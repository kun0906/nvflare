Namespace(server_ip='127.0.0.1', workspace_dir='out/ws_20_30_1_1', client_idx=5)
[Client 5] Connecting to server at 127.0.0.1:60000
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])

*** server_epoch:0, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:21:43...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.2956, val_loss: 17.2956, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 10.3564, val_loss: 10.3564, LR: 0.0009000000000000001
Function 'train_cnn' executed in 14.0913 seconds (Start: 2025-11-12 11:21:43, End: 2025-11-12 11:21:57)
dist(local, global): 5.42405366897583
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:21:57...
Function 'evaluate' executed in 0.0279 seconds (Start: 2025-11-12 11:21:57, End: 2025-11-12 11:21:57)
Function 'evaluate_shared_test starts at 2025-11-12 11:21:57...
Function 'evaluate_shared_test' executed in 0.0045 seconds (Start: 2025-11-12 11:21:57, End: 2025-11-12 11:21:57)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:00...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.2757, val_loss: 12.2757, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.6041, val_loss: 8.6041, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4547 seconds (Start: 2025-11-12 11:22:00, End: 2025-11-12 11:22:01)
dist(local, global): 1.6233327388763428
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:01...
Function 'evaluate' executed in 0.0331 seconds (Start: 2025-11-12 11:22:01, End: 2025-11-12 11:22:01)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:01...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:22:01, End: 2025-11-12 11:22:01)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:3, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:02...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 11.9559, val_loss: 11.9559, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.5457, val_loss: 8.5457, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4460 seconds (Start: 2025-11-12 11:22:02, End: 2025-11-12 11:22:02)
dist(local, global): 1.521813154220581
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:02...
Function 'evaluate' executed in 0.0314 seconds (Start: 2025-11-12 11:22:02, End: 2025-11-12 11:22:02)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:02...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:02, End: 2025-11-12 11:22:02)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:4, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:02...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.4797, val_loss: 12.4797, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3521, val_loss: 8.3521, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4111 seconds (Start: 2025-11-12 11:22:02, End: 2025-11-12 11:22:03)
dist(local, global): 1.4601026773452759
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:03...
Function 'evaluate' executed in 0.0156 seconds (Start: 2025-11-12 11:22:03, End: 2025-11-12 11:22:03)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:03...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:03, End: 2025-11-12 11:22:03)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:04...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.5442, val_loss: 12.5442, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.9970, val_loss: 7.9970, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4775 seconds (Start: 2025-11-12 11:22:04, End: 2025-11-12 11:22:04)
dist(local, global): 1.3225102424621582
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:04...
Function 'evaluate' executed in 0.0396 seconds (Start: 2025-11-12 11:22:04, End: 2025-11-12 11:22:05)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:05...
Function 'evaluate_shared_test' executed in 0.0042 seconds (Start: 2025-11-12 11:22:05, End: 2025-11-12 11:22:05)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:05...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.2873, val_loss: 12.2873, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.8847, val_loss: 7.8847, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4491 seconds (Start: 2025-11-12 11:22:05, End: 2025-11-12 11:22:06)
dist(local, global): 1.3518099784851074
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:06...
Function 'evaluate' executed in 0.0211 seconds (Start: 2025-11-12 11:22:06, End: 2025-11-12 11:22:06)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:06...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:06, End: 2025-11-12 11:22:06)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:11, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:06...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.1372, val_loss: 13.1372, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.8071, val_loss: 7.8071, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4376 seconds (Start: 2025-11-12 11:22:06, End: 2025-11-12 11:22:07)
dist(local, global): 1.3986295461654663
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:07...
Function 'evaluate' executed in 0.0226 seconds (Start: 2025-11-12 11:22:07, End: 2025-11-12 11:22:07)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:07...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:07, End: 2025-11-12 11:22:07)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:13, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:08...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9.5540, val_loss: 9.5540, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5.5246, val_loss: 5.5246, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4444 seconds (Start: 2025-11-12 11:22:08, End: 2025-11-12 11:22:08)
dist(local, global): 1.7683948278427124
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:08...
Function 'evaluate' executed in 0.0320 seconds (Start: 2025-11-12 11:22:08, End: 2025-11-12 11:22:08)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:08...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:22:08, End: 2025-11-12 11:22:08)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:08...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9.7511, val_loss: 9.7511, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5.5330, val_loss: 5.5330, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4111 seconds (Start: 2025-11-12 11:22:08, End: 2025-11-12 11:22:09)
dist(local, global): 1.9284700155258179
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:09...
Function 'evaluate' executed in 0.0263 seconds (Start: 2025-11-12 11:22:09, End: 2025-11-12 11:22:09)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:09...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:09, End: 2025-11-12 11:22:09)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:15, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:09...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.8292, val_loss: 10.8292, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5.5080, val_loss: 5.5080, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4489 seconds (Start: 2025-11-12 11:22:09, End: 2025-11-12 11:22:09)
dist(local, global): 1.4453476667404175
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:09...
Function 'evaluate' executed in 0.0318 seconds (Start: 2025-11-12 11:22:09, End: 2025-11-12 11:22:09)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:09...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:22:09, End: 2025-11-12 11:22:09)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:10...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 5.1463, val_loss: 5.1463, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.6498, val_loss: 2.6498, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4820 seconds (Start: 2025-11-12 11:22:10, End: 2025-11-12 11:22:10)
dist(local, global): 1.8431909084320068
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:10...
Function 'evaluate' executed in 0.0370 seconds (Start: 2025-11-12 11:22:10, End: 2025-11-12 11:22:10)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:10...
Function 'evaluate_shared_test' executed in 0.0042 seconds (Start: 2025-11-12 11:22:10, End: 2025-11-12 11:22:10)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:17, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:10...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 7.4822, val_loss: 7.4822, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.3313, val_loss: 3.3313, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4134 seconds (Start: 2025-11-12 11:22:10, End: 2025-11-12 11:22:11)
dist(local, global): 1.831710934638977
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:11...
Function 'evaluate' executed in 0.0271 seconds (Start: 2025-11-12 11:22:11, End: 2025-11-12 11:22:11)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:11...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:11, End: 2025-11-12 11:22:11)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:11...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9.0194, val_loss: 9.0194, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.8993, val_loss: 3.8993, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4824 seconds (Start: 2025-11-12 11:22:11, End: 2025-11-12 11:22:12)
dist(local, global): 1.8595213890075684
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:12...
Function 'evaluate' executed in 0.0335 seconds (Start: 2025-11-12 11:22:12, End: 2025-11-12 11:22:12)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:12...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:22:12, End: 2025-11-12 11:22:12)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:20, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:12...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9.3670, val_loss: 9.3670, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.9649, val_loss: 3.9649, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4788 seconds (Start: 2025-11-12 11:22:12, End: 2025-11-12 11:22:13)
dist(local, global): 1.3296924829483032
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:13...
Function 'evaluate' executed in 0.0360 seconds (Start: 2025-11-12 11:22:13, End: 2025-11-12 11:22:13)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:13...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:22:13, End: 2025-11-12 11:22:13)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:14...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.0255, val_loss: 10.0255, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.3042, val_loss: 4.3042, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4099 seconds (Start: 2025-11-12 11:22:14, End: 2025-11-12 11:22:14)
dist(local, global): 1.427747368812561
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:14...
Function 'evaluate' executed in 0.0286 seconds (Start: 2025-11-12 11:22:14, End: 2025-11-12 11:22:14)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:14...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:22:14, End: 2025-11-12 11:22:14)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:24, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:15...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.1512, val_loss: 10.1512, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.2312, val_loss: 4.2312, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4103 seconds (Start: 2025-11-12 11:22:15, End: 2025-11-12 11:22:15)
dist(local, global): 1.2897162437438965
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:15...
Function 'evaluate' executed in 0.0264 seconds (Start: 2025-11-12 11:22:15, End: 2025-11-12 11:22:15)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:15...
Function 'evaluate_shared_test' executed in 0.0044 seconds (Start: 2025-11-12 11:22:15, End: 2025-11-12 11:22:15)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:26, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:16...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.7839, val_loss: 10.7839, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.5479, val_loss: 4.5479, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4101 seconds (Start: 2025-11-12 11:22:16, End: 2025-11-12 11:22:16)
dist(local, global): 1.2657166719436646
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:16...
Function 'evaluate' executed in 0.0291 seconds (Start: 2025-11-12 11:22:16, End: 2025-11-12 11:22:16)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:16...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:22:16, End: 2025-11-12 11:22:16)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:16...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4.1612, val_loss: 4.1612, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1.7567, val_loss: 1.7567, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4100 seconds (Start: 2025-11-12 11:22:16, End: 2025-11-12 11:22:17)
dist(local, global): 1.8553355932235718
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:17...
Function 'evaluate' executed in 0.0265 seconds (Start: 2025-11-12 11:22:17, End: 2025-11-12 11:22:17)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:17...
Function 'evaluate_shared_test' executed in 0.0041 seconds (Start: 2025-11-12 11:22:17, End: 2025-11-12 11:22:17)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:17...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 6.4886, val_loss: 6.4886, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.3473, val_loss: 2.3473, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4444 seconds (Start: 2025-11-12 11:22:17, End: 2025-11-12 11:22:17)
dist(local, global): 2.035951614379883
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:17...
Function 'evaluate' executed in 0.0257 seconds (Start: 2025-11-12 11:22:17, End: 2025-11-12 11:22:17)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:17...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:22:17, End: 2025-11-12 11:22:17)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])

*** server_epoch:0, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:18...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.7173, val_loss: 17.7173, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 10.8839, val_loss: 10.8839, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3771 seconds (Start: 2025-11-12 11:22:18, End: 2025-11-12 11:22:19)
dist(local, global): 6.412509441375732
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:19...
Function 'evaluate' executed in 0.0239 seconds (Start: 2025-11-12 11:22:19, End: 2025-11-12 11:22:19)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:19...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:22:19, End: 2025-11-12 11:22:19)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:1, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:19...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.7414, val_loss: 12.7414, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.9511, val_loss: 8.9511, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4133 seconds (Start: 2025-11-12 11:22:19, End: 2025-11-12 11:22:19)
dist(local, global): 2.3182294368743896
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:19...
Function 'evaluate' executed in 0.0260 seconds (Start: 2025-11-12 11:22:19, End: 2025-11-12 11:22:19)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:19...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:22:19, End: 2025-11-12 11:22:19)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:19...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 8.4505, val_loss: 8.4505, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6.6365, val_loss: 6.6365, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4801 seconds (Start: 2025-11-12 11:22:19, End: 2025-11-12 11:22:20)
dist(local, global): 1.6927404403686523
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:20...
Function 'evaluate' executed in 0.0338 seconds (Start: 2025-11-12 11:22:20, End: 2025-11-12 11:22:20)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:20...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:22:20, End: 2025-11-12 11:22:20)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:4, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:21...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.2450, val_loss: 10.2450, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.1554, val_loss: 7.1554, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3722 seconds (Start: 2025-11-12 11:22:21, End: 2025-11-12 11:22:21)
dist(local, global): 1.7011796236038208
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:21...
Function 'evaluate' executed in 0.0257 seconds (Start: 2025-11-12 11:22:21, End: 2025-11-12 11:22:21)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:21...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:21, End: 2025-11-12 11:22:21)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:5, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:21...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 6.8329, val_loss: 6.8329, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5.0991, val_loss: 5.0991, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4457 seconds (Start: 2025-11-12 11:22:21, End: 2025-11-12 11:22:22)
dist(local, global): 1.7776246070861816
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:22...
Function 'evaluate' executed in 0.0330 seconds (Start: 2025-11-12 11:22:22, End: 2025-11-12 11:22:22)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:22...
Function 'evaluate_shared_test' executed in 0.0042 seconds (Start: 2025-11-12 11:22:22, End: 2025-11-12 11:22:22)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:6, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:22...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 8.5476, val_loss: 8.5476, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5.4362, val_loss: 5.4362, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4119 seconds (Start: 2025-11-12 11:22:22, End: 2025-11-12 11:22:22)
dist(local, global): 2.2672853469848633
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:22...
Function 'evaluate' executed in 0.0265 seconds (Start: 2025-11-12 11:22:22, End: 2025-11-12 11:22:22)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:22...
Function 'evaluate_shared_test' executed in 0.0046 seconds (Start: 2025-11-12 11:22:22, End: 2025-11-12 11:22:22)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:22...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9.2524, val_loss: 9.2524, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5.6523, val_loss: 5.6523, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4462 seconds (Start: 2025-11-12 11:22:22, End: 2025-11-12 11:22:23)
dist(local, global): 1.6888537406921387
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:23...
Function 'evaluate' executed in 0.0315 seconds (Start: 2025-11-12 11:22:23, End: 2025-11-12 11:22:23)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:23...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:22:23, End: 2025-11-12 11:22:23)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:8, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:23...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 5.3418, val_loss: 5.3418, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.5249, val_loss: 3.5249, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4450 seconds (Start: 2025-11-12 11:22:23, End: 2025-11-12 11:22:24)
dist(local, global): 1.8387058973312378
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:24...
Function 'evaluate' executed in 0.0304 seconds (Start: 2025-11-12 11:22:24, End: 2025-11-12 11:22:24)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:24...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:24, End: 2025-11-12 11:22:24)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:24...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 7.4819, val_loss: 7.4819, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.0861, val_loss: 4.0861, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4104 seconds (Start: 2025-11-12 11:22:24, End: 2025-11-12 11:22:24)
dist(local, global): 2.4162514209747314
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:24...
Function 'evaluate' executed in 0.0295 seconds (Start: 2025-11-12 11:22:24, End: 2025-11-12 11:22:24)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:24...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:22:24, End: 2025-11-12 11:22:24)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:12, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:26...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 8.2585, val_loss: 8.2585, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.0777, val_loss: 4.0777, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3991 seconds (Start: 2025-11-12 11:22:26, End: 2025-11-12 11:22:26)
dist(local, global): 2.005998134613037
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:26...
Function 'evaluate' executed in 0.0363 seconds (Start: 2025-11-12 11:22:26, End: 2025-11-12 11:22:26)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:26...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:22:26, End: 2025-11-12 11:22:26)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:27...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9.6024, val_loss: 9.6024, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.5323, val_loss: 4.5323, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4448 seconds (Start: 2025-11-12 11:22:27, End: 2025-11-12 11:22:27)
dist(local, global): 1.8162754774093628
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:27...
Function 'evaluate' executed in 0.0329 seconds (Start: 2025-11-12 11:22:27, End: 2025-11-12 11:22:27)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:27...
Function 'evaluate_shared_test' executed in 0.0045 seconds (Start: 2025-11-12 11:22:27, End: 2025-11-12 11:22:27)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:15, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:27...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 8.9957, val_loss: 8.9957, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.2762, val_loss: 4.2762, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4481 seconds (Start: 2025-11-12 11:22:27, End: 2025-11-12 11:22:28)
dist(local, global): 1.6230965852737427
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:28...
Function 'evaluate' executed in 0.0335 seconds (Start: 2025-11-12 11:22:28, End: 2025-11-12 11:22:28)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:28...
Function 'evaluate_shared_test' executed in 0.0042 seconds (Start: 2025-11-12 11:22:28, End: 2025-11-12 11:22:28)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:28...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.0896, val_loss: 10.0896, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.1850, val_loss: 4.1850, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4123 seconds (Start: 2025-11-12 11:22:28, End: 2025-11-12 11:22:28)
dist(local, global): 1.2968788146972656
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:28...
Function 'evaluate' executed in 0.0267 seconds (Start: 2025-11-12 11:22:28, End: 2025-11-12 11:22:28)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:28...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:22:28, End: 2025-11-12 11:22:28)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:17, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:29...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9.8148, val_loss: 9.8148, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.3652, val_loss: 4.3652, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4474 seconds (Start: 2025-11-12 11:22:29, End: 2025-11-12 11:22:29)
dist(local, global): 1.767006278038025
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:29...
Function 'evaluate' executed in 0.0305 seconds (Start: 2025-11-12 11:22:29, End: 2025-11-12 11:22:29)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:29...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:22:29, End: 2025-11-12 11:22:29)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:18, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:29...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.0009, val_loss: 10.0009, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.6686, val_loss: 4.6686, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4825 seconds (Start: 2025-11-12 11:22:29, End: 2025-11-12 11:22:30)
dist(local, global): 1.7647404670715332
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:30...
Function 'evaluate' executed in 0.0331 seconds (Start: 2025-11-12 11:22:30, End: 2025-11-12 11:22:30)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:30...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:30, End: 2025-11-12 11:22:30)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:30...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9.3093, val_loss: 9.3093, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.4530, val_loss: 4.4530, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4817 seconds (Start: 2025-11-12 11:22:30, End: 2025-11-12 11:22:30)
dist(local, global): 1.4681364297866821
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:30...
Function 'evaluate' executed in 0.0371 seconds (Start: 2025-11-12 11:22:30, End: 2025-11-12 11:22:30)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:30...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:30, End: 2025-11-12 11:22:30)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:20, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:31...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9.5253, val_loss: 9.5253, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.3120, val_loss: 4.3120, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4438 seconds (Start: 2025-11-12 11:22:31, End: 2025-11-12 11:22:31)
dist(local, global): 1.3477054834365845
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:31...
Function 'evaluate' executed in 0.0291 seconds (Start: 2025-11-12 11:22:31, End: 2025-11-12 11:22:31)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:31...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:22:31, End: 2025-11-12 11:22:31)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:32...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.3752, val_loss: 10.3752, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.6290, val_loss: 4.6290, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4448 seconds (Start: 2025-11-12 11:22:32, End: 2025-11-12 11:22:33)
dist(local, global): 1.1762645244598389
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:33...
Function 'evaluate' executed in 0.0292 seconds (Start: 2025-11-12 11:22:33, End: 2025-11-12 11:22:33)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:33...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:22:33, End: 2025-11-12 11:22:33)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:25, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:34...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 7.1310, val_loss: 7.1310, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.6790, val_loss: 2.6790, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4110 seconds (Start: 2025-11-12 11:22:34, End: 2025-11-12 11:22:34)
dist(local, global): 1.224255919456482
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:34...
Function 'evaluate' executed in 0.0269 seconds (Start: 2025-11-12 11:22:34, End: 2025-11-12 11:22:34)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:34...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:34, End: 2025-11-12 11:22:34)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:26, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:34...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 7.2777, val_loss: 7.2777, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.9746, val_loss: 2.9746, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3744 seconds (Start: 2025-11-12 11:22:34, End: 2025-11-12 11:22:35)
dist(local, global): 1.3922640085220337
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:35...
Function 'evaluate' executed in 0.0228 seconds (Start: 2025-11-12 11:22:35, End: 2025-11-12 11:22:35)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:35...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:22:35, End: 2025-11-12 11:22:35)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:35...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 8.3142, val_loss: 8.3142, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.3392, val_loss: 3.3392, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4830 seconds (Start: 2025-11-12 11:22:35, End: 2025-11-12 11:22:35)
dist(local, global): 1.6466163396835327
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:35...
Function 'evaluate' executed in 0.0326 seconds (Start: 2025-11-12 11:22:35, End: 2025-11-12 11:22:35)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:35...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:35, End: 2025-11-12 11:22:35)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:36...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3.2371, val_loss: 3.2371, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1.6053, val_loss: 1.6053, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4135 seconds (Start: 2025-11-12 11:22:36, End: 2025-11-12 11:22:36)
dist(local, global): 1.6343547105789185
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:36...
Function 'evaluate' executed in 0.0286 seconds (Start: 2025-11-12 11:22:36, End: 2025-11-12 11:22:36)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:36...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:36, End: 2025-11-12 11:22:36)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:29, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:36...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1.5428, val_loss: 1.5428, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 0.4151, val_loss: 0.4151, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4170 seconds (Start: 2025-11-12 11:22:36, End: 2025-11-12 11:22:37)
dist(local, global): 1.471634030342102
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:37...
Function 'evaluate' executed in 0.0095 seconds (Start: 2025-11-12 11:22:37, End: 2025-11-12 11:22:37)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:37...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:22:37, End: 2025-11-12 11:22:37)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])

*** server_epoch:0, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:37...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.6939, val_loss: 17.6939, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 10.8195, val_loss: 10.8195, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4116 seconds (Start: 2025-11-12 11:22:37, End: 2025-11-12 11:22:37)
dist(local, global): 4.934053421020508
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:37...
Function 'evaluate' executed in 0.0272 seconds (Start: 2025-11-12 11:22:37, End: 2025-11-12 11:22:37)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:37...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:22:37, End: 2025-11-12 11:22:37)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:1, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:37...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.2265, val_loss: 13.2265, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.0577, val_loss: 9.0577, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4119 seconds (Start: 2025-11-12 11:22:37, End: 2025-11-12 11:22:38)
dist(local, global): 2.559892416000366
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:38...
Function 'evaluate' executed in 0.0282 seconds (Start: 2025-11-12 11:22:38, End: 2025-11-12 11:22:38)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:38...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:38, End: 2025-11-12 11:22:38)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:38...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.3475, val_loss: 12.3475, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.7490, val_loss: 8.7490, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3758 seconds (Start: 2025-11-12 11:22:38, End: 2025-11-12 11:22:38)
dist(local, global): 1.7833915948867798
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:38...
Function 'evaluate' executed in 0.0254 seconds (Start: 2025-11-12 11:22:38, End: 2025-11-12 11:22:38)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:38...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:38, End: 2025-11-12 11:22:38)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:3, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:38...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.6427, val_loss: 12.6427, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.7499, val_loss: 8.7499, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4472 seconds (Start: 2025-11-12 11:22:38, End: 2025-11-12 11:22:39)
dist(local, global): 1.6469707489013672
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:39...
Function 'evaluate' executed in 0.0268 seconds (Start: 2025-11-12 11:22:39, End: 2025-11-12 11:22:39)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:39...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:22:39, End: 2025-11-12 11:22:39)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:4, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:39...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.7468, val_loss: 12.7468, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8334, val_loss: 8.8334, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4464 seconds (Start: 2025-11-12 11:22:39, End: 2025-11-12 11:22:40)
dist(local, global): 1.5793768167495728
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:40...
Function 'evaluate' executed in 0.0304 seconds (Start: 2025-11-12 11:22:40, End: 2025-11-12 11:22:40)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:40...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:22:40, End: 2025-11-12 11:22:40)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:5, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:40...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.5654, val_loss: 12.5654, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.7898, val_loss: 8.7898, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3700 seconds (Start: 2025-11-12 11:22:40, End: 2025-11-12 11:22:40)
dist(local, global): 1.640509843826294
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:40...
Function 'evaluate' executed in 0.0210 seconds (Start: 2025-11-12 11:22:40, End: 2025-11-12 11:22:40)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:40...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:40, End: 2025-11-12 11:22:40)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:6, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:40...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.3634, val_loss: 12.3634, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.5598, val_loss: 8.5598, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4181 seconds (Start: 2025-11-12 11:22:40, End: 2025-11-12 11:22:41)
dist(local, global): 1.473628282546997
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:41...
Function 'evaluate' executed in 0.0261 seconds (Start: 2025-11-12 11:22:41, End: 2025-11-12 11:22:41)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:41...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:41, End: 2025-11-12 11:22:41)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:41...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.0814, val_loss: 13.0814, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.5027, val_loss: 8.5027, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4119 seconds (Start: 2025-11-12 11:22:41, End: 2025-11-12 11:22:41)
dist(local, global): 1.4336752891540527
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:41...
Function 'evaluate' executed in 0.0270 seconds (Start: 2025-11-12 11:22:41, End: 2025-11-12 11:22:41)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:41...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:22:41, End: 2025-11-12 11:22:41)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:8, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:41...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.9191, val_loss: 15.9191, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3356, val_loss: 8.3356, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4465 seconds (Start: 2025-11-12 11:22:41, End: 2025-11-12 11:22:42)
dist(local, global): 1.7365705966949463
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:42...
Function 'evaluate' executed in 0.0320 seconds (Start: 2025-11-12 11:22:42, End: 2025-11-12 11:22:42)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:42...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:42, End: 2025-11-12 11:22:42)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:42...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.5080, val_loss: 13.5080, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.1786, val_loss: 8.1786, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4470 seconds (Start: 2025-11-12 11:22:42, End: 2025-11-12 11:22:43)
dist(local, global): 1.4496511220932007
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:43...
Function 'evaluate' executed in 0.0302 seconds (Start: 2025-11-12 11:22:43, End: 2025-11-12 11:22:43)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:43...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:22:43, End: 2025-11-12 11:22:43)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:10, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:43...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.3533, val_loss: 14.3533, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3265, val_loss: 8.3265, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4069 seconds (Start: 2025-11-12 11:22:43, End: 2025-11-12 11:22:43)
dist(local, global): 1.5033501386642456
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:43...
Function 'evaluate' executed in 0.0312 seconds (Start: 2025-11-12 11:22:43, End: 2025-11-12 11:22:43)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:43...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:22:43, End: 2025-11-12 11:22:43)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:12, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:44...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.1489, val_loss: 15.1489, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.9511, val_loss: 7.9511, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4105 seconds (Start: 2025-11-12 11:22:44, End: 2025-11-12 11:22:44)
dist(local, global): 1.4570549726486206
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:44...
Function 'evaluate' executed in 0.0299 seconds (Start: 2025-11-12 11:22:44, End: 2025-11-12 11:22:44)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:44...
Function 'evaluate_shared_test' executed in 0.0041 seconds (Start: 2025-11-12 11:22:44, End: 2025-11-12 11:22:44)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:13, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:45...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.8828, val_loss: 13.8828, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.9701, val_loss: 7.9701, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4468 seconds (Start: 2025-11-12 11:22:45, End: 2025-11-12 11:22:45)
dist(local, global): 1.3050066232681274
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:45...
Function 'evaluate' executed in 0.0297 seconds (Start: 2025-11-12 11:22:45, End: 2025-11-12 11:22:45)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:45...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:45, End: 2025-11-12 11:22:45)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:45...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.2606, val_loss: 14.2606, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3204, val_loss: 8.3204, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4439 seconds (Start: 2025-11-12 11:22:45, End: 2025-11-12 11:22:46)
dist(local, global): 1.436321496963501
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:46...
Function 'evaluate' executed in 0.0322 seconds (Start: 2025-11-12 11:22:46, End: 2025-11-12 11:22:46)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:46...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:46, End: 2025-11-12 11:22:46)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:15, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:46...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.4473, val_loss: 17.4473, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3115, val_loss: 8.3115, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4454 seconds (Start: 2025-11-12 11:22:46, End: 2025-11-12 11:22:46)
dist(local, global): 1.5773156881332397
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:46...
Function 'evaluate' executed in 0.0299 seconds (Start: 2025-11-12 11:22:46, End: 2025-11-12 11:22:46)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:46...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:22:46, End: 2025-11-12 11:22:46)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:47...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.5465, val_loss: 14.5465, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.1891, val_loss: 8.1891, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4822 seconds (Start: 2025-11-12 11:22:47, End: 2025-11-12 11:22:47)
dist(local, global): 1.462136149406433
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:47...
Function 'evaluate' executed in 0.0321 seconds (Start: 2025-11-12 11:22:47, End: 2025-11-12 11:22:47)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:47...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:47, End: 2025-11-12 11:22:47)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:17, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:47...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.1818, val_loss: 15.1818, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2599, val_loss: 8.2599, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3776 seconds (Start: 2025-11-12 11:22:47, End: 2025-11-12 11:22:48)
dist(local, global): 1.4973899126052856
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:48...
Function 'evaluate' executed in 0.0246 seconds (Start: 2025-11-12 11:22:48, End: 2025-11-12 11:22:48)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:48...
Function 'evaluate_shared_test' executed in 0.0043 seconds (Start: 2025-11-12 11:22:48, End: 2025-11-12 11:22:48)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:18, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:48...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.4975, val_loss: 14.4975, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3609, val_loss: 8.3609, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4116 seconds (Start: 2025-11-12 11:22:48, End: 2025-11-12 11:22:48)
dist(local, global): 1.3549067974090576
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:48...
Function 'evaluate' executed in 0.0288 seconds (Start: 2025-11-12 11:22:48, End: 2025-11-12 11:22:48)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:48...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:48, End: 2025-11-12 11:22:48)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:48...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 19.0940, val_loss: 19.0940, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.5808, val_loss: 8.5808, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4467 seconds (Start: 2025-11-12 11:22:48, End: 2025-11-12 11:22:49)
dist(local, global): 1.695836067199707
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:49...
Function 'evaluate' executed in 0.0290 seconds (Start: 2025-11-12 11:22:49, End: 2025-11-12 11:22:49)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:49...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:49, End: 2025-11-12 11:22:49)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:21, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:50...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.9507, val_loss: 14.9507, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3321, val_loss: 8.3321, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4467 seconds (Start: 2025-11-12 11:22:50, End: 2025-11-12 11:22:50)
dist(local, global): 1.3548487424850464
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:50...
Function 'evaluate' executed in 0.0301 seconds (Start: 2025-11-12 11:22:50, End: 2025-11-12 11:22:50)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:50...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:22:50, End: 2025-11-12 11:22:50)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:22, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:50...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 16.4048, val_loss: 16.4048, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3975, val_loss: 8.3975, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4113 seconds (Start: 2025-11-12 11:22:50, End: 2025-11-12 11:22:51)
dist(local, global): 1.3980801105499268
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:51...
Function 'evaluate' executed in 0.0271 seconds (Start: 2025-11-12 11:22:51, End: 2025-11-12 11:22:51)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:51...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:51, End: 2025-11-12 11:22:51)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:51...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 8.1197, val_loss: 8.1197, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.9451, val_loss: 4.9451, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4092 seconds (Start: 2025-11-12 11:22:51, End: 2025-11-12 11:22:51)
dist(local, global): 1.3658746480941772
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:51...
Function 'evaluate' executed in 0.0266 seconds (Start: 2025-11-12 11:22:51, End: 2025-11-12 11:22:51)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:51...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:22:51, End: 2025-11-12 11:22:51)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:24, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:51...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.7132, val_loss: 12.7132, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5.4344, val_loss: 5.4344, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4108 seconds (Start: 2025-11-12 11:22:51, End: 2025-11-12 11:22:52)
dist(local, global): 1.215380072593689
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:52...
Function 'evaluate' executed in 0.0284 seconds (Start: 2025-11-12 11:22:52, End: 2025-11-12 11:22:52)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:52...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:52, End: 2025-11-12 11:22:52)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:25, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:52...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.6567, val_loss: 12.6567, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5.6127, val_loss: 5.6127, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4110 seconds (Start: 2025-11-12 11:22:52, End: 2025-11-12 11:22:52)
dist(local, global): 1.2133238315582275
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:52...
Function 'evaluate' executed in 0.0290 seconds (Start: 2025-11-12 11:22:52, End: 2025-11-12 11:22:52)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:52...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:52, End: 2025-11-12 11:22:52)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:26, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:53...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.1316, val_loss: 12.1316, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5.9286, val_loss: 5.9286, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4843 seconds (Start: 2025-11-12 11:22:53, End: 2025-11-12 11:22:53)
dist(local, global): 1.1517210006713867
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:53...
Function 'evaluate' executed in 0.0301 seconds (Start: 2025-11-12 11:22:53, End: 2025-11-12 11:22:53)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:53...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:22:53, End: 2025-11-12 11:22:53)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:53...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.9123, val_loss: 14.9123, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6.1336, val_loss: 6.1336, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4500 seconds (Start: 2025-11-12 11:22:53, End: 2025-11-12 11:22:54)
dist(local, global): 1.3515379428863525
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:54...
Function 'evaluate' executed in 0.0314 seconds (Start: 2025-11-12 11:22:54, End: 2025-11-12 11:22:54)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:54...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:22:54, End: 2025-11-12 11:22:54)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:54...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.8798, val_loss: 15.8798, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6.2880, val_loss: 6.2880, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4106 seconds (Start: 2025-11-12 11:22:54, End: 2025-11-12 11:22:54)
dist(local, global): 1.4292312860488892
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:54...
Function 'evaluate' executed in 0.0303 seconds (Start: 2025-11-12 11:22:54, End: 2025-11-12 11:22:54)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:54...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:54, End: 2025-11-12 11:22:54)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:29, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:54...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 21.5239, val_loss: 21.5239, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6.8207, val_loss: 6.8207, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4132 seconds (Start: 2025-11-12 11:22:54, End: 2025-11-12 11:22:55)
dist(local, global): 1.6282660961151123
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:55...
Function 'evaluate' executed in 0.0279 seconds (Start: 2025-11-12 11:22:55, End: 2025-11-12 11:22:55)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:55...
Function 'evaluate_shared_test' executed in 0.0044 seconds (Start: 2025-11-12 11:22:55, End: 2025-11-12 11:22:55)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])

*** server_epoch:0, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:55...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.3811, val_loss: 17.3811, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 10.3958, val_loss: 10.3958, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4467 seconds (Start: 2025-11-12 11:22:55, End: 2025-11-12 11:22:56)
dist(local, global): 5.651318550109863
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:56...
Function 'evaluate' executed in 0.0297 seconds (Start: 2025-11-12 11:22:56, End: 2025-11-12 11:22:56)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:56...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:22:56, End: 2025-11-12 11:22:56)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:1, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:56...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.9798, val_loss: 12.9798, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.9885, val_loss: 8.9885, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4827 seconds (Start: 2025-11-12 11:22:56, End: 2025-11-12 11:22:56)
dist(local, global): 2.303241014480591
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:56...
Function 'evaluate' executed in 0.0334 seconds (Start: 2025-11-12 11:22:56, End: 2025-11-12 11:22:56)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:56...
Function 'evaluate_shared_test' executed in 0.0041 seconds (Start: 2025-11-12 11:22:56, End: 2025-11-12 11:22:56)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:56...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.1958, val_loss: 12.1958, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8116, val_loss: 8.8116, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4472 seconds (Start: 2025-11-12 11:22:56, End: 2025-11-12 11:22:57)
dist(local, global): 1.7410842180252075
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:57...
Function 'evaluate' executed in 0.0291 seconds (Start: 2025-11-12 11:22:57, End: 2025-11-12 11:22:57)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:57...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:22:57, End: 2025-11-12 11:22:57)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:3, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:57...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.8233, val_loss: 12.8233, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.9897, val_loss: 8.9897, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4088 seconds (Start: 2025-11-12 11:22:57, End: 2025-11-12 11:22:57)
dist(local, global): 1.6635401248931885
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:57...
Function 'evaluate' executed in 0.0280 seconds (Start: 2025-11-12 11:22:57, End: 2025-11-12 11:22:57)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:57...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:22:57, End: 2025-11-12 11:22:57)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:5, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:58...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.3987, val_loss: 12.3987, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.6782, val_loss: 8.6782, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4146 seconds (Start: 2025-11-12 11:22:58, End: 2025-11-12 11:22:59)
dist(local, global): 1.6296303272247314
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:59...
Function 'evaluate' executed in 0.0274 seconds (Start: 2025-11-12 11:22:59, End: 2025-11-12 11:22:59)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:59...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:22:59, End: 2025-11-12 11:22:59)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:6, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:59...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.9489, val_loss: 13.9489, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.9115, val_loss: 8.9115, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4451 seconds (Start: 2025-11-12 11:22:59, End: 2025-11-12 11:22:59)
dist(local, global): 1.6507196426391602
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:22:59...
Function 'evaluate' executed in 0.0292 seconds (Start: 2025-11-12 11:22:59, End: 2025-11-12 11:22:59)
Function 'evaluate_shared_test starts at 2025-11-12 11:22:59...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:22:59, End: 2025-11-12 11:22:59)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:22:59...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.9955, val_loss: 12.9955, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.7725, val_loss: 8.7725, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4445 seconds (Start: 2025-11-12 11:22:59, End: 2025-11-12 11:23:00)
dist(local, global): 1.5002820491790771
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:00...
Function 'evaluate' executed in 0.0316 seconds (Start: 2025-11-12 11:23:00, End: 2025-11-12 11:23:00)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:00...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:23:00, End: 2025-11-12 11:23:00)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:8, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:00...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.9347, val_loss: 13.9347, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.6128, val_loss: 8.6128, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4463 seconds (Start: 2025-11-12 11:23:00, End: 2025-11-12 11:23:01)
dist(local, global): 1.5281198024749756
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:01...
Function 'evaluate' executed in 0.0294 seconds (Start: 2025-11-12 11:23:01, End: 2025-11-12 11:23:01)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:01...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:23:01, End: 2025-11-12 11:23:01)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:01...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.4487, val_loss: 13.4487, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.5062, val_loss: 8.5062, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3764 seconds (Start: 2025-11-12 11:23:01, End: 2025-11-12 11:23:01)
dist(local, global): 1.467664122581482
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:01...
Function 'evaluate' executed in 0.0227 seconds (Start: 2025-11-12 11:23:01, End: 2025-11-12 11:23:01)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:01...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:23:01, End: 2025-11-12 11:23:01)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:10, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:01...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.7914, val_loss: 15.7914, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2510, val_loss: 8.2510, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3714 seconds (Start: 2025-11-12 11:23:01, End: 2025-11-12 11:23:02)
dist(local, global): 1.7053719758987427
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:02...
Function 'evaluate' executed in 0.0292 seconds (Start: 2025-11-12 11:23:02, End: 2025-11-12 11:23:02)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:02...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:23:02, End: 2025-11-12 11:23:02)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:11, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:02...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.5678, val_loss: 13.5678, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2188, val_loss: 8.2188, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4382 seconds (Start: 2025-11-12 11:23:02, End: 2025-11-12 11:23:02)
dist(local, global): 1.3958829641342163
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:02...
Function 'evaluate' executed in 0.0357 seconds (Start: 2025-11-12 11:23:02, End: 2025-11-12 11:23:02)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:02...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:23:02, End: 2025-11-12 11:23:02)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:12, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:02...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.2937, val_loss: 15.2937, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.0756, val_loss: 8.0756, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4489 seconds (Start: 2025-11-12 11:23:02, End: 2025-11-12 11:23:03)
dist(local, global): 1.5315996408462524
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:03...
Function 'evaluate' executed in 0.0301 seconds (Start: 2025-11-12 11:23:03, End: 2025-11-12 11:23:03)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:03...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:23:03, End: 2025-11-12 11:23:03)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:13, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:03...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.6252, val_loss: 13.6252, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.9752, val_loss: 7.9752, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4053 seconds (Start: 2025-11-12 11:23:03, End: 2025-11-12 11:23:03)
dist(local, global): 1.359371304512024
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:03...
Function 'evaluate' executed in 0.0320 seconds (Start: 2025-11-12 11:23:03, End: 2025-11-12 11:23:04)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:04...
Function 'evaluate_shared_test' executed in 0.0041 seconds (Start: 2025-11-12 11:23:04, End: 2025-11-12 11:23:04)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:04...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.8952, val_loss: 12.8952, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.8032, val_loss: 7.8032, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4063 seconds (Start: 2025-11-12 11:23:04, End: 2025-11-12 11:23:04)
dist(local, global): 1.4096931219100952
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:04...
Function 'evaluate' executed in 0.0247 seconds (Start: 2025-11-12 11:23:04, End: 2025-11-12 11:23:04)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:04...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:23:04, End: 2025-11-12 11:23:04)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:05...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.3523, val_loss: 17.3523, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.9727, val_loss: 7.9727, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4105 seconds (Start: 2025-11-12 11:23:05, End: 2025-11-12 11:23:05)
dist(local, global): 1.724893569946289
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:05...
Function 'evaluate' executed in 0.0272 seconds (Start: 2025-11-12 11:23:05, End: 2025-11-12 11:23:05)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:05...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:23:05, End: 2025-11-12 11:23:05)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:17, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:05...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.3586, val_loss: 15.3586, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.9086, val_loss: 7.9086, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4107 seconds (Start: 2025-11-12 11:23:05, End: 2025-11-12 11:23:06)
dist(local, global): 1.4391567707061768
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:06...
Function 'evaluate' executed in 0.0263 seconds (Start: 2025-11-12 11:23:06, End: 2025-11-12 11:23:06)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:06...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:23:06, End: 2025-11-12 11:23:06)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:07...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.0278, val_loss: 15.0278, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.9317, val_loss: 7.9317, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4480 seconds (Start: 2025-11-12 11:23:07, End: 2025-11-12 11:23:07)
dist(local, global): 1.5182862281799316
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:07...
Function 'evaluate' executed in 0.0304 seconds (Start: 2025-11-12 11:23:07, End: 2025-11-12 11:23:07)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:07...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:23:07, End: 2025-11-12 11:23:07)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:20, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:07...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.9303, val_loss: 15.9303, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.8334, val_loss: 7.8334, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4496 seconds (Start: 2025-11-12 11:23:07, End: 2025-11-12 11:23:08)
dist(local, global): 1.557114601135254
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:08...
Function 'evaluate' executed in 0.0320 seconds (Start: 2025-11-12 11:23:08, End: 2025-11-12 11:23:08)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:08...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:23:08, End: 2025-11-12 11:23:08)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:22, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:09...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.6966, val_loss: 17.6966, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.7893, val_loss: 7.7893, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4467 seconds (Start: 2025-11-12 11:23:09, End: 2025-11-12 11:23:09)
dist(local, global): 1.6390209197998047
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:09...
Function 'evaluate' executed in 0.0252 seconds (Start: 2025-11-12 11:23:09, End: 2025-11-12 11:23:09)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:09...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:23:09, End: 2025-11-12 11:23:09)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:09...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 22.2908, val_loss: 22.2908, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.1892, val_loss: 8.1892, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4846 seconds (Start: 2025-11-12 11:23:09, End: 2025-11-12 11:23:10)
dist(local, global): 1.9092868566513062
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:10...
Function 'evaluate' executed in 0.0308 seconds (Start: 2025-11-12 11:23:10, End: 2025-11-12 11:23:10)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:10...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:23:10, End: 2025-11-12 11:23:10)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:24, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:10...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 20.8700, val_loss: 20.8700, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.0926, val_loss: 8.0926, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4463 seconds (Start: 2025-11-12 11:23:10, End: 2025-11-12 11:23:10)
dist(local, global): 1.8433103561401367
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:10...
Function 'evaluate' executed in 0.0297 seconds (Start: 2025-11-12 11:23:10, End: 2025-11-12 11:23:10)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:10...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:23:10, End: 2025-11-12 11:23:10)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:25, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:10...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 22.5597, val_loss: 22.5597, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.1890, val_loss: 8.1890, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4850 seconds (Start: 2025-11-12 11:23:10, End: 2025-11-12 11:23:11)
dist(local, global): 1.8432424068450928
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:11...
Function 'evaluate' executed in 0.0333 seconds (Start: 2025-11-12 11:23:11, End: 2025-11-12 11:23:11)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:11...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:23:11, End: 2025-11-12 11:23:11)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:26, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:11...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 22.6641, val_loss: 22.6641, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.0579, val_loss: 8.0579, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4108 seconds (Start: 2025-11-12 11:23:11, End: 2025-11-12 11:23:12)
dist(local, global): 1.8755600452423096
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:12...
Function 'evaluate' executed in 0.0273 seconds (Start: 2025-11-12 11:23:12, End: 2025-11-12 11:23:12)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:12...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:23:12, End: 2025-11-12 11:23:12)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:12...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 7.8304, val_loss: 7.8304, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.0051, val_loss: 4.0051, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4098 seconds (Start: 2025-11-12 11:23:12, End: 2025-11-12 11:23:12)
dist(local, global): 1.096550464630127
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:12...
Function 'evaluate' executed in 0.0310 seconds (Start: 2025-11-12 11:23:12, End: 2025-11-12 11:23:12)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:12...
Function 'evaluate_shared_test' executed in 0.0043 seconds (Start: 2025-11-12 11:23:12, End: 2025-11-12 11:23:12)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:12...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9.8326, val_loss: 9.8326, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.6228, val_loss: 4.6228, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.5156 seconds (Start: 2025-11-12 11:23:12, End: 2025-11-12 11:23:13)
dist(local, global): 1.315454125404358
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:13...
Function 'evaluate' executed in 0.0358 seconds (Start: 2025-11-12 11:23:13, End: 2025-11-12 11:23:13)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:13...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:23:13, End: 2025-11-12 11:23:13)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:29, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:13...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.9408, val_loss: 12.9408, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5.0848, val_loss: 5.0848, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3773 seconds (Start: 2025-11-12 11:23:13, End: 2025-11-12 11:23:13)
dist(local, global): 1.1549397706985474
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:13...
Function 'evaluate' executed in 0.0246 seconds (Start: 2025-11-12 11:23:13, End: 2025-11-12 11:23:13)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:13...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:23:13, End: 2025-11-12 11:23:13)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:1, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:14...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.5568, val_loss: 12.5568, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8587, val_loss: 8.8587, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4127 seconds (Start: 2025-11-12 11:23:14, End: 2025-11-12 11:23:15)
dist(local, global): 2.0649898052215576
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:15...
Function 'evaluate' executed in 0.0266 seconds (Start: 2025-11-12 11:23:15, End: 2025-11-12 11:23:15)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:15...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:23:15, End: 2025-11-12 11:23:15)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:15...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.0632, val_loss: 12.0632, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.6918, val_loss: 8.6918, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4127 seconds (Start: 2025-11-12 11:23:15, End: 2025-11-12 11:23:15)
dist(local, global): 1.7016336917877197
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:15...
Function 'evaluate' executed in 0.0277 seconds (Start: 2025-11-12 11:23:15, End: 2025-11-12 11:23:15)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:15...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:23:15, End: 2025-11-12 11:23:15)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:3, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:15...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.4270, val_loss: 12.4270, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.6988, val_loss: 8.6988, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4461 seconds (Start: 2025-11-12 11:23:15, End: 2025-11-12 11:23:16)
dist(local, global): 1.4956051111221313
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:16...
Function 'evaluate' executed in 0.0318 seconds (Start: 2025-11-12 11:23:16, End: 2025-11-12 11:23:16)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:16...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:23:16, End: 2025-11-12 11:23:16)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:5, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:17...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.0857, val_loss: 13.0857, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.7761, val_loss: 8.7761, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4474 seconds (Start: 2025-11-12 11:23:17, End: 2025-11-12 11:23:17)
dist(local, global): 1.5932338237762451
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:17...
Function 'evaluate' executed in 0.0316 seconds (Start: 2025-11-12 11:23:17, End: 2025-11-12 11:23:17)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:17...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:23:17, End: 2025-11-12 11:23:17)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:6, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:17...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.1914, val_loss: 12.1914, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.5243, val_loss: 8.5243, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4448 seconds (Start: 2025-11-12 11:23:17, End: 2025-11-12 11:23:18)
dist(local, global): 1.6963798999786377
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:18...
Function 'evaluate' executed in 0.0306 seconds (Start: 2025-11-12 11:23:18, End: 2025-11-12 11:23:18)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:18...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:23:18, End: 2025-11-12 11:23:18)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:18...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.9349, val_loss: 12.9349, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.6573, val_loss: 8.6573, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4075 seconds (Start: 2025-11-12 11:23:18, End: 2025-11-12 11:23:18)
dist(local, global): 1.4749503135681152
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:18...
Function 'evaluate' executed in 0.0314 seconds (Start: 2025-11-12 11:23:18, End: 2025-11-12 11:23:18)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:18...
Function 'evaluate_shared_test' executed in 0.0042 seconds (Start: 2025-11-12 11:23:18, End: 2025-11-12 11:23:18)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:8, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:18...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.3338, val_loss: 13.3338, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3394, val_loss: 8.3394, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4424 seconds (Start: 2025-11-12 11:23:18, End: 2025-11-12 11:23:19)
dist(local, global): 1.4850702285766602
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:19...
Function 'evaluate' executed in 0.0297 seconds (Start: 2025-11-12 11:23:19, End: 2025-11-12 11:23:19)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:19...
Function 'evaluate_shared_test' executed in 0.0043 seconds (Start: 2025-11-12 11:23:19, End: 2025-11-12 11:23:19)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:19...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.1469, val_loss: 13.1469, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.4628, val_loss: 8.4628, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4035 seconds (Start: 2025-11-12 11:23:19, End: 2025-11-12 11:23:19)
dist(local, global): 1.6343015432357788
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:19...
Function 'evaluate' executed in 0.0340 seconds (Start: 2025-11-12 11:23:19, End: 2025-11-12 11:23:19)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:19...
Function 'evaluate_shared_test' executed in 0.0046 seconds (Start: 2025-11-12 11:23:19, End: 2025-11-12 11:23:19)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:10, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:20...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.8449, val_loss: 12.8449, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.4243, val_loss: 8.4243, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4807 seconds (Start: 2025-11-12 11:23:20, End: 2025-11-12 11:23:20)
dist(local, global): 1.574118971824646
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:20...
Function 'evaluate' executed in 0.0331 seconds (Start: 2025-11-12 11:23:20, End: 2025-11-12 11:23:20)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:20...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:23:20, End: 2025-11-12 11:23:20)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:11, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:20...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.7733, val_loss: 12.7733, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3722, val_loss: 8.3722, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4120 seconds (Start: 2025-11-12 11:23:20, End: 2025-11-12 11:23:21)
dist(local, global): 1.423318862915039
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:21...
Function 'evaluate' executed in 0.0279 seconds (Start: 2025-11-12 11:23:21, End: 2025-11-12 11:23:21)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:21...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:23:21, End: 2025-11-12 11:23:21)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:12, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:21...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.0731, val_loss: 13.0731, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.4708, val_loss: 8.4708, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4113 seconds (Start: 2025-11-12 11:23:21, End: 2025-11-12 11:23:21)
dist(local, global): 1.496899962425232
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:21...
Function 'evaluate' executed in 0.0299 seconds (Start: 2025-11-12 11:23:21, End: 2025-11-12 11:23:21)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:21...
Function 'evaluate_shared_test' executed in 0.0052 seconds (Start: 2025-11-12 11:23:21, End: 2025-11-12 11:23:21)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:22...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 16.2504, val_loss: 16.2504, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3146, val_loss: 8.3146, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4116 seconds (Start: 2025-11-12 11:23:22, End: 2025-11-12 11:23:23)
dist(local, global): 1.6918587684631348
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:23...
Function 'evaluate' executed in 0.0275 seconds (Start: 2025-11-12 11:23:23, End: 2025-11-12 11:23:23)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:23...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:23:23, End: 2025-11-12 11:23:23)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:15, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:23...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 21.5947, val_loss: 21.5947, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.6208, val_loss: 8.6208, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4462 seconds (Start: 2025-11-12 11:23:23, End: 2025-11-12 11:23:23)
dist(local, global): 2.0017518997192383
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:23...
Function 'evaluate' executed in 0.0299 seconds (Start: 2025-11-12 11:23:23, End: 2025-11-12 11:23:23)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:23...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:23:23, End: 2025-11-12 11:23:23)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:23...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 16.8989, val_loss: 16.8989, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2965, val_loss: 8.2965, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4128 seconds (Start: 2025-11-12 11:23:23, End: 2025-11-12 11:23:24)
dist(local, global): 1.6612706184387207
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:24...
Function 'evaluate' executed in 0.0278 seconds (Start: 2025-11-12 11:23:24, End: 2025-11-12 11:23:24)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:24...
Function 'evaluate_shared_test' executed in 0.0043 seconds (Start: 2025-11-12 11:23:24, End: 2025-11-12 11:23:24)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:18, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:25...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 20.2005, val_loss: 20.2005, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.6307, val_loss: 8.6307, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4113 seconds (Start: 2025-11-12 11:23:25, End: 2025-11-12 11:23:25)
dist(local, global): 1.87714421749115
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:25...
Function 'evaluate' executed in 0.0260 seconds (Start: 2025-11-12 11:23:25, End: 2025-11-12 11:23:25)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:25...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:23:25, End: 2025-11-12 11:23:25)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:25...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.6117, val_loss: 17.6117, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2447, val_loss: 8.2447, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4410 seconds (Start: 2025-11-12 11:23:25, End: 2025-11-12 11:23:26)
dist(local, global): 1.6171154975891113
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:26...
Function 'evaluate' executed in 0.0332 seconds (Start: 2025-11-12 11:23:26, End: 2025-11-12 11:23:26)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:26...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:23:26, End: 2025-11-12 11:23:26)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:20, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:26...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.9903, val_loss: 14.9903, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2914, val_loss: 8.2914, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4405 seconds (Start: 2025-11-12 11:23:26, End: 2025-11-12 11:23:26)
dist(local, global): 1.4440773725509644
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:26...
Function 'evaluate' executed in 0.0342 seconds (Start: 2025-11-12 11:23:26, End: 2025-11-12 11:23:26)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:26...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:23:26, End: 2025-11-12 11:23:26)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:21, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:26...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.1075, val_loss: 17.1075, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.4161, val_loss: 8.4161, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4123 seconds (Start: 2025-11-12 11:23:26, End: 2025-11-12 11:23:27)
dist(local, global): 1.5784131288528442
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:27...
Function 'evaluate' executed in 0.0315 seconds (Start: 2025-11-12 11:23:27, End: 2025-11-12 11:23:27)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:27...
Function 'evaluate_shared_test' executed in 0.0043 seconds (Start: 2025-11-12 11:23:27, End: 2025-11-12 11:23:27)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:22, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:27...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.5743, val_loss: 15.5743, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.1545, val_loss: 8.1545, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4448 seconds (Start: 2025-11-12 11:23:27, End: 2025-11-12 11:23:27)
dist(local, global): 1.5744965076446533
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:27...
Function 'evaluate' executed in 0.0308 seconds (Start: 2025-11-12 11:23:27, End: 2025-11-12 11:23:27)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:27...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:23:27, End: 2025-11-12 11:23:27)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:28...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 18.8459, val_loss: 18.8459, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3238, val_loss: 8.3238, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4114 seconds (Start: 2025-11-12 11:23:28, End: 2025-11-12 11:23:28)
dist(local, global): 1.7683448791503906
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:28...
Function 'evaluate' executed in 0.0261 seconds (Start: 2025-11-12 11:23:28, End: 2025-11-12 11:23:28)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:28...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:23:28, End: 2025-11-12 11:23:28)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:24, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:28...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 24.4120, val_loss: 24.4120, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8888, val_loss: 8.8888, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4147 seconds (Start: 2025-11-12 11:23:28, End: 2025-11-12 11:23:29)
dist(local, global): 2.030369758605957
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:29...
Function 'evaluate' executed in 0.0287 seconds (Start: 2025-11-12 11:23:29, End: 2025-11-12 11:23:29)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:29...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:23:29, End: 2025-11-12 11:23:29)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:25, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:29...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 8.4126, val_loss: 8.4126, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.4773, val_loss: 4.4773, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4445 seconds (Start: 2025-11-12 11:23:29, End: 2025-11-12 11:23:29)
dist(local, global): 1.102496862411499
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:29...
Function 'evaluate' executed in 0.0193 seconds (Start: 2025-11-12 11:23:29, End: 2025-11-12 11:23:29)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:29...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:23:29, End: 2025-11-12 11:23:29)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:30...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 7.2043, val_loss: 7.2043, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.3042, val_loss: 2.3042, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4358 seconds (Start: 2025-11-12 11:23:30, End: 2025-11-12 11:23:30)
dist(local, global): 2.0564627647399902
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:30...
Function 'evaluate' executed in 0.0438 seconds (Start: 2025-11-12 11:23:30, End: 2025-11-12 11:23:30)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:30...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:23:30, End: 2025-11-12 11:23:30)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:31...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 8.2017, val_loss: 8.2017, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.8311, val_loss: 2.8311, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4809 seconds (Start: 2025-11-12 11:23:31, End: 2025-11-12 11:23:31)
dist(local, global): 1.9444376230239868
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:31...
Function 'evaluate' executed in 0.0330 seconds (Start: 2025-11-12 11:23:31, End: 2025-11-12 11:23:31)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:31...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:23:31, End: 2025-11-12 11:23:31)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])

*** server_epoch:0, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:32...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.3300, val_loss: 17.3300, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 10.4400, val_loss: 10.4400, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4076 seconds (Start: 2025-11-12 11:23:32, End: 2025-11-12 11:23:32)
dist(local, global): 5.823461532592773
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:32...
Function 'evaluate' executed in 0.0251 seconds (Start: 2025-11-12 11:23:32, End: 2025-11-12 11:23:32)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:32...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:23:32, End: 2025-11-12 11:23:32)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:33...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.5788, val_loss: 12.5788, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.1956, val_loss: 9.1956, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4517 seconds (Start: 2025-11-12 11:23:33, End: 2025-11-12 11:23:33)
dist(local, global): 1.8220014572143555
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:33...
Function 'evaluate' executed in 0.0312 seconds (Start: 2025-11-12 11:23:33, End: 2025-11-12 11:23:33)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:33...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:23:33, End: 2025-11-12 11:23:33)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:3, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:34...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 11.9741, val_loss: 11.9741, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.7791, val_loss: 8.7791, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4473 seconds (Start: 2025-11-12 11:23:34, End: 2025-11-12 11:23:34)
dist(local, global): 1.8884315490722656
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:34...
Function 'evaluate' executed in 0.0295 seconds (Start: 2025-11-12 11:23:34, End: 2025-11-12 11:23:34)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:34...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:23:34, End: 2025-11-12 11:23:34)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:4, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:34...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 11.9397, val_loss: 11.9397, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8339, val_loss: 8.8339, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4124 seconds (Start: 2025-11-12 11:23:34, End: 2025-11-12 11:23:35)
dist(local, global): 1.6536369323730469
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:35...
Function 'evaluate' executed in 0.0284 seconds (Start: 2025-11-12 11:23:35, End: 2025-11-12 11:23:35)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:35...
Function 'evaluate_shared_test' executed in 0.0045 seconds (Start: 2025-11-12 11:23:35, End: 2025-11-12 11:23:35)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:36...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.2251, val_loss: 12.2251, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.6578, val_loss: 8.6578, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4789 seconds (Start: 2025-11-12 11:23:36, End: 2025-11-12 11:23:37)
dist(local, global): 1.6145676374435425
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:37...
Function 'evaluate' executed in 0.0369 seconds (Start: 2025-11-12 11:23:37, End: 2025-11-12 11:23:37)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:37...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:23:37, End: 2025-11-12 11:23:37)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:37...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.4551, val_loss: 13.4551, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.4957, val_loss: 8.4957, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4470 seconds (Start: 2025-11-12 11:23:37, End: 2025-11-12 11:23:38)
dist(local, global): 1.6088166236877441
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:38...
Function 'evaluate' executed in 0.0308 seconds (Start: 2025-11-12 11:23:38, End: 2025-11-12 11:23:38)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:38...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:23:38, End: 2025-11-12 11:23:38)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:11, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:39...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.6520, val_loss: 14.6520, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.5103, val_loss: 8.5103, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4470 seconds (Start: 2025-11-12 11:23:39, End: 2025-11-12 11:23:39)
dist(local, global): 1.7565875053405762
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:39...
Function 'evaluate' executed in 0.0307 seconds (Start: 2025-11-12 11:23:39, End: 2025-11-12 11:23:39)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:39...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:23:39, End: 2025-11-12 11:23:39)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:13, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:40...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.4499, val_loss: 14.4499, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2843, val_loss: 8.2843, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4454 seconds (Start: 2025-11-12 11:23:40, End: 2025-11-12 11:23:40)
dist(local, global): 1.5754456520080566
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:40...
Function 'evaluate' executed in 0.0302 seconds (Start: 2025-11-12 11:23:40, End: 2025-11-12 11:23:40)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:40...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:23:40, End: 2025-11-12 11:23:40)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:40...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.0007, val_loss: 14.0007, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2010, val_loss: 8.2010, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4066 seconds (Start: 2025-11-12 11:23:40, End: 2025-11-12 11:23:41)
dist(local, global): 1.5397270917892456
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:41...
Function 'evaluate' executed in 0.0231 seconds (Start: 2025-11-12 11:23:41, End: 2025-11-12 11:23:41)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:41...
Function 'evaluate_shared_test' executed in 0.0032 seconds (Start: 2025-11-12 11:23:41, End: 2025-11-12 11:23:41)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:15, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:41...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.2009, val_loss: 14.2009, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2603, val_loss: 8.2603, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4431 seconds (Start: 2025-11-12 11:23:41, End: 2025-11-12 11:23:41)
dist(local, global): 1.5023062229156494
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:41...
Function 'evaluate' executed in 0.0322 seconds (Start: 2025-11-12 11:23:41, End: 2025-11-12 11:23:42)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:42...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:23:42, End: 2025-11-12 11:23:42)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:42...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.4830, val_loss: 15.4830, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3223, val_loss: 8.3223, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4798 seconds (Start: 2025-11-12 11:23:42, End: 2025-11-12 11:23:42)
dist(local, global): 1.625028133392334
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:42...
Function 'evaluate' executed in 0.0359 seconds (Start: 2025-11-12 11:23:42, End: 2025-11-12 11:23:42)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:42...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:23:42, End: 2025-11-12 11:23:42)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:17, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:42...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.1004, val_loss: 17.1004, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.1966, val_loss: 8.1966, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4089 seconds (Start: 2025-11-12 11:23:42, End: 2025-11-12 11:23:43)
dist(local, global): 1.6649279594421387
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:43...
Function 'evaluate' executed in 0.0269 seconds (Start: 2025-11-12 11:23:43, End: 2025-11-12 11:23:43)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:43...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:23:43, End: 2025-11-12 11:23:43)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:44...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 18.3382, val_loss: 18.3382, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2773, val_loss: 8.2773, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4833 seconds (Start: 2025-11-12 11:23:44, End: 2025-11-12 11:23:44)
dist(local, global): 1.784018874168396
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:44...
Function 'evaluate' executed in 0.0322 seconds (Start: 2025-11-12 11:23:44, End: 2025-11-12 11:23:44)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:44...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:23:44, End: 2025-11-12 11:23:44)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:20, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:44...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 20.1587, val_loss: 20.1587, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.4174, val_loss: 8.4174, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4693 seconds (Start: 2025-11-12 11:23:44, End: 2025-11-12 11:23:45)
dist(local, global): 1.7353190183639526
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:45...
Function 'evaluate' executed in 0.0349 seconds (Start: 2025-11-12 11:23:45, End: 2025-11-12 11:23:45)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:45...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:23:45, End: 2025-11-12 11:23:45)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:46...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 23.8356, val_loss: 23.8356, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.9504, val_loss: 8.9504, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4068 seconds (Start: 2025-11-12 11:23:46, End: 2025-11-12 11:23:47)
dist(local, global): 1.8207166194915771
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:47...
Function 'evaluate' executed in 0.0285 seconds (Start: 2025-11-12 11:23:47, End: 2025-11-12 11:23:47)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:47...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:23:47, End: 2025-11-12 11:23:47)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:24, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:47...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 23.9736, val_loss: 23.9736, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.9496, val_loss: 8.9496, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4099 seconds (Start: 2025-11-12 11:23:47, End: 2025-11-12 11:23:47)
dist(local, global): 1.912558674812317
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:47...
Function 'evaluate' executed in 0.0271 seconds (Start: 2025-11-12 11:23:47, End: 2025-11-12 11:23:47)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:47...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:23:47, End: 2025-11-12 11:23:47)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:26, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:48...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 22.3176, val_loss: 22.3176, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.6370, val_loss: 8.6370, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4112 seconds (Start: 2025-11-12 11:23:48, End: 2025-11-12 11:23:48)
dist(local, global): 1.8816297054290771
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:48...
Function 'evaluate' executed in 0.0259 seconds (Start: 2025-11-12 11:23:48, End: 2025-11-12 11:23:48)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:48...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:23:48, End: 2025-11-12 11:23:48)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:48...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 25.3746, val_loss: 25.3746, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.0819, val_loss: 9.0819, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4128 seconds (Start: 2025-11-12 11:23:48, End: 2025-11-12 11:23:49)
dist(local, global): 1.9263994693756104
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:49...
Function 'evaluate' executed in 0.0274 seconds (Start: 2025-11-12 11:23:49, End: 2025-11-12 11:23:49)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:49...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:23:49, End: 2025-11-12 11:23:49)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:49...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 22.6065, val_loss: 22.6065, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8558, val_loss: 8.8558, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4398 seconds (Start: 2025-11-12 11:23:49, End: 2025-11-12 11:23:49)
dist(local, global): 1.8093839883804321
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:49...
Function 'evaluate' executed in 0.0339 seconds (Start: 2025-11-12 11:23:49, End: 2025-11-12 11:23:50)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:50...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:23:50, End: 2025-11-12 11:23:50)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])

*** server_epoch:0, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:50...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.2170, val_loss: 17.2170, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 10.2760, val_loss: 10.2760, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3819 seconds (Start: 2025-11-12 11:23:50, End: 2025-11-12 11:23:51)
dist(local, global): 5.191389560699463
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:51...
Function 'evaluate' executed in 0.0232 seconds (Start: 2025-11-12 11:23:51, End: 2025-11-12 11:23:51)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:51...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:23:51, End: 2025-11-12 11:23:51)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:1, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:51...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.5979, val_loss: 12.5979, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8203, val_loss: 8.8203, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4114 seconds (Start: 2025-11-12 11:23:51, End: 2025-11-12 11:23:51)
dist(local, global): 1.93976891040802
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:51...
Function 'evaluate' executed in 0.0275 seconds (Start: 2025-11-12 11:23:51, End: 2025-11-12 11:23:51)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:51...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:23:51, End: 2025-11-12 11:23:51)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:51...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.0694, val_loss: 13.0694, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.9228, val_loss: 8.9228, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4824 seconds (Start: 2025-11-12 11:23:51, End: 2025-11-12 11:23:52)
dist(local, global): 1.5753850936889648
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:52...
Function 'evaluate' executed in 0.0345 seconds (Start: 2025-11-12 11:23:52, End: 2025-11-12 11:23:52)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:52...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:23:52, End: 2025-11-12 11:23:52)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:4, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:53...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.2149, val_loss: 12.2149, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.4663, val_loss: 8.4663, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3636 seconds (Start: 2025-11-12 11:23:53, End: 2025-11-12 11:23:53)
dist(local, global): 1.6838394403457642
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:53...
Function 'evaluate' executed in 0.0162 seconds (Start: 2025-11-12 11:23:53, End: 2025-11-12 11:23:53)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:53...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:23:53, End: 2025-11-12 11:23:53)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:5, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:53...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.0813, val_loss: 12.0813, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3989, val_loss: 8.3989, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4459 seconds (Start: 2025-11-12 11:23:53, End: 2025-11-12 11:23:54)
dist(local, global): 1.5829672813415527
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:54...
Function 'evaluate' executed in 0.0294 seconds (Start: 2025-11-12 11:23:54, End: 2025-11-12 11:23:54)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:54...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:23:54, End: 2025-11-12 11:23:54)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:6, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:54...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.2020, val_loss: 13.2020, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.4535, val_loss: 8.4535, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4098 seconds (Start: 2025-11-12 11:23:54, End: 2025-11-12 11:23:54)
dist(local, global): 1.6468257904052734
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:54...
Function 'evaluate' executed in 0.0273 seconds (Start: 2025-11-12 11:23:54, End: 2025-11-12 11:23:54)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:54...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:23:54, End: 2025-11-12 11:23:54)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:54...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.4932, val_loss: 12.4932, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.0575, val_loss: 8.0575, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4449 seconds (Start: 2025-11-12 11:23:54, End: 2025-11-12 11:23:55)
dist(local, global): 1.4830461740493774
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:55...
Function 'evaluate' executed in 0.0316 seconds (Start: 2025-11-12 11:23:55, End: 2025-11-12 11:23:55)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:55...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:23:55, End: 2025-11-12 11:23:55)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:8, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:55...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.7404, val_loss: 12.7404, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.8942, val_loss: 7.8942, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4445 seconds (Start: 2025-11-12 11:23:55, End: 2025-11-12 11:23:56)
dist(local, global): 1.4496381282806396
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:56...
Function 'evaluate' executed in 0.0298 seconds (Start: 2025-11-12 11:23:56, End: 2025-11-12 11:23:56)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:56...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:23:56, End: 2025-11-12 11:23:56)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:56...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.8951, val_loss: 12.8951, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.1304, val_loss: 8.1304, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4102 seconds (Start: 2025-11-12 11:23:56, End: 2025-11-12 11:23:56)
dist(local, global): 1.4227159023284912
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:56...
Function 'evaluate' executed in 0.0282 seconds (Start: 2025-11-12 11:23:56, End: 2025-11-12 11:23:56)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:56...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:23:56, End: 2025-11-12 11:23:56)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:12, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:58...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.7830, val_loss: 14.7830, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.9051, val_loss: 7.9051, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4073 seconds (Start: 2025-11-12 11:23:58, End: 2025-11-12 11:23:58)
dist(local, global): 1.458944320678711
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:58...
Function 'evaluate' executed in 0.0302 seconds (Start: 2025-11-12 11:23:58, End: 2025-11-12 11:23:58)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:58...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:23:58, End: 2025-11-12 11:23:58)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:59...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.6304, val_loss: 13.6304, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.7482, val_loss: 7.7482, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4418 seconds (Start: 2025-11-12 11:23:59, End: 2025-11-12 11:23:59)
dist(local, global): 1.3546770811080933
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:23:59...
Function 'evaluate' executed in 0.0307 seconds (Start: 2025-11-12 11:23:59, End: 2025-11-12 11:23:59)
Function 'evaluate_shared_test starts at 2025-11-12 11:23:59...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:23:59, End: 2025-11-12 11:23:59)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:15, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:23:59...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.2771, val_loss: 15.2771, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.5412, val_loss: 7.5412, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4489 seconds (Start: 2025-11-12 11:23:59, End: 2025-11-12 11:24:00)
dist(local, global): 1.4470971822738647
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:00...
Function 'evaluate' executed in 0.0287 seconds (Start: 2025-11-12 11:24:00, End: 2025-11-12 11:24:00)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:00...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:24:00, End: 2025-11-12 11:24:00)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:00...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.6155, val_loss: 15.6155, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.6368, val_loss: 7.6368, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4096 seconds (Start: 2025-11-12 11:24:00, End: 2025-11-12 11:24:00)
dist(local, global): 1.443078637123108
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:00...
Function 'evaluate' executed in 0.0268 seconds (Start: 2025-11-12 11:24:00, End: 2025-11-12 11:24:00)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:00...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:00, End: 2025-11-12 11:24:00)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:17, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:01...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.5662, val_loss: 15.5662, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.7099, val_loss: 7.7099, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4444 seconds (Start: 2025-11-12 11:24:01, End: 2025-11-12 11:24:01)
dist(local, global): 1.471975564956665
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:01...
Function 'evaluate' executed in 0.0265 seconds (Start: 2025-11-12 11:24:01, End: 2025-11-12 11:24:01)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:01...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:24:01, End: 2025-11-12 11:24:01)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:18, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:01...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.9123, val_loss: 15.9123, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.6003, val_loss: 7.6003, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4827 seconds (Start: 2025-11-12 11:24:01, End: 2025-11-12 11:24:02)
dist(local, global): 1.5425989627838135
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:02...
Function 'evaluate' executed in 0.0334 seconds (Start: 2025-11-12 11:24:02, End: 2025-11-12 11:24:02)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:02...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:24:02, End: 2025-11-12 11:24:02)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:02...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.8419, val_loss: 17.8419, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.8630, val_loss: 7.8630, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4828 seconds (Start: 2025-11-12 11:24:02, End: 2025-11-12 11:24:02)
dist(local, global): 1.5744690895080566
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:02...
Function 'evaluate' executed in 0.0344 seconds (Start: 2025-11-12 11:24:02, End: 2025-11-12 11:24:02)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:02...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:02, End: 2025-11-12 11:24:02)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:20, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:03...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 16.5567, val_loss: 16.5567, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.7068, val_loss: 7.7068, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4436 seconds (Start: 2025-11-12 11:24:03, End: 2025-11-12 11:24:03)
dist(local, global): 1.492486834526062
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:03...
Function 'evaluate' executed in 0.0280 seconds (Start: 2025-11-12 11:24:03, End: 2025-11-12 11:24:03)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:03...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:03, End: 2025-11-12 11:24:03)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:04...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.6038, val_loss: 12.6038, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.6449, val_loss: 4.6449, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4292 seconds (Start: 2025-11-12 11:24:04, End: 2025-11-12 11:24:05)
dist(local, global): 1.1126266717910767
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:05...
Function 'evaluate' executed in 0.0149 seconds (Start: 2025-11-12 11:24:05, End: 2025-11-12 11:24:05)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:05...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:24:05, End: 2025-11-12 11:24:05)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:25, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:06...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.7861, val_loss: 12.7861, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4.8195, val_loss: 4.8195, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4081 seconds (Start: 2025-11-12 11:24:06, End: 2025-11-12 11:24:06)
dist(local, global): 1.1674491167068481
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:06...
Function 'evaluate' executed in 0.0192 seconds (Start: 2025-11-12 11:24:06, End: 2025-11-12 11:24:06)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:06...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:24:06, End: 2025-11-12 11:24:06)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:26, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:06...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4.8849, val_loss: 4.8849, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.0947, val_loss: 2.0947, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3743 seconds (Start: 2025-11-12 11:24:06, End: 2025-11-12 11:24:07)
dist(local, global): 1.2776364088058472
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:07...
Function 'evaluate' executed in 0.0258 seconds (Start: 2025-11-12 11:24:07, End: 2025-11-12 11:24:07)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:07...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:24:07, End: 2025-11-12 11:24:07)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:07...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 8.0663, val_loss: 8.0663, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.4785, val_loss: 2.4785, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4823 seconds (Start: 2025-11-12 11:24:07, End: 2025-11-12 11:24:07)
dist(local, global): 0.9086804986000061
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:07...
Function 'evaluate' executed in 0.0325 seconds (Start: 2025-11-12 11:24:07, End: 2025-11-12 11:24:07)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:07...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:24:07, End: 2025-11-12 11:24:07)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:08...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2.5314, val_loss: 2.5314, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 0.8528, val_loss: 0.8528, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4122 seconds (Start: 2025-11-12 11:24:08, End: 2025-11-12 11:24:08)
dist(local, global): 1.2597969770431519
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:08...
Function 'evaluate' executed in 0.0269 seconds (Start: 2025-11-12 11:24:08, End: 2025-11-12 11:24:08)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:08...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:24:08, End: 2025-11-12 11:24:08)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:29, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:08...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4.6075, val_loss: 4.6075, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1.1122, val_loss: 1.1122, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4453 seconds (Start: 2025-11-12 11:24:08, End: 2025-11-12 11:24:09)
dist(local, global): 0.9881353378295898
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:09...
Function 'evaluate' executed in 0.0313 seconds (Start: 2025-11-12 11:24:09, End: 2025-11-12 11:24:09)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:09...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:24:09, End: 2025-11-12 11:24:09)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])

*** server_epoch:0, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:09...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.3172, val_loss: 17.3172, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 11.3820, val_loss: 11.3820, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4128 seconds (Start: 2025-11-12 11:24:09, End: 2025-11-12 11:24:09)
dist(local, global): 4.945093154907227
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:09...
Function 'evaluate' executed in 0.0276 seconds (Start: 2025-11-12 11:24:09, End: 2025-11-12 11:24:09)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:09...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:24:09, End: 2025-11-12 11:24:09)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:1, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:09...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9.8274, val_loss: 9.8274, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6.6742, val_loss: 6.6742, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4074 seconds (Start: 2025-11-12 11:24:09, End: 2025-11-12 11:24:10)
dist(local, global): 2.7726361751556396
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:10...
Function 'evaluate' executed in 0.0316 seconds (Start: 2025-11-12 11:24:10, End: 2025-11-12 11:24:10)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:10...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:24:10, End: 2025-11-12 11:24:10)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:10...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.1064, val_loss: 10.1064, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6.7700, val_loss: 6.7700, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3771 seconds (Start: 2025-11-12 11:24:10, End: 2025-11-12 11:24:10)
dist(local, global): 2.022005558013916
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:10...
Function 'evaluate' executed in 0.0240 seconds (Start: 2025-11-12 11:24:10, End: 2025-11-12 11:24:10)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:10...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:24:10, End: 2025-11-12 11:24:10)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:3, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:10...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.9564, val_loss: 10.9564, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.2403, val_loss: 7.2403, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4430 seconds (Start: 2025-11-12 11:24:10, End: 2025-11-12 11:24:11)
dist(local, global): 1.817660927772522
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:11...
Function 'evaluate' executed in 0.0310 seconds (Start: 2025-11-12 11:24:11, End: 2025-11-12 11:24:11)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:11...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:24:11, End: 2025-11-12 11:24:11)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:4, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:11...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.7304, val_loss: 10.7304, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.1472, val_loss: 7.1472, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4443 seconds (Start: 2025-11-12 11:24:11, End: 2025-11-12 11:24:12)
dist(local, global): 1.897181510925293
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:12...
Function 'evaluate' executed in 0.0310 seconds (Start: 2025-11-12 11:24:12, End: 2025-11-12 11:24:12)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:12...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:24:12, End: 2025-11-12 11:24:12)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:5, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:12...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.7612, val_loss: 10.7612, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7.2492, val_loss: 7.2492, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3767 seconds (Start: 2025-11-12 11:24:12, End: 2025-11-12 11:24:12)
dist(local, global): 1.9731755256652832
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:12...
Function 'evaluate' executed in 0.0217 seconds (Start: 2025-11-12 11:24:12, End: 2025-11-12 11:24:12)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:12...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:24:12, End: 2025-11-12 11:24:12)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:6, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:12...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.6067, val_loss: 10.6067, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6.7795, val_loss: 6.7795, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4109 seconds (Start: 2025-11-12 11:24:12, End: 2025-11-12 11:24:13)
dist(local, global): 2.077023983001709
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:13...
Function 'evaluate' executed in 0.0264 seconds (Start: 2025-11-12 11:24:13, End: 2025-11-12 11:24:13)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:13...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:24:13, End: 2025-11-12 11:24:13)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:13...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 11.3302, val_loss: 11.3302, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6.7807, val_loss: 6.7807, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4118 seconds (Start: 2025-11-12 11:24:13, End: 2025-11-12 11:24:13)
dist(local, global): 1.7411119937896729
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:13...
Function 'evaluate' executed in 0.0266 seconds (Start: 2025-11-12 11:24:13, End: 2025-11-12 11:24:13)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:13...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:13, End: 2025-11-12 11:24:13)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:8, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:13...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.8057, val_loss: 10.8057, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6.3823, val_loss: 6.3823, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4443 seconds (Start: 2025-11-12 11:24:13, End: 2025-11-12 11:24:14)
dist(local, global): 1.6707364320755005
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:14...
Function 'evaluate' executed in 0.0334 seconds (Start: 2025-11-12 11:24:14, End: 2025-11-12 11:24:14)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:14...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:24:14, End: 2025-11-12 11:24:14)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:14...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.7372, val_loss: 10.7372, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6.4365, val_loss: 6.4365, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4419 seconds (Start: 2025-11-12 11:24:14, End: 2025-11-12 11:24:15)
dist(local, global): 1.652570366859436
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:15...
Function 'evaluate' executed in 0.0316 seconds (Start: 2025-11-12 11:24:15, End: 2025-11-12 11:24:15)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:15...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:24:15, End: 2025-11-12 11:24:15)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:10, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:15...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 11.0801, val_loss: 11.0801, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6.5964, val_loss: 6.5964, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4057 seconds (Start: 2025-11-12 11:24:15, End: 2025-11-12 11:24:15)
dist(local, global): 1.6830886602401733
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:15...
Function 'evaluate' executed in 0.0306 seconds (Start: 2025-11-12 11:24:15, End: 2025-11-12 11:24:15)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:15...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:24:15, End: 2025-11-12 11:24:15)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:12, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:16...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 11.8918, val_loss: 11.8918, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6.6114, val_loss: 6.6114, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4146 seconds (Start: 2025-11-12 11:24:16, End: 2025-11-12 11:24:16)
dist(local, global): 1.4245940446853638
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:16...
Function 'evaluate' executed in 0.0272 seconds (Start: 2025-11-12 11:24:16, End: 2025-11-12 11:24:16)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:16...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:24:16, End: 2025-11-12 11:24:16)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:13, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:17...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.2459, val_loss: 12.2459, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6.3098, val_loss: 6.3098, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4463 seconds (Start: 2025-11-12 11:24:17, End: 2025-11-12 11:24:17)
dist(local, global): 1.3140565156936646
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:17...
Function 'evaluate' executed in 0.0326 seconds (Start: 2025-11-12 11:24:17, End: 2025-11-12 11:24:17)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:17...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:17, End: 2025-11-12 11:24:17)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:17...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 6.0168, val_loss: 6.0168, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.2036, val_loss: 3.2036, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4443 seconds (Start: 2025-11-12 11:24:17, End: 2025-11-12 11:24:18)
dist(local, global): 1.6301648616790771
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:18...
Function 'evaluate' executed in 0.0322 seconds (Start: 2025-11-12 11:24:18, End: 2025-11-12 11:24:18)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:18...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:24:18, End: 2025-11-12 11:24:18)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:15, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:18...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 8.7528, val_loss: 8.7528, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.8870, val_loss: 3.8870, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4456 seconds (Start: 2025-11-12 11:24:18, End: 2025-11-12 11:24:18)
dist(local, global): 1.6409138441085815
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:18...
Function 'evaluate' executed in 0.0299 seconds (Start: 2025-11-12 11:24:18, End: 2025-11-12 11:24:18)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:18...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:24:18, End: 2025-11-12 11:24:18)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:19...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3.5307, val_loss: 3.5307, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1.4147, val_loss: 1.4147, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4667 seconds (Start: 2025-11-12 11:24:19, End: 2025-11-12 11:24:19)
dist(local, global): 1.704742431640625
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:19...
Function 'evaluate' executed in 0.0142 seconds (Start: 2025-11-12 11:24:19, End: 2025-11-12 11:24:19)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:19...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:24:19, End: 2025-11-12 11:24:19)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:17, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:19...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 5.9459, val_loss: 5.9459, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1.9402, val_loss: 1.9402, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3737 seconds (Start: 2025-11-12 11:24:19, End: 2025-11-12 11:24:20)
dist(local, global): 1.7255967855453491
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:20...
Function 'evaluate' executed in 0.0261 seconds (Start: 2025-11-12 11:24:20, End: 2025-11-12 11:24:20)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:20...
Function 'evaluate_shared_test' executed in 0.0045 seconds (Start: 2025-11-12 11:24:20, End: 2025-11-12 11:24:20)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:18, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:20...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 6.9518, val_loss: 6.9518, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.1943, val_loss: 2.1943, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4087 seconds (Start: 2025-11-12 11:24:20, End: 2025-11-12 11:24:20)
dist(local, global): 1.504177212715149
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:20...
Function 'evaluate' executed in 0.0322 seconds (Start: 2025-11-12 11:24:20, End: 2025-11-12 11:24:20)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:20...
Function 'evaluate_shared_test' executed in 0.0042 seconds (Start: 2025-11-12 11:24:20, End: 2025-11-12 11:24:20)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:20...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2.0621, val_loss: 2.0621, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 0.6061, val_loss: 0.6061, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4466 seconds (Start: 2025-11-12 11:24:20, End: 2025-11-12 11:24:21)
dist(local, global): 1.5934202671051025
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:21...
Function 'evaluate' executed in 0.0302 seconds (Start: 2025-11-12 11:24:21, End: 2025-11-12 11:24:21)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:21...
Function 'evaluate_shared_test' executed in 0.0041 seconds (Start: 2025-11-12 11:24:21, End: 2025-11-12 11:24:21)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:21, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:22...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 5.4710, val_loss: 5.4710, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1.3288, val_loss: 1.3288, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4486 seconds (Start: 2025-11-12 11:24:22, End: 2025-11-12 11:24:22)
dist(local, global): 1.6068350076675415
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:22...
Function 'evaluate' executed in 0.0296 seconds (Start: 2025-11-12 11:24:22, End: 2025-11-12 11:24:22)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:22...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:24:22, End: 2025-11-12 11:24:22)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:22, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:22...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 6.0138, val_loss: 6.0138, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1.4547, val_loss: 1.4547, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4101 seconds (Start: 2025-11-12 11:24:22, End: 2025-11-12 11:24:23)
dist(local, global): 1.3347764015197754
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:23...
Function 'evaluate' executed in 0.0265 seconds (Start: 2025-11-12 11:24:23, End: 2025-11-12 11:24:23)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:23...
Function 'evaluate_shared_test' executed in 0.0041 seconds (Start: 2025-11-12 11:24:23, End: 2025-11-12 11:24:23)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:23...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1.3566, val_loss: 1.3566, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 0.3435, val_loss: 0.3435, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4092 seconds (Start: 2025-11-12 11:24:23, End: 2025-11-12 11:24:23)
dist(local, global): 1.4430559873580933
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:23...
Function 'evaluate' executed in 0.0279 seconds (Start: 2025-11-12 11:24:23, End: 2025-11-12 11:24:23)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:23...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:24:23, End: 2025-11-12 11:24:23)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:24, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:23...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3.6198, val_loss: 3.6198, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 0.6944, val_loss: 0.6944, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4124 seconds (Start: 2025-11-12 11:24:23, End: 2025-11-12 11:24:24)
dist(local, global): 1.371008276939392
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:24...
Function 'evaluate' executed in 0.0272 seconds (Start: 2025-11-12 11:24:24, End: 2025-11-12 11:24:24)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:24...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:24, End: 2025-11-12 11:24:24)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:25, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:24...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4.4203, val_loss: 4.4203, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 0.7641, val_loss: 0.7641, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4133 seconds (Start: 2025-11-12 11:24:24, End: 2025-11-12 11:24:24)
dist(local, global): 1.0308643579483032
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:24...
Function 'evaluate' executed in 0.0266 seconds (Start: 2025-11-12 11:24:24, End: 2025-11-12 11:24:24)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:24...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:24:24, End: 2025-11-12 11:24:24)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:26, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:25...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 0.9314, val_loss: 0.9314, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 0.2527, val_loss: 0.2527, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4815 seconds (Start: 2025-11-12 11:24:25, End: 2025-11-12 11:24:25)
dist(local, global): 1.0374350547790527
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:25...
Function 'evaluate' executed in 0.0337 seconds (Start: 2025-11-12 11:24:25, End: 2025-11-12 11:24:25)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:25...
Function 'evaluate_shared_test' executed in 0.0041 seconds (Start: 2025-11-12 11:24:25, End: 2025-11-12 11:24:25)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:25...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2.7413, val_loss: 2.7413, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 0.3658, val_loss: 0.3658, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4407 seconds (Start: 2025-11-12 11:24:25, End: 2025-11-12 11:24:26)
dist(local, global): 0.9935873746871948
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:26...
Function 'evaluate' executed in 0.0391 seconds (Start: 2025-11-12 11:24:26, End: 2025-11-12 11:24:26)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:26...
Function 'evaluate_shared_test' executed in 0.0050 seconds (Start: 2025-11-12 11:24:26, End: 2025-11-12 11:24:26)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:26...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3.6823, val_loss: 3.6823, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 0.4096, val_loss: 0.4096, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4117 seconds (Start: 2025-11-12 11:24:26, End: 2025-11-12 11:24:26)
dist(local, global): 0.8178750872612
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:26...
Function 'evaluate' executed in 0.0245 seconds (Start: 2025-11-12 11:24:26, End: 2025-11-12 11:24:26)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:26...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:24:26, End: 2025-11-12 11:24:26)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:29, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:26...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 0.6749, val_loss: 0.6749, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 0.1881, val_loss: 0.1881, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4030 seconds (Start: 2025-11-12 11:24:26, End: 2025-11-12 11:24:27)
dist(local, global): 0.9354752898216248
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:27...
Function 'evaluate' executed in 0.0207 seconds (Start: 2025-11-12 11:24:27, End: 2025-11-12 11:24:27)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:27...
Function 'evaluate_shared_test' executed in 0.0032 seconds (Start: 2025-11-12 11:24:27, End: 2025-11-12 11:24:27)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])

*** server_epoch:0, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:27...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.3673, val_loss: 17.3673, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 10.3480, val_loss: 10.3480, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4461 seconds (Start: 2025-11-12 11:24:27, End: 2025-11-12 11:24:27)
dist(local, global): 5.757251262664795
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:27...
Function 'evaluate' executed in 0.0300 seconds (Start: 2025-11-12 11:24:27, End: 2025-11-12 11:24:27)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:27...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:27, End: 2025-11-12 11:24:27)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:1, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:28...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.0232, val_loss: 13.0232, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.0996, val_loss: 9.0996, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4819 seconds (Start: 2025-11-12 11:24:28, End: 2025-11-12 11:24:28)
dist(local, global): 2.1170907020568848
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:28...
Function 'evaluate' executed in 0.0322 seconds (Start: 2025-11-12 11:24:28, End: 2025-11-12 11:24:28)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:28...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:24:28, End: 2025-11-12 11:24:28)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:28...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.5946, val_loss: 12.5946, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.0899, val_loss: 9.0899, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4467 seconds (Start: 2025-11-12 11:24:28, End: 2025-11-12 11:24:29)
dist(local, global): 1.6723525524139404
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:29...
Function 'evaluate' executed in 0.0293 seconds (Start: 2025-11-12 11:24:29, End: 2025-11-12 11:24:29)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:29...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:29, End: 2025-11-12 11:24:29)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:3, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:29...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.2570, val_loss: 12.2570, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8961, val_loss: 8.8961, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4133 seconds (Start: 2025-11-12 11:24:29, End: 2025-11-12 11:24:29)
dist(local, global): 1.6376112699508667
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:29...
Function 'evaluate' executed in 0.0328 seconds (Start: 2025-11-12 11:24:29, End: 2025-11-12 11:24:29)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:29...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:29, End: 2025-11-12 11:24:29)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:5, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:30...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.9962, val_loss: 12.9962, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.0790, val_loss: 9.0790, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4129 seconds (Start: 2025-11-12 11:24:30, End: 2025-11-12 11:24:31)
dist(local, global): 1.5119314193725586
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:31...
Function 'evaluate' executed in 0.0290 seconds (Start: 2025-11-12 11:24:31, End: 2025-11-12 11:24:31)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:31...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:24:31, End: 2025-11-12 11:24:31)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:6, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:31...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.0523, val_loss: 12.0523, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.7586, val_loss: 8.7586, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4444 seconds (Start: 2025-11-12 11:24:31, End: 2025-11-12 11:24:31)
dist(local, global): 1.5729255676269531
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:31...
Function 'evaluate' executed in 0.0266 seconds (Start: 2025-11-12 11:24:31, End: 2025-11-12 11:24:31)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:31...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:31, End: 2025-11-12 11:24:31)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:31...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.7381, val_loss: 12.7381, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.6602, val_loss: 8.6602, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4460 seconds (Start: 2025-11-12 11:24:31, End: 2025-11-12 11:24:32)
dist(local, global): 1.5613665580749512
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:32...
Function 'evaluate' executed in 0.0299 seconds (Start: 2025-11-12 11:24:32, End: 2025-11-12 11:24:32)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:32...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:24:32, End: 2025-11-12 11:24:32)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:8, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:32...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.5748, val_loss: 13.5748, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.7463, val_loss: 8.7463, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4491 seconds (Start: 2025-11-12 11:24:32, End: 2025-11-12 11:24:33)
dist(local, global): 1.6065855026245117
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:33...
Function 'evaluate' executed in 0.0302 seconds (Start: 2025-11-12 11:24:33, End: 2025-11-12 11:24:33)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:33...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:24:33, End: 2025-11-12 11:24:33)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:33...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.0129, val_loss: 13.0129, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.5534, val_loss: 8.5534, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3766 seconds (Start: 2025-11-12 11:24:33, End: 2025-11-12 11:24:33)
dist(local, global): 1.4664108753204346
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:33...
Function 'evaluate' executed in 0.0237 seconds (Start: 2025-11-12 11:24:33, End: 2025-11-12 11:24:33)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:33...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:24:33, End: 2025-11-12 11:24:33)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:10, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:33...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.2089, val_loss: 14.2089, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3250, val_loss: 8.3250, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3779 seconds (Start: 2025-11-12 11:24:33, End: 2025-11-12 11:24:34)
dist(local, global): 1.5426276922225952
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:34...
Function 'evaluate' executed in 0.0252 seconds (Start: 2025-11-12 11:24:34, End: 2025-11-12 11:24:34)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:34...
Function 'evaluate_shared_test' executed in 0.0043 seconds (Start: 2025-11-12 11:24:34, End: 2025-11-12 11:24:34)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:11, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:34...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.0985, val_loss: 13.0985, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3916, val_loss: 8.3916, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4400 seconds (Start: 2025-11-12 11:24:34, End: 2025-11-12 11:24:34)
dist(local, global): 1.3588391542434692
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:34...
Function 'evaluate' executed in 0.0377 seconds (Start: 2025-11-12 11:24:34, End: 2025-11-12 11:24:34)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:34...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:24:34, End: 2025-11-12 11:24:34)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:12, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:34...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.3568, val_loss: 14.3568, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.4051, val_loss: 8.4051, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4470 seconds (Start: 2025-11-12 11:24:34, End: 2025-11-12 11:24:35)
dist(local, global): 1.4472604990005493
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:35...
Function 'evaluate' executed in 0.0292 seconds (Start: 2025-11-12 11:24:35, End: 2025-11-12 11:24:35)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:35...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:24:35, End: 2025-11-12 11:24:35)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:13, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:35...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.2256, val_loss: 13.2256, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3791, val_loss: 8.3791, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4072 seconds (Start: 2025-11-12 11:24:35, End: 2025-11-12 11:24:35)
dist(local, global): 1.3889778852462769
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:35...
Function 'evaluate' executed in 0.0318 seconds (Start: 2025-11-12 11:24:35, End: 2025-11-12 11:24:35)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:35...
Function 'evaluate_shared_test' executed in 0.0045 seconds (Start: 2025-11-12 11:24:35, End: 2025-11-12 11:24:35)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:36...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.0245, val_loss: 14.0245, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3596, val_loss: 8.3596, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4092 seconds (Start: 2025-11-12 11:24:36, End: 2025-11-12 11:24:36)
dist(local, global): 1.4559954404830933
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:36...
Function 'evaluate' executed in 0.0261 seconds (Start: 2025-11-12 11:24:36, End: 2025-11-12 11:24:36)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:36...
Function 'evaluate_shared_test' executed in 0.0044 seconds (Start: 2025-11-12 11:24:36, End: 2025-11-12 11:24:36)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:37...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.8309, val_loss: 15.8309, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.5630, val_loss: 8.5630, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4049 seconds (Start: 2025-11-12 11:24:37, End: 2025-11-12 11:24:37)
dist(local, global): 1.6316720247268677
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:37...
Function 'evaluate' executed in 0.0320 seconds (Start: 2025-11-12 11:24:37, End: 2025-11-12 11:24:37)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:37...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:37, End: 2025-11-12 11:24:37)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:17, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:37...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 16.6430, val_loss: 16.6430, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.6383, val_loss: 8.6383, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4102 seconds (Start: 2025-11-12 11:24:37, End: 2025-11-12 11:24:38)
dist(local, global): 1.6789746284484863
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:38...
Function 'evaluate' executed in 0.0278 seconds (Start: 2025-11-12 11:24:38, End: 2025-11-12 11:24:38)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:38...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:24:38, End: 2025-11-12 11:24:38)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:39...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 19.0748, val_loss: 19.0748, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.5637, val_loss: 8.5637, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4447 seconds (Start: 2025-11-12 11:24:39, End: 2025-11-12 11:24:39)
dist(local, global): 1.7164175510406494
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:39...
Function 'evaluate' executed in 0.0299 seconds (Start: 2025-11-12 11:24:39, End: 2025-11-12 11:24:39)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:39...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:24:39, End: 2025-11-12 11:24:39)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:20, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:39...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 20.8445, val_loss: 20.8445, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8208, val_loss: 8.8208, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4478 seconds (Start: 2025-11-12 11:24:39, End: 2025-11-12 11:24:40)
dist(local, global): 1.83782160282135
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:40...
Function 'evaluate' executed in 0.0290 seconds (Start: 2025-11-12 11:24:40, End: 2025-11-12 11:24:40)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:40...
Function 'evaluate_shared_test' executed in 0.0041 seconds (Start: 2025-11-12 11:24:40, End: 2025-11-12 11:24:40)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:22, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:40...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 21.7209, val_loss: 21.7209, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.9703, val_loss: 8.9703, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4446 seconds (Start: 2025-11-12 11:24:40, End: 2025-11-12 11:24:41)
dist(local, global): 1.9470568895339966
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:41...
Function 'evaluate' executed in 0.0309 seconds (Start: 2025-11-12 11:24:41, End: 2025-11-12 11:24:41)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:41...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:24:41, End: 2025-11-12 11:24:41)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:41...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 25.0561, val_loss: 25.0561, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.3582, val_loss: 9.3582, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4790 seconds (Start: 2025-11-12 11:24:41, End: 2025-11-12 11:24:42)
dist(local, global): 1.998334288597107
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:42...
Function 'evaluate' executed in 0.0320 seconds (Start: 2025-11-12 11:24:42, End: 2025-11-12 11:24:42)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:42...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:24:42, End: 2025-11-12 11:24:42)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:24, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:42...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 25.2183, val_loss: 25.2183, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.3654, val_loss: 9.3654, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4226 seconds (Start: 2025-11-12 11:24:42, End: 2025-11-12 11:24:42)
dist(local, global): 1.9450023174285889
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:42...
Function 'evaluate' executed in 0.0113 seconds (Start: 2025-11-12 11:24:42, End: 2025-11-12 11:24:42)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:42...
Function 'evaluate_shared_test' executed in 0.0032 seconds (Start: 2025-11-12 11:24:42, End: 2025-11-12 11:24:42)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:25, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:42...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 23.8403, val_loss: 23.8403, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.4296, val_loss: 9.4296, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4830 seconds (Start: 2025-11-12 11:24:42, End: 2025-11-12 11:24:43)
dist(local, global): 2.0187196731567383
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:43...
Function 'evaluate' executed in 0.0314 seconds (Start: 2025-11-12 11:24:43, End: 2025-11-12 11:24:43)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:43...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:24:43, End: 2025-11-12 11:24:43)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:26, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:43...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 25.7743, val_loss: 25.7743, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.4893, val_loss: 9.4893, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3886 seconds (Start: 2025-11-12 11:24:43, End: 2025-11-12 11:24:44)
dist(local, global): 2.0465540885925293
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:44...
Function 'evaluate' executed in 0.0106 seconds (Start: 2025-11-12 11:24:44, End: 2025-11-12 11:24:44)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:44...
Function 'evaluate_shared_test' executed in 0.0032 seconds (Start: 2025-11-12 11:24:44, End: 2025-11-12 11:24:44)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:44...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 27.0181, val_loss: 27.0181, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.3752, val_loss: 9.3752, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4114 seconds (Start: 2025-11-12 11:24:44, End: 2025-11-12 11:24:44)
dist(local, global): 2.095719337463379
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:44...
Function 'evaluate' executed in 0.0275 seconds (Start: 2025-11-12 11:24:44, End: 2025-11-12 11:24:44)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:44...
Function 'evaluate_shared_test' executed in 0.0044 seconds (Start: 2025-11-12 11:24:44, End: 2025-11-12 11:24:44)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:44...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 28.3203, val_loss: 28.3203, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.4349, val_loss: 9.4349, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.5176 seconds (Start: 2025-11-12 11:24:44, End: 2025-11-12 11:24:45)
dist(local, global): 2.0900638103485107
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:45...
Function 'evaluate' executed in 0.0402 seconds (Start: 2025-11-12 11:24:45, End: 2025-11-12 11:24:45)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:45...
Function 'evaluate_shared_test' executed in 0.0050 seconds (Start: 2025-11-12 11:24:45, End: 2025-11-12 11:24:45)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:29, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:45...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 28.3493, val_loss: 28.3493, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.9046, val_loss: 9.9046, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3737 seconds (Start: 2025-11-12 11:24:45, End: 2025-11-12 11:24:45)
dist(local, global): 2.1668224334716797
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:45...
Function 'evaluate' executed in 0.0207 seconds (Start: 2025-11-12 11:24:45, End: 2025-11-12 11:24:45)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:45...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:24:45, End: 2025-11-12 11:24:45)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:1, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:46...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.6102, val_loss: 12.6102, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.1242, val_loss: 9.1242, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4118 seconds (Start: 2025-11-12 11:24:46, End: 2025-11-12 11:24:47)
dist(local, global): 2.2483503818511963
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:47...
Function 'evaluate' executed in 0.0269 seconds (Start: 2025-11-12 11:24:47, End: 2025-11-12 11:24:47)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:47...
Function 'evaluate_shared_test' executed in 0.0042 seconds (Start: 2025-11-12 11:24:47, End: 2025-11-12 11:24:47)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:47...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.0239, val_loss: 12.0239, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.0053, val_loss: 9.0053, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4125 seconds (Start: 2025-11-12 11:24:47, End: 2025-11-12 11:24:47)
dist(local, global): 1.5687891244888306
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:47...
Function 'evaluate' executed in 0.0272 seconds (Start: 2025-11-12 11:24:47, End: 2025-11-12 11:24:47)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:47...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:24:47, End: 2025-11-12 11:24:47)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:3, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:47...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 11.9352, val_loss: 11.9352, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8287, val_loss: 8.8287, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4510 seconds (Start: 2025-11-12 11:24:47, End: 2025-11-12 11:24:48)
dist(local, global): 1.5686109066009521
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:48...
Function 'evaluate' executed in 0.0302 seconds (Start: 2025-11-12 11:24:48, End: 2025-11-12 11:24:48)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:48...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:48, End: 2025-11-12 11:24:48)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:5, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:48...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.4332, val_loss: 12.4332, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8042, val_loss: 8.8042, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4400 seconds (Start: 2025-11-12 11:24:48, End: 2025-11-12 11:24:49)
dist(local, global): 1.4698939323425293
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:49...
Function 'evaluate' executed in 0.0366 seconds (Start: 2025-11-12 11:24:49, End: 2025-11-12 11:24:49)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:49...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:24:49, End: 2025-11-12 11:24:49)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:6, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:49...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.7596, val_loss: 12.7596, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8099, val_loss: 8.8099, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4461 seconds (Start: 2025-11-12 11:24:49, End: 2025-11-12 11:24:50)
dist(local, global): 1.54476797580719
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:50...
Function 'evaluate' executed in 0.0326 seconds (Start: 2025-11-12 11:24:50, End: 2025-11-12 11:24:50)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:50...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:24:50, End: 2025-11-12 11:24:50)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:50...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.7865, val_loss: 12.7865, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8400, val_loss: 8.8400, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4093 seconds (Start: 2025-11-12 11:24:50, End: 2025-11-12 11:24:50)
dist(local, global): 1.464471459388733
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:50...
Function 'evaluate' executed in 0.0246 seconds (Start: 2025-11-12 11:24:50, End: 2025-11-12 11:24:50)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:50...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:24:50, End: 2025-11-12 11:24:50)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:8, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:50...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.4019, val_loss: 12.4019, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.6349, val_loss: 8.6349, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4449 seconds (Start: 2025-11-12 11:24:50, End: 2025-11-12 11:24:51)
dist(local, global): 1.45806086063385
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:51...
Function 'evaluate' executed in 0.0293 seconds (Start: 2025-11-12 11:24:51, End: 2025-11-12 11:24:51)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:51...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:24:51, End: 2025-11-12 11:24:51)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:51...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.3278, val_loss: 13.3278, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.4994, val_loss: 8.4994, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4112 seconds (Start: 2025-11-12 11:24:51, End: 2025-11-12 11:24:51)
dist(local, global): 1.4813274145126343
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:51...
Function 'evaluate' executed in 0.0266 seconds (Start: 2025-11-12 11:24:51, End: 2025-11-12 11:24:51)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:51...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:24:51, End: 2025-11-12 11:24:51)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:10, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:52...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.1992, val_loss: 13.1992, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.5003, val_loss: 8.5003, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4811 seconds (Start: 2025-11-12 11:24:52, End: 2025-11-12 11:24:52)
dist(local, global): 1.4187766313552856
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:52...
Function 'evaluate' executed in 0.0340 seconds (Start: 2025-11-12 11:24:52, End: 2025-11-12 11:24:52)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:52...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:52, End: 2025-11-12 11:24:52)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:11, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:52...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.0809, val_loss: 13.0809, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2167, val_loss: 8.2167, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4135 seconds (Start: 2025-11-12 11:24:52, End: 2025-11-12 11:24:53)
dist(local, global): 1.4845333099365234
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:53...
Function 'evaluate' executed in 0.0274 seconds (Start: 2025-11-12 11:24:53, End: 2025-11-12 11:24:53)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:53...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:53, End: 2025-11-12 11:24:53)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:12, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:53...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.7809, val_loss: 12.7809, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2644, val_loss: 8.2644, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4121 seconds (Start: 2025-11-12 11:24:53, End: 2025-11-12 11:24:53)
dist(local, global): 1.4703198671340942
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:53...
Function 'evaluate' executed in 0.0268 seconds (Start: 2025-11-12 11:24:53, End: 2025-11-12 11:24:53)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:53...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:24:53, End: 2025-11-12 11:24:53)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:54...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.9391, val_loss: 13.9391, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2345, val_loss: 8.2345, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4134 seconds (Start: 2025-11-12 11:24:54, End: 2025-11-12 11:24:54)
dist(local, global): 1.5080500841140747
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:54...
Function 'evaluate' executed in 0.0278 seconds (Start: 2025-11-12 11:24:54, End: 2025-11-12 11:24:54)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:54...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:24:54, End: 2025-11-12 11:24:54)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:15, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:55...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 14.2688, val_loss: 14.2688, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.1242, val_loss: 8.1242, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4434 seconds (Start: 2025-11-12 11:24:55, End: 2025-11-12 11:24:55)
dist(local, global): 1.4984840154647827
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:55...
Function 'evaluate' executed in 0.0301 seconds (Start: 2025-11-12 11:24:55, End: 2025-11-12 11:24:55)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:55...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:24:55, End: 2025-11-12 11:24:55)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:55...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.3180, val_loss: 15.3180, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.1598, val_loss: 8.1598, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4138 seconds (Start: 2025-11-12 11:24:55, End: 2025-11-12 11:24:56)
dist(local, global): 1.614691972732544
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:56...
Function 'evaluate' executed in 0.0286 seconds (Start: 2025-11-12 11:24:56, End: 2025-11-12 11:24:56)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:56...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:24:56, End: 2025-11-12 11:24:56)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:18, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:57...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.1310, val_loss: 15.1310, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.1438, val_loss: 8.1438, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4071 seconds (Start: 2025-11-12 11:24:57, End: 2025-11-12 11:24:57)
dist(local, global): 1.5574771165847778
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:57...
Function 'evaluate' executed in 0.0282 seconds (Start: 2025-11-12 11:24:57, End: 2025-11-12 11:24:57)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:57...
Function 'evaluate_shared_test' executed in 0.0045 seconds (Start: 2025-11-12 11:24:57, End: 2025-11-12 11:24:57)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:57...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.9569, val_loss: 15.9569, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.0276, val_loss: 8.0276, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4476 seconds (Start: 2025-11-12 11:24:57, End: 2025-11-12 11:24:58)
dist(local, global): 1.6449086666107178
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:58...
Function 'evaluate' executed in 0.0336 seconds (Start: 2025-11-12 11:24:58, End: 2025-11-12 11:24:58)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:58...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:24:58, End: 2025-11-12 11:24:58)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:20, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:58...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.3022, val_loss: 17.3022, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.2584, val_loss: 8.2584, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4410 seconds (Start: 2025-11-12 11:24:58, End: 2025-11-12 11:24:58)
dist(local, global): 1.6992231607437134
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:58...
Function 'evaluate' executed in 0.0336 seconds (Start: 2025-11-12 11:24:58, End: 2025-11-12 11:24:58)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:58...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:58, End: 2025-11-12 11:24:58)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:21, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:58...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.7738, val_loss: 17.7738, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.4055, val_loss: 8.4055, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3989 seconds (Start: 2025-11-12 11:24:58, End: 2025-11-12 11:24:59)
dist(local, global): 1.7356879711151123
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:59...
Function 'evaluate' executed in 0.0362 seconds (Start: 2025-11-12 11:24:59, End: 2025-11-12 11:24:59)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:59...
Function 'evaluate_shared_test' executed in 0.0043 seconds (Start: 2025-11-12 11:24:59, End: 2025-11-12 11:24:59)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:22, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:24:59...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.6816, val_loss: 17.6816, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.3950, val_loss: 8.3950, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4421 seconds (Start: 2025-11-12 11:24:59, End: 2025-11-12 11:24:59)
dist(local, global): 1.6809207201004028
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:24:59...
Function 'evaluate' executed in 0.0314 seconds (Start: 2025-11-12 11:24:59, End: 2025-11-12 11:24:59)
Function 'evaluate_shared_test starts at 2025-11-12 11:24:59...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:24:59, End: 2025-11-12 11:24:59)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:00...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 19.4271, val_loss: 19.4271, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.5117, val_loss: 8.5117, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4108 seconds (Start: 2025-11-12 11:25:00, End: 2025-11-12 11:25:00)
dist(local, global): 1.7075815200805664
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:00...
Function 'evaluate' executed in 0.0242 seconds (Start: 2025-11-12 11:25:00, End: 2025-11-12 11:25:00)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:00...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:25:00, End: 2025-11-12 11:25:00)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:24, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:00...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 20.3812, val_loss: 20.3812, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.4594, val_loss: 8.4594, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4104 seconds (Start: 2025-11-12 11:25:00, End: 2025-11-12 11:25:01)
dist(local, global): 1.8273102045059204
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:01...
Function 'evaluate' executed in 0.0309 seconds (Start: 2025-11-12 11:25:01, End: 2025-11-12 11:25:01)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:01...
Function 'evaluate_shared_test' executed in 0.0045 seconds (Start: 2025-11-12 11:25:01, End: 2025-11-12 11:25:01)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:25, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:01...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 21.8858, val_loss: 21.8858, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8.8116, val_loss: 8.8116, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4485 seconds (Start: 2025-11-12 11:25:01, End: 2025-11-12 11:25:01)
dist(local, global): 1.8472007513046265
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:01...
Function 'evaluate' executed in 0.0285 seconds (Start: 2025-11-12 11:25:01, End: 2025-11-12 11:25:01)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:01...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:25:01, End: 2025-11-12 11:25:01)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:02...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 22.5184, val_loss: 22.5184, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.0263, val_loss: 9.0263, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4419 seconds (Start: 2025-11-12 11:25:02, End: 2025-11-12 11:25:02)
dist(local, global): 1.8735628128051758
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:02...
Function 'evaluate' executed in 0.0311 seconds (Start: 2025-11-12 11:25:02, End: 2025-11-12 11:25:02)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:02...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:25:02, End: 2025-11-12 11:25:02)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:03...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 23.9382, val_loss: 23.9382, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.1290, val_loss: 9.1290, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4841 seconds (Start: 2025-11-12 11:25:03, End: 2025-11-12 11:25:03)
dist(local, global): 1.9761284589767456
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:03...
Function 'evaluate' executed in 0.0359 seconds (Start: 2025-11-12 11:25:03, End: 2025-11-12 11:25:03)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:03...
Function 'evaluate_shared_test' executed in 0.0041 seconds (Start: 2025-11-12 11:25:03, End: 2025-11-12 11:25:03)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])

*** server_epoch:0, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:04...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.1905, val_loss: 17.1905, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 10.3879, val_loss: 10.3879, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4097 seconds (Start: 2025-11-12 11:25:04, End: 2025-11-12 11:25:04)
dist(local, global): 5.18562650680542
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:04...
Function 'evaluate' executed in 0.0263 seconds (Start: 2025-11-12 11:25:04, End: 2025-11-12 11:25:04)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:04...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:25:04, End: 2025-11-12 11:25:04)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:05...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 67230.2687, val_loss: 67230.2687, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 47481.5947, val_loss: 47481.5947, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4428 seconds (Start: 2025-11-12 11:25:05, End: 2025-11-12 11:25:05)
dist(local, global): 5.047546863555908
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:05...
Function 'evaluate' executed in 0.0322 seconds (Start: 2025-11-12 11:25:05, End: 2025-11-12 11:25:05)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:05...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:25:05, End: 2025-11-12 11:25:05)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:3, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:06...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 79204.4093, val_loss: 79204.4093, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 52813.0369, val_loss: 52813.0369, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4592 seconds (Start: 2025-11-12 11:25:06, End: 2025-11-12 11:25:06)
dist(local, global): 5.240128040313721
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:06...
Function 'evaluate' executed in 0.0291 seconds (Start: 2025-11-12 11:25:06, End: 2025-11-12 11:25:06)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:06...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:25:06, End: 2025-11-12 11:25:06)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:4, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:06...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 322289.9707, val_loss: 322289.9707, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 229841.9292, val_loss: 229841.9292, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4085 seconds (Start: 2025-11-12 11:25:06, End: 2025-11-12 11:25:07)
dist(local, global): 6.1577911376953125
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:07...
Function 'evaluate' executed in 0.0285 seconds (Start: 2025-11-12 11:25:07, End: 2025-11-12 11:25:07)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:07...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:25:07, End: 2025-11-12 11:25:07)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:08...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 742560.0947, val_loss: 742560.0947, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 533476.8115, val_loss: 533476.8115, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4761 seconds (Start: 2025-11-12 11:25:08, End: 2025-11-12 11:25:09)
dist(local, global): 6.638388156890869
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:09...
Function 'evaluate' executed in 0.0354 seconds (Start: 2025-11-12 11:25:09, End: 2025-11-12 11:25:09)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:09...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:25:09, End: 2025-11-12 11:25:09)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:09...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1178207.5801, val_loss: 1178207.5801, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 917154.7090, val_loss: 917154.7090, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4450 seconds (Start: 2025-11-12 11:25:09, End: 2025-11-12 11:25:10)
dist(local, global): 5.983870983123779
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:10...
Function 'evaluate' executed in 0.0294 seconds (Start: 2025-11-12 11:25:10, End: 2025-11-12 11:25:10)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:10...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:25:10, End: 2025-11-12 11:25:10)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:11, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:11...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 978046.2754, val_loss: 978046.2754, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 878878.1943, val_loss: 878878.1943, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4479 seconds (Start: 2025-11-12 11:25:11, End: 2025-11-12 11:25:11)
dist(local, global): 4.026484966278076
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:11...
Function 'evaluate' executed in 0.0265 seconds (Start: 2025-11-12 11:25:11, End: 2025-11-12 11:25:11)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:11...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:25:11, End: 2025-11-12 11:25:11)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:13, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:12...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1289457.9434, val_loss: 1289457.9434, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1095400.8125, val_loss: 1095400.8125, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4455 seconds (Start: 2025-11-12 11:25:12, End: 2025-11-12 11:25:12)
dist(local, global): 4.910549163818359
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:12...
Function 'evaluate' executed in 0.0311 seconds (Start: 2025-11-12 11:25:12, End: 2025-11-12 11:25:12)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:12...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:25:12, End: 2025-11-12 11:25:12)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:13...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2566196.5703, val_loss: 2566196.5703, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2043022.2070, val_loss: 2043022.2070, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4111 seconds (Start: 2025-11-12 11:25:13, End: 2025-11-12 11:25:13)
dist(local, global): 6.324211120605469
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:13...
Function 'evaluate' executed in 0.0277 seconds (Start: 2025-11-12 11:25:13, End: 2025-11-12 11:25:13)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:13...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:25:13, End: 2025-11-12 11:25:13)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:15, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:13...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3164084.5039, val_loss: 3164084.5039, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2593778.8359, val_loss: 2593778.8359, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4411 seconds (Start: 2025-11-12 11:25:13, End: 2025-11-12 11:25:14)
dist(local, global): 6.122195720672607
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:14...
Function 'evaluate' executed in 0.0321 seconds (Start: 2025-11-12 11:25:14, End: 2025-11-12 11:25:14)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:14...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:25:14, End: 2025-11-12 11:25:14)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:14...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2397690.4844, val_loss: 2397690.4844, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2095907.0625, val_loss: 2095907.0625, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4798 seconds (Start: 2025-11-12 11:25:14, End: 2025-11-12 11:25:14)
dist(local, global): 5.005588054656982
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:14...
Function 'evaluate' executed in 0.0340 seconds (Start: 2025-11-12 11:25:14, End: 2025-11-12 11:25:14)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:14...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:25:14, End: 2025-11-12 11:25:14)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:17, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:14...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2021891.4160, val_loss: 2021891.4160, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1771701.5098, val_loss: 1771701.5098, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4151 seconds (Start: 2025-11-12 11:25:14, End: 2025-11-12 11:25:15)
dist(local, global): 4.778351783752441
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:15...
Function 'evaluate' executed in 0.0264 seconds (Start: 2025-11-12 11:25:15, End: 2025-11-12 11:25:15)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:15...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:25:15, End: 2025-11-12 11:25:15)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:15...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3208895.1328, val_loss: 3208895.1328, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2775727.0000, val_loss: 2775727.0000, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4806 seconds (Start: 2025-11-12 11:25:15, End: 2025-11-12 11:25:16)
dist(local, global): 5.183995246887207
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:16...
Function 'evaluate' executed in 0.0329 seconds (Start: 2025-11-12 11:25:16, End: 2025-11-12 11:25:16)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:16...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:25:16, End: 2025-11-12 11:25:16)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:20, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:16...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3126228.5703, val_loss: 3126228.5703, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2826364.4062, val_loss: 2826364.4062, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4809 seconds (Start: 2025-11-12 11:25:16, End: 2025-11-12 11:25:17)
dist(local, global): 4.821956157684326
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:17...
Function 'evaluate' executed in 0.0340 seconds (Start: 2025-11-12 11:25:17, End: 2025-11-12 11:25:17)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:17...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:25:17, End: 2025-11-12 11:25:17)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:18...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3345728.7422, val_loss: 3345728.7422, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3057540.0547, val_loss: 3057540.0547, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4067 seconds (Start: 2025-11-12 11:25:18, End: 2025-11-12 11:25:18)
dist(local, global): 5.010562896728516
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:18...
Function 'evaluate' executed in 0.0308 seconds (Start: 2025-11-12 11:25:18, End: 2025-11-12 11:25:18)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:18...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:25:18, End: 2025-11-12 11:25:18)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:24, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:19...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2259464.6445, val_loss: 2259464.6445, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2051708.3008, val_loss: 2051708.3008, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4103 seconds (Start: 2025-11-12 11:25:19, End: 2025-11-12 11:25:19)
dist(local, global): 5.078159332275391
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:19...
Function 'evaluate' executed in 0.0285 seconds (Start: 2025-11-12 11:25:19, End: 2025-11-12 11:25:19)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:19...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:25:19, End: 2025-11-12 11:25:19)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:26, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:20...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3243242.0625, val_loss: 3243242.0625, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2980433.2969, val_loss: 2980433.2969, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4091 seconds (Start: 2025-11-12 11:25:20, End: 2025-11-12 11:25:20)
dist(local, global): 4.528411865234375
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:20...
Function 'evaluate' executed in 0.0275 seconds (Start: 2025-11-12 11:25:20, End: 2025-11-12 11:25:20)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:20...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:25:20, End: 2025-11-12 11:25:20)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:20...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3581715.3359, val_loss: 3581715.3359, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3221708.7031, val_loss: 3221708.7031, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4093 seconds (Start: 2025-11-12 11:25:20, End: 2025-11-12 11:25:21)
dist(local, global): 4.735019207000732
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:21...
Function 'evaluate' executed in 0.0257 seconds (Start: 2025-11-12 11:25:21, End: 2025-11-12 11:25:21)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:21...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:25:21, End: 2025-11-12 11:25:21)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:21...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3056811.4219, val_loss: 3056811.4219, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2824194.5898, val_loss: 2824194.5898, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4503 seconds (Start: 2025-11-12 11:25:21, End: 2025-11-12 11:25:21)
dist(local, global): 4.222311496734619
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:21...
Function 'evaluate' executed in 0.0327 seconds (Start: 2025-11-12 11:25:21, End: 2025-11-12 11:25:21)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:21...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:25:21, End: 2025-11-12 11:25:21)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])

*** server_epoch:0, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:22...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.2209, val_loss: 17.2209, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9.5234, val_loss: 9.5234, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3787 seconds (Start: 2025-11-12 11:25:22, End: 2025-11-12 11:25:23)
dist(local, global): 5.4443039894104
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:23...
Function 'evaluate' executed in 0.0209 seconds (Start: 2025-11-12 11:25:23, End: 2025-11-12 11:25:23)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:23...
Function 'evaluate_shared_test' executed in 0.0032 seconds (Start: 2025-11-12 11:25:23, End: 2025-11-12 11:25:23)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:1, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:23...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13517.6680, val_loss: 13517.6680, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9074.5107, val_loss: 9074.5107, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4107 seconds (Start: 2025-11-12 11:25:23, End: 2025-11-12 11:25:23)
dist(local, global): 4.546172618865967
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:23...
Function 'evaluate' executed in 0.0278 seconds (Start: 2025-11-12 11:25:23, End: 2025-11-12 11:25:23)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:23...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:25:23, End: 2025-11-12 11:25:23)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:23...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 116206.2588, val_loss: 116206.2588, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 69957.4049, val_loss: 69957.4049, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4809 seconds (Start: 2025-11-12 11:25:23, End: 2025-11-12 11:25:24)
dist(local, global): 6.086952209472656
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:24...
Function 'evaluate' executed in 0.0348 seconds (Start: 2025-11-12 11:25:24, End: 2025-11-12 11:25:24)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:24...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:25:24, End: 2025-11-12 11:25:24)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:4, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:25...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 211531.9878, val_loss: 211531.9878, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 152110.8408, val_loss: 152110.8408, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3748 seconds (Start: 2025-11-12 11:25:25, End: 2025-11-12 11:25:25)
dist(local, global): 5.480697154998779
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:25...
Function 'evaluate' executed in 0.0249 seconds (Start: 2025-11-12 11:25:25, End: 2025-11-12 11:25:25)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:25...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:25:25, End: 2025-11-12 11:25:25)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:5, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:25...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 397386.4072, val_loss: 397386.4072, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 309107.6270, val_loss: 309107.6270, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4468 seconds (Start: 2025-11-12 11:25:25, End: 2025-11-12 11:25:26)
dist(local, global): 5.299708843231201
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:26...
Function 'evaluate' executed in 0.0326 seconds (Start: 2025-11-12 11:25:26, End: 2025-11-12 11:25:26)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:26...
Function 'evaluate_shared_test' executed in 0.0041 seconds (Start: 2025-11-12 11:25:26, End: 2025-11-12 11:25:26)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:6, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:26...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 471516.5586, val_loss: 471516.5586, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 386908.3477, val_loss: 386908.3477, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4058 seconds (Start: 2025-11-12 11:25:26, End: 2025-11-12 11:25:26)
dist(local, global): 4.911047458648682
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:26...
Function 'evaluate' executed in 0.0305 seconds (Start: 2025-11-12 11:25:26, End: 2025-11-12 11:25:26)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:26...
Function 'evaluate_shared_test' executed in 0.0049 seconds (Start: 2025-11-12 11:25:26, End: 2025-11-12 11:25:26)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:26...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 779224.9180, val_loss: 779224.9180, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 618290.8623, val_loss: 618290.8623, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4493 seconds (Start: 2025-11-12 11:25:26, End: 2025-11-12 11:25:27)
dist(local, global): 5.84063720703125
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:27...
Function 'evaluate' executed in 0.0292 seconds (Start: 2025-11-12 11:25:27, End: 2025-11-12 11:25:27)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:27...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:25:27, End: 2025-11-12 11:25:27)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:8, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:27...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 907038.2949, val_loss: 907038.2949, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 759860.0996, val_loss: 759860.0996, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4423 seconds (Start: 2025-11-12 11:25:27, End: 2025-11-12 11:25:28)
dist(local, global): 5.285507678985596
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:28...
Function 'evaluate' executed in 0.0311 seconds (Start: 2025-11-12 11:25:28, End: 2025-11-12 11:25:28)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:28...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:25:28, End: 2025-11-12 11:25:28)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:28...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 961322.2539, val_loss: 961322.2539, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 811847.0303, val_loss: 811847.0303, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4076 seconds (Start: 2025-11-12 11:25:28, End: 2025-11-12 11:25:28)
dist(local, global): 4.97144079208374
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:28...
Function 'evaluate' executed in 0.0289 seconds (Start: 2025-11-12 11:25:28, End: 2025-11-12 11:25:28)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:28...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:25:28, End: 2025-11-12 11:25:28)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:12, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:30...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2986537.3594, val_loss: 2986537.3594, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2723542.0391, val_loss: 2723542.0391, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4112 seconds (Start: 2025-11-12 11:25:30, End: 2025-11-12 11:25:30)
dist(local, global): 4.752066612243652
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:30...
Function 'evaluate' executed in 0.0278 seconds (Start: 2025-11-12 11:25:30, End: 2025-11-12 11:25:30)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:30...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:25:30, End: 2025-11-12 11:25:30)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:31...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3116075.5859, val_loss: 3116075.5859, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2845247.4492, val_loss: 2845247.4492, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4421 seconds (Start: 2025-11-12 11:25:31, End: 2025-11-12 11:25:31)
dist(local, global): 4.618905544281006
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:31...
Function 'evaluate' executed in 0.0333 seconds (Start: 2025-11-12 11:25:31, End: 2025-11-12 11:25:31)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:31...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:25:31, End: 2025-11-12 11:25:31)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:15, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:31...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4264187.6875, val_loss: 4264187.6875, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3920235.4688, val_loss: 3920235.4688, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4448 seconds (Start: 2025-11-12 11:25:31, End: 2025-11-12 11:25:32)
dist(local, global): 4.660750865936279
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:32...
Function 'evaluate' executed in 0.0315 seconds (Start: 2025-11-12 11:25:32, End: 2025-11-12 11:25:32)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:32...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:25:32, End: 2025-11-12 11:25:32)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:32...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4029156.0703, val_loss: 4029156.0703, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3723882.6250, val_loss: 3723882.6250, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4113 seconds (Start: 2025-11-12 11:25:32, End: 2025-11-12 11:25:32)
dist(local, global): 4.679835319519043
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:32...
Function 'evaluate' executed in 0.0278 seconds (Start: 2025-11-12 11:25:32, End: 2025-11-12 11:25:32)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:32...
Function 'evaluate_shared_test' executed in 0.0046 seconds (Start: 2025-11-12 11:25:32, End: 2025-11-12 11:25:32)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:17, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:33...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4883307.7031, val_loss: 4883307.7031, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4521128.7031, val_loss: 4521128.7031, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4470 seconds (Start: 2025-11-12 11:25:33, End: 2025-11-12 11:25:33)
dist(local, global): 4.624632835388184
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:33...
Function 'evaluate' executed in 0.0284 seconds (Start: 2025-11-12 11:25:33, End: 2025-11-12 11:25:33)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:33...
Function 'evaluate_shared_test' executed in 0.0032 seconds (Start: 2025-11-12 11:25:33, End: 2025-11-12 11:25:33)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:18, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:33...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 6576446.8438, val_loss: 6576446.8438, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6127768.3906, val_loss: 6127768.3906, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4836 seconds (Start: 2025-11-12 11:25:33, End: 2025-11-12 11:25:34)
dist(local, global): 4.609106063842773
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:34...
Function 'evaluate' executed in 0.0287 seconds (Start: 2025-11-12 11:25:34, End: 2025-11-12 11:25:34)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:34...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:25:34, End: 2025-11-12 11:25:34)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:34...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 7659532.7188, val_loss: 7659532.7188, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7149348.4219, val_loss: 7149348.4219, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4857 seconds (Start: 2025-11-12 11:25:34, End: 2025-11-12 11:25:34)
dist(local, global): 4.738224983215332
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:34...
Function 'evaluate' executed in 0.0291 seconds (Start: 2025-11-12 11:25:34, End: 2025-11-12 11:25:34)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:34...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:25:34, End: 2025-11-12 11:25:34)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:20, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:35...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 7685510.8750, val_loss: 7685510.8750, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7162134.5312, val_loss: 7162134.5312, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4451 seconds (Start: 2025-11-12 11:25:35, End: 2025-11-12 11:25:35)
dist(local, global): 4.777717113494873
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:35...
Function 'evaluate' executed in 0.0297 seconds (Start: 2025-11-12 11:25:35, End: 2025-11-12 11:25:35)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:35...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:25:35, End: 2025-11-12 11:25:35)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:36...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 8756354.5938, val_loss: 8756354.5938, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8106342.1406, val_loss: 8106342.1406, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4427 seconds (Start: 2025-11-12 11:25:36, End: 2025-11-12 11:25:37)
dist(local, global): 4.837332248687744
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:37...
Function 'evaluate' executed in 0.0315 seconds (Start: 2025-11-12 11:25:37, End: 2025-11-12 11:25:37)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:37...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:25:37, End: 2025-11-12 11:25:37)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:25, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:38...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10518390.3906, val_loss: 10518390.3906, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9709742.2031, val_loss: 9709742.2031, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4083 seconds (Start: 2025-11-12 11:25:38, End: 2025-11-12 11:25:38)
dist(local, global): 4.884698390960693
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:38...
Function 'evaluate' executed in 0.0246 seconds (Start: 2025-11-12 11:25:38, End: 2025-11-12 11:25:38)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:38...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:25:38, End: 2025-11-12 11:25:38)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:26, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:38...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10090126.2812, val_loss: 10090126.2812, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 9319654.3906, val_loss: 9319654.3906, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3776 seconds (Start: 2025-11-12 11:25:38, End: 2025-11-12 11:25:39)
dist(local, global): 4.890842437744141
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:39...
Function 'evaluate' executed in 0.0200 seconds (Start: 2025-11-12 11:25:39, End: 2025-11-12 11:25:39)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:39...
Function 'evaluate_shared_test' executed in 0.0032 seconds (Start: 2025-11-12 11:25:39, End: 2025-11-12 11:25:39)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:39...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9252411.5625, val_loss: 9252411.5625, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8579196.4141, val_loss: 8579196.4141, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4826 seconds (Start: 2025-11-12 11:25:39, End: 2025-11-12 11:25:39)
dist(local, global): 4.849673748016357
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:39...
Function 'evaluate' executed in 0.0219 seconds (Start: 2025-11-12 11:25:39, End: 2025-11-12 11:25:39)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:39...
Function 'evaluate_shared_test' executed in 0.0032 seconds (Start: 2025-11-12 11:25:39, End: 2025-11-12 11:25:39)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:39...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9445765.2188, val_loss: 9445765.2188, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8736677.8594, val_loss: 8736677.8594, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4125 seconds (Start: 2025-11-12 11:25:39, End: 2025-11-12 11:25:40)
dist(local, global): 4.950536251068115
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:40...
Function 'evaluate' executed in 0.0268 seconds (Start: 2025-11-12 11:25:40, End: 2025-11-12 11:25:40)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:40...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:25:40, End: 2025-11-12 11:25:40)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:29, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:40...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9553906.1875, val_loss: 9553906.1875, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 8796280.9375, val_loss: 8796280.9375, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4457 seconds (Start: 2025-11-12 11:25:40, End: 2025-11-12 11:25:40)
dist(local, global): 5.069807529449463
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:40...
Function 'evaluate' executed in 0.0258 seconds (Start: 2025-11-12 11:25:40, End: 2025-11-12 11:25:40)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:40...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:25:40, End: 2025-11-12 11:25:40)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])

*** server_epoch:0, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:41...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.4101, val_loss: 17.4101, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 10.5062, val_loss: 10.5062, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4126 seconds (Start: 2025-11-12 11:25:41, End: 2025-11-12 11:25:41)
dist(local, global): 5.324922561645508
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:41...
Function 'evaluate' executed in 0.0260 seconds (Start: 2025-11-12 11:25:41, End: 2025-11-12 11:25:41)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:41...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:25:41, End: 2025-11-12 11:25:41)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:1, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:41...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17885.8378, val_loss: 17885.8378, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 11306.5121, val_loss: 11306.5121, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4095 seconds (Start: 2025-11-12 11:25:41, End: 2025-11-12 11:25:42)
dist(local, global): 5.518868446350098
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:42...
Function 'evaluate' executed in 0.0279 seconds (Start: 2025-11-12 11:25:42, End: 2025-11-12 11:25:42)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:42...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:25:42, End: 2025-11-12 11:25:42)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:42...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 27514.4751, val_loss: 27514.4751, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 18694.5150, val_loss: 18694.5150, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3835 seconds (Start: 2025-11-12 11:25:42, End: 2025-11-12 11:25:42)
dist(local, global): 4.867045879364014
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:42...
Function 'evaluate' executed in 0.0245 seconds (Start: 2025-11-12 11:25:42, End: 2025-11-12 11:25:42)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:42...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:25:42, End: 2025-11-12 11:25:42)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:3, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:42...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 116163.4092, val_loss: 116163.4092, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 83358.3893, val_loss: 83358.3893, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4404 seconds (Start: 2025-11-12 11:25:42, End: 2025-11-12 11:25:43)
dist(local, global): 5.288735866546631
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:43...
Function 'evaluate' executed in 0.0320 seconds (Start: 2025-11-12 11:25:43, End: 2025-11-12 11:25:43)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:43...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:25:43, End: 2025-11-12 11:25:43)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:4, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:43...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 127545.7366, val_loss: 127545.7366, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 94581.8865, val_loss: 94581.8865, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4477 seconds (Start: 2025-11-12 11:25:43, End: 2025-11-12 11:25:43)
dist(local, global): 4.8619914054870605
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:43...
Function 'evaluate' executed in 0.0264 seconds (Start: 2025-11-12 11:25:43, End: 2025-11-12 11:25:43)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:43...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:25:43, End: 2025-11-12 11:25:43)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:5, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:44...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 271766.1934, val_loss: 271766.1934, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 189592.4673, val_loss: 189592.4673, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3754 seconds (Start: 2025-11-12 11:25:44, End: 2025-11-12 11:25:44)
dist(local, global): 6.031269073486328
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:44...
Function 'evaluate' executed in 0.0235 seconds (Start: 2025-11-12 11:25:44, End: 2025-11-12 11:25:44)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:44...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:25:44, End: 2025-11-12 11:25:44)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:6, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:44...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 691935.0801, val_loss: 691935.0801, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 508818.4268, val_loss: 508818.4268, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4164 seconds (Start: 2025-11-12 11:25:44, End: 2025-11-12 11:25:44)
dist(local, global): 6.302168369293213
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:44...
Function 'evaluate' executed in 0.0250 seconds (Start: 2025-11-12 11:25:44, End: 2025-11-12 11:25:45)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:45...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:25:45, End: 2025-11-12 11:25:45)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:45...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 428941.1982, val_loss: 428941.1982, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 339721.2656, val_loss: 339721.2656, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4137 seconds (Start: 2025-11-12 11:25:45, End: 2025-11-12 11:25:45)
dist(local, global): 4.878646373748779
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:45...
Function 'evaluate' executed in 0.0259 seconds (Start: 2025-11-12 11:25:45, End: 2025-11-12 11:25:45)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:45...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:25:45, End: 2025-11-12 11:25:45)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:8, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:45...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 663022.3301, val_loss: 663022.3301, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 565458.4365, val_loss: 565458.4365, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4486 seconds (Start: 2025-11-12 11:25:45, End: 2025-11-12 11:25:46)
dist(local, global): 4.894558906555176
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:46...
Function 'evaluate' executed in 0.0293 seconds (Start: 2025-11-12 11:25:46, End: 2025-11-12 11:25:46)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:46...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:25:46, End: 2025-11-12 11:25:46)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:46...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 667817.8398, val_loss: 667817.8398, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 579025.4199, val_loss: 579025.4199, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4453 seconds (Start: 2025-11-12 11:25:46, End: 2025-11-12 11:25:46)
dist(local, global): 4.511515140533447
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:46...
Function 'evaluate' executed in 0.0284 seconds (Start: 2025-11-12 11:25:46, End: 2025-11-12 11:25:46)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:46...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:25:46, End: 2025-11-12 11:25:46)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:10, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:46...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 793558.4619, val_loss: 793558.4619, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 687881.8184, val_loss: 687881.8184, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4188 seconds (Start: 2025-11-12 11:25:46, End: 2025-11-12 11:25:47)
dist(local, global): 4.348712921142578
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:47...
Function 'evaluate' executed in 0.0248 seconds (Start: 2025-11-12 11:25:47, End: 2025-11-12 11:25:47)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:47...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:25:47, End: 2025-11-12 11:25:47)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:12, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:48...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1356142.6992, val_loss: 1356142.6992, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1108226.9551, val_loss: 1108226.9551, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4132 seconds (Start: 2025-11-12 11:25:48, End: 2025-11-12 11:25:48)
dist(local, global): 5.348701000213623
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:48...
Function 'evaluate' executed in 0.0290 seconds (Start: 2025-11-12 11:25:48, End: 2025-11-12 11:25:48)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:48...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:25:48, End: 2025-11-12 11:25:48)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:13, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:48...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1317281.6738, val_loss: 1317281.6738, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1104509.6445, val_loss: 1104509.6445, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4479 seconds (Start: 2025-11-12 11:25:48, End: 2025-11-12 11:25:49)
dist(local, global): 4.992028713226318
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:49...
Function 'evaluate' executed in 0.0291 seconds (Start: 2025-11-12 11:25:49, End: 2025-11-12 11:25:49)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:49...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:25:49, End: 2025-11-12 11:25:49)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:49...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1581448.0020, val_loss: 1581448.0020, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1270193.3945, val_loss: 1270193.3945, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4432 seconds (Start: 2025-11-12 11:25:49, End: 2025-11-12 11:25:49)
dist(local, global): 5.723655700683594
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:49...
Function 'evaluate' executed in 0.0317 seconds (Start: 2025-11-12 11:25:49, End: 2025-11-12 11:25:49)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:49...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:25:49, End: 2025-11-12 11:25:49)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:15, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:50...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3110218.0781, val_loss: 3110218.0781, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2615174.6836, val_loss: 2615174.6836, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4437 seconds (Start: 2025-11-12 11:25:50, End: 2025-11-12 11:25:50)
dist(local, global): 5.9012227058410645
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:50...
Function 'evaluate' executed in 0.0284 seconds (Start: 2025-11-12 11:25:50, End: 2025-11-12 11:25:50)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:50...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:25:50, End: 2025-11-12 11:25:50)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:50...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2837406.1562, val_loss: 2837406.1562, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2385187.3477, val_loss: 2385187.3477, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4817 seconds (Start: 2025-11-12 11:25:50, End: 2025-11-12 11:25:51)
dist(local, global): 5.634570598602295
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:51...
Function 'evaluate' executed in 0.0328 seconds (Start: 2025-11-12 11:25:51, End: 2025-11-12 11:25:51)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:51...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:25:51, End: 2025-11-12 11:25:51)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:17, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:51...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2534044.2344, val_loss: 2534044.2344, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2138429.8887, val_loss: 2138429.8887, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3761 seconds (Start: 2025-11-12 11:25:51, End: 2025-11-12 11:25:51)
dist(local, global): 5.348153591156006
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:51...
Function 'evaluate' executed in 0.0259 seconds (Start: 2025-11-12 11:25:51, End: 2025-11-12 11:25:51)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:51...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:25:51, End: 2025-11-12 11:25:51)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:18, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:51...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2501153.1758, val_loss: 2501153.1758, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2247014.6523, val_loss: 2247014.6523, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4104 seconds (Start: 2025-11-12 11:25:51, End: 2025-11-12 11:25:52)
dist(local, global): 4.352581024169922
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:52...
Function 'evaluate' executed in 0.0291 seconds (Start: 2025-11-12 11:25:52, End: 2025-11-12 11:25:52)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:52...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:25:52, End: 2025-11-12 11:25:52)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:52...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2734747.8203, val_loss: 2734747.8203, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2368456.9453, val_loss: 2368456.9453, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4456 seconds (Start: 2025-11-12 11:25:52, End: 2025-11-12 11:25:52)
dist(local, global): 5.003709316253662
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:52...
Function 'evaluate' executed in 0.0301 seconds (Start: 2025-11-12 11:25:52, End: 2025-11-12 11:25:52)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:52...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:25:52, End: 2025-11-12 11:25:52)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:21, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:53...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3131586.1133, val_loss: 3131586.1133, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2832440.3125, val_loss: 2832440.3125, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4483 seconds (Start: 2025-11-12 11:25:53, End: 2025-11-12 11:25:54)
dist(local, global): 4.703906059265137
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:54...
Function 'evaluate' executed in 0.0292 seconds (Start: 2025-11-12 11:25:54, End: 2025-11-12 11:25:54)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:54...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:25:54, End: 2025-11-12 11:25:54)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:22, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:54...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3600409.3047, val_loss: 3600409.3047, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3274360.5703, val_loss: 3274360.5703, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4072 seconds (Start: 2025-11-12 11:25:54, End: 2025-11-12 11:25:54)
dist(local, global): 4.791798114776611
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:54...
Function 'evaluate' executed in 0.0317 seconds (Start: 2025-11-12 11:25:54, End: 2025-11-12 11:25:54)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:54...
Function 'evaluate_shared_test' executed in 0.0049 seconds (Start: 2025-11-12 11:25:54, End: 2025-11-12 11:25:54)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:54...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4590125.5156, val_loss: 4590125.5156, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4177880.8516, val_loss: 4177880.8516, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4039 seconds (Start: 2025-11-12 11:25:54, End: 2025-11-12 11:25:55)
dist(local, global): 4.901155948638916
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:55...
Function 'evaluate' executed in 0.0216 seconds (Start: 2025-11-12 11:25:55, End: 2025-11-12 11:25:55)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:55...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:25:55, End: 2025-11-12 11:25:55)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:24, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:55...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 5782355.3047, val_loss: 5782355.3047, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5286338.7656, val_loss: 5286338.7656, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4064 seconds (Start: 2025-11-12 11:25:55, End: 2025-11-12 11:25:55)
dist(local, global): 5.16579008102417
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:55...
Function 'evaluate' executed in 0.0306 seconds (Start: 2025-11-12 11:25:55, End: 2025-11-12 11:25:55)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:55...
Function 'evaluate_shared_test' executed in 0.0042 seconds (Start: 2025-11-12 11:25:55, End: 2025-11-12 11:25:55)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:25, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:56...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 7737118.1250, val_loss: 7737118.1250, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6977765.0156, val_loss: 6977765.0156, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4111 seconds (Start: 2025-11-12 11:25:56, End: 2025-11-12 11:25:56)
dist(local, global): 5.727286338806152
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:56...
Function 'evaluate' executed in 0.0254 seconds (Start: 2025-11-12 11:25:56, End: 2025-11-12 11:25:56)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:56...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:25:56, End: 2025-11-12 11:25:56)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:26, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:56...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 6480379.4297, val_loss: 6480379.4297, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5879012.9688, val_loss: 5879012.9688, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4843 seconds (Start: 2025-11-12 11:25:56, End: 2025-11-12 11:25:57)
dist(local, global): 5.354315280914307
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:57...
Function 'evaluate' executed in 0.0349 seconds (Start: 2025-11-12 11:25:57, End: 2025-11-12 11:25:57)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:57...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:25:57, End: 2025-11-12 11:25:57)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:57...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 5905720.0312, val_loss: 5905720.0312, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5357157.0547, val_loss: 5357157.0547, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4426 seconds (Start: 2025-11-12 11:25:57, End: 2025-11-12 11:25:57)
dist(local, global): 5.197683811187744
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:57...
Function 'evaluate' executed in 0.0385 seconds (Start: 2025-11-12 11:25:57, End: 2025-11-12 11:25:57)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:57...
Function 'evaluate_shared_test' executed in 0.0049 seconds (Start: 2025-11-12 11:25:57, End: 2025-11-12 11:25:57)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:57...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 6675322.6406, val_loss: 6675322.6406, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6051700.7344, val_loss: 6051700.7344, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4099 seconds (Start: 2025-11-12 11:25:57, End: 2025-11-12 11:25:58)
dist(local, global): 5.6544718742370605
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:58...
Function 'evaluate' executed in 0.0316 seconds (Start: 2025-11-12 11:25:58, End: 2025-11-12 11:25:58)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:58...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:25:58, End: 2025-11-12 11:25:58)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:29, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:58...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 6180007.0625, val_loss: 6180007.0625, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5636901.0859, val_loss: 5636901.0859, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4082 seconds (Start: 2025-11-12 11:25:58, End: 2025-11-12 11:25:58)
dist(local, global): 5.416077613830566
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:58...
Function 'evaluate' executed in 0.0261 seconds (Start: 2025-11-12 11:25:58, End: 2025-11-12 11:25:59)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:59...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:25:59, End: 2025-11-12 11:25:59)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])

*** server_epoch:0, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:59...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.2489, val_loss: 17.2489, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 11.1468, val_loss: 11.1468, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4466 seconds (Start: 2025-11-12 11:25:59, End: 2025-11-12 11:25:59)
dist(local, global): 4.8880839347839355
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:25:59...
Function 'evaluate' executed in 0.0305 seconds (Start: 2025-11-12 11:25:59, End: 2025-11-12 11:25:59)
Function 'evaluate_shared_test starts at 2025-11-12 11:25:59...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:25:59, End: 2025-11-12 11:25:59)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:1, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:25:59...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13846.7541, val_loss: 13846.7541, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6664.4709, val_loss: 6664.4709, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4856 seconds (Start: 2025-11-12 11:25:59, End: 2025-11-12 11:26:00)
dist(local, global): 5.220833778381348
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:00...
Function 'evaluate' executed in 0.0344 seconds (Start: 2025-11-12 11:26:00, End: 2025-11-12 11:26:00)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:00...
Function 'evaluate_shared_test' executed in 0.0044 seconds (Start: 2025-11-12 11:26:00, End: 2025-11-12 11:26:00)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:00...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 16476.4604, val_loss: 16476.4604, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 10617.9465, val_loss: 10617.9465, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4465 seconds (Start: 2025-11-12 11:26:00, End: 2025-11-12 11:26:00)
dist(local, global): 4.47486686706543
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:00...
Function 'evaluate' executed in 0.0311 seconds (Start: 2025-11-12 11:26:00, End: 2025-11-12 11:26:00)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:00...
Function 'evaluate_shared_test' executed in 0.0043 seconds (Start: 2025-11-12 11:26:00, End: 2025-11-12 11:26:00)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:3, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:01...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 61182.0082, val_loss: 61182.0082, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 44133.1973, val_loss: 44133.1973, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4082 seconds (Start: 2025-11-12 11:26:01, End: 2025-11-12 11:26:01)
dist(local, global): 4.9478278160095215
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:01...
Function 'evaluate' executed in 0.0277 seconds (Start: 2025-11-12 11:26:01, End: 2025-11-12 11:26:01)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:01...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:26:01, End: 2025-11-12 11:26:01)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:5, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:02...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 240804.6855, val_loss: 240804.6855, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 190339.7017, val_loss: 190339.7017, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4107 seconds (Start: 2025-11-12 11:26:02, End: 2025-11-12 11:26:02)
dist(local, global): 5.044680595397949
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:02...
Function 'evaluate' executed in 0.0243 seconds (Start: 2025-11-12 11:26:02, End: 2025-11-12 11:26:02)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:02...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:26:02, End: 2025-11-12 11:26:02)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:6, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:02...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 453297.9639, val_loss: 453297.9639, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 382204.7329, val_loss: 382204.7329, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4391 seconds (Start: 2025-11-12 11:26:02, End: 2025-11-12 11:26:03)
dist(local, global): 4.749425888061523
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:03...
Function 'evaluate' executed in 0.0311 seconds (Start: 2025-11-12 11:26:03, End: 2025-11-12 11:26:03)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:03...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:26:03, End: 2025-11-12 11:26:03)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:03...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 354661.2603, val_loss: 354661.2603, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 291119.2617, val_loss: 291119.2617, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4458 seconds (Start: 2025-11-12 11:26:03, End: 2025-11-12 11:26:03)
dist(local, global): 4.535051345825195
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:03...
Function 'evaluate' executed in 0.0309 seconds (Start: 2025-11-12 11:26:03, End: 2025-11-12 11:26:03)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:03...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:26:03, End: 2025-11-12 11:26:03)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:8, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:04...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 695599.8447, val_loss: 695599.8447, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 590235.5840, val_loss: 590235.5840, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4472 seconds (Start: 2025-11-12 11:26:04, End: 2025-11-12 11:26:04)
dist(local, global): 4.892106056213379
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:04...
Function 'evaluate' executed in 0.0306 seconds (Start: 2025-11-12 11:26:04, End: 2025-11-12 11:26:04)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:04...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:26:04, End: 2025-11-12 11:26:04)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:04...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 857734.8350, val_loss: 857734.8350, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 741363.2373, val_loss: 741363.2373, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3803 seconds (Start: 2025-11-12 11:26:04, End: 2025-11-12 11:26:05)
dist(local, global): 4.430480480194092
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:05...
Function 'evaluate' executed in 0.0231 seconds (Start: 2025-11-12 11:26:05, End: 2025-11-12 11:26:05)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:05...
Function 'evaluate_shared_test' executed in 0.0032 seconds (Start: 2025-11-12 11:26:05, End: 2025-11-12 11:26:05)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:10, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:05...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 797325.4023, val_loss: 797325.4023, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 687107.6123, val_loss: 687107.6123, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3782 seconds (Start: 2025-11-12 11:26:05, End: 2025-11-12 11:26:05)
dist(local, global): 4.36491060256958
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:05...
Function 'evaluate' executed in 0.0230 seconds (Start: 2025-11-12 11:26:05, End: 2025-11-12 11:26:05)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:05...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:26:05, End: 2025-11-12 11:26:05)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:11, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:05...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 791816.8643, val_loss: 791816.8643, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 684588.2031, val_loss: 684588.2031, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4424 seconds (Start: 2025-11-12 11:26:05, End: 2025-11-12 11:26:06)
dist(local, global): 4.6726298332214355
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:06...
Function 'evaluate' executed in 0.0323 seconds (Start: 2025-11-12 11:26:06, End: 2025-11-12 11:26:06)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:06...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:26:06, End: 2025-11-12 11:26:06)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:12, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:06...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 852295.3809, val_loss: 852295.3809, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 745369.7188, val_loss: 745369.7188, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4472 seconds (Start: 2025-11-12 11:26:06, End: 2025-11-12 11:26:06)
dist(local, global): 4.475062847137451
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:06...
Function 'evaluate' executed in 0.0295 seconds (Start: 2025-11-12 11:26:06, End: 2025-11-12 11:26:06)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:06...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:26:06, End: 2025-11-12 11:26:06)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:13, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:07...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 949218.8838, val_loss: 949218.8838, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 826853.4199, val_loss: 826853.4199, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4057 seconds (Start: 2025-11-12 11:26:07, End: 2025-11-12 11:26:07)
dist(local, global): 4.484604358673096
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:07...
Function 'evaluate' executed in 0.0380 seconds (Start: 2025-11-12 11:26:07, End: 2025-11-12 11:26:07)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:07...
Function 'evaluate_shared_test' executed in 0.0055 seconds (Start: 2025-11-12 11:26:07, End: 2025-11-12 11:26:07)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:07...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1347690.1562, val_loss: 1347690.1562, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1195730.8613, val_loss: 1195730.8613, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4078 seconds (Start: 2025-11-12 11:26:07, End: 2025-11-12 11:26:08)
dist(local, global): 4.542644500732422
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:08...
Function 'evaluate' executed in 0.0248 seconds (Start: 2025-11-12 11:26:08, End: 2025-11-12 11:26:08)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:08...
Function 'evaluate_shared_test' executed in 0.0043 seconds (Start: 2025-11-12 11:26:08, End: 2025-11-12 11:26:08)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:08...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1905869.3047, val_loss: 1905869.3047, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1671831.2910, val_loss: 1671831.2910, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4095 seconds (Start: 2025-11-12 11:26:08, End: 2025-11-12 11:26:09)
dist(local, global): 4.962419509887695
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:09...
Function 'evaluate' executed in 0.0351 seconds (Start: 2025-11-12 11:26:09, End: 2025-11-12 11:26:09)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:09...
Function 'evaluate_shared_test' executed in 0.0055 seconds (Start: 2025-11-12 11:26:09, End: 2025-11-12 11:26:09)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:17, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:09...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2210176.8438, val_loss: 2210176.8438, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1964302.3691, val_loss: 1964302.3691, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4108 seconds (Start: 2025-11-12 11:26:09, End: 2025-11-12 11:26:09)
dist(local, global): 4.695418357849121
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:09...
Function 'evaluate' executed in 0.0256 seconds (Start: 2025-11-12 11:26:09, End: 2025-11-12 11:26:09)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:09...
Function 'evaluate_shared_test' executed in 0.0044 seconds (Start: 2025-11-12 11:26:09, End: 2025-11-12 11:26:09)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:10...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3309811.1484, val_loss: 3309811.1484, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2937090.6328, val_loss: 2937090.6328, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4456 seconds (Start: 2025-11-12 11:26:10, End: 2025-11-12 11:26:11)
dist(local, global): 4.882526397705078
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:11...
Function 'evaluate' executed in 0.0302 seconds (Start: 2025-11-12 11:26:11, End: 2025-11-12 11:26:11)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:11...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:26:11, End: 2025-11-12 11:26:11)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:20, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:11...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4213399.3672, val_loss: 4213399.3672, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3641094.0352, val_loss: 3641094.0352, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4488 seconds (Start: 2025-11-12 11:26:11, End: 2025-11-12 11:26:11)
dist(local, global): 5.516051292419434
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:11...
Function 'evaluate' executed in 0.0297 seconds (Start: 2025-11-12 11:26:11, End: 2025-11-12 11:26:11)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:11...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:26:11, End: 2025-11-12 11:26:11)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:22, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:12...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4667703.5312, val_loss: 4667703.5312, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4072949.7734, val_loss: 4072949.7734, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4459 seconds (Start: 2025-11-12 11:26:12, End: 2025-11-12 11:26:13)
dist(local, global): 5.334968566894531
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:13...
Function 'evaluate' executed in 0.0298 seconds (Start: 2025-11-12 11:26:13, End: 2025-11-12 11:26:13)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:13...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:26:13, End: 2025-11-12 11:26:13)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:13...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4819414.3516, val_loss: 4819414.3516, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4287831.1289, val_loss: 4287831.1289, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4890 seconds (Start: 2025-11-12 11:26:13, End: 2025-11-12 11:26:13)
dist(local, global): 5.062346935272217
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:13...
Function 'evaluate' executed in 0.0277 seconds (Start: 2025-11-12 11:26:13, End: 2025-11-12 11:26:13)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:13...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:26:13, End: 2025-11-12 11:26:13)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:24, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:13...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4365234.2031, val_loss: 4365234.2031, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3901896.4570, val_loss: 3901896.4570, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4486 seconds (Start: 2025-11-12 11:26:13, End: 2025-11-12 11:26:14)
dist(local, global): 4.8142499923706055
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:14...
Function 'evaluate' executed in 0.0302 seconds (Start: 2025-11-12 11:26:14, End: 2025-11-12 11:26:14)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:14...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:26:14, End: 2025-11-12 11:26:14)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:25, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:14...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 5896445.5547, val_loss: 5896445.5547, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5164483.6016, val_loss: 5164483.6016, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4792 seconds (Start: 2025-11-12 11:26:14, End: 2025-11-12 11:26:14)
dist(local, global): 5.065618515014648
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:14...
Function 'evaluate' executed in 0.0343 seconds (Start: 2025-11-12 11:26:14, End: 2025-11-12 11:26:15)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:15...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:26:15, End: 2025-11-12 11:26:15)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:26, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:15...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 7642539.7266, val_loss: 7642539.7266, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6576413.0781, val_loss: 6576413.0781, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4102 seconds (Start: 2025-11-12 11:26:15, End: 2025-11-12 11:26:15)
dist(local, global): 5.438075542449951
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:15...
Function 'evaluate' executed in 0.0235 seconds (Start: 2025-11-12 11:26:15, End: 2025-11-12 11:26:15)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:15...
Function 'evaluate_shared_test' executed in 0.0033 seconds (Start: 2025-11-12 11:26:15, End: 2025-11-12 11:26:15)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:15...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 6327772.5625, val_loss: 6327772.5625, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5453007.3516, val_loss: 5453007.3516, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4117 seconds (Start: 2025-11-12 11:26:15, End: 2025-11-12 11:26:16)
dist(local, global): 5.256784915924072
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:16...
Function 'evaluate' executed in 0.0291 seconds (Start: 2025-11-12 11:26:16, End: 2025-11-12 11:26:16)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:16...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:26:16, End: 2025-11-12 11:26:16)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:16...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 6285970.2188, val_loss: 6285970.2188, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5540796.7422, val_loss: 5540796.7422, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.5159 seconds (Start: 2025-11-12 11:26:16, End: 2025-11-12 11:26:16)
dist(local, global): 5.108957290649414
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:16...
Function 'evaluate' executed in 0.0383 seconds (Start: 2025-11-12 11:26:16, End: 2025-11-12 11:26:16)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:16...
Function 'evaluate_shared_test' executed in 0.0047 seconds (Start: 2025-11-12 11:26:16, End: 2025-11-12 11:26:16)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:29, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:17...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 5428478.9375, val_loss: 5428478.9375, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4857492.0938, val_loss: 4857492.0938, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.3696 seconds (Start: 2025-11-12 11:26:17, End: 2025-11-12 11:26:17)
dist(local, global): 4.7487077713012695
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:17...
Function 'evaluate' executed in 0.0184 seconds (Start: 2025-11-12 11:26:17, End: 2025-11-12 11:26:17)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:17...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:26:17, End: 2025-11-12 11:26:17)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:1, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:18...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 20918.5425, val_loss: 20918.5425, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 13181.8307, val_loss: 13181.8307, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4122 seconds (Start: 2025-11-12 11:26:18, End: 2025-11-12 11:26:18)
dist(local, global): 4.913022041320801
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:18...
Function 'evaluate' executed in 0.0268 seconds (Start: 2025-11-12 11:26:18, End: 2025-11-12 11:26:18)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:18...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:26:18, End: 2025-11-12 11:26:18)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:2, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:18...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 92020.3270, val_loss: 92020.3270, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 67169.4528, val_loss: 67169.4528, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4083 seconds (Start: 2025-11-12 11:26:18, End: 2025-11-12 11:26:19)
dist(local, global): 5.470033645629883
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:19...
Function 'evaluate' executed in 0.0358 seconds (Start: 2025-11-12 11:26:19, End: 2025-11-12 11:26:19)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:19...
Function 'evaluate_shared_test' executed in 0.0045 seconds (Start: 2025-11-12 11:26:19, End: 2025-11-12 11:26:19)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:3, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:19...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 265342.7402, val_loss: 265342.7402, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 179565.5966, val_loss: 179565.5966, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4434 seconds (Start: 2025-11-12 11:26:19, End: 2025-11-12 11:26:19)
dist(local, global): 6.536391735076904
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:19...
Function 'evaluate' executed in 0.0330 seconds (Start: 2025-11-12 11:26:19, End: 2025-11-12 11:26:19)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:19...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:26:19, End: 2025-11-12 11:26:19)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:5, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:20...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 343209.5420, val_loss: 343209.5420, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 268445.2070, val_loss: 268445.2070, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4454 seconds (Start: 2025-11-12 11:26:20, End: 2025-11-12 11:26:21)
dist(local, global): 5.041379451751709
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:21...
Function 'evaluate' executed in 0.0299 seconds (Start: 2025-11-12 11:26:21, End: 2025-11-12 11:26:21)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:21...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:26:21, End: 2025-11-12 11:26:21)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:6, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:21...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 471586.8892, val_loss: 471586.8892, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 411094.7422, val_loss: 411094.7422, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4448 seconds (Start: 2025-11-12 11:26:21, End: 2025-11-12 11:26:21)
dist(local, global): 4.177215576171875
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:21...
Function 'evaluate' executed in 0.0258 seconds (Start: 2025-11-12 11:26:21, End: 2025-11-12 11:26:21)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:21...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:26:21, End: 2025-11-12 11:26:21)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:7, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:21...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 776491.5996, val_loss: 776491.5996, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 657886.4951, val_loss: 657886.4951, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4104 seconds (Start: 2025-11-12 11:26:21, End: 2025-11-12 11:26:22)
dist(local, global): 4.644600868225098
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:22...
Function 'evaluate' executed in 0.0274 seconds (Start: 2025-11-12 11:26:22, End: 2025-11-12 11:26:22)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:22...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:26:22, End: 2025-11-12 11:26:22)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:8, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:22...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1586285.7617, val_loss: 1586285.7617, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1301180.1406, val_loss: 1301180.1406, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4442 seconds (Start: 2025-11-12 11:26:22, End: 2025-11-12 11:26:22)
dist(local, global): 5.783903121948242
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:22...
Function 'evaluate' executed in 0.0295 seconds (Start: 2025-11-12 11:26:22, End: 2025-11-12 11:26:22)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:22...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:26:22, End: 2025-11-12 11:26:22)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:9, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:22...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1251552.2383, val_loss: 1251552.2383, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1038528.4541, val_loss: 1038528.4541, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4134 seconds (Start: 2025-11-12 11:26:22, End: 2025-11-12 11:26:23)
dist(local, global): 5.018900394439697
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:23...
Function 'evaluate' executed in 0.0293 seconds (Start: 2025-11-12 11:26:23, End: 2025-11-12 11:26:23)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:23...
Function 'evaluate_shared_test' executed in 0.0042 seconds (Start: 2025-11-12 11:26:23, End: 2025-11-12 11:26:23)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:10, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:23...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1360272.3281, val_loss: 1360272.3281, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1211058.9512, val_loss: 1211058.9512, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4693 seconds (Start: 2025-11-12 11:26:23, End: 2025-11-12 11:26:24)
dist(local, global): 4.457253456115723
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:24...
Function 'evaluate' executed in 0.0152 seconds (Start: 2025-11-12 11:26:24, End: 2025-11-12 11:26:24)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:24...
Function 'evaluate_shared_test' executed in 0.0032 seconds (Start: 2025-11-12 11:26:24, End: 2025-11-12 11:26:24)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:11, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:24...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1467647.6797, val_loss: 1467647.6797, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1282785.9062, val_loss: 1282785.9062, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4107 seconds (Start: 2025-11-12 11:26:24, End: 2025-11-12 11:26:24)
dist(local, global): 4.877067565917969
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:24...
Function 'evaluate' executed in 0.0233 seconds (Start: 2025-11-12 11:26:24, End: 2025-11-12 11:26:24)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:24...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:26:24, End: 2025-11-12 11:26:24)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:12, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:24...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1519248.9609, val_loss: 1519248.9609, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1355340.0664, val_loss: 1355340.0664, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4091 seconds (Start: 2025-11-12 11:26:24, End: 2025-11-12 11:26:25)
dist(local, global): 4.454869270324707
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:25...
Function 'evaluate' executed in 0.0268 seconds (Start: 2025-11-12 11:26:25, End: 2025-11-12 11:26:25)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:25...
Function 'evaluate_shared_test' executed in 0.0040 seconds (Start: 2025-11-12 11:26:25, End: 2025-11-12 11:26:25)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:14, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:25...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1504674.2344, val_loss: 1504674.2344, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1343242.4531, val_loss: 1343242.4531, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4106 seconds (Start: 2025-11-12 11:26:25, End: 2025-11-12 11:26:26)
dist(local, global): 4.57370662689209
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:26...
Function 'evaluate' executed in 0.0285 seconds (Start: 2025-11-12 11:26:26, End: 2025-11-12 11:26:26)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:26...
Function 'evaluate_shared_test' executed in 0.0037 seconds (Start: 2025-11-12 11:26:26, End: 2025-11-12 11:26:26)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:15, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:26...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1687420.0391, val_loss: 1687420.0391, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1453060.9141, val_loss: 1453060.9141, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4327 seconds (Start: 2025-11-12 11:26:26, End: 2025-11-12 11:26:27)
dist(local, global): 5.177298545837402
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:27...
Function 'evaluate' executed in 0.0390 seconds (Start: 2025-11-12 11:26:27, End: 2025-11-12 11:26:27)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:27...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:26:27, End: 2025-11-12 11:26:27)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:16, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:27...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1645614.8691, val_loss: 1645614.8691, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1475044.9199, val_loss: 1475044.9199, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4134 seconds (Start: 2025-11-12 11:26:27, End: 2025-11-12 11:26:27)
dist(local, global): 4.426746368408203
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:27...
Function 'evaluate' executed in 0.0267 seconds (Start: 2025-11-12 11:26:27, End: 2025-11-12 11:26:27)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:27...
Function 'evaluate_shared_test' executed in 0.0041 seconds (Start: 2025-11-12 11:26:27, End: 2025-11-12 11:26:27)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:18, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:28...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1547069.0117, val_loss: 1547069.0117, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1365065.7227, val_loss: 1365065.7227, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4072 seconds (Start: 2025-11-12 11:26:28, End: 2025-11-12 11:26:28)
dist(local, global): 4.981566429138184
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:28...
Function 'evaluate' executed in 0.0325 seconds (Start: 2025-11-12 11:26:28, End: 2025-11-12 11:26:28)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:28...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:26:28, End: 2025-11-12 11:26:28)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:19, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:29...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1447409.9746, val_loss: 1447409.9746, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1288348.8340, val_loss: 1288348.8340, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4441 seconds (Start: 2025-11-12 11:26:29, End: 2025-11-12 11:26:29)
dist(local, global): 4.6593804359436035
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:29...
Function 'evaluate' executed in 0.0270 seconds (Start: 2025-11-12 11:26:29, End: 2025-11-12 11:26:29)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:29...
Function 'evaluate_shared_test' executed in 0.0034 seconds (Start: 2025-11-12 11:26:29, End: 2025-11-12 11:26:29)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:20, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:29...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1581298.1738, val_loss: 1581298.1738, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1422815.1250, val_loss: 1422815.1250, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4447 seconds (Start: 2025-11-12 11:26:29, End: 2025-11-12 11:26:30)
dist(local, global): 4.380815505981445
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:30...
Function 'evaluate' executed in 0.0304 seconds (Start: 2025-11-12 11:26:30, End: 2025-11-12 11:26:30)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:30...
Function 'evaluate_shared_test' executed in 0.0039 seconds (Start: 2025-11-12 11:26:30, End: 2025-11-12 11:26:30)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:21, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:30...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 1353633.2754, val_loss: 1353633.2754, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1182144.0117, val_loss: 1182144.0117, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4129 seconds (Start: 2025-11-12 11:26:30, End: 2025-11-12 11:26:30)
dist(local, global): 4.565176486968994
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:30...
Function 'evaluate' executed in 0.0280 seconds (Start: 2025-11-12 11:26:30, End: 2025-11-12 11:26:30)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:30...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:26:30, End: 2025-11-12 11:26:30)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:22, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:30...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2474233.1953, val_loss: 2474233.1953, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2097958.5742, val_loss: 2097958.5742, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4455 seconds (Start: 2025-11-12 11:26:30, End: 2025-11-12 11:26:31)
dist(local, global): 5.502678871154785
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:31...
Function 'evaluate' executed in 0.0301 seconds (Start: 2025-11-12 11:26:31, End: 2025-11-12 11:26:31)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:31...
Function 'evaluate_shared_test' executed in 0.0041 seconds (Start: 2025-11-12 11:26:31, End: 2025-11-12 11:26:31)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:23, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:31...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4188612.1719, val_loss: 4188612.1719, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3612769.6562, val_loss: 3612769.6562, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4109 seconds (Start: 2025-11-12 11:26:31, End: 2025-11-12 11:26:31)
dist(local, global): 5.816463947296143
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:31...
Function 'evaluate' executed in 0.0271 seconds (Start: 2025-11-12 11:26:31, End: 2025-11-12 11:26:32)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:32...
Function 'evaluate_shared_test' executed in 0.0035 seconds (Start: 2025-11-12 11:26:32, End: 2025-11-12 11:26:32)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:24, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:32...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3756741.2500, val_loss: 3756741.2500, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3286877.5312, val_loss: 3286877.5312, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4114 seconds (Start: 2025-11-12 11:26:32, End: 2025-11-12 11:26:32)
dist(local, global): 5.381220817565918
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:32...
Function 'evaluate' executed in 0.0304 seconds (Start: 2025-11-12 11:26:32, End: 2025-11-12 11:26:32)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:32...
Function 'evaluate_shared_test' executed in 0.0041 seconds (Start: 2025-11-12 11:26:32, End: 2025-11-12 11:26:32)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:25, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:32...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 5769387.2734, val_loss: 5769387.2734, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 4973514.7031, val_loss: 4973514.7031, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4477 seconds (Start: 2025-11-12 11:26:32, End: 2025-11-12 11:26:33)
dist(local, global): 5.907883644104004
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:33...
Function 'evaluate' executed in 0.0292 seconds (Start: 2025-11-12 11:26:33, End: 2025-11-12 11:26:33)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:33...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:26:33, End: 2025-11-12 11:26:33)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:27, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:33...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 8703183.6250, val_loss: 8703183.6250, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7656020.3750, val_loss: 7656020.3750, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4477 seconds (Start: 2025-11-12 11:26:33, End: 2025-11-12 11:26:34)
dist(local, global): 6.343479156494141
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:34...
Function 'evaluate' executed in 0.0296 seconds (Start: 2025-11-12 11:26:34, End: 2025-11-12 11:26:34)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:34...
Function 'evaluate_shared_test' executed in 0.0038 seconds (Start: 2025-11-12 11:26:34, End: 2025-11-12 11:26:34)
[Client 5] Sending updated value
[Client 5] Received: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])

*** server_epoch:28, client_5, client_type: Honest: ... ***
client_5 data (2): {0: 402, 1: 396}
Train FNN...
Function 'train_cnn starts at 2025-11-12 11:26:34...
X: min: -5.690790176391602, max: 6.196309566497803
Compute classes weights...
labeled_y:  dict_items([(0, 402), (1, 396)])
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/users/kunyang/.conda/envs/flnlp_3.9.21/lib/python3.9/site-packages/sklearn/metrics/_classification.py:407: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
class_weight: tensor([0.4962, 0.5038], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9010374.2031, val_loss: 9010374.2031, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 7909926.9375, val_loss: 7909926.9375, LR: 0.0009000000000000001
Function 'train_cnn' executed in 0.4837 seconds (Start: 2025-11-12 11:26:34, End: 2025-11-12 11:26:35)
dist(local, global): 6.4015421867370605
Evaluate FNNs...
Function 'evaluate starts at 2025-11-12 11:26:35...
Function 'evaluate' executed in 0.0332 seconds (Start: 2025-11-12 11:26:35, End: 2025-11-12 11:26:35)
Function 'evaluate_shared_test starts at 2025-11-12 11:26:35...
Function 'evaluate_shared_test' executed in 0.0036 seconds (Start: 2025-11-12 11:26:35, End: 2025-11-12 11:26:35)
[Client 5] Sending updated value
[Client 5] Server signals training complete. Exiting.
[Client 5] Done.
