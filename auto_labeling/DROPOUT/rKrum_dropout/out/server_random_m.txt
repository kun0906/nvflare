Namespace(server_ip='127.0.0.1', workspace_dir='out/ws_20_30_1_1', num_clients=20, num_rounds=30)
Number of clients:  20
NUM_BYZANTINE_CLIENTS:  8
NUM_HONEST_CLIENTS:  12
[Server] Starting...
[Server] Waiting for 20 clients to connect...
[Server] Connected to client 7 at ('127.0.0.1', 54836)
[Server] Connected to client 20 at ('127.0.0.1', 54846)
[Server] Connected to client 4 at ('127.0.0.1', 54856)
[Server] Connected to client 16 at ('127.0.0.1', 54868)
[Server] Connected to client 9 at ('127.0.0.1', 54870)
[Server] Connected to client 3 at ('127.0.0.1', 54884)
[Server] Connected to client 17 at ('127.0.0.1', 54890)
[Server] Connected to client 10 at ('127.0.0.1', 54892)
[Server] Connected to client 15 at ('127.0.0.1', 54904)
[Server] Connected to client 1 at ('127.0.0.1', 54910)
[Server] Connected to client 14 at ('127.0.0.1', 54914)
[Server] Connected to client 11 at ('127.0.0.1', 54928)
[Server] Connected to client 2 at ('127.0.0.1', 54938)
[Server] Connected to client 18 at ('127.0.0.1', 54948)
[Server] Connected to client 5 at ('127.0.0.1', 54954)
[Server] Connected to client 19 at ('127.0.0.1', 54970)
[Server] Connected to client 6 at ('127.0.0.1', 54982)
[Server] Connected to client 8 at ('127.0.0.1', 54984)
[Server] Connected to client 12 at ('127.0.0.1', 54998)
[Server] Connected to client 13 at ('127.0.0.1', 55004)
[Server] All clients connected.
-----------------------------------------------------------------------------------

 ------- aggregate method: rkrum, random_seed: 0 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [18, 20, 15, 6, 19, 17, 2, 9, 10, 3, 1, 16, 4], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 7.7184e+05, 7.8410e+05, 4.0348e+05, 7.7348e+05, 8.1277e+05,
         4.0347e+05, 4.0351e+05, 4.0342e+05, 4.0346e+05, 4.0345e+05, 8.0742e+05,
         4.0346e+05],
        [7.7184e+05, 0.0000e+00, 7.8238e+05, 3.8441e+05, 7.7481e+05, 7.8799e+05,
         3.8444e+05, 3.8444e+05, 3.8443e+05, 3.8446e+05, 3.8441e+05, 7.7354e+05,
         3.8443e+05],
        [7.8410e+05, 7.8238e+05, 0.0000e+00, 3.8587e+05, 7.7270e+05, 7.8800e+05,
         3.8597e+05, 3.8591e+05, 3.8595e+05, 3.8593e+05, 3.8600e+05, 7.7113e+05,
         3.8591e+05],
        [4.0348e+05, 3.8441e+05, 3.8587e+05, 0.0000e+00, 3.8325e+05, 4.0415e+05,
         3.6671e+00, 4.2482e+00, 4.0287e+00, 3.7158e+00, 4.1356e+00, 3.8938e+05,
         3.6529e+00],
        [7.7348e+05, 7.7481e+05, 7.7270e+05, 3.8325e+05, 0.0000e+00, 7.6991e+05,
         3.8326e+05, 3.8326e+05, 3.8324e+05, 3.8325e+05, 3.8324e+05, 7.9241e+05,
         3.8322e+05],
        [8.1277e+05, 7.8799e+05, 7.8800e+05, 4.0415e+05, 7.6991e+05, 0.0000e+00,
         4.0413e+05, 4.0413e+05, 4.0410e+05, 4.0410e+05, 4.0415e+05, 7.9556e+05,
         4.0416e+05],
        [4.0347e+05, 3.8444e+05, 3.8597e+05, 3.6671e+00, 3.8326e+05, 4.0413e+05,
         0.0000e+00, 3.8183e+00, 3.1283e+00, 3.2676e+00, 3.4322e+00, 3.8938e+05,
         3.7454e+00],
        [4.0351e+05, 3.8444e+05, 3.8591e+05, 4.2482e+00, 3.8326e+05, 4.0413e+05,
         3.8183e+00, 0.0000e+00, 3.6609e+00, 3.6458e+00, 3.5668e+00, 3.8942e+05,
         4.1140e+00],
        [4.0342e+05, 3.8443e+05, 3.8595e+05, 4.0287e+00, 3.8324e+05, 4.0410e+05,
         3.1283e+00, 3.6609e+00, 0.0000e+00, 3.2990e+00, 3.3430e+00, 3.8939e+05,
         3.5849e+00],
        [4.0346e+05, 3.8446e+05, 3.8593e+05, 3.7158e+00, 3.8325e+05, 4.0410e+05,
         3.2676e+00, 3.6458e+00, 3.2990e+00, 0.0000e+00, 3.6144e+00, 3.8934e+05,
         3.6465e+00],
        [4.0345e+05, 3.8441e+05, 3.8600e+05, 4.1356e+00, 3.8324e+05, 4.0415e+05,
         3.4322e+00, 3.5668e+00, 3.3430e+00, 3.6144e+00, 0.0000e+00, 3.8941e+05,
         3.7753e+00],
        [8.0742e+05, 7.7354e+05, 7.7113e+05, 3.8938e+05, 7.9241e+05, 7.9556e+05,
         3.8938e+05, 3.8942e+05, 3.8939e+05, 3.8934e+05, 3.8941e+05, 0.0000e+00,
         3.8936e+05],
        [4.0346e+05, 3.8443e+05, 3.8591e+05, 3.6529e+00, 3.8322e+05, 4.0416e+05,
         3.7454e+00, 4.1140e+00, 3.5849e+00, 3.6465e+00, 3.7753e+00, 3.8936e+05,
         0.0000e+00]])
sorted_distances: tensor([     0.0000, 403419.6562, 403451.6875, 403455.8438, 403460.4688,
        403467.5625, 403482.7500, 403514.8750, 771842.0000, 773484.8750,
        784097.7500, 807415.6250, 812773.9375])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 384408.1562, 384410.2500, 384427.2188, 384429.6250,
        384440.9688, 384442.1250, 384462.7812, 771842.0000, 773539.6875,
        774811.2500, 782376.5000, 787992.3750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 385870.6875, 385910.7188, 385914.5312, 385934.6875,
        385948.2812, 385966.9375, 386000.5312, 771126.0625, 772701.4375,
        782376.5000, 784097.7500, 788003.9375])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6529e+00, 3.6671e+00, 3.7158e+00, 4.0287e+00, 4.1356e+00,
        4.2482e+00, 3.8325e+05, 3.8441e+05, 3.8587e+05, 3.8938e+05, 4.0348e+05,
        4.0415e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 383215.5625, 383236.4375, 383238.8750, 383252.0000,
        383254.1875, 383261.2188, 383264.0000, 769913.8750, 772701.4375,
        773484.8750, 774811.2500, 792407.2500])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 404102.1562, 404105.0000, 404132.8438, 404133.5938,
        404147.0312, 404153.5000, 404157.6875, 769913.8750, 787992.3750,
        788003.9375, 795562.9375, 812773.9375])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.1283e+00, 3.2676e+00, 3.4322e+00, 3.6671e+00, 3.7454e+00,
        3.8183e+00, 3.8326e+05, 3.8444e+05, 3.8597e+05, 3.8938e+05, 4.0347e+05,
        4.0413e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.5668e+00, 3.6458e+00, 3.6609e+00, 3.8183e+00, 4.1140e+00,
        4.2482e+00, 3.8326e+05, 3.8444e+05, 3.8591e+05, 3.8942e+05, 4.0351e+05,
        4.0413e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.1283e+00, 3.2990e+00, 3.3430e+00, 3.5849e+00, 3.6609e+00,
        4.0287e+00, 3.8324e+05, 3.8443e+05, 3.8595e+05, 3.8939e+05, 4.0342e+05,
        4.0410e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.2676e+00, 3.2990e+00, 3.6144e+00, 3.6458e+00, 3.6465e+00,
        3.7158e+00, 3.8325e+05, 3.8446e+05, 3.8593e+05, 3.8934e+05, 4.0346e+05,
        4.0410e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.3430e+00, 3.4322e+00, 3.5668e+00, 3.6144e+00, 3.7753e+00,
        4.1356e+00, 3.8324e+05, 3.8441e+05, 3.8600e+05, 3.8941e+05, 4.0345e+05,
        4.0415e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 389340.3750, 389363.9688, 389376.4688, 389383.3750,
        389387.8125, 389411.5938, 389420.8750, 771126.0625, 773539.6875,
        792407.2500, 795562.9375, 807415.6250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.5849e+00, 3.6465e+00, 3.6529e+00, 3.7454e+00, 3.7753e+00,
        4.1140e+00, 3.8322e+05, 3.8443e+05, 3.8591e+05, 3.8936e+05, 4.0346e+05,
        4.0416e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['449511.84', '432857.88', '434084.06', '95960.73', '431579.53', '449855.75', '95965.90', '95965.66', '95961.19', '95967.00', '95958.57', '437101.31', '95958.16']
estimated f for each client, fs: [4, 5, 4, 6, 5, 4, 6, 6, 6, 6, 6, 4, 6]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']], selected_client_indices: [18, 20, 15, 6, 19, 17, 2, 9, 10, 3, 1, 16, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0112s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:19...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.7887 seconds (Start: 2025-07-22 15:45:19, End: 2025-07-22 15:45:20)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [9, 16, 15, 13, 1, 20, 11, 5, 14, 3], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 4.0135e+05, 3.7982e+05, 4.0264e+05, 1.9055e+00, 3.7758e+05,
         1.8016e+00, 2.1018e+00, 3.9194e+05, 1.9694e+00],
        [4.0135e+05, 0.0000e+00, 7.7477e+05, 8.3520e+05, 4.0137e+05, 7.7110e+05,
         4.0136e+05, 4.0138e+05, 7.8477e+05, 4.0135e+05],
        [3.7982e+05, 7.7477e+05, 0.0000e+00, 7.8475e+05, 3.7981e+05, 7.5244e+05,
         3.7990e+05, 3.7984e+05, 7.8434e+05, 3.7984e+05],
        [4.0264e+05, 8.3520e+05, 7.8475e+05, 0.0000e+00, 4.0269e+05, 7.9304e+05,
         4.0263e+05, 4.0262e+05, 7.9333e+05, 4.0265e+05],
        [1.9055e+00, 4.0137e+05, 3.7981e+05, 4.0269e+05, 0.0000e+00, 3.7756e+05,
         1.8667e+00, 1.9613e+00, 3.9193e+05, 2.1166e+00],
        [3.7758e+05, 7.7110e+05, 7.5244e+05, 7.9304e+05, 3.7756e+05, 0.0000e+00,
         3.7756e+05, 3.7757e+05, 7.8186e+05, 3.7760e+05],
        [1.8016e+00, 4.0136e+05, 3.7990e+05, 4.0263e+05, 1.8667e+00, 3.7756e+05,
         0.0000e+00, 1.8196e+00, 3.9194e+05, 2.0087e+00],
        [2.1018e+00, 4.0138e+05, 3.7984e+05, 4.0262e+05, 1.9613e+00, 3.7757e+05,
         1.8196e+00, 0.0000e+00, 3.9196e+05, 1.9520e+00],
        [3.9194e+05, 7.8477e+05, 7.8434e+05, 7.9333e+05, 3.9193e+05, 7.8186e+05,
         3.9194e+05, 3.9196e+05, 0.0000e+00, 3.9194e+05],
        [1.9694e+00, 4.0135e+05, 3.7984e+05, 4.0265e+05, 2.1166e+00, 3.7760e+05,
         2.0087e+00, 1.9520e+00, 3.9194e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.8016e+00, 1.9055e+00, 1.9694e+00, 2.1018e+00, 3.7758e+05,
        3.7982e+05, 3.9194e+05, 4.0135e+05, 4.0264e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 401354.0000, 401354.5625, 401358.9375, 401370.2812,
        401376.8125, 771099.0625, 774766.6250, 784767.5625, 835203.3750])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 379813.4688, 379824.2500, 379840.2812, 379842.4062,
        379895.5000, 752440.5000, 774766.6250, 784337.9375, 784748.3750])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 402620.1875, 402634.2812, 402643.7500, 402651.8125,
        402692.0625, 784748.3750, 793041.3750, 793325.6250, 835203.3750])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.8667e+00, 1.9055e+00, 1.9613e+00, 2.1166e+00, 3.7756e+05,
        3.7981e+05, 3.9193e+05, 4.0137e+05, 4.0269e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 377558.4375, 377564.9375, 377565.7500, 377583.5000,
        377596.4062, 752440.5000, 771099.0625, 781862.7500, 793041.3750])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.8016e+00, 1.8196e+00, 1.8667e+00, 2.0087e+00, 3.7756e+05,
        3.7990e+05, 3.9194e+05, 4.0136e+05, 4.0263e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.8196e+00, 1.9520e+00, 1.9613e+00, 2.1018e+00, 3.7757e+05,
        3.7984e+05, 3.9196e+05, 4.0138e+05, 4.0262e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 391929.6562, 391941.2188, 391941.2500, 391943.3125,
        391956.4062, 781862.7500, 784337.9375, 784767.5625, 793325.6250])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.9520e+00, 1.9694e+00, 2.0087e+00, 2.1166e+00, 3.7760e+05,
        3.7984e+05, 3.9194e+05, 4.0135e+05, 4.0265e+05])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['164193.81', '507525.78', '489489.03', '513004.53', '164187.05', '487344.03', '164201.31', '164196.05', '503701.75', '164198.27']
estimated f for each client, fs: [5, 2, 3, 2, 5, 3, 5, 5, 3, 5]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [9, 16, 15, 13, 1, 20, 11, 5, 14, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0357s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:25...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0031 seconds (Start: 2025-07-22 15:45:25, End: 2025-07-22 15:45:25)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [8, 16, 11, 18, 14, 1, 19, 12, 15, 10, 6, 13, 9, 7, 5, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0200e+05, 1.9285e+00, 3.7933e+05, 3.8002e+05, 1.9983e+00,
         3.8445e+05, 1.7844e+00, 4.0335e+05, 1.8436e+00, 1.8742e+00, 3.8400e+05,
         1.8028e+00, 1.9277e+00, 1.9874e+00, 3.9422e+05],
        [4.0200e+05, 0.0000e+00, 4.0196e+05, 7.7376e+05, 7.6933e+05, 4.0195e+05,
         8.0074e+05, 4.0196e+05, 7.8433e+05, 4.0196e+05, 4.0199e+05, 7.8061e+05,
         4.0198e+05, 4.0196e+05, 4.0200e+05, 8.2527e+05],
        [1.9285e+00, 4.0196e+05, 0.0000e+00, 3.7929e+05, 3.8004e+05, 1.7102e+00,
         3.8441e+05, 1.6171e+00, 4.0338e+05, 1.7554e+00, 1.8061e+00, 3.8400e+05,
         1.6511e+00, 1.8056e+00, 1.6317e+00, 3.9423e+05],
        [3.7933e+05, 7.7376e+05, 3.7929e+05, 0.0000e+00, 7.6580e+05, 3.7926e+05,
         7.7458e+05, 3.7932e+05, 7.9981e+05, 3.7926e+05, 3.7930e+05, 7.6253e+05,
         3.7933e+05, 3.7929e+05, 3.7928e+05, 7.6554e+05],
        [3.8002e+05, 7.6933e+05, 3.8004e+05, 7.6580e+05, 0.0000e+00, 3.8007e+05,
         7.5579e+05, 3.8007e+05, 7.7097e+05, 3.8003e+05, 3.8005e+05, 7.5284e+05,
         3.8008e+05, 3.8004e+05, 3.8008e+05, 8.0047e+05],
        [1.9983e+00, 4.0195e+05, 1.7102e+00, 3.7926e+05, 3.8007e+05, 0.0000e+00,
         3.8442e+05, 1.7025e+00, 4.0339e+05, 1.8410e+00, 1.9155e+00, 3.8404e+05,
         1.6463e+00, 1.7995e+00, 1.7124e+00, 3.9421e+05],
        [3.8445e+05, 8.0074e+05, 3.8441e+05, 7.7458e+05, 7.5579e+05, 3.8442e+05,
         0.0000e+00, 3.8442e+05, 7.9288e+05, 3.8442e+05, 3.8444e+05, 7.5548e+05,
         3.8439e+05, 3.8442e+05, 3.8440e+05, 7.6069e+05],
        [1.7844e+00, 4.0196e+05, 1.6171e+00, 3.7932e+05, 3.8007e+05, 1.7025e+00,
         3.8442e+05, 0.0000e+00, 4.0336e+05, 1.6714e+00, 1.7177e+00, 3.8401e+05,
         1.6134e+00, 1.7199e+00, 1.6197e+00, 3.9425e+05],
        [4.0335e+05, 7.8433e+05, 4.0338e+05, 7.9981e+05, 7.7097e+05, 4.0339e+05,
         7.9288e+05, 4.0336e+05, 0.0000e+00, 4.0333e+05, 4.0335e+05, 7.7885e+05,
         4.0334e+05, 4.0336e+05, 4.0337e+05, 8.0138e+05],
        [1.8436e+00, 4.0196e+05, 1.7554e+00, 3.7926e+05, 3.8003e+05, 1.8410e+00,
         3.8442e+05, 1.6714e+00, 4.0333e+05, 0.0000e+00, 1.8691e+00, 3.8402e+05,
         1.6115e+00, 1.7397e+00, 1.7582e+00, 3.9424e+05],
        [1.8742e+00, 4.0199e+05, 1.8061e+00, 3.7930e+05, 3.8005e+05, 1.9155e+00,
         3.8444e+05, 1.7177e+00, 4.0335e+05, 1.8691e+00, 0.0000e+00, 3.8401e+05,
         1.6529e+00, 1.8742e+00, 1.8157e+00, 3.9425e+05],
        [3.8400e+05, 7.8061e+05, 3.8400e+05, 7.6253e+05, 7.5284e+05, 3.8404e+05,
         7.5548e+05, 3.8401e+05, 7.7885e+05, 3.8402e+05, 3.8401e+05, 0.0000e+00,
         3.8398e+05, 3.8401e+05, 3.8404e+05, 7.9426e+05],
        [1.8028e+00, 4.0198e+05, 1.6511e+00, 3.7933e+05, 3.8008e+05, 1.6463e+00,
         3.8439e+05, 1.6134e+00, 4.0334e+05, 1.6115e+00, 1.6529e+00, 3.8398e+05,
         0.0000e+00, 1.7237e+00, 1.8476e+00, 3.9420e+05],
        [1.9277e+00, 4.0196e+05, 1.8056e+00, 3.7929e+05, 3.8004e+05, 1.7995e+00,
         3.8442e+05, 1.7199e+00, 4.0336e+05, 1.7397e+00, 1.8742e+00, 3.8401e+05,
         1.7237e+00, 0.0000e+00, 1.7177e+00, 3.9422e+05],
        [1.9874e+00, 4.0200e+05, 1.6317e+00, 3.7928e+05, 3.8008e+05, 1.7124e+00,
         3.8440e+05, 1.6197e+00, 4.0337e+05, 1.7582e+00, 1.8157e+00, 3.8404e+05,
         1.8476e+00, 1.7177e+00, 0.0000e+00, 3.9422e+05],
        [3.9422e+05, 8.2527e+05, 3.9423e+05, 7.6554e+05, 8.0047e+05, 3.9421e+05,
         7.6069e+05, 3.9425e+05, 8.0138e+05, 3.9424e+05, 3.9425e+05, 7.9426e+05,
         3.9420e+05, 3.9422e+05, 3.9422e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7844e+00, 1.8028e+00, 1.8436e+00, 1.8742e+00, 1.9277e+00,
        1.9285e+00, 1.9874e+00, 1.9983e+00, 3.7933e+05, 3.8002e+05, 3.8400e+05,
        3.8445e+05, 3.9422e+05, 4.0200e+05, 4.0335e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401946.4062, 401958.5938, 401959.9375, 401960.7188,
        401961.8750, 401976.9688, 401991.5625, 401998.3750, 402002.6250,
        769330.0000, 773758.6250, 780610.0000, 784326.8125, 800738.8125,
        825272.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6171e+00, 1.6317e+00, 1.6511e+00, 1.7102e+00, 1.7554e+00,
        1.8056e+00, 1.8061e+00, 1.9285e+00, 3.7929e+05, 3.8004e+05, 3.8400e+05,
        3.8441e+05, 3.9423e+05, 4.0196e+05, 4.0338e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379260.8438, 379262.8438, 379282.2812, 379292.5625,
        379293.7188, 379296.1250, 379324.9375, 379329.9688, 379331.2500,
        762530.9375, 765535.0625, 765804.6875, 773758.6250, 774577.9375,
        799809.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380024.1875, 380033.7500, 380039.0312, 380041.0000,
        380054.1250, 380065.8750, 380067.4062, 380076.9375, 380081.3125,
        752837.1875, 755785.4375, 765804.6875, 769330.0000, 770972.6250,
        800474.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6463e+00, 1.7025e+00, 1.7102e+00, 1.7124e+00, 1.7995e+00,
        1.8410e+00, 1.9155e+00, 1.9983e+00, 3.7926e+05, 3.8007e+05, 3.8404e+05,
        3.8442e+05, 3.9421e+05, 4.0195e+05, 4.0339e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384392.7188, 384401.1250, 384410.8125, 384418.5000,
        384422.2188, 384422.4062, 384422.6250, 384435.5625, 384450.2188,
        755478.2500, 755785.4375, 760692.0625, 774577.9375, 792879.7500,
        800738.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6134e+00, 1.6171e+00, 1.6197e+00, 1.6714e+00, 1.7025e+00,
        1.7177e+00, 1.7199e+00, 1.7844e+00, 3.7932e+05, 3.8007e+05, 3.8401e+05,
        3.8442e+05, 3.9425e+05, 4.0196e+05, 4.0336e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403329.9062, 403336.8438, 403349.3125, 403352.4688,
        403355.4688, 403363.7500, 403374.1250, 403378.8125, 403391.9688,
        770972.6250, 778847.2500, 784326.8125, 792879.7500, 799809.7500,
        801379.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6115e+00, 1.6714e+00, 1.7397e+00, 1.7554e+00, 1.7582e+00,
        1.8410e+00, 1.8436e+00, 1.8691e+00, 3.7926e+05, 3.8003e+05, 3.8402e+05,
        3.8442e+05, 3.9424e+05, 4.0196e+05, 4.0333e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6529e+00, 1.7177e+00, 1.8061e+00, 1.8157e+00, 1.8691e+00,
        1.8742e+00, 1.8742e+00, 1.9155e+00, 3.7930e+05, 3.8005e+05, 3.8401e+05,
        3.8444e+05, 3.9425e+05, 4.0199e+05, 4.0335e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383984.5312, 383997.0312, 384001.2500, 384008.4375,
        384010.3438, 384011.5938, 384017.7500, 384036.2500, 384041.2500,
        752837.1875, 755478.2500, 762530.9375, 778847.2500, 780610.0000,
        794257.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6115e+00, 1.6134e+00, 1.6463e+00, 1.6511e+00, 1.6529e+00,
        1.7237e+00, 1.8028e+00, 1.8476e+00, 3.7933e+05, 3.8008e+05, 3.8398e+05,
        3.8439e+05, 3.9420e+05, 4.0198e+05, 4.0334e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7177e+00, 1.7199e+00, 1.7237e+00, 1.7397e+00, 1.7995e+00,
        1.8056e+00, 1.8742e+00, 1.9277e+00, 3.7929e+05, 3.8004e+05, 3.8401e+05,
        3.8442e+05, 3.9422e+05, 4.0196e+05, 4.0336e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6197e+00, 1.6317e+00, 1.7124e+00, 1.7177e+00, 1.7582e+00,
        1.8157e+00, 1.8476e+00, 1.9874e+00, 3.7928e+05, 3.8008e+05, 3.8404e+05,
        3.8440e+05, 3.9422e+05, 4.0200e+05, 4.0337e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394196.4688, 394211.3125, 394218.5938, 394219.8438,
        394221.9375, 394229.4375, 394235.0938, 394246.8438, 394248.2812,
        760692.0625, 765535.0625, 794257.6875, 800474.2500, 801379.3750,
        825272.0000])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75936.93', '438708.69', '75934.86', '417620.56', '417332.09', '75934.10', '421525.44', '75940.59', '440120.56', '75931.07', '75936.48', '420894.56', '75942.61', '75934.60', '75937.33', '430872.00']
estimated f for each client, fs: [7, 5, 7, 6, 5, 7, 5, 7, 5, 7, 7, 5, 7, 7, 7, 5]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 16, 11, 18, 14, 1, 19, 12, 15, 10, 6, 13, 9, 7, 5, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0146s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:29...
global Accuracy on shared test data: 78.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 42 221]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:45:29, End: 2025-07-22 15:45:29)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [2, 7, 19], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[0.0000e+00, 1.6131e+00, 3.8810e+05],
        [1.6131e+00, 0.0000e+00, 3.8809e+05],
        [3.8810e+05, 3.8809e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6131e+00, 3.8810e+05])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000e+00, 1.6131e+00, 3.8809e+05])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([     0.0000, 388090.4375, 388099.9375])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['194050.78', '194046.03', '388095.19']
estimated f for each client, fs: [1, 1, 0]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']], selected_client_indices: [2, 7, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:30...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:30, End: 2025-07-22 15:45:30)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [10, 14, 4, 17, 13, 16, 2, 8, 15, 19, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
tensor([[0.0000e+00, 3.9631e+05, 1.8593e+00, 3.9082e+05, 3.9264e+05, 3.9347e+05,
         1.7530e+00, 1.9199e+00, 3.9259e+05, 3.8918e+05, 3.9172e+05],
        [3.9631e+05, 0.0000e+00, 3.9629e+05, 7.8673e+05, 7.6424e+05, 8.0846e+05,
         3.9629e+05, 3.9633e+05, 7.9280e+05, 7.9193e+05, 7.7978e+05],
        [1.8593e+00, 3.9629e+05, 0.0000e+00, 3.9083e+05, 3.9261e+05, 3.9348e+05,
         1.8367e+00, 1.8497e+00, 3.9261e+05, 3.8918e+05, 3.9172e+05],
        [3.9082e+05, 7.8673e+05, 3.9083e+05, 0.0000e+00, 7.9960e+05, 7.6725e+05,
         3.9086e+05, 3.9086e+05, 7.6796e+05, 7.8569e+05, 7.7157e+05],
        [3.9264e+05, 7.6424e+05, 3.9261e+05, 7.9960e+05, 0.0000e+00, 7.8947e+05,
         3.9260e+05, 3.9264e+05, 7.9128e+05, 7.6908e+05, 7.9537e+05],
        [3.9347e+05, 8.0846e+05, 3.9348e+05, 7.6725e+05, 7.8947e+05, 0.0000e+00,
         3.9349e+05, 3.9347e+05, 7.6812e+05, 7.8624e+05, 7.9749e+05],
        [1.7530e+00, 3.9629e+05, 1.8367e+00, 3.9086e+05, 3.9260e+05, 3.9349e+05,
         0.0000e+00, 1.8155e+00, 3.9263e+05, 3.8914e+05, 3.9172e+05],
        [1.9199e+00, 3.9633e+05, 1.8497e+00, 3.9086e+05, 3.9264e+05, 3.9347e+05,
         1.8155e+00, 0.0000e+00, 3.9264e+05, 3.8916e+05, 3.9174e+05],
        [3.9259e+05, 7.9280e+05, 3.9261e+05, 7.6796e+05, 7.9128e+05, 7.6812e+05,
         3.9263e+05, 3.9264e+05, 0.0000e+00, 7.6202e+05, 7.6980e+05],
        [3.8918e+05, 7.9193e+05, 3.8918e+05, 7.8569e+05, 7.6908e+05, 7.8624e+05,
         3.8914e+05, 3.8916e+05, 7.6202e+05, 0.0000e+00, 7.5012e+05],
        [3.9172e+05, 7.7978e+05, 3.9172e+05, 7.7157e+05, 7.9537e+05, 7.9749e+05,
         3.9172e+05, 3.9174e+05, 7.6980e+05, 7.5012e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7530e+00, 1.8593e+00, 1.9199e+00, 3.8918e+05, 3.9082e+05,
        3.9172e+05, 3.9259e+05, 3.9264e+05, 3.9347e+05, 3.9631e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 396293.0312, 396294.2500, 396314.8125, 396330.0625,
        764238.8750, 779776.0000, 786734.4375, 791927.6875, 792797.3125,
        808461.6875])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.8367e+00, 1.8497e+00, 1.8593e+00, 3.8918e+05, 3.9083e+05,
        3.9172e+05, 3.9261e+05, 3.9261e+05, 3.9348e+05, 3.9629e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 390819.1875, 390825.5625, 390861.2500, 390861.4062,
        767246.6875, 767963.3125, 771573.1875, 785688.4375, 786734.4375,
        799598.3125])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 392598.8438, 392606.0938, 392636.1562, 392642.0000,
        764238.8750, 769084.5000, 789468.9375, 791280.5625, 795367.6875,
        799598.3125])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 393469.7188, 393470.2812, 393475.5000, 393491.5312,
        767246.6875, 768120.7500, 786242.0000, 789468.9375, 797487.6250,
        808461.6875])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.7530e+00, 1.8155e+00, 1.8367e+00, 3.8914e+05, 3.9086e+05,
        3.9172e+05, 3.9260e+05, 3.9263e+05, 3.9349e+05, 3.9629e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.8155e+00, 1.8497e+00, 1.9199e+00, 3.8916e+05, 3.9086e+05,
        3.9174e+05, 3.9264e+05, 3.9264e+05, 3.9347e+05, 3.9633e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 392592.4375, 392605.4688, 392631.1250, 392640.0312,
        762018.2500, 767963.3125, 768120.7500, 769798.5000, 791280.5625,
        792797.3125])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 389145.0000, 389164.6562, 389183.9375, 389184.1562,
        750117.3750, 762018.2500, 769084.5000, 785688.4375, 786242.0000,
        791927.6875])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 391717.2500, 391718.1562, 391723.3750, 391741.9375,
        750117.3750, 769798.5000, 771573.1875, 779776.0000, 795367.6875,
        797487.6250])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['223474.22', '559425.94', '223477.72', '552878.69', '556182.19', '556502.38', '223475.42', '223487.67', '552653.12', '548271.12', '551198.56']
estimated f for each client, fs: [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [10, 14, 4, 17, 13, 16, 2, 8, 15, 19, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0135s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:30...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 45 218]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:30, End: 2025-07-22 15:45:30)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [14, 6, 19], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[     0.0000, 385141.8438, 758288.1250],
        [385141.8438,      0.0000, 385770.7188],
        [758288.1250, 385770.7188,      0.0000]])
sorted_distances: tensor([     0.0000, 385141.8438, 758288.1250])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([     0.0000, 385141.8438, 385770.7188])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([     0.0000, 385770.7188, 758288.1250])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['571715.00', '385456.28', '572029.44']
estimated f for each client, fs: [0, 0, 0]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']], selected_client_indices: [14, 6, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0020s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:30...
global Accuracy on shared test data: 79.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:30, End: 2025-07-22 15:45:30)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (4): [1, 8, 13, 16], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 4
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([4])
tensor([[0.0000e+00, 1.9423e+00, 4.0733e+05, 3.8117e+05],
        [1.9423e+00, 0.0000e+00, 4.0734e+05, 3.8119e+05],
        [4.0733e+05, 4.0734e+05, 0.0000e+00, 7.7074e+05],
        [3.8117e+05, 3.8119e+05, 7.7074e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.9423e+00, 3.8117e+05, 4.0733e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 1.9423e+00, 3.8119e+05, 4.0734e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([     0.0000, 407325.7188, 407335.3438, 770742.6250])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([     0.0000, 381171.6562, 381187.2500, 770742.6250])
Index of maximum distance difference after half of values: 4
adaptive_Krum scores:  ['262833.09', '262841.50', '528467.94', '511033.84']
estimated f for each client, fs: [2, 2, 0, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']], selected_client_indices: [1, 8, 13, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0024s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:30...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:30, End: 2025-07-22 15:45:30)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 8, 17, 1, 5, 20, 6, 2, 12, 3, 18, 16, 9, 19, 11, 13, 7, 4], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.9452e+05, 7.6673e+05, 3.9452e+05, 3.9452e+05, 7.7553e+05,
         3.9452e+05, 3.9451e+05, 3.9453e+05, 3.9452e+05, 7.8477e+05, 7.9093e+05,
         3.9450e+05, 7.8954e+05, 3.9452e+05, 8.0155e+05, 3.9451e+05, 3.9450e+05],
        [3.9452e+05, 0.0000e+00, 3.8594e+05, 2.1174e+00, 1.5981e+00, 3.8733e+05,
         1.5419e+00, 1.5728e+00, 1.4387e+00, 1.4848e+00, 3.8760e+05, 3.9782e+05,
         1.5527e+00, 3.8567e+05, 1.5500e+00, 3.9729e+05, 1.6355e+00, 1.5040e+00],
        [7.6673e+05, 3.8594e+05, 0.0000e+00, 3.8594e+05, 3.8593e+05, 7.8402e+05,
         3.8594e+05, 3.8593e+05, 3.8595e+05, 3.8596e+05, 7.6338e+05, 7.8781e+05,
         3.8593e+05, 7.8043e+05, 3.8594e+05, 7.8382e+05, 3.8598e+05, 3.8594e+05],
        [3.9452e+05, 2.1174e+00, 3.8594e+05, 0.0000e+00, 1.7540e+00, 3.8737e+05,
         1.8488e+00, 1.9213e+00, 1.8573e+00, 1.9319e+00, 3.8762e+05, 3.9780e+05,
         1.7830e+00, 3.8568e+05, 1.8208e+00, 3.9727e+05, 1.7496e+00, 1.8170e+00],
        [3.9452e+05, 1.5981e+00, 3.8593e+05, 1.7540e+00, 0.0000e+00, 3.8734e+05,
         1.5139e+00, 1.5391e+00, 1.3946e+00, 1.4219e+00, 3.8758e+05, 3.9780e+05,
         1.6281e+00, 3.8569e+05, 1.4508e+00, 3.9729e+05, 1.4747e+00, 1.4515e+00],
        [7.7553e+05, 3.8733e+05, 7.8402e+05, 3.8737e+05, 3.8734e+05, 0.0000e+00,
         3.8735e+05, 3.8733e+05, 3.8732e+05, 3.8734e+05, 7.6802e+05, 7.8176e+05,
         3.8733e+05, 7.6354e+05, 3.8739e+05, 7.8586e+05, 3.8736e+05, 3.8736e+05],
        [3.9452e+05, 1.5419e+00, 3.8594e+05, 1.8488e+00, 1.5139e+00, 3.8735e+05,
         0.0000e+00, 1.4241e+00, 1.3659e+00, 1.5551e+00, 3.8757e+05, 3.9778e+05,
         1.4550e+00, 3.8566e+05, 1.4944e+00, 3.9727e+05, 1.6326e+00, 1.4839e+00],
        [3.9451e+05, 1.5728e+00, 3.8593e+05, 1.9213e+00, 1.5391e+00, 3.8733e+05,
         1.4241e+00, 0.0000e+00, 1.4508e+00, 1.4038e+00, 3.8761e+05, 3.9781e+05,
         1.3866e+00, 3.8569e+05, 1.5065e+00, 3.9728e+05, 1.4956e+00, 1.5032e+00],
        [3.9453e+05, 1.4387e+00, 3.8595e+05, 1.8573e+00, 1.3946e+00, 3.8732e+05,
         1.3659e+00, 1.4508e+00, 0.0000e+00, 1.3102e+00, 3.8759e+05, 3.9779e+05,
         1.4769e+00, 3.8567e+05, 1.3940e+00, 3.9728e+05, 1.5624e+00, 1.3978e+00],
        [3.9452e+05, 1.4848e+00, 3.8596e+05, 1.9319e+00, 1.4219e+00, 3.8734e+05,
         1.5551e+00, 1.4038e+00, 1.3102e+00, 0.0000e+00, 3.8760e+05, 3.9781e+05,
         1.4372e+00, 3.8567e+05, 1.5160e+00, 3.9730e+05, 1.5406e+00, 1.4588e+00],
        [7.8477e+05, 3.8760e+05, 7.6338e+05, 3.8762e+05, 3.8758e+05, 7.6802e+05,
         3.8757e+05, 3.8761e+05, 3.8759e+05, 3.8760e+05, 0.0000e+00, 8.0770e+05,
         3.8760e+05, 7.7662e+05, 3.8764e+05, 7.9695e+05, 3.8759e+05, 3.8755e+05],
        [7.9093e+05, 3.9782e+05, 7.8781e+05, 3.9780e+05, 3.9780e+05, 7.8176e+05,
         3.9778e+05, 3.9781e+05, 3.9779e+05, 3.9781e+05, 8.0770e+05, 0.0000e+00,
         3.9779e+05, 7.7924e+05, 3.9783e+05, 8.0468e+05, 3.9782e+05, 3.9781e+05],
        [3.9450e+05, 1.5527e+00, 3.8593e+05, 1.7830e+00, 1.6281e+00, 3.8733e+05,
         1.4550e+00, 1.3866e+00, 1.4769e+00, 1.4372e+00, 3.8760e+05, 3.9779e+05,
         0.0000e+00, 3.8568e+05, 1.5065e+00, 3.9727e+05, 1.5348e+00, 1.5610e+00],
        [7.8954e+05, 3.8567e+05, 7.8043e+05, 3.8568e+05, 3.8569e+05, 7.6354e+05,
         3.8566e+05, 3.8569e+05, 3.8567e+05, 3.8567e+05, 7.7662e+05, 7.7924e+05,
         3.8568e+05, 0.0000e+00, 3.8570e+05, 8.0470e+05, 3.8567e+05, 3.8567e+05],
        [3.9452e+05, 1.5500e+00, 3.8594e+05, 1.8208e+00, 1.4508e+00, 3.8739e+05,
         1.4944e+00, 1.5065e+00, 1.3940e+00, 1.5160e+00, 3.8764e+05, 3.9783e+05,
         1.5065e+00, 3.8570e+05, 0.0000e+00, 3.9729e+05, 1.5869e+00, 1.4519e+00],
        [8.0155e+05, 3.9729e+05, 7.8382e+05, 3.9727e+05, 3.9729e+05, 7.8586e+05,
         3.9727e+05, 3.9728e+05, 3.9728e+05, 3.9730e+05, 7.9695e+05, 8.0468e+05,
         3.9727e+05, 8.0470e+05, 3.9729e+05, 0.0000e+00, 3.9730e+05, 3.9732e+05],
        [3.9451e+05, 1.6355e+00, 3.8598e+05, 1.7496e+00, 1.4747e+00, 3.8736e+05,
         1.6326e+00, 1.4956e+00, 1.5624e+00, 1.5406e+00, 3.8759e+05, 3.9782e+05,
         1.5348e+00, 3.8567e+05, 1.5869e+00, 3.9730e+05, 0.0000e+00, 1.4388e+00],
        [3.9450e+05, 1.5040e+00, 3.8594e+05, 1.8170e+00, 1.4515e+00, 3.8736e+05,
         1.4839e+00, 1.5032e+00, 1.3978e+00, 1.4588e+00, 3.8755e+05, 3.9781e+05,
         1.5610e+00, 3.8567e+05, 1.4519e+00, 3.9732e+05, 1.4388e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 394495.9688, 394500.4062, 394511.3750, 394512.4375,
        394517.4375, 394517.9375, 394519.0000, 394520.5625, 394522.8438,
        394523.5625, 394527.8438, 766728.2500, 775529.3750, 784771.0000,
        789536.0625, 790931.8125, 801548.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4387e+00, 1.4848e+00, 1.5040e+00, 1.5419e+00, 1.5500e+00,
        1.5527e+00, 1.5728e+00, 1.5981e+00, 1.6355e+00, 2.1174e+00, 3.8567e+05,
        3.8594e+05, 3.8733e+05, 3.8760e+05, 3.9452e+05, 3.9729e+05, 3.9782e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385931.9375, 385932.5625, 385933.4688, 385935.3438,
        385935.6250, 385937.4375, 385940.2812, 385944.8125, 385951.7500,
        385959.1875, 385975.5938, 763375.0000, 766728.2500, 780428.7500,
        783820.2500, 784023.6875, 787813.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7496e+00, 1.7540e+00, 1.7830e+00, 1.8170e+00, 1.8208e+00,
        1.8488e+00, 1.8573e+00, 1.9213e+00, 1.9319e+00, 2.1174e+00, 3.8568e+05,
        3.8594e+05, 3.8737e+05, 3.8762e+05, 3.9452e+05, 3.9727e+05, 3.9780e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3946e+00, 1.4219e+00, 1.4508e+00, 1.4515e+00, 1.4747e+00,
        1.5139e+00, 1.5391e+00, 1.5981e+00, 1.6281e+00, 1.7540e+00, 3.8569e+05,
        3.8593e+05, 3.8734e+05, 3.8758e+05, 3.9452e+05, 3.9729e+05, 3.9780e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387324.1250, 387325.4375, 387328.1562, 387332.4062,
        387336.9062, 387343.9375, 387352.6875, 387355.6250, 387362.5312,
        387368.9688, 387385.5312, 763536.3750, 768015.8125, 775529.3750,
        781761.4375, 784023.6875, 785864.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3659e+00, 1.4241e+00, 1.4550e+00, 1.4839e+00, 1.4944e+00,
        1.5139e+00, 1.5419e+00, 1.5551e+00, 1.6326e+00, 1.8488e+00, 3.8566e+05,
        3.8594e+05, 3.8735e+05, 3.8757e+05, 3.9452e+05, 3.9727e+05, 3.9778e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3866e+00, 1.4038e+00, 1.4241e+00, 1.4508e+00, 1.4956e+00,
        1.5032e+00, 1.5065e+00, 1.5391e+00, 1.5728e+00, 1.9213e+00, 3.8569e+05,
        3.8593e+05, 3.8733e+05, 3.8761e+05, 3.9451e+05, 3.9728e+05, 3.9781e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3102e+00, 1.3659e+00, 1.3940e+00, 1.3946e+00, 1.3978e+00,
        1.4387e+00, 1.4508e+00, 1.4769e+00, 1.5624e+00, 1.8573e+00, 3.8567e+05,
        3.8595e+05, 3.8732e+05, 3.8759e+05, 3.9453e+05, 3.9728e+05, 3.9779e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3102e+00, 1.4038e+00, 1.4219e+00, 1.4372e+00, 1.4588e+00,
        1.4848e+00, 1.5160e+00, 1.5406e+00, 1.5551e+00, 1.9319e+00, 3.8567e+05,
        3.8596e+05, 3.8734e+05, 3.8760e+05, 3.9452e+05, 3.9730e+05, 3.9781e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387548.6562, 387570.5312, 387576.3438, 387585.5938,
        387589.5938, 387599.5625, 387604.5625, 387604.8438, 387610.5625,
        387616.5938, 387637.6875, 763375.0000, 768015.8125, 776624.1250,
        784771.0000, 796945.8750, 807702.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397784.4375, 397791.5938, 397793.6562, 397800.8125,
        397804.9688, 397812.8750, 397813.4062, 397814.7188, 397817.1875,
        397823.0625, 397834.3125, 779240.1875, 781761.4375, 787813.6250,
        790931.8125, 804679.5625, 807702.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3866e+00, 1.4372e+00, 1.4550e+00, 1.4769e+00, 1.5065e+00,
        1.5348e+00, 1.5527e+00, 1.5610e+00, 1.6281e+00, 1.7830e+00, 3.8568e+05,
        3.8593e+05, 3.8733e+05, 3.8760e+05, 3.9450e+05, 3.9727e+05, 3.9779e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385659.2500, 385665.7188, 385668.0312, 385671.3125,
        385674.0625, 385674.8438, 385675.3750, 385677.8438, 385687.6875,
        385689.6562, 385700.5000, 763536.3750, 776624.1250, 779240.1875,
        780428.7500, 789536.0625, 804699.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3940e+00, 1.4508e+00, 1.4519e+00, 1.4944e+00, 1.5065e+00,
        1.5065e+00, 1.5160e+00, 1.5500e+00, 1.5869e+00, 1.8208e+00, 3.8570e+05,
        3.8594e+05, 3.8739e+05, 3.8764e+05, 3.9452e+05, 3.9729e+05, 3.9783e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397266.0000, 397269.3750, 397274.9688, 397280.1562,
        397284.0625, 397287.5625, 397293.4062, 397293.8438, 397296.2188,
        397300.8125, 397323.7500, 783820.2500, 785864.6875, 796945.8750,
        801548.5625, 804679.5625, 804699.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4388e+00, 1.4747e+00, 1.4956e+00, 1.5348e+00, 1.5406e+00,
        1.5624e+00, 1.5869e+00, 1.6326e+00, 1.6355e+00, 1.7496e+00, 3.8567e+05,
        3.8598e+05, 3.8736e+05, 3.8759e+05, 3.9451e+05, 3.9730e+05, 3.9782e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3978e+00, 1.4388e+00, 1.4515e+00, 1.4519e+00, 1.4588e+00,
        1.4839e+00, 1.5032e+00, 1.5040e+00, 1.5610e+00, 1.8170e+00, 3.8567e+05,
        3.8594e+05, 3.8736e+05, 3.8755e+05, 3.9450e+05, 3.9732e+05, 3.9781e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['394515.38', '35062.73', '385943.44', '35063.32', '35064.07', '387346.94', '35061.32', '35063.90', '35061.85', '35062.71', '387594.94', '397808.25', '35062.79', '385676.72', '35065.07', '397288.19', '35062.45', '35062.09']
estimated f for each client, fs: [5, 7, 5, 7, 7, 5, 7, 7, 7, 7, 5, 5, 7, 5, 7, 5, 7, 7]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 8, 17, 1, 5, 20, 6, 2, 12, 3, 18, 16, 9, 19, 11, 13, 7, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0157s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:31...
global Accuracy on shared test data: 78.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[189  48]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:31, End: 2025-07-22 15:45:31)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [19, 4, 12, 9, 6, 5, 7, 20, 11], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 4.0297e+05, 4.0299e+05, 4.0303e+05, 4.0299e+05, 4.0300e+05,
         4.0299e+05, 8.0062e+05, 4.0300e+05],
        [4.0297e+05, 0.0000e+00, 1.4160e+00, 1.5510e+00, 1.6708e+00, 1.5625e+00,
         1.4797e+00, 3.9237e+05, 1.5009e+00],
        [4.0299e+05, 1.4160e+00, 0.0000e+00, 1.4997e+00, 1.5556e+00, 1.3937e+00,
         1.5596e+00, 3.9239e+05, 1.4339e+00],
        [4.0303e+05, 1.5510e+00, 1.4997e+00, 0.0000e+00, 1.5667e+00, 1.6088e+00,
         1.5311e+00, 3.9239e+05, 1.4984e+00],
        [4.0299e+05, 1.6708e+00, 1.5556e+00, 1.5667e+00, 0.0000e+00, 1.6691e+00,
         1.6475e+00, 3.9238e+05, 1.6774e+00],
        [4.0300e+05, 1.5625e+00, 1.3937e+00, 1.6088e+00, 1.6691e+00, 0.0000e+00,
         1.4833e+00, 3.9238e+05, 1.4619e+00],
        [4.0299e+05, 1.4797e+00, 1.5596e+00, 1.5311e+00, 1.6475e+00, 1.4833e+00,
         0.0000e+00, 3.9237e+05, 1.5277e+00],
        [8.0062e+05, 3.9237e+05, 3.9239e+05, 3.9239e+05, 3.9238e+05, 3.9238e+05,
         3.9237e+05, 0.0000e+00, 3.9237e+05],
        [4.0300e+05, 1.5009e+00, 1.4339e+00, 1.4984e+00, 1.6774e+00, 1.4619e+00,
         1.5277e+00, 3.9237e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 402967.6875, 402985.7812, 402990.1875, 402993.0938,
        403002.7500, 403003.9375, 403025.0312, 800619.0000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.4160e+00, 1.4797e+00, 1.5009e+00, 1.5510e+00, 1.5625e+00,
        1.6708e+00, 3.9237e+05, 4.0297e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.3937e+00, 1.4160e+00, 1.4339e+00, 1.4997e+00, 1.5556e+00,
        1.5596e+00, 3.9239e+05, 4.0299e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.4984e+00, 1.4997e+00, 1.5311e+00, 1.5510e+00, 1.5667e+00,
        1.6088e+00, 3.9239e+05, 4.0303e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.5556e+00, 1.5667e+00, 1.6475e+00, 1.6691e+00, 1.6708e+00,
        1.6774e+00, 3.9238e+05, 4.0299e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.3937e+00, 1.4619e+00, 1.4833e+00, 1.5625e+00, 1.6088e+00,
        1.6691e+00, 3.9238e+05, 4.0300e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.4797e+00, 1.4833e+00, 1.5277e+00, 1.5311e+00, 1.5596e+00,
        1.6475e+00, 3.9237e+05, 4.0299e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 392365.9062, 392370.8125, 392371.3750, 392379.5938,
        392384.8750, 392387.4375, 392393.3125, 800619.0000])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.4339e+00, 1.4619e+00, 1.4984e+00, 1.5009e+00, 1.5277e+00,
        1.6774e+00, 3.9237e+05, 4.0300e+05])
Index of maximum distance difference after half of values: 6
adaptive_Krum scores:  ['402995.47', '1.53', '1.48', '1.54', '1.63', '1.53', '1.54', '392376.66', '1.52']
estimated f for each client, fs: [0, 2, 2, 2, 2, 2, 2, 2, 2]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [19, 4, 12, 9, 6, 5, 7, 20, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0077s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:32...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[191  46]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:32, End: 2025-07-22 15:45:32)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [2, 6, 15, 12, 10, 18, 16, 14, 1, 17, 11, 9, 19, 5, 3, 4, 7, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.5979e+00, 3.9159e+05, 1.7018e+00, 1.7752e+00, 3.9657e+05,
         3.7815e+05, 3.9540e+05, 1.7053e+00, 4.0364e+05, 1.6020e+00, 1.4702e+00,
         3.8061e+05, 1.6560e+00, 1.5103e+00, 1.5549e+00, 1.5162e+00, 3.8458e+05],
        [1.5979e+00, 0.0000e+00, 3.9156e+05, 1.3343e+00, 1.4792e+00, 3.9656e+05,
         3.7818e+05, 3.9540e+05, 1.3772e+00, 4.0365e+05, 1.6254e+00, 1.4736e+00,
         3.8059e+05, 1.5848e+00, 1.6691e+00, 1.4935e+00, 1.5689e+00, 3.8462e+05],
        [3.9159e+05, 3.9156e+05, 0.0000e+00, 3.9159e+05, 3.9157e+05, 8.0392e+05,
         7.7383e+05, 7.8741e+05, 3.9156e+05, 8.1745e+05, 3.9159e+05, 3.9160e+05,
         7.6079e+05, 3.9159e+05, 3.9159e+05, 3.9156e+05, 3.9157e+05, 7.7054e+05],
        [1.7018e+00, 1.3343e+00, 3.9159e+05, 0.0000e+00, 1.4978e+00, 3.9657e+05,
         3.7816e+05, 3.9543e+05, 1.4247e+00, 4.0366e+05, 1.6148e+00, 1.6539e+00,
         3.8057e+05, 1.5010e+00, 1.5413e+00, 1.5073e+00, 1.5903e+00, 3.8459e+05],
        [1.7752e+00, 1.4792e+00, 3.9157e+05, 1.4978e+00, 0.0000e+00, 3.9657e+05,
         3.7820e+05, 3.9546e+05, 1.4496e+00, 4.0364e+05, 1.7290e+00, 1.6719e+00,
         3.8056e+05, 1.6690e+00, 1.7133e+00, 1.6452e+00, 1.5130e+00, 3.8458e+05],
        [3.9657e+05, 3.9656e+05, 8.0392e+05, 3.9657e+05, 3.9657e+05, 0.0000e+00,
         7.6118e+05, 7.7038e+05, 3.9657e+05, 8.1295e+05, 3.9657e+05, 3.9657e+05,
         7.9387e+05, 3.9656e+05, 3.9657e+05, 3.9657e+05, 3.9655e+05, 7.8225e+05],
        [3.7815e+05, 3.7818e+05, 7.7383e+05, 3.7816e+05, 3.7820e+05, 7.6118e+05,
         0.0000e+00, 7.6422e+05, 3.7816e+05, 8.0961e+05, 3.7815e+05, 3.7815e+05,
         7.4645e+05, 3.7817e+05, 3.7815e+05, 3.7814e+05, 3.7816e+05, 7.7658e+05],
        [3.9540e+05, 3.9540e+05, 7.8741e+05, 3.9543e+05, 3.9546e+05, 7.7038e+05,
         7.6422e+05, 0.0000e+00, 3.9540e+05, 7.8466e+05, 3.9536e+05, 3.9542e+05,
         7.5020e+05, 3.9539e+05, 3.9539e+05, 3.9544e+05, 3.9543e+05, 7.7422e+05],
        [1.7053e+00, 1.3772e+00, 3.9156e+05, 1.4247e+00, 1.4496e+00, 3.9657e+05,
         3.7816e+05, 3.9540e+05, 0.0000e+00, 4.0361e+05, 1.6355e+00, 1.5944e+00,
         3.8057e+05, 1.6117e+00, 1.7312e+00, 1.6093e+00, 1.5624e+00, 3.8460e+05],
        [4.0364e+05, 4.0365e+05, 8.1745e+05, 4.0366e+05, 4.0364e+05, 8.1295e+05,
         8.0961e+05, 7.8466e+05, 4.0361e+05, 0.0000e+00, 4.0365e+05, 4.0362e+05,
         8.0039e+05, 4.0361e+05, 4.0363e+05, 4.0366e+05, 4.0363e+05, 7.9136e+05],
        [1.6020e+00, 1.6254e+00, 3.9159e+05, 1.6148e+00, 1.7290e+00, 3.9657e+05,
         3.7815e+05, 3.9536e+05, 1.6355e+00, 4.0365e+05, 0.0000e+00, 1.5215e+00,
         3.8058e+05, 1.4680e+00, 1.6517e+00, 1.5381e+00, 1.5304e+00, 3.8461e+05],
        [1.4702e+00, 1.4736e+00, 3.9160e+05, 1.6539e+00, 1.6719e+00, 3.9657e+05,
         3.7815e+05, 3.9542e+05, 1.5944e+00, 4.0362e+05, 1.5215e+00, 0.0000e+00,
         3.8057e+05, 1.6981e+00, 1.5144e+00, 1.6000e+00, 1.5395e+00, 3.8458e+05],
        [3.8061e+05, 3.8059e+05, 7.6079e+05, 3.8057e+05, 3.8056e+05, 7.9387e+05,
         7.4645e+05, 7.5020e+05, 3.8057e+05, 8.0039e+05, 3.8058e+05, 3.8057e+05,
         0.0000e+00, 3.8059e+05, 3.8060e+05, 3.8059e+05, 3.8059e+05, 7.6961e+05],
        [1.6560e+00, 1.5848e+00, 3.9159e+05, 1.5010e+00, 1.6690e+00, 3.9656e+05,
         3.7817e+05, 3.9539e+05, 1.6117e+00, 4.0361e+05, 1.4680e+00, 1.6981e+00,
         3.8059e+05, 0.0000e+00, 1.5419e+00, 1.6114e+00, 1.5012e+00, 3.8460e+05],
        [1.5103e+00, 1.6691e+00, 3.9159e+05, 1.5413e+00, 1.7133e+00, 3.9657e+05,
         3.7815e+05, 3.9539e+05, 1.7312e+00, 4.0363e+05, 1.6517e+00, 1.5144e+00,
         3.8060e+05, 1.5419e+00, 0.0000e+00, 1.5478e+00, 1.5673e+00, 3.8458e+05],
        [1.5549e+00, 1.4935e+00, 3.9156e+05, 1.5073e+00, 1.6452e+00, 3.9657e+05,
         3.7814e+05, 3.9544e+05, 1.6093e+00, 4.0366e+05, 1.5381e+00, 1.6000e+00,
         3.8059e+05, 1.6114e+00, 1.5478e+00, 0.0000e+00, 1.4824e+00, 3.8459e+05],
        [1.5162e+00, 1.5689e+00, 3.9157e+05, 1.5903e+00, 1.5130e+00, 3.9655e+05,
         3.7816e+05, 3.9543e+05, 1.5624e+00, 4.0363e+05, 1.5304e+00, 1.5395e+00,
         3.8059e+05, 1.5012e+00, 1.5673e+00, 1.4824e+00, 0.0000e+00, 3.8463e+05],
        [3.8458e+05, 3.8462e+05, 7.7054e+05, 3.8459e+05, 3.8458e+05, 7.8225e+05,
         7.7658e+05, 7.7422e+05, 3.8460e+05, 7.9136e+05, 3.8461e+05, 3.8458e+05,
         7.6961e+05, 3.8460e+05, 3.8458e+05, 3.8459e+05, 3.8463e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4702e+00, 1.5103e+00, 1.5162e+00, 1.5549e+00, 1.5979e+00,
        1.6020e+00, 1.6560e+00, 1.7018e+00, 1.7053e+00, 1.7752e+00, 3.7815e+05,
        3.8061e+05, 3.8458e+05, 3.9159e+05, 3.9540e+05, 3.9657e+05, 4.0364e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3343e+00, 1.3772e+00, 1.4736e+00, 1.4792e+00, 1.4935e+00,
        1.5689e+00, 1.5848e+00, 1.5979e+00, 1.6254e+00, 1.6691e+00, 3.7818e+05,
        3.8059e+05, 3.8462e+05, 3.9156e+05, 3.9540e+05, 3.9656e+05, 4.0365e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391562.1875, 391563.6875, 391563.8438, 391571.3750,
        391571.8750, 391585.1875, 391585.5312, 391588.4062, 391590.4062,
        391592.3438, 391597.4375, 760794.5000, 770543.8125, 773833.6875,
        787410.2500, 803919.9375, 817451.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3343e+00, 1.4247e+00, 1.4978e+00, 1.5010e+00, 1.5073e+00,
        1.5413e+00, 1.5903e+00, 1.6148e+00, 1.6539e+00, 1.7018e+00, 3.7816e+05,
        3.8057e+05, 3.8459e+05, 3.9159e+05, 3.9543e+05, 3.9657e+05, 4.0366e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4496e+00, 1.4792e+00, 1.4978e+00, 1.5130e+00, 1.6452e+00,
        1.6690e+00, 1.6719e+00, 1.7133e+00, 1.7290e+00, 1.7752e+00, 3.7820e+05,
        3.8056e+05, 3.8458e+05, 3.9157e+05, 3.9546e+05, 3.9657e+05, 4.0364e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396551.6875, 396557.0000, 396559.7188, 396565.6875,
        396565.8125, 396566.0000, 396571.1250, 396571.7812, 396572.2188,
        396573.5625, 396574.8750, 761180.6875, 770376.3750, 782253.6875,
        793874.0000, 803919.9375, 812950.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 378143.2812, 378149.2500, 378152.0000, 378153.8438,
        378153.8750, 378156.0000, 378157.3750, 378160.8438, 378165.5938,
        378181.6562, 378199.4688, 746445.5000, 761180.6875, 764222.2500,
        773833.6875, 776581.6250, 809611.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395364.5312, 395386.0000, 395391.8438, 395399.6562,
        395404.8750, 395404.9062, 395418.5000, 395428.6250, 395429.6562,
        395441.0000, 395461.5625, 750203.8125, 764222.2500, 770376.3750,
        774224.8750, 784655.1875, 787410.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3772e+00, 1.4247e+00, 1.4496e+00, 1.5624e+00, 1.5944e+00,
        1.6093e+00, 1.6117e+00, 1.6355e+00, 1.7053e+00, 1.7312e+00, 3.7816e+05,
        3.8057e+05, 3.8460e+05, 3.9156e+05, 3.9540e+05, 3.9657e+05, 4.0361e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 403607.1250, 403613.0625, 403622.1875, 403626.3750,
        403626.5625, 403644.0938, 403644.0938, 403648.1875, 403653.6562,
        403658.9062, 403662.9375, 784655.1875, 791355.1875, 800392.3125,
        809611.5625, 812950.8125, 817451.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4680e+00, 1.5215e+00, 1.5304e+00, 1.5381e+00, 1.6020e+00,
        1.6148e+00, 1.6254e+00, 1.6355e+00, 1.6517e+00, 1.7290e+00, 3.7815e+05,
        3.8058e+05, 3.8461e+05, 3.9159e+05, 3.9536e+05, 3.9657e+05, 4.0365e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4702e+00, 1.4736e+00, 1.5144e+00, 1.5215e+00, 1.5395e+00,
        1.5944e+00, 1.6000e+00, 1.6539e+00, 1.6719e+00, 1.6981e+00, 3.7815e+05,
        3.8057e+05, 3.8458e+05, 3.9160e+05, 3.9542e+05, 3.9657e+05, 4.0362e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 380558.4375, 380568.0312, 380573.1875, 380573.5625,
        380580.7188, 380585.0625, 380590.2188, 380591.3125, 380594.8750,
        380600.8750, 380606.5938, 746445.5000, 750203.8125, 760794.5000,
        769608.5000, 793874.0000, 800392.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4680e+00, 1.5010e+00, 1.5012e+00, 1.5419e+00, 1.5848e+00,
        1.6114e+00, 1.6117e+00, 1.6560e+00, 1.6690e+00, 1.6981e+00, 3.7817e+05,
        3.8059e+05, 3.8460e+05, 3.9159e+05, 3.9539e+05, 3.9656e+05, 4.0361e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5103e+00, 1.5144e+00, 1.5413e+00, 1.5419e+00, 1.5478e+00,
        1.5673e+00, 1.6517e+00, 1.6691e+00, 1.7133e+00, 1.7312e+00, 3.7815e+05,
        3.8060e+05, 3.8458e+05, 3.9159e+05, 3.9539e+05, 3.9657e+05, 4.0363e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4824e+00, 1.4935e+00, 1.5073e+00, 1.5381e+00, 1.5478e+00,
        1.5549e+00, 1.6000e+00, 1.6093e+00, 1.6114e+00, 1.6452e+00, 3.7814e+05,
        3.8059e+05, 3.8459e+05, 3.9156e+05, 3.9544e+05, 3.9657e+05, 4.0366e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4824e+00, 1.5012e+00, 1.5130e+00, 1.5162e+00, 1.5304e+00,
        1.5395e+00, 1.5624e+00, 1.5673e+00, 1.5689e+00, 1.5903e+00, 3.7816e+05,
        3.8059e+05, 3.8463e+05, 3.9157e+05, 3.9543e+05, 3.9655e+05, 4.0363e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384577.8438, 384578.4062, 384579.7812, 384584.3438,
        384585.0625, 384594.4062, 384599.5000, 384602.5000, 384607.6250,
        384619.4375, 384625.3438, 769608.5000, 770543.8125, 774224.8750,
        776581.6250, 782253.6875, 791355.1875])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34378.91', '34381.53', '391579.28', '34379.34', '34383.24', '396566.31', '378161.19', '395411.84', '34379.68', '403637.00', '34378.65', '34379.05', '380583.88', '34380.13', '34379.08', '34378.08', '34379.21', '384595.84']
estimated f for each client, fs: [7, 7, 5, 7, 7, 5, 5, 5, 7, 5, 7, 7, 5, 7, 7, 7, 7, 6]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']
 ['Update 16']
 ['Update 17']], selected_client_indices: [2, 6, 15, 12, 10, 18, 16, 14, 1, 17, 11, 9, 19, 5, 3, 4, 7, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0246s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:32...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[190  47]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:32, End: 2025-07-22 15:45:32)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [16, 19, 14, 17, 10, 7, 11, 9, 20, 13, 3, 4, 1, 8, 5, 12, 18, 15, 2, 6], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 7.6298e+05, 7.8700e+05, 8.0055e+05, 3.8782e+05, 3.8782e+05,
         3.8784e+05, 3.8783e+05, 7.6053e+05, 8.0761e+05, 3.8784e+05, 3.8783e+05,
         3.8785e+05, 3.8781e+05, 3.8785e+05, 3.8786e+05, 7.5922e+05, 7.8244e+05,
         3.8782e+05, 3.8782e+05],
        [7.6298e+05, 0.0000e+00, 7.8463e+05, 7.8357e+05, 3.8626e+05, 3.8627e+05,
         3.8626e+05, 3.8630e+05, 7.7569e+05, 7.8208e+05, 3.8627e+05, 3.8627e+05,
         3.8627e+05, 3.8624e+05, 3.8627e+05, 3.8627e+05, 7.5303e+05, 7.5820e+05,
         3.8627e+05, 3.8627e+05],
        [7.8700e+05, 7.8463e+05, 0.0000e+00, 7.9506e+05, 3.9437e+05, 3.9440e+05,
         3.9442e+05, 3.9440e+05, 7.7499e+05, 8.0649e+05, 3.9442e+05, 3.9442e+05,
         3.9440e+05, 3.9442e+05, 3.9441e+05, 3.9440e+05, 7.6262e+05, 7.5723e+05,
         3.9440e+05, 3.9440e+05],
        [8.0055e+05, 7.8357e+05, 7.9506e+05, 0.0000e+00, 4.0515e+05, 4.0516e+05,
         4.0520e+05, 4.0522e+05, 8.0346e+05, 8.2169e+05, 4.0522e+05, 4.0519e+05,
         4.0519e+05, 4.0523e+05, 4.0521e+05, 4.0522e+05, 7.6496e+05, 7.9648e+05,
         4.0523e+05, 4.0520e+05],
        [3.8782e+05, 3.8626e+05, 3.9437e+05, 4.0515e+05, 0.0000e+00, 1.4935e+00,
         1.6632e+00, 1.6386e+00, 3.8654e+05, 4.1213e+05, 1.6806e+00, 1.5910e+00,
         1.4064e+00, 1.7174e+00, 1.5946e+00, 1.4248e+00, 3.7884e+05, 3.8260e+05,
         1.6392e+00, 1.4285e+00],
        [3.8782e+05, 3.8627e+05, 3.9440e+05, 4.0516e+05, 1.4935e+00, 0.0000e+00,
         1.5335e+00, 1.5141e+00, 3.8651e+05, 4.1212e+05, 1.5729e+00, 1.6405e+00,
         1.5478e+00, 1.5801e+00, 1.5150e+00, 1.5181e+00, 3.7889e+05, 3.8257e+05,
         1.4572e+00, 1.5520e+00],
        [3.8784e+05, 3.8626e+05, 3.9442e+05, 4.0520e+05, 1.6632e+00, 1.5335e+00,
         0.0000e+00, 1.4567e+00, 3.8654e+05, 4.1211e+05, 1.5464e+00, 1.7266e+00,
         1.5747e+00, 1.4980e+00, 1.4495e+00, 1.5271e+00, 3.7885e+05, 3.8257e+05,
         1.4771e+00, 1.5581e+00],
        [3.8783e+05, 3.8630e+05, 3.9440e+05, 4.0522e+05, 1.6386e+00, 1.5141e+00,
         1.4567e+00, 0.0000e+00, 3.8657e+05, 4.1212e+05, 1.4621e+00, 1.8105e+00,
         1.5482e+00, 1.5038e+00, 1.6104e+00, 1.5160e+00, 3.7888e+05, 3.8259e+05,
         1.3803e+00, 1.4203e+00],
        [7.6053e+05, 7.7569e+05, 7.7499e+05, 8.0346e+05, 3.8654e+05, 3.8651e+05,
         3.8654e+05, 3.8657e+05, 0.0000e+00, 8.0885e+05, 3.8652e+05, 3.8654e+05,
         3.8652e+05, 3.8651e+05, 3.8654e+05, 3.8653e+05, 7.7491e+05, 7.6855e+05,
         3.8653e+05, 3.8652e+05],
        [8.0761e+05, 7.8208e+05, 8.0649e+05, 8.2169e+05, 4.1213e+05, 4.1212e+05,
         4.1211e+05, 4.1212e+05, 8.0885e+05, 0.0000e+00, 4.1216e+05, 4.1211e+05,
         4.1213e+05, 4.1210e+05, 4.1213e+05, 4.1216e+05, 7.8988e+05, 8.0285e+05,
         4.1211e+05, 4.1211e+05],
        [3.8784e+05, 3.8627e+05, 3.9442e+05, 4.0522e+05, 1.6806e+00, 1.5729e+00,
         1.5464e+00, 1.4621e+00, 3.8652e+05, 4.1216e+05, 0.0000e+00, 1.6759e+00,
         1.6724e+00, 1.5415e+00, 1.4761e+00, 1.4604e+00, 3.7890e+05, 3.8260e+05,
         1.4575e+00, 1.6228e+00],
        [3.8783e+05, 3.8627e+05, 3.9442e+05, 4.0519e+05, 1.5910e+00, 1.6405e+00,
         1.7266e+00, 1.8105e+00, 3.8654e+05, 4.1211e+05, 1.6759e+00, 0.0000e+00,
         1.4329e+00, 1.7763e+00, 1.6343e+00, 1.4439e+00, 3.7890e+05, 3.8258e+05,
         1.7501e+00, 1.5071e+00],
        [3.8785e+05, 3.8627e+05, 3.9440e+05, 4.0519e+05, 1.4064e+00, 1.5478e+00,
         1.5747e+00, 1.5482e+00, 3.8652e+05, 4.1213e+05, 1.6724e+00, 1.4329e+00,
         0.0000e+00, 1.7913e+00, 1.5337e+00, 1.3523e+00, 3.7890e+05, 3.8259e+05,
         1.6352e+00, 1.3332e+00],
        [3.8781e+05, 3.8624e+05, 3.9442e+05, 4.0523e+05, 1.7174e+00, 1.5801e+00,
         1.4980e+00, 1.5038e+00, 3.8651e+05, 4.1210e+05, 1.5415e+00, 1.7763e+00,
         1.7913e+00, 0.0000e+00, 1.6002e+00, 1.5592e+00, 3.7890e+05, 3.8260e+05,
         1.5478e+00, 1.6097e+00],
        [3.8785e+05, 3.8627e+05, 3.9441e+05, 4.0521e+05, 1.5946e+00, 1.5150e+00,
         1.4495e+00, 1.6104e+00, 3.8654e+05, 4.1213e+05, 1.4761e+00, 1.6343e+00,
         1.5337e+00, 1.6002e+00, 0.0000e+00, 1.4097e+00, 3.7888e+05, 3.8257e+05,
         1.5520e+00, 1.5335e+00],
        [3.8786e+05, 3.8627e+05, 3.9440e+05, 4.0522e+05, 1.4248e+00, 1.5181e+00,
         1.5271e+00, 1.5160e+00, 3.8653e+05, 4.1216e+05, 1.4604e+00, 1.4439e+00,
         1.3523e+00, 1.5592e+00, 1.4097e+00, 0.0000e+00, 3.7889e+05, 3.8256e+05,
         1.5718e+00, 1.2849e+00],
        [7.5922e+05, 7.5303e+05, 7.6262e+05, 7.6496e+05, 3.7884e+05, 3.7889e+05,
         3.7885e+05, 3.7888e+05, 7.7491e+05, 7.8988e+05, 3.7890e+05, 3.7890e+05,
         3.7890e+05, 3.7890e+05, 3.7888e+05, 3.7889e+05, 0.0000e+00, 7.7397e+05,
         3.7888e+05, 3.7889e+05],
        [7.8244e+05, 7.5820e+05, 7.5723e+05, 7.9648e+05, 3.8260e+05, 3.8257e+05,
         3.8257e+05, 3.8259e+05, 7.6855e+05, 8.0285e+05, 3.8260e+05, 3.8258e+05,
         3.8259e+05, 3.8260e+05, 3.8257e+05, 3.8256e+05, 7.7397e+05, 0.0000e+00,
         3.8256e+05, 3.8255e+05],
        [3.8782e+05, 3.8627e+05, 3.9440e+05, 4.0523e+05, 1.6392e+00, 1.4572e+00,
         1.4771e+00, 1.3803e+00, 3.8653e+05, 4.1211e+05, 1.4575e+00, 1.7501e+00,
         1.6352e+00, 1.5478e+00, 1.5520e+00, 1.5718e+00, 3.7888e+05, 3.8256e+05,
         0.0000e+00, 1.5214e+00],
        [3.8782e+05, 3.8627e+05, 3.9440e+05, 4.0520e+05, 1.4285e+00, 1.5520e+00,
         1.5581e+00, 1.4203e+00, 3.8652e+05, 4.1211e+05, 1.6228e+00, 1.5071e+00,
         1.3332e+00, 1.6097e+00, 1.5335e+00, 1.2849e+00, 3.7889e+05, 3.8255e+05,
         1.5214e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 387808.5312, 387817.5000, 387819.8125, 387821.3125,
        387823.6250, 387830.0625, 387832.6562, 387840.8750, 387841.7500,
        387848.2500, 387849.9688, 387860.5625, 759218.0625, 760534.2500,
        762979.8125, 782441.6875, 787002.5625, 800547.8125, 807611.1250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 386236.8438, 386264.3438, 386264.5000, 386266.2188,
        386266.4375, 386270.5625, 386271.4375, 386272.2500, 386273.1250,
        386273.5000, 386274.5312, 386296.3125, 753031.8750, 758196.4375,
        762979.8125, 775685.1250, 782084.2500, 783574.9375, 784632.1250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 394374.8750, 394395.2500, 394395.4062, 394395.8125,
        394397.1562, 394401.6875, 394403.6250, 394408.2500, 394417.7500,
        394420.3750, 394420.9062, 394424.6875, 757225.1250, 762618.8125,
        774993.5000, 784632.1250, 787002.5625, 795059.2500, 806494.4375])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 405153.5312, 405160.1875, 405190.1875, 405192.7188,
        405196.4375, 405200.6562, 405206.4062, 405215.1875, 405215.5312,
        405219.7500, 405225.9688, 405233.3125, 764956.2500, 783574.9375,
        795059.2500, 796477.1250, 800547.8125, 803461.2500, 821692.3125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4064e+00, 1.4248e+00, 1.4285e+00, 1.4935e+00, 1.5910e+00,
        1.5946e+00, 1.6386e+00, 1.6392e+00, 1.6632e+00, 1.6806e+00, 1.7174e+00,
        3.7884e+05, 3.8260e+05, 3.8626e+05, 3.8654e+05, 3.8782e+05, 3.9437e+05,
        4.0515e+05, 4.1213e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4572e+00, 1.4935e+00, 1.5141e+00, 1.5150e+00, 1.5181e+00,
        1.5335e+00, 1.5478e+00, 1.5520e+00, 1.5729e+00, 1.5801e+00, 1.6405e+00,
        3.7889e+05, 3.8257e+05, 3.8627e+05, 3.8651e+05, 3.8782e+05, 3.9440e+05,
        4.0516e+05, 4.1212e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4495e+00, 1.4567e+00, 1.4771e+00, 1.4980e+00, 1.5271e+00,
        1.5335e+00, 1.5464e+00, 1.5581e+00, 1.5747e+00, 1.6632e+00, 1.7266e+00,
        3.7885e+05, 3.8257e+05, 3.8626e+05, 3.8654e+05, 3.8784e+05, 3.9442e+05,
        4.0520e+05, 4.1211e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.3803e+00, 1.4203e+00, 1.4567e+00, 1.4621e+00, 1.5038e+00,
        1.5141e+00, 1.5160e+00, 1.5482e+00, 1.6104e+00, 1.6386e+00, 1.8105e+00,
        3.7888e+05, 3.8259e+05, 3.8630e+05, 3.8657e+05, 3.8783e+05, 3.9440e+05,
        4.0522e+05, 4.1212e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 386506.9688, 386508.4375, 386515.1875, 386521.1875,
        386523.5625, 386527.0000, 386529.5938, 386535.6562, 386543.3750,
        386543.5000, 386544.5938, 386573.5000, 760534.2500, 768547.4375,
        774905.6875, 774993.5000, 775685.1250, 803461.2500, 808847.5000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 412101.2188, 412106.2812, 412107.4375, 412108.2812,
        412112.9688, 412119.3750, 412121.5938, 412125.4062, 412131.1875,
        412131.7500, 412158.7812, 412163.1250, 782084.2500, 789882.5000,
        802849.6250, 806494.4375, 807611.1250, 808847.5000, 821692.3125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4575e+00, 1.4604e+00, 1.4621e+00, 1.4761e+00, 1.5415e+00,
        1.5464e+00, 1.5729e+00, 1.6228e+00, 1.6724e+00, 1.6759e+00, 1.6806e+00,
        3.7890e+05, 3.8260e+05, 3.8627e+05, 3.8652e+05, 3.8784e+05, 3.9442e+05,
        4.0522e+05, 4.1216e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4329e+00, 1.4439e+00, 1.5071e+00, 1.5910e+00, 1.6343e+00,
        1.6405e+00, 1.6759e+00, 1.7266e+00, 1.7501e+00, 1.7763e+00, 1.8105e+00,
        3.7890e+05, 3.8258e+05, 3.8627e+05, 3.8654e+05, 3.8783e+05, 3.9442e+05,
        4.0519e+05, 4.1211e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.3332e+00, 1.3523e+00, 1.4064e+00, 1.4329e+00, 1.5337e+00,
        1.5478e+00, 1.5482e+00, 1.5747e+00, 1.6352e+00, 1.6724e+00, 1.7913e+00,
        3.7890e+05, 3.8259e+05, 3.8627e+05, 3.8652e+05, 3.8785e+05, 3.9440e+05,
        4.0519e+05, 4.1213e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4980e+00, 1.5038e+00, 1.5415e+00, 1.5478e+00, 1.5592e+00,
        1.5801e+00, 1.6002e+00, 1.6097e+00, 1.7174e+00, 1.7763e+00, 1.7913e+00,
        3.7890e+05, 3.8260e+05, 3.8624e+05, 3.8651e+05, 3.8781e+05, 3.9442e+05,
        4.0523e+05, 4.1210e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4097e+00, 1.4495e+00, 1.4761e+00, 1.5150e+00, 1.5335e+00,
        1.5337e+00, 1.5520e+00, 1.5946e+00, 1.6002e+00, 1.6104e+00, 1.6343e+00,
        3.7888e+05, 3.8257e+05, 3.8627e+05, 3.8654e+05, 3.8785e+05, 3.9441e+05,
        4.0521e+05, 4.1213e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.2849e+00, 1.3523e+00, 1.4097e+00, 1.4248e+00, 1.4439e+00,
        1.4604e+00, 1.5160e+00, 1.5181e+00, 1.5271e+00, 1.5592e+00, 1.5718e+00,
        3.7889e+05, 3.8256e+05, 3.8627e+05, 3.8653e+05, 3.8786e+05, 3.9440e+05,
        4.0522e+05, 4.1216e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 378841.1562, 378848.2188, 378879.9062, 378880.0938,
        378884.9375, 378890.4688, 378890.9375, 378893.0312, 378896.9375,
        378897.6250, 378902.2500, 378902.5625, 753031.8750, 759218.0625,
        762618.8125, 764956.2500, 773973.2500, 774905.6875, 789882.5000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 382546.0000, 382558.5625, 382562.3438, 382567.3750,
        382569.5938, 382569.6562, 382575.3750, 382587.8125, 382590.0000,
        382596.0938, 382599.2188, 382604.9062, 757225.1250, 758196.4375,
        768547.4375, 773973.2500, 782441.6875, 796477.1250, 802849.6250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.3803e+00, 1.4572e+00, 1.4575e+00, 1.4771e+00, 1.5214e+00,
        1.5478e+00, 1.5520e+00, 1.5718e+00, 1.6352e+00, 1.6392e+00, 1.7501e+00,
        3.7888e+05, 3.8256e+05, 3.8627e+05, 3.8653e+05, 3.8782e+05, 3.9440e+05,
        4.0523e+05, 4.1211e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.2849e+00, 1.3332e+00, 1.4203e+00, 1.4285e+00, 1.5071e+00,
        1.5214e+00, 1.5335e+00, 1.5520e+00, 1.5581e+00, 1.6097e+00, 1.6228e+00,
        3.7889e+05, 3.8255e+05, 3.8627e+05, 3.8652e+05, 3.8782e+05, 3.9440e+05,
        4.0520e+05, 4.1211e+05])
Index of maximum distance difference after half of values: 12
adaptive_Krum scores:  ['387832.88', '386269.12', '394404.59', '405200.81', '31571.54', '31575.83', '31572.10', '31575.14', '386531.00', '412123.91', '31576.17', '31576.71', '31576.20', '31576.66', '31574.75', '31575.58', '378883.97', '382577.22', '31574.74', '31575.57']
estimated f for each client, fs: [6, 6, 6, 6, 8, 8, 8, 8, 6, 6, 8, 8, 8, 8, 8, 8, 6, 6, 8, 8]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [16, 19, 14, 17, 10, 7, 11, 9, 20, 13, 3, 4, 1, 8, 5, 12, 18, 15, 2, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0305s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:33...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:45:33, End: 2025-07-22 15:45:33)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [8, 4, 7, 16, 17, 1, 18, 5, 20, 19, 11, 3, 2, 13, 9, 14, 10, 15, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.3189e+00, 1.3510e+00, 3.9264e+05, 3.8594e+05, 1.5096e+00,
         4.0076e+05, 1.3272e+00, 4.0014e+05, 3.7106e+05, 1.3012e+00, 1.3277e+00,
         1.3332e+00, 3.8332e+05, 1.3077e+00, 3.8054e+05, 2.0351e+00, 3.8242e+05,
         1.3116e+00],
        [1.3189e+00, 0.0000e+00, 1.2583e+00, 3.9266e+05, 3.8596e+05, 1.1488e+00,
         4.0074e+05, 1.2757e+00, 4.0010e+05, 3.7107e+05, 1.3043e+00, 1.3273e+00,
         1.3146e+00, 3.8333e+05, 1.4131e+00, 3.8057e+05, 1.4609e+00, 3.8241e+05,
         1.0882e+00],
        [1.3510e+00, 1.2583e+00, 0.0000e+00, 3.9265e+05, 3.8597e+05, 1.3419e+00,
         4.0077e+05, 1.2712e+00, 4.0013e+05, 3.7105e+05, 1.3477e+00, 1.3814e+00,
         1.2759e+00, 3.8333e+05, 1.3813e+00, 3.8055e+05, 1.7550e+00, 3.8240e+05,
         1.2840e+00],
        [3.9264e+05, 3.9266e+05, 3.9265e+05, 0.0000e+00, 7.6939e+05, 3.9266e+05,
         8.0166e+05, 3.9268e+05, 8.1836e+05, 7.7351e+05, 3.9266e+05, 3.9267e+05,
         3.9268e+05, 7.7168e+05, 3.9269e+05, 7.7490e+05, 3.9267e+05, 7.7350e+05,
         3.9268e+05],
        [3.8594e+05, 3.8596e+05, 3.8597e+05, 7.6939e+05, 0.0000e+00, 3.8595e+05,
         7.9150e+05, 3.8598e+05, 7.9135e+05, 7.5086e+05, 3.8594e+05, 3.8597e+05,
         3.8594e+05, 7.8224e+05, 3.8595e+05, 7.5947e+05, 3.8590e+05, 7.6457e+05,
         3.8592e+05],
        [1.5096e+00, 1.1488e+00, 1.3419e+00, 3.9266e+05, 3.8595e+05, 0.0000e+00,
         4.0076e+05, 1.2966e+00, 4.0012e+05, 3.7106e+05, 1.3588e+00, 1.4084e+00,
         1.3655e+00, 3.8332e+05, 1.3420e+00, 3.8057e+05, 1.3505e+00, 3.8241e+05,
         1.1708e+00],
        [4.0076e+05, 4.0074e+05, 4.0077e+05, 8.0166e+05, 7.9150e+05, 4.0076e+05,
         0.0000e+00, 4.0076e+05, 8.2533e+05, 7.8421e+05, 4.0077e+05, 4.0077e+05,
         4.0077e+05, 7.8661e+05, 4.0078e+05, 7.8907e+05, 4.0077e+05, 7.9991e+05,
         4.0075e+05],
        [1.3272e+00, 1.2757e+00, 1.2712e+00, 3.9268e+05, 3.8598e+05, 1.2966e+00,
         4.0076e+05, 0.0000e+00, 4.0008e+05, 3.7106e+05, 1.2335e+00, 1.2404e+00,
         1.2656e+00, 3.8330e+05, 1.3639e+00, 3.8059e+05, 1.8501e+00, 3.8238e+05,
         1.1983e+00],
        [4.0014e+05, 4.0010e+05, 4.0013e+05, 8.1836e+05, 7.9135e+05, 4.0012e+05,
         8.2533e+05, 4.0008e+05, 0.0000e+00, 7.6852e+05, 4.0012e+05, 4.0010e+05,
         4.0013e+05, 7.6215e+05, 4.0014e+05, 7.6609e+05, 4.0013e+05, 7.7936e+05,
         4.0010e+05],
        [3.7106e+05, 3.7107e+05, 3.7105e+05, 7.7351e+05, 7.5086e+05, 3.7106e+05,
         7.8421e+05, 3.7106e+05, 7.6852e+05, 0.0000e+00, 3.7105e+05, 3.7108e+05,
         3.7104e+05, 7.5607e+05, 3.7104e+05, 7.3201e+05, 3.7103e+05, 7.6458e+05,
         3.7107e+05],
        [1.3012e+00, 1.3043e+00, 1.3477e+00, 3.9266e+05, 3.8594e+05, 1.3588e+00,
         4.0077e+05, 1.2335e+00, 4.0012e+05, 3.7105e+05, 0.0000e+00, 1.3502e+00,
         1.2589e+00, 3.8332e+05, 1.2567e+00, 3.8058e+05, 1.9803e+00, 3.8240e+05,
         1.3013e+00],
        [1.3277e+00, 1.3273e+00, 1.3814e+00, 3.9267e+05, 3.8597e+05, 1.4084e+00,
         4.0077e+05, 1.2404e+00, 4.0010e+05, 3.7108e+05, 1.3502e+00, 0.0000e+00,
         1.2275e+00, 3.8330e+05, 1.2668e+00, 3.8059e+05, 1.9154e+00, 3.8243e+05,
         1.1858e+00],
        [1.3332e+00, 1.3146e+00, 1.2759e+00, 3.9268e+05, 3.8594e+05, 1.3655e+00,
         4.0077e+05, 1.2656e+00, 4.0013e+05, 3.7104e+05, 1.2589e+00, 1.2275e+00,
         0.0000e+00, 3.8334e+05, 1.1971e+00, 3.8061e+05, 1.9293e+00, 3.8245e+05,
         1.2522e+00],
        [3.8332e+05, 3.8333e+05, 3.8333e+05, 7.7168e+05, 7.8224e+05, 3.8332e+05,
         7.8661e+05, 3.8330e+05, 7.6215e+05, 7.5607e+05, 3.8332e+05, 3.8330e+05,
         3.8334e+05, 0.0000e+00, 3.8330e+05, 7.6010e+05, 3.8329e+05, 7.5687e+05,
         3.8333e+05],
        [1.3077e+00, 1.4131e+00, 1.3813e+00, 3.9269e+05, 3.8595e+05, 1.3420e+00,
         4.0078e+05, 1.3639e+00, 4.0014e+05, 3.7104e+05, 1.2567e+00, 1.2668e+00,
         1.1971e+00, 3.8330e+05, 0.0000e+00, 3.8060e+05, 1.8985e+00, 3.8240e+05,
         1.3075e+00],
        [3.8054e+05, 3.8057e+05, 3.8055e+05, 7.7490e+05, 7.5947e+05, 3.8057e+05,
         7.8907e+05, 3.8059e+05, 7.6609e+05, 7.3201e+05, 3.8058e+05, 3.8059e+05,
         3.8061e+05, 7.6010e+05, 3.8060e+05, 0.0000e+00, 3.8057e+05, 7.4706e+05,
         3.8057e+05],
        [2.0351e+00, 1.4609e+00, 1.7550e+00, 3.9267e+05, 3.8590e+05, 1.3505e+00,
         4.0077e+05, 1.8501e+00, 4.0013e+05, 3.7103e+05, 1.9803e+00, 1.9154e+00,
         1.9293e+00, 3.8329e+05, 1.8985e+00, 3.8057e+05, 0.0000e+00, 3.8242e+05,
         1.5075e+00],
        [3.8242e+05, 3.8241e+05, 3.8240e+05, 7.7350e+05, 7.6457e+05, 3.8241e+05,
         7.9991e+05, 3.8238e+05, 7.7936e+05, 7.6458e+05, 3.8240e+05, 3.8243e+05,
         3.8245e+05, 7.5687e+05, 3.8240e+05, 7.4706e+05, 3.8242e+05, 0.0000e+00,
         3.8239e+05],
        [1.3116e+00, 1.0882e+00, 1.2840e+00, 3.9268e+05, 3.8592e+05, 1.1708e+00,
         4.0075e+05, 1.1983e+00, 4.0010e+05, 3.7107e+05, 1.3013e+00, 1.1858e+00,
         1.2522e+00, 3.8333e+05, 1.3075e+00, 3.8057e+05, 1.5075e+00, 3.8239e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3012e+00, 1.3077e+00, 1.3116e+00, 1.3189e+00, 1.3272e+00,
        1.3277e+00, 1.3332e+00, 1.3510e+00, 1.5096e+00, 2.0351e+00, 3.7106e+05,
        3.8054e+05, 3.8242e+05, 3.8332e+05, 3.8594e+05, 3.9264e+05, 4.0014e+05,
        4.0076e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0882e+00, 1.1488e+00, 1.2583e+00, 1.2757e+00, 1.3043e+00,
        1.3146e+00, 1.3189e+00, 1.3273e+00, 1.4131e+00, 1.4609e+00, 3.7107e+05,
        3.8057e+05, 3.8241e+05, 3.8333e+05, 3.8596e+05, 3.9266e+05, 4.0010e+05,
        4.0074e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2583e+00, 1.2712e+00, 1.2759e+00, 1.2840e+00, 1.3419e+00,
        1.3477e+00, 1.3510e+00, 1.3813e+00, 1.3814e+00, 1.7550e+00, 3.7105e+05,
        3.8055e+05, 3.8240e+05, 3.8333e+05, 3.8597e+05, 3.9265e+05, 4.0013e+05,
        4.0077e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392644.9062, 392647.1250, 392657.4375, 392658.1875,
        392659.3125, 392666.0625, 392673.0938, 392678.1250, 392680.0625,
        392681.5938, 392689.5000, 769393.3125, 771677.4375, 773499.9375,
        773509.3125, 774904.5000, 801656.9375, 818358.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385895.4688, 385923.4375, 385936.8750, 385941.4688,
        385942.7188, 385952.5625, 385953.9062, 385957.0938, 385968.4062,
        385972.1875, 385980.0312, 750858.8750, 759472.3125, 764571.0625,
        769393.3125, 782241.6875, 791353.3750, 791503.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1488e+00, 1.1708e+00, 1.2966e+00, 1.3419e+00, 1.3420e+00,
        1.3505e+00, 1.3588e+00, 1.3655e+00, 1.4084e+00, 1.5096e+00, 3.7106e+05,
        3.8057e+05, 3.8241e+05, 3.8332e+05, 3.8595e+05, 3.9266e+05, 4.0012e+05,
        4.0076e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 400744.9375, 400748.5312, 400757.2500, 400757.6875,
        400760.5312, 400766.6875, 400767.3125, 400767.5000, 400769.8125,
        400774.2500, 400777.9375, 784213.5625, 786608.5625, 789074.7500,
        791503.1250, 799909.2500, 801656.9375, 825333.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1983e+00, 1.2335e+00, 1.2404e+00, 1.2656e+00, 1.2712e+00,
        1.2757e+00, 1.2966e+00, 1.3272e+00, 1.3639e+00, 1.8501e+00, 3.7106e+05,
        3.8059e+05, 3.8238e+05, 3.8330e+05, 3.8598e+05, 3.9268e+05, 4.0008e+05,
        4.0076e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 400079.6250, 400101.9688, 400103.3750, 400103.4688,
        400121.6875, 400122.6562, 400125.8750, 400130.0312, 400134.9688,
        400136.8750, 400137.3125, 762150.2500, 766091.0000, 768515.5000,
        779360.2500, 791353.3750, 818358.1250, 825333.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 371025.3438, 371040.5625, 371043.1562, 371047.6562,
        371048.1562, 371056.3438, 371056.6875, 371060.4375, 371068.3125,
        371069.9062, 371083.5312, 732006.0000, 750858.8750, 756073.0625,
        764578.4375, 768515.5000, 773509.3125, 784213.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2335e+00, 1.2567e+00, 1.2589e+00, 1.3012e+00, 1.3013e+00,
        1.3043e+00, 1.3477e+00, 1.3502e+00, 1.3588e+00, 1.9803e+00, 3.7105e+05,
        3.8058e+05, 3.8240e+05, 3.8332e+05, 3.8594e+05, 3.9266e+05, 4.0012e+05,
        4.0077e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1858e+00, 1.2275e+00, 1.2404e+00, 1.2668e+00, 1.3273e+00,
        1.3277e+00, 1.3502e+00, 1.3814e+00, 1.4084e+00, 1.9154e+00, 3.7108e+05,
        3.8059e+05, 3.8243e+05, 3.8330e+05, 3.8597e+05, 3.9267e+05, 4.0010e+05,
        4.0077e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1971e+00, 1.2275e+00, 1.2522e+00, 1.2589e+00, 1.2656e+00,
        1.2759e+00, 1.3146e+00, 1.3332e+00, 1.3655e+00, 1.9293e+00, 3.7104e+05,
        3.8061e+05, 3.8245e+05, 3.8334e+05, 3.8594e+05, 3.9268e+05, 4.0013e+05,
        4.0077e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 383291.5938, 383295.4062, 383295.9375, 383301.6875,
        383315.5000, 383317.0312, 383322.2500, 383325.4375, 383325.5312,
        383333.9688, 383342.7500, 756073.0625, 756867.7500, 760099.2500,
        762150.2500, 771677.4375, 782241.6875, 786608.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1971e+00, 1.2567e+00, 1.2668e+00, 1.3075e+00, 1.3077e+00,
        1.3420e+00, 1.3639e+00, 1.3813e+00, 1.4131e+00, 1.8985e+00, 3.7104e+05,
        3.8060e+05, 3.8240e+05, 3.8330e+05, 3.8595e+05, 3.9269e+05, 4.0014e+05,
        4.0078e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 380542.4375, 380548.0000, 380567.5625, 380571.7500,
        380574.6875, 380574.7500, 380584.4062, 380585.0312, 380593.4375,
        380597.8125, 380605.7500, 732006.0000, 747055.8750, 759472.3125,
        760099.2500, 766091.0000, 774904.5000, 789074.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3505e+00, 1.4609e+00, 1.5075e+00, 1.7550e+00, 1.8501e+00,
        1.8985e+00, 1.9154e+00, 1.9293e+00, 1.9803e+00, 2.0351e+00, 3.7103e+05,
        3.8057e+05, 3.8242e+05, 3.8329e+05, 3.8590e+05, 3.9267e+05, 4.0013e+05,
        4.0077e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382382.5938, 382391.7500, 382395.0312, 382398.0938,
        382403.0000, 382410.8125, 382413.1562, 382420.0312, 382420.4375,
        382428.8750, 382448.8125, 747055.8750, 756867.7500, 764571.0625,
        764578.4375, 773499.9375, 779360.2500, 799909.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0882e+00, 1.1708e+00, 1.1858e+00, 1.1983e+00, 1.2522e+00,
        1.2840e+00, 1.3013e+00, 1.3075e+00, 1.3116e+00, 1.5075e+00, 3.7107e+05,
        3.8057e+05, 3.8239e+05, 3.8333e+05, 3.8592e+05, 3.9268e+05, 4.0010e+05,
        4.0075e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['33734.05', '33734.66', '33732.84', '392666.88', '385947.66', '33733.64', '400762.97', '33733.60', '400117.97', '371054.53', '33732.89', '33736.11', '33732.18', '383315.19', '33732.44', '380576.88', '33731.18', '382410.25', '33734.78']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 6, 8, 6, 6, 8, 8, 8, 6, 8, 6, 8, 6, 8]
selected_index: 16
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']
 ['Update 17']
 ['Update 18']], selected_client_indices: [8, 4, 7, 16, 17, 1, 18, 5, 20, 19, 11, 3, 2, 13, 9, 14, 10, 15, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:34...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:34, End: 2025-07-22 15:45:34)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [17, 20, 7, 18, 16, 6, 9, 12, 19, 2, 5, 3, 13, 14, 8, 1], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.9245e+05, 3.8667e+05, 7.8904e+05, 7.8684e+05, 3.8666e+05,
         3.8667e+05, 3.8669e+05, 8.0749e+05, 3.8667e+05, 3.8667e+05, 3.8665e+05,
         8.1400e+05, 7.6605e+05, 3.8666e+05, 3.8668e+05],
        [7.9245e+05, 0.0000e+00, 3.9735e+05, 7.8529e+05, 7.9086e+05, 3.9732e+05,
         3.9734e+05, 3.9733e+05, 7.7157e+05, 3.9739e+05, 3.9734e+05, 3.9735e+05,
         7.9065e+05, 7.6770e+05, 3.9735e+05, 3.9734e+05],
        [3.8667e+05, 3.9735e+05, 0.0000e+00, 4.0701e+05, 3.9449e+05, 1.0352e+00,
         1.0726e+00, 1.0372e+00, 3.9904e+05, 1.0428e+00, 1.0195e+00, 1.1090e+00,
         4.0647e+05, 3.9418e+05, 1.0600e+00, 1.0714e+00],
        [7.8904e+05, 7.8529e+05, 4.0701e+05, 0.0000e+00, 8.1174e+05, 4.0700e+05,
         4.0702e+05, 4.0702e+05, 8.0346e+05, 4.0700e+05, 4.0702e+05, 4.0703e+05,
         8.3189e+05, 8.2039e+05, 4.0702e+05, 4.0700e+05],
        [7.8684e+05, 7.9086e+05, 3.9449e+05, 8.1174e+05, 0.0000e+00, 3.9453e+05,
         3.9450e+05, 3.9452e+05, 7.9132e+05, 3.9453e+05, 3.9452e+05, 3.9451e+05,
         7.9750e+05, 8.1357e+05, 3.9450e+05, 3.9451e+05],
        [3.8666e+05, 3.9732e+05, 1.0352e+00, 4.0700e+05, 3.9453e+05, 0.0000e+00,
         9.8688e-01, 8.6732e-01, 3.9903e+05, 1.0255e+00, 1.0117e+00, 1.0758e+00,
         4.0646e+05, 3.9417e+05, 1.0126e+00, 9.2479e-01],
        [3.8667e+05, 3.9734e+05, 1.0726e+00, 4.0702e+05, 3.9450e+05, 9.8688e-01,
         0.0000e+00, 1.0998e+00, 3.9903e+05, 9.8866e-01, 1.1035e+00, 1.0483e+00,
         4.0648e+05, 3.9415e+05, 1.0481e+00, 1.0522e+00],
        [3.8669e+05, 3.9733e+05, 1.0372e+00, 4.0702e+05, 3.9452e+05, 8.6732e-01,
         1.0998e+00, 0.0000e+00, 3.9903e+05, 1.0465e+00, 9.7515e-01, 9.7844e-01,
         4.0647e+05, 3.9415e+05, 1.0647e+00, 9.5409e-01],
        [8.0749e+05, 7.7157e+05, 3.9904e+05, 8.0346e+05, 7.9132e+05, 3.9903e+05,
         3.9903e+05, 3.9903e+05, 0.0000e+00, 3.9902e+05, 3.9901e+05, 3.9903e+05,
         8.1502e+05, 8.0324e+05, 3.9900e+05, 3.9903e+05],
        [3.8667e+05, 3.9739e+05, 1.0428e+00, 4.0700e+05, 3.9453e+05, 1.0255e+00,
         9.8866e-01, 1.0465e+00, 3.9902e+05, 0.0000e+00, 1.0565e+00, 9.9201e-01,
         4.0648e+05, 3.9414e+05, 1.0736e+00, 1.1160e+00],
        [3.8667e+05, 3.9734e+05, 1.0195e+00, 4.0702e+05, 3.9452e+05, 1.0117e+00,
         1.1035e+00, 9.7515e-01, 3.9901e+05, 1.0565e+00, 0.0000e+00, 1.0457e+00,
         4.0645e+05, 3.9413e+05, 1.0467e+00, 1.0378e+00],
        [3.8665e+05, 3.9735e+05, 1.1090e+00, 4.0703e+05, 3.9451e+05, 1.0758e+00,
         1.0483e+00, 9.7844e-01, 3.9903e+05, 9.9201e-01, 1.0457e+00, 0.0000e+00,
         4.0646e+05, 3.9416e+05, 1.0541e+00, 1.1527e+00],
        [8.1400e+05, 7.9065e+05, 4.0647e+05, 8.3189e+05, 7.9750e+05, 4.0646e+05,
         4.0648e+05, 4.0647e+05, 8.1502e+05, 4.0648e+05, 4.0645e+05, 4.0646e+05,
         0.0000e+00, 7.9261e+05, 4.0647e+05, 4.0649e+05],
        [7.6605e+05, 7.6770e+05, 3.9418e+05, 8.2039e+05, 8.1357e+05, 3.9417e+05,
         3.9415e+05, 3.9415e+05, 8.0324e+05, 3.9414e+05, 3.9413e+05, 3.9416e+05,
         7.9261e+05, 0.0000e+00, 3.9416e+05, 3.9413e+05],
        [3.8666e+05, 3.9735e+05, 1.0600e+00, 4.0702e+05, 3.9450e+05, 1.0126e+00,
         1.0481e+00, 1.0647e+00, 3.9900e+05, 1.0736e+00, 1.0467e+00, 1.0541e+00,
         4.0647e+05, 3.9416e+05, 0.0000e+00, 1.1825e+00],
        [3.8668e+05, 3.9734e+05, 1.0714e+00, 4.0700e+05, 3.9451e+05, 9.2479e-01,
         1.0522e+00, 9.5409e-01, 3.9903e+05, 1.1160e+00, 1.0378e+00, 1.1527e+00,
         4.0649e+05, 3.9413e+05, 1.1825e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 386651.6562, 386657.5000, 386661.0625, 386667.3750,
        386669.0625, 386669.6250, 386674.1875, 386676.5312, 386687.0625,
        766046.4375, 786836.4375, 789041.1250, 792450.3125, 807491.9375,
        814002.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397320.6875, 397330.7188, 397336.0312, 397336.5000,
        397341.3125, 397348.3750, 397348.5000, 397354.0625, 397386.7500,
        767698.8750, 771573.6875, 785286.2500, 790645.6250, 790864.0000,
        792450.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0195e+00, 1.0352e+00, 1.0372e+00, 1.0428e+00, 1.0600e+00,
        1.0714e+00, 1.0726e+00, 1.1090e+00, 3.8667e+05, 3.9418e+05, 3.9449e+05,
        3.9735e+05, 3.9904e+05, 4.0647e+05, 4.0701e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406995.6875, 407002.0938, 407004.0312, 407006.6875,
        407016.0000, 407017.1250, 407020.6250, 407024.4375, 407027.8750,
        785286.2500, 789041.1250, 803456.4375, 811737.6250, 820394.8750,
        831887.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394492.4062, 394495.1875, 394500.3750, 394510.8125,
        394514.5938, 394515.6250, 394515.8125, 394529.7812, 394531.2188,
        786836.4375, 790864.0000, 791321.6250, 797496.6250, 811737.6250,
        813569.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6732e-01, 9.2479e-01, 9.8688e-01, 1.0117e+00, 1.0126e+00,
        1.0255e+00, 1.0352e+00, 1.0758e+00, 3.8666e+05, 3.9417e+05, 3.9453e+05,
        3.9732e+05, 3.9903e+05, 4.0646e+05, 4.0700e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8688e-01, 9.8866e-01, 1.0481e+00, 1.0483e+00, 1.0522e+00,
        1.0726e+00, 1.0998e+00, 1.1035e+00, 3.8667e+05, 3.9415e+05, 3.9450e+05,
        3.9734e+05, 3.9903e+05, 4.0648e+05, 4.0702e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6732e-01, 9.5409e-01, 9.7515e-01, 9.7844e-01, 1.0372e+00,
        1.0465e+00, 1.0647e+00, 1.0998e+00, 3.8669e+05, 3.9415e+05, 3.9452e+05,
        3.9733e+05, 3.9903e+05, 4.0647e+05, 4.0702e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399005.0000, 399007.2812, 399021.5312, 399025.8125,
        399027.9062, 399028.1562, 399032.9688, 399033.2812, 399039.4375,
        771573.6875, 791321.6250, 803240.3125, 803456.4375, 807491.9375,
        815019.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8866e-01, 9.9201e-01, 1.0255e+00, 1.0428e+00, 1.0465e+00,
        1.0565e+00, 1.0736e+00, 1.1160e+00, 3.8667e+05, 3.9414e+05, 3.9453e+05,
        3.9739e+05, 3.9902e+05, 4.0648e+05, 4.0700e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7515e-01, 1.0117e+00, 1.0195e+00, 1.0378e+00, 1.0457e+00,
        1.0467e+00, 1.0565e+00, 1.1035e+00, 3.8667e+05, 3.9413e+05, 3.9452e+05,
        3.9734e+05, 3.9901e+05, 4.0645e+05, 4.0702e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7844e-01, 9.9201e-01, 1.0457e+00, 1.0483e+00, 1.0541e+00,
        1.0758e+00, 1.1090e+00, 1.1527e+00, 3.8665e+05, 3.9416e+05, 3.9451e+05,
        3.9735e+05, 3.9903e+05, 4.0646e+05, 4.0703e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406451.4062, 406456.6250, 406462.8125, 406468.5312,
        406469.0625, 406472.1250, 406477.2812, 406477.6875, 406485.5625,
        790645.6250, 792605.8750, 797496.6250, 814002.7500, 815019.1875,
        831887.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394132.5000, 394134.4062, 394144.0938, 394146.5312,
        394149.5312, 394157.7812, 394161.2500, 394171.1875, 394176.1875,
        766046.4375, 767698.8750, 792605.8750, 803240.3125, 813569.3750,
        820394.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0126e+00, 1.0467e+00, 1.0481e+00, 1.0541e+00, 1.0600e+00,
        1.0647e+00, 1.0736e+00, 1.1825e+00, 3.8666e+05, 3.9416e+05, 3.9450e+05,
        3.9735e+05, 3.9900e+05, 4.0647e+05, 4.0702e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2479e-01, 9.5409e-01, 1.0378e+00, 1.0522e+00, 1.0714e+00,
        1.1160e+00, 1.1527e+00, 1.1825e+00, 3.8668e+05, 3.9413e+05, 3.9451e+05,
        3.9734e+05, 3.9903e+05, 4.0649e+05, 4.0700e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['424606.06', '434380.16', '78085.43', '444840.09', '433744.19', '78083.66', '78082.41', '78084.48', '436279.56', '78081.98', '78081.51', '78082.14', '444886.66', '431341.94', '78082.74', '78081.95']
estimated f for each client, fs: [5, 5, 7, 5, 5, 7, 7, 7, 5, 7, 7, 7, 5, 5, 7, 7]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [17, 20, 7, 18, 16, 6, 9, 12, 19, 2, 5, 3, 13, 14, 8, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0106s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:34...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[189  48]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:34, End: 2025-07-22 15:45:34)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [20, 16, 2, 17, 15, 3, 11, 10, 1, 4, 12, 7, 14, 6, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 7.7840e+05, 3.9311e+05, 7.8075e+05, 7.7510e+05, 3.9313e+05,
         3.9315e+05, 3.9314e+05, 3.9313e+05, 3.9313e+05, 3.9313e+05, 3.9314e+05,
         7.8499e+05, 3.9314e+05, 7.9098e+05],
        [7.7840e+05, 0.0000e+00, 3.8822e+05, 7.7423e+05, 7.7208e+05, 3.8821e+05,
         3.8822e+05, 3.8819e+05, 3.8820e+05, 3.8821e+05, 3.8819e+05, 3.8821e+05,
         7.8808e+05, 3.8820e+05, 7.7030e+05],
        [3.9311e+05, 3.8822e+05, 0.0000e+00, 3.8992e+05, 3.8263e+05, 1.1115e+00,
         1.2394e+00, 1.8829e+00, 1.3149e+00, 1.2551e+00, 1.1765e+00, 1.1927e+00,
         4.0832e+05, 1.1630e+00, 3.9685e+05],
        [7.8075e+05, 7.7423e+05, 3.8992e+05, 0.0000e+00, 7.5692e+05, 3.8991e+05,
         3.8988e+05, 3.8993e+05, 3.8989e+05, 3.8989e+05, 3.8990e+05, 3.8991e+05,
         8.1022e+05, 3.8989e+05, 7.8473e+05],
        [7.7510e+05, 7.7208e+05, 3.8263e+05, 7.5692e+05, 0.0000e+00, 3.8263e+05,
         3.8263e+05, 3.8265e+05, 3.8264e+05, 3.8263e+05, 3.8263e+05, 3.8265e+05,
         7.8874e+05, 3.8263e+05, 7.7803e+05],
        [3.9313e+05, 3.8821e+05, 1.1115e+00, 3.8991e+05, 3.8263e+05, 0.0000e+00,
         1.2307e+00, 1.7906e+00, 1.3353e+00, 1.2381e+00, 1.1114e+00, 1.2439e+00,
         4.0833e+05, 1.2252e+00, 3.9686e+05],
        [3.9315e+05, 3.8822e+05, 1.2394e+00, 3.8988e+05, 3.8263e+05, 1.2307e+00,
         0.0000e+00, 1.8093e+00, 1.2924e+00, 1.2193e+00, 1.2355e+00, 1.2353e+00,
         4.0835e+05, 1.1707e+00, 3.9683e+05],
        [3.9314e+05, 3.8819e+05, 1.8829e+00, 3.8993e+05, 3.8265e+05, 1.7906e+00,
         1.8093e+00, 0.0000e+00, 1.2002e+00, 1.3039e+00, 1.3300e+00, 1.5830e+00,
         4.0832e+05, 1.3812e+00, 3.9682e+05],
        [3.9313e+05, 3.8820e+05, 1.3149e+00, 3.8989e+05, 3.8264e+05, 1.3353e+00,
         1.2924e+00, 1.2002e+00, 0.0000e+00, 1.0893e+00, 1.1011e+00, 1.2238e+00,
         4.0834e+05, 1.1175e+00, 3.9682e+05],
        [3.9313e+05, 3.8821e+05, 1.2551e+00, 3.8989e+05, 3.8263e+05, 1.2381e+00,
         1.2193e+00, 1.3039e+00, 1.0893e+00, 0.0000e+00, 1.0401e+00, 1.1403e+00,
         4.0833e+05, 1.0944e+00, 3.9686e+05],
        [3.9313e+05, 3.8819e+05, 1.1765e+00, 3.8990e+05, 3.8263e+05, 1.1114e+00,
         1.2355e+00, 1.3300e+00, 1.1011e+00, 1.0401e+00, 0.0000e+00, 1.1882e+00,
         4.0829e+05, 9.7424e-01, 3.9683e+05],
        [3.9314e+05, 3.8821e+05, 1.1927e+00, 3.8991e+05, 3.8265e+05, 1.2439e+00,
         1.2353e+00, 1.5830e+00, 1.2238e+00, 1.1403e+00, 1.1882e+00, 0.0000e+00,
         4.0832e+05, 1.1782e+00, 3.9685e+05],
        [7.8499e+05, 7.8808e+05, 4.0832e+05, 8.1022e+05, 7.8874e+05, 4.0833e+05,
         4.0835e+05, 4.0832e+05, 4.0834e+05, 4.0833e+05, 4.0829e+05, 4.0832e+05,
         0.0000e+00, 4.0832e+05, 8.0958e+05],
        [3.9314e+05, 3.8820e+05, 1.1630e+00, 3.8989e+05, 3.8263e+05, 1.2252e+00,
         1.1707e+00, 1.3812e+00, 1.1175e+00, 1.0944e+00, 9.7424e-01, 1.1782e+00,
         4.0832e+05, 0.0000e+00, 3.9685e+05],
        [7.9098e+05, 7.7030e+05, 3.9685e+05, 7.8473e+05, 7.7803e+05, 3.9686e+05,
         3.9683e+05, 3.9682e+05, 3.9682e+05, 3.9686e+05, 3.9683e+05, 3.9685e+05,
         8.0958e+05, 3.9685e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 393110.2188, 393125.5625, 393128.0312, 393132.2812,
        393134.8125, 393137.5000, 393138.0000, 393143.5000, 393147.5000,
        775097.3750, 778397.6875, 780745.5625, 784992.7500, 790980.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388187.5625, 388189.1562, 388197.5625, 388198.9375,
        388205.5312, 388209.7188, 388213.2500, 388215.1250, 388216.1250,
        770302.6875, 772083.2500, 774230.6250, 778397.6875, 788079.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1115e+00, 1.1630e+00, 1.1765e+00, 1.1927e+00, 1.2394e+00,
        1.2551e+00, 1.3149e+00, 1.8829e+00, 3.8263e+05, 3.8822e+05, 3.8992e+05,
        3.9311e+05, 3.9685e+05, 4.0832e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389884.5625, 389889.3438, 389889.8125, 389894.4062,
        389903.2188, 389906.7188, 389912.1250, 389919.9375, 389933.0000,
        756920.6250, 774230.6250, 780745.5625, 784726.9375, 810222.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 382628.1250, 382629.4688, 382631.5312, 382631.6562,
        382631.8125, 382632.5312, 382638.1875, 382648.1875, 382652.8125,
        756920.6250, 772083.2500, 775097.3750, 778034.1875, 788738.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1114e+00, 1.1115e+00, 1.2252e+00, 1.2307e+00, 1.2381e+00,
        1.2439e+00, 1.3353e+00, 1.7906e+00, 3.8263e+05, 3.8821e+05, 3.8991e+05,
        3.9313e+05, 3.9686e+05, 4.0833e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1707e+00, 1.2193e+00, 1.2307e+00, 1.2353e+00, 1.2355e+00,
        1.2394e+00, 1.2924e+00, 1.8093e+00, 3.8263e+05, 3.8822e+05, 3.8988e+05,
        3.9315e+05, 3.9683e+05, 4.0835e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2002e+00, 1.3039e+00, 1.3300e+00, 1.3812e+00, 1.5830e+00,
        1.7906e+00, 1.8093e+00, 1.8829e+00, 3.8265e+05, 3.8819e+05, 3.8993e+05,
        3.9314e+05, 3.9682e+05, 4.0832e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0893e+00, 1.1011e+00, 1.1175e+00, 1.2002e+00, 1.2238e+00,
        1.2924e+00, 1.3149e+00, 1.3353e+00, 3.8264e+05, 3.8820e+05, 3.8989e+05,
        3.9313e+05, 3.9682e+05, 4.0834e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0401e+00, 1.0893e+00, 1.0944e+00, 1.1403e+00, 1.2193e+00,
        1.2381e+00, 1.2551e+00, 1.3039e+00, 3.8263e+05, 3.8821e+05, 3.8989e+05,
        3.9313e+05, 3.9686e+05, 4.0833e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.7424e-01, 1.0401e+00, 1.1011e+00, 1.1114e+00, 1.1765e+00,
        1.1882e+00, 1.2355e+00, 1.3300e+00, 3.8263e+05, 3.8819e+05, 3.8990e+05,
        3.9313e+05, 3.9683e+05, 4.0829e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1403e+00, 1.1782e+00, 1.1882e+00, 1.1927e+00, 1.2238e+00,
        1.2353e+00, 1.2439e+00, 1.5830e+00, 3.8265e+05, 3.8821e+05, 3.8991e+05,
        3.9314e+05, 3.9685e+05, 4.0832e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 408292.5625, 408318.7188, 408319.3125, 408321.8750,
        408323.3125, 408329.5312, 408331.2812, 408344.8438, 408346.2188,
        784992.7500, 788079.0000, 788738.8125, 809583.2500, 810222.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.7424e-01, 1.0944e+00, 1.1175e+00, 1.1630e+00, 1.1707e+00,
        1.1782e+00, 1.2252e+00, 1.3812e+00, 3.8263e+05, 3.8820e+05, 3.8989e+05,
        3.9314e+05, 3.9685e+05, 4.0832e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396817.5000, 396823.6875, 396829.5625, 396832.5000,
        396846.0625, 396851.0312, 396852.3750, 396856.3125, 396856.9688,
        770302.6875, 778034.1875, 784726.9375, 790980.7500, 809583.2500])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['393133.06', '388203.69', '42515.39', '389903.69', '382636.09', '42515.53', '42515.80', '42518.34', '42516.43', '42515.68', '42515.63', '42517.58', '408325.28', '42515.76', '396840.69']
estimated f for each client, fs: [4, 4, 6, 4, 4, 6, 6, 6, 6, 6, 6, 6, 4, 6, 4]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [20, 16, 2, 17, 15, 3, 11, 10, 1, 4, 12, 7, 14, 6, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0116s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:35...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:35, End: 2025-07-22 15:45:35)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [6, 15, 16, 5, 3, 7, 10, 14, 17, 1, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
tensor([[0.0000e+00, 3.9764e+05, 3.8971e+05, 1.2917e+00, 1.3666e+00, 1.3397e+00,
         1.4030e+00, 3.8207e+05, 3.8595e+05, 1.2386e+00, 1.1302e+00],
        [3.9764e+05, 0.0000e+00, 7.8617e+05, 3.9762e+05, 3.9765e+05, 3.9765e+05,
         3.9765e+05, 7.7958e+05, 7.8008e+05, 3.9764e+05, 3.9765e+05],
        [3.8971e+05, 7.8617e+05, 0.0000e+00, 3.8970e+05, 3.8970e+05, 3.8969e+05,
         3.8968e+05, 7.5790e+05, 7.5296e+05, 3.8974e+05, 3.8969e+05],
        [1.2917e+00, 3.9762e+05, 3.8970e+05, 0.0000e+00, 1.4168e+00, 1.3741e+00,
         1.3004e+00, 3.8209e+05, 3.8595e+05, 1.2399e+00, 1.2640e+00],
        [1.3666e+00, 3.9765e+05, 3.8970e+05, 1.4168e+00, 0.0000e+00, 1.4301e+00,
         1.7826e+00, 3.8205e+05, 3.8598e+05, 1.4735e+00, 1.2098e+00],
        [1.3397e+00, 3.9765e+05, 3.8969e+05, 1.3741e+00, 1.4301e+00, 0.0000e+00,
         1.6088e+00, 3.8206e+05, 3.8595e+05, 1.3469e+00, 1.2952e+00],
        [1.4030e+00, 3.9765e+05, 3.8968e+05, 1.3004e+00, 1.7826e+00, 1.6088e+00,
         0.0000e+00, 3.8210e+05, 3.8597e+05, 1.2652e+00, 1.4237e+00],
        [3.8207e+05, 7.7958e+05, 7.5790e+05, 3.8209e+05, 3.8205e+05, 3.8206e+05,
         3.8210e+05, 0.0000e+00, 7.6891e+05, 3.8206e+05, 3.8208e+05],
        [3.8595e+05, 7.8008e+05, 7.5296e+05, 3.8595e+05, 3.8598e+05, 3.8595e+05,
         3.8597e+05, 7.6891e+05, 0.0000e+00, 3.8598e+05, 3.8596e+05],
        [1.2386e+00, 3.9764e+05, 3.8974e+05, 1.2399e+00, 1.4735e+00, 1.3469e+00,
         1.2652e+00, 3.8206e+05, 3.8598e+05, 0.0000e+00, 1.2621e+00],
        [1.1302e+00, 3.9765e+05, 3.8969e+05, 1.2640e+00, 1.2098e+00, 1.2952e+00,
         1.4237e+00, 3.8208e+05, 3.8596e+05, 1.2621e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1302e+00, 1.2386e+00, 1.2917e+00, 1.3397e+00, 1.3666e+00,
        1.4030e+00, 3.8207e+05, 3.8595e+05, 3.8971e+05, 3.9764e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 397615.3125, 397636.4375, 397637.1875, 397646.5625,
        397646.8125, 397652.2812, 397652.3438, 779583.9375, 780076.5625,
        786168.8125])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 389684.1250, 389686.2188, 389690.3438, 389698.3750,
        389700.1562, 389705.5312, 389741.3125, 752955.2500, 757900.1875,
        786168.8125])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.2399e+00, 1.2640e+00, 1.2917e+00, 1.3004e+00, 1.3741e+00,
        1.4168e+00, 3.8209e+05, 3.8595e+05, 3.8970e+05, 3.9762e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.2098e+00, 1.3666e+00, 1.4168e+00, 1.4301e+00, 1.4735e+00,
        1.7826e+00, 3.8205e+05, 3.8598e+05, 3.8970e+05, 3.9765e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.2952e+00, 1.3397e+00, 1.3469e+00, 1.3741e+00, 1.4301e+00,
        1.6088e+00, 3.8206e+05, 3.8595e+05, 3.8969e+05, 3.9765e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.2652e+00, 1.3004e+00, 1.4030e+00, 1.4237e+00, 1.6088e+00,
        1.7826e+00, 3.8210e+05, 3.8597e+05, 3.8968e+05, 3.9765e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 382046.3125, 382055.2188, 382064.1250, 382068.1250,
        382082.0312, 382094.6875, 382104.4688, 757900.1875, 768908.9375,
        779583.9375])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 385948.5625, 385951.9375, 385954.7188, 385961.5000,
        385968.7812, 385978.3438, 385981.5625, 752955.2500, 768908.9375,
        780076.5625])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.2386e+00, 1.2399e+00, 1.2621e+00, 1.2652e+00, 1.3469e+00,
        1.4735e+00, 3.8206e+05, 3.8598e+05, 3.8974e+05, 3.9764e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.1302e+00, 1.2098e+00, 1.2621e+00, 1.2640e+00, 1.2952e+00,
        1.4237e+00, 3.8208e+05, 3.8596e+05, 3.8969e+05, 3.9765e+05])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['54582.28', '397641.03', '389700.88', '54586.08', '54579.29', '54580.52', '54587.61', '382073.62', '385963.66', '54581.70', '54584.23']
estimated f for each client, fs: [4, 2, 2, 4, 4, 4, 4, 2, 2, 4, 4]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [6, 15, 16, 5, 3, 7, 10, 14, 17, 1, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0068s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:35...
global Accuracy on shared test data: 77.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:35, End: 2025-07-22 15:45:35)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [11, 2, 15, 9, 7, 10, 13, 20, 3, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 1.3968e+00, 4.0158e+05, 1.3179e+00, 1.3677e+00, 1.9349e+00,
         3.8975e+05, 3.9083e+05, 1.6191e+00, 3.8874e+05],
        [1.3968e+00, 0.0000e+00, 4.0156e+05, 1.2641e+00, 1.2697e+00, 1.4362e+00,
         3.8977e+05, 3.9079e+05, 1.3345e+00, 3.8874e+05],
        [4.0158e+05, 4.0156e+05, 0.0000e+00, 4.0155e+05, 4.0156e+05, 4.0156e+05,
         7.7639e+05, 7.8091e+05, 4.0157e+05, 7.8609e+05],
        [1.3179e+00, 1.2641e+00, 4.0155e+05, 0.0000e+00, 1.3888e+00, 1.8147e+00,
         3.8978e+05, 3.9081e+05, 1.5399e+00, 3.8877e+05],
        [1.3677e+00, 1.2697e+00, 4.0156e+05, 1.3888e+00, 0.0000e+00, 1.6959e+00,
         3.8978e+05, 3.9080e+05, 1.5398e+00, 3.8875e+05],
        [1.9349e+00, 1.4362e+00, 4.0156e+05, 1.8147e+00, 1.6959e+00, 0.0000e+00,
         3.8974e+05, 3.9083e+05, 1.3912e+00, 3.8874e+05],
        [3.8975e+05, 3.8977e+05, 7.7639e+05, 3.8978e+05, 3.8978e+05, 3.8974e+05,
         0.0000e+00, 8.0652e+05, 3.8978e+05, 7.6581e+05],
        [3.9083e+05, 3.9079e+05, 7.8091e+05, 3.9081e+05, 3.9080e+05, 3.9083e+05,
         8.0652e+05, 0.0000e+00, 3.9081e+05, 8.0845e+05],
        [1.6191e+00, 1.3345e+00, 4.0157e+05, 1.5399e+00, 1.5398e+00, 1.3912e+00,
         3.8978e+05, 3.9081e+05, 0.0000e+00, 3.8873e+05],
        [3.8874e+05, 3.8874e+05, 7.8609e+05, 3.8877e+05, 3.8875e+05, 3.8874e+05,
         7.6581e+05, 8.0845e+05, 3.8873e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3179e+00, 1.3677e+00, 1.3968e+00, 1.6191e+00, 1.9349e+00,
        3.8874e+05, 3.8975e+05, 3.9083e+05, 4.0158e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.2641e+00, 1.2697e+00, 1.3345e+00, 1.3968e+00, 1.4362e+00,
        3.8874e+05, 3.8977e+05, 3.9079e+05, 4.0156e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 401548.8125, 401560.6250, 401562.0000, 401563.9062,
        401567.3125, 401577.7500, 776386.2500, 780908.2500, 786086.6250])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.2641e+00, 1.3179e+00, 1.3888e+00, 1.5399e+00, 1.8147e+00,
        3.8877e+05, 3.8978e+05, 3.9081e+05, 4.0155e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.2697e+00, 1.3677e+00, 1.3888e+00, 1.5398e+00, 1.6959e+00,
        3.8875e+05, 3.8978e+05, 3.9080e+05, 4.0156e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.3912e+00, 1.4362e+00, 1.6959e+00, 1.8147e+00, 1.9349e+00,
        3.8874e+05, 3.8974e+05, 3.9083e+05, 4.0156e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 389740.2812, 389747.4375, 389769.3438, 389778.6250,
        389779.1250, 389780.8750, 765809.8750, 776386.2500, 806521.4375])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 390791.8438, 390804.5000, 390811.1562, 390811.2188,
        390826.7188, 390834.7500, 780908.2500, 806521.4375, 808454.1250])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.3345e+00, 1.3912e+00, 1.5398e+00, 1.5399e+00, 1.6191e+00,
        3.8873e+05, 3.8978e+05, 3.9081e+05, 4.0157e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 388726.3125, 388735.5000, 388738.6250, 388743.1875,
        388752.2500, 388774.0625, 765809.8750, 786086.6250, 808454.1250])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['111212.95', '111216.37', '455109.53', '111223.19', '111219.81', '111213.09', '443486.53', '446541.19', '111216.06', '442611.34']
estimated f for each client, fs: [4, 4, 2, 4, 4, 4, 2, 2, 4, 2]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [11, 2, 15, 9, 7, 10, 13, 20, 3, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0101s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:36...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:36, End: 2025-07-22 15:45:36)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [15, 9, 10, 19, 11, 1, 12, 14, 3, 5, 2, 4, 18, 16, 6, 17, 7, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.8876e+05, 3.8877e+05, 7.7116e+05, 3.8878e+05, 3.8877e+05,
         3.8876e+05, 7.6228e+05, 3.8874e+05, 3.8875e+05, 3.8874e+05, 3.8875e+05,
         7.6097e+05, 8.0274e+05, 3.8875e+05, 7.6600e+05, 3.8877e+05, 3.8873e+05],
        [3.8876e+05, 0.0000e+00, 1.8683e+00, 3.8557e+05, 1.5843e+00, 1.5205e+00,
         1.4167e+00, 3.8243e+05, 1.4934e+00, 1.6251e+00, 1.3044e+00, 1.5773e+00,
         3.8441e+05, 4.1456e+05, 1.4338e+00, 3.8551e+05, 1.4853e+00, 1.3748e+00],
        [3.8877e+05, 1.8683e+00, 0.0000e+00, 3.8557e+05, 1.4459e+00, 1.4123e+00,
         1.5644e+00, 3.8246e+05, 1.4124e+00, 1.4369e+00, 1.5110e+00, 1.4567e+00,
         3.8448e+05, 4.1454e+05, 1.5317e+00, 3.8555e+05, 1.7389e+00, 2.0646e+00],
        [7.7116e+05, 3.8557e+05, 3.8557e+05, 0.0000e+00, 3.8558e+05, 3.8560e+05,
         3.8556e+05, 7.7381e+05, 3.8558e+05, 3.8557e+05, 3.8556e+05, 3.8559e+05,
         7.6808e+05, 8.0991e+05, 3.8559e+05, 7.5615e+05, 3.8558e+05, 3.8556e+05],
        [3.8878e+05, 1.5843e+00, 1.4459e+00, 3.8558e+05, 0.0000e+00, 1.4532e+00,
         1.4974e+00, 3.8246e+05, 1.4405e+00, 1.3872e+00, 1.4481e+00, 1.4186e+00,
         3.8445e+05, 4.1455e+05, 1.4492e+00, 3.8554e+05, 1.5206e+00, 1.6699e+00],
        [3.8877e+05, 1.5205e+00, 1.4123e+00, 3.8560e+05, 1.4532e+00, 0.0000e+00,
         1.3715e+00, 3.8246e+05, 1.4175e+00, 1.3644e+00, 1.3087e+00, 1.3737e+00,
         3.8446e+05, 4.1456e+05, 1.3719e+00, 3.8556e+05, 1.4763e+00, 1.6588e+00],
        [3.8876e+05, 1.4167e+00, 1.5644e+00, 3.8556e+05, 1.4974e+00, 1.3715e+00,
         0.0000e+00, 3.8244e+05, 1.2698e+00, 1.3368e+00, 1.2592e+00, 1.3121e+00,
         3.8443e+05, 4.1455e+05, 1.2897e+00, 3.8554e+05, 1.4267e+00, 1.3907e+00],
        [7.6228e+05, 3.8243e+05, 3.8246e+05, 7.7381e+05, 3.8246e+05, 3.8246e+05,
         3.8244e+05, 0.0000e+00, 3.8243e+05, 3.8245e+05, 3.8246e+05, 3.8243e+05,
         7.6782e+05, 7.8984e+05, 3.8246e+05, 7.6406e+05, 3.8245e+05, 3.8243e+05],
        [3.8874e+05, 1.4934e+00, 1.4124e+00, 3.8558e+05, 1.4405e+00, 1.4175e+00,
         1.2698e+00, 3.8243e+05, 0.0000e+00, 1.3449e+00, 1.2827e+00, 1.2952e+00,
         3.8446e+05, 4.1455e+05, 1.4736e+00, 3.8556e+05, 1.5064e+00, 1.5456e+00],
        [3.8875e+05, 1.6251e+00, 1.4369e+00, 3.8557e+05, 1.3872e+00, 1.3644e+00,
         1.3368e+00, 3.8245e+05, 1.3449e+00, 0.0000e+00, 1.3789e+00, 1.3887e+00,
         3.8445e+05, 4.1455e+05, 1.4183e+00, 3.8555e+05, 1.4245e+00, 1.6056e+00],
        [3.8874e+05, 1.3044e+00, 1.5110e+00, 3.8556e+05, 1.4481e+00, 1.3087e+00,
         1.2592e+00, 3.8246e+05, 1.2827e+00, 1.3789e+00, 0.0000e+00, 1.3207e+00,
         3.8440e+05, 4.1455e+05, 1.2653e+00, 3.8555e+05, 1.3026e+00, 1.4787e+00],
        [3.8875e+05, 1.5773e+00, 1.4567e+00, 3.8559e+05, 1.4186e+00, 1.3737e+00,
         1.3121e+00, 3.8243e+05, 1.2952e+00, 1.3887e+00, 1.3207e+00, 0.0000e+00,
         3.8443e+05, 4.1457e+05, 1.3913e+00, 3.8554e+05, 1.4185e+00, 1.5432e+00],
        [7.6097e+05, 3.8441e+05, 3.8448e+05, 7.6808e+05, 3.8445e+05, 3.8446e+05,
         3.8443e+05, 7.6782e+05, 3.8446e+05, 3.8445e+05, 3.8440e+05, 3.8443e+05,
         0.0000e+00, 7.8257e+05, 3.8444e+05, 7.6982e+05, 3.8442e+05, 3.8445e+05],
        [8.0274e+05, 4.1456e+05, 4.1454e+05, 8.0991e+05, 4.1455e+05, 4.1456e+05,
         4.1455e+05, 7.8984e+05, 4.1455e+05, 4.1455e+05, 4.1455e+05, 4.1457e+05,
         7.8257e+05, 0.0000e+00, 4.1455e+05, 8.0006e+05, 4.1454e+05, 4.1456e+05],
        [3.8875e+05, 1.4338e+00, 1.5317e+00, 3.8559e+05, 1.4492e+00, 1.3719e+00,
         1.2897e+00, 3.8246e+05, 1.4736e+00, 1.4183e+00, 1.2653e+00, 1.3913e+00,
         3.8444e+05, 4.1455e+05, 0.0000e+00, 3.8552e+05, 1.4803e+00, 1.4901e+00],
        [7.6600e+05, 3.8551e+05, 3.8555e+05, 7.5615e+05, 3.8554e+05, 3.8556e+05,
         3.8554e+05, 7.6406e+05, 3.8556e+05, 3.8555e+05, 3.8555e+05, 3.8554e+05,
         7.6982e+05, 8.0006e+05, 3.8552e+05, 0.0000e+00, 3.8555e+05, 3.8553e+05],
        [3.8877e+05, 1.4853e+00, 1.7389e+00, 3.8558e+05, 1.5206e+00, 1.4763e+00,
         1.4267e+00, 3.8245e+05, 1.5064e+00, 1.4245e+00, 1.3026e+00, 1.4185e+00,
         3.8442e+05, 4.1454e+05, 1.4803e+00, 3.8555e+05, 0.0000e+00, 1.4307e+00],
        [3.8873e+05, 1.3748e+00, 2.0646e+00, 3.8556e+05, 1.6699e+00, 1.6588e+00,
         1.3907e+00, 3.8243e+05, 1.5456e+00, 1.6056e+00, 1.4787e+00, 1.5432e+00,
         3.8445e+05, 4.1456e+05, 1.4901e+00, 3.8553e+05, 1.4307e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 388727.0938, 388739.2812, 388744.5000, 388747.6562,
        388749.5625, 388751.2812, 388761.4062, 388761.7812, 388767.4688,
        388767.5625, 388774.5938, 388776.2812, 760971.2500, 762281.8750,
        765996.1250, 771164.9375, 802742.5000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.3044e+00, 1.3748e+00, 1.4167e+00, 1.4338e+00, 1.4853e+00,
        1.4934e+00, 1.5205e+00, 1.5773e+00, 1.5843e+00, 1.6251e+00, 1.8683e+00,
        3.8243e+05, 3.8441e+05, 3.8551e+05, 3.8557e+05, 3.8876e+05, 4.1456e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4123e+00, 1.4124e+00, 1.4369e+00, 1.4459e+00, 1.4567e+00,
        1.5110e+00, 1.5317e+00, 1.5644e+00, 1.7389e+00, 1.8683e+00, 2.0646e+00,
        3.8246e+05, 3.8448e+05, 3.8555e+05, 3.8557e+05, 3.8877e+05, 4.1454e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385556.3438, 385559.8750, 385561.3438, 385570.5000,
        385571.9375, 385572.5000, 385579.0625, 385579.4688, 385581.5312,
        385585.6875, 385592.4062, 385598.6562, 756149.7500, 768077.6875,
        771164.9375, 773814.5000, 809910.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.3872e+00, 1.4186e+00, 1.4405e+00, 1.4459e+00, 1.4481e+00,
        1.4492e+00, 1.4532e+00, 1.4974e+00, 1.5206e+00, 1.5843e+00, 1.6699e+00,
        3.8246e+05, 3.8445e+05, 3.8554e+05, 3.8558e+05, 3.8878e+05, 4.1455e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3087e+00, 1.3644e+00, 1.3715e+00, 1.3719e+00, 1.3737e+00,
        1.4123e+00, 1.4175e+00, 1.4532e+00, 1.4763e+00, 1.5205e+00, 1.6588e+00,
        3.8246e+05, 3.8446e+05, 3.8556e+05, 3.8560e+05, 3.8877e+05, 4.1456e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2592e+00, 1.2698e+00, 1.2897e+00, 1.3121e+00, 1.3368e+00,
        1.3715e+00, 1.3907e+00, 1.4167e+00, 1.4267e+00, 1.4974e+00, 1.5644e+00,
        3.8244e+05, 3.8443e+05, 3.8554e+05, 3.8556e+05, 3.8876e+05, 4.1455e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382425.3125, 382431.5312, 382432.2188, 382434.4062,
        382442.9062, 382447.1875, 382454.3125, 382455.1875, 382455.5938,
        382457.6250, 382459.9375, 382460.6875, 762281.8750, 764059.4375,
        767822.9375, 773814.5000, 789837.1250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.2698e+00, 1.2827e+00, 1.2952e+00, 1.3449e+00, 1.4124e+00,
        1.4175e+00, 1.4405e+00, 1.4736e+00, 1.4934e+00, 1.5064e+00, 1.5456e+00,
        3.8243e+05, 3.8446e+05, 3.8556e+05, 3.8558e+05, 3.8874e+05, 4.1455e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3368e+00, 1.3449e+00, 1.3644e+00, 1.3789e+00, 1.3872e+00,
        1.3887e+00, 1.4183e+00, 1.4245e+00, 1.4369e+00, 1.6056e+00, 1.6251e+00,
        3.8245e+05, 3.8445e+05, 3.8555e+05, 3.8557e+05, 3.8875e+05, 4.1455e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2592e+00, 1.2653e+00, 1.2827e+00, 1.3026e+00, 1.3044e+00,
        1.3087e+00, 1.3207e+00, 1.3789e+00, 1.4481e+00, 1.4787e+00, 1.5110e+00,
        3.8246e+05, 3.8440e+05, 3.8555e+05, 3.8556e+05, 3.8874e+05, 4.1455e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2952e+00, 1.3121e+00, 1.3207e+00, 1.3737e+00, 1.3887e+00,
        1.3913e+00, 1.4185e+00, 1.4186e+00, 1.4567e+00, 1.5432e+00, 1.5773e+00,
        3.8243e+05, 3.8443e+05, 3.8554e+05, 3.8559e+05, 3.8875e+05, 4.1457e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384404.4375, 384407.8750, 384418.8438, 384428.3438,
        384429.6875, 384440.0312, 384449.6250, 384452.7812, 384454.2500,
        384456.1562, 384459.3125, 384477.2188, 760971.2500, 767822.9375,
        768077.6875, 769817.1250, 782566.3125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 414540.0312, 414541.1875, 414547.6875, 414549.0312,
        414552.5625, 414552.6875, 414553.2812, 414554.4375, 414559.5938,
        414563.4062, 414563.7188, 414565.7188, 782566.3125, 789837.1250,
        800059.9375, 802742.5000, 809910.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.2653e+00, 1.2897e+00, 1.3719e+00, 1.3913e+00, 1.4183e+00,
        1.4338e+00, 1.4492e+00, 1.4736e+00, 1.4803e+00, 1.4901e+00, 1.5317e+00,
        3.8246e+05, 3.8444e+05, 3.8552e+05, 3.8559e+05, 3.8875e+05, 4.1455e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385511.2812, 385523.3750, 385528.1875, 385537.0000,
        385543.5000, 385544.9688, 385547.5625, 385549.8438, 385550.2500,
        385550.3125, 385561.4688, 385564.0938, 756149.7500, 764059.4375,
        765996.1250, 769817.1250, 800059.9375])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.3026e+00, 1.4185e+00, 1.4245e+00, 1.4267e+00, 1.4307e+00,
        1.4763e+00, 1.4803e+00, 1.4853e+00, 1.5064e+00, 1.5206e+00, 1.7389e+00,
        3.8245e+05, 3.8442e+05, 3.8555e+05, 3.8558e+05, 3.8877e+05, 4.1454e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3748e+00, 1.3907e+00, 1.4307e+00, 1.4787e+00, 1.4901e+00,
        1.5432e+00, 1.5456e+00, 1.6056e+00, 1.6588e+00, 1.6699e+00, 2.0646e+00,
        3.8243e+05, 3.8445e+05, 3.8553e+05, 3.8556e+05, 3.8873e+05, 4.1456e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['388755.69', '1.52', '1.59', '385575.72', '1.48', '1.43', '1.38', '382446.38', '1.41', '1.43', '1.35', '1.41', '384439.84', '414553.53', '1.42', '385542.62', '1.47', '1.57']
estimated f for each client, fs: [4, 6, 6, 4, 6, 6, 6, 4, 6, 6, 6, 6, 4, 4, 6, 4, 6, 6]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [15, 9, 10, 19, 11, 1, 12, 14, 3, 5, 2, 4, 18, 16, 6, 17, 7, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0434s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:36...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:36, End: 2025-07-22 15:45:36)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [17, 14, 3, 10, 6, 12, 19, 13, 11, 5, 1, 2, 7, 16, 8, 9, 15, 4, 18, 20], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 7.6847e+05, 3.8180e+05, 3.8179e+05, 3.8178e+05, 3.8180e+05,
         7.6464e+05, 7.6213e+05, 3.8178e+05, 3.8177e+05, 3.8178e+05, 3.8178e+05,
         3.8176e+05, 7.4318e+05, 3.8177e+05, 3.8178e+05, 7.7745e+05, 3.8177e+05,
         7.6983e+05, 7.7542e+05],
        [7.6847e+05, 0.0000e+00, 3.7848e+05, 3.7847e+05, 3.7849e+05, 3.7849e+05,
         7.7473e+05, 7.6376e+05, 3.7849e+05, 3.7847e+05, 3.7849e+05, 3.7848e+05,
         3.7849e+05, 7.6116e+05, 3.7849e+05, 3.7848e+05, 7.6568e+05, 3.7850e+05,
         7.6270e+05, 7.7090e+05],
        [3.8180e+05, 3.7848e+05, 0.0000e+00, 1.3401e+00, 1.3191e+00, 1.2134e+00,
         3.9024e+05, 3.8898e+05, 1.2701e+00, 1.2474e+00, 1.2836e+00, 1.2765e+00,
         1.4225e+00, 3.8679e+05, 1.4465e+00, 1.3340e+00, 3.8890e+05, 1.2397e+00,
         3.8309e+05, 3.9908e+05],
        [3.8179e+05, 3.7847e+05, 1.3401e+00, 0.0000e+00, 1.4878e+00, 1.4821e+00,
         3.9029e+05, 3.8898e+05, 1.4091e+00, 1.3864e+00, 1.3356e+00, 1.2838e+00,
         1.6186e+00, 3.8677e+05, 1.9825e+00, 1.7003e+00, 3.8892e+05, 1.4206e+00,
         3.8308e+05, 3.9911e+05],
        [3.8178e+05, 3.7849e+05, 1.3191e+00, 1.4878e+00, 0.0000e+00, 1.1811e+00,
         3.9028e+05, 3.8901e+05, 1.2166e+00, 1.2773e+00, 1.2496e+00, 1.3602e+00,
         1.3018e+00, 3.8680e+05, 1.3543e+00, 1.2458e+00, 3.8891e+05, 1.2647e+00,
         3.8310e+05, 3.9912e+05],
        [3.8180e+05, 3.7849e+05, 1.2134e+00, 1.4821e+00, 1.1811e+00, 0.0000e+00,
         3.9029e+05, 3.8900e+05, 1.2885e+00, 1.2345e+00, 1.2854e+00, 1.4414e+00,
         1.3271e+00, 3.8679e+05, 1.3502e+00, 1.3156e+00, 3.8891e+05, 1.2138e+00,
         3.8308e+05, 3.9910e+05],
        [7.6464e+05, 7.7473e+05, 3.9024e+05, 3.9029e+05, 3.9028e+05, 3.9029e+05,
         0.0000e+00, 7.7470e+05, 3.9026e+05, 3.9024e+05, 3.9028e+05, 3.9030e+05,
         3.9025e+05, 7.6281e+05, 3.9026e+05, 3.9024e+05, 7.7700e+05, 3.9027e+05,
         7.6000e+05, 7.9098e+05],
        [7.6213e+05, 7.6376e+05, 3.8898e+05, 3.8898e+05, 3.8901e+05, 3.8900e+05,
         7.7470e+05, 0.0000e+00, 3.8900e+05, 3.8899e+05, 3.8901e+05, 3.8897e+05,
         3.8895e+05, 7.5101e+05, 3.8899e+05, 3.8897e+05, 7.7566e+05, 3.8897e+05,
         7.7064e+05, 7.9204e+05],
        [3.8178e+05, 3.7849e+05, 1.2701e+00, 1.4091e+00, 1.2166e+00, 1.2885e+00,
         3.9026e+05, 3.8900e+05, 0.0000e+00, 1.1920e+00, 1.2223e+00, 1.3525e+00,
         1.3063e+00, 3.8678e+05, 1.4041e+00, 1.3090e+00, 3.8894e+05, 1.1973e+00,
         3.8311e+05, 3.9912e+05],
        [3.8177e+05, 3.7847e+05, 1.2474e+00, 1.3864e+00, 1.2773e+00, 1.2345e+00,
         3.9024e+05, 3.8899e+05, 1.1920e+00, 0.0000e+00, 1.2253e+00, 1.4067e+00,
         1.3166e+00, 3.8679e+05, 1.4878e+00, 1.4150e+00, 3.8891e+05, 1.2483e+00,
         3.8306e+05, 3.9909e+05],
        [3.8178e+05, 3.7849e+05, 1.2836e+00, 1.3356e+00, 1.2496e+00, 1.2854e+00,
         3.9028e+05, 3.8901e+05, 1.2223e+00, 1.2253e+00, 0.0000e+00, 1.2688e+00,
         1.3521e+00, 3.8683e+05, 1.5265e+00, 1.3510e+00, 3.8891e+05, 1.2574e+00,
         3.8310e+05, 3.9911e+05],
        [3.8178e+05, 3.7848e+05, 1.2765e+00, 1.2838e+00, 1.3602e+00, 1.4414e+00,
         3.9030e+05, 3.8897e+05, 1.3525e+00, 1.4067e+00, 1.2688e+00, 0.0000e+00,
         1.4549e+00, 3.8679e+05, 1.7680e+00, 1.4625e+00, 3.8891e+05, 1.3362e+00,
         3.8311e+05, 3.9910e+05],
        [3.8176e+05, 3.7849e+05, 1.4225e+00, 1.6186e+00, 1.3018e+00, 1.3271e+00,
         3.9025e+05, 3.8895e+05, 1.3063e+00, 1.3166e+00, 1.3521e+00, 1.4549e+00,
         0.0000e+00, 3.8679e+05, 1.3726e+00, 1.3153e+00, 3.8891e+05, 1.3079e+00,
         3.8309e+05, 3.9912e+05],
        [7.4318e+05, 7.6116e+05, 3.8679e+05, 3.8677e+05, 3.8680e+05, 3.8679e+05,
         7.6281e+05, 7.5101e+05, 3.8678e+05, 3.8679e+05, 3.8683e+05, 3.8679e+05,
         3.8679e+05, 0.0000e+00, 3.8680e+05, 3.8678e+05, 7.9484e+05, 3.8679e+05,
         7.6144e+05, 7.7968e+05],
        [3.8177e+05, 3.7849e+05, 1.4465e+00, 1.9825e+00, 1.3543e+00, 1.3502e+00,
         3.9026e+05, 3.8899e+05, 1.4041e+00, 1.4878e+00, 1.5265e+00, 1.7680e+00,
         1.3726e+00, 3.8680e+05, 0.0000e+00, 1.3005e+00, 3.8892e+05, 1.3905e+00,
         3.8309e+05, 3.9911e+05],
        [3.8178e+05, 3.7848e+05, 1.3340e+00, 1.7003e+00, 1.2458e+00, 1.3156e+00,
         3.9024e+05, 3.8897e+05, 1.3090e+00, 1.4150e+00, 1.3510e+00, 1.4625e+00,
         1.3153e+00, 3.8678e+05, 1.3005e+00, 0.0000e+00, 3.8894e+05, 1.3916e+00,
         3.8312e+05, 3.9910e+05],
        [7.7745e+05, 7.6568e+05, 3.8890e+05, 3.8892e+05, 3.8891e+05, 3.8891e+05,
         7.7700e+05, 7.7566e+05, 3.8894e+05, 3.8891e+05, 3.8891e+05, 3.8891e+05,
         3.8891e+05, 7.9484e+05, 3.8892e+05, 3.8894e+05, 0.0000e+00, 3.8891e+05,
         7.6405e+05, 7.7782e+05],
        [3.8177e+05, 3.7850e+05, 1.2397e+00, 1.4206e+00, 1.2647e+00, 1.2138e+00,
         3.9027e+05, 3.8897e+05, 1.1973e+00, 1.2483e+00, 1.2574e+00, 1.3362e+00,
         1.3079e+00, 3.8679e+05, 1.3905e+00, 1.3916e+00, 3.8891e+05, 0.0000e+00,
         3.8308e+05, 3.9908e+05],
        [7.6983e+05, 7.6270e+05, 3.8309e+05, 3.8308e+05, 3.8310e+05, 3.8308e+05,
         7.6000e+05, 7.7064e+05, 3.8311e+05, 3.8306e+05, 3.8310e+05, 3.8311e+05,
         3.8309e+05, 7.6144e+05, 3.8309e+05, 3.8312e+05, 7.6405e+05, 3.8308e+05,
         0.0000e+00, 7.5490e+05],
        [7.7542e+05, 7.7090e+05, 3.9908e+05, 3.9911e+05, 3.9912e+05, 3.9910e+05,
         7.9098e+05, 7.9204e+05, 3.9912e+05, 3.9909e+05, 3.9911e+05, 3.9910e+05,
         3.9912e+05, 7.7968e+05, 3.9911e+05, 3.9910e+05, 7.7782e+05, 3.9908e+05,
         7.5490e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 381756.0000, 381766.9375, 381770.3750, 381771.5938,
        381776.5000, 381776.9375, 381779.8750, 381779.8750, 381784.5312,
        381788.9062, 381796.3125, 381801.4375, 743178.0000, 762131.6875,
        764637.0000, 768469.1875, 769833.8750, 775418.3750, 777445.2500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 378468.6562, 378473.4375, 378479.7812, 378480.6875,
        378482.0625, 378487.7812, 378490.3750, 378492.4688, 378492.5938,
        378493.3125, 378494.0000, 378501.3125, 761164.2500, 762705.0000,
        763755.0000, 765681.9375, 768469.1875, 770895.2500, 774727.1875])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.2134e+00, 1.2397e+00, 1.2474e+00, 1.2701e+00, 1.2765e+00,
        1.2836e+00, 1.3191e+00, 1.3340e+00, 1.3401e+00, 1.4225e+00, 1.4465e+00,
        3.7848e+05, 3.8180e+05, 3.8309e+05, 3.8679e+05, 3.8890e+05, 3.8898e+05,
        3.9024e+05, 3.9908e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.2838e+00, 1.3356e+00, 1.3401e+00, 1.3864e+00, 1.4091e+00,
        1.4206e+00, 1.4821e+00, 1.4878e+00, 1.6186e+00, 1.7003e+00, 1.9825e+00,
        3.7847e+05, 3.8179e+05, 3.8308e+05, 3.8677e+05, 3.8892e+05, 3.8898e+05,
        3.9029e+05, 3.9911e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.1811e+00, 1.2166e+00, 1.2458e+00, 1.2496e+00, 1.2647e+00,
        1.2773e+00, 1.3018e+00, 1.3191e+00, 1.3543e+00, 1.3602e+00, 1.4878e+00,
        3.7849e+05, 3.8178e+05, 3.8310e+05, 3.8680e+05, 3.8891e+05, 3.8901e+05,
        3.9028e+05, 3.9912e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.1811e+00, 1.2134e+00, 1.2138e+00, 1.2345e+00, 1.2854e+00,
        1.2885e+00, 1.3156e+00, 1.3271e+00, 1.3502e+00, 1.4414e+00, 1.4821e+00,
        3.7849e+05, 3.8180e+05, 3.8308e+05, 3.8679e+05, 3.8891e+05, 3.8900e+05,
        3.9029e+05, 3.9910e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 390237.6250, 390237.7188, 390237.7500, 390245.3125,
        390263.7500, 390264.5000, 390265.6875, 390280.5625, 390283.7188,
        390285.1875, 390294.6875, 390297.0625, 759995.6250, 762806.1250,
        764637.0000, 774697.2500, 774727.1875, 777004.5000, 790984.1250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 388946.0000, 388967.5625, 388973.2500, 388973.9062,
        388977.6250, 388983.5625, 388990.9062, 388992.3750, 389004.3125,
        389004.8438, 389005.6875, 389010.0938, 751010.7500, 762131.6875,
        763755.0000, 770639.2500, 774697.2500, 775662.1250, 792036.2500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.1920e+00, 1.1973e+00, 1.2166e+00, 1.2223e+00, 1.2701e+00,
        1.2885e+00, 1.3063e+00, 1.3090e+00, 1.3525e+00, 1.4041e+00, 1.4091e+00,
        3.7849e+05, 3.8178e+05, 3.8311e+05, 3.8678e+05, 3.8894e+05, 3.8900e+05,
        3.9026e+05, 3.9912e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.1920e+00, 1.2253e+00, 1.2345e+00, 1.2474e+00, 1.2483e+00,
        1.2773e+00, 1.3166e+00, 1.3864e+00, 1.4067e+00, 1.4150e+00, 1.4878e+00,
        3.7847e+05, 3.8177e+05, 3.8306e+05, 3.8679e+05, 3.8891e+05, 3.8899e+05,
        3.9024e+05, 3.9909e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.2223e+00, 1.2253e+00, 1.2496e+00, 1.2574e+00, 1.2688e+00,
        1.2836e+00, 1.2854e+00, 1.3356e+00, 1.3510e+00, 1.3521e+00, 1.5265e+00,
        3.7849e+05, 3.8178e+05, 3.8310e+05, 3.8683e+05, 3.8891e+05, 3.8901e+05,
        3.9028e+05, 3.9911e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.2688e+00, 1.2765e+00, 1.2838e+00, 1.3362e+00, 1.3525e+00,
        1.3602e+00, 1.4067e+00, 1.4414e+00, 1.4549e+00, 1.4625e+00, 1.7680e+00,
        3.7848e+05, 3.8178e+05, 3.8311e+05, 3.8679e+05, 3.8891e+05, 3.8897e+05,
        3.9030e+05, 3.9910e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.3018e+00, 1.3063e+00, 1.3079e+00, 1.3153e+00, 1.3166e+00,
        1.3271e+00, 1.3521e+00, 1.3726e+00, 1.4225e+00, 1.4549e+00, 1.6186e+00,
        3.7849e+05, 3.8176e+05, 3.8309e+05, 3.8679e+05, 3.8891e+05, 3.8895e+05,
        3.9025e+05, 3.9912e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 386770.8750, 386780.2188, 386783.5938, 386788.4375,
        386788.9375, 386789.5000, 386791.5000, 386791.5625, 386791.8125,
        386799.2812, 386800.3438, 386829.4688, 743178.0000, 751010.7500,
        761164.2500, 761443.8750, 762806.1250, 779675.6250, 794839.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.3005e+00, 1.3502e+00, 1.3543e+00, 1.3726e+00, 1.3905e+00,
        1.4041e+00, 1.4465e+00, 1.4878e+00, 1.5265e+00, 1.7680e+00, 1.9825e+00,
        3.7849e+05, 3.8177e+05, 3.8309e+05, 3.8680e+05, 3.8892e+05, 3.8899e+05,
        3.9026e+05, 3.9911e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.2458e+00, 1.3005e+00, 1.3090e+00, 1.3153e+00, 1.3156e+00,
        1.3340e+00, 1.3510e+00, 1.3916e+00, 1.4150e+00, 1.4625e+00, 1.7003e+00,
        3.7848e+05, 3.8178e+05, 3.8312e+05, 3.8678e+05, 3.8894e+05, 3.8897e+05,
        3.9024e+05, 3.9910e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 388904.6562, 388905.8750, 388906.3438, 388906.6875,
        388911.0938, 388912.9062, 388912.9375, 388913.6875, 388916.0000,
        388920.9375, 388936.7812, 388939.1562, 764046.0625, 765681.9375,
        775662.1250, 777004.5000, 777445.2500, 777817.3125, 794839.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.1973e+00, 1.2138e+00, 1.2397e+00, 1.2483e+00, 1.2574e+00,
        1.2647e+00, 1.3079e+00, 1.3362e+00, 1.3905e+00, 1.3916e+00, 1.4206e+00,
        3.7850e+05, 3.8177e+05, 3.8308e+05, 3.8679e+05, 3.8891e+05, 3.8897e+05,
        3.9027e+05, 3.9908e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 383056.8125, 383080.3125, 383082.2500, 383084.9375,
        383091.3750, 383091.6250, 383092.8125, 383100.7812, 383104.8125,
        383108.0625, 383114.0000, 383116.6250, 754900.0000, 759995.6250,
        761443.8750, 762705.0000, 764046.0625, 769833.8750, 770639.2500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 399079.0625, 399081.0000, 399087.7188, 399099.3125,
        399100.5312, 399100.8438, 399105.4375, 399106.7188, 399107.5625,
        399116.5938, 399117.5625, 399120.6250, 754900.0000, 770895.2500,
        775418.3750, 777817.3125, 779675.6250, 790984.1250, 792036.2500])
Index of maximum distance difference after half of values: 12
adaptive_Krum scores:  ['381779.06', '378486.31', '31541.18', '31540.82', '31542.23', '31542.23', '390266.06', '388985.78', '31542.05', '31540.26', '31541.83', '31541.45', '31542.36', '386792.09', '31542.53', '31541.32', '388915.53', '31542.96', '383093.66', '399101.88']
estimated f for each client, fs: [6, 7, 8, 8, 8, 8, 6, 6, 8, 8, 8, 8, 8, 6, 8, 8, 6, 8, 6, 6]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [17, 14, 3, 10, 6, 12, 19, 13, 11, 5, 1, 2, 7, 16, 8, 9, 15, 4, 18, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0169s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:37...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:37, End: 2025-07-22 15:45:37)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [4, 15, 3, 5, 19, 6, 12, 1, 7, 11, 10, 8, 9, 17, 16], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.9853e+05, 1.1260e+00, 1.4162e+00, 3.8588e+05, 1.2268e+00,
         1.1307e+00, 1.1601e+00, 1.1956e+00, 1.1248e+00, 1.3199e+00, 1.2947e+00,
         1.3590e+00, 3.9082e+05, 3.9255e+05],
        [3.9853e+05, 0.0000e+00, 3.9849e+05, 3.9853e+05, 7.8729e+05, 3.9850e+05,
         3.9852e+05, 3.9853e+05, 3.9850e+05, 3.9853e+05, 3.9854e+05, 3.9854e+05,
         3.9855e+05, 7.9331e+05, 7.8088e+05],
        [1.1260e+00, 3.9849e+05, 0.0000e+00, 1.3580e+00, 3.8586e+05, 1.2272e+00,
         1.0766e+00, 1.1763e+00, 1.2659e+00, 1.1573e+00, 1.2870e+00, 1.2700e+00,
         1.2170e+00, 3.9087e+05, 3.9255e+05],
        [1.4162e+00, 3.9853e+05, 1.3580e+00, 0.0000e+00, 3.8589e+05, 1.4905e+00,
         1.4497e+00, 1.2965e+00, 1.5486e+00, 1.3635e+00, 1.1149e+00, 1.8356e+00,
         1.7732e+00, 3.9084e+05, 3.9252e+05],
        [3.8588e+05, 7.8729e+05, 3.8586e+05, 3.8589e+05, 0.0000e+00, 3.8586e+05,
         3.8586e+05, 3.8585e+05, 3.8586e+05, 3.8584e+05, 3.8583e+05, 3.8589e+05,
         3.8586e+05, 7.9285e+05, 7.6498e+05],
        [1.2268e+00, 3.9850e+05, 1.2272e+00, 1.4905e+00, 3.8586e+05, 0.0000e+00,
         1.0897e+00, 1.1570e+00, 1.2192e+00, 1.1758e+00, 1.4191e+00, 1.2634e+00,
         1.2127e+00, 3.9084e+05, 3.9257e+05],
        [1.1307e+00, 3.9852e+05, 1.0766e+00, 1.4497e+00, 3.8586e+05, 1.0897e+00,
         0.0000e+00, 1.1264e+00, 1.1955e+00, 1.1811e+00, 1.3746e+00, 1.2285e+00,
         1.2611e+00, 3.9080e+05, 3.9256e+05],
        [1.1601e+00, 3.9853e+05, 1.1763e+00, 1.2965e+00, 3.8585e+05, 1.1570e+00,
         1.1264e+00, 0.0000e+00, 1.2343e+00, 1.1322e+00, 1.2375e+00, 1.4005e+00,
         1.2969e+00, 3.9083e+05, 3.9256e+05],
        [1.1956e+00, 3.9850e+05, 1.2659e+00, 1.5486e+00, 3.8586e+05, 1.2192e+00,
         1.1955e+00, 1.2343e+00, 0.0000e+00, 1.1588e+00, 1.4988e+00, 1.2829e+00,
         1.2381e+00, 3.9084e+05, 3.9256e+05],
        [1.1248e+00, 3.9853e+05, 1.1573e+00, 1.3635e+00, 3.8584e+05, 1.1758e+00,
         1.1811e+00, 1.1322e+00, 1.1588e+00, 0.0000e+00, 1.3425e+00, 1.3107e+00,
         1.2487e+00, 3.9083e+05, 3.9257e+05],
        [1.3199e+00, 3.9854e+05, 1.2870e+00, 1.1149e+00, 3.8583e+05, 1.4191e+00,
         1.3746e+00, 1.2375e+00, 1.4988e+00, 1.3425e+00, 0.0000e+00, 1.8429e+00,
         1.6257e+00, 3.9086e+05, 3.9254e+05],
        [1.2947e+00, 3.9854e+05, 1.2700e+00, 1.8356e+00, 3.8589e+05, 1.2634e+00,
         1.2285e+00, 1.4005e+00, 1.2829e+00, 1.3107e+00, 1.8429e+00, 0.0000e+00,
         1.2476e+00, 3.9083e+05, 3.9255e+05],
        [1.3590e+00, 3.9855e+05, 1.2170e+00, 1.7732e+00, 3.8586e+05, 1.2127e+00,
         1.2611e+00, 1.2969e+00, 1.2381e+00, 1.2487e+00, 1.6257e+00, 1.2476e+00,
         0.0000e+00, 3.9084e+05, 3.9260e+05],
        [3.9082e+05, 7.9331e+05, 3.9087e+05, 3.9084e+05, 7.9285e+05, 3.9084e+05,
         3.9080e+05, 3.9083e+05, 3.9084e+05, 3.9083e+05, 3.9086e+05, 3.9083e+05,
         3.9084e+05, 0.0000e+00, 7.7670e+05],
        [3.9255e+05, 7.8088e+05, 3.9255e+05, 3.9252e+05, 7.6498e+05, 3.9257e+05,
         3.9256e+05, 3.9256e+05, 3.9256e+05, 3.9257e+05, 3.9254e+05, 3.9255e+05,
         3.9260e+05, 7.7670e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1248e+00, 1.1260e+00, 1.1307e+00, 1.1601e+00, 1.1956e+00,
        1.2268e+00, 1.2947e+00, 1.3199e+00, 1.3590e+00, 1.4162e+00, 3.8588e+05,
        3.9082e+05, 3.9255e+05, 3.9853e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 398493.9375, 398496.1250, 398498.2500, 398522.0000,
        398525.6562, 398525.7812, 398526.7500, 398530.5938, 398539.2188,
        398544.2188, 398549.7500, 780881.0625, 787292.6875, 793313.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0766e+00, 1.1260e+00, 1.1573e+00, 1.1763e+00, 1.2170e+00,
        1.2272e+00, 1.2659e+00, 1.2700e+00, 1.2870e+00, 1.3580e+00, 3.8586e+05,
        3.9087e+05, 3.9255e+05, 3.9849e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1149e+00, 1.2965e+00, 1.3580e+00, 1.3635e+00, 1.4162e+00,
        1.4497e+00, 1.4905e+00, 1.5486e+00, 1.7732e+00, 1.8356e+00, 3.8589e+05,
        3.9084e+05, 3.9252e+05, 3.9853e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 385832.7500, 385844.6875, 385852.8750, 385857.5625,
        385857.6875, 385860.0938, 385860.5938, 385864.7812, 385876.2500,
        385885.7188, 385890.2812, 764979.3750, 787292.6875, 792849.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0897e+00, 1.1570e+00, 1.1758e+00, 1.2127e+00, 1.2192e+00,
        1.2268e+00, 1.2272e+00, 1.2634e+00, 1.4191e+00, 1.4905e+00, 3.8586e+05,
        3.9084e+05, 3.9257e+05, 3.9850e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0766e+00, 1.0897e+00, 1.1264e+00, 1.1307e+00, 1.1811e+00,
        1.1955e+00, 1.2285e+00, 1.2611e+00, 1.3746e+00, 1.4497e+00, 3.8586e+05,
        3.9080e+05, 3.9256e+05, 3.9852e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1264e+00, 1.1322e+00, 1.1570e+00, 1.1601e+00, 1.1763e+00,
        1.2343e+00, 1.2375e+00, 1.2965e+00, 1.2969e+00, 1.4005e+00, 3.8585e+05,
        3.9083e+05, 3.9256e+05, 3.9853e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1588e+00, 1.1955e+00, 1.1956e+00, 1.2192e+00, 1.2343e+00,
        1.2381e+00, 1.2659e+00, 1.2829e+00, 1.4988e+00, 1.5486e+00, 3.8586e+05,
        3.9084e+05, 3.9256e+05, 3.9850e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1248e+00, 1.1322e+00, 1.1573e+00, 1.1588e+00, 1.1758e+00,
        1.1811e+00, 1.2487e+00, 1.3107e+00, 1.3425e+00, 1.3635e+00, 3.8584e+05,
        3.9083e+05, 3.9257e+05, 3.9853e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1149e+00, 1.2375e+00, 1.2870e+00, 1.3199e+00, 1.3425e+00,
        1.3746e+00, 1.4191e+00, 1.4988e+00, 1.6257e+00, 1.8429e+00, 3.8583e+05,
        3.9086e+05, 3.9254e+05, 3.9854e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2285e+00, 1.2476e+00, 1.2634e+00, 1.2700e+00, 1.2829e+00,
        1.2947e+00, 1.3107e+00, 1.4005e+00, 1.8356e+00, 1.8429e+00, 3.8589e+05,
        3.9083e+05, 3.9255e+05, 3.9854e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2127e+00, 1.2170e+00, 1.2381e+00, 1.2476e+00, 1.2487e+00,
        1.2611e+00, 1.2969e+00, 1.3590e+00, 1.6257e+00, 1.7732e+00, 3.8586e+05,
        3.9084e+05, 3.9260e+05, 3.9855e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390795.0938, 390818.5000, 390831.9688, 390832.8125,
        390834.4375, 390838.5625, 390838.8438, 390839.5625, 390841.2188,
        390858.6250, 390868.6875, 776704.1250, 792849.7500, 793313.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392520.6250, 392544.1875, 392545.5312, 392549.6875,
        392552.5625, 392557.7188, 392561.1875, 392562.9375, 392567.2188,
        392570.1562, 392599.1562, 764979.3750, 776704.1250, 780881.0625])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['1.22', '398522.97', '1.20', '1.42', '385862.16', '1.22', '1.18', '1.20', '1.25', '1.20', '1.36', '1.35', '1.30', '390836.19', '392557.38']
estimated f for each client, fs: [5, 2, 5, 5, 2, 5, 5, 5, 5, 5, 5, 5, 5, 2, 2]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [4, 15, 3, 5, 19, 6, 12, 1, 7, 11, 10, 8, 9, 17, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0345s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:38...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:38, End: 2025-07-22 15:45:38)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [18, 17], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[     0.0000, 797423.6875],
        [797423.6875,      0.0000]])
sorted_distances: tensor([     0.0000, 797423.6875])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([     0.0000, 797423.6875])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['797423.69', '797423.69']
estimated f for each client, fs: [1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [18, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0016s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:38...
global Accuracy on shared test data: 54.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 56 181]
 [ 49 214]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:38, End: 2025-07-22 15:45:38)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [4, 9, 7, 2, 18, 3, 8, 16, 19, 11, 15, 20, 6, 14, 12, 1, 13, 5], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.5549e+00, 3.3901e+00, 3.4933e+00, 3.8942e+05, 3.3500e+00,
         3.5302e+00, 3.8943e+05, 3.9893e+05, 3.3612e+00, 4.1354e+05, 3.8455e+05,
         3.0174e+00, 3.8321e+05, 3.5427e+00, 3.2130e+00, 3.9560e+05, 3.6619e+00],
        [3.5549e+00, 0.0000e+00, 3.6810e+00, 3.6025e+00, 3.8943e+05, 3.4149e+00,
         3.8394e+00, 3.8940e+05, 3.9887e+05, 3.6804e+00, 4.1356e+05, 3.8456e+05,
         3.7702e+00, 3.8317e+05, 3.7547e+00, 3.3711e+00, 3.9559e+05, 3.7691e+00],
        [3.3901e+00, 3.6810e+00, 0.0000e+00, 3.7538e+00, 3.8944e+05, 3.5227e+00,
         4.0734e+00, 3.8943e+05, 3.9889e+05, 3.7040e+00, 4.1351e+05, 3.8457e+05,
         3.7658e+00, 3.8319e+05, 3.7702e+00, 3.5504e+00, 3.9557e+05, 3.7933e+00],
        [3.4933e+00, 3.6025e+00, 3.7538e+00, 0.0000e+00, 3.8950e+05, 3.5251e+00,
         3.8927e+00, 3.8946e+05, 3.9892e+05, 3.8444e+00, 4.1359e+05, 3.8456e+05,
         3.6479e+00, 3.8318e+05, 4.0296e+00, 3.5200e+00, 3.9556e+05, 3.7379e+00],
        [3.8942e+05, 3.8943e+05, 3.8944e+05, 3.8950e+05, 0.0000e+00, 3.8947e+05,
         3.8946e+05, 7.9830e+05, 7.9379e+05, 3.8942e+05, 7.7019e+05, 7.6491e+05,
         3.8945e+05, 7.9654e+05, 3.8944e+05, 3.8948e+05, 7.6341e+05, 3.8943e+05],
        [3.3500e+00, 3.4149e+00, 3.5227e+00, 3.5251e+00, 3.8947e+05, 0.0000e+00,
         3.6458e+00, 3.8947e+05, 3.9891e+05, 3.7259e+00, 4.1354e+05, 3.8459e+05,
         3.4373e+00, 3.8314e+05, 3.3693e+00, 3.2017e+00, 3.9556e+05, 3.5657e+00],
        [3.5302e+00, 3.8394e+00, 4.0734e+00, 3.8927e+00, 3.8946e+05, 3.6458e+00,
         0.0000e+00, 3.8942e+05, 3.9892e+05, 3.9871e+00, 4.1354e+05, 3.8454e+05,
         3.6061e+00, 3.8322e+05, 4.1826e+00, 3.5686e+00, 3.9556e+05, 3.9977e+00],
        [3.8943e+05, 3.8940e+05, 3.8943e+05, 3.8946e+05, 7.9830e+05, 3.8947e+05,
         3.8942e+05, 0.0000e+00, 7.9806e+05, 3.8942e+05, 8.1807e+05, 7.8990e+05,
         3.8946e+05, 7.8957e+05, 3.8944e+05, 3.8945e+05, 8.0431e+05, 3.8944e+05],
        [3.9893e+05, 3.9887e+05, 3.9889e+05, 3.9892e+05, 7.9379e+05, 3.9891e+05,
         3.9892e+05, 7.9806e+05, 0.0000e+00, 3.9888e+05, 8.0520e+05, 7.6106e+05,
         3.9886e+05, 7.9334e+05, 3.9891e+05, 3.9887e+05, 7.8142e+05, 3.9886e+05],
        [3.3612e+00, 3.6804e+00, 3.7040e+00, 3.8444e+00, 3.8942e+05, 3.7259e+00,
         3.9871e+00, 3.8942e+05, 3.9888e+05, 0.0000e+00, 4.1351e+05, 3.8455e+05,
         3.4366e+00, 3.8317e+05, 3.9916e+00, 3.6022e+00, 3.9556e+05, 3.8599e+00],
        [4.1354e+05, 4.1356e+05, 4.1351e+05, 4.1359e+05, 7.7019e+05, 4.1354e+05,
         4.1354e+05, 8.1807e+05, 8.0520e+05, 4.1351e+05, 0.0000e+00, 7.9982e+05,
         4.1353e+05, 8.0621e+05, 4.1350e+05, 4.1356e+05, 8.1271e+05, 4.1357e+05],
        [3.8455e+05, 3.8456e+05, 3.8457e+05, 3.8456e+05, 7.6491e+05, 3.8459e+05,
         3.8454e+05, 7.8990e+05, 7.6106e+05, 3.8455e+05, 7.9982e+05, 0.0000e+00,
         3.8456e+05, 7.7713e+05, 3.8454e+05, 3.8457e+05, 8.0508e+05, 3.8459e+05],
        [3.0174e+00, 3.7702e+00, 3.7658e+00, 3.6479e+00, 3.8945e+05, 3.4373e+00,
         3.6061e+00, 3.8946e+05, 3.9886e+05, 3.4366e+00, 4.1353e+05, 3.8456e+05,
         0.0000e+00, 3.8320e+05, 3.1971e+00, 3.4644e+00, 3.9558e+05, 3.7681e+00],
        [3.8321e+05, 3.8317e+05, 3.8319e+05, 3.8318e+05, 7.9654e+05, 3.8314e+05,
         3.8322e+05, 7.8957e+05, 7.9334e+05, 3.8317e+05, 8.0621e+05, 7.7713e+05,
         3.8320e+05, 0.0000e+00, 3.8321e+05, 3.8316e+05, 7.8682e+05, 3.8321e+05],
        [3.5427e+00, 3.7547e+00, 3.7702e+00, 4.0296e+00, 3.8944e+05, 3.3693e+00,
         4.1826e+00, 3.8944e+05, 3.9891e+05, 3.9916e+00, 4.1350e+05, 3.8454e+05,
         3.1971e+00, 3.8321e+05, 0.0000e+00, 3.6322e+00, 3.9553e+05, 3.6803e+00],
        [3.2130e+00, 3.3711e+00, 3.5504e+00, 3.5200e+00, 3.8948e+05, 3.2017e+00,
         3.5686e+00, 3.8945e+05, 3.9887e+05, 3.6022e+00, 4.1356e+05, 3.8457e+05,
         3.4644e+00, 3.8316e+05, 3.6322e+00, 0.0000e+00, 3.9555e+05, 3.5300e+00],
        [3.9560e+05, 3.9559e+05, 3.9557e+05, 3.9556e+05, 7.6341e+05, 3.9556e+05,
         3.9556e+05, 8.0431e+05, 7.8142e+05, 3.9556e+05, 8.1271e+05, 8.0508e+05,
         3.9558e+05, 7.8682e+05, 3.9553e+05, 3.9555e+05, 0.0000e+00, 3.9559e+05],
        [3.6619e+00, 3.7691e+00, 3.7933e+00, 3.7379e+00, 3.8943e+05, 3.5657e+00,
         3.9977e+00, 3.8944e+05, 3.9886e+05, 3.8599e+00, 4.1357e+05, 3.8459e+05,
         3.7681e+00, 3.8321e+05, 3.6803e+00, 3.5300e+00, 3.9559e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.0174e+00, 3.2130e+00, 3.3500e+00, 3.3612e+00, 3.3901e+00,
        3.4933e+00, 3.5302e+00, 3.5427e+00, 3.5549e+00, 3.6619e+00, 3.8321e+05,
        3.8455e+05, 3.8942e+05, 3.8943e+05, 3.9560e+05, 3.9893e+05, 4.1354e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3711e+00, 3.4149e+00, 3.5549e+00, 3.6025e+00, 3.6804e+00,
        3.6810e+00, 3.7547e+00, 3.7691e+00, 3.7702e+00, 3.8394e+00, 3.8317e+05,
        3.8456e+05, 3.8940e+05, 3.8943e+05, 3.9559e+05, 3.9887e+05, 4.1356e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3901e+00, 3.5227e+00, 3.5504e+00, 3.6810e+00, 3.7040e+00,
        3.7538e+00, 3.7658e+00, 3.7702e+00, 3.7933e+00, 4.0734e+00, 3.8319e+05,
        3.8457e+05, 3.8943e+05, 3.8944e+05, 3.9557e+05, 3.9889e+05, 4.1351e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4933e+00, 3.5200e+00, 3.5251e+00, 3.6025e+00, 3.6479e+00,
        3.7379e+00, 3.7538e+00, 3.8444e+00, 3.8927e+00, 4.0296e+00, 3.8318e+05,
        3.8456e+05, 3.8946e+05, 3.8950e+05, 3.9556e+05, 3.9892e+05, 4.1359e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 389418.9688, 389423.3438, 389429.9375, 389434.5625,
        389442.7812, 389443.8125, 389449.7188, 389461.9688, 389465.5000,
        389477.9688, 389497.2812, 763411.7500, 764907.0625, 770186.3750,
        793792.1250, 796538.4375, 798300.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2017e+00, 3.3500e+00, 3.3693e+00, 3.4149e+00, 3.4373e+00,
        3.5227e+00, 3.5251e+00, 3.5657e+00, 3.6458e+00, 3.7259e+00, 3.8314e+05,
        3.8459e+05, 3.8947e+05, 3.8947e+05, 3.9556e+05, 3.9891e+05, 4.1354e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5302e+00, 3.5686e+00, 3.6061e+00, 3.6458e+00, 3.8394e+00,
        3.8927e+00, 3.9871e+00, 3.9977e+00, 4.0734e+00, 4.1826e+00, 3.8322e+05,
        3.8454e+05, 3.8942e+05, 3.8946e+05, 3.9556e+05, 3.9892e+05, 4.1354e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 389397.3750, 389421.5312, 389424.5000, 389426.4375,
        389430.0625, 389435.7500, 389440.6875, 389447.0000, 389459.5938,
        389461.6875, 389472.1250, 789574.7500, 789897.8750, 798065.0000,
        798300.9375, 804306.8750, 818074.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398857.4688, 398860.6562, 398869.4375, 398870.5000,
        398877.6250, 398886.3125, 398905.0625, 398911.0312, 398915.4062,
        398921.3438, 398926.8125, 761056.0000, 781423.3750, 793341.8750,
        793792.1250, 798065.0000, 805197.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3612e+00, 3.4366e+00, 3.6022e+00, 3.6804e+00, 3.7040e+00,
        3.7259e+00, 3.8444e+00, 3.8599e+00, 3.9871e+00, 3.9916e+00, 3.8317e+05,
        3.8455e+05, 3.8942e+05, 3.8942e+05, 3.9556e+05, 3.9888e+05, 4.1351e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 413503.2500, 413506.8438, 413514.8125, 413530.7188,
        413536.8125, 413539.6875, 413540.6875, 413560.6562, 413562.1250,
        413571.0938, 413594.1250, 770186.3750, 799817.2500, 805197.0625,
        806208.8125, 812709.0000, 818074.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384542.0938, 384545.0000, 384547.2500, 384550.8125,
        384557.1562, 384559.8125, 384559.8750, 384566.8438, 384570.6875,
        384585.3125, 384589.0312, 761056.0000, 764907.0625, 777134.2500,
        789897.8750, 799817.2500, 805077.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.0174e+00, 3.1971e+00, 3.4366e+00, 3.4373e+00, 3.4644e+00,
        3.6061e+00, 3.6479e+00, 3.7658e+00, 3.7681e+00, 3.7702e+00, 3.8320e+05,
        3.8456e+05, 3.8945e+05, 3.8946e+05, 3.9558e+05, 3.9886e+05, 4.1353e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 383142.3125, 383162.0938, 383166.2188, 383170.9375,
        383184.9375, 383186.4375, 383199.6250, 383206.3750, 383211.5938,
        383211.6250, 383221.8125, 777134.2500, 786822.9375, 789574.7500,
        793341.8750, 796538.4375, 806208.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.1971e+00, 3.3693e+00, 3.5427e+00, 3.6322e+00, 3.6803e+00,
        3.7547e+00, 3.7702e+00, 3.9916e+00, 4.0296e+00, 4.1826e+00, 3.8321e+05,
        3.8454e+05, 3.8944e+05, 3.8944e+05, 3.9553e+05, 3.9891e+05, 4.1350e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2017e+00, 3.2130e+00, 3.3711e+00, 3.4644e+00, 3.5200e+00,
        3.5300e+00, 3.5504e+00, 3.5686e+00, 3.6022e+00, 3.6322e+00, 3.8316e+05,
        3.8457e+05, 3.8945e+05, 3.8948e+05, 3.9555e+05, 3.9887e+05, 4.1356e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395533.1875, 395546.6875, 395557.6250, 395559.0000,
        395561.7812, 395564.0625, 395571.0312, 395575.3750, 395587.9688,
        395592.2500, 395598.4688, 763411.7500, 781423.3750, 786822.9375,
        804306.8750, 805077.6250, 812709.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5300e+00, 3.5657e+00, 3.6619e+00, 3.6803e+00, 3.7379e+00,
        3.7681e+00, 3.7691e+00, 3.7933e+00, 3.8599e+00, 3.9977e+00, 3.8321e+05,
        3.8459e+05, 3.8943e+05, 3.8944e+05, 3.9559e+05, 3.9886e+05, 4.1357e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34840.04', '34836.60', '34838.49', '34838.36', '389449.56', '34834.27', '34841.83', '389437.84', '398891.03', '34837.10', '413541.84', '384561.22', '34839.52', '383187.66', '34840.80', '34836.07', '395567.91', '34840.81']
estimated f for each client, fs: [7, 7, 7, 7, 5, 7, 7, 6, 5, 7, 5, 5, 7, 6, 7, 7, 5, 7]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [4, 9, 7, 2, 18, 3, 8, 16, 19, 11, 15, 20, 6, 14, 12, 1, 13, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0160s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:38...
global Accuracy on shared test data: 55.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 68 169]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:38, End: 2025-07-22 15:45:38)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (6): [16, 19, 2, 4, 7, 9], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 6
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([6])
tensor([[0.0000e+00, 7.7296e+05, 3.9977e+05, 3.9974e+05, 3.9980e+05, 3.9975e+05],
        [7.7296e+05, 0.0000e+00, 3.8482e+05, 3.8479e+05, 3.8481e+05, 3.8480e+05],
        [3.9977e+05, 3.8482e+05, 0.0000e+00, 3.4486e+00, 3.6499e+00, 3.7109e+00],
        [3.9974e+05, 3.8479e+05, 3.4486e+00, 0.0000e+00, 3.4944e+00, 3.7668e+00],
        [3.9980e+05, 3.8481e+05, 3.6499e+00, 3.4944e+00, 0.0000e+00, 3.9458e+00],
        [3.9975e+05, 3.8480e+05, 3.7109e+00, 3.7668e+00, 3.9458e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 399744.3750, 399752.3750, 399765.3125, 399802.5000,
        772963.7500])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 384793.0000, 384803.8750, 384806.5938, 384824.2500,
        772963.7500])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.4486e+00, 3.6499e+00, 3.7109e+00, 3.8482e+05, 3.9977e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.4486e+00, 3.4944e+00, 3.7668e+00, 3.8479e+05, 3.9974e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.4944e+00, 3.6499e+00, 3.9458e+00, 3.8481e+05, 3.9980e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.7109e+00, 3.7668e+00, 3.9458e+00, 3.8480e+05, 3.9975e+05])
Index of maximum distance difference after half of values: 5
adaptive_Krum scores:  ['474405.66', '462438.28', '156920.08', '156909.61', '156924.03', '156913.53']
estimated f for each client, fs: [0, 1, 2, 2, 2, 2]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']], selected_client_indices: [16, 19, 2, 4, 7, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:39...
global Accuracy on shared test data: 56.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 80 157]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:39, End: 2025-07-22 15:45:39)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [16, 15, 9, 6, 11, 20, 18, 4, 8, 7, 14, 1, 13, 3, 2], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 7.6617e+05, 3.8276e+05, 3.8276e+05, 3.8274e+05, 8.0124e+05,
         7.7585e+05, 3.8275e+05, 3.8277e+05, 3.8273e+05, 7.5779e+05, 3.8274e+05,
         7.8520e+05, 3.8275e+05, 3.8276e+05],
        [7.6617e+05, 0.0000e+00, 3.9524e+05, 3.9530e+05, 3.9525e+05, 8.1381e+05,
         8.1619e+05, 3.9531e+05, 3.9530e+05, 3.9533e+05, 7.8548e+05, 3.9527e+05,
         7.7530e+05, 3.9532e+05, 3.9527e+05],
        [3.8276e+05, 3.9524e+05, 0.0000e+00, 4.0720e+00, 3.8794e+00, 3.9453e+05,
         3.9398e+05, 3.9398e+00, 4.0748e+00, 4.2396e+00, 3.9210e+05, 3.6934e+00,
         3.9070e+05, 3.7423e+00, 3.9472e+00],
        [3.8276e+05, 3.9530e+05, 4.0720e+00, 0.0000e+00, 3.6409e+00, 3.9456e+05,
         3.9396e+05, 3.3983e+00, 3.8747e+00, 4.0512e+00, 3.9207e+05, 3.4488e+00,
         3.9069e+05, 3.7512e+00, 3.6437e+00],
        [3.8274e+05, 3.9525e+05, 3.8794e+00, 3.6409e+00, 0.0000e+00, 3.9460e+05,
         3.9394e+05, 3.4928e+00, 3.9003e+00, 3.9068e+00, 3.9211e+05, 3.5979e+00,
         3.9079e+05, 3.8416e+00, 3.7168e+00],
        [8.0124e+05, 8.1381e+05, 3.9453e+05, 3.9456e+05, 3.9460e+05, 0.0000e+00,
         7.7861e+05, 3.9455e+05, 3.9458e+05, 3.9456e+05, 7.7635e+05, 3.9456e+05,
         7.8551e+05, 3.9454e+05, 3.9458e+05],
        [7.7585e+05, 8.1619e+05, 3.9398e+05, 3.9396e+05, 3.9394e+05, 7.7861e+05,
         0.0000e+00, 3.9393e+05, 3.9395e+05, 3.9399e+05, 8.0066e+05, 3.9400e+05,
         7.9295e+05, 3.9397e+05, 3.9395e+05],
        [3.8275e+05, 3.9531e+05, 3.9398e+00, 3.3983e+00, 3.4928e+00, 3.9455e+05,
         3.9393e+05, 0.0000e+00, 3.5792e+00, 3.5787e+00, 3.9206e+05, 3.3173e+00,
         3.9073e+05, 3.3941e+00, 3.5045e+00],
        [3.8277e+05, 3.9530e+05, 4.0748e+00, 3.8747e+00, 3.9003e+00, 3.9458e+05,
         3.9395e+05, 3.5792e+00, 0.0000e+00, 4.0464e+00, 3.9207e+05, 3.5192e+00,
         3.9075e+05, 3.6166e+00, 3.7965e+00],
        [3.8273e+05, 3.9533e+05, 4.2396e+00, 4.0512e+00, 3.9068e+00, 3.9456e+05,
         3.9399e+05, 3.5787e+00, 4.0464e+00, 0.0000e+00, 3.9205e+05, 3.6651e+00,
         3.9071e+05, 3.8059e+00, 3.6767e+00],
        [7.5779e+05, 7.8548e+05, 3.9210e+05, 3.9207e+05, 3.9211e+05, 7.7635e+05,
         8.0066e+05, 3.9206e+05, 3.9207e+05, 3.9205e+05, 0.0000e+00, 3.9207e+05,
         7.6061e+05, 3.9211e+05, 3.9211e+05],
        [3.8274e+05, 3.9527e+05, 3.6934e+00, 3.4488e+00, 3.5979e+00, 3.9456e+05,
         3.9400e+05, 3.3173e+00, 3.5192e+00, 3.6651e+00, 3.9207e+05, 0.0000e+00,
         3.9072e+05, 3.5062e+00, 3.4107e+00],
        [7.8520e+05, 7.7530e+05, 3.9070e+05, 3.9069e+05, 3.9079e+05, 7.8551e+05,
         7.9295e+05, 3.9073e+05, 3.9075e+05, 3.9071e+05, 7.6061e+05, 3.9072e+05,
         0.0000e+00, 3.9069e+05, 3.9073e+05],
        [3.8275e+05, 3.9532e+05, 3.7423e+00, 3.7512e+00, 3.8416e+00, 3.9454e+05,
         3.9397e+05, 3.3941e+00, 3.6166e+00, 3.8059e+00, 3.9211e+05, 3.5062e+00,
         3.9069e+05, 0.0000e+00, 3.5427e+00],
        [3.8276e+05, 3.9527e+05, 3.9472e+00, 3.6437e+00, 3.7168e+00, 3.9458e+05,
         3.9395e+05, 3.5045e+00, 3.7965e+00, 3.6767e+00, 3.9211e+05, 3.4107e+00,
         3.9073e+05, 3.5427e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 382733.6875, 382741.1562, 382741.2500, 382745.9375,
        382750.9375, 382761.6250, 382762.7812, 382763.5000, 382772.7500,
        757791.2500, 766172.8750, 775850.4375, 785197.1250, 801241.9375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 395244.0000, 395250.5312, 395268.3750, 395270.9375,
        395296.8125, 395301.3125, 395309.3438, 395321.6562, 395325.2500,
        766172.8750, 775297.2500, 785476.6250, 813812.9375, 816186.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.6934e+00, 3.7423e+00, 3.8794e+00, 3.9398e+00, 3.9472e+00,
        4.0720e+00, 4.0748e+00, 4.2396e+00, 3.8276e+05, 3.9070e+05, 3.9210e+05,
        3.9398e+05, 3.9453e+05, 3.9524e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.3983e+00, 3.4488e+00, 3.6409e+00, 3.6437e+00, 3.7512e+00,
        3.8747e+00, 4.0512e+00, 4.0720e+00, 3.8276e+05, 3.9069e+05, 3.9207e+05,
        3.9396e+05, 3.9456e+05, 3.9530e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4928e+00, 3.5979e+00, 3.6409e+00, 3.7168e+00, 3.8416e+00,
        3.8794e+00, 3.9003e+00, 3.9068e+00, 3.8274e+05, 3.9079e+05, 3.9211e+05,
        3.9394e+05, 3.9460e+05, 3.9525e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394531.4375, 394535.7188, 394545.3750, 394558.5000,
        394562.7500, 394563.7188, 394577.6562, 394580.3438, 394597.7812,
        776351.8125, 778608.7500, 785512.3750, 801241.9375, 813812.9375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393929.2500, 393942.9062, 393947.0625, 393948.4688,
        393959.2500, 393968.1250, 393984.2812, 393992.1250, 393996.3438,
        775850.4375, 778608.7500, 792949.6250, 800661.8750, 816186.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.3173e+00, 3.3941e+00, 3.3983e+00, 3.4928e+00, 3.5045e+00,
        3.5787e+00, 3.5792e+00, 3.9398e+00, 3.8275e+05, 3.9073e+05, 3.9206e+05,
        3.9393e+05, 3.9455e+05, 3.9531e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5192e+00, 3.5792e+00, 3.6166e+00, 3.7965e+00, 3.8747e+00,
        3.9003e+00, 4.0464e+00, 4.0748e+00, 3.8277e+05, 3.9075e+05, 3.9207e+05,
        3.9395e+05, 3.9458e+05, 3.9530e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5787e+00, 3.6651e+00, 3.6767e+00, 3.8059e+00, 3.9068e+00,
        4.0464e+00, 4.0512e+00, 4.2396e+00, 3.8273e+05, 3.9071e+05, 3.9205e+05,
        3.9399e+05, 3.9456e+05, 3.9533e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 392053.6250, 392059.2188, 392072.0938, 392072.6875,
        392073.0000, 392101.9375, 392105.2500, 392105.6875, 392110.0000,
        757791.2500, 760608.1250, 776351.8125, 785476.6250, 800661.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.3173e+00, 3.4107e+00, 3.4488e+00, 3.5062e+00, 3.5192e+00,
        3.5979e+00, 3.6651e+00, 3.6934e+00, 3.8274e+05, 3.9072e+05, 3.9207e+05,
        3.9400e+05, 3.9456e+05, 3.9527e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390689.6875, 390693.9688, 390697.1250, 390708.5938,
        390719.5312, 390730.1875, 390731.7500, 390754.4062, 390791.3750,
        760608.1250, 775297.2500, 785197.1250, 785512.3750, 792949.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.3941e+00, 3.5062e+00, 3.5427e+00, 3.6166e+00, 3.7423e+00,
        3.7512e+00, 3.8059e+00, 3.8416e+00, 3.8275e+05, 3.9069e+05, 3.9211e+05,
        3.9397e+05, 3.9454e+05, 3.9532e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4107e+00, 3.5045e+00, 3.5427e+00, 3.6437e+00, 3.6767e+00,
        3.7168e+00, 3.7965e+00, 3.9472e+00, 3.8276e+05, 3.9073e+05, 3.9211e+05,
        3.9395e+05, 3.9458e+05, 3.9527e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['382752.62', '395287.59', '42532.58', '42532.52', '42530.13', '394561.50', '393963.09', '42531.02', '42533.68', '42529.40', '392083.69', '42529.92', '390724.06', '42530.57', '42532.53']
estimated f for each client, fs: [4, 4, 6, 6, 6, 4, 4, 6, 6, 6, 4, 6, 4, 6, 6]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [16, 15, 9, 6, 11, 20, 18, 4, 8, 7, 14, 1, 13, 3, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0133s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:39...
global Accuracy on shared test data: 56.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 88 149]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0023 seconds (Start: 2025-07-22 15:45:39, End: 2025-07-22 15:45:39)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 11, 20, 19, 5, 13, 17, 3, 15, 4, 16, 18, 9, 7, 8, 2, 6, 10], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.8229e+05, 7.7826e+05, 7.8867e+05, 3.8225e+05, 8.0217e+05,
         7.7951e+05, 3.8223e+05, 7.8671e+05, 3.8220e+05, 7.3626e+05, 7.9055e+05,
         3.8223e+05, 3.8223e+05, 3.8226e+05, 3.8223e+05, 3.8223e+05, 3.8227e+05],
        [3.8229e+05, 0.0000e+00, 3.9720e+05, 3.8427e+05, 3.9289e+00, 3.9654e+05,
         4.0286e+05, 3.9671e+00, 3.9885e+05, 3.5474e+00, 3.8380e+05, 3.9539e+05,
         3.9531e+00, 4.0529e+00, 3.9681e+00, 3.8631e+00, 3.8523e+00, 3.9093e+00],
        [7.7826e+05, 3.9720e+05, 0.0000e+00, 7.6495e+05, 3.9721e+05, 8.0657e+05,
         8.0419e+05, 3.9712e+05, 7.9607e+05, 3.9721e+05, 7.8303e+05, 8.1389e+05,
         3.9719e+05, 3.9721e+05, 3.9716e+05, 3.9717e+05, 3.9715e+05, 3.9715e+05],
        [7.8867e+05, 3.8427e+05, 7.6495e+05, 0.0000e+00, 3.8428e+05, 7.8055e+05,
         7.9348e+05, 3.8426e+05, 7.4969e+05, 3.8422e+05, 7.7555e+05, 7.9881e+05,
         3.8431e+05, 3.8434e+05, 3.8423e+05, 3.8423e+05, 3.8423e+05, 3.8429e+05],
        [3.8225e+05, 3.9289e+00, 3.9721e+05, 3.8428e+05, 0.0000e+00, 3.9655e+05,
         4.0283e+05, 3.5804e+00, 3.9880e+05, 3.8583e+00, 3.8387e+05, 3.9540e+05,
         3.9300e+00, 3.9100e+00, 3.8596e+00, 3.7987e+00, 3.9741e+00, 3.6746e+00],
        [8.0217e+05, 3.9654e+05, 8.0657e+05, 7.8055e+05, 3.9655e+05, 0.0000e+00,
         8.2566e+05, 3.9648e+05, 7.9536e+05, 3.9658e+05, 7.8630e+05, 7.9568e+05,
         3.9653e+05, 3.9649e+05, 3.9654e+05, 3.9653e+05, 3.9656e+05, 3.9656e+05],
        [7.7951e+05, 4.0286e+05, 8.0419e+05, 7.9348e+05, 4.0283e+05, 8.2566e+05,
         0.0000e+00, 4.0285e+05, 8.1675e+05, 4.0278e+05, 7.9178e+05, 7.9306e+05,
         4.0288e+05, 4.0280e+05, 4.0283e+05, 4.0285e+05, 4.0286e+05, 4.0283e+05],
        [3.8223e+05, 3.9671e+00, 3.9712e+05, 3.8426e+05, 3.5804e+00, 3.9648e+05,
         4.0285e+05, 0.0000e+00, 3.9877e+05, 3.3856e+00, 3.8381e+05, 3.9536e+05,
         3.7945e+00, 4.0605e+00, 3.6380e+00, 3.5945e+00, 3.8551e+00, 3.2961e+00],
        [7.8671e+05, 3.9885e+05, 7.9607e+05, 7.4969e+05, 3.9880e+05, 7.9536e+05,
         8.1675e+05, 3.9877e+05, 0.0000e+00, 3.9878e+05, 8.0319e+05, 7.7956e+05,
         3.9882e+05, 3.9881e+05, 3.9879e+05, 3.9884e+05, 3.9880e+05, 3.9882e+05],
        [3.8220e+05, 3.5474e+00, 3.9721e+05, 3.8422e+05, 3.8583e+00, 3.9658e+05,
         4.0278e+05, 3.3856e+00, 3.9878e+05, 0.0000e+00, 3.8379e+05, 3.9537e+05,
         3.8612e+00, 3.6713e+00, 3.6898e+00, 3.6848e+00, 3.5335e+00, 3.7879e+00],
        [7.3626e+05, 3.8380e+05, 7.8303e+05, 7.7555e+05, 3.8387e+05, 7.8630e+05,
         7.9178e+05, 3.8381e+05, 8.0319e+05, 3.8379e+05, 0.0000e+00, 7.8185e+05,
         3.8380e+05, 3.8375e+05, 3.8379e+05, 3.8383e+05, 3.8384e+05, 3.8381e+05],
        [7.9055e+05, 3.9539e+05, 8.1389e+05, 7.9881e+05, 3.9540e+05, 7.9568e+05,
         7.9306e+05, 3.9536e+05, 7.7956e+05, 3.9537e+05, 7.8185e+05, 0.0000e+00,
         3.9543e+05, 3.9536e+05, 3.9538e+05, 3.9540e+05, 3.9543e+05, 3.9540e+05],
        [3.8223e+05, 3.9531e+00, 3.9719e+05, 3.8431e+05, 3.9300e+00, 3.9653e+05,
         4.0288e+05, 3.7945e+00, 3.9882e+05, 3.8612e+00, 3.8380e+05, 3.9543e+05,
         0.0000e+00, 4.3805e+00, 4.0435e+00, 3.9681e+00, 4.1675e+00, 4.0165e+00],
        [3.8223e+05, 4.0529e+00, 3.9721e+05, 3.8434e+05, 3.9100e+00, 3.9649e+05,
         4.0280e+05, 4.0605e+00, 3.9881e+05, 3.6713e+00, 3.8375e+05, 3.9536e+05,
         4.3805e+00, 0.0000e+00, 4.0147e+00, 3.7824e+00, 4.2175e+00, 3.7710e+00],
        [3.8226e+05, 3.9681e+00, 3.9716e+05, 3.8423e+05, 3.8596e+00, 3.9654e+05,
         4.0283e+05, 3.6380e+00, 3.9879e+05, 3.6898e+00, 3.8379e+05, 3.9538e+05,
         4.0435e+00, 4.0147e+00, 0.0000e+00, 3.7232e+00, 3.8630e+00, 3.6021e+00],
        [3.8223e+05, 3.8631e+00, 3.9717e+05, 3.8423e+05, 3.7987e+00, 3.9653e+05,
         4.0285e+05, 3.5945e+00, 3.9884e+05, 3.6848e+00, 3.8383e+05, 3.9540e+05,
         3.9681e+00, 3.7824e+00, 3.7232e+00, 0.0000e+00, 3.6128e+00, 3.5564e+00],
        [3.8223e+05, 3.8523e+00, 3.9715e+05, 3.8423e+05, 3.9741e+00, 3.9656e+05,
         4.0286e+05, 3.8551e+00, 3.9880e+05, 3.5335e+00, 3.8384e+05, 3.9543e+05,
         4.1675e+00, 4.2175e+00, 3.8630e+00, 3.6128e+00, 0.0000e+00, 3.7566e+00],
        [3.8227e+05, 3.9093e+00, 3.9715e+05, 3.8429e+05, 3.6746e+00, 3.9656e+05,
         4.0283e+05, 3.2961e+00, 3.9882e+05, 3.7879e+00, 3.8381e+05, 3.9540e+05,
         4.0165e+00, 3.7710e+00, 3.6021e+00, 3.5564e+00, 3.7566e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 382204.6562, 382229.7500, 382232.0312, 382232.0625,
        382233.0312, 382234.6562, 382246.5625, 382262.2812, 382270.7812,
        382285.4688, 736256.2500, 778262.1875, 779508.4375, 786706.0625,
        788672.6875, 790549.1875, 802167.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5474e+00, 3.8523e+00, 3.8631e+00, 3.9093e+00, 3.9289e+00,
        3.9531e+00, 3.9671e+00, 3.9681e+00, 4.0529e+00, 3.8229e+05, 3.8380e+05,
        3.8427e+05, 3.9539e+05, 3.9654e+05, 3.9720e+05, 3.9885e+05, 4.0286e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397115.2188, 397147.4375, 397153.0000, 397158.7500,
        397173.9688, 397192.1250, 397203.9688, 397205.5312, 397209.0312,
        397210.5625, 764952.8125, 778262.1875, 783030.1250, 796065.8750,
        804188.0000, 806570.6250, 813892.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384223.6875, 384225.5312, 384233.4375, 384234.0000,
        384256.3750, 384271.6562, 384278.8125, 384294.5938, 384314.0000,
        384341.0625, 749694.0625, 764952.8125, 775549.5000, 780549.7500,
        788672.6875, 793478.0625, 798807.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5804e+00, 3.6746e+00, 3.7987e+00, 3.8583e+00, 3.8596e+00,
        3.9100e+00, 3.9289e+00, 3.9300e+00, 3.9741e+00, 3.8225e+05, 3.8387e+05,
        3.8428e+05, 3.9540e+05, 3.9655e+05, 3.9721e+05, 3.9880e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396482.4688, 396493.0000, 396525.9375, 396531.7812,
        396537.0938, 396542.5938, 396545.3438, 396556.7812, 396563.3125,
        396581.1250, 780549.7500, 786296.2500, 795361.3750, 795680.8750,
        802167.9375, 806570.6250, 825659.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 402780.3750, 402796.5000, 402827.0625, 402830.5000,
        402832.5312, 402846.1875, 402853.6562, 402856.2500, 402860.2500,
        402878.5625, 779508.4375, 791779.9375, 793064.8750, 793478.0625,
        804188.0000, 816751.7500, 825659.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2961e+00, 3.3856e+00, 3.5804e+00, 3.5945e+00, 3.6380e+00,
        3.7945e+00, 3.8551e+00, 3.9671e+00, 4.0605e+00, 3.8223e+05, 3.8381e+05,
        3.8426e+05, 3.9536e+05, 3.9648e+05, 3.9712e+05, 3.9877e+05, 4.0285e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398767.0938, 398784.2500, 398793.0312, 398796.0938,
        398798.7812, 398810.9062, 398816.0000, 398816.4688, 398839.6250,
        398846.5312, 749694.0625, 779556.8125, 786706.0625, 795361.3750,
        796065.8750, 803193.5625, 816751.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3856e+00, 3.5335e+00, 3.5474e+00, 3.6713e+00, 3.6848e+00,
        3.6898e+00, 3.7879e+00, 3.8583e+00, 3.8612e+00, 3.8220e+05, 3.8379e+05,
        3.8422e+05, 3.9537e+05, 3.9658e+05, 3.9721e+05, 3.9878e+05, 4.0278e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 383752.5938, 383785.5312, 383794.0000, 383795.4062,
        383797.7188, 383809.8750, 383810.3750, 383829.4688, 383844.8750,
        383866.9062, 736256.2500, 775549.5000, 781850.1250, 783030.1250,
        786296.2500, 791779.9375, 803193.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395362.1250, 395364.8750, 395369.5000, 395381.5625,
        395385.7500, 395396.5938, 395397.3750, 395398.3438, 395425.6562,
        395433.9688, 779556.8125, 781850.1250, 790549.1875, 793064.8750,
        795680.8750, 798807.1250, 813892.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.7945e+00, 3.8612e+00, 3.9300e+00, 3.9531e+00, 3.9681e+00,
        4.0165e+00, 4.0435e+00, 4.1675e+00, 4.3805e+00, 3.8223e+05, 3.8380e+05,
        3.8431e+05, 3.9543e+05, 3.9653e+05, 3.9719e+05, 3.9882e+05, 4.0288e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6713e+00, 3.7710e+00, 3.7824e+00, 3.9100e+00, 4.0147e+00,
        4.0529e+00, 4.0605e+00, 4.2175e+00, 4.3805e+00, 3.8223e+05, 3.8375e+05,
        3.8434e+05, 3.9536e+05, 3.9649e+05, 3.9721e+05, 3.9881e+05, 4.0280e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6021e+00, 3.6380e+00, 3.6898e+00, 3.7232e+00, 3.8596e+00,
        3.8630e+00, 3.9681e+00, 4.0147e+00, 4.0435e+00, 3.8226e+05, 3.8379e+05,
        3.8423e+05, 3.9538e+05, 3.9654e+05, 3.9716e+05, 3.9879e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5564e+00, 3.5945e+00, 3.6128e+00, 3.6848e+00, 3.7232e+00,
        3.7824e+00, 3.7987e+00, 3.8631e+00, 3.9681e+00, 3.8223e+05, 3.8383e+05,
        3.8423e+05, 3.9540e+05, 3.9653e+05, 3.9717e+05, 3.9884e+05, 4.0285e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5335e+00, 3.6128e+00, 3.7566e+00, 3.8523e+00, 3.8551e+00,
        3.8630e+00, 3.9741e+00, 4.1675e+00, 4.2175e+00, 3.8223e+05, 3.8384e+05,
        3.8423e+05, 3.9543e+05, 3.9656e+05, 3.9715e+05, 3.9880e+05, 4.0286e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2961e+00, 3.5564e+00, 3.6021e+00, 3.6746e+00, 3.7566e+00,
        3.7710e+00, 3.7879e+00, 3.9093e+00, 4.0165e+00, 3.8227e+05, 3.8381e+05,
        3.8429e+05, 3.9540e+05, 3.9656e+05, 3.9715e+05, 3.9882e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['414426.09', '69646.89', '430611.09', '417487.91', '69649.81', '431446.25', '437079.09', '69642.98', '430705.66', '69639.23', '415849.31', '430315.62', '69642.34', '69638.23', '69643.83', '69645.24', '69646.60', '69646.77']
estimated f for each client, fs: [6, 8, 6, 6, 8, 6, 6, 8, 6, 8, 6, 6, 8, 8, 8, 8, 8, 8]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 11, 20, 19, 5, 13, 17, 3, 15, 4, 16, 18, 9, 7, 8, 2, 6, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0124s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:40...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 93 144]
 [ 87 176]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:40, End: 2025-07-22 15:45:40)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [11, 4, 14, 20, 6, 9, 12, 18, 1, 5, 3], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
tensor([[0.0000e+00, 3.6711e+00, 3.9787e+05, 4.1006e+05, 3.8224e+00, 3.9481e+00,
         4.0447e+00, 3.9159e+05, 3.6826e+00, 3.7543e+00, 3.8413e+00],
        [3.6711e+00, 0.0000e+00, 3.9782e+05, 4.1005e+05, 3.7558e+00, 3.8726e+00,
         4.1343e+00, 3.9162e+05, 3.4979e+00, 3.9404e+00, 3.5119e+00],
        [3.9787e+05, 3.9782e+05, 0.0000e+00, 8.0306e+05, 3.9792e+05, 3.9788e+05,
         3.9792e+05, 7.7413e+05, 3.9790e+05, 3.9797e+05, 3.9794e+05],
        [4.1006e+05, 4.1005e+05, 8.0306e+05, 0.0000e+00, 4.1005e+05, 4.1003e+05,
         4.1001e+05, 7.9437e+05, 4.1003e+05, 4.1008e+05, 4.1000e+05],
        [3.8224e+00, 3.7558e+00, 3.9792e+05, 4.1005e+05, 0.0000e+00, 4.2518e+00,
         3.9127e+00, 3.9162e+05, 3.5890e+00, 4.0073e+00, 3.8787e+00],
        [3.9481e+00, 3.8726e+00, 3.9788e+05, 4.1003e+05, 4.2518e+00, 0.0000e+00,
         4.4856e+00, 3.9157e+05, 3.7634e+00, 3.9168e+00, 3.8439e+00],
        [4.0447e+00, 4.1343e+00, 3.9792e+05, 4.1001e+05, 3.9127e+00, 4.4856e+00,
         0.0000e+00, 3.9164e+05, 3.8664e+00, 3.6947e+00, 3.8796e+00],
        [3.9159e+05, 3.9162e+05, 7.7413e+05, 7.9437e+05, 3.9162e+05, 3.9157e+05,
         3.9164e+05, 0.0000e+00, 3.9163e+05, 3.9159e+05, 3.9156e+05],
        [3.6826e+00, 3.4979e+00, 3.9790e+05, 4.1003e+05, 3.5890e+00, 3.7634e+00,
         3.8664e+00, 3.9163e+05, 0.0000e+00, 3.5250e+00, 3.7404e+00],
        [3.7543e+00, 3.9404e+00, 3.9797e+05, 4.1008e+05, 4.0073e+00, 3.9168e+00,
         3.6947e+00, 3.9159e+05, 3.5250e+00, 0.0000e+00, 3.4633e+00],
        [3.8413e+00, 3.5119e+00, 3.9794e+05, 4.1000e+05, 3.8787e+00, 3.8439e+00,
         3.8796e+00, 3.9156e+05, 3.7404e+00, 3.4633e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.6711e+00, 3.6826e+00, 3.7543e+00, 3.8224e+00, 3.8413e+00,
        3.9481e+00, 4.0447e+00, 3.9159e+05, 3.9787e+05, 4.1006e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.4979e+00, 3.5119e+00, 3.6711e+00, 3.7558e+00, 3.8726e+00,
        3.9404e+00, 4.1343e+00, 3.9162e+05, 3.9782e+05, 4.1005e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 397817.9688, 397874.9688, 397884.2188, 397903.2500,
        397918.0000, 397918.2188, 397940.2188, 397969.3438, 774130.2500,
        803056.4375])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 410004.8125, 410010.9375, 410031.5625, 410034.5000,
        410047.2812, 410054.8125, 410055.6875, 410082.4688, 794370.9375,
        803056.4375])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.5890e+00, 3.7558e+00, 3.8224e+00, 3.8787e+00, 3.9127e+00,
        4.0073e+00, 4.2518e+00, 3.9162e+05, 3.9792e+05, 4.1005e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.7634e+00, 3.8439e+00, 3.8726e+00, 3.9168e+00, 3.9481e+00,
        4.2518e+00, 4.4856e+00, 3.9157e+05, 3.9788e+05, 4.1003e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.6947e+00, 3.8664e+00, 3.8796e+00, 3.9127e+00, 4.0447e+00,
        4.1343e+00, 4.4856e+00, 3.9164e+05, 3.9792e+05, 4.1001e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 391562.3125, 391566.5625, 391592.4062, 391594.8125,
        391615.3438, 391624.1875, 391629.1875, 391635.3750, 774130.2500,
        794370.9375])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.4979e+00, 3.5250e+00, 3.5890e+00, 3.6826e+00, 3.7404e+00,
        3.7634e+00, 3.8664e+00, 3.9163e+05, 3.9790e+05, 4.1003e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.4633e+00, 3.5250e+00, 3.6947e+00, 3.7543e+00, 3.9168e+00,
        3.9404e+00, 4.0073e+00, 3.9159e+05, 3.9797e+05, 4.1008e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.4633e+00, 3.5119e+00, 3.7404e+00, 3.8413e+00, 3.8439e+00,
        3.8787e+00, 3.8796e+00, 3.9156e+05, 3.9794e+05, 4.1000e+05])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['3.82', '3.77', '397903.25', '410040.25', '3.89', '4.01', '4.00', '391602.53', '3.67', '3.76', '3.74']
estimated f for each client, fs: [3, 3, 1, 1, 3, 3, 3, 1, 3, 3, 3]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']], selected_client_indices: [11, 4, 14, 20, 6, 9, 12, 18, 1, 5, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0194s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:40...
global Accuracy on shared test data: 53.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 93 144]
 [ 89 174]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:40, End: 2025-07-22 15:45:40)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [8, 9, 1, 16, 19, 11, 6, 7, 12, 4, 15, 20, 5], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.8629e+00, 3.6791e+00, 4.0626e+05, 3.7446e+05, 3.7958e+00,
         3.8754e+00, 3.9857e+00, 3.8087e+00, 3.8301e+00, 3.8760e+05, 3.7592e+05,
         3.8147e+00],
        [3.8629e+00, 0.0000e+00, 3.7533e+00, 4.0621e+05, 3.7451e+05, 3.9047e+00,
         4.2870e+00, 4.4852e+00, 4.3873e+00, 3.8932e+00, 3.8759e+05, 3.7588e+05,
         3.9170e+00],
        [3.6791e+00, 3.7533e+00, 0.0000e+00, 4.0630e+05, 3.7452e+05, 3.7520e+00,
         3.7444e+00, 3.6470e+00, 3.8792e+00, 3.5801e+00, 3.8762e+05, 3.7589e+05,
         3.5816e+00],
        [4.0626e+05, 4.0621e+05, 4.0630e+05, 0.0000e+00, 7.8680e+05, 4.0626e+05,
         4.0629e+05, 4.0628e+05, 4.0625e+05, 4.0629e+05, 7.9893e+05, 7.8404e+05,
         4.0627e+05],
        [3.7446e+05, 3.7451e+05, 3.7452e+05, 7.8680e+05, 0.0000e+00, 3.7448e+05,
         3.7452e+05, 3.7453e+05, 3.7450e+05, 3.7447e+05, 7.7276e+05, 7.2918e+05,
         3.7444e+05],
        [3.7958e+00, 3.9047e+00, 3.7520e+00, 4.0626e+05, 3.7448e+05, 0.0000e+00,
         3.9071e+00, 3.9925e+00, 4.0099e+00, 3.6753e+00, 3.8758e+05, 3.7585e+05,
         3.7737e+00],
        [3.8754e+00, 4.2870e+00, 3.7444e+00, 4.0629e+05, 3.7452e+05, 3.9071e+00,
         0.0000e+00, 4.3493e+00, 4.0302e+00, 3.8384e+00, 3.8755e+05, 3.7593e+05,
         4.1215e+00],
        [3.9857e+00, 4.4852e+00, 3.6470e+00, 4.0628e+05, 3.7453e+05, 3.9925e+00,
         4.3493e+00, 0.0000e+00, 3.6927e+00, 3.8116e+00, 3.8757e+05, 3.7590e+05,
         3.7627e+00],
        [3.8087e+00, 4.3873e+00, 3.8792e+00, 4.0625e+05, 3.7450e+05, 4.0099e+00,
         4.0302e+00, 3.6927e+00, 0.0000e+00, 4.1259e+00, 3.8759e+05, 3.7593e+05,
         3.7475e+00],
        [3.8301e+00, 3.8932e+00, 3.5801e+00, 4.0629e+05, 3.7447e+05, 3.6753e+00,
         3.8384e+00, 3.8116e+00, 4.1259e+00, 0.0000e+00, 3.8759e+05, 3.7589e+05,
         3.9685e+00],
        [3.8760e+05, 3.8759e+05, 3.8762e+05, 7.9893e+05, 7.7276e+05, 3.8758e+05,
         3.8755e+05, 3.8757e+05, 3.8759e+05, 3.8759e+05, 0.0000e+00, 7.4633e+05,
         3.8761e+05],
        [3.7592e+05, 3.7588e+05, 3.7589e+05, 7.8404e+05, 7.2918e+05, 3.7585e+05,
         3.7593e+05, 3.7590e+05, 3.7593e+05, 3.7589e+05, 7.4633e+05, 0.0000e+00,
         3.7589e+05],
        [3.8147e+00, 3.9170e+00, 3.5816e+00, 4.0627e+05, 3.7444e+05, 3.7737e+00,
         4.1215e+00, 3.7627e+00, 3.7475e+00, 3.9685e+00, 3.8761e+05, 3.7589e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.6791e+00, 3.7958e+00, 3.8087e+00, 3.8147e+00, 3.8301e+00,
        3.8629e+00, 3.8754e+00, 3.9857e+00, 3.7446e+05, 3.7592e+05, 3.8760e+05,
        4.0626e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.7533e+00, 3.8629e+00, 3.8932e+00, 3.9047e+00, 3.9170e+00,
        4.2870e+00, 4.3873e+00, 4.4852e+00, 3.7451e+05, 3.7588e+05, 3.8759e+05,
        4.0621e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.5801e+00, 3.5816e+00, 3.6470e+00, 3.6791e+00, 3.7444e+00,
        3.7520e+00, 3.7533e+00, 3.8792e+00, 3.7452e+05, 3.7589e+05, 3.8762e+05,
        4.0630e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 406210.8438, 406253.4688, 406258.2500, 406261.5312,
        406272.4688, 406279.4062, 406287.1250, 406288.1250, 406297.2500,
        784035.5000, 786801.3125, 798933.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 374440.3750, 374456.4375, 374472.8438, 374482.6562,
        374499.2188, 374508.2188, 374515.8438, 374519.9062, 374532.7188,
        729185.0000, 772761.0000, 786801.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.6753e+00, 3.7520e+00, 3.7737e+00, 3.7958e+00, 3.9047e+00,
        3.9071e+00, 3.9925e+00, 4.0099e+00, 3.7448e+05, 3.7585e+05, 3.8758e+05,
        4.0626e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.7444e+00, 3.8384e+00, 3.8754e+00, 3.9071e+00, 4.0302e+00,
        4.1215e+00, 4.2870e+00, 4.3493e+00, 3.7452e+05, 3.7593e+05, 3.8755e+05,
        4.0629e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6470e+00, 3.6927e+00, 3.7627e+00, 3.8116e+00, 3.9857e+00,
        3.9925e+00, 4.3493e+00, 4.4852e+00, 3.7453e+05, 3.7590e+05, 3.8757e+05,
        4.0628e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6927e+00, 3.7475e+00, 3.8087e+00, 3.8792e+00, 4.0099e+00,
        4.0302e+00, 4.1259e+00, 4.3873e+00, 3.7450e+05, 3.7593e+05, 3.8759e+05,
        4.0625e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.5801e+00, 3.6753e+00, 3.8116e+00, 3.8301e+00, 3.8384e+00,
        3.8932e+00, 3.9685e+00, 4.1259e+00, 3.7447e+05, 3.7589e+05, 3.8759e+05,
        4.0629e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 387546.5000, 387571.9688, 387579.8750, 387590.6562,
        387592.8125, 387593.1562, 387603.1875, 387614.1875, 387617.2500,
        746327.6875, 772761.0000, 798933.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 375852.3750, 375877.2188, 375885.0938, 375885.0938,
        375885.1875, 375896.2500, 375916.3125, 375925.5312, 375927.4375,
        729185.0000, 746327.6875, 784035.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5816e+00, 3.7475e+00, 3.7627e+00, 3.7737e+00, 3.8147e+00,
        3.9170e+00, 3.9685e+00, 4.1215e+00, 3.7444e+05, 3.7589e+05, 3.8761e+05,
        4.0627e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['3.83', '4.06', '3.70', '406267.62', '374492.00', '3.85', '4.02', '3.97', '3.96', '3.84', '387589.94', '375894.50', '3.84']
estimated f for each client, fs: [4, 4, 4, 2, 2, 4, 4, 4, 4, 4, 2, 2, 4]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [8, 9, 1, 16, 19, 11, 6, 7, 12, 4, 15, 20, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0090s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:41...
global Accuracy on shared test data: 54.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[101 136]
 [ 93 170]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:41, End: 2025-07-22 15:45:41)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [14, 1, 18, 16, 6, 15, 10, 8, 3, 11, 20, 2, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.9450e+05, 7.8643e+05, 7.8159e+05, 3.9447e+05, 7.9895e+05,
         3.9452e+05, 3.9448e+05, 3.9446e+05, 3.9447e+05, 7.7863e+05, 3.9448e+05,
         3.9451e+05],
        [3.9450e+05, 0.0000e+00, 3.9254e+05, 3.9557e+05, 3.6771e+00, 3.9810e+05,
         3.5050e+00, 3.7442e+00, 3.8053e+00, 3.6765e+00, 3.9358e+05, 3.5441e+00,
         3.8923e+00],
        [7.8643e+05, 3.9254e+05, 0.0000e+00, 7.6382e+05, 3.9250e+05, 8.0045e+05,
         3.9249e+05, 3.9250e+05, 3.9250e+05, 3.9253e+05, 7.6544e+05, 3.9256e+05,
         3.9252e+05],
        [7.8159e+05, 3.9557e+05, 7.6382e+05, 0.0000e+00, 3.9559e+05, 7.9717e+05,
         3.9556e+05, 3.9561e+05, 3.9556e+05, 3.9558e+05, 7.7438e+05, 3.9560e+05,
         3.9565e+05],
        [3.9447e+05, 3.6771e+00, 3.9250e+05, 3.9559e+05, 0.0000e+00, 3.9815e+05,
         3.8117e+00, 3.8453e+00, 3.9942e+00, 3.8523e+00, 3.9356e+05, 3.7088e+00,
         4.0119e+00],
        [7.9895e+05, 3.9810e+05, 8.0045e+05, 7.9717e+05, 3.9815e+05, 0.0000e+00,
         3.9813e+05, 3.9810e+05, 3.9813e+05, 3.9812e+05, 7.9774e+05, 3.9814e+05,
         3.9815e+05],
        [3.9452e+05, 3.5050e+00, 3.9249e+05, 3.9556e+05, 3.8117e+00, 3.9813e+05,
         0.0000e+00, 3.6313e+00, 3.3373e+00, 3.6790e+00, 3.9353e+05, 3.6116e+00,
         3.6920e+00],
        [3.9448e+05, 3.7442e+00, 3.9250e+05, 3.9561e+05, 3.8453e+00, 3.9810e+05,
         3.6313e+00, 0.0000e+00, 3.8612e+00, 3.7408e+00, 3.9357e+05, 3.7726e+00,
         3.8369e+00],
        [3.9446e+05, 3.8053e+00, 3.9250e+05, 3.9556e+05, 3.9942e+00, 3.9813e+05,
         3.3373e+00, 3.8612e+00, 0.0000e+00, 3.8933e+00, 3.9349e+05, 3.9335e+00,
         4.0370e+00],
        [3.9447e+05, 3.6765e+00, 3.9253e+05, 3.9558e+05, 3.8523e+00, 3.9812e+05,
         3.6790e+00, 3.7408e+00, 3.8933e+00, 0.0000e+00, 3.9358e+05, 3.8903e+00,
         3.9488e+00],
        [7.7863e+05, 3.9358e+05, 7.6544e+05, 7.7438e+05, 3.9356e+05, 7.9774e+05,
         3.9353e+05, 3.9357e+05, 3.9349e+05, 3.9358e+05, 0.0000e+00, 3.9354e+05,
         3.9351e+05],
        [3.9448e+05, 3.5441e+00, 3.9256e+05, 3.9560e+05, 3.7088e+00, 3.9814e+05,
         3.6116e+00, 3.7726e+00, 3.9335e+00, 3.8903e+00, 3.9354e+05, 0.0000e+00,
         3.9562e+00],
        [3.9451e+05, 3.8923e+00, 3.9252e+05, 3.9565e+05, 4.0119e+00, 3.9815e+05,
         3.6920e+00, 3.8369e+00, 4.0370e+00, 3.9488e+00, 3.9351e+05, 3.9562e+00,
         0.0000e+00]])
sorted_distances: tensor([     0.0000, 394456.2812, 394468.4062, 394470.9062, 394477.9688,
        394478.6562, 394495.1562, 394509.0938, 394522.7188, 778634.8750,
        781592.6875, 786434.2500, 798954.5625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.5050e+00, 3.5441e+00, 3.6765e+00, 3.6771e+00, 3.7442e+00,
        3.8053e+00, 3.8923e+00, 3.9254e+05, 3.9358e+05, 3.9450e+05, 3.9557e+05,
        3.9810e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 392486.4062, 392498.0938, 392498.5938, 392504.9375,
        392523.6875, 392525.3750, 392539.5312, 392555.5312, 763819.7500,
        765440.0000, 786434.2500, 800446.8125])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 395556.2188, 395559.5625, 395573.5625, 395578.2812,
        395594.6250, 395603.5000, 395609.0625, 395653.2812, 763819.7500,
        774382.6875, 781592.6875, 797173.3750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6771e+00, 3.7088e+00, 3.8117e+00, 3.8453e+00, 3.8523e+00,
        3.9942e+00, 4.0119e+00, 3.9250e+05, 3.9356e+05, 3.9447e+05, 3.9559e+05,
        3.9815e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 398095.9062, 398096.5000, 398116.7188, 398128.6250,
        398131.5312, 398137.4062, 398150.1562, 398153.2812, 797173.3750,
        797742.5625, 798954.5625, 800446.8125])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.3373e+00, 3.5050e+00, 3.6116e+00, 3.6313e+00, 3.6790e+00,
        3.6920e+00, 3.8117e+00, 3.9249e+05, 3.9353e+05, 3.9452e+05, 3.9556e+05,
        3.9813e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6313e+00, 3.7408e+00, 3.7442e+00, 3.7726e+00, 3.8369e+00,
        3.8453e+00, 3.8612e+00, 3.9250e+05, 3.9357e+05, 3.9448e+05, 3.9561e+05,
        3.9810e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.3373e+00, 3.8053e+00, 3.8612e+00, 3.8933e+00, 3.9335e+00,
        3.9942e+00, 4.0370e+00, 3.9250e+05, 3.9349e+05, 3.9446e+05, 3.9556e+05,
        3.9813e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6765e+00, 3.6790e+00, 3.7408e+00, 3.8523e+00, 3.8903e+00,
        3.8933e+00, 3.9488e+00, 3.9253e+05, 3.9358e+05, 3.9447e+05, 3.9558e+05,
        3.9812e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 393488.4375, 393508.1875, 393532.5938, 393536.9062,
        393561.5938, 393571.5625, 393575.6875, 393581.8750, 765440.0000,
        774382.6875, 778634.8750, 797742.5625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.5441e+00, 3.6116e+00, 3.7088e+00, 3.7726e+00, 3.8903e+00,
        3.9335e+00, 3.9562e+00, 3.9256e+05, 3.9354e+05, 3.9448e+05, 3.9560e+05,
        3.9814e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6920e+00, 3.8369e+00, 3.8923e+00, 3.9488e+00, 3.9562e+00,
        4.0119e+00, 4.0370e+00, 3.9252e+05, 3.9351e+05, 3.9451e+05, 3.9565e+05,
        3.9815e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['394484.91', '49070.67', '392516.50', '395591.00', '49065.69', '398126.25', '49063.96', '49066.42', '49065.62', '49069.01', '393544.62', '49072.74', '49068.88']
estimated f for each client, fs: [3, 5, 3, 3, 5, 4, 5, 5, 5, 5, 3, 5, 5]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [14, 1, 18, 16, 6, 15, 10, 8, 3, 11, 20, 2, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0096s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:41...
global Accuracy on shared test data: 54.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[105 132]
 [ 94 169]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:41, End: 2025-07-22 15:45:41)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [18, 20, 1, 14, 9, 5, 4, 6, 8, 17, 12, 11, 15, 10, 3, 2], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 8.1032e+05, 3.9151e+05, 7.9301e+05, 3.9150e+05, 3.9154e+05,
         3.9151e+05, 3.9155e+05, 3.9155e+05, 7.8709e+05, 3.9159e+05, 3.9151e+05,
         7.5532e+05, 3.9155e+05, 3.9153e+05, 3.9158e+05],
        [8.1032e+05, 0.0000e+00, 4.1101e+05, 7.9984e+05, 4.1101e+05, 4.1104e+05,
         4.1099e+05, 4.1097e+05, 4.1105e+05, 7.8250e+05, 4.1106e+05, 4.1097e+05,
         7.8282e+05, 4.1100e+05, 4.1103e+05, 4.1099e+05],
        [3.9151e+05, 4.1101e+05, 0.0000e+00, 3.9222e+05, 3.8025e+00, 3.5857e+00,
         3.5121e+00, 3.7637e+00, 3.6975e+00, 3.8563e+05, 4.0564e+00, 3.6920e+00,
         3.8480e+05, 3.5830e+00, 3.9103e+00, 3.6830e+00],
        [7.9301e+05, 7.9984e+05, 3.9222e+05, 0.0000e+00, 3.9227e+05, 3.9227e+05,
         3.9222e+05, 3.9231e+05, 3.9230e+05, 7.9412e+05, 3.9227e+05, 3.9226e+05,
         8.0045e+05, 3.9225e+05, 3.9231e+05, 3.9226e+05],
        [3.9150e+05, 4.1101e+05, 3.8025e+00, 3.9227e+05, 0.0000e+00, 4.0163e+00,
         3.8341e+00, 4.4737e+00, 3.8305e+00, 3.8566e+05, 4.3709e+00, 3.8649e+00,
         3.8476e+05, 3.9560e+00, 4.0581e+00, 4.2802e+00],
        [3.9154e+05, 4.1104e+05, 3.5857e+00, 3.9227e+05, 4.0163e+00, 0.0000e+00,
         3.9002e+00, 4.1521e+00, 3.8532e+00, 3.8566e+05, 3.7517e+00, 3.7967e+00,
         3.8482e+05, 3.5231e+00, 3.5722e+00, 3.6599e+00],
        [3.9151e+05, 4.1099e+05, 3.5121e+00, 3.9222e+05, 3.8341e+00, 3.9002e+00,
         0.0000e+00, 3.8622e+00, 3.7664e+00, 3.8570e+05, 4.0321e+00, 3.5967e+00,
         3.8488e+05, 3.7251e+00, 3.8125e+00, 3.9768e+00],
        [3.9155e+05, 4.1097e+05, 3.7637e+00, 3.9231e+05, 4.4737e+00, 4.1521e+00,
         3.8622e+00, 0.0000e+00, 3.8216e+00, 3.8563e+05, 4.0503e+00, 3.8460e+00,
         3.8479e+05, 3.7160e+00, 4.0337e+00, 3.7917e+00],
        [3.9155e+05, 4.1105e+05, 3.6975e+00, 3.9230e+05, 3.8305e+00, 3.8532e+00,
         3.7664e+00, 3.8216e+00, 0.0000e+00, 3.8567e+05, 3.7767e+00, 3.6594e+00,
         3.8479e+05, 3.5900e+00, 3.8320e+00, 3.7157e+00],
        [7.8709e+05, 7.8250e+05, 3.8563e+05, 7.9412e+05, 3.8566e+05, 3.8566e+05,
         3.8570e+05, 3.8563e+05, 3.8567e+05, 0.0000e+00, 3.8568e+05, 3.8568e+05,
         7.4251e+05, 3.8570e+05, 3.8565e+05, 3.8568e+05],
        [3.9159e+05, 4.1106e+05, 4.0564e+00, 3.9227e+05, 4.3709e+00, 3.7517e+00,
         4.0321e+00, 4.0503e+00, 3.7767e+00, 3.8568e+05, 0.0000e+00, 4.0331e+00,
         3.8482e+05, 3.6644e+00, 4.1092e+00, 3.8893e+00],
        [3.9151e+05, 4.1097e+05, 3.6920e+00, 3.9226e+05, 3.8649e+00, 3.7967e+00,
         3.5967e+00, 3.8460e+00, 3.6594e+00, 3.8568e+05, 4.0331e+00, 0.0000e+00,
         3.8483e+05, 3.6665e+00, 3.9653e+00, 3.9188e+00],
        [7.5532e+05, 7.8282e+05, 3.8480e+05, 8.0045e+05, 3.8476e+05, 3.8482e+05,
         3.8488e+05, 3.8479e+05, 3.8479e+05, 7.4251e+05, 3.8482e+05, 3.8483e+05,
         0.0000e+00, 3.8477e+05, 3.8477e+05, 3.8478e+05],
        [3.9155e+05, 4.1100e+05, 3.5830e+00, 3.9225e+05, 3.9560e+00, 3.5231e+00,
         3.7251e+00, 3.7160e+00, 3.5900e+00, 3.8570e+05, 3.6644e+00, 3.6665e+00,
         3.8477e+05, 0.0000e+00, 3.4214e+00, 3.5362e+00],
        [3.9153e+05, 4.1103e+05, 3.9103e+00, 3.9231e+05, 4.0581e+00, 3.5722e+00,
         3.8125e+00, 4.0337e+00, 3.8320e+00, 3.8565e+05, 4.1092e+00, 3.9653e+00,
         3.8477e+05, 3.4214e+00, 0.0000e+00, 4.0027e+00],
        [3.9158e+05, 4.1099e+05, 3.6830e+00, 3.9226e+05, 4.2802e+00, 3.6599e+00,
         3.9768e+00, 3.7917e+00, 3.7157e+00, 3.8568e+05, 3.8893e+00, 3.9188e+00,
         3.8478e+05, 3.5362e+00, 4.0027e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 391497.5312, 391506.5625, 391508.0625, 391513.6875,
        391526.9375, 391544.7500, 391548.5938, 391551.5312, 391553.6250,
        391582.0625, 391585.5000, 755318.0625, 787091.8750, 793012.1250,
        810322.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 410969.2500, 410973.2188, 410985.7812, 410992.3438,
        411000.4688, 411006.6562, 411011.7812, 411025.1562, 411035.3438,
        411045.0312, 411061.3438, 782503.5625, 782822.2500, 799835.0000,
        810322.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5121e+00, 3.5830e+00, 3.5857e+00, 3.6830e+00, 3.6920e+00,
        3.6975e+00, 3.7637e+00, 3.8025e+00, 3.9103e+00, 4.0564e+00, 3.8480e+05,
        3.8563e+05, 3.9151e+05, 3.9222e+05, 4.1101e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392220.2812, 392222.3125, 392254.5625, 392259.8750,
        392263.5625, 392265.8750, 392271.7812, 392273.0938, 392300.4688,
        392306.6875, 392309.8750, 793012.1250, 794115.8750, 799835.0000,
        800445.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.8025e+00, 3.8305e+00, 3.8341e+00, 3.8649e+00, 3.9560e+00,
        4.0163e+00, 4.0581e+00, 4.2802e+00, 4.3709e+00, 4.4737e+00, 3.8476e+05,
        3.8566e+05, 3.9150e+05, 3.9227e+05, 4.1101e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5231e+00, 3.5722e+00, 3.5857e+00, 3.6599e+00, 3.7517e+00,
        3.7967e+00, 3.8532e+00, 3.9002e+00, 4.0163e+00, 4.1521e+00, 3.8482e+05,
        3.8566e+05, 3.9154e+05, 3.9227e+05, 4.1104e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5121e+00, 3.5967e+00, 3.7251e+00, 3.7664e+00, 3.8125e+00,
        3.8341e+00, 3.8622e+00, 3.9002e+00, 3.9768e+00, 4.0321e+00, 3.8488e+05,
        3.8570e+05, 3.9151e+05, 3.9222e+05, 4.1099e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.7160e+00, 3.7637e+00, 3.7917e+00, 3.8216e+00, 3.8460e+00,
        3.8622e+00, 4.0337e+00, 4.0503e+00, 4.1521e+00, 4.4737e+00, 3.8479e+05,
        3.8563e+05, 3.9155e+05, 3.9231e+05, 4.1097e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5900e+00, 3.6594e+00, 3.6975e+00, 3.7157e+00, 3.7664e+00,
        3.7767e+00, 3.8216e+00, 3.8305e+00, 3.8320e+00, 3.8532e+00, 3.8479e+05,
        3.8567e+05, 3.9155e+05, 3.9230e+05, 4.1105e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385630.3750, 385631.4375, 385651.3750, 385655.3750,
        385656.4688, 385673.7500, 385676.6250, 385681.4688, 385684.6562,
        385696.7812, 385697.8750, 742508.1250, 782503.5625, 787091.8750,
        794115.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6644e+00, 3.7517e+00, 3.7767e+00, 3.8893e+00, 4.0321e+00,
        4.0331e+00, 4.0503e+00, 4.0564e+00, 4.1092e+00, 4.3709e+00, 3.8482e+05,
        3.8568e+05, 3.9159e+05, 3.9227e+05, 4.1106e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5967e+00, 3.6594e+00, 3.6665e+00, 3.6920e+00, 3.7967e+00,
        3.8460e+00, 3.8649e+00, 3.9188e+00, 3.9653e+00, 4.0331e+00, 3.8483e+05,
        3.8568e+05, 3.9151e+05, 3.9226e+05, 4.1097e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384759.5938, 384770.5000, 384772.8125, 384779.4375,
        384789.1250, 384790.8750, 384801.9688, 384815.7500, 384823.8438,
        384833.1875, 384880.5000, 742508.1250, 755318.0625, 782822.2500,
        800445.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4214e+00, 3.5231e+00, 3.5362e+00, 3.5830e+00, 3.5900e+00,
        3.6644e+00, 3.6665e+00, 3.7160e+00, 3.7251e+00, 3.9560e+00, 3.8477e+05,
        3.8570e+05, 3.9155e+05, 3.9225e+05, 4.1100e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4214e+00, 3.5722e+00, 3.8125e+00, 3.8320e+00, 3.9103e+00,
        3.9653e+00, 4.0027e+00, 4.0337e+00, 4.0581e+00, 4.1092e+00, 3.8477e+05,
        3.8565e+05, 3.9153e+05, 3.9231e+05, 4.1103e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5362e+00, 3.6599e+00, 3.6830e+00, 3.7157e+00, 3.7917e+00,
        3.8893e+00, 3.9188e+00, 3.9768e+00, 4.0027e+00, 4.2802e+00, 3.8478e+05,
        3.8568e+05, 3.9158e+05, 3.9226e+05, 4.1099e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['391538.09', '411009.69', '3.73', '392263.81', '4.05', '3.78', '3.80', '3.95', '3.75', '385666.97', '3.97', '3.80', '384801.62', '3.64', '3.87', '3.85']
estimated f for each client, fs: [3, 3, 5, 5, 5, 5, 5, 5, 5, 3, 5, 5, 3, 5, 5, 5]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [18, 20, 1, 14, 9, 5, 4, 6, 8, 17, 12, 11, 15, 10, 3, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:42...
global Accuracy on shared test data: 54.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[105 132]
 [ 95 168]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:42, End: 2025-07-22 15:45:42)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [2, 7], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 3.8272],
        [3.8272, 0.0000]])
sorted_distances: tensor([0.0000, 3.8272])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000, 3.8272])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['3.83', '3.83']
estimated f for each client, fs: [1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [2, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0015s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:42...
global Accuracy on shared test data: 54.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[105 132]
 [ 95 168]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:42, End: 2025-07-22 15:45:42)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (4): [2, 8, 6, 1], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 4
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([4])
tensor([[0.0000, 3.6815, 3.6331, 3.7639],
        [3.6815, 0.0000, 3.7842, 3.7512],
        [3.6331, 3.7842, 0.0000, 3.8870],
        [3.7639, 3.7512, 3.8870, 0.0000]])
sorted_distances: tensor([0.0000, 3.6331, 3.6815, 3.7639])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000, 3.6815, 3.7512, 3.7842])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000, 3.6331, 3.7842, 3.8870])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000, 3.7512, 3.7639, 3.8870])
Index of maximum distance difference after half of values: 4
adaptive_Krum scores:  ['3.69', '3.74', '3.77', '3.80']
estimated f for each client, fs: [0, 0, 0, 0]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']], selected_client_indices: [2, 8, 6, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0178s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:43...
global Accuracy on shared test data: 54.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[106 131]
 [ 97 166]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:43, End: 2025-07-22 15:45:43)
start time is: 98091852924266, end time is: 98124990771116
The total time is: 33137846850ns.

 ------- aggregate method: rkrum, random_seed: 100 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [5, 13, 3, 2, 11], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
tensor([[0.0000e+00, 4.0260e+05, 5.1157e+00, 5.7703e+00, 5.4258e+00],
        [4.0260e+05, 0.0000e+00, 4.0264e+05, 4.0266e+05, 4.0267e+05],
        [5.1157e+00, 4.0264e+05, 0.0000e+00, 4.5757e+00, 5.0182e+00],
        [5.7703e+00, 4.0266e+05, 4.5757e+00, 0.0000e+00, 4.0992e+00],
        [5.4258e+00, 4.0267e+05, 5.0182e+00, 4.0992e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 5.1157e+00, 5.4258e+00, 5.7703e+00, 4.0260e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([     0.0000, 402600.4688, 402641.3125, 402655.3438, 402670.8750])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 4.5757e+00, 5.0182e+00, 5.1157e+00, 4.0264e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 4.0992e+00, 4.5757e+00, 5.7703e+00, 4.0266e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 4.0992e+00, 5.0182e+00, 5.4258e+00, 4.0267e+05])
Index of maximum distance difference after half of values: 4
adaptive_Krum scores:  ['100654.20', '402642.03', '100664.02', '100667.45', '100671.36']
estimated f for each client, fs: [1, 0, 1, 1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']], selected_client_indices: [5, 13, 3, 2, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0030s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:43...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:43, End: 2025-07-22 15:45:43)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [6, 16, 8, 12, 4, 11, 10, 9, 7, 14, 13, 3, 1, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.8624e+05, 2.2903e+00, 2.1995e+00, 2.0930e+00, 2.2636e+00,
         2.1717e+00, 2.0939e+00, 2.2825e+00, 3.8178e+05, 3.9139e+05, 2.3958e+00,
         2.1362e+00, 3.8335e+05],
        [3.8624e+05, 0.0000e+00, 3.8626e+05, 3.8624e+05, 3.8630e+05, 3.8627e+05,
         3.8628e+05, 3.8627e+05, 3.8630e+05, 7.6320e+05, 7.6162e+05, 3.8628e+05,
         3.8631e+05, 7.9431e+05],
        [2.2903e+00, 3.8626e+05, 0.0000e+00, 2.1160e+00, 2.0579e+00, 2.2633e+00,
         2.1677e+00, 2.1571e+00, 2.2202e+00, 3.8182e+05, 3.9135e+05, 2.2070e+00,
         2.2525e+00, 3.8336e+05],
        [2.1995e+00, 3.8624e+05, 2.1160e+00, 0.0000e+00, 1.9429e+00, 1.9643e+00,
         2.0259e+00, 2.0037e+00, 2.0228e+00, 3.8181e+05, 3.9135e+05, 1.9669e+00,
         1.9909e+00, 3.8338e+05],
        [2.0930e+00, 3.8630e+05, 2.0579e+00, 1.9429e+00, 0.0000e+00, 2.0891e+00,
         2.1293e+00, 2.0023e+00, 1.9505e+00, 3.8183e+05, 3.9140e+05, 2.1635e+00,
         2.0384e+00, 3.8336e+05],
        [2.2636e+00, 3.8627e+05, 2.2633e+00, 1.9643e+00, 2.0891e+00, 0.0000e+00,
         2.0544e+00, 1.9574e+00, 2.0092e+00, 3.8177e+05, 3.9135e+05, 2.2669e+00,
         1.9747e+00, 3.8334e+05],
        [2.1717e+00, 3.8628e+05, 2.1677e+00, 2.0259e+00, 2.1293e+00, 2.0544e+00,
         0.0000e+00, 1.8719e+00, 2.0069e+00, 3.8181e+05, 3.9137e+05, 1.9871e+00,
         2.0820e+00, 3.8336e+05],
        [2.0939e+00, 3.8627e+05, 2.1571e+00, 2.0037e+00, 2.0023e+00, 1.9574e+00,
         1.8719e+00, 0.0000e+00, 2.0918e+00, 3.8180e+05, 3.9135e+05, 1.9335e+00,
         1.9718e+00, 3.8338e+05],
        [2.2825e+00, 3.8630e+05, 2.2202e+00, 2.0228e+00, 1.9505e+00, 2.0092e+00,
         2.0069e+00, 2.0918e+00, 0.0000e+00, 3.8183e+05, 3.9140e+05, 2.1418e+00,
         2.1321e+00, 3.8337e+05],
        [3.8178e+05, 7.6320e+05, 3.8182e+05, 3.8181e+05, 3.8183e+05, 3.8177e+05,
         3.8181e+05, 3.8180e+05, 3.8183e+05, 0.0000e+00, 7.4789e+05, 3.8185e+05,
         3.8182e+05, 7.6278e+05],
        [3.9139e+05, 7.6162e+05, 3.9135e+05, 3.9135e+05, 3.9140e+05, 3.9135e+05,
         3.9137e+05, 3.9135e+05, 3.9140e+05, 7.4789e+05, 0.0000e+00, 3.9130e+05,
         3.9137e+05, 7.7046e+05],
        [2.3958e+00, 3.8628e+05, 2.2070e+00, 1.9669e+00, 2.1635e+00, 2.2669e+00,
         1.9871e+00, 1.9335e+00, 2.1418e+00, 3.8185e+05, 3.9130e+05, 0.0000e+00,
         2.2264e+00, 3.8338e+05],
        [2.1362e+00, 3.8631e+05, 2.2525e+00, 1.9909e+00, 2.0384e+00, 1.9747e+00,
         2.0820e+00, 1.9718e+00, 2.1321e+00, 3.8182e+05, 3.9137e+05, 2.2264e+00,
         0.0000e+00, 3.8335e+05],
        [3.8335e+05, 7.9431e+05, 3.8336e+05, 3.8338e+05, 3.8336e+05, 3.8334e+05,
         3.8336e+05, 3.8338e+05, 3.8337e+05, 7.6278e+05, 7.7046e+05, 3.8338e+05,
         3.8335e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 2.0930e+00, 2.0939e+00, 2.1362e+00, 2.1717e+00, 2.1995e+00,
        2.2636e+00, 2.2825e+00, 2.2903e+00, 2.3958e+00, 3.8178e+05, 3.8335e+05,
        3.8624e+05, 3.9139e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386238.2812, 386243.4062, 386256.7188, 386267.7188,
        386270.4688, 386279.1250, 386279.4688, 386295.7500, 386299.0938,
        386314.1875, 761624.8750, 763195.8750, 794310.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 2.0579e+00, 2.1160e+00, 2.1571e+00, 2.1677e+00, 2.2070e+00,
        2.2202e+00, 2.2525e+00, 2.2633e+00, 2.2903e+00, 3.8182e+05, 3.8336e+05,
        3.8626e+05, 3.9135e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.9429e+00, 1.9643e+00, 1.9669e+00, 1.9909e+00, 2.0037e+00,
        2.0228e+00, 2.0259e+00, 2.1160e+00, 2.1995e+00, 3.8181e+05, 3.8338e+05,
        3.8624e+05, 3.9135e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.9429e+00, 1.9505e+00, 2.0023e+00, 2.0384e+00, 2.0579e+00,
        2.0891e+00, 2.0930e+00, 2.1293e+00, 2.1635e+00, 3.8183e+05, 3.8336e+05,
        3.8630e+05, 3.9140e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.9574e+00, 1.9643e+00, 1.9747e+00, 2.0092e+00, 2.0544e+00,
        2.0891e+00, 2.2633e+00, 2.2636e+00, 2.2669e+00, 3.8177e+05, 3.8334e+05,
        3.8627e+05, 3.9135e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.8719e+00, 1.9871e+00, 2.0069e+00, 2.0259e+00, 2.0544e+00,
        2.0820e+00, 2.1293e+00, 2.1677e+00, 2.1717e+00, 3.8181e+05, 3.8336e+05,
        3.8628e+05, 3.9137e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.8719e+00, 1.9335e+00, 1.9574e+00, 1.9718e+00, 2.0023e+00,
        2.0037e+00, 2.0918e+00, 2.0939e+00, 2.1571e+00, 3.8180e+05, 3.8338e+05,
        3.8627e+05, 3.9135e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.9505e+00, 2.0069e+00, 2.0092e+00, 2.0228e+00, 2.0918e+00,
        2.1321e+00, 2.1418e+00, 2.2202e+00, 2.2825e+00, 3.8183e+05, 3.8337e+05,
        3.8630e+05, 3.9140e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 381766.0938, 381778.8750, 381801.0938, 381813.5312,
        381813.6875, 381821.8125, 381822.8125, 381825.3125, 381830.5000,
        381849.0000, 747889.3750, 762783.2500, 763195.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391301.5938, 391347.1250, 391348.0000, 391351.4062,
        391351.6250, 391365.6250, 391372.4375, 391394.2188, 391401.2188,
        391401.5938, 747889.3750, 761624.8750, 770461.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.9335e+00, 1.9669e+00, 1.9871e+00, 2.1418e+00, 2.1635e+00,
        2.2070e+00, 2.2264e+00, 2.2669e+00, 2.3958e+00, 3.8185e+05, 3.8338e+05,
        3.8628e+05, 3.9130e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.9718e+00, 1.9747e+00, 1.9909e+00, 2.0384e+00, 2.0820e+00,
        2.1321e+00, 2.1362e+00, 2.2264e+00, 2.2525e+00, 3.8182e+05, 3.8335e+05,
        3.8631e+05, 3.9137e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 383337.0000, 383347.5938, 383348.0312, 383358.0000,
        383363.4062, 383363.5000, 383365.5312, 383375.8750, 383376.5000,
        383380.2812, 762783.2500, 770461.8750, 794310.0000])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['2.21', '386274.34', '2.19', '2.03', '2.05', '2.09', '2.06', '2.01', '2.10', '381812.25', '391363.44', '2.14', '2.09', '383361.53']
estimated f for each client, fs: [4, 2, 4, 4, 4, 4, 4, 4, 4, 2, 2, 4, 4, 2]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [6, 16, 8, 12, 4, 11, 10, 9, 7, 14, 13, 3, 1, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0100s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:44...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:44, End: 2025-07-22 15:45:44)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [3, 9, 17, 11, 6, 14, 8], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 1.8400e+00, 3.9764e+05, 1.8951e+00, 1.9561e+00, 3.8631e+05,
         1.8309e+00],
        [1.8400e+00, 0.0000e+00, 3.9766e+05, 1.7811e+00, 1.9323e+00, 3.8631e+05,
         2.0766e+00],
        [3.9764e+05, 3.9766e+05, 0.0000e+00, 3.9765e+05, 3.9763e+05, 7.7052e+05,
         3.9767e+05],
        [1.8951e+00, 1.7811e+00, 3.9765e+05, 0.0000e+00, 1.8372e+00, 3.8630e+05,
         1.8578e+00],
        [1.9561e+00, 1.9323e+00, 3.9763e+05, 1.8372e+00, 0.0000e+00, 3.8629e+05,
         1.8958e+00],
        [3.8631e+05, 3.8631e+05, 7.7052e+05, 3.8630e+05, 3.8629e+05, 0.0000e+00,
         3.8633e+05],
        [1.8309e+00, 2.0766e+00, 3.9767e+05, 1.8578e+00, 1.8958e+00, 3.8633e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.8309e+00, 1.8400e+00, 1.8951e+00, 1.9561e+00, 3.8631e+05,
        3.9764e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.7811e+00, 1.8400e+00, 1.9323e+00, 2.0766e+00, 3.8631e+05,
        3.9766e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 397634.8125, 397640.2500, 397646.2188, 397661.5625,
        397672.0938, 770516.3750])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.7811e+00, 1.8372e+00, 1.8578e+00, 1.8951e+00, 3.8630e+05,
        3.9765e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.8372e+00, 1.8958e+00, 1.9323e+00, 1.9561e+00, 3.8629e+05,
        3.9763e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 386285.1562, 386302.5000, 386306.4375, 386310.2500,
        386325.6562, 770516.3750])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.8309e+00, 1.8578e+00, 1.8958e+00, 2.0766e+00, 3.8633e+05,
        3.9767e+05])
Index of maximum distance difference after half of values: 5
adaptive_Krum scores:  ['77262.80', '77263.58', '397651.00', '77261.98', '77258.56', '386306.03', '77266.66']
estimated f for each client, fs: [2, 2, 0, 2, 2, 0, 2]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']], selected_client_indices: [3, 9, 17, 11, 6, 14, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0065s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:44...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:44, End: 2025-07-22 15:45:44)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [2, 5, 8, 15, 13, 4, 18], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 2.1430e+00, 1.9947e+00, 3.8094e+05, 4.0418e+05, 1.8276e+00,
         3.7073e+05],
        [2.1430e+00, 0.0000e+00, 2.1694e+00, 3.8095e+05, 4.0419e+05, 1.9812e+00,
         3.7072e+05],
        [1.9947e+00, 2.1694e+00, 0.0000e+00, 3.8095e+05, 4.0415e+05, 1.7708e+00,
         3.7071e+05],
        [3.8094e+05, 3.8095e+05, 3.8095e+05, 0.0000e+00, 7.7415e+05, 3.8095e+05,
         7.5523e+05],
        [4.0418e+05, 4.0419e+05, 4.0415e+05, 7.7415e+05, 0.0000e+00, 4.0420e+05,
         7.8070e+05],
        [1.8276e+00, 1.9812e+00, 1.7708e+00, 3.8095e+05, 4.0420e+05, 0.0000e+00,
         3.7075e+05],
        [3.7073e+05, 3.7072e+05, 3.7071e+05, 7.5523e+05, 7.8070e+05, 3.7075e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.8276e+00, 1.9947e+00, 2.1430e+00, 3.7073e+05, 3.8094e+05,
        4.0418e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.9812e+00, 2.1430e+00, 2.1694e+00, 3.7072e+05, 3.8095e+05,
        4.0419e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.7708e+00, 1.9947e+00, 2.1694e+00, 3.7071e+05, 3.8095e+05,
        4.0415e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 380938.5625, 380946.9375, 380947.1250, 380954.8750,
        755225.9375, 774152.5625])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 404147.2812, 404175.8438, 404190.9062, 404197.5625,
        774152.5625, 780704.5000])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.7708e+00, 1.8276e+00, 1.9812e+00, 3.7075e+05, 3.8095e+05,
        4.0420e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 370708.0938, 370717.5000, 370727.3438, 370751.8125,
        755225.9375, 780704.5000])
Index of maximum distance difference after half of values: 5
adaptive_Krum scores:  ['150334.38', '150335.73', '150332.19', '455802.72', '478172.84', '150340.91', '447626.09']
estimated f for each client, fs: [3, 3, 3, 1, 1, 3, 2]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [2, 5, 8, 15, 13, 4, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:44...
global Accuracy on shared test data: 78.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:44, End: 2025-07-22 15:45:44)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (4): [3, 7, 2, 9], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 4
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([4])
tensor([[0.0000, 1.7993, 1.8590, 1.7505],
        [1.7993, 0.0000, 1.7226, 1.8393],
        [1.8590, 1.7226, 0.0000, 1.8542],
        [1.7505, 1.8393, 1.8542, 0.0000]])
sorted_distances: tensor([0.0000, 1.7505, 1.7993, 1.8590])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000, 1.7226, 1.7993, 1.8393])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000, 1.7226, 1.8542, 1.8590])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000, 1.7505, 1.8393, 1.8542])
Index of maximum distance difference after half of values: 4
adaptive_Krum scores:  ['1.80', '1.79', '1.81', '1.81']
estimated f for each client, fs: [0, 0, 0, 0]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']], selected_client_indices: [3, 7, 2, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0062s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:45...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:45, End: 2025-07-22 15:45:45)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [3, 17, 13, 7, 10, 19, 2, 14, 12, 4, 1, 15, 6, 9, 20, 11, 18, 16, 8], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.9258e+05, 4.0108e+05, 1.8948e+00, 1.7226e+00, 4.0030e+05,
         1.7528e+00, 3.9500e+05, 1.7237e+00, 1.8593e+00, 1.9514e+00, 4.0183e+05,
         1.9665e+00, 1.7361e+00, 4.0169e+05, 1.9160e+00, 3.6306e+05, 3.9758e+05,
         1.8633e+00],
        [3.9258e+05, 0.0000e+00, 7.8705e+05, 3.9256e+05, 3.9259e+05, 8.1523e+05,
         3.9258e+05, 7.8094e+05, 3.9258e+05, 3.9258e+05, 3.9259e+05, 7.7497e+05,
         3.9258e+05, 3.9258e+05, 7.8086e+05, 3.9260e+05, 7.5506e+05, 8.2277e+05,
         3.9258e+05],
        [4.0108e+05, 7.8705e+05, 0.0000e+00, 4.0106e+05, 4.0107e+05, 7.9011e+05,
         4.0106e+05, 7.8533e+05, 4.0108e+05, 4.0103e+05, 4.0104e+05, 8.1693e+05,
         4.0105e+05, 4.0108e+05, 7.9974e+05, 4.0108e+05, 7.7276e+05, 7.9586e+05,
         4.0105e+05],
        [1.8948e+00, 3.9256e+05, 4.0106e+05, 0.0000e+00, 1.7408e+00, 4.0033e+05,
         1.8574e+00, 3.9499e+05, 1.9478e+00, 1.8532e+00, 1.9038e+00, 4.0180e+05,
         1.9206e+00, 1.7527e+00, 4.0169e+05, 1.8711e+00, 3.6306e+05, 3.9759e+05,
         1.8354e+00],
        [1.7226e+00, 3.9259e+05, 4.0107e+05, 1.7408e+00, 0.0000e+00, 4.0034e+05,
         1.7484e+00, 3.9502e+05, 1.8210e+00, 1.9120e+00, 1.7979e+00, 4.0184e+05,
         1.8197e+00, 1.7273e+00, 4.0171e+05, 1.7336e+00, 3.6307e+05, 3.9758e+05,
         1.8444e+00],
        [4.0030e+05, 8.1523e+05, 7.9011e+05, 4.0033e+05, 4.0034e+05, 0.0000e+00,
         4.0035e+05, 7.9752e+05, 4.0033e+05, 4.0034e+05, 4.0032e+05, 8.0360e+05,
         4.0032e+05, 4.0030e+05, 8.1076e+05, 4.0035e+05, 7.5817e+05, 8.0865e+05,
         4.0031e+05],
        [1.7528e+00, 3.9258e+05, 4.0106e+05, 1.8574e+00, 1.7484e+00, 4.0035e+05,
         0.0000e+00, 3.9498e+05, 1.8047e+00, 1.8282e+00, 1.8759e+00, 4.0183e+05,
         1.7405e+00, 1.8470e+00, 4.0166e+05, 1.7771e+00, 3.6307e+05, 3.9759e+05,
         1.9765e+00],
        [3.9500e+05, 7.8094e+05, 7.8533e+05, 3.9499e+05, 3.9502e+05, 7.9752e+05,
         3.9498e+05, 0.0000e+00, 3.9501e+05, 3.9502e+05, 3.9503e+05, 7.9665e+05,
         3.9502e+05, 3.9504e+05, 8.0764e+05, 3.9498e+05, 7.7493e+05, 8.2356e+05,
         3.9504e+05],
        [1.7237e+00, 3.9258e+05, 4.0108e+05, 1.9478e+00, 1.8210e+00, 4.0033e+05,
         1.8047e+00, 3.9501e+05, 0.0000e+00, 1.7991e+00, 1.7898e+00, 4.0179e+05,
         1.8284e+00, 1.8135e+00, 4.0173e+05, 1.6686e+00, 3.6307e+05, 3.9758e+05,
         1.8208e+00],
        [1.8593e+00, 3.9258e+05, 4.0103e+05, 1.8532e+00, 1.9120e+00, 4.0034e+05,
         1.8282e+00, 3.9502e+05, 1.7991e+00, 0.0000e+00, 1.8629e+00, 4.0184e+05,
         1.8052e+00, 1.9283e+00, 4.0168e+05, 1.7568e+00, 3.6307e+05, 3.9753e+05,
         1.8012e+00],
        [1.9514e+00, 3.9259e+05, 4.0104e+05, 1.9038e+00, 1.7979e+00, 4.0032e+05,
         1.8759e+00, 3.9503e+05, 1.7898e+00, 1.8629e+00, 0.0000e+00, 4.0183e+05,
         1.7749e+00, 1.8103e+00, 4.0171e+05, 1.7258e+00, 3.6308e+05, 3.9761e+05,
         1.9563e+00],
        [4.0183e+05, 7.7497e+05, 8.1693e+05, 4.0180e+05, 4.0184e+05, 8.0360e+05,
         4.0183e+05, 7.9665e+05, 4.0179e+05, 4.0184e+05, 4.0183e+05, 0.0000e+00,
         4.0186e+05, 4.0182e+05, 8.1489e+05, 4.0181e+05, 7.7725e+05, 7.8058e+05,
         4.0180e+05],
        [1.9665e+00, 3.9258e+05, 4.0105e+05, 1.9206e+00, 1.8197e+00, 4.0032e+05,
         1.7405e+00, 3.9502e+05, 1.8284e+00, 1.8052e+00, 1.7749e+00, 4.0186e+05,
         0.0000e+00, 1.6333e+00, 4.0171e+05, 1.8198e+00, 3.6305e+05, 3.9760e+05,
         1.7576e+00],
        [1.7361e+00, 3.9258e+05, 4.0108e+05, 1.7527e+00, 1.7273e+00, 4.0030e+05,
         1.8470e+00, 3.9504e+05, 1.8135e+00, 1.9283e+00, 1.8103e+00, 4.0182e+05,
         1.6333e+00, 0.0000e+00, 4.0173e+05, 1.6465e+00, 3.6306e+05, 3.9753e+05,
         1.7765e+00],
        [4.0169e+05, 7.8086e+05, 7.9974e+05, 4.0169e+05, 4.0171e+05, 8.1076e+05,
         4.0166e+05, 8.0764e+05, 4.0173e+05, 4.0168e+05, 4.0171e+05, 8.1489e+05,
         4.0171e+05, 4.0173e+05, 0.0000e+00, 4.0169e+05, 7.3786e+05, 8.0901e+05,
         4.0171e+05],
        [1.9160e+00, 3.9260e+05, 4.0108e+05, 1.8711e+00, 1.7336e+00, 4.0035e+05,
         1.7771e+00, 3.9498e+05, 1.6686e+00, 1.7568e+00, 1.7258e+00, 4.0181e+05,
         1.8198e+00, 1.6465e+00, 4.0169e+05, 0.0000e+00, 3.6305e+05, 3.9760e+05,
         1.8559e+00],
        [3.6306e+05, 7.5506e+05, 7.7276e+05, 3.6306e+05, 3.6307e+05, 7.5817e+05,
         3.6307e+05, 7.7493e+05, 3.6307e+05, 3.6307e+05, 3.6308e+05, 7.7725e+05,
         3.6305e+05, 3.6306e+05, 7.3786e+05, 3.6305e+05, 0.0000e+00, 7.7720e+05,
         3.6304e+05],
        [3.9758e+05, 8.2277e+05, 7.9586e+05, 3.9759e+05, 3.9758e+05, 8.0865e+05,
         3.9759e+05, 8.2356e+05, 3.9758e+05, 3.9753e+05, 3.9761e+05, 7.8058e+05,
         3.9760e+05, 3.9753e+05, 8.0901e+05, 3.9760e+05, 7.7720e+05, 0.0000e+00,
         3.9761e+05],
        [1.8633e+00, 3.9258e+05, 4.0105e+05, 1.8354e+00, 1.8444e+00, 4.0031e+05,
         1.9765e+00, 3.9504e+05, 1.8208e+00, 1.8012e+00, 1.9563e+00, 4.0180e+05,
         1.7576e+00, 1.7765e+00, 4.0171e+05, 1.8559e+00, 3.6304e+05, 3.9761e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7226e+00, 1.7237e+00, 1.7361e+00, 1.7528e+00, 1.8593e+00,
        1.8633e+00, 1.8948e+00, 1.9160e+00, 1.9514e+00, 1.9665e+00, 3.6306e+05,
        3.9258e+05, 3.9500e+05, 3.9758e+05, 4.0030e+05, 4.0108e+05, 4.0169e+05,
        4.0183e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392561.6250, 392577.5312, 392578.6562, 392580.2188,
        392582.4688, 392582.6875, 392584.0312, 392584.0312, 392586.2812,
        392593.7812, 392596.3438, 755060.4375, 774973.8750, 780861.1250,
        780937.2500, 787048.8750, 815228.4375, 822773.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 401030.1562, 401044.5938, 401050.8125, 401054.9375,
        401059.8438, 401060.3125, 401071.4375, 401075.6562, 401080.1562,
        401083.2188, 401083.2812, 772763.2500, 785327.1250, 787048.8750,
        790106.9375, 795855.4375, 799736.0000, 816925.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7408e+00, 1.7527e+00, 1.8354e+00, 1.8532e+00, 1.8574e+00,
        1.8711e+00, 1.8948e+00, 1.9038e+00, 1.9206e+00, 1.9478e+00, 3.6306e+05,
        3.9256e+05, 3.9499e+05, 3.9759e+05, 4.0033e+05, 4.0106e+05, 4.0169e+05,
        4.0180e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7226e+00, 1.7273e+00, 1.7336e+00, 1.7408e+00, 1.7484e+00,
        1.7979e+00, 1.8197e+00, 1.8210e+00, 1.8444e+00, 1.9120e+00, 3.6307e+05,
        3.9259e+05, 3.9502e+05, 3.9758e+05, 4.0034e+05, 4.0107e+05, 4.0171e+05,
        4.0184e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 400300.0625, 400301.7500, 400314.8750, 400316.2500,
        400322.0312, 400328.0312, 400334.9062, 400341.2812, 400341.5938,
        400345.4375, 400349.3125, 758173.0000, 790106.9375, 797524.5625,
        803598.9375, 808647.5000, 810762.3750, 815228.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7405e+00, 1.7484e+00, 1.7528e+00, 1.7771e+00, 1.8047e+00,
        1.8282e+00, 1.8470e+00, 1.8574e+00, 1.8759e+00, 1.9765e+00, 3.6307e+05,
        3.9258e+05, 3.9498e+05, 3.9759e+05, 4.0035e+05, 4.0106e+05, 4.0166e+05,
        4.0183e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 394978.0938, 394981.2500, 394985.7500, 394998.2812,
        395007.9688, 395015.6562, 395016.6875, 395020.5000, 395025.9688,
        395038.6562, 395038.8438, 774925.3750, 780937.2500, 785327.1250,
        796654.3125, 797524.5625, 807639.1250, 823559.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6686e+00, 1.7237e+00, 1.7898e+00, 1.7991e+00, 1.8047e+00,
        1.8135e+00, 1.8208e+00, 1.8210e+00, 1.8284e+00, 1.9478e+00, 3.6307e+05,
        3.9258e+05, 3.9501e+05, 3.9758e+05, 4.0033e+05, 4.0108e+05, 4.0173e+05,
        4.0179e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7568e+00, 1.7991e+00, 1.8012e+00, 1.8052e+00, 1.8282e+00,
        1.8532e+00, 1.8593e+00, 1.8629e+00, 1.9120e+00, 1.9283e+00, 3.6307e+05,
        3.9258e+05, 3.9502e+05, 3.9753e+05, 4.0034e+05, 4.0103e+05, 4.0168e+05,
        4.0184e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7258e+00, 1.7749e+00, 1.7898e+00, 1.7979e+00, 1.8103e+00,
        1.8629e+00, 1.8759e+00, 1.9038e+00, 1.9514e+00, 1.9563e+00, 3.6308e+05,
        3.9259e+05, 3.9503e+05, 3.9761e+05, 4.0032e+05, 4.0104e+05, 4.0171e+05,
        4.0183e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 401787.5625, 401801.1562, 401801.8438, 401806.8438,
        401815.1875, 401828.7500, 401830.0000, 401834.0938, 401835.7500,
        401844.4688, 401861.9688, 774973.8750, 777249.7500, 780582.1250,
        796654.3125, 803598.9375, 814894.1250, 816925.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6333e+00, 1.7405e+00, 1.7576e+00, 1.7749e+00, 1.8052e+00,
        1.8197e+00, 1.8198e+00, 1.8284e+00, 1.9206e+00, 1.9665e+00, 3.6305e+05,
        3.9258e+05, 3.9502e+05, 3.9760e+05, 4.0032e+05, 4.0105e+05, 4.0171e+05,
        4.0186e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6333e+00, 1.6465e+00, 1.7273e+00, 1.7361e+00, 1.7527e+00,
        1.7765e+00, 1.8103e+00, 1.8135e+00, 1.8470e+00, 1.9283e+00, 3.6306e+05,
        3.9258e+05, 3.9504e+05, 3.9753e+05, 4.0030e+05, 4.0108e+05, 4.0173e+05,
        4.0182e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 401659.8438, 401676.3438, 401690.7188, 401691.0938,
        401691.4688, 401705.0938, 401710.3750, 401712.4375, 401712.6250,
        401725.5000, 401733.4062, 737861.4375, 780861.1250, 799736.0000,
        807639.1250, 809010.1875, 810762.3750, 814894.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6465e+00, 1.6686e+00, 1.7258e+00, 1.7336e+00, 1.7568e+00,
        1.7771e+00, 1.8198e+00, 1.8559e+00, 1.8711e+00, 1.9160e+00, 3.6305e+05,
        3.9260e+05, 3.9498e+05, 3.9760e+05, 4.0035e+05, 4.0108e+05, 4.0169e+05,
        4.0181e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 363038.6875, 363047.7500, 363054.9688, 363056.9688,
        363060.9375, 363062.5000, 363065.5625, 363067.6250, 363068.8438,
        363072.6875, 363081.7500, 737861.4375, 755060.4375, 758173.0000,
        772763.2500, 774925.3750, 777201.1875, 777249.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397529.5625, 397532.0312, 397575.4062, 397578.2500,
        397581.5312, 397585.7188, 397589.8438, 397598.2500, 397598.7500,
        397607.1250, 397609.6250, 777201.1875, 780582.1250, 795855.4375,
        808647.5000, 809010.1875, 822773.4375, 823559.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7576e+00, 1.7765e+00, 1.8012e+00, 1.8208e+00, 1.8354e+00,
        1.8444e+00, 1.8559e+00, 1.8633e+00, 1.9563e+00, 1.9765e+00, 3.6304e+05,
        3.9258e+05, 3.9504e+05, 3.9761e+05, 4.0031e+05, 4.0105e+05, 4.0171e+05,
        4.0180e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['33006.85', '392582.50', '401063.12', '33007.22', '33007.88', '400326.88', '33008.27', '395009.75', '33007.60', '33007.82', '33009.11', '401822.53', '33005.98', '33007.29', '401700.84', '33006.61', '363061.69', '397580.56', '33005.20']
estimated f for each client, fs: [8, 6, 6, 8, 8, 6, 8, 6, 8, 8, 8, 6, 8, 8, 6, 8, 7, 6, 8]
selected_index: 18
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Chosen Update']], selected_client_indices: [3, 17, 13, 7, 10, 19, 2, 14, 12, 4, 1, 15, 6, 9, 20, 11, 18, 16, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0139s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:45...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:45, End: 2025-07-22 15:45:45)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [14, 8, 11, 19, 2, 6, 7, 20, 9, 13, 17, 12, 16, 1, 3, 10, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.8451e+05, 3.8451e+05, 7.5794e+05, 3.8452e+05, 3.8449e+05,
         3.8447e+05, 7.8172e+05, 3.8447e+05, 7.9860e+05, 7.9274e+05, 3.8450e+05,
         7.9969e+05, 3.8449e+05, 3.8449e+05, 3.8449e+05, 7.6528e+05],
        [3.8451e+05, 0.0000e+00, 1.8760e+00, 3.7979e+05, 2.0444e+00, 1.7152e+00,
         1.6567e+00, 3.8672e+05, 1.7164e+00, 4.0101e+05, 3.9612e+05, 1.9044e+00,
         3.9510e+05, 2.0647e+00, 1.9431e+00, 1.9617e+00, 3.9131e+05],
        [3.8451e+05, 1.8760e+00, 0.0000e+00, 3.7978e+05, 1.5344e+00, 1.5092e+00,
         1.5247e+00, 3.8672e+05, 1.3974e+00, 4.0102e+05, 3.9610e+05, 1.4084e+00,
         3.9513e+05, 1.4646e+00, 1.6575e+00, 1.5120e+00, 3.9135e+05],
        [7.5794e+05, 3.7979e+05, 3.7978e+05, 0.0000e+00, 3.7978e+05, 3.7977e+05,
         3.7980e+05, 7.7316e+05, 3.7980e+05, 7.7352e+05, 7.7760e+05, 3.7978e+05,
         7.6991e+05, 3.7979e+05, 3.7976e+05, 3.7976e+05, 7.6697e+05],
        [3.8452e+05, 2.0444e+00, 1.5344e+00, 3.7978e+05, 0.0000e+00, 1.4504e+00,
         1.5445e+00, 3.8672e+05, 1.6043e+00, 4.0101e+05, 3.9611e+05, 1.5802e+00,
         3.9512e+05, 1.5716e+00, 1.5341e+00, 1.4504e+00, 3.9135e+05],
        [3.8449e+05, 1.7152e+00, 1.5092e+00, 3.7977e+05, 1.4504e+00, 0.0000e+00,
         1.5709e+00, 3.8664e+05, 1.3604e+00, 4.0101e+05, 3.9610e+05, 1.5470e+00,
         3.9512e+05, 1.5274e+00, 1.6916e+00, 1.5332e+00, 3.9136e+05],
        [3.8447e+05, 1.6567e+00, 1.5247e+00, 3.7980e+05, 1.5445e+00, 1.5709e+00,
         0.0000e+00, 3.8671e+05, 1.4557e+00, 4.0099e+05, 3.9613e+05, 1.6283e+00,
         3.9511e+05, 1.6206e+00, 1.6242e+00, 1.4848e+00, 3.9133e+05],
        [7.8172e+05, 3.8672e+05, 3.8672e+05, 7.7316e+05, 3.8672e+05, 3.8664e+05,
         3.8671e+05, 0.0000e+00, 3.8673e+05, 7.8633e+05, 7.8824e+05, 3.8670e+05,
         7.6749e+05, 3.8672e+05, 3.8670e+05, 3.8672e+05, 7.7558e+05],
        [3.8447e+05, 1.7164e+00, 1.3974e+00, 3.7980e+05, 1.6043e+00, 1.3604e+00,
         1.4557e+00, 3.8673e+05, 0.0000e+00, 4.0099e+05, 3.9612e+05, 1.5857e+00,
         3.9512e+05, 1.5382e+00, 1.5303e+00, 1.4861e+00, 3.9133e+05],
        [7.9860e+05, 4.0101e+05, 4.0102e+05, 7.7352e+05, 4.0101e+05, 4.0101e+05,
         4.0099e+05, 7.8633e+05, 4.0099e+05, 0.0000e+00, 7.7610e+05, 4.0103e+05,
         7.8661e+05, 4.0101e+05, 4.0103e+05, 4.0101e+05, 8.0102e+05],
        [7.9274e+05, 3.9612e+05, 3.9610e+05, 7.7760e+05, 3.9611e+05, 3.9610e+05,
         3.9613e+05, 7.8824e+05, 3.9612e+05, 7.7610e+05, 0.0000e+00, 3.9611e+05,
         7.8583e+05, 3.9608e+05, 3.9611e+05, 3.9611e+05, 7.7855e+05],
        [3.8450e+05, 1.9044e+00, 1.4084e+00, 3.7978e+05, 1.5802e+00, 1.5470e+00,
         1.6283e+00, 3.8670e+05, 1.5857e+00, 4.0103e+05, 3.9611e+05, 0.0000e+00,
         3.9512e+05, 1.5345e+00, 1.5037e+00, 1.5895e+00, 3.9135e+05],
        [7.9969e+05, 3.9510e+05, 3.9513e+05, 7.6991e+05, 3.9512e+05, 3.9512e+05,
         3.9511e+05, 7.6749e+05, 3.9512e+05, 7.8661e+05, 7.8583e+05, 3.9512e+05,
         0.0000e+00, 3.9513e+05, 3.9514e+05, 3.9512e+05, 7.9054e+05],
        [3.8449e+05, 2.0647e+00, 1.4646e+00, 3.7979e+05, 1.5716e+00, 1.5274e+00,
         1.6206e+00, 3.8672e+05, 1.5382e+00, 4.0101e+05, 3.9608e+05, 1.5345e+00,
         3.9513e+05, 0.0000e+00, 1.7045e+00, 1.5214e+00, 3.9132e+05],
        [3.8449e+05, 1.9431e+00, 1.6575e+00, 3.7976e+05, 1.5341e+00, 1.6916e+00,
         1.6242e+00, 3.8670e+05, 1.5303e+00, 4.0103e+05, 3.9611e+05, 1.5037e+00,
         3.9514e+05, 1.7045e+00, 0.0000e+00, 1.5456e+00, 3.9132e+05],
        [3.8449e+05, 1.9617e+00, 1.5120e+00, 3.7976e+05, 1.4504e+00, 1.5332e+00,
         1.4848e+00, 3.8672e+05, 1.4861e+00, 4.0101e+05, 3.9611e+05, 1.5895e+00,
         3.9512e+05, 1.5214e+00, 1.5456e+00, 0.0000e+00, 3.9132e+05],
        [7.6528e+05, 3.9131e+05, 3.9135e+05, 7.6697e+05, 3.9135e+05, 3.9136e+05,
         3.9133e+05, 7.7558e+05, 3.9133e+05, 8.0102e+05, 7.7855e+05, 3.9135e+05,
         7.9054e+05, 3.9132e+05, 3.9132e+05, 3.9132e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 384467.7500, 384473.3750, 384485.3125, 384488.5938,
        384492.6875, 384493.3125, 384498.4375, 384511.5938, 384511.9375,
        384523.9375, 757943.6875, 765275.9375, 781722.6250, 792740.2500,
        798595.6250, 799692.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6567e+00, 1.7152e+00, 1.7164e+00, 1.8760e+00, 1.9044e+00,
        1.9431e+00, 1.9617e+00, 2.0444e+00, 2.0647e+00, 3.7979e+05, 3.8451e+05,
        3.8672e+05, 3.9131e+05, 3.9510e+05, 3.9612e+05, 4.0101e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3974e+00, 1.4084e+00, 1.4646e+00, 1.5092e+00, 1.5120e+00,
        1.5247e+00, 1.5344e+00, 1.6575e+00, 1.8760e+00, 3.7978e+05, 3.8451e+05,
        3.8672e+05, 3.9135e+05, 3.9513e+05, 3.9610e+05, 4.0102e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379761.3438, 379762.2500, 379774.0000, 379779.5938,
        379782.3125, 379783.5625, 379790.3438, 379793.2500, 379799.9375,
        379802.0938, 757943.6875, 766968.5000, 769910.8125, 773163.3750,
        773519.4375, 777602.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4504e+00, 1.4504e+00, 1.5341e+00, 1.5344e+00, 1.5445e+00,
        1.5716e+00, 1.5802e+00, 1.6043e+00, 2.0444e+00, 3.7978e+05, 3.8452e+05,
        3.8672e+05, 3.9135e+05, 3.9512e+05, 3.9611e+05, 4.0101e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3604e+00, 1.4504e+00, 1.5092e+00, 1.5274e+00, 1.5332e+00,
        1.5470e+00, 1.5709e+00, 1.6916e+00, 1.7152e+00, 3.7977e+05, 3.8449e+05,
        3.8664e+05, 3.9136e+05, 3.9512e+05, 3.9610e+05, 4.0101e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4557e+00, 1.4848e+00, 1.5247e+00, 1.5445e+00, 1.5709e+00,
        1.6206e+00, 1.6242e+00, 1.6283e+00, 1.6567e+00, 3.7980e+05, 3.8447e+05,
        3.8671e+05, 3.9133e+05, 3.9511e+05, 3.9613e+05, 4.0099e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386644.2188, 386696.4375, 386701.7188, 386708.1875,
        386715.6250, 386716.1250, 386718.7812, 386719.6250, 386719.8750,
        386729.6250, 767487.4375, 773163.3750, 775578.3750, 781722.6250,
        786330.1875, 788244.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3604e+00, 1.3974e+00, 1.4557e+00, 1.4861e+00, 1.5303e+00,
        1.5382e+00, 1.5857e+00, 1.6043e+00, 1.7164e+00, 3.7980e+05, 3.8447e+05,
        3.8673e+05, 3.9133e+05, 3.9512e+05, 3.9612e+05, 4.0099e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400991.3125, 400992.3438, 401007.4062, 401007.5000,
        401008.9062, 401010.9688, 401013.0000, 401019.6875, 401029.0312,
        401029.5000, 773519.4375, 776104.6875, 786330.1875, 786606.0000,
        798595.6250, 801022.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396075.4062, 396097.9688, 396102.8438, 396105.0312,
        396105.9688, 396110.2500, 396112.8750, 396116.6250, 396120.7812,
        396129.2812, 776104.6875, 777602.8750, 778548.2500, 785830.0000,
        788244.1875, 792740.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4084e+00, 1.5037e+00, 1.5345e+00, 1.5470e+00, 1.5802e+00,
        1.5857e+00, 1.5895e+00, 1.6283e+00, 1.9044e+00, 3.7978e+05, 3.8450e+05,
        3.8670e+05, 3.9135e+05, 3.9512e+05, 3.9611e+05, 4.0103e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395103.2500, 395111.0000, 395119.1250, 395120.7188,
        395121.1250, 395124.0938, 395124.0938, 395128.7812, 395131.8125,
        395140.0000, 767487.4375, 769910.8125, 785830.0000, 786606.0000,
        790544.8750, 799692.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4646e+00, 1.5214e+00, 1.5274e+00, 1.5345e+00, 1.5382e+00,
        1.5716e+00, 1.6206e+00, 1.7045e+00, 2.0647e+00, 3.7979e+05, 3.8449e+05,
        3.8672e+05, 3.9132e+05, 3.9513e+05, 3.9608e+05, 4.0101e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5037e+00, 1.5303e+00, 1.5341e+00, 1.5456e+00, 1.6242e+00,
        1.6575e+00, 1.6916e+00, 1.7045e+00, 1.9431e+00, 3.7976e+05, 3.8449e+05,
        3.8670e+05, 3.9132e+05, 3.9514e+05, 3.9611e+05, 4.0103e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4504e+00, 1.4848e+00, 1.4861e+00, 1.5120e+00, 1.5214e+00,
        1.5332e+00, 1.5456e+00, 1.5895e+00, 1.9617e+00, 3.7976e+05, 3.8449e+05,
        3.8672e+05, 3.9132e+05, 3.9512e+05, 3.9611e+05, 4.0101e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391309.7812, 391319.0625, 391320.4375, 391321.3438,
        391327.3750, 391328.8438, 391345.4688, 391350.2500, 391354.0625,
        391357.1250, 765275.9375, 766968.5000, 775578.3750, 778548.2500,
        790544.8750, 801022.4375])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['384494.69', '37980.72', '37979.62', '379782.84', '37979.79', '37978.79', '37981.41', '386707.06', '37981.57', '401010.94', '396107.72', '37979.39', '395122.38', '37980.77', '37977.61', '37977.64', '391333.41']
estimated f for each client, fs: [5, 7, 7, 5, 7, 7, 7, 5, 7, 5, 5, 7, 5, 7, 7, 7, 5]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']], selected_client_indices: [14, 8, 11, 19, 2, 6, 7, 20, 9, 13, 17, 12, 16, 1, 3, 10, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0157s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:46...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:46, End: 2025-07-22 15:45:46)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [15, 9, 20, 14, 3, 7, 2, 12, 11, 8, 5, 16, 18, 10, 17, 6, 4, 19, 13], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.8525e+05, 7.8080e+05, 7.7690e+05, 3.8530e+05, 3.8526e+05,
         3.8533e+05, 3.8527e+05, 3.8527e+05, 3.8523e+05, 3.8527e+05, 7.4107e+05,
         7.8446e+05, 3.8524e+05, 7.8373e+05, 3.8529e+05, 3.8527e+05, 7.6579e+05,
         7.9300e+05],
        [3.8525e+05, 0.0000e+00, 3.7980e+05, 3.9174e+05, 1.7268e+00, 1.5890e+00,
         1.7282e+00, 1.7422e+00, 1.5279e+00, 1.6931e+00, 1.6489e+00, 3.9094e+05,
         3.9491e+05, 1.6157e+00, 4.0319e+05, 1.5220e+00, 1.7349e+00, 3.7411e+05,
         3.9218e+05],
        [7.8080e+05, 3.7980e+05, 0.0000e+00, 7.7969e+05, 3.7984e+05, 3.7980e+05,
         3.7980e+05, 3.7980e+05, 3.7979e+05, 3.7982e+05, 3.7980e+05, 7.9080e+05,
         7.7292e+05, 3.7980e+05, 7.7595e+05, 3.7980e+05, 3.7983e+05, 7.4066e+05,
         7.8140e+05],
        [7.7690e+05, 3.9174e+05, 7.7969e+05, 0.0000e+00, 3.9173e+05, 3.9172e+05,
         3.9172e+05, 3.9177e+05, 3.9174e+05, 3.9174e+05, 3.9177e+05, 7.7729e+05,
         7.9004e+05, 3.9168e+05, 8.2065e+05, 3.9170e+05, 3.9175e+05, 7.5333e+05,
         7.8641e+05],
        [3.8530e+05, 1.7268e+00, 3.7984e+05, 3.9173e+05, 0.0000e+00, 1.7526e+00,
         1.8302e+00, 1.7089e+00, 1.9150e+00, 1.7239e+00, 1.7571e+00, 3.9090e+05,
         3.9488e+05, 1.8419e+00, 4.0317e+05, 1.8996e+00, 1.8350e+00, 3.7411e+05,
         3.9220e+05],
        [3.8526e+05, 1.5890e+00, 3.7980e+05, 3.9172e+05, 1.7526e+00, 0.0000e+00,
         1.5949e+00, 1.7186e+00, 1.5729e+00, 1.6971e+00, 1.6329e+00, 3.9092e+05,
         3.9489e+05, 1.5868e+00, 4.0316e+05, 1.6826e+00, 1.6352e+00, 3.7411e+05,
         3.9216e+05],
        [3.8533e+05, 1.7282e+00, 3.7980e+05, 3.9172e+05, 1.8302e+00, 1.5949e+00,
         0.0000e+00, 1.7005e+00, 1.6287e+00, 1.9563e+00, 1.9230e+00, 3.9097e+05,
         3.9489e+05, 1.5304e+00, 4.0318e+05, 1.5639e+00, 1.6307e+00, 3.7411e+05,
         3.9215e+05],
        [3.8527e+05, 1.7422e+00, 3.7980e+05, 3.9177e+05, 1.7089e+00, 1.7186e+00,
         1.7005e+00, 0.0000e+00, 1.5807e+00, 1.8776e+00, 1.7784e+00, 3.9091e+05,
         3.9488e+05, 1.7173e+00, 4.0313e+05, 1.6796e+00, 1.6612e+00, 3.7410e+05,
         3.9214e+05],
        [3.8527e+05, 1.5279e+00, 3.7979e+05, 3.9174e+05, 1.9150e+00, 1.5729e+00,
         1.6287e+00, 1.5807e+00, 0.0000e+00, 1.8444e+00, 1.5375e+00, 3.9095e+05,
         3.9491e+05, 1.5658e+00, 4.0317e+05, 1.6619e+00, 1.4444e+00, 3.7409e+05,
         3.9216e+05],
        [3.8523e+05, 1.6931e+00, 3.7982e+05, 3.9174e+05, 1.7239e+00, 1.6971e+00,
         1.9563e+00, 1.8776e+00, 1.8444e+00, 0.0000e+00, 1.9042e+00, 3.9089e+05,
         3.9489e+05, 1.8219e+00, 4.0314e+05, 1.7009e+00, 1.8420e+00, 3.7413e+05,
         3.9222e+05],
        [3.8527e+05, 1.6489e+00, 3.7980e+05, 3.9177e+05, 1.7571e+00, 1.6329e+00,
         1.9230e+00, 1.7784e+00, 1.5375e+00, 1.9042e+00, 0.0000e+00, 3.9092e+05,
         3.9486e+05, 1.7222e+00, 4.0318e+05, 1.7247e+00, 1.7328e+00, 3.7413e+05,
         3.9217e+05],
        [7.4107e+05, 3.9094e+05, 7.9080e+05, 7.7729e+05, 3.9090e+05, 3.9092e+05,
         3.9097e+05, 3.9091e+05, 3.9095e+05, 3.9089e+05, 3.9092e+05, 0.0000e+00,
         7.8685e+05, 3.9091e+05, 7.9113e+05, 3.9093e+05, 3.9092e+05, 7.6564e+05,
         7.8083e+05],
        [7.8446e+05, 3.9491e+05, 7.7292e+05, 7.9004e+05, 3.9488e+05, 3.9489e+05,
         3.9489e+05, 3.9488e+05, 3.9491e+05, 3.9489e+05, 3.9486e+05, 7.8685e+05,
         0.0000e+00, 3.9491e+05, 7.9458e+05, 3.9488e+05, 3.9489e+05, 7.7096e+05,
         7.7870e+05],
        [3.8524e+05, 1.6157e+00, 3.7980e+05, 3.9168e+05, 1.8419e+00, 1.5868e+00,
         1.5304e+00, 1.7173e+00, 1.5658e+00, 1.8219e+00, 1.7222e+00, 3.9091e+05,
         3.9491e+05, 0.0000e+00, 4.0314e+05, 1.6149e+00, 1.7277e+00, 3.7413e+05,
         3.9217e+05],
        [7.8373e+05, 4.0319e+05, 7.7595e+05, 8.2065e+05, 4.0317e+05, 4.0316e+05,
         4.0318e+05, 4.0313e+05, 4.0317e+05, 4.0314e+05, 4.0318e+05, 7.9113e+05,
         7.9458e+05, 4.0314e+05, 0.0000e+00, 4.0317e+05, 4.0313e+05, 7.7319e+05,
         8.1858e+05],
        [3.8529e+05, 1.5220e+00, 3.7980e+05, 3.9170e+05, 1.8996e+00, 1.6826e+00,
         1.5639e+00, 1.6796e+00, 1.6619e+00, 1.7009e+00, 1.7247e+00, 3.9093e+05,
         3.9488e+05, 1.6149e+00, 4.0317e+05, 0.0000e+00, 1.6179e+00, 3.7412e+05,
         3.9214e+05],
        [3.8527e+05, 1.7349e+00, 3.7983e+05, 3.9175e+05, 1.8350e+00, 1.6352e+00,
         1.6307e+00, 1.6612e+00, 1.4444e+00, 1.8420e+00, 1.7328e+00, 3.9092e+05,
         3.9489e+05, 1.7277e+00, 4.0313e+05, 1.6179e+00, 0.0000e+00, 3.7411e+05,
         3.9217e+05],
        [7.6579e+05, 3.7411e+05, 7.4066e+05, 7.5333e+05, 3.7411e+05, 3.7411e+05,
         3.7411e+05, 3.7410e+05, 3.7409e+05, 3.7413e+05, 3.7413e+05, 7.6564e+05,
         7.7096e+05, 3.7413e+05, 7.7319e+05, 3.7412e+05, 3.7411e+05, 0.0000e+00,
         7.8315e+05],
        [7.9300e+05, 3.9218e+05, 7.8140e+05, 7.8641e+05, 3.9220e+05, 3.9216e+05,
         3.9215e+05, 3.9214e+05, 3.9216e+05, 3.9222e+05, 3.9217e+05, 7.8083e+05,
         7.7870e+05, 3.9217e+05, 8.1858e+05, 3.9214e+05, 3.9217e+05, 7.8315e+05,
         0.0000e+00]])
sorted_distances: tensor([     0.0000, 385233.3750, 385241.5312, 385248.5938, 385263.4375,
        385268.3438, 385271.6250, 385271.9375, 385274.6875, 385287.9375,
        385295.2188, 385326.0312, 741071.6250, 765788.7500, 776895.4375,
        780796.1875, 783726.3750, 784457.2500, 793002.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5220e+00, 1.5279e+00, 1.5890e+00, 1.6157e+00, 1.6489e+00,
        1.6931e+00, 1.7268e+00, 1.7282e+00, 1.7349e+00, 1.7422e+00, 3.7411e+05,
        3.7980e+05, 3.8525e+05, 3.9094e+05, 3.9174e+05, 3.9218e+05, 3.9491e+05,
        4.0319e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 379793.1250, 379796.6250, 379798.2188, 379798.5312,
        379799.1562, 379799.2188, 379801.2812, 379802.9375, 379817.2812,
        379831.0625, 379837.6562, 740656.5000, 772923.0000, 775948.2500,
        779686.2500, 780796.1875, 781401.8125, 790801.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391680.5000, 391701.2500, 391718.3125, 391720.8125,
        391729.8750, 391735.3125, 391736.7812, 391742.7812, 391752.4688,
        391767.5000, 391767.5312, 753333.3750, 776895.4375, 777292.6250,
        779686.2500, 786414.8750, 790036.0000, 820647.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7089e+00, 1.7239e+00, 1.7268e+00, 1.7526e+00, 1.7571e+00,
        1.8302e+00, 1.8350e+00, 1.8419e+00, 1.8996e+00, 1.9150e+00, 3.7411e+05,
        3.7984e+05, 3.8530e+05, 3.9090e+05, 3.9173e+05, 3.9220e+05, 3.9488e+05,
        4.0317e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5729e+00, 1.5868e+00, 1.5890e+00, 1.5949e+00, 1.6329e+00,
        1.6352e+00, 1.6826e+00, 1.6971e+00, 1.7186e+00, 1.7526e+00, 3.7411e+05,
        3.7980e+05, 3.8526e+05, 3.9092e+05, 3.9172e+05, 3.9216e+05, 3.9489e+05,
        4.0316e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5304e+00, 1.5639e+00, 1.5949e+00, 1.6287e+00, 1.6307e+00,
        1.7005e+00, 1.7282e+00, 1.8302e+00, 1.9230e+00, 1.9563e+00, 3.7411e+05,
        3.7980e+05, 3.8533e+05, 3.9097e+05, 3.9172e+05, 3.9215e+05, 3.9489e+05,
        4.0318e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5807e+00, 1.6612e+00, 1.6796e+00, 1.7005e+00, 1.7089e+00,
        1.7173e+00, 1.7186e+00, 1.7422e+00, 1.7784e+00, 1.8776e+00, 3.7410e+05,
        3.7980e+05, 3.8527e+05, 3.9091e+05, 3.9177e+05, 3.9214e+05, 3.9488e+05,
        4.0313e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4444e+00, 1.5279e+00, 1.5375e+00, 1.5658e+00, 1.5729e+00,
        1.5807e+00, 1.6287e+00, 1.6619e+00, 1.8444e+00, 1.9150e+00, 3.7409e+05,
        3.7979e+05, 3.8527e+05, 3.9095e+05, 3.9174e+05, 3.9216e+05, 3.9491e+05,
        4.0317e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6931e+00, 1.6971e+00, 1.7009e+00, 1.7239e+00, 1.8219e+00,
        1.8420e+00, 1.8444e+00, 1.8776e+00, 1.9042e+00, 1.9563e+00, 3.7413e+05,
        3.7982e+05, 3.8523e+05, 3.9089e+05, 3.9174e+05, 3.9222e+05, 3.9489e+05,
        4.0314e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5375e+00, 1.6329e+00, 1.6489e+00, 1.7222e+00, 1.7247e+00,
        1.7328e+00, 1.7571e+00, 1.7784e+00, 1.9042e+00, 1.9230e+00, 3.7413e+05,
        3.7980e+05, 3.8527e+05, 3.9092e+05, 3.9177e+05, 3.9217e+05, 3.9486e+05,
        4.0318e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 390891.5000, 390896.0625, 390911.2812, 390913.0625,
        390920.2188, 390922.9062, 390923.9062, 390928.8750, 390939.1250,
        390946.5312, 390965.3125, 741071.6250, 765636.3750, 777292.6250,
        780828.0000, 786849.0000, 790801.0625, 791126.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 394860.7500, 394876.0625, 394881.0000, 394884.5000,
        394890.3438, 394890.9375, 394892.0000, 394892.1875, 394910.0938,
        394911.2812, 394911.4062, 770961.0000, 772923.0000, 778696.2500,
        784457.2500, 786849.0000, 790036.0000, 794579.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5304e+00, 1.5658e+00, 1.5868e+00, 1.6149e+00, 1.6157e+00,
        1.7173e+00, 1.7222e+00, 1.7277e+00, 1.8219e+00, 1.8419e+00, 3.7413e+05,
        3.7980e+05, 3.8524e+05, 3.9091e+05, 3.9168e+05, 3.9217e+05, 3.9491e+05,
        4.0314e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 403133.3125, 403134.4375, 403141.3438, 403142.4062,
        403158.6562, 403165.6250, 403170.8125, 403172.9062, 403175.7188,
        403182.3125, 403193.0000, 773194.6875, 775948.2500, 783726.3750,
        791126.8125, 794579.1875, 818578.9375, 820647.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5220e+00, 1.5639e+00, 1.6149e+00, 1.6179e+00, 1.6619e+00,
        1.6796e+00, 1.6826e+00, 1.7009e+00, 1.7247e+00, 1.8996e+00, 3.7412e+05,
        3.7980e+05, 3.8529e+05, 3.9093e+05, 3.9170e+05, 3.9214e+05, 3.9488e+05,
        4.0317e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4444e+00, 1.6179e+00, 1.6307e+00, 1.6352e+00, 1.6612e+00,
        1.7277e+00, 1.7328e+00, 1.7349e+00, 1.8350e+00, 1.8420e+00, 3.7411e+05,
        3.7983e+05, 3.8527e+05, 3.9092e+05, 3.9175e+05, 3.9217e+05, 3.9489e+05,
        4.0313e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 374087.5312, 374103.5625, 374109.9375, 374110.4688,
        374111.7812, 374113.0625, 374113.1562, 374115.3438, 374126.6250,
        374129.3750, 374132.5625, 740656.5000, 753333.3750, 765636.3750,
        765788.7500, 770961.0000, 773194.6875, 783145.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392141.3125, 392141.6250, 392147.1875, 392160.3438,
        392164.2188, 392165.0312, 392168.0312, 392171.9062, 392177.5938,
        392196.6875, 392224.7812, 778696.2500, 780828.0000, 781401.8125,
        783145.3750, 786414.8750, 793002.1250, 818578.9375])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['385271.16', '34011.80', '379806.84', '391732.09', '34011.91', '34011.54', '34011.55', '34010.98', '34009.44', '34013.16', '34013.62', '390923.53', '394890.97', '34013.29', '403160.94', '34012.00', '34011.70', '374113.97', '392168.97']
estimated f for each client, fs: [6, 8, 6, 6, 8, 8, 8, 8, 8, 8, 8, 6, 6, 8, 6, 8, 8, 6, 6]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [15, 9, 20, 14, 3, 7, 2, 12, 11, 8, 5, 16, 18, 10, 17, 6, 4, 19, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0138s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:47...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:45:47, End: 2025-07-22 15:45:47)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [16], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
rkrum, clients_type: ['Chosen Update'], selected_client_indices: [16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0000s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:47...
global Accuracy on shared test data: 59.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[100 137]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:45:47, End: 2025-07-22 15:45:47)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [17, 6, 16, 13, 20, 12, 11, 19, 5, 14, 4, 10, 7, 3, 8, 2], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9052e+05, 7.5595e+05, 7.5680e+05, 8.1034e+05, 3.9059e+05,
         3.9053e+05, 7.8677e+05, 3.9050e+05, 7.7079e+05, 3.9053e+05, 3.9050e+05,
         3.9055e+05, 3.9052e+05, 3.9056e+05, 3.9057e+05],
        [3.9052e+05, 0.0000e+00, 3.7848e+05, 3.8975e+05, 3.9558e+05, 3.5310e+00,
         3.5054e+00, 3.9331e+05, 3.7184e+00, 3.8200e+05, 3.5706e+00, 3.4398e+00,
         3.0364e+00, 3.1373e+00, 3.5410e+00, 3.2866e+00],
        [7.5595e+05, 3.7848e+05, 0.0000e+00, 7.5023e+05, 7.5734e+05, 3.7847e+05,
         3.7847e+05, 7.7635e+05, 3.7846e+05, 7.4562e+05, 3.7846e+05, 3.7849e+05,
         3.7847e+05, 3.7850e+05, 3.7847e+05, 3.7850e+05],
        [7.5680e+05, 3.8975e+05, 7.5023e+05, 0.0000e+00, 7.9159e+05, 3.8974e+05,
         3.8970e+05, 7.8615e+05, 3.8974e+05, 7.6324e+05, 3.8975e+05, 3.8973e+05,
         3.8972e+05, 3.8973e+05, 3.8975e+05, 3.8975e+05],
        [8.1034e+05, 3.9558e+05, 7.5734e+05, 7.9159e+05, 0.0000e+00, 3.9561e+05,
         3.9559e+05, 8.0368e+05, 3.9559e+05, 8.0465e+05, 3.9560e+05, 3.9561e+05,
         3.9557e+05, 3.9555e+05, 3.9558e+05, 3.9560e+05],
        [3.9059e+05, 3.5310e+00, 3.7847e+05, 3.8974e+05, 3.9561e+05, 0.0000e+00,
         3.5501e+00, 3.9330e+05, 3.3354e+00, 3.8202e+05, 3.6848e+00, 3.5006e+00,
         3.2327e+00, 3.4777e+00, 3.6059e+00, 3.5816e+00],
        [3.9053e+05, 3.5054e+00, 3.7847e+05, 3.8970e+05, 3.9559e+05, 3.5501e+00,
         0.0000e+00, 3.9333e+05, 3.8093e+00, 3.8204e+05, 3.4880e+00, 3.3801e+00,
         3.3329e+00, 3.8059e+00, 3.5330e+00, 3.5880e+00],
        [7.8677e+05, 3.9331e+05, 7.7635e+05, 7.8615e+05, 8.0368e+05, 3.9330e+05,
         3.9333e+05, 0.0000e+00, 3.9332e+05, 7.9652e+05, 3.9335e+05, 3.9335e+05,
         3.9329e+05, 3.9333e+05, 3.9335e+05, 3.9335e+05],
        [3.9050e+05, 3.7184e+00, 3.7846e+05, 3.8974e+05, 3.9559e+05, 3.3354e+00,
         3.8093e+00, 3.9332e+05, 0.0000e+00, 3.8203e+05, 3.3771e+00, 3.6240e+00,
         3.6288e+00, 3.5863e+00, 3.5905e+00, 3.5225e+00],
        [7.7079e+05, 3.8200e+05, 7.4562e+05, 7.6324e+05, 8.0465e+05, 3.8202e+05,
         3.8204e+05, 7.9652e+05, 3.8203e+05, 0.0000e+00, 3.8202e+05, 3.8201e+05,
         3.8199e+05, 3.8195e+05, 3.8198e+05, 3.8201e+05],
        [3.9053e+05, 3.5706e+00, 3.7846e+05, 3.8975e+05, 3.9560e+05, 3.6848e+00,
         3.4880e+00, 3.9335e+05, 3.3771e+00, 3.8202e+05, 0.0000e+00, 3.3302e+00,
         3.4165e+00, 3.6826e+00, 3.7568e+00, 3.6531e+00],
        [3.9050e+05, 3.4398e+00, 3.7849e+05, 3.8973e+05, 3.9561e+05, 3.5006e+00,
         3.3801e+00, 3.9335e+05, 3.6240e+00, 3.8201e+05, 3.3302e+00, 0.0000e+00,
         3.0387e+00, 3.2776e+00, 3.3275e+00, 3.3598e+00],
        [3.9055e+05, 3.0364e+00, 3.7847e+05, 3.8972e+05, 3.9557e+05, 3.2327e+00,
         3.3329e+00, 3.9329e+05, 3.6288e+00, 3.8199e+05, 3.4165e+00, 3.0387e+00,
         0.0000e+00, 3.2370e+00, 3.5855e+00, 3.0344e+00],
        [3.9052e+05, 3.1373e+00, 3.7850e+05, 3.8973e+05, 3.9555e+05, 3.4777e+00,
         3.8059e+00, 3.9333e+05, 3.5863e+00, 3.8195e+05, 3.6826e+00, 3.2776e+00,
         3.2370e+00, 0.0000e+00, 3.3537e+00, 3.3403e+00],
        [3.9056e+05, 3.5410e+00, 3.7847e+05, 3.8975e+05, 3.9558e+05, 3.6059e+00,
         3.5330e+00, 3.9335e+05, 3.5905e+00, 3.8198e+05, 3.7568e+00, 3.3275e+00,
         3.5855e+00, 3.3537e+00, 0.0000e+00, 3.4948e+00],
        [3.9057e+05, 3.2866e+00, 3.7850e+05, 3.8975e+05, 3.9560e+05, 3.5816e+00,
         3.5880e+00, 3.9335e+05, 3.5225e+00, 3.8201e+05, 3.6531e+00, 3.3598e+00,
         3.0344e+00, 3.3403e+00, 3.4948e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 390502.1875, 390502.5312, 390519.5000, 390520.5625,
        390531.8438, 390531.9688, 390547.6250, 390556.8438, 390570.2500,
        390586.8125, 755946.5000, 756797.9375, 770788.1875, 786771.1250,
        810339.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.0364e+00, 3.1373e+00, 3.2866e+00, 3.4398e+00, 3.5054e+00,
        3.5310e+00, 3.5410e+00, 3.5706e+00, 3.7184e+00, 3.7848e+05, 3.8200e+05,
        3.8975e+05, 3.9052e+05, 3.9331e+05, 3.9558e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 378457.8125, 378459.0000, 378465.5312, 378467.6562,
        378467.8750, 378469.8125, 378483.2500, 378485.2500, 378496.6250,
        378504.6875, 745622.1250, 750228.1250, 755946.5000, 757339.7500,
        776349.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389704.3438, 389715.2500, 389728.1875, 389731.1250,
        389736.0312, 389738.3125, 389749.5625, 389750.4375, 389754.2500,
        389754.9375, 750228.1250, 756797.9375, 763238.0625, 786151.0000,
        791587.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395549.7812, 395566.2188, 395579.5938, 395580.5000,
        395585.6562, 395590.2188, 395599.3125, 395604.6250, 395606.3438,
        395614.6250, 757339.7500, 791587.3125, 803684.8125, 804651.1250,
        810339.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2327e+00, 3.3354e+00, 3.4777e+00, 3.5006e+00, 3.5310e+00,
        3.5501e+00, 3.5816e+00, 3.6059e+00, 3.6848e+00, 3.7847e+05, 3.8202e+05,
        3.8974e+05, 3.9059e+05, 3.9330e+05, 3.9561e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3329e+00, 3.3801e+00, 3.4880e+00, 3.5054e+00, 3.5330e+00,
        3.5501e+00, 3.5880e+00, 3.8059e+00, 3.8093e+00, 3.7847e+05, 3.8204e+05,
        3.8970e+05, 3.9053e+05, 3.9333e+05, 3.9559e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393286.7500, 393300.4375, 393311.1875, 393322.1562,
        393328.0000, 393332.3125, 393347.6562, 393347.8750, 393350.9375,
        393353.1250, 776349.1875, 786151.0000, 786771.1250, 796517.8125,
        803684.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3354e+00, 3.3771e+00, 3.5225e+00, 3.5863e+00, 3.5905e+00,
        3.6240e+00, 3.6288e+00, 3.7184e+00, 3.8093e+00, 3.7846e+05, 3.8203e+05,
        3.8974e+05, 3.9050e+05, 3.9332e+05, 3.9559e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381954.8125, 381975.7500, 381990.0625, 382004.8125,
        382013.9375, 382014.5625, 382015.5625, 382024.6875, 382025.0312,
        382036.6250, 745622.1250, 763238.0625, 770788.1875, 796517.8125,
        804651.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3302e+00, 3.3771e+00, 3.4165e+00, 3.4880e+00, 3.5706e+00,
        3.6531e+00, 3.6826e+00, 3.6848e+00, 3.7568e+00, 3.7846e+05, 3.8202e+05,
        3.8975e+05, 3.9053e+05, 3.9335e+05, 3.9560e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.0387e+00, 3.2776e+00, 3.3275e+00, 3.3302e+00, 3.3598e+00,
        3.3801e+00, 3.4398e+00, 3.5006e+00, 3.6240e+00, 3.7849e+05, 3.8201e+05,
        3.8973e+05, 3.9050e+05, 3.9335e+05, 3.9561e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.0344e+00, 3.0364e+00, 3.0387e+00, 3.2327e+00, 3.2370e+00,
        3.3329e+00, 3.4165e+00, 3.5855e+00, 3.6288e+00, 3.7847e+05, 3.8199e+05,
        3.8972e+05, 3.9055e+05, 3.9329e+05, 3.9557e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.1373e+00, 3.2370e+00, 3.2776e+00, 3.3403e+00, 3.3537e+00,
        3.4777e+00, 3.5863e+00, 3.6826e+00, 3.8059e+00, 3.7850e+05, 3.8195e+05,
        3.8973e+05, 3.9052e+05, 3.9333e+05, 3.9555e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3275e+00, 3.3537e+00, 3.4948e+00, 3.5330e+00, 3.5410e+00,
        3.5855e+00, 3.5905e+00, 3.6059e+00, 3.7568e+00, 3.7847e+05, 3.8198e+05,
        3.8975e+05, 3.9056e+05, 3.9335e+05, 3.9558e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.0344e+00, 3.2866e+00, 3.3403e+00, 3.3598e+00, 3.4948e+00,
        3.5225e+00, 3.5816e+00, 3.5880e+00, 3.6531e+00, 3.7850e+05, 3.8201e+05,
        3.8975e+05, 3.9057e+05, 3.9335e+05, 3.9560e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['390536.97', '37851.40', '378475.72', '389736.22', '395587.69', '37849.91', '37850.18', '393328.06', '37849.12', '382005.56', '37848.98', '37851.55', '37849.51', '37853.56', '37849.96', '37852.75']
estimated f for each client, fs: [4, 6, 4, 4, 4, 6, 6, 4, 6, 4, 6, 6, 6, 6, 6, 6]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [17, 6, 16, 13, 20, 12, 11, 19, 5, 14, 4, 10, 7, 3, 8, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0107s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:47...
global Accuracy on shared test data: 59.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[106 131]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:47, End: 2025-07-22 15:45:47)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [19, 20], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[     0.0000, 771335.5000],
        [771335.5000,      0.0000]])
sorted_distances: tensor([     0.0000, 771335.5000])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([     0.0000, 771335.5000])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['771335.50', '771335.50']
estimated f for each client, fs: [1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [19, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0013s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:47...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 44 193]
 [ 43 220]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:45:47, End: 2025-07-22 15:45:47)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [10, 3, 16, 20, 9, 8, 14], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 3.2140e+00, 3.8642e+05, 4.0166e+05, 3.4617e+00, 3.5058e+00,
         3.8801e+05],
        [3.2140e+00, 0.0000e+00, 3.8641e+05, 4.0166e+05, 3.6626e+00, 3.5344e+00,
         3.8800e+05],
        [3.8642e+05, 3.8641e+05, 0.0000e+00, 7.7994e+05, 3.8641e+05, 3.8639e+05,
         7.6471e+05],
        [4.0166e+05, 4.0166e+05, 7.7994e+05, 0.0000e+00, 4.0165e+05, 4.0164e+05,
         7.8050e+05],
        [3.4617e+00, 3.6626e+00, 3.8641e+05, 4.0165e+05, 0.0000e+00, 3.8768e+00,
         3.8801e+05],
        [3.5058e+00, 3.5344e+00, 3.8639e+05, 4.0164e+05, 3.8768e+00, 0.0000e+00,
         3.8798e+05],
        [3.8801e+05, 3.8800e+05, 7.6471e+05, 7.8050e+05, 3.8801e+05, 3.8798e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.2140e+00, 3.4617e+00, 3.5058e+00, 3.8642e+05, 3.8801e+05,
        4.0166e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.2140e+00, 3.5344e+00, 3.6626e+00, 3.8641e+05, 3.8800e+05,
        4.0166e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 386390.0938, 386409.2500, 386412.8125, 386416.5000,
        764712.7500, 779937.6875])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 401640.7500, 401654.8750, 401656.2812, 401660.6875,
        779937.6875, 780504.1250])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.4617e+00, 3.6626e+00, 3.8768e+00, 3.8641e+05, 3.8801e+05,
        4.0165e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.5058e+00, 3.5344e+00, 3.8768e+00, 3.8639e+05, 3.8798e+05,
        4.0164e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 387976.0000, 388004.8125, 388006.5312, 388014.5625,
        764712.7500, 780504.1250])
Index of maximum distance difference after half of values: 5
adaptive_Krum scores:  ['154886.66', '154884.91', '462068.31', '477310.03', '154887.69', '154875.41', '463342.94']
estimated f for each client, fs: [3, 3, 1, 1, 3, 3, 1]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']], selected_client_indices: [10, 3, 16, 20, 9, 8, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0225s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:48...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 51 186]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:48, End: 2025-07-22 15:45:48)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [16, 15, 4], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[     0.0000, 801609.6250, 407440.3125],
        [801609.6250,      0.0000, 398194.9062],
        [407440.3125, 398194.9062,      0.0000]])
sorted_distances: tensor([     0.0000, 407440.3125, 801609.6250])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([     0.0000, 398194.9062, 801609.6250])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([     0.0000, 398194.9062, 407440.3125])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['604524.94', '599902.31', '402817.59']
estimated f for each client, fs: [0, 1, 0]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']], selected_client_indices: [16, 15, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0019s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:48...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 58 179]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:48, End: 2025-07-22 15:45:48)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [20, 8, 18, 19, 5, 3, 11, 10, 15, 16, 1, 9, 17], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 4.0156e+05, 7.9605e+05, 8.0968e+05, 4.0160e+05, 4.0162e+05,
         4.0160e+05, 4.0162e+05, 8.0969e+05, 7.9073e+05, 4.0165e+05, 4.0165e+05,
         7.7945e+05],
        [4.0156e+05, 0.0000e+00, 3.8662e+05, 3.9645e+05, 3.9099e+00, 3.7510e+00,
         3.6619e+00, 3.5395e+00, 4.0555e+05, 3.9409e+05, 3.7089e+00, 3.9374e+00,
         3.9782e+05],
        [7.9605e+05, 3.8662e+05, 0.0000e+00, 7.7981e+05, 3.8664e+05, 3.8671e+05,
         3.8668e+05, 3.8664e+05, 7.9957e+05, 8.0288e+05, 3.8668e+05, 3.8668e+05,
         7.6853e+05],
        [8.0968e+05, 3.9645e+05, 7.7981e+05, 0.0000e+00, 3.9643e+05, 3.9647e+05,
         3.9644e+05, 3.9649e+05, 8.1184e+05, 7.6896e+05, 3.9649e+05, 3.9650e+05,
         8.0160e+05],
        [4.0160e+05, 3.9099e+00, 3.8664e+05, 3.9643e+05, 0.0000e+00, 3.4112e+00,
         3.5386e+00, 3.4237e+00, 4.0551e+05, 3.9412e+05, 3.8785e+00, 3.8313e+00,
         3.9781e+05],
        [4.0162e+05, 3.7510e+00, 3.8671e+05, 3.9647e+05, 3.4112e+00, 0.0000e+00,
         3.4946e+00, 3.2777e+00, 4.0551e+05, 3.9412e+05, 3.5425e+00, 3.7700e+00,
         3.9783e+05],
        [4.0160e+05, 3.6619e+00, 3.8668e+05, 3.9644e+05, 3.5386e+00, 3.4946e+00,
         0.0000e+00, 3.2334e+00, 4.0553e+05, 3.9409e+05, 3.6298e+00, 3.5591e+00,
         3.9781e+05],
        [4.0162e+05, 3.5395e+00, 3.8664e+05, 3.9649e+05, 3.4237e+00, 3.2777e+00,
         3.2334e+00, 0.0000e+00, 4.0551e+05, 3.9410e+05, 3.5119e+00, 3.5794e+00,
         3.9783e+05],
        [8.0969e+05, 4.0555e+05, 7.9957e+05, 8.1184e+05, 4.0551e+05, 4.0551e+05,
         4.0553e+05, 4.0551e+05, 0.0000e+00, 7.9724e+05, 4.0552e+05, 4.0548e+05,
         8.0545e+05],
        [7.9073e+05, 3.9409e+05, 8.0288e+05, 7.6896e+05, 3.9412e+05, 3.9412e+05,
         3.9409e+05, 3.9410e+05, 7.9724e+05, 0.0000e+00, 3.9404e+05, 3.9407e+05,
         7.9766e+05],
        [4.0165e+05, 3.7089e+00, 3.8668e+05, 3.9649e+05, 3.8785e+00, 3.5425e+00,
         3.6298e+00, 3.5119e+00, 4.0552e+05, 3.9404e+05, 0.0000e+00, 3.3235e+00,
         3.9782e+05],
        [4.0165e+05, 3.9374e+00, 3.8668e+05, 3.9650e+05, 3.8313e+00, 3.7700e+00,
         3.5591e+00, 3.5794e+00, 4.0548e+05, 3.9407e+05, 3.3235e+00, 0.0000e+00,
         3.9782e+05],
        [7.7945e+05, 3.9782e+05, 7.6853e+05, 8.0160e+05, 3.9781e+05, 3.9783e+05,
         3.9781e+05, 3.9783e+05, 8.0545e+05, 7.9766e+05, 3.9782e+05, 3.9782e+05,
         0.0000e+00]])
sorted_distances: tensor([     0.0000, 401564.4375, 401598.0938, 401598.5000, 401617.1250,
        401619.6250, 401646.3750, 401650.9375, 779446.5625, 790731.9375,
        796054.8125, 809675.5000, 809693.6250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.5395e+00, 3.6619e+00, 3.7089e+00, 3.7510e+00, 3.9099e+00,
        3.9374e+00, 3.8662e+05, 3.9409e+05, 3.9645e+05, 3.9782e+05, 4.0156e+05,
        4.0555e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 386624.9062, 386637.2188, 386644.7500, 386680.0938,
        386682.5625, 386684.1875, 386705.9062, 768529.6250, 779806.3750,
        796054.8125, 799567.1250, 802881.2500])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 396433.3125, 396443.6250, 396446.4062, 396472.3750,
        396487.3438, 396490.1250, 396495.7812, 768955.5625, 779806.3750,
        801600.1875, 809675.5000, 811840.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.4112e+00, 3.4237e+00, 3.5386e+00, 3.8313e+00, 3.8785e+00,
        3.9099e+00, 3.8664e+05, 3.9412e+05, 3.9643e+05, 3.9781e+05, 4.0160e+05,
        4.0551e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.2777e+00, 3.4112e+00, 3.4946e+00, 3.5425e+00, 3.7510e+00,
        3.7700e+00, 3.8671e+05, 3.9412e+05, 3.9647e+05, 3.9783e+05, 4.0162e+05,
        4.0551e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.2334e+00, 3.4946e+00, 3.5386e+00, 3.5591e+00, 3.6298e+00,
        3.6619e+00, 3.8668e+05, 3.9409e+05, 3.9644e+05, 3.9781e+05, 4.0160e+05,
        4.0553e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.2334e+00, 3.2777e+00, 3.4237e+00, 3.5119e+00, 3.5395e+00,
        3.5794e+00, 3.8664e+05, 3.9410e+05, 3.9649e+05, 3.9783e+05, 4.0162e+05,
        4.0551e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 405476.3125, 405506.2812, 405506.5938, 405513.3750,
        405523.5625, 405529.6250, 405548.6875, 797235.8125, 799567.1250,
        805451.0000, 809693.6250, 811840.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 394040.7188, 394066.9062, 394085.8750, 394090.0000,
        394095.5000, 394116.6875, 394124.1562, 768955.5625, 790731.9375,
        797235.8125, 797658.2500, 802881.2500])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.3235e+00, 3.5119e+00, 3.5425e+00, 3.6298e+00, 3.7089e+00,
        3.8785e+00, 3.8668e+05, 3.9404e+05, 3.9649e+05, 3.9782e+05, 4.0165e+05,
        4.0552e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.3235e+00, 3.5591e+00, 3.5794e+00, 3.7700e+00, 3.8313e+00,
        3.9374e+00, 3.8668e+05, 3.9407e+05, 3.9650e+05, 3.9782e+05, 4.0165e+05,
        4.0548e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 397805.2500, 397811.8125, 397815.6875, 397820.0312,
        397822.8438, 397825.9375, 397834.1875, 768529.6250, 779446.5625,
        797658.2500, 801600.1875, 805451.0000])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['448842.72', '97592.18', '434398.62', '443028.06', '97596.99', '97606.41', '97598.90', '97595.09', '454480.03', '440946.94', '97593.12', '97596.12', '444158.12']
estimated f for each client, fs: [4, 6, 4, 4, 6, 6, 6, 6, 4, 4, 6, 6, 4]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [20, 8, 18, 19, 5, 3, 11, 10, 15, 16, 1, 9, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0167s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:48...
global Accuracy on shared test data: 51.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 71 166]
 [ 79 184]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:48, End: 2025-07-22 15:45:48)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [17, 18, 4, 15, 2], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
tensor([[0.0000e+00, 7.5658e+05, 3.8004e+05, 7.7656e+05, 3.8003e+05],
        [7.5658e+05, 0.0000e+00, 3.9233e+05, 7.7366e+05, 3.9233e+05],
        [3.8004e+05, 3.9233e+05, 0.0000e+00, 3.8394e+05, 3.2945e+00],
        [7.7656e+05, 7.7366e+05, 3.8394e+05, 0.0000e+00, 3.8391e+05],
        [3.8003e+05, 3.9233e+05, 3.2945e+00, 3.8391e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 380028.6250, 380035.0000, 756583.0000, 776561.8750])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([     0.0000, 392327.7500, 392328.9375, 756583.0000, 773658.6250])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 3.2945e+00, 3.8004e+05, 3.8394e+05, 3.9233e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([     0.0000, 383909.0000, 383938.9062, 773658.6250, 776561.8750])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 3.2945e+00, 3.8003e+05, 3.8391e+05, 3.9233e+05])
Index of maximum distance difference after half of values: 4
adaptive_Krum scores:  ['573302.12', '578724.62', '289076.25', '579517.12', '289067.47']
estimated f for each client, fs: [1, 0, 0, 2, 0]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']], selected_client_indices: [17, 18, 4, 15, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0031s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:49...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 81 156]
 [ 84 179]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:49, End: 2025-07-22 15:45:49)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [16, 17, 10, 20, 2, 9, 7, 5, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 7.9244e+05, 3.9673e+05, 7.7910e+05, 3.9673e+05, 3.9672e+05,
         3.9672e+05, 3.9669e+05, 7.6775e+05],
        [7.9244e+05, 0.0000e+00, 3.9056e+05, 7.7904e+05, 3.9056e+05, 3.9056e+05,
         3.9056e+05, 3.9058e+05, 8.1503e+05],
        [3.9673e+05, 3.9056e+05, 0.0000e+00, 3.8526e+05, 3.4490e+00, 3.9541e+00,
         3.4669e+00, 3.4623e+00, 3.8896e+05],
        [7.7910e+05, 7.7904e+05, 3.8526e+05, 0.0000e+00, 3.8525e+05, 3.8528e+05,
         3.8528e+05, 3.8530e+05, 7.6542e+05],
        [3.9673e+05, 3.9056e+05, 3.4490e+00, 3.8525e+05, 0.0000e+00, 3.4517e+00,
         3.6542e+00, 3.5411e+00, 3.8897e+05],
        [3.9672e+05, 3.9056e+05, 3.9541e+00, 3.8528e+05, 3.4517e+00, 0.0000e+00,
         3.9063e+00, 3.8880e+00, 3.8896e+05],
        [3.9672e+05, 3.9056e+05, 3.4669e+00, 3.8528e+05, 3.6542e+00, 3.9063e+00,
         0.0000e+00, 3.4340e+00, 3.8898e+05],
        [3.9669e+05, 3.9058e+05, 3.4623e+00, 3.8530e+05, 3.5411e+00, 3.8880e+00,
         3.4340e+00, 0.0000e+00, 3.8894e+05],
        [7.6775e+05, 8.1503e+05, 3.8896e+05, 7.6542e+05, 3.8897e+05, 3.8896e+05,
         3.8898e+05, 3.8894e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 396692.7500, 396715.5000, 396724.8750, 396728.1562,
        396730.4062, 767747.3750, 779104.4375, 792435.2500])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 390556.6875, 390558.0938, 390560.8750, 390563.3438,
        390579.7500, 779039.3750, 792435.2500, 815029.1875])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.4490e+00, 3.4623e+00, 3.4669e+00, 3.9541e+00, 3.8526e+05,
        3.8896e+05, 3.9056e+05, 3.9673e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 385250.0000, 385264.8438, 385275.1250, 385278.3750,
        385302.4688, 765423.8750, 779039.3750, 779104.4375])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.4490e+00, 3.4517e+00, 3.5411e+00, 3.6542e+00, 3.8525e+05,
        3.8897e+05, 3.9056e+05, 3.9673e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.4517e+00, 3.8880e+00, 3.9063e+00, 3.9541e+00, 3.8528e+05,
        3.8896e+05, 3.9056e+05, 3.9672e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.4340e+00, 3.4669e+00, 3.6542e+00, 3.9063e+00, 3.8528e+05,
        3.8898e+05, 3.9056e+05, 3.9672e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.4340e+00, 3.4623e+00, 3.5411e+00, 3.8880e+00, 3.8530e+05,
        3.8894e+05, 3.9058e+05, 3.9669e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 388940.5000, 388955.1562, 388961.3125, 388965.6250,
        388977.6250, 765423.8750, 767747.3750, 815029.1875])
Index of maximum distance difference after half of values: 6
adaptive_Krum scores:  ['458556.50', '455309.72', '129039.05', '448632.41', '129038.28', '129041.94', '129045.08', '129042.88', '451704.00']
estimated f for each client, fs: [2, 2, 4, 2, 4, 4, 4, 4, 2]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [16, 17, 10, 20, 2, 9, 7, 5, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0103s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:49...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 88 149]
 [ 90 173]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:49, End: 2025-07-22 15:45:49)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [7, 8], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 3.7500],
        [3.7500, 0.0000]])
sorted_distances: tensor([0.0000, 3.7500])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000, 3.7500])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['3.75', '3.75']
estimated f for each client, fs: [1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [7, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0012s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:49...
global Accuracy on shared test data: 51.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 92 145]
 [ 99 164]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:45:49, End: 2025-07-22 15:45:49)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [10, 2, 7, 4, 13, 9, 14, 18, 11, 12], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.5520e+00, 3.6901e+00, 3.5867e+00, 3.8078e+05, 3.8328e+00,
         3.9724e+05, 3.9533e+05, 3.2815e+00, 3.6287e+00],
        [3.5520e+00, 0.0000e+00, 3.7086e+00, 3.4426e+00, 3.8081e+05, 3.5090e+00,
         3.9727e+05, 3.9537e+05, 3.4178e+00, 3.7414e+00],
        [3.6901e+00, 3.7086e+00, 0.0000e+00, 3.6202e+00, 3.8081e+05, 3.9078e+00,
         3.9725e+05, 3.9536e+05, 3.6095e+00, 3.5589e+00],
        [3.5867e+00, 3.4426e+00, 3.6202e+00, 0.0000e+00, 3.8079e+05, 4.0266e+00,
         3.9720e+05, 3.9531e+05, 3.4812e+00, 3.5879e+00],
        [3.8078e+05, 3.8081e+05, 3.8081e+05, 3.8079e+05, 0.0000e+00, 3.8079e+05,
         7.7285e+05, 7.7757e+05, 3.8076e+05, 3.8076e+05],
        [3.8328e+00, 3.5090e+00, 3.9078e+00, 4.0266e+00, 3.8079e+05, 0.0000e+00,
         3.9729e+05, 3.9541e+05, 3.5077e+00, 4.0964e+00],
        [3.9724e+05, 3.9727e+05, 3.9725e+05, 3.9720e+05, 7.7285e+05, 3.9729e+05,
         0.0000e+00, 7.8727e+05, 3.9732e+05, 3.9726e+05],
        [3.9533e+05, 3.9537e+05, 3.9536e+05, 3.9531e+05, 7.7757e+05, 3.9541e+05,
         7.8727e+05, 0.0000e+00, 3.9537e+05, 3.9536e+05],
        [3.2815e+00, 3.4178e+00, 3.6095e+00, 3.4812e+00, 3.8076e+05, 3.5077e+00,
         3.9732e+05, 3.9537e+05, 0.0000e+00, 3.7109e+00],
        [3.6287e+00, 3.7414e+00, 3.5589e+00, 3.5879e+00, 3.8076e+05, 4.0964e+00,
         3.9726e+05, 3.9536e+05, 3.7109e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.2815e+00, 3.5520e+00, 3.5867e+00, 3.6287e+00, 3.6901e+00,
        3.8328e+00, 3.8078e+05, 3.9533e+05, 3.9724e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.4178e+00, 3.4426e+00, 3.5090e+00, 3.5520e+00, 3.7086e+00,
        3.7414e+00, 3.8081e+05, 3.9537e+05, 3.9727e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.5589e+00, 3.6095e+00, 3.6202e+00, 3.6901e+00, 3.7086e+00,
        3.9078e+00, 3.8081e+05, 3.9536e+05, 3.9725e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.4426e+00, 3.4812e+00, 3.5867e+00, 3.5879e+00, 3.6202e+00,
        4.0266e+00, 3.8079e+05, 3.9531e+05, 3.9720e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 380756.3750, 380756.9688, 380778.5625, 380788.6875,
        380790.3125, 380805.7500, 380813.6875, 772848.4375, 777567.5625])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.5077e+00, 3.5090e+00, 3.8328e+00, 3.9078e+00, 4.0266e+00,
        4.0964e+00, 3.8079e+05, 3.9541e+05, 3.9729e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 397202.4688, 397242.6562, 397254.5938, 397261.3438,
        397266.9062, 397292.6250, 397318.3125, 772848.4375, 787267.6875])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 395314.3750, 395331.8438, 395358.9375, 395362.2500,
        395369.0625, 395374.9688, 395408.6875, 777567.5625, 787267.6875])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.2815e+00, 3.4178e+00, 3.4812e+00, 3.5077e+00, 3.6095e+00,
        3.7109e+00, 3.8076e+05, 3.9537e+05, 3.9732e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.5589e+00, 3.5879e+00, 3.6287e+00, 3.7109e+00, 3.7414e+00,
        4.0964e+00, 3.8076e+05, 3.9536e+05, 3.9726e+05])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['54400.02', '54403.87', '54405.11', '54401.49', '380784.34', '54401.88', '397262.66', '395360.03', '54396.85', '54396.95']
estimated f for each client, fs: [3, 3, 3, 3, 2, 3, 1, 1, 3, 3]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']], selected_client_indices: [10, 2, 7, 4, 13, 9, 14, 18, 11, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0060s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:50...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 98 139]
 [100 163]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:50, End: 2025-07-22 15:45:50)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [4], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
rkrum, clients_type: ['Chosen Update'], selected_client_indices: [4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0000s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:50...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[105 132]
 [104 159]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:45:50, End: 2025-07-22 15:45:50)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [11, 14, 5, 20, 3, 8, 6, 7, 13, 1, 19, 15, 4, 18, 12, 2, 9, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.8226e+05, 3.5837e+00, 3.8513e+05, 3.5890e+00, 3.9979e+00,
         3.6859e+00, 3.6715e+00, 4.0285e+05, 3.7569e+00, 3.9578e+05, 3.9733e+05,
         3.5257e+00, 3.8690e+05, 3.7191e+00, 3.5872e+00, 3.6393e+00, 3.4288e+00,
         4.0698e+05],
        [3.8226e+05, 0.0000e+00, 3.8227e+05, 7.4939e+05, 3.8226e+05, 3.8224e+05,
         3.8229e+05, 3.8226e+05, 7.7986e+05, 3.8229e+05, 7.5813e+05, 7.6631e+05,
         3.8231e+05, 7.7488e+05, 3.8227e+05, 3.8230e+05, 3.8221e+05, 3.8228e+05,
         7.8074e+05],
        [3.5837e+00, 3.8227e+05, 0.0000e+00, 3.8515e+05, 3.4385e+00, 4.0408e+00,
         3.3806e+00, 3.3923e+00, 4.0281e+05, 4.0153e+00, 3.9573e+05, 3.9734e+05,
         3.8927e+00, 3.8682e+05, 3.5393e+00, 3.8187e+00, 4.0056e+00, 3.6880e+00,
         4.0692e+05],
        [3.8513e+05, 7.4939e+05, 3.8515e+05, 0.0000e+00, 3.8512e+05, 3.8514e+05,
         3.8515e+05, 3.8512e+05, 7.9111e+05, 3.8511e+05, 7.8466e+05, 7.8751e+05,
         3.8510e+05, 7.5843e+05, 3.8515e+05, 3.8515e+05, 3.8508e+05, 3.8511e+05,
         7.8524e+05],
        [3.5890e+00, 3.8226e+05, 3.4385e+00, 3.8512e+05, 0.0000e+00, 4.1378e+00,
         3.4087e+00, 3.7283e+00, 4.0286e+05, 3.7232e+00, 3.9573e+05, 3.9729e+05,
         3.7710e+00, 3.8683e+05, 3.6153e+00, 3.6185e+00, 3.9958e+00, 3.5305e+00,
         4.0695e+05],
        [3.9979e+00, 3.8224e+05, 4.0408e+00, 3.8514e+05, 4.1378e+00, 0.0000e+00,
         3.5350e+00, 3.9813e+00, 4.0282e+05, 4.4835e+00, 3.9574e+05, 3.9730e+05,
         4.2744e+00, 3.8690e+05, 3.6256e+00, 4.1340e+00, 4.6743e+00, 4.0815e+00,
         4.0696e+05],
        [3.6859e+00, 3.8229e+05, 3.3806e+00, 3.8515e+05, 3.4087e+00, 3.5350e+00,
         0.0000e+00, 3.2541e+00, 4.0283e+05, 3.9159e+00, 3.9568e+05, 3.9733e+05,
         3.7974e+00, 3.8686e+05, 3.5030e+00, 3.7210e+00, 4.1390e+00, 3.4797e+00,
         4.0700e+05],
        [3.6715e+00, 3.8226e+05, 3.3923e+00, 3.8512e+05, 3.7283e+00, 3.9813e+00,
         3.2541e+00, 0.0000e+00, 4.0279e+05, 3.8758e+00, 3.9573e+05, 3.9736e+05,
         3.7038e+00, 3.8686e+05, 3.6778e+00, 3.7985e+00, 3.9260e+00, 3.7290e+00,
         4.0696e+05],
        [4.0285e+05, 7.7986e+05, 4.0281e+05, 7.9111e+05, 4.0286e+05, 4.0282e+05,
         4.0283e+05, 4.0279e+05, 0.0000e+00, 4.0281e+05, 7.9032e+05, 8.2086e+05,
         4.0280e+05, 7.8644e+05, 4.0288e+05, 4.0281e+05, 4.0279e+05, 4.0285e+05,
         8.1261e+05],
        [3.7569e+00, 3.8229e+05, 4.0153e+00, 3.8511e+05, 3.7232e+00, 4.4835e+00,
         3.9159e+00, 3.8758e+00, 4.0281e+05, 0.0000e+00, 3.9573e+05, 3.9736e+05,
         4.2413e+00, 3.8687e+05, 4.1979e+00, 3.7268e+00, 3.5948e+00, 3.9280e+00,
         4.0700e+05],
        [3.9578e+05, 7.5813e+05, 3.9573e+05, 7.8466e+05, 3.9573e+05, 3.9574e+05,
         3.9568e+05, 3.9573e+05, 7.9032e+05, 3.9573e+05, 0.0000e+00, 7.9590e+05,
         3.9578e+05, 7.8357e+05, 3.9576e+05, 3.9574e+05, 3.9575e+05, 3.9574e+05,
         7.9614e+05],
        [3.9733e+05, 7.6631e+05, 3.9734e+05, 7.8751e+05, 3.9729e+05, 3.9730e+05,
         3.9733e+05, 3.9736e+05, 8.2086e+05, 3.9736e+05, 7.9590e+05, 0.0000e+00,
         3.9737e+05, 7.9491e+05, 3.9730e+05, 3.9731e+05, 3.9730e+05, 3.9728e+05,
         8.0931e+05],
        [3.5257e+00, 3.8231e+05, 3.8927e+00, 3.8510e+05, 3.7710e+00, 4.2744e+00,
         3.7974e+00, 3.7038e+00, 4.0280e+05, 4.2413e+00, 3.9578e+05, 3.9737e+05,
         0.0000e+00, 3.8688e+05, 3.7274e+00, 3.6921e+00, 4.1609e+00, 3.8050e+00,
         4.0694e+05],
        [3.8690e+05, 7.7488e+05, 3.8682e+05, 7.5843e+05, 3.8683e+05, 3.8690e+05,
         3.8686e+05, 3.8686e+05, 7.8644e+05, 3.8687e+05, 7.8357e+05, 7.9491e+05,
         3.8688e+05, 0.0000e+00, 3.8688e+05, 3.8687e+05, 3.8687e+05, 3.8686e+05,
         7.9712e+05],
        [3.7191e+00, 3.8227e+05, 3.5393e+00, 3.8515e+05, 3.6153e+00, 3.6256e+00,
         3.5030e+00, 3.6778e+00, 4.0288e+05, 4.1979e+00, 3.9576e+05, 3.9730e+05,
         3.7274e+00, 3.8688e+05, 0.0000e+00, 3.9164e+00, 4.1116e+00, 3.7310e+00,
         4.0693e+05],
        [3.5872e+00, 3.8230e+05, 3.8187e+00, 3.8515e+05, 3.6185e+00, 4.1340e+00,
         3.7210e+00, 3.7985e+00, 4.0281e+05, 3.7268e+00, 3.9574e+05, 3.9731e+05,
         3.6921e+00, 3.8687e+05, 3.9164e+00, 0.0000e+00, 3.7088e+00, 3.8023e+00,
         4.0693e+05],
        [3.6393e+00, 3.8221e+05, 4.0056e+00, 3.8508e+05, 3.9958e+00, 4.6743e+00,
         4.1390e+00, 3.9260e+00, 4.0279e+05, 3.5948e+00, 3.9575e+05, 3.9730e+05,
         4.1609e+00, 3.8687e+05, 4.1116e+00, 3.7088e+00, 0.0000e+00, 4.0069e+00,
         4.0693e+05],
        [3.4288e+00, 3.8228e+05, 3.6880e+00, 3.8511e+05, 3.5305e+00, 4.0815e+00,
         3.4797e+00, 3.7290e+00, 4.0285e+05, 3.9280e+00, 3.9574e+05, 3.9728e+05,
         3.8050e+00, 3.8686e+05, 3.7310e+00, 3.8023e+00, 4.0069e+00, 0.0000e+00,
         4.0697e+05],
        [4.0698e+05, 7.8074e+05, 4.0692e+05, 7.8524e+05, 4.0695e+05, 4.0696e+05,
         4.0700e+05, 4.0696e+05, 8.1261e+05, 4.0700e+05, 7.9614e+05, 8.0931e+05,
         4.0694e+05, 7.9712e+05, 4.0693e+05, 4.0693e+05, 4.0693e+05, 4.0697e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.4288e+00, 3.5257e+00, 3.5837e+00, 3.5872e+00, 3.5890e+00,
        3.6393e+00, 3.6715e+00, 3.6859e+00, 3.7191e+00, 3.7569e+00, 3.9979e+00,
        3.8226e+05, 3.8513e+05, 3.8690e+05, 3.9578e+05, 3.9733e+05, 4.0285e+05,
        4.0698e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382209.5625, 382237.8125, 382255.3438, 382256.4375,
        382262.2500, 382265.5938, 382268.5625, 382281.3750, 382288.4375,
        382290.9062, 382296.8125, 382305.8125, 749391.2500, 758127.5625,
        766305.6875, 774882.7500, 779857.9375, 780744.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.3806e+00, 3.3923e+00, 3.4385e+00, 3.5393e+00, 3.5837e+00,
        3.6880e+00, 3.8187e+00, 3.8927e+00, 4.0056e+00, 4.0153e+00, 4.0408e+00,
        3.8227e+05, 3.8515e+05, 3.8682e+05, 3.9573e+05, 3.9734e+05, 4.0281e+05,
        4.0692e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385080.6250, 385099.1875, 385106.6875, 385107.5312,
        385115.1562, 385118.3125, 385132.4062, 385140.5000, 385147.9375,
        385148.5625, 385151.2500, 385153.8750, 749391.2500, 758434.6250,
        784656.6250, 785237.0625, 787509.1875, 791107.6875])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.4087e+00, 3.4385e+00, 3.5305e+00, 3.5890e+00, 3.6153e+00,
        3.6185e+00, 3.7232e+00, 3.7283e+00, 3.7710e+00, 3.9958e+00, 4.1378e+00,
        3.8226e+05, 3.8512e+05, 3.8683e+05, 3.9573e+05, 3.9729e+05, 4.0286e+05,
        4.0695e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5350e+00, 3.6256e+00, 3.9813e+00, 3.9979e+00, 4.0408e+00,
        4.0815e+00, 4.1340e+00, 4.1378e+00, 4.2744e+00, 4.4835e+00, 4.6743e+00,
        3.8224e+05, 3.8514e+05, 3.8690e+05, 3.9574e+05, 3.9730e+05, 4.0282e+05,
        4.0696e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2541e+00, 3.3806e+00, 3.4087e+00, 3.4797e+00, 3.5030e+00,
        3.5350e+00, 3.6859e+00, 3.7210e+00, 3.7974e+00, 3.9159e+00, 4.1390e+00,
        3.8229e+05, 3.8515e+05, 3.8686e+05, 3.9568e+05, 3.9733e+05, 4.0283e+05,
        4.0700e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2541e+00, 3.3923e+00, 3.6715e+00, 3.6778e+00, 3.7038e+00,
        3.7283e+00, 3.7290e+00, 3.7985e+00, 3.8758e+00, 3.9260e+00, 3.9813e+00,
        3.8226e+05, 3.8512e+05, 3.8686e+05, 3.9573e+05, 3.9736e+05, 4.0279e+05,
        4.0696e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 402788.8750, 402794.4375, 402804.6250, 402806.7188,
        402813.3750, 402813.7500, 402816.8750, 402831.5312, 402848.0312,
        402851.6562, 402864.7500, 402881.0625, 779857.9375, 786437.0625,
        790322.0000, 791107.6875, 812607.3750, 820859.6250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.5948e+00, 3.7232e+00, 3.7268e+00, 3.7569e+00, 3.8758e+00,
        3.9159e+00, 3.9280e+00, 4.0153e+00, 4.1979e+00, 4.2413e+00, 4.4835e+00,
        3.8229e+05, 3.8511e+05, 3.8687e+05, 3.9573e+05, 3.9736e+05, 4.0281e+05,
        4.0700e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395681.0938, 395726.2500, 395729.6875, 395729.9688,
        395732.6875, 395736.4062, 395739.0000, 395743.0938, 395745.6562,
        395764.1875, 395781.1875, 395783.5000, 758127.5625, 783574.3750,
        784656.6250, 790322.0000, 795899.4375, 796142.1875])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 397277.9375, 397289.8125, 397299.7188, 397301.6562,
        397303.9375, 397309.5312, 397329.9062, 397332.0938, 397342.5625,
        397358.6875, 397359.7812, 397365.2812, 766305.6875, 787509.1875,
        794912.0625, 795899.4375, 809314.2500, 820859.6250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.5257e+00, 3.6921e+00, 3.7038e+00, 3.7274e+00, 3.7710e+00,
        3.7974e+00, 3.8050e+00, 3.8927e+00, 4.1609e+00, 4.2413e+00, 4.2744e+00,
        3.8231e+05, 3.8510e+05, 3.8688e+05, 3.9578e+05, 3.9737e+05, 4.0280e+05,
        4.0694e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386824.7812, 386831.4375, 386857.0312, 386859.2500,
        386864.0312, 386870.7812, 386871.8750, 386874.3125, 386880.4688,
        386884.5625, 386896.7500, 386904.3750, 758434.6250, 774882.7500,
        783574.3750, 786437.0625, 794912.0625, 797121.5000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.5030e+00, 3.5393e+00, 3.6153e+00, 3.6256e+00, 3.6778e+00,
        3.7191e+00, 3.7274e+00, 3.7310e+00, 3.9164e+00, 4.1116e+00, 4.1979e+00,
        3.8227e+05, 3.8515e+05, 3.8688e+05, 3.9576e+05, 3.9730e+05, 4.0288e+05,
        4.0693e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5872e+00, 3.6185e+00, 3.6921e+00, 3.7088e+00, 3.7210e+00,
        3.7268e+00, 3.7985e+00, 3.8023e+00, 3.8187e+00, 3.9164e+00, 4.1340e+00,
        3.8230e+05, 3.8515e+05, 3.8687e+05, 3.9574e+05, 3.9731e+05, 4.0281e+05,
        4.0693e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5948e+00, 3.6393e+00, 3.7088e+00, 3.9260e+00, 3.9958e+00,
        4.0056e+00, 4.0069e+00, 4.1116e+00, 4.1390e+00, 4.1609e+00, 4.6743e+00,
        3.8221e+05, 3.8508e+05, 3.8687e+05, 3.9575e+05, 3.9730e+05, 4.0279e+05,
        4.0693e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4288e+00, 3.4797e+00, 3.5305e+00, 3.6880e+00, 3.7290e+00,
        3.7310e+00, 3.8023e+00, 3.8050e+00, 3.9280e+00, 4.0069e+00, 4.0815e+00,
        3.8228e+05, 3.8511e+05, 3.8686e+05, 3.9574e+05, 3.9728e+05, 4.0285e+05,
        4.0697e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 406923.4688, 406928.0625, 406928.0938, 406932.6875,
        406938.6562, 406950.6250, 406956.4375, 406957.8125, 406968.0938,
        406983.6875, 406995.7812, 407000.4375, 780744.7500, 785237.0625,
        796142.1875, 797121.5000, 809314.2500, 812607.3750])
Index of maximum distance difference after half of values: 12
adaptive_Krum scores:  ['3.65', '382268.25', '3.71', '385125.16', '3.69', '4.09', '3.62', '3.70', '402826.34', '3.95', '395741.06', '397322.59', '3.87', '386868.31', '3.76', '3.77', '4.00', '3.75', '406955.34']
estimated f for each client, fs: [7, 5, 7, 5, 7, 7, 7, 7, 5, 7, 5, 5, 7, 5, 7, 7, 7, 7, 5]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [11, 14, 5, 20, 3, 8, 6, 7, 13, 1, 19, 15, 4, 18, 12, 2, 9, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0147s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:51...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[113 124]
 [116 147]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:51, End: 2025-07-22 15:45:51)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [2, 3, 13, 8, 5, 16, 19, 4, 1, 11, 15, 9, 20, 12, 18, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.6824e+00, 3.9301e+05, 4.2944e+00, 3.8966e+00, 4.0553e+05,
         3.7943e+05, 3.7588e+00, 3.6950e+00, 3.6110e+00, 3.8289e+05, 3.7034e+00,
         3.8763e+05, 3.8942e+00, 3.8044e+05, 3.7977e+00, 3.9983e+05],
        [3.6824e+00, 0.0000e+00, 3.9302e+05, 4.2325e+00, 3.4903e+00, 4.0549e+05,
         3.7938e+05, 3.9051e+00, 3.7850e+00, 3.8113e+00, 3.8287e+05, 4.0554e+00,
         3.8761e+05, 3.4999e+00, 3.8044e+05, 3.5137e+00, 3.9984e+05],
        [3.9301e+05, 3.9302e+05, 0.0000e+00, 3.9309e+05, 3.9309e+05, 8.2621e+05,
         7.4951e+05, 3.9301e+05, 3.9302e+05, 3.9302e+05, 7.7303e+05, 3.9301e+05,
         7.8967e+05, 3.9310e+05, 7.4608e+05, 3.9307e+05, 7.8954e+05],
        [4.2944e+00, 4.2325e+00, 3.9309e+05, 0.0000e+00, 4.0932e+00, 4.0559e+05,
         3.7939e+05, 4.4276e+00, 4.5474e+00, 4.1515e+00, 3.8291e+05, 4.7582e+00,
         3.8764e+05, 3.6326e+00, 3.8043e+05, 4.1057e+00, 3.9985e+05],
        [3.8966e+00, 3.4903e+00, 3.9309e+05, 4.0932e+00, 0.0000e+00, 4.0558e+05,
         3.7940e+05, 4.0184e+00, 4.0400e+00, 3.6559e+00, 3.8292e+05, 3.9923e+00,
         3.8762e+05, 3.5347e+00, 3.8038e+05, 3.7327e+00, 3.9988e+05],
        [4.0553e+05, 4.0549e+05, 8.2621e+05, 4.0559e+05, 4.0558e+05, 0.0000e+00,
         8.0178e+05, 4.0556e+05, 4.0556e+05, 4.0553e+05, 8.1675e+05, 4.0554e+05,
         7.9942e+05, 4.0557e+05, 7.9109e+05, 4.0551e+05, 7.9866e+05],
        [3.7943e+05, 3.7938e+05, 7.4951e+05, 3.7939e+05, 3.7940e+05, 8.0178e+05,
         0.0000e+00, 3.7932e+05, 3.7932e+05, 3.7939e+05, 7.7185e+05, 3.7936e+05,
         7.6536e+05, 3.7944e+05, 7.5626e+05, 3.7937e+05, 7.7790e+05],
        [3.7588e+00, 3.9051e+00, 3.9301e+05, 4.4276e+00, 4.0184e+00, 4.0556e+05,
         3.7932e+05, 0.0000e+00, 4.1832e+00, 3.6338e+00, 3.8291e+05, 4.1441e+00,
         3.8766e+05, 3.7794e+00, 3.8042e+05, 3.8437e+00, 3.9983e+05],
        [3.6950e+00, 3.7850e+00, 3.9302e+05, 4.5474e+00, 4.0400e+00, 4.0556e+05,
         3.7932e+05, 4.1832e+00, 0.0000e+00, 3.7769e+00, 3.8292e+05, 3.5357e+00,
         3.8759e+05, 4.1843e+00, 3.8042e+05, 3.9217e+00, 3.9990e+05],
        [3.6110e+00, 3.8113e+00, 3.9302e+05, 4.1515e+00, 3.6559e+00, 4.0553e+05,
         3.7939e+05, 3.6338e+00, 3.7769e+00, 0.0000e+00, 3.8291e+05, 3.7347e+00,
         3.8760e+05, 3.8307e+00, 3.8044e+05, 3.5633e+00, 3.9986e+05],
        [3.8289e+05, 3.8287e+05, 7.7303e+05, 3.8291e+05, 3.8292e+05, 8.1675e+05,
         7.7185e+05, 3.8291e+05, 3.8292e+05, 3.8291e+05, 0.0000e+00, 3.8288e+05,
         7.5806e+05, 3.8290e+05, 7.6735e+05, 3.8297e+05, 7.6820e+05],
        [3.7034e+00, 4.0554e+00, 3.9301e+05, 4.7582e+00, 3.9923e+00, 4.0554e+05,
         3.7936e+05, 4.1441e+00, 3.5357e+00, 3.7347e+00, 3.8288e+05, 0.0000e+00,
         3.8767e+05, 4.0726e+00, 3.8043e+05, 3.9795e+00, 3.9984e+05],
        [3.8763e+05, 3.8761e+05, 7.8967e+05, 3.8764e+05, 3.8762e+05, 7.9942e+05,
         7.6536e+05, 3.8766e+05, 3.8759e+05, 3.8760e+05, 7.5806e+05, 3.8767e+05,
         0.0000e+00, 3.8762e+05, 7.7798e+05, 3.8768e+05, 7.6883e+05],
        [3.8942e+00, 3.4999e+00, 3.9310e+05, 3.6326e+00, 3.5347e+00, 4.0557e+05,
         3.7944e+05, 3.7794e+00, 4.1843e+00, 3.8307e+00, 3.8290e+05, 4.0726e+00,
         3.8762e+05, 0.0000e+00, 3.8040e+05, 3.7159e+00, 3.9983e+05],
        [3.8044e+05, 3.8044e+05, 7.4608e+05, 3.8043e+05, 3.8038e+05, 7.9109e+05,
         7.5626e+05, 3.8042e+05, 3.8042e+05, 3.8044e+05, 7.6735e+05, 3.8043e+05,
         7.7798e+05, 3.8040e+05, 0.0000e+00, 3.8041e+05, 7.7155e+05],
        [3.7977e+00, 3.5137e+00, 3.9307e+05, 4.1057e+00, 3.7327e+00, 4.0551e+05,
         3.7937e+05, 3.8437e+00, 3.9217e+00, 3.5633e+00, 3.8297e+05, 3.9795e+00,
         3.8768e+05, 3.7159e+00, 3.8041e+05, 0.0000e+00, 3.9983e+05],
        [3.9983e+05, 3.9984e+05, 7.8954e+05, 3.9985e+05, 3.9988e+05, 7.9866e+05,
         7.7790e+05, 3.9983e+05, 3.9990e+05, 3.9986e+05, 7.6820e+05, 3.9984e+05,
         7.6883e+05, 3.9983e+05, 7.7155e+05, 3.9983e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.6110e+00, 3.6824e+00, 3.6950e+00, 3.7034e+00, 3.7588e+00,
        3.7977e+00, 3.8942e+00, 3.8966e+00, 4.2944e+00, 3.7943e+05, 3.8044e+05,
        3.8289e+05, 3.8763e+05, 3.9301e+05, 3.9983e+05, 4.0553e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4903e+00, 3.4999e+00, 3.5137e+00, 3.6824e+00, 3.7850e+00,
        3.8113e+00, 3.9051e+00, 4.0554e+00, 4.2325e+00, 3.7938e+05, 3.8044e+05,
        3.8287e+05, 3.8761e+05, 3.9302e+05, 3.9984e+05, 4.0549e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393005.2500, 393009.0625, 393013.5312, 393017.1250,
        393019.5938, 393024.3125, 393070.5625, 393085.5312, 393092.1562,
        393100.0625, 746076.8125, 749514.5000, 773027.6875, 789542.2500,
        789672.6250, 826209.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6326e+00, 4.0932e+00, 4.1057e+00, 4.1515e+00, 4.2325e+00,
        4.2944e+00, 4.4276e+00, 4.5474e+00, 4.7582e+00, 3.7939e+05, 3.8043e+05,
        3.8291e+05, 3.8764e+05, 3.9309e+05, 3.9985e+05, 4.0559e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4903e+00, 3.5347e+00, 3.6559e+00, 3.7327e+00, 3.8966e+00,
        3.9923e+00, 4.0184e+00, 4.0400e+00, 4.0932e+00, 3.7940e+05, 3.8038e+05,
        3.8292e+05, 3.8762e+05, 3.9309e+05, 3.9988e+05, 4.0558e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405492.3438, 405507.7812, 405528.8750, 405530.4062,
        405535.8125, 405555.2188, 405562.5625, 405568.8438, 405584.0000,
        405592.1562, 791089.7500, 798660.0625, 799418.2500, 801783.3125,
        816751.0625, 826209.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379316.5625, 379321.8438, 379359.2188, 379367.1250,
        379376.2188, 379386.7500, 379390.4688, 379403.1875, 379432.2500,
        379443.6875, 749514.5000, 756258.6250, 765359.6250, 771851.2500,
        777899.6875, 801783.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6338e+00, 3.7588e+00, 3.7794e+00, 3.8437e+00, 3.9051e+00,
        4.0184e+00, 4.1441e+00, 4.1832e+00, 4.4276e+00, 3.7932e+05, 3.8042e+05,
        3.8291e+05, 3.8766e+05, 3.9301e+05, 3.9983e+05, 4.0556e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5357e+00, 3.6950e+00, 3.7769e+00, 3.7850e+00, 3.9217e+00,
        4.0400e+00, 4.1832e+00, 4.1843e+00, 4.5474e+00, 3.7932e+05, 3.8042e+05,
        3.8292e+05, 3.8759e+05, 3.9302e+05, 3.9990e+05, 4.0556e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5633e+00, 3.6110e+00, 3.6338e+00, 3.6559e+00, 3.7347e+00,
        3.7769e+00, 3.8113e+00, 3.8307e+00, 4.1515e+00, 3.7939e+05, 3.8044e+05,
        3.8291e+05, 3.8760e+05, 3.9302e+05, 3.9986e+05, 4.0553e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382866.3438, 382881.8125, 382891.9062, 382895.9062,
        382908.0312, 382911.9062, 382912.2188, 382919.5625, 382924.4375,
        382969.2500, 758064.9375, 767349.1250, 768195.5625, 771851.2500,
        773027.6875, 816751.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5357e+00, 3.7034e+00, 3.7347e+00, 3.9795e+00, 3.9923e+00,
        4.0554e+00, 4.0726e+00, 4.1441e+00, 4.7582e+00, 3.7936e+05, 3.8043e+05,
        3.8288e+05, 3.8767e+05, 3.9301e+05, 3.9984e+05, 4.0554e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387591.9375, 387597.4688, 387609.8438, 387619.0312,
        387624.2500, 387632.9375, 387644.5000, 387657.3125, 387672.4688,
        387680.3750, 758064.9375, 765359.6250, 768829.9375, 777980.1875,
        789672.6250, 799418.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4999e+00, 3.5347e+00, 3.6326e+00, 3.7159e+00, 3.7794e+00,
        3.8307e+00, 3.8942e+00, 4.0726e+00, 4.1843e+00, 3.7944e+05, 3.8040e+05,
        3.8290e+05, 3.8762e+05, 3.9310e+05, 3.9983e+05, 4.0557e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380377.7812, 380399.6250, 380406.7188, 380420.9375,
        380424.0312, 380425.3750, 380428.4688, 380436.1875, 380439.3125,
        380444.2500, 746076.8125, 756258.6250, 767349.1250, 771552.6250,
        777980.1875, 791089.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5137e+00, 3.5633e+00, 3.7159e+00, 3.7327e+00, 3.7977e+00,
        3.8437e+00, 3.9217e+00, 3.9795e+00, 4.1057e+00, 3.7937e+05, 3.8041e+05,
        3.8297e+05, 3.8768e+05, 3.9307e+05, 3.9983e+05, 4.0551e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399827.0625, 399832.2812, 399833.5000, 399834.1250,
        399844.7188, 399845.0000, 399853.7188, 399856.7812, 399882.5312,
        399897.0938, 768195.5625, 768829.9375, 771552.6250, 777899.6875,
        789542.2500, 798660.0625])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37946.66', '37941.02', '393043.69', '37942.49', '37943.76', '405545.78', '379379.72', '37935.22', '37935.75', '37942.42', '382908.16', '37939.52', '387632.97', '37947.78', '380420.25', '37940.12', '399850.66']
estimated f for each client, fs: [7, 7, 5, 7, 7, 5, 5, 7, 7, 7, 5, 7, 5, 7, 5, 7, 5]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [2, 3, 13, 8, 5, 16, 19, 4, 1, 11, 15, 9, 20, 12, 18, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0119s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:51...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[120 117]
 [120 143]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:51, End: 2025-07-22 15:45:51)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [12, 6, 16, 1, 9, 18, 20, 13, 2, 8, 7, 17, 10, 14, 3, 4, 11, 15, 19], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.4663e+00, 3.8129e+05, 4.1476e+00, 4.0410e+00, 3.8229e+05,
         3.8069e+05, 4.0522e+05, 3.8732e+00, 3.6793e+00, 3.6170e+00, 3.9499e+05,
         3.6608e+00, 3.9692e+05, 3.5223e+00, 3.7177e+00, 3.9183e+00, 3.8673e+05,
         3.9578e+05],
        [3.4663e+00, 0.0000e+00, 3.8128e+05, 4.0017e+00, 4.3034e+00, 3.8232e+05,
         3.8063e+05, 4.0522e+05, 3.8313e+00, 3.6577e+00, 3.3844e+00, 3.9496e+05,
         3.5568e+00, 3.9690e+05, 3.5217e+00, 3.9671e+00, 3.9516e+00, 3.8681e+05,
         3.9582e+05],
        [3.8129e+05, 3.8128e+05, 0.0000e+00, 3.8125e+05, 3.8129e+05, 7.7599e+05,
         7.6412e+05, 8.0521e+05, 3.8124e+05, 3.8130e+05, 3.8127e+05, 7.7745e+05,
         3.8128e+05, 7.7459e+05, 3.8126e+05, 3.8124e+05, 3.8127e+05, 7.8859e+05,
         7.8325e+05],
        [4.1476e+00, 4.0017e+00, 3.8125e+05, 0.0000e+00, 3.5497e+00, 3.8235e+05,
         3.8068e+05, 4.0516e+05, 3.7430e+00, 4.5455e+00, 3.9707e+00, 3.9496e+05,
         3.8730e+00, 3.9691e+05, 3.8201e+00, 4.1076e+00, 3.7805e+00, 3.8678e+05,
         3.9585e+05],
        [4.0410e+00, 4.3034e+00, 3.8129e+05, 3.5497e+00, 0.0000e+00, 3.8235e+05,
         3.8069e+05, 4.0519e+05, 3.7472e+00, 4.7567e+00, 4.0664e+00, 3.9493e+05,
         3.9570e+00, 3.9688e+05, 4.0116e+00, 3.9971e+00, 3.6878e+00, 3.8678e+05,
         3.9584e+05],
        [3.8229e+05, 3.8232e+05, 7.7599e+05, 3.8235e+05, 3.8235e+05, 0.0000e+00,
         7.8880e+05, 7.8286e+05, 3.8231e+05, 3.8233e+05, 3.8232e+05, 7.7483e+05,
         3.8234e+05, 7.8220e+05, 3.8232e+05, 3.8229e+05, 3.8232e+05, 7.5040e+05,
         7.9769e+05],
        [3.8069e+05, 3.8063e+05, 7.6412e+05, 3.8068e+05, 3.8069e+05, 7.8880e+05,
         0.0000e+00, 7.5815e+05, 3.8063e+05, 3.8063e+05, 3.8063e+05, 7.7433e+05,
         3.8060e+05, 7.7339e+05, 3.8064e+05, 3.8066e+05, 3.8068e+05, 7.7062e+05,
         7.8414e+05],
        [4.0522e+05, 4.0522e+05, 8.0521e+05, 4.0516e+05, 4.0519e+05, 7.8286e+05,
         7.5815e+05, 0.0000e+00, 4.0510e+05, 4.0522e+05, 4.0522e+05, 8.1431e+05,
         4.0522e+05, 7.9674e+05, 4.0520e+05, 4.0522e+05, 4.0523e+05, 7.9447e+05,
         7.8805e+05],
        [3.8732e+00, 3.8313e+00, 3.8124e+05, 3.7430e+00, 3.7472e+00, 3.8231e+05,
         3.8063e+05, 4.0510e+05, 0.0000e+00, 4.2075e+00, 3.9218e+00, 3.9494e+05,
         3.8092e+00, 3.9690e+05, 3.6576e+00, 3.7279e+00, 3.6983e+00, 3.8675e+05,
         3.9581e+05],
        [3.6793e+00, 3.6577e+00, 3.8130e+05, 4.5455e+00, 4.7567e+00, 3.8233e+05,
         3.8063e+05, 4.0522e+05, 4.2075e+00, 0.0000e+00, 3.9577e+00, 3.9501e+05,
         4.0715e+00, 3.9690e+05, 4.2665e+00, 4.3891e+00, 4.1508e+00, 3.8680e+05,
         3.9578e+05],
        [3.6170e+00, 3.3844e+00, 3.8127e+05, 3.9707e+00, 4.0664e+00, 3.8232e+05,
         3.8063e+05, 4.0522e+05, 3.9218e+00, 3.9577e+00, 0.0000e+00, 3.9492e+05,
         3.6691e+00, 3.9686e+05, 3.8223e+00, 3.7620e+00, 3.9979e+00, 3.8684e+05,
         3.9580e+05],
        [3.9499e+05, 3.9496e+05, 7.7745e+05, 3.9496e+05, 3.9493e+05, 7.7483e+05,
         7.7433e+05, 8.1431e+05, 3.9494e+05, 3.9501e+05, 3.9492e+05, 0.0000e+00,
         3.9499e+05, 7.8362e+05, 3.9496e+05, 3.9493e+05, 3.9495e+05, 7.7490e+05,
         8.0951e+05],
        [3.6608e+00, 3.5568e+00, 3.8128e+05, 3.8730e+00, 3.9570e+00, 3.8234e+05,
         3.8060e+05, 4.0522e+05, 3.8092e+00, 4.0715e+00, 3.6691e+00, 3.9499e+05,
         0.0000e+00, 3.9689e+05, 3.4987e+00, 3.8147e+00, 3.6027e+00, 3.8678e+05,
         3.9580e+05],
        [3.9692e+05, 3.9690e+05, 7.7459e+05, 3.9691e+05, 3.9688e+05, 7.8220e+05,
         7.7339e+05, 7.9674e+05, 3.9690e+05, 3.9690e+05, 3.9686e+05, 7.8362e+05,
         3.9689e+05, 0.0000e+00, 3.9687e+05, 3.9692e+05, 3.9687e+05, 7.9550e+05,
         7.7816e+05],
        [3.5223e+00, 3.5217e+00, 3.8126e+05, 3.8201e+00, 4.0116e+00, 3.8232e+05,
         3.8064e+05, 4.0520e+05, 3.6576e+00, 4.2665e+00, 3.8223e+00, 3.9496e+05,
         3.4987e+00, 3.9687e+05, 0.0000e+00, 3.8456e+00, 3.8425e+00, 3.8677e+05,
         3.9579e+05],
        [3.7177e+00, 3.9671e+00, 3.8124e+05, 4.1076e+00, 3.9971e+00, 3.8229e+05,
         3.8066e+05, 4.0522e+05, 3.7279e+00, 4.3891e+00, 3.7620e+00, 3.9493e+05,
         3.8147e+00, 3.9692e+05, 3.8456e+00, 0.0000e+00, 3.6268e+00, 3.8686e+05,
         3.9585e+05],
        [3.9183e+00, 3.9516e+00, 3.8127e+05, 3.7805e+00, 3.6878e+00, 3.8232e+05,
         3.8068e+05, 4.0523e+05, 3.6983e+00, 4.1508e+00, 3.9979e+00, 3.9495e+05,
         3.6027e+00, 3.9687e+05, 3.8425e+00, 3.6268e+00, 0.0000e+00, 3.8680e+05,
         3.9580e+05],
        [3.8673e+05, 3.8681e+05, 7.8859e+05, 3.8678e+05, 3.8678e+05, 7.5040e+05,
         7.7062e+05, 7.9447e+05, 3.8675e+05, 3.8680e+05, 3.8684e+05, 7.7490e+05,
         3.8678e+05, 7.9550e+05, 3.8677e+05, 3.8686e+05, 3.8680e+05, 0.0000e+00,
         8.0423e+05],
        [3.9578e+05, 3.9582e+05, 7.8325e+05, 3.9585e+05, 3.9584e+05, 7.9769e+05,
         7.8414e+05, 7.8805e+05, 3.9581e+05, 3.9578e+05, 3.9580e+05, 8.0951e+05,
         3.9580e+05, 7.7816e+05, 3.9579e+05, 3.9585e+05, 3.9580e+05, 8.0423e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.4663e+00, 3.5223e+00, 3.6170e+00, 3.6608e+00, 3.6793e+00,
        3.7177e+00, 3.8732e+00, 3.9183e+00, 4.0410e+00, 4.1476e+00, 3.8069e+05,
        3.8129e+05, 3.8229e+05, 3.8673e+05, 3.9499e+05, 3.9578e+05, 3.9692e+05,
        4.0522e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3844e+00, 3.4663e+00, 3.5217e+00, 3.5568e+00, 3.6577e+00,
        3.8313e+00, 3.9516e+00, 3.9671e+00, 4.0017e+00, 4.3034e+00, 3.8063e+05,
        3.8128e+05, 3.8232e+05, 3.8681e+05, 3.9496e+05, 3.9582e+05, 3.9690e+05,
        4.0522e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 381239.2812, 381241.2812, 381252.1250, 381257.5938,
        381265.4688, 381272.5938, 381278.8438, 381280.5938, 381289.9375,
        381291.2500, 381299.1562, 764120.8750, 774589.7500, 775985.0625,
        777452.4375, 783245.3125, 788589.7500, 805206.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5497e+00, 3.7430e+00, 3.7805e+00, 3.8201e+00, 3.8730e+00,
        3.9707e+00, 4.0017e+00, 4.1076e+00, 4.1476e+00, 4.5455e+00, 3.8068e+05,
        3.8125e+05, 3.8235e+05, 3.8678e+05, 3.9496e+05, 3.9585e+05, 3.9691e+05,
        4.0516e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5497e+00, 3.6878e+00, 3.7472e+00, 3.9570e+00, 3.9971e+00,
        4.0116e+00, 4.0410e+00, 4.0664e+00, 4.3034e+00, 4.7567e+00, 3.8069e+05,
        3.8129e+05, 3.8235e+05, 3.8678e+05, 3.9493e+05, 3.9584e+05, 3.9688e+05,
        4.0519e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382290.1250, 382294.1875, 382314.5625, 382315.3438,
        382315.6875, 382320.9062, 382321.0625, 382327.1250, 382340.0312,
        382345.4688, 382349.0625, 750401.3750, 774833.7500, 775985.0625,
        782199.5000, 782855.2500, 788796.4375, 797690.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 380601.1875, 380625.9375, 380627.2188, 380629.5312,
        380630.7812, 380642.6875, 380662.9375, 380676.7188, 380682.7188,
        380688.3750, 380694.4375, 758146.9375, 764120.8750, 770623.6875,
        773388.0000, 774333.6875, 784140.5000, 788796.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 405104.7500, 405157.4375, 405190.9688, 405197.6875,
        405215.1250, 405215.1562, 405215.9688, 405217.7500, 405217.7500,
        405221.5938, 405227.1250, 758146.9375, 782855.2500, 788052.0625,
        794473.2500, 796743.7500, 805206.5000, 814309.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6576e+00, 3.6983e+00, 3.7279e+00, 3.7430e+00, 3.7472e+00,
        3.8092e+00, 3.8313e+00, 3.8732e+00, 3.9218e+00, 4.2075e+00, 3.8063e+05,
        3.8124e+05, 3.8231e+05, 3.8675e+05, 3.9494e+05, 3.9581e+05, 3.9690e+05,
        4.0510e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6577e+00, 3.6793e+00, 3.9577e+00, 4.0715e+00, 4.1508e+00,
        4.2075e+00, 4.2665e+00, 4.3891e+00, 4.5455e+00, 4.7567e+00, 3.8063e+05,
        3.8130e+05, 3.8233e+05, 3.8680e+05, 3.9501e+05, 3.9578e+05, 3.9690e+05,
        4.0522e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3844e+00, 3.6170e+00, 3.6691e+00, 3.7620e+00, 3.8223e+00,
        3.9218e+00, 3.9577e+00, 3.9707e+00, 3.9979e+00, 4.0664e+00, 3.8063e+05,
        3.8127e+05, 3.8232e+05, 3.8684e+05, 3.9492e+05, 3.9580e+05, 3.9686e+05,
        4.0522e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 394915.5000, 394932.2500, 394934.6875, 394939.0625,
        394952.5625, 394961.6875, 394963.0312, 394964.8125, 394986.6250,
        394993.5938, 395012.1250, 774333.6875, 774833.7500, 774895.8125,
        777452.4375, 783623.0000, 809506.7500, 814309.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4987e+00, 3.5568e+00, 3.6027e+00, 3.6608e+00, 3.6691e+00,
        3.8092e+00, 3.8147e+00, 3.8730e+00, 3.9570e+00, 4.0715e+00, 3.8060e+05,
        3.8128e+05, 3.8234e+05, 3.8678e+05, 3.9499e+05, 3.9580e+05, 3.9689e+05,
        4.0522e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396864.8125, 396868.7500, 396870.9375, 396884.0625,
        396890.7812, 396897.4062, 396898.4062, 396902.6250, 396908.4062,
        396919.4688, 396921.3125, 773388.0000, 774589.7500, 778161.8750,
        782199.5000, 783623.0000, 795500.6875, 796743.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4987e+00, 3.5217e+00, 3.5223e+00, 3.6576e+00, 3.8201e+00,
        3.8223e+00, 3.8425e+00, 3.8456e+00, 4.0116e+00, 4.2665e+00, 3.8064e+05,
        3.8126e+05, 3.8232e+05, 3.8677e+05, 3.9496e+05, 3.9579e+05, 3.9687e+05,
        4.0520e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6268e+00, 3.7177e+00, 3.7279e+00, 3.7620e+00, 3.8147e+00,
        3.8456e+00, 3.9671e+00, 3.9971e+00, 4.1076e+00, 4.3891e+00, 3.8066e+05,
        3.8124e+05, 3.8229e+05, 3.8686e+05, 3.9493e+05, 3.9585e+05, 3.9692e+05,
        4.0522e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6027e+00, 3.6268e+00, 3.6878e+00, 3.6983e+00, 3.7805e+00,
        3.8425e+00, 3.9183e+00, 3.9516e+00, 3.9979e+00, 4.1508e+00, 3.8068e+05,
        3.8127e+05, 3.8232e+05, 3.8680e+05, 3.9495e+05, 3.9580e+05, 3.9687e+05,
        4.0523e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386728.7812, 386747.1250, 386767.1250, 386776.2500,
        386777.0000, 386779.2500, 386799.4062, 386803.4688, 386814.3750,
        386842.7188, 386859.0000, 750401.3750, 770623.6875, 774895.8125,
        788589.7500, 794473.2500, 795500.6875, 804233.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395777.8750, 395777.9688, 395794.9375, 395798.0938,
        395800.2812, 395801.6875, 395814.7500, 395818.2188, 395837.6250,
        395845.7188, 395853.8438, 778161.8750, 783245.3125, 784140.5000,
        788052.0625, 797690.2500, 804233.6875, 809506.7500])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34611.46', '34605.78', '381269.88', '34611.12', '34612.23', '382321.22', '380651.12', '405198.28', '34606.27', '34606.48', '34605.94', '394959.66', '34603.52', '396893.34', '34607.32', '34609.26', '34610.46', '386790.41', '395811.03']
estimated f for each client, fs: [8, 8, 7, 8, 8, 6, 6, 6, 8, 8, 8, 6, 8, 6, 8, 8, 8, 6, 6]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [12, 6, 16, 1, 9, 18, 20, 13, 2, 8, 7, 17, 10, 14, 3, 4, 11, 15, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0153s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:52...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[122 115]
 [123 140]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:52, End: 2025-07-22 15:45:52)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [18, 7, 9, 19, 16, 11, 20, 8, 14, 5, 13, 15, 4, 1, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.9759e+05, 3.9761e+05, 7.9758e+05, 7.6424e+05, 3.9759e+05,
         8.1023e+05, 3.9761e+05, 7.7975e+05, 3.9761e+05, 7.9862e+05, 8.0421e+05,
         3.9758e+05, 3.9760e+05, 3.9758e+05],
        [3.9759e+05, 0.0000e+00, 4.0140e+00, 3.9076e+05, 3.7955e+05, 3.8525e+00,
         4.0698e+05, 3.9213e+00, 3.8703e+05, 3.4261e+00, 3.9752e+05, 3.9286e+05,
         3.7071e+00, 3.9802e+00, 3.7902e+00],
        [3.9761e+05, 4.0140e+00, 0.0000e+00, 3.9082e+05, 3.7957e+05, 3.7963e+00,
         4.0697e+05, 4.7953e+00, 3.8704e+05, 4.0120e+00, 3.9751e+05, 3.9287e+05,
         4.1280e+00, 3.5423e+00, 3.7954e+00],
        [7.9758e+05, 3.9076e+05, 3.9082e+05, 0.0000e+00, 7.6113e+05, 3.9074e+05,
         8.0051e+05, 3.9075e+05, 7.6971e+05, 3.9069e+05, 7.5668e+05, 7.7271e+05,
         3.9080e+05, 3.9078e+05, 3.9082e+05],
        [7.6424e+05, 3.7955e+05, 3.7957e+05, 7.6113e+05, 0.0000e+00, 3.7955e+05,
         8.1287e+05, 3.7956e+05, 7.7420e+05, 3.7955e+05, 7.7476e+05, 7.8208e+05,
         3.7951e+05, 3.7954e+05, 3.7955e+05],
        [3.9759e+05, 3.8525e+00, 3.7963e+00, 3.9074e+05, 3.7955e+05, 0.0000e+00,
         4.0699e+05, 4.1432e+00, 3.8707e+05, 3.7819e+00, 3.9749e+05, 3.9285e+05,
         3.6468e+00, 3.7957e+00, 3.7161e+00],
        [8.1023e+05, 4.0698e+05, 4.0697e+05, 8.0051e+05, 8.1287e+05, 4.0699e+05,
         0.0000e+00, 4.0695e+05, 8.1037e+05, 4.0696e+05, 8.0433e+05, 7.9915e+05,
         4.0695e+05, 4.0692e+05, 4.0687e+05],
        [3.9761e+05, 3.9213e+00, 4.7953e+00, 3.9075e+05, 3.7956e+05, 4.1432e+00,
         4.0695e+05, 0.0000e+00, 3.8704e+05, 4.2038e+00, 3.9750e+05, 3.9289e+05,
         4.3625e+00, 4.6171e+00, 4.2647e+00],
        [7.7975e+05, 3.8703e+05, 3.8704e+05, 7.6971e+05, 7.7420e+05, 3.8707e+05,
         8.1037e+05, 3.8704e+05, 0.0000e+00, 3.8703e+05, 7.8055e+05, 7.7437e+05,
         3.8701e+05, 3.8704e+05, 3.8708e+05],
        [3.9761e+05, 3.4261e+00, 4.0120e+00, 3.9069e+05, 3.7955e+05, 3.7819e+00,
         4.0696e+05, 4.2038e+00, 3.8703e+05, 0.0000e+00, 3.9749e+05, 3.9293e+05,
         3.9895e+00, 4.0423e+00, 3.8943e+00],
        [7.9862e+05, 3.9752e+05, 3.9751e+05, 7.5668e+05, 7.7476e+05, 3.9749e+05,
         8.0433e+05, 3.9750e+05, 7.8055e+05, 3.9749e+05, 0.0000e+00, 7.9180e+05,
         3.9750e+05, 3.9751e+05, 3.9754e+05],
        [8.0421e+05, 3.9286e+05, 3.9287e+05, 7.7271e+05, 7.8208e+05, 3.9285e+05,
         7.9915e+05, 3.9289e+05, 7.7437e+05, 3.9293e+05, 7.9180e+05, 0.0000e+00,
         3.9292e+05, 3.9288e+05, 3.9287e+05],
        [3.9758e+05, 3.7071e+00, 4.1280e+00, 3.9080e+05, 3.7951e+05, 3.6468e+00,
         4.0695e+05, 4.3625e+00, 3.8701e+05, 3.9895e+00, 3.9750e+05, 3.9292e+05,
         0.0000e+00, 4.1619e+00, 3.7418e+00],
        [3.9760e+05, 3.9802e+00, 3.5423e+00, 3.9078e+05, 3.7954e+05, 3.7957e+00,
         4.0692e+05, 4.6171e+00, 3.8704e+05, 4.0423e+00, 3.9751e+05, 3.9288e+05,
         4.1619e+00, 0.0000e+00, 3.7504e+00],
        [3.9758e+05, 3.7902e+00, 3.7954e+00, 3.9082e+05, 3.7955e+05, 3.7161e+00,
         4.0687e+05, 4.2647e+00, 3.8708e+05, 3.8943e+00, 3.9754e+05, 3.9287e+05,
         3.7418e+00, 3.7504e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 397582.7188, 397584.7500, 397588.3125, 397591.6875,
        397596.5000, 397605.0938, 397610.9375, 397612.3438, 764244.4375,
        779745.0625, 797580.8125, 798616.1875, 804213.2500, 810225.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4261e+00, 3.7071e+00, 3.7902e+00, 3.8525e+00, 3.9213e+00,
        3.9802e+00, 4.0140e+00, 3.7955e+05, 3.8703e+05, 3.9076e+05, 3.9286e+05,
        3.9752e+05, 3.9759e+05, 4.0698e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5423e+00, 3.7954e+00, 3.7963e+00, 4.0120e+00, 4.0140e+00,
        4.1280e+00, 4.7953e+00, 3.7957e+05, 3.8704e+05, 3.9082e+05, 3.9287e+05,
        3.9751e+05, 3.9761e+05, 4.0697e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390693.8750, 390743.2188, 390752.6562, 390758.5000,
        390780.5625, 390796.5625, 390815.5312, 390824.3125, 756682.1250,
        761127.7500, 769713.1875, 772713.8750, 797580.8125, 800508.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 379512.0312, 379535.4688, 379548.9375, 379549.4688,
        379552.2500, 379552.4688, 379563.5625, 379573.1250, 761127.7500,
        764244.4375, 774204.4375, 774765.0000, 782075.1875, 812865.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.6468e+00, 3.7161e+00, 3.7819e+00, 3.7957e+00, 3.7963e+00,
        3.8525e+00, 4.1432e+00, 3.7955e+05, 3.8707e+05, 3.9074e+05, 3.9285e+05,
        3.9749e+05, 3.9759e+05, 4.0699e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 406870.2812, 406919.0625, 406948.3125, 406954.4062,
        406964.2500, 406968.4688, 406982.2812, 406990.0000, 799145.6250,
        800508.0000, 804326.8125, 810225.2500, 810368.8125, 812865.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.9213e+00, 4.1432e+00, 4.2038e+00, 4.2647e+00, 4.3625e+00,
        4.6171e+00, 4.7953e+00, 3.7956e+05, 3.8704e+05, 3.9075e+05, 3.9289e+05,
        3.9750e+05, 3.9761e+05, 4.0695e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387006.4375, 387029.6875, 387033.4062, 387038.0312,
        387040.8125, 387041.3750, 387069.0000, 387079.7812, 769713.1875,
        774204.4375, 774365.3750, 779745.0625, 780548.0625, 810368.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4261e+00, 3.7819e+00, 3.8943e+00, 3.9895e+00, 4.0120e+00,
        4.0423e+00, 4.2038e+00, 3.7955e+05, 3.8703e+05, 3.9069e+05, 3.9293e+05,
        3.9749e+05, 3.9761e+05, 4.0696e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397489.8438, 397494.2812, 397495.4375, 397501.4688,
        397505.4062, 397511.9375, 397516.3750, 397538.8125, 756682.1250,
        774765.0000, 780548.0625, 791802.3125, 798616.1875, 804326.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 392850.2188, 392857.6875, 392869.1250, 392869.9688,
        392877.1875, 392888.7500, 392915.2188, 392927.7188, 772713.8750,
        774365.3750, 782075.1875, 791802.3125, 799145.6250, 804213.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.6468e+00, 3.7071e+00, 3.7418e+00, 3.9895e+00, 4.1280e+00,
        4.1619e+00, 4.3625e+00, 3.7951e+05, 3.8701e+05, 3.9080e+05, 3.9292e+05,
        3.9750e+05, 3.9758e+05, 4.0695e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5423e+00, 3.7504e+00, 3.7957e+00, 3.9802e+00, 4.0423e+00,
        4.1619e+00, 4.6171e+00, 3.7954e+05, 3.8704e+05, 3.9078e+05, 3.9288e+05,
        3.9751e+05, 3.9760e+05, 4.0692e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.7161e+00, 3.7418e+00, 3.7504e+00, 3.7902e+00, 3.7954e+00,
        3.8943e+00, 4.2647e+00, 3.7955e+05, 3.8708e+05, 3.9082e+05, 3.9287e+05,
        3.9754e+05, 3.9758e+05, 4.0687e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['438335.19', '85178.76', '85182.46', '431427.47', '421946.12', '85182.74', '450526.97', '85181.33', '429561.28', '85178.91', '437415.09', '435085.53', '85171.80', '85178.30', '85184.34']
estimated f for each client, fs: [5, 7, 7, 5, 6, 7, 5, 7, 5, 7, 5, 5, 7, 7, 7]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']], selected_client_indices: [18, 7, 9, 19, 16, 11, 20, 8, 14, 5, 13, 15, 4, 1, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0099s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:52...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[126 111]
 [125 138]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:52, End: 2025-07-22 15:45:52)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [9, 3, 11, 2, 16, 14, 18, 10, 12, 20, 6, 13, 19, 8, 4, 5, 7, 1, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 4.1942e+00, 3.7757e+00, 3.8763e+00, 3.8852e+05, 3.9037e+05,
         3.9759e+05, 3.9464e+00, 4.2211e+00, 3.8974e+05, 4.3311e+00, 3.9946e+05,
         3.7691e+05, 4.8339e+00, 4.2543e+00, 4.0821e+00, 4.1927e+00, 3.6923e+00,
         3.9179e+05],
        [4.1942e+00, 0.0000e+00, 3.9514e+00, 3.8269e+00, 3.8849e+05, 3.9040e+05,
         3.9752e+05, 3.6484e+00, 3.6260e+00, 3.8968e+05, 3.6243e+00, 3.9936e+05,
         3.7689e+05, 4.3116e+00, 3.9545e+00, 3.5150e+00, 3.7603e+00, 3.9644e+00,
         3.9188e+05],
        [3.7757e+00, 3.9514e+00, 0.0000e+00, 3.6758e+00, 3.8851e+05, 3.9042e+05,
         3.9756e+05, 3.5808e+00, 3.9822e+00, 3.8968e+05, 3.8515e+00, 3.9944e+05,
         3.7696e+05, 4.1302e+00, 3.6521e+00, 3.7123e+00, 3.8809e+00, 3.8512e+00,
         3.9190e+05],
        [3.8763e+00, 3.8269e+00, 3.6758e+00, 0.0000e+00, 3.8856e+05, 3.9039e+05,
         3.9752e+05, 3.7988e+00, 3.9454e+00, 3.8975e+05, 3.9539e+00, 3.9935e+05,
         3.7695e+05, 4.2771e+00, 3.7561e+00, 3.8762e+00, 3.8880e+00, 3.8709e+00,
         3.9189e+05],
        [3.8852e+05, 3.8849e+05, 3.8851e+05, 3.8856e+05, 0.0000e+00, 7.6714e+05,
         7.8277e+05, 3.8854e+05, 3.8851e+05, 8.1547e+05, 3.8852e+05, 7.8692e+05,
         7.8115e+05, 3.8849e+05, 3.8854e+05, 3.8853e+05, 3.8850e+05, 3.8849e+05,
         7.7189e+05],
        [3.9037e+05, 3.9040e+05, 3.9042e+05, 3.9039e+05, 7.6714e+05, 0.0000e+00,
         7.8838e+05, 3.9041e+05, 3.9039e+05, 7.9103e+05, 3.9036e+05, 7.8831e+05,
         7.6007e+05, 3.9040e+05, 3.9038e+05, 3.9043e+05, 3.9040e+05, 3.9038e+05,
         7.8484e+05],
        [3.9759e+05, 3.9752e+05, 3.9756e+05, 3.9752e+05, 7.8277e+05, 7.8838e+05,
         0.0000e+00, 3.9755e+05, 3.9752e+05, 7.9714e+05, 3.9754e+05, 7.9615e+05,
         7.5098e+05, 3.9754e+05, 3.9754e+05, 3.9758e+05, 3.9752e+05, 3.9756e+05,
         7.7125e+05],
        [3.9464e+00, 3.6484e+00, 3.5808e+00, 3.7988e+00, 3.8854e+05, 3.9041e+05,
         3.9755e+05, 0.0000e+00, 3.5807e+00, 3.8970e+05, 3.6040e+00, 3.9941e+05,
         3.7696e+05, 3.9870e+00, 3.7801e+00, 3.6672e+00, 3.6937e+00, 3.9394e+00,
         3.9189e+05],
        [4.2211e+00, 3.6260e+00, 3.9822e+00, 3.9454e+00, 3.8851e+05, 3.9039e+05,
         3.9752e+05, 3.5807e+00, 0.0000e+00, 3.8978e+05, 3.5577e+00, 3.9937e+05,
         3.7695e+05, 3.6466e+00, 3.6602e+00, 3.4914e+00, 3.4877e+00, 4.2233e+00,
         3.9191e+05],
        [3.8974e+05, 3.8968e+05, 3.8968e+05, 3.8975e+05, 8.1547e+05, 7.9103e+05,
         7.9714e+05, 3.8970e+05, 3.8978e+05, 0.0000e+00, 3.8973e+05, 7.9781e+05,
         7.8125e+05, 3.8970e+05, 3.8970e+05, 3.8970e+05, 3.8971e+05, 3.8970e+05,
         7.5518e+05],
        [4.3311e+00, 3.6243e+00, 3.8515e+00, 3.9539e+00, 3.8852e+05, 3.9036e+05,
         3.9754e+05, 3.6040e+00, 3.5577e+00, 3.8973e+05, 0.0000e+00, 3.9938e+05,
         3.7701e+05, 3.7316e+00, 3.8955e+00, 3.5186e+00, 3.3740e+00, 3.8785e+00,
         3.9190e+05],
        [3.9946e+05, 3.9936e+05, 3.9944e+05, 3.9935e+05, 7.8692e+05, 7.8831e+05,
         7.9615e+05, 3.9941e+05, 3.9937e+05, 7.9781e+05, 3.9938e+05, 0.0000e+00,
         7.7653e+05, 3.9945e+05, 3.9941e+05, 3.9940e+05, 3.9941e+05, 3.9943e+05,
         8.0630e+05],
        [3.7691e+05, 3.7689e+05, 3.7696e+05, 3.7695e+05, 7.8115e+05, 7.6007e+05,
         7.5098e+05, 3.7696e+05, 3.7695e+05, 7.8125e+05, 3.7701e+05, 7.7653e+05,
         0.0000e+00, 3.7696e+05, 3.7694e+05, 3.7700e+05, 3.7697e+05, 3.7694e+05,
         7.8520e+05],
        [4.8339e+00, 4.3116e+00, 4.1302e+00, 4.2771e+00, 3.8849e+05, 3.9040e+05,
         3.9754e+05, 3.9870e+00, 3.6466e+00, 3.8970e+05, 3.7316e+00, 3.9945e+05,
         3.7696e+05, 0.0000e+00, 4.2444e+00, 4.1274e+00, 3.8979e+00, 4.5584e+00,
         3.9183e+05],
        [4.2543e+00, 3.9545e+00, 3.6521e+00, 3.7561e+00, 3.8854e+05, 3.9038e+05,
         3.9754e+05, 3.7801e+00, 3.6602e+00, 3.8970e+05, 3.8955e+00, 3.9941e+05,
         3.7694e+05, 4.2444e+00, 0.0000e+00, 3.9368e+00, 3.7555e+00, 4.2814e+00,
         3.9192e+05],
        [4.0821e+00, 3.5150e+00, 3.7123e+00, 3.8762e+00, 3.8853e+05, 3.9043e+05,
         3.9758e+05, 3.6672e+00, 3.4914e+00, 3.8970e+05, 3.5186e+00, 3.9940e+05,
         3.7700e+05, 4.1274e+00, 3.9368e+00, 0.0000e+00, 3.4084e+00, 4.0047e+00,
         3.9190e+05],
        [4.1927e+00, 3.7603e+00, 3.8809e+00, 3.8880e+00, 3.8850e+05, 3.9040e+05,
         3.9752e+05, 3.6937e+00, 3.4877e+00, 3.8971e+05, 3.3740e+00, 3.9941e+05,
         3.7697e+05, 3.8979e+00, 3.7555e+00, 3.4084e+00, 0.0000e+00, 4.1084e+00,
         3.9190e+05],
        [3.6923e+00, 3.9644e+00, 3.8512e+00, 3.8709e+00, 3.8849e+05, 3.9038e+05,
         3.9756e+05, 3.9394e+00, 4.2233e+00, 3.8970e+05, 3.8785e+00, 3.9943e+05,
         3.7694e+05, 4.5584e+00, 4.2814e+00, 4.0047e+00, 4.1084e+00, 0.0000e+00,
         3.9185e+05],
        [3.9179e+05, 3.9188e+05, 3.9190e+05, 3.9189e+05, 7.7189e+05, 7.8484e+05,
         7.7125e+05, 3.9189e+05, 3.9191e+05, 7.5518e+05, 3.9190e+05, 8.0630e+05,
         7.8520e+05, 3.9183e+05, 3.9192e+05, 3.9190e+05, 3.9190e+05, 3.9185e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.6923e+00, 3.7757e+00, 3.8763e+00, 3.9464e+00, 4.0821e+00,
        4.1927e+00, 4.1942e+00, 4.2211e+00, 4.2543e+00, 4.3311e+00, 4.8339e+00,
        3.7691e+05, 3.8852e+05, 3.8974e+05, 3.9037e+05, 3.9179e+05, 3.9759e+05,
        3.9946e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5150e+00, 3.6243e+00, 3.6260e+00, 3.6484e+00, 3.7603e+00,
        3.8269e+00, 3.9514e+00, 3.9545e+00, 3.9644e+00, 4.1942e+00, 4.3116e+00,
        3.7689e+05, 3.8849e+05, 3.8968e+05, 3.9040e+05, 3.9188e+05, 3.9752e+05,
        3.9936e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5808e+00, 3.6521e+00, 3.6758e+00, 3.7123e+00, 3.7757e+00,
        3.8512e+00, 3.8515e+00, 3.8809e+00, 3.9514e+00, 3.9822e+00, 4.1302e+00,
        3.7696e+05, 3.8851e+05, 3.8968e+05, 3.9042e+05, 3.9190e+05, 3.9756e+05,
        3.9944e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6758e+00, 3.7561e+00, 3.7988e+00, 3.8269e+00, 3.8709e+00,
        3.8762e+00, 3.8763e+00, 3.8880e+00, 3.9454e+00, 3.9539e+00, 4.2771e+00,
        3.7695e+05, 3.8856e+05, 3.8975e+05, 3.9039e+05, 3.9189e+05, 3.9752e+05,
        3.9935e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388488.7500, 388489.8750, 388493.2500, 388500.5000,
        388505.9062, 388508.1562, 388517.1562, 388521.1562, 388525.3438,
        388537.6875, 388544.3438, 388561.9375, 767141.0000, 771885.8750,
        781146.2500, 782773.0000, 786922.0000, 815469.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 390357.6875, 390370.1250, 390382.3750, 390384.0625,
        390387.0938, 390390.0312, 390396.7500, 390399.0000, 390404.8750,
        390412.1250, 390417.1562, 390433.9688, 760068.6250, 767141.0000,
        784842.8125, 788309.7500, 788383.1250, 791025.6250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 397519.2812, 397521.4062, 397522.3125, 397524.5312,
        397536.7500, 397537.0000, 397542.8750, 397551.9375, 397555.1562,
        397559.7500, 397575.1875, 397586.3750, 750984.3750, 771252.4375,
        782773.0000, 788383.1250, 796153.6875, 797140.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.5807e+00, 3.5808e+00, 3.6040e+00, 3.6484e+00, 3.6672e+00,
        3.6937e+00, 3.7801e+00, 3.7988e+00, 3.9394e+00, 3.9464e+00, 3.9870e+00,
        3.7696e+05, 3.8854e+05, 3.8970e+05, 3.9041e+05, 3.9189e+05, 3.9755e+05,
        3.9941e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4877e+00, 3.4914e+00, 3.5577e+00, 3.5807e+00, 3.6260e+00,
        3.6466e+00, 3.6602e+00, 3.9454e+00, 3.9822e+00, 4.2211e+00, 4.2233e+00,
        3.7695e+05, 3.8851e+05, 3.8978e+05, 3.9039e+05, 3.9191e+05, 3.9752e+05,
        3.9937e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 389677.4688, 389683.2812, 389696.0312, 389696.1250,
        389697.2812, 389699.5000, 389700.7500, 389709.1250, 389727.8438,
        389735.1875, 389746.3438, 389776.1875, 755178.4375, 781253.3750,
        791025.6250, 797140.7500, 797808.1875, 815469.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.3740e+00, 3.5186e+00, 3.5577e+00, 3.6040e+00, 3.6243e+00,
        3.7316e+00, 3.8515e+00, 3.8785e+00, 3.8955e+00, 3.9539e+00, 4.3311e+00,
        3.7701e+05, 3.8852e+05, 3.8973e+05, 3.9036e+05, 3.9190e+05, 3.9754e+05,
        3.9938e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 399348.1875, 399361.0625, 399370.7500, 399380.0938,
        399396.4062, 399406.5000, 399408.6875, 399408.7188, 399425.0938,
        399439.0625, 399450.5312, 399464.8125, 776527.5000, 786922.0000,
        788309.7500, 796153.6875, 797808.1875, 806299.6875])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 376891.0625, 376910.8750, 376936.9688, 376943.1875,
        376950.9062, 376954.0938, 376959.8125, 376962.8750, 376963.5625,
        376970.3750, 376999.6562, 377012.8750, 750984.3750, 760068.6250,
        776527.5000, 781146.2500, 781253.3750, 785198.1875])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.6466e+00, 3.7316e+00, 3.8979e+00, 3.9870e+00, 4.1274e+00,
        4.1302e+00, 4.2444e+00, 4.2771e+00, 4.3116e+00, 4.5584e+00, 4.8339e+00,
        3.7696e+05, 3.8849e+05, 3.8970e+05, 3.9040e+05, 3.9183e+05, 3.9754e+05,
        3.9945e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6521e+00, 3.6602e+00, 3.7555e+00, 3.7561e+00, 3.7801e+00,
        3.8955e+00, 3.9368e+00, 3.9545e+00, 4.2444e+00, 4.2543e+00, 4.2814e+00,
        3.7694e+05, 3.8854e+05, 3.8970e+05, 3.9038e+05, 3.9192e+05, 3.9754e+05,
        3.9941e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4084e+00, 3.4914e+00, 3.5150e+00, 3.5186e+00, 3.6672e+00,
        3.7123e+00, 3.8762e+00, 3.9368e+00, 4.0047e+00, 4.0821e+00, 4.1274e+00,
        3.7700e+05, 3.8853e+05, 3.8970e+05, 3.9043e+05, 3.9190e+05, 3.9758e+05,
        3.9940e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3740e+00, 3.4084e+00, 3.4877e+00, 3.6937e+00, 3.7555e+00,
        3.7603e+00, 3.8809e+00, 3.8880e+00, 3.8979e+00, 4.1084e+00, 4.1927e+00,
        3.7697e+05, 3.8850e+05, 3.8971e+05, 3.9040e+05, 3.9190e+05, 3.9752e+05,
        3.9941e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6923e+00, 3.8512e+00, 3.8709e+00, 3.8785e+00, 3.9394e+00,
        3.9644e+00, 4.0047e+00, 4.1084e+00, 4.2233e+00, 4.2814e+00, 4.5584e+00,
        3.7694e+05, 3.8849e+05, 3.8970e+05, 3.9038e+05, 3.9185e+05, 3.9756e+05,
        3.9943e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391794.2188, 391828.1250, 391852.9062, 391880.8125,
        391888.8125, 391894.2500, 391895.1875, 391899.8125, 391901.4688,
        391902.6875, 391905.7188, 391920.3438, 755178.4375, 771252.4375,
        771885.8750, 784842.8125, 785198.1875, 806299.6875])
Index of maximum distance difference after half of values: 12
adaptive_Krum scores:  ['4.13', '3.85', '3.82', '3.89', '388516.19', '390394.62', '397544.41', '3.75', '3.77', '389712.12', '3.76', '399405.00', '376954.66', '4.16', '3.92', '3.76', '3.77', '4.03', '391880.44']
estimated f for each client, fs: [7, 7, 7, 7, 5, 5, 5, 7, 7, 5, 7, 5, 5, 7, 7, 7, 7, 7, 5]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [9, 3, 11, 2, 16, 14, 18, 10, 12, 20, 6, 13, 19, 8, 4, 5, 7, 1, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0146s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:53...
global Accuracy on shared test data: 53.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[127 110]
 [124 139]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:53, End: 2025-07-22 15:45:53)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [16, 8, 4, 9, 19, 14, 7, 11, 10, 3, 15, 2, 13, 1, 18, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.7695e+05, 3.7693e+05, 3.7699e+05, 7.6243e+05, 7.5498e+05,
         3.7692e+05, 3.7699e+05, 3.7692e+05, 3.7694e+05, 7.6240e+05, 3.7694e+05,
         7.7184e+05, 3.7694e+05, 7.8009e+05, 3.7692e+05, 3.7691e+05],
        [3.7695e+05, 0.0000e+00, 4.1774e+00, 4.7361e+00, 3.9697e+05, 3.8746e+05,
         3.8859e+00, 4.0599e+00, 3.8937e+00, 4.2058e+00, 4.0450e+05, 4.0681e+00,
         3.9034e+05, 4.4066e+00, 4.0286e+05, 3.6555e+00, 3.5710e+00],
        [3.7693e+05, 4.1774e+00, 0.0000e+00, 4.2495e+00, 3.9696e+05, 3.8746e+05,
         3.8414e+00, 3.6944e+00, 3.7575e+00, 3.9957e+00, 4.0447e+05, 3.7030e+00,
         3.9036e+05, 4.1635e+00, 4.0290e+05, 3.8717e+00, 3.6515e+00],
        [3.7699e+05, 4.7361e+00, 4.2495e+00, 0.0000e+00, 3.9701e+05, 3.8740e+05,
         4.3574e+00, 3.8247e+00, 3.9665e+00, 4.2548e+00, 4.0447e+05, 3.9709e+00,
         3.9026e+05, 3.6880e+00, 4.0288e+05, 4.4297e+00, 4.3615e+00],
        [7.6243e+05, 3.9697e+05, 3.9696e+05, 3.9701e+05, 0.0000e+00, 7.8613e+05,
         3.9700e+05, 3.9696e+05, 3.9698e+05, 3.9702e+05, 8.0678e+05, 3.9699e+05,
         7.7519e+05, 3.9699e+05, 8.2480e+05, 3.9697e+05, 3.9697e+05],
        [7.5498e+05, 3.8746e+05, 3.8746e+05, 3.8740e+05, 7.8613e+05, 0.0000e+00,
         3.8739e+05, 3.8747e+05, 3.8743e+05, 3.8742e+05, 7.8770e+05, 3.8740e+05,
         7.8108e+05, 3.8744e+05, 7.8945e+05, 3.8742e+05, 3.8743e+05],
        [3.7692e+05, 3.8859e+00, 3.8414e+00, 4.3574e+00, 3.9700e+05, 3.8739e+05,
         0.0000e+00, 4.1266e+00, 3.8444e+00, 3.7375e+00, 4.0445e+05, 3.9214e+00,
         3.9030e+05, 4.1265e+00, 4.0291e+05, 3.4469e+00, 3.5572e+00],
        [3.7699e+05, 4.0599e+00, 3.6944e+00, 3.8247e+00, 3.9696e+05, 3.8747e+05,
         4.1266e+00, 0.0000e+00, 3.6485e+00, 4.0661e+00, 4.0452e+05, 3.7502e+00,
         3.9036e+05, 3.8823e+00, 4.0290e+05, 3.9553e+00, 4.0012e+00],
        [3.7692e+05, 3.8937e+00, 3.7575e+00, 3.9665e+00, 3.9698e+05, 3.8743e+05,
         3.8444e+00, 3.6485e+00, 0.0000e+00, 3.6554e+00, 4.0453e+05, 3.7807e+00,
         3.9037e+05, 3.8695e+00, 4.0294e+05, 3.6575e+00, 3.6562e+00],
        [3.7694e+05, 4.2058e+00, 3.9957e+00, 4.2548e+00, 3.9702e+05, 3.8742e+05,
         3.7375e+00, 4.0661e+00, 3.6554e+00, 0.0000e+00, 4.0455e+05, 3.8763e+00,
         3.9030e+05, 3.9095e+00, 4.0292e+05, 3.5938e+00, 3.6224e+00],
        [7.6240e+05, 4.0450e+05, 4.0447e+05, 4.0447e+05, 8.0678e+05, 7.8770e+05,
         4.0445e+05, 4.0452e+05, 4.0453e+05, 4.0455e+05, 0.0000e+00, 4.0447e+05,
         7.9768e+05, 4.0448e+05, 7.8450e+05, 4.0456e+05, 4.0450e+05],
        [3.7694e+05, 4.0681e+00, 3.7030e+00, 3.9709e+00, 3.9699e+05, 3.8740e+05,
         3.9214e+00, 3.7502e+00, 3.7807e+00, 3.8763e+00, 4.0447e+05, 0.0000e+00,
         3.9030e+05, 3.8551e+00, 4.0291e+05, 3.9921e+00, 3.8972e+00],
        [7.7184e+05, 3.9034e+05, 3.9036e+05, 3.9026e+05, 7.7519e+05, 7.8108e+05,
         3.9030e+05, 3.9036e+05, 3.9037e+05, 3.9030e+05, 7.9768e+05, 3.9030e+05,
         0.0000e+00, 3.9027e+05, 7.8639e+05, 3.9034e+05, 3.9034e+05],
        [3.7694e+05, 4.4066e+00, 4.1635e+00, 3.6880e+00, 3.9699e+05, 3.8744e+05,
         4.1265e+00, 3.8823e+00, 3.8695e+00, 3.9095e+00, 4.0448e+05, 3.8551e+00,
         3.9027e+05, 0.0000e+00, 4.0291e+05, 3.8189e+00, 4.1618e+00],
        [7.8009e+05, 4.0286e+05, 4.0290e+05, 4.0288e+05, 8.2480e+05, 7.8945e+05,
         4.0291e+05, 4.0290e+05, 4.0294e+05, 4.0292e+05, 7.8450e+05, 4.0291e+05,
         7.8639e+05, 4.0291e+05, 0.0000e+00, 4.0291e+05, 4.0291e+05],
        [3.7692e+05, 3.6555e+00, 3.8717e+00, 4.4297e+00, 3.9697e+05, 3.8742e+05,
         3.4469e+00, 3.9553e+00, 3.6575e+00, 3.5938e+00, 4.0456e+05, 3.9921e+00,
         3.9034e+05, 3.8189e+00, 4.0291e+05, 0.0000e+00, 3.5237e+00],
        [3.7691e+05, 3.5710e+00, 3.6515e+00, 4.3615e+00, 3.9697e+05, 3.8743e+05,
         3.5572e+00, 4.0012e+00, 3.6562e+00, 3.6224e+00, 4.0450e+05, 3.8972e+00,
         3.9034e+05, 4.1618e+00, 4.0291e+05, 3.5237e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 376913.8750, 376916.0938, 376922.1562, 376922.2812,
        376930.4375, 376936.8125, 376942.0938, 376943.4062, 376946.0625,
        376985.9688, 376992.4688, 754975.8750, 762400.2500, 762433.3125,
        771843.1250, 780085.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5710e+00, 3.6555e+00, 3.8859e+00, 3.8937e+00, 4.0599e+00,
        4.0681e+00, 4.1774e+00, 4.2058e+00, 4.4066e+00, 4.7361e+00, 3.7695e+05,
        3.8746e+05, 3.9034e+05, 3.9697e+05, 4.0286e+05, 4.0450e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6515e+00, 3.6944e+00, 3.7030e+00, 3.7575e+00, 3.8414e+00,
        3.8717e+00, 3.9957e+00, 4.1635e+00, 4.1774e+00, 4.2495e+00, 3.7693e+05,
        3.8746e+05, 3.9036e+05, 3.9696e+05, 4.0290e+05, 4.0447e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6880e+00, 3.8247e+00, 3.9665e+00, 3.9709e+00, 4.2495e+00,
        4.2548e+00, 4.3574e+00, 4.3615e+00, 4.4297e+00, 4.7361e+00, 3.7699e+05,
        3.8740e+05, 3.9026e+05, 3.9701e+05, 4.0288e+05, 4.0447e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396958.9062, 396961.3438, 396965.7188, 396969.4688,
        396971.7500, 396980.5312, 396985.8750, 396992.1562, 397000.1250,
        397006.8125, 397017.5625, 762433.3125, 775192.5000, 786132.0000,
        806779.5000, 824804.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387394.5000, 387399.7188, 387403.7812, 387415.8750,
        387419.0312, 387430.8438, 387434.7188, 387441.4062, 387456.4375,
        387458.8438, 387467.4375, 754975.8750, 781080.5000, 786132.0000,
        787704.8750, 789450.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4469e+00, 3.5572e+00, 3.7375e+00, 3.8414e+00, 3.8444e+00,
        3.8859e+00, 3.9214e+00, 4.1265e+00, 4.1266e+00, 4.3574e+00, 3.7692e+05,
        3.8739e+05, 3.9030e+05, 3.9700e+05, 4.0291e+05, 4.0445e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6485e+00, 3.6944e+00, 3.7502e+00, 3.8247e+00, 3.8823e+00,
        3.9553e+00, 4.0012e+00, 4.0599e+00, 4.0661e+00, 4.1266e+00, 3.7699e+05,
        3.8747e+05, 3.9036e+05, 3.9696e+05, 4.0290e+05, 4.0452e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6485e+00, 3.6554e+00, 3.6562e+00, 3.6575e+00, 3.7575e+00,
        3.7807e+00, 3.8444e+00, 3.8695e+00, 3.8937e+00, 3.9665e+00, 3.7692e+05,
        3.8743e+05, 3.9037e+05, 3.9698e+05, 4.0294e+05, 4.0453e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5938e+00, 3.6224e+00, 3.6554e+00, 3.7375e+00, 3.8763e+00,
        3.9095e+00, 3.9957e+00, 4.0661e+00, 4.2058e+00, 4.2548e+00, 3.7694e+05,
        3.8742e+05, 3.9030e+05, 3.9702e+05, 4.0292e+05, 4.0455e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404450.8438, 404465.2500, 404474.2188, 404474.6562,
        404475.3125, 404499.7500, 404501.7812, 404521.4062, 404532.1875,
        404554.7500, 404555.9375, 762400.2500, 784503.6250, 787704.8750,
        797675.6875, 806779.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.7030e+00, 3.7502e+00, 3.7807e+00, 3.8551e+00, 3.8763e+00,
        3.8972e+00, 3.9214e+00, 3.9709e+00, 3.9921e+00, 4.0681e+00, 3.7694e+05,
        3.8740e+05, 3.9030e+05, 3.9699e+05, 4.0291e+05, 4.0447e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390260.1875, 390272.4062, 390299.3438, 390301.2812,
        390304.7812, 390335.5625, 390341.7812, 390341.8125, 390355.5312,
        390364.4062, 390372.1562, 771843.1250, 775192.5000, 781080.5000,
        786389.7500, 797675.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6880e+00, 3.8189e+00, 3.8551e+00, 3.8695e+00, 3.8823e+00,
        3.9095e+00, 4.1265e+00, 4.1618e+00, 4.1635e+00, 4.4066e+00, 3.7694e+05,
        3.8744e+05, 3.9027e+05, 3.9699e+05, 4.0291e+05, 4.0448e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402860.6875, 402882.9375, 402897.4062, 402902.7812,
        402907.6875, 402909.6875, 402910.7812, 402910.8438, 402912.8125,
        402915.5625, 402939.7188, 780085.1250, 784503.6250, 786389.7500,
        789450.0000, 824804.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4469e+00, 3.5237e+00, 3.5938e+00, 3.6555e+00, 3.6575e+00,
        3.8189e+00, 3.8717e+00, 3.9553e+00, 3.9921e+00, 4.4297e+00, 3.7692e+05,
        3.8742e+05, 3.9034e+05, 3.9697e+05, 4.0291e+05, 4.0456e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5237e+00, 3.5572e+00, 3.5710e+00, 3.6224e+00, 3.6515e+00,
        3.6562e+00, 3.8972e+00, 4.0012e+00, 4.1618e+00, 4.3615e+00, 3.7691e+05,
        3.8743e+05, 3.9034e+05, 3.9697e+05, 4.0291e+05, 4.0450e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['376935.91', '4.07', '3.91', '4.18', '396982.72', '387429.34', '3.88', '3.90', '3.77', '3.89', '404500.53', '3.88', '390322.69', '3.99', '402904.62', '3.79', '3.80']
estimated f for each client, fs: [6, 6, 6, 6, 4, 4, 6, 6, 6, 6, 4, 6, 4, 6, 4, 6, 6]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [16, 8, 4, 9, 19, 14, 7, 11, 10, 3, 15, 2, 13, 1, 18, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0126s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:54...
global Accuracy on shared test data: 53.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[131 106]
 [128 135]]
Function 'evaluate_global_model' executed in 0.0046 seconds (Start: 2025-07-22 15:45:54, End: 2025-07-22 15:45:54)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [13], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
rkrum, clients_type: ['Chosen Update'], selected_client_indices: [13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0000s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:54...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [169  94]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:54, End: 2025-07-22 15:45:54)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [6, 16, 3, 20, 10, 19, 11, 7, 13, 12, 8, 1, 18, 15, 4, 2, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.8501e+05, 3.6694e+00, 3.9766e+05, 3.8278e+00, 3.8615e+05,
         3.6796e+00, 3.8933e+00, 3.8257e+05, 3.5590e+00, 3.6705e+00, 3.6911e+00,
         3.8081e+05, 3.9795e+05, 3.7691e+00, 3.7162e+00, 3.8811e+05],
        [3.8501e+05, 0.0000e+00, 3.8512e+05, 7.9717e+05, 3.8502e+05, 7.5641e+05,
         3.8498e+05, 3.8499e+05, 7.7068e+05, 3.8493e+05, 3.8494e+05, 3.8496e+05,
         7.6476e+05, 8.1172e+05, 3.8505e+05, 3.8500e+05, 7.6444e+05],
        [3.6694e+00, 3.8512e+05, 0.0000e+00, 3.9760e+05, 3.6462e+00, 3.8613e+05,
         3.8270e+00, 3.5384e+00, 3.8255e+05, 3.7601e+00, 3.8302e+00, 3.6773e+00,
         3.8080e+05, 3.9792e+05, 3.5215e+00, 3.6460e+00, 3.8809e+05],
        [3.9766e+05, 7.9717e+05, 3.9760e+05, 0.0000e+00, 3.9761e+05, 7.7626e+05,
         3.9764e+05, 3.9758e+05, 7.6674e+05, 3.9766e+05, 3.9760e+05, 3.9764e+05,
         7.9523e+05, 7.8490e+05, 3.9760e+05, 3.9764e+05, 7.9918e+05],
        [3.8278e+00, 3.8502e+05, 3.6462e+00, 3.9761e+05, 0.0000e+00, 3.8611e+05,
         3.4506e+00, 3.7882e+00, 3.8256e+05, 3.6111e+00, 3.5506e+00, 3.7716e+00,
         3.8084e+05, 3.9797e+05, 3.2838e+00, 3.8569e+00, 3.8812e+05],
        [3.8615e+05, 7.5641e+05, 3.8613e+05, 7.7626e+05, 3.8611e+05, 0.0000e+00,
         3.8615e+05, 3.8612e+05, 7.5903e+05, 3.8613e+05, 3.8613e+05, 3.8617e+05,
         7.5289e+05, 7.9589e+05, 3.8619e+05, 3.8617e+05, 7.7459e+05],
        [3.6796e+00, 3.8498e+05, 3.8270e+00, 3.9764e+05, 3.4506e+00, 3.8615e+05,
         0.0000e+00, 3.8453e+00, 3.8259e+05, 3.7972e+00, 3.7511e+00, 3.6621e+00,
         3.8081e+05, 3.9793e+05, 3.2730e+00, 3.6847e+00, 3.8809e+05],
        [3.8933e+00, 3.8499e+05, 3.5384e+00, 3.9758e+05, 3.7882e+00, 3.8612e+05,
         3.8453e+00, 0.0000e+00, 3.8260e+05, 3.8842e+00, 3.8630e+00, 3.8799e+00,
         3.8080e+05, 3.9791e+05, 3.3768e+00, 3.8413e+00, 3.8808e+05],
        [3.8257e+05, 7.7068e+05, 3.8255e+05, 7.6674e+05, 3.8256e+05, 7.5903e+05,
         3.8259e+05, 3.8260e+05, 0.0000e+00, 3.8260e+05, 3.8257e+05, 3.8261e+05,
         7.4970e+05, 7.9612e+05, 3.8262e+05, 3.8257e+05, 7.7207e+05],
        [3.5590e+00, 3.8493e+05, 3.7601e+00, 3.9766e+05, 3.6111e+00, 3.8613e+05,
         3.7972e+00, 3.8842e+00, 3.8260e+05, 0.0000e+00, 3.5132e+00, 3.9743e+00,
         3.8082e+05, 3.9789e+05, 3.6946e+00, 3.8482e+00, 3.8814e+05],
        [3.6705e+00, 3.8494e+05, 3.8302e+00, 3.9760e+05, 3.5506e+00, 3.8613e+05,
         3.7511e+00, 3.8630e+00, 3.8257e+05, 3.5132e+00, 0.0000e+00, 4.0117e+00,
         3.8083e+05, 3.9792e+05, 3.3760e+00, 3.6381e+00, 3.8808e+05],
        [3.6911e+00, 3.8496e+05, 3.6773e+00, 3.9764e+05, 3.7716e+00, 3.8617e+05,
         3.6621e+00, 3.8799e+00, 3.8261e+05, 3.9743e+00, 4.0117e+00, 0.0000e+00,
         3.8080e+05, 3.9792e+05, 3.4857e+00, 3.6387e+00, 3.8811e+05],
        [3.8081e+05, 7.6476e+05, 3.8080e+05, 7.9523e+05, 3.8084e+05, 7.5289e+05,
         3.8081e+05, 3.8080e+05, 7.4970e+05, 3.8082e+05, 3.8083e+05, 3.8080e+05,
         0.0000e+00, 7.7592e+05, 3.8076e+05, 3.8083e+05, 7.7455e+05],
        [3.9795e+05, 8.1172e+05, 3.9792e+05, 7.8490e+05, 3.9797e+05, 7.9589e+05,
         3.9793e+05, 3.9791e+05, 7.9612e+05, 3.9789e+05, 3.9792e+05, 3.9792e+05,
         7.7592e+05, 0.0000e+00, 3.9791e+05, 3.9789e+05, 7.7529e+05],
        [3.7691e+00, 3.8505e+05, 3.5215e+00, 3.9760e+05, 3.2838e+00, 3.8619e+05,
         3.2730e+00, 3.3768e+00, 3.8262e+05, 3.6946e+00, 3.3760e+00, 3.4857e+00,
         3.8076e+05, 3.9791e+05, 0.0000e+00, 3.4417e+00, 3.8812e+05],
        [3.7162e+00, 3.8500e+05, 3.6460e+00, 3.9764e+05, 3.8569e+00, 3.8617e+05,
         3.6847e+00, 3.8413e+00, 3.8257e+05, 3.8482e+00, 3.6381e+00, 3.6387e+00,
         3.8083e+05, 3.9789e+05, 3.4417e+00, 0.0000e+00, 3.8811e+05],
        [3.8811e+05, 7.6444e+05, 3.8809e+05, 7.9918e+05, 3.8812e+05, 7.7459e+05,
         3.8809e+05, 3.8808e+05, 7.7207e+05, 3.8814e+05, 3.8808e+05, 3.8811e+05,
         7.7455e+05, 7.7529e+05, 3.8812e+05, 3.8811e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.5590e+00, 3.6694e+00, 3.6705e+00, 3.6796e+00, 3.6911e+00,
        3.7162e+00, 3.7691e+00, 3.8278e+00, 3.8933e+00, 3.8081e+05, 3.8257e+05,
        3.8501e+05, 3.8615e+05, 3.8811e+05, 3.9766e+05, 3.9795e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384931.3125, 384938.8125, 384961.1250, 384980.0938,
        384990.9375, 385000.8125, 385009.3125, 385024.0938, 385054.3125,
        385116.6875, 756413.6250, 764438.0000, 764757.6875, 770680.2500,
        797174.9375, 811716.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5215e+00, 3.5384e+00, 3.6460e+00, 3.6462e+00, 3.6694e+00,
        3.6773e+00, 3.7601e+00, 3.8270e+00, 3.8302e+00, 3.8080e+05, 3.8255e+05,
        3.8512e+05, 3.8613e+05, 3.8809e+05, 3.9760e+05, 3.9792e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397582.5312, 397602.5000, 397602.9375, 397604.4375,
        397609.8750, 397637.5625, 397638.3438, 397642.4375, 397657.3750,
        397658.8438, 766744.8750, 776263.8750, 784898.3125, 795225.7500,
        797174.9375, 799176.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2838e+00, 3.4506e+00, 3.5506e+00, 3.6111e+00, 3.6462e+00,
        3.7716e+00, 3.7882e+00, 3.8278e+00, 3.8569e+00, 3.8084e+05, 3.8256e+05,
        3.8502e+05, 3.8611e+05, 3.8812e+05, 3.9761e+05, 3.9797e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386111.8750, 386119.9062, 386126.5938, 386131.2812,
        386133.6250, 386147.0625, 386149.1875, 386171.8750, 386172.5312,
        386187.4062, 752886.1875, 756413.6250, 759033.3750, 774587.2500,
        776263.8750, 795887.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2730e+00, 3.4506e+00, 3.6621e+00, 3.6796e+00, 3.6847e+00,
        3.7511e+00, 3.7972e+00, 3.8270e+00, 3.8453e+00, 3.8081e+05, 3.8259e+05,
        3.8498e+05, 3.8615e+05, 3.8809e+05, 3.9764e+05, 3.9793e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3768e+00, 3.5384e+00, 3.7882e+00, 3.8413e+00, 3.8453e+00,
        3.8630e+00, 3.8799e+00, 3.8842e+00, 3.8933e+00, 3.8080e+05, 3.8260e+05,
        3.8499e+05, 3.8612e+05, 3.8808e+05, 3.9758e+05, 3.9791e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382547.0312, 382559.9062, 382566.7812, 382569.9375,
        382572.0000, 382593.3750, 382595.7188, 382602.8125, 382610.1250,
        382621.9688, 749697.3125, 759033.3750, 766744.8750, 770680.2500,
        772067.8750, 796123.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5132e+00, 3.5590e+00, 3.6111e+00, 3.6946e+00, 3.7601e+00,
        3.7972e+00, 3.8482e+00, 3.8842e+00, 3.9743e+00, 3.8082e+05, 3.8260e+05,
        3.8493e+05, 3.8613e+05, 3.8814e+05, 3.9766e+05, 3.9789e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3760e+00, 3.5132e+00, 3.5506e+00, 3.6381e+00, 3.6705e+00,
        3.7511e+00, 3.8302e+00, 3.8630e+00, 4.0117e+00, 3.8083e+05, 3.8257e+05,
        3.8494e+05, 3.8613e+05, 3.8808e+05, 3.9760e+05, 3.9792e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4857e+00, 3.6387e+00, 3.6621e+00, 3.6773e+00, 3.6911e+00,
        3.7716e+00, 3.8799e+00, 3.9743e+00, 4.0117e+00, 3.8080e+05, 3.8261e+05,
        3.8496e+05, 3.8617e+05, 3.8811e+05, 3.9764e+05, 3.9792e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380764.1250, 380796.3750, 380798.2500, 380803.4375,
        380809.0000, 380809.0938, 380816.5000, 380831.0000, 380832.5000,
        380841.1875, 749697.3125, 752886.1875, 764757.6875, 774549.4375,
        775924.6875, 795225.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397889.2500, 397889.8125, 397907.9062, 397908.0312,
        397916.1250, 397919.0625, 397924.7812, 397929.8438, 397947.3750,
        397970.7500, 775289.5000, 775924.6875, 784898.3125, 795887.7500,
        796123.6875, 811716.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2730e+00, 3.2838e+00, 3.3760e+00, 3.3768e+00, 3.4417e+00,
        3.4857e+00, 3.5215e+00, 3.6946e+00, 3.7691e+00, 3.8076e+05, 3.8262e+05,
        3.8505e+05, 3.8619e+05, 3.8812e+05, 3.9760e+05, 3.9791e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4417e+00, 3.6381e+00, 3.6387e+00, 3.6460e+00, 3.6847e+00,
        3.7162e+00, 3.8413e+00, 3.8482e+00, 3.8569e+00, 3.8083e+05, 3.8257e+05,
        3.8500e+05, 3.8617e+05, 3.8811e+05, 3.9764e+05, 3.9789e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388084.5625, 388084.8125, 388085.9375, 388087.0312,
        388105.3438, 388111.7188, 388112.3438, 388116.4375, 388120.8750,
        388136.0625, 764438.0000, 772067.8750, 774549.4375, 774587.2500,
        775289.5000, 799176.5625])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38084.25', '385000.75', '38082.95', '397623.66', '38087.40', '386145.09', '38084.21', '38083.74', '382583.94', '38085.01', '38086.42', '38083.21', '380810.16', '397920.28', '38079.54', '38086.59', '388104.50']
estimated f for each client, fs: [7, 5, 7, 5, 7, 5, 7, 7, 5, 7, 7, 7, 5, 5, 7, 7, 5]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']], selected_client_indices: [6, 16, 3, 20, 10, 19, 11, 7, 13, 12, 8, 1, 18, 15, 4, 2, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0120s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:54...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [166  97]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:54, End: 2025-07-22 15:45:54)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [5, 17, 14, 4, 3, 19, 1, 2, 8, 18], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.7998e+05, 3.8766e+05, 3.3773e+00, 3.5216e+00, 3.8194e+05,
         3.3716e+00, 3.6324e+00, 3.8914e+00, 3.9346e+05],
        [3.7998e+05, 0.0000e+00, 7.6202e+05, 3.7995e+05, 3.7995e+05, 7.5284e+05,
         3.7996e+05, 3.7999e+05, 3.8000e+05, 7.7059e+05],
        [3.8766e+05, 7.6202e+05, 0.0000e+00, 3.8765e+05, 3.8767e+05, 7.5960e+05,
         3.8771e+05, 3.8764e+05, 3.8764e+05, 7.6250e+05],
        [3.3773e+00, 3.7995e+05, 3.8765e+05, 0.0000e+00, 3.5799e+00, 3.8190e+05,
         3.5303e+00, 3.3845e+00, 3.4687e+00, 3.9348e+05],
        [3.5216e+00, 3.7995e+05, 3.8767e+05, 3.5799e+00, 0.0000e+00, 3.8191e+05,
         3.7026e+00, 3.6376e+00, 3.9043e+00, 3.9345e+05],
        [3.8194e+05, 7.5284e+05, 7.5960e+05, 3.8190e+05, 3.8191e+05, 0.0000e+00,
         3.8195e+05, 3.8195e+05, 3.8193e+05, 7.9002e+05],
        [3.3716e+00, 3.7996e+05, 3.8771e+05, 3.5303e+00, 3.7026e+00, 3.8195e+05,
         0.0000e+00, 3.6690e+00, 4.0863e+00, 3.9347e+05],
        [3.6324e+00, 3.7999e+05, 3.8764e+05, 3.3845e+00, 3.6376e+00, 3.8195e+05,
         3.6690e+00, 0.0000e+00, 3.6925e+00, 3.9346e+05],
        [3.8914e+00, 3.8000e+05, 3.8764e+05, 3.4687e+00, 3.9043e+00, 3.8193e+05,
         4.0863e+00, 3.6925e+00, 0.0000e+00, 3.9348e+05],
        [3.9346e+05, 7.7059e+05, 7.6250e+05, 3.9348e+05, 3.9345e+05, 7.9002e+05,
         3.9347e+05, 3.9346e+05, 3.9348e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.3716e+00, 3.3773e+00, 3.5216e+00, 3.6324e+00, 3.8914e+00,
        3.7998e+05, 3.8194e+05, 3.8766e+05, 3.9346e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 379953.2812, 379953.3438, 379961.8125, 379983.7812,
        379993.5000, 379995.5938, 752844.5000, 762024.0625, 770587.7500])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 387639.3750, 387640.8125, 387654.8750, 387657.2500,
        387671.9375, 387710.9688, 759595.1250, 762024.0625, 762502.6250])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.3773e+00, 3.3845e+00, 3.4687e+00, 3.5303e+00, 3.5799e+00,
        3.7995e+05, 3.8190e+05, 3.8765e+05, 3.9348e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.5216e+00, 3.5799e+00, 3.6376e+00, 3.7026e+00, 3.9043e+00,
        3.7995e+05, 3.8191e+05, 3.8767e+05, 3.9345e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 381896.8750, 381913.8125, 381929.0312, 381939.1562,
        381946.9375, 381950.6875, 752844.5000, 759595.1250, 790022.5000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.3716e+00, 3.5303e+00, 3.6690e+00, 3.7026e+00, 4.0863e+00,
        3.7996e+05, 3.8195e+05, 3.8771e+05, 3.9347e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.3845e+00, 3.6324e+00, 3.6376e+00, 3.6690e+00, 3.6925e+00,
        3.7999e+05, 3.8195e+05, 3.8764e+05, 3.9346e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.4687e+00, 3.6925e+00, 3.8914e+00, 3.9043e+00, 4.0863e+00,
        3.8000e+05, 3.8193e+05, 3.8764e+05, 3.9348e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 393452.3125, 393460.9062, 393464.4062, 393469.7500,
        393477.8438, 393479.5625, 762502.6250, 770587.7500, 790022.5000])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['108848.66', '433240.81', '440795.72', '108838.20', '108840.77', '434917.25', '108846.72', '108851.73', '108849.09', '446186.75']
estimated f for each client, fs: [4, 2, 2, 4, 4, 2, 4, 4, 4, 2]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [5, 17, 14, 4, 3, 19, 1, 2, 8, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0061s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:55...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [162 101]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:55, End: 2025-07-22 15:45:55)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [17, 18, 4, 8, 14], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
tensor([[0.0000e+00, 7.6324e+05, 3.8663e+05, 3.8662e+05, 7.9193e+05],
        [7.6324e+05, 0.0000e+00, 3.8832e+05, 3.8830e+05, 7.8509e+05],
        [3.8663e+05, 3.8832e+05, 0.0000e+00, 3.5493e+00, 4.0617e+05],
        [3.8662e+05, 3.8830e+05, 3.5493e+00, 0.0000e+00, 4.0614e+05],
        [7.9193e+05, 7.8509e+05, 4.0617e+05, 4.0614e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 386619.0625, 386630.8750, 763237.1875, 791929.4375])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([     0.0000, 388300.0000, 388316.0625, 763237.1875, 785086.5000])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 3.5493e+00, 3.8663e+05, 3.8832e+05, 4.0617e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 3.5493e+00, 3.8662e+05, 3.8830e+05, 4.0614e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([     0.0000, 406137.8750, 406173.2500, 785086.5000, 791929.4375])
Index of maximum distance difference after half of values: 4
adaptive_Krum scores:  ['582104.12', '581234.94', '295280.94', '295265.12', '597331.69']
estimated f for each client, fs: [1, 1, 0, 0, 0]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']], selected_client_indices: [17, 18, 4, 8, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0304s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:55...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[158  79]
 [162 101]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:55, End: 2025-07-22 15:45:55)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [17, 14, 15, 9, 16, 10, 2, 7, 19, 8, 4, 5, 18, 13, 6, 11, 1, 12, 3, 20], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 7.9960e+05, 8.0969e+05, 3.9040e+05, 7.9291e+05, 3.9039e+05,
         3.9038e+05, 3.9037e+05, 8.1781e+05, 3.9042e+05, 3.9036e+05, 3.9041e+05,
         7.6918e+05, 8.0785e+05, 3.9033e+05, 3.9040e+05, 3.9040e+05, 3.9041e+05,
         3.9044e+05, 7.7307e+05],
        [7.9960e+05, 0.0000e+00, 8.0968e+05, 4.0339e+05, 8.0037e+05, 4.0341e+05,
         4.0342e+05, 4.0343e+05, 8.0822e+05, 4.0338e+05, 4.0343e+05, 4.0343e+05,
         7.8012e+05, 8.0763e+05, 4.0349e+05, 4.0342e+05, 4.0341e+05, 4.0339e+05,
         4.0345e+05, 7.6739e+05],
        [8.0969e+05, 8.0968e+05, 0.0000e+00, 3.9945e+05, 7.9508e+05, 3.9947e+05,
         3.9947e+05, 3.9945e+05, 7.8704e+05, 3.9945e+05, 3.9948e+05, 3.9949e+05,
         7.8866e+05, 7.9274e+05, 3.9943e+05, 3.9946e+05, 3.9946e+05, 3.9946e+05,
         3.9950e+05, 7.5604e+05],
        [3.9040e+05, 4.0339e+05, 3.9945e+05, 0.0000e+00, 3.9850e+05, 3.9145e+00,
         3.9346e+00, 4.1794e+00, 4.0148e+05, 3.8385e+00, 3.5548e+00, 3.6486e+00,
         3.9325e+05, 4.0038e+05, 3.8946e+00, 3.7733e+00, 3.3247e+00, 4.1272e+00,
         3.8374e+00, 3.7448e+05],
        [7.9291e+05, 8.0037e+05, 7.9508e+05, 3.9850e+05, 0.0000e+00, 3.9855e+05,
         3.9848e+05, 3.9851e+05, 7.9011e+05, 3.9847e+05, 3.9854e+05, 3.9850e+05,
         8.0104e+05, 7.8730e+05, 3.9853e+05, 3.9855e+05, 3.9846e+05, 3.9855e+05,
         3.9849e+05, 7.7837e+05],
        [3.9039e+05, 4.0341e+05, 3.9947e+05, 3.9145e+00, 3.9855e+05, 0.0000e+00,
         3.8160e+00, 3.9765e+00, 4.0147e+05, 3.7644e+00, 3.3538e+00, 3.5930e+00,
         3.9322e+05, 4.0034e+05, 3.7741e+00, 3.4604e+00, 4.0153e+00, 3.6222e+00,
         3.7543e+00, 3.7440e+05],
        [3.9038e+05, 4.0342e+05, 3.9947e+05, 3.9346e+00, 3.9848e+05, 3.8160e+00,
         0.0000e+00, 3.9984e+00, 4.0142e+05, 3.7450e+00, 3.4184e+00, 3.6431e+00,
         3.9322e+05, 4.0034e+05, 3.7323e+00, 3.7248e+00, 3.6155e+00, 3.7699e+00,
         3.6557e+00, 3.7442e+05],
        [3.9037e+05, 4.0343e+05, 3.9945e+05, 4.1794e+00, 3.9851e+05, 3.9765e+00,
         3.9984e+00, 0.0000e+00, 4.0150e+05, 4.0655e+00, 3.5551e+00, 3.8578e+00,
         3.9327e+05, 4.0038e+05, 3.9315e+00, 4.0689e+00, 4.1051e+00, 3.9837e+00,
         3.7785e+00, 3.7443e+05],
        [8.1781e+05, 8.0822e+05, 7.8704e+05, 4.0148e+05, 7.9011e+05, 4.0147e+05,
         4.0142e+05, 4.0150e+05, 0.0000e+00, 4.0143e+05, 4.0149e+05, 4.0150e+05,
         8.1691e+05, 7.9514e+05, 4.0147e+05, 4.0150e+05, 4.0145e+05, 4.0145e+05,
         4.0141e+05, 7.9224e+05],
        [3.9042e+05, 4.0338e+05, 3.9945e+05, 3.8385e+00, 3.9847e+05, 3.7644e+00,
         3.7450e+00, 4.0655e+00, 4.0143e+05, 0.0000e+00, 3.5414e+00, 3.8332e+00,
         3.9324e+05, 4.0036e+05, 3.7411e+00, 3.8589e+00, 4.1211e+00, 3.6685e+00,
         3.8896e+00, 3.7444e+05],
        [3.9036e+05, 4.0343e+05, 3.9948e+05, 3.5548e+00, 3.9854e+05, 3.3538e+00,
         3.4184e+00, 3.5551e+00, 4.0149e+05, 3.5414e+00, 0.0000e+00, 3.5101e+00,
         3.9323e+05, 4.0038e+05, 3.7225e+00, 3.3071e+00, 3.6251e+00, 3.6493e+00,
         3.6162e+00, 3.7445e+05],
        [3.9041e+05, 4.0343e+05, 3.9949e+05, 3.6486e+00, 3.9850e+05, 3.5930e+00,
         3.6431e+00, 3.8578e+00, 4.0150e+05, 3.8332e+00, 3.5101e+00, 0.0000e+00,
         3.9327e+05, 4.0038e+05, 3.3234e+00, 3.5492e+00, 3.4134e+00, 3.6659e+00,
         3.5839e+00, 3.7444e+05],
        [7.6918e+05, 7.8012e+05, 7.8866e+05, 3.9325e+05, 8.0104e+05, 3.9322e+05,
         3.9322e+05, 3.9327e+05, 8.1691e+05, 3.9324e+05, 3.9323e+05, 3.9327e+05,
         0.0000e+00, 7.9043e+05, 3.9325e+05, 3.9324e+05, 3.9325e+05, 3.9323e+05,
         3.9327e+05, 7.7941e+05],
        [8.0785e+05, 8.0763e+05, 7.9274e+05, 4.0038e+05, 7.8730e+05, 4.0034e+05,
         4.0034e+05, 4.0038e+05, 7.9514e+05, 4.0036e+05, 4.0038e+05, 4.0038e+05,
         7.9043e+05, 0.0000e+00, 4.0036e+05, 4.0037e+05, 4.0039e+05, 4.0043e+05,
         4.0035e+05, 7.8908e+05],
        [3.9033e+05, 4.0349e+05, 3.9943e+05, 3.8946e+00, 3.9853e+05, 3.7741e+00,
         3.7323e+00, 3.9315e+00, 4.0147e+05, 3.7411e+00, 3.7225e+00, 3.3234e+00,
         3.9325e+05, 4.0036e+05, 0.0000e+00, 3.7163e+00, 3.7053e+00, 3.4698e+00,
         3.6496e+00, 3.7447e+05],
        [3.9040e+05, 4.0342e+05, 3.9946e+05, 3.7733e+00, 3.9855e+05, 3.4604e+00,
         3.7248e+00, 4.0689e+00, 4.0150e+05, 3.8589e+00, 3.3071e+00, 3.5492e+00,
         3.9324e+05, 4.0037e+05, 3.7163e+00, 0.0000e+00, 3.8517e+00, 3.9599e+00,
         3.7828e+00, 3.7447e+05],
        [3.9040e+05, 4.0341e+05, 3.9946e+05, 3.3247e+00, 3.9846e+05, 4.0153e+00,
         3.6155e+00, 4.1051e+00, 4.0145e+05, 4.1211e+00, 3.6251e+00, 3.4134e+00,
         3.9325e+05, 4.0039e+05, 3.7053e+00, 3.8517e+00, 0.0000e+00, 3.9859e+00,
         3.6570e+00, 3.7446e+05],
        [3.9041e+05, 4.0339e+05, 3.9946e+05, 4.1272e+00, 3.9855e+05, 3.6222e+00,
         3.7699e+00, 3.9837e+00, 4.0145e+05, 3.6685e+00, 3.6493e+00, 3.6659e+00,
         3.9323e+05, 4.0043e+05, 3.4698e+00, 3.9599e+00, 3.9859e+00, 0.0000e+00,
         3.7357e+00, 3.7441e+05],
        [3.9044e+05, 4.0345e+05, 3.9950e+05, 3.8374e+00, 3.9849e+05, 3.7543e+00,
         3.6557e+00, 3.7785e+00, 4.0141e+05, 3.8896e+00, 3.6162e+00, 3.5839e+00,
         3.9327e+05, 4.0035e+05, 3.6496e+00, 3.7828e+00, 3.6570e+00, 3.7357e+00,
         0.0000e+00, 3.7443e+05],
        [7.7307e+05, 7.6739e+05, 7.5604e+05, 3.7448e+05, 7.7837e+05, 3.7440e+05,
         3.7442e+05, 3.7443e+05, 7.9224e+05, 3.7444e+05, 3.7445e+05, 3.7444e+05,
         7.7941e+05, 7.8908e+05, 3.7447e+05, 3.7447e+05, 3.7446e+05, 3.7441e+05,
         3.7443e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 390326.3750, 390356.1250, 390371.8125, 390375.5000,
        390385.8750, 390399.7188, 390400.4375, 390401.3125, 390409.2500,
        390411.2188, 390415.9688, 390441.6562, 769176.8750, 773068.0000,
        792910.6250, 799604.2500, 807853.8125, 809689.3750, 817807.5000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 403383.2812, 403393.1875, 403394.8125, 403408.1562,
        403408.8750, 403420.2188, 403422.5625, 403430.1562, 403432.7500,
        403433.5625, 403452.5312, 403485.2500, 767387.1875, 780122.0625,
        799604.2500, 800372.1250, 807629.1250, 808221.4375, 809675.9375])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 399426.8750, 399449.6562, 399452.2812, 399454.3438,
        399458.2812, 399461.9688, 399464.8438, 399469.2500, 399470.5000,
        399475.4375, 399485.1250, 399496.1250, 756039.6250, 787035.2500,
        788661.5000, 792744.5000, 795078.4375, 809675.9375, 809689.3750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.3247e+00, 3.5548e+00, 3.6486e+00, 3.7733e+00, 3.8374e+00,
        3.8385e+00, 3.8946e+00, 3.9145e+00, 3.9346e+00, 4.1272e+00, 4.1794e+00,
        3.7448e+05, 3.9040e+05, 3.9325e+05, 3.9850e+05, 3.9945e+05, 4.0038e+05,
        4.0148e+05, 4.0339e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 398464.1250, 398470.8438, 398479.8750, 398491.7812,
        398501.0625, 398502.1250, 398505.2812, 398525.8438, 398535.9062,
        398545.0625, 398545.3125, 398550.0000, 778374.3125, 787302.6250,
        790111.2500, 792910.6250, 795078.4375, 800372.1250, 801036.3125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.3538e+00, 3.4604e+00, 3.5930e+00, 3.6222e+00, 3.7543e+00,
        3.7644e+00, 3.7741e+00, 3.8160e+00, 3.9145e+00, 3.9765e+00, 4.0153e+00,
        3.7440e+05, 3.9039e+05, 3.9322e+05, 3.9855e+05, 3.9947e+05, 4.0034e+05,
        4.0147e+05, 4.0341e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.4184e+00, 3.6155e+00, 3.6431e+00, 3.6557e+00, 3.7248e+00,
        3.7323e+00, 3.7450e+00, 3.7699e+00, 3.8160e+00, 3.9346e+00, 3.9984e+00,
        3.7442e+05, 3.9038e+05, 3.9322e+05, 3.9848e+05, 3.9947e+05, 4.0034e+05,
        4.0142e+05, 4.0342e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.5551e+00, 3.7785e+00, 3.8578e+00, 3.9315e+00, 3.9765e+00,
        3.9837e+00, 3.9984e+00, 4.0655e+00, 4.0689e+00, 4.1051e+00, 4.1794e+00,
        3.7443e+05, 3.9037e+05, 3.9327e+05, 3.9851e+05, 3.9945e+05, 4.0038e+05,
        4.0150e+05, 4.0343e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 401412.3750, 401421.0312, 401425.1875, 401446.8438,
        401454.9688, 401469.8438, 401471.3750, 401483.5625, 401485.7500,
        401495.0000, 401496.2188, 401498.2500, 787035.2500, 790111.2500,
        792243.6875, 795142.2500, 808221.4375, 816908.6250, 817807.5000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.5414e+00, 3.6685e+00, 3.7411e+00, 3.7450e+00, 3.7644e+00,
        3.8332e+00, 3.8385e+00, 3.8589e+00, 3.8896e+00, 4.0655e+00, 4.1211e+00,
        3.7444e+05, 3.9042e+05, 3.9324e+05, 3.9847e+05, 3.9945e+05, 4.0036e+05,
        4.0143e+05, 4.0338e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.3071e+00, 3.3538e+00, 3.4184e+00, 3.5101e+00, 3.5414e+00,
        3.5548e+00, 3.5551e+00, 3.6162e+00, 3.6251e+00, 3.6493e+00, 3.7225e+00,
        3.7445e+05, 3.9036e+05, 3.9323e+05, 3.9854e+05, 3.9948e+05, 4.0038e+05,
        4.0149e+05, 4.0343e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.3234e+00, 3.4134e+00, 3.5101e+00, 3.5492e+00, 3.5839e+00,
        3.5930e+00, 3.6431e+00, 3.6486e+00, 3.6659e+00, 3.8332e+00, 3.8578e+00,
        3.7444e+05, 3.9041e+05, 3.9327e+05, 3.9850e+05, 3.9949e+05, 4.0038e+05,
        4.0150e+05, 4.0343e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 393219.5312, 393222.7500, 393228.6875, 393232.2812,
        393240.6250, 393240.8750, 393248.8750, 393252.8438, 393253.0000,
        393268.0000, 393268.8438, 393270.7188, 769176.8750, 779408.6250,
        780122.0625, 788661.5000, 790431.8750, 801036.3125, 816908.6250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 400341.1250, 400343.0625, 400353.0625, 400356.3438,
        400364.0312, 400372.9375, 400378.8750, 400382.0625, 400383.5938,
        400384.2812, 400391.3125, 400433.5938, 787302.6250, 789082.6875,
        790431.8750, 792744.5000, 795142.2500, 807629.1250, 807853.8125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.3234e+00, 3.4698e+00, 3.6496e+00, 3.7053e+00, 3.7163e+00,
        3.7225e+00, 3.7323e+00, 3.7411e+00, 3.7741e+00, 3.8946e+00, 3.9315e+00,
        3.7447e+05, 3.9033e+05, 3.9325e+05, 3.9853e+05, 3.9943e+05, 4.0036e+05,
        4.0147e+05, 4.0349e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.3071e+00, 3.4604e+00, 3.5492e+00, 3.7163e+00, 3.7248e+00,
        3.7733e+00, 3.7828e+00, 3.8517e+00, 3.8589e+00, 3.9599e+00, 4.0689e+00,
        3.7447e+05, 3.9040e+05, 3.9324e+05, 3.9855e+05, 3.9946e+05, 4.0037e+05,
        4.0150e+05, 4.0342e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.3247e+00, 3.4134e+00, 3.6155e+00, 3.6251e+00, 3.6570e+00,
        3.7053e+00, 3.8517e+00, 3.9859e+00, 4.0153e+00, 4.1051e+00, 4.1211e+00,
        3.7446e+05, 3.9040e+05, 3.9325e+05, 3.9846e+05, 3.9946e+05, 4.0039e+05,
        4.0145e+05, 4.0341e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.4698e+00, 3.6222e+00, 3.6493e+00, 3.6659e+00, 3.6685e+00,
        3.7357e+00, 3.7699e+00, 3.9599e+00, 3.9837e+00, 3.9859e+00, 4.1272e+00,
        3.7441e+05, 3.9041e+05, 3.9323e+05, 3.9855e+05, 3.9946e+05, 4.0043e+05,
        4.0145e+05, 4.0339e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.5839e+00, 3.6162e+00, 3.6496e+00, 3.6557e+00, 3.6570e+00,
        3.7357e+00, 3.7543e+00, 3.7785e+00, 3.7828e+00, 3.8374e+00, 3.8896e+00,
        3.7443e+05, 3.9044e+05, 3.9327e+05, 3.9849e+05, 3.9950e+05, 4.0035e+05,
        4.0141e+05, 4.0345e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 374399.9062, 374408.6250, 374417.5000, 374425.1875,
        374434.5625, 374442.4688, 374444.4375, 374452.1250, 374461.7812,
        374468.6875, 374472.9062, 374476.5000, 756039.6250, 767387.1875,
        773068.0000, 778374.3125, 779408.6250, 789082.6875, 792243.6875])
Index of maximum distance difference after half of values: 12
adaptive_Krum scores:  ['390391.22', '403422.03', '399463.69', '31209.87', '398509.75', '31203.41', '31204.88', '31206.50', '401463.31', '31207.04', '31207.59', '31207.00', '393245.53', '400373.62', '31209.46', '31209.15', '31208.60', '31204.19', '31205.51', '374442.03']
estimated f for each client, fs: [6, 6, 6, 8, 6, 8, 8, 8, 6, 8, 8, 8, 6, 6, 8, 8, 8, 8, 8, 7]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [17, 14, 15, 9, 16, 10, 2, 7, 19, 8, 4, 5, 18, 13, 6, 11, 1, 12, 3, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0173s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:56...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[155  82]
 [160 103]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:56, End: 2025-07-22 15:45:56)
start time is: 98124990774142, end time is: 98138139959572
The total time is: 13149185430ns.

 ------- aggregate method: rkrum, random_seed: 200 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [17, 7], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[     0.0000, 397909.4375],
        [397909.4375,      0.0000]])
sorted_distances: tensor([     0.0000, 397909.4375])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([     0.0000, 397909.4375])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['397909.44', '397909.44']
estimated f for each client, fs: [1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [17, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0014s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:56...
global Accuracy on shared test data: 46.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [211  52]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:56, End: 2025-07-22 15:45:56)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [13, 15, 7, 5, 3], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
tensor([[0.0000e+00, 7.7105e+05, 3.8615e+05, 3.8614e+05, 3.8619e+05],
        [7.7105e+05, 0.0000e+00, 3.9267e+05, 3.9271e+05, 3.9270e+05],
        [3.8615e+05, 3.9267e+05, 0.0000e+00, 3.1613e+00, 3.4529e+00],
        [3.8614e+05, 3.9271e+05, 3.1613e+00, 0.0000e+00, 3.5180e+00],
        [3.8619e+05, 3.9270e+05, 3.4529e+00, 3.5180e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 386141.5938, 386149.5000, 386185.7812, 771054.8750])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([     0.0000, 392665.8125, 392699.8750, 392707.8750, 771054.8750])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 3.1613e+00, 3.4529e+00, 3.8615e+05, 3.9267e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 3.1613e+00, 3.5180e+00, 3.8614e+05, 3.9271e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 3.4529e+00, 3.5180e+00, 3.8619e+05, 3.9270e+05])
Index of maximum distance difference after half of values: 4
adaptive_Krum scores:  ['482382.97', '487282.09', '194705.47', '194714.05', '194723.16']
estimated f for each client, fs: [0, 0, 2, 2, 2]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']], selected_client_indices: [13, 15, 7, 5, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0030s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:56...
global Accuracy on shared test data: 46.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [208  55]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:56, End: 2025-07-22 15:45:56)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [5], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
rkrum, clients_type: ['Chosen Update'], selected_client_indices: [5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0000s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:57...
global Accuracy on shared test data: 47.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [201  62]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:57, End: 2025-07-22 15:45:57)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [5, 13, 10, 17, 16, 9, 11, 18, 6], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 3.8485e+05, 3.3766e+00, 3.7776e+05, 3.9220e+05, 3.8032e+00,
         3.1758e+00, 4.1415e+05, 3.5459e+00],
        [3.8485e+05, 0.0000e+00, 3.8488e+05, 7.6125e+05, 7.8207e+05, 3.8483e+05,
         3.8476e+05, 8.0619e+05, 3.8481e+05],
        [3.3766e+00, 3.8488e+05, 0.0000e+00, 3.7778e+05, 3.9218e+05, 3.7854e+00,
         3.4641e+00, 4.1410e+05, 3.4896e+00],
        [3.7776e+05, 7.6125e+05, 3.7778e+05, 0.0000e+00, 7.8014e+05, 3.7781e+05,
         3.7778e+05, 7.9408e+05, 3.7778e+05],
        [3.9220e+05, 7.8207e+05, 3.9218e+05, 7.8014e+05, 0.0000e+00, 3.9217e+05,
         3.9216e+05, 8.1843e+05, 3.9218e+05],
        [3.8032e+00, 3.8483e+05, 3.7854e+00, 3.7781e+05, 3.9217e+05, 0.0000e+00,
         3.6021e+00, 4.1408e+05, 3.6736e+00],
        [3.1758e+00, 3.8476e+05, 3.4641e+00, 3.7778e+05, 3.9216e+05, 3.6021e+00,
         0.0000e+00, 4.1414e+05, 3.3060e+00],
        [4.1415e+05, 8.0619e+05, 4.1410e+05, 7.9408e+05, 8.1843e+05, 4.1408e+05,
         4.1414e+05, 0.0000e+00, 4.1412e+05],
        [3.5459e+00, 3.8481e+05, 3.4896e+00, 3.7778e+05, 3.9218e+05, 3.6736e+00,
         3.3060e+00, 4.1412e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.1758e+00, 3.3766e+00, 3.5459e+00, 3.8032e+00, 3.7776e+05,
        3.8485e+05, 3.9220e+05, 4.1415e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 384761.9062, 384807.5938, 384834.5625, 384846.8750,
        384875.5000, 761253.9375, 782071.2500, 806186.1875])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.3766e+00, 3.4641e+00, 3.4896e+00, 3.7854e+00, 3.7778e+05,
        3.8488e+05, 3.9218e+05, 4.1410e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 377761.1250, 377778.4375, 377780.1250, 377782.5000,
        377808.0312, 761253.9375, 780141.5625, 794078.1250])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 392159.3125, 392165.8750, 392180.0938, 392180.5938,
        392196.9688, 780141.5625, 782071.2500, 818426.4375])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.6021e+00, 3.6736e+00, 3.7854e+00, 3.8032e+00, 3.7781e+05,
        3.8483e+05, 3.9217e+05, 4.1408e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.1758e+00, 3.3060e+00, 3.4641e+00, 3.6021e+00, 3.7778e+05,
        3.8476e+05, 3.9216e+05, 4.1414e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 414079.5625, 414102.4062, 414122.0000, 414135.1250,
        414153.1562, 794078.1250, 806186.1875, 818426.4375])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.3060e+00, 3.4896e+00, 3.5459e+00, 3.6736e+00, 3.7778e+05,
        3.8481e+05, 3.9218e+05, 4.1412e+05])
Index of maximum distance difference after half of values: 6
adaptive_Krum scores:  ['127103.65', '447563.38', '127111.62', '441694.03', '456837.38', '127109.58', '127092.31', '477445.03', '127100.67']
estimated f for each client, fs: [4, 2, 4, 3, 2, 4, 4, 2, 4]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']], selected_client_indices: [5, 13, 10, 17, 16, 9, 11, 18, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0055s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:57...
global Accuracy on shared test data: 47.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [193  70]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:57, End: 2025-07-22 15:45:57)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [16, 5, 18, 10, 19, 9, 14, 11, 20, 4, 8, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 3.9462e+05, 7.8630e+05, 3.9463e+05, 8.2465e+05, 3.9467e+05,
         7.7898e+05, 3.9462e+05, 8.1480e+05, 3.9462e+05, 3.9459e+05, 3.9465e+05],
        [3.9462e+05, 0.0000e+00, 3.8277e+05, 3.3024e+00, 4.1047e+05, 3.7373e+00,
         3.9071e+05, 3.3209e+00, 3.9782e+05, 3.6076e+00, 3.5470e+00, 3.5889e+00],
        [7.8630e+05, 3.8277e+05, 0.0000e+00, 3.8280e+05, 7.6499e+05, 3.8285e+05,
         7.6632e+05, 3.8281e+05, 7.7533e+05, 3.8279e+05, 3.8283e+05, 3.8281e+05],
        [3.9463e+05, 3.3024e+00, 3.8280e+05, 0.0000e+00, 4.1051e+05, 3.7164e+00,
         3.9073e+05, 3.4287e+00, 3.9782e+05, 3.4554e+00, 3.0249e+00, 3.3526e+00],
        [8.2465e+05, 4.1047e+05, 7.6499e+05, 4.1051e+05, 0.0000e+00, 4.1046e+05,
         8.1421e+05, 4.1049e+05, 8.1454e+05, 4.1051e+05, 4.1052e+05, 4.1050e+05],
        [3.9467e+05, 3.7373e+00, 3.8285e+05, 3.7164e+00, 4.1046e+05, 0.0000e+00,
         3.9072e+05, 3.6341e+00, 3.9778e+05, 3.7494e+00, 3.4921e+00, 3.6762e+00],
        [7.7898e+05, 3.9071e+05, 7.6632e+05, 3.9073e+05, 8.1421e+05, 3.9072e+05,
         0.0000e+00, 3.9080e+05, 7.8809e+05, 3.9078e+05, 3.9073e+05, 3.9075e+05],
        [3.9462e+05, 3.3209e+00, 3.8281e+05, 3.4287e+00, 4.1049e+05, 3.6341e+00,
         3.9080e+05, 0.0000e+00, 3.9787e+05, 3.5548e+00, 3.2947e+00, 3.3979e+00],
        [8.1480e+05, 3.9782e+05, 7.7533e+05, 3.9782e+05, 8.1454e+05, 3.9778e+05,
         7.8809e+05, 3.9787e+05, 0.0000e+00, 3.9781e+05, 3.9777e+05, 3.9784e+05],
        [3.9462e+05, 3.6076e+00, 3.8279e+05, 3.4554e+00, 4.1051e+05, 3.7494e+00,
         3.9078e+05, 3.5548e+00, 3.9781e+05, 0.0000e+00, 3.5133e+00, 3.5927e+00],
        [3.9459e+05, 3.5470e+00, 3.8283e+05, 3.0249e+00, 4.1052e+05, 3.4921e+00,
         3.9073e+05, 3.2947e+00, 3.9777e+05, 3.5133e+00, 0.0000e+00, 3.3662e+00],
        [3.9465e+05, 3.5889e+00, 3.8281e+05, 3.3526e+00, 4.1050e+05, 3.6762e+00,
         3.9075e+05, 3.3979e+00, 3.9784e+05, 3.5927e+00, 3.3662e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 394591.0938, 394617.6562, 394618.2188, 394623.5938,
        394633.0625, 394645.2500, 394665.1250, 778976.4375, 786297.1250,
        814796.6250, 824645.6250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.3024e+00, 3.3209e+00, 3.5470e+00, 3.5889e+00, 3.6076e+00,
        3.7373e+00, 3.8277e+05, 3.9071e+05, 3.9462e+05, 3.9782e+05, 4.1047e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 382769.2188, 382794.6250, 382799.4375, 382810.0625,
        382812.6875, 382834.7500, 382849.5000, 764987.9375, 766321.0000,
        775332.3750, 786297.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.0249e+00, 3.3024e+00, 3.3526e+00, 3.4287e+00, 3.4554e+00,
        3.7164e+00, 3.8280e+05, 3.9073e+05, 3.9463e+05, 3.9782e+05, 4.1051e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 410462.7812, 410470.2188, 410488.5000, 410502.4062,
        410511.6875, 410514.5312, 410518.9062, 764987.9375, 814209.4375,
        814541.6250, 824645.6250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.4921e+00, 3.6341e+00, 3.6762e+00, 3.7164e+00, 3.7373e+00,
        3.7494e+00, 3.8285e+05, 3.9072e+05, 3.9467e+05, 3.9778e+05, 4.1046e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 390707.4062, 390721.8125, 390726.0625, 390730.8438,
        390754.4062, 390777.6562, 390798.5625, 766321.0000, 778976.4375,
        788089.2500, 814209.4375])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.2947e+00, 3.3209e+00, 3.3979e+00, 3.4287e+00, 3.5548e+00,
        3.6341e+00, 3.8281e+05, 3.9080e+05, 3.9462e+05, 3.9787e+05, 4.1049e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 397772.8750, 397781.4375, 397808.4375, 397818.9062,
        397819.1250, 397839.1875, 397868.4375, 775332.3750, 788089.2500,
        814541.6250, 814796.6250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.4554e+00, 3.5133e+00, 3.5548e+00, 3.5927e+00, 3.6076e+00,
        3.7494e+00, 3.8279e+05, 3.9078e+05, 3.9462e+05, 3.9781e+05, 4.1051e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.0249e+00, 3.2947e+00, 3.3662e+00, 3.4921e+00, 3.5133e+00,
        3.5470e+00, 3.8283e+05, 3.9073e+05, 3.9459e+05, 3.9777e+05, 4.1052e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.3526e+00, 3.3662e+00, 3.3979e+00, 3.5889e+00, 3.5927e+00,
        3.6762e+00, 3.8281e+05, 3.9075e+05, 3.9465e+05, 3.9784e+05, 4.1050e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['442671.34', '96687.22', '430582.28', '96693.23', '454807.16', '96699.17', '437692.25', '96703.66', '445005.12', '96699.23', '96698.23', '96698.52']
estimated f for each client, fs: [3, 5, 3, 5, 3, 5, 3, 5, 3, 5, 5, 5]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [16, 5, 18, 10, 19, 9, 14, 11, 20, 4, 8, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0076s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:57...
global Accuracy on shared test data: 47.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[161  76]
 [188  75]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:57, End: 2025-07-22 15:45:57)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [3, 17, 2, 19, 16, 1, 6, 15, 14, 11, 13, 20, 4, 9, 5, 8], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8659e+05, 3.3897e+00, 3.8146e+05, 3.9321e+05, 3.6275e+00,
         3.7366e+00, 3.9268e+05, 3.7500e+05, 3.5475e+00, 3.7689e+05, 3.9309e+05,
         3.6016e+00, 3.6846e+00, 3.6753e+00, 3.4236e+00],
        [3.8659e+05, 0.0000e+00, 3.8659e+05, 7.4965e+05, 7.8224e+05, 3.8654e+05,
         3.8652e+05, 7.9539e+05, 7.7530e+05, 3.8652e+05, 7.7837e+05, 7.8412e+05,
         3.8655e+05, 3.8654e+05, 3.8659e+05, 3.8652e+05],
        [3.3897e+00, 3.8659e+05, 0.0000e+00, 3.8139e+05, 3.9318e+05, 3.4757e+00,
         3.6727e+00, 3.9262e+05, 3.7504e+05, 3.5660e+00, 3.7684e+05, 3.9310e+05,
         3.5056e+00, 3.7557e+00, 3.7028e+00, 3.5532e+00],
        [3.8146e+05, 7.4965e+05, 3.8139e+05, 0.0000e+00, 7.5712e+05, 3.8138e+05,
         3.8138e+05, 7.7852e+05, 7.5819e+05, 3.8139e+05, 7.3072e+05, 7.7762e+05,
         3.8132e+05, 3.8137e+05, 3.8138e+05, 3.8140e+05],
        [3.9321e+05, 7.8224e+05, 3.9318e+05, 7.5712e+05, 0.0000e+00, 3.9319e+05,
         3.9322e+05, 7.7830e+05, 7.7934e+05, 3.9322e+05, 7.6771e+05, 7.8832e+05,
         3.9318e+05, 3.9319e+05, 3.9320e+05, 3.9323e+05],
        [3.6275e+00, 3.8654e+05, 3.4757e+00, 3.8138e+05, 3.9319e+05, 0.0000e+00,
         3.5735e+00, 3.9259e+05, 3.7501e+05, 3.6647e+00, 3.7689e+05, 3.9308e+05,
         3.8316e+00, 3.6095e+00, 3.4943e+00, 3.3316e+00],
        [3.7366e+00, 3.8652e+05, 3.6727e+00, 3.8138e+05, 3.9322e+05, 3.5735e+00,
         0.0000e+00, 3.9264e+05, 3.7503e+05, 3.4590e+00, 3.7685e+05, 3.9304e+05,
         3.5018e+00, 3.7381e+00, 3.5366e+00, 3.3613e+00],
        [3.9268e+05, 7.9539e+05, 3.9262e+05, 7.7852e+05, 7.7830e+05, 3.9259e+05,
         3.9264e+05, 0.0000e+00, 7.4202e+05, 3.9266e+05, 7.8974e+05, 7.9367e+05,
         3.9264e+05, 3.9269e+05, 3.9261e+05, 3.9261e+05],
        [3.7500e+05, 7.7530e+05, 3.7504e+05, 7.5819e+05, 7.7934e+05, 3.7501e+05,
         3.7503e+05, 7.4202e+05, 0.0000e+00, 3.7504e+05, 7.6612e+05, 7.4760e+05,
         3.7502e+05, 3.7504e+05, 3.7501e+05, 3.7499e+05],
        [3.5475e+00, 3.8652e+05, 3.5660e+00, 3.8139e+05, 3.9322e+05, 3.6647e+00,
         3.4590e+00, 3.9266e+05, 3.7504e+05, 0.0000e+00, 3.7681e+05, 3.9303e+05,
         3.5283e+00, 3.7282e+00, 3.3520e+00, 3.4146e+00],
        [3.7689e+05, 7.7837e+05, 3.7684e+05, 7.3072e+05, 7.6771e+05, 3.7689e+05,
         3.7685e+05, 7.8974e+05, 7.6612e+05, 3.7681e+05, 0.0000e+00, 7.5214e+05,
         3.7680e+05, 3.7683e+05, 3.7685e+05, 3.7687e+05],
        [3.9309e+05, 7.8412e+05, 3.9310e+05, 7.7762e+05, 7.8832e+05, 3.9308e+05,
         3.9304e+05, 7.9367e+05, 7.4760e+05, 3.9303e+05, 7.5214e+05, 0.0000e+00,
         3.9307e+05, 3.9303e+05, 3.9303e+05, 3.9308e+05],
        [3.6016e+00, 3.8655e+05, 3.5056e+00, 3.8132e+05, 3.9318e+05, 3.8316e+00,
         3.5018e+00, 3.9264e+05, 3.7502e+05, 3.5283e+00, 3.7680e+05, 3.9307e+05,
         0.0000e+00, 3.8660e+00, 3.5531e+00, 3.4951e+00],
        [3.6846e+00, 3.8654e+05, 3.7557e+00, 3.8137e+05, 3.9319e+05, 3.6095e+00,
         3.7381e+00, 3.9269e+05, 3.7504e+05, 3.7282e+00, 3.7683e+05, 3.9303e+05,
         3.8660e+00, 0.0000e+00, 3.6557e+00, 3.5874e+00],
        [3.6753e+00, 3.8659e+05, 3.7028e+00, 3.8138e+05, 3.9320e+05, 3.4943e+00,
         3.5366e+00, 3.9261e+05, 3.7501e+05, 3.3520e+00, 3.7685e+05, 3.9303e+05,
         3.5531e+00, 3.6557e+00, 0.0000e+00, 3.3806e+00],
        [3.4236e+00, 3.8652e+05, 3.5532e+00, 3.8140e+05, 3.9323e+05, 3.3316e+00,
         3.3613e+00, 3.9261e+05, 3.7499e+05, 3.4146e+00, 3.7687e+05, 3.9308e+05,
         3.4951e+00, 3.5874e+00, 3.3806e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.3897e+00, 3.4236e+00, 3.5475e+00, 3.6016e+00, 3.6275e+00,
        3.6753e+00, 3.6846e+00, 3.7366e+00, 3.7500e+05, 3.7689e+05, 3.8146e+05,
        3.8659e+05, 3.9268e+05, 3.9309e+05, 3.9321e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386519.2500, 386520.5312, 386524.8438, 386539.2188,
        386539.7500, 386550.6562, 386587.9688, 386588.4375, 386591.3125,
        749653.5625, 775298.1250, 778365.3750, 782243.8125, 784123.9375,
        795392.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3897e+00, 3.4757e+00, 3.5056e+00, 3.5532e+00, 3.5660e+00,
        3.6727e+00, 3.7028e+00, 3.7557e+00, 3.7504e+05, 3.7684e+05, 3.8139e+05,
        3.8659e+05, 3.9262e+05, 3.9310e+05, 3.9318e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381319.5312, 381367.7500, 381376.5000, 381381.5000,
        381383.8438, 381385.1250, 381391.2188, 381398.5312, 381458.2500,
        730720.7500, 749653.5625, 757117.3750, 758193.7500, 777618.0625,
        778515.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393182.3750, 393182.7500, 393190.8438, 393191.8750,
        393196.6562, 393214.2500, 393216.9375, 393221.7500, 393225.5000,
        757117.3750, 767708.5000, 778298.3750, 779344.0000, 782243.8125,
        788315.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3316e+00, 3.4757e+00, 3.4943e+00, 3.5735e+00, 3.6095e+00,
        3.6275e+00, 3.6647e+00, 3.8316e+00, 3.7501e+05, 3.7689e+05, 3.8138e+05,
        3.8654e+05, 3.9259e+05, 3.9308e+05, 3.9319e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3613e+00, 3.4590e+00, 3.5018e+00, 3.5366e+00, 3.5735e+00,
        3.6727e+00, 3.7366e+00, 3.7381e+00, 3.7503e+05, 3.7685e+05, 3.8138e+05,
        3.8652e+05, 3.9264e+05, 3.9304e+05, 3.9322e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392593.0000, 392605.0312, 392613.1250, 392616.4375,
        392641.5000, 392644.0938, 392659.2812, 392682.9375, 392687.1562,
        742022.0000, 778298.3750, 778515.8750, 789735.0625, 793666.1250,
        795392.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374993.5000, 374995.2500, 375007.0938, 375011.1562,
        375021.2500, 375025.8125, 375035.0000, 375035.8125, 375038.0312,
        742022.0000, 747601.8750, 758193.7500, 766124.3750, 775298.1250,
        779344.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3520e+00, 3.4146e+00, 3.4590e+00, 3.5283e+00, 3.5475e+00,
        3.5660e+00, 3.6647e+00, 3.7282e+00, 3.7504e+05, 3.7681e+05, 3.8139e+05,
        3.8652e+05, 3.9266e+05, 3.9303e+05, 3.9322e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376800.7812, 376813.6875, 376829.1250, 376839.8750,
        376846.3438, 376847.7812, 376865.2500, 376891.0000, 376894.6875,
        730720.7500, 752142.6875, 766124.3750, 767708.5000, 778365.3750,
        789735.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393027.0000, 393031.9375, 393034.9688, 393043.8438,
        393070.0625, 393080.4688, 393083.4062, 393093.0312, 393096.0000,
        747601.8750, 752142.6875, 777618.0625, 784123.9375, 788315.1875,
        793666.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4951e+00, 3.5018e+00, 3.5056e+00, 3.5283e+00, 3.5531e+00,
        3.6016e+00, 3.8316e+00, 3.8660e+00, 3.7502e+05, 3.7680e+05, 3.8132e+05,
        3.8655e+05, 3.9264e+05, 3.9307e+05, 3.9318e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5874e+00, 3.6095e+00, 3.6557e+00, 3.6846e+00, 3.7282e+00,
        3.7381e+00, 3.7557e+00, 3.8660e+00, 3.7504e+05, 3.7683e+05, 3.8137e+05,
        3.8654e+05, 3.9269e+05, 3.9303e+05, 3.9319e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3520e+00, 3.3806e+00, 3.4943e+00, 3.5366e+00, 3.5531e+00,
        3.6557e+00, 3.6753e+00, 3.7028e+00, 3.7501e+05, 3.7685e+05, 3.8138e+05,
        3.8659e+05, 3.9261e+05, 3.9303e+05, 3.9320e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3316e+00, 3.3613e+00, 3.3806e+00, 3.4146e+00, 3.4236e+00,
        3.4951e+00, 3.5532e+00, 3.5874e+00, 3.7499e+05, 3.7687e+05, 3.8140e+05,
        3.8652e+05, 3.9261e+05, 3.9308e+05, 3.9323e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75191.50', '422861.56', '75190.43', '416318.28', '429594.00', '75193.45', '75190.08', '427576.44', '411718.47', '75187.70', '412234.94', '428516.25', '75185.09', '75189.67', '75188.33', '75188.63']
estimated f for each client, fs: [7, 5, 7, 5, 5, 7, 7, 5, 5, 7, 5, 5, 7, 7, 7, 7]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 17, 2, 19, 16, 1, 6, 15, 14, 11, 13, 20, 4, 9, 5, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0109s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:58...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[154  83]
 [173  90]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:45:58, End: 2025-07-22 15:45:58)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [12, 11], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 3.5898],
        [3.5898, 0.0000]])
sorted_distances: tensor([0.0000, 3.5898])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000, 3.5898])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['3.59', '3.59']
estimated f for each client, fs: [1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [12, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0015s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:58...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[151  86]
 [167  96]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:58, End: 2025-07-22 15:45:58)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (6): [19, 5, 1, 8, 17, 20], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 6
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([6])
tensor([[0.0000e+00, 4.0227e+05, 4.0231e+05, 4.0231e+05, 7.6931e+05, 7.8029e+05],
        [4.0227e+05, 0.0000e+00, 3.6833e+00, 3.3910e+00, 3.8528e+05, 3.9783e+05],
        [4.0231e+05, 3.6833e+00, 0.0000e+00, 3.3856e+00, 3.8526e+05, 3.9784e+05],
        [4.0231e+05, 3.3910e+00, 3.3856e+00, 0.0000e+00, 3.8529e+05, 3.9782e+05],
        [7.6931e+05, 3.8528e+05, 3.8526e+05, 3.8529e+05, 0.0000e+00, 7.9207e+05],
        [7.8029e+05, 3.9783e+05, 3.9784e+05, 3.9782e+05, 7.9207e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 402265.9375, 402313.6250, 402314.4062, 769308.0000,
        780285.6875])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.3910e+00, 3.6833e+00, 3.8528e+05, 3.9783e+05, 4.0227e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.3856e+00, 3.6833e+00, 3.8526e+05, 3.9784e+05, 4.0231e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.3856e+00, 3.3910e+00, 3.8529e+05, 3.9782e+05, 4.0231e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 385263.5000, 385282.3438, 385285.1875, 769308.0000,
        792065.5000])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 397820.4688, 397834.1250, 397837.4062, 780285.6875,
        792065.5000])
Index of maximum distance difference after half of values: 5
adaptive_Krum scores:  ['551297.50', '237077.89', '237084.47', '237085.19', '543440.88', '553168.62']
estimated f for each client, fs: [0, 3, 3, 3, 1, 0]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']], selected_client_indices: [19, 5, 1, 8, 17, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0109s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:58...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[150  87]
 [161 102]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:58, End: 2025-07-22 15:45:58)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [14, 15, 8, 11, 4, 18, 5], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 7.8794e+05, 3.9257e+05, 3.9251e+05, 3.9257e+05, 7.5872e+05,
         3.9255e+05],
        [7.8794e+05, 0.0000e+00, 3.9765e+05, 3.9764e+05, 3.9772e+05, 7.6020e+05,
         3.9767e+05],
        [3.9257e+05, 3.9765e+05, 0.0000e+00, 3.5660e+00, 3.6423e+00, 3.7466e+05,
         3.3834e+00],
        [3.9251e+05, 3.9764e+05, 3.5660e+00, 0.0000e+00, 3.6775e+00, 3.7462e+05,
         3.5233e+00],
        [3.9257e+05, 3.9772e+05, 3.6423e+00, 3.6775e+00, 0.0000e+00, 3.7460e+05,
         3.9291e+00],
        [7.5872e+05, 7.6020e+05, 3.7466e+05, 3.7462e+05, 3.7460e+05, 0.0000e+00,
         3.7466e+05],
        [3.9255e+05, 3.9767e+05, 3.3834e+00, 3.5233e+00, 3.9291e+00, 3.7466e+05,
         0.0000e+00]])
sorted_distances: tensor([     0.0000, 392509.2812, 392550.0625, 392568.8125, 392571.6875,
        758715.3750, 787942.2500])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 397636.3438, 397652.3125, 397668.5625, 397724.9688,
        760204.6250, 787942.2500])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.3834e+00, 3.5660e+00, 3.6423e+00, 3.7466e+05, 3.9257e+05,
        3.9765e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.5233e+00, 3.5660e+00, 3.6775e+00, 3.7462e+05, 3.9251e+05,
        3.9764e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.6423e+00, 3.6775e+00, 3.9291e+00, 3.7460e+05, 3.9257e+05,
        3.9772e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 374602.6875, 374620.3750, 374657.7500, 374661.8125,
        758715.3750, 760204.6250])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.3834e+00, 3.5233e+00, 3.9291e+00, 3.7466e+05, 3.9255e+05,
        3.9767e+05])
Index of maximum distance difference after half of values: 5
adaptive_Krum scores:  ['465783.06', '470177.34', '153448.81', '153428.08', '153436.55', '451451.66', '153443.73']
estimated f for each client, fs: [1, 1, 3, 3, 3, 2, 3]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [14, 15, 8, 11, 4, 18, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:59...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[146  91]
 [147 116]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:59, End: 2025-07-22 15:45:59)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [6, 11, 13, 7, 9, 15, 16, 19, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 3.6075e+00, 3.9355e+05, 3.5859e+00, 3.8561e+00, 3.8522e+05,
         4.0046e+05, 3.9291e+05, 3.5239e+00],
        [3.6075e+00, 0.0000e+00, 3.9355e+05, 3.4540e+00, 3.9098e+00, 3.8526e+05,
         4.0043e+05, 3.9296e+05, 3.8399e+00],
        [3.9355e+05, 3.9355e+05, 0.0000e+00, 3.9351e+05, 3.9356e+05, 7.8047e+05,
         8.0674e+05, 7.9699e+05, 3.9357e+05],
        [3.5859e+00, 3.4540e+00, 3.9351e+05, 0.0000e+00, 3.9083e+00, 3.8526e+05,
         4.0049e+05, 3.9296e+05, 3.6480e+00],
        [3.8561e+00, 3.9098e+00, 3.9356e+05, 3.9083e+00, 0.0000e+00, 3.8528e+05,
         4.0050e+05, 3.9295e+05, 3.7733e+00],
        [3.8522e+05, 3.8526e+05, 7.8047e+05, 3.8526e+05, 3.8528e+05, 0.0000e+00,
         7.8105e+05, 7.6628e+05, 3.8527e+05],
        [4.0046e+05, 4.0043e+05, 8.0674e+05, 4.0049e+05, 4.0050e+05, 7.8105e+05,
         0.0000e+00, 8.1701e+05, 4.0055e+05],
        [3.9291e+05, 3.9296e+05, 7.9699e+05, 3.9296e+05, 3.9295e+05, 7.6628e+05,
         8.1701e+05, 0.0000e+00, 3.9294e+05],
        [3.5239e+00, 3.8399e+00, 3.9357e+05, 3.6480e+00, 3.7733e+00, 3.8527e+05,
         4.0055e+05, 3.9294e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.5239e+00, 3.5859e+00, 3.6075e+00, 3.8561e+00, 3.8522e+05,
        3.9291e+05, 3.9355e+05, 4.0046e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.4540e+00, 3.6075e+00, 3.8399e+00, 3.9098e+00, 3.8526e+05,
        3.9296e+05, 3.9355e+05, 4.0043e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 393507.3438, 393550.3750, 393552.3750, 393561.9375,
        393568.2500, 780473.8750, 796986.2500, 806738.3125])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.4540e+00, 3.5859e+00, 3.6480e+00, 3.9083e+00, 3.8526e+05,
        3.9296e+05, 3.9351e+05, 4.0049e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.7733e+00, 3.8561e+00, 3.9083e+00, 3.9098e+00, 3.8528e+05,
        3.9295e+05, 3.9356e+05, 4.0050e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 385216.9375, 385255.5938, 385260.1875, 385265.6250,
        385277.8750, 766278.6875, 780473.8750, 781045.2500])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 400429.6250, 400462.1562, 400492.1250, 400497.8750,
        400554.7812, 781045.2500, 806738.3125, 817012.2500])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 392914.8750, 392935.3750, 392954.4062, 392958.7812,
        392960.2812, 766278.6875, 796986.2500, 817012.2500])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.5239e+00, 3.6480e+00, 3.7733e+00, 3.8399e+00, 3.8527e+05,
        3.9294e+05, 3.9357e+05, 4.0055e+05])
Index of maximum distance difference after half of values: 6
adaptive_Krum scores:  ['129691.06', '129705.12', '458035.69', '129705.59', '129707.96', '448759.12', '463913.62', '455167.06', '129702.64']
estimated f for each client, fs: [4, 4, 2, 4, 4, 2, 2, 2, 4]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [6, 11, 13, 7, 9, 15, 16, 19, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0052s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:59...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[143  94]
 [146 117]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:45:59, End: 2025-07-22 15:45:59)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [7, 5, 14], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[0.0000e+00, 3.5126e+00, 3.9459e+05],
        [3.5126e+00, 0.0000e+00, 3.9457e+05],
        [3.9459e+05, 3.9457e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.5126e+00, 3.9459e+05])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000e+00, 3.5126e+00, 3.9457e+05])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([     0.0000, 394574.3125, 394588.2812])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['197295.91', '197288.92', '394581.31']
estimated f for each client, fs: [1, 1, 0]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']], selected_client_indices: [7, 5, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0017s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:45:59...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[146  91]
 [148 115]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:45:59, End: 2025-07-22 15:45:59)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (4): [1, 11, 7, 15], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 4
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([4])
tensor([[0.0000e+00, 3.8429e+00, 3.6718e+00, 3.8892e+05],
        [3.8429e+00, 0.0000e+00, 3.4675e+00, 3.8900e+05],
        [3.6718e+00, 3.4675e+00, 0.0000e+00, 3.8896e+05],
        [3.8892e+05, 3.8900e+05, 3.8896e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.6718e+00, 3.8429e+00, 3.8892e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 3.4675e+00, 3.8429e+00, 3.8900e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 3.4675e+00, 3.6718e+00, 3.8896e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([     0.0000, 388923.8750, 388958.5625, 389003.3125])
Index of maximum distance difference after half of values: 4
adaptive_Krum scores:  ['129643.79', '129670.21', '129655.23', '388961.91']
estimated f for each client, fs: [1, 1, 1, 0]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']], selected_client_indices: [1, 11, 7, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0123s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:00...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[143  94]
 [147 116]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:46:00, End: 2025-07-22 15:46:00)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [15, 16, 10, 7, 18, 12, 8, 19, 5, 6, 11, 13], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 7.7340e+05, 3.8114e+05, 3.8107e+05, 7.5252e+05, 3.8115e+05,
         3.8109e+05, 7.4173e+05, 3.8109e+05, 3.8114e+05, 3.8108e+05, 7.6636e+05],
        [7.7340e+05, 0.0000e+00, 3.9334e+05, 3.9335e+05, 7.9237e+05, 3.9339e+05,
         3.9338e+05, 7.8848e+05, 3.9338e+05, 3.9332e+05, 3.9334e+05, 7.9183e+05],
        [3.8114e+05, 3.9334e+05, 0.0000e+00, 3.6602e+00, 3.9403e+05, 3.5638e+00,
         3.2337e+00, 3.7257e+05, 3.4514e+00, 3.5286e+00, 3.7962e+00, 3.9531e+05],
        [3.8107e+05, 3.9335e+05, 3.6602e+00, 0.0000e+00, 3.9402e+05, 3.7688e+00,
         3.4992e+00, 3.7253e+05, 3.5434e+00, 3.5555e+00, 3.4164e+00, 3.9526e+05],
        [7.5252e+05, 7.9237e+05, 3.9403e+05, 3.9402e+05, 0.0000e+00, 3.9398e+05,
         3.9401e+05, 7.6942e+05, 3.9399e+05, 3.9398e+05, 3.9401e+05, 7.9343e+05],
        [3.8115e+05, 3.9339e+05, 3.5638e+00, 3.7688e+00, 3.9398e+05, 0.0000e+00,
         3.4453e+00, 3.7265e+05, 3.7953e+00, 3.7457e+00, 4.0041e+00, 3.9527e+05],
        [3.8109e+05, 3.9338e+05, 3.2337e+00, 3.4992e+00, 3.9401e+05, 3.4453e+00,
         0.0000e+00, 3.7258e+05, 3.5262e+00, 3.3242e+00, 3.8067e+00, 3.9527e+05],
        [7.4173e+05, 7.8848e+05, 3.7257e+05, 3.7253e+05, 7.6942e+05, 3.7265e+05,
         3.7258e+05, 0.0000e+00, 3.7260e+05, 3.7251e+05, 3.7255e+05, 7.7882e+05],
        [3.8109e+05, 3.9338e+05, 3.4514e+00, 3.5434e+00, 3.9399e+05, 3.7953e+00,
         3.5262e+00, 3.7260e+05, 0.0000e+00, 3.7222e+00, 3.6534e+00, 3.9526e+05],
        [3.8114e+05, 3.9332e+05, 3.5286e+00, 3.5555e+00, 3.9398e+05, 3.7457e+00,
         3.3242e+00, 3.7251e+05, 3.7222e+00, 0.0000e+00, 3.7983e+00, 3.9530e+05],
        [3.8108e+05, 3.9334e+05, 3.7962e+00, 3.4164e+00, 3.9401e+05, 4.0041e+00,
         3.8067e+00, 3.7255e+05, 3.6534e+00, 3.7983e+00, 0.0000e+00, 3.9531e+05],
        [7.6636e+05, 7.9183e+05, 3.9531e+05, 3.9526e+05, 7.9343e+05, 3.9527e+05,
         3.9527e+05, 7.7882e+05, 3.9526e+05, 3.9530e+05, 3.9531e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 381070.0312, 381077.3438, 381093.5000, 381094.9375,
        381136.7812, 381139.6250, 381152.0000, 741726.5625, 752520.5625,
        766360.6875, 773395.3750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 393320.1250, 393339.3438, 393343.3750, 393351.6562,
        393377.3750, 393378.4062, 393390.6250, 773395.3750, 788476.1250,
        791829.1875, 792373.6875])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.2337e+00, 3.4514e+00, 3.5286e+00, 3.5638e+00, 3.6602e+00,
        3.7962e+00, 3.7257e+05, 3.8114e+05, 3.9334e+05, 3.9403e+05, 3.9531e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.4164e+00, 3.4992e+00, 3.5434e+00, 3.5555e+00, 3.6602e+00,
        3.7688e+00, 3.7253e+05, 3.8107e+05, 3.9335e+05, 3.9402e+05, 3.9526e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 393979.0312, 393981.2188, 393994.6562, 394010.2812,
        394012.3125, 394015.6875, 394030.5000, 752520.5625, 769419.9375,
        792373.6875, 793431.6875])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.4453e+00, 3.5638e+00, 3.7457e+00, 3.7688e+00, 3.7953e+00,
        4.0041e+00, 3.7265e+05, 3.8115e+05, 3.9339e+05, 3.9398e+05, 3.9527e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.2337e+00, 3.3242e+00, 3.4453e+00, 3.4992e+00, 3.5262e+00,
        3.8067e+00, 3.7258e+05, 3.8109e+05, 3.9338e+05, 3.9401e+05, 3.9527e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 372510.9375, 372527.5938, 372551.1250, 372565.1875,
        372577.8438, 372599.4375, 372651.9375, 741726.5625, 769419.9375,
        778819.6875, 788476.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.4514e+00, 3.5262e+00, 3.5434e+00, 3.6534e+00, 3.7222e+00,
        3.7953e+00, 3.7260e+05, 3.8109e+05, 3.9338e+05, 3.9399e+05, 3.9526e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.3242e+00, 3.5286e+00, 3.5555e+00, 3.7222e+00, 3.7457e+00,
        3.7983e+00, 3.7251e+05, 3.8114e+05, 3.9332e+05, 3.9398e+05, 3.9530e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.4164e+00, 3.6534e+00, 3.7962e+00, 3.7983e+00, 3.8067e+00,
        4.0041e+00, 3.7255e+05, 3.8108e+05, 3.9334e+05, 3.9401e+05, 3.9531e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 395259.1250, 395262.5000, 395265.3125, 395273.1250,
        395298.4375, 395312.7812, 395314.4375, 766360.6875, 778819.6875,
        791829.1875, 793431.6875])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['426186.41', '440862.06', '94215.41', '94202.39', '438818.09', '94228.29', '94211.53', '418713.88', '94214.52', '94209.04', '94206.38', '441668.31']
estimated f for each client, fs: [3, 3, 5, 5, 3, 5, 5, 3, 5, 5, 5, 3]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [15, 16, 10, 7, 18, 12, 8, 19, 5, 6, 11, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0172s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:00...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[141  96]
 [142 121]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:00, End: 2025-07-22 15:46:00)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [4, 1, 2, 20, 7, 19, 8, 9, 12, 5, 18, 13, 15, 16, 14], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.8874e+00, 3.7093e+00, 3.6487e+05, 3.8894e+00, 3.9940e+05,
         3.6626e+00, 3.9952e+00, 3.8410e+00, 3.8113e+00, 4.0079e+05, 3.9693e+05,
         4.0097e+05, 3.8424e+05, 3.9735e+05],
        [3.8874e+00, 0.0000e+00, 3.4891e+00, 3.6486e+05, 3.7211e+00, 3.9937e+05,
         3.5941e+00, 3.9176e+00, 3.7121e+00, 3.7625e+00, 4.0080e+05, 3.9686e+05,
         4.0093e+05, 3.8421e+05, 3.9737e+05],
        [3.7093e+00, 3.4891e+00, 0.0000e+00, 3.6493e+05, 3.8975e+00, 3.9942e+05,
         3.7810e+00, 3.9526e+00, 3.8732e+00, 3.9562e+00, 4.0078e+05, 3.9687e+05,
         4.0100e+05, 3.8423e+05, 3.9731e+05],
        [3.6487e+05, 3.6486e+05, 3.6493e+05, 0.0000e+00, 3.6492e+05, 7.6614e+05,
         3.6493e+05, 3.6491e+05, 3.6496e+05, 3.6491e+05, 7.7333e+05, 7.5993e+05,
         7.7480e+05, 7.5443e+05, 7.7293e+05],
        [3.8894e+00, 3.7211e+00, 3.8975e+00, 3.6492e+05, 0.0000e+00, 3.9940e+05,
         3.5349e+00, 3.8653e+00, 3.9061e+00, 3.5872e+00, 4.0083e+05, 3.9690e+05,
         4.0101e+05, 3.8425e+05, 3.9732e+05],
        [3.9940e+05, 3.9937e+05, 3.9942e+05, 7.6614e+05, 3.9940e+05, 0.0000e+00,
         3.9938e+05, 3.9939e+05, 3.9943e+05, 3.9939e+05, 8.0233e+05, 7.9485e+05,
         7.9540e+05, 7.8376e+05, 7.9806e+05],
        [3.6626e+00, 3.5941e+00, 3.7810e+00, 3.6493e+05, 3.5349e+00, 3.9938e+05,
         0.0000e+00, 3.7959e+00, 3.5976e+00, 3.5401e+00, 4.0085e+05, 3.9683e+05,
         4.0099e+05, 3.8423e+05, 3.9731e+05],
        [3.9952e+00, 3.9176e+00, 3.9526e+00, 3.6491e+05, 3.8653e+00, 3.9939e+05,
         3.7959e+00, 0.0000e+00, 3.9777e+00, 3.9939e+00, 4.0081e+05, 3.9688e+05,
         4.0093e+05, 3.8421e+05, 3.9729e+05],
        [3.8410e+00, 3.7121e+00, 3.8732e+00, 3.6496e+05, 3.9061e+00, 3.9943e+05,
         3.5976e+00, 3.9777e+00, 0.0000e+00, 3.9660e+00, 4.0079e+05, 3.9685e+05,
         4.0096e+05, 3.8429e+05, 3.9737e+05],
        [3.8113e+00, 3.7625e+00, 3.9562e+00, 3.6491e+05, 3.5872e+00, 3.9939e+05,
         3.5401e+00, 3.9939e+00, 3.9660e+00, 0.0000e+00, 4.0073e+05, 3.9688e+05,
         4.0093e+05, 3.8422e+05, 3.9731e+05],
        [4.0079e+05, 4.0080e+05, 4.0078e+05, 7.7333e+05, 4.0083e+05, 8.0233e+05,
         4.0085e+05, 4.0081e+05, 4.0079e+05, 4.0073e+05, 0.0000e+00, 7.8123e+05,
         8.0535e+05, 7.8754e+05, 8.0486e+05],
        [3.9693e+05, 3.9686e+05, 3.9687e+05, 7.5993e+05, 3.9690e+05, 7.9485e+05,
         3.9683e+05, 3.9688e+05, 3.9685e+05, 3.9688e+05, 7.8123e+05, 0.0000e+00,
         7.9684e+05, 7.8286e+05, 8.0321e+05],
        [4.0097e+05, 4.0093e+05, 4.0100e+05, 7.7480e+05, 4.0101e+05, 7.9540e+05,
         4.0099e+05, 4.0093e+05, 4.0096e+05, 4.0093e+05, 8.0535e+05, 7.9684e+05,
         0.0000e+00, 7.8155e+05, 8.0576e+05],
        [3.8424e+05, 3.8421e+05, 3.8423e+05, 7.5443e+05, 3.8425e+05, 7.8376e+05,
         3.8423e+05, 3.8421e+05, 3.8429e+05, 3.8422e+05, 7.8754e+05, 7.8286e+05,
         7.8155e+05, 0.0000e+00, 7.8494e+05],
        [3.9735e+05, 3.9737e+05, 3.9731e+05, 7.7293e+05, 3.9732e+05, 7.9806e+05,
         3.9731e+05, 3.9729e+05, 3.9737e+05, 3.9731e+05, 8.0486e+05, 8.0321e+05,
         8.0576e+05, 7.8494e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.6626e+00, 3.7093e+00, 3.8113e+00, 3.8410e+00, 3.8874e+00,
        3.8894e+00, 3.9952e+00, 3.6487e+05, 3.8424e+05, 3.9693e+05, 3.9735e+05,
        3.9940e+05, 4.0079e+05, 4.0097e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4891e+00, 3.5941e+00, 3.7121e+00, 3.7211e+00, 3.7625e+00,
        3.8874e+00, 3.9176e+00, 3.6486e+05, 3.8421e+05, 3.9686e+05, 3.9737e+05,
        3.9937e+05, 4.0080e+05, 4.0093e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4891e+00, 3.7093e+00, 3.7810e+00, 3.8732e+00, 3.8975e+00,
        3.9526e+00, 3.9562e+00, 3.6493e+05, 3.8423e+05, 3.9687e+05, 3.9731e+05,
        3.9942e+05, 4.0078e+05, 4.0100e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 364862.6250, 364866.3750, 364906.8438, 364909.6250,
        364917.4688, 364931.5312, 364933.3750, 364961.2500, 754434.6875,
        759927.0000, 766137.6250, 772931.7500, 773329.8125, 774798.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5349e+00, 3.5872e+00, 3.7211e+00, 3.8653e+00, 3.8894e+00,
        3.8975e+00, 3.9061e+00, 3.6492e+05, 3.8425e+05, 3.9690e+05, 3.9732e+05,
        3.9940e+05, 4.0083e+05, 4.0101e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 399366.8750, 399376.3750, 399386.0000, 399394.3438,
        399401.8125, 399402.4688, 399424.8125, 399426.8125, 766137.6250,
        783762.7500, 794845.1250, 795400.1875, 798058.5000, 802330.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5349e+00, 3.5401e+00, 3.5941e+00, 3.5976e+00, 3.6626e+00,
        3.7810e+00, 3.7959e+00, 3.6493e+05, 3.8423e+05, 3.9683e+05, 3.9731e+05,
        3.9938e+05, 4.0085e+05, 4.0099e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.7959e+00, 3.8653e+00, 3.9176e+00, 3.9526e+00, 3.9777e+00,
        3.9939e+00, 3.9952e+00, 3.6491e+05, 3.8421e+05, 3.9688e+05, 3.9729e+05,
        3.9939e+05, 4.0081e+05, 4.0093e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5976e+00, 3.7121e+00, 3.8410e+00, 3.8732e+00, 3.9061e+00,
        3.9660e+00, 3.9777e+00, 3.6496e+05, 3.8429e+05, 3.9685e+05, 3.9737e+05,
        3.9943e+05, 4.0079e+05, 4.0096e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5401e+00, 3.5872e+00, 3.7625e+00, 3.8113e+00, 3.9562e+00,
        3.9660e+00, 3.9939e+00, 3.6491e+05, 3.8422e+05, 3.9688e+05, 3.9731e+05,
        3.9939e+05, 4.0073e+05, 4.0093e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400731.6250, 400781.7500, 400787.1562, 400791.9062,
        400802.5000, 400805.4688, 400829.5312, 400849.0938, 773329.8125,
        781225.2500, 787535.6875, 802330.0625, 804864.6875, 805353.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396831.5312, 396849.7500, 396857.2188, 396867.2500,
        396882.7188, 396883.2500, 396897.6250, 396931.6250, 759927.0000,
        781225.2500, 782857.8750, 794845.1250, 796838.8125, 803211.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400929.0625, 400932.1250, 400934.7188, 400963.8438,
        400967.1875, 400990.7500, 400995.1562, 401005.3125, 774798.6250,
        781548.5625, 795400.1875, 796838.8125, 805353.8750, 805761.6875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 384207.4688, 384214.3438, 384216.7500, 384225.1562,
        384228.7500, 384235.5000, 384249.1875, 384287.4375, 754434.6875,
        781548.5625, 782857.8750, 783762.7500, 784938.1250, 787535.6875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397291.0938, 397307.5312, 397314.0938, 397314.5938,
        397319.1875, 397353.4062, 397367.1250, 397372.5938, 772931.7500,
        784938.1250, 798058.5000, 803211.5000, 804864.6875, 805761.6875])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['83236.52', '83233.67', '83242.59', '408191.53', '83243.67', '440146.38', '83243.08', '83237.98', '83252.84', '83239.22', '442189.88', '437214.25', '442501.84', '425366.59', '439063.53']
estimated f for each client, fs: [7, 7, 7, 6, 7, 5, 7, 7, 7, 7, 5, 5, 5, 5, 5]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [4, 1, 2, 20, 7, 19, 8, 9, 12, 5, 18, 13, 15, 16, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0134s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:01...
global Accuracy on shared test data: 53.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[139  98]
 [137 126]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:01, End: 2025-07-22 15:46:01)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [3, 7, 18, 15, 10, 19, 1, 6, 8, 2, 16, 4, 12, 5, 11], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.6992e+00, 3.8950e+05, 3.7021e+05, 3.7041e+00, 3.7962e+05,
         3.8221e+00, 3.9049e+00, 3.5794e+00, 3.8208e+00, 3.8613e+05, 3.9902e+00,
         3.7708e+00, 3.9214e+00, 4.0407e+00],
        [3.6992e+00, 0.0000e+00, 3.8948e+05, 3.7021e+05, 3.7438e+00, 3.7960e+05,
         3.7135e+00, 3.6778e+00, 3.6224e+00, 3.8889e+00, 3.8616e+05, 3.8807e+00,
         3.9293e+00, 3.5408e+00, 3.4808e+00],
        [3.8950e+05, 3.8948e+05, 0.0000e+00, 7.3825e+05, 3.8950e+05, 7.5448e+05,
         3.8948e+05, 3.8944e+05, 3.8943e+05, 3.8951e+05, 7.5595e+05, 3.8946e+05,
         3.8947e+05, 3.8957e+05, 3.8946e+05],
        [3.7021e+05, 3.7021e+05, 7.3825e+05, 0.0000e+00, 3.7019e+05, 7.3436e+05,
         3.7019e+05, 3.7017e+05, 3.7021e+05, 3.7023e+05, 7.6224e+05, 3.7021e+05,
         3.7018e+05, 3.7025e+05, 3.7022e+05],
        [3.7041e+00, 3.7438e+00, 3.8950e+05, 3.7019e+05, 0.0000e+00, 3.7959e+05,
         3.5703e+00, 3.4723e+00, 3.4001e+00, 3.6369e+00, 3.8611e+05, 3.3577e+00,
         3.6488e+00, 3.4227e+00, 3.6806e+00],
        [3.7962e+05, 3.7960e+05, 7.5448e+05, 7.3436e+05, 3.7959e+05, 0.0000e+00,
         3.7961e+05, 3.7954e+05, 3.7956e+05, 3.7959e+05, 7.7370e+05, 3.7954e+05,
         3.7954e+05, 3.7960e+05, 3.7958e+05],
        [3.8221e+00, 3.7135e+00, 3.8948e+05, 3.7019e+05, 3.5703e+00, 3.7961e+05,
         0.0000e+00, 4.0144e+00, 3.6233e+00, 3.4613e+00, 3.8615e+05, 3.8119e+00,
         3.7490e+00, 3.7395e+00, 3.7484e+00],
        [3.9049e+00, 3.6778e+00, 3.8944e+05, 3.7017e+05, 3.4723e+00, 3.7954e+05,
         4.0144e+00, 0.0000e+00, 3.4001e+00, 3.9218e+00, 3.8617e+05, 3.7815e+00,
         3.7601e+00, 3.7456e+00, 3.7351e+00],
        [3.5794e+00, 3.6224e+00, 3.8943e+05, 3.7021e+05, 3.4001e+00, 3.7956e+05,
         3.6233e+00, 3.4001e+00, 0.0000e+00, 3.7715e+00, 3.8612e+05, 3.6607e+00,
         3.6104e+00, 3.5762e+00, 3.7574e+00],
        [3.8208e+00, 3.8889e+00, 3.8951e+05, 3.7023e+05, 3.6369e+00, 3.7959e+05,
         3.4613e+00, 3.9218e+00, 3.7715e+00, 0.0000e+00, 3.8616e+05, 3.5828e+00,
         3.8336e+00, 3.9947e+00, 3.7412e+00],
        [3.8613e+05, 3.8616e+05, 7.5595e+05, 7.6224e+05, 3.8611e+05, 7.7370e+05,
         3.8615e+05, 3.8617e+05, 3.8612e+05, 3.8616e+05, 0.0000e+00, 3.8617e+05,
         3.8615e+05, 3.8614e+05, 3.8617e+05],
        [3.9902e+00, 3.8807e+00, 3.8946e+05, 3.7021e+05, 3.3577e+00, 3.7954e+05,
         3.8119e+00, 3.7815e+00, 3.6607e+00, 3.5828e+00, 3.8617e+05, 0.0000e+00,
         3.7822e+00, 3.7174e+00, 3.7913e+00],
        [3.7708e+00, 3.9293e+00, 3.8947e+05, 3.7018e+05, 3.6488e+00, 3.7954e+05,
         3.7490e+00, 3.7601e+00, 3.6104e+00, 3.8336e+00, 3.8615e+05, 3.7822e+00,
         0.0000e+00, 3.9532e+00, 3.9593e+00],
        [3.9214e+00, 3.5408e+00, 3.8957e+05, 3.7025e+05, 3.4227e+00, 3.7960e+05,
         3.7395e+00, 3.7456e+00, 3.5762e+00, 3.9947e+00, 3.8614e+05, 3.7174e+00,
         3.9532e+00, 0.0000e+00, 3.5001e+00],
        [4.0407e+00, 3.4808e+00, 3.8946e+05, 3.7022e+05, 3.6806e+00, 3.7958e+05,
         3.7484e+00, 3.7351e+00, 3.7574e+00, 3.7412e+00, 3.8617e+05, 3.7913e+00,
         3.9593e+00, 3.5001e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.5794e+00, 3.6992e+00, 3.7041e+00, 3.7708e+00, 3.8208e+00,
        3.8221e+00, 3.9049e+00, 3.9214e+00, 3.9902e+00, 4.0407e+00, 3.7021e+05,
        3.7962e+05, 3.8613e+05, 3.8950e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4808e+00, 3.5408e+00, 3.6224e+00, 3.6778e+00, 3.6992e+00,
        3.7135e+00, 3.7438e+00, 3.8807e+00, 3.8889e+00, 3.9293e+00, 3.7021e+05,
        3.7960e+05, 3.8616e+05, 3.8948e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389429.2188, 389436.2812, 389456.8438, 389462.5625,
        389468.4062, 389478.4688, 389479.5312, 389498.2812, 389499.7188,
        389507.9062, 389572.9062, 738248.2500, 754481.5000, 755947.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 370171.7188, 370179.3750, 370191.5000, 370194.0000,
        370205.9375, 370206.9375, 370209.5000, 370209.6250, 370222.4375,
        370227.1875, 370249.5312, 734356.7500, 738248.2500, 762237.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3577e+00, 3.4001e+00, 3.4227e+00, 3.4723e+00, 3.5703e+00,
        3.6369e+00, 3.6488e+00, 3.6806e+00, 3.7041e+00, 3.7438e+00, 3.7019e+05,
        3.7959e+05, 3.8611e+05, 3.8950e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 379536.0000, 379543.2500, 379543.7812, 379556.8125,
        379575.1562, 379588.1250, 379588.1875, 379597.3438, 379599.1875,
        379609.4688, 379618.1875, 734356.7500, 754481.5000, 773699.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4613e+00, 3.5703e+00, 3.6233e+00, 3.7135e+00, 3.7395e+00,
        3.7484e+00, 3.7490e+00, 3.8119e+00, 3.8221e+00, 4.0144e+00, 3.7019e+05,
        3.7961e+05, 3.8615e+05, 3.8948e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4001e+00, 3.4723e+00, 3.6778e+00, 3.7351e+00, 3.7456e+00,
        3.7601e+00, 3.7815e+00, 3.9049e+00, 3.9218e+00, 4.0144e+00, 3.7017e+05,
        3.7954e+05, 3.8617e+05, 3.8944e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4001e+00, 3.4001e+00, 3.5762e+00, 3.5794e+00, 3.6104e+00,
        3.6224e+00, 3.6233e+00, 3.6607e+00, 3.7574e+00, 3.7715e+00, 3.7021e+05,
        3.7956e+05, 3.8612e+05, 3.8943e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4613e+00, 3.5828e+00, 3.6369e+00, 3.7412e+00, 3.7715e+00,
        3.8208e+00, 3.8336e+00, 3.8889e+00, 3.9218e+00, 3.9947e+00, 3.7023e+05,
        3.7959e+05, 3.8616e+05, 3.8951e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386113.5000, 386117.9062, 386132.9375, 386144.3750,
        386148.2812, 386151.8750, 386157.5000, 386160.9375, 386165.8438,
        386172.8125, 386172.8125, 755947.8750, 762237.1875, 773699.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3577e+00, 3.5828e+00, 3.6607e+00, 3.7174e+00, 3.7815e+00,
        3.7822e+00, 3.7913e+00, 3.8119e+00, 3.8807e+00, 3.9902e+00, 3.7021e+05,
        3.7954e+05, 3.8617e+05, 3.8946e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.6104e+00, 3.6488e+00, 3.7490e+00, 3.7601e+00, 3.7708e+00,
        3.7822e+00, 3.8336e+00, 3.9293e+00, 3.9532e+00, 3.9593e+00, 3.7018e+05,
        3.7954e+05, 3.8615e+05, 3.8947e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4227e+00, 3.5001e+00, 3.5408e+00, 3.5762e+00, 3.7174e+00,
        3.7395e+00, 3.7456e+00, 3.9214e+00, 3.9532e+00, 3.9947e+00, 3.7025e+05,
        3.7960e+05, 3.8614e+05, 3.8957e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4808e+00, 3.5001e+00, 3.6806e+00, 3.7351e+00, 3.7412e+00,
        3.7484e+00, 3.7574e+00, 3.7913e+00, 3.9593e+00, 4.0407e+00, 3.7022e+05,
        3.7958e+05, 3.8617e+05, 3.8946e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['3.80', '3.69', '389480.97', '370206.22', '3.54', '379577.75', '3.69', '3.71', '3.58', '3.74', '386148.97', '3.71', '3.78', '3.68', '3.71']
estimated f for each client, fs: [5, 5, 2, 2, 5, 2, 5, 5, 5, 5, 2, 5, 5, 5, 5]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [3, 7, 18, 15, 10, 19, 1, 6, 8, 2, 16, 4, 12, 5, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0246s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:01...
global Accuracy on shared test data: 53.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[138  99]
 [133 130]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:01, End: 2025-07-22 15:46:01)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [20, 16, 7, 4, 17, 15, 14, 11, 13, 19, 10, 8, 2, 3, 1], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 7.7364e+05, 3.9128e+05, 3.9133e+05, 7.7347e+05, 7.9070e+05,
         7.9101e+05, 3.9131e+05, 7.8280e+05, 7.8440e+05, 3.9133e+05, 3.9131e+05,
         3.9130e+05, 3.9129e+05, 3.9127e+05],
        [7.7364e+05, 0.0000e+00, 3.8938e+05, 3.8934e+05, 7.7197e+05, 7.7173e+05,
         7.7587e+05, 3.8933e+05, 7.9185e+05, 7.7564e+05, 3.8934e+05, 3.8931e+05,
         3.8940e+05, 3.8932e+05, 3.8936e+05],
        [3.9128e+05, 3.8938e+05, 0.0000e+00, 3.8601e+00, 3.8939e+05, 3.8991e+05,
         3.9134e+05, 3.4356e+00, 3.8995e+05, 3.8563e+05, 3.7854e+00, 3.5704e+00,
         3.7406e+00, 3.6238e+00, 3.7029e+00],
        [3.9133e+05, 3.8934e+05, 3.8601e+00, 0.0000e+00, 3.8935e+05, 3.8993e+05,
         3.9130e+05, 3.7741e+00, 3.8990e+05, 3.8564e+05, 3.5060e+00, 3.7051e+00,
         3.5854e+00, 3.9312e+00, 3.8902e+00],
        [7.7347e+05, 7.7197e+05, 3.8939e+05, 3.8935e+05, 0.0000e+00, 7.6386e+05,
         8.0415e+05, 3.8935e+05, 7.7034e+05, 8.1318e+05, 3.8941e+05, 3.8931e+05,
         3.8942e+05, 3.8943e+05, 3.8939e+05],
        [7.9070e+05, 7.7173e+05, 3.8991e+05, 3.8993e+05, 7.6386e+05, 0.0000e+00,
         7.8052e+05, 3.8994e+05, 7.6005e+05, 7.4282e+05, 3.8989e+05, 3.8990e+05,
         3.8990e+05, 3.8991e+05, 3.8993e+05],
        [7.9101e+05, 7.7587e+05, 3.9134e+05, 3.9130e+05, 8.0415e+05, 7.8052e+05,
         0.0000e+00, 3.9132e+05, 7.9793e+05, 7.5311e+05, 3.9132e+05, 3.9133e+05,
         3.9136e+05, 3.9130e+05, 3.9134e+05],
        [3.9131e+05, 3.8933e+05, 3.4356e+00, 3.7741e+00, 3.8935e+05, 3.8994e+05,
         3.9132e+05, 0.0000e+00, 3.8993e+05, 3.8566e+05, 3.8080e+00, 3.8089e+00,
         3.7290e+00, 4.0204e+00, 3.8269e+00],
        [7.8280e+05, 7.9185e+05, 3.8995e+05, 3.8990e+05, 7.7034e+05, 7.6005e+05,
         7.9793e+05, 3.8993e+05, 0.0000e+00, 7.7288e+05, 3.8993e+05, 3.8997e+05,
         3.8995e+05, 3.8995e+05, 3.8996e+05],
        [7.8440e+05, 7.7564e+05, 3.8563e+05, 3.8564e+05, 8.1318e+05, 7.4282e+05,
         7.5311e+05, 3.8566e+05, 7.7288e+05, 0.0000e+00, 3.8565e+05, 3.8569e+05,
         3.8568e+05, 3.8560e+05, 3.8567e+05],
        [3.9133e+05, 3.8934e+05, 3.7854e+00, 3.5060e+00, 3.8941e+05, 3.8989e+05,
         3.9132e+05, 3.8080e+00, 3.8993e+05, 3.8565e+05, 0.0000e+00, 3.5470e+00,
         3.5776e+00, 3.8238e+00, 3.6500e+00],
        [3.9131e+05, 3.8931e+05, 3.5704e+00, 3.7051e+00, 3.8931e+05, 3.8990e+05,
         3.9133e+05, 3.8089e+00, 3.8997e+05, 3.8569e+05, 3.5470e+00, 0.0000e+00,
         3.8350e+00, 3.6039e+00, 3.5966e+00],
        [3.9130e+05, 3.8940e+05, 3.7406e+00, 3.5854e+00, 3.8942e+05, 3.8990e+05,
         3.9136e+05, 3.7290e+00, 3.8995e+05, 3.8568e+05, 3.5776e+00, 3.8350e+00,
         0.0000e+00, 3.7210e+00, 3.4595e+00],
        [3.9129e+05, 3.8932e+05, 3.6238e+00, 3.9312e+00, 3.8943e+05, 3.8991e+05,
         3.9130e+05, 4.0204e+00, 3.8995e+05, 3.8560e+05, 3.8238e+00, 3.6039e+00,
         3.7210e+00, 0.0000e+00, 3.8833e+00],
        [3.9127e+05, 3.8936e+05, 3.7029e+00, 3.8902e+00, 3.8939e+05, 3.8993e+05,
         3.9134e+05, 3.8269e+00, 3.8996e+05, 3.8567e+05, 3.6500e+00, 3.5966e+00,
         3.4595e+00, 3.8833e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 391270.4375, 391280.7812, 391289.8750, 391302.2812,
        391307.1875, 391307.4375, 391327.4062, 391328.9688, 773466.0000,
        773637.8750, 782796.1875, 784401.8125, 790697.8750, 791013.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389311.0938, 389315.1250, 389325.4062, 389336.3438,
        389340.3750, 389363.9375, 389381.6250, 389398.8750, 771731.2500,
        771967.5625, 773637.8750, 775637.6250, 775871.5000, 791846.3750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4356e+00, 3.5704e+00, 3.6238e+00, 3.7029e+00, 3.7406e+00,
        3.7854e+00, 3.8601e+00, 3.8563e+05, 3.8938e+05, 3.8939e+05, 3.8991e+05,
        3.8995e+05, 3.9128e+05, 3.9134e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5060e+00, 3.5854e+00, 3.7051e+00, 3.7741e+00, 3.8601e+00,
        3.8902e+00, 3.9312e+00, 3.8564e+05, 3.8934e+05, 3.8935e+05, 3.8990e+05,
        3.8993e+05, 3.9130e+05, 3.9133e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389306.0000, 389348.7500, 389352.7500, 389391.5625,
        389393.2812, 389407.9375, 389421.5625, 389430.1250, 763863.5000,
        770335.0000, 771967.5625, 773466.0000, 804152.0000, 813179.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389885.6875, 389901.6562, 389904.0625, 389910.8438,
        389913.6875, 389929.0938, 389930.3438, 389942.9375, 742821.8750,
        760052.8750, 763863.5000, 771731.2500, 780518.3750, 790697.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391298.1875, 391299.7188, 391315.3750, 391319.9375,
        391332.0625, 391335.2812, 391339.3125, 391357.6250, 753108.0000,
        775871.5000, 780518.3750, 791013.5000, 797929.1250, 804152.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4356e+00, 3.7290e+00, 3.7741e+00, 3.8080e+00, 3.8089e+00,
        3.8269e+00, 4.0204e+00, 3.8566e+05, 3.8933e+05, 3.8935e+05, 3.8993e+05,
        3.8994e+05, 3.9131e+05, 3.9132e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389895.6562, 389925.4688, 389929.8125, 389947.4688,
        389953.6875, 389954.2812, 389961.3125, 389967.3750, 760052.8750,
        770335.0000, 772881.3750, 782796.1875, 791846.3750, 797929.1250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 385599.6562, 385626.7812, 385640.3125, 385653.1250,
        385655.5625, 385667.2812, 385682.6875, 385686.6562, 742821.8750,
        753108.0000, 772881.3750, 775637.6250, 784401.8125, 813179.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5060e+00, 3.5470e+00, 3.5776e+00, 3.6500e+00, 3.7854e+00,
        3.8080e+00, 3.8238e+00, 3.8565e+05, 3.8934e+05, 3.8941e+05, 3.8989e+05,
        3.8993e+05, 3.9132e+05, 3.9133e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5470e+00, 3.5704e+00, 3.5966e+00, 3.6039e+00, 3.7051e+00,
        3.8089e+00, 3.8350e+00, 3.8569e+05, 3.8931e+05, 3.8931e+05, 3.8990e+05,
        3.8997e+05, 3.9131e+05, 3.9133e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4595e+00, 3.5776e+00, 3.5854e+00, 3.7210e+00, 3.7290e+00,
        3.7406e+00, 3.8350e+00, 3.8568e+05, 3.8940e+05, 3.8942e+05, 3.8990e+05,
        3.8995e+05, 3.9130e+05, 3.9136e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.6039e+00, 3.6238e+00, 3.7210e+00, 3.8238e+00, 3.8833e+00,
        3.9312e+00, 4.0204e+00, 3.8560e+05, 3.8932e+05, 3.8943e+05, 3.8991e+05,
        3.8995e+05, 3.9129e+05, 3.9130e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4595e+00, 3.5966e+00, 3.6500e+00, 3.7029e+00, 3.8269e+00,
        3.8833e+00, 3.8902e+00, 3.8567e+05, 3.8936e+05, 3.8939e+05, 3.8993e+05,
        3.8996e+05, 3.9127e+05, 3.9134e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['433764.47', '431833.81', '86114.91', '86111.44', '430990.59', '429126.69', '431522.88', '86111.94', '431065.31', '425337.12', '86113.24', '86113.15', '86123.02', '86104.61', '86117.48']
estimated f for each client, fs: [5, 5, 7, 7, 5, 5, 5, 7, 5, 5, 7, 7, 7, 7, 7]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']], selected_client_indices: [20, 16, 7, 4, 17, 15, 14, 11, 13, 19, 10, 8, 2, 3, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0320s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:02...
global Accuracy on shared test data: 53.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[137 100]
 [133 130]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:02, End: 2025-07-22 15:46:02)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [10, 3, 18, 4, 5, 14, 8, 16, 11, 12, 17, 6, 1, 19, 9, 7, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.9082e+00, 3.8557e+05, 3.5513e+00, 3.6065e+00, 3.9673e+05,
         3.5927e+00, 3.8932e+05, 3.8483e+00, 3.8009e+00, 3.9314e+05, 3.5584e+00,
         3.6909e+00, 3.8406e+05, 3.7862e+00, 3.7961e+00, 3.8972e+05],
        [3.9082e+00, 0.0000e+00, 3.8554e+05, 3.9726e+00, 3.9594e+00, 3.9674e+05,
         3.7132e+00, 3.8933e+05, 4.0339e+00, 3.8584e+00, 3.9309e+05, 4.0074e+00,
         3.9723e+00, 3.8407e+05, 4.0596e+00, 3.6534e+00, 3.8975e+05],
        [3.8557e+05, 3.8554e+05, 0.0000e+00, 3.8554e+05, 3.8561e+05, 7.8564e+05,
         3.8561e+05, 7.9453e+05, 3.8554e+05, 3.8558e+05, 7.6670e+05, 3.8555e+05,
         3.8551e+05, 7.5911e+05, 3.8558e+05, 3.8555e+05, 7.6572e+05],
        [3.5513e+00, 3.9726e+00, 3.8554e+05, 0.0000e+00, 3.7090e+00, 3.9671e+05,
         3.7403e+00, 3.8925e+05, 3.7941e+00, 3.9210e+00, 3.9315e+05, 3.8656e+00,
         3.9402e+00, 3.8413e+05, 4.0734e+00, 3.8608e+00, 3.8973e+05],
        [3.6065e+00, 3.9594e+00, 3.8561e+05, 3.7090e+00, 0.0000e+00, 3.9673e+05,
         3.6222e+00, 3.8930e+05, 3.6014e+00, 4.0065e+00, 3.9310e+05, 3.8635e+00,
         3.7852e+00, 3.8409e+05, 4.0258e+00, 3.6999e+00, 3.8969e+05],
        [3.9673e+05, 3.9674e+05, 7.8564e+05, 3.9671e+05, 3.9673e+05, 0.0000e+00,
         3.9674e+05, 7.6831e+05, 3.9671e+05, 3.9671e+05, 7.7275e+05, 3.9673e+05,
         3.9671e+05, 7.8909e+05, 3.9670e+05, 3.9673e+05, 8.0136e+05],
        [3.5927e+00, 3.7132e+00, 3.8561e+05, 3.7403e+00, 3.6222e+00, 3.9674e+05,
         0.0000e+00, 3.8931e+05, 3.8294e+00, 3.5820e+00, 3.9313e+05, 3.5265e+00,
         3.6217e+00, 3.8409e+05, 3.9799e+00, 3.6814e+00, 3.8975e+05],
        [3.8932e+05, 3.8933e+05, 7.9453e+05, 3.8925e+05, 3.8930e+05, 7.6831e+05,
         3.8931e+05, 0.0000e+00, 3.8932e+05, 3.8929e+05, 7.8716e+05, 3.8931e+05,
         3.8933e+05, 7.7937e+05, 3.8935e+05, 3.8929e+05, 7.5635e+05],
        [3.8483e+00, 4.0339e+00, 3.8554e+05, 3.7941e+00, 3.6014e+00, 3.9671e+05,
         3.8294e+00, 3.8932e+05, 0.0000e+00, 4.0403e+00, 3.9314e+05, 3.7655e+00,
         3.8753e+00, 3.8410e+05, 3.8619e+00, 3.4907e+00, 3.8966e+05],
        [3.8009e+00, 3.8584e+00, 3.8558e+05, 3.9210e+00, 4.0065e+00, 3.9671e+05,
         3.5820e+00, 3.8929e+05, 4.0403e+00, 0.0000e+00, 3.9311e+05, 3.9054e+00,
         3.8343e+00, 3.8409e+05, 4.0775e+00, 3.8703e+00, 3.8976e+05],
        [3.9314e+05, 3.9309e+05, 7.6670e+05, 3.9315e+05, 3.9310e+05, 7.7275e+05,
         3.9313e+05, 7.8716e+05, 3.9314e+05, 3.9311e+05, 0.0000e+00, 3.9317e+05,
         3.9307e+05, 7.7801e+05, 3.9315e+05, 3.9313e+05, 7.8660e+05],
        [3.5584e+00, 4.0074e+00, 3.8555e+05, 3.8656e+00, 3.8635e+00, 3.9673e+05,
         3.5265e+00, 3.8931e+05, 3.7655e+00, 3.9054e+00, 3.9317e+05, 0.0000e+00,
         4.0364e+00, 3.8412e+05, 4.1344e+00, 3.7650e+00, 3.8977e+05],
        [3.6909e+00, 3.9723e+00, 3.8551e+05, 3.9402e+00, 3.7852e+00, 3.9671e+05,
         3.6217e+00, 3.8933e+05, 3.8753e+00, 3.8343e+00, 3.9307e+05, 4.0364e+00,
         0.0000e+00, 3.8408e+05, 4.0356e+00, 3.7905e+00, 3.8970e+05],
        [3.8406e+05, 3.8407e+05, 7.5911e+05, 3.8413e+05, 3.8409e+05, 7.8909e+05,
         3.8409e+05, 7.7937e+05, 3.8410e+05, 3.8409e+05, 7.7801e+05, 3.8412e+05,
         3.8408e+05, 0.0000e+00, 3.8414e+05, 3.8409e+05, 7.5356e+05],
        [3.7862e+00, 4.0596e+00, 3.8558e+05, 4.0734e+00, 4.0258e+00, 3.9670e+05,
         3.9799e+00, 3.8935e+05, 3.8619e+00, 4.0775e+00, 3.9315e+05, 4.1344e+00,
         4.0356e+00, 3.8414e+05, 0.0000e+00, 3.9542e+00, 3.8970e+05],
        [3.7961e+00, 3.6534e+00, 3.8555e+05, 3.8608e+00, 3.6999e+00, 3.9673e+05,
         3.6814e+00, 3.8929e+05, 3.4907e+00, 3.8703e+00, 3.9313e+05, 3.7650e+00,
         3.7905e+00, 3.8409e+05, 3.9542e+00, 0.0000e+00, 3.8968e+05],
        [3.8972e+05, 3.8975e+05, 7.6572e+05, 3.8973e+05, 3.8969e+05, 8.0136e+05,
         3.8975e+05, 7.5635e+05, 3.8966e+05, 3.8976e+05, 7.8660e+05, 3.8977e+05,
         3.8970e+05, 7.5356e+05, 3.8970e+05, 3.8968e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.5513e+00, 3.5584e+00, 3.5927e+00, 3.6065e+00, 3.6909e+00,
        3.7862e+00, 3.7961e+00, 3.8009e+00, 3.8483e+00, 3.9082e+00, 3.8406e+05,
        3.8557e+05, 3.8932e+05, 3.8972e+05, 3.9314e+05, 3.9673e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6534e+00, 3.7132e+00, 3.8584e+00, 3.9082e+00, 3.9594e+00,
        3.9723e+00, 3.9726e+00, 4.0074e+00, 4.0339e+00, 4.0596e+00, 3.8407e+05,
        3.8554e+05, 3.8933e+05, 3.8975e+05, 3.9309e+05, 3.9674e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385514.6250, 385536.7500, 385541.5938, 385544.2188,
        385550.8125, 385550.8438, 385569.7188, 385577.3750, 385581.5000,
        385609.3750, 385609.7500, 759110.4375, 765716.8125, 766703.1250,
        785637.3125, 794528.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5513e+00, 3.7090e+00, 3.7403e+00, 3.7941e+00, 3.8608e+00,
        3.8656e+00, 3.9210e+00, 3.9402e+00, 3.9726e+00, 4.0734e+00, 3.8413e+05,
        3.8554e+05, 3.8925e+05, 3.8973e+05, 3.9315e+05, 3.9671e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6014e+00, 3.6065e+00, 3.6222e+00, 3.6999e+00, 3.7090e+00,
        3.7852e+00, 3.8635e+00, 3.9594e+00, 4.0065e+00, 4.0258e+00, 3.8409e+05,
        3.8561e+05, 3.8930e+05, 3.8969e+05, 3.9310e+05, 3.9673e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396701.1250, 396708.6250, 396710.3125, 396710.9688,
        396712.8750, 396726.5000, 396727.9375, 396729.0625, 396729.3125,
        396741.8750, 396742.0000, 768308.2500, 772751.6250, 785637.3125,
        789089.4375, 801356.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5265e+00, 3.5820e+00, 3.5927e+00, 3.6217e+00, 3.6222e+00,
        3.6814e+00, 3.7132e+00, 3.7403e+00, 3.8294e+00, 3.9799e+00, 3.8409e+05,
        3.8561e+05, 3.8931e+05, 3.8975e+05, 3.9313e+05, 3.9674e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389253.8750, 389286.6875, 389291.8438, 389303.8125,
        389312.3750, 389312.6562, 389320.5312, 389324.3750, 389332.1250,
        389332.6250, 389350.4062, 756349.3125, 768308.2500, 779370.6875,
        787163.2500, 794528.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4907e+00, 3.6014e+00, 3.7655e+00, 3.7941e+00, 3.8294e+00,
        3.8483e+00, 3.8619e+00, 3.8753e+00, 4.0339e+00, 4.0403e+00, 3.8410e+05,
        3.8554e+05, 3.8932e+05, 3.8966e+05, 3.9314e+05, 3.9671e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5820e+00, 3.8009e+00, 3.8343e+00, 3.8584e+00, 3.8703e+00,
        3.9054e+00, 3.9210e+00, 4.0065e+00, 4.0403e+00, 4.0775e+00, 3.8409e+05,
        3.8558e+05, 3.8929e+05, 3.8976e+05, 3.9311e+05, 3.9671e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393071.3125, 393094.1875, 393097.8438, 393107.0625,
        393127.0625, 393132.6875, 393137.1250, 393139.1250, 393149.8438,
        393150.8750, 393171.3438, 766703.1250, 772751.6250, 778009.9375,
        786597.1250, 787163.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5265e+00, 3.5584e+00, 3.7650e+00, 3.7655e+00, 3.8635e+00,
        3.8656e+00, 3.9054e+00, 4.0074e+00, 4.0364e+00, 4.1344e+00, 3.8412e+05,
        3.8555e+05, 3.8931e+05, 3.8977e+05, 3.9317e+05, 3.9673e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6217e+00, 3.6909e+00, 3.7852e+00, 3.7905e+00, 3.8343e+00,
        3.8753e+00, 3.9402e+00, 3.9723e+00, 4.0356e+00, 4.0364e+00, 3.8408e+05,
        3.8551e+05, 3.8933e+05, 3.8970e+05, 3.9307e+05, 3.9671e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384062.1875, 384073.9062, 384075.2812, 384086.9688,
        384087.9062, 384089.3750, 384092.6562, 384102.5000, 384124.8750,
        384129.3750, 384135.3750, 753560.9375, 759110.4375, 778009.9375,
        779370.6875, 789089.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.7862e+00, 3.8619e+00, 3.9542e+00, 3.9799e+00, 4.0258e+00,
        4.0356e+00, 4.0596e+00, 4.0734e+00, 4.0775e+00, 4.1344e+00, 3.8414e+05,
        3.8558e+05, 3.8935e+05, 3.8970e+05, 3.9315e+05, 3.9670e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4907e+00, 3.6534e+00, 3.6814e+00, 3.6999e+00, 3.7650e+00,
        3.7905e+00, 3.7961e+00, 3.8608e+00, 3.8703e+00, 3.9542e+00, 3.8409e+05,
        3.8555e+05, 3.8929e+05, 3.8968e+05, 3.9313e+05, 3.9673e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389661.2812, 389678.3750, 389691.8750, 389699.5000,
        389702.6250, 389715.6875, 389730.0938, 389746.4375, 389746.6250,
        389764.0000, 389766.0938, 753560.9375, 756349.3125, 765716.8125,
        786597.1250, 801356.7500])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['3.71', '3.91', '385562.41', '3.84', '3.79', '396721.88', '3.69', '389311.06', '3.81', '3.89', '393125.31', '3.84', '3.86', '384096.38', '4.00', '3.76', '389718.41']
estimated f for each client, fs: [6, 6, 4, 6, 6, 4, 6, 4, 6, 6, 4, 6, 6, 4, 6, 6, 4]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [10, 3, 18, 4, 5, 14, 8, 16, 11, 12, 17, 6, 1, 19, 9, 7, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0129s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:03...
global Accuracy on shared test data: 53.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[138  99]
 [134 129]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:03, End: 2025-07-22 15:46:03)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [6, 5], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 3.8441],
        [3.8441, 0.0000]])
sorted_distances: tensor([0.0000, 3.8441])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000, 3.8441])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['3.84', '3.84']
estimated f for each client, fs: [1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [6, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0015s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:03...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[140  97]
 [134 129]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:03, End: 2025-07-22 15:46:03)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [20, 10], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[     0.0000, 379738.9062],
        [379738.9062,      0.0000]])
sorted_distances: tensor([     0.0000, 379738.9062])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([     0.0000, 379738.9062])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['379738.91', '379738.91']
estimated f for each client, fs: [1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [20, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0015s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:03...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[206  31]
 [236  27]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:03, End: 2025-07-22 15:46:03)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [9, 18, 20, 3, 13, 17, 5, 2, 11, 7, 4, 10, 6, 16, 14, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9940e+05, 4.0167e+05, 3.6568e+00, 3.9794e+05, 3.8912e+05,
         3.6717e+00, 3.6247e+00, 3.4816e+00, 3.9969e+00, 3.6821e+00, 3.7254e+00,
         3.7474e+00, 3.8893e+05, 3.7964e+05, 4.0023e+00],
        [3.9940e+05, 0.0000e+00, 8.0535e+05, 3.9944e+05, 8.0971e+05, 7.9341e+05,
         3.9944e+05, 3.9942e+05, 3.9941e+05, 3.9942e+05, 3.9942e+05, 3.9944e+05,
         3.9943e+05, 7.7809e+05, 7.8544e+05, 3.9945e+05],
        [4.0167e+05, 8.0535e+05, 0.0000e+00, 4.0168e+05, 8.0277e+05, 7.9760e+05,
         4.0171e+05, 4.0171e+05, 4.0170e+05, 4.0173e+05, 4.0171e+05, 4.0173e+05,
         4.0168e+05, 8.1036e+05, 7.6973e+05, 4.0170e+05],
        [3.6568e+00, 3.9944e+05, 4.0168e+05, 0.0000e+00, 3.9797e+05, 3.8908e+05,
         3.4643e+00, 3.9191e+00, 3.5510e+00, 3.4389e+00, 3.4172e+00, 3.7767e+00,
         3.4827e+00, 3.8894e+05, 3.7963e+05, 3.7356e+00],
        [3.9794e+05, 8.0971e+05, 8.0277e+05, 3.9797e+05, 0.0000e+00, 7.9298e+05,
         3.9796e+05, 3.9787e+05, 3.9798e+05, 3.9796e+05, 3.9794e+05, 3.9795e+05,
         3.9794e+05, 7.9700e+05, 7.8757e+05, 3.9795e+05],
        [3.8912e+05, 7.9341e+05, 7.9760e+05, 3.8908e+05, 7.9298e+05, 0.0000e+00,
         3.8907e+05, 3.8914e+05, 3.8910e+05, 3.8911e+05, 3.8909e+05, 3.8907e+05,
         3.8911e+05, 8.1077e+05, 7.5698e+05, 3.8915e+05],
        [3.6717e+00, 3.9944e+05, 4.0171e+05, 3.4643e+00, 3.9796e+05, 3.8907e+05,
         0.0000e+00, 3.9161e+00, 3.4899e+00, 3.4929e+00, 3.5926e+00, 3.6638e+00,
         3.3676e+00, 3.8896e+05, 3.7959e+05, 3.8884e+00],
        [3.6247e+00, 3.9942e+05, 4.0171e+05, 3.9191e+00, 3.9787e+05, 3.8914e+05,
         3.9161e+00, 0.0000e+00, 3.6279e+00, 3.7283e+00, 3.9445e+00, 3.5885e+00,
         3.6177e+00, 3.8896e+05, 3.7964e+05, 4.1102e+00],
        [3.4816e+00, 3.9941e+05, 4.0170e+05, 3.5510e+00, 3.9798e+05, 3.8910e+05,
         3.4899e+00, 3.6279e+00, 0.0000e+00, 3.5140e+00, 3.4434e+00, 3.3128e+00,
         3.4400e+00, 3.8894e+05, 3.7965e+05, 3.6370e+00],
        [3.9969e+00, 3.9942e+05, 4.0173e+05, 3.4389e+00, 3.9796e+05, 3.8911e+05,
         3.4929e+00, 3.7283e+00, 3.5140e+00, 0.0000e+00, 3.7792e+00, 3.6308e+00,
         3.6790e+00, 3.8897e+05, 3.7964e+05, 3.9265e+00],
        [3.6821e+00, 3.9942e+05, 4.0171e+05, 3.4172e+00, 3.9794e+05, 3.8909e+05,
         3.5926e+00, 3.9445e+00, 3.4434e+00, 3.7792e+00, 0.0000e+00, 3.6161e+00,
         3.5271e+00, 3.8898e+05, 3.7963e+05, 4.0053e+00],
        [3.7254e+00, 3.9944e+05, 4.0173e+05, 3.7767e+00, 3.9795e+05, 3.8907e+05,
         3.6638e+00, 3.5885e+00, 3.3128e+00, 3.6308e+00, 3.6161e+00, 0.0000e+00,
         3.6093e+00, 3.8892e+05, 3.7961e+05, 3.9734e+00],
        [3.7474e+00, 3.9943e+05, 4.0168e+05, 3.4827e+00, 3.9794e+05, 3.8911e+05,
         3.3676e+00, 3.6177e+00, 3.4400e+00, 3.6790e+00, 3.5271e+00, 3.6093e+00,
         0.0000e+00, 3.8893e+05, 3.7965e+05, 3.7920e+00],
        [3.8893e+05, 7.7809e+05, 8.1036e+05, 3.8894e+05, 7.9700e+05, 8.1077e+05,
         3.8896e+05, 3.8896e+05, 3.8894e+05, 3.8897e+05, 3.8898e+05, 3.8892e+05,
         3.8893e+05, 0.0000e+00, 8.0069e+05, 3.8895e+05],
        [3.7964e+05, 7.8544e+05, 7.6973e+05, 3.7963e+05, 7.8757e+05, 7.5698e+05,
         3.7959e+05, 3.7964e+05, 3.7965e+05, 3.7964e+05, 3.7963e+05, 3.7961e+05,
         3.7965e+05, 8.0069e+05, 0.0000e+00, 3.7964e+05],
        [4.0023e+00, 3.9945e+05, 4.0170e+05, 3.7356e+00, 3.9795e+05, 3.8915e+05,
         3.8884e+00, 4.1102e+00, 3.6370e+00, 3.9265e+00, 4.0053e+00, 3.9734e+00,
         3.7920e+00, 3.8895e+05, 3.7964e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.4816e+00, 3.6247e+00, 3.6568e+00, 3.6717e+00, 3.6821e+00,
        3.7254e+00, 3.7474e+00, 3.9969e+00, 4.0023e+00, 3.7964e+05, 3.8893e+05,
        3.8912e+05, 3.9794e+05, 3.9940e+05, 4.0167e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399403.4062, 399406.3438, 399415.1250, 399415.2188,
        399419.4375, 399432.2812, 399439.4375, 399441.7812, 399441.8438,
        399446.6250, 778089.1250, 785442.9375, 793409.2500, 805350.3125,
        809710.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401671.9375, 401681.5312, 401681.6875, 401697.9688,
        401704.9062, 401708.5000, 401708.5938, 401710.2812, 401726.5312,
        401728.7500, 769725.1250, 797600.8750, 802770.1875, 805350.3125,
        810356.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4172e+00, 3.4389e+00, 3.4643e+00, 3.4827e+00, 3.5510e+00,
        3.6568e+00, 3.7356e+00, 3.7767e+00, 3.9191e+00, 3.7963e+05, 3.8894e+05,
        3.8908e+05, 3.9797e+05, 3.9944e+05, 4.0168e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397865.7188, 397940.0000, 397940.3750, 397941.0625,
        397951.6250, 397954.6875, 397964.6562, 397964.7812, 397965.8750,
        397979.0000, 787569.1250, 792976.1250, 797001.0000, 802770.1875,
        809710.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389065.0312, 389073.8125, 389078.5625, 389086.6250,
        389096.6562, 389108.5312, 389112.2500, 389120.2500, 389142.9688,
        389149.0312, 756983.0000, 792976.1250, 793409.2500, 797600.8750,
        810771.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3676e+00, 3.4643e+00, 3.4899e+00, 3.4929e+00, 3.5926e+00,
        3.6638e+00, 3.6717e+00, 3.8884e+00, 3.9161e+00, 3.7959e+05, 3.8896e+05,
        3.8907e+05, 3.9796e+05, 3.9944e+05, 4.0171e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5885e+00, 3.6177e+00, 3.6247e+00, 3.6279e+00, 3.7283e+00,
        3.9161e+00, 3.9191e+00, 3.9445e+00, 4.1102e+00, 3.7964e+05, 3.8896e+05,
        3.8914e+05, 3.9787e+05, 3.9942e+05, 4.0171e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3128e+00, 3.4400e+00, 3.4434e+00, 3.4816e+00, 3.4899e+00,
        3.5140e+00, 3.5510e+00, 3.6279e+00, 3.6370e+00, 3.7965e+05, 3.8894e+05,
        3.8910e+05, 3.9798e+05, 3.9941e+05, 4.0170e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4389e+00, 3.4929e+00, 3.5140e+00, 3.6308e+00, 3.6790e+00,
        3.7283e+00, 3.7792e+00, 3.9265e+00, 3.9969e+00, 3.7964e+05, 3.8897e+05,
        3.8911e+05, 3.9796e+05, 3.9942e+05, 4.0173e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4172e+00, 3.4434e+00, 3.5271e+00, 3.5926e+00, 3.6161e+00,
        3.6821e+00, 3.7792e+00, 3.9445e+00, 4.0053e+00, 3.7963e+05, 3.8898e+05,
        3.8909e+05, 3.9794e+05, 3.9942e+05, 4.0171e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3128e+00, 3.5885e+00, 3.6093e+00, 3.6161e+00, 3.6308e+00,
        3.6638e+00, 3.7254e+00, 3.7767e+00, 3.9734e+00, 3.7961e+05, 3.8892e+05,
        3.8907e+05, 3.9795e+05, 3.9944e+05, 4.0173e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3676e+00, 3.4400e+00, 3.4827e+00, 3.5271e+00, 3.6093e+00,
        3.6177e+00, 3.6790e+00, 3.7474e+00, 3.7920e+00, 3.7965e+05, 3.8893e+05,
        3.8911e+05, 3.9794e+05, 3.9943e+05, 4.0168e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388919.2188, 388926.5625, 388929.4062, 388938.5312,
        388942.1562, 388948.4375, 388956.3125, 388958.4688, 388968.6562,
        388978.8125, 778089.1250, 797001.0000, 800690.3125, 810356.8125,
        810771.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379588.8125, 379608.1250, 379627.6562, 379629.6562,
        379637.5312, 379640.5312, 379641.0312, 379642.2812, 379653.3438,
        379654.3750, 756983.0000, 769725.1250, 785442.9375, 787569.1250,
        800690.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6370e+00, 3.7356e+00, 3.7920e+00, 3.8884e+00, 3.9265e+00,
        3.9734e+00, 4.0023e+00, 4.0053e+00, 4.1102e+00, 3.7964e+05, 3.8895e+05,
        3.8915e+05, 3.9795e+05, 3.9945e+05, 4.0170e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37967.59', '399426.16', '401702.06', '37966.01', '397946.78', '389103.38', '37962.13', '37967.46', '37968.48', '37967.42', '37966.27', '37964.10', '37968.66', '388946.69', '379632.31', '37967.26']
estimated f for each client, fs: [6, 4, 4, 6, 4, 4, 6, 6, 6, 6, 6, 6, 6, 5, 4, 6]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 18, 20, 3, 13, 17, 5, 2, 11, 7, 4, 10, 6, 16, 14, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0104s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:04...
global Accuracy on shared test data: 45.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[200  37]
 [234  29]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:04, End: 2025-07-22 15:46:04)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [9, 18, 16, 20, 2, 4, 19, 1, 11, 17, 15, 5, 7, 13, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 4.1193e+05, 3.9992e+05, 3.9250e+05, 3.5446e+00, 3.6659e+00,
         3.8649e+05, 3.8107e+00, 3.5801e+00, 3.9336e+05, 4.0044e+05, 3.8896e+00,
         4.0921e+00, 3.9941e+05, 3.6571e+00],
        [4.1193e+05, 0.0000e+00, 7.9885e+05, 7.6727e+05, 4.1193e+05, 4.1195e+05,
         8.1548e+05, 4.1196e+05, 4.1199e+05, 7.8644e+05, 7.9344e+05, 4.1190e+05,
         4.1197e+05, 8.3152e+05, 4.1199e+05],
        [3.9992e+05, 7.9885e+05, 0.0000e+00, 7.8801e+05, 4.0001e+05, 4.0003e+05,
         8.0058e+05, 3.9998e+05, 4.0000e+05, 7.8789e+05, 7.8295e+05, 3.9997e+05,
         4.0000e+05, 8.1513e+05, 4.0002e+05],
        [3.9250e+05, 7.6727e+05, 7.8801e+05, 0.0000e+00, 3.9249e+05, 3.9250e+05,
         7.8575e+05, 3.9248e+05, 3.9253e+05, 7.8396e+05, 8.0807e+05, 3.9250e+05,
         3.9250e+05, 7.8380e+05, 3.9255e+05],
        [3.5446e+00, 4.1193e+05, 4.0001e+05, 3.9249e+05, 0.0000e+00, 3.8036e+00,
         3.8649e+05, 3.5450e+00, 3.6197e+00, 3.9333e+05, 4.0045e+05, 3.8942e+00,
         3.7103e+00, 3.9942e+05, 3.8226e+00],
        [3.6659e+00, 4.1195e+05, 4.0003e+05, 3.9250e+05, 3.8036e+00, 0.0000e+00,
         3.8654e+05, 3.6616e+00, 3.4155e+00, 3.9332e+05, 4.0043e+05, 3.6995e+00,
         3.7112e+00, 3.9942e+05, 3.4087e+00],
        [3.8649e+05, 8.1548e+05, 8.0058e+05, 7.8575e+05, 3.8649e+05, 3.8654e+05,
         0.0000e+00, 3.8647e+05, 3.8652e+05, 7.7327e+05, 7.8490e+05, 3.8645e+05,
         3.8653e+05, 7.6942e+05, 3.8654e+05],
        [3.8107e+00, 4.1196e+05, 3.9998e+05, 3.9248e+05, 3.5450e+00, 3.6616e+00,
         3.8647e+05, 0.0000e+00, 3.6997e+00, 3.9338e+05, 4.0045e+05, 3.8750e+00,
         3.5184e+00, 3.9942e+05, 4.0160e+00],
        [3.5801e+00, 4.1199e+05, 4.0000e+05, 3.9253e+05, 3.6197e+00, 3.4155e+00,
         3.8652e+05, 3.6997e+00, 0.0000e+00, 3.9330e+05, 4.0043e+05, 3.5831e+00,
         3.5521e+00, 3.9940e+05, 3.5503e+00],
        [3.9336e+05, 7.8644e+05, 7.8789e+05, 7.8396e+05, 3.9333e+05, 3.9332e+05,
         7.7327e+05, 3.9338e+05, 3.9330e+05, 0.0000e+00, 7.7883e+05, 3.9330e+05,
         3.9335e+05, 7.7427e+05, 3.9332e+05],
        [4.0044e+05, 7.9344e+05, 7.8295e+05, 8.0807e+05, 4.0045e+05, 4.0043e+05,
         7.8490e+05, 4.0045e+05, 4.0043e+05, 7.7883e+05, 0.0000e+00, 4.0041e+05,
         4.0047e+05, 7.9283e+05, 4.0042e+05],
        [3.8896e+00, 4.1190e+05, 3.9997e+05, 3.9250e+05, 3.8942e+00, 3.6995e+00,
         3.8645e+05, 3.8750e+00, 3.5831e+00, 3.9330e+05, 4.0041e+05, 0.0000e+00,
         3.5064e+00, 3.9943e+05, 3.5227e+00],
        [4.0921e+00, 4.1197e+05, 4.0000e+05, 3.9250e+05, 3.7103e+00, 3.7112e+00,
         3.8653e+05, 3.5184e+00, 3.5521e+00, 3.9335e+05, 4.0047e+05, 3.5064e+00,
         0.0000e+00, 3.9944e+05, 3.4785e+00],
        [3.9941e+05, 8.3152e+05, 8.1513e+05, 7.8380e+05, 3.9942e+05, 3.9942e+05,
         7.6942e+05, 3.9942e+05, 3.9940e+05, 7.7427e+05, 7.9283e+05, 3.9943e+05,
         3.9944e+05, 0.0000e+00, 3.9940e+05],
        [3.6571e+00, 4.1199e+05, 4.0002e+05, 3.9255e+05, 3.8226e+00, 3.4087e+00,
         3.8654e+05, 4.0160e+00, 3.5503e+00, 3.9332e+05, 4.0042e+05, 3.5227e+00,
         3.4785e+00, 3.9940e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.5446e+00, 3.5801e+00, 3.6571e+00, 3.6659e+00, 3.8107e+00,
        3.8896e+00, 4.0921e+00, 3.8649e+05, 3.9250e+05, 3.9336e+05, 3.9941e+05,
        3.9992e+05, 4.0044e+05, 4.1193e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 411902.6875, 411931.3438, 411934.4375, 411946.1875,
        411955.1250, 411974.6250, 411988.6875, 411989.0938, 767274.3750,
        786442.2500, 793441.1875, 798852.4375, 815477.0000, 831519.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 399920.5938, 399965.4375, 399977.0000, 399996.7812,
        400002.8750, 400010.6562, 400015.4375, 400028.3438, 782950.6875,
        787890.5000, 788013.7500, 798852.4375, 800579.5000, 815130.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 392477.0938, 392492.7812, 392496.1875, 392497.4688,
        392503.0000, 392503.8750, 392533.5938, 392550.3438, 767274.3750,
        783798.8750, 783958.0000, 785754.5000, 788013.7500, 808070.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5446e+00, 3.5450e+00, 3.6197e+00, 3.7103e+00, 3.8036e+00,
        3.8226e+00, 3.8942e+00, 3.8649e+05, 3.9249e+05, 3.9333e+05, 3.9942e+05,
        4.0001e+05, 4.0045e+05, 4.1193e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4087e+00, 3.4155e+00, 3.6616e+00, 3.6659e+00, 3.6995e+00,
        3.7112e+00, 3.8036e+00, 3.8654e+05, 3.9250e+05, 3.9332e+05, 3.9942e+05,
        4.0003e+05, 4.0043e+05, 4.1195e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386445.6250, 386472.7812, 386490.3125, 386491.2188,
        386519.3438, 386530.0625, 386536.6250, 386541.1250, 769415.9375,
        773269.2500, 784897.3125, 785754.5000, 800579.5000, 815477.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5184e+00, 3.5450e+00, 3.6616e+00, 3.6997e+00, 3.8107e+00,
        3.8750e+00, 4.0160e+00, 3.8647e+05, 3.9248e+05, 3.9338e+05, 3.9942e+05,
        3.9998e+05, 4.0045e+05, 4.1196e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4155e+00, 3.5503e+00, 3.5521e+00, 3.5801e+00, 3.5831e+00,
        3.6197e+00, 3.6997e+00, 3.8652e+05, 3.9253e+05, 3.9330e+05, 3.9940e+05,
        4.0000e+05, 4.0043e+05, 4.1199e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393299.6250, 393300.8750, 393320.4375, 393320.7500,
        393325.4375, 393354.6250, 393357.3750, 393377.8438, 773269.2500,
        774268.2500, 778832.7500, 783958.0000, 786442.2500, 787890.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400413.1875, 400422.9688, 400426.2500, 400432.2500,
        400444.0625, 400448.8438, 400449.6875, 400467.2500, 778832.7500,
        782950.6875, 784897.3125, 792831.9375, 793441.1875, 808070.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5064e+00, 3.5227e+00, 3.5831e+00, 3.6995e+00, 3.8750e+00,
        3.8896e+00, 3.8942e+00, 3.8645e+05, 3.9250e+05, 3.9330e+05, 3.9943e+05,
        3.9997e+05, 4.0041e+05, 4.1190e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4785e+00, 3.5064e+00, 3.5184e+00, 3.5521e+00, 3.7103e+00,
        3.7112e+00, 4.0921e+00, 3.8653e+05, 3.9250e+05, 3.9335e+05, 3.9944e+05,
        4.0000e+05, 4.0047e+05, 4.1197e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 399399.5625, 399404.0000, 399406.6250, 399416.1250,
        399423.1250, 399424.6250, 399429.5625, 399440.2500, 769415.9375,
        774268.2500, 783798.8750, 792831.9375, 815130.5625, 831519.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4087e+00, 3.4785e+00, 3.5227e+00, 3.5503e+00, 3.6571e+00,
        3.8226e+00, 4.0160e+00, 3.8654e+05, 3.9255e+05, 3.9332e+05, 3.9940e+05,
        4.0002e+05, 4.0042e+05, 4.1199e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['86557.07', '451432.94', '442540.88', '434147.62', '86556.56', '86563.38', '429049.19', '86552.89', '86564.22', '435547.38', '442481.91', '86552.12', '86562.07', '440528.88', '86568.05']
estimated f for each client, fs: [7, 5, 5, 5, 7, 7, 5, 7, 7, 5, 5, 7, 7, 5, 7]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [9, 18, 16, 20, 2, 4, 19, 1, 11, 17, 15, 5, 7, 13, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0139s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:04...
global Accuracy on shared test data: 44.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [227  36]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:04, End: 2025-07-22 15:46:04)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [5, 9, 11, 14, 18, 19, 2, 15, 1, 10, 16, 6, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.9835e+00, 3.5687e+00, 3.8641e+05, 4.0452e+05, 4.0736e+05,
         3.8777e+00, 3.9335e+05, 3.9636e+00, 3.5642e+00, 3.9296e+05, 3.4821e+00,
         3.8179e+05],
        [3.9835e+00, 0.0000e+00, 3.7993e+00, 3.8641e+05, 4.0456e+05, 4.0738e+05,
         3.5960e+00, 3.9327e+05, 3.9073e+00, 3.8708e+00, 3.9289e+05, 3.8261e+00,
         3.8182e+05],
        [3.5687e+00, 3.7993e+00, 0.0000e+00, 3.8640e+05, 4.0453e+05, 4.0740e+05,
         3.7205e+00, 3.9335e+05, 3.7445e+00, 3.4174e+00, 3.9296e+05, 3.4720e+00,
         3.8180e+05],
        [3.8641e+05, 3.8641e+05, 3.8640e+05, 0.0000e+00, 7.7981e+05, 8.1136e+05,
         3.8642e+05, 7.6860e+05, 3.8637e+05, 3.8637e+05, 7.8578e+05, 3.8639e+05,
         7.6321e+05],
        [4.0452e+05, 4.0456e+05, 4.0453e+05, 7.7981e+05, 0.0000e+00, 8.2648e+05,
         4.0455e+05, 8.0690e+05, 4.0453e+05, 4.0451e+05, 7.8241e+05, 4.0451e+05,
         7.9105e+05],
        [4.0736e+05, 4.0738e+05, 4.0740e+05, 8.1136e+05, 8.2648e+05, 0.0000e+00,
         4.0736e+05, 7.7585e+05, 4.0734e+05, 4.0738e+05, 8.0579e+05, 4.0731e+05,
         7.8990e+05],
        [3.8777e+00, 3.5960e+00, 3.7205e+00, 3.8642e+05, 4.0455e+05, 4.0736e+05,
         0.0000e+00, 3.9330e+05, 3.5864e+00, 3.5661e+00, 3.9301e+05, 3.6557e+00,
         3.8181e+05],
        [3.9335e+05, 3.9327e+05, 3.9335e+05, 7.6860e+05, 8.0690e+05, 7.7585e+05,
         3.9330e+05, 0.0000e+00, 3.9327e+05, 3.9332e+05, 7.8642e+05, 3.9331e+05,
         7.7307e+05],
        [3.9636e+00, 3.9073e+00, 3.7445e+00, 3.8637e+05, 4.0453e+05, 4.0734e+05,
         3.5864e+00, 3.9327e+05, 0.0000e+00, 3.3874e+00, 3.9296e+05, 3.7757e+00,
         3.8176e+05],
        [3.5642e+00, 3.8708e+00, 3.4174e+00, 3.8637e+05, 4.0451e+05, 4.0738e+05,
         3.5661e+00, 3.9332e+05, 3.3874e+00, 0.0000e+00, 3.9296e+05, 3.5530e+00,
         3.8176e+05],
        [3.9296e+05, 3.9289e+05, 3.9296e+05, 7.8578e+05, 7.8241e+05, 8.0579e+05,
         3.9301e+05, 7.8642e+05, 3.9296e+05, 3.9296e+05, 0.0000e+00, 3.9297e+05,
         7.7096e+05],
        [3.4821e+00, 3.8261e+00, 3.4720e+00, 3.8639e+05, 4.0451e+05, 4.0731e+05,
         3.6557e+00, 3.9331e+05, 3.7757e+00, 3.5530e+00, 3.9297e+05, 0.0000e+00,
         3.8182e+05],
        [3.8179e+05, 3.8182e+05, 3.8180e+05, 7.6321e+05, 7.9105e+05, 7.8990e+05,
         3.8181e+05, 7.7307e+05, 3.8176e+05, 3.8176e+05, 7.7096e+05, 3.8182e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.4821e+00, 3.5642e+00, 3.5687e+00, 3.8777e+00, 3.9636e+00,
        3.9835e+00, 3.8179e+05, 3.8641e+05, 3.9296e+05, 3.9335e+05, 4.0452e+05,
        4.0736e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.5960e+00, 3.7993e+00, 3.8261e+00, 3.8708e+00, 3.9073e+00,
        3.9835e+00, 3.8182e+05, 3.8641e+05, 3.9289e+05, 3.9327e+05, 4.0456e+05,
        4.0738e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.4174e+00, 3.4720e+00, 3.5687e+00, 3.7205e+00, 3.7445e+00,
        3.7993e+00, 3.8180e+05, 3.8640e+05, 3.9296e+05, 3.9335e+05, 4.0453e+05,
        4.0740e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 386367.8750, 386368.8750, 386393.3125, 386397.7188,
        386405.8125, 386413.7812, 386416.7812, 763209.4375, 768597.8750,
        779807.1250, 785782.6250, 811358.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 404509.2500, 404512.8750, 404523.4375, 404526.0000,
        404526.6250, 404550.6875, 404562.8750, 779807.1250, 782409.1875,
        791054.0000, 806898.2500, 826479.0000])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 407314.8125, 407340.4688, 407357.5938, 407360.7500,
        407380.8750, 407381.2500, 407399.0000, 775848.7500, 789903.5625,
        805793.1250, 811358.1250, 826479.0000])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.5661e+00, 3.5864e+00, 3.5960e+00, 3.6557e+00, 3.7205e+00,
        3.8777e+00, 3.8181e+05, 3.8642e+05, 3.9301e+05, 3.9330e+05, 4.0455e+05,
        4.0736e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 393268.7812, 393268.8750, 393295.7188, 393310.7500,
        393317.3125, 393348.3125, 393349.0312, 768597.8750, 773067.0000,
        775848.7500, 786420.8125, 806898.2500])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.3874e+00, 3.5864e+00, 3.7445e+00, 3.7757e+00, 3.9073e+00,
        3.9636e+00, 3.8176e+05, 3.8637e+05, 3.9296e+05, 3.9327e+05, 4.0453e+05,
        4.0734e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.3874e+00, 3.4174e+00, 3.5530e+00, 3.5642e+00, 3.5661e+00,
        3.8708e+00, 3.8176e+05, 3.8637e+05, 3.9296e+05, 3.9332e+05, 4.0451e+05,
        4.0738e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 392890.5000, 392956.5312, 392961.0938, 392962.9062,
        392963.0312, 392970.3750, 393005.1562, 770964.6250, 782409.1875,
        785782.6250, 786420.8125, 805793.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.4720e+00, 3.4821e+00, 3.5530e+00, 3.6557e+00, 3.7757e+00,
        3.8261e+00, 3.8182e+05, 3.8639e+05, 3.9297e+05, 3.9331e+05, 4.0451e+05,
        4.0731e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 381761.8125, 381764.5625, 381791.9062, 381799.8750,
        381811.7500, 381818.1562, 381824.8125, 763209.4375, 770964.6250,
        773067.0000, 789903.5625, 791054.0000])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['96028.52', '96031.70', '96027.41', '433496.72', '451439.88', '453422.97', '96031.31', '440219.59', '96019.48', '96018.88', '440209.28', '96029.16', '429472.75']
estimated f for each client, fs: [6, 6, 6, 4, 4, 4, 6, 4, 6, 6, 4, 6, 4]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 9, 11, 14, 18, 19, 2, 15, 1, 10, 16, 6, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0084s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:05...
global Accuracy on shared test data: 44.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [222  41]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:05, End: 2025-07-22 15:46:05)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [8, 11, 3, 14, 18, 13, 16, 4, 17, 6, 1, 12, 2, 9], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.6375e+00, 3.9237e+00, 3.8794e+05, 3.8488e+05, 3.8228e+05,
         3.9147e+05, 3.8612e+00, 3.9350e+05, 3.7112e+00, 3.8641e+00, 3.7127e+00,
         4.0806e+00, 4.2731e+00],
        [3.6375e+00, 0.0000e+00, 3.7632e+00, 3.8794e+05, 3.8488e+05, 3.8228e+05,
         3.9152e+05, 3.4159e+00, 3.9351e+05, 3.3948e+00, 3.7354e+00, 3.4877e+00,
         3.6818e+00, 3.8073e+00],
        [3.9237e+00, 3.7632e+00, 0.0000e+00, 3.8790e+05, 3.8487e+05, 3.8225e+05,
         3.9148e+05, 3.4995e+00, 3.9354e+05, 3.5217e+00, 4.0969e+00, 3.7798e+00,
         3.7922e+00, 3.7292e+00],
        [3.8794e+05, 3.8794e+05, 3.8790e+05, 0.0000e+00, 7.9197e+05, 7.7143e+05,
         7.7929e+05, 3.8796e+05, 7.8219e+05, 3.8786e+05, 3.8792e+05, 3.8791e+05,
         3.8791e+05, 3.8793e+05],
        [3.8488e+05, 3.8488e+05, 3.8487e+05, 7.9197e+05, 0.0000e+00, 7.9272e+05,
         7.5997e+05, 3.8488e+05, 7.6118e+05, 3.8490e+05, 3.8491e+05, 3.8486e+05,
         3.8489e+05, 3.8491e+05],
        [3.8228e+05, 3.8228e+05, 3.8225e+05, 7.7143e+05, 7.9272e+05, 0.0000e+00,
         7.8804e+05, 3.8226e+05, 7.7288e+05, 3.8230e+05, 3.8226e+05, 3.8228e+05,
         3.8231e+05, 3.8225e+05],
        [3.9147e+05, 3.9152e+05, 3.9148e+05, 7.7929e+05, 7.5997e+05, 7.8804e+05,
         0.0000e+00, 3.9146e+05, 7.8435e+05, 3.9150e+05, 3.9153e+05, 3.9150e+05,
         3.9153e+05, 3.9141e+05],
        [3.8612e+00, 3.4159e+00, 3.4995e+00, 3.8796e+05, 3.8488e+05, 3.8226e+05,
         3.9146e+05, 0.0000e+00, 3.9354e+05, 3.2761e+00, 3.6295e+00, 3.4087e+00,
         3.8009e+00, 3.5997e+00],
        [3.9350e+05, 3.9351e+05, 3.9354e+05, 7.8219e+05, 7.6118e+05, 7.7288e+05,
         7.8435e+05, 3.9354e+05, 0.0000e+00, 3.9349e+05, 3.9346e+05, 3.9352e+05,
         3.9352e+05, 3.9353e+05],
        [3.7112e+00, 3.3948e+00, 3.5217e+00, 3.8786e+05, 3.8490e+05, 3.8230e+05,
         3.9150e+05, 3.2761e+00, 3.9349e+05, 0.0000e+00, 3.8103e+00, 3.6531e+00,
         3.6431e+00, 3.7857e+00],
        [3.8641e+00, 3.7354e+00, 4.0969e+00, 3.8792e+05, 3.8491e+05, 3.8226e+05,
         3.9153e+05, 3.6295e+00, 3.9346e+05, 3.8103e+00, 0.0000e+00, 3.6082e+00,
         3.5398e+00, 3.9403e+00],
        [3.7127e+00, 3.4877e+00, 3.7798e+00, 3.8791e+05, 3.8486e+05, 3.8228e+05,
         3.9150e+05, 3.4087e+00, 3.9352e+05, 3.6531e+00, 3.6082e+00, 0.0000e+00,
         3.5963e+00, 3.9161e+00],
        [4.0806e+00, 3.6818e+00, 3.7922e+00, 3.8791e+05, 3.8489e+05, 3.8231e+05,
         3.9153e+05, 3.8009e+00, 3.9352e+05, 3.6431e+00, 3.5398e+00, 3.5963e+00,
         0.0000e+00, 3.5446e+00],
        [4.2731e+00, 3.8073e+00, 3.7292e+00, 3.8793e+05, 3.8491e+05, 3.8225e+05,
         3.9141e+05, 3.5997e+00, 3.9353e+05, 3.7857e+00, 3.9403e+00, 3.9161e+00,
         3.5446e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.6375e+00, 3.7112e+00, 3.7127e+00, 3.8612e+00, 3.8641e+00,
        3.9237e+00, 4.0806e+00, 4.2731e+00, 3.8228e+05, 3.8488e+05, 3.8794e+05,
        3.9147e+05, 3.9350e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.3948e+00, 3.4159e+00, 3.4877e+00, 3.6375e+00, 3.6818e+00,
        3.7354e+00, 3.7632e+00, 3.8073e+00, 3.8228e+05, 3.8488e+05, 3.8794e+05,
        3.9152e+05, 3.9351e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4995e+00, 3.5217e+00, 3.7292e+00, 3.7632e+00, 3.7798e+00,
        3.7922e+00, 3.9237e+00, 4.0969e+00, 3.8225e+05, 3.8487e+05, 3.8790e+05,
        3.9148e+05, 3.9354e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387859.5625, 387902.6875, 387910.4062, 387911.3750,
        387918.7500, 387931.4062, 387935.1562, 387937.9375, 387959.9062,
        771432.1875, 779285.5000, 782192.1250, 791972.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 384857.8438, 384871.3125, 384881.0000, 384882.2812,
        384884.6250, 384885.7500, 384895.5938, 384909.9062, 384910.7500,
        759969.7500, 761180.7500, 791972.1875, 792717.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 382246.8750, 382253.0312, 382257.2500, 382257.6875,
        382279.4375, 382280.5312, 382281.3750, 382295.6562, 382308.5625,
        771432.1875, 772883.5000, 788041.6250, 792717.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391408.6250, 391462.9688, 391473.3438, 391483.1562,
        391495.3750, 391496.0000, 391515.0312, 391525.3438, 391530.8438,
        759969.7500, 779285.5000, 784352.9375, 788041.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.2761e+00, 3.4087e+00, 3.4159e+00, 3.4995e+00, 3.5997e+00,
        3.6295e+00, 3.8009e+00, 3.8612e+00, 3.8226e+05, 3.8488e+05, 3.8796e+05,
        3.9146e+05, 3.9354e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393455.4062, 393494.5000, 393499.5625, 393512.4688,
        393517.8750, 393520.0000, 393526.5000, 393539.0625, 393543.0625,
        761180.7500, 772883.5000, 782192.1250, 784352.9375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.2761e+00, 3.3948e+00, 3.5217e+00, 3.6431e+00, 3.6531e+00,
        3.7112e+00, 3.7857e+00, 3.8103e+00, 3.8230e+05, 3.8490e+05, 3.8786e+05,
        3.9150e+05, 3.9349e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5398e+00, 3.6082e+00, 3.6295e+00, 3.7354e+00, 3.8103e+00,
        3.8641e+00, 3.9403e+00, 4.0969e+00, 3.8226e+05, 3.8491e+05, 3.8792e+05,
        3.9153e+05, 3.9346e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4087e+00, 3.4877e+00, 3.5963e+00, 3.6082e+00, 3.6531e+00,
        3.7127e+00, 3.7798e+00, 3.9161e+00, 3.8228e+05, 3.8486e+05, 3.8791e+05,
        3.9150e+05, 3.9352e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5398e+00, 3.5446e+00, 3.5963e+00, 3.6431e+00, 3.6818e+00,
        3.7922e+00, 3.8009e+00, 4.0806e+00, 3.8231e+05, 3.8489e+05, 3.8791e+05,
        3.9153e+05, 3.9352e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5446e+00, 3.5997e+00, 3.7292e+00, 3.7857e+00, 3.8073e+00,
        3.9161e+00, 3.9403e+00, 4.2731e+00, 3.8225e+05, 3.8491e+05, 3.8793e+05,
        3.9141e+05, 3.9353e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['42479.06', '42478.93', '42475.22', '387918.59', '384886.56', '382273.34', '391487.81', '42476.24', '393512.03', '42480.49', '42476.38', '42478.74', '42482.03', '42475.95']
estimated f for each client, fs: [5, 5, 5, 3, 3, 4, 3, 5, 3, 5, 5, 5, 5, 5]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [8, 11, 3, 14, 18, 13, 16, 4, 17, 6, 1, 12, 2, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0089s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:05...
global Accuracy on shared test data: 44.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [214  49]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:05, End: 2025-07-22 15:46:05)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [12, 13, 9, 16, 6, 7, 8, 1, 11, 18, 15, 3, 20, 4, 2, 10, 17, 19, 14], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.7867e+05, 4.2585e+00, 3.9624e+05, 3.6439e+00, 3.7690e+00,
         3.7064e+00, 3.7376e+00, 3.5053e+00, 3.8446e+05, 3.9930e+05, 3.8653e+00,
         3.9113e+05, 3.4073e+00, 3.6957e+00, 3.6002e+00, 3.9394e+05, 3.9837e+05,
         3.8058e+05],
        [3.7867e+05, 0.0000e+00, 3.7868e+05, 7.5093e+05, 3.7864e+05, 3.7867e+05,
         3.7865e+05, 3.7867e+05, 3.7863e+05, 7.6111e+05, 7.8475e+05, 3.7863e+05,
         7.8402e+05, 3.7866e+05, 3.7865e+05, 3.7863e+05, 7.8853e+05, 7.7412e+05,
         7.8462e+05],
        [4.2585e+00, 3.7868e+05, 0.0000e+00, 3.9626e+05, 4.0847e+00, 4.2831e+00,
         4.5421e+00, 4.1513e+00, 4.0355e+00, 3.8450e+05, 3.9931e+05, 3.9274e+00,
         3.9113e+05, 3.7222e+00, 3.5862e+00, 4.1557e+00, 3.9397e+05, 3.9831e+05,
         3.8055e+05],
        [3.9624e+05, 7.5093e+05, 3.9626e+05, 0.0000e+00, 3.9623e+05, 3.9625e+05,
         3.9621e+05, 3.9626e+05, 3.9625e+05, 7.8805e+05, 7.9230e+05, 3.9617e+05,
         7.5413e+05, 3.9627e+05, 3.9623e+05, 3.9627e+05, 7.9805e+05, 8.0248e+05,
         7.6833e+05],
        [3.6439e+00, 3.7864e+05, 4.0847e+00, 3.9623e+05, 0.0000e+00, 3.6694e+00,
         3.6830e+00, 3.8938e+00, 3.4205e+00, 3.8441e+05, 3.9933e+05, 3.5035e+00,
         3.9115e+05, 3.2543e+00, 3.6792e+00, 3.7154e+00, 3.9394e+05, 3.9834e+05,
         3.8060e+05],
        [3.7690e+00, 3.7867e+05, 4.2831e+00, 3.9625e+05, 3.6694e+00, 0.0000e+00,
         4.0498e+00, 3.6414e+00, 3.7178e+00, 3.8445e+05, 3.9929e+05, 3.8155e+00,
         3.9112e+05, 3.6422e+00, 3.6527e+00, 3.7934e+00, 3.9394e+05, 3.9837e+05,
         3.8055e+05],
        [3.7064e+00, 3.7865e+05, 4.5421e+00, 3.9621e+05, 3.6830e+00, 4.0498e+00,
         0.0000e+00, 3.9049e+00, 3.6487e+00, 3.8446e+05, 3.9931e+05, 3.9827e+00,
         3.9120e+05, 3.8074e+00, 4.1006e+00, 3.9397e+00, 3.9399e+05, 3.9838e+05,
         3.8054e+05],
        [3.7376e+00, 3.7867e+05, 4.1513e+00, 3.9626e+05, 3.8938e+00, 3.6414e+00,
         3.9049e+00, 0.0000e+00, 3.8069e+00, 3.8443e+05, 3.9930e+05, 4.2697e+00,
         3.9116e+05, 3.5945e+00, 3.5942e+00, 3.4681e+00, 3.9393e+05, 3.9837e+05,
         3.8052e+05],
        [3.5053e+00, 3.7863e+05, 4.0355e+00, 3.9625e+05, 3.4205e+00, 3.7178e+00,
         3.6487e+00, 3.8069e+00, 0.0000e+00, 3.8447e+05, 3.9930e+05, 3.8798e+00,
         3.9114e+05, 3.3265e+00, 3.7408e+00, 3.5660e+00, 3.9394e+05, 3.9832e+05,
         3.8055e+05],
        [3.8446e+05, 7.6111e+05, 3.8450e+05, 7.8805e+05, 3.8441e+05, 3.8445e+05,
         3.8446e+05, 3.8443e+05, 3.8447e+05, 0.0000e+00, 7.6676e+05, 3.8445e+05,
         7.7327e+05, 3.8444e+05, 3.8442e+05, 3.8442e+05, 7.5335e+05, 7.6571e+05,
         7.5998e+05],
        [3.9930e+05, 7.8475e+05, 3.9931e+05, 7.9230e+05, 3.9933e+05, 3.9929e+05,
         3.9931e+05, 3.9930e+05, 3.9930e+05, 7.6676e+05, 0.0000e+00, 3.9929e+05,
         7.9554e+05, 3.9927e+05, 3.9929e+05, 3.9930e+05, 8.0790e+05, 7.8770e+05,
         7.6441e+05],
        [3.8653e+00, 3.7863e+05, 3.9274e+00, 3.9617e+05, 3.5035e+00, 3.8155e+00,
         3.9827e+00, 4.2697e+00, 3.8798e+00, 3.8445e+05, 3.9929e+05, 0.0000e+00,
         3.9115e+05, 3.4533e+00, 3.8478e+00, 3.9621e+00, 3.9398e+05, 3.9839e+05,
         3.8058e+05],
        [3.9113e+05, 7.8402e+05, 3.9113e+05, 7.5413e+05, 3.9115e+05, 3.9112e+05,
         3.9120e+05, 3.9116e+05, 3.9114e+05, 7.7327e+05, 7.9554e+05, 3.9115e+05,
         0.0000e+00, 3.9107e+05, 3.9113e+05, 3.9112e+05, 8.1367e+05, 8.0303e+05,
         7.7908e+05],
        [3.4073e+00, 3.7866e+05, 3.7222e+00, 3.9627e+05, 3.2543e+00, 3.6422e+00,
         3.8074e+00, 3.5945e+00, 3.3265e+00, 3.8444e+05, 3.9927e+05, 3.4533e+00,
         3.9107e+05, 0.0000e+00, 3.7307e+00, 3.5469e+00, 3.9396e+05, 3.9832e+05,
         3.8056e+05],
        [3.6957e+00, 3.7865e+05, 3.5862e+00, 3.9623e+05, 3.6792e+00, 3.6527e+00,
         4.1006e+00, 3.5942e+00, 3.7408e+00, 3.8442e+05, 3.9929e+05, 3.8478e+00,
         3.9113e+05, 3.7307e+00, 0.0000e+00, 3.6475e+00, 3.9388e+05, 3.9839e+05,
         3.8058e+05],
        [3.6002e+00, 3.7863e+05, 4.1557e+00, 3.9627e+05, 3.7154e+00, 3.7934e+00,
         3.9397e+00, 3.4681e+00, 3.5660e+00, 3.8442e+05, 3.9930e+05, 3.9621e+00,
         3.9112e+05, 3.5469e+00, 3.6475e+00, 0.0000e+00, 3.9394e+05, 3.9832e+05,
         3.8056e+05],
        [3.9394e+05, 7.8853e+05, 3.9397e+05, 7.9805e+05, 3.9394e+05, 3.9394e+05,
         3.9399e+05, 3.9393e+05, 3.9394e+05, 7.5335e+05, 8.0790e+05, 3.9398e+05,
         8.1367e+05, 3.9396e+05, 3.9388e+05, 3.9394e+05, 0.0000e+00, 7.9553e+05,
         7.9669e+05],
        [3.9837e+05, 7.7412e+05, 3.9831e+05, 8.0248e+05, 3.9834e+05, 3.9837e+05,
         3.9838e+05, 3.9837e+05, 3.9832e+05, 7.6571e+05, 7.8770e+05, 3.9839e+05,
         8.0303e+05, 3.9832e+05, 3.9839e+05, 3.9832e+05, 7.9553e+05, 0.0000e+00,
         7.7959e+05],
        [3.8058e+05, 7.8462e+05, 3.8055e+05, 7.6833e+05, 3.8060e+05, 3.8055e+05,
         3.8054e+05, 3.8052e+05, 3.8055e+05, 7.5998e+05, 7.6441e+05, 3.8058e+05,
         7.7908e+05, 3.8056e+05, 3.8058e+05, 3.8056e+05, 7.9669e+05, 7.7959e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.4073e+00, 3.5053e+00, 3.6002e+00, 3.6439e+00, 3.6957e+00,
        3.7064e+00, 3.7376e+00, 3.7690e+00, 3.8653e+00, 4.2585e+00, 3.7867e+05,
        3.8058e+05, 3.8446e+05, 3.9113e+05, 3.9394e+05, 3.9624e+05, 3.9837e+05,
        3.9930e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 378626.4688, 378631.1250, 378632.5312, 378636.2500,
        378647.9375, 378654.4375, 378663.2500, 378665.6250, 378666.0000,
        378674.0625, 378684.9375, 750926.5000, 761113.4375, 774116.5000,
        784018.3750, 784617.4375, 784748.9375, 788533.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5862e+00, 3.7222e+00, 3.9274e+00, 4.0355e+00, 4.0847e+00,
        4.1513e+00, 4.1557e+00, 4.2585e+00, 4.2831e+00, 4.5421e+00, 3.7868e+05,
        3.8055e+05, 3.8450e+05, 3.9113e+05, 3.9397e+05, 3.9626e+05, 3.9831e+05,
        3.9931e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396171.8125, 396213.3750, 396232.0312, 396234.1875,
        396235.1875, 396248.2500, 396249.6250, 396258.7188, 396260.5000,
        396268.5625, 396268.7812, 750926.5000, 754132.1250, 768327.7500,
        788053.7500, 792298.7500, 798052.9375, 802481.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2543e+00, 3.4205e+00, 3.5035e+00, 3.6439e+00, 3.6694e+00,
        3.6792e+00, 3.6830e+00, 3.7154e+00, 3.8938e+00, 4.0847e+00, 3.7864e+05,
        3.8060e+05, 3.8441e+05, 3.9115e+05, 3.9394e+05, 3.9623e+05, 3.9834e+05,
        3.9933e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6414e+00, 3.6422e+00, 3.6527e+00, 3.6694e+00, 3.7178e+00,
        3.7690e+00, 3.7934e+00, 3.8155e+00, 4.0498e+00, 4.2831e+00, 3.7867e+05,
        3.8055e+05, 3.8445e+05, 3.9112e+05, 3.9394e+05, 3.9625e+05, 3.9837e+05,
        3.9929e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6487e+00, 3.6830e+00, 3.7064e+00, 3.8074e+00, 3.9049e+00,
        3.9397e+00, 3.9827e+00, 4.0498e+00, 4.1006e+00, 4.5421e+00, 3.7865e+05,
        3.8054e+05, 3.8446e+05, 3.9120e+05, 3.9399e+05, 3.9621e+05, 3.9838e+05,
        3.9931e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4681e+00, 3.5942e+00, 3.5945e+00, 3.6414e+00, 3.7376e+00,
        3.8069e+00, 3.8938e+00, 3.9049e+00, 4.1513e+00, 4.2697e+00, 3.7867e+05,
        3.8052e+05, 3.8443e+05, 3.9116e+05, 3.9393e+05, 3.9626e+05, 3.9837e+05,
        3.9930e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3265e+00, 3.4205e+00, 3.5053e+00, 3.5660e+00, 3.6487e+00,
        3.7178e+00, 3.7408e+00, 3.8069e+00, 3.8798e+00, 4.0355e+00, 3.7863e+05,
        3.8055e+05, 3.8447e+05, 3.9114e+05, 3.9394e+05, 3.9625e+05, 3.9832e+05,
        3.9930e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384406.0625, 384415.1875, 384422.3125, 384427.1875,
        384438.5312, 384447.6875, 384454.6250, 384456.9688, 384458.8438,
        384466.7188, 384500.3125, 753349.8125, 759982.3750, 761113.4375,
        765710.1250, 766761.1875, 773267.6875, 788053.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 399273.0938, 399285.2812, 399292.0625, 399294.7188,
        399297.3125, 399299.2188, 399300.6875, 399303.0625, 399306.6562,
        399310.0000, 399332.6250, 764406.6250, 766761.1875, 784748.9375,
        787700.4375, 792298.7500, 795539.4375, 807903.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4533e+00, 3.5035e+00, 3.8155e+00, 3.8478e+00, 3.8653e+00,
        3.8798e+00, 3.9274e+00, 3.9621e+00, 3.9827e+00, 4.2697e+00, 3.7863e+05,
        3.8058e+05, 3.8445e+05, 3.9115e+05, 3.9398e+05, 3.9617e+05, 3.9839e+05,
        3.9929e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391067.8125, 391115.2188, 391122.6250, 391128.8125,
        391131.5625, 391133.2812, 391139.1250, 391147.1250, 391148.9688,
        391158.7812, 391200.5312, 754132.1250, 773267.6875, 779080.0625,
        784018.3750, 795539.4375, 803025.5000, 813671.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2543e+00, 3.3265e+00, 3.4073e+00, 3.4533e+00, 3.5469e+00,
        3.5945e+00, 3.6422e+00, 3.7222e+00, 3.7307e+00, 3.8074e+00, 3.7866e+05,
        3.8056e+05, 3.8444e+05, 3.9107e+05, 3.9396e+05, 3.9627e+05, 3.9832e+05,
        3.9927e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5862e+00, 3.5942e+00, 3.6475e+00, 3.6527e+00, 3.6792e+00,
        3.6957e+00, 3.7307e+00, 3.7408e+00, 3.8478e+00, 4.1006e+00, 3.7865e+05,
        3.8058e+05, 3.8442e+05, 3.9113e+05, 3.9388e+05, 3.9623e+05, 3.9839e+05,
        3.9929e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4681e+00, 3.5469e+00, 3.5660e+00, 3.6002e+00, 3.6475e+00,
        3.7154e+00, 3.7934e+00, 3.9397e+00, 3.9621e+00, 4.1557e+00, 3.7863e+05,
        3.8056e+05, 3.8442e+05, 3.9112e+05, 3.9394e+05, 3.9627e+05, 3.9832e+05,
        3.9930e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393883.4375, 393928.4375, 393936.8750, 393938.1562,
        393938.5312, 393939.5625, 393941.2188, 393962.0938, 393966.9688,
        393984.7188, 393991.4375, 753349.8125, 788533.5000, 795527.0000,
        796693.3750, 798052.9375, 807903.1250, 813671.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398306.4375, 398321.1250, 398322.1562, 398322.8750,
        398341.4062, 398368.8438, 398369.4375, 398370.6562, 398378.0000,
        398387.0625, 398392.3750, 765710.1250, 774116.5000, 779589.7500,
        787700.4375, 795527.0000, 802481.7500, 803025.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 380521.0625, 380540.4688, 380545.0938, 380550.0625,
        380551.7812, 380561.1875, 380564.8438, 380577.2812, 380577.3438,
        380583.4062, 380599.5312, 759982.3750, 764406.6250, 768327.7500,
        779080.0625, 779589.7500, 784617.4375, 796693.3750])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34428.30', '378652.97', '34429.61', '396240.12', '34424.80', '34427.61', '34426.12', '34427.64', '34423.92', '384444.97', '399299.53', '34424.51', '391135.81', '34427.16', '34426.52', '34424.54', '393946.50', '398352.75', '380561.09']
estimated f for each client, fs: [8, 6, 8, 6, 8, 8, 8, 8, 8, 6, 6, 8, 6, 8, 8, 8, 6, 6, 6]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [12, 13, 9, 16, 6, 7, 8, 1, 11, 18, 15, 3, 20, 4, 2, 10, 17, 19, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0138s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:06...
global Accuracy on shared test data: 45.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [204  59]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:06, End: 2025-07-22 15:46:06)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [18, 17, 11, 7, 10, 5, 19, 2, 3], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 7.9163e+05, 3.8831e+05, 3.8827e+05, 3.8825e+05, 3.8825e+05,
         7.5693e+05, 3.8826e+05, 3.8825e+05],
        [7.9163e+05, 0.0000e+00, 3.9262e+05, 3.9264e+05, 3.9262e+05, 3.9262e+05,
         7.5668e+05, 3.9262e+05, 3.9259e+05],
        [3.8831e+05, 3.9262e+05, 0.0000e+00, 3.6781e+00, 3.5405e+00, 3.6325e+00,
         3.7414e+05, 3.7751e+00, 3.8257e+00],
        [3.8827e+05, 3.9264e+05, 3.6781e+00, 0.0000e+00, 3.6787e+00, 3.6520e+00,
         3.7418e+05, 3.6094e+00, 3.7639e+00],
        [3.8825e+05, 3.9262e+05, 3.5405e+00, 3.6787e+00, 0.0000e+00, 3.6838e+00,
         3.7420e+05, 3.7092e+00, 3.9194e+00],
        [3.8825e+05, 3.9262e+05, 3.6325e+00, 3.6520e+00, 3.6838e+00, 0.0000e+00,
         3.7417e+05, 3.7254e+00, 3.6542e+00],
        [7.5693e+05, 7.5668e+05, 3.7414e+05, 3.7418e+05, 3.7420e+05, 3.7417e+05,
         0.0000e+00, 3.7416e+05, 3.7418e+05],
        [3.8826e+05, 3.9262e+05, 3.7751e+00, 3.6094e+00, 3.7092e+00, 3.7254e+00,
         3.7416e+05, 0.0000e+00, 3.8185e+00],
        [3.8825e+05, 3.9259e+05, 3.8257e+00, 3.7639e+00, 3.9194e+00, 3.6542e+00,
         3.7418e+05, 3.8185e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 388245.8438, 388247.9062, 388249.7188, 388257.1875,
        388272.1250, 388314.6875, 756932.8750, 791633.5000])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 392589.1562, 392618.7812, 392619.7812, 392621.7500,
        392622.7500, 392638.8750, 756681.3750, 791633.5000])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.5405e+00, 3.6325e+00, 3.6781e+00, 3.7751e+00, 3.8257e+00,
        3.7414e+05, 3.8831e+05, 3.9262e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.6094e+00, 3.6520e+00, 3.6781e+00, 3.6787e+00, 3.7639e+00,
        3.7418e+05, 3.8827e+05, 3.9264e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.5405e+00, 3.6787e+00, 3.6838e+00, 3.7092e+00, 3.9194e+00,
        3.7420e+05, 3.8825e+05, 3.9262e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.6325e+00, 3.6520e+00, 3.6542e+00, 3.6838e+00, 3.7254e+00,
        3.7417e+05, 3.8825e+05, 3.9262e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 374141.7812, 374156.7188, 374168.2812, 374183.0000,
        374184.0625, 374195.5000, 756681.3750, 756932.8750])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.6094e+00, 3.7092e+00, 3.7254e+00, 3.7751e+00, 3.8185e+00,
        3.7416e+05, 3.8826e+05, 3.9262e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.6542e+00, 3.7639e+00, 3.8185e+00, 3.8257e+00, 3.9194e+00,
        3.7418e+05, 3.8825e+05, 3.9259e+05])
Index of maximum distance difference after half of values: 6
adaptive_Krum scores:  ['388264.56', '392618.53', '62360.04', '62366.91', '62369.01', '62364.44', '374171.53', '62362.56', '62367.18']
estimated f for each client, fs: [1, 1, 3, 3, 3, 3, 2, 3, 3]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [18, 17, 11, 7, 10, 5, 19, 2, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0053s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:06...
global Accuracy on shared test data: 44.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[154  83]
 [197  66]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:06, End: 2025-07-22 15:46:06)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [9, 11], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 3.9897],
        [3.9897, 0.0000]])
sorted_distances: tensor([0.0000, 3.9897])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000, 3.9897])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['3.99', '3.99']
estimated f for each client, fs: [1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [9, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0015s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:07...
global Accuracy on shared test data: 45.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[144  93]
 [182  81]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:07, End: 2025-07-22 15:46:07)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [13, 8, 14, 6, 15, 20, 19, 16, 3, 10, 1, 11, 18, 9, 12, 2, 17, 7], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.7561e+05, 7.4585e+05, 3.7568e+05, 7.7560e+05, 7.5839e+05,
         7.4291e+05, 7.4804e+05, 3.7563e+05, 3.7565e+05, 3.7564e+05, 3.7565e+05,
         8.0158e+05, 3.7567e+05, 3.7562e+05, 3.7563e+05, 7.7076e+05, 3.7564e+05],
        [3.7561e+05, 0.0000e+00, 3.8728e+05, 3.7300e+00, 3.9103e+05, 3.7808e+05,
         3.7598e+05, 3.9209e+05, 3.8131e+00, 3.9491e+00, 3.7304e+00, 3.7456e+00,
         3.8634e+05, 4.2591e+00, 3.8417e+00, 3.9602e+00, 3.9850e+05, 3.8229e+00],
        [7.4585e+05, 3.8728e+05, 0.0000e+00, 3.8728e+05, 7.8024e+05, 7.8116e+05,
         7.7192e+05, 7.6706e+05, 3.8728e+05, 3.8731e+05, 3.8730e+05, 3.8727e+05,
         7.7221e+05, 3.8729e+05, 3.8725e+05, 3.8726e+05, 7.9320e+05, 3.8729e+05],
        [3.7568e+05, 3.7300e+00, 3.8728e+05, 0.0000e+00, 3.9099e+05, 3.7809e+05,
         3.7600e+05, 3.9211e+05, 3.5739e+00, 3.7242e+00, 4.0738e+00, 3.6303e+00,
         3.8636e+05, 4.0664e+00, 3.9155e+00, 3.5976e+00, 3.9851e+05, 3.8139e+00],
        [7.7560e+05, 3.9103e+05, 7.8024e+05, 3.9099e+05, 0.0000e+00, 7.6119e+05,
         7.7965e+05, 7.6985e+05, 3.9106e+05, 3.9111e+05, 3.9102e+05, 3.9103e+05,
         7.7338e+05, 3.9102e+05, 3.9101e+05, 3.9105e+05, 7.6586e+05, 3.9102e+05],
        [7.5839e+05, 3.7808e+05, 7.8116e+05, 3.7809e+05, 7.6119e+05, 0.0000e+00,
         7.5529e+05, 7.8570e+05, 3.7805e+05, 3.7805e+05, 3.7807e+05, 3.7807e+05,
         7.7955e+05, 3.7805e+05, 3.7807e+05, 3.7806e+05, 7.8434e+05, 3.7806e+05],
        [7.4291e+05, 3.7598e+05, 7.7192e+05, 3.7600e+05, 7.7965e+05, 7.5529e+05,
         0.0000e+00, 7.6242e+05, 3.7601e+05, 3.7599e+05, 3.7599e+05, 3.7597e+05,
         7.6227e+05, 3.7604e+05, 3.7599e+05, 3.7603e+05, 7.7110e+05, 3.7599e+05],
        [7.4804e+05, 3.9209e+05, 7.6706e+05, 3.9211e+05, 7.6985e+05, 7.8570e+05,
         7.6242e+05, 0.0000e+00, 3.9216e+05, 3.9215e+05, 3.9216e+05, 3.9215e+05,
         7.6294e+05, 3.9217e+05, 3.9213e+05, 3.9210e+05, 8.0720e+05, 3.9213e+05],
        [3.7563e+05, 3.8131e+00, 3.8728e+05, 3.5739e+00, 3.9106e+05, 3.7805e+05,
         3.7601e+05, 3.9216e+05, 0.0000e+00, 3.8655e+00, 4.1833e+00, 3.8123e+00,
         3.8632e+05, 3.7465e+00, 4.0045e+00, 3.7915e+00, 3.9844e+05, 3.7881e+00],
        [3.7565e+05, 3.9491e+00, 3.8731e+05, 3.7242e+00, 3.9111e+05, 3.7805e+05,
         3.7599e+05, 3.9215e+05, 3.8655e+00, 0.0000e+00, 3.6612e+00, 3.5358e+00,
         3.8630e+05, 4.1888e+00, 4.0042e+00, 3.6312e+00, 3.9849e+05, 3.7320e+00],
        [3.7564e+05, 3.7304e+00, 3.8730e+05, 4.0738e+00, 3.9102e+05, 3.7807e+05,
         3.7599e+05, 3.9216e+05, 4.1833e+00, 3.6612e+00, 0.0000e+00, 3.8771e+00,
         3.8630e+05, 4.1518e+00, 4.1416e+00, 3.7198e+00, 3.9849e+05, 3.7955e+00],
        [3.7565e+05, 3.7456e+00, 3.8727e+05, 3.6303e+00, 3.9103e+05, 3.7807e+05,
         3.7597e+05, 3.9215e+05, 3.8123e+00, 3.5358e+00, 3.8771e+00, 0.0000e+00,
         3.8630e+05, 3.9731e+00, 4.0410e+00, 3.7900e+00, 3.9851e+05, 3.8295e+00],
        [8.0158e+05, 3.8634e+05, 7.7221e+05, 3.8636e+05, 7.7338e+05, 7.7955e+05,
         7.6227e+05, 7.6294e+05, 3.8632e+05, 3.8630e+05, 3.8630e+05, 3.8630e+05,
         0.0000e+00, 3.8632e+05, 3.8634e+05, 3.8635e+05, 7.9109e+05, 3.8636e+05],
        [3.7567e+05, 4.2591e+00, 3.8729e+05, 4.0664e+00, 3.9102e+05, 3.7805e+05,
         3.7604e+05, 3.9217e+05, 3.7465e+00, 4.1888e+00, 4.1518e+00, 3.9731e+00,
         3.8632e+05, 0.0000e+00, 4.3645e+00, 3.5560e+00, 3.9852e+05, 4.3256e+00],
        [3.7562e+05, 3.8417e+00, 3.8725e+05, 3.9155e+00, 3.9101e+05, 3.7807e+05,
         3.7599e+05, 3.9213e+05, 4.0045e+00, 4.0042e+00, 4.1416e+00, 4.0410e+00,
         3.8634e+05, 4.3645e+00, 0.0000e+00, 4.0270e+00, 3.9847e+05, 3.9698e+00],
        [3.7563e+05, 3.9602e+00, 3.8726e+05, 3.5976e+00, 3.9105e+05, 3.7806e+05,
         3.7603e+05, 3.9210e+05, 3.7915e+00, 3.6312e+00, 3.7198e+00, 3.7900e+00,
         3.8635e+05, 3.5560e+00, 4.0270e+00, 0.0000e+00, 3.9845e+05, 3.7043e+00],
        [7.7076e+05, 3.9850e+05, 7.9320e+05, 3.9851e+05, 7.6586e+05, 7.8434e+05,
         7.7110e+05, 8.0720e+05, 3.9844e+05, 3.9849e+05, 3.9849e+05, 3.9851e+05,
         7.9109e+05, 3.9852e+05, 3.9847e+05, 3.9845e+05, 0.0000e+00, 3.9846e+05],
        [3.7564e+05, 3.8229e+00, 3.8729e+05, 3.8139e+00, 3.9102e+05, 3.7806e+05,
         3.7599e+05, 3.9213e+05, 3.7881e+00, 3.7320e+00, 3.7955e+00, 3.8295e+00,
         3.8636e+05, 4.3256e+00, 3.9698e+00, 3.7043e+00, 3.9846e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 375614.0938, 375622.0625, 375625.6875, 375634.2188,
        375644.2188, 375644.8125, 375650.6875, 375652.3750, 375667.0938,
        375682.2500, 742907.5625, 745852.4375, 748041.1875, 758393.4375,
        770757.6875, 775599.4375, 801584.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.7300e+00, 3.7304e+00, 3.7456e+00, 3.8131e+00, 3.8229e+00,
        3.8417e+00, 3.9491e+00, 3.9602e+00, 4.2591e+00, 3.7561e+05, 3.7598e+05,
        3.7808e+05, 3.8634e+05, 3.8728e+05, 3.9103e+05, 3.9209e+05, 3.9850e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387253.3438, 387257.9062, 387269.2812, 387280.0000,
        387283.5312, 387284.8438, 387286.7500, 387287.0000, 387298.4375,
        387311.3125, 745852.4375, 767059.5000, 771919.5625, 772211.9375,
        780239.8125, 781160.3125, 793204.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5739e+00, 3.5976e+00, 3.6303e+00, 3.7242e+00, 3.7300e+00,
        3.8139e+00, 3.9155e+00, 4.0664e+00, 4.0738e+00, 3.7568e+05, 3.7600e+05,
        3.7809e+05, 3.8636e+05, 3.8728e+05, 3.9099e+05, 3.9211e+05, 3.9851e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 390990.9688, 391014.8125, 391016.6250, 391020.7812,
        391022.5000, 391028.0625, 391032.3125, 391054.2500, 391064.7188,
        391108.0312, 761194.0000, 765863.0000, 769847.1250, 773378.5000,
        775599.4375, 779650.4375, 780239.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 378045.0938, 378051.9688, 378053.3125, 378055.6875,
        378062.3125, 378067.5000, 378067.6250, 378071.6562, 378080.7188,
        378087.1250, 755291.6875, 758393.4375, 761194.0000, 779549.7500,
        781160.3125, 784340.5000, 785703.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 375974.3125, 375983.1875, 375987.5938, 375988.8750,
        375990.8750, 375994.9688, 375995.1562, 376009.4375, 376032.7500,
        376038.4688, 742907.5625, 755291.6875, 762274.8125, 762417.6250,
        771104.1250, 771919.5625, 779650.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392092.7500, 392098.4688, 392109.6250, 392128.5312,
        392130.8125, 392151.8750, 392153.9688, 392156.5938, 392160.7188,
        392166.1562, 748041.1875, 762417.6250, 762935.6250, 767059.5000,
        769847.1250, 785703.3125, 807199.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5739e+00, 3.7465e+00, 3.7881e+00, 3.7915e+00, 3.8123e+00,
        3.8131e+00, 3.8655e+00, 4.0045e+00, 4.1833e+00, 3.7563e+05, 3.7601e+05,
        3.7805e+05, 3.8632e+05, 3.8728e+05, 3.9106e+05, 3.9216e+05, 3.9844e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5358e+00, 3.6312e+00, 3.6612e+00, 3.7242e+00, 3.7320e+00,
        3.8655e+00, 3.9491e+00, 4.0042e+00, 4.1888e+00, 3.7565e+05, 3.7599e+05,
        3.7805e+05, 3.8630e+05, 3.8731e+05, 3.9111e+05, 3.9215e+05, 3.9849e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6612e+00, 3.7198e+00, 3.7304e+00, 3.7955e+00, 3.8771e+00,
        4.0738e+00, 4.1416e+00, 4.1518e+00, 4.1833e+00, 3.7564e+05, 3.7599e+05,
        3.7807e+05, 3.8630e+05, 3.8730e+05, 3.9102e+05, 3.9216e+05, 3.9849e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5358e+00, 3.6303e+00, 3.7456e+00, 3.7900e+00, 3.8123e+00,
        3.8295e+00, 3.8771e+00, 3.9731e+00, 4.0410e+00, 3.7565e+05, 3.7597e+05,
        3.7807e+05, 3.8630e+05, 3.8727e+05, 3.9103e+05, 3.9215e+05, 3.9851e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386297.5938, 386302.7812, 386304.2812, 386322.1562,
        386323.4062, 386336.1250, 386337.5938, 386346.8438, 386355.5625,
        386363.0312, 762274.8125, 762935.6250, 772211.9375, 773378.5000,
        779549.7500, 791094.9375, 801584.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5560e+00, 3.7465e+00, 3.9731e+00, 4.0664e+00, 4.1518e+00,
        4.1888e+00, 4.2591e+00, 4.3256e+00, 4.3645e+00, 3.7567e+05, 3.7604e+05,
        3.7805e+05, 3.8632e+05, 3.8729e+05, 3.9102e+05, 3.9217e+05, 3.9852e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.8417e+00, 3.9155e+00, 3.9698e+00, 4.0042e+00, 4.0045e+00,
        4.0270e+00, 4.0410e+00, 4.1416e+00, 4.3645e+00, 3.7562e+05, 3.7599e+05,
        3.7807e+05, 3.8634e+05, 3.8725e+05, 3.9101e+05, 3.9213e+05, 3.9847e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5560e+00, 3.5976e+00, 3.6312e+00, 3.7043e+00, 3.7198e+00,
        3.7900e+00, 3.7915e+00, 3.9602e+00, 4.0270e+00, 3.7563e+05, 3.7603e+05,
        3.7806e+05, 3.8635e+05, 3.8726e+05, 3.9105e+05, 3.9210e+05, 3.9845e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398443.0625, 398454.0625, 398463.6250, 398467.0000,
        398485.4375, 398487.0938, 398496.1562, 398508.4688, 398513.0938,
        398518.9062, 765863.0000, 770757.6875, 771104.1250, 784340.5000,
        791094.9375, 793204.2500, 807199.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.7043e+00, 3.7320e+00, 3.7881e+00, 3.7955e+00, 3.8139e+00,
        3.8229e+00, 3.8295e+00, 3.9698e+00, 4.3256e+00, 3.7564e+05, 3.7599e+05,
        3.7806e+05, 3.8636e+05, 3.8729e+05, 3.9102e+05, 3.9213e+05, 3.9846e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['409031.34', '68330.18', '419878.66', '68337.41', '424686.03', '412357.69', '409354.78', '424490.06', '68334.38', '68333.98', '68333.73', '68332.80', '420505.81', '68340.21', '68332.11', '68335.66', '431881.78', '68333.31']
estimated f for each client, fs: [6, 8, 6, 8, 6, 6, 6, 6, 8, 8, 8, 8, 6, 8, 8, 8, 6, 8]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [13, 8, 14, 6, 15, 20, 19, 16, 3, 10, 1, 11, 18, 9, 12, 2, 17, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0139s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:07...
global Accuracy on shared test data: 45.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[140  97]
 [175  88]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:46:07, End: 2025-07-22 15:46:07)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [11, 17, 18, 4, 6, 13, 20, 14, 1, 9, 19, 5, 15, 8, 2, 12, 16, 7], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.9559e+05, 3.8593e+05, 3.8579e+00, 3.6937e+00, 3.7816e+05,
         3.9197e+05, 4.1825e+05, 4.0100e+00, 4.0935e+00, 3.9555e+05, 3.7847e+00,
         3.9778e+05, 3.8330e+00, 4.0316e+00, 4.2061e+00, 3.9100e+05, 3.9406e+00],
        [3.9559e+05, 0.0000e+00, 7.7435e+05, 3.9562e+05, 3.9556e+05, 7.8288e+05,
         8.0508e+05, 8.1525e+05, 3.9557e+05, 3.9562e+05, 8.0899e+05, 3.9561e+05,
         8.0013e+05, 3.9562e+05, 3.9562e+05, 3.9568e+05, 8.0289e+05, 3.9566e+05],
        [3.8593e+05, 7.7435e+05, 0.0000e+00, 3.8591e+05, 3.8590e+05, 7.6599e+05,
         7.8629e+05, 8.1608e+05, 3.8592e+05, 3.8586e+05, 7.8736e+05, 3.8592e+05,
         7.6920e+05, 3.8591e+05, 3.8588e+05, 3.8586e+05, 7.6815e+05, 3.8588e+05],
        [3.8579e+00, 3.9562e+05, 3.8591e+05, 0.0000e+00, 3.6354e+00, 3.7818e+05,
         3.9202e+05, 4.1828e+05, 3.9659e+00, 4.1085e+00, 3.9553e+05, 3.7551e+00,
         3.9771e+05, 3.8312e+00, 4.0109e+00, 3.8152e+00, 3.9095e+05, 3.8624e+00],
        [3.6937e+00, 3.9556e+05, 3.8590e+05, 3.6354e+00, 0.0000e+00, 3.7812e+05,
         3.9192e+05, 4.1830e+05, 4.0965e+00, 4.0821e+00, 3.9551e+05, 3.6931e+00,
         3.9773e+05, 3.7689e+00, 3.6514e+00, 3.9526e+00, 3.9095e+05, 3.8017e+00],
        [3.7816e+05, 7.8288e+05, 7.6599e+05, 3.7818e+05, 3.7812e+05, 0.0000e+00,
         7.5235e+05, 7.8403e+05, 3.7816e+05, 3.7811e+05, 7.5095e+05, 3.7813e+05,
         7.6997e+05, 3.7812e+05, 3.7816e+05, 3.7816e+05, 7.7674e+05, 3.7814e+05],
        [3.9197e+05, 8.0508e+05, 7.8629e+05, 3.9202e+05, 3.9192e+05, 7.5235e+05,
         0.0000e+00, 8.0563e+05, 3.9196e+05, 3.9198e+05, 7.8211e+05, 3.9195e+05,
         8.1849e+05, 3.9199e+05, 3.9201e+05, 3.9201e+05, 7.9707e+05, 3.9204e+05],
        [4.1825e+05, 8.1525e+05, 8.1608e+05, 4.1828e+05, 4.1830e+05, 7.8403e+05,
         8.0563e+05, 0.0000e+00, 4.1821e+05, 4.1825e+05, 8.2947e+05, 4.1827e+05,
         8.1705e+05, 4.1825e+05, 4.1828e+05, 4.1822e+05, 8.1185e+05, 4.1824e+05],
        [4.0100e+00, 3.9557e+05, 3.8592e+05, 3.9659e+00, 4.0965e+00, 3.7816e+05,
         3.9196e+05, 4.1821e+05, 0.0000e+00, 4.1493e+00, 3.9550e+05, 4.0082e+00,
         3.9774e+05, 3.7562e+00, 3.6681e+00, 4.1766e+00, 3.9095e+05, 3.7909e+00],
        [4.0935e+00, 3.9562e+05, 3.8586e+05, 4.1085e+00, 4.0821e+00, 3.7811e+05,
         3.9198e+05, 4.1825e+05, 4.1493e+00, 0.0000e+00, 3.9553e+05, 3.9530e+00,
         3.9774e+05, 4.2525e+00, 3.6263e+00, 4.3842e+00, 3.9096e+05, 4.2706e+00],
        [3.9555e+05, 8.0899e+05, 7.8736e+05, 3.9553e+05, 3.9551e+05, 7.5095e+05,
         7.8211e+05, 8.2947e+05, 3.9550e+05, 3.9553e+05, 0.0000e+00, 3.9552e+05,
         8.0036e+05, 3.9551e+05, 3.9548e+05, 3.9552e+05, 7.9897e+05, 3.9557e+05],
        [3.7847e+00, 3.9561e+05, 3.8592e+05, 3.7551e+00, 3.6931e+00, 3.7813e+05,
         3.9195e+05, 4.1827e+05, 4.0082e+00, 3.9530e+00, 3.9552e+05, 0.0000e+00,
         3.9777e+05, 3.6542e+00, 3.7067e+00, 3.8206e+00, 3.9100e+05, 3.5250e+00],
        [3.9778e+05, 8.0013e+05, 7.6920e+05, 3.9771e+05, 3.9773e+05, 7.6997e+05,
         8.1849e+05, 8.1705e+05, 3.9774e+05, 3.9774e+05, 8.0036e+05, 3.9777e+05,
         0.0000e+00, 3.9774e+05, 3.9777e+05, 3.9771e+05, 7.9289e+05, 3.9777e+05],
        [3.8330e+00, 3.9562e+05, 3.8591e+05, 3.8312e+00, 3.7689e+00, 3.7812e+05,
         3.9199e+05, 4.1825e+05, 3.7562e+00, 4.2525e+00, 3.9551e+05, 3.6542e+00,
         3.9774e+05, 0.0000e+00, 3.9770e+00, 3.8715e+00, 3.9100e+05, 3.8719e+00],
        [4.0316e+00, 3.9562e+05, 3.8588e+05, 4.0109e+00, 3.6514e+00, 3.7816e+05,
         3.9201e+05, 4.1828e+05, 3.6681e+00, 3.6263e+00, 3.9548e+05, 3.7067e+00,
         3.9777e+05, 3.9770e+00, 0.0000e+00, 3.9982e+00, 3.9098e+05, 3.6807e+00],
        [4.2061e+00, 3.9568e+05, 3.8586e+05, 3.8152e+00, 3.9526e+00, 3.7816e+05,
         3.9201e+05, 4.1822e+05, 4.1766e+00, 4.3842e+00, 3.9552e+05, 3.8206e+00,
         3.9771e+05, 3.8715e+00, 3.9982e+00, 0.0000e+00, 3.9096e+05, 4.0913e+00],
        [3.9100e+05, 8.0289e+05, 7.6815e+05, 3.9095e+05, 3.9095e+05, 7.7674e+05,
         7.9707e+05, 8.1185e+05, 3.9095e+05, 3.9096e+05, 7.9897e+05, 3.9100e+05,
         7.9289e+05, 3.9100e+05, 3.9098e+05, 3.9096e+05, 0.0000e+00, 3.9098e+05],
        [3.9406e+00, 3.9566e+05, 3.8588e+05, 3.8624e+00, 3.8017e+00, 3.7814e+05,
         3.9204e+05, 4.1824e+05, 3.7909e+00, 4.2706e+00, 3.9557e+05, 3.5250e+00,
         3.9777e+05, 3.8719e+00, 3.6807e+00, 4.0913e+00, 3.9098e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.6937e+00, 3.7847e+00, 3.8330e+00, 3.8579e+00, 3.9406e+00,
        4.0100e+00, 4.0316e+00, 4.0935e+00, 4.2061e+00, 3.7816e+05, 3.8593e+05,
        3.9100e+05, 3.9197e+05, 3.9555e+05, 3.9559e+05, 3.9778e+05, 4.1825e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395561.5000, 395568.1875, 395593.0625, 395610.5312,
        395615.0312, 395615.9375, 395619.6875, 395620.2812, 395660.0625,
        395683.4688, 774351.6875, 782877.6875, 800126.6250, 802894.6875,
        805078.6875, 808985.3750, 815251.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385859.0000, 385862.5625, 385879.3125, 385880.4688,
        385904.5312, 385908.9375, 385914.5625, 385919.8750, 385924.0938,
        385934.3750, 765985.3125, 768150.8750, 769197.1250, 774351.6875,
        786291.6250, 787360.5000, 816083.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6354e+00, 3.7551e+00, 3.8152e+00, 3.8312e+00, 3.8579e+00,
        3.8624e+00, 3.9659e+00, 4.0109e+00, 4.1085e+00, 3.7818e+05, 3.8591e+05,
        3.9095e+05, 3.9202e+05, 3.9553e+05, 3.9562e+05, 3.9771e+05, 4.1828e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6354e+00, 3.6514e+00, 3.6931e+00, 3.6937e+00, 3.7689e+00,
        3.8017e+00, 3.9526e+00, 4.0821e+00, 4.0965e+00, 3.7812e+05, 3.8590e+05,
        3.9095e+05, 3.9192e+05, 3.9551e+05, 3.9556e+05, 3.9773e+05, 4.1830e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 378110.6562, 378116.8750, 378119.3750, 378129.2500,
        378135.9688, 378156.0938, 378157.7500, 378158.3438, 378164.9062,
        378182.3750, 750951.3125, 752345.2500, 765985.3125, 769971.4375,
        776737.2500, 782877.6875, 784032.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391923.5312, 391949.5625, 391959.6875, 391972.7812,
        391982.3750, 391985.8125, 392008.2500, 392009.0312, 392021.5625,
        392040.6250, 752345.2500, 782111.1250, 786291.6250, 797071.2500,
        805078.6875, 805626.0000, 818494.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 418205.5625, 418218.8750, 418244.5000, 418245.3750,
        418246.0938, 418247.0312, 418268.1562, 418283.0625, 418283.4688,
        418296.1250, 784032.5000, 805626.0000, 811845.6250, 815251.0625,
        816083.1875, 817050.6250, 829474.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6681e+00, 3.7562e+00, 3.7909e+00, 3.9659e+00, 4.0082e+00,
        4.0100e+00, 4.0965e+00, 4.1493e+00, 4.1766e+00, 3.7816e+05, 3.8592e+05,
        3.9095e+05, 3.9196e+05, 3.9550e+05, 3.9557e+05, 3.9774e+05, 4.1821e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6263e+00, 3.9530e+00, 4.0821e+00, 4.0935e+00, 4.1085e+00,
        4.1493e+00, 4.2525e+00, 4.2706e+00, 4.3842e+00, 3.7811e+05, 3.8586e+05,
        3.9096e+05, 3.9198e+05, 3.9553e+05, 3.9562e+05, 3.9774e+05, 4.1825e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395477.2812, 395498.2500, 395511.5625, 395513.5625,
        395519.5000, 395522.5312, 395525.4688, 395532.7188, 395553.9375,
        395572.0625, 750951.3125, 782111.1250, 787360.5000, 798966.3750,
        800360.6250, 808985.3750, 829474.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5250e+00, 3.6542e+00, 3.6931e+00, 3.7067e+00, 3.7551e+00,
        3.7847e+00, 3.8206e+00, 3.9530e+00, 4.0082e+00, 3.7813e+05, 3.8592e+05,
        3.9100e+05, 3.9195e+05, 3.9552e+05, 3.9561e+05, 3.9777e+05, 4.1827e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397710.7188, 397713.6562, 397727.2812, 397736.8125,
        397743.4688, 397744.9688, 397767.2500, 397767.7188, 397770.1250,
        397780.4375, 769197.1250, 769971.4375, 792891.6250, 800126.6250,
        800360.6250, 817050.6250, 818494.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6542e+00, 3.7562e+00, 3.7689e+00, 3.8312e+00, 3.8330e+00,
        3.8715e+00, 3.8719e+00, 3.9770e+00, 4.2525e+00, 3.7812e+05, 3.8591e+05,
        3.9100e+05, 3.9199e+05, 3.9551e+05, 3.9562e+05, 3.9774e+05, 4.1825e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6263e+00, 3.6514e+00, 3.6681e+00, 3.6807e+00, 3.7067e+00,
        3.9770e+00, 3.9982e+00, 4.0109e+00, 4.0316e+00, 3.7816e+05, 3.8588e+05,
        3.9098e+05, 3.9201e+05, 3.9548e+05, 3.9562e+05, 3.9777e+05, 4.1828e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.8152e+00, 3.8206e+00, 3.8715e+00, 3.9526e+00, 3.9982e+00,
        4.0913e+00, 4.1766e+00, 4.2061e+00, 4.3842e+00, 3.7816e+05, 3.8586e+05,
        3.9096e+05, 3.9201e+05, 3.9552e+05, 3.9568e+05, 3.9771e+05, 4.1822e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 390945.1875, 390946.2812, 390950.0625, 390960.7812,
        390963.3438, 390976.5000, 390980.3750, 390996.7500, 391000.3750,
        391004.8438, 768150.8750, 776737.2500, 792891.6250, 797071.2500,
        798966.3750, 802894.6875, 811845.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5250e+00, 3.6807e+00, 3.7909e+00, 3.8017e+00, 3.8624e+00,
        3.8719e+00, 3.9406e+00, 4.0913e+00, 4.2706e+00, 3.7814e+05, 3.8588e+05,
        3.9098e+05, 3.9204e+05, 3.9557e+05, 3.9566e+05, 3.9777e+05, 4.1824e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['69466.20', '430045.38', '420452.06', '69466.52', '69459.62', '412034.81', '424745.28', '451506.44', '69465.87', '69455.46', '427834.41', '69462.09', '431514.47', '69460.28', '69460.89', '69459.35', '425261.41', '69459.20']
estimated f for each client, fs: [8, 6, 6, 8, 8, 6, 6, 6, 8, 8, 6, 8, 6, 8, 8, 8, 6, 8]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [11, 17, 18, 4, 6, 13, 20, 14, 1, 9, 19, 5, 15, 8, 2, 12, 16, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0166s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:08...
global Accuracy on shared test data: 45.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[131 106]
 [166  97]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:08, End: 2025-07-22 15:46:08)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [20, 19, 3, 7, 16, 2, 12, 14, 5, 4], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 7.6273e+05, 3.8707e+05, 3.8719e+05, 7.4214e+05, 3.8716e+05,
         3.8716e+05, 7.7205e+05, 3.8714e+05, 3.8710e+05],
        [7.6273e+05, 0.0000e+00, 3.9650e+05, 3.9656e+05, 7.8835e+05, 3.9650e+05,
         3.9651e+05, 7.7110e+05, 3.9656e+05, 3.9655e+05],
        [3.8707e+05, 3.9650e+05, 0.0000e+00, 3.9292e+00, 3.7499e+05, 4.0511e+00,
         4.2047e+00, 3.8018e+05, 3.6776e+00, 3.8529e+00],
        [3.8719e+05, 3.9656e+05, 3.9292e+00, 0.0000e+00, 3.7489e+05, 3.8384e+00,
         4.1170e+00, 3.8017e+05, 3.6915e+00, 3.9041e+00],
        [7.4214e+05, 7.8835e+05, 3.7499e+05, 3.7489e+05, 0.0000e+00, 3.7496e+05,
         3.7494e+05, 7.5269e+05, 3.7493e+05, 3.7496e+05],
        [3.8716e+05, 3.9650e+05, 4.0511e+00, 3.8384e+00, 3.7496e+05, 0.0000e+00,
         4.0016e+00, 3.8021e+05, 3.6591e+00, 3.8993e+00],
        [3.8716e+05, 3.9651e+05, 4.2047e+00, 4.1170e+00, 3.7494e+05, 4.0016e+00,
         0.0000e+00, 3.8016e+05, 3.8287e+00, 3.7312e+00],
        [7.7205e+05, 7.7110e+05, 3.8018e+05, 3.8017e+05, 7.5269e+05, 3.8021e+05,
         3.8016e+05, 0.0000e+00, 3.8016e+05, 3.8016e+05],
        [3.8714e+05, 3.9656e+05, 3.6776e+00, 3.6915e+00, 3.7493e+05, 3.6591e+00,
         3.8287e+00, 3.8016e+05, 0.0000e+00, 3.6381e+00],
        [3.8710e+05, 3.9655e+05, 3.8529e+00, 3.9041e+00, 3.7496e+05, 3.8993e+00,
         3.7312e+00, 3.8016e+05, 3.6381e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 387072.9688, 387098.3125, 387138.5000, 387158.2500,
        387162.2500, 387186.5312, 742144.5625, 762726.0625, 772050.5000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 396497.0625, 396500.7188, 396514.3750, 396548.2812,
        396559.3125, 396559.9688, 762726.0625, 771104.5000, 788350.0000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.6776e+00, 3.8529e+00, 3.9292e+00, 4.0511e+00, 4.2047e+00,
        3.7499e+05, 3.8018e+05, 3.8707e+05, 3.9650e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.6915e+00, 3.8384e+00, 3.9041e+00, 3.9292e+00, 4.1170e+00,
        3.7489e+05, 3.8017e+05, 3.8719e+05, 3.9656e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 374893.1250, 374925.5625, 374937.5625, 374961.3438,
        374963.2500, 374989.9062, 742144.5625, 752686.6250, 788350.0000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.6591e+00, 3.8384e+00, 3.8993e+00, 4.0016e+00, 4.0511e+00,
        3.7496e+05, 3.8021e+05, 3.8716e+05, 3.9650e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.7312e+00, 3.8287e+00, 4.0016e+00, 4.1170e+00, 4.2047e+00,
        3.7494e+05, 3.8016e+05, 3.8716e+05, 3.9651e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 380158.5312, 380161.1562, 380163.0938, 380169.0000,
        380182.0312, 380212.4688, 752686.6250, 771104.5000, 772050.5000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.6381e+00, 3.6591e+00, 3.6776e+00, 3.6915e+00, 3.8287e+00,
        3.7493e+05, 3.8016e+05, 3.8714e+05, 3.9656e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.6381e+00, 3.7312e+00, 3.8529e+00, 3.8993e+00, 3.9041e+00,
        3.7496e+05, 3.8016e+05, 3.8710e+05, 3.9655e+05])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['437851.56', '448843.62', '107884.52', '107868.80', '427402.16', '107885.02', '107873.71', '433390.41', '107872.17', '107877.64']
estimated f for each client, fs: [2, 2, 4, 4, 2, 4, 4, 2, 4, 4]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [20, 19, 3, 7, 16, 2, 12, 14, 5, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0077s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:08...
global Accuracy on shared test data: 44.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[126 111]
 [165  98]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:08, End: 2025-07-22 15:46:08)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [9, 2, 13, 5, 7, 11, 20, 3, 12, 16, 4], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
tensor([[0.0000e+00, 3.7797e+00, 3.8388e+05, 4.0036e+00, 4.2791e+00, 4.2346e+00,
         3.8417e+05, 3.8363e+00, 4.4138e+00, 3.8249e+05, 4.0272e+00],
        [3.7797e+00, 0.0000e+00, 3.8386e+05, 3.7035e+00, 3.8123e+00, 4.0363e+00,
         3.8416e+05, 3.9893e+00, 3.9556e+00, 3.8257e+05, 3.9582e+00],
        [3.8388e+05, 3.8386e+05, 0.0000e+00, 3.8388e+05, 3.8382e+05, 3.8381e+05,
         7.5542e+05, 3.8384e+05, 3.8387e+05, 7.6461e+05, 3.8383e+05],
        [4.0036e+00, 3.7035e+00, 3.8388e+05, 0.0000e+00, 3.7070e+00, 3.7820e+00,
         3.8414e+05, 3.7402e+00, 3.8662e+00, 3.8254e+05, 3.7200e+00],
        [4.2791e+00, 3.8123e+00, 3.8382e+05, 3.7070e+00, 0.0000e+00, 3.9567e+00,
         3.8418e+05, 3.8739e+00, 4.0164e+00, 3.8254e+05, 3.8717e+00],
        [4.2346e+00, 4.0363e+00, 3.8381e+05, 3.7820e+00, 3.9567e+00, 0.0000e+00,
         3.8410e+05, 4.1147e+00, 4.3168e+00, 3.8255e+05, 3.8926e+00],
        [3.8417e+05, 3.8416e+05, 7.5542e+05, 3.8414e+05, 3.8418e+05, 3.8410e+05,
         0.0000e+00, 3.8412e+05, 3.8418e+05, 7.4084e+05, 3.8413e+05],
        [3.8363e+00, 3.9893e+00, 3.8384e+05, 3.7402e+00, 3.8739e+00, 4.1147e+00,
         3.8412e+05, 0.0000e+00, 4.1415e+00, 3.8251e+05, 3.8194e+00],
        [4.4138e+00, 3.9556e+00, 3.8387e+05, 3.8662e+00, 4.0164e+00, 4.3168e+00,
         3.8418e+05, 4.1415e+00, 0.0000e+00, 3.8253e+05, 3.7294e+00],
        [3.8249e+05, 3.8257e+05, 7.6461e+05, 3.8254e+05, 3.8254e+05, 3.8255e+05,
         7.4084e+05, 3.8251e+05, 3.8253e+05, 0.0000e+00, 3.8252e+05],
        [4.0272e+00, 3.9582e+00, 3.8383e+05, 3.7200e+00, 3.8717e+00, 3.8926e+00,
         3.8413e+05, 3.8194e+00, 3.7294e+00, 3.8252e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.7797e+00, 3.8363e+00, 4.0036e+00, 4.0272e+00, 4.2346e+00,
        4.2791e+00, 4.4138e+00, 3.8249e+05, 3.8388e+05, 3.8417e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.7035e+00, 3.7797e+00, 3.8123e+00, 3.9556e+00, 3.9582e+00,
        3.9893e+00, 4.0363e+00, 3.8257e+05, 3.8386e+05, 3.8416e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 383811.5000, 383815.3125, 383833.1250, 383839.6562,
        383859.2812, 383867.2500, 383876.5312, 383880.2812, 755421.5625,
        764608.7500])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.7035e+00, 3.7070e+00, 3.7200e+00, 3.7402e+00, 3.7820e+00,
        3.8662e+00, 4.0036e+00, 3.8254e+05, 3.8388e+05, 3.8414e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.7070e+00, 3.8123e+00, 3.8717e+00, 3.8739e+00, 3.9567e+00,
        4.0164e+00, 4.2791e+00, 3.8254e+05, 3.8382e+05, 3.8418e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.7820e+00, 3.8926e+00, 3.9567e+00, 4.0363e+00, 4.1147e+00,
        4.2346e+00, 4.3168e+00, 3.8255e+05, 3.8381e+05, 3.8410e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 384101.5938, 384120.2812, 384126.9062, 384143.5938,
        384156.4688, 384171.0000, 384183.1562, 384184.4688, 740842.5000,
        755421.5625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.7402e+00, 3.8194e+00, 3.8363e+00, 3.8739e+00, 3.9893e+00,
        4.1147e+00, 4.1415e+00, 3.8251e+05, 3.8384e+05, 3.8412e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.7294e+00, 3.8662e+00, 3.9556e+00, 4.0164e+00, 4.1415e+00,
        4.3168e+00, 4.4138e+00, 3.8253e+05, 3.8387e+05, 3.8418e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 382489.3125, 382514.4375, 382516.1250, 382528.7500,
        382536.3438, 382540.4375, 382552.5000, 382567.9688, 740842.5000,
        764608.7500])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.7200e+00, 3.7294e+00, 3.8194e+00, 3.8717e+00, 3.8926e+00,
        3.9582e+00, 4.0272e+00, 3.8252e+05, 3.8383e+05, 3.8413e+05])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['4.08', '3.89', '383847.88', '3.79', '3.93', '4.05', '384148.44', '3.93', '4.06', '382530.75', '3.86']
estimated f for each client, fs: [3, 3, 1, 3, 3, 3, 1, 3, 3, 1, 3]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [9, 2, 13, 5, 7, 11, 20, 3, 12, 16, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0141s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:09...
global Accuracy on shared test data: 45.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[123 114]
 [157 106]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:09, End: 2025-07-22 15:46:09)
start time is: 98138139962758, end time is: 98150999775110
The total time is: 12859812352ns.

 ------- aggregate method: rkrum, random_seed: 300 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [11, 13, 7, 19, 12, 15, 18, 17, 1, 6, 4, 14, 20, 16, 5, 3, 10, 9, 8, 2], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 3.8958e+05, 4.2719e+00, 3.9632e+05, 3.8200e+00, 4.0388e+05,
         3.9878e+05, 4.1096e+05, 3.7416e+00, 4.2329e+00, 4.0416e+00, 3.9374e+05,
         3.8153e+05, 3.8036e+05, 4.0475e+00, 4.0545e+00, 4.3435e+00, 4.6492e+00,
         4.1539e+00, 4.2849e+00],
        [3.8958e+05, 0.0000e+00, 3.8962e+05, 7.9629e+05, 3.8959e+05, 8.0614e+05,
         8.0664e+05, 8.0240e+05, 3.8959e+05, 3.8963e+05, 3.8960e+05, 7.9413e+05,
         7.6463e+05, 7.7257e+05, 3.8962e+05, 3.8963e+05, 3.8964e+05, 3.8958e+05,
         3.8964e+05, 3.8961e+05],
        [4.2719e+00, 3.8962e+05, 0.0000e+00, 3.9635e+05, 4.6154e+00, 4.0387e+05,
         3.9875e+05, 4.1099e+05, 4.6982e+00, 4.1873e+00, 4.8497e+00, 3.9361e+05,
         3.8156e+05, 3.8039e+05, 4.8985e+00, 4.1007e+00, 3.9999e+00, 5.0411e+00,
         4.7544e+00, 3.8781e+00],
        [3.9632e+05, 7.9629e+05, 3.9635e+05, 0.0000e+00, 3.9636e+05, 8.0283e+05,
         7.9783e+05, 8.2180e+05, 3.9633e+05, 3.9638e+05, 3.9635e+05, 7.9573e+05,
         7.6970e+05, 7.5939e+05, 3.9636e+05, 3.9634e+05, 3.9638e+05, 3.9638e+05,
         3.9635e+05, 3.9636e+05],
        [3.8200e+00, 3.8959e+05, 4.6154e+00, 3.9636e+05, 0.0000e+00, 4.0383e+05,
         3.9882e+05, 4.1094e+05, 4.1285e+00, 4.7503e+00, 4.3998e+00, 3.9370e+05,
         3.8157e+05, 3.8036e+05, 4.0631e+00, 3.9508e+00, 4.2415e+00, 4.8927e+00,
         4.1266e+00, 4.4174e+00],
        [4.0388e+05, 8.0614e+05, 4.0387e+05, 8.0283e+05, 4.0383e+05, 0.0000e+00,
         8.1761e+05, 7.9030e+05, 4.0394e+05, 4.0386e+05, 4.0390e+05, 7.8474e+05,
         7.9246e+05, 7.9338e+05, 4.0389e+05, 4.0387e+05, 4.0392e+05, 4.0389e+05,
         4.0393e+05, 4.0388e+05],
        [3.9878e+05, 8.0664e+05, 3.9875e+05, 7.9783e+05, 3.9882e+05, 8.1761e+05,
         0.0000e+00, 8.0910e+05, 3.9884e+05, 3.9884e+05, 3.9879e+05, 7.9505e+05,
         7.9487e+05, 7.8691e+05, 3.9878e+05, 3.9877e+05, 3.9883e+05, 3.9877e+05,
         3.9879e+05, 3.9881e+05],
        [4.1096e+05, 8.0240e+05, 4.1099e+05, 8.2180e+05, 4.1094e+05, 7.9030e+05,
         8.0910e+05, 0.0000e+00, 4.1102e+05, 4.1102e+05, 4.1102e+05, 8.0047e+05,
         7.7526e+05, 7.6423e+05, 4.1105e+05, 4.1102e+05, 4.1099e+05, 4.1100e+05,
         4.1100e+05, 4.1100e+05],
        [3.7416e+00, 3.8959e+05, 4.6982e+00, 3.9633e+05, 4.1285e+00, 4.0394e+05,
         3.9884e+05, 4.1102e+05, 0.0000e+00, 4.4075e+00, 4.1568e+00, 3.9371e+05,
         3.8156e+05, 3.8033e+05, 4.4355e+00, 4.3307e+00, 4.3243e+00, 4.7529e+00,
         4.6384e+00, 4.6101e+00],
        [4.2329e+00, 3.8963e+05, 4.1873e+00, 3.9638e+05, 4.7503e+00, 4.0386e+05,
         3.9884e+05, 4.1102e+05, 4.4075e+00, 0.0000e+00, 4.5851e+00, 3.9362e+05,
         3.8158e+05, 3.8049e+05, 4.8852e+00, 4.3440e+00, 4.0463e+00, 5.3169e+00,
         4.7032e+00, 3.7899e+00],
        [4.0416e+00, 3.8960e+05, 4.8497e+00, 3.9635e+05, 4.3998e+00, 4.0390e+05,
         3.9879e+05, 4.1102e+05, 4.1568e+00, 4.5851e+00, 0.0000e+00, 3.9369e+05,
         3.8157e+05, 3.8039e+05, 4.6655e+00, 4.6417e+00, 4.6650e+00, 5.0943e+00,
         4.9828e+00, 4.5409e+00],
        [3.9374e+05, 7.9413e+05, 3.9361e+05, 7.9573e+05, 3.9370e+05, 7.8474e+05,
         7.9505e+05, 8.0047e+05, 3.9371e+05, 3.9362e+05, 3.9369e+05, 0.0000e+00,
         7.7914e+05, 7.8006e+05, 3.9368e+05, 3.9366e+05, 3.9363e+05, 3.9368e+05,
         3.9366e+05, 3.9362e+05],
        [3.8153e+05, 7.6463e+05, 3.8156e+05, 7.6970e+05, 3.8157e+05, 7.9246e+05,
         7.9487e+05, 7.7526e+05, 3.8156e+05, 3.8158e+05, 3.8157e+05, 7.7914e+05,
         0.0000e+00, 7.4769e+05, 3.8151e+05, 3.8157e+05, 3.8156e+05, 3.8160e+05,
         3.8157e+05, 3.8155e+05],
        [3.8036e+05, 7.7257e+05, 3.8039e+05, 7.5939e+05, 3.8036e+05, 7.9338e+05,
         7.8691e+05, 7.6423e+05, 3.8033e+05, 3.8049e+05, 3.8039e+05, 7.8006e+05,
         7.4769e+05, 0.0000e+00, 3.8039e+05, 3.8041e+05, 3.8038e+05, 3.8038e+05,
         3.8035e+05, 3.8046e+05],
        [4.0475e+00, 3.8962e+05, 4.8985e+00, 3.9636e+05, 4.0631e+00, 4.0389e+05,
         3.9878e+05, 4.1105e+05, 4.4355e+00, 4.8852e+00, 4.6655e+00, 3.9368e+05,
         3.8151e+05, 3.8039e+05, 0.0000e+00, 4.5334e+00, 4.8126e+00, 5.5648e+00,
         4.5015e+00, 4.8023e+00],
        [4.0545e+00, 3.8963e+05, 4.1007e+00, 3.9634e+05, 3.9508e+00, 4.0387e+05,
         3.9877e+05, 4.1102e+05, 4.3307e+00, 4.3440e+00, 4.6417e+00, 3.9366e+05,
         3.8157e+05, 3.8041e+05, 4.5334e+00, 0.0000e+00, 4.3116e+00, 4.4195e+00,
         4.2090e+00, 4.0407e+00],
        [4.3435e+00, 3.8964e+05, 3.9999e+00, 3.9638e+05, 4.2415e+00, 4.0392e+05,
         3.9883e+05, 4.1099e+05, 4.3243e+00, 4.0463e+00, 4.6650e+00, 3.9363e+05,
         3.8156e+05, 3.8038e+05, 4.8126e+00, 4.3116e+00, 0.0000e+00, 5.4249e+00,
         4.3544e+00, 3.8229e+00],
        [4.6492e+00, 3.8958e+05, 5.0411e+00, 3.9638e+05, 4.8927e+00, 4.0389e+05,
         3.9877e+05, 4.1100e+05, 4.7529e+00, 5.3169e+00, 5.0943e+00, 3.9368e+05,
         3.8160e+05, 3.8038e+05, 5.5648e+00, 4.4195e+00, 5.4249e+00, 0.0000e+00,
         4.9896e+00, 4.8878e+00],
        [4.1539e+00, 3.8964e+05, 4.7544e+00, 3.9635e+05, 4.1266e+00, 4.0393e+05,
         3.9879e+05, 4.1100e+05, 4.6384e+00, 4.7032e+00, 4.9828e+00, 3.9366e+05,
         3.8157e+05, 3.8035e+05, 4.5015e+00, 4.2090e+00, 4.3544e+00, 4.9896e+00,
         0.0000e+00, 4.6679e+00],
        [4.2849e+00, 3.8961e+05, 3.8781e+00, 3.9636e+05, 4.4174e+00, 4.0388e+05,
         3.9881e+05, 4.1100e+05, 4.6101e+00, 3.7899e+00, 4.5409e+00, 3.9362e+05,
         3.8155e+05, 3.8046e+05, 4.8023e+00, 4.0407e+00, 3.8229e+00, 4.8878e+00,
         4.6679e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.7416e+00, 3.8200e+00, 4.0416e+00, 4.0475e+00, 4.0545e+00,
        4.1539e+00, 4.2329e+00, 4.2719e+00, 4.2849e+00, 4.3435e+00, 4.6492e+00,
        3.8036e+05, 3.8153e+05, 3.8958e+05, 3.9374e+05, 3.9632e+05, 3.9878e+05,
        4.0388e+05, 4.1096e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 389578.1562, 389580.2188, 389587.7188, 389590.1875,
        389599.4375, 389613.1562, 389622.0312, 389622.4062, 389628.6875,
        389631.6250, 389635.2500, 389640.6562, 764625.1250, 772569.8125,
        794134.0000, 796287.6875, 802401.0625, 806135.0625, 806640.1875])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.8781e+00, 3.9999e+00, 4.1007e+00, 4.1873e+00, 4.2719e+00,
        4.6154e+00, 4.6982e+00, 4.7544e+00, 4.8497e+00, 4.8985e+00, 5.0411e+00,
        3.8039e+05, 3.8156e+05, 3.8962e+05, 3.9361e+05, 3.9635e+05, 3.9875e+05,
        4.0387e+05, 4.1099e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 396319.8438, 396327.3750, 396336.5000, 396346.8125,
        396352.1875, 396353.2188, 396358.8750, 396361.8125, 396362.3750,
        396375.1562, 396378.1250, 396381.1250, 759388.0625, 769704.9375,
        795729.0625, 796287.6875, 797829.1250, 802825.9375, 821798.0625])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.8200e+00, 3.9508e+00, 4.0631e+00, 4.1266e+00, 4.1285e+00,
        4.2415e+00, 4.3998e+00, 4.4174e+00, 4.6154e+00, 4.7503e+00, 4.8927e+00,
        3.8036e+05, 3.8157e+05, 3.8959e+05, 3.9370e+05, 3.9636e+05, 3.9882e+05,
        4.0383e+05, 4.1094e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 403833.8750, 403864.3125, 403867.8438, 403873.0625,
        403876.4375, 403881.0312, 403885.5000, 403891.1250, 403903.5938,
        403915.2812, 403929.1562, 403935.7500, 784735.8750, 790303.6875,
        792455.3125, 793380.8750, 802825.9375, 806135.0625, 817613.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 398748.7812, 398766.4688, 398769.0625, 398776.0000,
        398780.1562, 398785.3438, 398792.6875, 398811.2812, 398820.6250,
        398825.5000, 398835.9375, 398838.2812, 786905.4375, 794867.8125,
        795051.2500, 797829.1250, 806640.1875, 809095.7500, 817613.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 410939.2188, 410962.0625, 410990.1875, 410992.6250,
        410997.0938, 410998.4688, 411004.0000, 411016.1250, 411016.8438,
        411020.7812, 411020.9375, 411045.7500, 764233.3125, 775261.4375,
        790303.6875, 800467.3750, 802401.0625, 809095.7500, 821798.0625])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.7416e+00, 4.1285e+00, 4.1568e+00, 4.3243e+00, 4.3307e+00,
        4.4075e+00, 4.4355e+00, 4.6101e+00, 4.6384e+00, 4.6982e+00, 4.7529e+00,
        3.8033e+05, 3.8156e+05, 3.8959e+05, 3.9371e+05, 3.9633e+05, 3.9884e+05,
        4.0394e+05, 4.1102e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.7899e+00, 4.0463e+00, 4.1873e+00, 4.2329e+00, 4.3440e+00,
        4.4075e+00, 4.5851e+00, 4.7032e+00, 4.7503e+00, 4.8852e+00, 5.3169e+00,
        3.8049e+05, 3.8158e+05, 3.8963e+05, 3.9362e+05, 3.9638e+05, 3.9884e+05,
        4.0386e+05, 4.1102e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 4.0416e+00, 4.1568e+00, 4.3998e+00, 4.5409e+00, 4.5851e+00,
        4.6417e+00, 4.6650e+00, 4.6655e+00, 4.8497e+00, 4.9828e+00, 5.0943e+00,
        3.8039e+05, 3.8157e+05, 3.8960e+05, 3.9369e+05, 3.9635e+05, 3.9879e+05,
        4.0390e+05, 4.1102e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 393611.0000, 393615.9375, 393621.2500, 393627.2188,
        393660.9062, 393662.5938, 393676.0625, 393681.5625, 393685.5312,
        393697.8125, 393710.1562, 393741.0000, 779142.3125, 780058.1250,
        784735.8750, 794134.0000, 795051.2500, 795729.0625, 800467.3750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 381507.7500, 381529.7500, 381553.6562, 381557.0000,
        381558.1562, 381559.8438, 381566.5000, 381568.1250, 381573.7188,
        381574.1562, 381580.1875, 381596.2188, 747686.0625, 764625.1250,
        769704.9375, 775261.4375, 779142.3125, 792455.3125, 794867.8125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 380326.0312, 380354.7188, 380355.4375, 380357.3125,
        380375.1250, 380380.5000, 380388.7188, 380393.2812, 380394.9688,
        380411.4375, 380460.5000, 380485.0312, 747686.0625, 759388.0625,
        764233.3125, 772569.8125, 780058.1250, 786905.4375, 793380.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 4.0475e+00, 4.0631e+00, 4.4355e+00, 4.5015e+00, 4.5334e+00,
        4.6655e+00, 4.8023e+00, 4.8126e+00, 4.8852e+00, 4.8985e+00, 5.5648e+00,
        3.8039e+05, 3.8151e+05, 3.8962e+05, 3.9368e+05, 3.9636e+05, 3.9878e+05,
        4.0389e+05, 4.1105e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.9508e+00, 4.0407e+00, 4.0545e+00, 4.1007e+00, 4.2090e+00,
        4.3116e+00, 4.3307e+00, 4.3440e+00, 4.4195e+00, 4.5334e+00, 4.6417e+00,
        3.8041e+05, 3.8157e+05, 3.8963e+05, 3.9366e+05, 3.9634e+05, 3.9877e+05,
        4.0387e+05, 4.1102e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.8229e+00, 3.9999e+00, 4.0463e+00, 4.2415e+00, 4.3116e+00,
        4.3243e+00, 4.3435e+00, 4.3544e+00, 4.6650e+00, 4.8126e+00, 5.4249e+00,
        3.8038e+05, 3.8156e+05, 3.8964e+05, 3.9363e+05, 3.9638e+05, 3.9883e+05,
        4.0392e+05, 4.1099e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 4.4195e+00, 4.6492e+00, 4.7529e+00, 4.8878e+00, 4.8927e+00,
        4.9896e+00, 5.0411e+00, 5.0943e+00, 5.3169e+00, 5.4249e+00, 5.5648e+00,
        3.8038e+05, 3.8160e+05, 3.8958e+05, 3.9368e+05, 3.9638e+05, 3.9877e+05,
        4.0389e+05, 4.1100e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 4.1266e+00, 4.1539e+00, 4.2090e+00, 4.3544e+00, 4.5015e+00,
        4.6384e+00, 4.6679e+00, 4.7032e+00, 4.7544e+00, 4.9828e+00, 4.9896e+00,
        3.8035e+05, 3.8157e+05, 3.8964e+05, 3.9366e+05, 3.9635e+05, 3.9879e+05,
        4.0393e+05, 4.1100e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.7899e+00, 3.8229e+00, 3.8781e+00, 4.0407e+00, 4.2849e+00,
        4.4174e+00, 4.5409e+00, 4.6101e+00, 4.6679e+00, 4.8023e+00, 4.8878e+00,
        3.8046e+05, 3.8155e+05, 3.8961e+05, 3.9362e+05, 3.9636e+05, 3.9881e+05,
        4.0388e+05, 4.1100e+05])
Index of maximum distance difference after half of values: 12
adaptive_Krum scores:  ['31700.24', '389610.78', '31703.68', '396354.38', '31700.24', '403888.06', '398795.78', '411000.31', '31697.86', '31711.18', '31703.27', '393665.84', '381560.38', '380390.22', '31703.70', '31704.86', '31702.40', '31702.51', '31700.39', '31709.02']
estimated f for each client, fs: [8, 6, 8, 6, 8, 6, 6, 6, 8, 8, 8, 6, 6, 6, 8, 8, 8, 8, 8, 8]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [11, 13, 7, 19, 12, 15, 18, 17, 1, 6, 4, 14, 20, 16, 5, 3, 10, 9, 8, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0146s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:09...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:46:09, End: 2025-07-22 15:46:09)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [6, 13, 20, 4, 1, 9, 14, 15, 8, 2, 5, 3, 7, 10, 17, 19, 11, 16, 12, 18], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 3.8528e+05, 3.9917e+05, 1.7700e+00, 2.1089e+00, 1.8205e+00,
         3.8873e+05, 3.9536e+05, 2.0246e+00, 1.7803e+00, 1.9716e+00, 2.1304e+00,
         2.0832e+00, 2.0374e+00, 4.0769e+05, 3.9975e+05, 1.8795e+00, 3.9272e+05,
         2.0024e+00, 3.8144e+05],
        [3.8528e+05, 0.0000e+00, 8.1396e+05, 3.8531e+05, 3.8526e+05, 3.8524e+05,
         7.8955e+05, 7.9930e+05, 3.8527e+05, 3.8528e+05, 3.8527e+05, 3.8525e+05,
         3.8523e+05, 3.8531e+05, 7.7697e+05, 7.8249e+05, 3.8528e+05, 7.8058e+05,
         3.8524e+05, 7.7872e+05],
        [3.9917e+05, 8.1396e+05, 0.0000e+00, 3.9918e+05, 3.9920e+05, 3.9918e+05,
         7.7440e+05, 7.8126e+05, 3.9914e+05, 3.9915e+05, 3.9915e+05, 3.9914e+05,
         3.9916e+05, 3.9915e+05, 7.7751e+05, 7.9144e+05, 3.9913e+05, 7.8545e+05,
         3.9915e+05, 7.9148e+05],
        [1.7700e+00, 3.8531e+05, 3.9918e+05, 0.0000e+00, 2.1414e+00, 1.8511e+00,
         3.8874e+05, 3.9537e+05, 1.9200e+00, 1.9168e+00, 1.8501e+00, 1.9706e+00,
         1.8700e+00, 1.8829e+00, 4.0772e+05, 3.9976e+05, 1.8337e+00, 3.9275e+05,
         1.9058e+00, 3.8142e+05],
        [2.1089e+00, 3.8526e+05, 3.9920e+05, 2.1414e+00, 0.0000e+00, 1.9544e+00,
         3.8872e+05, 3.9539e+05, 2.2790e+00, 2.0642e+00, 1.9898e+00, 2.2690e+00,
         2.2000e+00, 2.0194e+00, 4.0771e+05, 3.9974e+05, 1.9629e+00, 3.9280e+05,
         2.0861e+00, 3.8137e+05],
        [1.8205e+00, 3.8524e+05, 3.9918e+05, 1.8511e+00, 1.9544e+00, 0.0000e+00,
         3.8873e+05, 3.9536e+05, 1.9860e+00, 1.7788e+00, 1.9890e+00, 1.7893e+00,
         1.8685e+00, 1.6991e+00, 4.0770e+05, 3.9972e+05, 1.7734e+00, 3.9277e+05,
         1.8536e+00, 3.8142e+05],
        [3.8873e+05, 7.8955e+05, 7.7440e+05, 3.8874e+05, 3.8872e+05, 3.8873e+05,
         0.0000e+00, 7.9533e+05, 3.8871e+05, 3.8876e+05, 3.8872e+05, 3.8869e+05,
         3.8871e+05, 3.8869e+05, 7.9654e+05, 7.9366e+05, 3.8874e+05, 7.8869e+05,
         3.8876e+05, 7.7413e+05],
        [3.9536e+05, 7.9930e+05, 7.8126e+05, 3.9537e+05, 3.9539e+05, 3.9536e+05,
         7.9533e+05, 0.0000e+00, 3.9535e+05, 3.9537e+05, 3.9538e+05, 3.9538e+05,
         3.9539e+05, 3.9537e+05, 8.1333e+05, 8.0264e+05, 3.9540e+05, 7.8830e+05,
         3.9536e+05, 7.7455e+05],
        [2.0246e+00, 3.8527e+05, 3.9914e+05, 1.9200e+00, 2.2790e+00, 1.9860e+00,
         3.8871e+05, 3.9535e+05, 0.0000e+00, 2.0137e+00, 2.0304e+00, 1.8956e+00,
         2.0966e+00, 1.8025e+00, 4.0769e+05, 3.9975e+05, 1.9489e+00, 3.9276e+05,
         1.9152e+00, 3.8141e+05],
        [1.7803e+00, 3.8528e+05, 3.9915e+05, 1.9168e+00, 2.0642e+00, 1.7788e+00,
         3.8876e+05, 3.9537e+05, 2.0137e+00, 0.0000e+00, 1.8878e+00, 1.8510e+00,
         1.7833e+00, 1.7580e+00, 4.0770e+05, 3.9973e+05, 1.9639e+00, 3.9275e+05,
         1.8439e+00, 3.8141e+05],
        [1.9716e+00, 3.8527e+05, 3.9915e+05, 1.8501e+00, 1.9898e+00, 1.9890e+00,
         3.8872e+05, 3.9538e+05, 2.0304e+00, 1.8878e+00, 0.0000e+00, 1.8863e+00,
         1.9154e+00, 1.9084e+00, 4.0766e+05, 3.9972e+05, 1.8095e+00, 3.9274e+05,
         1.8772e+00, 3.8138e+05],
        [2.1304e+00, 3.8525e+05, 3.9914e+05, 1.9706e+00, 2.2690e+00, 1.7893e+00,
         3.8869e+05, 3.9538e+05, 1.8956e+00, 1.8510e+00, 1.8863e+00, 0.0000e+00,
         1.9485e+00, 1.8206e+00, 4.0771e+05, 3.9974e+05, 2.0854e+00, 3.9272e+05,
         1.8502e+00, 3.8139e+05],
        [2.0832e+00, 3.8523e+05, 3.9916e+05, 1.8700e+00, 2.2000e+00, 1.8685e+00,
         3.8871e+05, 3.9539e+05, 2.0966e+00, 1.7833e+00, 1.9154e+00, 1.9485e+00,
         0.0000e+00, 1.8318e+00, 4.0772e+05, 3.9975e+05, 2.0234e+00, 3.9277e+05,
         1.8612e+00, 3.8139e+05],
        [2.0374e+00, 3.8531e+05, 3.9915e+05, 1.8829e+00, 2.0194e+00, 1.6991e+00,
         3.8869e+05, 3.9537e+05, 1.8025e+00, 1.7580e+00, 1.9084e+00, 1.8206e+00,
         1.8318e+00, 0.0000e+00, 4.0770e+05, 3.9974e+05, 1.8518e+00, 3.9277e+05,
         1.8771e+00, 3.8142e+05],
        [4.0769e+05, 7.7697e+05, 7.7751e+05, 4.0772e+05, 4.0771e+05, 4.0770e+05,
         7.9654e+05, 8.1333e+05, 4.0769e+05, 4.0770e+05, 4.0766e+05, 4.0771e+05,
         4.0772e+05, 4.0770e+05, 0.0000e+00, 8.0173e+05, 4.0771e+05, 7.8898e+05,
         4.0773e+05, 7.8460e+05],
        [3.9975e+05, 7.8249e+05, 7.9144e+05, 3.9976e+05, 3.9974e+05, 3.9972e+05,
         7.9366e+05, 8.0264e+05, 3.9975e+05, 3.9973e+05, 3.9972e+05, 3.9974e+05,
         3.9975e+05, 3.9974e+05, 8.0173e+05, 0.0000e+00, 3.9976e+05, 8.1524e+05,
         3.9976e+05, 7.8495e+05],
        [1.8795e+00, 3.8528e+05, 3.9913e+05, 1.8337e+00, 1.9629e+00, 1.7734e+00,
         3.8874e+05, 3.9540e+05, 1.9489e+00, 1.9639e+00, 1.8095e+00, 2.0854e+00,
         2.0234e+00, 1.8518e+00, 4.0771e+05, 3.9976e+05, 0.0000e+00, 3.9275e+05,
         1.8677e+00, 3.8143e+05],
        [3.9272e+05, 7.8058e+05, 7.8545e+05, 3.9275e+05, 3.9280e+05, 3.9277e+05,
         7.8869e+05, 7.8830e+05, 3.9276e+05, 3.9275e+05, 3.9274e+05, 3.9272e+05,
         3.9277e+05, 3.9277e+05, 7.8898e+05, 8.1524e+05, 3.9275e+05, 0.0000e+00,
         3.9276e+05, 7.7005e+05],
        [2.0024e+00, 3.8524e+05, 3.9915e+05, 1.9058e+00, 2.0861e+00, 1.8536e+00,
         3.8876e+05, 3.9536e+05, 1.9152e+00, 1.8439e+00, 1.8772e+00, 1.8502e+00,
         1.8612e+00, 1.8771e+00, 4.0773e+05, 3.9976e+05, 1.8677e+00, 3.9276e+05,
         0.0000e+00, 3.8139e+05],
        [3.8144e+05, 7.7872e+05, 7.9148e+05, 3.8142e+05, 3.8137e+05, 3.8142e+05,
         7.7413e+05, 7.7455e+05, 3.8141e+05, 3.8141e+05, 3.8138e+05, 3.8139e+05,
         3.8139e+05, 3.8142e+05, 7.8460e+05, 7.8495e+05, 3.8143e+05, 7.7005e+05,
         3.8139e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7700e+00, 1.7803e+00, 1.8205e+00, 1.8795e+00, 1.9716e+00,
        2.0024e+00, 2.0246e+00, 2.0374e+00, 2.0832e+00, 2.1089e+00, 2.1304e+00,
        3.8144e+05, 3.8528e+05, 3.8873e+05, 3.9272e+05, 3.9536e+05, 3.9917e+05,
        3.9975e+05, 4.0769e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 385229.5312, 385241.9062, 385244.8750, 385254.0625,
        385264.1250, 385267.1875, 385267.8438, 385275.8750, 385281.3750,
        385283.6875, 385308.9062, 385310.2500, 776971.0000, 778717.8750,
        780577.5000, 782492.2500, 789552.7500, 799301.3750, 813957.1250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 399132.0312, 399141.0938, 399143.5312, 399147.5938,
        399148.5000, 399148.9062, 399152.5625, 399156.0938, 399173.0312,
        399175.6875, 399177.3125, 399203.5000, 774398.4375, 777509.6250,
        781258.0000, 785448.4375, 791440.5625, 791480.9375, 813957.1250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.7700e+00, 1.8337e+00, 1.8501e+00, 1.8511e+00, 1.8700e+00,
        1.8829e+00, 1.9058e+00, 1.9168e+00, 1.9200e+00, 1.9706e+00, 2.1414e+00,
        3.8142e+05, 3.8531e+05, 3.8874e+05, 3.9275e+05, 3.9537e+05, 3.9918e+05,
        3.9976e+05, 4.0772e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.9544e+00, 1.9629e+00, 1.9898e+00, 2.0194e+00, 2.0642e+00,
        2.0861e+00, 2.1089e+00, 2.1414e+00, 2.2000e+00, 2.2690e+00, 2.2790e+00,
        3.8137e+05, 3.8526e+05, 3.8872e+05, 3.9280e+05, 3.9539e+05, 3.9920e+05,
        3.9974e+05, 4.0771e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.6991e+00, 1.7734e+00, 1.7788e+00, 1.7893e+00, 1.8205e+00,
        1.8511e+00, 1.8536e+00, 1.8685e+00, 1.9544e+00, 1.9860e+00, 1.9890e+00,
        3.8142e+05, 3.8524e+05, 3.8873e+05, 3.9277e+05, 3.9536e+05, 3.9918e+05,
        3.9972e+05, 4.0770e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 388686.0625, 388693.6250, 388709.0625, 388709.2500,
        388719.6250, 388724.3750, 388725.2500, 388729.1875, 388736.6250,
        388743.0625, 388760.5312, 388761.0625, 774128.3125, 774398.4375,
        788693.8750, 789552.7500, 793656.3125, 795332.4375, 796539.3125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 395351.4375, 395356.6250, 395357.9375, 395363.5625,
        395366.8438, 395373.3438, 395374.0938, 395376.1875, 395383.0000,
        395391.7188, 395393.4375, 395397.5625, 774547.6250, 781258.0000,
        788297.6250, 795332.4375, 799301.3750, 802639.9375, 813333.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.8025e+00, 1.8956e+00, 1.9152e+00, 1.9200e+00, 1.9489e+00,
        1.9860e+00, 2.0137e+00, 2.0246e+00, 2.0304e+00, 2.0966e+00, 2.2790e+00,
        3.8141e+05, 3.8527e+05, 3.8871e+05, 3.9276e+05, 3.9535e+05, 3.9914e+05,
        3.9975e+05, 4.0769e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.7580e+00, 1.7788e+00, 1.7803e+00, 1.7833e+00, 1.8439e+00,
        1.8510e+00, 1.8878e+00, 1.9168e+00, 1.9639e+00, 2.0137e+00, 2.0642e+00,
        3.8141e+05, 3.8528e+05, 3.8876e+05, 3.9275e+05, 3.9537e+05, 3.9915e+05,
        3.9973e+05, 4.0770e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.8095e+00, 1.8501e+00, 1.8772e+00, 1.8863e+00, 1.8878e+00,
        1.9084e+00, 1.9154e+00, 1.9716e+00, 1.9890e+00, 1.9898e+00, 2.0304e+00,
        3.8138e+05, 3.8527e+05, 3.8872e+05, 3.9274e+05, 3.9538e+05, 3.9915e+05,
        3.9972e+05, 4.0766e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.7893e+00, 1.8206e+00, 1.8502e+00, 1.8510e+00, 1.8863e+00,
        1.8956e+00, 1.9485e+00, 1.9706e+00, 2.0854e+00, 2.1304e+00, 2.2690e+00,
        3.8139e+05, 3.8525e+05, 3.8869e+05, 3.9272e+05, 3.9538e+05, 3.9914e+05,
        3.9974e+05, 4.0771e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.7833e+00, 1.8318e+00, 1.8612e+00, 1.8685e+00, 1.8700e+00,
        1.9154e+00, 1.9485e+00, 2.0234e+00, 2.0832e+00, 2.0966e+00, 2.2000e+00,
        3.8139e+05, 3.8523e+05, 3.8871e+05, 3.9277e+05, 3.9539e+05, 3.9916e+05,
        3.9975e+05, 4.0772e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.6991e+00, 1.7580e+00, 1.8025e+00, 1.8206e+00, 1.8318e+00,
        1.8518e+00, 1.8771e+00, 1.8829e+00, 1.9084e+00, 2.0194e+00, 2.0374e+00,
        3.8142e+05, 3.8531e+05, 3.8869e+05, 3.9277e+05, 3.9537e+05, 3.9915e+05,
        3.9974e+05, 4.0770e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 407661.1250, 407685.6250, 407687.2188, 407697.4688,
        407699.2500, 407702.7500, 407706.1875, 407707.7812, 407710.6250,
        407715.0000, 407723.9062, 407725.9375, 776971.0000, 777509.6250,
        784601.7500, 788979.1250, 796539.3125, 801728.6875, 813333.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 399719.2188, 399720.2812, 399733.1250, 399735.9375,
        399736.8438, 399742.5625, 399751.3125, 399753.9688, 399754.0000,
        399757.9688, 399758.7188, 399763.3125, 782492.2500, 784949.5000,
        791440.5625, 793656.3125, 801728.6875, 802639.9375, 815237.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.7734e+00, 1.8095e+00, 1.8337e+00, 1.8518e+00, 1.8677e+00,
        1.8795e+00, 1.9489e+00, 1.9629e+00, 1.9639e+00, 2.0234e+00, 2.0854e+00,
        3.8143e+05, 3.8528e+05, 3.8874e+05, 3.9275e+05, 3.9540e+05, 3.9913e+05,
        3.9976e+05, 4.0771e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 392718.2188, 392722.8438, 392738.5625, 392751.3750,
        392752.0312, 392753.8750, 392755.7812, 392764.3438, 392766.7188,
        392768.1875, 392771.1250, 392804.8125, 770046.8750, 780577.5000,
        785448.4375, 788297.6250, 788693.8750, 788979.1250, 815237.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.8439e+00, 1.8502e+00, 1.8536e+00, 1.8612e+00, 1.8677e+00,
        1.8771e+00, 1.8772e+00, 1.9058e+00, 1.9152e+00, 2.0024e+00, 2.0861e+00,
        3.8139e+05, 3.8524e+05, 3.8876e+05, 3.9276e+05, 3.9536e+05, 3.9915e+05,
        3.9976e+05, 4.0773e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 381366.3750, 381375.3750, 381386.6875, 381390.2812,
        381394.4688, 381405.1875, 381409.1562, 381417.7812, 381418.4062,
        381420.1250, 381434.9062, 381436.3125, 770046.8750, 774128.3125,
        774547.6250, 778717.8750, 784601.7500, 784949.5000, 791480.9375])
Index of maximum distance difference after half of values: 12
adaptive_Krum scores:  ['31788.16', '385269.09', '399158.28', '31786.60', '31782.45', '31786.70', '388724.75', '395373.75', '31785.59', '31785.82', '31783.03', '31784.01', '31784.31', '31786.52', '407701.88', '399743.91', '31787.98', '392755.56', '31784.62', '381404.53']
estimated f for each client, fs: [8, 7, 6, 8, 8, 8, 6, 6, 8, 8, 8, 8, 8, 8, 6, 6, 8, 6, 8, 7]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [6, 13, 20, 4, 1, 9, 14, 15, 8, 2, 5, 3, 7, 10, 17, 19, 11, 16, 12, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0323s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:10...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:10, End: 2025-07-22 15:46:10)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [3, 20, 19, 5, 12, 1, 9, 14, 16, 2, 17, 11, 6, 8, 4, 10, 13, 18, 15], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 4.1090e+05, 3.9847e+05, 1.4010e+00, 1.3707e+00, 2.1403e+00,
         1.3407e+00, 3.8620e+05, 3.8812e+05, 1.3998e+00, 4.1166e+05, 1.5467e+00,
         1.5452e+00, 1.3768e+00, 1.4934e+00, 1.3828e+00, 4.1138e+05, 3.8449e+05,
         3.9203e+05],
        [4.1090e+05, 0.0000e+00, 8.0566e+05, 4.1090e+05, 4.1092e+05, 4.1088e+05,
         4.1087e+05, 8.1472e+05, 7.7514e+05, 4.1089e+05, 8.1348e+05, 4.1086e+05,
         4.1087e+05, 4.1086e+05, 4.1089e+05, 4.1088e+05, 8.4293e+05, 7.9005e+05,
         7.9166e+05],
        [3.9847e+05, 8.0566e+05, 0.0000e+00, 3.9851e+05, 3.9851e+05, 3.9849e+05,
         3.9852e+05, 7.9711e+05, 7.7535e+05, 3.9849e+05, 8.0394e+05, 3.9848e+05,
         3.9852e+05, 3.9848e+05, 3.9849e+05, 3.9847e+05, 8.0851e+05, 7.8116e+05,
         7.8238e+05],
        [1.4010e+00, 4.1090e+05, 3.9851e+05, 0.0000e+00, 1.4277e+00, 1.8873e+00,
         1.4644e+00, 3.8620e+05, 3.8809e+05, 1.3982e+00, 4.1161e+05, 1.3181e+00,
         1.4710e+00, 1.4968e+00, 1.4013e+00, 1.4532e+00, 4.1138e+05, 3.8449e+05,
         3.9203e+05],
        [1.3707e+00, 4.1092e+05, 3.9851e+05, 1.4277e+00, 0.0000e+00, 2.0674e+00,
         1.3956e+00, 3.8619e+05, 3.8807e+05, 1.3598e+00, 4.1162e+05, 1.4181e+00,
         1.4990e+00, 1.3917e+00, 1.4497e+00, 1.3820e+00, 4.1139e+05, 3.8452e+05,
         3.9203e+05],
        [2.1403e+00, 4.1088e+05, 3.9849e+05, 1.8873e+00, 2.0674e+00, 0.0000e+00,
         1.8784e+00, 3.8616e+05, 3.8812e+05, 1.9798e+00, 4.1164e+05, 1.9178e+00,
         2.0813e+00, 2.1896e+00, 2.1979e+00, 1.9899e+00, 4.1139e+05, 3.8448e+05,
         3.9202e+05],
        [1.3407e+00, 4.1087e+05, 3.9852e+05, 1.4644e+00, 1.3956e+00, 1.8784e+00,
         0.0000e+00, 3.8617e+05, 3.8811e+05, 1.3033e+00, 4.1160e+05, 1.3111e+00,
         1.3376e+00, 1.4392e+00, 1.4009e+00, 1.2741e+00, 4.1138e+05, 3.8454e+05,
         3.9203e+05],
        [3.8620e+05, 8.1472e+05, 7.9711e+05, 3.8620e+05, 3.8619e+05, 3.8616e+05,
         3.8617e+05, 0.0000e+00, 7.6847e+05, 3.8616e+05, 7.8630e+05, 3.8619e+05,
         3.8617e+05, 3.8620e+05, 3.8623e+05, 3.8620e+05, 8.1239e+05, 7.6761e+05,
         7.6755e+05],
        [3.8812e+05, 7.7514e+05, 7.7535e+05, 3.8809e+05, 3.8807e+05, 3.8812e+05,
         3.8811e+05, 7.6847e+05, 0.0000e+00, 3.8808e+05, 8.0814e+05, 3.8806e+05,
         3.8810e+05, 3.8811e+05, 3.8810e+05, 3.8807e+05, 8.3483e+05, 7.5226e+05,
         7.9574e+05],
        [1.3998e+00, 4.1089e+05, 3.9849e+05, 1.3982e+00, 1.3598e+00, 1.9798e+00,
         1.3033e+00, 3.8616e+05, 3.8808e+05, 0.0000e+00, 4.1164e+05, 1.4352e+00,
         1.2685e+00, 1.3979e+00, 1.3782e+00, 1.2855e+00, 4.1137e+05, 3.8452e+05,
         3.9201e+05],
        [4.1166e+05, 8.1348e+05, 8.0394e+05, 4.1161e+05, 4.1162e+05, 4.1164e+05,
         4.1160e+05, 7.8630e+05, 8.0814e+05, 4.1164e+05, 0.0000e+00, 4.1160e+05,
         4.1163e+05, 4.1162e+05, 4.1159e+05, 4.1162e+05, 8.2767e+05, 8.0377e+05,
         7.9137e+05],
        [1.5467e+00, 4.1086e+05, 3.9848e+05, 1.3181e+00, 1.4181e+00, 1.9178e+00,
         1.3111e+00, 3.8619e+05, 3.8806e+05, 1.4352e+00, 4.1160e+05, 0.0000e+00,
         1.3644e+00, 1.4000e+00, 1.3846e+00, 1.4188e+00, 4.1138e+05, 3.8450e+05,
         3.9200e+05],
        [1.5452e+00, 4.1087e+05, 3.9852e+05, 1.4710e+00, 1.4990e+00, 2.0813e+00,
         1.3376e+00, 3.8617e+05, 3.8810e+05, 1.2685e+00, 4.1163e+05, 1.3644e+00,
         0.0000e+00, 1.4503e+00, 1.3427e+00, 1.5132e+00, 4.1142e+05, 3.8454e+05,
         3.9201e+05],
        [1.3768e+00, 4.1086e+05, 3.9848e+05, 1.4968e+00, 1.3917e+00, 2.1896e+00,
         1.4392e+00, 3.8620e+05, 3.8811e+05, 1.3979e+00, 4.1162e+05, 1.4000e+00,
         1.4503e+00, 0.0000e+00, 1.4335e+00, 1.3029e+00, 4.1138e+05, 3.8449e+05,
         3.9206e+05],
        [1.4934e+00, 4.1089e+05, 3.9849e+05, 1.4013e+00, 1.4497e+00, 2.1979e+00,
         1.4009e+00, 3.8623e+05, 3.8810e+05, 1.3782e+00, 4.1159e+05, 1.3846e+00,
         1.3427e+00, 1.4335e+00, 0.0000e+00, 1.4193e+00, 4.1138e+05, 3.8454e+05,
         3.9202e+05],
        [1.3828e+00, 4.1088e+05, 3.9847e+05, 1.4532e+00, 1.3820e+00, 1.9899e+00,
         1.2741e+00, 3.8620e+05, 3.8807e+05, 1.2855e+00, 4.1162e+05, 1.4188e+00,
         1.5132e+00, 1.3029e+00, 1.4193e+00, 0.0000e+00, 4.1138e+05, 3.8451e+05,
         3.9201e+05],
        [4.1138e+05, 8.4293e+05, 8.0851e+05, 4.1138e+05, 4.1139e+05, 4.1139e+05,
         4.1138e+05, 8.1239e+05, 8.3483e+05, 4.1137e+05, 8.2767e+05, 4.1138e+05,
         4.1142e+05, 4.1138e+05, 4.1138e+05, 4.1138e+05, 0.0000e+00, 7.9779e+05,
         8.1357e+05],
        [3.8449e+05, 7.9005e+05, 7.8116e+05, 3.8449e+05, 3.8452e+05, 3.8448e+05,
         3.8454e+05, 7.6761e+05, 7.5226e+05, 3.8452e+05, 8.0377e+05, 3.8450e+05,
         3.8454e+05, 3.8449e+05, 3.8454e+05, 3.8451e+05, 7.9779e+05, 0.0000e+00,
         7.8431e+05],
        [3.9203e+05, 7.9166e+05, 7.8238e+05, 3.9203e+05, 3.9203e+05, 3.9202e+05,
         3.9203e+05, 7.6755e+05, 7.9574e+05, 3.9201e+05, 7.9137e+05, 3.9200e+05,
         3.9201e+05, 3.9206e+05, 3.9202e+05, 3.9201e+05, 8.1357e+05, 7.8431e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3407e+00, 1.3707e+00, 1.3768e+00, 1.3828e+00, 1.3998e+00,
        1.4010e+00, 1.4934e+00, 1.5452e+00, 1.5467e+00, 2.1403e+00, 3.8449e+05,
        3.8620e+05, 3.8812e+05, 3.9203e+05, 3.9847e+05, 4.1090e+05, 4.1138e+05,
        4.1166e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 410861.1250, 410864.9062, 410865.0312, 410870.9688,
        410884.1875, 410884.6562, 410891.1562, 410891.2812, 410901.4688,
        410903.6250, 410924.3125, 775140.7500, 790050.4375, 791657.3750,
        805662.0000, 813477.1875, 814716.7500, 842928.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398472.5000, 398473.0000, 398477.5938, 398483.6875,
        398486.0938, 398489.0938, 398491.7188, 398506.2500, 398507.2812,
        398517.8750, 398524.0625, 775350.8750, 781157.7500, 782380.8125,
        797112.1875, 803943.5000, 805662.0000, 808505.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3181e+00, 1.3982e+00, 1.4010e+00, 1.4013e+00, 1.4277e+00,
        1.4532e+00, 1.4644e+00, 1.4710e+00, 1.4968e+00, 1.8873e+00, 3.8449e+05,
        3.8620e+05, 3.8809e+05, 3.9203e+05, 3.9851e+05, 4.1090e+05, 4.1138e+05,
        4.1161e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3598e+00, 1.3707e+00, 1.3820e+00, 1.3917e+00, 1.3956e+00,
        1.4181e+00, 1.4277e+00, 1.4497e+00, 1.4990e+00, 2.0674e+00, 3.8452e+05,
        3.8619e+05, 3.8807e+05, 3.9203e+05, 3.9851e+05, 4.1092e+05, 4.1139e+05,
        4.1162e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.8784e+00, 1.8873e+00, 1.9178e+00, 1.9798e+00, 1.9899e+00,
        2.0674e+00, 2.0813e+00, 2.1403e+00, 2.1896e+00, 2.1979e+00, 3.8448e+05,
        3.8616e+05, 3.8812e+05, 3.9202e+05, 3.9849e+05, 4.1088e+05, 4.1139e+05,
        4.1164e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2741e+00, 1.3033e+00, 1.3111e+00, 1.3376e+00, 1.3407e+00,
        1.3956e+00, 1.4009e+00, 1.4392e+00, 1.4644e+00, 1.8784e+00, 3.8454e+05,
        3.8617e+05, 3.8811e+05, 3.9203e+05, 3.9852e+05, 4.1087e+05, 4.1138e+05,
        4.1160e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386163.0000, 386163.5938, 386172.2812, 386173.4375,
        386190.3750, 386192.4062, 386195.0625, 386195.2812, 386196.3438,
        386197.1562, 386233.7500, 767553.8125, 767612.6875, 768466.6875,
        786297.5000, 797112.1875, 812389.0000, 814716.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388056.0938, 388072.3125, 388073.8125, 388080.4375,
        388091.9688, 388099.6875, 388104.8438, 388106.9062, 388106.9375,
        388116.8125, 388117.1875, 752262.7500, 768466.6875, 775140.7500,
        775350.8750, 795738.1875, 808137.0000, 834829.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2685e+00, 1.2855e+00, 1.3033e+00, 1.3598e+00, 1.3782e+00,
        1.3979e+00, 1.3982e+00, 1.3998e+00, 1.4352e+00, 1.9798e+00, 3.8452e+05,
        3.8616e+05, 3.8808e+05, 3.9201e+05, 3.9849e+05, 4.1089e+05, 4.1137e+05,
        4.1164e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 411589.2188, 411601.5000, 411602.4062, 411612.4375,
        411619.3750, 411619.8750, 411622.9375, 411629.7812, 411638.5000,
        411643.6562, 411660.4062, 786297.5000, 791368.5000, 803769.7500,
        803943.5000, 808137.0000, 813477.1875, 827674.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3111e+00, 1.3181e+00, 1.3644e+00, 1.3846e+00, 1.4000e+00,
        1.4181e+00, 1.4188e+00, 1.4352e+00, 1.5467e+00, 1.9178e+00, 3.8450e+05,
        3.8619e+05, 3.8806e+05, 3.9200e+05, 3.9848e+05, 4.1086e+05, 4.1138e+05,
        4.1160e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2685e+00, 1.3376e+00, 1.3427e+00, 1.3644e+00, 1.4503e+00,
        1.4710e+00, 1.4990e+00, 1.5132e+00, 1.5452e+00, 2.0813e+00, 3.8454e+05,
        3.8617e+05, 3.8810e+05, 3.9201e+05, 3.9852e+05, 4.1087e+05, 4.1142e+05,
        4.1163e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3029e+00, 1.3768e+00, 1.3917e+00, 1.3979e+00, 1.4000e+00,
        1.4335e+00, 1.4392e+00, 1.4503e+00, 1.4968e+00, 2.1896e+00, 3.8449e+05,
        3.8620e+05, 3.8811e+05, 3.9206e+05, 3.9848e+05, 4.1086e+05, 4.1138e+05,
        4.1162e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3427e+00, 1.3782e+00, 1.3846e+00, 1.4009e+00, 1.4013e+00,
        1.4193e+00, 1.4335e+00, 1.4497e+00, 1.4934e+00, 2.1979e+00, 3.8454e+05,
        3.8623e+05, 3.8810e+05, 3.9202e+05, 3.9849e+05, 4.1089e+05, 4.1138e+05,
        4.1159e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2741e+00, 1.2855e+00, 1.3029e+00, 1.3820e+00, 1.3828e+00,
        1.4188e+00, 1.4193e+00, 1.4532e+00, 1.5132e+00, 1.9899e+00, 3.8451e+05,
        3.8620e+05, 3.8807e+05, 3.9201e+05, 3.9847e+05, 4.1088e+05, 4.1138e+05,
        4.1162e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 411372.5000, 411376.5625, 411376.6250, 411376.8750,
        411379.9688, 411381.8750, 411382.4062, 411383.5000, 411393.0938,
        411393.2188, 411416.4062, 797786.1875, 808505.2500, 812389.0000,
        813574.6875, 827674.1875, 834829.3125, 842928.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384483.0000, 384490.9375, 384494.0625, 384494.9062,
        384503.6562, 384505.6562, 384522.0938, 384524.4688, 384535.4375,
        384538.4688, 384539.3438, 752262.7500, 767612.6875, 781157.7500,
        784309.0000, 790050.4375, 797786.1875, 803769.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391997.4062, 392008.8438, 392009.5000, 392014.0312,
        392017.4375, 392019.6562, 392026.5938, 392028.0625, 392028.6250,
        392030.9375, 392063.6562, 767553.8125, 782380.8125, 784309.0000,
        791368.5000, 791657.3750, 795738.1875, 813574.6875])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34955.37', '410885.72', '398493.59', '34955.42', '34957.90', '34954.85', '34959.05', '386188.44', '388093.34', '34958.07', '411621.78', '34956.20', '34959.47', '34955.08', '34959.39', '34956.37', '411384.81', '384512.00', '392022.28']
estimated f for each client, fs: [8, 6, 6, 8, 8, 8, 8, 6, 6, 8, 6, 8, 8, 8, 8, 8, 6, 6, 6]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [3, 20, 19, 5, 12, 1, 9, 14, 16, 2, 17, 11, 6, 8, 4, 10, 13, 18, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0169s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:11...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[164  73]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:11, End: 2025-07-22 15:46:11)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (8): [11, 12, 2, 9, 4, 18, 7, 6], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 8
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([8])
tensor([[0.0000e+00, 1.1022e+00, 1.1438e+00, 1.0312e+00, 1.1608e+00, 4.0321e+05,
         1.1849e+00, 1.0607e+00],
        [1.1022e+00, 0.0000e+00, 1.0841e+00, 1.1067e+00, 1.1532e+00, 4.0325e+05,
         1.0833e+00, 1.1565e+00],
        [1.1438e+00, 1.0841e+00, 0.0000e+00, 1.0500e+00, 1.1311e+00, 4.0324e+05,
         1.0719e+00, 1.0269e+00],
        [1.0312e+00, 1.1067e+00, 1.0500e+00, 0.0000e+00, 1.1591e+00, 4.0323e+05,
         1.1050e+00, 1.0485e+00],
        [1.1608e+00, 1.1532e+00, 1.1311e+00, 1.1591e+00, 0.0000e+00, 4.0320e+05,
         1.0944e+00, 1.0887e+00],
        [4.0321e+05, 4.0325e+05, 4.0324e+05, 4.0323e+05, 4.0320e+05, 0.0000e+00,
         4.0324e+05, 4.0322e+05],
        [1.1849e+00, 1.0833e+00, 1.0719e+00, 1.1050e+00, 1.0944e+00, 4.0324e+05,
         0.0000e+00, 1.1660e+00],
        [1.0607e+00, 1.1565e+00, 1.0269e+00, 1.0485e+00, 1.0887e+00, 4.0322e+05,
         1.1660e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0312e+00, 1.0607e+00, 1.1022e+00, 1.1438e+00, 1.1608e+00,
        1.1849e+00, 4.0321e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.0833e+00, 1.0841e+00, 1.1022e+00, 1.1067e+00, 1.1532e+00,
        1.1565e+00, 4.0325e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.0269e+00, 1.0500e+00, 1.0719e+00, 1.0841e+00, 1.1311e+00,
        1.1438e+00, 4.0324e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.0312e+00, 1.0485e+00, 1.0500e+00, 1.1050e+00, 1.1067e+00,
        1.1591e+00, 4.0323e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.0887e+00, 1.0944e+00, 1.1311e+00, 1.1532e+00, 1.1591e+00,
        1.1608e+00, 4.0320e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 403196.8125, 403211.6250, 403222.2188, 403233.6562,
        403240.1250, 403243.2188, 403245.2500])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.0719e+00, 1.0833e+00, 1.0944e+00, 1.1050e+00, 1.1660e+00,
        1.1849e+00, 4.0324e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.0269e+00, 1.0485e+00, 1.0607e+00, 1.0887e+00, 1.1565e+00,
        1.1660e+00, 4.0322e+05])
Index of maximum distance difference after half of values: 6
adaptive_Krum scores:  ['1.11', '1.11', '1.08', '1.08', '1.13', '403224.62', '1.12', '1.09']
estimated f for each client, fs: [1, 1, 1, 1, 1, 1, 1, 1]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']], selected_client_indices: [11, 12, 2, 9, 4, 18, 7, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0323s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:11...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:11, End: 2025-07-22 15:46:11)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [17, 20, 15, 11, 16, 8, 1, 12, 3, 7, 4, 19, 6, 9], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 7.9713e+05, 7.9696e+05, 3.9593e+05, 7.4548e+05, 3.9596e+05,
         3.9589e+05, 3.9593e+05, 3.9593e+05, 3.9592e+05, 3.9597e+05, 7.8269e+05,
         3.9592e+05, 3.9591e+05],
        [7.9713e+05, 0.0000e+00, 7.8123e+05, 3.8773e+05, 7.7084e+05, 3.8772e+05,
         3.8773e+05, 3.8772e+05, 3.8770e+05, 3.8776e+05, 3.8774e+05, 7.9878e+05,
         3.8772e+05, 3.8770e+05],
        [7.9696e+05, 7.8123e+05, 0.0000e+00, 3.8830e+05, 7.8284e+05, 3.8831e+05,
         3.8829e+05, 3.8831e+05, 3.8832e+05, 3.8833e+05, 3.8828e+05, 7.8089e+05,
         3.8833e+05, 3.8834e+05],
        [3.9593e+05, 3.8773e+05, 3.8830e+05, 0.0000e+00, 3.8468e+05, 1.3770e+00,
         1.8725e+00, 1.3274e+00, 1.4338e+00, 1.4018e+00, 1.3602e+00, 3.9359e+05,
         1.3356e+00, 1.4222e+00],
        [7.4548e+05, 7.7084e+05, 7.8284e+05, 3.8468e+05, 0.0000e+00, 3.8466e+05,
         3.8468e+05, 3.8466e+05, 3.8468e+05, 3.8468e+05, 3.8467e+05, 7.9559e+05,
         3.8465e+05, 3.8466e+05],
        [3.9596e+05, 3.8772e+05, 3.8831e+05, 1.3770e+00, 3.8466e+05, 0.0000e+00,
         2.1400e+00, 1.3552e+00, 1.3478e+00, 1.4748e+00, 1.4425e+00, 3.9363e+05,
         1.4284e+00, 1.5681e+00],
        [3.9589e+05, 3.8773e+05, 3.8829e+05, 1.8725e+00, 3.8468e+05, 2.1400e+00,
         0.0000e+00, 1.9796e+00, 2.0870e+00, 2.0273e+00, 2.1451e+00, 3.9360e+05,
         2.0277e+00, 1.4476e+00],
        [3.9593e+05, 3.8772e+05, 3.8831e+05, 1.3274e+00, 3.8466e+05, 1.3552e+00,
         1.9796e+00, 0.0000e+00, 1.2907e+00, 1.3548e+00, 1.3748e+00, 3.9360e+05,
         1.4183e+00, 1.5116e+00],
        [3.9593e+05, 3.8770e+05, 3.8832e+05, 1.4338e+00, 3.8468e+05, 1.3478e+00,
         2.0870e+00, 1.2907e+00, 0.0000e+00, 1.4157e+00, 1.4368e+00, 3.9362e+05,
         1.4894e+00, 1.4893e+00],
        [3.9592e+05, 3.8776e+05, 3.8833e+05, 1.4018e+00, 3.8468e+05, 1.4748e+00,
         2.0273e+00, 1.3548e+00, 1.4157e+00, 0.0000e+00, 1.3537e+00, 3.9359e+05,
         1.4555e+00, 1.5312e+00],
        [3.9597e+05, 3.8774e+05, 3.8828e+05, 1.3602e+00, 3.8467e+05, 1.4425e+00,
         2.1451e+00, 1.3748e+00, 1.4368e+00, 1.3537e+00, 0.0000e+00, 3.9360e+05,
         1.3337e+00, 1.5769e+00],
        [7.8269e+05, 7.9878e+05, 7.8089e+05, 3.9359e+05, 7.9559e+05, 3.9363e+05,
         3.9360e+05, 3.9360e+05, 3.9362e+05, 3.9359e+05, 3.9360e+05, 0.0000e+00,
         3.9358e+05, 3.9359e+05],
        [3.9592e+05, 3.8772e+05, 3.8833e+05, 1.3356e+00, 3.8465e+05, 1.4284e+00,
         2.0277e+00, 1.4183e+00, 1.4894e+00, 1.4555e+00, 1.3337e+00, 3.9358e+05,
         0.0000e+00, 1.5304e+00],
        [3.9591e+05, 3.8770e+05, 3.8834e+05, 1.4222e+00, 3.8466e+05, 1.5681e+00,
         1.4476e+00, 1.5116e+00, 1.4893e+00, 1.5312e+00, 1.5769e+00, 3.9359e+05,
         1.5304e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 395893.6875, 395912.6562, 395915.1562, 395922.5938,
        395929.3750, 395931.5625, 395931.8438, 395961.1562, 395966.8750,
        745485.0000, 782689.3750, 796959.6250, 797127.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387697.3125, 387703.8125, 387717.7812, 387718.0938,
        387721.1875, 387725.8750, 387726.2812, 387740.7812, 387761.6250,
        770842.3750, 781233.6875, 797127.1875, 798776.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388278.1875, 388292.9375, 388302.1250, 388308.8750,
        388312.4375, 388324.4688, 388332.2500, 388333.3750, 388340.5312,
        780888.3125, 781233.6875, 782836.3125, 796959.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3274e+00, 1.3356e+00, 1.3602e+00, 1.3770e+00, 1.4018e+00,
        1.4222e+00, 1.4338e+00, 1.8725e+00, 3.8468e+05, 3.8773e+05, 3.8830e+05,
        3.9359e+05, 3.9593e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 384647.1250, 384658.0000, 384658.8125, 384664.1562,
        384666.7500, 384678.8125, 384680.3125, 384683.7188, 384684.9688,
        745485.0000, 770842.3750, 782836.3125, 795588.1250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3478e+00, 1.3552e+00, 1.3770e+00, 1.4284e+00, 1.4425e+00,
        1.4748e+00, 1.5681e+00, 2.1400e+00, 3.8466e+05, 3.8772e+05, 3.8831e+05,
        3.9363e+05, 3.9596e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4476e+00, 1.8725e+00, 1.9796e+00, 2.0273e+00, 2.0277e+00,
        2.0870e+00, 2.1400e+00, 2.1451e+00, 3.8468e+05, 3.8773e+05, 3.8829e+05,
        3.9360e+05, 3.9589e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2907e+00, 1.3274e+00, 1.3548e+00, 1.3552e+00, 1.3748e+00,
        1.4183e+00, 1.5116e+00, 1.9796e+00, 3.8466e+05, 3.8772e+05, 3.8831e+05,
        3.9360e+05, 3.9593e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2907e+00, 1.3478e+00, 1.4157e+00, 1.4338e+00, 1.4368e+00,
        1.4893e+00, 1.4894e+00, 2.0870e+00, 3.8468e+05, 3.8770e+05, 3.8832e+05,
        3.9362e+05, 3.9593e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3537e+00, 1.3548e+00, 1.4018e+00, 1.4157e+00, 1.4555e+00,
        1.4748e+00, 1.5312e+00, 2.0273e+00, 3.8468e+05, 3.8776e+05, 3.8833e+05,
        3.9359e+05, 3.9592e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3337e+00, 1.3537e+00, 1.3602e+00, 1.3748e+00, 1.4368e+00,
        1.4425e+00, 1.5769e+00, 2.1451e+00, 3.8467e+05, 3.8774e+05, 3.8828e+05,
        3.9360e+05, 3.9597e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393583.1250, 393585.1250, 393589.0938, 393590.7500,
        393596.0000, 393596.9062, 393602.5938, 393619.2500, 393626.6875,
        780888.3125, 782689.3750, 795588.1250, 798776.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3337e+00, 1.3356e+00, 1.4183e+00, 1.4284e+00, 1.4555e+00,
        1.4894e+00, 1.5304e+00, 2.0277e+00, 3.8465e+05, 3.8772e+05, 3.8833e+05,
        3.9358e+05, 3.9592e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4222e+00, 1.4476e+00, 1.4893e+00, 1.5116e+00, 1.5304e+00,
        1.5312e+00, 1.5681e+00, 1.5769e+00, 3.8466e+05, 3.8770e+05, 3.8834e+05,
        3.9359e+05, 3.9591e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['395929.41', '387723.62', '388313.91', '42744.05', '384669.19', '42741.80', '42743.83', '42741.07', '42743.96', '42743.59', '42742.09', '393598.81', '42739.90', '42741.21']
estimated f for each client, fs: [3, 3, 4, 5, 3, 5, 5, 5, 5, 5, 5, 3, 5, 5]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']], selected_client_indices: [17, 20, 15, 11, 16, 8, 1, 12, 3, 7, 4, 19, 6, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0105s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:12...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:12, End: 2025-07-22 15:46:12)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (6): [8, 11, 2, 4, 19, 10], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 6
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([6])
tensor([[0.0000e+00, 1.4608e+00, 1.4956e+00, 1.5149e+00, 3.8511e+05, 1.4172e+00],
        [1.4608e+00, 0.0000e+00, 1.4403e+00, 1.5071e+00, 3.8511e+05, 1.4326e+00],
        [1.4956e+00, 1.4403e+00, 0.0000e+00, 1.4905e+00, 3.8515e+05, 1.3487e+00],
        [1.5149e+00, 1.5071e+00, 1.4905e+00, 0.0000e+00, 3.8512e+05, 1.5755e+00],
        [3.8511e+05, 3.8511e+05, 3.8515e+05, 3.8512e+05, 0.0000e+00, 3.8515e+05],
        [1.4172e+00, 1.4326e+00, 1.3487e+00, 1.5755e+00, 3.8515e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4172e+00, 1.4608e+00, 1.4956e+00, 1.5149e+00, 3.8511e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.4326e+00, 1.4403e+00, 1.4608e+00, 1.5071e+00, 3.8511e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.3487e+00, 1.4403e+00, 1.4905e+00, 1.4956e+00, 3.8515e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.4905e+00, 1.5071e+00, 1.5149e+00, 1.5755e+00, 3.8512e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 385110.7500, 385112.7812, 385119.1562, 385149.8125,
        385150.5000])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.3487e+00, 1.4172e+00, 1.4326e+00, 1.5755e+00, 3.8515e+05])
Index of maximum distance difference after half of values: 5
adaptive_Krum scores:  ['77023.32', '77023.72', '77031.12', '77025.05', '385128.59', '77031.25']
estimated f for each client, fs: [1, 1, 1, 1, 0, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']], selected_client_indices: [8, 11, 2, 4, 19, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:12...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:12, End: 2025-07-22 15:46:12)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [2, 7, 1, 17, 3, 10, 12, 15, 20, 16, 4, 18, 11, 13, 14, 19, 8], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.4705e+00, 1.8149e+00, 3.7350e+05, 1.5472e+00, 1.3866e+00,
         1.5082e+00, 3.8638e+05, 3.7923e+05, 4.0320e+05, 1.4825e+00, 3.9279e+05,
         1.5105e+00, 4.0370e+05, 3.9730e+05, 3.8741e+05, 1.6306e+00],
        [1.4705e+00, 0.0000e+00, 1.9778e+00, 3.7352e+05, 1.5464e+00, 1.4852e+00,
         1.5230e+00, 3.8635e+05, 3.7923e+05, 4.0324e+05, 1.4514e+00, 3.9281e+05,
         1.5726e+00, 4.0371e+05, 3.9731e+05, 3.8742e+05, 1.7492e+00],
        [1.8149e+00, 1.9778e+00, 0.0000e+00, 3.7351e+05, 2.0307e+00, 1.9029e+00,
         1.8843e+00, 3.8639e+05, 3.7926e+05, 4.0321e+05, 2.0494e+00, 3.9279e+05,
         1.8222e+00, 4.0373e+05, 3.9730e+05, 3.8736e+05, 1.6769e+00],
        [3.7350e+05, 3.7352e+05, 3.7351e+05, 0.0000e+00, 3.7352e+05, 3.7352e+05,
         3.7352e+05, 7.6913e+05, 7.5285e+05, 7.7289e+05, 3.7355e+05, 7.5111e+05,
         3.7352e+05, 7.8911e+05, 7.3140e+05, 7.6578e+05, 3.7352e+05],
        [1.5472e+00, 1.5464e+00, 2.0307e+00, 3.7352e+05, 0.0000e+00, 1.5504e+00,
         1.4713e+00, 3.8637e+05, 3.7923e+05, 4.0321e+05, 1.5464e+00, 3.9274e+05,
         1.6181e+00, 4.0370e+05, 3.9733e+05, 3.8738e+05, 1.7344e+00],
        [1.3866e+00, 1.4852e+00, 1.9029e+00, 3.7352e+05, 1.5504e+00, 0.0000e+00,
         1.4676e+00, 3.8636e+05, 3.7922e+05, 4.0320e+05, 1.5925e+00, 3.9280e+05,
         1.4830e+00, 4.0370e+05, 3.9731e+05, 3.8739e+05, 1.6683e+00],
        [1.5082e+00, 1.5230e+00, 1.8843e+00, 3.7352e+05, 1.4713e+00, 1.4676e+00,
         0.0000e+00, 3.8637e+05, 3.7924e+05, 4.0322e+05, 1.5128e+00, 3.9277e+05,
         1.4323e+00, 4.0371e+05, 3.9731e+05, 3.8742e+05, 1.6706e+00],
        [3.8638e+05, 3.8635e+05, 3.8639e+05, 7.6913e+05, 3.8637e+05, 3.8636e+05,
         3.8637e+05, 0.0000e+00, 7.5143e+05, 8.1761e+05, 3.8639e+05, 7.6360e+05,
         3.8637e+05, 7.9212e+05, 8.0019e+05, 7.9418e+05, 3.8639e+05],
        [3.7923e+05, 3.7923e+05, 3.7926e+05, 7.5285e+05, 3.7923e+05, 3.7922e+05,
         3.7924e+05, 7.5143e+05, 0.0000e+00, 7.7393e+05, 3.7920e+05, 7.7234e+05,
         3.7921e+05, 8.1332e+05, 7.9195e+05, 7.5958e+05, 3.7918e+05],
        [4.0320e+05, 4.0324e+05, 4.0321e+05, 7.7289e+05, 4.0321e+05, 4.0320e+05,
         4.0322e+05, 8.1761e+05, 7.7393e+05, 0.0000e+00, 4.0323e+05, 8.1430e+05,
         4.0323e+05, 8.0026e+05, 8.1341e+05, 7.7571e+05, 4.0320e+05],
        [1.4825e+00, 1.4514e+00, 2.0494e+00, 3.7355e+05, 1.5464e+00, 1.5925e+00,
         1.5128e+00, 3.8639e+05, 3.7920e+05, 4.0323e+05, 0.0000e+00, 3.9278e+05,
         1.4984e+00, 4.0374e+05, 3.9734e+05, 3.8741e+05, 1.6929e+00],
        [3.9279e+05, 3.9281e+05, 3.9279e+05, 7.5111e+05, 3.9274e+05, 3.9280e+05,
         3.9277e+05, 7.6360e+05, 7.7234e+05, 8.1430e+05, 3.9278e+05, 0.0000e+00,
         3.9281e+05, 7.7213e+05, 7.7983e+05, 7.8956e+05, 3.9281e+05],
        [1.5105e+00, 1.5726e+00, 1.8222e+00, 3.7352e+05, 1.6181e+00, 1.4830e+00,
         1.4323e+00, 3.8637e+05, 3.7921e+05, 4.0323e+05, 1.4984e+00, 3.9281e+05,
         0.0000e+00, 4.0371e+05, 3.9731e+05, 3.8736e+05, 1.6035e+00],
        [4.0370e+05, 4.0371e+05, 4.0373e+05, 7.8911e+05, 4.0370e+05, 4.0370e+05,
         4.0371e+05, 7.9212e+05, 8.1332e+05, 8.0026e+05, 4.0374e+05, 7.7213e+05,
         4.0371e+05, 0.0000e+00, 8.0663e+05, 8.0752e+05, 4.0371e+05],
        [3.9730e+05, 3.9731e+05, 3.9730e+05, 7.3140e+05, 3.9733e+05, 3.9731e+05,
         3.9731e+05, 8.0019e+05, 7.9195e+05, 8.1341e+05, 3.9734e+05, 7.7983e+05,
         3.9731e+05, 8.0663e+05, 0.0000e+00, 7.9119e+05, 3.9732e+05],
        [3.8741e+05, 3.8742e+05, 3.8736e+05, 7.6578e+05, 3.8738e+05, 3.8739e+05,
         3.8742e+05, 7.9418e+05, 7.5958e+05, 7.7571e+05, 3.8741e+05, 7.8956e+05,
         3.8736e+05, 8.0752e+05, 7.9119e+05, 0.0000e+00, 3.8740e+05],
        [1.6306e+00, 1.7492e+00, 1.6769e+00, 3.7352e+05, 1.7344e+00, 1.6683e+00,
         1.6706e+00, 3.8639e+05, 3.7918e+05, 4.0320e+05, 1.6929e+00, 3.9281e+05,
         1.6035e+00, 4.0371e+05, 3.9732e+05, 3.8740e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3866e+00, 1.4705e+00, 1.4825e+00, 1.5082e+00, 1.5105e+00,
        1.5472e+00, 1.6306e+00, 1.8149e+00, 3.7350e+05, 3.7923e+05, 3.8638e+05,
        3.8741e+05, 3.9279e+05, 3.9730e+05, 4.0320e+05, 4.0370e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4514e+00, 1.4705e+00, 1.4852e+00, 1.5230e+00, 1.5464e+00,
        1.5726e+00, 1.7492e+00, 1.9778e+00, 3.7352e+05, 3.7923e+05, 3.8635e+05,
        3.8742e+05, 3.9281e+05, 3.9731e+05, 4.0324e+05, 4.0371e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6769e+00, 1.8149e+00, 1.8222e+00, 1.8843e+00, 1.9029e+00,
        1.9778e+00, 2.0307e+00, 2.0494e+00, 3.7351e+05, 3.7926e+05, 3.8639e+05,
        3.8736e+05, 3.9279e+05, 3.9730e+05, 4.0321e+05, 4.0373e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 373503.0000, 373509.6562, 373516.7188, 373517.5000,
        373518.5938, 373519.5625, 373521.0312, 373524.5938, 373546.3125,
        731401.5625, 751110.0000, 752854.1875, 765780.3750, 769130.0625,
        772885.6250, 789108.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4713e+00, 1.5464e+00, 1.5464e+00, 1.5472e+00, 1.5504e+00,
        1.6181e+00, 1.7344e+00, 2.0307e+00, 3.7352e+05, 3.7923e+05, 3.8637e+05,
        3.8738e+05, 3.9274e+05, 3.9733e+05, 4.0321e+05, 4.0370e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3866e+00, 1.4676e+00, 1.4830e+00, 1.4852e+00, 1.5504e+00,
        1.5925e+00, 1.6683e+00, 1.9029e+00, 3.7352e+05, 3.7922e+05, 3.8636e+05,
        3.8739e+05, 3.9280e+05, 3.9731e+05, 4.0320e+05, 4.0370e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4323e+00, 1.4676e+00, 1.4713e+00, 1.5082e+00, 1.5128e+00,
        1.5230e+00, 1.6706e+00, 1.8843e+00, 3.7352e+05, 3.7924e+05, 3.8637e+05,
        3.8742e+05, 3.9277e+05, 3.9731e+05, 4.0322e+05, 4.0371e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386348.6562, 386356.6875, 386367.4062, 386368.0625,
        386372.2500, 386376.1250, 386385.6562, 386390.3438, 386392.3125,
        751434.1250, 763598.6250, 769130.0625, 792117.2500, 794184.3750,
        800185.8125, 817606.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379180.8750, 379198.0000, 379214.0625, 379224.0312,
        379225.4375, 379228.9062, 379232.0000, 379239.0938, 379256.0625,
        751434.1250, 752854.1875, 759581.1875, 772344.2500, 773934.2500,
        791954.6875, 813320.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403195.9688, 403197.1562, 403199.5000, 403212.2812,
        403214.4062, 403219.8750, 403230.8750, 403234.3750, 403238.9375,
        772885.6250, 773934.2500, 775714.5000, 800257.1875, 813409.2500,
        814297.6875, 817606.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4514e+00, 1.4825e+00, 1.4984e+00, 1.5128e+00, 1.5464e+00,
        1.5925e+00, 1.6929e+00, 2.0494e+00, 3.7355e+05, 3.7920e+05, 3.8639e+05,
        3.8741e+05, 3.9278e+05, 3.9734e+05, 4.0323e+05, 4.0374e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392740.1250, 392767.8750, 392781.3125, 392793.3438,
        392794.7188, 392804.5000, 392806.3750, 392806.5938, 392808.1875,
        751110.0000, 763598.6250, 772130.5000, 772344.2500, 779832.2500,
        789558.0000, 814297.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4323e+00, 1.4830e+00, 1.4984e+00, 1.5105e+00, 1.5726e+00,
        1.6035e+00, 1.6181e+00, 1.8222e+00, 3.7352e+05, 3.7921e+05, 3.8637e+05,
        3.8736e+05, 3.9281e+05, 3.9731e+05, 4.0323e+05, 4.0371e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403695.5938, 403697.6875, 403700.6250, 403707.9062,
        403712.3438, 403714.5312, 403714.9062, 403734.5000, 403744.7812,
        772130.5000, 789108.3125, 792117.2500, 800257.1875, 806628.3125,
        807520.1875, 813320.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397296.1875, 397297.5625, 397311.5312, 397311.6875,
        397313.1875, 397313.5312, 397316.2500, 397326.5000, 397342.1875,
        731401.5625, 779832.2500, 791186.6250, 791954.6875, 800185.8125,
        806628.3125, 813409.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387359.4688, 387363.3125, 387379.2812, 387391.8125,
        387401.6562, 387407.7500, 387407.8750, 387415.4688, 387418.0312,
        759581.1875, 765780.3750, 775714.5000, 789558.0000, 791186.6250,
        794184.3750, 807520.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6035e+00, 1.6306e+00, 1.6683e+00, 1.6706e+00, 1.6769e+00,
        1.6929e+00, 1.7344e+00, 1.7492e+00, 3.7352e+05, 3.7918e+05, 3.8639e+05,
        3.8740e+05, 3.9281e+05, 3.9732e+05, 4.0320e+05, 4.0371e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75274.08', '75276.62', '75278.08', '409307.84', '75276.35', '75275.32', '75277.26', '422879.12', '416443.25', '440182.91', '75275.71', '428621.28', '75274.61', '440555.31', '430723.00', '424612.56', '75271.17']
estimated f for each client, fs: [8, 8, 8, 6, 8, 8, 8, 6, 6, 6, 8, 6, 8, 6, 6, 6, 8]
selected_index: 16
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']], selected_client_indices: [2, 7, 1, 17, 3, 10, 12, 15, 20, 16, 4, 18, 11, 13, 14, 19, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0269s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:13...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:13, End: 2025-07-22 15:46:13)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [8, 2, 5, 12, 14, 18, 15, 1, 17, 9, 13, 4], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 1.7286e+00, 1.8374e+00, 1.8283e+00, 3.7364e+05, 3.9731e+05,
         3.9271e+05, 1.3020e+00, 3.8832e+05, 1.4757e+00, 3.8791e+05, 1.8876e+00],
        [1.7286e+00, 0.0000e+00, 1.2713e+00, 1.2665e+00, 3.7367e+05, 3.9735e+05,
         3.9273e+05, 1.4637e+00, 3.8833e+05, 1.1530e+00, 3.8791e+05, 1.2385e+00],
        [1.8374e+00, 1.2713e+00, 0.0000e+00, 1.2353e+00, 3.7363e+05, 3.9735e+05,
         3.9269e+05, 1.4122e+00, 3.8829e+05, 1.2188e+00, 3.8791e+05, 1.1559e+00],
        [1.8283e+00, 1.2665e+00, 1.2353e+00, 0.0000e+00, 3.7366e+05, 3.9733e+05,
         3.9269e+05, 1.5210e+00, 3.8831e+05, 1.2166e+00, 3.8792e+05, 1.2708e+00],
        [3.7364e+05, 3.7367e+05, 3.7363e+05, 3.7366e+05, 0.0000e+00, 7.9312e+05,
         7.8375e+05, 3.7363e+05, 7.5982e+05, 3.7364e+05, 7.6196e+05, 3.7366e+05],
        [3.9731e+05, 3.9735e+05, 3.9735e+05, 3.9733e+05, 7.9312e+05, 0.0000e+00,
         7.7505e+05, 3.9734e+05, 7.8760e+05, 3.9735e+05, 8.0135e+05, 3.9732e+05],
        [3.9271e+05, 3.9273e+05, 3.9269e+05, 3.9269e+05, 7.8375e+05, 7.7505e+05,
         0.0000e+00, 3.9272e+05, 7.7568e+05, 3.9273e+05, 7.7823e+05, 3.9273e+05],
        [1.3020e+00, 1.4637e+00, 1.4122e+00, 1.5210e+00, 3.7363e+05, 3.9734e+05,
         3.9272e+05, 0.0000e+00, 3.8829e+05, 1.1713e+00, 3.8792e+05, 1.6408e+00],
        [3.8832e+05, 3.8833e+05, 3.8829e+05, 3.8831e+05, 7.5982e+05, 7.8760e+05,
         7.7568e+05, 3.8829e+05, 0.0000e+00, 3.8831e+05, 7.6621e+05, 3.8830e+05],
        [1.4757e+00, 1.1530e+00, 1.2188e+00, 1.2166e+00, 3.7364e+05, 3.9735e+05,
         3.9273e+05, 1.1713e+00, 3.8831e+05, 0.0000e+00, 3.8792e+05, 1.2787e+00],
        [3.8791e+05, 3.8791e+05, 3.8791e+05, 3.8792e+05, 7.6196e+05, 8.0135e+05,
         7.7823e+05, 3.8792e+05, 7.6621e+05, 3.8792e+05, 0.0000e+00, 3.8793e+05],
        [1.8876e+00, 1.2385e+00, 1.1559e+00, 1.2708e+00, 3.7366e+05, 3.9732e+05,
         3.9273e+05, 1.6408e+00, 3.8830e+05, 1.2787e+00, 3.8793e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3020e+00, 1.4757e+00, 1.7286e+00, 1.8283e+00, 1.8374e+00,
        1.8876e+00, 3.7364e+05, 3.8791e+05, 3.8832e+05, 3.9271e+05, 3.9731e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1530e+00, 1.2385e+00, 1.2665e+00, 1.2713e+00, 1.4637e+00,
        1.7286e+00, 3.7367e+05, 3.8791e+05, 3.8833e+05, 3.9273e+05, 3.9735e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1559e+00, 1.2188e+00, 1.2353e+00, 1.2713e+00, 1.4122e+00,
        1.8374e+00, 3.7363e+05, 3.8791e+05, 3.8829e+05, 3.9269e+05, 3.9735e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.2166e+00, 1.2353e+00, 1.2665e+00, 1.2708e+00, 1.5210e+00,
        1.8283e+00, 3.7366e+05, 3.8792e+05, 3.8831e+05, 3.9269e+05, 3.9733e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 373631.8750, 373633.6875, 373637.9375, 373639.6562,
        373657.7188, 373659.9688, 373670.7500, 759818.8750, 761957.1250,
        783747.3750, 793116.0625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 397314.0938, 397324.8125, 397325.2500, 397341.8125,
        397347.7500, 397353.7500, 397354.4688, 775046.9375, 787598.6250,
        793116.0625, 801345.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 392692.5312, 392694.7500, 392710.1250, 392720.6250,
        392725.0625, 392729.4688, 392732.5625, 775046.9375, 775676.0625,
        778231.5000, 783747.3750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1713e+00, 1.3020e+00, 1.4122e+00, 1.4637e+00, 1.5210e+00,
        1.6408e+00, 3.7363e+05, 3.8792e+05, 3.8829e+05, 3.9272e+05, 3.9734e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 388285.0625, 388291.8438, 388303.4375, 388305.6250,
        388305.8438, 388320.9688, 388331.0938, 759818.8750, 766206.0000,
        775676.0625, 787598.6250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1530e+00, 1.1713e+00, 1.2166e+00, 1.2188e+00, 1.2787e+00,
        1.4757e+00, 3.7364e+05, 3.8792e+05, 3.8831e+05, 3.9273e+05, 3.9735e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 387905.0625, 387912.5312, 387914.6250, 387916.4688,
        387924.3750, 387924.6562, 387927.1250, 761957.1250, 766206.0000,
        778231.5000, 801345.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1559e+00, 1.2385e+00, 1.2708e+00, 1.2787e+00, 1.6408e+00,
        1.8876e+00, 3.7366e+05, 3.8793e+05, 3.8830e+05, 3.9273e+05, 3.9732e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['95195.55', '95198.94', '95193.14', '95198.10', '421918.84', '444551.12', '440506.53', '95195.83', '434745.34', '95196.27', '434672.78', '95199.17']
estimated f for each client, fs: [5, 5, 5, 5, 4, 3, 3, 5, 3, 5, 3, 5]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [8, 2, 5, 12, 14, 18, 15, 1, 17, 9, 13, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0188s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:13...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:13, End: 2025-07-22 15:46:13)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [5, 14, 12, 1, 9, 15, 16], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 3.7418e+05, 1.6473e+00, 1.4716e+00, 1.5477e+00, 3.8218e+05,
         4.1317e+05],
        [3.7418e+05, 0.0000e+00, 3.7420e+05, 3.7424e+05, 3.7421e+05, 7.4545e+05,
         7.8770e+05],
        [1.6473e+00, 3.7420e+05, 0.0000e+00, 1.9154e+00, 1.4465e+00, 3.8214e+05,
         4.1317e+05],
        [1.4716e+00, 3.7424e+05, 1.9154e+00, 0.0000e+00, 1.4364e+00, 3.8215e+05,
         4.1313e+05],
        [1.5477e+00, 3.7421e+05, 1.4465e+00, 1.4364e+00, 0.0000e+00, 3.8215e+05,
         4.1310e+05],
        [3.8218e+05, 7.4545e+05, 3.8214e+05, 3.8215e+05, 3.8215e+05, 0.0000e+00,
         7.9713e+05],
        [4.1317e+05, 7.8770e+05, 4.1317e+05, 4.1313e+05, 4.1310e+05, 7.9713e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4716e+00, 1.5477e+00, 1.6473e+00, 3.7418e+05, 3.8218e+05,
        4.1317e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 374182.2188, 374196.0000, 374213.9062, 374243.6875,
        745451.5000, 787704.8125])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.4465e+00, 1.6473e+00, 1.9154e+00, 3.7420e+05, 3.8214e+05,
        4.1317e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.4364e+00, 1.4716e+00, 1.9154e+00, 3.7424e+05, 3.8215e+05,
        4.1313e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.4364e+00, 1.4465e+00, 1.5477e+00, 3.7421e+05, 3.8215e+05,
        4.1310e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 382136.1250, 382146.8750, 382153.5312, 382183.2188,
        745451.5000, 797130.9375])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 413096.0000, 413127.6250, 413165.1875, 413170.9375,
        787704.8125, 797130.9375])
Index of maximum distance difference after half of values: 5
adaptive_Krum scores:  ['151274.02', '448457.47', '151267.44', '151279.08', '151274.38', '454814.28', '488052.94']
estimated f for each client, fs: [3, 1, 3, 3, 3, 1, 1]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [5, 14, 12, 1, 9, 15, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0134s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:14...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:14, End: 2025-07-22 15:46:14)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [12, 16, 7, 17, 3, 2, 5, 19, 14, 13], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 4.0025e+05, 1.5847e+00, 3.8794e+05, 1.5671e+00, 1.5796e+00,
         1.3811e+00, 3.8308e+05, 3.9189e+05, 3.8519e+05],
        [4.0025e+05, 0.0000e+00, 4.0020e+05, 7.9794e+05, 4.0021e+05, 4.0020e+05,
         4.0021e+05, 7.8160e+05, 8.1064e+05, 7.9503e+05],
        [1.5847e+00, 4.0020e+05, 0.0000e+00, 3.8793e+05, 1.4605e+00, 1.4323e+00,
         1.6160e+00, 3.8304e+05, 3.9190e+05, 3.8519e+05],
        [3.8794e+05, 7.9794e+05, 3.8793e+05, 0.0000e+00, 3.8792e+05, 3.8794e+05,
         3.8791e+05, 7.6676e+05, 7.7238e+05, 7.5948e+05],
        [1.5671e+00, 4.0021e+05, 1.4605e+00, 3.8792e+05, 0.0000e+00, 1.4884e+00,
         1.5671e+00, 3.8301e+05, 3.9192e+05, 3.8517e+05],
        [1.5796e+00, 4.0020e+05, 1.4323e+00, 3.8794e+05, 1.4884e+00, 0.0000e+00,
         1.6468e+00, 3.8301e+05, 3.9190e+05, 3.8519e+05],
        [1.3811e+00, 4.0021e+05, 1.6160e+00, 3.8791e+05, 1.5671e+00, 1.6468e+00,
         0.0000e+00, 3.8306e+05, 3.9189e+05, 3.8521e+05],
        [3.8308e+05, 7.8160e+05, 3.8304e+05, 7.6676e+05, 3.8301e+05, 3.8301e+05,
         3.8306e+05, 0.0000e+00, 7.8038e+05, 7.6172e+05],
        [3.9189e+05, 8.1064e+05, 3.9190e+05, 7.7238e+05, 3.9192e+05, 3.9190e+05,
         3.9189e+05, 7.8038e+05, 0.0000e+00, 7.9277e+05],
        [3.8519e+05, 7.9503e+05, 3.8519e+05, 7.5948e+05, 3.8517e+05, 3.8519e+05,
         3.8521e+05, 7.6172e+05, 7.9277e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3811e+00, 1.5671e+00, 1.5796e+00, 1.5847e+00, 3.8308e+05,
        3.8519e+05, 3.8794e+05, 3.9189e+05, 4.0025e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 400201.2500, 400203.3750, 400209.5000, 400214.8125,
        400245.5312, 781600.0000, 795032.5000, 797941.9375, 810642.0625])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.4323e+00, 1.4605e+00, 1.5847e+00, 1.6160e+00, 3.8304e+05,
        3.8519e+05, 3.8793e+05, 3.9190e+05, 4.0020e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 387906.7188, 387920.6562, 387930.6875, 387935.2500,
        387935.4062, 759476.3125, 766757.3125, 772380.7500, 797941.9375])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.4605e+00, 1.4884e+00, 1.5671e+00, 1.5671e+00, 3.8301e+05,
        3.8517e+05, 3.8792e+05, 3.9192e+05, 4.0021e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.4323e+00, 1.4884e+00, 1.5796e+00, 1.6468e+00, 3.8301e+05,
        3.8519e+05, 3.8794e+05, 3.9190e+05, 4.0020e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.3811e+00, 1.5671e+00, 1.6160e+00, 1.6468e+00, 3.8306e+05,
        3.8521e+05, 3.8791e+05, 3.9189e+05, 4.0021e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 383011.1250, 383014.3125, 383044.6562, 383058.4375,
        383081.3750, 761717.9375, 766757.3125, 780376.3750, 781600.0000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 391886.7812, 391890.1250, 391898.1562, 391904.0312,
        391921.4688, 772380.7500, 780376.3750, 792770.7500, 810642.0625])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 385171.8750, 385185.3438, 385189.0312, 385194.0625,
        385211.2188, 759476.3125, 761717.9375, 792770.7500, 795032.5000])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['165172.59', '511100.94', '165167.20', '495123.19', '165158.53', '165164.25', '165168.92', '491955.00', '501751.09', '492449.38']
estimated f for each client, fs: [5, 2, 5, 2, 5, 5, 5, 3, 2, 2]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [12, 16, 7, 17, 3, 2, 5, 19, 14, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0058s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:14...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:14, End: 2025-07-22 15:46:14)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [12, 14, 15, 17, 11, 5, 13, 1, 16], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 3.7569e+05, 3.9004e+05, 3.9128e+05, 1.4649e+00, 1.3647e+00,
         3.8892e+05, 1.5122e+00, 3.7702e+05],
        [3.7569e+05, 0.0000e+00, 7.6354e+05, 7.7903e+05, 3.7573e+05, 3.7571e+05,
         7.9014e+05, 3.7568e+05, 7.5229e+05],
        [3.9004e+05, 7.6354e+05, 0.0000e+00, 7.8241e+05, 3.9004e+05, 3.9006e+05,
         8.0868e+05, 3.9002e+05, 7.7316e+05],
        [3.9128e+05, 7.7903e+05, 7.8241e+05, 0.0000e+00, 3.9127e+05, 3.9128e+05,
         7.9688e+05, 3.9130e+05, 7.4685e+05],
        [1.4649e+00, 3.7573e+05, 3.9004e+05, 3.9127e+05, 0.0000e+00, 1.4757e+00,
         3.8890e+05, 1.6651e+00, 3.7701e+05],
        [1.3647e+00, 3.7571e+05, 3.9006e+05, 3.9128e+05, 1.4757e+00, 0.0000e+00,
         3.8890e+05, 1.4592e+00, 3.7705e+05],
        [3.8892e+05, 7.9014e+05, 8.0868e+05, 7.9688e+05, 3.8890e+05, 3.8890e+05,
         0.0000e+00, 3.8891e+05, 7.6812e+05],
        [1.5122e+00, 3.7568e+05, 3.9002e+05, 3.9130e+05, 1.6651e+00, 1.4592e+00,
         3.8891e+05, 0.0000e+00, 3.7700e+05],
        [3.7702e+05, 7.5229e+05, 7.7316e+05, 7.4685e+05, 3.7701e+05, 3.7705e+05,
         7.6812e+05, 3.7700e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3647e+00, 1.4649e+00, 1.5122e+00, 3.7569e+05, 3.7702e+05,
        3.8892e+05, 3.9004e+05, 3.9128e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 375684.5000, 375693.4375, 375711.0000, 375730.0000,
        752289.5625, 763545.0000, 779031.4375, 790144.8125])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 390024.6875, 390035.0312, 390038.0312, 390058.0000,
        763545.0000, 773157.6250, 782413.8750, 808675.5000])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 391265.1875, 391279.4062, 391279.5312, 391296.6250,
        746847.8750, 779031.4375, 782413.8750, 796878.1250])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.4649e+00, 1.4757e+00, 1.6651e+00, 3.7573e+05, 3.7701e+05,
        3.8890e+05, 3.9004e+05, 3.9127e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.3647e+00, 1.4592e+00, 1.4757e+00, 3.7571e+05, 3.7705e+05,
        3.8890e+05, 3.9006e+05, 3.9128e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 388896.8750, 388903.5312, 388908.4062, 388923.3750,
        768119.7500, 790144.8125, 796878.1250, 808675.5000])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 1.4592e+00, 1.5122e+00, 1.6651e+00, 3.7568e+05, 3.7700e+05,
        3.8891e+05, 3.9002e+05, 3.9130e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 376997.8125, 377014.8438, 377023.6875, 377048.9688,
        746847.8750, 752289.5625, 768119.7500, 773157.6250])
Index of maximum distance difference after half of values: 6
adaptive_Krum scores:  ['190274.12', '503108.91', '516143.06', '515166.69', '190275.48', '190276.88', '518982.78', '190265.91', '501203.81']
estimated f for each client, fs: [2, 4, 2, 2, 2, 2, 3, 2, 2]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']], selected_client_indices: [12, 14, 15, 17, 11, 5, 13, 1, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0060s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:14...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:14, End: 2025-07-22 15:46:14)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [14, 16, 15, 8, 18, 9, 6, 3, 12, 11, 13], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
tensor([[0.0000e+00, 7.9095e+05, 8.0349e+05, 3.9489e+05, 7.9554e+05, 3.9492e+05,
         3.9491e+05, 3.9490e+05, 3.9491e+05, 3.9489e+05, 7.7573e+05],
        [7.9095e+05, 0.0000e+00, 7.8731e+05, 3.9095e+05, 7.6588e+05, 3.9098e+05,
         3.9095e+05, 3.9096e+05, 3.9095e+05, 3.9097e+05, 7.9589e+05],
        [8.0349e+05, 7.8731e+05, 0.0000e+00, 3.9248e+05, 7.8054e+05, 3.9246e+05,
         3.9245e+05, 3.9246e+05, 3.9244e+05, 3.9246e+05, 7.9396e+05],
        [3.9489e+05, 3.9095e+05, 3.9248e+05, 0.0000e+00, 3.8528e+05, 1.0687e+00,
         1.0395e+00, 1.0118e+00, 1.0050e+00, 1.1434e+00, 3.9674e+05],
        [7.9554e+05, 7.6588e+05, 7.8054e+05, 3.8528e+05, 0.0000e+00, 3.8530e+05,
         3.8528e+05, 3.8529e+05, 3.8532e+05, 3.8530e+05, 7.7144e+05],
        [3.9492e+05, 3.9098e+05, 3.9246e+05, 1.0687e+00, 3.8530e+05, 0.0000e+00,
         1.1063e+00, 1.0596e+00, 1.0471e+00, 1.0777e+00, 3.9672e+05],
        [3.9491e+05, 3.9095e+05, 3.9245e+05, 1.0395e+00, 3.8528e+05, 1.1063e+00,
         0.0000e+00, 1.1462e+00, 1.1083e+00, 1.1031e+00, 3.9672e+05],
        [3.9490e+05, 3.9096e+05, 3.9246e+05, 1.0118e+00, 3.8529e+05, 1.0596e+00,
         1.1462e+00, 0.0000e+00, 9.4176e-01, 1.1231e+00, 3.9672e+05],
        [3.9491e+05, 3.9095e+05, 3.9244e+05, 1.0050e+00, 3.8532e+05, 1.0471e+00,
         1.1083e+00, 9.4176e-01, 0.0000e+00, 1.0325e+00, 3.9673e+05],
        [3.9489e+05, 3.9097e+05, 3.9246e+05, 1.1434e+00, 3.8530e+05, 1.0777e+00,
         1.1031e+00, 1.1231e+00, 1.0325e+00, 0.0000e+00, 3.9671e+05],
        [7.7573e+05, 7.9589e+05, 7.9396e+05, 3.9674e+05, 7.7144e+05, 3.9672e+05,
         3.9672e+05, 3.9672e+05, 3.9673e+05, 3.9671e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 394888.5312, 394891.1250, 394899.6250, 394907.3125,
        394910.6250, 394920.3750, 775726.5000, 790945.2500, 795543.1250,
        803493.0000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 390950.0625, 390952.3750, 390953.4688, 390959.0000,
        390971.0938, 390975.9375, 765878.8750, 787308.3750, 790945.2500,
        795891.6875])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 392435.0625, 392446.9375, 392459.2500, 392462.7188,
        392463.1562, 392482.1875, 780543.4375, 787308.3750, 793955.4375,
        803493.0000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.0050e+00, 1.0118e+00, 1.0395e+00, 1.0687e+00, 1.1434e+00,
        3.8528e+05, 3.9095e+05, 3.9248e+05, 3.9489e+05, 3.9674e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 385277.9375, 385280.1250, 385289.8125, 385302.3750,
        385303.8125, 385315.6875, 765878.8750, 771442.3125, 780543.4375,
        795543.1250])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.0471e+00, 1.0596e+00, 1.0687e+00, 1.0777e+00, 1.1063e+00,
        3.8530e+05, 3.9098e+05, 3.9246e+05, 3.9492e+05, 3.9672e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.0395e+00, 1.1031e+00, 1.1063e+00, 1.1083e+00, 1.1462e+00,
        3.8528e+05, 3.9095e+05, 3.9245e+05, 3.9491e+05, 3.9672e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 9.4176e-01, 1.0118e+00, 1.0596e+00, 1.1231e+00, 1.1462e+00,
        3.8529e+05, 3.9096e+05, 3.9246e+05, 3.9490e+05, 3.9672e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 9.4176e-01, 1.0050e+00, 1.0325e+00, 1.0471e+00, 1.1083e+00,
        3.8532e+05, 3.9095e+05, 3.9244e+05, 3.9491e+05, 3.9673e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.0325e+00, 1.0777e+00, 1.1031e+00, 1.1231e+00, 1.1434e+00,
        3.8530e+05, 3.9097e+05, 3.9246e+05, 3.9489e+05, 3.9671e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 396711.5938, 396718.3750, 396718.9688, 396721.6250,
        396730.8750, 396743.2500, 771442.3125, 775726.5000, 793955.4375,
        795891.6875])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['449306.31', '444520.12', '447899.00', '110890.78', '439664.12', '110897.88', '110890.84', '110893.45', '110896.33', '110897.01', '450255.34']
estimated f for each client, fs: [3, 3, 3, 5, 3, 5, 5, 5, 5, 5, 3]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [14, 16, 15, 8, 18, 9, 6, 3, 12, 11, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0074s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:15...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:15, End: 2025-07-22 15:46:15)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [4, 16, 7, 12, 9, 20, 17], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 3.7986e+05, 1.0954e+00, 1.1548e+00, 1.1451e+00, 3.9257e+05,
         3.9469e+05],
        [3.7986e+05, 0.0000e+00, 3.7989e+05, 3.7989e+05, 3.7986e+05, 7.6449e+05,
         7.9765e+05],
        [1.0954e+00, 3.7989e+05, 0.0000e+00, 1.1588e+00, 1.1054e+00, 3.9257e+05,
         3.9470e+05],
        [1.1548e+00, 3.7989e+05, 1.1588e+00, 0.0000e+00, 9.9842e-01, 3.9258e+05,
         3.9469e+05],
        [1.1451e+00, 3.7986e+05, 1.1054e+00, 9.9842e-01, 0.0000e+00, 3.9260e+05,
         3.9472e+05],
        [3.9257e+05, 7.6449e+05, 3.9257e+05, 3.9258e+05, 3.9260e+05, 0.0000e+00,
         7.6470e+05],
        [3.9469e+05, 7.9765e+05, 3.9470e+05, 3.9469e+05, 3.9472e+05, 7.6470e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0954e+00, 1.1451e+00, 1.1548e+00, 3.7986e+05, 3.9257e+05,
        3.9469e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 379855.5625, 379857.1250, 379886.1875, 379889.3125,
        764491.6250, 797647.6250])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 1.0954e+00, 1.1054e+00, 1.1588e+00, 3.7989e+05, 3.9257e+05,
        3.9470e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 9.9842e-01, 1.1548e+00, 1.1588e+00, 3.7989e+05, 3.9258e+05,
        3.9469e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 9.9842e-01, 1.1054e+00, 1.1451e+00, 3.7986e+05, 3.9260e+05,
        3.9472e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 392566.4375, 392574.3750, 392583.2812, 392604.8750,
        764491.6250, 764703.8125])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 394693.0938, 394694.7812, 394696.7500, 394720.6250,
        764703.8125, 797647.6250])
Index of maximum distance difference after half of values: 5
adaptive_Krum scores:  ['154485.08', '456795.97', '154493.41', '154494.56', '154493.06', '466964.09', '468701.84']
estimated f for each client, fs: [3, 2, 3, 3, 3, 1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [4, 16, 7, 12, 9, 20, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:15...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 46 217]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:15, End: 2025-07-22 15:46:15)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [16, 13], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[     0.0000, 791851.8750],
        [791851.8750,      0.0000]])
sorted_distances: tensor([     0.0000, 791851.8750])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([     0.0000, 791851.8750])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['791851.88', '791851.88']
estimated f for each client, fs: [1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [16, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0012s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:15...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[108 129]
 [121 142]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:46:15, End: 2025-07-22 15:46:15)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [17, 15, 11, 1, 18, 20, 3, 7, 5, 13, 19, 6, 10, 4, 2, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 7.4697e+05, 3.8713e+05, 3.8717e+05, 7.7850e+05, 7.9568e+05,
         3.8713e+05, 3.8708e+05, 3.8713e+05, 7.7536e+05, 7.8721e+05, 3.8712e+05,
         3.8714e+05, 3.8710e+05, 3.8715e+05, 7.5633e+05, 3.8704e+05],
        [7.4697e+05, 0.0000e+00, 3.9543e+05, 3.9544e+05, 7.8965e+05, 7.9727e+05,
         3.9541e+05, 3.9544e+05, 3.9544e+05, 7.9450e+05, 7.9411e+05, 3.9543e+05,
         3.9543e+05, 3.9541e+05, 3.9543e+05, 8.0871e+05, 3.9544e+05],
        [3.8713e+05, 3.9543e+05, 0.0000e+00, 3.8793e+00, 3.9358e+05, 4.0407e+05,
         3.3958e+00, 3.7414e+00, 3.5566e+00, 3.9448e+05, 3.9642e+05, 3.4789e+00,
         3.6165e+00, 3.3385e+00, 3.9062e+00, 3.9782e+05, 3.4939e+00],
        [3.8717e+05, 3.9544e+05, 3.8793e+00, 0.0000e+00, 3.9360e+05, 4.0406e+05,
         3.6744e+00, 3.9187e+00, 4.2065e+00, 3.9452e+05, 3.9644e+05, 3.5567e+00,
         4.1643e+00, 4.4712e+00, 4.0461e+00, 3.9784e+05, 3.6759e+00],
        [7.7850e+05, 7.8965e+05, 3.9358e+05, 3.9360e+05, 0.0000e+00, 8.0021e+05,
         3.9356e+05, 3.9360e+05, 3.9360e+05, 8.1042e+05, 7.7758e+05, 3.9363e+05,
         3.9361e+05, 3.9359e+05, 3.9356e+05, 8.0500e+05, 3.9355e+05],
        [7.9568e+05, 7.9727e+05, 4.0407e+05, 4.0406e+05, 8.0021e+05, 0.0000e+00,
         4.0397e+05, 4.0400e+05, 4.0402e+05, 8.0329e+05, 7.9217e+05, 4.0400e+05,
         4.0401e+05, 4.0408e+05, 4.0399e+05, 8.0233e+05, 4.0404e+05],
        [3.8713e+05, 3.9541e+05, 3.3958e+00, 3.6744e+00, 3.9356e+05, 4.0397e+05,
         0.0000e+00, 3.1128e+00, 3.3552e+00, 3.9453e+05, 3.9642e+05, 3.4634e+00,
         3.1653e+00, 3.5572e+00, 3.5097e+00, 3.9784e+05, 3.2464e+00],
        [3.8708e+05, 3.9544e+05, 3.7414e+00, 3.9187e+00, 3.9360e+05, 4.0400e+05,
         3.1128e+00, 0.0000e+00, 3.5103e+00, 3.9454e+05, 3.9643e+05, 3.4616e+00,
         3.4371e+00, 3.7613e+00, 3.7741e+00, 3.9782e+05, 3.3365e+00],
        [3.8713e+05, 3.9544e+05, 3.5566e+00, 4.2065e+00, 3.9360e+05, 4.0402e+05,
         3.3552e+00, 3.5103e+00, 0.0000e+00, 3.9455e+05, 3.9642e+05, 3.4963e+00,
         3.6337e+00, 3.4069e+00, 3.5555e+00, 3.9783e+05, 3.5569e+00],
        [7.7536e+05, 7.9450e+05, 3.9448e+05, 3.9452e+05, 8.1042e+05, 8.0329e+05,
         3.9453e+05, 3.9454e+05, 3.9455e+05, 0.0000e+00, 7.9363e+05, 3.9455e+05,
         3.9452e+05, 3.9447e+05, 3.9452e+05, 8.0306e+05, 3.9452e+05],
        [7.8721e+05, 7.9411e+05, 3.9642e+05, 3.9644e+05, 7.7758e+05, 7.9217e+05,
         3.9642e+05, 3.9643e+05, 3.9642e+05, 7.9363e+05, 0.0000e+00, 3.9647e+05,
         3.9644e+05, 3.9641e+05, 3.9640e+05, 7.7324e+05, 3.9643e+05],
        [3.8712e+05, 3.9543e+05, 3.4789e+00, 3.5567e+00, 3.9363e+05, 4.0400e+05,
         3.4634e+00, 3.4616e+00, 3.4963e+00, 3.9455e+05, 3.9647e+05, 0.0000e+00,
         3.3740e+00, 3.5577e+00, 3.6293e+00, 3.9781e+05, 3.2651e+00],
        [3.8714e+05, 3.9543e+05, 3.6165e+00, 4.1643e+00, 3.9361e+05, 4.0401e+05,
         3.1653e+00, 3.4371e+00, 3.6337e+00, 3.9452e+05, 3.9644e+05, 3.3740e+00,
         0.0000e+00, 3.7179e+00, 3.5603e+00, 3.9781e+05, 3.2755e+00],
        [3.8710e+05, 3.9541e+05, 3.3385e+00, 4.4712e+00, 3.9359e+05, 4.0408e+05,
         3.5572e+00, 3.7613e+00, 3.4069e+00, 3.9447e+05, 3.9641e+05, 3.5577e+00,
         3.7179e+00, 0.0000e+00, 3.5376e+00, 3.9781e+05, 3.5493e+00],
        [3.8715e+05, 3.9543e+05, 3.9062e+00, 4.0461e+00, 3.9356e+05, 4.0399e+05,
         3.5097e+00, 3.7741e+00, 3.5555e+00, 3.9452e+05, 3.9640e+05, 3.6293e+00,
         3.5603e+00, 3.5376e+00, 0.0000e+00, 3.9785e+05, 3.5492e+00],
        [7.5633e+05, 8.0871e+05, 3.9782e+05, 3.9784e+05, 8.0500e+05, 8.0233e+05,
         3.9784e+05, 3.9782e+05, 3.9783e+05, 8.0306e+05, 7.7324e+05, 3.9781e+05,
         3.9781e+05, 3.9781e+05, 3.9785e+05, 0.0000e+00, 3.9786e+05],
        [3.8704e+05, 3.9544e+05, 3.4939e+00, 3.6759e+00, 3.9355e+05, 4.0404e+05,
         3.2464e+00, 3.3365e+00, 3.5569e+00, 3.9452e+05, 3.9643e+05, 3.2651e+00,
         3.2755e+00, 3.5493e+00, 3.5492e+00, 3.9786e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 387035.5625, 387078.8438, 387098.8438, 387121.8125,
        387127.5000, 387129.9688, 387132.9375, 387143.3750, 387149.4375,
        387174.6250, 746970.5000, 756331.6875, 775363.6250, 778495.4375,
        787209.4375, 795677.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395406.1875, 395413.8438, 395426.9375, 395429.3125,
        395429.7812, 395431.6875, 395436.9062, 395438.9688, 395440.5000,
        395442.6875, 746970.5000, 789653.8750, 794111.3125, 794500.4375,
        797266.8750, 808709.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3385e+00, 3.3958e+00, 3.4789e+00, 3.4939e+00, 3.5566e+00,
        3.6165e+00, 3.7414e+00, 3.8793e+00, 3.9062e+00, 3.8713e+05, 3.9358e+05,
        3.9448e+05, 3.9543e+05, 3.9642e+05, 3.9782e+05, 4.0407e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5567e+00, 3.6744e+00, 3.6759e+00, 3.8793e+00, 3.9187e+00,
        4.0461e+00, 4.1643e+00, 4.2065e+00, 4.4712e+00, 3.8717e+05, 3.9360e+05,
        3.9452e+05, 3.9544e+05, 3.9644e+05, 3.9784e+05, 4.0406e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393552.7500, 393560.3438, 393561.0312, 393580.6250,
        393593.0000, 393598.5625, 393600.6875, 393601.3125, 393610.9062,
        393630.4062, 777584.3750, 778495.4375, 789653.8750, 800213.2500,
        804995.6875, 810418.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403974.1875, 403991.1250, 403998.3750, 404003.3750,
        404011.0000, 404021.0625, 404036.9688, 404057.2812, 404070.0938,
        404083.1875, 792171.1250, 795677.3125, 797266.8750, 800213.2500,
        802333.5625, 803294.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.1128e+00, 3.1653e+00, 3.2464e+00, 3.3552e+00, 3.3958e+00,
        3.4634e+00, 3.5097e+00, 3.5572e+00, 3.6744e+00, 3.8713e+05, 3.9356e+05,
        3.9453e+05, 3.9541e+05, 3.9642e+05, 3.9784e+05, 4.0397e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.1128e+00, 3.3365e+00, 3.4371e+00, 3.4616e+00, 3.5103e+00,
        3.7414e+00, 3.7613e+00, 3.7741e+00, 3.9187e+00, 3.8708e+05, 3.9360e+05,
        3.9454e+05, 3.9544e+05, 3.9643e+05, 3.9782e+05, 4.0400e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3552e+00, 3.4069e+00, 3.4963e+00, 3.5103e+00, 3.5555e+00,
        3.5566e+00, 3.5569e+00, 3.6337e+00, 4.2065e+00, 3.8713e+05, 3.9360e+05,
        3.9455e+05, 3.9544e+05, 3.9642e+05, 3.9783e+05, 4.0402e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394466.6875, 394481.4375, 394515.0000, 394516.1250,
        394521.2500, 394524.0625, 394528.2812, 394540.9375, 394546.1250,
        394551.7500, 775363.6250, 793628.2500, 794500.4375, 803060.5000,
        803294.5000, 810418.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396395.1562, 396405.2500, 396417.8750, 396420.3750,
        396422.8438, 396427.6875, 396431.4062, 396442.6562, 396443.7500,
        396472.7500, 773235.7500, 777584.3750, 787209.4375, 792171.1250,
        793628.2500, 794111.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2651e+00, 3.3740e+00, 3.4616e+00, 3.4634e+00, 3.4789e+00,
        3.4963e+00, 3.5567e+00, 3.5577e+00, 3.6293e+00, 3.8712e+05, 3.9363e+05,
        3.9455e+05, 3.9543e+05, 3.9647e+05, 3.9781e+05, 4.0400e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.1653e+00, 3.2755e+00, 3.3740e+00, 3.4371e+00, 3.5603e+00,
        3.6165e+00, 3.6337e+00, 3.7179e+00, 4.1643e+00, 3.8714e+05, 3.9361e+05,
        3.9452e+05, 3.9543e+05, 3.9644e+05, 3.9781e+05, 4.0401e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3385e+00, 3.4069e+00, 3.5376e+00, 3.5493e+00, 3.5572e+00,
        3.5577e+00, 3.7179e+00, 3.7613e+00, 4.4712e+00, 3.8710e+05, 3.9359e+05,
        3.9447e+05, 3.9541e+05, 3.9641e+05, 3.9781e+05, 4.0408e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5097e+00, 3.5376e+00, 3.5492e+00, 3.5555e+00, 3.5603e+00,
        3.6293e+00, 3.7741e+00, 3.9062e+00, 4.0461e+00, 3.8715e+05, 3.9356e+05,
        3.9452e+05, 3.9543e+05, 3.9640e+05, 3.9785e+05, 4.0399e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397805.7500, 397807.5000, 397809.6250, 397818.3438,
        397818.7188, 397830.5312, 397836.1250, 397844.1875, 397847.2812,
        397857.9375, 756331.6875, 773235.7500, 802333.5625, 803060.5000,
        804995.6875, 808709.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2464e+00, 3.2651e+00, 3.2755e+00, 3.3365e+00, 3.4939e+00,
        3.5492e+00, 3.5493e+00, 3.5569e+00, 3.6759e+00, 3.8704e+05, 3.9355e+05,
        3.9452e+05, 3.9544e+05, 3.9643e+05, 3.9786e+05, 4.0404e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['387119.28', '395429.69', '38716.54', '38721.02', '393588.94', '404024.66', '38715.80', '38711.09', '38716.22', '394519.16', '396427.94', '38715.30', '38717.53', '38713.18', '38718.25', '397827.59', '38706.65']
estimated f for each client, fs: [5, 5, 7, 7, 5, 5, 7, 7, 7, 5, 5, 7, 7, 7, 7, 5, 7]
selected_index: 16
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']], selected_client_indices: [17, 15, 11, 1, 18, 20, 3, 7, 5, 13, 19, 6, 10, 4, 2, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0142s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:16...
global Accuracy on shared test data: 50.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[110 127]
 [120 143]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:16, End: 2025-07-22 15:46:16)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [11, 16, 17, 9, 6, 12, 20], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 3.8522e+05, 3.9301e+05, 3.4974e+00, 3.5835e+00, 3.5852e+00,
         4.1234e+05],
        [3.8522e+05, 0.0000e+00, 7.8688e+05, 3.8518e+05, 3.8518e+05, 3.8519e+05,
         7.9428e+05],
        [3.9301e+05, 7.8688e+05, 0.0000e+00, 3.9307e+05, 3.9296e+05, 3.9301e+05,
         8.1595e+05],
        [3.4974e+00, 3.8518e+05, 3.9307e+05, 0.0000e+00, 3.4479e+00, 3.6396e+00,
         4.1235e+05],
        [3.5835e+00, 3.8518e+05, 3.9296e+05, 3.4479e+00, 0.0000e+00, 3.2657e+00,
         4.1233e+05],
        [3.5852e+00, 3.8519e+05, 3.9301e+05, 3.6396e+00, 3.2657e+00, 0.0000e+00,
         4.1235e+05],
        [4.1234e+05, 7.9428e+05, 8.1595e+05, 4.1235e+05, 4.1233e+05, 4.1235e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.4974e+00, 3.5835e+00, 3.5852e+00, 3.8522e+05, 3.9301e+05,
        4.1234e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 385176.1875, 385180.3438, 385192.4375, 385215.5000,
        786879.9375, 794279.5000])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 392957.2500, 393010.4688, 393014.3750, 393069.1562,
        786879.9375, 815950.8750])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.4479e+00, 3.4974e+00, 3.6396e+00, 3.8518e+05, 3.9307e+05,
        4.1235e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.2657e+00, 3.4479e+00, 3.5835e+00, 3.8518e+05, 3.9296e+05,
        4.1233e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([0.0000e+00, 3.2657e+00, 3.5852e+00, 3.6396e+00, 3.8519e+05, 3.9301e+05,
        4.1235e+05])
Index of maximum distance difference after half of values: 5
sorted_distances: tensor([     0.0000, 412328.7500, 412339.5000, 412347.5000, 412352.2188,
        794279.5000, 815950.8750])
Index of maximum distance difference after half of values: 5
adaptive_Krum scores:  ['155648.11', '465528.88', '471786.25', '155652.02', '155628.75', '155642.67', '488729.53']
estimated f for each client, fs: [3, 2, 2, 3, 3, 3, 1]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']], selected_client_indices: [11, 16, 17, 9, 6, 12, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0069s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:16...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[116 121]
 [120 143]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:16, End: 2025-07-22 15:46:16)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [12, 10, 17, 18, 19, 4, 7, 2, 3, 8, 16, 5, 20, 1], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.3068e+00, 3.8094e+05, 3.8347e+05, 4.1215e+05, 3.6380e+00,
         3.4277e+00, 3.6263e+00, 3.2369e+00, 3.7140e+00, 3.9732e+05, 3.4354e+00,
         3.8925e+05, 3.5109e+00],
        [3.3068e+00, 0.0000e+00, 3.8095e+05, 3.8345e+05, 4.1216e+05, 3.6753e+00,
         3.4180e+00, 3.6925e+00, 3.1831e+00, 3.7362e+00, 3.9728e+05, 3.6770e+00,
         3.8921e+05, 3.9938e+00],
        [3.8094e+05, 3.8095e+05, 0.0000e+00, 7.5458e+05, 8.0316e+05, 3.8099e+05,
         3.8100e+05, 3.8099e+05, 3.8096e+05, 3.8092e+05, 7.8864e+05, 3.8090e+05,
         7.7151e+05, 3.8093e+05],
        [3.8347e+05, 3.8345e+05, 7.5458e+05, 0.0000e+00, 7.7410e+05, 3.8341e+05,
         3.8342e+05, 3.8341e+05, 3.8342e+05, 3.8345e+05, 7.7587e+05, 3.8348e+05,
         7.7007e+05, 3.8340e+05],
        [4.1215e+05, 4.1216e+05, 8.0316e+05, 7.7410e+05, 0.0000e+00, 4.1220e+05,
         4.1214e+05, 4.1214e+05, 4.1218e+05, 4.1220e+05, 8.2888e+05, 4.1216e+05,
         8.1348e+05, 4.1210e+05],
        [3.6380e+00, 3.6753e+00, 3.8099e+05, 3.8341e+05, 4.1220e+05, 0.0000e+00,
         3.5191e+00, 3.7531e+00, 3.5589e+00, 4.1971e+00, 3.9730e+05, 3.4460e+00,
         3.8925e+05, 4.5144e+00],
        [3.4277e+00, 3.4180e+00, 3.8100e+05, 3.8342e+05, 4.1214e+05, 3.5191e+00,
         0.0000e+00, 3.7436e+00, 3.0856e+00, 4.0484e+00, 3.9725e+05, 3.3899e+00,
         3.8926e+05, 3.7696e+00],
        [3.6263e+00, 3.6925e+00, 3.8099e+05, 3.8341e+05, 4.1214e+05, 3.7531e+00,
         3.7436e+00, 0.0000e+00, 3.5474e+00, 4.0984e+00, 3.9730e+05, 3.6405e+00,
         3.8919e+05, 4.0394e+00],
        [3.2369e+00, 3.1831e+00, 3.8096e+05, 3.8342e+05, 4.1218e+05, 3.5589e+00,
         3.0856e+00, 3.5474e+00, 0.0000e+00, 3.5886e+00, 3.9726e+05, 3.3166e+00,
         3.8925e+05, 3.6331e+00],
        [3.7140e+00, 3.7362e+00, 3.8092e+05, 3.8345e+05, 4.1220e+05, 4.1971e+00,
         4.0484e+00, 4.0984e+00, 3.5886e+00, 0.0000e+00, 3.9723e+05, 3.7608e+00,
         3.8921e+05, 4.1110e+00],
        [3.9732e+05, 3.9728e+05, 7.8864e+05, 7.7587e+05, 8.2888e+05, 3.9730e+05,
         3.9725e+05, 3.9730e+05, 3.9726e+05, 3.9723e+05, 0.0000e+00, 3.9729e+05,
         7.6695e+05, 3.9727e+05],
        [3.4354e+00, 3.6770e+00, 3.8090e+05, 3.8348e+05, 4.1216e+05, 3.4460e+00,
         3.3899e+00, 3.6405e+00, 3.3166e+00, 3.7608e+00, 3.9729e+05, 0.0000e+00,
         3.8923e+05, 4.1494e+00],
        [3.8925e+05, 3.8921e+05, 7.7151e+05, 7.7007e+05, 8.1348e+05, 3.8925e+05,
         3.8926e+05, 3.8919e+05, 3.8925e+05, 3.8921e+05, 7.6695e+05, 3.8923e+05,
         0.0000e+00, 3.8927e+05],
        [3.5109e+00, 3.9938e+00, 3.8093e+05, 3.8340e+05, 4.1210e+05, 4.5144e+00,
         3.7696e+00, 4.0394e+00, 3.6331e+00, 4.1110e+00, 3.9727e+05, 4.1494e+00,
         3.8927e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.2369e+00, 3.3068e+00, 3.4277e+00, 3.4354e+00, 3.5109e+00,
        3.6263e+00, 3.6380e+00, 3.7140e+00, 3.8094e+05, 3.8347e+05, 3.8925e+05,
        3.9732e+05, 4.1215e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.1831e+00, 3.3068e+00, 3.4180e+00, 3.6753e+00, 3.6770e+00,
        3.6925e+00, 3.7362e+00, 3.9938e+00, 3.8095e+05, 3.8345e+05, 3.8921e+05,
        3.9728e+05, 4.1216e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 380895.4062, 380924.1875, 380930.9688, 380941.6250,
        380953.0312, 380961.3125, 380991.8750, 380994.4688, 381002.9375,
        754584.0000, 771506.2500, 788641.4375, 803155.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 383402.5938, 383405.7812, 383411.0625, 383417.4375,
        383421.4375, 383452.4688, 383453.5000, 383474.7500, 383478.5938,
        754584.0000, 770070.8750, 774104.3125, 775873.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 412103.7812, 412136.1250, 412142.1875, 412148.2812,
        412158.7812, 412163.7500, 412182.7500, 412197.8750, 412204.6875,
        774104.3125, 803155.1875, 813476.5625, 828882.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4460e+00, 3.5191e+00, 3.5589e+00, 3.6380e+00, 3.6753e+00,
        3.7531e+00, 4.1971e+00, 4.5144e+00, 3.8099e+05, 3.8341e+05, 3.8925e+05,
        3.9730e+05, 4.1220e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.0856e+00, 3.3899e+00, 3.4180e+00, 3.4277e+00, 3.5191e+00,
        3.7436e+00, 3.7696e+00, 4.0484e+00, 3.8100e+05, 3.8342e+05, 3.8926e+05,
        3.9725e+05, 4.1214e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5474e+00, 3.6263e+00, 3.6405e+00, 3.6925e+00, 3.7436e+00,
        3.7531e+00, 4.0394e+00, 4.0984e+00, 3.8099e+05, 3.8341e+05, 3.8919e+05,
        3.9730e+05, 4.1214e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.0856e+00, 3.1831e+00, 3.2369e+00, 3.3166e+00, 3.5474e+00,
        3.5589e+00, 3.5886e+00, 3.6331e+00, 3.8096e+05, 3.8342e+05, 3.8925e+05,
        3.9726e+05, 4.1218e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5886e+00, 3.7140e+00, 3.7362e+00, 3.7608e+00, 4.0484e+00,
        4.0984e+00, 4.1110e+00, 4.1971e+00, 3.8092e+05, 3.8345e+05, 3.8921e+05,
        3.9723e+05, 4.1220e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397228.3125, 397253.8438, 397262.3438, 397266.7188,
        397283.0625, 397286.6562, 397303.6875, 397304.1562, 397324.3750,
        766953.3125, 775873.3125, 788641.4375, 828882.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.3166e+00, 3.3899e+00, 3.4354e+00, 3.4460e+00, 3.6405e+00,
        3.6770e+00, 3.7608e+00, 4.1494e+00, 3.8090e+05, 3.8348e+05, 3.8923e+05,
        3.9729e+05, 4.1216e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389189.1250, 389211.1875, 389213.5000, 389230.7500,
        389245.9688, 389248.0000, 389250.1562, 389256.4375, 389266.1875,
        766953.3125, 770070.8750, 771506.2500, 813476.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5109e+00, 3.6331e+00, 3.7696e+00, 3.9938e+00, 4.0394e+00,
        4.1110e+00, 4.1494e+00, 4.5144e+00, 3.8093e+05, 3.8340e+05, 3.8927e+05,
        3.9727e+05, 4.1210e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['42329.95', '42331.30', '380955.09', '383435.28', '412159.78', '42336.08', '42336.81', '42335.78', '42332.05', '42328.38', '397279.22', '42324.91', '389234.56', '42329.18']
estimated f for each client, fs: [5, 5, 3, 3, 3, 5, 5, 5, 5, 5, 3, 5, 3, 5]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']], selected_client_indices: [12, 10, 17, 18, 19, 4, 7, 2, 3, 8, 16, 5, 20, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:17...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[120 117]
 [123 140]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:17, End: 2025-07-22 15:46:17)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [7, 16, 15, 4, 8], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
tensor([[0.0000e+00, 3.9043e+05, 3.7120e+05, 3.4759e+00, 4.0823e+00],
        [3.9043e+05, 0.0000e+00, 7.5992e+05, 3.9043e+05, 3.9048e+05],
        [3.7120e+05, 7.5992e+05, 0.0000e+00, 3.7122e+05, 3.7124e+05],
        [3.4759e+00, 3.9043e+05, 3.7122e+05, 0.0000e+00, 4.1841e+00],
        [4.0823e+00, 3.9048e+05, 3.7124e+05, 4.1841e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.4759e+00, 4.0823e+00, 3.7120e+05, 3.9043e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([     0.0000, 390427.3125, 390431.3750, 390482.7500, 759918.7500])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([     0.0000, 371198.9375, 371217.9375, 371242.9375, 759918.7500])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 3.4759e+00, 4.1841e+00, 3.7122e+05, 3.9043e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 4.0823e+00, 4.1841e+00, 3.7124e+05, 3.9048e+05])
Index of maximum distance difference after half of values: 4
adaptive_Krum scores:  ['190409.45', '482815.03', '468394.66', '190413.22', '190433.50']
estimated f for each client, fs: [2, 0, 1, 2, 2]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']], selected_client_indices: [7, 16, 15, 4, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:17...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[120 117]
 [125 138]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:17, End: 2025-07-22 15:46:17)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [9, 2, 18, 5, 10, 16, 11, 3, 6], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 3.6795e+00, 3.8100e+05, 3.5329e+00, 3.3973e+00, 4.0240e+05,
         3.3984e+00, 3.5491e+00, 3.4246e+00],
        [3.6795e+00, 0.0000e+00, 3.8104e+05, 3.7177e+00, 3.5710e+00, 4.0240e+05,
         4.2633e+00, 3.4872e+00, 3.5642e+00],
        [3.8100e+05, 3.8104e+05, 0.0000e+00, 3.8100e+05, 3.8099e+05, 7.9255e+05,
         3.8101e+05, 3.8101e+05, 3.8100e+05],
        [3.5329e+00, 3.7177e+00, 3.8100e+05, 0.0000e+00, 3.6972e+00, 4.0240e+05,
         3.5262e+00, 3.3951e+00, 3.4684e+00],
        [3.3973e+00, 3.5710e+00, 3.8099e+05, 3.6972e+00, 0.0000e+00, 4.0243e+05,
         3.6456e+00, 3.1563e+00, 3.2651e+00],
        [4.0240e+05, 4.0240e+05, 7.9255e+05, 4.0240e+05, 4.0243e+05, 0.0000e+00,
         4.0244e+05, 4.0244e+05, 4.0239e+05],
        [3.3984e+00, 4.2633e+00, 3.8101e+05, 3.5262e+00, 3.6456e+00, 4.0244e+05,
         0.0000e+00, 3.4179e+00, 3.6219e+00],
        [3.5491e+00, 3.4872e+00, 3.8101e+05, 3.3951e+00, 3.1563e+00, 4.0244e+05,
         3.4179e+00, 0.0000e+00, 3.2828e+00],
        [3.4246e+00, 3.5642e+00, 3.8100e+05, 3.4684e+00, 3.2651e+00, 4.0239e+05,
         3.6219e+00, 3.2828e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.3973e+00, 3.3984e+00, 3.4246e+00, 3.5329e+00, 3.5491e+00,
        3.6795e+00, 3.8100e+05, 4.0240e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.4872e+00, 3.5642e+00, 3.5710e+00, 3.6795e+00, 3.7177e+00,
        4.2633e+00, 3.8104e+05, 4.0240e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 380990.7812, 380996.3438, 381001.1875, 381003.5625,
        381007.4062, 381012.6875, 381042.1875, 792548.8125])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.3951e+00, 3.4684e+00, 3.5262e+00, 3.5329e+00, 3.6972e+00,
        3.7177e+00, 3.8100e+05, 4.0240e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.1563e+00, 3.2651e+00, 3.3973e+00, 3.5710e+00, 3.6456e+00,
        3.6972e+00, 3.8099e+05, 4.0243e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 402391.2500, 402398.1250, 402402.9375, 402403.8438,
        402431.9375, 402438.0625, 402443.9375, 792548.8125])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.3984e+00, 3.4179e+00, 3.5262e+00, 3.6219e+00, 3.6456e+00,
        4.2633e+00, 3.8101e+05, 4.0244e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.1563e+00, 3.2828e+00, 3.3951e+00, 3.4179e+00, 3.4872e+00,
        3.5491e+00, 3.8101e+05, 4.0244e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.2651e+00, 3.2828e+00, 3.4246e+00, 3.4684e+00, 3.5642e+00,
        3.6219e+00, 3.8100e+05, 4.0239e+05])
Index of maximum distance difference after half of values: 6
adaptive_Krum scores:  ['3.50', '3.71', '381002.00', '3.56', '3.46', '402415.72', '3.65', '3.38', '3.44']
estimated f for each client, fs: [2, 2, 2, 2, 2, 0, 2, 2, 2]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']], selected_client_indices: [9, 2, 18, 5, 10, 16, 11, 3, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0131s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:17...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[123 114]
 [125 138]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:17, End: 2025-07-22 15:46:17)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 19, 20, 8, 6, 1, 7, 13, 12, 11, 3, 9, 16, 2, 18, 5, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 7.8856e+05, 7.8370e+05, 3.8448e+05, 3.8451e+05, 3.8452e+05,
         3.8448e+05, 7.6400e+05, 3.8451e+05, 3.8451e+05, 3.8450e+05, 3.8451e+05,
         8.0301e+05, 3.8447e+05, 7.8205e+05, 3.8453e+05, 3.8450e+05, 7.5485e+05],
        [7.8856e+05, 0.0000e+00, 7.9446e+05, 3.9392e+05, 3.9386e+05, 3.9391e+05,
         3.9389e+05, 7.8364e+05, 3.9392e+05, 3.9390e+05, 3.9389e+05, 3.9390e+05,
         8.2634e+05, 3.9388e+05, 7.8919e+05, 3.9393e+05, 3.9395e+05, 7.8667e+05],
        [7.8370e+05, 7.9446e+05, 0.0000e+00, 3.9142e+05, 3.9145e+05, 3.9143e+05,
         3.9144e+05, 7.8317e+05, 3.9138e+05, 3.9141e+05, 3.9147e+05, 3.9142e+05,
         8.1121e+05, 3.9140e+05, 8.0239e+05, 3.9143e+05, 3.9139e+05, 7.7142e+05],
        [3.8448e+05, 3.9392e+05, 3.9142e+05, 0.0000e+00, 3.7575e+00, 4.0749e+00,
         4.0273e+00, 3.9790e+05, 3.7020e+00, 4.2084e+00, 3.4847e+00, 4.2864e+00,
         4.0927e+05, 4.1397e+00, 3.9839e+05, 3.9228e+00, 3.6921e+00, 3.8981e+05],
        [3.8451e+05, 3.9386e+05, 3.9145e+05, 3.7575e+00, 0.0000e+00, 3.3348e+00,
         3.5485e+00, 3.9793e+05, 3.2246e+00, 3.5804e+00, 3.3098e+00, 3.5494e+00,
         4.0927e+05, 3.5385e+00, 3.9838e+05, 3.5086e+00, 3.1988e+00, 3.8991e+05],
        [3.8452e+05, 3.9391e+05, 3.9143e+05, 4.0749e+00, 3.3348e+00, 0.0000e+00,
         3.7844e+00, 3.9791e+05, 3.4455e+00, 3.8502e+00, 3.4737e+00, 3.4249e+00,
         4.0931e+05, 3.9984e+00, 3.9838e+05, 4.0224e+00, 3.6616e+00, 3.8989e+05],
        [3.8448e+05, 3.9389e+05, 3.9144e+05, 4.0273e+00, 3.5485e+00, 3.7844e+00,
         0.0000e+00, 3.9787e+05, 3.4888e+00, 3.8130e+00, 3.1828e+00, 3.7014e+00,
         4.0928e+05, 3.6851e+00, 3.9838e+05, 3.4490e+00, 3.4709e+00, 3.8991e+05],
        [7.6400e+05, 7.8364e+05, 7.8317e+05, 3.9790e+05, 3.9793e+05, 3.9791e+05,
         3.9787e+05, 0.0000e+00, 3.9790e+05, 3.9789e+05, 3.9786e+05, 3.9788e+05,
         7.7997e+05, 3.9788e+05, 7.9504e+05, 3.9788e+05, 3.9783e+05, 7.9433e+05],
        [3.8451e+05, 3.9392e+05, 3.9138e+05, 3.7020e+00, 3.2246e+00, 3.4455e+00,
         3.4888e+00, 3.9790e+05, 0.0000e+00, 3.6782e+00, 3.4126e+00, 3.7586e+00,
         4.0930e+05, 3.6828e+00, 3.9838e+05, 3.5328e+00, 3.3645e+00, 3.8992e+05],
        [3.8451e+05, 3.9390e+05, 3.9141e+05, 4.2084e+00, 3.5804e+00, 3.8502e+00,
         3.8130e+00, 3.9789e+05, 3.6782e+00, 0.0000e+00, 3.3767e+00, 3.4300e+00,
         4.0925e+05, 4.1659e+00, 3.9840e+05, 3.5241e+00, 3.5435e+00, 3.8988e+05],
        [3.8450e+05, 3.9389e+05, 3.9147e+05, 3.4847e+00, 3.3098e+00, 3.4737e+00,
         3.1828e+00, 3.9786e+05, 3.4126e+00, 3.3767e+00, 0.0000e+00, 3.6303e+00,
         4.0932e+05, 3.4735e+00, 3.9836e+05, 3.4948e+00, 3.1167e+00, 3.8990e+05],
        [3.8451e+05, 3.9390e+05, 3.9142e+05, 4.2864e+00, 3.5494e+00, 3.4249e+00,
         3.7014e+00, 3.9788e+05, 3.7586e+00, 3.4300e+00, 3.6303e+00, 0.0000e+00,
         4.0927e+05, 3.7568e+00, 3.9839e+05, 3.6240e+00, 3.3884e+00, 3.8990e+05],
        [8.0301e+05, 8.2634e+05, 8.1121e+05, 4.0927e+05, 4.0927e+05, 4.0931e+05,
         4.0928e+05, 7.7997e+05, 4.0930e+05, 4.0925e+05, 4.0932e+05, 4.0927e+05,
         0.0000e+00, 4.0932e+05, 8.0836e+05, 4.0928e+05, 4.0926e+05, 8.2905e+05],
        [3.8447e+05, 3.9388e+05, 3.9140e+05, 4.1397e+00, 3.5385e+00, 3.9984e+00,
         3.6851e+00, 3.9788e+05, 3.6828e+00, 4.1659e+00, 3.4735e+00, 3.7568e+00,
         4.0932e+05, 0.0000e+00, 3.9842e+05, 3.7523e+00, 3.4380e+00, 3.8991e+05],
        [7.8205e+05, 7.8919e+05, 8.0239e+05, 3.9839e+05, 3.9838e+05, 3.9838e+05,
         3.9838e+05, 7.9504e+05, 3.9838e+05, 3.9840e+05, 3.9836e+05, 3.9839e+05,
         8.0836e+05, 3.9842e+05, 0.0000e+00, 3.9841e+05, 3.9835e+05, 7.8611e+05],
        [3.8453e+05, 3.9393e+05, 3.9143e+05, 3.9228e+00, 3.5086e+00, 4.0224e+00,
         3.4490e+00, 3.9788e+05, 3.5328e+00, 3.5241e+00, 3.4948e+00, 3.6240e+00,
         4.0928e+05, 3.7523e+00, 3.9841e+05, 0.0000e+00, 3.6686e+00, 3.8989e+05],
        [3.8450e+05, 3.9395e+05, 3.9139e+05, 3.6921e+00, 3.1988e+00, 3.6616e+00,
         3.4709e+00, 3.9783e+05, 3.3645e+00, 3.5435e+00, 3.1167e+00, 3.3884e+00,
         4.0926e+05, 3.4380e+00, 3.9835e+05, 3.6686e+00, 0.0000e+00, 3.8987e+05],
        [7.5485e+05, 7.8667e+05, 7.7142e+05, 3.8981e+05, 3.8991e+05, 3.8989e+05,
         3.8991e+05, 7.9433e+05, 3.8992e+05, 3.8988e+05, 3.8990e+05, 3.8990e+05,
         8.2905e+05, 3.8991e+05, 7.8611e+05, 3.8989e+05, 3.8987e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 384474.3125, 384478.8125, 384483.5625, 384496.4375,
        384498.7812, 384505.4375, 384507.1562, 384508.5000, 384510.4062,
        384520.1562, 384526.1562, 754851.1250, 764001.8125, 782051.4375,
        783695.3750, 788557.8750, 803006.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393859.3438, 393878.0312, 393887.6562, 393889.3125,
        393899.5000, 393902.7188, 393914.3125, 393917.1250, 393920.9062,
        393930.4062, 393946.3125, 783643.9375, 786666.0000, 788557.8750,
        789185.7500, 794458.6250, 826336.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391376.7188, 391394.7812, 391399.6250, 391411.7188,
        391421.2812, 391422.3125, 391430.6250, 391433.4688, 391442.5625,
        391446.7188, 391470.9062, 771421.2500, 783173.5625, 783695.3750,
        794458.6250, 802386.0000, 811213.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4847e+00, 3.6921e+00, 3.7020e+00, 3.7575e+00, 3.9228e+00,
        4.0273e+00, 4.0749e+00, 4.1397e+00, 4.2084e+00, 4.2864e+00, 3.8448e+05,
        3.8981e+05, 3.9142e+05, 3.9392e+05, 3.9790e+05, 3.9839e+05, 4.0927e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.1988e+00, 3.2246e+00, 3.3098e+00, 3.3348e+00, 3.5086e+00,
        3.5385e+00, 3.5485e+00, 3.5494e+00, 3.5804e+00, 3.7575e+00, 3.8451e+05,
        3.8991e+05, 3.9145e+05, 3.9386e+05, 3.9793e+05, 3.9838e+05, 4.0927e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3348e+00, 3.4249e+00, 3.4455e+00, 3.4737e+00, 3.6616e+00,
        3.7844e+00, 3.8502e+00, 3.9984e+00, 4.0224e+00, 4.0749e+00, 3.8452e+05,
        3.8989e+05, 3.9143e+05, 3.9391e+05, 3.9791e+05, 3.9838e+05, 4.0931e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.1828e+00, 3.4490e+00, 3.4709e+00, 3.4888e+00, 3.5485e+00,
        3.6851e+00, 3.7014e+00, 3.7844e+00, 3.8130e+00, 4.0273e+00, 3.8448e+05,
        3.8991e+05, 3.9144e+05, 3.9389e+05, 3.9787e+05, 3.9838e+05, 4.0928e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397834.3750, 397862.5938, 397870.0625, 397881.7188,
        397882.6562, 397884.0000, 397892.6562, 397896.9375, 397900.9375,
        397910.4688, 397930.4375, 764001.8125, 779968.1250, 783173.5625,
        783643.9375, 794333.8750, 795040.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2246e+00, 3.3645e+00, 3.4126e+00, 3.4455e+00, 3.4888e+00,
        3.5328e+00, 3.6782e+00, 3.6828e+00, 3.7020e+00, 3.7586e+00, 3.8451e+05,
        3.8992e+05, 3.9138e+05, 3.9392e+05, 3.9790e+05, 3.9838e+05, 4.0930e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3767e+00, 3.4300e+00, 3.5241e+00, 3.5435e+00, 3.5804e+00,
        3.6782e+00, 3.8130e+00, 3.8502e+00, 4.1659e+00, 4.2084e+00, 3.8451e+05,
        3.8988e+05, 3.9141e+05, 3.9390e+05, 3.9789e+05, 3.9840e+05, 4.0925e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.1167e+00, 3.1828e+00, 3.3098e+00, 3.3767e+00, 3.4126e+00,
        3.4735e+00, 3.4737e+00, 3.4847e+00, 3.4948e+00, 3.6303e+00, 3.8450e+05,
        3.8990e+05, 3.9147e+05, 3.9389e+05, 3.9786e+05, 3.9836e+05, 4.0932e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3884e+00, 3.4249e+00, 3.4300e+00, 3.5494e+00, 3.6240e+00,
        3.6303e+00, 3.7014e+00, 3.7568e+00, 3.7586e+00, 4.2864e+00, 3.8451e+05,
        3.8990e+05, 3.9142e+05, 3.9390e+05, 3.9788e+05, 3.9839e+05, 4.0927e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 409246.6875, 409259.9375, 409267.9375, 409268.4062,
        409268.7500, 409275.3125, 409282.6250, 409300.5625, 409306.5625,
        409317.2188, 409319.7500, 779968.1250, 803006.6875, 808364.1875,
        811213.8125, 826336.8125, 829049.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4380e+00, 3.4735e+00, 3.5385e+00, 3.6828e+00, 3.6851e+00,
        3.7523e+00, 3.7568e+00, 3.9984e+00, 4.1397e+00, 4.1659e+00, 3.8447e+05,
        3.8991e+05, 3.9140e+05, 3.9388e+05, 3.9788e+05, 3.9842e+05, 4.0932e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398352.1875, 398355.0000, 398376.8438, 398378.6250,
        398381.7500, 398382.4688, 398390.8750, 398392.0938, 398397.9062,
        398408.8750, 398422.5625, 782051.4375, 786106.4375, 789185.7500,
        795040.2500, 802386.0000, 808364.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4490e+00, 3.4948e+00, 3.5086e+00, 3.5241e+00, 3.5328e+00,
        3.6240e+00, 3.6686e+00, 3.7523e+00, 3.9228e+00, 4.0224e+00, 3.8453e+05,
        3.8989e+05, 3.9143e+05, 3.9393e+05, 3.9788e+05, 3.9841e+05, 4.0928e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.1167e+00, 3.1988e+00, 3.3645e+00, 3.3884e+00, 3.4380e+00,
        3.4709e+00, 3.5435e+00, 3.6616e+00, 3.6686e+00, 3.6921e+00, 3.8450e+05,
        3.8987e+05, 3.9139e+05, 3.9395e+05, 3.9783e+05, 3.9835e+05, 4.0926e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 389811.9375, 389872.1250, 389880.6562, 389885.3125,
        389891.0000, 389898.3438, 389902.3438, 389907.6250, 389908.8750,
        389908.9688, 389918.4375, 754851.1250, 771421.2500, 786106.4375,
        786666.0000, 794333.8750, 829049.3125])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['384500.88', '393904.09', '391422.75', '34956.19', '34958.63', '34959.75', '34956.34', '397886.06', '34958.25', '34958.70', '34957.31', '34958.52', '409283.03', '34955.63', '398385.34', '34960.23', '34957.57', '389889.53']
estimated f for each client, fs: [5, 5, 5, 7, 7, 7, 7, 5, 7, 7, 7, 7, 5, 7, 5, 7, 7, 5]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 19, 20, 8, 6, 1, 7, 13, 12, 11, 3, 9, 16, 2, 18, 5, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0209s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:18...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[123 114]
 [125 138]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:46:18, End: 2025-07-22 15:46:18)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [4, 2, 3, 12, 16, 15, 13, 11, 19, 10, 1, 6, 8, 5, 20, 14], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.6616e+00, 3.5439e+00, 3.6804e+00, 4.0076e+05, 3.9644e+05,
         3.7344e+05, 3.3460e+00, 3.9432e+05, 3.5345e+00, 4.1213e+00, 3.4770e+00,
         4.0745e+00, 3.4297e+00, 3.9327e+05, 3.8562e+05],
        [3.6616e+00, 0.0000e+00, 3.5569e+00, 3.6994e+00, 4.0074e+05, 3.9638e+05,
         3.7342e+05, 4.2098e+00, 3.9427e+05, 3.5327e+00, 3.9605e+00, 3.6190e+00,
         4.1866e+00, 3.7148e+00, 3.9332e+05, 3.8554e+05],
        [3.5439e+00, 3.5569e+00, 0.0000e+00, 3.4840e+00, 4.0070e+05, 3.9636e+05,
         3.7339e+05, 3.4389e+00, 3.9429e+05, 3.2874e+00, 3.4231e+00, 3.3461e+00,
         3.4249e+00, 3.4374e+00, 3.9330e+05, 3.8556e+05],
        [3.6804e+00, 3.6994e+00, 3.4840e+00, 0.0000e+00, 4.0073e+05, 3.9638e+05,
         3.7342e+05, 3.7609e+00, 3.9429e+05, 3.4461e+00, 3.3998e+00, 3.2396e+00,
         3.6534e+00, 3.4539e+00, 3.9324e+05, 3.8559e+05],
        [4.0076e+05, 4.0074e+05, 4.0070e+05, 4.0073e+05, 0.0000e+00, 7.8954e+05,
         7.9876e+05, 4.0078e+05, 8.0026e+05, 4.0071e+05, 4.0079e+05, 4.0070e+05,
         4.0070e+05, 4.0072e+05, 7.8071e+05, 8.0462e+05],
        [3.9644e+05, 3.9638e+05, 3.9636e+05, 3.9638e+05, 7.8954e+05, 0.0000e+00,
         7.6012e+05, 3.9635e+05, 7.7119e+05, 3.9645e+05, 3.9636e+05, 3.9640e+05,
         3.9635e+05, 3.9644e+05, 8.0276e+05, 7.8079e+05],
        [3.7344e+05, 3.7342e+05, 3.7339e+05, 3.7342e+05, 7.9876e+05, 7.6012e+05,
         0.0000e+00, 3.7338e+05, 7.7948e+05, 3.7345e+05, 3.7340e+05, 3.7341e+05,
         3.7344e+05, 3.7338e+05, 7.6989e+05, 7.6947e+05],
        [3.3460e+00, 4.2098e+00, 3.4389e+00, 3.7609e+00, 4.0078e+05, 3.9635e+05,
         3.7338e+05, 0.0000e+00, 3.9431e+05, 3.7178e+00, 3.8881e+00, 3.6766e+00,
         4.2075e+00, 3.5323e+00, 3.9327e+05, 3.8557e+05],
        [3.9432e+05, 3.9427e+05, 3.9429e+05, 3.9429e+05, 8.0026e+05, 7.7119e+05,
         7.7948e+05, 3.9431e+05, 0.0000e+00, 3.9432e+05, 3.9428e+05, 3.9431e+05,
         3.9423e+05, 3.9432e+05, 7.8352e+05, 7.8053e+05],
        [3.5345e+00, 3.5327e+00, 3.2874e+00, 3.4461e+00, 4.0071e+05, 3.9645e+05,
         3.7345e+05, 3.7178e+00, 3.9432e+05, 0.0000e+00, 3.7322e+00, 3.3308e+00,
         3.8043e+00, 3.7088e+00, 3.9333e+05, 3.8554e+05],
        [4.1213e+00, 3.9605e+00, 3.4231e+00, 3.3998e+00, 4.0079e+05, 3.9636e+05,
         3.7340e+05, 3.8881e+00, 3.9428e+05, 3.7322e+00, 0.0000e+00, 3.4353e+00,
         4.0855e+00, 3.9446e+00, 3.9323e+05, 3.8556e+05],
        [3.4770e+00, 3.6190e+00, 3.3461e+00, 3.2396e+00, 4.0070e+05, 3.9640e+05,
         3.7341e+05, 3.6766e+00, 3.9431e+05, 3.3308e+00, 3.4353e+00, 0.0000e+00,
         3.6839e+00, 3.3948e+00, 3.9327e+05, 3.8563e+05],
        [4.0745e+00, 4.1866e+00, 3.4249e+00, 3.6534e+00, 4.0070e+05, 3.9635e+05,
         3.7344e+05, 4.2075e+00, 3.9423e+05, 3.8043e+00, 4.0855e+00, 3.6839e+00,
         0.0000e+00, 3.7934e+00, 3.9328e+05, 3.8559e+05],
        [3.4297e+00, 3.7148e+00, 3.4374e+00, 3.4539e+00, 4.0072e+05, 3.9644e+05,
         3.7338e+05, 3.5323e+00, 3.9432e+05, 3.7088e+00, 3.9446e+00, 3.3948e+00,
         3.7934e+00, 0.0000e+00, 3.9332e+05, 3.8557e+05],
        [3.9327e+05, 3.9332e+05, 3.9330e+05, 3.9324e+05, 7.8071e+05, 8.0276e+05,
         7.6989e+05, 3.9327e+05, 7.8352e+05, 3.9333e+05, 3.9323e+05, 3.9327e+05,
         3.9328e+05, 3.9332e+05, 0.0000e+00, 7.8749e+05],
        [3.8562e+05, 3.8554e+05, 3.8556e+05, 3.8559e+05, 8.0462e+05, 7.8079e+05,
         7.6947e+05, 3.8557e+05, 7.8053e+05, 3.8554e+05, 3.8556e+05, 3.8563e+05,
         3.8559e+05, 3.8557e+05, 7.8749e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.3460e+00, 3.4297e+00, 3.4770e+00, 3.5345e+00, 3.5439e+00,
        3.6616e+00, 3.6804e+00, 4.0745e+00, 4.1213e+00, 3.7344e+05, 3.8562e+05,
        3.9327e+05, 3.9432e+05, 3.9644e+05, 4.0076e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5327e+00, 3.5569e+00, 3.6190e+00, 3.6616e+00, 3.6994e+00,
        3.7148e+00, 3.9605e+00, 4.1866e+00, 4.2098e+00, 3.7342e+05, 3.8554e+05,
        3.9332e+05, 3.9427e+05, 3.9638e+05, 4.0074e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2874e+00, 3.3461e+00, 3.4231e+00, 3.4249e+00, 3.4374e+00,
        3.4389e+00, 3.4840e+00, 3.5439e+00, 3.5569e+00, 3.7339e+05, 3.8556e+05,
        3.9330e+05, 3.9429e+05, 3.9636e+05, 4.0070e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2396e+00, 3.3998e+00, 3.4461e+00, 3.4539e+00, 3.4840e+00,
        3.6534e+00, 3.6804e+00, 3.6994e+00, 3.7609e+00, 3.7342e+05, 3.8559e+05,
        3.9324e+05, 3.9429e+05, 3.9638e+05, 4.0073e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400698.1250, 400703.8438, 400704.0000, 400709.2500,
        400720.7500, 400731.7812, 400740.5312, 400755.5938, 400775.0000,
        400789.3125, 780714.2500, 789539.9375, 798761.6875, 800261.0625,
        804619.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396346.8125, 396350.6250, 396356.7500, 396360.7500,
        396383.9062, 396384.9688, 396396.7500, 396442.8750, 396444.5000,
        396454.3750, 760117.3750, 771194.1250, 780786.1250, 789539.9375,
        802758.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 373376.9688, 373378.2812, 373390.2500, 373403.0312,
        373413.0938, 373415.5938, 373424.9688, 373438.2500, 373440.8438,
        373447.5312, 760117.3750, 769468.6250, 769890.9375, 779483.7500,
        798761.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3460e+00, 3.4389e+00, 3.5323e+00, 3.6766e+00, 3.7178e+00,
        3.7609e+00, 3.8881e+00, 4.2075e+00, 4.2098e+00, 3.7338e+05, 3.8557e+05,
        3.9327e+05, 3.9431e+05, 3.9635e+05, 4.0078e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394233.8438, 394273.0000, 394275.0000, 394289.5000,
        394291.6250, 394306.2812, 394309.8438, 394319.8438, 394319.9375,
        394324.8750, 771194.1250, 779483.7500, 780532.8750, 783523.1250,
        800261.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2874e+00, 3.3308e+00, 3.4461e+00, 3.5327e+00, 3.5345e+00,
        3.7088e+00, 3.7178e+00, 3.7322e+00, 3.8043e+00, 3.7345e+05, 3.8554e+05,
        3.9333e+05, 3.9432e+05, 3.9645e+05, 4.0071e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3998e+00, 3.4231e+00, 3.4353e+00, 3.7322e+00, 3.8881e+00,
        3.9446e+00, 3.9605e+00, 4.0855e+00, 4.1213e+00, 3.7340e+05, 3.8556e+05,
        3.9323e+05, 3.9428e+05, 3.9636e+05, 4.0079e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2396e+00, 3.3308e+00, 3.3461e+00, 3.3948e+00, 3.4353e+00,
        3.4770e+00, 3.6190e+00, 3.6766e+00, 3.6839e+00, 3.7341e+05, 3.8563e+05,
        3.9327e+05, 3.9431e+05, 3.9640e+05, 4.0070e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4249e+00, 3.6534e+00, 3.6839e+00, 3.7934e+00, 3.8043e+00,
        4.0745e+00, 4.0855e+00, 4.1866e+00, 4.2075e+00, 3.7344e+05, 3.8559e+05,
        3.9328e+05, 3.9423e+05, 3.9635e+05, 4.0070e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3948e+00, 3.4297e+00, 3.4374e+00, 3.4539e+00, 3.5323e+00,
        3.7088e+00, 3.7148e+00, 3.7934e+00, 3.9446e+00, 3.7338e+05, 3.8557e+05,
        3.9332e+05, 3.9432e+05, 3.9644e+05, 4.0072e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393225.2500, 393242.9688, 393265.8750, 393267.5312,
        393269.0625, 393282.7188, 393297.5625, 393316.4062, 393322.0625,
        393334.0625, 769890.9375, 780714.2500, 783523.1250, 787492.0000,
        802758.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385537.0000, 385540.3750, 385560.3750, 385562.7812,
        385567.9688, 385573.6250, 385588.4375, 385591.0625, 385619.5000,
        385631.6875, 769468.6250, 780532.8750, 780786.1250, 787492.0000,
        804619.3750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37347.11', '37344.98', '37342.12', '37345.68', '400732.81', '396392.25', '373412.88', '37341.07', '394294.31', '37347.96', '37343.70', '37344.43', '37347.58', '37341.07', '393282.34', '385577.31']
estimated f for each client, fs: [6, 6, 6, 6, 4, 4, 5, 6, 4, 6, 6, 6, 6, 6, 4, 4]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 2, 3, 12, 16, 15, 13, 11, 19, 10, 1, 6, 8, 5, 20, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0108s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:19...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[126 111]
 [125 138]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:19, End: 2025-07-22 15:46:19)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [19, 13, 3, 15, 5, 1, 12, 18, 20, 7], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 7.5321e+05, 3.9042e+05, 7.8808e+05, 3.9040e+05, 3.9042e+05,
         3.9045e+05, 7.7937e+05, 7.7756e+05, 3.9037e+05],
        [7.5321e+05, 0.0000e+00, 3.8906e+05, 7.6093e+05, 3.8904e+05, 3.8906e+05,
         3.8910e+05, 7.7767e+05, 7.8843e+05, 3.8902e+05],
        [3.9042e+05, 3.8906e+05, 0.0000e+00, 3.8667e+05, 3.4502e+00, 3.4626e+00,
         3.4965e+00, 3.9100e+05, 3.9008e+05, 3.1843e+00],
        [7.8808e+05, 7.6093e+05, 3.8667e+05, 0.0000e+00, 3.8673e+05, 3.8671e+05,
         3.8666e+05, 7.8991e+05, 7.8060e+05, 3.8669e+05],
        [3.9040e+05, 3.8904e+05, 3.4502e+00, 3.8673e+05, 0.0000e+00, 3.9833e+00,
         3.4455e+00, 3.9102e+05, 3.9011e+05, 3.3278e+00],
        [3.9042e+05, 3.8906e+05, 3.4626e+00, 3.8671e+05, 3.9833e+00, 0.0000e+00,
         3.4597e+00, 3.9095e+05, 3.9008e+05, 3.6304e+00],
        [3.9045e+05, 3.8910e+05, 3.4965e+00, 3.8666e+05, 3.4455e+00, 3.4597e+00,
         0.0000e+00, 3.9105e+05, 3.9009e+05, 3.3615e+00],
        [7.7937e+05, 7.7767e+05, 3.9100e+05, 7.8991e+05, 3.9102e+05, 3.9095e+05,
         3.9105e+05, 0.0000e+00, 8.0854e+05, 3.9097e+05],
        [7.7756e+05, 7.8843e+05, 3.9008e+05, 7.8060e+05, 3.9011e+05, 3.9008e+05,
         3.9009e+05, 8.0854e+05, 0.0000e+00, 3.9008e+05],
        [3.9037e+05, 3.8902e+05, 3.1843e+00, 3.8669e+05, 3.3278e+00, 3.6304e+00,
         3.3615e+00, 3.9097e+05, 3.9008e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 390368.7812, 390403.0625, 390416.9062, 390417.8750,
        390451.0000, 753206.6250, 777558.4375, 779372.6250, 788083.5625])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 389020.4375, 389039.0312, 389058.2812, 389060.1250,
        389098.5312, 753206.6250, 760932.6250, 777673.5000, 788432.8125])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.1843e+00, 3.4502e+00, 3.4626e+00, 3.4965e+00, 3.8667e+05,
        3.8906e+05, 3.9008e+05, 3.9042e+05, 3.9100e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 386660.1875, 386669.9688, 386694.4375, 386707.5625,
        386725.8125, 760932.6250, 780601.8750, 788083.5625, 789912.8750])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.3278e+00, 3.4455e+00, 3.4502e+00, 3.9833e+00, 3.8673e+05,
        3.8904e+05, 3.9011e+05, 3.9040e+05, 3.9102e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.4597e+00, 3.4626e+00, 3.6304e+00, 3.9833e+00, 3.8671e+05,
        3.8906e+05, 3.9008e+05, 3.9042e+05, 3.9095e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.3615e+00, 3.4455e+00, 3.4597e+00, 3.4965e+00, 3.8666e+05,
        3.8910e+05, 3.9009e+05, 3.9045e+05, 3.9105e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 390951.4062, 390966.1875, 391003.5625, 391023.2188,
        391051.8750, 777673.5000, 779372.6250, 789912.8750, 808540.7500])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 390077.5000, 390078.1250, 390082.3125, 390092.8125,
        390110.2500, 777558.4375, 780601.8750, 788432.8125, 808540.7500])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.1843e+00, 3.3278e+00, 3.3615e+00, 3.6304e+00, 3.8669e+05,
        3.8902e+05, 3.9008e+05, 3.9037e+05, 3.9097e+05])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['497546.09', '494202.19', '166545.88', '496427.47', '166555.61', '166551.20', '166552.17', '501720.28', '501228.72', '166544.39']
estimated f for each client, fs: [2, 2, 5, 3, 5, 5, 5, 2, 3, 5]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']], selected_client_indices: [19, 13, 3, 15, 5, 1, 12, 18, 20, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0058s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:19...
global Accuracy on shared test data: 53.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[127 110]
 [124 139]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:19, End: 2025-07-22 15:46:19)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [18], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
rkrum, clients_type: ['Chosen Update'], selected_client_indices: [18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0000s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:19...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[138  99]
 [157 106]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:46:19, End: 2025-07-22 15:46:19)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [19, 7, 11, 12, 18, 4, 8, 17, 3, 14, 1, 6, 13, 20, 16, 10, 15, 5], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.8279e+05, 3.8280e+05, 3.8272e+05, 7.7708e+05, 3.8282e+05,
         3.8278e+05, 7.5898e+05, 3.8276e+05, 7.6393e+05, 3.8275e+05, 3.8276e+05,
         7.8031e+05, 7.8183e+05, 7.6577e+05, 3.8282e+05, 7.6460e+05, 3.8278e+05],
        [3.8279e+05, 0.0000e+00, 3.5104e+00, 3.6293e+00, 4.0239e+05, 3.6332e+00,
         3.8359e+00, 3.9632e+05, 3.8350e+00, 3.8680e+05, 3.7863e+00, 3.7577e+00,
         4.0427e+05, 3.9632e+05, 3.8039e+05, 3.7816e+00, 3.9089e+05, 3.5128e+00],
        [3.8280e+05, 3.5104e+00, 0.0000e+00, 3.3580e+00, 4.0239e+05, 3.4217e+00,
         3.8566e+00, 3.9630e+05, 3.9905e+00, 3.8676e+05, 3.5917e+00, 3.3828e+00,
         4.0424e+05, 3.9630e+05, 3.8044e+05, 3.6428e+00, 3.9089e+05, 3.5869e+00],
        [3.8272e+05, 3.6293e+00, 3.3580e+00, 0.0000e+00, 4.0235e+05, 3.9525e+00,
         3.9448e+00, 3.9627e+05, 3.9381e+00, 3.8675e+05, 3.7865e+00, 3.5398e+00,
         4.0420e+05, 3.9628e+05, 3.8042e+05, 3.7297e+00, 3.9087e+05, 3.4159e+00],
        [7.7708e+05, 4.0239e+05, 4.0239e+05, 4.0235e+05, 0.0000e+00, 4.0235e+05,
         4.0240e+05, 7.6914e+05, 4.0235e+05, 7.9971e+05, 4.0241e+05, 4.0240e+05,
         8.0874e+05, 8.1860e+05, 7.8607e+05, 4.0239e+05, 7.9618e+05, 4.0238e+05],
        [3.8282e+05, 3.6332e+00, 3.4217e+00, 3.9525e+00, 4.0235e+05, 0.0000e+00,
         3.6006e+00, 3.9633e+05, 3.7477e+00, 3.8676e+05, 3.4936e+00, 3.6890e+00,
         4.0422e+05, 3.9634e+05, 3.8042e+05, 3.5271e+00, 3.9095e+05, 3.5085e+00],
        [3.8278e+05, 3.8359e+00, 3.8566e+00, 3.9448e+00, 4.0240e+05, 3.6006e+00,
         0.0000e+00, 3.9630e+05, 3.6713e+00, 3.8678e+05, 3.9031e+00, 3.9392e+00,
         4.0419e+05, 3.9632e+05, 3.8039e+05, 3.6690e+00, 3.9087e+05, 3.7723e+00],
        [7.5898e+05, 3.9632e+05, 3.9630e+05, 3.9627e+05, 7.6914e+05, 3.9633e+05,
         3.9630e+05, 0.0000e+00, 3.9636e+05, 7.9372e+05, 3.9632e+05, 3.9630e+05,
         8.1407e+05, 7.8957e+05, 7.5882e+05, 3.9622e+05, 8.0878e+05, 3.9630e+05],
        [3.8276e+05, 3.8350e+00, 3.9905e+00, 3.9381e+00, 4.0235e+05, 3.7477e+00,
         3.6713e+00, 3.9636e+05, 0.0000e+00, 3.8675e+05, 3.5511e+00, 3.7995e+00,
         4.0415e+05, 3.9632e+05, 3.8041e+05, 3.7697e+00, 3.9091e+05, 3.6884e+00],
        [7.6393e+05, 3.8680e+05, 3.8676e+05, 3.8675e+05, 7.9971e+05, 3.8676e+05,
         3.8678e+05, 7.9372e+05, 3.8675e+05, 0.0000e+00, 3.8673e+05, 3.8680e+05,
         7.9964e+05, 7.5984e+05, 7.6740e+05, 3.8679e+05, 7.6865e+05, 3.8677e+05],
        [3.8275e+05, 3.7863e+00, 3.5917e+00, 3.7865e+00, 4.0241e+05, 3.4936e+00,
         3.9031e+00, 3.9632e+05, 3.5511e+00, 3.8673e+05, 0.0000e+00, 3.4557e+00,
         4.0424e+05, 3.9631e+05, 3.8037e+05, 3.7608e+00, 3.9087e+05, 3.7267e+00],
        [3.8276e+05, 3.7577e+00, 3.3828e+00, 3.5398e+00, 4.0240e+05, 3.6890e+00,
         3.9392e+00, 3.9630e+05, 3.7995e+00, 3.8680e+05, 3.4557e+00, 0.0000e+00,
         4.0421e+05, 3.9631e+05, 3.8043e+05, 3.7037e+00, 3.9090e+05, 3.7437e+00],
        [7.8031e+05, 4.0427e+05, 4.0424e+05, 4.0420e+05, 8.0874e+05, 4.0422e+05,
         4.0419e+05, 8.1407e+05, 4.0415e+05, 7.9964e+05, 4.0424e+05, 4.0421e+05,
         0.0000e+00, 7.9268e+05, 7.9243e+05, 4.0423e+05, 8.0748e+05, 4.0425e+05],
        [7.8183e+05, 3.9632e+05, 3.9630e+05, 3.9628e+05, 8.1860e+05, 3.9634e+05,
         3.9632e+05, 7.8957e+05, 3.9632e+05, 7.5984e+05, 3.9631e+05, 3.9631e+05,
         7.9268e+05, 0.0000e+00, 7.8387e+05, 3.9630e+05, 7.8850e+05, 3.9632e+05],
        [7.6577e+05, 3.8039e+05, 3.8044e+05, 3.8042e+05, 7.8607e+05, 3.8042e+05,
         3.8039e+05, 7.5882e+05, 3.8041e+05, 7.6740e+05, 3.8037e+05, 3.8043e+05,
         7.9243e+05, 7.8387e+05, 0.0000e+00, 3.8039e+05, 7.6816e+05, 3.8040e+05],
        [3.8282e+05, 3.7816e+00, 3.6428e+00, 3.7297e+00, 4.0239e+05, 3.5271e+00,
         3.6690e+00, 3.9622e+05, 3.7697e+00, 3.8679e+05, 3.7608e+00, 3.7037e+00,
         4.0423e+05, 3.9630e+05, 3.8039e+05, 0.0000e+00, 3.9092e+05, 3.7373e+00],
        [7.6460e+05, 3.9089e+05, 3.9089e+05, 3.9087e+05, 7.9618e+05, 3.9095e+05,
         3.9087e+05, 8.0878e+05, 3.9091e+05, 7.6865e+05, 3.9087e+05, 3.9090e+05,
         8.0748e+05, 7.8850e+05, 7.6816e+05, 3.9092e+05, 0.0000e+00, 3.9092e+05],
        [3.8278e+05, 3.5128e+00, 3.5869e+00, 3.4159e+00, 4.0238e+05, 3.5085e+00,
         3.7723e+00, 3.9630e+05, 3.6884e+00, 3.8677e+05, 3.7267e+00, 3.7437e+00,
         4.0425e+05, 3.9632e+05, 3.8040e+05, 3.7373e+00, 3.9092e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 382718.6250, 382753.8125, 382758.2500, 382761.8125,
        382777.4375, 382781.1250, 382793.4375, 382802.7812, 382815.6875,
        382823.2500, 758978.9375, 763926.1250, 764604.2500, 765771.2500,
        777081.4375, 780310.1250, 781834.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5104e+00, 3.5128e+00, 3.6293e+00, 3.6332e+00, 3.7577e+00,
        3.7816e+00, 3.7863e+00, 3.8350e+00, 3.8359e+00, 3.8039e+05, 3.8279e+05,
        3.8680e+05, 3.9089e+05, 3.9632e+05, 3.9632e+05, 4.0239e+05, 4.0427e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3580e+00, 3.3828e+00, 3.4217e+00, 3.5104e+00, 3.5869e+00,
        3.5917e+00, 3.6428e+00, 3.8566e+00, 3.9905e+00, 3.8044e+05, 3.8280e+05,
        3.8676e+05, 3.9089e+05, 3.9630e+05, 3.9630e+05, 4.0239e+05, 4.0424e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3580e+00, 3.4159e+00, 3.5398e+00, 3.6293e+00, 3.7297e+00,
        3.7865e+00, 3.9381e+00, 3.9448e+00, 3.9525e+00, 3.8042e+05, 3.8272e+05,
        3.8675e+05, 3.9087e+05, 3.9627e+05, 3.9628e+05, 4.0235e+05, 4.0420e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 402345.2188, 402352.9062, 402354.4688, 402381.7500,
        402389.0000, 402390.9375, 402391.5938, 402395.0938, 402404.9688,
        402414.4375, 769143.7500, 777081.4375, 786070.1250, 796179.3750,
        799712.1250, 808738.8125, 818596.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4217e+00, 3.4936e+00, 3.5085e+00, 3.5271e+00, 3.6006e+00,
        3.6332e+00, 3.6890e+00, 3.7477e+00, 3.9525e+00, 3.8042e+05, 3.8282e+05,
        3.8676e+05, 3.9095e+05, 3.9633e+05, 3.9634e+05, 4.0235e+05, 4.0422e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6006e+00, 3.6690e+00, 3.6713e+00, 3.7723e+00, 3.8359e+00,
        3.8566e+00, 3.9031e+00, 3.9392e+00, 3.9448e+00, 3.8039e+05, 3.8278e+05,
        3.8678e+05, 3.9087e+05, 3.9630e+05, 3.9632e+05, 4.0240e+05, 4.0419e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396216.6875, 396272.4375, 396295.0625, 396298.7812,
        396301.5625, 396302.5938, 396323.8438, 396324.2500, 396328.2812,
        396359.0625, 758818.5625, 758978.9375, 769143.7500, 789569.2500,
        793716.3750, 808779.9375, 814071.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5511e+00, 3.6713e+00, 3.6884e+00, 3.7477e+00, 3.7697e+00,
        3.7995e+00, 3.8350e+00, 3.9381e+00, 3.9905e+00, 3.8041e+05, 3.8276e+05,
        3.8675e+05, 3.9091e+05, 3.9632e+05, 3.9636e+05, 4.0235e+05, 4.0415e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386731.6875, 386752.4375, 386753.2188, 386758.8750,
        386760.7188, 386770.5312, 386780.0000, 386789.1562, 386796.3438,
        386804.9688, 759836.7500, 763926.1250, 767396.0000, 768646.0000,
        793716.3750, 799635.3750, 799712.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4557e+00, 3.4936e+00, 3.5511e+00, 3.5917e+00, 3.7267e+00,
        3.7608e+00, 3.7863e+00, 3.7865e+00, 3.9031e+00, 3.8037e+05, 3.8275e+05,
        3.8673e+05, 3.9087e+05, 3.9631e+05, 3.9632e+05, 4.0241e+05, 4.0424e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3828e+00, 3.4557e+00, 3.5398e+00, 3.6890e+00, 3.7037e+00,
        3.7437e+00, 3.7577e+00, 3.7995e+00, 3.9392e+00, 3.8043e+05, 3.8276e+05,
        3.8680e+05, 3.9090e+05, 3.9630e+05, 3.9631e+05, 4.0240e+05, 4.0421e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 404154.7812, 404188.4375, 404198.1562, 404214.8125,
        404224.1250, 404230.2812, 404236.2188, 404237.0938, 404247.6562,
        404274.5625, 780310.1250, 792427.6875, 792681.7500, 799635.3750,
        807481.8125, 808738.8125, 814071.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396280.5625, 396300.5938, 396304.6562, 396307.5000,
        396310.9062, 396315.5938, 396318.7500, 396319.5938, 396324.9688,
        396342.9062, 759836.7500, 781834.3750, 783871.5625, 788499.1250,
        789569.2500, 792681.7500, 818596.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 380374.8438, 380388.0625, 380394.5312, 380394.8438,
        380397.0000, 380405.5625, 380417.4062, 380419.3750, 380430.8750,
        380439.0938, 758818.5625, 765771.2500, 767396.0000, 768160.6875,
        783871.5625, 786070.1250, 792427.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5271e+00, 3.6428e+00, 3.6690e+00, 3.7037e+00, 3.7297e+00,
        3.7373e+00, 3.7608e+00, 3.7697e+00, 3.7816e+00, 3.8039e+05, 3.8282e+05,
        3.8679e+05, 3.9092e+05, 3.9622e+05, 3.9630e+05, 4.0239e+05, 4.0423e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 390867.0000, 390868.7812, 390872.2188, 390887.5000,
        390894.8750, 390896.4062, 390910.6875, 390915.2812, 390921.9375,
        390947.2188, 764604.2500, 768160.6875, 768646.0000, 788499.1250,
        796179.3750, 807481.8125, 808779.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4159e+00, 3.5085e+00, 3.5128e+00, 3.5869e+00, 3.6884e+00,
        3.7267e+00, 3.7373e+00, 3.7437e+00, 3.7723e+00, 3.8040e+05, 3.8278e+05,
        3.8677e+05, 3.9092e+05, 3.9630e+05, 3.9632e+05, 4.0238e+05, 4.0425e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['416978.66', '69383.76', '69388.57', '69379.02', '435724.03', '69387.96', '69382.41', '429258.25', '69381.94', '420684.94', '69378.34', '69383.82', '438410.47', '429360.19', '414807.25', '69385.88', '424871.44', '69382.79']
estimated f for each client, fs: [6, 8, 8, 8, 6, 8, 8, 6, 8, 6, 8, 8, 6, 6, 6, 8, 6, 8]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [19, 7, 11, 12, 18, 4, 8, 17, 3, 14, 1, 6, 13, 20, 16, 10, 15, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0127s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:20...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[137 100]
 [153 110]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:20, End: 2025-07-22 15:46:20)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [8, 2, 16, 10, 1, 3, 7, 14, 13, 4, 18, 9, 19, 12, 5, 11], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0403e+00, 4.0181e+05, 3.5944e+00, 3.8810e+00, 3.7379e+00,
         3.8525e+00, 3.9075e+05, 3.7960e+05, 3.6201e+00, 3.8381e+05, 4.2174e+00,
         3.9602e+05, 3.9854e+00, 3.7764e+00, 3.9073e+00],
        [4.0403e+00, 0.0000e+00, 4.0184e+05, 3.7526e+00, 3.5864e+00, 3.7357e+00,
         3.7477e+00, 3.9070e+05, 3.7957e+05, 3.8240e+00, 3.8386e+05, 4.1394e+00,
         3.9610e+05, 3.8545e+00, 3.6080e+00, 3.6714e+00],
        [4.0181e+05, 4.0184e+05, 0.0000e+00, 4.0179e+05, 4.0179e+05, 4.0181e+05,
         4.0181e+05, 8.3033e+05, 7.6843e+05, 4.0183e+05, 7.7063e+05, 4.0178e+05,
         7.8754e+05, 4.0182e+05, 4.0181e+05, 4.0179e+05],
        [3.5944e+00, 3.7526e+00, 4.0179e+05, 0.0000e+00, 3.6649e+00, 3.7650e+00,
         3.7019e+00, 3.9075e+05, 3.7956e+05, 3.4996e+00, 3.8383e+05, 3.8916e+00,
         3.9605e+05, 3.7196e+00, 3.7515e+00, 3.6313e+00],
        [3.8810e+00, 3.5864e+00, 4.0179e+05, 3.6649e+00, 0.0000e+00, 3.6094e+00,
         3.6734e+00, 3.9076e+05, 3.7960e+05, 3.4775e+00, 3.8383e+05, 3.9175e+00,
         3.9612e+05, 3.7758e+00, 3.7227e+00, 3.5233e+00],
        [3.7379e+00, 3.7357e+00, 4.0181e+05, 3.7650e+00, 3.6094e+00, 0.0000e+00,
         3.8700e+00, 3.9077e+05, 3.7957e+05, 3.7328e+00, 3.8386e+05, 4.2250e+00,
         3.9604e+05, 3.9325e+00, 3.7659e+00, 3.9997e+00],
        [3.8525e+00, 3.7477e+00, 4.0181e+05, 3.7019e+00, 3.6734e+00, 3.8700e+00,
         0.0000e+00, 3.9074e+05, 3.7954e+05, 3.5785e+00, 3.8383e+05, 4.2393e+00,
         3.9609e+05, 3.6297e+00, 3.5318e+00, 3.4761e+00],
        [3.9075e+05, 3.9070e+05, 8.3033e+05, 3.9075e+05, 3.9076e+05, 3.9077e+05,
         3.9074e+05, 0.0000e+00, 7.8261e+05, 3.9075e+05, 7.8098e+05, 3.9073e+05,
         7.9272e+05, 3.9077e+05, 3.9074e+05, 3.9075e+05],
        [3.7960e+05, 3.7957e+05, 7.6843e+05, 3.7956e+05, 3.7960e+05, 3.7957e+05,
         3.7954e+05, 7.8261e+05, 0.0000e+00, 3.7955e+05, 7.8503e+05, 3.7954e+05,
         8.0299e+05, 3.7957e+05, 3.7958e+05, 3.7954e+05],
        [3.6201e+00, 3.8240e+00, 4.0183e+05, 3.4996e+00, 3.4775e+00, 3.7328e+00,
         3.5785e+00, 3.9075e+05, 3.7955e+05, 0.0000e+00, 3.8380e+05, 3.5260e+00,
         3.9607e+05, 3.9728e+00, 3.4634e+00, 3.4412e+00],
        [3.8381e+05, 3.8386e+05, 7.7063e+05, 3.8383e+05, 3.8383e+05, 3.8386e+05,
         3.8383e+05, 7.8098e+05, 7.8503e+05, 3.8380e+05, 0.0000e+00, 3.8391e+05,
         7.7796e+05, 3.8386e+05, 3.8381e+05, 3.8383e+05],
        [4.2174e+00, 4.1394e+00, 4.0178e+05, 3.8916e+00, 3.9175e+00, 4.2250e+00,
         4.2393e+00, 3.9073e+05, 3.7954e+05, 3.5260e+00, 3.8391e+05, 0.0000e+00,
         3.9611e+05, 4.0419e+00, 4.1362e+00, 3.6386e+00],
        [3.9602e+05, 3.9610e+05, 7.8754e+05, 3.9605e+05, 3.9612e+05, 3.9604e+05,
         3.9609e+05, 7.9272e+05, 8.0299e+05, 3.9607e+05, 7.7796e+05, 3.9611e+05,
         0.0000e+00, 3.9607e+05, 3.9603e+05, 3.9607e+05],
        [3.9854e+00, 3.8545e+00, 4.0182e+05, 3.7196e+00, 3.7758e+00, 3.9325e+00,
         3.6297e+00, 3.9077e+05, 3.7957e+05, 3.9728e+00, 3.8386e+05, 4.0419e+00,
         3.9607e+05, 0.0000e+00, 3.4766e+00, 3.4182e+00],
        [3.7764e+00, 3.6080e+00, 4.0181e+05, 3.7515e+00, 3.7227e+00, 3.7659e+00,
         3.5318e+00, 3.9074e+05, 3.7958e+05, 3.4634e+00, 3.8381e+05, 4.1362e+00,
         3.9603e+05, 3.4766e+00, 0.0000e+00, 3.6050e+00],
        [3.9073e+00, 3.6714e+00, 4.0179e+05, 3.6313e+00, 3.5233e+00, 3.9997e+00,
         3.4761e+00, 3.9075e+05, 3.7954e+05, 3.4412e+00, 3.8383e+05, 3.6386e+00,
         3.9607e+05, 3.4182e+00, 3.6050e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.5944e+00, 3.6201e+00, 3.7379e+00, 3.7764e+00, 3.8525e+00,
        3.8810e+00, 3.9073e+00, 3.9854e+00, 4.0403e+00, 4.2174e+00, 3.7960e+05,
        3.8381e+05, 3.9075e+05, 3.9602e+05, 4.0181e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5864e+00, 3.6080e+00, 3.6714e+00, 3.7357e+00, 3.7477e+00,
        3.7526e+00, 3.8240e+00, 3.8545e+00, 4.0403e+00, 4.1394e+00, 3.7957e+05,
        3.8386e+05, 3.9070e+05, 3.9610e+05, 4.0184e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401775.2500, 401788.1250, 401791.2500, 401791.8438,
        401807.8438, 401810.1562, 401812.8750, 401812.8750, 401815.5625,
        401832.7500, 401843.3750, 768431.0625, 770627.1875, 787540.7500,
        830334.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4996e+00, 3.5944e+00, 3.6313e+00, 3.6649e+00, 3.7019e+00,
        3.7196e+00, 3.7515e+00, 3.7526e+00, 3.7650e+00, 3.8916e+00, 3.7956e+05,
        3.8383e+05, 3.9075e+05, 3.9605e+05, 4.0179e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4775e+00, 3.5233e+00, 3.5864e+00, 3.6094e+00, 3.6649e+00,
        3.6734e+00, 3.7227e+00, 3.7758e+00, 3.8810e+00, 3.9175e+00, 3.7960e+05,
        3.8383e+05, 3.9076e+05, 3.9612e+05, 4.0179e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6094e+00, 3.7328e+00, 3.7357e+00, 3.7379e+00, 3.7650e+00,
        3.7659e+00, 3.8700e+00, 3.9325e+00, 3.9997e+00, 4.2250e+00, 3.7957e+05,
        3.8386e+05, 3.9077e+05, 3.9604e+05, 4.0181e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4761e+00, 3.5318e+00, 3.5785e+00, 3.6297e+00, 3.6734e+00,
        3.7019e+00, 3.7477e+00, 3.8525e+00, 3.8700e+00, 4.2393e+00, 3.7954e+05,
        3.8383e+05, 3.9074e+05, 3.9609e+05, 4.0181e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390701.4062, 390729.9688, 390737.4688, 390740.5938,
        390747.5938, 390750.1250, 390750.5625, 390754.9688, 390762.4375,
        390770.6875, 390770.9688, 780977.9375, 782608.3125, 792715.8750,
        830334.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 379537.4688, 379538.9688, 379539.1250, 379548.9688,
        379556.6250, 379566.7812, 379570.5312, 379571.0000, 379575.5625,
        379602.1250, 379604.1875, 768431.0625, 782608.3125, 785028.0000,
        802994.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4412e+00, 3.4634e+00, 3.4775e+00, 3.4996e+00, 3.5260e+00,
        3.5785e+00, 3.6201e+00, 3.7328e+00, 3.8240e+00, 3.9728e+00, 3.7955e+05,
        3.8380e+05, 3.9075e+05, 3.9607e+05, 4.0183e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383803.5938, 383810.7188, 383814.4688, 383826.7500,
        383829.8125, 383832.5625, 383833.6562, 383857.2500, 383861.1250,
        383862.5000, 383907.5625, 770627.1875, 777956.8125, 780977.9375,
        785028.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5260e+00, 3.6386e+00, 3.8916e+00, 3.9175e+00, 4.0419e+00,
        4.1362e+00, 4.1394e+00, 4.2174e+00, 4.2250e+00, 4.2393e+00, 3.7954e+05,
        3.8391e+05, 3.9073e+05, 3.9611e+05, 4.0178e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396017.4375, 396034.3125, 396043.8750, 396049.3125,
        396065.4062, 396070.7500, 396071.4688, 396085.3750, 396095.1250,
        396114.9688, 396122.7188, 777956.8125, 787540.7500, 792715.8750,
        802994.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4182e+00, 3.4766e+00, 3.6297e+00, 3.7196e+00, 3.7758e+00,
        3.8545e+00, 3.9325e+00, 3.9728e+00, 3.9854e+00, 4.0419e+00, 3.7957e+05,
        3.8386e+05, 3.9077e+05, 3.9607e+05, 4.0182e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4634e+00, 3.4766e+00, 3.5318e+00, 3.6050e+00, 3.6080e+00,
        3.7227e+00, 3.7515e+00, 3.7659e+00, 3.7764e+00, 4.1362e+00, 3.7958e+05,
        3.8381e+05, 3.9074e+05, 3.9603e+05, 4.0181e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4182e+00, 3.4412e+00, 3.4761e+00, 3.5233e+00, 3.6050e+00,
        3.6313e+00, 3.6386e+00, 3.6714e+00, 3.9073e+00, 3.9997e+00, 3.7954e+05,
        3.8383e+05, 3.9075e+05, 3.9607e+05, 4.0179e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['3.86', '3.80', '401807.47', '3.70', '3.68', '3.84', '3.73', '390746.97', '379560.72', '3.61', '383833.25', '4.00', '396070.09', '3.78', '3.68', '3.63']
estimated f for each client, fs: [5, 5, 3, 5, 5, 5, 5, 3, 5, 5, 5, 5, 3, 5, 5, 5]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 2, 16, 10, 1, 3, 7, 14, 13, 4, 18, 9, 19, 12, 5, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0112s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:20...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[136 101]
 [152 111]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:20, End: 2025-07-22 15:46:20)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [9, 5, 12, 7, 6, 8, 14, 10, 4, 19, 15, 17, 11, 2], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 4.0651e+00, 4.0606e+00, 4.1373e+00, 3.9882e+00, 4.1488e+00,
         3.8970e+05, 3.8911e+00, 3.4088e+00, 3.8626e+05, 3.8313e+05, 4.1436e+05,
         3.6380e+00, 4.1018e+00],
        [4.0651e+00, 0.0000e+00, 3.4729e+00, 3.4837e+00, 3.8092e+00, 3.7708e+00,
         3.8965e+05, 3.8833e+00, 3.4977e+00, 3.8625e+05, 3.8310e+05, 4.1434e+05,
         3.6173e+00, 3.6513e+00],
        [4.0606e+00, 3.4729e+00, 0.0000e+00, 3.5620e+00, 3.5029e+00, 3.9865e+00,
         3.8971e+05, 3.7641e+00, 3.9511e+00, 3.8627e+05, 3.8312e+05, 4.1433e+05,
         3.4442e+00, 3.9082e+00],
        [4.1373e+00, 3.4837e+00, 3.5620e+00, 0.0000e+00, 3.6819e+00, 3.8441e+00,
         3.8971e+05, 3.7302e+00, 3.5874e+00, 3.8627e+05, 3.8313e+05, 4.1440e+05,
         3.4554e+00, 3.7667e+00],
        [3.9882e+00, 3.8092e+00, 3.5029e+00, 3.6819e+00, 0.0000e+00, 3.8819e+00,
         3.8966e+05, 3.7163e+00, 3.8176e+00, 3.8628e+05, 3.8313e+05, 4.1435e+05,
         3.5172e+00, 3.5686e+00],
        [4.1488e+00, 3.7708e+00, 3.9865e+00, 3.8441e+00, 3.8819e+00, 0.0000e+00,
         3.8967e+05, 3.6356e+00, 3.7462e+00, 3.8626e+05, 3.8310e+05, 4.1433e+05,
         3.9122e+00, 4.0526e+00],
        [3.8970e+05, 3.8965e+05, 3.8971e+05, 3.8971e+05, 3.8966e+05, 3.8967e+05,
         0.0000e+00, 3.8970e+05, 3.8969e+05, 7.8481e+05, 7.6658e+05, 7.9791e+05,
         3.8969e+05, 3.8966e+05],
        [3.8911e+00, 3.8833e+00, 3.7641e+00, 3.7302e+00, 3.7163e+00, 3.6356e+00,
         3.8970e+05, 0.0000e+00, 3.6210e+00, 3.8630e+05, 3.8309e+05, 4.1442e+05,
         3.7328e+00, 3.8882e+00],
        [3.4088e+00, 3.4977e+00, 3.9511e+00, 3.5874e+00, 3.8176e+00, 3.7462e+00,
         3.8969e+05, 3.6210e+00, 0.0000e+00, 3.8623e+05, 3.8311e+05, 4.1435e+05,
         3.5222e+00, 3.8887e+00],
        [3.8626e+05, 3.8625e+05, 3.8627e+05, 3.8627e+05, 3.8628e+05, 3.8626e+05,
         7.8481e+05, 3.8630e+05, 3.8623e+05, 0.0000e+00, 7.5835e+05, 8.0223e+05,
         3.8626e+05, 3.8621e+05],
        [3.8313e+05, 3.8310e+05, 3.8312e+05, 3.8313e+05, 3.8313e+05, 3.8310e+05,
         7.6658e+05, 3.8309e+05, 3.8311e+05, 7.5835e+05, 0.0000e+00, 8.0636e+05,
         3.8312e+05, 3.8314e+05],
        [4.1436e+05, 4.1434e+05, 4.1433e+05, 4.1440e+05, 4.1435e+05, 4.1433e+05,
         7.9791e+05, 4.1442e+05, 4.1435e+05, 8.0223e+05, 8.0636e+05, 0.0000e+00,
         4.1435e+05, 4.1432e+05],
        [3.6380e+00, 3.6173e+00, 3.4442e+00, 3.4554e+00, 3.5172e+00, 3.9122e+00,
         3.8969e+05, 3.7328e+00, 3.5222e+00, 3.8626e+05, 3.8312e+05, 4.1435e+05,
         0.0000e+00, 3.7293e+00],
        [4.1018e+00, 3.6513e+00, 3.9082e+00, 3.7667e+00, 3.5686e+00, 4.0526e+00,
         3.8966e+05, 3.8882e+00, 3.8887e+00, 3.8621e+05, 3.8314e+05, 4.1432e+05,
         3.7293e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.4088e+00, 3.6380e+00, 3.8911e+00, 3.9882e+00, 4.0606e+00,
        4.0651e+00, 4.1018e+00, 4.1373e+00, 4.1488e+00, 3.8313e+05, 3.8626e+05,
        3.8970e+05, 4.1436e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4729e+00, 3.4837e+00, 3.4977e+00, 3.6173e+00, 3.6513e+00,
        3.7708e+00, 3.8092e+00, 3.8833e+00, 4.0651e+00, 3.8310e+05, 3.8625e+05,
        3.8965e+05, 4.1434e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4442e+00, 3.4729e+00, 3.5029e+00, 3.5620e+00, 3.7641e+00,
        3.9082e+00, 3.9511e+00, 3.9865e+00, 4.0606e+00, 3.8312e+05, 3.8627e+05,
        3.8971e+05, 4.1433e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4554e+00, 3.4837e+00, 3.5620e+00, 3.5874e+00, 3.6819e+00,
        3.7302e+00, 3.7667e+00, 3.8441e+00, 4.1373e+00, 3.8313e+05, 3.8627e+05,
        3.8971e+05, 4.1440e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5029e+00, 3.5172e+00, 3.5686e+00, 3.6819e+00, 3.7163e+00,
        3.8092e+00, 3.8176e+00, 3.8819e+00, 3.9882e+00, 3.8313e+05, 3.8628e+05,
        3.8966e+05, 4.1435e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.6356e+00, 3.7462e+00, 3.7708e+00, 3.8441e+00, 3.8819e+00,
        3.9122e+00, 3.9865e+00, 4.0526e+00, 4.1488e+00, 3.8310e+05, 3.8626e+05,
        3.8967e+05, 4.1433e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389647.4062, 389655.6250, 389658.2188, 389674.2500,
        389691.3125, 389694.1875, 389697.1562, 389697.2500, 389708.1250,
        389710.2500, 766581.5625, 784811.9375, 797912.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6210e+00, 3.6356e+00, 3.7163e+00, 3.7302e+00, 3.7328e+00,
        3.7641e+00, 3.8833e+00, 3.8882e+00, 3.8911e+00, 3.8309e+05, 3.8630e+05,
        3.8970e+05, 4.1442e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4088e+00, 3.4977e+00, 3.5222e+00, 3.5874e+00, 3.6210e+00,
        3.7462e+00, 3.8176e+00, 3.8887e+00, 3.9511e+00, 3.8311e+05, 3.8623e+05,
        3.8969e+05, 4.1435e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386206.3125, 386228.0312, 386253.5312, 386255.7500,
        386261.6250, 386264.5000, 386272.5938, 386273.8125, 386277.4375,
        386299.2812, 758352.6250, 784811.9375, 802233.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383094.0625, 383099.8125, 383102.6562, 383109.9688,
        383116.6875, 383118.2812, 383126.4375, 383130.0000, 383134.8750,
        383136.9688, 758352.6250, 766581.5625, 806357.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 414324.7188, 414326.2812, 414328.8438, 414344.1562,
        414346.8438, 414346.9688, 414350.2812, 414365.0000, 414398.6875,
        414416.4062, 797912.1250, 802233.5000, 806357.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4442e+00, 3.4554e+00, 3.5172e+00, 3.5222e+00, 3.6173e+00,
        3.6380e+00, 3.7293e+00, 3.7328e+00, 3.9122e+00, 3.8312e+05, 3.8626e+05,
        3.8969e+05, 4.1435e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.5686e+00, 3.6513e+00, 3.7293e+00, 3.7667e+00, 3.8882e+00,
        3.8887e+00, 3.9082e+00, 4.0526e+00, 4.1018e+00, 3.8314e+05, 3.8621e+05,
        3.8966e+05, 4.1432e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['3.94', '3.69', '3.74', '3.69', '3.72', '3.89', '389683.34', '3.76', '3.67', '386259.25', '383116.97', '414354.81', '3.62', '3.84']
estimated f for each client, fs: [4, 4, 4, 4, 4, 4, 2, 4, 4, 2, 2, 2, 4, 4]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']], selected_client_indices: [9, 5, 12, 7, 6, 8, 14, 10, 4, 19, 15, 17, 11, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0212s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:21...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[135 102]
 [149 114]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:21, End: 2025-07-22 15:46:21)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [19], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
rkrum, clients_type: ['Chosen Update'], selected_client_indices: [19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0000s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:21...
global Accuracy on shared test data: 50.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[213  24]
 [225  38]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:46:21, End: 2025-07-22 15:46:21)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [1, 2, 8, 11, 19, 16, 9, 12, 3, 17, 20, 7, 15, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.1929e+00, 3.7537e+00, 3.2434e+00, 3.9213e+05, 3.8955e+05,
         3.5121e+00, 3.5439e+00, 4.0369e+00, 3.8732e+05, 4.0097e+05, 3.3580e+00,
         3.9931e+05, 3.7560e+00],
        [3.1929e+00, 0.0000e+00, 3.8101e+00, 3.4874e+00, 3.9216e+05, 3.8960e+05,
         3.5951e+00, 3.8683e+00, 3.8486e+00, 3.8733e+05, 4.0095e+05, 3.4868e+00,
         3.9924e+05, 3.2578e+00],
        [3.7537e+00, 3.8101e+00, 0.0000e+00, 3.4020e+00, 3.9212e+05, 3.8953e+05,
         3.6257e+00, 3.5044e+00, 4.1389e+00, 3.8732e+05, 4.0100e+05, 3.6105e+00,
         3.9924e+05, 3.7875e+00],
        [3.2434e+00, 3.4874e+00, 3.4020e+00, 0.0000e+00, 3.9217e+05, 3.8953e+05,
         3.1818e+00, 3.5052e+00, 3.8794e+00, 3.8735e+05, 4.0094e+05, 3.2484e+00,
         3.9923e+05, 3.4945e+00],
        [3.9213e+05, 3.9216e+05, 3.9212e+05, 3.9217e+05, 0.0000e+00, 7.6862e+05,
         3.9209e+05, 3.9221e+05, 3.9216e+05, 7.8057e+05, 7.8782e+05, 3.9222e+05,
         7.9394e+05, 3.9222e+05],
        [3.8955e+05, 3.8960e+05, 3.8953e+05, 3.8953e+05, 7.6862e+05, 0.0000e+00,
         3.8954e+05, 3.8956e+05, 3.8959e+05, 7.6849e+05, 7.7895e+05, 3.8952e+05,
         8.0042e+05, 3.8956e+05],
        [3.5121e+00, 3.5951e+00, 3.6257e+00, 3.1818e+00, 3.9209e+05, 3.8954e+05,
         0.0000e+00, 3.8760e+00, 4.0102e+00, 3.8739e+05, 4.0097e+05, 3.7506e+00,
         3.9925e+05, 3.6458e+00],
        [3.5439e+00, 3.8683e+00, 3.5044e+00, 3.5052e+00, 3.9221e+05, 3.8956e+05,
         3.8760e+00, 0.0000e+00, 4.1613e+00, 3.8731e+05, 4.0091e+05, 3.4241e+00,
         3.9928e+05, 4.0143e+00],
        [4.0369e+00, 3.8486e+00, 4.1389e+00, 3.8794e+00, 3.9216e+05, 3.8959e+05,
         4.0102e+00, 4.1613e+00, 0.0000e+00, 3.8737e+05, 4.0096e+05, 3.7801e+00,
         3.9924e+05, 3.6217e+00],
        [3.8732e+05, 3.8733e+05, 3.8732e+05, 3.8735e+05, 7.8057e+05, 7.6849e+05,
         3.8739e+05, 3.8731e+05, 3.8737e+05, 0.0000e+00, 8.0542e+05, 3.8735e+05,
         7.8605e+05, 3.8735e+05],
        [4.0097e+05, 4.0095e+05, 4.0100e+05, 4.0094e+05, 7.8782e+05, 7.7895e+05,
         4.0097e+05, 4.0091e+05, 4.0096e+05, 8.0542e+05, 0.0000e+00, 4.0093e+05,
         7.8664e+05, 4.0099e+05],
        [3.3580e+00, 3.4868e+00, 3.6105e+00, 3.2484e+00, 3.9222e+05, 3.8952e+05,
         3.7506e+00, 3.4241e+00, 3.7801e+00, 3.8735e+05, 4.0093e+05, 0.0000e+00,
         3.9927e+05, 3.6627e+00],
        [3.9931e+05, 3.9924e+05, 3.9924e+05, 3.9923e+05, 7.9394e+05, 8.0042e+05,
         3.9925e+05, 3.9928e+05, 3.9924e+05, 7.8605e+05, 7.8664e+05, 3.9927e+05,
         0.0000e+00, 3.9924e+05],
        [3.7560e+00, 3.2578e+00, 3.7875e+00, 3.4945e+00, 3.9222e+05, 3.8956e+05,
         3.6458e+00, 4.0143e+00, 3.6217e+00, 3.8735e+05, 4.0099e+05, 3.6627e+00,
         3.9924e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.1929e+00, 3.2434e+00, 3.3580e+00, 3.5121e+00, 3.5439e+00,
        3.7537e+00, 3.7560e+00, 4.0369e+00, 3.8732e+05, 3.8955e+05, 3.9213e+05,
        3.9931e+05, 4.0097e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.1929e+00, 3.2578e+00, 3.4868e+00, 3.4874e+00, 3.5951e+00,
        3.8101e+00, 3.8486e+00, 3.8683e+00, 3.8733e+05, 3.8960e+05, 3.9216e+05,
        3.9924e+05, 4.0095e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4020e+00, 3.5044e+00, 3.6105e+00, 3.6257e+00, 3.7537e+00,
        3.7875e+00, 3.8101e+00, 4.1389e+00, 3.8732e+05, 3.8953e+05, 3.9212e+05,
        3.9924e+05, 4.0100e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.1818e+00, 3.2434e+00, 3.2484e+00, 3.4020e+00, 3.4874e+00,
        3.4945e+00, 3.5052e+00, 3.8794e+00, 3.8735e+05, 3.8953e+05, 3.9217e+05,
        3.9923e+05, 4.0094e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 392094.1562, 392120.1250, 392129.3750, 392156.8750,
        392160.1562, 392165.1250, 392212.5625, 392218.9062, 392222.0312,
        768624.0000, 780574.4375, 787823.6875, 793940.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389515.8750, 389530.0625, 389530.9688, 389543.4375,
        389545.1875, 389561.9062, 389564.8750, 389586.1250, 389599.7500,
        768490.3750, 768624.0000, 778951.0000, 800416.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.1818e+00, 3.5121e+00, 3.5951e+00, 3.6257e+00, 3.6458e+00,
        3.7506e+00, 3.8760e+00, 4.0102e+00, 3.8739e+05, 3.8954e+05, 3.9209e+05,
        3.9925e+05, 4.0097e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.4241e+00, 3.5044e+00, 3.5052e+00, 3.5439e+00, 3.8683e+00,
        3.8760e+00, 4.0143e+00, 4.1613e+00, 3.8731e+05, 3.8956e+05, 3.9221e+05,
        3.9928e+05, 4.0091e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.6217e+00, 3.7801e+00, 3.8486e+00, 3.8794e+00, 4.0102e+00,
        4.0369e+00, 4.1389e+00, 4.1613e+00, 3.8737e+05, 3.8959e+05, 3.9216e+05,
        3.9924e+05, 4.0096e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387306.2500, 387323.3750, 387324.9375, 387326.2500,
        387348.1875, 387350.2500, 387353.1875, 387373.1875, 387389.4688,
        768490.3750, 780574.4375, 786052.1250, 805423.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400910.7500, 400927.1250, 400944.5938, 400950.2500,
        400955.5625, 400970.8125, 400973.6875, 400988.8750, 400996.9375,
        778951.0000, 786635.3750, 787823.6875, 805423.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.2484e+00, 3.3580e+00, 3.4241e+00, 3.4868e+00, 3.6105e+00,
        3.6627e+00, 3.7506e+00, 3.7801e+00, 3.8735e+05, 3.8952e+05, 3.9222e+05,
        3.9927e+05, 4.0093e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 399233.5625, 399237.7188, 399239.2500, 399241.2500,
        399244.6250, 399252.2500, 399268.1250, 399275.9375, 399314.9375,
        786052.1250, 786635.3750, 793940.1875, 800416.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.2578e+00, 3.4945e+00, 3.6217e+00, 3.6458e+00, 3.6627e+00,
        3.7560e+00, 3.7875e+00, 4.0143e+00, 3.8735e+05, 3.8956e+05, 3.9222e+05,
        3.9924e+05, 4.0099e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['43039.09', '43039.42', '43039.39', '43041.96', '392164.38', '389553.09', '43046.52', '43037.34', '43044.96', '387343.88', '400957.62', '43042.39', '399256.41', '43041.93']
estimated f for each client, fs: [5, 5, 5, 5, 3, 3, 5, 5, 5, 3, 3, 5, 3, 5]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [1, 2, 8, 11, 19, 16, 9, 12, 3, 17, 20, 7, 15, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0091s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:21...
global Accuracy on shared test data: 50.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[209  28]
 [221  42]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:21, End: 2025-07-22 15:46:21)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 20, 17, 4, 6, 15, 3, 10, 11, 2, 18, 7, 5, 1, 8, 12, 13, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 8.1723e+05, 7.9212e+05, 4.0717e+05, 4.0712e+05, 7.9175e+05,
         4.0719e+05, 4.0714e+05, 4.0710e+05, 4.0714e+05, 8.0633e+05, 4.0715e+05,
         4.0712e+05, 4.0712e+05, 4.0710e+05, 4.0712e+05, 8.0031e+05, 4.0715e+05],
        [8.1723e+05, 0.0000e+00, 7.9721e+05, 4.0493e+05, 4.0493e+05, 8.1891e+05,
         4.0491e+05, 4.0493e+05, 4.0495e+05, 4.0494e+05, 8.1895e+05, 4.0490e+05,
         4.0488e+05, 4.0489e+05, 4.0495e+05, 4.0492e+05, 7.9182e+05, 4.0490e+05],
        [7.9212e+05, 7.9721e+05, 0.0000e+00, 3.9607e+05, 3.9608e+05, 7.9170e+05,
         3.9603e+05, 3.9601e+05, 3.9608e+05, 3.9608e+05, 7.8396e+05, 3.9603e+05,
         3.9605e+05, 3.9603e+05, 3.9604e+05, 3.9606e+05, 7.7668e+05, 3.9607e+05],
        [4.0717e+05, 4.0493e+05, 3.9607e+05, 0.0000e+00, 3.9587e+00, 4.0039e+05,
         3.7866e+00, 3.4896e+00, 3.2613e+00, 3.5163e+00, 3.9773e+05, 3.5491e+00,
         3.2247e+00, 3.1687e+00, 3.7038e+00, 3.3838e+00, 3.8748e+05, 3.5109e+00],
        [4.0712e+05, 4.0493e+05, 3.9608e+05, 3.9587e+00, 0.0000e+00, 4.0038e+05,
         3.6275e+00, 3.2453e+00, 3.5342e+00, 3.3038e+00, 3.9774e+05, 3.7321e+00,
         3.9161e+00, 3.7709e+00, 3.7434e+00, 4.1584e+00, 3.8752e+05, 3.6624e+00],
        [7.9175e+05, 8.1891e+05, 7.9170e+05, 4.0039e+05, 4.0038e+05, 0.0000e+00,
         4.0037e+05, 4.0045e+05, 4.0039e+05, 4.0039e+05, 7.9165e+05, 4.0043e+05,
         4.0037e+05, 4.0043e+05, 4.0040e+05, 4.0042e+05, 7.7918e+05, 4.0039e+05],
        [4.0719e+05, 4.0491e+05, 3.9603e+05, 3.7866e+00, 3.6275e+00, 4.0037e+05,
         0.0000e+00, 4.0207e+00, 3.9036e+00, 3.9718e+00, 3.9775e+05, 3.8633e+00,
         3.4695e+00, 4.1483e+00, 4.0318e+00, 4.1498e+00, 3.8754e+05, 4.0686e+00],
        [4.0714e+05, 4.0493e+05, 3.9601e+05, 3.4896e+00, 3.2453e+00, 4.0045e+05,
         4.0207e+00, 0.0000e+00, 3.4651e+00, 3.1911e+00, 3.9768e+05, 3.5018e+00,
         3.9584e+00, 3.5331e+00, 3.4422e+00, 3.6910e+00, 3.8751e+05, 3.4848e+00],
        [4.0710e+05, 4.0495e+05, 3.9608e+05, 3.2613e+00, 3.5342e+00, 4.0039e+05,
         3.9036e+00, 3.4651e+00, 0.0000e+00, 3.5428e+00, 3.9779e+05, 3.3828e+00,
         3.4280e+00, 3.2721e+00, 3.3605e+00, 3.6274e+00, 3.8755e+05, 3.2031e+00],
        [4.0714e+05, 4.0494e+05, 3.9608e+05, 3.5163e+00, 3.3038e+00, 4.0039e+05,
         3.9718e+00, 3.1911e+00, 3.5428e+00, 0.0000e+00, 3.9779e+05, 3.5655e+00,
         3.6917e+00, 3.4031e+00, 3.7126e+00, 3.9269e+00, 3.8750e+05, 3.6553e+00],
        [8.0633e+05, 8.1895e+05, 7.8396e+05, 3.9773e+05, 3.9774e+05, 7.9165e+05,
         3.9775e+05, 3.9768e+05, 3.9779e+05, 3.9779e+05, 0.0000e+00, 3.9771e+05,
         3.9772e+05, 3.9773e+05, 3.9772e+05, 3.9768e+05, 8.0083e+05, 3.9769e+05],
        [4.0715e+05, 4.0490e+05, 3.9603e+05, 3.5491e+00, 3.7321e+00, 4.0043e+05,
         3.8633e+00, 3.5018e+00, 3.3828e+00, 3.5655e+00, 3.9771e+05, 0.0000e+00,
         3.4475e+00, 3.4537e+00, 3.6329e+00, 3.5374e+00, 3.8753e+05, 3.8446e+00],
        [4.0712e+05, 4.0488e+05, 3.9605e+05, 3.2247e+00, 3.9161e+00, 4.0037e+05,
         3.4695e+00, 3.9584e+00, 3.4280e+00, 3.6917e+00, 3.9772e+05, 3.4475e+00,
         0.0000e+00, 3.5595e+00, 4.0157e+00, 3.7116e+00, 3.8752e+05, 3.6283e+00],
        [4.0712e+05, 4.0489e+05, 3.9603e+05, 3.1687e+00, 3.7709e+00, 4.0043e+05,
         4.1483e+00, 3.5331e+00, 3.2721e+00, 3.4031e+00, 3.9773e+05, 3.4537e+00,
         3.5595e+00, 0.0000e+00, 3.7316e+00, 3.6932e+00, 3.8755e+05, 3.5034e+00],
        [4.0710e+05, 4.0495e+05, 3.9604e+05, 3.7038e+00, 3.7434e+00, 4.0040e+05,
         4.0318e+00, 3.4422e+00, 3.3605e+00, 3.7126e+00, 3.9772e+05, 3.6329e+00,
         4.0157e+00, 3.7316e+00, 0.0000e+00, 3.5423e+00, 3.8750e+05, 3.6125e+00],
        [4.0712e+05, 4.0492e+05, 3.9606e+05, 3.3838e+00, 4.1584e+00, 4.0042e+05,
         4.1498e+00, 3.6910e+00, 3.6274e+00, 3.9269e+00, 3.9768e+05, 3.5374e+00,
         3.7116e+00, 3.6932e+00, 3.5423e+00, 0.0000e+00, 3.8749e+05, 4.0853e+00],
        [8.0031e+05, 7.9182e+05, 7.7668e+05, 3.8748e+05, 3.8752e+05, 7.7918e+05,
         3.8754e+05, 3.8751e+05, 3.8755e+05, 3.8750e+05, 8.0083e+05, 3.8753e+05,
         3.8752e+05, 3.8755e+05, 3.8750e+05, 3.8749e+05, 0.0000e+00, 3.8756e+05],
        [4.0715e+05, 4.0490e+05, 3.9607e+05, 3.5109e+00, 3.6624e+00, 4.0039e+05,
         4.0686e+00, 3.4848e+00, 3.2031e+00, 3.6553e+00, 3.9769e+05, 3.8446e+00,
         3.6283e+00, 3.5034e+00, 3.6125e+00, 4.0853e+00, 3.8756e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 407098.2500, 407104.0312, 407121.2500, 407122.5938,
        407123.1875, 407124.4688, 407135.1250, 407138.5938, 407150.7500,
        407154.3438, 407173.8750, 407192.9688, 791754.1250, 792123.1250,
        800305.6250, 806334.7500, 817228.3750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 404883.5625, 404888.5625, 404896.8438, 404903.5938,
        404914.7188, 404919.0625, 404927.0000, 404928.4375, 404933.7500,
        404940.5312, 404948.3750, 404954.0000, 791817.8125, 797209.9375,
        817228.3750, 818914.8750, 818951.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 396005.2188, 396028.0312, 396030.5625, 396034.7188,
        396039.8125, 396053.9062, 396063.4375, 396067.5000, 396071.8125,
        396078.7188, 396083.1250, 396084.2812, 776683.5000, 783957.2500,
        791703.8750, 792123.1250, 797209.9375])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.1687e+00, 3.2247e+00, 3.2613e+00, 3.3838e+00, 3.4896e+00,
        3.5109e+00, 3.5163e+00, 3.5491e+00, 3.7038e+00, 3.7866e+00, 3.9587e+00,
        3.8748e+05, 3.9607e+05, 3.9773e+05, 4.0039e+05, 4.0493e+05, 4.0717e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2453e+00, 3.3038e+00, 3.5342e+00, 3.6275e+00, 3.6624e+00,
        3.7321e+00, 3.7434e+00, 3.7709e+00, 3.9161e+00, 3.9587e+00, 4.1584e+00,
        3.8752e+05, 3.9608e+05, 3.9774e+05, 4.0038e+05, 4.0493e+05, 4.0712e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 400367.8750, 400371.5000, 400382.1250, 400386.9688,
        400387.8438, 400389.8125, 400393.3750, 400399.9375, 400415.6562,
        400427.6562, 400434.0312, 400453.0938, 779181.5000, 791649.8125,
        791703.8750, 791754.1250, 818914.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.4695e+00, 3.6275e+00, 3.7866e+00, 3.8633e+00, 3.9036e+00,
        3.9718e+00, 4.0207e+00, 4.0318e+00, 4.0686e+00, 4.1483e+00, 4.1498e+00,
        3.8754e+05, 3.9603e+05, 3.9775e+05, 4.0037e+05, 4.0491e+05, 4.0719e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.1911e+00, 3.2453e+00, 3.4422e+00, 3.4651e+00, 3.4848e+00,
        3.4896e+00, 3.5018e+00, 3.5331e+00, 3.6910e+00, 3.9584e+00, 4.0207e+00,
        3.8751e+05, 3.9601e+05, 3.9768e+05, 4.0045e+05, 4.0493e+05, 4.0714e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2031e+00, 3.2613e+00, 3.2721e+00, 3.3605e+00, 3.3828e+00,
        3.4280e+00, 3.4651e+00, 3.5342e+00, 3.5428e+00, 3.6274e+00, 3.9036e+00,
        3.8755e+05, 3.9608e+05, 3.9779e+05, 4.0039e+05, 4.0495e+05, 4.0710e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.1911e+00, 3.3038e+00, 3.4031e+00, 3.5163e+00, 3.5428e+00,
        3.5655e+00, 3.6553e+00, 3.6917e+00, 3.7126e+00, 3.9269e+00, 3.9718e+00,
        3.8750e+05, 3.9608e+05, 3.9779e+05, 4.0039e+05, 4.0494e+05, 4.0714e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397681.9688, 397683.5938, 397693.2188, 397713.3750,
        397719.2500, 397721.9062, 397725.4375, 397726.6250, 397743.2500,
        397748.6250, 397789.5000, 397791.1562, 783957.2500, 791649.8125,
        800833.6875, 806334.7500, 818951.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.3828e+00, 3.4475e+00, 3.4537e+00, 3.5018e+00, 3.5374e+00,
        3.5491e+00, 3.5655e+00, 3.6329e+00, 3.7321e+00, 3.8446e+00, 3.8633e+00,
        3.8753e+05, 3.9603e+05, 3.9771e+05, 4.0043e+05, 4.0490e+05, 4.0715e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2247e+00, 3.4280e+00, 3.4475e+00, 3.4695e+00, 3.5595e+00,
        3.6283e+00, 3.6917e+00, 3.7116e+00, 3.9161e+00, 3.9584e+00, 4.0157e+00,
        3.8752e+05, 3.9605e+05, 3.9772e+05, 4.0037e+05, 4.0488e+05, 4.0712e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.1687e+00, 3.2721e+00, 3.4031e+00, 3.4537e+00, 3.5034e+00,
        3.5331e+00, 3.5595e+00, 3.6932e+00, 3.7316e+00, 3.7709e+00, 4.1483e+00,
        3.8755e+05, 3.9603e+05, 3.9773e+05, 4.0043e+05, 4.0489e+05, 4.0712e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3605e+00, 3.4422e+00, 3.5423e+00, 3.6125e+00, 3.6329e+00,
        3.7038e+00, 3.7126e+00, 3.7316e+00, 3.7434e+00, 4.0157e+00, 4.0318e+00,
        3.8750e+05, 3.9604e+05, 3.9772e+05, 4.0040e+05, 4.0495e+05, 4.0710e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3838e+00, 3.5374e+00, 3.5423e+00, 3.6274e+00, 3.6910e+00,
        3.6932e+00, 3.7116e+00, 3.9269e+00, 4.0853e+00, 4.1498e+00, 4.1584e+00,
        3.8749e+05, 3.9606e+05, 3.9768e+05, 4.0042e+05, 4.0492e+05, 4.0712e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387484.3125, 387486.6250, 387499.1250, 387503.5625,
        387507.6562, 387515.2500, 387516.7500, 387533.3750, 387543.7188,
        387548.5625, 387549.2500, 387558.8125, 776683.5000, 779181.5000,
        791817.8125, 800305.6250, 800833.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2031e+00, 3.4848e+00, 3.5034e+00, 3.5109e+00, 3.6125e+00,
        3.6283e+00, 3.6553e+00, 3.6624e+00, 3.8446e+00, 4.0686e+00, 4.0853e+00,
        3.8756e+05, 3.9607e+05, 3.9769e+05, 4.0039e+05, 4.0490e+05, 4.0715e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['407136.59', '404919.84', '396053.44', '3.50', '3.70', '400400.75', '3.91', '3.55', '3.45', '3.59', '397728.09', '3.59', '3.64', '3.57', '3.68', '3.77', '387517.06', '3.66']
estimated f for each client, fs: [4, 4, 4, 6, 6, 4, 6, 6, 6, 6, 4, 6, 6, 6, 6, 6, 6, 6]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 20, 17, 4, 6, 15, 3, 10, 11, 2, 18, 7, 5, 1, 8, 12, 13, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0136s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:22...
global Accuracy on shared test data: 51.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[207  30]
 [214  49]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:22, End: 2025-07-22 15:46:22)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [6, 16, 9, 20, 12, 5, 8, 11, 15, 14, 17, 13, 4, 7, 3, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7731e+05, 3.6056e+00, 3.8913e+05, 4.1693e+00, 3.8962e+00,
         3.7654e+00, 3.4851e+00, 3.9812e+05, 4.0669e+05, 3.8272e+05, 3.8517e+05,
         3.9709e+00, 3.7189e+00, 3.6010e+00, 3.9698e+05],
        [3.7731e+05, 0.0000e+00, 3.7735e+05, 7.6520e+05, 3.7729e+05, 3.7727e+05,
         3.7730e+05, 3.7731e+05, 7.9367e+05, 7.8300e+05, 7.6001e+05, 7.6550e+05,
         3.7729e+05, 3.7726e+05, 3.7724e+05, 7.7119e+05],
        [3.6056e+00, 3.7735e+05, 0.0000e+00, 3.8915e+05, 4.1243e+00, 3.6071e+00,
         3.6629e+00, 3.1881e+00, 3.9807e+05, 4.0671e+05, 3.8275e+05, 3.8513e+05,
         3.5077e+00, 3.8340e+00, 4.0213e+00, 3.9691e+05],
        [3.8913e+05, 7.6520e+05, 3.8915e+05, 0.0000e+00, 3.8914e+05, 3.8916e+05,
         3.8919e+05, 3.8917e+05, 7.8097e+05, 7.9685e+05, 7.9354e+05, 7.5226e+05,
         3.8918e+05, 3.8914e+05, 3.8916e+05, 7.8772e+05],
        [4.1693e+00, 3.7729e+05, 4.1243e+00, 3.8914e+05, 0.0000e+00, 3.6519e+00,
         3.6443e+00, 3.7208e+00, 3.9806e+05, 4.0670e+05, 3.8269e+05, 3.8518e+05,
         3.4547e+00, 3.6674e+00, 4.1694e+00, 3.9694e+05],
        [3.8962e+00, 3.7727e+05, 3.6071e+00, 3.8916e+05, 3.6519e+00, 0.0000e+00,
         4.0584e+00, 3.4429e+00, 3.9810e+05, 4.0676e+05, 3.8268e+05, 3.8514e+05,
         3.2601e+00, 3.4135e+00, 3.5933e+00, 3.9686e+05],
        [3.7654e+00, 3.7730e+05, 3.6629e+00, 3.8919e+05, 3.6443e+00, 4.0584e+00,
         0.0000e+00, 3.4670e+00, 3.9806e+05, 4.0673e+05, 3.8272e+05, 3.8513e+05,
         3.7065e+00, 3.6992e+00, 4.1635e+00, 3.9694e+05],
        [3.4851e+00, 3.7731e+05, 3.1881e+00, 3.8917e+05, 3.7208e+00, 3.4429e+00,
         3.4670e+00, 0.0000e+00, 3.9809e+05, 4.0672e+05, 3.8271e+05, 3.8515e+05,
         3.3101e+00, 3.3903e+00, 3.9356e+00, 3.9691e+05],
        [3.9812e+05, 7.9367e+05, 3.9807e+05, 7.8097e+05, 3.9806e+05, 3.9810e+05,
         3.9806e+05, 3.9809e+05, 0.0000e+00, 8.0042e+05, 7.7037e+05, 8.1176e+05,
         3.9806e+05, 3.9811e+05, 3.9810e+05, 7.9069e+05],
        [4.0669e+05, 7.8300e+05, 4.0671e+05, 7.9685e+05, 4.0670e+05, 4.0676e+05,
         4.0673e+05, 4.0672e+05, 8.0042e+05, 0.0000e+00, 7.8065e+05, 7.7719e+05,
         4.0675e+05, 4.0663e+05, 4.0670e+05, 8.1603e+05],
        [3.8272e+05, 7.6001e+05, 3.8275e+05, 7.9354e+05, 3.8269e+05, 3.8268e+05,
         3.8272e+05, 3.8271e+05, 7.7037e+05, 7.8065e+05, 0.0000e+00, 7.5698e+05,
         3.8270e+05, 3.8271e+05, 3.8270e+05, 7.9866e+05],
        [3.8517e+05, 7.6550e+05, 3.8513e+05, 7.5226e+05, 3.8518e+05, 3.8514e+05,
         3.8513e+05, 3.8515e+05, 8.1176e+05, 7.7719e+05, 7.5698e+05, 0.0000e+00,
         3.8519e+05, 3.8507e+05, 3.8515e+05, 7.6811e+05],
        [3.9709e+00, 3.7729e+05, 3.5077e+00, 3.8918e+05, 3.4547e+00, 3.2601e+00,
         3.7065e+00, 3.3101e+00, 3.9806e+05, 4.0675e+05, 3.8270e+05, 3.8519e+05,
         0.0000e+00, 3.5023e+00, 3.8193e+00, 3.9690e+05],
        [3.7189e+00, 3.7726e+05, 3.8340e+00, 3.8914e+05, 3.6674e+00, 3.4135e+00,
         3.6992e+00, 3.3903e+00, 3.9811e+05, 4.0663e+05, 3.8271e+05, 3.8507e+05,
         3.5023e+00, 0.0000e+00, 3.8846e+00, 3.9694e+05],
        [3.6010e+00, 3.7724e+05, 4.0213e+00, 3.8916e+05, 4.1694e+00, 3.5933e+00,
         4.1635e+00, 3.9356e+00, 3.9810e+05, 4.0670e+05, 3.8270e+05, 3.8515e+05,
         3.8193e+00, 3.8846e+00, 0.0000e+00, 3.9691e+05],
        [3.9698e+05, 7.7119e+05, 3.9691e+05, 7.8772e+05, 3.9694e+05, 3.9686e+05,
         3.9694e+05, 3.9691e+05, 7.9069e+05, 8.1603e+05, 7.9866e+05, 7.6811e+05,
         3.9690e+05, 3.9694e+05, 3.9691e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.4851e+00, 3.6010e+00, 3.6056e+00, 3.7189e+00, 3.7654e+00,
        3.8962e+00, 3.9709e+00, 4.1693e+00, 3.7731e+05, 3.8272e+05, 3.8517e+05,
        3.8913e+05, 3.9698e+05, 3.9812e+05, 4.0669e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377243.6875, 377261.9375, 377274.8438, 377289.0312,
        377291.9688, 377297.7500, 377312.0000, 377314.9688, 377348.9375,
        760013.8750, 765201.6250, 765502.5625, 771187.4375, 783002.1250,
        793666.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.1881e+00, 3.5077e+00, 3.6056e+00, 3.6071e+00, 3.6629e+00,
        3.8340e+00, 4.0213e+00, 4.1243e+00, 3.7735e+05, 3.8275e+05, 3.8513e+05,
        3.8915e+05, 3.9691e+05, 3.9807e+05, 4.0671e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389131.6250, 389141.9062, 389143.5000, 389150.8125,
        389155.1562, 389159.7188, 389168.4688, 389177.2812, 389190.5000,
        752261.6250, 765201.6250, 780973.0625, 787722.1875, 793543.5000,
        796852.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4547e+00, 3.6443e+00, 3.6519e+00, 3.6674e+00, 3.7208e+00,
        4.1243e+00, 4.1693e+00, 4.1694e+00, 3.7729e+05, 3.8269e+05, 3.8518e+05,
        3.8914e+05, 3.9694e+05, 3.9806e+05, 4.0670e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2601e+00, 3.4135e+00, 3.4429e+00, 3.5933e+00, 3.6071e+00,
        3.6519e+00, 3.8962e+00, 4.0584e+00, 3.7727e+05, 3.8268e+05, 3.8514e+05,
        3.8916e+05, 3.9686e+05, 3.9810e+05, 4.0676e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4670e+00, 3.6443e+00, 3.6629e+00, 3.6992e+00, 3.7065e+00,
        3.7654e+00, 4.0584e+00, 4.1635e+00, 3.7730e+05, 3.8272e+05, 3.8513e+05,
        3.8919e+05, 3.9694e+05, 3.9806e+05, 4.0673e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.1881e+00, 3.3101e+00, 3.3903e+00, 3.4429e+00, 3.4670e+00,
        3.4851e+00, 3.7208e+00, 3.9356e+00, 3.7731e+05, 3.8271e+05, 3.8515e+05,
        3.8917e+05, 3.9691e+05, 3.9809e+05, 4.0672e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398055.3438, 398056.6562, 398057.1875, 398065.7188,
        398089.3125, 398098.8750, 398104.5000, 398114.6250, 398121.7500,
        770369.8750, 780973.0625, 790692.6875, 793666.3125, 800419.1875,
        811759.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406632.0938, 406685.7500, 406698.6250, 406700.3125,
        406705.3438, 406716.4375, 406730.3750, 406745.1875, 406755.0625,
        777185.3125, 780648.8750, 783002.1250, 796852.9375, 800419.1875,
        816032.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382679.4688, 382692.9375, 382697.0938, 382697.1250,
        382705.5312, 382707.5625, 382721.3750, 382722.0000, 382753.4375,
        756979.1250, 760013.8750, 770369.8750, 780648.8750, 793543.5000,
        798664.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385071.1875, 385125.0625, 385130.7812, 385136.0625,
        385146.7188, 385147.0000, 385173.1250, 385181.1875, 385187.1250,
        752261.6250, 756979.1250, 765502.5625, 768109.7500, 777185.3125,
        811759.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2601e+00, 3.3101e+00, 3.4547e+00, 3.5023e+00, 3.5077e+00,
        3.7065e+00, 3.8193e+00, 3.9709e+00, 3.7729e+05, 3.8270e+05, 3.8519e+05,
        3.8918e+05, 3.9690e+05, 3.9806e+05, 4.0675e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3903e+00, 3.4135e+00, 3.5023e+00, 3.6674e+00, 3.6992e+00,
        3.7189e+00, 3.8340e+00, 3.8846e+00, 3.7726e+05, 3.8271e+05, 3.8507e+05,
        3.8914e+05, 3.9694e+05, 3.9811e+05, 4.0663e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5933e+00, 3.6010e+00, 3.8193e+00, 3.8846e+00, 3.9356e+00,
        4.0213e+00, 4.1635e+00, 4.1694e+00, 3.7724e+05, 3.8270e+05, 3.8515e+05,
        3.8916e+05, 3.9691e+05, 3.9810e+05, 4.0670e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396860.9375, 396900.1875, 396910.1875, 396911.1875,
        396913.1875, 396940.7812, 396941.9062, 396944.9375, 396983.8125,
        768109.7500, 771187.4375, 787722.1875, 790692.6875, 798664.4375,
        816032.5625])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76006.37', '415564.91', '76013.20', '425468.06', '76001.55', '75998.32', '76004.98', '76004.84', '435313.34', '443755.44', '420135.56', '421855.94', '76001.46', '75999.86', '75997.20', '434041.69']
estimated f for each client, fs: [7, 6, 7, 5, 7, 7, 7, 7, 5, 5, 5, 5, 7, 7, 7, 5]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [6, 16, 9, 20, 12, 5, 8, 11, 15, 14, 17, 13, 4, 7, 3, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0251s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:23...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[200  37]
 [211  52]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:23, End: 2025-07-22 15:46:23)
start time is: 98150999778487, end time is: 98164975114634
The total time is: 13975336147ns.

 ------- aggregate method: rkrum, random_seed: 400 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [8, 15, 4, 19, 5, 17, 2, 6, 12, 9], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.8789e+05, 4.0701e+00, 4.0168e+05, 4.7108e+00, 3.8221e+05,
         4.7565e+00, 4.5540e+00, 4.0118e+00, 4.8431e+00],
        [3.8789e+05, 0.0000e+00, 3.8793e+05, 7.8014e+05, 3.8790e+05, 7.5986e+05,
         3.8789e+05, 3.8789e+05, 3.8791e+05, 3.8792e+05],
        [4.0701e+00, 3.8793e+05, 0.0000e+00, 4.0167e+05, 3.8920e+00, 3.8219e+05,
         4.2716e+00, 4.1226e+00, 4.0988e+00, 4.7853e+00],
        [4.0168e+05, 7.8014e+05, 4.0167e+05, 0.0000e+00, 4.0168e+05, 7.5553e+05,
         4.0172e+05, 4.0164e+05, 4.0171e+05, 4.0165e+05],
        [4.7108e+00, 3.8790e+05, 3.8920e+00, 4.0168e+05, 0.0000e+00, 3.8219e+05,
         4.2630e+00, 4.5181e+00, 4.6083e+00, 5.9458e+00],
        [3.8221e+05, 7.5986e+05, 3.8219e+05, 7.5553e+05, 3.8219e+05, 0.0000e+00,
         3.8218e+05, 3.8225e+05, 3.8227e+05, 3.8219e+05],
        [4.7565e+00, 3.8789e+05, 4.2716e+00, 4.0172e+05, 4.2630e+00, 3.8218e+05,
         0.0000e+00, 4.5944e+00, 4.4830e+00, 5.3122e+00],
        [4.5540e+00, 3.8789e+05, 4.1226e+00, 4.0164e+05, 4.5181e+00, 3.8225e+05,
         4.5944e+00, 0.0000e+00, 4.3555e+00, 4.9263e+00],
        [4.0118e+00, 3.8791e+05, 4.0988e+00, 4.0171e+05, 4.6083e+00, 3.8227e+05,
         4.4830e+00, 4.3555e+00, 0.0000e+00, 4.6987e+00],
        [4.8431e+00, 3.8792e+05, 4.7853e+00, 4.0165e+05, 5.9458e+00, 3.8219e+05,
         5.3122e+00, 4.9263e+00, 4.6987e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 4.0118e+00, 4.0701e+00, 4.5540e+00, 4.7108e+00, 4.7565e+00,
        4.8431e+00, 3.8221e+05, 3.8789e+05, 4.0168e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 387887.1562, 387888.3750, 387890.6875, 387895.5000,
        387910.9375, 387916.3125, 387926.9688, 759864.3750, 780140.9375])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.8920e+00, 4.0701e+00, 4.0988e+00, 4.1226e+00, 4.2716e+00,
        4.7853e+00, 3.8219e+05, 3.8793e+05, 4.0167e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 401644.6250, 401649.0312, 401669.6562, 401679.1562,
        401681.8438, 401705.6250, 401723.3125, 755534.3750, 780140.9375])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.8920e+00, 4.2630e+00, 4.5181e+00, 4.6083e+00, 4.7108e+00,
        5.9458e+00, 3.8219e+05, 3.8790e+05, 4.0168e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 382175.3438, 382187.4375, 382188.9688, 382192.6562,
        382212.6875, 382249.0938, 382269.5312, 755534.3750, 759864.3750])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 4.2630e+00, 4.2716e+00, 4.4830e+00, 4.5944e+00, 4.7565e+00,
        5.3122e+00, 3.8218e+05, 3.8789e+05, 4.0172e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 4.1226e+00, 4.3555e+00, 4.5181e+00, 4.5540e+00, 4.5944e+00,
        4.9263e+00, 3.8225e+05, 3.8789e+05, 4.0164e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 4.0118e+00, 4.0988e+00, 4.3555e+00, 4.4830e+00, 4.6083e+00,
        4.6987e+00, 3.8227e+05, 3.8791e+05, 4.0171e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 4.6987e+00, 4.7853e+00, 4.8431e+00, 4.9263e+00, 5.3122e+00,
        5.9458e+00, 3.8219e+05, 3.8792e+05, 4.0165e+05])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['54605.66', '387902.28', '54601.81', '401679.03', '54602.94', '382210.78', '54600.43', '54610.88', '54613.68', '54602.78']
estimated f for each client, fs: [3, 1, 3, 1, 3, 1, 3, 3, 3, 3]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [8, 15, 4, 19, 5, 17, 2, 6, 12, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0060s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:23...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:23, End: 2025-07-22 15:46:23)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [5, 17, 18, 9, 20, 8, 16, 1, 7, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.7973e+05, 3.9010e+05, 2.1042e+00, 3.9473e+05, 2.1278e+00,
         3.8935e+05, 1.8504e+00, 1.9264e+00, 1.9801e+00],
        [3.7973e+05, 0.0000e+00, 7.7461e+05, 3.7973e+05, 7.6503e+05, 3.7973e+05,
         7.4708e+05, 3.7971e+05, 3.7972e+05, 3.7975e+05],
        [3.9010e+05, 7.7461e+05, 0.0000e+00, 3.9011e+05, 7.8648e+05, 3.9013e+05,
         7.8806e+05, 3.9013e+05, 3.9008e+05, 3.9013e+05],
        [2.1042e+00, 3.7973e+05, 3.9011e+05, 0.0000e+00, 3.9471e+05, 1.8737e+00,
         3.8931e+05, 1.7088e+00, 1.9505e+00, 1.9111e+00],
        [3.9473e+05, 7.6503e+05, 7.8648e+05, 3.9471e+05, 0.0000e+00, 3.9470e+05,
         7.8925e+05, 3.9471e+05, 3.9466e+05, 3.9470e+05],
        [2.1278e+00, 3.7973e+05, 3.9013e+05, 1.8737e+00, 3.9470e+05, 0.0000e+00,
         3.8936e+05, 1.9524e+00, 1.9946e+00, 1.9562e+00],
        [3.8935e+05, 7.4708e+05, 7.8806e+05, 3.8931e+05, 7.8925e+05, 3.8936e+05,
         0.0000e+00, 3.8934e+05, 3.8937e+05, 3.8938e+05],
        [1.8504e+00, 3.7971e+05, 3.9013e+05, 1.7088e+00, 3.9471e+05, 1.9524e+00,
         3.8934e+05, 0.0000e+00, 1.8763e+00, 1.8041e+00],
        [1.9264e+00, 3.7972e+05, 3.9008e+05, 1.9505e+00, 3.9466e+05, 1.9946e+00,
         3.8937e+05, 1.8763e+00, 0.0000e+00, 1.8934e+00],
        [1.9801e+00, 3.7975e+05, 3.9013e+05, 1.9111e+00, 3.9470e+05, 1.9562e+00,
         3.8938e+05, 1.8041e+00, 1.8934e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.8504e+00, 1.9264e+00, 1.9801e+00, 2.1042e+00, 2.1278e+00,
        3.7973e+05, 3.8935e+05, 3.9010e+05, 3.9473e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 379708.5625, 379719.5000, 379728.3750, 379728.3750,
        379734.6875, 379749.5000, 747082.2500, 765027.4375, 774613.2500])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 390079.5625, 390103.8750, 390109.0625, 390127.4062,
        390129.1562, 390132.6875, 774613.2500, 786480.5000, 788056.6875])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.7088e+00, 1.8737e+00, 1.9111e+00, 1.9505e+00, 2.1042e+00,
        3.7973e+05, 3.8931e+05, 3.9011e+05, 3.9471e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 394663.6250, 394697.4688, 394698.7500, 394707.4375,
        394714.5938, 394729.7812, 765027.4375, 786480.5000, 789250.7500])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.8737e+00, 1.9524e+00, 1.9562e+00, 1.9946e+00, 2.1278e+00,
        3.7973e+05, 3.8936e+05, 3.9013e+05, 3.9470e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 389313.0312, 389337.8125, 389350.6562, 389359.5625,
        389370.3750, 389381.3438, 747082.2500, 788056.6875, 789250.7500])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.7088e+00, 1.8041e+00, 1.8504e+00, 1.8763e+00, 1.9524e+00,
        3.7971e+05, 3.8934e+05, 3.9013e+05, 3.9471e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.8763e+00, 1.8934e+00, 1.9264e+00, 1.9505e+00, 1.9946e+00,
        3.7972e+05, 3.8937e+05, 3.9008e+05, 3.9466e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.8041e+00, 1.8934e+00, 1.9111e+00, 1.9562e+00, 1.9801e+00,
        3.7975e+05, 3.8938e+05, 3.9013e+05, 3.9470e+05])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['109869.86', '432207.28', '445042.12', '109865.31', '447605.59', '109871.12', '440456.44', '109865.07', '109871.35', '109877.19']
estimated f for each client, fs: [4, 2, 2, 4, 2, 4, 2, 4, 4, 4]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']], selected_client_indices: [5, 17, 18, 9, 20, 8, 16, 1, 7, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0059s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:23...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[189  48]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:23, End: 2025-07-22 15:46:23)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [13, 10, 18, 12, 16, 20, 5, 3, 8, 1], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.9200e+05, 7.9338e+05, 3.9207e+05, 7.7713e+05, 7.7516e+05,
         3.9204e+05, 3.9204e+05, 3.9206e+05, 3.9206e+05],
        [3.9200e+05, 0.0000e+00, 4.0198e+05, 1.7135e+00, 3.9179e+05, 3.9662e+05,
         1.8242e+00, 1.6491e+00, 1.6940e+00, 1.8470e+00],
        [7.9338e+05, 4.0198e+05, 0.0000e+00, 4.0196e+05, 7.7759e+05, 8.0610e+05,
         4.0196e+05, 4.0194e+05, 4.0196e+05, 4.0198e+05],
        [3.9207e+05, 1.7135e+00, 4.0196e+05, 0.0000e+00, 3.9176e+05, 3.9664e+05,
         1.6947e+00, 1.6566e+00, 1.7747e+00, 1.8189e+00],
        [7.7713e+05, 3.9179e+05, 7.7759e+05, 3.9176e+05, 0.0000e+00, 7.8371e+05,
         3.9174e+05, 3.9172e+05, 3.9178e+05, 3.9176e+05],
        [7.7516e+05, 3.9662e+05, 8.0610e+05, 3.9664e+05, 7.8371e+05, 0.0000e+00,
         3.9664e+05, 3.9665e+05, 3.9664e+05, 3.9665e+05],
        [3.9204e+05, 1.8242e+00, 4.0196e+05, 1.6947e+00, 3.9174e+05, 3.9664e+05,
         0.0000e+00, 1.6810e+00, 1.9369e+00, 1.7508e+00],
        [3.9204e+05, 1.6491e+00, 4.0194e+05, 1.6566e+00, 3.9172e+05, 3.9665e+05,
         1.6810e+00, 0.0000e+00, 1.8220e+00, 1.8590e+00],
        [3.9206e+05, 1.6940e+00, 4.0196e+05, 1.7747e+00, 3.9178e+05, 3.9664e+05,
         1.9369e+00, 1.8220e+00, 0.0000e+00, 1.9644e+00],
        [3.9206e+05, 1.8470e+00, 4.0198e+05, 1.8189e+00, 3.9176e+05, 3.9665e+05,
         1.7508e+00, 1.8590e+00, 1.9644e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 391995.1250, 392037.7188, 392042.3750, 392055.3438,
        392059.1250, 392067.6875, 775156.6875, 777131.6875, 793375.7500])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.6491e+00, 1.6940e+00, 1.7135e+00, 1.8242e+00, 1.8470e+00,
        3.9179e+05, 3.9200e+05, 3.9662e+05, 4.0198e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 401936.0625, 401957.2500, 401961.2500, 401962.0625,
        401978.0625, 401983.2812, 777588.0000, 793375.7500, 806098.5625])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.6566e+00, 1.6947e+00, 1.7135e+00, 1.7747e+00, 1.8189e+00,
        3.9176e+05, 3.9207e+05, 3.9664e+05, 4.0196e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 391723.6250, 391741.8125, 391757.4375, 391762.4688,
        391779.1875, 391785.0938, 777131.6875, 777588.0000, 783708.8750])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 396623.0000, 396638.0312, 396639.9375, 396640.2188,
        396646.4375, 396650.5000, 775156.6875, 783708.8750, 806098.5625])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.6810e+00, 1.6947e+00, 1.7508e+00, 1.8242e+00, 1.9369e+00,
        3.9174e+05, 3.9204e+05, 3.9664e+05, 4.0196e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.6491e+00, 1.6566e+00, 1.6810e+00, 1.8220e+00, 1.8590e+00,
        3.9172e+05, 3.9204e+05, 3.9665e+05, 4.0194e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.6940e+00, 1.7747e+00, 1.8220e+00, 1.9369e+00, 1.9644e+00,
        3.9178e+05, 3.9206e+05, 3.9664e+05, 4.0196e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.7508e+00, 1.8189e+00, 1.8470e+00, 1.8590e+00, 1.9644e+00,
        3.9176e+05, 3.9206e+05, 3.9665e+05, 4.0198e+05])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['446773.41', '111969.84', '455623.72', '111976.25', '446811.62', '450713.53', '111970.43', '111967.13', '111978.22', '111975.30']
estimated f for each client, fs: [2, 4, 2, 4, 2, 2, 4, 4, 4, 4]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']], selected_client_indices: [13, 10, 18, 12, 16, 20, 5, 3, 8, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0097s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:24...
global Accuracy on shared test data: 79.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[187  50]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:24, End: 2025-07-22 15:46:24)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [18, 12, 8], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[0.0000e+00, 3.9184e+05, 3.9182e+05],
        [3.9184e+05, 0.0000e+00, 1.8339e+00],
        [3.9182e+05, 1.8339e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 391816.4375, 391843.0625])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000e+00, 1.8339e+00, 3.9184e+05])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000e+00, 1.8339e+00, 3.9182e+05])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['391829.75', '195922.45', '195909.14']
estimated f for each client, fs: [0, 1, 1]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']], selected_client_indices: [18, 12, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0020s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:24...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:24, End: 2025-07-22 15:46:24)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [20], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
rkrum, clients_type: ['Chosen Update'], selected_client_indices: [20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0000s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:24...
global Accuracy on shared test data: 58.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 69 168]
 [ 41 222]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:46:24, End: 2025-07-22 15:46:24)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [16, 10], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[     0.0000, 384446.0312],
        [384446.0312,      0.0000]])
sorted_distances: tensor([     0.0000, 384446.0312])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([     0.0000, 384446.0312])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['384446.03', '384446.03']
estimated f for each client, fs: [1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [16, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0015s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:24...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[  1 236]
 [  1 262]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:24, End: 2025-07-22 15:46:24)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [8, 14, 4, 1, 12], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
tensor([[0.0000e+00, 4.0269e+05, 3.4007e+00, 3.4181e+00, 3.2863e+00],
        [4.0269e+05, 0.0000e+00, 4.0269e+05, 4.0274e+05, 4.0273e+05],
        [3.4007e+00, 4.0269e+05, 0.0000e+00, 3.5297e+00, 3.2509e+00],
        [3.4181e+00, 4.0274e+05, 3.5297e+00, 0.0000e+00, 3.4056e+00],
        [3.2863e+00, 4.0273e+05, 3.2509e+00, 3.4056e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.2863e+00, 3.4007e+00, 3.4181e+00, 4.0269e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([     0.0000, 402687.5312, 402687.8438, 402725.2188, 402743.5000])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 3.2509e+00, 3.4007e+00, 3.5297e+00, 4.0269e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 3.4056e+00, 3.4181e+00, 3.5297e+00, 4.0274e+05])
Index of maximum distance difference after half of values: 4
sorted_distances: tensor([0.0000e+00, 3.2509e+00, 3.2863e+00, 3.4056e+00, 4.0273e+05])
Index of maximum distance difference after half of values: 4
adaptive_Krum scores:  ['100674.49', '402711.00', '100674.43', '100688.47', '100683.80']
estimated f for each client, fs: [1, 0, 1, 1, 1]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']], selected_client_indices: [8, 14, 4, 1, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:25...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[  1 236]
 [  2 261]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:25, End: 2025-07-22 15:46:25)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [19, 7, 10, 16, 18, 9, 11, 17, 14, 5, 8, 4, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.7189e+05, 3.7189e+05, 7.6884e+05, 7.4390e+05, 3.7189e+05,
         3.7186e+05, 7.4827e+05, 7.5689e+05, 3.7190e+05, 3.7190e+05, 3.7185e+05,
         7.7655e+05],
        [3.7189e+05, 0.0000e+00, 3.2381e+00, 3.8344e+05, 3.8200e+05, 3.7699e+00,
         3.3697e+00, 3.7132e+05, 3.8654e+05, 3.2768e+00, 3.5814e+00, 3.3121e+00,
         3.9678e+05],
        [3.7189e+05, 3.2381e+00, 0.0000e+00, 3.8340e+05, 3.8194e+05, 3.4611e+00,
         3.2581e+00, 3.7134e+05, 3.8659e+05, 3.3096e+00, 3.3810e+00, 3.0690e+00,
         3.9673e+05],
        [7.6884e+05, 3.8344e+05, 3.8340e+05, 0.0000e+00, 7.6233e+05, 3.8340e+05,
         3.8337e+05, 7.4269e+05, 7.7774e+05, 3.8345e+05, 3.8341e+05, 3.8341e+05,
         7.6640e+05],
        [7.4390e+05, 3.8200e+05, 3.8194e+05, 7.6233e+05, 0.0000e+00, 3.8198e+05,
         3.8196e+05, 7.3711e+05, 7.5874e+05, 3.8194e+05, 3.8197e+05, 3.8194e+05,
         7.9165e+05],
        [3.7189e+05, 3.7699e+00, 3.4611e+00, 3.8340e+05, 3.8198e+05, 0.0000e+00,
         3.0992e+00, 3.7134e+05, 3.8659e+05, 3.5127e+00, 3.3924e+00, 3.5581e+00,
         3.9675e+05],
        [3.7186e+05, 3.3697e+00, 3.2581e+00, 3.8337e+05, 3.8196e+05, 3.0992e+00,
         0.0000e+00, 3.7132e+05, 3.8660e+05, 3.1008e+00, 3.2228e+00, 3.1851e+00,
         3.9674e+05],
        [7.4827e+05, 3.7132e+05, 3.7134e+05, 7.4269e+05, 7.3711e+05, 3.7134e+05,
         3.7132e+05, 0.0000e+00, 7.4537e+05, 3.7139e+05, 3.7133e+05, 3.7136e+05,
         7.6854e+05],
        [7.5689e+05, 3.8654e+05, 3.8659e+05, 7.7774e+05, 7.5874e+05, 3.8659e+05,
         3.8660e+05, 7.4537e+05, 0.0000e+00, 3.8658e+05, 3.8654e+05, 3.8656e+05,
         7.5575e+05],
        [3.7190e+05, 3.2768e+00, 3.3096e+00, 3.8345e+05, 3.8194e+05, 3.5127e+00,
         3.1008e+00, 3.7139e+05, 3.8658e+05, 0.0000e+00, 3.4329e+00, 3.0919e+00,
         3.9677e+05],
        [3.7190e+05, 3.5814e+00, 3.3810e+00, 3.8341e+05, 3.8197e+05, 3.3924e+00,
         3.2228e+00, 3.7133e+05, 3.8654e+05, 3.4329e+00, 0.0000e+00, 3.4529e+00,
         3.9673e+05],
        [3.7185e+05, 3.3121e+00, 3.0690e+00, 3.8341e+05, 3.8194e+05, 3.5581e+00,
         3.1851e+00, 3.7136e+05, 3.8656e+05, 3.0919e+00, 3.4529e+00, 0.0000e+00,
         3.9671e+05],
        [7.7655e+05, 3.9678e+05, 3.9673e+05, 7.6640e+05, 7.9165e+05, 3.9675e+05,
         3.9674e+05, 7.6854e+05, 7.5575e+05, 3.9677e+05, 3.9673e+05, 3.9671e+05,
         0.0000e+00]])
sorted_distances: tensor([     0.0000, 371850.8125, 371862.6875, 371885.7500, 371888.6875,
        371894.0938, 371900.0312, 371903.5625, 743901.4375, 748271.1875,
        756894.6875, 768835.7500, 776551.6875])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.2381e+00, 3.2768e+00, 3.3121e+00, 3.3697e+00, 3.5814e+00,
        3.7699e+00, 3.7132e+05, 3.7189e+05, 3.8200e+05, 3.8344e+05, 3.8654e+05,
        3.9678e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.0690e+00, 3.2381e+00, 3.2581e+00, 3.3096e+00, 3.3810e+00,
        3.4611e+00, 3.7134e+05, 3.7189e+05, 3.8194e+05, 3.8340e+05, 3.8659e+05,
        3.9673e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 383369.0625, 383400.1875, 383400.9375, 383406.9688,
        383410.8125, 383444.6562, 383446.0625, 742691.9375, 762329.0000,
        766401.0625, 768835.7500, 777735.6250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 381936.1250, 381937.8438, 381942.6562, 381959.0312,
        381971.2812, 381976.6250, 381999.3750, 737109.4375, 743901.4375,
        758735.2500, 762329.0000, 791649.3750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.0992e+00, 3.3924e+00, 3.4611e+00, 3.5127e+00, 3.5581e+00,
        3.7699e+00, 3.7134e+05, 3.7189e+05, 3.8198e+05, 3.8340e+05, 3.8659e+05,
        3.9675e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.0992e+00, 3.1008e+00, 3.1851e+00, 3.2228e+00, 3.2581e+00,
        3.3697e+00, 3.7132e+05, 3.7186e+05, 3.8196e+05, 3.8337e+05, 3.8660e+05,
        3.9674e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 371321.7188, 371321.7500, 371325.0938, 371340.8750,
        371343.8750, 371362.0000, 371388.0312, 737109.4375, 742691.9375,
        745370.9375, 748271.1875, 768543.5000])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 386535.5625, 386544.9375, 386560.0312, 386581.9375,
        386588.0938, 386589.8438, 386596.3750, 745370.9375, 755748.6250,
        756894.6875, 758735.2500, 777735.6250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.0919e+00, 3.1008e+00, 3.2768e+00, 3.3096e+00, 3.4329e+00,
        3.5127e+00, 3.7139e+05, 3.7190e+05, 3.8194e+05, 3.8345e+05, 3.8658e+05,
        3.9677e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.2228e+00, 3.3810e+00, 3.3924e+00, 3.4329e+00, 3.4529e+00,
        3.5814e+00, 3.7133e+05, 3.7190e+05, 3.8197e+05, 3.8341e+05, 3.8654e+05,
        3.9673e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.0690e+00, 3.0919e+00, 3.1851e+00, 3.3121e+00, 3.4529e+00,
        3.5581e+00, 3.7136e+05, 3.7185e+05, 3.8194e+05, 3.8341e+05, 3.8656e+05,
        3.9671e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 396708.5625, 396727.6875, 396729.6875, 396740.9688,
        396748.6250, 396769.9062, 396781.2812, 755748.6250, 766401.0625,
        768543.5000, 776551.6875, 791649.3750])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['418385.91', '92904.55', '92906.53', '428321.34', '426354.03', '92905.93', '92900.46', '417064.09', '431420.97', '92913.47', '92906.14', '92904.06', '441619.44']
estimated f for each client, fs: [5, 6, 6, 4, 4, 6, 6, 4, 4, 6, 6, 6, 4]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [19, 7, 10, 16, 18, 9, 11, 17, 14, 5, 8, 4, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0087s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:25...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[  2 235]
 [  3 260]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:25, End: 2025-07-22 15:46:25)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 1, 10, 15, 9, 19, 12, 7, 20, 11, 13, 16, 5, 8, 6, 17, 3, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.7847e+05, 3.7853e+05, 7.4158e+05, 3.7849e+05, 7.6110e+05,
         3.7849e+05, 3.7854e+05, 7.5690e+05, 3.7852e+05, 7.6486e+05, 7.6686e+05,
         3.7840e+05, 3.7850e+05, 3.7849e+05, 7.6593e+05, 3.7850e+05, 3.7852e+05],
        [3.7847e+05, 0.0000e+00, 3.1495e+00, 3.8065e+05, 3.3937e+00, 3.9303e+05,
         3.4184e+00, 3.4743e+00, 3.8839e+05, 3.1488e+00, 3.9023e+05, 4.0283e+05,
         3.4004e+00, 3.3324e+00, 3.3587e+00, 3.8225e+05, 3.0955e+00, 3.1276e+00],
        [3.7853e+05, 3.1495e+00, 0.0000e+00, 3.8065e+05, 3.4485e+00, 3.9302e+05,
         3.2717e+00, 3.2167e+00, 3.8834e+05, 3.2828e+00, 3.9026e+05, 4.0283e+05,
         3.3771e+00, 3.2720e+00, 3.3261e+00, 3.8226e+05, 3.0988e+00, 3.0862e+00],
        [7.4158e+05, 3.8065e+05, 3.8065e+05, 0.0000e+00, 3.8072e+05, 7.5910e+05,
         3.8073e+05, 3.8062e+05, 7.6283e+05, 3.8067e+05, 7.4249e+05, 7.8550e+05,
         3.8067e+05, 3.8070e+05, 3.8066e+05, 7.6288e+05, 3.8069e+05, 3.8066e+05],
        [3.7849e+05, 3.3937e+00, 3.4485e+00, 3.8072e+05, 0.0000e+00, 3.9304e+05,
         3.3705e+00, 3.6890e+00, 3.8836e+05, 3.0854e+00, 3.9023e+05, 4.0286e+05,
         3.5259e+00, 3.3522e+00, 3.4941e+00, 3.8227e+05, 3.2741e+00, 3.2239e+00],
        [7.6110e+05, 3.9303e+05, 3.9302e+05, 7.5910e+05, 3.9304e+05, 0.0000e+00,
         3.9305e+05, 3.9301e+05, 7.7006e+05, 3.9301e+05, 7.6415e+05, 7.8375e+05,
         3.9304e+05, 3.9305e+05, 3.9298e+05, 7.7316e+05, 3.9303e+05, 3.9297e+05],
        [3.7849e+05, 3.4184e+00, 3.2717e+00, 3.8073e+05, 3.3705e+00, 3.9305e+05,
         0.0000e+00, 3.3036e+00, 3.8836e+05, 3.1210e+00, 3.9021e+05, 4.0284e+05,
         3.4852e+00, 3.2803e+00, 3.2624e+00, 3.8226e+05, 3.1049e+00, 3.2426e+00],
        [3.7854e+05, 3.4743e+00, 3.2167e+00, 3.8062e+05, 3.6890e+00, 3.9301e+05,
         3.3036e+00, 0.0000e+00, 3.8836e+05, 3.3099e+00, 3.9020e+05, 4.0276e+05,
         3.2382e+00, 3.4138e+00, 3.3477e+00, 3.8229e+05, 3.2121e+00, 3.0896e+00],
        [7.5690e+05, 3.8839e+05, 3.8834e+05, 7.6283e+05, 3.8836e+05, 7.7006e+05,
         3.8836e+05, 3.8836e+05, 0.0000e+00, 3.8837e+05, 7.9910e+05, 8.0425e+05,
         3.8837e+05, 3.8836e+05, 3.8834e+05, 7.7830e+05, 3.8837e+05, 3.8836e+05],
        [3.7852e+05, 3.1488e+00, 3.2828e+00, 3.8067e+05, 3.0854e+00, 3.9301e+05,
         3.1210e+00, 3.3099e+00, 3.8837e+05, 0.0000e+00, 3.9028e+05, 4.0283e+05,
         3.1935e+00, 3.1882e+00, 3.0912e+00, 3.8227e+05, 3.3024e+00, 2.9044e+00],
        [7.6486e+05, 3.9023e+05, 3.9026e+05, 7.4249e+05, 3.9023e+05, 7.6415e+05,
         3.9021e+05, 3.9020e+05, 7.9910e+05, 3.9028e+05, 0.0000e+00, 8.0907e+05,
         3.9025e+05, 3.9027e+05, 3.9024e+05, 7.7689e+05, 3.9019e+05, 3.9023e+05],
        [7.6686e+05, 4.0283e+05, 4.0283e+05, 7.8550e+05, 4.0286e+05, 7.8375e+05,
         4.0284e+05, 4.0276e+05, 8.0425e+05, 4.0283e+05, 8.0907e+05, 0.0000e+00,
         4.0283e+05, 4.0283e+05, 4.0282e+05, 7.8784e+05, 4.0284e+05, 4.0281e+05],
        [3.7840e+05, 3.4004e+00, 3.3771e+00, 3.8067e+05, 3.5259e+00, 3.9304e+05,
         3.4852e+00, 3.2382e+00, 3.8837e+05, 3.1935e+00, 3.9025e+05, 4.0283e+05,
         0.0000e+00, 3.4118e+00, 3.1640e+00, 3.8224e+05, 3.3790e+00, 3.1042e+00],
        [3.7850e+05, 3.3324e+00, 3.2720e+00, 3.8070e+05, 3.3522e+00, 3.9305e+05,
         3.2803e+00, 3.4138e+00, 3.8836e+05, 3.1882e+00, 3.9027e+05, 4.0283e+05,
         3.4118e+00, 0.0000e+00, 3.5211e+00, 3.8225e+05, 3.1173e+00, 3.2642e+00],
        [3.7849e+05, 3.3587e+00, 3.3261e+00, 3.8066e+05, 3.4941e+00, 3.9298e+05,
         3.2624e+00, 3.3477e+00, 3.8834e+05, 3.0912e+00, 3.9024e+05, 4.0282e+05,
         3.1640e+00, 3.5211e+00, 0.0000e+00, 3.8226e+05, 3.2212e+00, 3.0502e+00],
        [7.6593e+05, 3.8225e+05, 3.8226e+05, 7.6288e+05, 3.8227e+05, 7.7316e+05,
         3.8226e+05, 3.8229e+05, 7.7830e+05, 3.8227e+05, 7.7689e+05, 7.8784e+05,
         3.8224e+05, 3.8225e+05, 3.8226e+05, 0.0000e+00, 3.8223e+05, 3.8227e+05],
        [3.7850e+05, 3.0955e+00, 3.0988e+00, 3.8069e+05, 3.2741e+00, 3.9303e+05,
         3.1049e+00, 3.2121e+00, 3.8837e+05, 3.3024e+00, 3.9019e+05, 4.0284e+05,
         3.3790e+00, 3.1173e+00, 3.2212e+00, 3.8223e+05, 0.0000e+00, 2.8199e+00],
        [3.7852e+05, 3.1276e+00, 3.0862e+00, 3.8066e+05, 3.2239e+00, 3.9297e+05,
         3.2426e+00, 3.0896e+00, 3.8836e+05, 2.9044e+00, 3.9023e+05, 4.0281e+05,
         3.1042e+00, 3.2642e+00, 3.0502e+00, 3.8227e+05, 2.8199e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 378401.2500, 378472.5000, 378488.6875, 378491.4375,
        378493.9688, 378500.1562, 378500.5938, 378518.2812, 378523.8750,
        378531.9375, 378539.0938, 741577.8125, 756897.4375, 761103.3750,
        764856.2500, 765929.5000, 766855.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.0955e+00, 3.1276e+00, 3.1488e+00, 3.1495e+00, 3.3324e+00,
        3.3587e+00, 3.3937e+00, 3.4004e+00, 3.4184e+00, 3.4743e+00, 3.7847e+05,
        3.8065e+05, 3.8225e+05, 3.8839e+05, 3.9023e+05, 3.9303e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.0862e+00, 3.0988e+00, 3.1495e+00, 3.2167e+00, 3.2717e+00,
        3.2720e+00, 3.2828e+00, 3.3261e+00, 3.3771e+00, 3.4485e+00, 3.7853e+05,
        3.8065e+05, 3.8226e+05, 3.8834e+05, 3.9026e+05, 3.9302e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 380620.6562, 380647.9062, 380650.3438, 380655.4375,
        380662.3438, 380670.7500, 380671.9688, 380685.3438, 380701.4375,
        380720.0625, 380727.7500, 741577.8125, 742490.9375, 759102.8125,
        762826.1875, 762882.5000, 785502.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.0854e+00, 3.2239e+00, 3.2741e+00, 3.3522e+00, 3.3705e+00,
        3.3937e+00, 3.4485e+00, 3.4941e+00, 3.5259e+00, 3.6890e+00, 3.7849e+05,
        3.8072e+05, 3.8227e+05, 3.8836e+05, 3.9023e+05, 3.9304e+05, 4.0286e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392974.6562, 392975.5000, 393007.0625, 393013.1250,
        393019.1250, 393030.8125, 393032.2500, 393038.1875, 393042.1250,
        393045.5938, 393048.6875, 759102.8125, 761103.3750, 764147.3125,
        770055.3750, 773164.2500, 783747.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.1049e+00, 3.1210e+00, 3.2426e+00, 3.2624e+00, 3.2717e+00,
        3.2803e+00, 3.3036e+00, 3.3705e+00, 3.4184e+00, 3.4852e+00, 3.7849e+05,
        3.8073e+05, 3.8226e+05, 3.8836e+05, 3.9021e+05, 3.9305e+05, 4.0284e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.0896e+00, 3.2121e+00, 3.2167e+00, 3.2382e+00, 3.3036e+00,
        3.3099e+00, 3.3477e+00, 3.4138e+00, 3.4743e+00, 3.6890e+00, 3.7854e+05,
        3.8062e+05, 3.8229e+05, 3.8836e+05, 3.9020e+05, 3.9301e+05, 4.0276e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388342.5000, 388342.8125, 388360.9062, 388360.9688,
        388361.2500, 388362.5625, 388364.3125, 388368.0938, 388371.1875,
        388373.4375, 388385.2812, 756897.4375, 762826.1875, 770055.3750,
        778296.8750, 799100.7500, 804252.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 2.9044e+00, 3.0854e+00, 3.0912e+00, 3.1210e+00, 3.1488e+00,
        3.1882e+00, 3.1935e+00, 3.2828e+00, 3.3024e+00, 3.3099e+00, 3.7852e+05,
        3.8067e+05, 3.8227e+05, 3.8837e+05, 3.9028e+05, 3.9301e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 390191.2812, 390201.3125, 390208.1250, 390226.4375,
        390228.6875, 390234.0312, 390240.6875, 390252.1250, 390257.6875,
        390270.8750, 390277.8750, 742490.9375, 764147.3125, 764856.2500,
        776888.3750, 799100.7500, 809066.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 402755.0000, 402813.2500, 402815.0938, 402826.6250,
        402827.1562, 402830.0625, 402830.2188, 402831.1562, 402840.2500,
        402842.0000, 402862.5000, 766855.5000, 783747.6250, 785502.3125,
        787835.7500, 804252.1250, 809066.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.1042e+00, 3.1640e+00, 3.1935e+00, 3.2382e+00, 3.3771e+00,
        3.3790e+00, 3.4004e+00, 3.4118e+00, 3.4852e+00, 3.5259e+00, 3.7840e+05,
        3.8067e+05, 3.8224e+05, 3.8837e+05, 3.9025e+05, 3.9304e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.1173e+00, 3.1882e+00, 3.2642e+00, 3.2720e+00, 3.2803e+00,
        3.3324e+00, 3.3522e+00, 3.4118e+00, 3.4138e+00, 3.5211e+00, 3.7850e+05,
        3.8070e+05, 3.8225e+05, 3.8836e+05, 3.9027e+05, 3.9305e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.0502e+00, 3.0912e+00, 3.1640e+00, 3.2212e+00, 3.2624e+00,
        3.3261e+00, 3.3477e+00, 3.3587e+00, 3.4941e+00, 3.5211e+00, 3.7849e+05,
        3.8066e+05, 3.8226e+05, 3.8834e+05, 3.9024e+05, 3.9298e+05, 4.0282e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382234.7500, 382239.4688, 382250.3125, 382250.9062,
        382261.7500, 382263.3750, 382264.2812, 382268.9062, 382270.2188,
        382271.0938, 382287.3438, 762882.5000, 765929.5000, 773164.2500,
        776888.3750, 778296.8750, 787835.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 2.8199e+00, 3.0955e+00, 3.0988e+00, 3.1049e+00, 3.1173e+00,
        3.2121e+00, 3.2212e+00, 3.2741e+00, 3.3024e+00, 3.3790e+00, 3.7850e+05,
        3.8069e+05, 3.8223e+05, 3.8837e+05, 3.9019e+05, 3.9303e+05, 4.0284e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 2.8199e+00, 2.9044e+00, 3.0502e+00, 3.0862e+00, 3.0896e+00,
        3.1042e+00, 3.1276e+00, 3.2239e+00, 3.2426e+00, 3.2642e+00, 3.7852e+05,
        3.8066e+05, 3.8227e+05, 3.8836e+05, 3.9023e+05, 3.9297e+05, 4.0281e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['378496.47', '34409.59', '34414.95', '380673.97', '34411.14', '393020.59', '34411.30', '34415.66', '388363.00', '34413.63', '390235.34', '402824.81', '34403.13', '34412.12', '34411.53', '382260.19', '34412.02', '34414.07']
estimated f for each client, fs: [5, 7, 7, 5, 7, 5, 7, 7, 5, 7, 5, 5, 7, 7, 7, 5, 7, 7]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 1, 10, 15, 9, 19, 12, 7, 20, 11, 13, 16, 5, 8, 6, 17, 3, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0129s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:26...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[  3 234]
 [  3 260]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:26, End: 2025-07-22 15:46:26)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [5, 14, 18, 11, 13, 7, 15, 4, 9, 1, 10, 17, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.8778e+05, 3.8535e+05, 3.2571e+00, 3.9861e+05, 3.2790e+00,
         3.8699e+05, 3.2023e+00, 3.5970e+00, 3.3807e+00, 3.3755e+00, 4.0968e+05,
         3.9174e+05],
        [3.8778e+05, 0.0000e+00, 7.7415e+05, 3.8777e+05, 7.8304e+05, 3.8781e+05,
         7.8355e+05, 3.8785e+05, 3.8781e+05, 3.8776e+05, 3.8785e+05, 8.0365e+05,
         7.9226e+05],
        [3.8535e+05, 7.7415e+05, 0.0000e+00, 3.8532e+05, 7.7178e+05, 3.8533e+05,
         7.7436e+05, 3.8529e+05, 3.8533e+05, 3.8529e+05, 3.8533e+05, 8.0576e+05,
         7.7225e+05],
        [3.2571e+00, 3.8777e+05, 3.8532e+05, 0.0000e+00, 3.9854e+05, 3.3240e+00,
         3.8701e+05, 3.2849e+00, 3.1429e+00, 3.2457e+00, 3.2817e+00, 4.0969e+05,
         3.9176e+05],
        [3.9861e+05, 7.8304e+05, 7.7178e+05, 3.9854e+05, 0.0000e+00, 3.9865e+05,
         7.7813e+05, 3.9862e+05, 3.9864e+05, 3.9861e+05, 3.9862e+05, 8.1950e+05,
         7.5876e+05],
        [3.2790e+00, 3.8781e+05, 3.8533e+05, 3.3240e+00, 3.9865e+05, 0.0000e+00,
         3.8695e+05, 3.3214e+00, 3.6686e+00, 3.4989e+00, 3.2264e+00, 4.0965e+05,
         3.9174e+05],
        [3.8699e+05, 7.8355e+05, 7.7436e+05, 3.8701e+05, 7.7813e+05, 3.8695e+05,
         0.0000e+00, 3.8697e+05, 3.8701e+05, 3.8700e+05, 3.8701e+05, 7.9989e+05,
         7.6830e+05],
        [3.2023e+00, 3.8785e+05, 3.8529e+05, 3.2849e+00, 3.9862e+05, 3.3214e+00,
         3.8697e+05, 0.0000e+00, 3.6284e+00, 3.4824e+00, 3.1529e+00, 4.0967e+05,
         3.9172e+05],
        [3.5970e+00, 3.8781e+05, 3.8533e+05, 3.1429e+00, 3.9864e+05, 3.6686e+00,
         3.8701e+05, 3.6284e+00, 0.0000e+00, 3.4929e+00, 3.4945e+00, 4.0973e+05,
         3.9180e+05],
        [3.3807e+00, 3.8776e+05, 3.8529e+05, 3.2457e+00, 3.9861e+05, 3.4989e+00,
         3.8700e+05, 3.4824e+00, 3.4929e+00, 0.0000e+00, 3.1952e+00, 4.0971e+05,
         3.9177e+05],
        [3.3755e+00, 3.8785e+05, 3.8533e+05, 3.2817e+00, 3.9862e+05, 3.2264e+00,
         3.8701e+05, 3.1529e+00, 3.4945e+00, 3.1952e+00, 0.0000e+00, 4.0968e+05,
         3.9175e+05],
        [4.0968e+05, 8.0365e+05, 8.0576e+05, 4.0969e+05, 8.1950e+05, 4.0965e+05,
         7.9989e+05, 4.0967e+05, 4.0973e+05, 4.0971e+05, 4.0968e+05, 0.0000e+00,
         7.9018e+05],
        [3.9174e+05, 7.9226e+05, 7.7225e+05, 3.9176e+05, 7.5876e+05, 3.9174e+05,
         7.6830e+05, 3.9172e+05, 3.9180e+05, 3.9177e+05, 3.9175e+05, 7.9018e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.2023e+00, 3.2571e+00, 3.2790e+00, 3.3755e+00, 3.3807e+00,
        3.5970e+00, 3.8535e+05, 3.8699e+05, 3.8778e+05, 3.9174e+05, 3.9861e+05,
        4.0968e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 387756.4688, 387770.1562, 387780.3750, 387811.4375,
        387814.3750, 387846.0625, 387853.4062, 774148.3125, 783035.7500,
        783546.3125, 792260.3750, 803653.3750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 385285.8438, 385291.5625, 385318.5625, 385326.2500,
        385333.2812, 385333.5000, 385353.5000, 771779.3125, 772253.2500,
        774148.3125, 774357.6875, 805759.7500])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.1429e+00, 3.2457e+00, 3.2571e+00, 3.2817e+00, 3.2849e+00,
        3.3240e+00, 3.8532e+05, 3.8701e+05, 3.8777e+05, 3.9176e+05, 3.9854e+05,
        4.0969e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 398537.8125, 398609.7188, 398610.1562, 398617.5625,
        398619.3750, 398642.6250, 398647.6250, 758763.0000, 771779.3125,
        778129.0000, 783035.7500, 819503.5625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.2264e+00, 3.2790e+00, 3.3214e+00, 3.3240e+00, 3.4989e+00,
        3.6686e+00, 3.8533e+05, 3.8695e+05, 3.8781e+05, 3.9174e+05, 3.9865e+05,
        4.0965e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 386954.1875, 386965.2812, 386987.0938, 387003.1875,
        387005.0625, 387006.4062, 387012.5000, 768298.4375, 774357.6875,
        778129.0000, 783546.3125, 799888.8750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.1529e+00, 3.2023e+00, 3.2849e+00, 3.3214e+00, 3.4824e+00,
        3.6284e+00, 3.8529e+05, 3.8697e+05, 3.8785e+05, 3.9172e+05, 3.9862e+05,
        4.0967e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.1429e+00, 3.4929e+00, 3.4945e+00, 3.5970e+00, 3.6284e+00,
        3.6686e+00, 3.8533e+05, 3.8701e+05, 3.8781e+05, 3.9180e+05, 3.9864e+05,
        4.0973e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.1952e+00, 3.2457e+00, 3.3807e+00, 3.4824e+00, 3.4929e+00,
        3.4989e+00, 3.8529e+05, 3.8700e+05, 3.8776e+05, 3.9177e+05, 3.9861e+05,
        4.0971e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.1529e+00, 3.1952e+00, 3.2264e+00, 3.2817e+00, 3.3755e+00,
        3.4945e+00, 3.8533e+05, 3.8701e+05, 3.8785e+05, 3.9175e+05, 3.9862e+05,
        4.0968e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 409654.9375, 409671.5625, 409679.8438, 409684.9062,
        409689.0000, 409708.1562, 409729.7500, 790176.5625, 799888.8750,
        803653.3750, 805759.7500, 819503.5625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 391723.8125, 391737.5625, 391743.7812, 391751.9062,
        391755.7812, 391773.4688, 391801.9062, 758763.0000, 768298.4375,
        772253.2500, 790176.5625, 792260.3750])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['96545.08', '436097.56', '433627.72', '96543.82', '443630.97', '96538.47', '434653.97', '96534.62', '96544.21', '96538.66', '96544.79', '457249.34', '437631.38']
estimated f for each client, fs: [6, 4, 5, 6, 4, 6, 4, 6, 6, 6, 6, 4, 4]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 14, 18, 11, 13, 7, 15, 4, 9, 1, 10, 17, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0080s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:26...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[  3 234]
 [  3 260]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:26, End: 2025-07-22 15:46:26)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [20], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
rkrum, clients_type: ['Chosen Update'], selected_client_indices: [20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0000s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:26...
global Accuracy on shared test data: 50.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 42 195]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:26, End: 2025-07-22 15:46:26)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [4, 16, 20, 8, 1, 3, 6, 5, 7, 12, 14, 10, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.9330e+05, 3.9365e+05, 3.3753e+00, 3.5198e+00, 3.3591e+00,
         3.5307e+00, 3.3849e+00, 3.2544e+00, 3.3691e+00, 3.9318e+05, 3.3259e+00,
         3.8561e+05],
        [3.9330e+05, 0.0000e+00, 7.6719e+05, 3.9336e+05, 3.9334e+05, 3.9335e+05,
         3.9340e+05, 3.9335e+05, 3.9335e+05, 3.9336e+05, 7.7245e+05, 3.9336e+05,
         7.8465e+05],
        [3.9365e+05, 7.6719e+05, 0.0000e+00, 3.9366e+05, 3.9361e+05, 3.9362e+05,
         3.9366e+05, 3.9357e+05, 3.9360e+05, 3.9362e+05, 8.0423e+05, 3.9362e+05,
         7.7220e+05],
        [3.3753e+00, 3.9336e+05, 3.9366e+05, 0.0000e+00, 3.4407e+00, 3.1346e+00,
         3.7369e+00, 3.9090e+00, 3.4301e+00, 3.6706e+00, 3.9309e+05, 3.2786e+00,
         3.8559e+05],
        [3.5198e+00, 3.9334e+05, 3.9361e+05, 3.4407e+00, 0.0000e+00, 3.2054e+00,
         3.5692e+00, 3.4308e+00, 3.5034e+00, 3.4975e+00, 3.9313e+05, 3.1800e+00,
         3.8561e+05],
        [3.3591e+00, 3.9335e+05, 3.9362e+05, 3.1346e+00, 3.2054e+00, 0.0000e+00,
         3.3802e+00, 3.4714e+00, 3.3554e+00, 3.3974e+00, 3.9317e+05, 3.3497e+00,
         3.8558e+05],
        [3.5307e+00, 3.9340e+05, 3.9366e+05, 3.7369e+00, 3.5692e+00, 3.3802e+00,
         0.0000e+00, 3.4660e+00, 3.4110e+00, 3.6439e+00, 3.9314e+05, 3.5572e+00,
         3.8558e+05],
        [3.3849e+00, 3.9335e+05, 3.9357e+05, 3.9090e+00, 3.4308e+00, 3.4714e+00,
         3.4660e+00, 0.0000e+00, 3.4785e+00, 3.6666e+00, 3.9316e+05, 3.6255e+00,
         3.8562e+05],
        [3.2544e+00, 3.9335e+05, 3.9360e+05, 3.4301e+00, 3.5034e+00, 3.3554e+00,
         3.4110e+00, 3.4785e+00, 0.0000e+00, 3.5183e+00, 3.9312e+05, 3.0708e+00,
         3.8555e+05],
        [3.3691e+00, 3.9336e+05, 3.9362e+05, 3.6706e+00, 3.4975e+00, 3.3974e+00,
         3.6439e+00, 3.6666e+00, 3.5183e+00, 0.0000e+00, 3.9317e+05, 3.2613e+00,
         3.8559e+05],
        [3.9318e+05, 7.7245e+05, 8.0423e+05, 3.9309e+05, 3.9313e+05, 3.9317e+05,
         3.9314e+05, 3.9316e+05, 3.9312e+05, 3.9317e+05, 0.0000e+00, 3.9315e+05,
         7.8663e+05],
        [3.3259e+00, 3.9336e+05, 3.9362e+05, 3.2786e+00, 3.1800e+00, 3.3497e+00,
         3.5572e+00, 3.6255e+00, 3.0708e+00, 3.2613e+00, 3.9315e+05, 0.0000e+00,
         3.8560e+05],
        [3.8561e+05, 7.8465e+05, 7.7220e+05, 3.8559e+05, 3.8561e+05, 3.8558e+05,
         3.8558e+05, 3.8562e+05, 3.8555e+05, 3.8559e+05, 7.8663e+05, 3.8560e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.2544e+00, 3.3259e+00, 3.3591e+00, 3.3691e+00, 3.3753e+00,
        3.3849e+00, 3.5198e+00, 3.5307e+00, 3.8561e+05, 3.9318e+05, 3.9330e+05,
        3.9365e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 393300.8750, 393342.6562, 393345.0625, 393350.0938,
        393352.5625, 393358.3438, 393359.7500, 393360.0312, 393399.5938,
        767192.3125, 772453.7500, 784653.6875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393570.6875, 393604.3750, 393609.1250, 393615.0625,
        393621.8125, 393623.2812, 393652.9062, 393659.2812, 393659.6875,
        767192.3125, 772204.6875, 804226.1250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.1346e+00, 3.2786e+00, 3.3753e+00, 3.4301e+00, 3.4407e+00,
        3.6706e+00, 3.7369e+00, 3.9090e+00, 3.8559e+05, 3.9309e+05, 3.9336e+05,
        3.9366e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.1800e+00, 3.2054e+00, 3.4308e+00, 3.4407e+00, 3.4975e+00,
        3.5034e+00, 3.5198e+00, 3.5692e+00, 3.8561e+05, 3.9313e+05, 3.9334e+05,
        3.9361e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.1346e+00, 3.2054e+00, 3.3497e+00, 3.3554e+00, 3.3591e+00,
        3.3802e+00, 3.3974e+00, 3.4714e+00, 3.8558e+05, 3.9317e+05, 3.9335e+05,
        3.9362e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.3802e+00, 3.4110e+00, 3.4660e+00, 3.5307e+00, 3.5572e+00,
        3.5692e+00, 3.6439e+00, 3.7369e+00, 3.8558e+05, 3.9314e+05, 3.9340e+05,
        3.9366e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.3849e+00, 3.4308e+00, 3.4660e+00, 3.4714e+00, 3.4785e+00,
        3.6255e+00, 3.6666e+00, 3.9090e+00, 3.8562e+05, 3.9316e+05, 3.9335e+05,
        3.9357e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.0708e+00, 3.2544e+00, 3.3554e+00, 3.4110e+00, 3.4301e+00,
        3.4785e+00, 3.5034e+00, 3.5183e+00, 3.8555e+05, 3.9312e+05, 3.9335e+05,
        3.9360e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.2613e+00, 3.3691e+00, 3.3974e+00, 3.4975e+00, 3.5183e+00,
        3.6439e+00, 3.6666e+00, 3.6706e+00, 3.8559e+05, 3.9317e+05, 3.9336e+05,
        3.9362e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 393089.6250, 393122.3750, 393131.3125, 393139.5938,
        393151.4062, 393162.3125, 393165.4375, 393172.4062, 393179.4062,
        772453.7500, 786631.6250, 804226.1250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.0708e+00, 3.1800e+00, 3.2613e+00, 3.2786e+00, 3.3259e+00,
        3.3497e+00, 3.5572e+00, 3.6255e+00, 3.8560e+05, 3.9315e+05, 3.9336e+05,
        3.9362e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 385551.7812, 385577.0312, 385584.5000, 385585.1250,
        385593.3750, 385604.6562, 385607.2188, 385610.6562, 385617.0312,
        772204.6875, 784653.6875, 786631.6250])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['3.39', '393352.09', '393624.00', '3.50', '3.42', '3.33', '3.54', '3.55', '3.38', '3.50', '393146.03', '3.33', '385589.31']
estimated f for each client, fs: [4, 2, 2, 4, 4, 4, 4, 4, 4, 4, 2, 4, 4]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']], selected_client_indices: [4, 16, 20, 8, 1, 3, 6, 5, 7, 12, 14, 10, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0115s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:27...
global Accuracy on shared test data: 50.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 47 190]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:27, End: 2025-07-22 15:46:27)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (8): [6, 12, 19, 17, 1, 8, 7, 18], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 8
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([8])
tensor([[0.0000e+00, 3.5716e+00, 3.9857e+05, 3.8722e+05, 3.6286e+00, 3.7555e+00,
         3.5025e+00, 4.0163e+05],
        [3.5716e+00, 0.0000e+00, 3.9856e+05, 3.8719e+05, 3.4798e+00, 3.5545e+00,
         3.5483e+00, 4.0161e+05],
        [3.9857e+05, 3.9856e+05, 0.0000e+00, 8.0735e+05, 3.9862e+05, 3.9855e+05,
         3.9859e+05, 7.8524e+05],
        [3.8722e+05, 3.8719e+05, 8.0735e+05, 0.0000e+00, 3.8718e+05, 3.8714e+05,
         3.8725e+05, 7.9380e+05],
        [3.6286e+00, 3.4798e+00, 3.9862e+05, 3.8718e+05, 0.0000e+00, 3.4808e+00,
         3.6110e+00, 4.0166e+05],
        [3.7555e+00, 3.5545e+00, 3.9855e+05, 3.8714e+05, 3.4808e+00, 0.0000e+00,
         3.5441e+00, 4.0158e+05],
        [3.5025e+00, 3.5483e+00, 3.9859e+05, 3.8725e+05, 3.6110e+00, 3.5441e+00,
         0.0000e+00, 4.0165e+05],
        [4.0163e+05, 4.0161e+05, 7.8524e+05, 7.9380e+05, 4.0166e+05, 4.0158e+05,
         4.0165e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.5025e+00, 3.5716e+00, 3.6286e+00, 3.7555e+00, 3.8722e+05,
        3.9857e+05, 4.0163e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.4798e+00, 3.5483e+00, 3.5545e+00, 3.5716e+00, 3.8719e+05,
        3.9856e+05, 4.0161e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 398548.3750, 398559.4688, 398573.0312, 398587.7188,
        398617.1250, 785243.7500, 807347.3125])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 387141.5312, 387178.1562, 387194.7812, 387216.0312,
        387254.5000, 793796.6875, 807347.3125])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.4798e+00, 3.4808e+00, 3.6110e+00, 3.6286e+00, 3.8718e+05,
        3.9862e+05, 4.0166e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.4808e+00, 3.5441e+00, 3.5545e+00, 3.7555e+00, 3.8714e+05,
        3.9855e+05, 4.0158e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.5025e+00, 3.5441e+00, 3.5483e+00, 3.6110e+00, 3.8725e+05,
        3.9859e+05, 4.0165e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 401579.6875, 401607.3125, 401634.0000, 401645.6250,
        401656.4375, 785243.7500, 793796.6875])
Index of maximum distance difference after half of values: 6
adaptive_Krum scores:  ['130967.25', '130961.41', '463021.59', '454963.62', '130968.25', '130950.71', '130976.09', '465561.16']
estimated f for each client, fs: [3, 3, 1, 2, 3, 3, 3, 1]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']], selected_client_indices: [6, 12, 19, 17, 1, 8, 7, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:27...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 54 183]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:27, End: 2025-07-22 15:46:27)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [4, 6, 12, 5, 8, 1, 3, 18, 11, 16, 2, 15, 19, 7, 9, 14, 10, 17, 13], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.6250e+00, 3.3366e+00, 3.4135e+00, 3.4325e+00, 3.5820e+00,
         3.5066e+00, 3.9701e+05, 3.6031e+00, 3.9923e+05, 3.5252e+00, 3.8858e+05,
         3.8479e+05, 3.4366e+00, 3.8867e+00, 3.9860e+05, 3.4274e+00, 3.8878e+05,
         3.9355e+05],
        [3.6250e+00, 0.0000e+00, 3.5534e+00, 3.5576e+00, 3.7842e+00, 3.6406e+00,
         3.5615e+00, 3.9699e+05, 3.7606e+00, 3.9918e+05, 3.7936e+00, 3.8864e+05,
         3.8485e+05, 3.5759e+00, 4.2315e+00, 3.9866e+05, 3.6167e+00, 3.8878e+05,
         3.9359e+05],
        [3.3366e+00, 3.5534e+00, 0.0000e+00, 3.6569e+00, 3.5271e+00, 3.4413e+00,
         3.3788e+00, 3.9699e+05, 3.5254e+00, 3.9922e+05, 3.3287e+00, 3.8858e+05,
         3.8479e+05, 3.6402e+00, 3.9256e+00, 3.9868e+05, 3.2156e+00, 3.8875e+05,
         3.9357e+05],
        [3.4135e+00, 3.5576e+00, 3.6569e+00, 0.0000e+00, 3.9807e+00, 3.4862e+00,
         3.5662e+00, 3.9698e+05, 3.7656e+00, 3.9921e+05, 3.5549e+00, 3.8862e+05,
         3.8482e+05, 3.5822e+00, 3.9236e+00, 3.9865e+05, 3.6763e+00, 3.8880e+05,
         3.9357e+05],
        [3.4325e+00, 3.7842e+00, 3.5271e+00, 3.9807e+00, 0.0000e+00, 3.4597e+00,
         3.3708e+00, 3.9698e+05, 3.6789e+00, 3.9920e+05, 3.5141e+00, 3.8861e+05,
         3.8477e+05, 3.6161e+00, 3.9299e+00, 3.9862e+05, 3.3055e+00, 3.8879e+05,
         3.9362e+05],
        [3.5820e+00, 3.6406e+00, 3.4413e+00, 3.4862e+00, 3.4597e+00, 0.0000e+00,
         3.4208e+00, 3.9697e+05, 3.6114e+00, 3.9923e+05, 3.4155e+00, 3.8862e+05,
         3.8484e+05, 3.6924e+00, 3.4302e+00, 3.9863e+05, 3.3942e+00, 3.8879e+05,
         3.9364e+05],
        [3.5066e+00, 3.5615e+00, 3.3788e+00, 3.5662e+00, 3.3708e+00, 3.4208e+00,
         0.0000e+00, 3.9699e+05, 3.6411e+00, 3.9918e+05, 3.4758e+00, 3.8860e+05,
         3.8483e+05, 3.6120e+00, 3.7818e+00, 3.9869e+05, 3.5841e+00, 3.8881e+05,
         3.9357e+05],
        [3.9701e+05, 3.9699e+05, 3.9699e+05, 3.9698e+05, 3.9698e+05, 3.9697e+05,
         3.9699e+05, 0.0000e+00, 3.9701e+05, 8.1186e+05, 3.9697e+05, 7.9555e+05,
         7.7877e+05, 3.9705e+05, 3.9703e+05, 8.0199e+05, 3.9701e+05, 7.6691e+05,
         7.8855e+05],
        [3.6031e+00, 3.7606e+00, 3.5254e+00, 3.7656e+00, 3.6789e+00, 3.6114e+00,
         3.6411e+00, 3.9701e+05, 0.0000e+00, 3.9919e+05, 3.3504e+00, 3.8858e+05,
         3.8483e+05, 3.8938e+00, 3.8155e+00, 3.9861e+05, 3.6194e+00, 3.8881e+05,
         3.9356e+05],
        [3.9923e+05, 3.9918e+05, 3.9922e+05, 3.9921e+05, 3.9920e+05, 3.9923e+05,
         3.9918e+05, 8.1186e+05, 3.9919e+05, 0.0000e+00, 3.9922e+05, 7.8722e+05,
         7.7528e+05, 3.9918e+05, 3.9920e+05, 8.0677e+05, 3.9921e+05, 7.7550e+05,
         8.0481e+05],
        [3.5252e+00, 3.7936e+00, 3.3287e+00, 3.5549e+00, 3.5141e+00, 3.4155e+00,
         3.4758e+00, 3.9697e+05, 3.3504e+00, 3.9922e+05, 0.0000e+00, 3.8860e+05,
         3.8486e+05, 3.5805e+00, 3.6103e+00, 3.9868e+05, 3.4176e+00, 3.8881e+05,
         3.9361e+05],
        [3.8858e+05, 3.8864e+05, 3.8858e+05, 3.8862e+05, 3.8861e+05, 3.8862e+05,
         3.8860e+05, 7.9555e+05, 3.8858e+05, 7.8722e+05, 3.8860e+05, 0.0000e+00,
         7.5321e+05, 3.8864e+05, 3.8854e+05, 7.9556e+05, 3.8860e+05, 7.5781e+05,
         7.8345e+05],
        [3.8479e+05, 3.8485e+05, 3.8479e+05, 3.8482e+05, 3.8477e+05, 3.8484e+05,
         3.8483e+05, 7.7877e+05, 3.8483e+05, 7.7528e+05, 3.8486e+05, 7.5321e+05,
         0.0000e+00, 3.8479e+05, 3.8483e+05, 7.8310e+05, 3.8485e+05, 7.7880e+05,
         7.6254e+05],
        [3.4366e+00, 3.5759e+00, 3.6402e+00, 3.5822e+00, 3.6161e+00, 3.6924e+00,
         3.6120e+00, 3.9705e+05, 3.8938e+00, 3.9918e+05, 3.5805e+00, 3.8864e+05,
         3.8479e+05, 0.0000e+00, 3.9522e+00, 3.9866e+05, 3.1633e+00, 3.8877e+05,
         3.9353e+05],
        [3.8867e+00, 4.2315e+00, 3.9256e+00, 3.9236e+00, 3.9299e+00, 3.4302e+00,
         3.7818e+00, 3.9703e+05, 3.8155e+00, 3.9920e+05, 3.6103e+00, 3.8854e+05,
         3.8483e+05, 3.9522e+00, 0.0000e+00, 3.9864e+05, 3.8619e+00, 3.8879e+05,
         3.9360e+05],
        [3.9860e+05, 3.9866e+05, 3.9868e+05, 3.9865e+05, 3.9862e+05, 3.9863e+05,
         3.9869e+05, 8.0199e+05, 3.9861e+05, 8.0677e+05, 3.9868e+05, 7.9556e+05,
         7.8310e+05, 3.9866e+05, 3.9864e+05, 0.0000e+00, 3.9866e+05, 7.7711e+05,
         8.0411e+05],
        [3.4274e+00, 3.6167e+00, 3.2156e+00, 3.6763e+00, 3.3055e+00, 3.3942e+00,
         3.5841e+00, 3.9701e+05, 3.6194e+00, 3.9921e+05, 3.4176e+00, 3.8860e+05,
         3.8485e+05, 3.1633e+00, 3.8619e+00, 3.9866e+05, 0.0000e+00, 3.8878e+05,
         3.9360e+05],
        [3.8878e+05, 3.8878e+05, 3.8875e+05, 3.8880e+05, 3.8879e+05, 3.8879e+05,
         3.8881e+05, 7.6691e+05, 3.8881e+05, 7.7550e+05, 3.8881e+05, 7.5781e+05,
         7.7880e+05, 3.8877e+05, 3.8879e+05, 7.7711e+05, 3.8878e+05, 0.0000e+00,
         7.8765e+05],
        [3.9355e+05, 3.9359e+05, 3.9357e+05, 3.9357e+05, 3.9362e+05, 3.9364e+05,
         3.9357e+05, 7.8855e+05, 3.9356e+05, 8.0481e+05, 3.9361e+05, 7.8345e+05,
         7.6254e+05, 3.9353e+05, 3.9360e+05, 8.0411e+05, 3.9360e+05, 7.8765e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.3366e+00, 3.4135e+00, 3.4274e+00, 3.4325e+00, 3.4366e+00,
        3.5066e+00, 3.5252e+00, 3.5820e+00, 3.6031e+00, 3.6250e+00, 3.8867e+00,
        3.8479e+05, 3.8858e+05, 3.8878e+05, 3.9355e+05, 3.9701e+05, 3.9860e+05,
        3.9923e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.5534e+00, 3.5576e+00, 3.5615e+00, 3.5759e+00, 3.6167e+00,
        3.6250e+00, 3.6406e+00, 3.7606e+00, 3.7842e+00, 3.7936e+00, 4.2315e+00,
        3.8485e+05, 3.8864e+05, 3.8878e+05, 3.9359e+05, 3.9699e+05, 3.9866e+05,
        3.9918e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.2156e+00, 3.3287e+00, 3.3366e+00, 3.3788e+00, 3.4413e+00,
        3.5254e+00, 3.5271e+00, 3.5534e+00, 3.6402e+00, 3.6569e+00, 3.9256e+00,
        3.8479e+05, 3.8858e+05, 3.8875e+05, 3.9357e+05, 3.9699e+05, 3.9868e+05,
        3.9922e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4135e+00, 3.4862e+00, 3.5549e+00, 3.5576e+00, 3.5662e+00,
        3.5822e+00, 3.6569e+00, 3.6763e+00, 3.7656e+00, 3.9236e+00, 3.9807e+00,
        3.8482e+05, 3.8862e+05, 3.8880e+05, 3.9357e+05, 3.9698e+05, 3.9865e+05,
        3.9921e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3055e+00, 3.3708e+00, 3.4325e+00, 3.4597e+00, 3.5141e+00,
        3.5271e+00, 3.6161e+00, 3.6789e+00, 3.7842e+00, 3.9299e+00, 3.9807e+00,
        3.8477e+05, 3.8861e+05, 3.8879e+05, 3.9362e+05, 3.9698e+05, 3.9862e+05,
        3.9920e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3942e+00, 3.4155e+00, 3.4208e+00, 3.4302e+00, 3.4413e+00,
        3.4597e+00, 3.4862e+00, 3.5820e+00, 3.6114e+00, 3.6406e+00, 3.6924e+00,
        3.8484e+05, 3.8862e+05, 3.8879e+05, 3.9364e+05, 3.9697e+05, 3.9863e+05,
        3.9923e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.3708e+00, 3.3788e+00, 3.4208e+00, 3.4758e+00, 3.5066e+00,
        3.5615e+00, 3.5662e+00, 3.5841e+00, 3.6120e+00, 3.6411e+00, 3.7818e+00,
        3.8483e+05, 3.8860e+05, 3.8881e+05, 3.9357e+05, 3.9699e+05, 3.9869e+05,
        3.9918e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396967.0312, 396973.2500, 396984.0625, 396984.0938,
        396985.8125, 396989.2812, 396992.8438, 397007.7812, 397011.3750,
        397012.7500, 397030.1250, 397054.8125, 766913.1875, 778765.8125,
        788552.0000, 795554.9375, 801992.3750, 811860.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.3504e+00, 3.5254e+00, 3.6031e+00, 3.6114e+00, 3.6194e+00,
        3.6411e+00, 3.6789e+00, 3.7606e+00, 3.7656e+00, 3.8155e+00, 3.8938e+00,
        3.8483e+05, 3.8858e+05, 3.8881e+05, 3.9356e+05, 3.9701e+05, 3.9861e+05,
        3.9919e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 399180.2500, 399181.0000, 399184.4062, 399186.8750,
        399200.6875, 399202.0625, 399207.4375, 399211.3125, 399216.8438,
        399217.9375, 399228.3750, 399228.8750, 775275.8750, 775500.0625,
        787223.8125, 804812.3125, 806767.0000, 811860.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.3287e+00, 3.3504e+00, 3.4155e+00, 3.4176e+00, 3.4758e+00,
        3.5141e+00, 3.5252e+00, 3.5549e+00, 3.5805e+00, 3.6103e+00, 3.7936e+00,
        3.8486e+05, 3.8860e+05, 3.8881e+05, 3.9361e+05, 3.9697e+05, 3.9868e+05,
        3.9922e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388539.0312, 388576.0625, 388576.8438, 388576.9375,
        388595.8438, 388601.5000, 388601.8750, 388608.3125, 388621.3125,
        388624.8438, 388639.2188, 388644.0625, 753212.3750, 757812.3750,
        783451.1250, 787223.8125, 795554.9375, 795562.3125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 384771.8750, 384788.1250, 384788.5625, 384793.9688,
        384816.3750, 384826.3750, 384828.0000, 384828.4688, 384837.3125,
        384847.8438, 384853.4375, 384855.8438, 753212.3750, 762536.8750,
        775275.8750, 778765.8125, 778801.3750, 783098.5000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.1633e+00, 3.4366e+00, 3.5759e+00, 3.5805e+00, 3.5822e+00,
        3.6120e+00, 3.6161e+00, 3.6402e+00, 3.6924e+00, 3.8938e+00, 3.9522e+00,
        3.8479e+05, 3.8864e+05, 3.8877e+05, 3.9353e+05, 3.9705e+05, 3.9866e+05,
        3.9918e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.4302e+00, 3.6103e+00, 3.7818e+00, 3.8155e+00, 3.8619e+00,
        3.8867e+00, 3.9236e+00, 3.9256e+00, 3.9299e+00, 3.9522e+00, 4.2315e+00,
        3.8483e+05, 3.8854e+05, 3.8879e+05, 3.9360e+05, 3.9703e+05, 3.9864e+05,
        3.9920e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398604.8750, 398608.4688, 398616.0938, 398626.1250,
        398635.8438, 398650.8750, 398660.2812, 398662.5000, 398664.1875,
        398678.4062, 398682.6250, 398687.8750, 777109.3750, 783098.5000,
        795562.3125, 801992.3750, 804110.5625, 806767.0000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 3.1633e+00, 3.2156e+00, 3.3055e+00, 3.3942e+00, 3.4176e+00,
        3.4274e+00, 3.5841e+00, 3.6167e+00, 3.6194e+00, 3.6763e+00, 3.8619e+00,
        3.8485e+05, 3.8860e+05, 3.8878e+05, 3.9360e+05, 3.9701e+05, 3.9866e+05,
        3.9921e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388751.4062, 388771.5000, 388776.5625, 388778.3125,
        388781.4375, 388785.5312, 388787.6562, 388792.8125, 388800.5000,
        388810.0000, 388811.3438, 388811.6875, 757812.3750, 766913.1875,
        775500.0625, 777109.3750, 778801.3750, 787648.6250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 393534.2500, 393550.0000, 393557.6562, 393566.8750,
        393573.6875, 393573.8750, 393593.3438, 393596.0312, 393596.7500,
        393607.7500, 393615.5000, 393635.2500, 762536.8750, 783451.1250,
        787648.6250, 788552.0000, 804110.5625, 804812.3125])
Index of maximum distance difference after half of values: 12
adaptive_Krum scores:  ['3.53', '3.70', '3.50', '3.65', '3.60', '3.51', '3.54', '396999.44', '3.66', '399203.88', '3.51', '388600.50', '384819.69', '3.61', '3.85', '398648.19', '3.48', '388788.25', '393583.41']
estimated f for each client, fs: [7, 7, 7, 7, 7, 7, 7, 5, 7, 5, 7, 5, 5, 7, 7, 5, 7, 5, 5]
selected_index: 16
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']
 ['Update 17']
 ['Update 18']], selected_client_indices: [4, 6, 12, 5, 8, 1, 3, 18, 11, 16, 2, 15, 19, 7, 9, 14, 10, 17, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0326s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:28...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 64 173]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:28, End: 2025-07-22 15:46:28)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (8): [8, 9, 20, 4, 3, 2, 5, 14], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 8
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([8])
tensor([[0.0000e+00, 4.0320e+00, 3.9573e+05, 3.4906e+00, 3.3910e+00, 3.5358e+00,
         4.0291e+00, 3.7804e+05],
        [4.0320e+00, 0.0000e+00, 3.9575e+05, 4.0385e+00, 3.8944e+00, 3.7534e+00,
         4.1581e+00, 3.7807e+05],
        [3.9573e+05, 3.9575e+05, 0.0000e+00, 3.9577e+05, 3.9574e+05, 3.9575e+05,
         3.9574e+05, 7.8913e+05],
        [3.4906e+00, 4.0385e+00, 3.9577e+05, 0.0000e+00, 3.4874e+00, 3.6549e+00,
         3.4596e+00, 3.7807e+05],
        [3.3910e+00, 3.8944e+00, 3.9574e+05, 3.4874e+00, 0.0000e+00, 3.5436e+00,
         3.6264e+00, 3.7808e+05],
        [3.5358e+00, 3.7534e+00, 3.9575e+05, 3.6549e+00, 3.5436e+00, 0.0000e+00,
         3.6109e+00, 3.7806e+05],
        [4.0291e+00, 4.1581e+00, 3.9574e+05, 3.4596e+00, 3.6264e+00, 3.6109e+00,
         0.0000e+00, 3.7807e+05],
        [3.7804e+05, 3.7807e+05, 7.8913e+05, 3.7807e+05, 3.7808e+05, 3.7806e+05,
         3.7807e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.3910e+00, 3.4906e+00, 3.5358e+00, 4.0291e+00, 4.0320e+00,
        3.7804e+05, 3.9573e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.7534e+00, 3.8944e+00, 4.0320e+00, 4.0385e+00, 4.1581e+00,
        3.7807e+05, 3.9575e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 395730.3438, 395735.2812, 395739.4375, 395745.8750,
        395748.3438, 395767.7188, 789127.1250])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.4596e+00, 3.4874e+00, 3.4906e+00, 3.6549e+00, 4.0385e+00,
        3.7807e+05, 3.9577e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.3910e+00, 3.4874e+00, 3.5436e+00, 3.6264e+00, 3.8944e+00,
        3.7808e+05, 3.9574e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.5358e+00, 3.5436e+00, 3.6109e+00, 3.6549e+00, 3.7534e+00,
        3.7806e+05, 3.9575e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.4596e+00, 3.6109e+00, 3.6264e+00, 4.0291e+00, 4.1581e+00,
        3.7807e+05, 3.9574e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 378041.3438, 378060.5625, 378067.9375, 378069.2812,
        378074.4688, 378079.2812, 789127.1250])
Index of maximum distance difference after half of values: 6
adaptive_Krum scores:  ['63009.97', '63014.86', '395744.50', '63015.44', '63016.20', '63013.11', '63014.47', '378065.50']
estimated f for each client, fs: [2, 2, 0, 2, 2, 2, 2, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']], selected_client_indices: [8, 9, 20, 4, 3, 2, 5, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:28...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 71 166]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:28, End: 2025-07-22 15:46:28)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [16, 12, 4], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[0.0000e+00, 3.9661e+05, 3.9661e+05],
        [3.9661e+05, 0.0000e+00, 3.3385e+00],
        [3.9661e+05, 3.3385e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 396609.1562, 396610.7812])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000e+00, 3.3385e+00, 3.9661e+05])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000e+00, 3.3385e+00, 3.9661e+05])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['396609.97', '198306.25', '198307.05']
estimated f for each client, fs: [0, 1, 1]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']], selected_client_indices: [16, 12, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0019s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:28...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 80 157]
 [ 80 183]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:28, End: 2025-07-22 15:46:28)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [2, 7, 9], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[0.0000, 3.6986, 3.8617],
        [3.6986, 0.0000, 4.2354],
        [3.8617, 4.2354, 0.0000]])
sorted_distances: tensor([0.0000, 3.6986, 3.8617])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000, 3.6986, 4.2354])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000, 3.8617, 4.2354])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['3.78', '3.97', '4.05']
estimated f for each client, fs: [0, 0, 0]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']], selected_client_indices: [2, 7, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0019s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:29...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 86 151]
 [ 87 176]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:29, End: 2025-07-22 15:46:29)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [8, 3, 10, 19, 17, 12, 9, 4, 11, 14, 18, 2, 13, 7, 15, 20, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.5068e+00, 3.3228e+00, 3.7701e+05, 3.9360e+05, 3.6728e+00,
         3.9363e+00, 3.5333e+00, 3.6908e+00, 4.0160e+05, 3.9629e+05, 3.5684e+00,
         3.9410e+05, 3.6082e+00, 3.8787e+05, 4.0589e+05, 3.8784e+00],
        [3.5068e+00, 0.0000e+00, 3.5090e+00, 3.7702e+05, 3.9359e+05, 3.4252e+00,
         3.9076e+00, 3.5570e+00, 3.7581e+00, 4.0162e+05, 3.9623e+05, 3.7782e+00,
         3.9406e+05, 3.7154e+00, 3.8787e+05, 4.0588e+05, 3.8002e+00],
        [3.3228e+00, 3.5090e+00, 0.0000e+00, 3.7707e+05, 3.9359e+05, 3.3496e+00,
         3.8485e+00, 3.4894e+00, 3.6096e+00, 4.0158e+05, 3.9627e+05, 3.5830e+00,
         3.9408e+05, 3.4537e+00, 3.8785e+05, 4.0590e+05, 3.6174e+00],
        [3.7701e+05, 3.7702e+05, 3.7707e+05, 0.0000e+00, 7.8277e+05, 3.7700e+05,
         3.7700e+05, 3.7703e+05, 3.7701e+05, 7.7483e+05, 7.7687e+05, 3.7701e+05,
         7.7736e+05, 3.7699e+05, 7.8013e+05, 8.0470e+05, 3.7702e+05],
        [3.9360e+05, 3.9359e+05, 3.9359e+05, 7.8277e+05, 0.0000e+00, 3.9360e+05,
         3.9366e+05, 3.9361e+05, 3.9362e+05, 7.9397e+05, 7.7012e+05, 3.9360e+05,
         7.7485e+05, 3.9362e+05, 7.7636e+05, 8.0197e+05, 3.9358e+05],
        [3.6728e+00, 3.4252e+00, 3.3496e+00, 3.7700e+05, 3.9360e+05, 0.0000e+00,
         4.0031e+00, 3.4183e+00, 3.6597e+00, 4.0159e+05, 3.9630e+05, 3.6578e+00,
         3.9406e+05, 3.6456e+00, 3.8789e+05, 4.0581e+05, 3.6319e+00],
        [3.9363e+00, 3.9076e+00, 3.8485e+00, 3.7700e+05, 3.9366e+05, 4.0031e+00,
         0.0000e+00, 4.0319e+00, 3.7295e+00, 4.0155e+05, 3.9632e+05, 3.9061e+00,
         3.9410e+05, 4.3030e+00, 3.8784e+05, 4.0586e+05, 4.3414e+00],
        [3.5333e+00, 3.5570e+00, 3.4894e+00, 3.7703e+05, 3.9361e+05, 3.4183e+00,
         4.0319e+00, 0.0000e+00, 3.7232e+00, 4.0160e+05, 3.9626e+05, 3.9353e+00,
         3.9408e+05, 3.6093e+00, 3.8787e+05, 4.0584e+05, 3.6223e+00],
        [3.6908e+00, 3.7581e+00, 3.6096e+00, 3.7701e+05, 3.9362e+05, 3.6597e+00,
         3.7295e+00, 3.7232e+00, 0.0000e+00, 4.0149e+05, 3.9626e+05, 3.5958e+00,
         3.9409e+05, 3.9044e+00, 3.8790e+05, 4.0581e+05, 3.6627e+00],
        [4.0160e+05, 4.0162e+05, 4.0158e+05, 7.7483e+05, 7.9397e+05, 4.0159e+05,
         4.0155e+05, 4.0160e+05, 4.0149e+05, 0.0000e+00, 8.2303e+05, 4.0152e+05,
         7.9599e+05, 4.0162e+05, 8.1076e+05, 7.8121e+05, 4.0158e+05],
        [3.9629e+05, 3.9623e+05, 3.9627e+05, 7.7687e+05, 7.7012e+05, 3.9630e+05,
         3.9632e+05, 3.9626e+05, 3.9626e+05, 8.2303e+05, 0.0000e+00, 3.9628e+05,
         7.7558e+05, 3.9630e+05, 7.7840e+05, 7.8241e+05, 3.9624e+05],
        [3.5684e+00, 3.7782e+00, 3.5830e+00, 3.7701e+05, 3.9360e+05, 3.6578e+00,
         3.9061e+00, 3.9353e+00, 3.5958e+00, 4.0152e+05, 3.9628e+05, 0.0000e+00,
         3.9404e+05, 3.7776e+00, 3.8786e+05, 4.0588e+05, 3.9968e+00],
        [3.9410e+05, 3.9406e+05, 3.9408e+05, 7.7736e+05, 7.7485e+05, 3.9406e+05,
         3.9410e+05, 3.9408e+05, 3.9409e+05, 7.9599e+05, 7.7558e+05, 3.9404e+05,
         0.0000e+00, 3.9407e+05, 7.7927e+05, 7.9799e+05, 3.9411e+05],
        [3.6082e+00, 3.7154e+00, 3.4537e+00, 3.7699e+05, 3.9362e+05, 3.6456e+00,
         4.3030e+00, 3.6093e+00, 3.9044e+00, 4.0162e+05, 3.9630e+05, 3.7776e+00,
         3.9407e+05, 0.0000e+00, 3.8786e+05, 4.0588e+05, 3.7713e+00],
        [3.8787e+05, 3.8787e+05, 3.8785e+05, 7.8013e+05, 7.7636e+05, 3.8789e+05,
         3.8784e+05, 3.8787e+05, 3.8790e+05, 8.1076e+05, 7.7840e+05, 3.8786e+05,
         7.7927e+05, 3.8786e+05, 0.0000e+00, 7.7156e+05, 3.8788e+05],
        [4.0589e+05, 4.0588e+05, 4.0590e+05, 8.0470e+05, 8.0197e+05, 4.0581e+05,
         4.0586e+05, 4.0584e+05, 4.0581e+05, 7.8121e+05, 7.8241e+05, 4.0588e+05,
         7.9799e+05, 4.0588e+05, 7.7156e+05, 0.0000e+00, 4.0585e+05],
        [3.8784e+00, 3.8002e+00, 3.6174e+00, 3.7702e+05, 3.9358e+05, 3.6319e+00,
         4.3414e+00, 3.6223e+00, 3.6627e+00, 4.0158e+05, 3.9624e+05, 3.9968e+00,
         3.9411e+05, 3.7713e+00, 3.8788e+05, 4.0585e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.3228e+00, 3.5068e+00, 3.5333e+00, 3.5684e+00, 3.6082e+00,
        3.6728e+00, 3.6908e+00, 3.8784e+00, 3.9363e+00, 3.7701e+05, 3.8787e+05,
        3.9360e+05, 3.9410e+05, 3.9629e+05, 4.0160e+05, 4.0589e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4252e+00, 3.5068e+00, 3.5090e+00, 3.5570e+00, 3.7154e+00,
        3.7581e+00, 3.7782e+00, 3.8002e+00, 3.9076e+00, 3.7702e+05, 3.8787e+05,
        3.9359e+05, 3.9406e+05, 3.9623e+05, 4.0162e+05, 4.0588e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3228e+00, 3.3496e+00, 3.4537e+00, 3.4894e+00, 3.5090e+00,
        3.5830e+00, 3.6096e+00, 3.6174e+00, 3.8485e+00, 3.7707e+05, 3.8785e+05,
        3.9359e+05, 3.9408e+05, 3.9627e+05, 4.0158e+05, 4.0590e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376992.5625, 376995.8438, 376997.3750, 377005.1250,
        377006.2500, 377012.9375, 377023.4688, 377024.0938, 377033.2812,
        377066.8125, 774830.5000, 776872.8750, 777363.0000, 780125.6250,
        782767.3125, 804695.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393582.6250, 393586.3750, 393591.8438, 393598.0625,
        393601.4688, 393602.4375, 393613.5625, 393616.3125, 393617.0000,
        393659.1250, 770125.0000, 774847.1250, 776355.5000, 782767.3125,
        793967.9375, 801968.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.3496e+00, 3.4183e+00, 3.4252e+00, 3.6319e+00, 3.6456e+00,
        3.6578e+00, 3.6597e+00, 3.6728e+00, 4.0031e+00, 3.7700e+05, 3.8789e+05,
        3.9360e+05, 3.9406e+05, 3.9630e+05, 4.0159e+05, 4.0581e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.7295e+00, 3.8485e+00, 3.9061e+00, 3.9076e+00, 3.9363e+00,
        4.0031e+00, 4.0319e+00, 4.3030e+00, 4.3414e+00, 3.7700e+05, 3.8784e+05,
        3.9366e+05, 3.9410e+05, 3.9632e+05, 4.0155e+05, 4.0586e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4183e+00, 3.4894e+00, 3.5333e+00, 3.5570e+00, 3.6093e+00,
        3.6223e+00, 3.7232e+00, 3.9353e+00, 4.0319e+00, 3.7703e+05, 3.8787e+05,
        3.9361e+05, 3.9408e+05, 3.9626e+05, 4.0160e+05, 4.0584e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5958e+00, 3.6096e+00, 3.6597e+00, 3.6627e+00, 3.6908e+00,
        3.7232e+00, 3.7295e+00, 3.7581e+00, 3.9044e+00, 3.7701e+05, 3.8790e+05,
        3.9362e+05, 3.9409e+05, 3.9626e+05, 4.0149e+05, 4.0581e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401491.2500, 401517.0938, 401546.1875, 401576.2500,
        401584.8438, 401589.2812, 401600.2188, 401600.8125, 401615.7500,
        401615.9688, 774830.5000, 781213.8125, 793967.9375, 795990.5000,
        810756.0625, 823029.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396229.2188, 396238.6250, 396257.9688, 396261.2812,
        396273.3125, 396278.3750, 396285.2188, 396298.3750, 396300.4062,
        396320.5625, 770125.0000, 775579.4375, 776872.8750, 778398.1875,
        782409.6250, 823029.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5684e+00, 3.5830e+00, 3.5958e+00, 3.6578e+00, 3.7776e+00,
        3.7782e+00, 3.9061e+00, 3.9353e+00, 3.9968e+00, 3.7701e+05, 3.8786e+05,
        3.9360e+05, 3.9404e+05, 3.9628e+05, 4.0152e+05, 4.0588e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394039.9688, 394057.7812, 394059.8750, 394071.7188,
        394079.7812, 394083.0625, 394094.2500, 394098.5312, 394100.0312,
        394107.5000, 774847.1250, 775579.4375, 777363.0000, 779272.7500,
        795990.5000, 797987.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4537e+00, 3.6082e+00, 3.6093e+00, 3.6456e+00, 3.7154e+00,
        3.7713e+00, 3.7776e+00, 3.9044e+00, 4.3030e+00, 3.7699e+05, 3.8786e+05,
        3.9362e+05, 3.9407e+05, 3.9630e+05, 4.0162e+05, 4.0588e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387841.6562, 387845.3125, 387861.6875, 387865.0000,
        387870.0000, 387872.1562, 387874.1250, 387879.1562, 387885.0625,
        387901.0625, 771559.5000, 776355.5000, 778398.1875, 779272.7500,
        780125.6250, 810756.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405809.3438, 405814.6875, 405842.7500, 405853.5312,
        405859.0938, 405878.2812, 405880.4062, 405882.5938, 405887.1562,
        405900.6250, 771559.5000, 781213.8125, 782409.6250, 797987.0625,
        801968.9375, 804695.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6174e+00, 3.6223e+00, 3.6319e+00, 3.6627e+00, 3.7713e+00,
        3.8002e+00, 3.8784e+00, 3.9968e+00, 4.3414e+00, 3.7702e+05, 3.8788e+05,
        3.9358e+05, 3.9411e+05, 3.9624e+05, 4.0158e+05, 4.0585e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37704.57', '37705.64', '37709.86', '377015.75', '393606.88', '37702.83', '37703.34', '37706.62', '37703.95', '401573.72', '396274.34', '37703.89', '394079.25', '37702.64', '387869.50', '405860.81', '37705.84']
estimated f for each client, fs: [7, 7, 7, 6, 5, 7, 7, 7, 7, 5, 5, 7, 5, 7, 5, 5, 7]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [8, 3, 10, 19, 17, 12, 9, 4, 11, 14, 18, 2, 13, 7, 15, 20, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0356s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:29...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 92 145]
 [ 92 171]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:29, End: 2025-07-22 15:46:29)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [1, 13, 4, 18, 9, 14, 15, 2, 7, 17], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.7525e+05, 3.9000e+00, 3.8927e+05, 3.7534e+00, 3.8868e+05,
         3.9334e+05, 3.7126e+00, 4.0460e+00, 3.9784e+05],
        [3.7525e+05, 0.0000e+00, 3.7525e+05, 7.7367e+05, 3.7522e+05, 7.7854e+05,
         7.6729e+05, 3.7522e+05, 3.7526e+05, 7.7492e+05],
        [3.9000e+00, 3.7525e+05, 0.0000e+00, 3.8933e+05, 4.0109e+00, 3.8864e+05,
         3.9326e+05, 4.1176e+00, 3.7906e+00, 3.9791e+05],
        [3.8927e+05, 7.7367e+05, 3.8933e+05, 0.0000e+00, 3.8928e+05, 7.9445e+05,
         8.0295e+05, 3.8928e+05, 3.8933e+05, 7.7717e+05],
        [3.7534e+00, 3.7522e+05, 4.0109e+00, 3.8928e+05, 0.0000e+00, 3.8866e+05,
         3.9326e+05, 3.8239e+00, 4.2617e+00, 3.9780e+05],
        [3.8868e+05, 7.7854e+05, 3.8864e+05, 7.9445e+05, 3.8866e+05, 0.0000e+00,
         7.7020e+05, 3.8868e+05, 3.8864e+05, 7.8410e+05],
        [3.9334e+05, 7.6729e+05, 3.9326e+05, 8.0295e+05, 3.9326e+05, 7.7020e+05,
         0.0000e+00, 3.9330e+05, 3.9332e+05, 8.1228e+05],
        [3.7126e+00, 3.7522e+05, 4.1176e+00, 3.8928e+05, 3.8239e+00, 3.8868e+05,
         3.9330e+05, 0.0000e+00, 3.8934e+00, 3.9788e+05],
        [4.0460e+00, 3.7526e+05, 3.7906e+00, 3.8933e+05, 4.2617e+00, 3.8864e+05,
         3.9332e+05, 3.8934e+00, 0.0000e+00, 3.9784e+05],
        [3.9784e+05, 7.7492e+05, 3.9791e+05, 7.7717e+05, 3.9780e+05, 7.8410e+05,
         8.1228e+05, 3.9788e+05, 3.9784e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.7126e+00, 3.7534e+00, 3.9000e+00, 4.0460e+00, 3.7525e+05,
        3.8868e+05, 3.8927e+05, 3.9334e+05, 3.9784e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 375217.0625, 375223.4688, 375246.1250, 375248.8125,
        375261.3750, 767291.6250, 773671.8125, 774924.8125, 778540.5000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.7906e+00, 3.9000e+00, 4.0109e+00, 4.1176e+00, 3.7525e+05,
        3.8864e+05, 3.8933e+05, 3.9326e+05, 3.9791e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 389274.8125, 389278.1250, 389280.6250, 389328.4688,
        389329.5938, 773671.8125, 777174.7500, 794452.5000, 802947.0625])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.7534e+00, 3.8239e+00, 4.0109e+00, 4.2617e+00, 3.7522e+05,
        3.8866e+05, 3.8928e+05, 3.9326e+05, 3.9780e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 388641.3125, 388641.6250, 388661.7812, 388679.8438,
        388680.8438, 770204.8750, 778540.5000, 784104.1250, 794452.5000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 393259.4062, 393263.6875, 393299.2188, 393320.0625,
        393342.7188, 767291.6250, 770204.8750, 802947.0625, 812277.9375])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.7126e+00, 3.8239e+00, 3.8934e+00, 4.1176e+00, 3.7522e+05,
        3.8868e+05, 3.8928e+05, 3.9330e+05, 3.9788e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 3.7906e+00, 3.8934e+00, 4.0460e+00, 4.2617e+00, 3.7526e+05,
        3.8864e+05, 3.8933e+05, 3.9332e+05, 3.9784e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 397802.8750, 397838.9688, 397840.6562, 397882.2812,
        397912.2500, 774924.8125, 777174.7500, 784104.1250, 812277.9375])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['164745.17', '488165.72', '164747.75', '499619.69', '164739.89', '498864.44', '500568.81', '164742.02', '164749.80', '505910.91']
estimated f for each client, fs: [5, 4, 5, 2, 5, 3, 2, 5, 5, 2]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [1, 13, 4, 18, 9, 14, 15, 2, 7, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0057s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:30...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 94 143]
 [ 94 169]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:30, End: 2025-07-22 15:46:30)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [19, 17, 10, 20, 2, 4, 15, 13, 18], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 7.8134e+05, 3.8660e+05, 7.6157e+05, 3.8660e+05, 3.8667e+05,
         8.0222e+05, 8.0365e+05, 7.8770e+05],
        [7.8134e+05, 0.0000e+00, 4.0825e+05, 8.0688e+05, 4.0825e+05, 4.0823e+05,
         7.9879e+05, 8.3824e+05, 8.0747e+05],
        [3.8660e+05, 4.0825e+05, 0.0000e+00, 3.9164e+05, 3.7370e+00, 3.6706e+00,
         3.9169e+05, 4.0775e+05, 4.0237e+05],
        [7.6157e+05, 8.0688e+05, 3.9164e+05, 0.0000e+00, 3.9163e+05, 3.9164e+05,
         7.8279e+05, 7.9119e+05, 7.8285e+05],
        [3.8660e+05, 4.0825e+05, 3.7370e+00, 3.9163e+05, 0.0000e+00, 4.1534e+00,
         3.9173e+05, 4.0770e+05, 4.0237e+05],
        [3.8667e+05, 4.0823e+05, 3.6706e+00, 3.9164e+05, 4.1534e+00, 0.0000e+00,
         3.9166e+05, 4.0772e+05, 4.0237e+05],
        [8.0222e+05, 7.9879e+05, 3.9169e+05, 7.8279e+05, 3.9173e+05, 3.9166e+05,
         0.0000e+00, 8.0181e+05, 8.0631e+05],
        [8.0365e+05, 8.3824e+05, 4.0775e+05, 7.9119e+05, 4.0770e+05, 4.0772e+05,
         8.0181e+05, 0.0000e+00, 8.1250e+05],
        [7.8770e+05, 8.0747e+05, 4.0237e+05, 7.8285e+05, 4.0237e+05, 4.0237e+05,
         8.0631e+05, 8.1250e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 386598.6250, 386601.3750, 386668.2812, 761568.0625,
        781338.3125, 787699.6875, 802221.5000, 803645.1250])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 408230.9062, 408245.9688, 408250.6250, 781338.3125,
        798787.0000, 806878.6875, 807471.6875, 838242.8750])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.6706e+00, 3.7370e+00, 3.8660e+05, 3.9164e+05, 3.9169e+05,
        4.0237e+05, 4.0775e+05, 4.0825e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 391630.5625, 391637.4062, 391637.7812, 761568.0625,
        782787.8750, 782851.3750, 791187.9375, 806878.6875])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.7370e+00, 4.1534e+00, 3.8660e+05, 3.9163e+05, 3.9173e+05,
        4.0237e+05, 4.0770e+05, 4.0825e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.6706e+00, 4.1534e+00, 3.8667e+05, 3.9164e+05, 3.9166e+05,
        4.0237e+05, 4.0772e+05, 4.0823e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 391663.0625, 391687.2500, 391729.6875, 782787.8750,
        798787.0000, 801807.7500, 802221.5000, 806308.4375])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 407698.5625, 407724.4062, 407753.9688, 791187.9375,
        801807.7500, 803645.1250, 812504.8750, 838242.8750])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 402369.8750, 402371.4375, 402373.1875, 782851.3750,
        787699.6875, 806308.4375, 807471.6875, 812504.8750])
Index of maximum distance difference after half of values: 6
adaptive_Krum scores:  ['581745.75', '601955.25', '262050.42', '583685.50', '262057.12', '262057.73', '593077.12', '603303.00', '597328.94']
estimated f for each client, fs: [2, 2, 2, 2, 2, 2, 2, 2, 2]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [19, 17, 10, 20, 2, 4, 15, 13, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0066s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:30...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 96 141]
 [ 97 166]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:30, End: 2025-07-22 15:46:30)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [7, 2], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 4.0820],
        [4.0820, 0.0000]])
sorted_distances: tensor([0.0000, 4.0820])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000, 4.0820])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['4.08', '4.08']
estimated f for each client, fs: [1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [7, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0015s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:30...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [104 159]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:30, End: 2025-07-22 15:46:30)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [4, 7, 10], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[0.0000, 3.9087, 3.7048],
        [3.9087, 0.0000, 3.6919],
        [3.7048, 3.6919, 0.0000]])
sorted_distances: tensor([0.0000, 3.7048, 3.9087])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000, 3.6919, 3.9087])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000, 3.6919, 3.7048])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['3.81', '3.80', '3.70']
estimated f for each client, fs: [0, 0, 0]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']], selected_client_indices: [4, 7, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0020s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:31...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[103 134]
 [108 155]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:31, End: 2025-07-22 15:46:31)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [7, 14, 9, 1, 6, 2, 19, 10, 16, 15, 18, 3], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 3.9434e+05, 4.3891e+00, 4.3860e+00, 4.2785e+00, 4.2691e+00,
         4.0008e+05, 3.7312e+00, 3.8918e+05, 3.9305e+05, 4.1438e+05, 3.8321e+00],
        [3.9434e+05, 0.0000e+00, 3.9439e+05, 3.9435e+05, 3.9435e+05, 3.9437e+05,
         7.9676e+05, 3.9436e+05, 8.0010e+05, 7.8944e+05, 8.1047e+05, 3.9435e+05],
        [4.3891e+00, 3.9439e+05, 0.0000e+00, 3.7431e+00, 4.3874e+00, 4.0569e+00,
         4.0011e+05, 4.0751e+00, 3.8916e+05, 3.9305e+05, 4.1437e+05, 3.8318e+00],
        [4.3860e+00, 3.9435e+05, 3.7431e+00, 0.0000e+00, 4.1364e+00, 3.7491e+00,
         4.0014e+05, 3.9063e+00, 3.8915e+05, 3.9303e+05, 4.1430e+05, 3.6270e+00],
        [4.2785e+00, 3.9435e+05, 4.3874e+00, 4.1364e+00, 0.0000e+00, 4.3048e+00,
         4.0014e+05, 3.9700e+00, 3.8916e+05, 3.9301e+05, 4.1434e+05, 3.9049e+00],
        [4.2691e+00, 3.9437e+05, 4.0569e+00, 3.7491e+00, 4.3048e+00, 0.0000e+00,
         4.0013e+05, 3.8866e+00, 3.8918e+05, 3.9300e+05, 4.1439e+05, 3.9611e+00],
        [4.0008e+05, 7.9676e+05, 4.0011e+05, 4.0014e+05, 4.0014e+05, 4.0013e+05,
         0.0000e+00, 4.0010e+05, 7.6603e+05, 8.1091e+05, 8.0391e+05, 4.0012e+05],
        [3.7312e+00, 3.9436e+05, 4.0751e+00, 3.9063e+00, 3.9700e+00, 3.8866e+00,
         4.0010e+05, 0.0000e+00, 3.8918e+05, 3.9305e+05, 4.1436e+05, 3.6973e+00],
        [3.8918e+05, 8.0010e+05, 3.8916e+05, 3.8915e+05, 3.8916e+05, 3.8918e+05,
         7.6603e+05, 3.8918e+05, 0.0000e+00, 7.7318e+05, 8.1251e+05, 3.8916e+05],
        [3.9305e+05, 7.8944e+05, 3.9305e+05, 3.9303e+05, 3.9301e+05, 3.9300e+05,
         8.1091e+05, 3.9305e+05, 7.7318e+05, 0.0000e+00, 8.0262e+05, 3.9307e+05],
        [4.1438e+05, 8.1047e+05, 4.1437e+05, 4.1430e+05, 4.1434e+05, 4.1439e+05,
         8.0391e+05, 4.1436e+05, 8.1251e+05, 8.0262e+05, 0.0000e+00, 4.1437e+05],
        [3.8321e+00, 3.9435e+05, 3.8318e+00, 3.6270e+00, 3.9049e+00, 3.9611e+00,
         4.0012e+05, 3.6973e+00, 3.8916e+05, 3.9307e+05, 4.1437e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.7312e+00, 3.8321e+00, 4.2691e+00, 4.2785e+00, 4.3860e+00,
        4.3891e+00, 3.8918e+05, 3.9305e+05, 3.9434e+05, 4.0008e+05, 4.1438e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 394344.6250, 394350.4375, 394354.5000, 394354.5000,
        394359.7812, 394372.9062, 394394.0312, 789438.6875, 796757.3125,
        800101.3125, 810472.9375])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.7431e+00, 3.8318e+00, 4.0569e+00, 4.0751e+00, 4.3874e+00,
        4.3891e+00, 3.8916e+05, 3.9305e+05, 3.9439e+05, 4.0011e+05, 4.1437e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6270e+00, 3.7431e+00, 3.7491e+00, 3.9063e+00, 4.1364e+00,
        4.3860e+00, 3.8915e+05, 3.9303e+05, 3.9435e+05, 4.0014e+05, 4.1430e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.9049e+00, 3.9700e+00, 4.1364e+00, 4.2785e+00, 4.3048e+00,
        4.3874e+00, 3.8916e+05, 3.9301e+05, 3.9435e+05, 4.0014e+05, 4.1434e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.7491e+00, 3.8866e+00, 3.9611e+00, 4.0569e+00, 4.2691e+00,
        4.3048e+00, 3.8918e+05, 3.9300e+05, 3.9437e+05, 4.0013e+05, 4.1439e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 400082.0312, 400103.5000, 400109.6562, 400124.8438,
        400131.6250, 400137.9062, 400142.0000, 766027.7500, 796757.3125,
        803912.1250, 810910.3750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6973e+00, 3.7312e+00, 3.8866e+00, 3.9063e+00, 3.9700e+00,
        4.0751e+00, 3.8918e+05, 3.9305e+05, 3.9436e+05, 4.0010e+05, 4.1436e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 389153.8125, 389159.5938, 389163.1875, 389163.5000,
        389176.6875, 389177.0312, 389179.7188, 766027.7500, 773175.5000,
        800101.3125, 812510.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 393002.6250, 393007.1875, 393030.5000, 393045.1875,
        393053.5000, 393054.1250, 393069.0312, 773175.5000, 789438.6875,
        802622.5000, 810910.3750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 414301.5000, 414339.8125, 414361.0938, 414365.0312,
        414372.6250, 414382.5312, 414391.2812, 802622.5000, 803912.1250,
        810472.9375, 812510.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6270e+00, 3.6973e+00, 3.8318e+00, 3.8321e+00, 3.9049e+00,
        3.9611e+00, 3.8916e+05, 3.9307e+05, 3.9435e+05, 4.0012e+05, 4.1437e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['97781.89', '443746.25', '97780.27', '97775.99', '97773.98', '97775.49', '445857.50', '97781.03', '436275.22', '440554.72', '462892.09', '97781.89']
estimated f for each client, fs: [5, 4, 5, 5, 5, 5, 3, 5, 3, 3, 3, 5]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [7, 14, 9, 1, 6, 2, 19, 10, 16, 15, 18, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0101s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:31...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[107 130]
 [112 151]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:31, End: 2025-07-22 15:46:31)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [19, 13, 18, 3, 2, 17, 11, 5, 15], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 7.5514e+05, 7.6787e+05, 3.9524e+05, 3.9525e+05, 7.9650e+05,
         3.9525e+05, 3.9530e+05, 7.9606e+05],
        [7.5514e+05, 0.0000e+00, 7.8838e+05, 3.8260e+05, 3.8260e+05, 7.5158e+05,
         3.8260e+05, 3.8261e+05, 7.8064e+05],
        [7.6787e+05, 7.8838e+05, 0.0000e+00, 3.9148e+05, 3.9150e+05, 7.7173e+05,
         3.9146e+05, 3.9149e+05, 7.8719e+05],
        [3.9524e+05, 3.8260e+05, 3.9148e+05, 0.0000e+00, 4.0263e+00, 3.8338e+05,
         3.8569e+00, 3.8121e+00, 4.0279e+05],
        [3.9525e+05, 3.8260e+05, 3.9150e+05, 4.0263e+00, 0.0000e+00, 3.8336e+05,
         3.9292e+00, 3.9871e+00, 4.0275e+05],
        [7.9650e+05, 7.5158e+05, 7.7173e+05, 3.8338e+05, 3.8336e+05, 0.0000e+00,
         3.8337e+05, 3.8341e+05, 7.8081e+05],
        [3.9525e+05, 3.8260e+05, 3.9146e+05, 3.8569e+00, 3.9292e+00, 3.8337e+05,
         0.0000e+00, 3.7512e+00, 4.0282e+05],
        [3.9530e+05, 3.8261e+05, 3.9149e+05, 3.8121e+00, 3.9871e+00, 3.8341e+05,
         3.7512e+00, 0.0000e+00, 4.0279e+05],
        [7.9606e+05, 7.8064e+05, 7.8719e+05, 4.0279e+05, 4.0275e+05, 7.8081e+05,
         4.0282e+05, 4.0279e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 395236.5625, 395246.0000, 395251.6250, 395304.0625,
        755144.6250, 767870.0625, 796063.8750, 796495.5000])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 382595.4062, 382598.5000, 382601.5000, 382605.5000,
        751577.0625, 755144.6250, 780643.6875, 788376.0000])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 391459.4375, 391476.6250, 391492.8750, 391501.1562,
        767870.0625, 771731.0625, 787190.4375, 788376.0000])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.8121e+00, 3.8569e+00, 4.0263e+00, 3.8260e+05, 3.8338e+05,
        3.9148e+05, 3.9524e+05, 4.0279e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.9292e+00, 3.9871e+00, 4.0263e+00, 3.8260e+05, 3.8336e+05,
        3.9150e+05, 3.9525e+05, 4.0275e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 383362.6250, 383374.8125, 383378.4375, 383408.4375,
        751577.0625, 771731.0625, 780805.1875, 796495.5000])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.7512e+00, 3.8569e+00, 3.9292e+00, 3.8260e+05, 3.8337e+05,
        3.9146e+05, 3.9525e+05, 4.0282e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.7512e+00, 3.8121e+00, 3.9871e+00, 3.8261e+05, 3.8341e+05,
        3.9149e+05, 3.9530e+05, 4.0279e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 402747.0938, 402789.8750, 402791.5000, 402820.3750,
        780643.6875, 780805.1875, 787190.4375, 796063.8750])
Index of maximum distance difference after half of values: 6
adaptive_Krum scores:  ['517342.16', '506187.09', '517588.53', '192910.36', '192912.38', '509472.09', '192907.88', '192919.73', '528766.31']
estimated f for each client, fs: [2, 2, 2, 2, 2, 3, 2, 2, 2]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']], selected_client_indices: [19, 13, 18, 3, 2, 17, 11, 5, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0063s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:31...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[111 126]
 [112 151]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:31, End: 2025-07-22 15:46:31)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [18, 4, 1, 16, 5, 19, 20, 17, 11, 2, 15, 8, 9, 13, 12, 6, 10], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.9093e+05, 3.9102e+05, 7.7531e+05, 3.9090e+05, 7.6439e+05,
         7.9080e+05, 7.5022e+05, 3.9097e+05, 3.9096e+05, 7.9146e+05, 3.9098e+05,
         3.9096e+05, 7.7872e+05, 3.9094e+05, 3.9093e+05, 3.9094e+05],
        [3.9093e+05, 0.0000e+00, 3.9352e+00, 3.8354e+05, 3.6918e+00, 3.8324e+05,
         4.0363e+05, 3.8676e+05, 3.8751e+00, 4.2787e+00, 3.9102e+05, 3.8072e+00,
         4.1462e+00, 3.8532e+05, 3.6758e+00, 3.8987e+00, 3.7680e+00],
        [3.9102e+05, 3.9352e+00, 0.0000e+00, 3.8349e+05, 3.7009e+00, 3.8325e+05,
         4.0363e+05, 3.8671e+05, 4.0117e+00, 3.8744e+00, 3.9105e+05, 3.9616e+00,
         3.8219e+00, 3.8531e+05, 4.1088e+00, 4.0546e+00, 3.9279e+00],
        [7.7531e+05, 3.8354e+05, 3.8349e+05, 0.0000e+00, 3.8348e+05, 7.5544e+05,
         7.7072e+05, 8.0097e+05, 3.8349e+05, 3.8355e+05, 7.7535e+05, 3.8357e+05,
         3.8351e+05, 7.6858e+05, 3.8348e+05, 3.8348e+05, 3.8353e+05],
        [3.9090e+05, 3.6918e+00, 3.7009e+00, 3.8348e+05, 0.0000e+00, 3.8322e+05,
         4.0369e+05, 3.8671e+05, 3.7585e+00, 3.9888e+00, 3.9101e+05, 4.1456e+00,
         4.2383e+00, 3.8530e+05, 3.9053e+00, 4.1626e+00, 3.8041e+00],
        [7.6439e+05, 3.8324e+05, 3.8325e+05, 7.5544e+05, 3.8322e+05, 0.0000e+00,
         7.8559e+05, 7.7782e+05, 3.8325e+05, 3.8321e+05, 7.6600e+05, 3.8325e+05,
         3.8324e+05, 7.7126e+05, 3.8326e+05, 3.8324e+05, 3.8323e+05],
        [7.9080e+05, 4.0363e+05, 4.0363e+05, 7.7072e+05, 4.0369e+05, 7.8559e+05,
         0.0000e+00, 7.9554e+05, 4.0362e+05, 4.0357e+05, 7.9017e+05, 4.0364e+05,
         4.0359e+05, 7.7587e+05, 4.0364e+05, 4.0365e+05, 4.0363e+05],
        [7.5022e+05, 3.8676e+05, 3.8671e+05, 8.0097e+05, 3.8671e+05, 7.7782e+05,
         7.9554e+05, 0.0000e+00, 3.8682e+05, 3.8670e+05, 7.6834e+05, 3.8678e+05,
         3.8677e+05, 7.7987e+05, 3.8673e+05, 3.8678e+05, 3.8672e+05],
        [3.9097e+05, 3.8751e+00, 4.0117e+00, 3.8349e+05, 3.7585e+00, 3.8325e+05,
         4.0362e+05, 3.8682e+05, 0.0000e+00, 4.0771e+00, 3.9105e+05, 4.0031e+00,
         4.1756e+00, 3.8533e+05, 3.6976e+00, 4.1179e+00, 3.8083e+00],
        [3.9096e+05, 4.2787e+00, 3.8744e+00, 3.8355e+05, 3.9888e+00, 3.8321e+05,
         4.0357e+05, 3.8670e+05, 4.0771e+00, 0.0000e+00, 3.9103e+05, 4.1562e+00,
         4.1965e+00, 3.8536e+05, 4.0713e+00, 4.2895e+00, 3.9380e+00],
        [7.9146e+05, 3.9102e+05, 3.9105e+05, 7.7535e+05, 3.9101e+05, 7.6600e+05,
         7.9017e+05, 7.6834e+05, 3.9105e+05, 3.9103e+05, 0.0000e+00, 3.9107e+05,
         3.9100e+05, 7.9138e+05, 3.9106e+05, 3.9103e+05, 3.9102e+05],
        [3.9098e+05, 3.8072e+00, 3.9616e+00, 3.8357e+05, 4.1456e+00, 3.8325e+05,
         4.0364e+05, 3.8678e+05, 4.0031e+00, 4.1562e+00, 3.9107e+05, 0.0000e+00,
         4.2276e+00, 3.8530e+05, 3.6376e+00, 4.3728e+00, 3.6039e+00],
        [3.9096e+05, 4.1462e+00, 3.8219e+00, 3.8351e+05, 4.2383e+00, 3.8324e+05,
         4.0359e+05, 3.8677e+05, 4.1756e+00, 4.1965e+00, 3.9100e+05, 4.2276e+00,
         0.0000e+00, 3.8532e+05, 4.1756e+00, 4.5207e+00, 4.1527e+00],
        [7.7872e+05, 3.8532e+05, 3.8531e+05, 7.6858e+05, 3.8530e+05, 7.7126e+05,
         7.7587e+05, 7.7987e+05, 3.8533e+05, 3.8536e+05, 7.9138e+05, 3.8530e+05,
         3.8532e+05, 0.0000e+00, 3.8531e+05, 3.8534e+05, 3.8531e+05],
        [3.9094e+05, 3.6758e+00, 4.1088e+00, 3.8348e+05, 3.9053e+00, 3.8326e+05,
         4.0364e+05, 3.8673e+05, 3.6976e+00, 4.0713e+00, 3.9106e+05, 3.6376e+00,
         4.1756e+00, 3.8531e+05, 0.0000e+00, 4.0225e+00, 3.5892e+00],
        [3.9093e+05, 3.8987e+00, 4.0546e+00, 3.8348e+05, 4.1626e+00, 3.8324e+05,
         4.0365e+05, 3.8678e+05, 4.1179e+00, 4.2895e+00, 3.9103e+05, 4.3728e+00,
         4.5207e+00, 3.8534e+05, 4.0225e+00, 0.0000e+00, 3.8928e+00],
        [3.9094e+05, 3.7680e+00, 3.9279e+00, 3.8353e+05, 3.8041e+00, 3.8323e+05,
         4.0363e+05, 3.8672e+05, 3.8083e+00, 3.9380e+00, 3.9102e+05, 3.6039e+00,
         4.1527e+00, 3.8531e+05, 3.5892e+00, 3.8928e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 390897.5000, 390927.3750, 390928.0000, 390939.9688,
        390941.9062, 390955.3750, 390958.6562, 390973.5938, 390981.0625,
        391022.0000, 750219.0000, 764392.5625, 775306.1875, 778720.8125,
        790804.0625, 791462.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6758e+00, 3.6918e+00, 3.7680e+00, 3.8072e+00, 3.8751e+00,
        3.8987e+00, 3.9352e+00, 4.1462e+00, 4.2787e+00, 3.8324e+05, 3.8354e+05,
        3.8532e+05, 3.8676e+05, 3.9093e+05, 3.9102e+05, 4.0363e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.7009e+00, 3.8219e+00, 3.8744e+00, 3.9279e+00, 3.9352e+00,
        3.9616e+00, 4.0117e+00, 4.0546e+00, 4.1088e+00, 3.8325e+05, 3.8349e+05,
        3.8531e+05, 3.8671e+05, 3.9102e+05, 3.9105e+05, 4.0363e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383479.3125, 383479.6875, 383481.7188, 383491.3750,
        383494.5312, 383514.0000, 383529.6562, 383541.7500, 383551.6875,
        383565.5000, 755436.9375, 768580.6250, 770715.5000, 775306.1875,
        775352.5625, 800973.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6918e+00, 3.7009e+00, 3.7585e+00, 3.8041e+00, 3.9053e+00,
        3.9888e+00, 4.1456e+00, 4.1626e+00, 4.2383e+00, 3.8322e+05, 3.8348e+05,
        3.8530e+05, 3.8671e+05, 3.9090e+05, 3.9101e+05, 4.0369e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383212.1562, 383217.3438, 383233.8125, 383239.7500,
        383244.0312, 383244.5000, 383247.0938, 383251.9375, 383254.3438,
        383259.6875, 755436.9375, 764392.5625, 765997.5625, 771259.6875,
        777819.5000, 785592.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403569.5000, 403593.1250, 403620.9375, 403625.6875,
        403629.9375, 403633.3750, 403640.1250, 403644.4688, 403650.2500,
        403685.5000, 770715.5000, 775865.3750, 785592.5000, 790166.1875,
        790804.0625, 795538.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386701.7812, 386710.8438, 386713.2500, 386715.2812,
        386731.4375, 386761.9688, 386772.1562, 386779.0312, 386782.4688,
        386821.9375, 750219.0000, 768343.0000, 777819.5000, 779874.2500,
        795538.6875, 800973.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6976e+00, 3.7585e+00, 3.8083e+00, 3.8751e+00, 4.0031e+00,
        4.0117e+00, 4.0771e+00, 4.1179e+00, 4.1756e+00, 3.8325e+05, 3.8349e+05,
        3.8533e+05, 3.8682e+05, 3.9097e+05, 3.9105e+05, 4.0362e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.8744e+00, 3.9380e+00, 3.9888e+00, 4.0713e+00, 4.0771e+00,
        4.1562e+00, 4.1965e+00, 4.2787e+00, 4.2895e+00, 3.8321e+05, 3.8355e+05,
        3.8536e+05, 3.8670e+05, 3.9096e+05, 3.9103e+05, 4.0357e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391001.8750, 391011.3438, 391015.0625, 391024.5000,
        391033.6875, 391033.7812, 391046.9375, 391050.0625, 391058.2812,
        391065.7500, 765997.5625, 768343.0000, 775352.5625, 790166.1875,
        791381.0000, 791462.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6039e+00, 3.6376e+00, 3.8072e+00, 3.9616e+00, 4.0031e+00,
        4.1456e+00, 4.1562e+00, 4.2276e+00, 4.3728e+00, 3.8325e+05, 3.8357e+05,
        3.8530e+05, 3.8678e+05, 3.9098e+05, 3.9107e+05, 4.0364e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.8219e+00, 4.1462e+00, 4.1527e+00, 4.1756e+00, 4.1756e+00,
        4.1965e+00, 4.2276e+00, 4.2383e+00, 4.5207e+00, 3.8324e+05, 3.8351e+05,
        3.8532e+05, 3.8677e+05, 3.9096e+05, 3.9100e+05, 4.0359e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385301.2500, 385303.3125, 385311.5312, 385312.4688,
        385314.4688, 385316.4375, 385322.0312, 385328.6562, 385339.5000,
        385357.5625, 768580.6250, 771259.6875, 775865.3750, 778720.8125,
        779874.2500, 791381.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5892e+00, 3.6376e+00, 3.6758e+00, 3.6976e+00, 3.9053e+00,
        4.0225e+00, 4.0713e+00, 4.1088e+00, 4.1756e+00, 3.8326e+05, 3.8348e+05,
        3.8531e+05, 3.8673e+05, 3.9094e+05, 3.9106e+05, 4.0364e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.8928e+00, 3.8987e+00, 4.0225e+00, 4.0546e+00, 4.1179e+00,
        4.1626e+00, 4.2895e+00, 4.3728e+00, 4.5207e+00, 3.8324e+05, 3.8348e+05,
        3.8534e+05, 3.8678e+05, 3.9093e+05, 3.9103e+05, 4.0365e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5892e+00, 3.6039e+00, 3.7680e+00, 3.8041e+00, 3.8083e+00,
        3.8928e+00, 3.9279e+00, 3.9380e+00, 4.1527e+00, 3.8323e+05, 3.8353e+05,
        3.8531e+05, 3.8672e+05, 3.9094e+05, 3.9102e+05, 4.0363e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['390952.53', '38327.48', '38328.25', '383512.91', '38325.27', '383240.47', '403629.28', '386748.97', '38328.99', '38324.91', '391034.16', '38328.79', '38328.21', '385320.72', '38329.46', '38328.13', '38326.83']
estimated f for each client, fs: [5, 7, 7, 5, 7, 5, 5, 5, 7, 7, 5, 7, 7, 5, 7, 7, 7]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [18, 4, 1, 16, 5, 19, 20, 17, 11, 2, 15, 8, 9, 13, 12, 6, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0162s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:32...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[111 126]
 [113 150]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:32, End: 2025-07-22 15:46:32)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [9, 5], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 4.2757],
        [4.2757, 0.0000]])
sorted_distances: tensor([0.0000, 4.2757])
Index of maximum distance difference after half of values: 3
sorted_distances: tensor([0.0000, 4.2757])
Index of maximum distance difference after half of values: 3
adaptive_Krum scores:  ['4.28', '4.28']
estimated f for each client, fs: [1, 1]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [9, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0015s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:32...
global Accuracy on shared test data: 53.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[110 127]
 [105 158]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:32, End: 2025-07-22 15:46:32)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [8, 13, 10, 7, 14, 20, 15, 16, 1, 18, 12, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 3.9317e+05, 3.6671e+00, 4.1314e+00, 3.8108e+05, 4.1140e+05,
         3.9342e+05, 3.8550e+05, 4.0465e+00, 3.9292e+05, 3.6915e+00, 4.4635e+00],
        [3.9317e+05, 0.0000e+00, 3.9317e+05, 3.9319e+05, 7.7673e+05, 7.9765e+05,
         7.5731e+05, 7.7301e+05, 3.9315e+05, 8.0724e+05, 3.9315e+05, 3.9313e+05],
        [3.6671e+00, 3.9317e+05, 0.0000e+00, 3.8586e+00, 3.8110e+05, 4.1146e+05,
         3.9335e+05, 3.8547e+05, 3.9367e+00, 3.9289e+05, 3.6812e+00, 4.0127e+00],
        [4.1314e+00, 3.9319e+05, 3.8586e+00, 0.0000e+00, 3.8104e+05, 4.1147e+05,
         3.9337e+05, 3.8554e+05, 4.6683e+00, 3.9283e+05, 4.1039e+00, 4.4259e+00],
        [3.8108e+05, 7.7673e+05, 3.8110e+05, 3.8104e+05, 0.0000e+00, 8.0916e+05,
         7.8500e+05, 7.6904e+05, 3.8109e+05, 7.8594e+05, 3.8104e+05, 3.8106e+05],
        [4.1140e+05, 7.9765e+05, 4.1146e+05, 4.1147e+05, 8.0916e+05, 0.0000e+00,
         8.1773e+05, 8.1300e+05, 4.1147e+05, 7.8619e+05, 4.1146e+05, 4.1144e+05],
        [3.9342e+05, 7.5731e+05, 3.9335e+05, 3.9337e+05, 7.8500e+05, 8.1773e+05,
         0.0000e+00, 7.5528e+05, 3.9344e+05, 7.7099e+05, 3.9337e+05, 3.9330e+05],
        [3.8550e+05, 7.7301e+05, 3.8547e+05, 3.8554e+05, 7.6904e+05, 8.1300e+05,
         7.5528e+05, 0.0000e+00, 3.8548e+05, 7.7104e+05, 3.8550e+05, 3.8550e+05],
        [4.0465e+00, 3.9315e+05, 3.9367e+00, 4.6683e+00, 3.8109e+05, 4.1147e+05,
         3.9344e+05, 3.8548e+05, 0.0000e+00, 3.9290e+05, 4.1146e+00, 4.2505e+00],
        [3.9292e+05, 8.0724e+05, 3.9289e+05, 3.9283e+05, 7.8594e+05, 7.8619e+05,
         7.7099e+05, 7.7104e+05, 3.9290e+05, 0.0000e+00, 3.9289e+05, 3.9292e+05],
        [3.6915e+00, 3.9315e+05, 3.6812e+00, 4.1039e+00, 3.8104e+05, 4.1146e+05,
         3.9337e+05, 3.8550e+05, 4.1146e+00, 3.9289e+05, 0.0000e+00, 4.1465e+00],
        [4.4635e+00, 3.9313e+05, 4.0127e+00, 4.4259e+00, 3.8106e+05, 4.1144e+05,
         3.9330e+05, 3.8550e+05, 4.2505e+00, 3.9292e+05, 4.1465e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.6671e+00, 3.6915e+00, 4.0465e+00, 4.1314e+00, 4.4635e+00,
        3.8108e+05, 3.8550e+05, 3.9292e+05, 3.9317e+05, 3.9342e+05, 4.1140e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 393128.4062, 393150.6250, 393153.0625, 393169.4688,
        393173.3750, 393191.2812, 757310.8750, 773007.0625, 776729.8125,
        797653.9375, 807239.3750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6671e+00, 3.6812e+00, 3.8586e+00, 3.9367e+00, 4.0127e+00,
        3.8110e+05, 3.8547e+05, 3.9289e+05, 3.9317e+05, 3.9335e+05, 4.1146e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.8586e+00, 4.1039e+00, 4.1314e+00, 4.4259e+00, 4.6683e+00,
        3.8104e+05, 3.8554e+05, 3.9283e+05, 3.9319e+05, 3.9337e+05, 4.1147e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 381035.8125, 381042.4062, 381056.2812, 381079.3750,
        381089.6875, 381097.5625, 769039.6250, 776729.8125, 784997.6875,
        785944.0000, 809159.0625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 411402.0000, 411438.5312, 411457.7812, 411458.6875,
        411473.5938, 411474.7500, 786193.0625, 797653.9375, 809159.0625,
        813000.0625, 817727.9375])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 393297.8438, 393349.5312, 393369.4688, 393371.7188,
        393417.0000, 393439.5312, 755279.4375, 757310.8750, 770993.3750,
        784997.6875, 817727.9375])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 385467.5000, 385475.5312, 385496.6875, 385497.1875,
        385502.0312, 385536.4062, 755279.4375, 769039.6250, 771040.9375,
        773007.0625, 813000.0625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.9367e+00, 4.0465e+00, 4.1146e+00, 4.2505e+00, 4.6683e+00,
        3.8109e+05, 3.8548e+05, 3.9290e+05, 3.9315e+05, 3.9344e+05, 4.1147e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 392830.1250, 392885.5000, 392891.0625, 392896.3750,
        392916.3438, 392924.9062, 770993.3750, 771040.9375, 785944.0000,
        786193.0625, 807239.3750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6812e+00, 3.6915e+00, 4.1039e+00, 4.1146e+00, 4.1465e+00,
        3.8104e+05, 3.8550e+05, 3.9289e+05, 3.9315e+05, 3.9337e+05, 4.1146e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 4.0127e+00, 4.1465e+00, 4.2505e+00, 4.4259e+00, 4.4635e+00,
        3.8106e+05, 3.8550e+05, 3.9292e+05, 3.9313e+05, 3.9330e+05, 4.1144e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['144939.73', '486160.53', '144934.42', '144928.78', '479021.38', '506569.06', '484104.44', '479661.81', '144935.34', '487422.41', '144929.73', '144937.47']
estimated f for each client, fs: [6, 3, 6, 6, 5, 3, 3, 3, 6, 3, 6, 6]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [8, 13, 10, 7, 14, 20, 15, 16, 1, 18, 12, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0073s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:33...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[113 124]
 [113 150]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:33, End: 2025-07-22 15:46:33)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [16, 2, 4, 19, 6, 15, 12, 10, 7], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 3.8609e+05, 3.8609e+05, 7.8687e+05, 3.8601e+05, 7.6538e+05,
         3.8604e+05, 3.8608e+05, 3.8605e+05],
        [3.8609e+05, 0.0000e+00, 4.2174e+00, 3.9255e+05, 4.4479e+00, 3.9343e+05,
         4.1338e+00, 4.0566e+00, 4.4798e+00],
        [3.8609e+05, 4.2174e+00, 0.0000e+00, 3.9261e+05, 3.9583e+00, 3.9343e+05,
         3.7118e+00, 3.7973e+00, 3.9628e+00],
        [7.8687e+05, 3.9255e+05, 3.9261e+05, 0.0000e+00, 3.9252e+05, 7.7807e+05,
         3.9259e+05, 3.9256e+05, 3.9258e+05],
        [3.8601e+05, 4.4479e+00, 3.9583e+00, 3.9252e+05, 0.0000e+00, 3.9345e+05,
         4.2503e+00, 4.0157e+00, 4.4065e+00],
        [7.6538e+05, 3.9343e+05, 3.9343e+05, 7.7807e+05, 3.9345e+05, 0.0000e+00,
         3.9350e+05, 3.9340e+05, 3.9340e+05],
        [3.8604e+05, 4.1338e+00, 3.7118e+00, 3.9259e+05, 4.2503e+00, 3.9350e+05,
         0.0000e+00, 3.7748e+00, 4.0314e+00],
        [3.8608e+05, 4.0566e+00, 3.7973e+00, 3.9256e+05, 4.0157e+00, 3.9340e+05,
         3.7748e+00, 0.0000e+00, 3.9697e+00],
        [3.8605e+05, 4.4798e+00, 3.9628e+00, 3.9258e+05, 4.4065e+00, 3.9340e+05,
         4.0314e+00, 3.9697e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 386009.4062, 386037.3125, 386053.9375, 386076.1562,
        386085.5625, 386086.0938, 765382.7500, 786866.9375])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 4.0566e+00, 4.1338e+00, 4.2174e+00, 4.4479e+00, 4.4798e+00,
        3.8609e+05, 3.9255e+05, 3.9343e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.7118e+00, 3.7973e+00, 3.9583e+00, 3.9628e+00, 4.2174e+00,
        3.8609e+05, 3.9261e+05, 3.9343e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 392516.0000, 392551.7188, 392560.4375, 392584.3125,
        392585.9062, 392609.6875, 778074.0625, 786866.9375])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.9583e+00, 4.0157e+00, 4.2503e+00, 4.4065e+00, 4.4479e+00,
        3.8601e+05, 3.9252e+05, 3.9345e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([     0.0000, 393400.5000, 393404.5000, 393425.8750, 393431.9375,
        393452.6875, 393498.5312, 765382.7500, 778074.0625])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.7118e+00, 3.7748e+00, 4.0314e+00, 4.1338e+00, 4.2503e+00,
        3.8604e+05, 3.9259e+05, 3.9350e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.7748e+00, 3.7973e+00, 3.9697e+00, 4.0157e+00, 4.0566e+00,
        3.8608e+05, 3.9256e+05, 3.9340e+05])
Index of maximum distance difference after half of values: 6
sorted_distances: tensor([0.0000e+00, 3.9628e+00, 3.9697e+00, 4.0314e+00, 4.4065e+00, 4.4798e+00,
        3.8605e+05, 3.9258e+05, 3.9340e+05])
Index of maximum distance difference after half of values: 6
adaptive_Krum scores:  ['386058.03', '64351.15', '64350.96', '392568.00', '64338.41', '393435.66', '64342.87', '64349.30', '64345.80']
estimated f for each client, fs: [1, 3, 3, 1, 3, 1, 3, 3, 3]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [16, 2, 4, 19, 6, 15, 12, 10, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0135s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:33...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[114 123]
 [117 146]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:33, End: 2025-07-22 15:46:33)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [18, 17, 1, 7, 10, 5, 11, 8, 15, 16, 4, 3], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 7.6080e+05, 3.9391e+05, 3.9393e+05, 3.9385e+05, 3.9396e+05,
         3.9393e+05, 3.9387e+05, 7.8075e+05, 7.9090e+05, 3.9391e+05, 3.9391e+05],
        [7.6080e+05, 0.0000e+00, 3.7996e+05, 3.7994e+05, 3.7990e+05, 3.7995e+05,
         3.7999e+05, 3.8000e+05, 7.4618e+05, 7.6974e+05, 3.7993e+05, 3.7996e+05],
        [3.9391e+05, 3.7996e+05, 0.0000e+00, 4.4415e+00, 3.9006e+00, 3.6910e+00,
         4.1181e+00, 3.9475e+00, 3.8217e+05, 3.9035e+05, 3.8979e+00, 3.8160e+00],
        [3.9393e+05, 3.7994e+05, 4.4415e+00, 0.0000e+00, 4.0417e+00, 3.8576e+00,
         4.0983e+00, 4.1951e+00, 3.8215e+05, 3.9043e+05, 3.9504e+00, 3.8803e+00],
        [3.9385e+05, 3.7990e+05, 3.9006e+00, 4.0417e+00, 0.0000e+00, 3.8333e+00,
         3.7854e+00, 3.6550e+00, 3.8215e+05, 3.9041e+05, 3.8012e+00, 4.0819e+00],
        [3.9396e+05, 3.7995e+05, 3.6910e+00, 3.8576e+00, 3.8333e+00, 0.0000e+00,
         3.7337e+00, 4.1008e+00, 3.8216e+05, 3.9041e+05, 3.7300e+00, 3.8583e+00],
        [3.9393e+05, 3.7999e+05, 4.1181e+00, 4.0983e+00, 3.7854e+00, 3.7337e+00,
         0.0000e+00, 3.9892e+00, 3.8218e+05, 3.9039e+05, 3.9189e+00, 4.0213e+00],
        [3.9387e+05, 3.8000e+05, 3.9475e+00, 4.1951e+00, 3.6550e+00, 4.1008e+00,
         3.9892e+00, 0.0000e+00, 3.8217e+05, 3.9043e+05, 3.8224e+00, 3.9554e+00],
        [7.8075e+05, 7.4618e+05, 3.8217e+05, 3.8215e+05, 3.8215e+05, 3.8216e+05,
         3.8218e+05, 3.8217e+05, 0.0000e+00, 7.8669e+05, 3.8214e+05, 3.8216e+05],
        [7.9090e+05, 7.6974e+05, 3.9035e+05, 3.9043e+05, 3.9041e+05, 3.9041e+05,
         3.9039e+05, 3.9043e+05, 7.8669e+05, 0.0000e+00, 3.9040e+05, 3.9036e+05],
        [3.9391e+05, 3.7993e+05, 3.8979e+00, 3.9504e+00, 3.8012e+00, 3.7300e+00,
         3.9189e+00, 3.8224e+00, 3.8214e+05, 3.9040e+05, 0.0000e+00, 3.8073e+00],
        [3.9391e+05, 3.7996e+05, 3.8160e+00, 3.8803e+00, 4.0819e+00, 3.8583e+00,
         4.0213e+00, 3.9554e+00, 3.8216e+05, 3.9036e+05, 3.8073e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 393853.3125, 393868.3438, 393906.8750, 393907.0625,
        393908.8438, 393932.6250, 393934.0000, 393963.1875, 760803.2500,
        780747.3750, 790899.5625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 379896.0625, 379928.0625, 379943.8438, 379949.9375,
        379955.3750, 379957.5938, 379986.6562, 379998.4375, 746183.6875,
        760803.2500, 769737.2500])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6910e+00, 3.8160e+00, 3.8979e+00, 3.9006e+00, 3.9475e+00,
        4.1181e+00, 4.4415e+00, 3.7996e+05, 3.8217e+05, 3.9035e+05, 3.9391e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.8576e+00, 3.8803e+00, 3.9504e+00, 4.0417e+00, 4.0983e+00,
        4.1951e+00, 4.4415e+00, 3.7994e+05, 3.8215e+05, 3.9043e+05, 3.9393e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6550e+00, 3.7854e+00, 3.8012e+00, 3.8333e+00, 3.9006e+00,
        4.0417e+00, 4.0819e+00, 3.7990e+05, 3.8215e+05, 3.9041e+05, 3.9385e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6910e+00, 3.7300e+00, 3.7337e+00, 3.8333e+00, 3.8576e+00,
        3.8583e+00, 4.1008e+00, 3.7995e+05, 3.8216e+05, 3.9041e+05, 3.9396e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.7337e+00, 3.7854e+00, 3.9189e+00, 3.9892e+00, 4.0213e+00,
        4.0983e+00, 4.1181e+00, 3.7999e+05, 3.8218e+05, 3.9039e+05, 3.9393e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.6550e+00, 3.8224e+00, 3.9475e+00, 3.9554e+00, 3.9892e+00,
        4.1008e+00, 4.1951e+00, 3.8000e+05, 3.8217e+05, 3.9043e+05, 3.9387e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 382136.4062, 382148.9375, 382153.5625, 382160.6875,
        382161.0938, 382172.2812, 382173.3125, 382180.2500, 746183.6875,
        780747.3750, 786687.0000])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 390349.0000, 390356.3438, 390385.3438, 390397.8438,
        390412.9688, 390413.5938, 390426.9375, 390432.6250, 769737.2500,
        786687.0000, 790899.5625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.7300e+00, 3.8012e+00, 3.8073e+00, 3.8224e+00, 3.8979e+00,
        3.9189e+00, 3.9504e+00, 3.7993e+05, 3.8214e+05, 3.9040e+05, 3.9391e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 3.8073e+00, 3.8160e+00, 3.8583e+00, 3.8803e+00, 3.9554e+00,
        4.0213e+00, 4.0819e+00, 3.7996e+05, 3.8216e+05, 3.9036e+05, 3.9391e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['393909.31', '379952.03', '47497.90', '47496.54', '47490.40', '47497.10', '47501.79', '47503.27', '382160.84', '390396.88', '47494.38', '47498.13']
estimated f for each client, fs: [2, 2, 4, 4, 4, 4, 4, 4, 2, 2, 4, 4]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [18, 17, 1, 7, 10, 5, 11, 8, 15, 16, 4, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0073s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:34...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[114 123]
 [116 147]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:34, End: 2025-07-22 15:46:34)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [17, 15, 8, 18, 13, 5, 7, 6, 19, 16, 20, 11, 12, 10, 9, 14, 2, 4], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 7.7974e+05, 3.7962e+05, 8.0347e+05, 7.7555e+05, 3.7961e+05,
         3.7963e+05, 3.7966e+05, 7.6356e+05, 7.6909e+05, 7.9134e+05, 3.7963e+05,
         3.7958e+05, 3.7960e+05, 3.7962e+05, 7.7790e+05, 3.7959e+05, 3.7962e+05],
        [7.7974e+05, 0.0000e+00, 4.0708e+05, 8.4375e+05, 7.7930e+05, 4.0706e+05,
         4.0706e+05, 4.0710e+05, 7.8750e+05, 8.0263e+05, 8.1098e+05, 4.0710e+05,
         4.0708e+05, 4.0715e+05, 4.0712e+05, 8.0633e+05, 4.0708e+05, 4.0709e+05],
        [3.7962e+05, 4.0708e+05, 0.0000e+00, 4.1302e+05, 3.9763e+05, 4.1320e+00,
         4.1417e+00, 4.5811e+00, 3.8906e+05, 3.8770e+05, 4.0308e+05, 3.9985e+00,
         3.7102e+00, 3.6384e+00, 4.2685e+00, 3.9841e+05, 4.0926e+00, 3.8352e+00],
        [8.0347e+05, 8.4375e+05, 4.1302e+05, 0.0000e+00, 8.2215e+05, 4.1299e+05,
         4.1301e+05, 4.1302e+05, 8.1198e+05, 8.0451e+05, 8.4430e+05, 4.1299e+05,
         4.1299e+05, 4.1297e+05, 4.1304e+05, 8.0307e+05, 4.1303e+05, 4.1302e+05],
        [7.7555e+05, 7.7930e+05, 3.9763e+05, 8.2215e+05, 0.0000e+00, 3.9763e+05,
         3.9764e+05, 3.9764e+05, 7.7616e+05, 7.7712e+05, 7.8379e+05, 3.9761e+05,
         3.9766e+05, 3.9768e+05, 3.9764e+05, 7.9472e+05, 3.9765e+05, 3.9763e+05],
        [3.7961e+05, 4.0706e+05, 4.1320e+00, 4.1299e+05, 3.9763e+05, 0.0000e+00,
         3.8540e+00, 4.2600e+00, 3.8902e+05, 3.8777e+05, 4.0305e+05, 3.7435e+00,
         3.7773e+00, 3.8137e+00, 4.2748e+00, 3.9843e+05, 3.9541e+00, 3.8066e+00],
        [3.7963e+05, 4.0706e+05, 4.1417e+00, 4.1301e+05, 3.9764e+05, 3.8540e+00,
         0.0000e+00, 4.4300e+00, 3.8900e+05, 3.8777e+05, 4.0310e+05, 4.0491e+00,
         4.0502e+00, 3.9518e+00, 4.4997e+00, 3.9845e+05, 4.3281e+00, 3.9222e+00],
        [3.7966e+05, 4.0710e+05, 4.5811e+00, 4.1302e+05, 3.9764e+05, 4.2600e+00,
         4.4300e+00, 0.0000e+00, 3.8903e+05, 3.8772e+05, 4.0306e+05, 4.4929e+00,
         4.3263e+00, 4.0887e+00, 4.6599e+00, 3.9848e+05, 4.3336e+00, 3.8763e+00],
        [7.6356e+05, 7.8750e+05, 3.8906e+05, 8.1198e+05, 7.7616e+05, 3.8902e+05,
         3.8900e+05, 3.8903e+05, 0.0000e+00, 7.8465e+05, 7.8172e+05, 3.8902e+05,
         3.8899e+05, 3.8903e+05, 3.8905e+05, 7.9015e+05, 3.8907e+05, 3.8901e+05],
        [7.6909e+05, 8.0263e+05, 3.8770e+05, 8.0451e+05, 7.7712e+05, 3.8777e+05,
         3.8777e+05, 3.8772e+05, 7.8465e+05, 0.0000e+00, 7.8259e+05, 3.8775e+05,
         3.8772e+05, 3.8773e+05, 3.8771e+05, 7.8207e+05, 3.8774e+05, 3.8773e+05],
        [7.9134e+05, 8.1098e+05, 4.0308e+05, 8.4430e+05, 7.8379e+05, 4.0305e+05,
         4.0310e+05, 4.0306e+05, 7.8172e+05, 7.8259e+05, 0.0000e+00, 4.0307e+05,
         4.0303e+05, 4.0307e+05, 4.0305e+05, 8.0011e+05, 4.0305e+05, 4.0306e+05],
        [3.7963e+05, 4.0710e+05, 3.9985e+00, 4.1299e+05, 3.9761e+05, 3.7435e+00,
         4.0491e+00, 4.4929e+00, 3.8902e+05, 3.8775e+05, 4.0307e+05, 0.0000e+00,
         3.6682e+00, 3.6843e+00, 3.9579e+00, 3.9846e+05, 4.0042e+00, 3.9409e+00],
        [3.7958e+05, 4.0708e+05, 3.7102e+00, 4.1299e+05, 3.9766e+05, 3.7773e+00,
         4.0502e+00, 4.3263e+00, 3.8899e+05, 3.8772e+05, 4.0303e+05, 3.6682e+00,
         0.0000e+00, 3.7062e+00, 4.3441e+00, 3.9845e+05, 4.1032e+00, 3.6637e+00],
        [3.7960e+05, 4.0715e+05, 3.6384e+00, 4.1297e+05, 3.9768e+05, 3.8137e+00,
         3.9518e+00, 4.0887e+00, 3.8903e+05, 3.8773e+05, 4.0307e+05, 3.6843e+00,
         3.7062e+00, 0.0000e+00, 4.2024e+00, 3.9847e+05, 3.8894e+00, 3.7288e+00],
        [3.7962e+05, 4.0712e+05, 4.2685e+00, 4.1304e+05, 3.9764e+05, 4.2748e+00,
         4.4997e+00, 4.6599e+00, 3.8905e+05, 3.8771e+05, 4.0305e+05, 3.9579e+00,
         4.3441e+00, 4.2024e+00, 0.0000e+00, 3.9846e+05, 4.2952e+00, 4.0552e+00],
        [7.7790e+05, 8.0633e+05, 3.9841e+05, 8.0307e+05, 7.9472e+05, 3.9843e+05,
         3.9845e+05, 3.9848e+05, 7.9015e+05, 7.8207e+05, 8.0011e+05, 3.9846e+05,
         3.9845e+05, 3.9847e+05, 3.9846e+05, 0.0000e+00, 3.9844e+05, 3.9847e+05],
        [3.7959e+05, 4.0708e+05, 4.0926e+00, 4.1303e+05, 3.9765e+05, 3.9541e+00,
         4.3281e+00, 4.3336e+00, 3.8907e+05, 3.8774e+05, 4.0305e+05, 4.0042e+00,
         4.1032e+00, 3.8894e+00, 4.2952e+00, 3.9844e+05, 0.0000e+00, 4.1161e+00],
        [3.7962e+05, 4.0709e+05, 3.8352e+00, 4.1302e+05, 3.9763e+05, 3.8066e+00,
         3.9222e+00, 3.8763e+00, 3.8901e+05, 3.8773e+05, 4.0306e+05, 3.9409e+00,
         3.6637e+00, 3.7288e+00, 4.0552e+00, 3.9847e+05, 4.1161e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 379581.6562, 379588.0000, 379598.5312, 379610.4062,
        379617.3438, 379622.8125, 379625.0000, 379629.8438, 379633.5000,
        379656.7812, 763559.6875, 769089.1250, 775548.8750, 777903.7500,
        779744.0625, 791337.7500, 803466.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 407056.1562, 407059.5312, 407081.4375, 407082.3750,
        407083.2500, 407094.0938, 407101.1250, 407102.5312, 407120.6250,
        407148.3750, 779296.0000, 779744.0625, 787504.9375, 802630.6250,
        806330.6875, 810983.3750, 843746.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6384e+00, 3.7102e+00, 3.8352e+00, 3.9985e+00, 4.0926e+00,
        4.1320e+00, 4.1417e+00, 4.2685e+00, 4.5811e+00, 3.7962e+05, 3.8770e+05,
        3.8906e+05, 3.9763e+05, 3.9841e+05, 4.0308e+05, 4.0708e+05, 4.1302e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 412969.3125, 412988.9375, 412989.0000, 412993.3750,
        413014.1562, 413019.4688, 413021.6250, 413024.6250, 413027.9688,
        413039.6250, 803070.0625, 803466.0625, 804509.3125, 811981.5000,
        822147.0625, 843746.1250, 844300.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397614.4375, 397625.4062, 397626.2812, 397632.1250,
        397635.6875, 397638.4062, 397643.6875, 397654.7188, 397658.8438,
        397683.3438, 775548.8750, 776156.0000, 777118.3750, 779296.0000,
        783790.0000, 794715.5625, 822147.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.7435e+00, 3.7773e+00, 3.8066e+00, 3.8137e+00, 3.8540e+00,
        3.9541e+00, 4.1320e+00, 4.2600e+00, 4.2748e+00, 3.7961e+05, 3.8777e+05,
        3.8902e+05, 3.9763e+05, 3.9843e+05, 4.0305e+05, 4.0706e+05, 4.1299e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.8540e+00, 3.9222e+00, 3.9518e+00, 4.0491e+00, 4.0502e+00,
        4.1417e+00, 4.3281e+00, 4.4300e+00, 4.4997e+00, 3.7963e+05, 3.8777e+05,
        3.8900e+05, 3.9764e+05, 3.9845e+05, 4.0310e+05, 4.0706e+05, 4.1301e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.8763e+00, 4.0887e+00, 4.2600e+00, 4.3263e+00, 4.3336e+00,
        4.4300e+00, 4.4929e+00, 4.5811e+00, 4.6599e+00, 3.7966e+05, 3.8772e+05,
        3.8903e+05, 3.9764e+05, 3.9848e+05, 4.0306e+05, 4.0710e+05, 4.1302e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388989.0000, 389004.4688, 389007.2188, 389023.7812,
        389023.8125, 389028.5000, 389028.5625, 389050.1875, 389057.9375,
        389070.7500, 763559.6875, 776156.0000, 781722.0625, 784645.6875,
        787504.9375, 790148.2500, 811981.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387700.0625, 387714.6875, 387715.0625, 387717.9688,
        387728.4062, 387734.4062, 387741.6875, 387751.3750, 387765.0625,
        387772.8438, 769089.1250, 777118.3750, 782070.6875, 782593.8125,
        784645.6875, 802630.6250, 804509.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 403034.3438, 403047.1875, 403052.1250, 403054.9375,
        403062.0000, 403064.9062, 403065.8125, 403066.3438, 403082.9375,
        403099.1875, 781722.0625, 782593.8125, 783790.0000, 791337.7500,
        800114.6875, 810983.3750, 844300.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6682e+00, 3.6843e+00, 3.7435e+00, 3.9409e+00, 3.9579e+00,
        3.9985e+00, 4.0042e+00, 4.0491e+00, 4.4929e+00, 3.7963e+05, 3.8775e+05,
        3.8902e+05, 3.9761e+05, 3.9846e+05, 4.0307e+05, 4.0710e+05, 4.1299e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6637e+00, 3.6682e+00, 3.7062e+00, 3.7102e+00, 3.7773e+00,
        4.0502e+00, 4.1032e+00, 4.3263e+00, 4.3441e+00, 3.7958e+05, 3.8772e+05,
        3.8899e+05, 3.9766e+05, 3.9845e+05, 4.0303e+05, 4.0708e+05, 4.1299e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6384e+00, 3.6843e+00, 3.7062e+00, 3.7288e+00, 3.8137e+00,
        3.8894e+00, 3.9518e+00, 4.0887e+00, 4.2024e+00, 3.7960e+05, 3.8773e+05,
        3.8903e+05, 3.9768e+05, 3.9847e+05, 4.0307e+05, 4.0715e+05, 4.1297e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.9579e+00, 4.0552e+00, 4.2024e+00, 4.2685e+00, 4.2748e+00,
        4.2952e+00, 4.3441e+00, 4.4997e+00, 4.6599e+00, 3.7962e+05, 3.8771e+05,
        3.8905e+05, 3.9764e+05, 3.9846e+05, 4.0305e+05, 4.0712e+05, 4.1304e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398407.7812, 398426.8750, 398438.3438, 398448.3750,
        398454.5000, 398459.0312, 398462.7500, 398466.3438, 398467.5312,
        398480.9375, 777903.7500, 782070.6875, 790148.2500, 794715.5625,
        800114.6875, 803070.0625, 806330.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.8894e+00, 3.9541e+00, 4.0042e+00, 4.0926e+00, 4.1032e+00,
        4.1161e+00, 4.2952e+00, 4.3281e+00, 4.3336e+00, 3.7959e+05, 3.8774e+05,
        3.8907e+05, 3.9765e+05, 3.9844e+05, 4.0305e+05, 4.0708e+05, 4.1303e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 3.6637e+00, 3.7288e+00, 3.8066e+00, 3.8352e+00, 3.8763e+00,
        3.9222e+00, 3.9409e+00, 4.0552e+00, 4.1161e+00, 3.7962e+05, 3.8773e+05,
        3.8901e+05, 3.9763e+05, 3.9847e+05, 4.0306e+05, 4.0709e+05, 4.1302e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['414520.31', '440929.59', '69760.13', '448468.88', '431996.50', '69765.34', '69766.89', '69764.63', '423076.75', '422402.78', '437486.50', '69765.15', '69757.73', '69760.69', '69761.46', '432946.91', '69760.61', '69761.88']
estimated f for each client, fs: [7, 6, 8, 6, 6, 8, 8, 8, 6, 6, 6, 8, 8, 8, 8, 6, 8, 8]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [17, 15, 8, 18, 13, 5, 7, 6, 19, 16, 20, 11, 12, 10, 9, 14, 2, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0248s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:34...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[114 123]
 [115 148]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:46:34, End: 2025-07-22 15:46:34)
start time is: 98164975117800, end time is: 98176603947282
The total time is: 11628829482ns.

 ------- aggregate method: krum, random_seed: 0 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [18, 20, 15, 6, 19, 17, 2, 9, 10, 3, 1, 16, 4], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 7.9495e+05, 7.7523e+05, 3.7890e+05, 7.8015e+05, 7.5317e+05,
         3.7896e+05, 3.7886e+05, 3.7885e+05, 3.7885e+05, 3.7885e+05, 7.8577e+05,
         3.7885e+05],
        [7.9495e+05, 0.0000e+00, 7.9784e+05, 4.0493e+05, 8.0063e+05, 7.8396e+05,
         4.0496e+05, 4.0495e+05, 4.0494e+05, 4.0491e+05, 4.0491e+05, 7.9046e+05,
         4.0493e+05],
        [7.7523e+05, 7.9784e+05, 0.0000e+00, 3.8580e+05, 8.0657e+05, 7.6671e+05,
         3.8579e+05, 3.8586e+05, 3.8584e+05, 3.8592e+05, 3.8586e+05, 7.7845e+05,
         3.8582e+05],
        [3.7890e+05, 4.0493e+05, 3.8580e+05, 0.0000e+00, 3.9981e+05, 3.7475e+05,
         5.6109e+00, 5.2985e+00, 5.4107e+00, 5.3341e+00, 5.6512e+00, 3.9090e+05,
         6.0036e+00],
        [7.8015e+05, 8.0063e+05, 8.0657e+05, 3.9981e+05, 0.0000e+00, 7.4672e+05,
         3.9985e+05, 3.9989e+05, 3.9988e+05, 3.9986e+05, 3.9978e+05, 7.9104e+05,
         3.9983e+05],
        [7.5317e+05, 7.8396e+05, 7.6671e+05, 3.7475e+05, 7.4672e+05, 0.0000e+00,
         3.7470e+05, 3.7477e+05, 3.7472e+05, 3.7475e+05, 3.7478e+05, 7.8224e+05,
         3.7477e+05],
        [3.7896e+05, 4.0496e+05, 3.8579e+05, 5.6109e+00, 3.9985e+05, 3.7470e+05,
         0.0000e+00, 4.1089e+00, 4.6571e+00, 4.7305e+00, 5.1618e+00, 3.9099e+05,
         4.4429e+00],
        [3.7886e+05, 4.0495e+05, 3.8586e+05, 5.2985e+00, 3.9989e+05, 3.7477e+05,
         4.1089e+00, 0.0000e+00, 4.6723e+00, 4.3504e+00, 5.1237e+00, 3.9103e+05,
         4.5725e+00],
        [3.7885e+05, 4.0494e+05, 3.8584e+05, 5.4107e+00, 3.9988e+05, 3.7472e+05,
         4.6571e+00, 4.6723e+00, 0.0000e+00, 4.5992e+00, 4.8889e+00, 3.9096e+05,
         4.8643e+00],
        [3.7885e+05, 4.0491e+05, 3.8592e+05, 5.3341e+00, 3.9986e+05, 3.7475e+05,
         4.7305e+00, 4.3504e+00, 4.5992e+00, 0.0000e+00, 5.5144e+00, 3.9103e+05,
         4.6910e+00],
        [3.7885e+05, 4.0491e+05, 3.8586e+05, 5.6512e+00, 3.9978e+05, 3.7478e+05,
         5.1618e+00, 5.1237e+00, 4.8889e+00, 5.5144e+00, 0.0000e+00, 3.9088e+05,
         5.1773e+00],
        [7.8577e+05, 7.9046e+05, 7.7845e+05, 3.9090e+05, 7.9104e+05, 7.8224e+05,
         3.9099e+05, 3.9103e+05, 3.9096e+05, 3.9103e+05, 3.9088e+05, 0.0000e+00,
         3.9092e+05],
        [3.7885e+05, 4.0493e+05, 3.8582e+05, 6.0036e+00, 3.9983e+05, 3.7477e+05,
         4.4429e+00, 4.5725e+00, 4.8643e+00, 4.6910e+00, 5.1773e+00, 3.9092e+05,
         0.0000e+00]])
Krum scores: ['378851.22', '404924.25', '385821.72', '5.46', '399826.81', '374736.53', '4.62', '4.57', '4.74', '4.74', '5.17', '390930.78', '4.75']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [18, 20, 15, 6, 19, 17, 2, 9, 10, 3, 1, 16, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0069s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:35...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:35, End: 2025-07-22 15:46:35)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [9, 16, 15, 13, 1, 20, 11, 5, 14, 3], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.8562e+05, 3.8169e+05, 3.8281e+05, 2.0410e+00, 3.9910e+05,
         2.0766e+00, 2.1121e+00, 3.9549e+05, 2.0728e+00],
        [3.8562e+05, 0.0000e+00, 7.6767e+05, 7.6762e+05, 3.8560e+05, 7.8898e+05,
         3.8558e+05, 3.8561e+05, 7.7037e+05, 3.8563e+05],
        [3.8169e+05, 7.6767e+05, 0.0000e+00, 7.5909e+05, 3.8164e+05, 7.7185e+05,
         3.8165e+05, 3.8164e+05, 7.8173e+05, 3.8165e+05],
        [3.8281e+05, 7.6762e+05, 7.5909e+05, 0.0000e+00, 3.8280e+05, 7.5855e+05,
         3.8282e+05, 3.8280e+05, 7.9522e+05, 3.8279e+05],
        [2.0410e+00, 3.8560e+05, 3.8164e+05, 3.8280e+05, 0.0000e+00, 3.9905e+05,
         1.9542e+00, 1.9056e+00, 3.9547e+05, 2.0039e+00],
        [3.9910e+05, 7.8898e+05, 7.7185e+05, 7.5855e+05, 3.9905e+05, 0.0000e+00,
         3.9912e+05, 3.9906e+05, 8.0699e+05, 3.9907e+05],
        [2.0766e+00, 3.8558e+05, 3.8165e+05, 3.8282e+05, 1.9542e+00, 3.9912e+05,
         0.0000e+00, 1.8620e+00, 3.9549e+05, 1.9799e+00],
        [2.1121e+00, 3.8561e+05, 3.8164e+05, 3.8280e+05, 1.9056e+00, 3.9906e+05,
         1.8620e+00, 0.0000e+00, 3.9547e+05, 1.8771e+00],
        [3.9549e+05, 7.7037e+05, 7.8173e+05, 7.9522e+05, 3.9547e+05, 8.0699e+05,
         3.9549e+05, 3.9547e+05, 0.0000e+00, 3.9547e+05],
        [2.0728e+00, 3.8563e+05, 3.8165e+05, 3.8279e+05, 2.0039e+00, 3.9907e+05,
         1.9799e+00, 1.8771e+00, 3.9547e+05, 0.0000e+00]])
Krum scores: ['2.06', '385595.22', '381640.06', '382796.34', '1.95', '399059.31', '1.93', '1.88', '395470.34', '1.95']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']], selected_client_indices: [9, 16, 15, 13, 1, 20, 11, 5, 14, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0022s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:35...
global Accuracy on shared test data: 78.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[189  48]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:35, End: 2025-07-22 15:46:35)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [8, 16, 11, 18, 14, 1, 19, 12, 15, 10, 6, 13, 9, 7, 5, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0181e+05, 1.8175e+00, 3.9338e+05, 3.9129e+05, 1.8628e+00,
         3.9056e+05, 1.8117e+00, 3.9333e+05, 1.7013e+00, 1.8396e+00, 3.9611e+05,
         1.8622e+00, 1.8394e+00, 2.1922e+00, 4.0200e+05],
        [4.0181e+05, 0.0000e+00, 4.0183e+05, 7.9955e+05, 8.0630e+05, 4.0181e+05,
         8.0179e+05, 4.0179e+05, 7.7136e+05, 4.0184e+05, 4.0183e+05, 7.8687e+05,
         4.0178e+05, 4.0176e+05, 4.0179e+05, 7.7877e+05],
        [1.8175e+00, 4.0183e+05, 0.0000e+00, 3.9337e+05, 3.9135e+05, 1.6183e+00,
         3.9054e+05, 1.6849e+00, 3.9331e+05, 1.6995e+00, 1.7682e+00, 3.9613e+05,
         1.7313e+00, 1.7139e+00, 1.8121e+00, 4.0195e+05],
        [3.9338e+05, 7.9955e+05, 3.9337e+05, 0.0000e+00, 7.8486e+05, 3.9336e+05,
         7.9241e+05, 3.9335e+05, 7.8289e+05, 3.9330e+05, 3.9336e+05, 8.0084e+05,
         3.9334e+05, 3.9335e+05, 3.9337e+05, 7.9286e+05],
        [3.9129e+05, 8.0630e+05, 3.9135e+05, 7.8486e+05, 0.0000e+00, 3.9134e+05,
         8.0672e+05, 3.9135e+05, 7.8995e+05, 3.9132e+05, 3.9134e+05, 7.7150e+05,
         3.9134e+05, 3.9132e+05, 3.9129e+05, 7.9586e+05],
        [1.8628e+00, 4.0181e+05, 1.6183e+00, 3.9336e+05, 3.9134e+05, 0.0000e+00,
         3.9054e+05, 1.7029e+00, 3.9334e+05, 1.5856e+00, 1.6404e+00, 3.9612e+05,
         1.5990e+00, 1.6463e+00, 1.8603e+00, 4.0199e+05],
        [3.9056e+05, 8.0179e+05, 3.9054e+05, 7.9241e+05, 8.0672e+05, 3.9054e+05,
         0.0000e+00, 3.9052e+05, 7.8332e+05, 3.9057e+05, 3.9056e+05, 7.8171e+05,
         3.9059e+05, 3.9057e+05, 3.9054e+05, 8.2126e+05],
        [1.8117e+00, 4.0179e+05, 1.6849e+00, 3.9335e+05, 3.9135e+05, 1.7029e+00,
         3.9052e+05, 0.0000e+00, 3.9334e+05, 1.6707e+00, 1.8145e+00, 3.9616e+05,
         1.8022e+00, 1.6789e+00, 1.9223e+00, 4.0196e+05],
        [3.9333e+05, 7.7136e+05, 3.9331e+05, 7.8289e+05, 7.8995e+05, 3.9334e+05,
         7.8332e+05, 3.9334e+05, 0.0000e+00, 3.9332e+05, 3.9334e+05, 7.6937e+05,
         3.9332e+05, 3.9334e+05, 3.9332e+05, 7.9914e+05],
        [1.7013e+00, 4.0184e+05, 1.6995e+00, 3.9330e+05, 3.9132e+05, 1.5856e+00,
         3.9057e+05, 1.6707e+00, 3.9332e+05, 0.0000e+00, 1.7761e+00, 3.9611e+05,
         1.5723e+00, 1.6443e+00, 1.8758e+00, 4.0197e+05],
        [1.8396e+00, 4.0183e+05, 1.7682e+00, 3.9336e+05, 3.9134e+05, 1.6404e+00,
         3.9056e+05, 1.8145e+00, 3.9334e+05, 1.7761e+00, 0.0000e+00, 3.9612e+05,
         1.8160e+00, 1.8078e+00, 2.1330e+00, 4.0200e+05],
        [3.9611e+05, 7.8687e+05, 3.9613e+05, 8.0084e+05, 7.7150e+05, 3.9612e+05,
         7.8171e+05, 3.9616e+05, 7.6937e+05, 3.9611e+05, 3.9612e+05, 0.0000e+00,
         3.9612e+05, 3.9614e+05, 3.9613e+05, 7.9431e+05],
        [1.8622e+00, 4.0178e+05, 1.7313e+00, 3.9334e+05, 3.9134e+05, 1.5990e+00,
         3.9059e+05, 1.8022e+00, 3.9332e+05, 1.5723e+00, 1.8160e+00, 3.9612e+05,
         0.0000e+00, 1.8017e+00, 1.8733e+00, 4.0200e+05],
        [1.8394e+00, 4.0176e+05, 1.7139e+00, 3.9335e+05, 3.9132e+05, 1.6463e+00,
         3.9057e+05, 1.6789e+00, 3.9334e+05, 1.6443e+00, 1.8078e+00, 3.9614e+05,
         1.8017e+00, 0.0000e+00, 1.8764e+00, 4.0201e+05],
        [2.1922e+00, 4.0179e+05, 1.8121e+00, 3.9337e+05, 3.9129e+05, 1.8603e+00,
         3.9054e+05, 1.9223e+00, 3.9332e+05, 1.8758e+00, 2.1330e+00, 3.9613e+05,
         1.8733e+00, 1.8764e+00, 0.0000e+00, 4.0198e+05],
        [4.0200e+05, 7.7877e+05, 4.0195e+05, 7.9286e+05, 7.9586e+05, 4.0199e+05,
         8.2126e+05, 4.0196e+05, 7.9914e+05, 4.0197e+05, 4.0200e+05, 7.9431e+05,
         4.0200e+05, 4.0201e+05, 4.0198e+05, 0.0000e+00]])
Krum scores: ['1.82', '401795.34', '1.72', '393347.22', '391320.44', '1.66', '390546.06', '1.74', '393326.06', '1.66', '1.78', '396119.75', '1.74', '1.73', '1.91', '401980.50']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 16, 11, 18, 14, 1, 19, 12, 15, 10, 6, 13, 9, 7, 5, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:36...
global Accuracy on shared test data: 78.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:36, End: 2025-07-22 15:46:36)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [2, 7, 19], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[0.0000e+00, 1.7479e+00, 3.8445e+05],
        [1.7479e+00, 0.0000e+00, 3.8445e+05],
        [3.8445e+05, 3.8445e+05, 0.0000e+00]])
Krum scores: ['nan', 'nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']], selected_client_indices: [2, 7, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0022s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:36...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[187  50]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:36, End: 2025-07-22 15:46:36)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [10, 14, 4, 17, 13, 16, 2, 8, 15, 19, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
tensor([[0.0000e+00, 3.9325e+05, 1.9307e+00, 3.8839e+05, 3.9903e+05, 3.9669e+05,
         1.6776e+00, 1.7893e+00, 3.7842e+05, 3.9428e+05, 3.8585e+05],
        [3.9325e+05, 0.0000e+00, 3.9325e+05, 7.7747e+05, 8.0575e+05, 7.9307e+05,
         3.9323e+05, 3.9326e+05, 7.6677e+05, 8.0669e+05, 7.8981e+05],
        [1.9307e+00, 3.9325e+05, 0.0000e+00, 3.8838e+05, 3.9900e+05, 3.9671e+05,
         1.8417e+00, 1.8293e+00, 3.7848e+05, 3.9434e+05, 3.8579e+05],
        [3.8839e+05, 7.7747e+05, 3.8838e+05, 0.0000e+00, 7.7880e+05, 7.6568e+05,
         3.8838e+05, 3.8839e+05, 7.7226e+05, 7.9472e+05, 7.8449e+05],
        [3.9903e+05, 8.0575e+05, 3.9900e+05, 7.7880e+05, 0.0000e+00, 8.1171e+05,
         3.9899e+05, 3.9897e+05, 7.8549e+05, 8.0543e+05, 7.8436e+05],
        [3.9669e+05, 7.9307e+05, 3.9671e+05, 7.6568e+05, 8.1171e+05, 0.0000e+00,
         3.9668e+05, 3.9667e+05, 7.7921e+05, 7.9870e+05, 7.7245e+05],
        [1.6776e+00, 3.9323e+05, 1.8417e+00, 3.8838e+05, 3.9899e+05, 3.9668e+05,
         0.0000e+00, 1.9822e+00, 3.7845e+05, 3.9435e+05, 3.8583e+05],
        [1.7893e+00, 3.9326e+05, 1.8293e+00, 3.8839e+05, 3.9897e+05, 3.9667e+05,
         1.9822e+00, 0.0000e+00, 3.7843e+05, 3.9438e+05, 3.8584e+05],
        [3.7842e+05, 7.6677e+05, 3.7848e+05, 7.7226e+05, 7.8549e+05, 7.7921e+05,
         3.7845e+05, 3.7843e+05, 0.0000e+00, 7.6245e+05, 7.5364e+05],
        [3.9428e+05, 8.0669e+05, 3.9434e+05, 7.9472e+05, 8.0543e+05, 7.9870e+05,
         3.9435e+05, 3.9438e+05, 7.6245e+05, 0.0000e+00, 7.8110e+05],
        [3.8585e+05, 7.8981e+05, 3.8579e+05, 7.8449e+05, 7.8436e+05, 7.7245e+05,
         3.8583e+05, 3.8584e+05, 7.5364e+05, 7.8110e+05, 0.0000e+00]])
Krum scores: ['1.73', '393238.72', '1.84', '388382.22', '398980.66', '396673.47', '1.76', '1.81', '378424.31', '394313.38', '385810.47']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [10, 14, 4, 17, 13, 16, 2, 8, 15, 19, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0038s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:36...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:36, End: 2025-07-22 15:46:36)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [14, 6, 19], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[     0.0000, 388323.7812, 805144.0625],
        [388323.7812,      0.0000, 389433.5000],
        [805144.0625, 389433.5000,      0.0000]])
Krum scores: ['nan', 'nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']], selected_client_indices: [14, 6, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0171s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:37...
global Accuracy on shared test data: 51.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 10 227]
 [ 16 247]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:46:37, End: 2025-07-22 15:46:37)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (4): [1, 8, 13, 16], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 4
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([4])
tensor([[0.0000e+00, 3.2906e+00, 3.7545e+05, 3.7949e+05],
        [3.2906e+00, 0.0000e+00, 3.7547e+05, 3.7950e+05],
        [3.7545e+05, 3.7547e+05, 0.0000e+00, 7.6328e+05],
        [3.7949e+05, 3.7950e+05, 7.6328e+05, 0.0000e+00]])
Krum scores: ['nan', 'nan', 'nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']], selected_client_indices: [1, 8, 13, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0031s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:37...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 15 222]
 [ 20 243]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:37, End: 2025-07-22 15:46:37)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 8, 17, 1, 5, 20, 6, 2, 12, 3, 18, 16, 9, 19, 11, 13, 7, 4], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.9381e+05, 8.2593e+05, 3.9382e+05, 3.9379e+05, 7.8447e+05,
         3.9379e+05, 3.9384e+05, 3.9380e+05, 3.9380e+05, 8.1262e+05, 7.5932e+05,
         3.9382e+05, 7.6962e+05, 3.9375e+05, 8.0279e+05, 3.9377e+05, 3.9380e+05],
        [3.9381e+05, 0.0000e+00, 4.0130e+05, 3.2695e+00, 3.4192e+00, 3.8879e+05,
         3.4774e+00, 3.5594e+00, 3.4517e+00, 3.1844e+00, 3.8691e+05, 3.8598e+05,
         3.4770e+00, 3.7926e+05, 3.1304e+00, 3.9159e+05, 3.4587e+00, 3.5362e+00],
        [8.2593e+05, 4.0130e+05, 0.0000e+00, 4.0129e+05, 4.0131e+05, 7.7624e+05,
         4.0126e+05, 4.0132e+05, 4.0129e+05, 4.0126e+05, 7.8101e+05, 7.7666e+05,
         4.0128e+05, 7.8676e+05, 4.0130e+05, 7.7734e+05, 4.0128e+05, 4.0124e+05],
        [3.9382e+05, 3.2695e+00, 4.0129e+05, 0.0000e+00, 3.2512e+00, 3.8881e+05,
         3.1345e+00, 3.3388e+00, 3.2616e+00, 2.9408e+00, 3.8692e+05, 3.8600e+05,
         3.4940e+00, 3.7926e+05, 3.0231e+00, 3.9164e+05, 3.4425e+00, 3.6137e+00],
        [3.9379e+05, 3.4192e+00, 4.0131e+05, 3.2512e+00, 0.0000e+00, 3.8878e+05,
         3.1749e+00, 3.0507e+00, 3.1167e+00, 3.2091e+00, 3.8684e+05, 3.8595e+05,
         3.4544e+00, 3.7926e+05, 2.8923e+00, 3.9162e+05, 3.0530e+00, 3.0889e+00],
        [7.8447e+05, 3.8879e+05, 7.7624e+05, 3.8881e+05, 3.8878e+05, 0.0000e+00,
         3.8879e+05, 3.8876e+05, 3.8884e+05, 3.8879e+05, 7.6815e+05, 7.7996e+05,
         3.8884e+05, 7.7932e+05, 3.8880e+05, 7.8469e+05, 3.8880e+05, 3.8875e+05],
        [3.9379e+05, 3.4774e+00, 4.0126e+05, 3.1345e+00, 3.1749e+00, 3.8879e+05,
         0.0000e+00, 3.3599e+00, 2.9925e+00, 3.2047e+00, 3.8690e+05, 3.8597e+05,
         3.5901e+00, 3.7927e+05, 3.0753e+00, 3.9162e+05, 3.3955e+00, 3.4172e+00],
        [3.9384e+05, 3.5594e+00, 4.0132e+05, 3.3388e+00, 3.0507e+00, 3.8876e+05,
         3.3599e+00, 0.0000e+00, 3.0818e+00, 3.1370e+00, 3.8684e+05, 3.8594e+05,
         3.4866e+00, 3.7926e+05, 3.0687e+00, 3.9166e+05, 3.3591e+00, 3.4397e+00],
        [3.9380e+05, 3.4517e+00, 4.0129e+05, 3.2616e+00, 3.1167e+00, 3.8884e+05,
         2.9925e+00, 3.0818e+00, 0.0000e+00, 3.0887e+00, 3.8689e+05, 3.8600e+05,
         3.5979e+00, 3.7924e+05, 3.1933e+00, 3.9158e+05, 3.0783e+00, 3.3040e+00],
        [3.9380e+05, 3.1844e+00, 4.0126e+05, 2.9408e+00, 3.2091e+00, 3.8879e+05,
         3.2047e+00, 3.1370e+00, 3.0887e+00, 0.0000e+00, 3.8690e+05, 3.8599e+05,
         3.3039e+00, 3.7931e+05, 3.0928e+00, 3.9165e+05, 3.0474e+00, 3.3287e+00],
        [8.1262e+05, 3.8691e+05, 7.8101e+05, 3.8692e+05, 3.8684e+05, 7.6815e+05,
         3.8690e+05, 3.8684e+05, 3.8689e+05, 3.8690e+05, 0.0000e+00, 7.6349e+05,
         3.8686e+05, 7.7850e+05, 3.8686e+05, 7.9445e+05, 3.8687e+05, 3.8686e+05],
        [7.5932e+05, 3.8598e+05, 7.7666e+05, 3.8600e+05, 3.8595e+05, 7.7996e+05,
         3.8597e+05, 3.8594e+05, 3.8600e+05, 3.8599e+05, 7.6349e+05, 0.0000e+00,
         3.8597e+05, 7.6514e+05, 3.8596e+05, 7.7536e+05, 3.8597e+05, 3.8598e+05],
        [3.9382e+05, 3.4770e+00, 4.0128e+05, 3.4940e+00, 3.4544e+00, 3.8884e+05,
         3.5901e+00, 3.4866e+00, 3.5979e+00, 3.3039e+00, 3.8686e+05, 3.8597e+05,
         0.0000e+00, 3.7927e+05, 3.1743e+00, 3.9162e+05, 3.6830e+00, 3.7651e+00],
        [7.6962e+05, 3.7926e+05, 7.8676e+05, 3.7926e+05, 3.7926e+05, 7.7932e+05,
         3.7927e+05, 3.7926e+05, 3.7924e+05, 3.7931e+05, 7.7850e+05, 7.6514e+05,
         3.7927e+05, 0.0000e+00, 3.7926e+05, 7.7050e+05, 3.7926e+05, 3.7928e+05],
        [3.9375e+05, 3.1304e+00, 4.0130e+05, 3.0231e+00, 2.8923e+00, 3.8880e+05,
         3.0753e+00, 3.0687e+00, 3.1933e+00, 3.0928e+00, 3.8686e+05, 3.8596e+05,
         3.1743e+00, 3.7926e+05, 0.0000e+00, 3.9166e+05, 2.9312e+00, 3.0810e+00],
        [8.0279e+05, 3.9159e+05, 7.7734e+05, 3.9164e+05, 3.9162e+05, 7.8469e+05,
         3.9162e+05, 3.9166e+05, 3.9158e+05, 3.9165e+05, 7.9445e+05, 7.7536e+05,
         3.9162e+05, 7.7050e+05, 3.9166e+05, 0.0000e+00, 3.9159e+05, 3.9163e+05],
        [3.9377e+05, 3.4587e+00, 4.0128e+05, 3.4425e+00, 3.0530e+00, 3.8880e+05,
         3.3955e+00, 3.3591e+00, 3.0783e+00, 3.0474e+00, 3.8687e+05, 3.8597e+05,
         3.6830e+00, 3.7926e+05, 2.9312e+00, 3.9159e+05, 0.0000e+00, 3.1555e+00],
        [3.9380e+05, 3.5362e+00, 4.0124e+05, 3.6137e+00, 3.0889e+00, 3.8875e+05,
         3.4172e+00, 3.4397e+00, 3.3040e+00, 3.3287e+00, 3.8686e+05, 3.8598e+05,
         3.7651e+00, 3.7928e+05, 3.0810e+00, 3.9163e+05, 3.1555e+00, 0.0000e+00]])
Krum scores: ['393791.91', '3.38', '401277.47', '3.24', '3.14', '388784.78', '3.25', '3.26', '3.17', '3.13', '386870.28', '385966.06', '3.47', '379259.28', '3.05', '391615.28', '3.21', '3.33']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 8, 17, 1, 5, 20, 6, 2, 12, 3, 18, 16, 9, 19, 11, 13, 7, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0090s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:37...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 23 214]
 [ 25 238]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:37, End: 2025-07-22 15:46:37)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [19, 4, 12, 9, 6, 5, 7, 20, 11], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 3.8094e+05, 3.8097e+05, 3.8096e+05, 3.8095e+05, 3.8094e+05,
         3.8100e+05, 7.8410e+05, 3.8095e+05],
        [3.8094e+05, 0.0000e+00, 3.2585e+00, 3.7163e+00, 3.3246e+00, 3.1540e+00,
         3.1088e+00, 3.9405e+05, 3.1099e+00],
        [3.8097e+05, 3.2585e+00, 0.0000e+00, 3.6239e+00, 2.9760e+00, 3.1828e+00,
         3.0437e+00, 3.9411e+05, 3.1042e+00],
        [3.8096e+05, 3.7163e+00, 3.6239e+00, 0.0000e+00, 3.6263e+00, 3.5219e+00,
         3.7977e+00, 3.9405e+05, 3.3033e+00],
        [3.8095e+05, 3.3246e+00, 2.9760e+00, 3.6263e+00, 0.0000e+00, 3.1703e+00,
         3.3521e+00, 3.9408e+05, 3.1013e+00],
        [3.8094e+05, 3.1540e+00, 3.1828e+00, 3.5219e+00, 3.1703e+00, 0.0000e+00,
         3.0709e+00, 3.9412e+05, 2.9610e+00],
        [3.8100e+05, 3.1088e+00, 3.0437e+00, 3.7977e+00, 3.3521e+00, 3.0709e+00,
         0.0000e+00, 3.9407e+05, 3.0325e+00],
        [7.8410e+05, 3.9405e+05, 3.9411e+05, 3.9405e+05, 3.9408e+05, 3.9412e+05,
         3.9407e+05, 0.0000e+00, 3.9403e+05],
        [3.8095e+05, 3.1099e+00, 3.1042e+00, 3.3033e+00, 3.1013e+00, 2.9610e+00,
         3.0325e+00, 3.9403e+05, 0.0000e+00]])
Krum scores: ['380947.78', '3.19', '3.11', '3.56', '3.18', '3.11', '3.12', '394059.00', '3.06']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']], selected_client_indices: [19, 4, 12, 9, 6, 5, 7, 20, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0210s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:38...
global Accuracy on shared test data: 53.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 34 203]
 [ 31 232]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:38, End: 2025-07-22 15:46:38)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [2, 6, 15, 12, 10, 18, 16, 14, 1, 17, 11, 9, 19, 5, 3, 4, 7, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.4447e+00, 3.8608e+05, 3.1826e+00, 3.3541e+00, 3.7365e+05,
         3.8394e+05, 3.8406e+05, 3.3976e+00, 3.9395e+05, 3.3653e+00, 3.6394e+00,
         3.9973e+05, 3.3288e+00, 3.2583e+00, 3.5078e+00, 3.4433e+00, 3.8827e+05],
        [3.4447e+00, 0.0000e+00, 3.8603e+05, 2.9642e+00, 3.1945e+00, 3.7362e+05,
         3.8396e+05, 3.8410e+05, 3.0978e+00, 3.9397e+05, 3.1402e+00, 3.7463e+00,
         3.9972e+05, 3.1842e+00, 3.2403e+00, 3.2762e+00, 3.3881e+00, 3.8826e+05],
        [3.8608e+05, 3.8603e+05, 0.0000e+00, 3.8607e+05, 3.8606e+05, 7.5126e+05,
         7.6167e+05, 7.6798e+05, 3.8604e+05, 7.6813e+05, 3.8606e+05, 3.8605e+05,
         7.6715e+05, 3.8607e+05, 3.8608e+05, 3.8608e+05, 3.8611e+05, 7.9081e+05],
        [3.1826e+00, 2.9642e+00, 3.8607e+05, 0.0000e+00, 3.0973e+00, 3.7365e+05,
         3.8395e+05, 3.8406e+05, 3.2217e+00, 3.9397e+05, 3.1605e+00, 3.6647e+00,
         3.9975e+05, 3.1940e+00, 3.0780e+00, 3.1584e+00, 3.0624e+00, 3.8824e+05],
        [3.3541e+00, 3.1945e+00, 3.8606e+05, 3.0973e+00, 0.0000e+00, 3.7360e+05,
         3.8393e+05, 3.8403e+05, 3.3567e+00, 3.9398e+05, 3.1391e+00, 3.4812e+00,
         3.9973e+05, 3.3695e+00, 3.0661e+00, 3.4850e+00, 3.3132e+00, 3.8828e+05],
        [3.7365e+05, 3.7362e+05, 7.5126e+05, 3.7365e+05, 3.7360e+05, 0.0000e+00,
         7.5895e+05, 7.4747e+05, 3.7366e+05, 7.7559e+05, 3.7360e+05, 3.7359e+05,
         7.7741e+05, 3.7364e+05, 3.7362e+05, 3.7362e+05, 3.7367e+05, 7.6344e+05],
        [3.8394e+05, 3.8396e+05, 7.6167e+05, 3.8395e+05, 3.8393e+05, 7.5895e+05,
         0.0000e+00, 7.6277e+05, 3.8398e+05, 7.8424e+05, 3.8398e+05, 3.8395e+05,
         7.9430e+05, 3.8397e+05, 3.8393e+05, 3.8399e+05, 3.8398e+05, 7.6776e+05],
        [3.8406e+05, 3.8410e+05, 7.6798e+05, 3.8406e+05, 3.8403e+05, 7.4747e+05,
         7.6277e+05, 0.0000e+00, 3.8409e+05, 7.6395e+05, 3.8410e+05, 3.8408e+05,
         7.8266e+05, 3.8409e+05, 3.8405e+05, 3.8411e+05, 3.8408e+05, 7.8044e+05],
        [3.3976e+00, 3.0978e+00, 3.8604e+05, 3.2217e+00, 3.3567e+00, 3.7366e+05,
         3.8398e+05, 3.8409e+05, 0.0000e+00, 3.9395e+05, 3.1809e+00, 3.6686e+00,
         3.9977e+05, 3.3769e+00, 3.0559e+00, 3.6338e+00, 3.4278e+00, 3.8826e+05],
        [3.9395e+05, 3.9397e+05, 7.6813e+05, 3.9397e+05, 3.9398e+05, 7.7559e+05,
         7.8424e+05, 7.6395e+05, 3.9395e+05, 0.0000e+00, 3.9392e+05, 3.9399e+05,
         7.9385e+05, 3.9397e+05, 3.9395e+05, 3.9395e+05, 3.9397e+05, 7.7526e+05],
        [3.3653e+00, 3.1402e+00, 3.8606e+05, 3.1605e+00, 3.1391e+00, 3.7360e+05,
         3.8398e+05, 3.8410e+05, 3.1809e+00, 3.9392e+05, 0.0000e+00, 3.4803e+00,
         3.9974e+05, 2.9485e+00, 3.2304e+00, 3.1160e+00, 3.1439e+00, 3.8822e+05],
        [3.6394e+00, 3.7463e+00, 3.8605e+05, 3.6647e+00, 3.4812e+00, 3.7359e+05,
         3.8395e+05, 3.8408e+05, 3.6686e+00, 3.9399e+05, 3.4803e+00, 0.0000e+00,
         3.9976e+05, 3.7197e+00, 3.4158e+00, 3.7604e+00, 3.8612e+00, 3.8822e+05],
        [3.9973e+05, 3.9972e+05, 7.6715e+05, 3.9975e+05, 3.9973e+05, 7.7741e+05,
         7.9430e+05, 7.8266e+05, 3.9977e+05, 7.9385e+05, 3.9974e+05, 3.9976e+05,
         0.0000e+00, 3.9968e+05, 3.9977e+05, 3.9973e+05, 3.9975e+05, 8.0506e+05],
        [3.3288e+00, 3.1842e+00, 3.8607e+05, 3.1940e+00, 3.3695e+00, 3.7364e+05,
         3.8397e+05, 3.8409e+05, 3.3769e+00, 3.9397e+05, 2.9485e+00, 3.7197e+00,
         3.9968e+05, 0.0000e+00, 3.2533e+00, 3.1703e+00, 3.1561e+00, 3.8826e+05],
        [3.2583e+00, 3.2403e+00, 3.8608e+05, 3.0780e+00, 3.0661e+00, 3.7362e+05,
         3.8393e+05, 3.8405e+05, 3.0559e+00, 3.9395e+05, 3.2304e+00, 3.4158e+00,
         3.9977e+05, 3.2533e+00, 0.0000e+00, 3.3324e+00, 3.1111e+00, 3.8828e+05],
        [3.5078e+00, 3.2762e+00, 3.8608e+05, 3.1584e+00, 3.4850e+00, 3.7362e+05,
         3.8399e+05, 3.8411e+05, 3.6338e+00, 3.9395e+05, 3.1160e+00, 3.7604e+00,
         3.9973e+05, 3.1703e+00, 3.3324e+00, 0.0000e+00, 3.1025e+00, 3.8823e+05],
        [3.4433e+00, 3.3881e+00, 3.8611e+05, 3.0624e+00, 3.3132e+00, 3.7367e+05,
         3.8398e+05, 3.8408e+05, 3.4278e+00, 3.9397e+05, 3.1439e+00, 3.8612e+00,
         3.9975e+05, 3.1561e+00, 3.1111e+00, 3.1025e+00, 0.0000e+00, 3.8830e+05],
        [3.8827e+05, 3.8826e+05, 7.9081e+05, 3.8824e+05, 3.8828e+05, 7.6344e+05,
         7.6776e+05, 7.8044e+05, 3.8826e+05, 7.7526e+05, 3.8822e+05, 3.8822e+05,
         8.0506e+05, 3.8826e+05, 3.8828e+05, 3.8823e+05, 3.8830e+05, 0.0000e+00]])
Krum scores: ['3.36', '3.21', '386059.91', '3.12', '3.26', '373621.12', '383954.97', '384070.84', '3.31', '393956.84', '3.16', '3.62', '399733.28', '3.22', '3.18', '3.31', '3.24', '388249.59']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [2, 6, 15, 12, 10, 18, 16, 14, 1, 17, 11, 9, 19, 5, 3, 4, 7, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:39...
global Accuracy on shared test data: 54.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 48 189]
 [ 37 226]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:39, End: 2025-07-22 15:46:39)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [16, 19, 14, 17, 10, 7, 11, 9, 20, 13, 3, 4, 1, 8, 5, 12, 18, 15, 2, 6], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 7.7640e+05, 7.7530e+05, 7.7437e+05, 4.0192e+05, 4.0188e+05,
         4.0191e+05, 4.0189e+05, 8.2765e+05, 8.1643e+05, 4.0193e+05, 4.0194e+05,
         4.0189e+05, 4.0192e+05, 4.0186e+05, 4.0187e+05, 7.9185e+05, 8.2432e+05,
         4.0192e+05, 4.0191e+05],
        [7.7640e+05, 0.0000e+00, 7.3002e+05, 7.5583e+05, 3.7974e+05, 3.7973e+05,
         3.7971e+05, 3.7972e+05, 7.8674e+05, 7.7054e+05, 3.7972e+05, 3.7971e+05,
         3.7968e+05, 3.7978e+05, 3.7975e+05, 3.7975e+05, 7.6533e+05, 7.7075e+05,
         3.7968e+05, 3.7973e+05],
        [7.7530e+05, 7.3002e+05, 0.0000e+00, 7.8427e+05, 3.7979e+05, 3.7979e+05,
         3.7982e+05, 3.7978e+05, 7.9230e+05, 7.9388e+05, 3.7976e+05, 3.7979e+05,
         3.7981e+05, 3.7980e+05, 3.7978e+05, 3.7983e+05, 7.6119e+05, 7.7630e+05,
         3.7983e+05, 3.7981e+05],
        [7.7437e+05, 7.5583e+05, 7.8427e+05, 0.0000e+00, 3.9126e+05, 3.9124e+05,
         3.9123e+05, 3.9117e+05, 8.1349e+05, 7.9872e+05, 3.9120e+05, 3.9121e+05,
         3.9120e+05, 3.9117e+05, 3.9124e+05, 3.9123e+05, 7.7898e+05, 8.0700e+05,
         3.9122e+05, 3.9125e+05],
        [4.0192e+05, 3.7974e+05, 3.7979e+05, 3.9126e+05, 0.0000e+00, 3.3025e+00,
         3.1253e+00, 3.5340e+00, 4.0270e+05, 4.0476e+05, 3.0537e+00, 3.5488e+00,
         3.4533e+00, 3.3442e+00, 3.3828e+00, 3.1727e+00, 3.8169e+05, 4.0354e+05,
         3.4036e+00, 3.1965e+00],
        [4.0188e+05, 3.7973e+05, 3.7979e+05, 3.9124e+05, 3.3025e+00, 0.0000e+00,
         3.2082e+00, 3.8603e+00, 4.0271e+05, 4.0468e+05, 3.0731e+00, 3.0934e+00,
         3.4270e+00, 3.3765e+00, 3.1452e+00, 3.1151e+00, 3.8166e+05, 4.0353e+05,
         3.4407e+00, 3.3238e+00],
        [4.0191e+05, 3.7971e+05, 3.7982e+05, 3.9123e+05, 3.1253e+00, 3.2082e+00,
         0.0000e+00, 3.6140e+00, 4.0276e+05, 4.0478e+05, 3.3152e+00, 3.3062e+00,
         3.3888e+00, 3.3163e+00, 3.1125e+00, 3.2763e+00, 3.8167e+05, 4.0356e+05,
         3.3067e+00, 3.2518e+00],
        [4.0189e+05, 3.7972e+05, 3.7978e+05, 3.9117e+05, 3.5340e+00, 3.8603e+00,
         3.6140e+00, 0.0000e+00, 4.0276e+05, 4.0475e+05, 3.3448e+00, 3.7667e+00,
         3.7383e+00, 3.5371e+00, 3.6670e+00, 3.6499e+00, 3.8163e+05, 4.0353e+05,
         3.6495e+00, 3.6622e+00],
        [8.2765e+05, 7.8674e+05, 7.9230e+05, 8.1349e+05, 4.0270e+05, 4.0271e+05,
         4.0276e+05, 4.0276e+05, 0.0000e+00, 7.9155e+05, 4.0272e+05, 4.0275e+05,
         4.0273e+05, 4.0273e+05, 4.0272e+05, 4.0271e+05, 7.6345e+05, 7.9814e+05,
         4.0274e+05, 4.0273e+05],
        [8.1643e+05, 7.7054e+05, 7.9388e+05, 7.9872e+05, 4.0476e+05, 4.0468e+05,
         4.0478e+05, 4.0475e+05, 7.9155e+05, 0.0000e+00, 4.0480e+05, 4.0476e+05,
         4.0481e+05, 4.0477e+05, 4.0474e+05, 4.0477e+05, 8.0694e+05, 8.0106e+05,
         4.0482e+05, 4.0475e+05],
        [4.0193e+05, 3.7972e+05, 3.7976e+05, 3.9120e+05, 3.0537e+00, 3.0731e+00,
         3.3152e+00, 3.3448e+00, 4.0272e+05, 4.0480e+05, 0.0000e+00, 3.2622e+00,
         3.1379e+00, 3.2876e+00, 3.1811e+00, 3.1080e+00, 3.8160e+05, 4.0351e+05,
         3.2173e+00, 3.2418e+00],
        [4.0194e+05, 3.7971e+05, 3.7979e+05, 3.9121e+05, 3.5488e+00, 3.0934e+00,
         3.3062e+00, 3.7667e+00, 4.0275e+05, 4.0476e+05, 3.2622e+00, 0.0000e+00,
         3.6537e+00, 3.5340e+00, 3.2210e+00, 3.3331e+00, 3.8165e+05, 4.0349e+05,
         3.4523e+00, 3.2746e+00],
        [4.0189e+05, 3.7968e+05, 3.7981e+05, 3.9120e+05, 3.4533e+00, 3.4270e+00,
         3.3888e+00, 3.7383e+00, 4.0273e+05, 4.0481e+05, 3.1379e+00, 3.6537e+00,
         0.0000e+00, 3.5391e+00, 3.4465e+00, 3.2283e+00, 3.8165e+05, 4.0354e+05,
         3.4049e+00, 3.1471e+00],
        [4.0192e+05, 3.7978e+05, 3.7980e+05, 3.9117e+05, 3.3442e+00, 3.3765e+00,
         3.3163e+00, 3.5371e+00, 4.0273e+05, 4.0477e+05, 3.2876e+00, 3.5340e+00,
         3.5391e+00, 0.0000e+00, 3.6144e+00, 3.5580e+00, 3.8165e+05, 4.0353e+05,
         3.6254e+00, 3.3932e+00],
        [4.0186e+05, 3.7975e+05, 3.7978e+05, 3.9124e+05, 3.3828e+00, 3.1452e+00,
         3.1125e+00, 3.6670e+00, 4.0272e+05, 4.0474e+05, 3.1811e+00, 3.2210e+00,
         3.4465e+00, 3.6144e+00, 0.0000e+00, 3.1920e+00, 3.8164e+05, 4.0349e+05,
         3.2655e+00, 3.0301e+00],
        [4.0187e+05, 3.7975e+05, 3.7983e+05, 3.9123e+05, 3.1727e+00, 3.1151e+00,
         3.2763e+00, 3.6499e+00, 4.0271e+05, 4.0477e+05, 3.1080e+00, 3.3331e+00,
         3.2283e+00, 3.5580e+00, 3.1920e+00, 0.0000e+00, 3.8164e+05, 4.0352e+05,
         3.1392e+00, 2.9695e+00],
        [7.9185e+05, 7.6533e+05, 7.6119e+05, 7.7898e+05, 3.8169e+05, 3.8166e+05,
         3.8167e+05, 3.8163e+05, 7.6345e+05, 8.0694e+05, 3.8160e+05, 3.8165e+05,
         3.8165e+05, 3.8165e+05, 3.8164e+05, 3.8164e+05, 0.0000e+00, 7.8662e+05,
         3.8164e+05, 3.8165e+05],
        [8.2432e+05, 7.7075e+05, 7.7630e+05, 8.0700e+05, 4.0354e+05, 4.0353e+05,
         4.0356e+05, 4.0353e+05, 7.9814e+05, 8.0106e+05, 4.0351e+05, 4.0349e+05,
         4.0354e+05, 4.0353e+05, 4.0349e+05, 4.0352e+05, 7.8662e+05, 0.0000e+00,
         4.0351e+05, 4.0350e+05],
        [4.0192e+05, 3.7968e+05, 3.7983e+05, 3.9122e+05, 3.4036e+00, 3.4407e+00,
         3.3067e+00, 3.6495e+00, 4.0274e+05, 4.0482e+05, 3.2173e+00, 3.4523e+00,
         3.4049e+00, 3.6254e+00, 3.2655e+00, 3.1392e+00, 3.8164e+05, 4.0351e+05,
         0.0000e+00, 3.3732e+00],
        [4.0191e+05, 3.7973e+05, 3.7981e+05, 3.9125e+05, 3.1965e+00, 3.3238e+00,
         3.2518e+00, 3.6622e+00, 4.0273e+05, 4.0475e+05, 3.2418e+00, 3.2746e+00,
         3.1471e+00, 3.3932e+00, 3.0301e+00, 2.9695e+00, 3.8165e+05, 4.0350e+05,
         3.3732e+00, 0.0000e+00]])
Krum scores: ['401897.56', '379719.59', '379793.25', '391209.81', '3.30', '3.25', '3.26', '3.62', '402722.47', '404757.12', '3.19', '3.37', '3.38', '3.45', '3.26', '3.21', '381640.00', '403515.28', '3.36', '3.22']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [16, 19, 14, 17, 10, 7, 11, 9, 20, 13, 3, 4, 1, 8, 5, 12, 18, 15, 2, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0221s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:39...
global Accuracy on shared test data: 54.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 53 184]
 [ 46 217]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:39, End: 2025-07-22 15:46:39)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [8, 4, 7, 16, 17, 1, 18, 5, 20, 19, 11, 3, 2, 13, 9, 14, 10, 15, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.4605e+00, 3.4285e+00, 3.8813e+05, 3.9489e+05, 3.5263e+00,
         3.9060e+05, 3.6069e+00, 3.9297e+05, 3.8888e+05, 3.3819e+00, 3.2698e+00,
         3.5558e+00, 3.9515e+05, 3.5565e+00, 3.9420e+05, 3.2551e+00, 3.9438e+05,
         3.4685e+00],
        [3.4605e+00, 0.0000e+00, 3.2066e+00, 3.8813e+05, 3.9494e+05, 3.6358e+00,
         3.9052e+05, 3.2938e+00, 3.9297e+05, 3.8883e+05, 3.3534e+00, 3.2474e+00,
         3.4772e+00, 3.9514e+05, 3.7864e+00, 3.9422e+05, 3.5673e+00, 3.9433e+05,
         3.3805e+00],
        [3.4285e+00, 3.2066e+00, 0.0000e+00, 3.8810e+05, 3.9493e+05, 3.4680e+00,
         3.9054e+05, 3.2449e+00, 3.9302e+05, 3.8891e+05, 3.3947e+00, 3.2420e+00,
         3.5585e+00, 3.9518e+05, 3.9922e+00, 3.9419e+05, 3.3640e+00, 3.9431e+05,
         3.3601e+00],
        [3.8813e+05, 3.8813e+05, 3.8810e+05, 0.0000e+00, 7.8684e+05, 3.8812e+05,
         7.8565e+05, 3.8812e+05, 7.5668e+05, 7.9847e+05, 3.8808e+05, 3.8811e+05,
         3.8812e+05, 7.8452e+05, 3.8811e+05, 7.6757e+05, 3.8812e+05, 7.9473e+05,
         3.8813e+05],
        [3.9489e+05, 3.9494e+05, 3.9493e+05, 7.8684e+05, 0.0000e+00, 3.9494e+05,
         8.0403e+05, 3.9489e+05, 7.9423e+05, 7.6661e+05, 3.9488e+05, 3.9493e+05,
         3.9493e+05, 7.7835e+05, 3.9493e+05, 8.0245e+05, 3.9494e+05, 7.7893e+05,
         3.9491e+05],
        [3.5263e+00, 3.6358e+00, 3.4680e+00, 3.8812e+05, 3.9494e+05, 0.0000e+00,
         3.9057e+05, 3.5930e+00, 3.9300e+05, 3.8889e+05, 3.4378e+00, 3.3072e+00,
         3.2609e+00, 3.9512e+05, 3.8297e+00, 3.9426e+05, 3.4561e+00, 3.9437e+05,
         3.2960e+00],
        [3.9060e+05, 3.9052e+05, 3.9054e+05, 7.8565e+05, 8.0403e+05, 3.9057e+05,
         0.0000e+00, 3.9050e+05, 7.8484e+05, 7.8665e+05, 3.9055e+05, 3.9054e+05,
         3.9053e+05, 7.8777e+05, 3.9052e+05, 7.7584e+05, 3.9053e+05, 7.8873e+05,
         3.9055e+05],
        [3.6069e+00, 3.2938e+00, 3.2449e+00, 3.8812e+05, 3.9489e+05, 3.5930e+00,
         3.9050e+05, 0.0000e+00, 3.9299e+05, 3.8885e+05, 3.1923e+00, 3.2829e+00,
         3.1280e+00, 3.9513e+05, 3.7000e+00, 3.9424e+05, 3.3947e+00, 3.9435e+05,
         3.2260e+00],
        [3.9297e+05, 3.9297e+05, 3.9302e+05, 7.5668e+05, 7.9423e+05, 3.9300e+05,
         7.8484e+05, 3.9299e+05, 0.0000e+00, 7.9171e+05, 3.9304e+05, 3.9297e+05,
         3.9296e+05, 7.8794e+05, 3.9298e+05, 8.1333e+05, 3.9301e+05, 7.6449e+05,
         3.9299e+05],
        [3.8888e+05, 3.8883e+05, 3.8891e+05, 7.9847e+05, 7.6661e+05, 3.8889e+05,
         7.8665e+05, 3.8885e+05, 7.9171e+05, 0.0000e+00, 3.8884e+05, 3.8889e+05,
         3.8886e+05, 7.9330e+05, 3.8882e+05, 7.9111e+05, 3.8885e+05, 7.9181e+05,
         3.8883e+05],
        [3.3819e+00, 3.3534e+00, 3.3947e+00, 3.8808e+05, 3.9488e+05, 3.4378e+00,
         3.9055e+05, 3.1923e+00, 3.9304e+05, 3.8884e+05, 0.0000e+00, 3.3697e+00,
         3.2670e+00, 3.9518e+05, 3.6666e+00, 3.9419e+05, 3.1332e+00, 3.9432e+05,
         3.2290e+00],
        [3.2698e+00, 3.2474e+00, 3.2420e+00, 3.8811e+05, 3.9493e+05, 3.3072e+00,
         3.9054e+05, 3.2829e+00, 3.9297e+05, 3.8889e+05, 3.3697e+00, 0.0000e+00,
         3.2247e+00, 3.9512e+05, 3.4988e+00, 3.9424e+05, 3.1144e+00, 3.9432e+05,
         3.2232e+00],
        [3.5558e+00, 3.4772e+00, 3.5585e+00, 3.8812e+05, 3.9493e+05, 3.2609e+00,
         3.9053e+05, 3.1280e+00, 3.9296e+05, 3.8886e+05, 3.2670e+00, 3.2247e+00,
         0.0000e+00, 3.9514e+05, 3.6662e+00, 3.9420e+05, 3.3861e+00, 3.9434e+05,
         3.0477e+00],
        [3.9515e+05, 3.9514e+05, 3.9518e+05, 7.8452e+05, 7.7835e+05, 3.9512e+05,
         7.8777e+05, 3.9513e+05, 7.8794e+05, 7.9330e+05, 3.9518e+05, 3.9512e+05,
         3.9514e+05, 0.0000e+00, 3.9519e+05, 8.1225e+05, 3.9516e+05, 8.0216e+05,
         3.9514e+05],
        [3.5565e+00, 3.7864e+00, 3.9922e+00, 3.8811e+05, 3.9493e+05, 3.8297e+00,
         3.9052e+05, 3.7000e+00, 3.9298e+05, 3.8882e+05, 3.6666e+00, 3.4988e+00,
         3.6662e+00, 3.9519e+05, 0.0000e+00, 3.9423e+05, 3.5509e+00, 3.9437e+05,
         3.6036e+00],
        [3.9420e+05, 3.9422e+05, 3.9419e+05, 7.6757e+05, 8.0245e+05, 3.9426e+05,
         7.7584e+05, 3.9424e+05, 8.1333e+05, 7.9111e+05, 3.9419e+05, 3.9424e+05,
         3.9420e+05, 8.1225e+05, 3.9423e+05, 0.0000e+00, 3.9423e+05, 7.9519e+05,
         3.9427e+05],
        [3.2551e+00, 3.5673e+00, 3.3640e+00, 3.8812e+05, 3.9494e+05, 3.4561e+00,
         3.9053e+05, 3.3947e+00, 3.9301e+05, 3.8885e+05, 3.1332e+00, 3.1144e+00,
         3.3861e+00, 3.9516e+05, 3.5509e+00, 3.9423e+05, 0.0000e+00, 3.9436e+05,
         3.0863e+00],
        [3.9438e+05, 3.9433e+05, 3.9431e+05, 7.9473e+05, 7.7893e+05, 3.9437e+05,
         7.8873e+05, 3.9435e+05, 7.6449e+05, 7.9181e+05, 3.9432e+05, 3.9432e+05,
         3.9434e+05, 8.0216e+05, 3.9437e+05, 7.9519e+05, 3.9436e+05, 0.0000e+00,
         3.9434e+05],
        [3.4685e+00, 3.3805e+00, 3.3601e+00, 3.8813e+05, 3.9491e+05, 3.2960e+00,
         3.9055e+05, 3.2260e+00, 3.9299e+05, 3.8883e+05, 3.2290e+00, 3.2232e+00,
         3.0477e+00, 3.9514e+05, 3.6036e+00, 3.9427e+05, 3.0863e+00, 3.9434e+05,
         0.0000e+00]])
Krum scores: ['3.43', '3.40', '3.36', '388111.97', '394913.66', '3.44', '390530.53', '3.33', '392981.12', '388848.81', '3.31', '3.25', '3.32', '395142.31', '3.65', '394215.97', '3.30', '394338.62', '3.26']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [8, 4, 7, 16, 17, 1, 18, 5, 20, 19, 11, 3, 2, 13, 9, 14, 10, 15, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0090s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:40...
global Accuracy on shared test data: 53.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 62 175]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:40, End: 2025-07-22 15:46:40)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [17, 20, 7, 18, 16, 6, 9, 12, 19, 2, 5, 3, 13, 14, 8, 1], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 8.0518e+05, 3.8673e+05, 7.8607e+05, 7.6055e+05, 3.8680e+05,
         3.8674e+05, 3.8673e+05, 7.5780e+05, 3.8674e+05, 3.8675e+05, 3.8675e+05,
         7.7006e+05, 7.5949e+05, 3.8676e+05, 3.8673e+05],
        [8.0518e+05, 0.0000e+00, 4.1777e+05, 8.2305e+05, 8.0608e+05, 4.1767e+05,
         4.1774e+05, 4.1772e+05, 8.2773e+05, 4.1775e+05, 4.1774e+05, 4.1776e+05,
         7.9784e+05, 8.0935e+05, 4.1771e+05, 4.1774e+05],
        [3.8673e+05, 4.1777e+05, 0.0000e+00, 3.9059e+05, 3.8610e+05, 3.7666e+00,
         4.0059e+00, 3.4027e+00, 3.8873e+05, 3.5485e+00, 3.3112e+00, 3.2813e+00,
         3.8243e+05, 3.8297e+05, 3.5147e+00, 3.3892e+00],
        [7.8607e+05, 8.2305e+05, 3.9059e+05, 0.0000e+00, 7.9124e+05, 3.9056e+05,
         3.9059e+05, 3.9055e+05, 7.8525e+05, 3.9056e+05, 3.9056e+05, 3.9057e+05,
         7.7540e+05, 7.6010e+05, 3.9054e+05, 3.9059e+05],
        [7.6055e+05, 8.0608e+05, 3.8610e+05, 7.9124e+05, 0.0000e+00, 3.8613e+05,
         3.8606e+05, 3.8608e+05, 7.7049e+05, 3.8610e+05, 3.8611e+05, 3.8606e+05,
         7.5414e+05, 7.7109e+05, 3.8609e+05, 3.8610e+05],
        [3.8680e+05, 4.1767e+05, 3.7666e+00, 3.9056e+05, 3.8613e+05, 0.0000e+00,
         3.7673e+00, 2.9313e+00, 3.8869e+05, 3.4997e+00, 3.2381e+00, 3.2352e+00,
         3.8250e+05, 3.8303e+05, 3.4045e+00, 3.3802e+00],
        [3.8674e+05, 4.1774e+05, 4.0059e+00, 3.9059e+05, 3.8606e+05, 3.7673e+00,
         0.0000e+00, 3.6138e+00, 3.8868e+05, 3.7975e+00, 3.8085e+00, 3.5489e+00,
         3.8244e+05, 3.8298e+05, 3.6751e+00, 3.8568e+00],
        [3.8673e+05, 4.1772e+05, 3.4027e+00, 3.9055e+05, 3.8608e+05, 2.9313e+00,
         3.6138e+00, 0.0000e+00, 3.8870e+05, 3.0730e+00, 3.3314e+00, 3.2243e+00,
         3.8251e+05, 3.8299e+05, 3.4497e+00, 3.3912e+00],
        [7.5780e+05, 8.2773e+05, 3.8873e+05, 7.8525e+05, 7.7049e+05, 3.8869e+05,
         3.8868e+05, 3.8870e+05, 0.0000e+00, 3.8870e+05, 3.8869e+05, 3.8869e+05,
         7.7986e+05, 7.6518e+05, 3.8872e+05, 3.8869e+05],
        [3.8674e+05, 4.1775e+05, 3.5485e+00, 3.9056e+05, 3.8610e+05, 3.4997e+00,
         3.7975e+00, 3.0730e+00, 3.8870e+05, 0.0000e+00, 3.1570e+00, 3.2072e+00,
         3.8248e+05, 3.8295e+05, 3.5765e+00, 3.1918e+00],
        [3.8675e+05, 4.1774e+05, 3.3112e+00, 3.9056e+05, 3.8611e+05, 3.2381e+00,
         3.8085e+00, 3.3314e+00, 3.8869e+05, 3.1570e+00, 0.0000e+00, 3.2824e+00,
         3.8245e+05, 3.8300e+05, 3.6093e+00, 3.5295e+00],
        [3.8675e+05, 4.1776e+05, 3.2813e+00, 3.9057e+05, 3.8606e+05, 3.2352e+00,
         3.5489e+00, 3.2243e+00, 3.8869e+05, 3.2072e+00, 3.2824e+00, 0.0000e+00,
         3.8251e+05, 3.8296e+05, 3.3188e+00, 3.3301e+00],
        [7.7006e+05, 7.9784e+05, 3.8243e+05, 7.7540e+05, 7.5414e+05, 3.8250e+05,
         3.8244e+05, 3.8251e+05, 7.7986e+05, 3.8248e+05, 3.8245e+05, 3.8251e+05,
         0.0000e+00, 7.5204e+05, 3.8244e+05, 3.8250e+05],
        [7.5949e+05, 8.0935e+05, 3.8297e+05, 7.6010e+05, 7.7109e+05, 3.8303e+05,
         3.8298e+05, 3.8299e+05, 7.6518e+05, 3.8295e+05, 3.8300e+05, 3.8296e+05,
         7.5204e+05, 0.0000e+00, 3.8293e+05, 3.8295e+05],
        [3.8676e+05, 4.1771e+05, 3.5147e+00, 3.9054e+05, 3.8609e+05, 3.4045e+00,
         3.6751e+00, 3.4497e+00, 3.8872e+05, 3.5765e+00, 3.6093e+00, 3.3188e+00,
         3.8244e+05, 3.8293e+05, 0.0000e+00, 3.6564e+00],
        [3.8673e+05, 4.1774e+05, 3.3892e+00, 3.9059e+05, 3.8610e+05, 3.3802e+00,
         3.8568e+00, 3.3912e+00, 3.8869e+05, 3.1918e+00, 3.5295e+00, 3.3301e+00,
         3.8250e+05, 3.8295e+05, 3.6564e+00, 0.0000e+00]])
Krum scores: ['386738.03', '417724.31', '3.46', '390562.34', '386083.78', '3.35', '3.72', '3.26', '388692.50', '3.32', '3.35', '3.27', '382464.72', '382960.41', '3.50', '3.41']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [17, 20, 7, 18, 16, 6, 9, 12, 19, 2, 5, 3, 13, 14, 8, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0136s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:41...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 74 163]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:41, End: 2025-07-22 15:46:41)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [20, 16, 2, 17, 15, 3, 11, 10, 1, 4, 12, 7, 14, 6, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 7.9088e+05, 3.8908e+05, 7.7185e+05, 8.0613e+05, 3.8914e+05,
         3.8908e+05, 3.8913e+05, 3.8910e+05, 3.8914e+05, 3.8909e+05, 3.8915e+05,
         7.9390e+05, 3.8912e+05, 7.9959e+05],
        [7.9088e+05, 0.0000e+00, 3.9117e+05, 7.8279e+05, 7.9171e+05, 3.9110e+05,
         3.9112e+05, 3.9112e+05, 3.9114e+05, 3.9114e+05, 3.9114e+05, 3.9114e+05,
         7.7182e+05, 3.9117e+05, 7.8083e+05],
        [3.8908e+05, 3.9117e+05, 0.0000e+00, 3.9482e+05, 3.9756e+05, 3.2269e+00,
         3.1860e+00, 3.3633e+00, 3.1956e+00, 3.5221e+00, 3.1525e+00, 3.6152e+00,
         4.0161e+05, 3.6403e+00, 3.9777e+05],
        [7.7185e+05, 7.8279e+05, 3.9482e+05, 0.0000e+00, 7.9347e+05, 3.9490e+05,
         3.9488e+05, 3.9490e+05, 3.9493e+05, 3.9490e+05, 3.9482e+05, 3.9484e+05,
         8.0954e+05, 3.9482e+05, 8.1365e+05],
        [8.0613e+05, 7.9171e+05, 3.9756e+05, 7.9347e+05, 0.0000e+00, 3.9758e+05,
         3.9752e+05, 3.9754e+05, 3.9759e+05, 3.9758e+05, 3.9760e+05, 3.9763e+05,
         8.2358e+05, 3.9757e+05, 7.7807e+05],
        [3.8914e+05, 3.9110e+05, 3.2269e+00, 3.9490e+05, 3.9758e+05, 0.0000e+00,
         3.3802e+00, 3.0638e+00, 3.3195e+00, 3.2225e+00, 3.2576e+00, 3.2499e+00,
         4.0157e+05, 3.3055e+00, 3.9779e+05],
        [3.8908e+05, 3.9112e+05, 3.1860e+00, 3.9488e+05, 3.9752e+05, 3.3802e+00,
         0.0000e+00, 3.0586e+00, 3.3286e+00, 3.2661e+00, 3.2835e+00, 3.5085e+00,
         4.0163e+05, 3.5500e+00, 3.9778e+05],
        [3.8913e+05, 3.9112e+05, 3.3633e+00, 3.9490e+05, 3.9754e+05, 3.0638e+00,
         3.0586e+00, 0.0000e+00, 3.4913e+00, 3.4139e+00, 2.9815e+00, 3.3420e+00,
         4.0158e+05, 3.5954e+00, 3.9776e+05],
        [3.8910e+05, 3.9114e+05, 3.1956e+00, 3.9493e+05, 3.9759e+05, 3.3195e+00,
         3.3286e+00, 3.4913e+00, 0.0000e+00, 3.4852e+00, 3.4166e+00, 3.4184e+00,
         4.0161e+05, 3.4452e+00, 3.9779e+05],
        [3.8914e+05, 3.9114e+05, 3.5221e+00, 3.9490e+05, 3.9758e+05, 3.2225e+00,
         3.2661e+00, 3.4139e+00, 3.4852e+00, 0.0000e+00, 3.2563e+00, 3.2397e+00,
         4.0162e+05, 3.3699e+00, 3.9780e+05],
        [3.8909e+05, 3.9114e+05, 3.1525e+00, 3.9482e+05, 3.9760e+05, 3.2576e+00,
         3.2835e+00, 2.9815e+00, 3.4166e+00, 3.2563e+00, 0.0000e+00, 3.4214e+00,
         4.0158e+05, 3.1925e+00, 3.9779e+05],
        [3.8915e+05, 3.9114e+05, 3.6152e+00, 3.9484e+05, 3.9763e+05, 3.2499e+00,
         3.5085e+00, 3.3420e+00, 3.4184e+00, 3.2397e+00, 3.4214e+00, 0.0000e+00,
         4.0155e+05, 3.9933e+00, 3.9775e+05],
        [7.9390e+05, 7.7182e+05, 4.0161e+05, 8.0954e+05, 8.2358e+05, 4.0157e+05,
         4.0163e+05, 4.0158e+05, 4.0161e+05, 4.0162e+05, 4.0158e+05, 4.0155e+05,
         0.0000e+00, 4.0167e+05, 8.0319e+05],
        [3.8912e+05, 3.9117e+05, 3.6403e+00, 3.9482e+05, 3.9757e+05, 3.3055e+00,
         3.5500e+00, 3.5954e+00, 3.4452e+00, 3.3699e+00, 3.1925e+00, 3.9933e+00,
         4.0167e+05, 0.0000e+00, 3.9777e+05],
        [7.9959e+05, 7.8083e+05, 3.9777e+05, 8.1365e+05, 7.7807e+05, 3.9779e+05,
         3.9778e+05, 3.9776e+05, 3.9779e+05, 3.9780e+05, 3.9779e+05, 3.9775e+05,
         8.0319e+05, 3.9777e+05, 0.0000e+00]])
Krum scores: ['389106.75', '391129.50', '3.32', '394852.53', '397563.69', '3.24', '3.29', '3.24', '3.37', '3.32', '3.22', '3.40', '401587.09', '3.44', '397771.12']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [20, 16, 2, 17, 15, 3, 11, 10, 1, 4, 12, 7, 14, 6, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0062s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:41...
global Accuracy on shared test data: 54.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 85 152]
 [ 74 189]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:41, End: 2025-07-22 15:46:41)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [6, 15, 16, 5, 3, 7, 10, 14, 17, 1, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
tensor([[0.0000e+00, 4.0664e+05, 3.9616e+05, 3.5886e+00, 3.4126e+00, 4.0639e+00,
         3.6846e+00, 3.8795e+05, 3.9302e+05, 3.4745e+00, 3.2781e+00],
        [4.0664e+05, 0.0000e+00, 8.1386e+05, 4.0654e+05, 4.0662e+05, 4.0661e+05,
         4.0660e+05, 7.8851e+05, 7.9912e+05, 4.0667e+05, 4.0663e+05],
        [3.9616e+05, 8.1386e+05, 0.0000e+00, 3.9622e+05, 3.9626e+05, 3.9621e+05,
         3.9615e+05, 7.9308e+05, 7.4556e+05, 3.9623e+05, 3.9620e+05],
        [3.5886e+00, 4.0654e+05, 3.9622e+05, 0.0000e+00, 3.5283e+00, 3.4344e+00,
         3.3907e+00, 3.8798e+05, 3.9304e+05, 3.5652e+00, 3.4805e+00],
        [3.4126e+00, 4.0662e+05, 3.9626e+05, 3.5283e+00, 0.0000e+00, 3.3442e+00,
         3.2240e+00, 3.8794e+05, 3.9296e+05, 3.3253e+00, 3.4037e+00],
        [4.0639e+00, 4.0661e+05, 3.9621e+05, 3.4344e+00, 3.3442e+00, 0.0000e+00,
         3.3490e+00, 3.8790e+05, 3.9298e+05, 3.4302e+00, 3.6903e+00],
        [3.6846e+00, 4.0660e+05, 3.9615e+05, 3.3907e+00, 3.2240e+00, 3.3490e+00,
         0.0000e+00, 3.8792e+05, 3.9294e+05, 3.4180e+00, 3.1564e+00],
        [3.8795e+05, 7.8851e+05, 7.9308e+05, 3.8798e+05, 3.8794e+05, 3.8790e+05,
         3.8792e+05, 0.0000e+00, 8.0528e+05, 3.8793e+05, 3.8794e+05],
        [3.9302e+05, 7.9912e+05, 7.4556e+05, 3.9304e+05, 3.9296e+05, 3.9298e+05,
         3.9294e+05, 8.0528e+05, 0.0000e+00, 3.9300e+05, 3.9296e+05],
        [3.4745e+00, 4.0667e+05, 3.9623e+05, 3.5652e+00, 3.3253e+00, 3.4302e+00,
         3.4180e+00, 3.8793e+05, 3.9300e+05, 0.0000e+00, 3.4693e+00],
        [3.2781e+00, 4.0663e+05, 3.9620e+05, 3.4805e+00, 3.4037e+00, 3.6903e+00,
         3.1564e+00, 3.8794e+05, 3.9296e+05, 3.4693e+00, 0.0000e+00]])
Krum scores: ['3.49', '406601.22', '396190.62', '3.48', '3.34', '3.45', '3.31', '387927.28', '392967.78', '3.42', '3.36']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [6, 15, 16, 5, 3, 7, 10, 14, 17, 1, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0022s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:42...
global Accuracy on shared test data: 54.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 93 144]
 [ 82 181]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:42, End: 2025-07-22 15:46:42)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [11, 2, 15, 9, 7, 10, 13, 20, 3, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.2797e+00, 3.6977e+05, 3.9401e+00, 3.5854e+00, 3.2383e+00,
         3.7650e+05, 3.9000e+05, 3.6531e+00, 3.9694e+05],
        [3.2797e+00, 0.0000e+00, 3.6972e+05, 3.8034e+00, 3.6061e+00, 3.3896e+00,
         3.7646e+05, 3.9010e+05, 3.3273e+00, 3.9698e+05],
        [3.6977e+05, 3.6972e+05, 0.0000e+00, 3.6971e+05, 3.6976e+05, 3.6976e+05,
         7.4201e+05, 7.6753e+05, 3.6981e+05, 7.6810e+05],
        [3.9401e+00, 3.8034e+00, 3.6971e+05, 0.0000e+00, 3.9080e+00, 3.8713e+00,
         3.7646e+05, 3.9010e+05, 3.7388e+00, 3.9702e+05],
        [3.5854e+00, 3.6061e+00, 3.6976e+05, 3.9080e+00, 0.0000e+00, 3.4567e+00,
         3.7639e+05, 3.9010e+05, 3.3484e+00, 3.9699e+05],
        [3.2383e+00, 3.3896e+00, 3.6976e+05, 3.8713e+00, 3.4567e+00, 0.0000e+00,
         3.7652e+05, 3.9006e+05, 3.3397e+00, 3.9697e+05],
        [3.7650e+05, 3.7646e+05, 7.4201e+05, 3.7646e+05, 3.7639e+05, 3.7652e+05,
         0.0000e+00, 7.4329e+05, 3.7647e+05, 7.5958e+05],
        [3.9000e+05, 3.9010e+05, 7.6753e+05, 3.9010e+05, 3.9010e+05, 3.9006e+05,
         7.4329e+05, 0.0000e+00, 3.9008e+05, 8.0028e+05],
        [3.6531e+00, 3.3273e+00, 3.6981e+05, 3.7388e+00, 3.3484e+00, 3.3397e+00,
         3.7647e+05, 3.9008e+05, 0.0000e+00, 3.9696e+05],
        [3.9694e+05, 3.9698e+05, 7.6810e+05, 3.9702e+05, 3.9699e+05, 3.9697e+05,
         7.5958e+05, 8.0028e+05, 3.9696e+05, 0.0000e+00]])
Krum scores: ['3.44', '3.40', '369737.34', '3.83', '3.50', '3.36', '376445.31', '390060.19', '3.42', '396962.34']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [11, 2, 15, 9, 7, 10, 13, 20, 3, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0061s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:42...
global Accuracy on shared test data: 54.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 96 141]
 [ 85 178]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:42, End: 2025-07-22 15:46:42)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [15, 9, 10, 19, 11, 1, 12, 14, 3, 5, 2, 4, 18, 16, 6, 17, 7, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.7364e+05, 3.7362e+05, 7.5536e+05, 3.7360e+05, 3.7362e+05,
         3.7359e+05, 7.5662e+05, 3.7358e+05, 3.7364e+05, 3.7361e+05, 3.7359e+05,
         7.6373e+05, 7.4132e+05, 3.7361e+05, 7.6900e+05, 3.7362e+05, 3.7360e+05],
        [3.7364e+05, 0.0000e+00, 3.8051e+00, 3.8133e+05, 3.8591e+00, 3.7482e+00,
         3.8258e+00, 3.8860e+05, 3.8294e+00, 3.7069e+00, 3.6883e+00, 3.5864e+00,
         3.8348e+05, 3.8511e+05, 3.7684e+00, 3.9054e+05, 3.7304e+00, 3.8733e+00],
        [3.7362e+05, 3.8051e+00, 0.0000e+00, 3.8138e+05, 3.3347e+00, 3.5194e+00,
         3.2954e+00, 3.8856e+05, 3.4393e+00, 3.4486e+00, 3.4669e+00, 3.5630e+00,
         3.8355e+05, 3.8512e+05, 3.8258e+00, 3.9055e+05, 3.5102e+00, 3.6667e+00],
        [7.5536e+05, 3.8133e+05, 3.8138e+05, 0.0000e+00, 3.8132e+05, 3.8136e+05,
         3.8140e+05, 7.7785e+05, 3.8138e+05, 3.8139e+05, 3.8138e+05, 3.8131e+05,
         7.6495e+05, 7.8745e+05, 3.8136e+05, 7.6516e+05, 3.8135e+05, 3.8134e+05],
        [3.7360e+05, 3.8591e+00, 3.3347e+00, 3.8132e+05, 0.0000e+00, 3.4898e+00,
         3.5032e+00, 3.8853e+05, 3.7968e+00, 3.3428e+00, 3.4107e+00, 3.3583e+00,
         3.8355e+05, 3.8508e+05, 3.6224e+00, 3.9053e+05, 3.5089e+00, 3.6581e+00],
        [3.7362e+05, 3.7482e+00, 3.5194e+00, 3.8136e+05, 3.4898e+00, 0.0000e+00,
         3.4443e+00, 3.8855e+05, 3.4488e+00, 3.5942e+00, 3.2139e+00, 3.4733e+00,
         3.8358e+05, 3.8515e+05, 3.4843e+00, 3.9052e+05, 3.2785e+00, 3.8670e+00],
        [3.7359e+05, 3.8258e+00, 3.2954e+00, 3.8140e+05, 3.5032e+00, 3.4443e+00,
         0.0000e+00, 3.8858e+05, 3.5630e+00, 3.5177e+00, 3.3122e+00, 3.3939e+00,
         3.8356e+05, 3.8513e+05, 3.2715e+00, 3.9051e+05, 3.5730e+00, 4.0000e+00],
        [7.5662e+05, 3.8860e+05, 3.8856e+05, 7.7785e+05, 3.8853e+05, 3.8855e+05,
         3.8858e+05, 0.0000e+00, 3.8854e+05, 3.8858e+05, 3.8858e+05, 3.8861e+05,
         7.6919e+05, 7.6293e+05, 3.8860e+05, 7.9319e+05, 3.8857e+05, 3.8857e+05],
        [3.7358e+05, 3.8294e+00, 3.4393e+00, 3.8138e+05, 3.7968e+00, 3.4488e+00,
         3.5630e+00, 3.8854e+05, 0.0000e+00, 3.6329e+00, 3.3635e+00, 3.4758e+00,
         3.8358e+05, 3.8514e+05, 3.4118e+00, 3.9053e+05, 3.3813e+00, 4.0129e+00],
        [3.7364e+05, 3.7069e+00, 3.4486e+00, 3.8139e+05, 3.3428e+00, 3.5942e+00,
         3.5177e+00, 3.8858e+05, 3.6329e+00, 0.0000e+00, 3.1530e+00, 3.3659e+00,
         3.8354e+05, 3.8513e+05, 3.6207e+00, 3.9052e+05, 3.3161e+00, 3.7974e+00],
        [3.7361e+05, 3.6883e+00, 3.4669e+00, 3.8138e+05, 3.4107e+00, 3.2139e+00,
         3.3122e+00, 3.8858e+05, 3.3635e+00, 3.1530e+00, 0.0000e+00, 3.5906e+00,
         3.8354e+05, 3.8514e+05, 3.7098e+00, 3.9052e+05, 3.4770e+00, 4.0258e+00],
        [3.7359e+05, 3.5864e+00, 3.5630e+00, 3.8131e+05, 3.3583e+00, 3.4733e+00,
         3.3939e+00, 3.8861e+05, 3.4758e+00, 3.3659e+00, 3.5906e+00, 0.0000e+00,
         3.8356e+05, 3.8511e+05, 3.3913e+00, 3.9052e+05, 3.2446e+00, 3.7120e+00],
        [7.6373e+05, 3.8348e+05, 3.8355e+05, 7.6495e+05, 3.8355e+05, 3.8358e+05,
         3.8356e+05, 7.6919e+05, 3.8358e+05, 3.8354e+05, 3.8354e+05, 3.8356e+05,
         0.0000e+00, 7.5561e+05, 3.8353e+05, 7.7927e+05, 3.8354e+05, 3.8351e+05],
        [7.4132e+05, 3.8511e+05, 3.8512e+05, 7.8745e+05, 3.8508e+05, 3.8515e+05,
         3.8513e+05, 7.6293e+05, 3.8514e+05, 3.8513e+05, 3.8514e+05, 3.8511e+05,
         7.5561e+05, 0.0000e+00, 3.8509e+05, 7.6047e+05, 3.8511e+05, 3.8515e+05],
        [3.7361e+05, 3.7684e+00, 3.8258e+00, 3.8136e+05, 3.6224e+00, 3.4843e+00,
         3.2715e+00, 3.8860e+05, 3.4118e+00, 3.6207e+00, 3.7098e+00, 3.3913e+00,
         3.8353e+05, 3.8509e+05, 0.0000e+00, 3.9054e+05, 3.8761e+00, 3.7881e+00],
        [7.6900e+05, 3.9054e+05, 3.9055e+05, 7.6516e+05, 3.9053e+05, 3.9052e+05,
         3.9051e+05, 7.9319e+05, 3.9053e+05, 3.9052e+05, 3.9052e+05, 3.9052e+05,
         7.7927e+05, 7.6047e+05, 3.9054e+05, 0.0000e+00, 3.9050e+05, 3.9060e+05],
        [3.7362e+05, 3.7304e+00, 3.5102e+00, 3.8135e+05, 3.5089e+00, 3.2785e+00,
         3.5730e+00, 3.8857e+05, 3.3813e+00, 3.3161e+00, 3.4770e+00, 3.2446e+00,
         3.8354e+05, 3.8511e+05, 3.8761e+00, 3.9050e+05, 0.0000e+00, 3.7564e+00],
        [3.7360e+05, 3.8733e+00, 3.6667e+00, 3.8134e+05, 3.6581e+00, 3.8670e+00,
         4.0000e+00, 3.8857e+05, 4.0129e+00, 3.7974e+00, 4.0258e+00, 3.7120e+00,
         3.8351e+05, 3.8515e+05, 3.7881e+00, 3.9060e+05, 3.7564e+00, 0.0000e+00]])
Krum scores: ['373603.69', '3.75', '3.50', '381351.66', '3.50', '3.47', '3.47', '388564.97', '3.53', '3.47', '3.44', '3.44', '383536.69', '385115.06', '3.59', '390523.81', '3.48', '3.81']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [15, 9, 10, 19, 11, 1, 12, 14, 3, 5, 2, 4, 18, 16, 6, 17, 7, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0076s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:43...
global Accuracy on shared test data: 55.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[103 134]
 [ 91 172]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:43, End: 2025-07-22 15:46:43)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [17, 14, 3, 10, 6, 12, 19, 13, 11, 5, 1, 2, 7, 16, 8, 9, 15, 4, 18, 20], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 7.8631e+05, 3.8292e+05, 3.8288e+05, 3.8291e+05, 3.8297e+05,
         7.5919e+05, 7.6530e+05, 3.8291e+05, 3.8289e+05, 3.8293e+05, 3.8294e+05,
         3.8290e+05, 7.6316e+05, 3.8290e+05, 3.8294e+05, 7.7436e+05, 3.8290e+05,
         8.0174e+05, 7.9123e+05],
        [7.8631e+05, 0.0000e+00, 3.9276e+05, 3.9274e+05, 3.9271e+05, 3.9273e+05,
         7.6868e+05, 7.8598e+05, 3.9269e+05, 3.9271e+05, 3.9274e+05, 3.9272e+05,
         3.9274e+05, 7.9386e+05, 3.9278e+05, 3.9276e+05, 7.8807e+05, 3.9272e+05,
         7.8696e+05, 7.9869e+05],
        [3.8292e+05, 3.9276e+05, 0.0000e+00, 3.2881e+00, 3.1970e+00, 3.3747e+00,
         3.7790e+05, 3.9158e+05, 3.7615e+00, 3.5328e+00, 3.3144e+00, 3.3997e+00,
         3.3929e+00, 3.9574e+05, 3.8664e+00, 3.7274e+00, 3.9828e+05, 3.4515e+00,
         3.9446e+05, 3.9857e+05],
        [3.8288e+05, 3.9274e+05, 3.2881e+00, 0.0000e+00, 3.7610e+00, 3.2712e+00,
         3.7790e+05, 3.9156e+05, 3.3259e+00, 3.4998e+00, 3.5455e+00, 3.5367e+00,
         3.6771e+00, 3.9575e+05, 3.6229e+00, 3.8110e+00, 3.9833e+05, 3.6398e+00,
         3.9447e+05, 3.9858e+05],
        [3.8291e+05, 3.9271e+05, 3.1970e+00, 3.7610e+00, 0.0000e+00, 3.1988e+00,
         3.7788e+05, 3.9158e+05, 3.5620e+00, 3.5271e+00, 3.5107e+00, 3.8227e+00,
         3.9100e+00, 3.9574e+05, 3.7083e+00, 3.8652e+00, 3.9825e+05, 3.4685e+00,
         3.9441e+05, 3.9855e+05],
        [3.8297e+05, 3.9273e+05, 3.3747e+00, 3.2712e+00, 3.1988e+00, 0.0000e+00,
         3.7789e+05, 3.9154e+05, 3.4806e+00, 3.5319e+00, 3.4720e+00, 3.4358e+00,
         3.5878e+00, 3.9572e+05, 3.9597e+00, 3.6965e+00, 3.9829e+05, 3.3957e+00,
         3.9445e+05, 3.9860e+05],
        [7.5919e+05, 7.6868e+05, 3.7790e+05, 3.7790e+05, 3.7788e+05, 3.7789e+05,
         0.0000e+00, 7.7916e+05, 3.7789e+05, 3.7784e+05, 3.7788e+05, 3.7789e+05,
         3.7790e+05, 7.7514e+05, 3.7787e+05, 3.7793e+05, 7.8620e+05, 3.7790e+05,
         7.5955e+05, 7.7548e+05],
        [7.6530e+05, 7.8598e+05, 3.9158e+05, 3.9156e+05, 3.9158e+05, 3.9154e+05,
         7.7916e+05, 0.0000e+00, 3.9151e+05, 3.9147e+05, 3.9155e+05, 3.9152e+05,
         3.9153e+05, 8.0154e+05, 3.9154e+05, 3.9155e+05, 7.9384e+05, 3.9155e+05,
         7.8505e+05, 7.6337e+05],
        [3.8291e+05, 3.9269e+05, 3.7615e+00, 3.3259e+00, 3.5620e+00, 3.4806e+00,
         3.7789e+05, 3.9151e+05, 0.0000e+00, 3.4328e+00, 3.5279e+00, 3.5939e+00,
         3.6737e+00, 3.9579e+05, 3.5964e+00, 3.7873e+00, 3.9828e+05, 3.3900e+00,
         3.9444e+05, 3.9859e+05],
        [3.8289e+05, 3.9271e+05, 3.5328e+00, 3.4998e+00, 3.5271e+00, 3.5319e+00,
         3.7784e+05, 3.9147e+05, 3.4328e+00, 0.0000e+00, 3.6365e+00, 3.3486e+00,
         3.5107e+00, 3.9574e+05, 3.8379e+00, 3.8143e+00, 3.9827e+05, 3.4841e+00,
         3.9446e+05, 3.9860e+05],
        [3.8293e+05, 3.9274e+05, 3.3144e+00, 3.5455e+00, 3.5107e+00, 3.4720e+00,
         3.7788e+05, 3.9155e+05, 3.5279e+00, 3.6365e+00, 0.0000e+00, 3.3553e+00,
         3.2883e+00, 3.9580e+05, 3.8779e+00, 3.6905e+00, 3.9824e+05, 3.5640e+00,
         3.9445e+05, 3.9857e+05],
        [3.8294e+05, 3.9272e+05, 3.3997e+00, 3.5367e+00, 3.8227e+00, 3.4358e+00,
         3.7789e+05, 3.9152e+05, 3.5939e+00, 3.3486e+00, 3.3553e+00, 0.0000e+00,
         3.7165e+00, 3.9577e+05, 4.1411e+00, 3.8427e+00, 3.9831e+05, 3.7747e+00,
         3.9447e+05, 3.9856e+05],
        [3.8290e+05, 3.9274e+05, 3.3929e+00, 3.6771e+00, 3.9100e+00, 3.5878e+00,
         3.7790e+05, 3.9153e+05, 3.6737e+00, 3.5107e+00, 3.2883e+00, 3.7165e+00,
         0.0000e+00, 3.9579e+05, 3.8765e+00, 3.6997e+00, 3.9826e+05, 3.4349e+00,
         3.9444e+05, 3.9861e+05],
        [7.6316e+05, 7.9386e+05, 3.9574e+05, 3.9575e+05, 3.9574e+05, 3.9572e+05,
         7.7514e+05, 8.0154e+05, 3.9579e+05, 3.9574e+05, 3.9580e+05, 3.9577e+05,
         3.9579e+05, 0.0000e+00, 3.9585e+05, 3.9576e+05, 7.9826e+05, 3.9577e+05,
         7.8981e+05, 7.9071e+05],
        [3.8290e+05, 3.9278e+05, 3.8664e+00, 3.6229e+00, 3.7083e+00, 3.9597e+00,
         3.7787e+05, 3.9154e+05, 3.5964e+00, 3.8379e+00, 3.8779e+00, 4.1411e+00,
         3.8765e+00, 3.9585e+05, 0.0000e+00, 3.7861e+00, 3.9824e+05, 3.8432e+00,
         3.9441e+05, 3.9857e+05],
        [3.8294e+05, 3.9276e+05, 3.7274e+00, 3.8110e+00, 3.8652e+00, 3.6965e+00,
         3.7793e+05, 3.9155e+05, 3.7873e+00, 3.8143e+00, 3.6905e+00, 3.8427e+00,
         3.6997e+00, 3.9576e+05, 3.7861e+00, 0.0000e+00, 3.9824e+05, 3.5794e+00,
         3.9444e+05, 3.9861e+05],
        [7.7436e+05, 7.8807e+05, 3.9828e+05, 3.9833e+05, 3.9825e+05, 3.9829e+05,
         7.8620e+05, 7.9384e+05, 3.9828e+05, 3.9827e+05, 3.9824e+05, 3.9831e+05,
         3.9826e+05, 7.9826e+05, 3.9824e+05, 3.9824e+05, 0.0000e+00, 3.9827e+05,
         7.9883e+05, 7.9141e+05],
        [3.8290e+05, 3.9272e+05, 3.4515e+00, 3.6398e+00, 3.4685e+00, 3.3957e+00,
         3.7790e+05, 3.9155e+05, 3.3900e+00, 3.4841e+00, 3.5640e+00, 3.7747e+00,
         3.4349e+00, 3.9577e+05, 3.8432e+00, 3.5794e+00, 3.9827e+05, 0.0000e+00,
         3.9441e+05, 3.9853e+05],
        [8.0174e+05, 7.8696e+05, 3.9446e+05, 3.9447e+05, 3.9441e+05, 3.9445e+05,
         7.5955e+05, 7.8505e+05, 3.9444e+05, 3.9446e+05, 3.9445e+05, 3.9447e+05,
         3.9444e+05, 7.8981e+05, 3.9441e+05, 3.9444e+05, 7.9883e+05, 3.9441e+05,
         0.0000e+00, 7.7513e+05],
        [7.9123e+05, 7.9869e+05, 3.9857e+05, 3.9858e+05, 3.9855e+05, 3.9860e+05,
         7.7548e+05, 7.6337e+05, 3.9859e+05, 3.9860e+05, 3.9857e+05, 3.9856e+05,
         3.9861e+05, 7.9071e+05, 3.9857e+05, 3.9861e+05, 7.9141e+05, 3.9853e+05,
         7.7513e+05, 0.0000e+00]])
Krum scores: ['382907.69', '392725.56', '3.44', '3.52', '3.56', '3.44', '377884.78', '391532.22', '3.53', '3.53', '3.49', '3.58', '3.59', '395754.91', '3.80', '3.74', '398261.78', '3.52', '394435.66', '398572.03']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [17, 14, 3, 10, 6, 12, 19, 13, 11, 5, 1, 2, 7, 16, 8, 9, 15, 4, 18, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0052s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:43...
global Accuracy on shared test data: 54.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[107 130]
 [ 96 167]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:43, End: 2025-07-22 15:46:43)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [4, 15, 3, 5, 19, 6, 12, 1, 7, 11, 10, 8, 9, 17, 16], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.7757e+05, 3.3857e+00, 3.3616e+00, 3.8126e+05, 3.3752e+00,
         3.3368e+00, 3.5455e+00, 3.4196e+00, 3.3733e+00, 3.6055e+00, 3.7996e+00,
         3.5839e+00, 3.8609e+05, 3.9077e+05],
        [3.7757e+05, 0.0000e+00, 3.7750e+05, 3.7751e+05, 7.7024e+05, 3.7755e+05,
         3.7757e+05, 3.7755e+05, 3.7754e+05, 3.7754e+05, 3.7753e+05, 3.7753e+05,
         3.7756e+05, 7.3799e+05, 7.7244e+05],
        [3.3857e+00, 3.7750e+05, 0.0000e+00, 3.5118e+00, 3.8124e+05, 3.3214e+00,
         3.5777e+00, 3.4524e+00, 3.4724e+00, 3.8693e+00, 3.4009e+00, 3.9056e+00,
         3.7139e+00, 3.8605e+05, 3.9077e+05],
        [3.3616e+00, 3.7751e+05, 3.5118e+00, 0.0000e+00, 3.8127e+05, 3.3495e+00,
         3.4786e+00, 3.4941e+00, 3.4298e+00, 3.4182e+00, 3.3981e+00, 3.6502e+00,
         3.7321e+00, 3.8606e+05, 3.9071e+05],
        [3.8126e+05, 7.7024e+05, 3.8124e+05, 3.8127e+05, 0.0000e+00, 3.8126e+05,
         3.8123e+05, 3.8126e+05, 3.8127e+05, 3.8126e+05, 3.8126e+05, 3.8128e+05,
         3.8128e+05, 7.6383e+05, 7.7986e+05],
        [3.3752e+00, 3.7755e+05, 3.3214e+00, 3.3495e+00, 3.8126e+05, 0.0000e+00,
         3.2869e+00, 3.5817e+00, 3.8767e+00, 3.5325e+00, 3.7108e+00, 3.5693e+00,
         3.8813e+00, 3.8604e+05, 3.9076e+05],
        [3.3368e+00, 3.7757e+05, 3.5777e+00, 3.4786e+00, 3.8123e+05, 3.2869e+00,
         0.0000e+00, 3.4993e+00, 3.6080e+00, 3.6346e+00, 3.4054e+00, 3.9755e+00,
         3.6921e+00, 3.8605e+05, 3.9072e+05],
        [3.5455e+00, 3.7755e+05, 3.4524e+00, 3.4941e+00, 3.8126e+05, 3.5817e+00,
         3.4993e+00, 0.0000e+00, 3.2993e+00, 3.5416e+00, 3.5416e+00, 3.8390e+00,
         3.7663e+00, 3.8602e+05, 3.9075e+05],
        [3.4196e+00, 3.7754e+05, 3.4724e+00, 3.4298e+00, 3.8127e+05, 3.8767e+00,
         3.6080e+00, 3.2993e+00, 0.0000e+00, 3.6188e+00, 3.6988e+00, 3.8119e+00,
         3.6132e+00, 3.8606e+05, 3.9071e+05],
        [3.3733e+00, 3.7754e+05, 3.8693e+00, 3.4182e+00, 3.8126e+05, 3.5325e+00,
         3.6346e+00, 3.5416e+00, 3.6188e+00, 0.0000e+00, 3.3796e+00, 3.6146e+00,
         3.8027e+00, 3.8606e+05, 3.9074e+05],
        [3.6055e+00, 3.7753e+05, 3.4009e+00, 3.3981e+00, 3.8126e+05, 3.7108e+00,
         3.4054e+00, 3.5416e+00, 3.6988e+00, 3.3796e+00, 0.0000e+00, 3.6195e+00,
         3.7672e+00, 3.8603e+05, 3.9071e+05],
        [3.7996e+00, 3.7753e+05, 3.9056e+00, 3.6502e+00, 3.8128e+05, 3.5693e+00,
         3.9755e+00, 3.8390e+00, 3.8119e+00, 3.6146e+00, 3.6195e+00, 0.0000e+00,
         3.7428e+00, 3.8606e+05, 3.9075e+05],
        [3.5839e+00, 3.7756e+05, 3.7139e+00, 3.7321e+00, 3.8128e+05, 3.8813e+00,
         3.6921e+00, 3.7663e+00, 3.6132e+00, 3.8027e+00, 3.7672e+00, 3.7428e+00,
         0.0000e+00, 3.8604e+05, 3.9078e+05],
        [3.8609e+05, 7.3799e+05, 3.8605e+05, 3.8606e+05, 7.6383e+05, 3.8604e+05,
         3.8605e+05, 3.8602e+05, 3.8606e+05, 3.8606e+05, 3.8603e+05, 3.8606e+05,
         3.8604e+05, 0.0000e+00, 7.9437e+05],
        [3.9077e+05, 7.7244e+05, 3.9077e+05, 3.9071e+05, 7.7986e+05, 3.9076e+05,
         3.9072e+05, 3.9075e+05, 3.9071e+05, 3.9074e+05, 3.9071e+05, 3.9075e+05,
         3.9078e+05, 7.9437e+05, 0.0000e+00]])
Krum scores: ['3.44', '377532.78', '3.52', '3.45', '381255.84', '3.51', '3.50', '3.52', '3.55', '3.55', '3.53', '3.73', '3.71', '386046.09', '390736.34']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [4, 15, 3, 5, 19, 6, 12, 1, 7, 11, 10, 8, 9, 17, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:44...
global Accuracy on shared test data: 55.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[109 128]
 [ 97 166]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:44, End: 2025-07-22 15:46:44)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [18, 17], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[     0.0000, 785099.1250],
        [785099.1250,      0.0000]])
Krum scores: ['nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [18, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0007s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:44...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [194  69]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:46:44, End: 2025-07-22 15:46:44)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [4, 9, 7, 2, 18, 3, 8, 16, 19, 11, 15, 20, 6, 14, 12, 1, 13, 5], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.7378e+00, 3.5432e+00, 3.9759e+00, 3.7664e+05, 3.5313e+00,
         3.7984e+00, 3.8456e+05, 3.9617e+05, 3.6151e+00, 3.8210e+05, 3.8655e+05,
         3.5900e+00, 3.8926e+05, 3.3681e+00, 3.5803e+00, 3.8593e+05, 3.2884e+00],
        [3.7378e+00, 0.0000e+00, 3.8490e+00, 3.6621e+00, 3.7661e+05, 3.3564e+00,
         4.0519e+00, 3.8467e+05, 3.9615e+05, 3.5208e+00, 3.8207e+05, 3.8651e+05,
         3.6244e+00, 3.8919e+05, 3.4763e+00, 3.5508e+00, 3.8591e+05, 3.5579e+00],
        [3.5432e+00, 3.8490e+00, 0.0000e+00, 3.5227e+00, 3.7661e+05, 3.3142e+00,
         3.4516e+00, 3.8462e+05, 3.9618e+05, 3.6392e+00, 3.8209e+05, 3.8654e+05,
         3.7243e+00, 3.8924e+05, 3.2871e+00, 3.5960e+00, 3.8588e+05, 3.4291e+00],
        [3.9759e+00, 3.6621e+00, 3.5227e+00, 0.0000e+00, 3.7665e+05, 3.6512e+00,
         3.5555e+00, 3.8461e+05, 3.9618e+05, 3.7942e+00, 3.8208e+05, 3.8650e+05,
         3.5313e+00, 3.8919e+05, 3.6573e+00, 3.4506e+00, 3.8590e+05, 3.6421e+00],
        [3.7664e+05, 3.7661e+05, 3.7661e+05, 3.7665e+05, 0.0000e+00, 3.7661e+05,
         3.7673e+05, 7.7418e+05, 7.6920e+05, 3.7667e+05, 7.4406e+05, 7.5204e+05,
         3.7665e+05, 7.8138e+05, 3.7664e+05, 3.7668e+05, 7.3875e+05, 3.7658e+05],
        [3.5313e+00, 3.3564e+00, 3.3142e+00, 3.6512e+00, 3.7661e+05, 0.0000e+00,
         3.4130e+00, 3.8460e+05, 3.9613e+05, 3.4915e+00, 3.8210e+05, 3.8654e+05,
         3.3145e+00, 3.8926e+05, 3.3397e+00, 3.4077e+00, 3.8589e+05, 3.1057e+00],
        [3.7984e+00, 4.0519e+00, 3.4516e+00, 3.5555e+00, 3.7673e+05, 3.4130e+00,
         0.0000e+00, 3.8461e+05, 3.9616e+05, 3.5618e+00, 3.8207e+05, 3.8652e+05,
         3.4091e+00, 3.8926e+05, 3.5192e+00, 3.6097e+00, 3.8592e+05, 3.7298e+00],
        [3.8456e+05, 3.8467e+05, 3.8462e+05, 3.8461e+05, 7.7418e+05, 3.8460e+05,
         3.8461e+05, 0.0000e+00, 7.7867e+05, 3.8456e+05, 7.8032e+05, 7.6989e+05,
         3.8463e+05, 7.5293e+05, 3.8465e+05, 3.8464e+05, 7.6517e+05, 3.8460e+05],
        [3.9617e+05, 3.9615e+05, 3.9618e+05, 3.9618e+05, 7.6920e+05, 3.9613e+05,
         3.9616e+05, 7.7867e+05, 0.0000e+00, 3.9616e+05, 7.8069e+05, 7.8070e+05,
         3.9616e+05, 7.9656e+05, 3.9618e+05, 3.9616e+05, 7.8704e+05, 3.9618e+05],
        [3.6151e+00, 3.5208e+00, 3.6392e+00, 3.7942e+00, 3.7667e+05, 3.4915e+00,
         3.5618e+00, 3.8456e+05, 3.9616e+05, 0.0000e+00, 3.8208e+05, 3.8652e+05,
         3.6253e+00, 3.8922e+05, 3.6374e+00, 3.5861e+00, 3.8587e+05, 3.3201e+00],
        [3.8210e+05, 3.8207e+05, 3.8209e+05, 3.8208e+05, 7.4406e+05, 3.8210e+05,
         3.8207e+05, 7.8032e+05, 7.8069e+05, 3.8208e+05, 0.0000e+00, 7.6278e+05,
         3.8206e+05, 7.6528e+05, 3.8209e+05, 3.8203e+05, 7.7106e+05, 3.8200e+05],
        [3.8655e+05, 3.8651e+05, 3.8654e+05, 3.8650e+05, 7.5204e+05, 3.8654e+05,
         3.8652e+05, 7.6989e+05, 7.8070e+05, 3.8652e+05, 7.6278e+05, 0.0000e+00,
         3.8651e+05, 7.5683e+05, 3.8656e+05, 3.8651e+05, 7.8334e+05, 3.8652e+05],
        [3.5900e+00, 3.6244e+00, 3.7243e+00, 3.5313e+00, 3.7665e+05, 3.3145e+00,
         3.4091e+00, 3.8463e+05, 3.9616e+05, 3.6253e+00, 3.8206e+05, 3.8651e+05,
         0.0000e+00, 3.8926e+05, 3.6095e+00, 3.6691e+00, 3.8593e+05, 3.6962e+00],
        [3.8926e+05, 3.8919e+05, 3.8924e+05, 3.8919e+05, 7.8138e+05, 3.8926e+05,
         3.8926e+05, 7.5293e+05, 7.9656e+05, 3.8922e+05, 7.6528e+05, 7.5683e+05,
         3.8926e+05, 0.0000e+00, 3.8920e+05, 3.8921e+05, 7.8891e+05, 3.8928e+05],
        [3.3681e+00, 3.4763e+00, 3.2871e+00, 3.6573e+00, 3.7664e+05, 3.3397e+00,
         3.5192e+00, 3.8465e+05, 3.9618e+05, 3.6374e+00, 3.8209e+05, 3.8656e+05,
         3.6095e+00, 3.8920e+05, 0.0000e+00, 3.6607e+00, 3.8590e+05, 3.3857e+00],
        [3.5803e+00, 3.5508e+00, 3.5960e+00, 3.4506e+00, 3.7668e+05, 3.4077e+00,
         3.6097e+00, 3.8464e+05, 3.9616e+05, 3.5861e+00, 3.8203e+05, 3.8651e+05,
         3.6691e+00, 3.8921e+05, 3.6607e+00, 0.0000e+00, 3.8594e+05, 3.4073e+00],
        [3.8593e+05, 3.8591e+05, 3.8588e+05, 3.8590e+05, 7.3875e+05, 3.8589e+05,
         3.8592e+05, 7.6517e+05, 7.8704e+05, 3.8587e+05, 7.7106e+05, 7.8334e+05,
         3.8593e+05, 7.8891e+05, 3.8590e+05, 3.8594e+05, 0.0000e+00, 3.8588e+05],
        [3.2884e+00, 3.5579e+00, 3.4291e+00, 3.6421e+00, 3.7658e+05, 3.1057e+00,
         3.7298e+00, 3.8460e+05, 3.9618e+05, 3.3201e+00, 3.8200e+05, 3.8652e+05,
         3.6962e+00, 3.8928e+05, 3.3857e+00, 3.4073e+00, 3.8588e+05, 0.0000e+00]])
Krum scores: ['3.56', '3.59', '3.50', '3.61', '376629.56', '3.36', '3.56', '384601.72', '396158.88', '3.56', '382063.94', '386517.47', '3.56', '389223.31', '3.48', '3.54', '385897.00', '3.43']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [4, 9, 7, 2, 18, 3, 8, 16, 19, 11, 15, 20, 6, 14, 12, 1, 13, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0100s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:45...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [193  70]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:45, End: 2025-07-22 15:46:45)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (6): [16, 19, 2, 4, 7, 9], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 6
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([6])
tensor([[0.0000e+00, 7.7757e+05, 3.8087e+05, 3.8089e+05, 3.8083e+05, 3.8078e+05],
        [7.7757e+05, 0.0000e+00, 3.9385e+05, 3.9379e+05, 3.9384e+05, 3.9384e+05],
        [3.8087e+05, 3.9385e+05, 0.0000e+00, 3.9449e+00, 3.4787e+00, 3.6379e+00],
        [3.8089e+05, 3.9379e+05, 3.9449e+00, 0.0000e+00, 3.4650e+00, 3.7374e+00],
        [3.8083e+05, 3.9384e+05, 3.4787e+00, 3.4650e+00, 0.0000e+00, 3.8482e+00],
        [3.8078e+05, 3.9384e+05, 3.6379e+00, 3.7374e+00, 3.8482e+00, 0.0000e+00]])
Krum scores: ['380808.50', '393814.34', '3.56', '3.60', '3.47', '3.69']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']], selected_client_indices: [16, 19, 2, 4, 7, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0048s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:45...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [189  74]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:45, End: 2025-07-22 15:46:45)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [16, 15, 9, 6, 11, 20, 18, 4, 8, 7, 14, 1, 13, 3, 2], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 7.8086e+05, 3.8635e+05, 3.8633e+05, 3.8629e+05, 7.7737e+05,
         7.8125e+05, 3.8628e+05, 3.8632e+05, 3.8632e+05, 7.6424e+05, 3.8631e+05,
         8.0271e+05, 3.8632e+05, 3.8632e+05],
        [7.8086e+05, 0.0000e+00, 3.9877e+05, 3.9877e+05, 3.9880e+05, 7.9102e+05,
         7.6842e+05, 3.9875e+05, 3.9879e+05, 3.9881e+05, 7.7204e+05, 3.9880e+05,
         8.0567e+05, 3.9874e+05, 3.9873e+05],
        [3.8635e+05, 3.9877e+05, 0.0000e+00, 3.5874e+00, 3.5886e+00, 3.8535e+05,
         3.9414e+05, 3.8180e+00, 4.1790e+00, 3.8194e+00, 3.7944e+05, 3.5993e+00,
         4.0268e+05, 3.5554e+00, 3.7037e+00],
        [3.8633e+05, 3.9877e+05, 3.5874e+00, 0.0000e+00, 3.3823e+00, 3.8538e+05,
         3.9412e+05, 3.5844e+00, 3.4245e+00, 3.6200e+00, 3.7940e+05, 3.6301e+00,
         4.0269e+05, 3.3624e+00, 3.5525e+00],
        [3.8629e+05, 3.9880e+05, 3.5886e+00, 3.3823e+00, 0.0000e+00, 3.8533e+05,
         3.9419e+05, 3.6577e+00, 3.6344e+00, 3.4687e+00, 3.7943e+05, 3.4900e+00,
         4.0267e+05, 3.5967e+00, 3.6161e+00],
        [7.7737e+05, 7.9102e+05, 3.8535e+05, 3.8538e+05, 3.8533e+05, 0.0000e+00,
         7.8687e+05, 3.8536e+05, 3.8536e+05, 3.8536e+05, 7.6353e+05, 3.8538e+05,
         7.9218e+05, 3.8538e+05, 3.8540e+05],
        [7.8125e+05, 7.6842e+05, 3.9414e+05, 3.9412e+05, 3.9419e+05, 7.8687e+05,
         0.0000e+00, 3.9417e+05, 3.9416e+05, 3.9413e+05, 7.7357e+05, 3.9420e+05,
         7.8646e+05, 3.9416e+05, 3.9416e+05],
        [3.8628e+05, 3.9875e+05, 3.8180e+00, 3.5844e+00, 3.6577e+00, 3.8536e+05,
         3.9417e+05, 0.0000e+00, 3.9355e+00, 3.5365e+00, 3.7945e+05, 3.6278e+00,
         4.0270e+05, 3.5456e+00, 4.0317e+00],
        [3.8632e+05, 3.9879e+05, 4.1790e+00, 3.4245e+00, 3.6344e+00, 3.8536e+05,
         3.9416e+05, 3.9355e+00, 0.0000e+00, 3.4239e+00, 3.7943e+05, 3.6906e+00,
         4.0266e+05, 3.5292e+00, 3.5372e+00],
        [3.8632e+05, 3.9881e+05, 3.8194e+00, 3.6200e+00, 3.4687e+00, 3.8536e+05,
         3.9413e+05, 3.5365e+00, 3.4239e+00, 0.0000e+00, 3.7942e+05, 3.5272e+00,
         4.0267e+05, 3.3059e+00, 3.5037e+00],
        [7.6424e+05, 7.7204e+05, 3.7944e+05, 3.7940e+05, 3.7943e+05, 7.6353e+05,
         7.7357e+05, 3.7945e+05, 3.7943e+05, 3.7942e+05, 0.0000e+00, 3.7942e+05,
         7.8863e+05, 3.7944e+05, 3.7941e+05],
        [3.8631e+05, 3.9880e+05, 3.5993e+00, 3.6301e+00, 3.4900e+00, 3.8538e+05,
         3.9420e+05, 3.6278e+00, 3.6906e+00, 3.5272e+00, 3.7942e+05, 0.0000e+00,
         4.0270e+05, 3.5518e+00, 3.5009e+00],
        [8.0271e+05, 8.0567e+05, 4.0268e+05, 4.0269e+05, 4.0267e+05, 7.9218e+05,
         7.8646e+05, 4.0270e+05, 4.0266e+05, 4.0267e+05, 7.8863e+05, 4.0270e+05,
         0.0000e+00, 4.0268e+05, 4.0270e+05],
        [3.8632e+05, 3.9874e+05, 3.5554e+00, 3.3624e+00, 3.5967e+00, 3.8538e+05,
         3.9416e+05, 3.5456e+00, 3.5292e+00, 3.3059e+00, 3.7944e+05, 3.5518e+00,
         4.0268e+05, 0.0000e+00, 3.7666e+00],
        [3.8632e+05, 3.9873e+05, 3.7037e+00, 3.5525e+00, 3.6161e+00, 3.8540e+05,
         3.9416e+05, 4.0317e+00, 3.5372e+00, 3.5037e+00, 3.7941e+05, 3.5009e+00,
         4.0270e+05, 3.7666e+00, 0.0000e+00]])
Krum scores: ['386310.12', '398765.56', '3.67', '3.50', '3.54', '385359.00', '394149.03', '3.67', '3.60', '3.48', '379421.69', '3.56', '402679.69', '3.49', '3.60']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [16, 15, 9, 6, 11, 20, 18, 4, 8, 7, 14, 1, 13, 3, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0170s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:46...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [188  75]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:46, End: 2025-07-22 15:46:46)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 11, 20, 19, 5, 13, 17, 3, 15, 4, 16, 18, 9, 7, 8, 2, 6, 10], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.7786e+05, 7.5475e+05, 7.6518e+05, 3.7781e+05, 7.7260e+05,
         7.7852e+05, 3.7782e+05, 7.7683e+05, 3.7782e+05, 7.5495e+05, 7.7085e+05,
         3.7785e+05, 3.7787e+05, 3.7782e+05, 3.7783e+05, 3.7791e+05, 3.7789e+05],
        [3.7786e+05, 0.0000e+00, 3.8928e+05, 3.8905e+05, 3.2512e+00, 3.9643e+05,
         4.0278e+05, 3.5486e+00, 3.9763e+05, 3.6635e+00, 3.8420e+05, 3.8904e+05,
         3.5297e+00, 3.4545e+00, 3.5799e+00, 3.5734e+00, 3.3800e+00, 3.4035e+00],
        [7.5475e+05, 3.8928e+05, 0.0000e+00, 7.6306e+05, 3.8934e+05, 7.9739e+05,
         7.7973e+05, 3.8931e+05, 7.9075e+05, 3.8934e+05, 7.8075e+05, 7.7233e+05,
         3.8929e+05, 3.8930e+05, 3.8936e+05, 3.8936e+05, 3.8932e+05, 3.8936e+05],
        [7.6518e+05, 3.8905e+05, 7.6306e+05, 0.0000e+00, 3.8910e+05, 7.7688e+05,
         7.8235e+05, 3.8909e+05, 8.0050e+05, 3.8911e+05, 7.8560e+05, 7.7671e+05,
         3.8906e+05, 3.8907e+05, 3.8910e+05, 3.8909e+05, 3.8907e+05, 3.8909e+05],
        [3.7781e+05, 3.2512e+00, 3.8934e+05, 3.8910e+05, 0.0000e+00, 3.9638e+05,
         4.0276e+05, 3.2409e+00, 3.9765e+05, 3.3649e+00, 3.8419e+05, 3.8896e+05,
         3.5283e+00, 3.4901e+00, 3.6920e+00, 3.7840e+00, 3.5780e+00, 3.4701e+00],
        [7.7260e+05, 3.9643e+05, 7.9739e+05, 7.7688e+05, 3.9638e+05, 0.0000e+00,
         8.0428e+05, 3.9641e+05, 7.9264e+05, 3.9639e+05, 7.9573e+05, 7.8169e+05,
         3.9638e+05, 3.9637e+05, 3.9641e+05, 3.9640e+05, 3.9642e+05, 3.9633e+05],
        [7.7852e+05, 4.0278e+05, 7.7973e+05, 7.8235e+05, 4.0276e+05, 8.0428e+05,
         0.0000e+00, 4.0279e+05, 8.2023e+05, 4.0279e+05, 7.9845e+05, 7.8177e+05,
         4.0271e+05, 4.0274e+05, 4.0273e+05, 4.0277e+05, 4.0274e+05, 4.0273e+05],
        [3.7782e+05, 3.5486e+00, 3.8931e+05, 3.8909e+05, 3.2409e+00, 3.9641e+05,
         4.0279e+05, 0.0000e+00, 3.9764e+05, 3.6088e+00, 3.8419e+05, 3.8902e+05,
         3.4777e+00, 3.3022e+00, 3.4033e+00, 3.7883e+00, 3.2822e+00, 3.3705e+00],
        [7.7683e+05, 3.9763e+05, 7.9075e+05, 8.0050e+05, 3.9765e+05, 7.9264e+05,
         8.2023e+05, 3.9764e+05, 0.0000e+00, 3.9761e+05, 7.8974e+05, 7.8067e+05,
         3.9762e+05, 3.9758e+05, 3.9757e+05, 3.9763e+05, 3.9764e+05, 3.9763e+05],
        [3.7782e+05, 3.6635e+00, 3.8934e+05, 3.8911e+05, 3.3649e+00, 3.9639e+05,
         4.0279e+05, 3.6088e+00, 3.9761e+05, 0.0000e+00, 3.8419e+05, 3.8902e+05,
         3.8071e+00, 3.5221e+00, 3.8167e+00, 4.1047e+00, 3.5872e+00, 3.6135e+00],
        [7.5495e+05, 3.8420e+05, 7.8075e+05, 7.8560e+05, 3.8419e+05, 7.9573e+05,
         7.9845e+05, 3.8419e+05, 7.8974e+05, 3.8419e+05, 0.0000e+00, 7.7722e+05,
         3.8420e+05, 3.8412e+05, 3.8419e+05, 3.8420e+05, 3.8417e+05, 3.8422e+05],
        [7.7085e+05, 3.8904e+05, 7.7233e+05, 7.7671e+05, 3.8896e+05, 7.8169e+05,
         7.8177e+05, 3.8902e+05, 7.8067e+05, 3.8902e+05, 7.7722e+05, 0.0000e+00,
         3.8899e+05, 3.8899e+05, 3.8889e+05, 3.8897e+05, 3.8898e+05, 3.8898e+05],
        [3.7785e+05, 3.5297e+00, 3.8929e+05, 3.8906e+05, 3.5283e+00, 3.9638e+05,
         4.0271e+05, 3.4777e+00, 3.9762e+05, 3.8071e+00, 3.8420e+05, 3.8899e+05,
         0.0000e+00, 3.6999e+00, 4.0592e+00, 3.7128e+00, 3.5467e+00, 3.7311e+00],
        [3.7787e+05, 3.4545e+00, 3.8930e+05, 3.8907e+05, 3.4901e+00, 3.9637e+05,
         4.0274e+05, 3.3022e+00, 3.9758e+05, 3.5221e+00, 3.8412e+05, 3.8899e+05,
         3.6999e+00, 0.0000e+00, 3.3631e+00, 3.5057e+00, 3.5328e+00, 3.3350e+00],
        [3.7782e+05, 3.5799e+00, 3.8936e+05, 3.8910e+05, 3.6920e+00, 3.9641e+05,
         4.0273e+05, 3.4033e+00, 3.9757e+05, 3.8167e+00, 3.8419e+05, 3.8889e+05,
         4.0592e+00, 3.3631e+00, 0.0000e+00, 3.4693e+00, 3.3398e+00, 3.6525e+00],
        [3.7783e+05, 3.5734e+00, 3.8936e+05, 3.8909e+05, 3.7840e+00, 3.9640e+05,
         4.0277e+05, 3.7883e+00, 3.9763e+05, 4.1047e+00, 3.8420e+05, 3.8897e+05,
         3.7128e+00, 3.5057e+00, 3.4693e+00, 0.0000e+00, 3.5797e+00, 3.4282e+00],
        [3.7791e+05, 3.3800e+00, 3.8932e+05, 3.8907e+05, 3.5780e+00, 3.9642e+05,
         4.0274e+05, 3.2822e+00, 3.9764e+05, 3.5872e+00, 3.8417e+05, 3.8898e+05,
         3.5467e+00, 3.5328e+00, 3.3398e+00, 3.5797e+00, 0.0000e+00, 3.5027e+00],
        [3.7789e+05, 3.4035e+00, 3.8936e+05, 3.8909e+05, 3.4701e+00, 3.9633e+05,
         4.0273e+05, 3.3705e+00, 3.9763e+05, 3.6135e+00, 3.8422e+05, 3.8898e+05,
         3.7311e+00, 3.3350e+00, 3.6525e+00, 3.4282e+00, 3.5027e+00, 0.0000e+00]])
Krum scores: ['377835.16', '3.47', '389317.00', '389078.81', '3.45', '396383.97', '402745.22', '3.40', '397614.03', '3.62', '384180.41', '388973.06', '3.63', '3.44', '3.54', '3.61', '3.47', '3.47']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 11, 20, 19, 5, 13, 17, 3, 15, 4, 16, 18, 9, 7, 8, 2, 6, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0187s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:46...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [181  82]]
Function 'evaluate_global_model' executed in 0.0023 seconds (Start: 2025-07-22 15:46:46, End: 2025-07-22 15:46:46)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [11, 4, 14, 20, 6, 9, 12, 18, 1, 5, 3], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
tensor([[0.0000e+00, 3.6552e+00, 3.8692e+05, 3.9439e+05, 3.3279e+00, 3.5727e+00,
         3.5106e+00, 3.9754e+05, 3.4580e+00, 3.2472e+00, 3.4835e+00],
        [3.6552e+00, 0.0000e+00, 3.8688e+05, 3.9446e+05, 3.5996e+00, 3.8050e+00,
         3.3488e+00, 3.9752e+05, 3.7267e+00, 3.3173e+00, 3.5658e+00],
        [3.8692e+05, 3.8688e+05, 0.0000e+00, 8.0282e+05, 3.8690e+05, 3.8694e+05,
         3.8694e+05, 7.7444e+05, 3.8691e+05, 3.8692e+05, 3.8692e+05],
        [3.9439e+05, 3.9446e+05, 8.0282e+05, 0.0000e+00, 3.9437e+05, 3.9441e+05,
         3.9440e+05, 7.9262e+05, 3.9446e+05, 3.9445e+05, 3.9449e+05],
        [3.3279e+00, 3.5996e+00, 3.8690e+05, 3.9437e+05, 0.0000e+00, 3.5969e+00,
         3.6843e+00, 3.9753e+05, 3.5975e+00, 3.5444e+00, 3.2603e+00],
        [3.5727e+00, 3.8050e+00, 3.8694e+05, 3.9441e+05, 3.5969e+00, 0.0000e+00,
         3.6016e+00, 3.9746e+05, 3.6478e+00, 3.5842e+00, 3.5386e+00],
        [3.5106e+00, 3.3488e+00, 3.8694e+05, 3.9440e+05, 3.6843e+00, 3.6016e+00,
         0.0000e+00, 3.9751e+05, 3.8269e+00, 3.4818e+00, 3.4364e+00],
        [3.9754e+05, 3.9752e+05, 7.7444e+05, 7.9262e+05, 3.9753e+05, 3.9746e+05,
         3.9751e+05, 0.0000e+00, 3.9747e+05, 3.9748e+05, 3.9754e+05],
        [3.4580e+00, 3.7267e+00, 3.8691e+05, 3.9446e+05, 3.5975e+00, 3.6478e+00,
         3.8269e+00, 3.9747e+05, 0.0000e+00, 3.5854e+00, 3.6029e+00],
        [3.2472e+00, 3.3173e+00, 3.8692e+05, 3.9445e+05, 3.5444e+00, 3.5842e+00,
         3.4818e+00, 3.9748e+05, 3.5854e+00, 0.0000e+00, 3.2657e+00],
        [3.4835e+00, 3.5658e+00, 3.8692e+05, 3.9449e+05, 3.2603e+00, 3.5386e+00,
         3.4364e+00, 3.9754e+05, 3.6029e+00, 3.2657e+00, 0.0000e+00]])
Krum scores: ['3.43', '3.54', '386909.34', '394412.78', '3.49', '3.59', '3.51', '397494.66', '3.60', '3.41', '3.43']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']], selected_client_indices: [11, 4, 14, 20, 6, 9, 12, 18, 1, 5, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0174s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:47...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[164  73]
 [178  85]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:47, End: 2025-07-22 15:46:47)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [8, 9, 1, 16, 19, 11, 6, 7, 12, 4, 15, 20, 5], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 4.3038e+00, 3.9870e+00, 3.9239e+05, 3.8063e+05, 3.5975e+00,
         3.4373e+00, 3.4267e+00, 3.8430e+00, 3.9619e+00, 3.9769e+05, 3.8697e+05,
         3.8228e+00],
        [4.3038e+00, 0.0000e+00, 3.6391e+00, 3.9241e+05, 3.8055e+05, 3.4953e+00,
         3.6315e+00, 3.7100e+00, 3.6381e+00, 3.7327e+00, 3.9767e+05, 3.8695e+05,
         3.6184e+00],
        [3.9870e+00, 3.6391e+00, 0.0000e+00, 3.9243e+05, 3.8064e+05, 3.4526e+00,
         3.6186e+00, 3.5673e+00, 3.8328e+00, 3.7808e+00, 3.9775e+05, 3.8700e+05,
         3.6047e+00],
        [3.9239e+05, 3.9241e+05, 3.9243e+05, 0.0000e+00, 7.6308e+05, 3.9245e+05,
         3.9240e+05, 3.9246e+05, 3.9244e+05, 3.9249e+05, 7.9526e+05, 7.8738e+05,
         3.9247e+05],
        [3.8063e+05, 3.8055e+05, 3.8064e+05, 7.6308e+05, 0.0000e+00, 3.8059e+05,
         3.8059e+05, 3.8059e+05, 3.8066e+05, 3.8064e+05, 7.6039e+05, 7.7877e+05,
         3.8059e+05],
        [3.5975e+00, 3.4953e+00, 3.4526e+00, 3.9245e+05, 3.8059e+05, 0.0000e+00,
         3.3523e+00, 3.4251e+00, 3.5591e+00, 3.6677e+00, 3.9770e+05, 3.8698e+05,
         3.2706e+00],
        [3.4373e+00, 3.6315e+00, 3.6186e+00, 3.9240e+05, 3.8059e+05, 3.3523e+00,
         0.0000e+00, 3.5150e+00, 3.8138e+00, 3.6778e+00, 3.9774e+05, 3.8693e+05,
         3.6236e+00],
        [3.4267e+00, 3.7100e+00, 3.5673e+00, 3.9246e+05, 3.8059e+05, 3.4251e+00,
         3.5150e+00, 0.0000e+00, 3.4398e+00, 3.5608e+00, 3.9772e+05, 3.8699e+05,
         3.4669e+00],
        [3.8430e+00, 3.6381e+00, 3.8328e+00, 3.9244e+05, 3.8066e+05, 3.5591e+00,
         3.8138e+00, 3.4398e+00, 0.0000e+00, 3.4070e+00, 3.9772e+05, 3.8695e+05,
         3.5453e+00],
        [3.9619e+00, 3.7327e+00, 3.7808e+00, 3.9249e+05, 3.8064e+05, 3.6677e+00,
         3.6778e+00, 3.5608e+00, 3.4070e+00, 0.0000e+00, 3.9776e+05, 3.8700e+05,
         3.4010e+00],
        [3.9769e+05, 3.9767e+05, 3.9775e+05, 7.9526e+05, 7.6039e+05, 3.9770e+05,
         3.9774e+05, 3.9772e+05, 3.9772e+05, 3.9776e+05, 0.0000e+00, 7.7299e+05,
         3.9769e+05],
        [3.8697e+05, 3.8695e+05, 3.8700e+05, 7.8738e+05, 7.7877e+05, 3.8698e+05,
         3.8693e+05, 3.8699e+05, 3.8695e+05, 3.8700e+05, 7.7299e+05, 0.0000e+00,
         3.8698e+05],
        [3.8228e+00, 3.6184e+00, 3.6047e+00, 3.9247e+05, 3.8059e+05, 3.2706e+00,
         3.6236e+00, 3.4669e+00, 3.5453e+00, 3.4010e+00, 3.9769e+05, 3.8698e+05,
         0.0000e+00]])
Krum scores: ['3.73', '3.64', '3.64', '392427.16', '380596.94', '3.45', '3.55', '3.49', '3.61', '3.60', '397703.06', '386964.53', '3.50']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [8, 9, 1, 16, 19, 11, 6, 7, 12, 4, 15, 20, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0027s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:47...
global Accuracy on shared test data: 50.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[163  74]
 [173  90]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:47, End: 2025-07-22 15:46:47)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [14, 1, 18, 16, 6, 15, 10, 8, 3, 11, 20, 2, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.9053e+05, 7.9956e+05, 7.9056e+05, 3.9064e+05, 7.7541e+05,
         3.9057e+05, 3.9066e+05, 3.9063e+05, 3.9058e+05, 7.8399e+05, 3.9056e+05,
         3.9063e+05],
        [3.9053e+05, 0.0000e+00, 4.0693e+05, 3.8644e+05, 3.4532e+00, 3.9439e+05,
         3.6527e+00, 3.8647e+00, 3.5194e+00, 3.4019e+00, 3.9091e+05, 3.4920e+00,
         3.7617e+00],
        [7.9956e+05, 4.0693e+05, 0.0000e+00, 7.9040e+05, 4.0692e+05, 7.8527e+05,
         4.0692e+05, 4.0691e+05, 4.0691e+05, 4.0689e+05, 7.8103e+05, 4.0689e+05,
         4.0691e+05],
        [7.9056e+05, 3.8644e+05, 7.9040e+05, 0.0000e+00, 3.8649e+05, 7.8279e+05,
         3.8649e+05, 3.8648e+05, 3.8651e+05, 3.8644e+05, 7.5821e+05, 3.8649e+05,
         3.8645e+05],
        [3.9064e+05, 3.4532e+00, 4.0692e+05, 3.8649e+05, 0.0000e+00, 3.9437e+05,
         3.4173e+00, 3.3932e+00, 3.3306e+00, 3.2888e+00, 3.9092e+05, 3.5784e+00,
         3.7378e+00],
        [7.7541e+05, 3.9439e+05, 7.8527e+05, 7.8279e+05, 3.9437e+05, 0.0000e+00,
         3.9443e+05, 3.9431e+05, 3.9431e+05, 3.9434e+05, 7.6081e+05, 3.9438e+05,
         3.9440e+05],
        [3.9057e+05, 3.6527e+00, 4.0692e+05, 3.8649e+05, 3.4173e+00, 3.9443e+05,
         0.0000e+00, 3.6627e+00, 3.4565e+00, 3.3426e+00, 3.9090e+05, 3.5130e+00,
         3.5132e+00],
        [3.9066e+05, 3.8647e+00, 4.0691e+05, 3.8648e+05, 3.3932e+00, 3.9431e+05,
         3.6627e+00, 0.0000e+00, 3.6371e+00, 3.5276e+00, 3.9091e+05, 3.5873e+00,
         3.8563e+00],
        [3.9063e+05, 3.5194e+00, 4.0691e+05, 3.8651e+05, 3.3306e+00, 3.9431e+05,
         3.4565e+00, 3.6371e+00, 0.0000e+00, 3.4725e+00, 3.9091e+05, 3.7389e+00,
         3.4438e+00],
        [3.9058e+05, 3.4019e+00, 4.0689e+05, 3.8644e+05, 3.2888e+00, 3.9434e+05,
         3.3426e+00, 3.5276e+00, 3.4725e+00, 0.0000e+00, 3.9092e+05, 3.5608e+00,
         3.5910e+00],
        [7.8399e+05, 3.9091e+05, 7.8103e+05, 7.5821e+05, 3.9092e+05, 7.6081e+05,
         3.9090e+05, 3.9091e+05, 3.9091e+05, 3.9092e+05, 0.0000e+00, 3.9090e+05,
         3.9091e+05],
        [3.9056e+05, 3.4920e+00, 4.0689e+05, 3.8649e+05, 3.5784e+00, 3.9438e+05,
         3.5130e+00, 3.5873e+00, 3.7389e+00, 3.5608e+00, 3.9090e+05, 0.0000e+00,
         3.8437e+00],
        [3.9063e+05, 3.7617e+00, 4.0691e+05, 3.8645e+05, 3.7378e+00, 3.9440e+05,
         3.5132e+00, 3.8563e+00, 3.4438e+00, 3.5910e+00, 3.9091e+05, 3.8437e+00,
         0.0000e+00]])
Krum scores: ['390583.72', '3.55', '406906.25', '386464.28', '3.41', '394350.50', '3.48', '3.61', '3.48', '3.43', '390904.78', '3.58', '3.65']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [14, 1, 18, 16, 6, 15, 10, 8, 3, 11, 20, 2, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0055s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:48...
global Accuracy on shared test data: 51.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[161  76]
 [169  94]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:48, End: 2025-07-22 15:46:48)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [18, 20, 1, 14, 9, 5, 4, 6, 8, 17, 12, 11, 15, 10, 3, 2], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.5018e+05, 3.9387e+05, 7.6985e+05, 3.9387e+05, 3.9387e+05,
         3.9384e+05, 3.9384e+05, 3.9381e+05, 7.7302e+05, 3.9382e+05, 3.9386e+05,
         8.1103e+05, 3.9391e+05, 3.9384e+05, 3.9387e+05],
        [7.5018e+05, 0.0000e+00, 3.7800e+05, 7.7695e+05, 3.7808e+05, 3.7804e+05,
         3.7805e+05, 3.7802e+05, 3.7803e+05, 7.7862e+05, 3.7810e+05, 3.7804e+05,
         7.6394e+05, 3.7805e+05, 3.7801e+05, 3.7803e+05],
        [3.9387e+05, 3.7800e+05, 0.0000e+00, 4.0442e+05, 3.6998e+00, 3.6470e+00,
         3.8484e+00, 3.5585e+00, 3.8937e+00, 3.9240e+05, 3.9470e+00, 3.4833e+00,
         3.9485e+05, 3.6811e+00, 3.5365e+00, 3.4972e+00],
        [7.6985e+05, 7.7695e+05, 4.0442e+05, 0.0000e+00, 4.0442e+05, 4.0440e+05,
         4.0440e+05, 4.0444e+05, 4.0442e+05, 7.8427e+05, 4.0440e+05, 4.0441e+05,
         8.1080e+05, 4.0442e+05, 4.0438e+05, 4.0441e+05],
        [3.9387e+05, 3.7808e+05, 3.6998e+00, 4.0442e+05, 0.0000e+00, 3.7402e+00,
         3.8066e+00, 3.6315e+00, 4.1859e+00, 3.9244e+05, 3.7657e+00, 3.6806e+00,
         3.9486e+05, 3.7574e+00, 3.3802e+00, 3.6886e+00],
        [3.9387e+05, 3.7804e+05, 3.6470e+00, 4.0440e+05, 3.7402e+00, 0.0000e+00,
         3.5793e+00, 3.6496e+00, 3.7758e+00, 3.9240e+05, 3.6909e+00, 3.3922e+00,
         3.9483e+05, 3.4959e+00, 3.3607e+00, 3.7869e+00],
        [3.9384e+05, 3.7805e+05, 3.8484e+00, 4.0440e+05, 3.8066e+00, 3.5793e+00,
         0.0000e+00, 3.7778e+00, 3.9637e+00, 3.9243e+05, 3.5640e+00, 3.8308e+00,
         3.9488e+05, 3.7005e+00, 3.5791e+00, 4.0917e+00],
        [3.9384e+05, 3.7802e+05, 3.5585e+00, 4.0444e+05, 3.6315e+00, 3.6496e+00,
         3.7778e+00, 0.0000e+00, 3.4252e+00, 3.9243e+05, 3.8686e+00, 3.4287e+00,
         3.9482e+05, 3.4174e+00, 3.2791e+00, 3.6533e+00],
        [3.9381e+05, 3.7803e+05, 3.8937e+00, 4.0442e+05, 4.1859e+00, 3.7758e+00,
         3.9637e+00, 3.4252e+00, 0.0000e+00, 3.9242e+05, 3.9996e+00, 3.6109e+00,
         3.9485e+05, 3.6458e+00, 3.5664e+00, 3.5748e+00],
        [7.7302e+05, 7.7862e+05, 3.9240e+05, 7.8427e+05, 3.9244e+05, 3.9240e+05,
         3.9243e+05, 3.9243e+05, 3.9242e+05, 0.0000e+00, 3.9243e+05, 3.9241e+05,
         7.8810e+05, 3.9244e+05, 3.9243e+05, 3.9243e+05],
        [3.9382e+05, 3.7810e+05, 3.9470e+00, 4.0440e+05, 3.7657e+00, 3.6909e+00,
         3.5640e+00, 3.8686e+00, 3.9996e+00, 3.9243e+05, 0.0000e+00, 3.7989e+00,
         3.9483e+05, 3.4959e+00, 3.4371e+00, 3.9048e+00],
        [3.9386e+05, 3.7804e+05, 3.4833e+00, 4.0441e+05, 3.6806e+00, 3.3922e+00,
         3.8308e+00, 3.4287e+00, 3.6109e+00, 3.9241e+05, 3.7989e+00, 0.0000e+00,
         3.9488e+05, 3.3722e+00, 3.4891e+00, 3.6247e+00],
        [8.1103e+05, 7.6394e+05, 3.9485e+05, 8.1080e+05, 3.9486e+05, 3.9483e+05,
         3.9488e+05, 3.9482e+05, 3.9485e+05, 7.8810e+05, 3.9483e+05, 3.9488e+05,
         0.0000e+00, 3.9485e+05, 3.9480e+05, 3.9488e+05],
        [3.9391e+05, 3.7805e+05, 3.6811e+00, 4.0442e+05, 3.7574e+00, 3.4959e+00,
         3.7005e+00, 3.4174e+00, 3.6458e+00, 3.9244e+05, 3.4959e+00, 3.3722e+00,
         3.9485e+05, 0.0000e+00, 3.3733e+00, 3.4626e+00],
        [3.9384e+05, 3.7801e+05, 3.5365e+00, 4.0438e+05, 3.3802e+00, 3.3607e+00,
         3.5791e+00, 3.2791e+00, 3.5664e+00, 3.9243e+05, 3.4371e+00, 3.4891e+00,
         3.9480e+05, 3.3733e+00, 0.0000e+00, 3.5865e+00],
        [3.9387e+05, 3.7803e+05, 3.4972e+00, 4.0441e+05, 3.6886e+00, 3.7869e+00,
         4.0917e+00, 3.6533e+00, 3.5748e+00, 3.9243e+05, 3.9048e+00, 3.6247e+00,
         3.9488e+05, 3.4626e+00, 3.5865e+00, 0.0000e+00]])
Krum scores: ['393846.50', '378029.66', '3.65', '404406.00', '3.68', '3.59', '3.74', '3.54', '3.72', '392419.62', '3.72', '3.54', '394841.12', '3.52', '3.44', '3.64']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [18, 20, 1, 14, 9, 5, 4, 6, 8, 17, 12, 11, 15, 10, 3, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0163s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:48...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[161  76]
 [166  97]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:48, End: 2025-07-22 15:46:48)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [2, 7], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 3.6072],
        [3.6072, 0.0000]])
Krum scores: ['nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [2, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0008s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:49...
global Accuracy on shared test data: 51.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[158  79]
 [166  97]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:49, End: 2025-07-22 15:46:49)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (4): [2, 8, 6, 1], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 4
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([4])
tensor([[0.0000, 3.6158, 3.5441, 3.5253],
        [3.6158, 0.0000, 3.4931, 3.8749],
        [3.5441, 3.4931, 0.0000, 3.5788],
        [3.5253, 3.8749, 3.5788, 0.0000]])
Krum scores: ['3.53', '3.55', '3.52', '3.55']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']], selected_client_indices: [2, 8, 6, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0046s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:49...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[158  79]
 [163 100]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:49, End: 2025-07-22 15:46:49)
start time is: 98176603953133, end time is: 98191377738081
The total time is: 14773784948ns.

 ------- aggregate method: krum, random_seed: 100 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [5, 13, 3, 2, 11], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
tensor([[0.0000e+00, 3.9352e+05, 3.5682e+00, 4.0229e+00, 3.7884e+00],
        [3.9352e+05, 0.0000e+00, 3.9356e+05, 3.9357e+05, 3.9355e+05],
        [3.5682e+00, 3.9356e+05, 0.0000e+00, 3.8214e+00, 4.4064e+00],
        [4.0229e+00, 3.9357e+05, 3.8214e+00, 0.0000e+00, 4.3625e+00],
        [3.7884e+00, 3.9355e+05, 4.4064e+00, 4.3625e+00, 0.0000e+00]])
Krum scores: ['3.68', '393536.84', '3.69', '3.92', '4.08']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']], selected_client_indices: [5, 13, 3, 2, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0013s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:49...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:49, End: 2025-07-22 15:46:49)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [6, 16, 8, 12, 4, 11, 10, 9, 7, 14, 13, 3, 1, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.9905e+05, 2.0734e+00, 2.0461e+00, 1.8944e+00, 2.1402e+00,
         2.0392e+00, 1.9557e+00, 2.2025e+00, 3.9197e+05, 3.9877e+05, 2.2639e+00,
         2.0078e+00, 3.8620e+05],
        [3.9905e+05, 0.0000e+00, 3.9903e+05, 3.9902e+05, 3.9904e+05, 3.9905e+05,
         3.9904e+05, 3.9903e+05, 3.9902e+05, 7.9924e+05, 7.9736e+05, 3.9902e+05,
         3.9904e+05, 7.9843e+05],
        [2.0734e+00, 3.9903e+05, 0.0000e+00, 1.9953e+00, 1.9487e+00, 2.0339e+00,
         1.9620e+00, 1.9885e+00, 2.0788e+00, 3.9196e+05, 3.9877e+05, 2.0469e+00,
         2.0406e+00, 3.8625e+05],
        [2.0461e+00, 3.9902e+05, 1.9953e+00, 0.0000e+00, 1.8639e+00, 1.9080e+00,
         1.7776e+00, 1.9864e+00, 2.0023e+00, 3.9197e+05, 3.9879e+05, 1.8357e+00,
         1.9111e+00, 3.8621e+05],
        [1.8944e+00, 3.9904e+05, 1.9487e+00, 1.8639e+00, 0.0000e+00, 2.0180e+00,
         2.0468e+00, 2.0462e+00, 1.8611e+00, 3.9201e+05, 3.9878e+05, 1.9918e+00,
         1.9360e+00, 3.8623e+05],
        [2.1402e+00, 3.9905e+05, 2.0339e+00, 1.9080e+00, 2.0180e+00, 0.0000e+00,
         1.9113e+00, 1.7808e+00, 1.9104e+00, 3.9198e+05, 3.9874e+05, 2.0371e+00,
         1.9571e+00, 3.8618e+05],
        [2.0392e+00, 3.9904e+05, 1.9620e+00, 1.7776e+00, 2.0468e+00, 1.9113e+00,
         0.0000e+00, 1.7956e+00, 1.9717e+00, 3.9199e+05, 3.9877e+05, 1.9239e+00,
         1.8375e+00, 3.8621e+05],
        [1.9557e+00, 3.9903e+05, 1.9885e+00, 1.9864e+00, 2.0462e+00, 1.7808e+00,
         1.7956e+00, 0.0000e+00, 2.1298e+00, 3.9197e+05, 3.9873e+05, 1.8812e+00,
         1.8707e+00, 3.8620e+05],
        [2.2025e+00, 3.9902e+05, 2.0788e+00, 2.0023e+00, 1.8611e+00, 1.9104e+00,
         1.9717e+00, 2.1298e+00, 0.0000e+00, 3.9200e+05, 3.9877e+05, 2.0312e+00,
         1.8888e+00, 3.8623e+05],
        [3.9197e+05, 7.9924e+05, 3.9196e+05, 3.9197e+05, 3.9201e+05, 3.9198e+05,
         3.9199e+05, 3.9197e+05, 3.9200e+05, 0.0000e+00, 7.9297e+05, 3.9198e+05,
         3.9200e+05, 7.9280e+05],
        [3.9877e+05, 7.9736e+05, 3.9877e+05, 3.9879e+05, 3.9878e+05, 3.9874e+05,
         3.9877e+05, 3.9873e+05, 3.9877e+05, 7.9297e+05, 0.0000e+00, 3.9877e+05,
         3.9875e+05, 7.6689e+05],
        [2.2639e+00, 3.9902e+05, 2.0469e+00, 1.8357e+00, 1.9918e+00, 2.0371e+00,
         1.9239e+00, 1.8812e+00, 2.0312e+00, 3.9198e+05, 3.9877e+05, 0.0000e+00,
         2.1738e+00, 3.8620e+05],
        [2.0078e+00, 3.9904e+05, 2.0406e+00, 1.9111e+00, 1.9360e+00, 1.9571e+00,
         1.8375e+00, 1.8707e+00, 1.8888e+00, 3.9200e+05, 3.9875e+05, 2.1738e+00,
         0.0000e+00, 3.8621e+05],
        [3.8620e+05, 7.9843e+05, 3.8625e+05, 3.8621e+05, 3.8623e+05, 3.8618e+05,
         3.8621e+05, 3.8620e+05, 3.8623e+05, 7.9280e+05, 7.6689e+05, 3.8620e+05,
         3.8621e+05, 0.0000e+00]])
Krum scores: ['2.04', '399031.25', '2.01', '1.91', '1.95', '1.94', '1.90', '1.91', '1.98', '391978.59', '398760.53', '1.99', '1.93', '386205.72']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [6, 16, 8, 12, 4, 11, 10, 9, 7, 14, 13, 3, 1, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0030s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:50...
global Accuracy on shared test data: 78.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 44 219]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:50, End: 2025-07-22 15:46:50)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [3, 9, 17, 11, 6, 14, 8], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 1.7158e+00, 3.7483e+05, 1.8478e+00, 2.0146e+00, 3.8706e+05,
         1.7704e+00],
        [1.7158e+00, 0.0000e+00, 3.7482e+05, 1.7195e+00, 1.8017e+00, 3.8704e+05,
         1.8072e+00],
        [3.7483e+05, 3.7482e+05, 0.0000e+00, 3.7480e+05, 3.7479e+05, 7.8946e+05,
         3.7484e+05],
        [1.8478e+00, 1.7195e+00, 3.7480e+05, 0.0000e+00, 1.8602e+00, 3.8706e+05,
         1.7697e+00],
        [2.0146e+00, 1.8017e+00, 3.7479e+05, 1.8602e+00, 0.0000e+00, 3.8705e+05,
         1.8123e+00],
        [3.8706e+05, 3.8704e+05, 7.8946e+05, 3.8706e+05, 3.8705e+05, 0.0000e+00,
         3.8704e+05],
        [1.7704e+00, 1.8072e+00, 3.7484e+05, 1.7697e+00, 1.8123e+00, 3.8704e+05,
         0.0000e+00]])
Krum scores: ['1.78', '1.75', '374805.28', '1.78', '1.82', '387040.47', '1.78']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [3, 9, 17, 11, 6, 14, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0016s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:50...
global Accuracy on shared test data: 78.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 47 216]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:50, End: 2025-07-22 15:46:50)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [2, 5, 8, 15, 13, 4, 18], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 1.8934e+00, 1.7121e+00, 3.9232e+05, 3.7115e+05, 1.7362e+00,
         3.9181e+05],
        [1.8934e+00, 0.0000e+00, 1.9010e+00, 3.9233e+05, 3.7116e+05, 1.7766e+00,
         3.9181e+05],
        [1.7121e+00, 1.9010e+00, 0.0000e+00, 3.9236e+05, 3.7115e+05, 1.5724e+00,
         3.9177e+05],
        [3.9232e+05, 3.9233e+05, 3.9236e+05, 0.0000e+00, 7.5956e+05, 3.9236e+05,
         7.6736e+05],
        [3.7115e+05, 3.7116e+05, 3.7115e+05, 7.5956e+05, 0.0000e+00, 3.7115e+05,
         7.4895e+05],
        [1.7362e+00, 1.7766e+00, 1.5724e+00, 3.9236e+05, 3.7115e+05, 0.0000e+00,
         3.9179e+05],
        [3.9181e+05, 3.9181e+05, 3.9177e+05, 7.6736e+05, 7.4895e+05, 3.9179e+05,
         0.0000e+00]])
Krum scores: ['1.72', '1.84', '1.64', '392328.72', '371147.00', '1.65', '391780.09']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [2, 5, 8, 15, 13, 4, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0015s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:51...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:51, End: 2025-07-22 15:46:51)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (4): [3, 7, 2, 9], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 4
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([4])
tensor([[0.0000, 1.7781, 1.7369, 1.7072],
        [1.7781, 0.0000, 1.7063, 1.8873],
        [1.7369, 1.7063, 0.0000, 1.7207],
        [1.7072, 1.8873, 1.7207, 0.0000]])
Krum scores: ['1.72', '1.74', '1.71', '1.71']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']], selected_client_indices: [3, 7, 2, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0012s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:51...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:51, End: 2025-07-22 15:46:51)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [3, 17, 13, 7, 10, 19, 2, 14, 12, 4, 1, 15, 6, 9, 20, 11, 18, 16, 8], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.9302e+05, 4.0113e+05, 1.8662e+00, 1.7976e+00, 3.9607e+05,
         1.9216e+00, 3.8563e+05, 1.6770e+00, 1.8404e+00, 1.9338e+00, 3.9761e+05,
         2.0433e+00, 1.8393e+00, 3.9565e+05, 1.9159e+00, 3.7397e+05, 3.9019e+05,
         1.8054e+00],
        [3.9302e+05, 0.0000e+00, 7.8571e+05, 3.9302e+05, 3.9301e+05, 8.0607e+05,
         3.9302e+05, 7.8338e+05, 3.9305e+05, 3.9305e+05, 3.9304e+05, 7.8965e+05,
         3.9305e+05, 3.9302e+05, 7.9464e+05, 3.9307e+05, 7.7785e+05, 7.9744e+05,
         3.9300e+05],
        [4.0113e+05, 7.8571e+05, 0.0000e+00, 4.0111e+05, 4.0113e+05, 8.4725e+05,
         4.0109e+05, 7.8885e+05, 4.0115e+05, 4.0113e+05, 4.0112e+05, 8.0140e+05,
         4.0111e+05, 4.0109e+05, 7.7367e+05, 4.0112e+05, 7.8135e+05, 7.8750e+05,
         4.0113e+05],
        [1.8662e+00, 3.9302e+05, 4.0111e+05, 0.0000e+00, 1.7865e+00, 3.9606e+05,
         1.8402e+00, 3.8563e+05, 1.8163e+00, 1.7487e+00, 1.7954e+00, 3.9762e+05,
         2.0482e+00, 1.9306e+00, 3.9570e+05, 1.7865e+00, 3.7398e+05, 3.9022e+05,
         1.8637e+00],
        [1.7976e+00, 3.9301e+05, 4.0113e+05, 1.7865e+00, 0.0000e+00, 3.9607e+05,
         1.7381e+00, 3.8566e+05, 1.7100e+00, 2.0130e+00, 1.7934e+00, 3.9765e+05,
         2.0979e+00, 1.7007e+00, 3.9569e+05, 1.9146e+00, 3.7393e+05, 3.9022e+05,
         1.7089e+00],
        [3.9607e+05, 8.0607e+05, 8.4725e+05, 3.9606e+05, 3.9607e+05, 0.0000e+00,
         3.9606e+05, 7.7871e+05, 3.9607e+05, 3.9608e+05, 3.9607e+05, 7.7156e+05,
         3.9610e+05, 3.9606e+05, 8.1930e+05, 3.9610e+05, 7.6388e+05, 8.0072e+05,
         3.9607e+05],
        [1.9216e+00, 3.9302e+05, 4.0109e+05, 1.8402e+00, 1.7381e+00, 3.9606e+05,
         0.0000e+00, 3.8564e+05, 1.9395e+00, 2.0543e+00, 1.8590e+00, 3.9759e+05,
         1.9808e+00, 1.7803e+00, 3.9568e+05, 2.0428e+00, 3.7395e+05, 3.9018e+05,
         1.8135e+00],
        [3.8563e+05, 7.8338e+05, 7.8885e+05, 3.8563e+05, 3.8566e+05, 7.7871e+05,
         3.8564e+05, 0.0000e+00, 3.8562e+05, 3.8566e+05, 3.8562e+05, 7.9174e+05,
         3.8564e+05, 3.8564e+05, 7.9157e+05, 3.8563e+05, 7.5475e+05, 7.9329e+05,
         3.8564e+05],
        [1.6770e+00, 3.9305e+05, 4.0115e+05, 1.8163e+00, 1.7100e+00, 3.9607e+05,
         1.9395e+00, 3.8562e+05, 0.0000e+00, 1.7811e+00, 1.8592e+00, 3.9763e+05,
         2.0227e+00, 1.8443e+00, 3.9570e+05, 1.8243e+00, 3.7394e+05, 3.9018e+05,
         1.8895e+00],
        [1.8404e+00, 3.9305e+05, 4.0113e+05, 1.7487e+00, 2.0130e+00, 3.9608e+05,
         2.0543e+00, 3.8566e+05, 1.7811e+00, 0.0000e+00, 1.8831e+00, 3.9762e+05,
         1.7820e+00, 1.9317e+00, 3.9566e+05, 1.6644e+00, 3.7396e+05, 3.9020e+05,
         1.8403e+00],
        [1.9338e+00, 3.9304e+05, 4.0112e+05, 1.7954e+00, 1.7934e+00, 3.9607e+05,
         1.8590e+00, 3.8562e+05, 1.8592e+00, 1.8831e+00, 0.0000e+00, 3.9760e+05,
         1.7990e+00, 1.7979e+00, 3.9569e+05, 1.8021e+00, 3.7395e+05, 3.9019e+05,
         1.9222e+00],
        [3.9761e+05, 7.8965e+05, 8.0140e+05, 3.9762e+05, 3.9765e+05, 7.7156e+05,
         3.9759e+05, 7.9174e+05, 3.9763e+05, 3.9762e+05, 3.9760e+05, 0.0000e+00,
         3.9760e+05, 3.9762e+05, 7.8613e+05, 3.9762e+05, 7.7846e+05, 7.7833e+05,
         3.9763e+05],
        [2.0433e+00, 3.9305e+05, 4.0111e+05, 2.0482e+00, 2.0979e+00, 3.9610e+05,
         1.9808e+00, 3.8564e+05, 2.0227e+00, 1.7820e+00, 1.7990e+00, 3.9760e+05,
         0.0000e+00, 1.9295e+00, 3.9572e+05, 1.9124e+00, 3.7396e+05, 3.9018e+05,
         1.8775e+00],
        [1.8393e+00, 3.9302e+05, 4.0109e+05, 1.9306e+00, 1.7007e+00, 3.9606e+05,
         1.7803e+00, 3.8564e+05, 1.8443e+00, 1.9317e+00, 1.7979e+00, 3.9762e+05,
         1.9295e+00, 0.0000e+00, 3.9572e+05, 1.7147e+00, 3.7396e+05, 3.9019e+05,
         1.7465e+00],
        [3.9565e+05, 7.9464e+05, 7.7367e+05, 3.9570e+05, 3.9569e+05, 8.1930e+05,
         3.9568e+05, 7.9157e+05, 3.9570e+05, 3.9566e+05, 3.9569e+05, 7.8613e+05,
         3.9572e+05, 3.9572e+05, 0.0000e+00, 3.9567e+05, 7.5891e+05, 7.9171e+05,
         3.9568e+05],
        [1.9159e+00, 3.9307e+05, 4.0112e+05, 1.7865e+00, 1.9146e+00, 3.9610e+05,
         2.0428e+00, 3.8563e+05, 1.8243e+00, 1.6644e+00, 1.8021e+00, 3.9762e+05,
         1.9124e+00, 1.7147e+00, 3.9567e+05, 0.0000e+00, 3.7395e+05, 3.9023e+05,
         1.7987e+00],
        [3.7397e+05, 7.7785e+05, 7.8135e+05, 3.7398e+05, 3.7393e+05, 7.6388e+05,
         3.7395e+05, 7.5475e+05, 3.7394e+05, 3.7396e+05, 3.7395e+05, 7.7846e+05,
         3.7396e+05, 3.7396e+05, 7.5891e+05, 3.7395e+05, 0.0000e+00, 7.5490e+05,
         3.7395e+05],
        [3.9019e+05, 7.9744e+05, 7.8750e+05, 3.9022e+05, 3.9022e+05, 8.0072e+05,
         3.9018e+05, 7.9329e+05, 3.9018e+05, 3.9020e+05, 3.9019e+05, 7.7833e+05,
         3.9018e+05, 3.9019e+05, 7.9171e+05, 3.9023e+05, 7.5490e+05, 0.0000e+00,
         3.9023e+05],
        [1.8054e+00, 3.9300e+05, 4.0113e+05, 1.8637e+00, 1.7089e+00, 3.9607e+05,
         1.8135e+00, 3.8564e+05, 1.8895e+00, 1.8403e+00, 1.9222e+00, 3.9763e+05,
         1.8775e+00, 1.7465e+00, 3.9568e+05, 1.7987e+00, 3.7395e+05, 3.9023e+05,
         0.0000e+00]])
Krum scores: ['1.84', '393025.84', '401112.81', '1.83', '1.80', '396069.12', '1.88', '385632.75', '1.82', '1.83', '1.83', '397611.12', '1.93', '1.81', '395680.72', '1.81', '373950.84', '390194.00', '1.82']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [3, 17, 13, 7, 10, 19, 2, 14, 12, 4, 1, 15, 6, 9, 20, 11, 18, 16, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:52...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:52, End: 2025-07-22 15:46:52)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [14, 8, 11, 19, 2, 6, 7, 20, 9, 13, 17, 12, 16, 1, 3, 10, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 4.0171e+05, 4.0175e+05, 8.0146e+05, 4.0171e+05, 4.0171e+05,
         4.0169e+05, 7.8682e+05, 4.0171e+05, 8.0635e+05, 7.7712e+05, 4.0171e+05,
         8.0087e+05, 4.0171e+05, 4.0171e+05, 4.0176e+05, 7.9701e+05],
        [4.0171e+05, 0.0000e+00, 1.5204e+00, 3.9418e+05, 1.4745e+00, 1.5804e+00,
         1.5854e+00, 3.8791e+05, 1.5094e+00, 3.9767e+05, 4.0880e+05, 1.5866e+00,
         3.8936e+05, 1.5701e+00, 1.5218e+00, 1.7092e+00, 3.8369e+05],
        [4.0175e+05, 1.5204e+00, 0.0000e+00, 3.9416e+05, 1.6904e+00, 1.6237e+00,
         1.5548e+00, 3.8796e+05, 1.5009e+00, 3.9770e+05, 4.0879e+05, 1.5562e+00,
         3.8934e+05, 1.5055e+00, 1.6307e+00, 1.9468e+00, 3.8368e+05],
        [8.0146e+05, 3.9418e+05, 3.9416e+05, 0.0000e+00, 3.9417e+05, 3.9416e+05,
         3.9416e+05, 7.8297e+05, 3.9420e+05, 8.0236e+05, 7.9265e+05, 3.9420e+05,
         7.7154e+05, 3.9417e+05, 3.9419e+05, 3.9418e+05, 7.6999e+05],
        [4.0171e+05, 1.4745e+00, 1.6904e+00, 3.9417e+05, 0.0000e+00, 1.6275e+00,
         1.5679e+00, 3.8792e+05, 1.4940e+00, 3.9766e+05, 4.0884e+05, 1.6072e+00,
         3.8934e+05, 1.5370e+00, 1.5517e+00, 1.6421e+00, 3.8368e+05],
        [4.0171e+05, 1.5804e+00, 1.6237e+00, 3.9416e+05, 1.6275e+00, 0.0000e+00,
         1.7252e+00, 3.8791e+05, 1.6839e+00, 3.9767e+05, 4.0880e+05, 1.7148e+00,
         3.8936e+05, 1.5067e+00, 1.7227e+00, 2.1673e+00, 3.8366e+05],
        [4.0169e+05, 1.5854e+00, 1.5548e+00, 3.9416e+05, 1.5679e+00, 1.7252e+00,
         0.0000e+00, 3.8792e+05, 1.7171e+00, 3.9769e+05, 4.0881e+05, 1.6238e+00,
         3.8935e+05, 1.5408e+00, 1.6502e+00, 1.9474e+00, 3.8372e+05],
        [7.8682e+05, 3.8791e+05, 3.8796e+05, 7.8297e+05, 3.8792e+05, 3.8791e+05,
         3.8792e+05, 0.0000e+00, 3.8790e+05, 8.0875e+05, 7.8807e+05, 3.8792e+05,
         7.6487e+05, 3.8793e+05, 3.8790e+05, 3.8789e+05, 7.8727e+05],
        [4.0171e+05, 1.5094e+00, 1.5009e+00, 3.9420e+05, 1.4940e+00, 1.6839e+00,
         1.7171e+00, 3.8790e+05, 0.0000e+00, 3.9767e+05, 4.0879e+05, 1.6162e+00,
         3.8935e+05, 1.5717e+00, 1.5274e+00, 1.5909e+00, 3.8366e+05],
        [8.0635e+05, 3.9767e+05, 3.9770e+05, 8.0236e+05, 3.9766e+05, 3.9767e+05,
         3.9769e+05, 8.0875e+05, 3.9767e+05, 0.0000e+00, 8.3609e+05, 3.9771e+05,
         7.8969e+05, 3.9767e+05, 3.9770e+05, 3.9769e+05, 7.6013e+05],
        [7.7712e+05, 4.0880e+05, 4.0879e+05, 7.9265e+05, 4.0884e+05, 4.0880e+05,
         4.0881e+05, 7.8807e+05, 4.0879e+05, 8.3609e+05, 0.0000e+00, 4.0882e+05,
         7.9004e+05, 4.0878e+05, 4.0883e+05, 4.0878e+05, 7.8230e+05],
        [4.0171e+05, 1.5866e+00, 1.5562e+00, 3.9420e+05, 1.6072e+00, 1.7148e+00,
         1.6238e+00, 3.8792e+05, 1.6162e+00, 3.9771e+05, 4.0882e+05, 0.0000e+00,
         3.8932e+05, 1.5887e+00, 1.4405e+00, 1.8223e+00, 3.8370e+05],
        [8.0087e+05, 3.8936e+05, 3.8934e+05, 7.7154e+05, 3.8934e+05, 3.8936e+05,
         3.8935e+05, 7.6487e+05, 3.8935e+05, 7.8969e+05, 7.9004e+05, 3.8932e+05,
         0.0000e+00, 3.8937e+05, 3.8934e+05, 3.8939e+05, 7.7916e+05],
        [4.0171e+05, 1.5701e+00, 1.5055e+00, 3.9417e+05, 1.5370e+00, 1.5067e+00,
         1.5408e+00, 3.8793e+05, 1.5717e+00, 3.9767e+05, 4.0878e+05, 1.5887e+00,
         3.8937e+05, 0.0000e+00, 1.6483e+00, 1.8357e+00, 3.8368e+05],
        [4.0171e+05, 1.5218e+00, 1.6307e+00, 3.9419e+05, 1.5517e+00, 1.7227e+00,
         1.6502e+00, 3.8790e+05, 1.5274e+00, 3.9770e+05, 4.0883e+05, 1.4405e+00,
         3.8934e+05, 1.6483e+00, 0.0000e+00, 1.8444e+00, 3.8369e+05],
        [4.0176e+05, 1.7092e+00, 1.9468e+00, 3.9418e+05, 1.6421e+00, 2.1673e+00,
         1.9474e+00, 3.8789e+05, 1.5909e+00, 3.9769e+05, 4.0878e+05, 1.8223e+00,
         3.8939e+05, 1.8357e+00, 1.8444e+00, 0.0000e+00, 3.8367e+05],
        [7.9701e+05, 3.8369e+05, 3.8368e+05, 7.6999e+05, 3.8368e+05, 3.8366e+05,
         3.8372e+05, 7.8727e+05, 3.8366e+05, 7.6013e+05, 7.8230e+05, 3.8370e+05,
         7.7916e+05, 3.8368e+05, 3.8369e+05, 3.8367e+05, 0.0000e+00]])
Krum scores: ['401708.78', '1.54', '1.57', '394170.12', '1.56', '1.65', '1.62', '387907.22', '1.56', '397677.00', '408795.31', '1.59', '389345.31', '1.56', '1.59', '1.79', '383677.44']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [14, 8, 11, 19, 2, 6, 7, 20, 9, 13, 17, 12, 16, 1, 3, 10, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:52...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:52, End: 2025-07-22 15:46:52)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [15, 9, 20, 14, 3, 7, 2, 12, 11, 8, 5, 16, 18, 10, 17, 6, 4, 19, 13], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 4.1070e+05, 8.0367e+05, 8.4179e+05, 4.1072e+05, 4.1072e+05,
         4.1072e+05, 4.1074e+05, 4.1070e+05, 4.1069e+05, 4.1073e+05, 8.1370e+05,
         7.8518e+05, 4.1071e+05, 8.0274e+05, 4.1068e+05, 4.1068e+05, 8.0679e+05,
         8.0852e+05],
        [4.1070e+05, 0.0000e+00, 4.0145e+05, 4.1617e+05, 1.5277e+00, 1.6728e+00,
         1.4281e+00, 1.5647e+00, 1.4341e+00, 1.6519e+00, 1.5500e+00, 4.0186e+05,
         3.8991e+05, 1.4265e+00, 3.7546e+05, 1.6423e+00, 1.5975e+00, 3.8603e+05,
         3.8599e+05],
        [8.0367e+05, 4.0145e+05, 0.0000e+00, 8.0373e+05, 4.0147e+05, 4.0150e+05,
         4.0146e+05, 4.0147e+05, 4.0151e+05, 4.0151e+05, 4.0148e+05, 7.9945e+05,
         8.0558e+05, 4.0145e+05, 7.8877e+05, 4.0144e+05, 4.0150e+05, 7.8147e+05,
         7.9521e+05],
        [8.4179e+05, 4.1617e+05, 8.0373e+05, 0.0000e+00, 4.1616e+05, 4.1613e+05,
         4.1615e+05, 4.1615e+05, 4.1615e+05, 4.1615e+05, 4.1615e+05, 8.0761e+05,
         8.1892e+05, 4.1616e+05, 8.0363e+05, 4.1612e+05, 4.1613e+05, 8.2027e+05,
         8.1491e+05],
        [4.1072e+05, 1.5277e+00, 4.0147e+05, 4.1616e+05, 0.0000e+00, 1.6365e+00,
         1.5872e+00, 1.5181e+00, 1.6245e+00, 1.7900e+00, 1.5128e+00, 4.0188e+05,
         3.8989e+05, 1.6976e+00, 3.7545e+05, 1.7438e+00, 1.6242e+00, 3.8604e+05,
         3.8598e+05],
        [4.1072e+05, 1.6728e+00, 4.0150e+05, 4.1613e+05, 1.6365e+00, 0.0000e+00,
         1.5344e+00, 1.6531e+00, 1.5289e+00, 1.8114e+00, 1.5413e+00, 4.0192e+05,
         3.8991e+05, 1.7666e+00, 3.7545e+05, 1.7117e+00, 1.5059e+00, 3.8603e+05,
         3.8592e+05],
        [4.1072e+05, 1.4281e+00, 4.0146e+05, 4.1615e+05, 1.5872e+00, 1.5344e+00,
         0.0000e+00, 1.6263e+00, 1.6496e+00, 1.5976e+00, 1.6598e+00, 4.0190e+05,
         3.8991e+05, 1.4741e+00, 3.7545e+05, 1.6361e+00, 1.7314e+00, 3.8601e+05,
         3.8595e+05],
        [4.1074e+05, 1.5647e+00, 4.0147e+05, 4.1615e+05, 1.5181e+00, 1.6531e+00,
         1.6263e+00, 0.0000e+00, 1.5256e+00, 1.8010e+00, 1.5347e+00, 4.0192e+05,
         3.8994e+05, 1.6193e+00, 3.7547e+05, 1.7542e+00, 1.6135e+00, 3.8602e+05,
         3.8593e+05],
        [4.1070e+05, 1.4341e+00, 4.0151e+05, 4.1615e+05, 1.6245e+00, 1.5289e+00,
         1.6496e+00, 1.5256e+00, 0.0000e+00, 1.7497e+00, 1.4931e+00, 4.0190e+05,
         3.8992e+05, 1.7626e+00, 3.7542e+05, 1.6551e+00, 1.4125e+00, 3.8604e+05,
         3.8593e+05],
        [4.1069e+05, 1.6519e+00, 4.0151e+05, 4.1615e+05, 1.7900e+00, 1.8114e+00,
         1.5976e+00, 1.8010e+00, 1.7497e+00, 0.0000e+00, 1.7267e+00, 4.0189e+05,
         3.8996e+05, 1.5368e+00, 3.7547e+05, 1.8814e+00, 1.8986e+00, 3.8598e+05,
         3.8595e+05],
        [4.1073e+05, 1.5500e+00, 4.0148e+05, 4.1615e+05, 1.5128e+00, 1.5413e+00,
         1.6598e+00, 1.5347e+00, 1.4931e+00, 1.7267e+00, 0.0000e+00, 4.0191e+05,
         3.8994e+05, 1.5976e+00, 3.7543e+05, 1.7579e+00, 1.6915e+00, 3.8603e+05,
         3.8592e+05],
        [8.1370e+05, 4.0186e+05, 7.9945e+05, 8.0761e+05, 4.0188e+05, 4.0192e+05,
         4.0190e+05, 4.0192e+05, 4.0190e+05, 4.0189e+05, 4.0191e+05, 0.0000e+00,
         7.8539e+05, 4.0191e+05, 7.7113e+05, 4.0191e+05, 4.0187e+05, 8.0515e+05,
         7.9797e+05],
        [7.8518e+05, 3.8991e+05, 8.0558e+05, 8.1892e+05, 3.8989e+05, 3.8991e+05,
         3.8991e+05, 3.8994e+05, 3.8992e+05, 3.8996e+05, 3.8994e+05, 7.8539e+05,
         0.0000e+00, 3.8992e+05, 7.4032e+05, 3.8991e+05, 3.8991e+05, 7.8480e+05,
         7.8422e+05],
        [4.1071e+05, 1.4265e+00, 4.0145e+05, 4.1616e+05, 1.6976e+00, 1.7666e+00,
         1.4741e+00, 1.6193e+00, 1.7626e+00, 1.5368e+00, 1.5976e+00, 4.0191e+05,
         3.8992e+05, 0.0000e+00, 3.7546e+05, 1.9638e+00, 1.9726e+00, 3.8600e+05,
         3.8595e+05],
        [8.0274e+05, 3.7546e+05, 7.8877e+05, 8.0363e+05, 3.7545e+05, 3.7545e+05,
         3.7545e+05, 3.7547e+05, 3.7542e+05, 3.7547e+05, 3.7543e+05, 7.7113e+05,
         7.4032e+05, 3.7546e+05, 0.0000e+00, 3.7543e+05, 3.7543e+05, 7.4639e+05,
         7.7060e+05],
        [4.1068e+05, 1.6423e+00, 4.0144e+05, 4.1612e+05, 1.7438e+00, 1.7117e+00,
         1.6361e+00, 1.7542e+00, 1.6551e+00, 1.8814e+00, 1.7579e+00, 4.0191e+05,
         3.8991e+05, 1.9638e+00, 3.7543e+05, 0.0000e+00, 1.5014e+00, 3.8605e+05,
         3.8599e+05],
        [4.1068e+05, 1.5975e+00, 4.0150e+05, 4.1613e+05, 1.6242e+00, 1.5059e+00,
         1.7314e+00, 1.6135e+00, 1.4125e+00, 1.8986e+00, 1.6915e+00, 4.0187e+05,
         3.8991e+05, 1.9726e+00, 3.7543e+05, 1.5014e+00, 0.0000e+00, 3.8602e+05,
         3.8598e+05],
        [8.0679e+05, 3.8603e+05, 7.8147e+05, 8.2027e+05, 3.8604e+05, 3.8603e+05,
         3.8601e+05, 3.8602e+05, 3.8604e+05, 3.8598e+05, 3.8603e+05, 8.0515e+05,
         7.8480e+05, 3.8600e+05, 7.4639e+05, 3.8605e+05, 3.8602e+05, 0.0000e+00,
         7.8776e+05],
        [8.0852e+05, 3.8599e+05, 7.9521e+05, 8.1491e+05, 3.8598e+05, 3.8592e+05,
         3.8595e+05, 3.8593e+05, 3.8593e+05, 3.8595e+05, 3.8592e+05, 7.9797e+05,
         7.8422e+05, 3.8595e+05, 7.7060e+05, 3.8599e+05, 3.8598e+05, 7.8776e+05,
         0.0000e+00]])
Krum scores: ['410701.44', '1.54', '401469.25', '416142.53', '1.61', '1.62', '1.58', '1.60', '1.56', '1.73', '1.59', '401893.28', '389912.56', '1.65', '375444.94', '1.70', '1.62', '386016.31', '385946.44']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [15, 9, 20, 14, 3, 7, 2, 12, 11, 8, 5, 16, 18, 10, 17, 6, 4, 19, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:53...
global Accuracy on shared test data: 78.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 44 219]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:53, End: 2025-07-22 15:46:53)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [16], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
tensor([[0.]])
Krum scores: ['nan']
Selected index: 0
krum, clients_type: [['Chosen Update']], selected_client_indices: [16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:53...
global Accuracy on shared test data: 51.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[109 128]
 [117 146]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:46:53, End: 2025-07-22 15:46:53)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [17, 6, 16, 13, 20, 12, 11, 19, 5, 14, 4, 10, 7, 3, 8, 2], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8444e+05, 7.4938e+05, 7.7076e+05, 7.6512e+05, 3.8444e+05,
         3.8443e+05, 7.9216e+05, 3.8448e+05, 7.9322e+05, 3.8447e+05, 3.8446e+05,
         3.8448e+05, 3.8444e+05, 3.8448e+05, 3.8447e+05],
        [3.8444e+05, 0.0000e+00, 3.7263e+05, 3.8667e+05, 3.8467e+05, 3.5346e+00,
         3.4288e+00, 3.8926e+05, 3.5768e+00, 4.0826e+05, 3.1382e+00, 3.5972e+00,
         3.4848e+00, 3.7608e+00, 3.5981e+00, 3.7311e+00],
        [7.4938e+05, 3.7263e+05, 0.0000e+00, 7.4830e+05, 7.6337e+05, 3.7267e+05,
         3.7269e+05, 7.7414e+05, 3.7269e+05, 7.8879e+05, 3.7266e+05, 3.7265e+05,
         3.7266e+05, 3.7264e+05, 3.7266e+05, 3.7265e+05],
        [7.7076e+05, 3.8667e+05, 7.4830e+05, 0.0000e+00, 7.7480e+05, 3.8664e+05,
         3.8667e+05, 7.5936e+05, 3.8663e+05, 8.1141e+05, 3.8666e+05, 3.8665e+05,
         3.8663e+05, 3.8662e+05, 3.8671e+05, 3.8666e+05],
        [7.6512e+05, 3.8467e+05, 7.6337e+05, 7.7480e+05, 0.0000e+00, 3.8471e+05,
         3.8466e+05, 7.7414e+05, 3.8468e+05, 7.9934e+05, 3.8470e+05, 3.8465e+05,
         3.8468e+05, 3.8465e+05, 3.8468e+05, 3.8470e+05],
        [3.8444e+05, 3.5346e+00, 3.7267e+05, 3.8664e+05, 3.8471e+05, 0.0000e+00,
         3.1458e+00, 3.8923e+05, 3.6750e+00, 4.0830e+05, 3.1866e+00, 3.5456e+00,
         3.6103e+00, 3.9479e+00, 3.3392e+00, 2.9512e+00],
        [3.8443e+05, 3.4288e+00, 3.7269e+05, 3.8667e+05, 3.8466e+05, 3.1458e+00,
         0.0000e+00, 3.8927e+05, 3.7219e+00, 4.0826e+05, 3.3295e+00, 3.7325e+00,
         3.4576e+00, 3.9693e+00, 3.4378e+00, 3.5389e+00],
        [7.9216e+05, 3.8926e+05, 7.7414e+05, 7.5936e+05, 7.7414e+05, 3.8923e+05,
         3.8927e+05, 0.0000e+00, 3.8930e+05, 8.1143e+05, 3.8927e+05, 3.8925e+05,
         3.8929e+05, 3.8929e+05, 3.8927e+05, 3.8921e+05],
        [3.8448e+05, 3.5768e+00, 3.7269e+05, 3.8663e+05, 3.8468e+05, 3.6750e+00,
         3.7219e+00, 3.8930e+05, 0.0000e+00, 4.0831e+05, 3.3127e+00, 3.9228e+00,
         3.4483e+00, 3.6376e+00, 3.9768e+00, 3.5369e+00],
        [7.9322e+05, 4.0826e+05, 7.8879e+05, 8.1141e+05, 7.9934e+05, 4.0830e+05,
         4.0826e+05, 8.1143e+05, 4.0831e+05, 0.0000e+00, 4.0830e+05, 4.0832e+05,
         4.0831e+05, 4.0834e+05, 4.0830e+05, 4.0830e+05],
        [3.8447e+05, 3.1382e+00, 3.7266e+05, 3.8666e+05, 3.8470e+05, 3.1866e+00,
         3.3295e+00, 3.8927e+05, 3.3127e+00, 4.0830e+05, 0.0000e+00, 3.4449e+00,
         3.3645e+00, 3.5240e+00, 3.5606e+00, 3.1477e+00],
        [3.8446e+05, 3.5972e+00, 3.7265e+05, 3.8665e+05, 3.8465e+05, 3.5456e+00,
         3.7325e+00, 3.8925e+05, 3.9228e+00, 4.0832e+05, 3.4449e+00, 0.0000e+00,
         3.7673e+00, 3.6353e+00, 3.5056e+00, 3.5178e+00],
        [3.8448e+05, 3.4848e+00, 3.7266e+05, 3.8663e+05, 3.8468e+05, 3.6103e+00,
         3.4576e+00, 3.8929e+05, 3.4483e+00, 4.0831e+05, 3.3645e+00, 3.7673e+00,
         0.0000e+00, 3.6517e+00, 3.6972e+00, 3.4124e+00],
        [3.8444e+05, 3.7608e+00, 3.7264e+05, 3.8662e+05, 3.8465e+05, 3.9479e+00,
         3.9693e+00, 3.8929e+05, 3.6376e+00, 4.0834e+05, 3.5240e+00, 3.6353e+00,
         3.6517e+00, 0.0000e+00, 3.9594e+00, 3.5474e+00],
        [3.8448e+05, 3.5981e+00, 3.7266e+05, 3.8671e+05, 3.8468e+05, 3.3392e+00,
         3.4378e+00, 3.8927e+05, 3.9768e+00, 4.0830e+05, 3.5606e+00, 3.5056e+00,
         3.6972e+00, 3.9594e+00, 0.0000e+00, 3.4057e+00],
        [3.8447e+05, 3.7311e+00, 3.7265e+05, 3.8666e+05, 3.8470e+05, 2.9512e+00,
         3.5389e+00, 3.8921e+05, 3.5369e+00, 4.0830e+05, 3.1477e+00, 3.5178e+00,
         3.4124e+00, 3.5474e+00, 3.4057e+00, 0.0000e+00]])
Krum scores: ['384455.59', '3.51', '372652.84', '386646.56', '384670.47', '3.37', '3.47', '389257.44', '3.60', '408292.41', '3.31', '3.59', '3.52', '3.71', '3.56', '3.38']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [17, 6, 16, 13, 20, 12, 11, 19, 5, 14, 4, 10, 7, 3, 8, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0039s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:54...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[105 132]
 [114 149]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:54, End: 2025-07-22 15:46:54)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [19, 20], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[     0.0000, 761668.9375],
        [761668.9375,      0.0000]])
Krum scores: ['nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [19, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0008s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:54...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[154  83]
 [169  94]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:54, End: 2025-07-22 15:46:54)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [10, 3, 16, 20, 9, 8, 14], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 3.1210e+00, 3.9112e+05, 3.9323e+05, 3.5382e+00, 3.4982e+00,
         3.9745e+05],
        [3.1210e+00, 0.0000e+00, 3.9106e+05, 3.9329e+05, 3.1292e+00, 3.5454e+00,
         3.9741e+05],
        [3.9112e+05, 3.9106e+05, 0.0000e+00, 7.8234e+05, 3.9102e+05, 3.9106e+05,
         8.0109e+05],
        [3.9323e+05, 3.9329e+05, 7.8234e+05, 0.0000e+00, 3.9330e+05, 3.9323e+05,
         7.9929e+05],
        [3.5382e+00, 3.1292e+00, 3.9102e+05, 3.9330e+05, 0.0000e+00, 3.5896e+00,
         3.9748e+05],
        [3.4982e+00, 3.5454e+00, 3.9106e+05, 3.9323e+05, 3.5896e+00, 0.0000e+00,
         3.9747e+05],
        [3.9745e+05, 3.9741e+05, 8.0109e+05, 7.9929e+05, 3.9748e+05, 3.9747e+05,
         0.0000e+00]])
Krum scores: ['3.31', '3.13', '391036.16', '393231.84', '3.33', '3.52', '397427.38']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [10, 3, 16, 20, 9, 8, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0016s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:54...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[151  86]
 [162 101]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:54, End: 2025-07-22 15:46:54)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [16, 15, 4], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[     0.0000, 797886.7500, 394876.3750],
        [797886.7500,      0.0000, 400147.5312],
        [394876.3750, 400147.5312,      0.0000]])
Krum scores: ['nan', 'nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']], selected_client_indices: [16, 15, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0010s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:54...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[197  40]
 [218  45]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:54, End: 2025-07-22 15:46:54)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [20, 8, 18, 19, 5, 3, 11, 10, 15, 16, 1, 9, 17], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.7853e+05, 7.7660e+05, 7.6200e+05, 3.7855e+05, 3.7845e+05,
         3.7851e+05, 3.7849e+05, 7.6165e+05, 7.8312e+05, 3.7853e+05, 3.7850e+05,
         7.9979e+05],
        [3.7853e+05, 0.0000e+00, 3.8525e+05, 4.0257e+05, 3.7053e+00, 3.2924e+00,
         3.1752e+00, 3.5047e+00, 3.8699e+05, 3.9469e+05, 3.7213e+00, 3.4669e+00,
         4.1159e+05],
        [7.7660e+05, 3.8525e+05, 0.0000e+00, 7.9027e+05, 3.8520e+05, 3.8518e+05,
         3.8525e+05, 3.8527e+05, 7.9691e+05, 7.7229e+05, 3.8525e+05, 3.8523e+05,
         7.8656e+05],
        [7.6200e+05, 4.0257e+05, 7.9027e+05, 0.0000e+00, 4.0256e+05, 4.0252e+05,
         4.0254e+05, 4.0254e+05, 7.7651e+05, 8.1761e+05, 4.0257e+05, 4.0255e+05,
         8.1337e+05],
        [3.7855e+05, 3.7053e+00, 3.8520e+05, 4.0256e+05, 0.0000e+00, 3.1037e+00,
         3.0765e+00, 3.2964e+00, 3.8697e+05, 3.9465e+05, 3.4405e+00, 3.5790e+00,
         4.1152e+05],
        [3.7845e+05, 3.2924e+00, 3.8518e+05, 4.0252e+05, 3.1037e+00, 0.0000e+00,
         3.0524e+00, 3.1841e+00, 3.8697e+05, 3.9468e+05, 3.0831e+00, 3.2810e+00,
         4.1156e+05],
        [3.7851e+05, 3.1752e+00, 3.8525e+05, 4.0254e+05, 3.0765e+00, 3.0524e+00,
         0.0000e+00, 3.0763e+00, 3.8696e+05, 3.9466e+05, 3.3861e+00, 3.4595e+00,
         4.1154e+05],
        [3.7849e+05, 3.5047e+00, 3.8527e+05, 4.0254e+05, 3.2964e+00, 3.1841e+00,
         3.0763e+00, 0.0000e+00, 3.8700e+05, 3.9464e+05, 3.4214e+00, 3.6760e+00,
         4.1158e+05],
        [7.6165e+05, 3.8699e+05, 7.9691e+05, 7.7651e+05, 3.8697e+05, 3.8697e+05,
         3.8696e+05, 3.8700e+05, 0.0000e+00, 7.8751e+05, 3.8700e+05, 3.8700e+05,
         8.1884e+05],
        [7.8312e+05, 3.9469e+05, 7.7229e+05, 8.1761e+05, 3.9465e+05, 3.9468e+05,
         3.9466e+05, 3.9464e+05, 7.8751e+05, 0.0000e+00, 3.9462e+05, 3.9463e+05,
         8.0265e+05],
        [3.7853e+05, 3.7213e+00, 3.8525e+05, 4.0257e+05, 3.4405e+00, 3.0831e+00,
         3.3861e+00, 3.4214e+00, 3.8700e+05, 3.9462e+05, 0.0000e+00, 3.4857e+00,
         4.1154e+05],
        [3.7850e+05, 3.4669e+00, 3.8523e+05, 4.0255e+05, 3.5790e+00, 3.2810e+00,
         3.4595e+00, 3.6760e+00, 3.8700e+05, 3.9463e+05, 3.4857e+00, 0.0000e+00,
         4.1156e+05],
        [7.9979e+05, 4.1159e+05, 7.8656e+05, 8.1337e+05, 4.1152e+05, 4.1156e+05,
         4.1154e+05, 4.1158e+05, 8.1884e+05, 8.0265e+05, 4.1154e+05, 4.1156e+05,
         0.0000e+00]])
Krum scores: ['378495.56', '3.43', '385220.94', '402542.28', '3.30', '3.14', '3.15', '3.30', '386978.34', '394641.72', '3.36', '3.45', '411545.75']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [20, 8, 18, 19, 5, 3, 11, 10, 15, 16, 1, 9, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0027s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:55...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[193  44]
 [215  48]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:55, End: 2025-07-22 15:46:55)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [17, 18, 4, 15, 2], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
tensor([[0.0000e+00, 7.9176e+05, 3.9266e+05, 8.0146e+05, 3.9270e+05],
        [7.9176e+05, 0.0000e+00, 3.8979e+05, 7.7135e+05, 3.8977e+05],
        [3.9266e+05, 3.8979e+05, 0.0000e+00, 4.0021e+05, 3.3608e+00],
        [8.0146e+05, 7.7135e+05, 4.0021e+05, 0.0000e+00, 4.0020e+05],
        [3.9270e+05, 3.8977e+05, 3.3608e+00, 4.0020e+05, 0.0000e+00]])
Krum scores: ['nan', 'nan', 'nan', 'nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']], selected_client_indices: [17, 18, 4, 15, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0012s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:55...
global Accuracy on shared test data: 44.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[187  50]
 [229  34]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:55, End: 2025-07-22 15:46:55)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [16, 17, 10, 20, 2, 9, 7, 5, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 7.7276e+05, 3.9748e+05, 7.9028e+05, 3.9749e+05, 3.9753e+05,
         3.9746e+05, 3.9747e+05, 7.7575e+05],
        [7.7276e+05, 0.0000e+00, 3.8744e+05, 7.8751e+05, 3.8743e+05, 3.8743e+05,
         3.8739e+05, 3.8738e+05, 7.6838e+05],
        [3.9748e+05, 3.8744e+05, 0.0000e+00, 3.8737e+05, 3.2825e+00, 3.5579e+00,
         3.3360e+00, 3.4909e+00, 3.8730e+05],
        [7.9028e+05, 7.8751e+05, 3.8737e+05, 0.0000e+00, 3.8731e+05, 3.8735e+05,
         3.8728e+05, 3.8732e+05, 7.6044e+05],
        [3.9749e+05, 3.8743e+05, 3.2825e+00, 3.8731e+05, 0.0000e+00, 3.3773e+00,
         3.4595e+00, 3.4512e+00, 3.8733e+05],
        [3.9753e+05, 3.8743e+05, 3.5579e+00, 3.8735e+05, 3.3773e+00, 0.0000e+00,
         3.3862e+00, 3.5551e+00, 3.8734e+05],
        [3.9746e+05, 3.8739e+05, 3.3360e+00, 3.8728e+05, 3.4595e+00, 3.3862e+00,
         0.0000e+00, 3.4286e+00, 3.8736e+05],
        [3.9747e+05, 3.8738e+05, 3.4909e+00, 3.8732e+05, 3.4512e+00, 3.5551e+00,
         3.4286e+00, 0.0000e+00, 3.8730e+05],
        [7.7575e+05, 7.6838e+05, 3.8730e+05, 7.6044e+05, 3.8733e+05, 3.8734e+05,
         3.8736e+05, 3.8730e+05, 0.0000e+00]])
Krum scores: ['397472.00', '387400.12', '3.37', '387306.59', '3.37', '3.44', '3.38', '3.46', '387308.34']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [16, 17, 10, 20, 2, 9, 7, 5, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0019s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:55...
global Accuracy on shared test data: 45.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [224  39]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:55, End: 2025-07-22 15:46:55)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [7, 8], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 3.2098],
        [3.2098, 0.0000]])
Krum scores: ['nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [7, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0007s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:55...
global Accuracy on shared test data: 44.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [222  41]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:46:55, End: 2025-07-22 15:46:55)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [10, 2, 7, 4, 13, 9, 14, 18, 11, 12], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.4194e+00, 3.4232e+00, 3.2307e+00, 3.9977e+05, 3.6824e+00,
         3.8667e+05, 3.8191e+05, 3.3944e+00, 3.4468e+00],
        [3.4194e+00, 0.0000e+00, 3.4068e+00, 3.3743e+00, 3.9977e+05, 3.3550e+00,
         3.8665e+05, 3.8192e+05, 3.3624e+00, 3.4509e+00],
        [3.4232e+00, 3.4068e+00, 0.0000e+00, 3.2546e+00, 3.9979e+05, 3.5161e+00,
         3.8667e+05, 3.8192e+05, 3.1428e+00, 3.3866e+00],
        [3.2307e+00, 3.3743e+00, 3.2546e+00, 0.0000e+00, 3.9979e+05, 3.4712e+00,
         3.8663e+05, 3.8192e+05, 3.3362e+00, 3.1906e+00],
        [3.9977e+05, 3.9977e+05, 3.9979e+05, 3.9979e+05, 0.0000e+00, 3.9977e+05,
         7.9540e+05, 7.9879e+05, 3.9978e+05, 3.9978e+05],
        [3.6824e+00, 3.3550e+00, 3.5161e+00, 3.4712e+00, 3.9977e+05, 0.0000e+00,
         3.8663e+05, 3.8192e+05, 3.3706e+00, 3.5110e+00],
        [3.8667e+05, 3.8665e+05, 3.8667e+05, 3.8663e+05, 7.9540e+05, 3.8663e+05,
         0.0000e+00, 7.6152e+05, 3.8667e+05, 3.8668e+05],
        [3.8191e+05, 3.8192e+05, 3.8192e+05, 3.8192e+05, 7.9879e+05, 3.8192e+05,
         7.6152e+05, 0.0000e+00, 3.8192e+05, 3.8188e+05],
        [3.3944e+00, 3.3624e+00, 3.1428e+00, 3.3362e+00, 3.9978e+05, 3.3706e+00,
         3.8667e+05, 3.8192e+05, 0.0000e+00, 3.1857e+00],
        [3.4468e+00, 3.4509e+00, 3.3866e+00, 3.1906e+00, 3.9978e+05, 3.5110e+00,
         3.8668e+05, 3.8188e+05, 3.1857e+00, 0.0000e+00]])
Krum scores: ['3.38', '3.38', '3.32', '3.28', '399772.91', '3.44', '386647.28', '381910.94', '3.28', '3.33']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [10, 2, 7, 4, 13, 9, 14, 18, 11, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0099s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:56...
global Accuracy on shared test data: 43.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [222  41]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:46:56, End: 2025-07-22 15:46:56)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [4], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
tensor([[0.]])
Krum scores: ['nan']
Selected index: 0
krum, clients_type: [['Chosen Update']], selected_client_indices: [4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:56...
global Accuracy on shared test data: 44.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [218  45]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:46:56, End: 2025-07-22 15:46:56)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [11, 14, 5, 20, 3, 8, 6, 7, 13, 1, 19, 15, 4, 18, 12, 2, 9, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.7874e+05, 3.2739e+00, 3.9177e+05, 3.3792e+00, 3.6055e+00,
         3.2610e+00, 3.1633e+00, 3.8354e+05, 3.4600e+00, 3.8536e+05, 3.8821e+05,
         3.3729e+00, 3.9073e+05, 3.1514e+00, 3.3560e+00, 3.4753e+00, 3.5100e+00,
         3.8195e+05],
        [3.7874e+05, 0.0000e+00, 3.7878e+05, 7.7432e+05, 3.7876e+05, 3.7876e+05,
         3.7875e+05, 3.7879e+05, 7.5783e+05, 3.7868e+05, 7.7122e+05, 7.6355e+05,
         3.7875e+05, 7.8108e+05, 3.7875e+05, 3.7875e+05, 3.7868e+05, 3.7874e+05,
         7.9024e+05],
        [3.2739e+00, 3.7878e+05, 0.0000e+00, 3.9175e+05, 3.0470e+00, 4.0532e+00,
         3.6978e+00, 3.3930e+00, 3.8353e+05, 3.6090e+00, 3.8541e+05, 3.8818e+05,
         3.1204e+00, 3.9077e+05, 3.2332e+00, 3.4289e+00, 3.8005e+00, 3.5763e+00,
         3.8194e+05],
        [3.9177e+05, 7.7432e+05, 3.9175e+05, 0.0000e+00, 3.9171e+05, 3.9169e+05,
         3.9172e+05, 3.9171e+05, 7.7831e+05, 3.9175e+05, 7.7536e+05, 7.7217e+05,
         3.9171e+05, 7.8564e+05, 3.9175e+05, 3.9171e+05, 3.9170e+05, 3.9175e+05,
         7.5410e+05],
        [3.3792e+00, 3.7876e+05, 3.0470e+00, 3.9171e+05, 0.0000e+00, 3.7179e+00,
         3.4492e+00, 3.2068e+00, 3.8351e+05, 3.5330e+00, 3.8539e+05, 3.8810e+05,
         3.2941e+00, 3.9079e+05, 3.2780e+00, 3.0851e+00, 3.3862e+00, 3.3904e+00,
         3.8196e+05],
        [3.6055e+00, 3.7876e+05, 4.0532e+00, 3.9169e+05, 3.7179e+00, 0.0000e+00,
         3.2499e+00, 3.3298e+00, 3.8353e+05, 3.7018e+00, 3.8538e+05, 3.8816e+05,
         3.6597e+00, 3.9076e+05, 3.4170e+00, 3.6332e+00, 3.6696e+00, 3.6801e+00,
         3.8196e+05],
        [3.2610e+00, 3.7875e+05, 3.6978e+00, 3.9172e+05, 3.4492e+00, 3.2499e+00,
         0.0000e+00, 3.3790e+00, 3.8348e+05, 3.3650e+00, 3.8535e+05, 3.8820e+05,
         3.4180e+00, 3.9076e+05, 3.5860e+00, 3.3991e+00, 3.5193e+00, 3.4420e+00,
         3.8196e+05],
        [3.1633e+00, 3.7879e+05, 3.3930e+00, 3.9171e+05, 3.2068e+00, 3.3298e+00,
         3.3790e+00, 0.0000e+00, 3.8349e+05, 3.4354e+00, 3.8538e+05, 3.8808e+05,
         3.2681e+00, 3.9078e+05, 3.3730e+00, 3.5141e+00, 3.6866e+00, 3.3908e+00,
         3.8199e+05],
        [3.8354e+05, 7.5783e+05, 3.8353e+05, 7.7831e+05, 3.8351e+05, 3.8353e+05,
         3.8348e+05, 3.8349e+05, 0.0000e+00, 3.8353e+05, 7.5497e+05, 7.8548e+05,
         3.8350e+05, 7.8791e+05, 3.8350e+05, 3.8350e+05, 3.8350e+05, 3.8349e+05,
         7.9440e+05],
        [3.4600e+00, 3.7868e+05, 3.6090e+00, 3.9175e+05, 3.5330e+00, 3.7018e+00,
         3.3650e+00, 3.4354e+00, 3.8353e+05, 0.0000e+00, 3.8534e+05, 3.8813e+05,
         3.4567e+00, 3.9081e+05, 3.6116e+00, 3.4014e+00, 3.4248e+00, 3.4923e+00,
         3.8199e+05],
        [3.8536e+05, 7.7122e+05, 3.8541e+05, 7.7536e+05, 3.8539e+05, 3.8538e+05,
         3.8535e+05, 3.8538e+05, 7.5497e+05, 3.8534e+05, 0.0000e+00, 7.7137e+05,
         3.8542e+05, 7.7185e+05, 3.8540e+05, 3.8536e+05, 3.8534e+05, 3.8537e+05,
         7.6701e+05],
        [3.8821e+05, 7.6355e+05, 3.8818e+05, 7.7217e+05, 3.8810e+05, 3.8816e+05,
         3.8820e+05, 3.8808e+05, 7.8548e+05, 3.8813e+05, 7.7137e+05, 0.0000e+00,
         3.8818e+05, 7.9459e+05, 3.8819e+05, 3.8815e+05, 3.8819e+05, 3.8821e+05,
         7.8132e+05],
        [3.3729e+00, 3.7875e+05, 3.1204e+00, 3.9171e+05, 3.2941e+00, 3.6597e+00,
         3.4180e+00, 3.2681e+00, 3.8350e+05, 3.4567e+00, 3.8542e+05, 3.8818e+05,
         0.0000e+00, 3.9077e+05, 3.0934e+00, 3.3949e+00, 3.4275e+00, 3.2589e+00,
         3.8198e+05],
        [3.9073e+05, 7.8108e+05, 3.9077e+05, 7.8564e+05, 3.9079e+05, 3.9076e+05,
         3.9076e+05, 3.9078e+05, 7.8791e+05, 3.9081e+05, 7.7185e+05, 7.9459e+05,
         3.9077e+05, 0.0000e+00, 3.9077e+05, 3.9075e+05, 3.9072e+05, 3.9082e+05,
         7.6851e+05],
        [3.1514e+00, 3.7875e+05, 3.2332e+00, 3.9175e+05, 3.2780e+00, 3.4170e+00,
         3.5860e+00, 3.3730e+00, 3.8350e+05, 3.6116e+00, 3.8540e+05, 3.8819e+05,
         3.0934e+00, 3.9077e+05, 0.0000e+00, 3.4168e+00, 3.5045e+00, 3.3999e+00,
         3.8197e+05],
        [3.3560e+00, 3.7875e+05, 3.4289e+00, 3.9171e+05, 3.0851e+00, 3.6332e+00,
         3.3991e+00, 3.5141e+00, 3.8350e+05, 3.4014e+00, 3.8536e+05, 3.8815e+05,
         3.3949e+00, 3.9075e+05, 3.4168e+00, 0.0000e+00, 3.3735e+00, 3.3971e+00,
         3.8195e+05],
        [3.4753e+00, 3.7868e+05, 3.8005e+00, 3.9170e+05, 3.3862e+00, 3.6696e+00,
         3.5193e+00, 3.6866e+00, 3.8350e+05, 3.4248e+00, 3.8534e+05, 3.8819e+05,
         3.4275e+00, 3.9072e+05, 3.5045e+00, 3.3735e+00, 0.0000e+00, 3.6318e+00,
         3.8195e+05],
        [3.5100e+00, 3.7874e+05, 3.5763e+00, 3.9175e+05, 3.3904e+00, 3.6801e+00,
         3.4420e+00, 3.3908e+00, 3.8349e+05, 3.4923e+00, 3.8537e+05, 3.8821e+05,
         3.2589e+00, 3.9082e+05, 3.3999e+00, 3.3971e+00, 3.6318e+00, 0.0000e+00,
         3.8194e+05],
        [3.8195e+05, 7.9024e+05, 3.8194e+05, 7.5410e+05, 3.8196e+05, 3.8196e+05,
         3.8196e+05, 3.8199e+05, 7.9440e+05, 3.8199e+05, 7.6701e+05, 7.8132e+05,
         3.8198e+05, 7.6851e+05, 3.8197e+05, 3.8195e+05, 3.8195e+05, 3.8194e+05,
         0.0000e+00]])
Krum scores: ['3.34', '378736.69', '3.42', '391719.25', '3.30', '3.57', '3.41', '3.35', '383502.06', '3.48', '385366.91', '388157.16', '3.31', '390759.88', '3.35', '3.38', '3.51', '3.45', '381955.59']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [11, 14, 5, 20, 3, 8, 6, 7, 13, 1, 19, 15, 4, 18, 12, 2, 9, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:57...
global Accuracy on shared test data: 44.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [215  48]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:57, End: 2025-07-22 15:46:57)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [2, 3, 13, 8, 5, 16, 19, 4, 1, 11, 15, 9, 20, 12, 18, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.1089e+00, 3.9908e+05, 3.5979e+00, 3.4340e+00, 3.8874e+05,
         3.8650e+05, 3.4078e+00, 3.3624e+00, 3.3190e+00, 3.9967e+05, 3.5115e+00,
         3.9149e+05, 3.4357e+00, 4.0475e+05, 3.4246e+00, 3.9555e+05],
        [3.1089e+00, 0.0000e+00, 3.9907e+05, 3.6560e+00, 3.0841e+00, 3.8872e+05,
         3.8646e+05, 3.2525e+00, 3.5096e+00, 3.3532e+00, 3.9966e+05, 3.4416e+00,
         3.9152e+05, 3.3499e+00, 4.0473e+05, 3.3287e+00, 3.9556e+05],
        [3.9908e+05, 3.9907e+05, 0.0000e+00, 3.9910e+05, 3.9906e+05, 7.9423e+05,
         7.8858e+05, 3.9902e+05, 3.9903e+05, 3.9901e+05, 8.1324e+05, 3.9904e+05,
         7.7321e+05, 3.9906e+05, 7.8824e+05, 3.9908e+05, 7.8836e+05],
        [3.5979e+00, 3.6560e+00, 3.9910e+05, 0.0000e+00, 3.9570e+00, 3.8871e+05,
         3.8650e+05, 3.6111e+00, 3.5772e+00, 3.5838e+00, 3.9964e+05, 3.6862e+00,
         3.9151e+05, 3.4475e+00, 4.0477e+05, 3.6084e+00, 3.9556e+05],
        [3.4340e+00, 3.0841e+00, 3.9906e+05, 3.9570e+00, 0.0000e+00, 3.8875e+05,
         3.8647e+05, 3.1973e+00, 3.5838e+00, 3.2701e+00, 3.9968e+05, 3.9958e+00,
         3.9156e+05, 3.3554e+00, 4.0474e+05, 3.5716e+00, 3.9554e+05],
        [3.8874e+05, 3.8872e+05, 7.9423e+05, 3.8871e+05, 3.8875e+05, 0.0000e+00,
         7.6982e+05, 3.8878e+05, 3.8875e+05, 3.8870e+05, 7.7116e+05, 3.8872e+05,
         7.6940e+05, 3.8869e+05, 8.0044e+05, 3.8873e+05, 7.8434e+05],
        [3.8650e+05, 3.8646e+05, 7.8858e+05, 3.8650e+05, 3.8647e+05, 7.6982e+05,
         0.0000e+00, 3.8647e+05, 3.8647e+05, 3.8643e+05, 7.8421e+05, 3.8648e+05,
         8.0281e+05, 3.8647e+05, 8.1560e+05, 3.8644e+05, 7.7187e+05],
        [3.4078e+00, 3.2525e+00, 3.9902e+05, 3.6111e+00, 3.1973e+00, 3.8878e+05,
         3.8647e+05, 0.0000e+00, 3.4241e+00, 3.3593e+00, 3.9965e+05, 3.5005e+00,
         3.9158e+05, 3.1598e+00, 4.0471e+05, 3.2409e+00, 3.9554e+05],
        [3.3624e+00, 3.5096e+00, 3.9903e+05, 3.5772e+00, 3.5838e+00, 3.8875e+05,
         3.8647e+05, 3.4241e+00, 0.0000e+00, 3.4370e+00, 3.9967e+05, 3.5359e+00,
         3.9154e+05, 3.6811e+00, 4.0477e+05, 3.4536e+00, 3.9550e+05],
        [3.3190e+00, 3.3532e+00, 3.9901e+05, 3.5838e+00, 3.2701e+00, 3.8870e+05,
         3.8643e+05, 3.3593e+00, 3.4370e+00, 0.0000e+00, 3.9967e+05, 3.5811e+00,
         3.9150e+05, 3.2799e+00, 4.0474e+05, 3.3794e+00, 3.9551e+05],
        [3.9967e+05, 3.9966e+05, 8.1324e+05, 3.9964e+05, 3.9968e+05, 7.7116e+05,
         7.8421e+05, 3.9965e+05, 3.9967e+05, 3.9967e+05, 0.0000e+00, 3.9965e+05,
         7.6985e+05, 3.9963e+05, 8.1723e+05, 3.9966e+05, 8.0692e+05],
        [3.5115e+00, 3.4416e+00, 3.9904e+05, 3.6862e+00, 3.9958e+00, 3.8872e+05,
         3.8648e+05, 3.5005e+00, 3.5359e+00, 3.5811e+00, 3.9965e+05, 0.0000e+00,
         3.9156e+05, 3.7119e+00, 4.0472e+05, 3.7037e+00, 3.9552e+05],
        [3.9149e+05, 3.9152e+05, 7.7321e+05, 3.9151e+05, 3.9156e+05, 7.6940e+05,
         8.0281e+05, 3.9158e+05, 3.9154e+05, 3.9150e+05, 7.6985e+05, 3.9156e+05,
         0.0000e+00, 3.9154e+05, 8.0136e+05, 3.9158e+05, 7.9784e+05],
        [3.4357e+00, 3.3499e+00, 3.9906e+05, 3.4475e+00, 3.3554e+00, 3.8869e+05,
         3.8647e+05, 3.1598e+00, 3.6811e+00, 3.2799e+00, 3.9963e+05, 3.7119e+00,
         3.9154e+05, 0.0000e+00, 4.0470e+05, 3.3267e+00, 3.9556e+05],
        [4.0475e+05, 4.0473e+05, 7.8824e+05, 4.0477e+05, 4.0474e+05, 8.0044e+05,
         8.1560e+05, 4.0471e+05, 4.0477e+05, 4.0474e+05, 8.1723e+05, 4.0472e+05,
         8.0136e+05, 4.0470e+05, 0.0000e+00, 4.0473e+05, 8.1471e+05],
        [3.4246e+00, 3.3287e+00, 3.9908e+05, 3.6084e+00, 3.5716e+00, 3.8873e+05,
         3.8644e+05, 3.2409e+00, 3.4536e+00, 3.3794e+00, 3.9966e+05, 3.7037e+00,
         3.9158e+05, 3.3267e+00, 4.0473e+05, 0.0000e+00, 3.9550e+05],
        [3.9555e+05, 3.9556e+05, 7.8836e+05, 3.9556e+05, 3.9554e+05, 7.8434e+05,
         7.7187e+05, 3.9554e+05, 3.9550e+05, 3.9551e+05, 8.0692e+05, 3.9552e+05,
         7.9784e+05, 3.9556e+05, 8.1471e+05, 3.9550e+05, 0.0000e+00]])
Krum scores: ['3.38', '3.30', '399046.28', '3.60', '3.43', '388720.88', '386460.28', '3.32', '3.49', '3.37', '399653.91', '3.58', '391527.69', '3.38', '404726.84', '3.42', '395526.75']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [2, 3, 13, 8, 5, 16, 19, 4, 1, 11, 15, 9, 20, 12, 18, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0105s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:57...
global Accuracy on shared test data: 44.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [212  51]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:57, End: 2025-07-22 15:46:57)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [12, 6, 16, 1, 9, 18, 20, 13, 2, 8, 7, 17, 10, 14, 3, 4, 11, 15, 19], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.6138e+00, 3.8737e+05, 3.6346e+00, 3.6380e+00, 3.7502e+05,
         3.9815e+05, 3.8017e+05, 3.3989e+00, 3.4043e+00, 3.4840e+00, 3.8993e+05,
         3.2592e+00, 3.7367e+05, 3.3972e+00, 3.1444e+00, 3.1817e+00, 3.9176e+05,
         3.9163e+05],
        [3.6138e+00, 0.0000e+00, 3.8738e+05, 3.3459e+00, 3.6902e+00, 3.7503e+05,
         3.9819e+05, 3.8016e+05, 3.3554e+00, 3.2167e+00, 3.3726e+00, 3.8993e+05,
         3.3590e+00, 3.7367e+05, 3.5324e+00, 3.4111e+00, 3.0905e+00, 3.9171e+05,
         3.9162e+05],
        [3.8737e+05, 3.8738e+05, 0.0000e+00, 3.8737e+05, 3.8740e+05, 7.7703e+05,
         7.9721e+05, 7.4209e+05, 3.8737e+05, 3.8734e+05, 3.8740e+05, 7.7802e+05,
         3.8738e+05, 7.7907e+05, 3.8739e+05, 3.8737e+05, 3.8739e+05, 7.5753e+05,
         7.9786e+05],
        [3.6346e+00, 3.3459e+00, 3.8737e+05, 0.0000e+00, 3.6129e+00, 3.7504e+05,
         3.9812e+05, 3.8015e+05, 3.3372e+00, 3.4936e+00, 3.4690e+00, 3.8989e+05,
         3.3884e+00, 3.7366e+05, 3.6592e+00, 3.4229e+00, 3.3773e+00, 3.9173e+05,
         3.9162e+05],
        [3.6380e+00, 3.6902e+00, 3.8740e+05, 3.6129e+00, 0.0000e+00, 3.7504e+05,
         3.9813e+05, 3.8016e+05, 3.5857e+00, 3.7320e+00, 3.8735e+00, 3.8993e+05,
         3.7440e+00, 3.7361e+05, 3.5071e+00, 3.5370e+00, 3.5253e+00, 3.9174e+05,
         3.9165e+05],
        [3.7502e+05, 3.7503e+05, 7.7703e+05, 3.7504e+05, 3.7504e+05, 0.0000e+00,
         7.8043e+05, 7.3792e+05, 3.7498e+05, 3.7503e+05, 3.7502e+05, 7.7560e+05,
         3.7501e+05, 7.5683e+05, 3.7505e+05, 3.7502e+05, 3.7505e+05, 7.5292e+05,
         7.6345e+05],
        [3.9815e+05, 3.9819e+05, 7.9721e+05, 3.9812e+05, 3.9813e+05, 7.8043e+05,
         0.0000e+00, 7.8842e+05, 3.9820e+05, 3.9815e+05, 3.9812e+05, 7.9966e+05,
         3.9819e+05, 7.7891e+05, 3.9816e+05, 3.9813e+05, 3.9821e+05, 7.8834e+05,
         8.2115e+05],
        [3.8017e+05, 3.8016e+05, 7.4209e+05, 3.8015e+05, 3.8016e+05, 7.3792e+05,
         7.8842e+05, 0.0000e+00, 3.8013e+05, 3.8016e+05, 3.8017e+05, 7.8133e+05,
         3.8017e+05, 7.3843e+05, 3.8009e+05, 3.8012e+05, 3.8013e+05, 7.7015e+05,
         7.7493e+05],
        [3.3989e+00, 3.3554e+00, 3.8737e+05, 3.3372e+00, 3.5857e+00, 3.7498e+05,
         3.9820e+05, 3.8013e+05, 0.0000e+00, 3.6254e+00, 3.6200e+00, 3.8988e+05,
         3.4743e+00, 3.7363e+05, 3.1690e+00, 3.5008e+00, 3.3028e+00, 3.9172e+05,
         3.9165e+05],
        [3.4043e+00, 3.2167e+00, 3.8734e+05, 3.4936e+00, 3.7320e+00, 3.7503e+05,
         3.9815e+05, 3.8016e+05, 3.6254e+00, 0.0000e+00, 3.3645e+00, 3.8990e+05,
         3.6863e+00, 3.7358e+05, 3.6875e+00, 3.7838e+00, 3.4831e+00, 3.9174e+05,
         3.9161e+05],
        [3.4840e+00, 3.3726e+00, 3.8740e+05, 3.4690e+00, 3.8735e+00, 3.7502e+05,
         3.9812e+05, 3.8017e+05, 3.6200e+00, 3.3645e+00, 0.0000e+00, 3.8993e+05,
         3.4113e+00, 3.7367e+05, 3.4866e+00, 3.4732e+00, 3.1923e+00, 3.9173e+05,
         3.9164e+05],
        [3.8993e+05, 3.8993e+05, 7.7802e+05, 3.8989e+05, 3.8993e+05, 7.7560e+05,
         7.9966e+05, 7.8133e+05, 3.8988e+05, 3.8990e+05, 3.8993e+05, 0.0000e+00,
         3.8986e+05, 7.5045e+05, 3.8993e+05, 3.8990e+05, 3.8991e+05, 7.8457e+05,
         7.7747e+05],
        [3.2592e+00, 3.3590e+00, 3.8738e+05, 3.3884e+00, 3.7440e+00, 3.7501e+05,
         3.9819e+05, 3.8017e+05, 3.4743e+00, 3.6863e+00, 3.4113e+00, 3.8986e+05,
         0.0000e+00, 3.7371e+05, 3.4470e+00, 3.3312e+00, 3.3311e+00, 3.9169e+05,
         3.9165e+05],
        [3.7367e+05, 3.7367e+05, 7.7907e+05, 3.7366e+05, 3.7361e+05, 7.5683e+05,
         7.7891e+05, 7.3843e+05, 3.7363e+05, 3.7358e+05, 3.7367e+05, 7.5045e+05,
         3.7371e+05, 0.0000e+00, 3.7364e+05, 3.7365e+05, 3.7367e+05, 7.6376e+05,
         7.5833e+05],
        [3.3972e+00, 3.5324e+00, 3.8739e+05, 3.6592e+00, 3.5071e+00, 3.7505e+05,
         3.9816e+05, 3.8009e+05, 3.1690e+00, 3.6875e+00, 3.4866e+00, 3.8993e+05,
         3.4470e+00, 3.7364e+05, 0.0000e+00, 3.3755e+00, 3.4123e+00, 3.9170e+05,
         3.9162e+05],
        [3.1444e+00, 3.4111e+00, 3.8737e+05, 3.4229e+00, 3.5370e+00, 3.7502e+05,
         3.9813e+05, 3.8012e+05, 3.5008e+00, 3.7838e+00, 3.4732e+00, 3.8990e+05,
         3.3312e+00, 3.7365e+05, 3.3755e+00, 0.0000e+00, 3.2969e+00, 3.9174e+05,
         3.9165e+05],
        [3.1817e+00, 3.0905e+00, 3.8739e+05, 3.3773e+00, 3.5253e+00, 3.7505e+05,
         3.9821e+05, 3.8013e+05, 3.3028e+00, 3.4831e+00, 3.1923e+00, 3.8991e+05,
         3.3311e+00, 3.7367e+05, 3.4123e+00, 3.2969e+00, 0.0000e+00, 3.9176e+05,
         3.9162e+05],
        [3.9176e+05, 3.9171e+05, 7.5753e+05, 3.9173e+05, 3.9174e+05, 7.5292e+05,
         7.8834e+05, 7.7015e+05, 3.9172e+05, 3.9174e+05, 3.9173e+05, 7.8457e+05,
         3.9169e+05, 7.6376e+05, 3.9170e+05, 3.9174e+05, 3.9176e+05, 0.0000e+00,
         7.8893e+05],
        [3.9163e+05, 3.9162e+05, 7.9786e+05, 3.9162e+05, 3.9165e+05, 7.6345e+05,
         8.2115e+05, 7.7493e+05, 3.9165e+05, 3.9161e+05, 3.9164e+05, 7.7747e+05,
         3.9165e+05, 7.5833e+05, 3.9162e+05, 3.9165e+05, 3.9162e+05, 7.8893e+05,
         0.0000e+00]])
Krum scores: ['3.39', '3.37', '387374.38', '3.45', '3.62', '375020.34', '398149.38', '380141.22', '3.42', '3.52', '3.43', '389902.31', '3.41', '373641.28', '3.44', '3.39', '3.30', '391722.03', '391629.28']
Selected index: 16
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']
 ['Update 17']
 ['Update 18']], selected_client_indices: [12, 6, 16, 1, 9, 18, 20, 13, 2, 8, 7, 17, 10, 14, 3, 4, 11, 15, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0141s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:58...
global Accuracy on shared test data: 45.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [205  58]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:58, End: 2025-07-22 15:46:58)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [18, 7, 9, 19, 16, 11, 20, 8, 14, 5, 13, 15, 4, 1, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.8576e+05, 3.8577e+05, 7.8948e+05, 7.5870e+05, 3.8576e+05,
         7.8308e+05, 3.8578e+05, 7.7733e+05, 3.8574e+05, 7.6632e+05, 8.0615e+05,
         3.8581e+05, 3.8576e+05, 3.8573e+05],
        [3.8576e+05, 0.0000e+00, 3.8170e+00, 4.0355e+05, 3.7866e+05, 3.2717e+00,
         4.0395e+05, 3.2399e+00, 3.9512e+05, 3.3295e+00, 3.8357e+05, 4.0594e+05,
         3.4627e+00, 3.4368e+00, 3.5674e+00],
        [3.8577e+05, 3.8170e+00, 0.0000e+00, 4.0354e+05, 3.7865e+05, 3.5092e+00,
         4.0392e+05, 3.6833e+00, 3.9516e+05, 3.9182e+00, 3.8357e+05, 4.0592e+05,
         3.5164e+00, 3.6379e+00, 3.6297e+00],
        [7.8948e+05, 4.0355e+05, 4.0354e+05, 0.0000e+00, 7.7738e+05, 4.0355e+05,
         8.2258e+05, 4.0355e+05, 7.8010e+05, 4.0360e+05, 7.7381e+05, 8.0800e+05,
         4.0354e+05, 4.0359e+05, 4.0356e+05],
        [7.5870e+05, 3.7866e+05, 3.7865e+05, 7.7738e+05, 0.0000e+00, 3.7864e+05,
         7.8688e+05, 3.7858e+05, 7.6785e+05, 3.7860e+05, 7.6885e+05, 7.7852e+05,
         3.7862e+05, 3.7865e+05, 3.7863e+05],
        [3.8576e+05, 3.2717e+00, 3.5092e+00, 4.0355e+05, 3.7864e+05, 0.0000e+00,
         4.0391e+05, 3.4895e+00, 3.9511e+05, 3.2782e+00, 3.8354e+05, 4.0592e+05,
         3.4263e+00, 3.4130e+00, 3.3025e+00],
        [7.8308e+05, 4.0395e+05, 4.0392e+05, 8.2258e+05, 7.8688e+05, 4.0391e+05,
         0.0000e+00, 4.0396e+05, 7.8526e+05, 4.0392e+05, 8.0335e+05, 8.2110e+05,
         4.0394e+05, 4.0398e+05, 4.0392e+05],
        [3.8578e+05, 3.2399e+00, 3.6833e+00, 4.0355e+05, 3.7858e+05, 3.4895e+00,
         4.0396e+05, 0.0000e+00, 3.9514e+05, 3.8824e+00, 3.8350e+05, 4.0591e+05,
         3.7137e+00, 3.4995e+00, 3.5817e+00],
        [7.7733e+05, 3.9512e+05, 3.9516e+05, 7.8010e+05, 7.6785e+05, 3.9511e+05,
         7.8526e+05, 3.9514e+05, 0.0000e+00, 3.9512e+05, 7.6950e+05, 7.9912e+05,
         3.9518e+05, 3.9514e+05, 3.9517e+05],
        [3.8574e+05, 3.3295e+00, 3.9182e+00, 4.0360e+05, 3.7860e+05, 3.2782e+00,
         4.0392e+05, 3.8824e+00, 3.9512e+05, 0.0000e+00, 3.8352e+05, 4.0590e+05,
         3.1322e+00, 3.5192e+00, 3.3847e+00],
        [7.6632e+05, 3.8357e+05, 3.8357e+05, 7.7381e+05, 7.6885e+05, 3.8354e+05,
         8.0335e+05, 3.8350e+05, 7.6950e+05, 3.8352e+05, 0.0000e+00, 7.9647e+05,
         3.8349e+05, 3.8351e+05, 3.8351e+05],
        [8.0615e+05, 4.0594e+05, 4.0592e+05, 8.0800e+05, 7.7852e+05, 4.0592e+05,
         8.2110e+05, 4.0591e+05, 7.9912e+05, 4.0590e+05, 7.9647e+05, 0.0000e+00,
         4.0589e+05, 4.0590e+05, 4.0591e+05],
        [3.8581e+05, 3.4627e+00, 3.5164e+00, 4.0354e+05, 3.7862e+05, 3.4263e+00,
         4.0394e+05, 3.7137e+00, 3.9518e+05, 3.1322e+00, 3.8349e+05, 4.0589e+05,
         0.0000e+00, 3.3902e+00, 3.4166e+00],
        [3.8576e+05, 3.4368e+00, 3.6379e+00, 4.0359e+05, 3.7865e+05, 3.4130e+00,
         4.0398e+05, 3.4995e+00, 3.9514e+05, 3.5192e+00, 3.8351e+05, 4.0590e+05,
         3.3902e+00, 0.0000e+00, 3.3517e+00],
        [3.8573e+05, 3.5674e+00, 3.6297e+00, 4.0356e+05, 3.7863e+05, 3.3025e+00,
         4.0392e+05, 3.5817e+00, 3.9517e+05, 3.3847e+00, 3.8351e+05, 4.0591e+05,
         3.4166e+00, 3.3517e+00, 0.0000e+00]])
Krum scores: ['385752.88', '3.38', '3.63', '403548.03', '378617.41', '3.36', '403927.94', '3.53', '395133.97', '3.42', '383512.16', '405905.31', '3.39', '3.44', '3.43']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [18, 7, 9, 19, 16, 11, 20, 8, 14, 5, 13, 15, 4, 1, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0032s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:59...
global Accuracy on shared test data: 45.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [202  61]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:46:59, End: 2025-07-22 15:46:59)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [9, 3, 11, 2, 16, 14, 18, 10, 12, 20, 6, 13, 19, 8, 4, 5, 7, 1, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.4299e+00, 3.4509e+00, 3.6382e+00, 3.9240e+05, 3.9285e+05,
         3.9597e+05, 3.8357e+00, 3.7533e+00, 4.0459e+05, 3.6124e+00, 3.8327e+05,
         3.8775e+05, 3.7015e+00, 3.5072e+00, 3.8284e+00, 3.8603e+00, 3.7073e+00,
         3.7723e+05],
        [3.4299e+00, 0.0000e+00, 3.4796e+00, 3.1725e+00, 3.9241e+05, 3.9288e+05,
         3.9600e+05, 3.4090e+00, 3.4346e+00, 4.0456e+05, 3.4063e+00, 3.8322e+05,
         3.8772e+05, 3.6257e+00, 3.3604e+00, 2.9985e+00, 3.4121e+00, 3.6970e+00,
         3.7720e+05],
        [3.4509e+00, 3.4796e+00, 0.0000e+00, 3.3205e+00, 3.9241e+05, 3.9289e+05,
         3.9594e+05, 3.2741e+00, 3.2054e+00, 4.0457e+05, 3.0395e+00, 3.8320e+05,
         3.8774e+05, 3.5039e+00, 3.4238e+00, 3.1931e+00, 3.2416e+00, 3.3874e+00,
         3.7720e+05],
        [3.6382e+00, 3.1725e+00, 3.3205e+00, 0.0000e+00, 3.9239e+05, 3.9292e+05,
         3.9592e+05, 3.4357e+00, 3.4703e+00, 4.0455e+05, 3.2758e+00, 3.8324e+05,
         3.8770e+05, 3.6177e+00, 3.4171e+00, 3.3538e+00, 3.5237e+00, 3.3858e+00,
         3.7718e+05],
        [3.9240e+05, 3.9241e+05, 3.9241e+05, 3.9239e+05, 0.0000e+00, 7.6256e+05,
         7.8258e+05, 3.9237e+05, 3.9240e+05, 7.9224e+05, 3.9240e+05, 7.8380e+05,
         7.8477e+05, 3.9241e+05, 3.9238e+05, 3.9239e+05, 3.9241e+05, 3.9233e+05,
         7.6060e+05],
        [3.9285e+05, 3.9288e+05, 3.9289e+05, 3.9292e+05, 7.6256e+05, 0.0000e+00,
         7.7145e+05, 3.9288e+05, 3.9290e+05, 7.8011e+05, 3.9288e+05, 7.9139e+05,
         7.8858e+05, 3.9285e+05, 3.9287e+05, 3.9290e+05, 3.9288e+05, 3.9286e+05,
         7.7969e+05],
        [3.9597e+05, 3.9600e+05, 3.9594e+05, 3.9592e+05, 7.8258e+05, 7.7145e+05,
         0.0000e+00, 3.9596e+05, 3.9596e+05, 7.8307e+05, 3.9594e+05, 7.7789e+05,
         7.7810e+05, 3.9595e+05, 3.9597e+05, 3.9598e+05, 3.9595e+05, 3.9594e+05,
         7.6708e+05],
        [3.8357e+00, 3.4090e+00, 3.2741e+00, 3.4357e+00, 3.9237e+05, 3.9288e+05,
         3.9596e+05, 0.0000e+00, 3.2567e+00, 4.0456e+05, 3.3210e+00, 3.8321e+05,
         3.8770e+05, 3.6881e+00, 3.3512e+00, 3.4608e+00, 3.3230e+00, 3.2353e+00,
         3.7721e+05],
        [3.7533e+00, 3.4346e+00, 3.2054e+00, 3.4703e+00, 3.9240e+05, 3.9290e+05,
         3.9596e+05, 3.2567e+00, 0.0000e+00, 4.0454e+05, 3.5859e+00, 3.8325e+05,
         3.8772e+05, 3.3383e+00, 3.1741e+00, 3.1688e+00, 3.4556e+00, 3.6614e+00,
         3.7717e+05],
        [4.0459e+05, 4.0456e+05, 4.0457e+05, 4.0455e+05, 7.9224e+05, 7.8011e+05,
         7.8307e+05, 4.0456e+05, 4.0454e+05, 0.0000e+00, 4.0457e+05, 7.8444e+05,
         8.1243e+05, 4.0455e+05, 4.0456e+05, 4.0455e+05, 4.0458e+05, 4.0460e+05,
         8.0597e+05],
        [3.6124e+00, 3.4063e+00, 3.0395e+00, 3.2758e+00, 3.9240e+05, 3.9288e+05,
         3.9594e+05, 3.3210e+00, 3.5859e+00, 4.0457e+05, 0.0000e+00, 3.8320e+05,
         3.8779e+05, 3.2616e+00, 3.3595e+00, 3.4517e+00, 3.3449e+00, 3.3762e+00,
         3.7723e+05],
        [3.8327e+05, 3.8322e+05, 3.8320e+05, 3.8324e+05, 7.8380e+05, 7.9139e+05,
         7.7789e+05, 3.8321e+05, 3.8325e+05, 7.8444e+05, 3.8320e+05, 0.0000e+00,
         7.8179e+05, 3.8319e+05, 3.8318e+05, 3.8326e+05, 3.8319e+05, 3.8321e+05,
         7.5955e+05],
        [3.8775e+05, 3.8772e+05, 3.8774e+05, 3.8770e+05, 7.8477e+05, 7.8858e+05,
         7.7810e+05, 3.8770e+05, 3.8772e+05, 8.1243e+05, 3.8779e+05, 7.8179e+05,
         0.0000e+00, 3.8776e+05, 3.8772e+05, 3.8771e+05, 3.8775e+05, 3.8777e+05,
         7.4949e+05],
        [3.7015e+00, 3.6257e+00, 3.5039e+00, 3.6177e+00, 3.9241e+05, 3.9285e+05,
         3.9595e+05, 3.6881e+00, 3.3383e+00, 4.0455e+05, 3.2616e+00, 3.8319e+05,
         3.8776e+05, 0.0000e+00, 3.6931e+00, 3.8538e+00, 3.2832e+00, 3.5452e+00,
         3.7720e+05],
        [3.5072e+00, 3.3604e+00, 3.4238e+00, 3.4171e+00, 3.9238e+05, 3.9287e+05,
         3.9597e+05, 3.3512e+00, 3.1741e+00, 4.0456e+05, 3.3595e+00, 3.8318e+05,
         3.8772e+05, 3.6931e+00, 0.0000e+00, 3.0830e+00, 3.5372e+00, 3.3395e+00,
         3.7718e+05],
        [3.8284e+00, 2.9985e+00, 3.1931e+00, 3.3538e+00, 3.9239e+05, 3.9290e+05,
         3.9598e+05, 3.4608e+00, 3.1688e+00, 4.0455e+05, 3.4517e+00, 3.8326e+05,
         3.8771e+05, 3.8538e+00, 3.0830e+00, 0.0000e+00, 3.3701e+00, 3.4438e+00,
         3.7715e+05],
        [3.8603e+00, 3.4121e+00, 3.2416e+00, 3.5237e+00, 3.9241e+05, 3.9288e+05,
         3.9595e+05, 3.3230e+00, 3.4556e+00, 4.0458e+05, 3.3449e+00, 3.8319e+05,
         3.8775e+05, 3.2832e+00, 3.5372e+00, 3.3701e+00, 0.0000e+00, 3.3940e+00,
         3.7719e+05],
        [3.7073e+00, 3.6970e+00, 3.3874e+00, 3.3858e+00, 3.9233e+05, 3.9286e+05,
         3.9594e+05, 3.2353e+00, 3.6614e+00, 4.0460e+05, 3.3762e+00, 3.8321e+05,
         3.8777e+05, 3.5452e+00, 3.3395e+00, 3.4438e+00, 3.3940e+00, 0.0000e+00,
         3.7722e+05],
        [3.7723e+05, 3.7720e+05, 3.7720e+05, 3.7718e+05, 7.6060e+05, 7.7969e+05,
         7.6708e+05, 3.7721e+05, 3.7717e+05, 8.0597e+05, 3.7723e+05, 7.5955e+05,
         7.4949e+05, 3.7720e+05, 3.7718e+05, 3.7715e+05, 3.7719e+05, 3.7722e+05,
         0.0000e+00]])
Krum scores: ['3.65', '3.37', '3.30', '3.40', '392386.72', '392874.28', '395950.91', '3.38', '3.38', '404559.81', '3.34', '383209.38', '387728.84', '3.53', '3.36', '3.34', '3.39', '3.45', '377191.66']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [9, 3, 11, 2, 16, 14, 18, 10, 12, 20, 6, 13, 19, 8, 4, 5, 7, 1, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:46:59...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [195  68]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:46:59, End: 2025-07-22 15:46:59)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [16, 8, 4, 9, 19, 14, 7, 11, 10, 3, 15, 2, 13, 1, 18, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.9856e+05, 3.9859e+05, 3.9862e+05, 7.6105e+05, 7.8475e+05,
         3.9860e+05, 3.9866e+05, 3.9859e+05, 3.9864e+05, 7.7851e+05, 3.9856e+05,
         7.9814e+05, 3.9858e+05, 7.9213e+05, 3.9857e+05, 3.9855e+05],
        [3.9856e+05, 0.0000e+00, 3.7102e+00, 3.6619e+00, 3.9305e+05, 3.8134e+05,
         3.2829e+00, 3.5097e+00, 3.6782e+00, 3.6488e+00, 3.8589e+05, 3.5498e+00,
         4.0289e+05, 3.4983e+00, 3.8878e+05, 3.4077e+00, 3.2925e+00],
        [3.9859e+05, 3.7102e+00, 0.0000e+00, 3.5572e+00, 3.9308e+05, 3.8140e+05,
         3.5380e+00, 3.6085e+00, 3.4795e+00, 3.3387e+00, 3.8586e+05, 3.5195e+00,
         4.0289e+05, 3.5573e+00, 3.8869e+05, 3.3743e+00, 3.1737e+00],
        [3.9862e+05, 3.6619e+00, 3.5572e+00, 0.0000e+00, 3.9308e+05, 3.8141e+05,
         3.7894e+00, 3.4549e+00, 3.6973e+00, 3.3777e+00, 3.8582e+05, 3.6359e+00,
         4.0287e+05, 3.6655e+00, 3.8875e+05, 3.5517e+00, 3.6722e+00],
        [7.6105e+05, 3.9305e+05, 3.9308e+05, 3.9308e+05, 0.0000e+00, 7.7834e+05,
         3.9311e+05, 3.9309e+05, 3.9311e+05, 3.9308e+05, 7.6359e+05, 3.9303e+05,
         7.9954e+05, 3.9309e+05, 7.7823e+05, 3.9306e+05, 3.9307e+05],
        [7.8475e+05, 3.8134e+05, 3.8140e+05, 3.8141e+05, 7.7834e+05, 0.0000e+00,
         3.8141e+05, 3.8140e+05, 3.8142e+05, 3.8139e+05, 7.7092e+05, 3.8134e+05,
         7.8779e+05, 3.8136e+05, 7.6016e+05, 3.8135e+05, 3.8138e+05],
        [3.9860e+05, 3.2829e+00, 3.5380e+00, 3.7894e+00, 3.9311e+05, 3.8141e+05,
         0.0000e+00, 3.2693e+00, 3.4060e+00, 3.3573e+00, 3.8587e+05, 3.5354e+00,
         4.0290e+05, 3.4171e+00, 3.8867e+05, 3.4226e+00, 3.4629e+00],
        [3.9866e+05, 3.5097e+00, 3.6085e+00, 3.4549e+00, 3.9309e+05, 3.8140e+05,
         3.2693e+00, 0.0000e+00, 3.3945e+00, 3.5414e+00, 3.8589e+05, 3.4625e+00,
         4.0287e+05, 3.4712e+00, 3.8870e+05, 3.1699e+00, 3.2489e+00],
        [3.9859e+05, 3.6782e+00, 3.4795e+00, 3.6973e+00, 3.9311e+05, 3.8142e+05,
         3.4060e+00, 3.3945e+00, 0.0000e+00, 3.4902e+00, 3.8590e+05, 3.5760e+00,
         4.0289e+05, 3.2897e+00, 3.8870e+05, 3.3942e+00, 3.3197e+00],
        [3.9864e+05, 3.6488e+00, 3.3387e+00, 3.3777e+00, 3.9308e+05, 3.8139e+05,
         3.3573e+00, 3.5414e+00, 3.4902e+00, 0.0000e+00, 3.8588e+05, 3.2133e+00,
         4.0286e+05, 3.6455e+00, 3.8871e+05, 3.4392e+00, 3.3612e+00],
        [7.7851e+05, 3.8589e+05, 3.8586e+05, 3.8582e+05, 7.6359e+05, 7.7092e+05,
         3.8587e+05, 3.8589e+05, 3.8590e+05, 3.8588e+05, 0.0000e+00, 3.8586e+05,
         7.7124e+05, 3.8584e+05, 7.7437e+05, 3.8591e+05, 3.8588e+05],
        [3.9856e+05, 3.5498e+00, 3.5195e+00, 3.6359e+00, 3.9303e+05, 3.8134e+05,
         3.5354e+00, 3.4625e+00, 3.5760e+00, 3.2133e+00, 3.8586e+05, 0.0000e+00,
         4.0290e+05, 3.4836e+00, 3.8874e+05, 3.3228e+00, 3.4792e+00],
        [7.9814e+05, 4.0289e+05, 4.0289e+05, 4.0287e+05, 7.9954e+05, 7.8779e+05,
         4.0290e+05, 4.0287e+05, 4.0289e+05, 4.0286e+05, 7.7124e+05, 4.0290e+05,
         0.0000e+00, 4.0284e+05, 7.9506e+05, 4.0284e+05, 4.0288e+05],
        [3.9858e+05, 3.4983e+00, 3.5573e+00, 3.6655e+00, 3.9309e+05, 3.8136e+05,
         3.4171e+00, 3.4712e+00, 3.2897e+00, 3.6455e+00, 3.8584e+05, 3.4836e+00,
         4.0284e+05, 0.0000e+00, 3.8875e+05, 3.4660e+00, 3.6944e+00],
        [7.9213e+05, 3.8878e+05, 3.8869e+05, 3.8875e+05, 7.7823e+05, 7.6016e+05,
         3.8867e+05, 3.8870e+05, 3.8870e+05, 3.8871e+05, 7.7437e+05, 3.8874e+05,
         7.9506e+05, 3.8875e+05, 0.0000e+00, 3.8872e+05, 3.8872e+05],
        [3.9857e+05, 3.4077e+00, 3.3743e+00, 3.5517e+00, 3.9306e+05, 3.8135e+05,
         3.4226e+00, 3.1699e+00, 3.3942e+00, 3.4392e+00, 3.8591e+05, 3.3228e+00,
         4.0284e+05, 3.4660e+00, 3.8872e+05, 0.0000e+00, 3.5379e+00],
        [3.9855e+05, 3.2925e+00, 3.1737e+00, 3.6722e+00, 3.9307e+05, 3.8138e+05,
         3.4629e+00, 3.2489e+00, 3.3197e+00, 3.3612e+00, 3.8588e+05, 3.4792e+00,
         4.0288e+05, 3.6944e+00, 3.8872e+05, 3.5379e+00, 0.0000e+00]])
Krum scores: ['398579.41', '3.50', '3.46', '3.59', '393069.41', '381375.62', '3.41', '3.39', '3.45', '3.42', '385865.12', '3.46', '402870.75', '3.50', '388710.22', '3.39', '3.39']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [16, 8, 4, 9, 19, 14, 7, 11, 10, 3, 15, 2, 13, 1, 18, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:00...
global Accuracy on shared test data: 47.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[163  74]
 [188  75]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:00, End: 2025-07-22 15:47:00)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [13], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
tensor([[0.]])
Krum scores: ['nan']
Selected index: 0
krum, clients_type: [['Chosen Update']], selected_client_indices: [13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:00...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[228   9]
 [244  19]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:47:00, End: 2025-07-22 15:47:00)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [6, 16, 3, 20, 10, 19, 11, 7, 13, 12, 8, 1, 18, 15, 4, 2, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.8614e+05, 3.4271e+00, 3.7440e+05, 3.2462e+00, 3.9749e+05,
         3.1032e+00, 3.0733e+00, 3.8932e+05, 3.6579e+00, 3.1209e+00, 3.5637e+00,
         3.8881e+05, 3.8550e+05, 3.3584e+00, 3.2531e+00, 3.7080e+05],
        [3.8614e+05, 0.0000e+00, 3.8613e+05, 7.7715e+05, 3.8617e+05, 7.7134e+05,
         3.8612e+05, 3.8612e+05, 7.6016e+05, 3.8618e+05, 3.8612e+05, 3.8613e+05,
         7.7094e+05, 7.4269e+05, 3.8615e+05, 3.8616e+05, 7.5816e+05],
        [3.4271e+00, 3.8613e+05, 0.0000e+00, 3.7441e+05, 3.4676e+00, 3.9753e+05,
         3.4799e+00, 3.1153e+00, 3.8929e+05, 3.3979e+00, 3.6691e+00, 3.8124e+00,
         3.8876e+05, 3.8545e+05, 3.2275e+00, 3.2577e+00, 3.7076e+05],
        [3.7440e+05, 7.7715e+05, 3.7441e+05, 0.0000e+00, 3.7437e+05, 7.6961e+05,
         3.7437e+05, 3.7444e+05, 7.7753e+05, 3.7440e+05, 3.7440e+05, 3.7435e+05,
         7.6393e+05, 7.3388e+05, 3.7438e+05, 3.7441e+05, 7.0100e+05],
        [3.2462e+00, 3.8617e+05, 3.4676e+00, 3.7437e+05, 0.0000e+00, 3.9749e+05,
         3.2850e+00, 3.1653e+00, 3.8928e+05, 3.3019e+00, 3.5296e+00, 3.4970e+00,
         3.8875e+05, 3.8555e+05, 3.1329e+00, 3.2283e+00, 3.7080e+05],
        [3.9749e+05, 7.7134e+05, 3.9753e+05, 7.6961e+05, 3.9749e+05, 0.0000e+00,
         3.9751e+05, 3.9754e+05, 7.9161e+05, 3.9745e+05, 3.9756e+05, 3.9749e+05,
         7.8614e+05, 8.0043e+05, 3.9750e+05, 3.9752e+05, 7.6559e+05],
        [3.1032e+00, 3.8612e+05, 3.4799e+00, 3.7437e+05, 3.2850e+00, 3.9751e+05,
         0.0000e+00, 3.0436e+00, 3.8928e+05, 3.1928e+00, 3.2115e+00, 3.3095e+00,
         3.8883e+05, 3.8547e+05, 3.3016e+00, 3.1544e+00, 3.7077e+05],
        [3.0733e+00, 3.8612e+05, 3.1153e+00, 3.7444e+05, 3.1653e+00, 3.9754e+05,
         3.0436e+00, 0.0000e+00, 3.8931e+05, 3.3615e+00, 3.0335e+00, 3.4246e+00,
         3.8874e+05, 3.8548e+05, 3.1515e+00, 3.1956e+00, 3.7077e+05],
        [3.8932e+05, 7.6016e+05, 3.8929e+05, 7.7753e+05, 3.8928e+05, 7.9161e+05,
         3.8928e+05, 3.8931e+05, 0.0000e+00, 3.8929e+05, 3.8929e+05, 3.8933e+05,
         7.7260e+05, 7.7648e+05, 3.8931e+05, 3.8936e+05, 7.2633e+05],
        [3.6579e+00, 3.8618e+05, 3.3979e+00, 3.7440e+05, 3.3019e+00, 3.9745e+05,
         3.1928e+00, 3.3615e+00, 3.8929e+05, 0.0000e+00, 3.0965e+00, 3.5307e+00,
         3.8880e+05, 3.8545e+05, 3.3096e+00, 3.4258e+00, 3.7075e+05],
        [3.1209e+00, 3.8612e+05, 3.6691e+00, 3.7440e+05, 3.5296e+00, 3.9756e+05,
         3.2115e+00, 3.0335e+00, 3.8929e+05, 3.0965e+00, 0.0000e+00, 3.6397e+00,
         3.8877e+05, 3.8546e+05, 3.4277e+00, 3.3527e+00, 3.7077e+05],
        [3.5637e+00, 3.8613e+05, 3.8124e+00, 3.7435e+05, 3.4970e+00, 3.9749e+05,
         3.3095e+00, 3.4246e+00, 3.8933e+05, 3.5307e+00, 3.6397e+00, 0.0000e+00,
         3.8876e+05, 3.8546e+05, 3.4220e+00, 3.3018e+00, 3.7074e+05],
        [3.8881e+05, 7.7094e+05, 3.8876e+05, 7.6393e+05, 3.8875e+05, 7.8614e+05,
         3.8883e+05, 3.8874e+05, 7.7260e+05, 3.8880e+05, 3.8877e+05, 3.8876e+05,
         0.0000e+00, 7.7303e+05, 3.8872e+05, 3.8876e+05, 7.3925e+05],
        [3.8550e+05, 7.4269e+05, 3.8545e+05, 7.3388e+05, 3.8555e+05, 8.0043e+05,
         3.8547e+05, 3.8548e+05, 7.7648e+05, 3.8545e+05, 3.8546e+05, 3.8546e+05,
         7.7303e+05, 0.0000e+00, 3.8551e+05, 3.8550e+05, 7.5593e+05],
        [3.3584e+00, 3.8615e+05, 3.2275e+00, 3.7438e+05, 3.1329e+00, 3.9750e+05,
         3.3016e+00, 3.1515e+00, 3.8931e+05, 3.3096e+00, 3.4277e+00, 3.4220e+00,
         3.8872e+05, 3.8551e+05, 0.0000e+00, 3.4327e+00, 3.7082e+05],
        [3.2531e+00, 3.8616e+05, 3.2577e+00, 3.7441e+05, 3.2283e+00, 3.9752e+05,
         3.1544e+00, 3.1956e+00, 3.8936e+05, 3.4258e+00, 3.3527e+00, 3.3018e+00,
         3.8876e+05, 3.8550e+05, 3.4327e+00, 0.0000e+00, 3.7078e+05],
        [3.7080e+05, 7.5816e+05, 3.7076e+05, 7.0100e+05, 3.7080e+05, 7.6559e+05,
         3.7077e+05, 3.7077e+05, 7.2633e+05, 3.7075e+05, 3.7077e+05, 3.7074e+05,
         7.3925e+05, 7.5593e+05, 3.7082e+05, 3.7078e+05, 0.0000e+00]])
Krum scores: ['3.27', '386135.59', '3.38', '374384.69', '3.29', '397497.66', '3.20', '3.14', '389297.22', '3.33', '3.30', '3.46', '388756.59', '385472.72', '3.29', '3.27', '370768.62']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [6, 16, 3, 20, 10, 19, 11, 7, 13, 12, 8, 1, 18, 15, 4, 2, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0189s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:01...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[227  10]
 [244  19]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:01, End: 2025-07-22 15:47:01)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [5, 17, 14, 4, 3, 19, 1, 2, 8, 18], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.8406e+05, 3.8090e+05, 3.2098e+00, 3.1871e+00, 4.0225e+05,
         3.3046e+00, 3.3721e+00, 3.5446e+00, 3.8882e+05],
        [3.8406e+05, 0.0000e+00, 7.8456e+05, 3.8405e+05, 3.8406e+05, 7.9216e+05,
         3.8404e+05, 3.8406e+05, 3.8403e+05, 7.4584e+05],
        [3.8090e+05, 7.8456e+05, 0.0000e+00, 3.8098e+05, 3.8088e+05, 7.7979e+05,
         3.8094e+05, 3.8097e+05, 3.8094e+05, 7.7620e+05],
        [3.2098e+00, 3.8405e+05, 3.8098e+05, 0.0000e+00, 3.1895e+00, 4.0224e+05,
         3.3958e+00, 3.4859e+00, 3.4888e+00, 3.8885e+05],
        [3.1871e+00, 3.8406e+05, 3.8088e+05, 3.1895e+00, 0.0000e+00, 4.0229e+05,
         3.6290e+00, 3.2750e+00, 3.5940e+00, 3.8878e+05],
        [4.0225e+05, 7.9216e+05, 7.7979e+05, 4.0224e+05, 4.0229e+05, 0.0000e+00,
         4.0225e+05, 4.0225e+05, 4.0228e+05, 7.9490e+05],
        [3.3046e+00, 3.8404e+05, 3.8094e+05, 3.3958e+00, 3.6290e+00, 4.0225e+05,
         0.0000e+00, 3.2402e+00, 3.5811e+00, 3.8881e+05],
        [3.3721e+00, 3.8406e+05, 3.8097e+05, 3.4859e+00, 3.2750e+00, 4.0225e+05,
         3.2402e+00, 0.0000e+00, 3.3246e+00, 3.8881e+05],
        [3.5446e+00, 3.8403e+05, 3.8094e+05, 3.4888e+00, 3.5940e+00, 4.0228e+05,
         3.5811e+00, 3.3246e+00, 0.0000e+00, 3.8879e+05],
        [3.8882e+05, 7.4584e+05, 7.7620e+05, 3.8885e+05, 3.8878e+05, 7.9490e+05,
         3.8881e+05, 3.8881e+05, 3.8879e+05, 0.0000e+00]])
Krum scores: ['3.27', '384043.00', '380917.25', '3.32', '3.31', '402248.81', '3.38', '3.30', '3.48', '388797.50']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [5, 17, 14, 4, 3, 19, 1, 2, 8, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0021s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:01...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[227  10]
 [244  19]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:01, End: 2025-07-22 15:47:01)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [17, 18, 4, 8, 14], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
tensor([[0.0000e+00, 7.9153e+05, 3.8731e+05, 3.8730e+05, 7.9539e+05],
        [7.9153e+05, 0.0000e+00, 4.0548e+05, 4.0548e+05, 7.9192e+05],
        [3.8731e+05, 4.0548e+05, 0.0000e+00, 3.4561e+00, 3.9184e+05],
        [3.8730e+05, 4.0548e+05, 3.4561e+00, 0.0000e+00, 3.9181e+05],
        [7.9539e+05, 7.9192e+05, 3.9184e+05, 3.9181e+05, 0.0000e+00]])
Krum scores: ['nan', 'nan', 'nan', 'nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']], selected_client_indices: [17, 18, 4, 8, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0013s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:01...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [201  62]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:01, End: 2025-07-22 15:47:01)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [17, 14, 15, 9, 16, 10, 2, 7, 19, 8, 4, 5, 18, 13, 6, 11, 1, 12, 3, 20], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 7.7136e+05, 7.9679e+05, 3.8438e+05, 7.6774e+05, 3.8446e+05,
         3.8437e+05, 3.8439e+05, 7.6909e+05, 3.8438e+05, 3.8440e+05, 3.8433e+05,
         7.8621e+05, 7.6897e+05, 3.8438e+05, 3.8432e+05, 3.8438e+05, 3.8438e+05,
         3.8433e+05, 7.7665e+05],
        [7.7136e+05, 0.0000e+00, 7.8761e+05, 3.9236e+05, 7.7526e+05, 3.9228e+05,
         3.9230e+05, 3.9234e+05, 7.7845e+05, 3.9235e+05, 3.9228e+05, 3.9232e+05,
         7.9525e+05, 7.6939e+05, 3.9228e+05, 3.9229e+05, 3.9234e+05, 3.9233e+05,
         3.9236e+05, 7.8228e+05],
        [7.9679e+05, 7.8761e+05, 0.0000e+00, 4.0531e+05, 7.9417e+05, 4.0530e+05,
         4.0530e+05, 4.0526e+05, 8.1293e+05, 4.0531e+05, 4.0531e+05, 4.0525e+05,
         8.0045e+05, 8.1271e+05, 4.0527e+05, 4.0532e+05, 4.0533e+05, 4.0529e+05,
         4.0530e+05, 8.1460e+05],
        [3.8438e+05, 3.9236e+05, 4.0531e+05, 0.0000e+00, 3.8420e+05, 3.4253e+00,
         3.4894e+00, 3.6768e+00, 3.8717e+05, 3.6626e+00, 3.2421e+00, 3.3988e+00,
         3.9252e+05, 3.9059e+05, 3.4091e+00, 3.5371e+00, 3.6289e+00, 3.5504e+00,
         3.4905e+00, 3.8796e+05],
        [7.6774e+05, 7.7526e+05, 7.9417e+05, 3.8420e+05, 0.0000e+00, 3.8422e+05,
         3.8417e+05, 3.8415e+05, 7.8731e+05, 3.8421e+05, 3.8421e+05, 3.8420e+05,
         7.6884e+05, 7.7310e+05, 3.8418e+05, 3.8419e+05, 3.8422e+05, 3.8425e+05,
         3.8422e+05, 7.7570e+05],
        [3.8446e+05, 3.9228e+05, 4.0530e+05, 3.4253e+00, 3.8422e+05, 0.0000e+00,
         3.1715e+00, 3.5002e+00, 3.8711e+05, 3.5262e+00, 3.3507e+00, 3.1600e+00,
         3.9254e+05, 3.9055e+05, 3.5387e+00, 3.4250e+00, 3.4322e+00, 3.4294e+00,
         3.3188e+00, 3.8801e+05],
        [3.8437e+05, 3.9230e+05, 4.0530e+05, 3.4894e+00, 3.8417e+05, 3.1715e+00,
         0.0000e+00, 3.6368e+00, 3.8714e+05, 3.4894e+00, 3.4726e+00, 3.3660e+00,
         3.9251e+05, 3.9058e+05, 3.4110e+00, 3.4455e+00, 3.5771e+00, 3.6530e+00,
         3.3425e+00, 3.8798e+05],
        [3.8439e+05, 3.9234e+05, 4.0526e+05, 3.6768e+00, 3.8415e+05, 3.5002e+00,
         3.6368e+00, 0.0000e+00, 3.8714e+05, 3.4817e+00, 3.4410e+00, 3.3939e+00,
         3.9256e+05, 3.9060e+05, 3.7260e+00, 3.7441e+00, 3.6039e+00, 3.7017e+00,
         3.5622e+00, 3.8796e+05],
        [7.6909e+05, 7.7845e+05, 8.1293e+05, 3.8717e+05, 7.8731e+05, 3.8711e+05,
         3.8714e+05, 3.8714e+05, 0.0000e+00, 3.8710e+05, 3.8707e+05, 3.8713e+05,
         7.5694e+05, 7.6773e+05, 3.8707e+05, 3.8712e+05, 3.8716e+05, 3.8710e+05,
         3.8713e+05, 7.8139e+05],
        [3.8438e+05, 3.9235e+05, 4.0531e+05, 3.6626e+00, 3.8421e+05, 3.5262e+00,
         3.4894e+00, 3.4817e+00, 3.8710e+05, 0.0000e+00, 3.5291e+00, 3.6332e+00,
         3.9254e+05, 3.9054e+05, 3.6630e+00, 3.2710e+00, 3.6367e+00, 3.4101e+00,
         3.7143e+00, 3.8798e+05],
        [3.8440e+05, 3.9228e+05, 4.0531e+05, 3.2421e+00, 3.8421e+05, 3.3507e+00,
         3.4726e+00, 3.4410e+00, 3.8707e+05, 3.5291e+00, 0.0000e+00, 3.3698e+00,
         3.9254e+05, 3.9053e+05, 3.5159e+00, 3.2192e+00, 3.4683e+00, 3.5163e+00,
         3.1824e+00, 3.8799e+05],
        [3.8433e+05, 3.9232e+05, 4.0525e+05, 3.3988e+00, 3.8420e+05, 3.1600e+00,
         3.3660e+00, 3.3939e+00, 3.8713e+05, 3.6332e+00, 3.3698e+00, 0.0000e+00,
         3.9256e+05, 3.9058e+05, 3.6872e+00, 3.4289e+00, 3.4466e+00, 3.5471e+00,
         3.2157e+00, 3.8799e+05],
        [7.8621e+05, 7.9525e+05, 8.0045e+05, 3.9252e+05, 7.6884e+05, 3.9254e+05,
         3.9251e+05, 3.9256e+05, 7.5694e+05, 3.9254e+05, 3.9254e+05, 3.9256e+05,
         0.0000e+00, 7.8612e+05, 3.9256e+05, 3.9253e+05, 3.9256e+05, 3.9252e+05,
         3.9253e+05, 7.6954e+05],
        [7.6897e+05, 7.6939e+05, 8.1271e+05, 3.9059e+05, 7.7310e+05, 3.9055e+05,
         3.9058e+05, 3.9060e+05, 7.6773e+05, 3.9054e+05, 3.9053e+05, 3.9058e+05,
         7.8612e+05, 0.0000e+00, 3.9054e+05, 3.9055e+05, 3.9058e+05, 3.9060e+05,
         3.9062e+05, 7.6064e+05],
        [3.8438e+05, 3.9228e+05, 4.0527e+05, 3.4091e+00, 3.8418e+05, 3.5387e+00,
         3.4110e+00, 3.7260e+00, 3.8707e+05, 3.6630e+00, 3.5159e+00, 3.6872e+00,
         3.9256e+05, 3.9054e+05, 0.0000e+00, 3.5797e+00, 3.6728e+00, 3.8261e+00,
         3.5209e+00, 3.8805e+05],
        [3.8432e+05, 3.9229e+05, 4.0532e+05, 3.5371e+00, 3.8419e+05, 3.4250e+00,
         3.4455e+00, 3.7441e+00, 3.8712e+05, 3.2710e+00, 3.2192e+00, 3.4289e+00,
         3.9253e+05, 3.9055e+05, 3.5797e+00, 0.0000e+00, 3.5885e+00, 3.6179e+00,
         3.5133e+00, 3.8801e+05],
        [3.8438e+05, 3.9234e+05, 4.0533e+05, 3.6289e+00, 3.8422e+05, 3.4322e+00,
         3.5771e+00, 3.6039e+00, 3.8716e+05, 3.6367e+00, 3.4683e+00, 3.4466e+00,
         3.9256e+05, 3.9058e+05, 3.6728e+00, 3.5885e+00, 0.0000e+00, 3.6014e+00,
         3.6824e+00, 3.8804e+05],
        [3.8438e+05, 3.9233e+05, 4.0529e+05, 3.5504e+00, 3.8425e+05, 3.4294e+00,
         3.6530e+00, 3.7017e+00, 3.8710e+05, 3.4101e+00, 3.5163e+00, 3.5471e+00,
         3.9252e+05, 3.9060e+05, 3.8261e+00, 3.6179e+00, 3.6014e+00, 0.0000e+00,
         3.5154e+00, 3.8800e+05],
        [3.8433e+05, 3.9236e+05, 4.0530e+05, 3.4905e+00, 3.8422e+05, 3.3188e+00,
         3.3425e+00, 3.5622e+00, 3.8713e+05, 3.7143e+00, 3.1824e+00, 3.2157e+00,
         3.9253e+05, 3.9062e+05, 3.5209e+00, 3.5133e+00, 3.6824e+00, 3.5154e+00,
         0.0000e+00, 3.8804e+05],
        [7.7665e+05, 7.8228e+05, 8.1460e+05, 3.8796e+05, 7.7570e+05, 3.8801e+05,
         3.8798e+05, 3.8796e+05, 7.8139e+05, 3.8798e+05, 3.8799e+05, 3.8799e+05,
         7.6954e+05, 7.6064e+05, 3.8805e+05, 3.8801e+05, 3.8804e+05, 3.8800e+05,
         3.8804e+05, 0.0000e+00]])
Krum scores: ['384362.41', '392311.28', '405289.28', '3.48', '384195.09', '3.37', '3.44', '3.57', '387110.94', '3.53', '3.38', '3.40', '392534.31', '390563.06', '3.57', '3.46', '3.57', '3.55', '3.43', '387991.81']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [17, 14, 15, 9, 16, 10, 2, 7, 19, 8, 4, 5, 18, 13, 6, 11, 1, 12, 3, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0056s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:02...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [197  66]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:02, End: 2025-07-22 15:47:02)
start time is: 98191377741317, end time is: 98204297672238
The total time is: 12919930921ns.

 ------- aggregate method: krum, random_seed: 200 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [17, 7], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[     0.0000, 378268.4375],
        [378268.4375,      0.0000]])
Krum scores: ['nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [17, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0009s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:02...
global Accuracy on shared test data: 51.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 13 224]
 [ 19 244]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:02, End: 2025-07-22 15:47:02)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [13, 15, 7, 5, 3], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
tensor([[0.0000e+00, 7.2927e+05, 3.7789e+05, 3.7788e+05, 3.7791e+05],
        [7.2927e+05, 0.0000e+00, 3.7938e+05, 3.7938e+05, 3.7938e+05],
        [3.7789e+05, 3.7938e+05, 0.0000e+00, 3.0888e+00, 2.9556e+00],
        [3.7788e+05, 3.7938e+05, 3.0888e+00, 0.0000e+00, 2.9872e+00],
        [3.7791e+05, 3.7938e+05, 2.9556e+00, 2.9872e+00, 0.0000e+00]])
Krum scores: ['377883.88', '379377.50', '2.96', '2.99', '2.96']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']], selected_client_indices: [13, 15, 7, 5, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0012s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:03...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 16 221]
 [ 19 244]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:03, End: 2025-07-22 15:47:03)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [5], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
tensor([[0.]])
Krum scores: ['nan']
Selected index: 0
krum, clients_type: [['Chosen Update']], selected_client_indices: [5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:03...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 19 218]
 [ 22 241]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:47:03, End: 2025-07-22 15:47:03)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [5, 13, 10, 17, 16, 9, 11, 18, 6], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 3.8431e+05, 3.1243e+00, 3.7774e+05, 3.8752e+05, 3.0909e+00,
         3.0494e+00, 3.9092e+05, 3.1284e+00],
        [3.8431e+05, 0.0000e+00, 3.8435e+05, 7.7163e+05, 7.5631e+05, 3.8431e+05,
         3.8438e+05, 7.5998e+05, 3.8430e+05],
        [3.1243e+00, 3.8435e+05, 0.0000e+00, 3.7770e+05, 3.8751e+05, 3.3454e+00,
         3.1803e+00, 3.9087e+05, 3.0244e+00],
        [3.7774e+05, 7.7163e+05, 3.7770e+05, 0.0000e+00, 7.7650e+05, 3.7775e+05,
         3.7775e+05, 7.6753e+05, 3.7772e+05],
        [3.8752e+05, 7.5631e+05, 3.8751e+05, 7.7650e+05, 0.0000e+00, 3.8746e+05,
         3.8753e+05, 7.7907e+05, 3.8749e+05],
        [3.0909e+00, 3.8431e+05, 3.3454e+00, 3.7775e+05, 3.8746e+05, 0.0000e+00,
         3.0063e+00, 3.9088e+05, 3.1904e+00],
        [3.0494e+00, 3.8438e+05, 3.1803e+00, 3.7775e+05, 3.8753e+05, 3.0063e+00,
         0.0000e+00, 3.9089e+05, 3.0440e+00],
        [3.9092e+05, 7.5998e+05, 3.9087e+05, 7.6753e+05, 7.7907e+05, 3.9088e+05,
         3.9089e+05, 0.0000e+00, 3.9088e+05],
        [3.1284e+00, 3.8430e+05, 3.0244e+00, 3.7772e+05, 3.8749e+05, 3.1904e+00,
         3.0440e+00, 3.9088e+05, 0.0000e+00]])
Krum scores: ['3.09', '384308.03', '3.11', '377719.12', '387488.25', '3.10', '3.03', '390876.88', '3.07']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']], selected_client_indices: [5, 13, 10, 17, 16, 9, 11, 18, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0021s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:03...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 23 214]
 [ 22 241]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:03, End: 2025-07-22 15:47:03)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [16, 5, 18, 10, 19, 9, 14, 11, 20, 4, 8, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 3.9119e+05, 7.9426e+05, 3.9124e+05, 7.9120e+05, 3.9124e+05,
         7.6327e+05, 3.9119e+05, 7.9524e+05, 3.9123e+05, 3.9122e+05, 3.9118e+05],
        [3.9119e+05, 0.0000e+00, 3.8371e+05, 3.0950e+00, 3.9545e+05, 3.0686e+00,
         3.9177e+05, 2.9890e+00, 3.9414e+05, 2.6838e+00, 3.3648e+00, 3.2338e+00],
        [7.9426e+05, 3.8371e+05, 0.0000e+00, 3.8375e+05, 7.6595e+05, 3.8370e+05,
         7.5847e+05, 3.8373e+05, 8.0129e+05, 3.8370e+05, 3.8374e+05, 3.8375e+05],
        [3.9124e+05, 3.0950e+00, 3.8375e+05, 0.0000e+00, 3.9552e+05, 3.3191e+00,
         3.9181e+05, 3.1806e+00, 3.9421e+05, 2.8007e+00, 3.0952e+00, 3.0831e+00],
        [7.9120e+05, 3.9545e+05, 7.6595e+05, 3.9552e+05, 0.0000e+00, 3.9547e+05,
         7.8760e+05, 3.9549e+05, 8.1075e+05, 3.9547e+05, 3.9550e+05, 3.9547e+05],
        [3.9124e+05, 3.0686e+00, 3.8370e+05, 3.3191e+00, 3.9547e+05, 0.0000e+00,
         3.9184e+05, 2.9558e+00, 3.9419e+05, 3.1323e+00, 3.2640e+00, 3.2446e+00],
        [7.6327e+05, 3.9177e+05, 7.5847e+05, 3.9181e+05, 7.8760e+05, 3.9184e+05,
         0.0000e+00, 3.9183e+05, 7.9485e+05, 3.9183e+05, 3.9181e+05, 3.9180e+05],
        [3.9119e+05, 2.9890e+00, 3.8373e+05, 3.1806e+00, 3.9549e+05, 2.9558e+00,
         3.9183e+05, 0.0000e+00, 3.9418e+05, 2.9228e+00, 3.1534e+00, 3.1128e+00],
        [7.9524e+05, 3.9414e+05, 8.0129e+05, 3.9421e+05, 8.1075e+05, 3.9419e+05,
         7.9485e+05, 3.9418e+05, 0.0000e+00, 3.9415e+05, 3.9415e+05, 3.9416e+05],
        [3.9123e+05, 2.6838e+00, 3.8370e+05, 2.8007e+00, 3.9547e+05, 3.1323e+00,
         3.9183e+05, 2.9228e+00, 3.9415e+05, 0.0000e+00, 3.1469e+00, 2.9643e+00],
        [3.9122e+05, 3.3648e+00, 3.8374e+05, 3.0952e+00, 3.9550e+05, 3.2640e+00,
         3.9181e+05, 3.1534e+00, 3.9415e+05, 3.1469e+00, 0.0000e+00, 3.6974e+00],
        [3.9118e+05, 3.2338e+00, 3.8375e+05, 3.0831e+00, 3.9547e+05, 3.2446e+00,
         3.9180e+05, 3.1128e+00, 3.9416e+05, 2.9643e+00, 3.6974e+00, 0.0000e+00]])
Krum scores: ['391202.22', '3.01', '383715.28', '3.05', '395470.66', '3.13', '391802.31', '3.03', '394156.38', '2.90', '3.20', '3.13']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']], selected_client_indices: [16, 5, 18, 10, 19, 9, 14, 11, 20, 4, 8, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0025s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:04...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 28 209]
 [ 31 232]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:04, End: 2025-07-22 15:47:04)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [3, 17, 2, 19, 16, 1, 6, 15, 14, 11, 13, 20, 4, 9, 5, 8], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8267e+05, 2.8495e+00, 3.8910e+05, 3.9830e+05, 2.9303e+00,
         2.9279e+00, 3.9216e+05, 3.9846e+05, 3.0116e+00, 3.8110e+05, 3.8566e+05,
         3.0832e+00, 3.1909e+00, 3.0556e+00, 3.2741e+00],
        [3.8267e+05, 0.0000e+00, 3.8265e+05, 7.8025e+05, 7.9742e+05, 3.8265e+05,
         3.8272e+05, 7.6608e+05, 7.9015e+05, 3.8269e+05, 7.5464e+05, 7.6452e+05,
         3.8268e+05, 3.8265e+05, 3.8272e+05, 3.8268e+05],
        [2.8495e+00, 3.8265e+05, 0.0000e+00, 3.8913e+05, 3.9834e+05, 2.7535e+00,
         2.8729e+00, 3.9213e+05, 3.9852e+05, 2.8049e+00, 3.8110e+05, 3.8567e+05,
         3.0647e+00, 2.9910e+00, 2.9126e+00, 3.2654e+00],
        [3.8910e+05, 7.8025e+05, 3.8913e+05, 0.0000e+00, 7.9235e+05, 3.8912e+05,
         3.8913e+05, 7.8219e+05, 8.0843e+05, 3.8913e+05, 7.8190e+05, 7.4544e+05,
         3.8914e+05, 3.8908e+05, 3.8915e+05, 3.8915e+05],
        [3.9830e+05, 7.9742e+05, 3.9834e+05, 7.9235e+05, 0.0000e+00, 3.9831e+05,
         3.9834e+05, 8.0234e+05, 7.8562e+05, 3.9834e+05, 7.5871e+05, 7.7705e+05,
         3.9831e+05, 3.9837e+05, 3.9836e+05, 3.9837e+05],
        [2.9303e+00, 3.8265e+05, 2.7535e+00, 3.8912e+05, 3.9831e+05, 0.0000e+00,
         3.2704e+00, 3.9213e+05, 3.9850e+05, 2.8821e+00, 3.8107e+05, 3.8562e+05,
         3.3237e+00, 2.9481e+00, 3.1774e+00, 3.2051e+00],
        [2.9279e+00, 3.8272e+05, 2.8729e+00, 3.8913e+05, 3.9834e+05, 3.2704e+00,
         0.0000e+00, 3.9217e+05, 3.9849e+05, 3.1736e+00, 3.8114e+05, 3.8565e+05,
         2.9457e+00, 3.2804e+00, 3.2107e+00, 3.5670e+00],
        [3.9216e+05, 7.6608e+05, 3.9213e+05, 7.8219e+05, 8.0234e+05, 3.9213e+05,
         3.9217e+05, 0.0000e+00, 8.0250e+05, 3.9213e+05, 7.5315e+05, 7.8967e+05,
         3.9219e+05, 3.9218e+05, 3.9222e+05, 3.9216e+05],
        [3.9846e+05, 7.9015e+05, 3.9852e+05, 8.0843e+05, 7.8562e+05, 3.9850e+05,
         3.9849e+05, 8.0250e+05, 0.0000e+00, 3.9849e+05, 7.7426e+05, 7.7598e+05,
         3.9850e+05, 3.9852e+05, 3.9856e+05, 3.9850e+05],
        [3.0116e+00, 3.8269e+05, 2.8049e+00, 3.8913e+05, 3.9834e+05, 2.8821e+00,
         3.1736e+00, 3.9213e+05, 3.9849e+05, 0.0000e+00, 3.8106e+05, 3.8567e+05,
         3.0118e+00, 3.0270e+00, 2.9563e+00, 3.0716e+00],
        [3.8110e+05, 7.5464e+05, 3.8110e+05, 7.8190e+05, 7.5871e+05, 3.8107e+05,
         3.8114e+05, 7.5315e+05, 7.7426e+05, 3.8106e+05, 0.0000e+00, 7.7649e+05,
         3.8107e+05, 3.8107e+05, 3.8111e+05, 3.8109e+05],
        [3.8566e+05, 7.6452e+05, 3.8567e+05, 7.4544e+05, 7.7705e+05, 3.8562e+05,
         3.8565e+05, 7.8967e+05, 7.7598e+05, 3.8567e+05, 7.7649e+05, 0.0000e+00,
         3.8568e+05, 3.8568e+05, 3.8565e+05, 3.8567e+05],
        [3.0832e+00, 3.8268e+05, 3.0647e+00, 3.8914e+05, 3.9831e+05, 3.3237e+00,
         2.9457e+00, 3.9219e+05, 3.9850e+05, 3.0118e+00, 3.8107e+05, 3.8568e+05,
         0.0000e+00, 3.1650e+00, 2.7498e+00, 3.1457e+00],
        [3.1909e+00, 3.8265e+05, 2.9910e+00, 3.8908e+05, 3.9837e+05, 2.9481e+00,
         3.2804e+00, 3.9218e+05, 3.9852e+05, 3.0270e+00, 3.8107e+05, 3.8568e+05,
         3.1650e+00, 0.0000e+00, 3.0989e+00, 3.2064e+00],
        [3.0556e+00, 3.8272e+05, 2.9126e+00, 3.8915e+05, 3.9836e+05, 3.1774e+00,
         3.2107e+00, 3.9222e+05, 3.9856e+05, 2.9563e+00, 3.8111e+05, 3.8565e+05,
         2.7498e+00, 3.0989e+00, 0.0000e+00, 3.2554e+00],
        [3.2741e+00, 3.8268e+05, 3.2654e+00, 3.8915e+05, 3.9837e+05, 3.2051e+00,
         3.5670e+00, 3.9216e+05, 3.9850e+05, 3.0716e+00, 3.8109e+05, 3.8567e+05,
         3.1457e+00, 3.2064e+00, 3.2554e+00, 0.0000e+00]])
Krum scores: ['3.01', '382665.09', '2.89', '389119.44', '398331.03', '3.02', '3.10', '392151.66', '398494.53', '2.97', '381081.97', '385656.56', '3.02', '3.09', '3.02', '3.20']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 17, 2, 19, 16, 1, 6, 15, 14, 11, 13, 20, 4, 9, 5, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0035s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:04...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 34 203]
 [ 33 230]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:04, End: 2025-07-22 15:47:04)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [12, 11], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 3.0156],
        [3.0156, 0.0000]])
Krum scores: ['nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [12, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0008s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:04...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 41 196]
 [ 41 222]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:04, End: 2025-07-22 15:47:04)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (6): [19, 5, 1, 8, 17, 20], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 6
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([6])
tensor([[0.0000e+00, 4.0835e+05, 4.0829e+05, 4.0833e+05, 7.9293e+05, 7.9787e+05],
        [4.0835e+05, 0.0000e+00, 3.1638e+00, 3.1921e+00, 4.0351e+05, 3.7766e+05],
        [4.0829e+05, 3.1638e+00, 0.0000e+00, 3.2745e+00, 4.0351e+05, 3.7770e+05],
        [4.0833e+05, 3.1921e+00, 3.2745e+00, 0.0000e+00, 4.0352e+05, 3.7766e+05],
        [7.9293e+05, 4.0351e+05, 4.0351e+05, 4.0352e+05, 0.0000e+00, 7.6992e+05],
        [7.9787e+05, 3.7766e+05, 3.7770e+05, 3.7766e+05, 7.6992e+05, 0.0000e+00]])
Krum scores: ['408289.06', '3.16', '3.16', '3.19', '403510.12', '377661.47']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']], selected_client_indices: [19, 5, 1, 8, 17, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0014s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:05...
global Accuracy on shared test data: 53.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 47 190]
 [ 45 218]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:05, End: 2025-07-22 15:47:05)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [14, 15, 8, 11, 4, 18, 5], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 7.6669e+05, 4.0151e+05, 4.0150e+05, 4.0152e+05, 8.1704e+05,
         4.0153e+05],
        [7.6669e+05, 0.0000e+00, 3.9168e+05, 3.9172e+05, 3.9171e+05, 7.7754e+05,
         3.9175e+05],
        [4.0151e+05, 3.9168e+05, 0.0000e+00, 3.1669e+00, 3.2539e+00, 3.9525e+05,
         3.1711e+00],
        [4.0150e+05, 3.9172e+05, 3.1669e+00, 0.0000e+00, 3.0893e+00, 3.9527e+05,
         2.9034e+00],
        [4.0152e+05, 3.9171e+05, 3.2539e+00, 3.0893e+00, 0.0000e+00, 3.9522e+05,
         2.9094e+00],
        [8.1704e+05, 7.7754e+05, 3.9525e+05, 3.9527e+05, 3.9522e+05, 0.0000e+00,
         3.9522e+05],
        [4.0153e+05, 3.9175e+05, 3.1711e+00, 2.9034e+00, 2.9094e+00, 3.9522e+05,
         0.0000e+00]])
Krum scores: ['401506.53', '391698.72', '3.17', '3.00', '3.00', '395220.31', '2.91']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']], selected_client_indices: [14, 15, 8, 11, 4, 18, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0309s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:05...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 57 180]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:05, End: 2025-07-22 15:47:05)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [6, 11, 13, 7, 9, 15, 16, 19, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 3.1354e+00, 3.8892e+05, 3.3330e+00, 3.2898e+00, 3.9084e+05,
         3.8266e+05, 3.8228e+05, 3.1441e+00],
        [3.1354e+00, 0.0000e+00, 3.8888e+05, 3.2700e+00, 3.3157e+00, 3.9079e+05,
         3.8264e+05, 3.8224e+05, 3.2208e+00],
        [3.8892e+05, 3.8888e+05, 0.0000e+00, 3.8890e+05, 3.8897e+05, 7.6012e+05,
         7.5922e+05, 7.6618e+05, 3.8890e+05],
        [3.3330e+00, 3.2700e+00, 3.8890e+05, 0.0000e+00, 3.9947e+00, 3.9077e+05,
         3.8264e+05, 3.8225e+05, 3.2632e+00],
        [3.2898e+00, 3.3157e+00, 3.8897e+05, 3.9947e+00, 0.0000e+00, 3.9078e+05,
         3.8265e+05, 3.8227e+05, 3.5800e+00],
        [3.9084e+05, 3.9079e+05, 7.6012e+05, 3.9077e+05, 3.9078e+05, 0.0000e+00,
         7.5376e+05, 7.9003e+05, 3.9080e+05],
        [3.8266e+05, 3.8264e+05, 7.5922e+05, 3.8264e+05, 3.8265e+05, 7.5376e+05,
         0.0000e+00, 7.6145e+05, 3.8267e+05],
        [3.8228e+05, 3.8224e+05, 7.6618e+05, 3.8225e+05, 3.8227e+05, 7.9003e+05,
         7.6145e+05, 0.0000e+00, 3.8228e+05],
        [3.1441e+00, 3.2208e+00, 3.8890e+05, 3.2632e+00, 3.5800e+00, 3.9080e+05,
         3.8267e+05, 3.8228e+05, 0.0000e+00]])
Krum scores: ['3.19', '3.21', '388892.41', '3.29', '3.40', '390779.00', '382642.72', '382257.28', '3.21']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [6, 11, 13, 7, 9, 15, 16, 19, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0206s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:05...
global Accuracy on shared test data: 54.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 71 166]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:05, End: 2025-07-22 15:47:05)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [7, 5, 14], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[0.0000e+00, 3.3669e+00, 3.8550e+05],
        [3.3669e+00, 0.0000e+00, 3.8551e+05],
        [3.8550e+05, 3.8551e+05, 0.0000e+00]])
Krum scores: ['nan', 'nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']], selected_client_indices: [7, 5, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0010s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:06...
global Accuracy on shared test data: 55.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 82 155]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:06, End: 2025-07-22 15:47:06)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (4): [1, 11, 7, 15], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 4
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([4])
tensor([[0.0000e+00, 3.1550e+00, 3.5240e+00, 3.9918e+05],
        [3.1550e+00, 0.0000e+00, 3.4660e+00, 3.9921e+05],
        [3.5240e+00, 3.4660e+00, 0.0000e+00, 3.9925e+05],
        [3.9918e+05, 3.9921e+05, 3.9925e+05, 0.0000e+00]])
Krum scores: ['3.16', '3.16', '3.47', '399176.22']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']], selected_client_indices: [1, 11, 7, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0017s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:06...
global Accuracy on shared test data: 55.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 92 145]
 [ 79 184]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:06, End: 2025-07-22 15:47:06)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [15, 16, 10, 7, 18, 12, 8, 19, 5, 6, 11, 13], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 7.9044e+05, 3.8817e+05, 3.8821e+05, 7.9125e+05, 3.8822e+05,
         3.8820e+05, 7.6975e+05, 3.8821e+05, 3.8819e+05, 3.8819e+05, 7.7289e+05],
        [7.9044e+05, 0.0000e+00, 3.8879e+05, 3.8876e+05, 7.8375e+05, 3.8874e+05,
         3.8876e+05, 7.7766e+05, 3.8876e+05, 3.8874e+05, 3.8876e+05, 7.6366e+05],
        [3.8817e+05, 3.8879e+05, 0.0000e+00, 3.4928e+00, 4.0598e+05, 3.4192e+00,
         3.5506e+00, 3.8833e+05, 3.6106e+00, 3.3736e+00, 3.5716e+00, 3.8527e+05],
        [3.8821e+05, 3.8876e+05, 3.4928e+00, 0.0000e+00, 4.0600e+05, 3.4238e+00,
         3.9732e+00, 3.8834e+05, 3.4534e+00, 3.3419e+00, 3.5846e+00, 3.8520e+05],
        [7.9125e+05, 7.8375e+05, 4.0598e+05, 4.0600e+05, 0.0000e+00, 4.0597e+05,
         4.0602e+05, 7.8866e+05, 4.0600e+05, 4.0600e+05, 4.0597e+05, 7.9869e+05],
        [3.8822e+05, 3.8874e+05, 3.4192e+00, 3.4238e+00, 4.0597e+05, 0.0000e+00,
         4.0981e+00, 3.8833e+05, 3.1285e+00, 3.1677e+00, 3.5397e+00, 3.8523e+05],
        [3.8820e+05, 3.8876e+05, 3.5506e+00, 3.9732e+00, 4.0602e+05, 4.0981e+00,
         0.0000e+00, 3.8829e+05, 3.8666e+00, 3.9551e+00, 3.7382e+00, 3.8517e+05],
        [7.6975e+05, 7.7766e+05, 3.8833e+05, 3.8834e+05, 7.8866e+05, 3.8833e+05,
         3.8829e+05, 0.0000e+00, 3.8830e+05, 3.8833e+05, 3.8830e+05, 7.6768e+05],
        [3.8821e+05, 3.8876e+05, 3.6106e+00, 3.4534e+00, 4.0600e+05, 3.1285e+00,
         3.8666e+00, 3.8830e+05, 0.0000e+00, 3.4309e+00, 3.1849e+00, 3.8517e+05],
        [3.8819e+05, 3.8874e+05, 3.3736e+00, 3.3419e+00, 4.0600e+05, 3.1677e+00,
         3.9551e+00, 3.8833e+05, 3.4309e+00, 0.0000e+00, 3.5470e+00, 3.8522e+05],
        [3.8819e+05, 3.8876e+05, 3.5716e+00, 3.5846e+00, 4.0597e+05, 3.5397e+00,
         3.7382e+00, 3.8830e+05, 3.1849e+00, 3.5470e+00, 0.0000e+00, 3.8521e+05],
        [7.7289e+05, 7.6366e+05, 3.8527e+05, 3.8520e+05, 7.9869e+05, 3.8523e+05,
         3.8517e+05, 7.6768e+05, 3.8517e+05, 3.8522e+05, 3.8521e+05, 0.0000e+00]])
Krum scores: ['388195.03', '388750.00', '3.48', '3.46', '405984.34', '3.34', '3.82', '388310.31', '3.36', '3.37', '3.49', '385192.78']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [15, 16, 10, 7, 18, 12, 8, 19, 5, 6, 11, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0116s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:06...
global Accuracy on shared test data: 55.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[101 136]
 [ 88 175]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:06, End: 2025-07-22 15:47:06)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [4, 1, 2, 20, 7, 19, 8, 9, 12, 5, 18, 13, 15, 16, 14], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.5984e+00, 3.6319e+00, 3.8244e+05, 3.3546e+00, 3.8534e+05,
         3.5620e+00, 3.4450e+00, 3.5358e+00, 3.2443e+00, 3.8930e+05, 3.8208e+05,
         3.9810e+05, 4.0063e+05, 3.8422e+05],
        [3.5984e+00, 0.0000e+00, 3.4392e+00, 3.8242e+05, 3.5856e+00, 3.8532e+05,
         3.5871e+00, 3.5114e+00, 3.7434e+00, 3.4847e+00, 3.8934e+05, 3.8204e+05,
         3.9811e+05, 4.0066e+05, 3.8416e+05],
        [3.6319e+00, 3.4392e+00, 0.0000e+00, 3.8238e+05, 3.5194e+00, 3.8534e+05,
         3.6597e+00, 3.4702e+00, 3.5251e+00, 3.4512e+00, 3.8936e+05, 3.8204e+05,
         3.9815e+05, 4.0064e+05, 3.8414e+05],
        [3.8244e+05, 3.8242e+05, 3.8238e+05, 0.0000e+00, 3.8242e+05, 7.6199e+05,
         3.8238e+05, 3.8238e+05, 3.8239e+05, 3.8243e+05, 7.9136e+05, 7.6511e+05,
         7.8769e+05, 7.9331e+05, 7.4591e+05],
        [3.3546e+00, 3.5856e+00, 3.5194e+00, 3.8242e+05, 0.0000e+00, 3.8535e+05,
         3.7079e+00, 3.5426e+00, 3.4604e+00, 3.6317e+00, 3.8935e+05, 3.8207e+05,
         3.9817e+05, 4.0065e+05, 3.8415e+05],
        [3.8534e+05, 3.8532e+05, 3.8534e+05, 7.6199e+05, 3.8535e+05, 0.0000e+00,
         3.8533e+05, 3.8524e+05, 3.8527e+05, 3.8526e+05, 7.5864e+05, 7.6706e+05,
         8.1112e+05, 7.8204e+05, 7.3438e+05],
        [3.5620e+00, 3.5871e+00, 3.6597e+00, 3.8238e+05, 3.7079e+00, 3.8533e+05,
         0.0000e+00, 3.5353e+00, 4.1115e+00, 3.8034e+00, 3.8932e+05, 3.8213e+05,
         3.9814e+05, 4.0067e+05, 3.8420e+05],
        [3.4450e+00, 3.5114e+00, 3.4702e+00, 3.8238e+05, 3.5426e+00, 3.8524e+05,
         3.5353e+00, 0.0000e+00, 3.5845e+00, 3.4631e+00, 3.8937e+05, 3.8208e+05,
         3.9814e+05, 4.0064e+05, 3.8416e+05],
        [3.5358e+00, 3.7434e+00, 3.5251e+00, 3.8239e+05, 3.4604e+00, 3.8527e+05,
         4.1115e+00, 3.5845e+00, 0.0000e+00, 3.2210e+00, 3.8934e+05, 3.8207e+05,
         3.9814e+05, 4.0064e+05, 3.8420e+05],
        [3.2443e+00, 3.4847e+00, 3.4512e+00, 3.8243e+05, 3.6317e+00, 3.8526e+05,
         3.8034e+00, 3.4631e+00, 3.2210e+00, 0.0000e+00, 3.8935e+05, 3.8216e+05,
         3.9814e+05, 4.0055e+05, 3.8414e+05],
        [3.8930e+05, 3.8934e+05, 3.8936e+05, 7.9136e+05, 3.8935e+05, 7.5864e+05,
         3.8932e+05, 3.8937e+05, 3.8934e+05, 3.8935e+05, 0.0000e+00, 7.6349e+05,
         7.8719e+05, 8.0264e+05, 7.6425e+05],
        [3.8208e+05, 3.8204e+05, 3.8204e+05, 7.6511e+05, 3.8207e+05, 7.6706e+05,
         3.8213e+05, 3.8208e+05, 3.8207e+05, 3.8216e+05, 7.6349e+05, 0.0000e+00,
         7.8858e+05, 7.8779e+05, 7.7692e+05],
        [3.9810e+05, 3.9811e+05, 3.9815e+05, 7.8769e+05, 3.9817e+05, 8.1112e+05,
         3.9814e+05, 3.9814e+05, 3.9814e+05, 3.9814e+05, 7.8719e+05, 7.8858e+05,
         0.0000e+00, 8.1154e+05, 7.7590e+05],
        [4.0063e+05, 4.0066e+05, 4.0064e+05, 7.9331e+05, 4.0065e+05, 7.8204e+05,
         4.0067e+05, 4.0064e+05, 4.0064e+05, 4.0055e+05, 8.0264e+05, 7.8779e+05,
         8.1154e+05, 0.0000e+00, 7.7990e+05],
        [3.8422e+05, 3.8416e+05, 3.8414e+05, 7.4591e+05, 3.8415e+05, 7.3438e+05,
         3.8420e+05, 3.8416e+05, 3.8420e+05, 3.8414e+05, 7.6425e+05, 7.7692e+05,
         7.7590e+05, 7.7990e+05, 0.0000e+00]])
Krum scores: ['3.46', '3.53', '3.51', '382394.41', '3.52', '385291.69', '3.64', '3.49', '3.51', '3.42', '389335.31', '382062.66', '398127.72', '400624.56', '384156.75']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [4, 1, 2, 20, 7, 19, 8, 9, 12, 5, 18, 13, 15, 16, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0223s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:07...
global Accuracy on shared test data: 54.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[109 128]
 [100 163]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:07, End: 2025-07-22 15:47:07)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [3, 7, 18, 15, 10, 19, 1, 6, 8, 2, 16, 4, 12, 5, 11], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.1251e+00, 3.9253e+05, 3.8300e+05, 2.9925e+00, 3.7281e+05,
         3.2406e+00, 3.3747e+00, 3.5913e+00, 3.4468e+00, 4.0591e+05, 3.2393e+00,
         3.4732e+00, 3.5197e+00, 3.5263e+00],
        [3.1251e+00, 0.0000e+00, 3.9255e+05, 3.8305e+05, 3.2721e+00, 3.7282e+05,
         3.6264e+00, 3.5100e+00, 3.6492e+00, 3.3921e+00, 4.0601e+05, 3.2739e+00,
         3.4458e+00, 3.7058e+00, 3.7461e+00],
        [3.9253e+05, 3.9255e+05, 0.0000e+00, 7.7847e+05, 3.9255e+05, 7.6352e+05,
         3.9256e+05, 3.9255e+05, 3.9253e+05, 3.9258e+05, 8.1272e+05, 3.9258e+05,
         3.9262e+05, 3.9252e+05, 3.9255e+05],
        [3.8300e+05, 3.8305e+05, 7.7847e+05, 0.0000e+00, 3.8301e+05, 7.5233e+05,
         3.8297e+05, 3.8298e+05, 3.8298e+05, 3.8298e+05, 7.7838e+05, 3.8297e+05,
         3.8298e+05, 3.8298e+05, 3.8295e+05],
        [2.9925e+00, 3.2721e+00, 3.9255e+05, 3.8301e+05, 0.0000e+00, 3.7274e+05,
         3.4219e+00, 3.4178e+00, 3.6065e+00, 3.6427e+00, 4.0596e+05, 3.3471e+00,
         3.6664e+00, 3.5733e+00, 3.5651e+00],
        [3.7281e+05, 3.7282e+05, 7.6352e+05, 7.5233e+05, 3.7274e+05, 0.0000e+00,
         3.7282e+05, 3.7280e+05, 3.7278e+05, 3.7282e+05, 7.7200e+05, 3.7279e+05,
         3.7281e+05, 3.7276e+05, 3.7276e+05],
        [3.2406e+00, 3.6264e+00, 3.9256e+05, 3.8297e+05, 3.4219e+00, 3.7282e+05,
         0.0000e+00, 3.6237e+00, 3.6252e+00, 3.3427e+00, 4.0597e+05, 3.7043e+00,
         3.8321e+00, 3.4565e+00, 3.4680e+00],
        [3.3747e+00, 3.5100e+00, 3.9255e+05, 3.8298e+05, 3.4178e+00, 3.7280e+05,
         3.6237e+00, 0.0000e+00, 3.8345e+00, 3.2962e+00, 4.0598e+05, 3.7497e+00,
         3.4654e+00, 3.4076e+00, 3.7590e+00],
        [3.5913e+00, 3.6492e+00, 3.9253e+05, 3.8298e+05, 3.6065e+00, 3.7278e+05,
         3.6252e+00, 3.8345e+00, 0.0000e+00, 3.6834e+00, 4.0601e+05, 3.7092e+00,
         4.1716e+00, 3.7696e+00, 3.6442e+00],
        [3.4468e+00, 3.3921e+00, 3.9258e+05, 3.8298e+05, 3.6427e+00, 3.7282e+05,
         3.3427e+00, 3.2962e+00, 3.6834e+00, 0.0000e+00, 4.0598e+05, 3.6141e+00,
         3.5020e+00, 3.3390e+00, 3.6811e+00],
        [4.0591e+05, 4.0601e+05, 8.1272e+05, 7.7838e+05, 4.0596e+05, 7.7200e+05,
         4.0597e+05, 4.0598e+05, 4.0601e+05, 4.0598e+05, 0.0000e+00, 4.0596e+05,
         4.0605e+05, 4.0600e+05, 4.0596e+05],
        [3.2393e+00, 3.2739e+00, 3.9258e+05, 3.8297e+05, 3.3471e+00, 3.7279e+05,
         3.7043e+00, 3.7497e+00, 3.7092e+00, 3.6141e+00, 4.0596e+05, 0.0000e+00,
         3.7574e+00, 3.3408e+00, 3.6546e+00],
        [3.4732e+00, 3.4458e+00, 3.9262e+05, 3.8298e+05, 3.6664e+00, 3.7281e+05,
         3.8321e+00, 3.4654e+00, 4.1716e+00, 3.5020e+00, 4.0605e+05, 3.7574e+00,
         0.0000e+00, 3.3216e+00, 3.8010e+00],
        [3.5197e+00, 3.7058e+00, 3.9252e+05, 3.8298e+05, 3.5733e+00, 3.7276e+05,
         3.4565e+00, 3.4076e+00, 3.7696e+00, 3.3390e+00, 4.0600e+05, 3.3408e+00,
         3.3216e+00, 0.0000e+00, 3.5279e+00],
        [3.5263e+00, 3.7461e+00, 3.9255e+05, 3.8295e+05, 3.5651e+00, 3.7276e+05,
         3.4680e+00, 3.7590e+00, 3.6442e+00, 3.6811e+00, 4.0596e+05, 3.6546e+00,
         3.8010e+00, 3.5279e+00, 0.0000e+00]])
Krum scores: ['3.33', '3.44', '392546.34', '382976.25', '3.43', '372786.12', '3.50', '3.51', '3.68', '3.47', '405969.88', '3.51', '3.59', '3.47', '3.62']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [3, 7, 18, 15, 10, 19, 1, 6, 8, 2, 16, 4, 12, 5, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0158s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:08...
global Accuracy on shared test data: 54.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[116 121]
 [108 155]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:08, End: 2025-07-22 15:47:08)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [20, 16, 7, 4, 17, 15, 14, 11, 13, 19, 10, 8, 2, 3, 1], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 7.7331e+05, 3.9126e+05, 3.9124e+05, 7.7342e+05, 7.9096e+05,
         7.6374e+05, 3.9129e+05, 8.0260e+05, 7.7769e+05, 3.9131e+05, 3.9129e+05,
         3.9127e+05, 3.9128e+05, 3.9130e+05],
        [7.7331e+05, 0.0000e+00, 3.7327e+05, 3.7326e+05, 7.8938e+05, 7.8633e+05,
         7.6477e+05, 3.7320e+05, 7.7623e+05, 7.5507e+05, 3.7323e+05, 3.7323e+05,
         3.7324e+05, 3.7322e+05, 3.7327e+05],
        [3.9126e+05, 3.7327e+05, 0.0000e+00, 3.2666e+00, 3.9295e+05, 4.0866e+05,
         3.9577e+05, 3.7189e+00, 3.9882e+05, 3.9148e+05, 3.2809e+00, 3.6905e+00,
         3.4127e+00, 3.3286e+00, 3.5437e+00],
        [3.9124e+05, 3.7326e+05, 3.2666e+00, 0.0000e+00, 3.9293e+05, 4.0868e+05,
         3.9581e+05, 3.6806e+00, 3.9878e+05, 3.9155e+05, 3.3831e+00, 3.7743e+00,
         3.7382e+00, 3.3635e+00, 3.6685e+00],
        [7.7342e+05, 7.8938e+05, 3.9295e+05, 3.9293e+05, 0.0000e+00, 7.9625e+05,
         7.8264e+05, 3.9295e+05, 7.9735e+05, 7.8358e+05, 3.9287e+05, 3.9295e+05,
         3.9291e+05, 3.9293e+05, 3.9287e+05],
        [7.9096e+05, 7.8633e+05, 4.0866e+05, 4.0868e+05, 7.9625e+05, 0.0000e+00,
         7.9590e+05, 4.0871e+05, 8.1447e+05, 7.5902e+05, 4.0871e+05, 4.0872e+05,
         4.0867e+05, 4.0868e+05, 4.0866e+05],
        [7.6374e+05, 7.6477e+05, 3.9577e+05, 3.9581e+05, 7.8264e+05, 7.9590e+05,
         0.0000e+00, 3.9576e+05, 7.8878e+05, 7.9742e+05, 3.9584e+05, 3.9581e+05,
         3.9584e+05, 3.9582e+05, 3.9582e+05],
        [3.9129e+05, 3.7320e+05, 3.7189e+00, 3.6806e+00, 3.9295e+05, 4.0871e+05,
         3.9576e+05, 0.0000e+00, 3.9881e+05, 3.9147e+05, 3.4327e+00, 3.7745e+00,
         3.6875e+00, 3.6091e+00, 3.3455e+00],
        [8.0260e+05, 7.7623e+05, 3.9882e+05, 3.9878e+05, 7.9735e+05, 8.1447e+05,
         7.8878e+05, 3.9881e+05, 0.0000e+00, 8.1412e+05, 3.9880e+05, 3.9884e+05,
         3.9884e+05, 3.9884e+05, 3.9883e+05],
        [7.7769e+05, 7.5507e+05, 3.9148e+05, 3.9155e+05, 7.8358e+05, 7.5902e+05,
         7.9742e+05, 3.9147e+05, 8.1412e+05, 0.0000e+00, 3.9150e+05, 3.9146e+05,
         3.9147e+05, 3.9150e+05, 3.9150e+05],
        [3.9131e+05, 3.7323e+05, 3.2809e+00, 3.3831e+00, 3.9287e+05, 4.0871e+05,
         3.9584e+05, 3.4327e+00, 3.9880e+05, 3.9150e+05, 0.0000e+00, 3.6426e+00,
         3.5607e+00, 3.1671e+00, 3.4105e+00],
        [3.9129e+05, 3.7323e+05, 3.6905e+00, 3.7743e+00, 3.9295e+05, 4.0872e+05,
         3.9581e+05, 3.7745e+00, 3.9884e+05, 3.9146e+05, 3.6426e+00, 0.0000e+00,
         3.8016e+00, 3.5916e+00, 3.7174e+00],
        [3.9127e+05, 3.7324e+05, 3.4127e+00, 3.7382e+00, 3.9291e+05, 4.0867e+05,
         3.9584e+05, 3.6875e+00, 3.9884e+05, 3.9147e+05, 3.5607e+00, 3.8016e+00,
         0.0000e+00, 3.4500e+00, 3.3774e+00],
        [3.9128e+05, 3.7322e+05, 3.3286e+00, 3.3635e+00, 3.9293e+05, 4.0868e+05,
         3.9582e+05, 3.6091e+00, 3.9884e+05, 3.9150e+05, 3.1671e+00, 3.5916e+00,
         3.4500e+00, 0.0000e+00, 3.3308e+00],
        [3.9130e+05, 3.7327e+05, 3.5437e+00, 3.6685e+00, 3.9287e+05, 4.0866e+05,
         3.9582e+05, 3.3455e+00, 3.9883e+05, 3.9150e+05, 3.4105e+00, 3.7174e+00,
         3.3774e+00, 3.3308e+00, 0.0000e+00]])
Krum scores: ['391272.50', '373232.56', '3.42', '3.52', '392909.25', '408675.38', '395797.06', '3.58', '398811.62', '391481.25', '3.37', '3.70', '3.54', '3.37', '3.45']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']], selected_client_indices: [20, 16, 7, 4, 17, 15, 14, 11, 13, 19, 10, 8, 2, 3, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0088s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:08...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[122 115]
 [116 147]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:08, End: 2025-07-22 15:47:08)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [10, 3, 18, 4, 5, 14, 8, 16, 11, 12, 17, 6, 1, 19, 9, 7, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.3908e+00, 3.8412e+05, 3.4571e+00, 3.4939e+00, 3.8771e+05,
         3.5255e+00, 4.0076e+05, 3.4343e+00, 3.7112e+00, 3.8894e+05, 3.4605e+00,
         3.5351e+00, 4.0354e+05, 3.5566e+00, 3.4270e+00, 3.8589e+05],
        [3.3908e+00, 0.0000e+00, 3.8414e+05, 3.4337e+00, 3.5915e+00, 3.8775e+05,
         3.7240e+00, 4.0077e+05, 3.7566e+00, 3.5110e+00, 3.8893e+05, 3.5819e+00,
         3.5373e+00, 4.0359e+05, 3.6493e+00, 3.5395e+00, 3.8590e+05],
        [3.8412e+05, 3.8414e+05, 0.0000e+00, 3.8412e+05, 3.8413e+05, 7.7935e+05,
         3.8414e+05, 7.6759e+05, 3.8407e+05, 3.8411e+05, 7.6664e+05, 3.8414e+05,
         3.8407e+05, 8.1606e+05, 3.8413e+05, 3.8416e+05, 7.8931e+05],
        [3.4571e+00, 3.4337e+00, 3.8412e+05, 0.0000e+00, 3.2512e+00, 3.8773e+05,
         3.7181e+00, 4.0077e+05, 3.5085e+00, 3.7602e+00, 3.8894e+05, 3.7365e+00,
         3.7059e+00, 4.0355e+05, 3.7880e+00, 3.3256e+00, 3.8590e+05],
        [3.4939e+00, 3.5915e+00, 3.8413e+05, 3.2512e+00, 0.0000e+00, 3.8768e+05,
         3.9411e+00, 4.0079e+05, 3.3092e+00, 3.3375e+00, 3.8891e+05, 3.3428e+00,
         3.4358e+00, 4.0359e+05, 3.6024e+00, 3.5009e+00, 3.8597e+05],
        [3.8771e+05, 3.8775e+05, 7.7935e+05, 3.8773e+05, 3.8768e+05, 0.0000e+00,
         3.8776e+05, 7.8139e+05, 3.8770e+05, 3.8771e+05, 7.7156e+05, 3.8769e+05,
         3.8776e+05, 8.0566e+05, 3.8774e+05, 3.8769e+05, 7.7333e+05],
        [3.5255e+00, 3.7240e+00, 3.8414e+05, 3.7181e+00, 3.9411e+00, 3.8776e+05,
         0.0000e+00, 4.0077e+05, 3.7642e+00, 4.1011e+00, 3.8897e+05, 4.0032e+00,
         3.7841e+00, 4.0357e+05, 3.6871e+00, 3.6858e+00, 3.8587e+05],
        [4.0076e+05, 4.0077e+05, 7.6759e+05, 4.0077e+05, 4.0079e+05, 7.8139e+05,
         4.0077e+05, 0.0000e+00, 4.0075e+05, 4.0075e+05, 7.7240e+05, 4.0073e+05,
         4.0074e+05, 8.2699e+05, 4.0077e+05, 4.0080e+05, 7.9583e+05],
        [3.4343e+00, 3.7566e+00, 3.8407e+05, 3.5085e+00, 3.3092e+00, 3.8770e+05,
         3.7642e+00, 4.0075e+05, 0.0000e+00, 3.6747e+00, 3.8894e+05, 3.7462e+00,
         3.4617e+00, 4.0358e+05, 3.7727e+00, 3.7129e+00, 3.8589e+05],
        [3.7112e+00, 3.5110e+00, 3.8411e+05, 3.7602e+00, 3.3375e+00, 3.8771e+05,
         4.1011e+00, 4.0075e+05, 3.6747e+00, 0.0000e+00, 3.8893e+05, 3.4853e+00,
         3.8021e+00, 4.0353e+05, 3.6025e+00, 3.5013e+00, 3.8594e+05],
        [3.8894e+05, 3.8893e+05, 7.6664e+05, 3.8894e+05, 3.8891e+05, 7.7156e+05,
         3.8897e+05, 7.7240e+05, 3.8894e+05, 3.8893e+05, 0.0000e+00, 3.8894e+05,
         3.8891e+05, 7.7729e+05, 3.8889e+05, 3.8892e+05, 8.0675e+05],
        [3.4605e+00, 3.5819e+00, 3.8414e+05, 3.7365e+00, 3.3428e+00, 3.8769e+05,
         4.0032e+00, 4.0073e+05, 3.7462e+00, 3.4853e+00, 3.8894e+05, 0.0000e+00,
         3.6574e+00, 4.0357e+05, 3.7907e+00, 3.4994e+00, 3.8593e+05],
        [3.5351e+00, 3.5373e+00, 3.8407e+05, 3.7059e+00, 3.4358e+00, 3.8776e+05,
         3.7841e+00, 4.0074e+05, 3.4617e+00, 3.8021e+00, 3.8891e+05, 3.6574e+00,
         0.0000e+00, 4.0356e+05, 3.6639e+00, 3.7148e+00, 3.8592e+05],
        [4.0354e+05, 4.0359e+05, 8.1606e+05, 4.0355e+05, 4.0359e+05, 8.0566e+05,
         4.0357e+05, 8.2699e+05, 4.0358e+05, 4.0353e+05, 7.7729e+05, 4.0357e+05,
         4.0356e+05, 0.0000e+00, 4.0355e+05, 4.0361e+05, 7.7373e+05],
        [3.5566e+00, 3.6493e+00, 3.8413e+05, 3.7880e+00, 3.6024e+00, 3.8774e+05,
         3.6871e+00, 4.0077e+05, 3.7727e+00, 3.6025e+00, 3.8889e+05, 3.7907e+00,
         3.6639e+00, 4.0355e+05, 0.0000e+00, 3.6667e+00, 3.8590e+05],
        [3.4270e+00, 3.5395e+00, 3.8416e+05, 3.3256e+00, 3.5009e+00, 3.8769e+05,
         3.6858e+00, 4.0080e+05, 3.7129e+00, 3.5013e+00, 3.8892e+05, 3.4994e+00,
         3.7148e+00, 4.0361e+05, 3.6667e+00, 0.0000e+00, 3.8591e+05],
        [3.8589e+05, 3.8590e+05, 7.8931e+05, 3.8590e+05, 3.8597e+05, 7.7333e+05,
         3.8587e+05, 7.9583e+05, 3.8589e+05, 3.8594e+05, 8.0675e+05, 3.8593e+05,
         3.8592e+05, 7.7373e+05, 3.8590e+05, 3.8591e+05, 0.0000e+00]])
Krum scores: ['3.48', '3.55', '384112.97', '3.54', '3.43', '387709.25', '3.76', '400756.59', '3.60', '3.60', '388923.47', '3.59', '3.61', '403560.56', '3.67', '3.54', '385902.75']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [10, 3, 18, 4, 5, 14, 8, 16, 11, 12, 17, 6, 1, 19, 9, 7, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0038s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:09...
global Accuracy on shared test data: 54.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[125 112]
 [118 145]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:09, End: 2025-07-22 15:47:09)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [6, 5], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 3.3819],
        [3.3819, 0.0000]])
Krum scores: ['nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [6, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0009s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:09...
global Accuracy on shared test data: 53.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[127 110]
 [122 141]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:09, End: 2025-07-22 15:47:09)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [20, 10], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[     0.0000, 399070.7812],
        [399070.7812,      0.0000]])
Krum scores: ['nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [20, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0008s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:09...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 88 149]
 [112 151]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:09, End: 2025-07-22 15:47:09)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [9, 18, 20, 3, 13, 17, 5, 2, 11, 7, 4, 10, 6, 16, 14, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9571e+05, 3.9560e+05, 3.3650e+00, 3.6824e+05, 3.9625e+05,
         3.7382e+00, 3.5764e+00, 3.6366e+00, 3.9304e+00, 3.3325e+00, 3.7330e+00,
         3.7478e+00, 3.9235e+05, 3.8578e+05, 3.8523e+00],
        [3.9571e+05, 0.0000e+00, 7.9150e+05, 3.9577e+05, 7.6530e+05, 7.9750e+05,
         3.9574e+05, 3.9571e+05, 3.9572e+05, 3.9576e+05, 3.9579e+05, 3.9572e+05,
         3.9574e+05, 7.9662e+05, 7.8254e+05, 3.9576e+05],
        [3.9560e+05, 7.9150e+05, 0.0000e+00, 3.9560e+05, 7.4951e+05, 8.0240e+05,
         3.9558e+05, 3.9566e+05, 3.9563e+05, 3.9561e+05, 3.9563e+05, 3.9565e+05,
         3.9561e+05, 8.0335e+05, 7.9969e+05, 3.9566e+05],
        [3.3650e+00, 3.9577e+05, 3.9560e+05, 0.0000e+00, 3.6824e+05, 3.9628e+05,
         3.5706e+00, 3.0590e+00, 3.5748e+00, 3.3154e+00, 3.2847e+00, 3.3732e+00,
         3.3897e+00, 3.9229e+05, 3.8572e+05, 3.4626e+00],
        [3.6824e+05, 7.6530e+05, 7.4951e+05, 3.6824e+05, 0.0000e+00, 7.8089e+05,
         3.6818e+05, 3.6824e+05, 3.6827e+05, 3.6825e+05, 3.6819e+05, 3.6823e+05,
         3.6822e+05, 7.4831e+05, 7.6400e+05, 3.6824e+05],
        [3.9625e+05, 7.9750e+05, 8.0240e+05, 3.9628e+05, 7.8089e+05, 0.0000e+00,
         3.9628e+05, 3.9631e+05, 3.9633e+05, 3.9631e+05, 3.9628e+05, 3.9635e+05,
         3.9630e+05, 7.9830e+05, 7.8029e+05, 3.9631e+05],
        [3.7382e+00, 3.9574e+05, 3.9558e+05, 3.5706e+00, 3.6818e+05, 3.9628e+05,
         0.0000e+00, 3.3710e+00, 3.6344e+00, 3.5190e+00, 3.3482e+00, 3.5149e+00,
         3.4955e+00, 3.9230e+05, 3.8574e+05, 3.5107e+00],
        [3.5764e+00, 3.9571e+05, 3.9566e+05, 3.0590e+00, 3.6824e+05, 3.9631e+05,
         3.3710e+00, 0.0000e+00, 3.7329e+00, 3.4821e+00, 3.3985e+00, 3.3540e+00,
         3.4293e+00, 3.9232e+05, 3.8576e+05, 3.4634e+00],
        [3.6366e+00, 3.9572e+05, 3.9563e+05, 3.5748e+00, 3.6827e+05, 3.9633e+05,
         3.6344e+00, 3.7329e+00, 0.0000e+00, 3.7713e+00, 3.5487e+00, 3.4380e+00,
         3.2681e+00, 3.9230e+05, 3.8573e+05, 3.8226e+00],
        [3.9304e+00, 3.9576e+05, 3.9561e+05, 3.3154e+00, 3.6825e+05, 3.9631e+05,
         3.5190e+00, 3.4821e+00, 3.7713e+00, 0.0000e+00, 3.2648e+00, 3.6092e+00,
         3.4496e+00, 3.9223e+05, 3.8572e+05, 3.4430e+00],
        [3.3325e+00, 3.9579e+05, 3.9563e+05, 3.2847e+00, 3.6819e+05, 3.9628e+05,
         3.3482e+00, 3.3985e+00, 3.5487e+00, 3.2648e+00, 0.0000e+00, 3.2678e+00,
         3.3144e+00, 3.9230e+05, 3.8573e+05, 3.4782e+00],
        [3.7330e+00, 3.9572e+05, 3.9565e+05, 3.3732e+00, 3.6823e+05, 3.9635e+05,
         3.5149e+00, 3.3540e+00, 3.4380e+00, 3.6092e+00, 3.2678e+00, 0.0000e+00,
         3.6178e+00, 3.9232e+05, 3.8570e+05, 3.3665e+00],
        [3.7478e+00, 3.9574e+05, 3.9561e+05, 3.3897e+00, 3.6822e+05, 3.9630e+05,
         3.4955e+00, 3.4293e+00, 3.2681e+00, 3.4496e+00, 3.3144e+00, 3.6178e+00,
         0.0000e+00, 3.9227e+05, 3.8575e+05, 3.7312e+00],
        [3.9235e+05, 7.9662e+05, 8.0335e+05, 3.9229e+05, 7.4831e+05, 7.9830e+05,
         3.9230e+05, 3.9232e+05, 3.9230e+05, 3.9223e+05, 3.9230e+05, 3.9232e+05,
         3.9227e+05, 0.0000e+00, 7.8176e+05, 3.9233e+05],
        [3.8578e+05, 7.8254e+05, 7.9969e+05, 3.8572e+05, 7.6400e+05, 7.8029e+05,
         3.8574e+05, 3.8576e+05, 3.8573e+05, 3.8572e+05, 3.8573e+05, 3.8570e+05,
         3.8575e+05, 7.8176e+05, 0.0000e+00, 3.8574e+05],
        [3.8523e+00, 3.9576e+05, 3.9566e+05, 3.4626e+00, 3.6824e+05, 3.9631e+05,
         3.5107e+00, 3.4634e+00, 3.8226e+00, 3.4430e+00, 3.4782e+00, 3.3665e+00,
         3.7312e+00, 3.9233e+05, 3.8574e+05, 0.0000e+00]])
Krum scores: ['3.62', '395733.16', '395613.31', '3.35', '368221.31', '396288.84', '3.50', '3.39', '3.58', '3.48', '3.34', '3.44', '3.46', '392291.00', '385729.47', '3.53']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 18, 20, 3, 13, 17, 5, 2, 11, 7, 4, 10, 6, 16, 14, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0064s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:10...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 91 146]
 [114 149]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:10, End: 2025-07-22 15:47:10)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [9, 18, 16, 20, 2, 4, 19, 1, 11, 17, 15, 5, 7, 13, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.8732e+05, 3.8041e+05, 3.9666e+05, 3.6092e+00, 3.3182e+00,
         3.9173e+05, 3.5051e+00, 3.6774e+00, 3.8381e+05, 3.9991e+05, 3.7191e+00,
         3.9204e+00, 3.9906e+05, 3.3342e+00],
        [3.8732e+05, 0.0000e+00, 7.5530e+05, 7.8708e+05, 3.8734e+05, 3.8733e+05,
         7.9722e+05, 3.8730e+05, 3.8732e+05, 7.7299e+05, 7.9362e+05, 3.8731e+05,
         3.8735e+05, 7.7330e+05, 3.8732e+05],
        [3.8041e+05, 7.5530e+05, 0.0000e+00, 7.8651e+05, 3.8042e+05, 3.8039e+05,
         7.7769e+05, 3.8039e+05, 3.8043e+05, 7.6492e+05, 7.7585e+05, 3.8036e+05,
         3.8041e+05, 7.9878e+05, 3.8043e+05],
        [3.9666e+05, 7.8708e+05, 7.8651e+05, 0.0000e+00, 3.9667e+05, 3.9668e+05,
         7.9348e+05, 3.9669e+05, 3.9669e+05, 7.7265e+05, 8.0995e+05, 3.9670e+05,
         3.9663e+05, 7.9048e+05, 3.9669e+05],
        [3.6092e+00, 3.8734e+05, 3.8042e+05, 3.9667e+05, 0.0000e+00, 3.4370e+00,
         3.9175e+05, 3.7096e+00, 3.7324e+00, 3.8385e+05, 3.9993e+05, 3.4399e+00,
         3.6212e+00, 3.9906e+05, 3.0741e+00],
        [3.3182e+00, 3.8733e+05, 3.8039e+05, 3.9668e+05, 3.4370e+00, 0.0000e+00,
         3.9174e+05, 3.2493e+00, 3.5525e+00, 3.8391e+05, 3.9992e+05, 3.3439e+00,
         3.3397e+00, 3.9905e+05, 3.2218e+00],
        [3.9173e+05, 7.9722e+05, 7.7769e+05, 7.9348e+05, 3.9175e+05, 3.9174e+05,
         0.0000e+00, 3.9173e+05, 3.9170e+05, 7.9871e+05, 8.2513e+05, 3.9177e+05,
         3.9175e+05, 7.9709e+05, 3.9172e+05],
        [3.5051e+00, 3.8730e+05, 3.8039e+05, 3.9669e+05, 3.7096e+00, 3.2493e+00,
         3.9173e+05, 0.0000e+00, 3.7704e+00, 3.8389e+05, 3.9991e+05, 3.5322e+00,
         3.5689e+00, 3.9906e+05, 3.2106e+00],
        [3.6774e+00, 3.8732e+05, 3.8043e+05, 3.9669e+05, 3.7324e+00, 3.5525e+00,
         3.9170e+05, 3.7704e+00, 0.0000e+00, 3.8388e+05, 3.9993e+05, 3.5876e+00,
         3.8083e+00, 3.9907e+05, 3.5034e+00],
        [3.8381e+05, 7.7299e+05, 7.6492e+05, 7.7265e+05, 3.8385e+05, 3.8391e+05,
         7.9871e+05, 3.8389e+05, 3.8388e+05, 0.0000e+00, 7.9441e+05, 3.8385e+05,
         3.8387e+05, 7.8190e+05, 3.8387e+05],
        [3.9991e+05, 7.9362e+05, 7.7585e+05, 8.0995e+05, 3.9993e+05, 3.9992e+05,
         8.2513e+05, 3.9991e+05, 3.9993e+05, 7.9441e+05, 0.0000e+00, 3.9990e+05,
         3.9992e+05, 7.9084e+05, 3.9988e+05],
        [3.7191e+00, 3.8731e+05, 3.8036e+05, 3.9670e+05, 3.4399e+00, 3.3439e+00,
         3.9177e+05, 3.5322e+00, 3.5876e+00, 3.8385e+05, 3.9990e+05, 0.0000e+00,
         3.4756e+00, 3.9915e+05, 3.5202e+00],
        [3.9204e+00, 3.8735e+05, 3.8041e+05, 3.9663e+05, 3.6212e+00, 3.3397e+00,
         3.9175e+05, 3.5689e+00, 3.8083e+00, 3.8387e+05, 3.9992e+05, 3.4756e+00,
         0.0000e+00, 3.9902e+05, 3.3335e+00],
        [3.9906e+05, 7.7330e+05, 7.9878e+05, 7.9048e+05, 3.9906e+05, 3.9905e+05,
         7.9709e+05, 3.9906e+05, 3.9907e+05, 7.8190e+05, 7.9084e+05, 3.9915e+05,
         3.9902e+05, 0.0000e+00, 3.9905e+05],
        [3.3342e+00, 3.8732e+05, 3.8043e+05, 3.9669e+05, 3.0741e+00, 3.2218e+00,
         3.9172e+05, 3.2106e+00, 3.5034e+00, 3.8387e+05, 3.9988e+05, 3.5202e+00,
         3.3335e+00, 3.9905e+05, 0.0000e+00]])
Krum scores: ['3.53', '387317.34', '380396.62', '396671.72', '3.48', '3.32', '391727.66', '3.46', '3.64', '383856.00', '399906.28', '3.48', '3.52', '399050.47', '3.28']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']], selected_client_indices: [9, 18, 16, 20, 2, 4, 19, 1, 11, 17, 15, 5, 7, 13, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0032s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:10...
global Accuracy on shared test data: 47.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 93 144]
 [118 145]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:10, End: 2025-07-22 15:47:10)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [5, 9, 11, 14, 18, 19, 2, 15, 1, 10, 16, 6, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.6728e+00, 3.5434e+00, 4.0325e+05, 3.9658e+05, 3.7233e+05,
         3.4126e+00, 3.9437e+05, 3.5435e+00, 3.5405e+00, 3.9121e+05, 3.4618e+00,
         3.9653e+05],
        [3.6728e+00, 0.0000e+00, 3.6372e+00, 4.0318e+05, 3.9653e+05, 3.7234e+05,
         3.5381e+00, 3.9436e+05, 3.4929e+00, 3.8086e+00, 3.9119e+05, 3.6837e+00,
         3.9651e+05],
        [3.5434e+00, 3.6372e+00, 0.0000e+00, 4.0318e+05, 3.9654e+05, 3.7233e+05,
         3.7455e+00, 3.9432e+05, 3.7670e+00, 3.5156e+00, 3.9119e+05, 3.4064e+00,
         3.9651e+05],
        [4.0325e+05, 4.0318e+05, 4.0318e+05, 0.0000e+00, 8.1003e+05, 7.9484e+05,
         4.0323e+05, 7.8834e+05, 4.0320e+05, 4.0320e+05, 7.8061e+05, 4.0315e+05,
         7.9888e+05],
        [3.9658e+05, 3.9653e+05, 3.9654e+05, 8.1003e+05, 0.0000e+00, 7.7188e+05,
         3.9655e+05, 7.8529e+05, 3.9655e+05, 3.9657e+05, 8.2247e+05, 3.9656e+05,
         7.8831e+05],
        [3.7233e+05, 3.7234e+05, 3.7233e+05, 7.9484e+05, 7.7188e+05, 0.0000e+00,
         3.7235e+05, 7.5887e+05, 3.7232e+05, 3.7235e+05, 7.8081e+05, 3.7236e+05,
         7.7672e+05],
        [3.4126e+00, 3.5381e+00, 3.7455e+00, 4.0323e+05, 3.9655e+05, 3.7235e+05,
         0.0000e+00, 3.9431e+05, 3.6860e+00, 3.3578e+00, 3.9121e+05, 3.3810e+00,
         3.9651e+05],
        [3.9437e+05, 3.9436e+05, 3.9432e+05, 7.8834e+05, 7.8529e+05, 7.5887e+05,
         3.9431e+05, 0.0000e+00, 3.9430e+05, 3.9432e+05, 7.8602e+05, 3.9429e+05,
         8.1707e+05],
        [3.5435e+00, 3.4929e+00, 3.7670e+00, 4.0320e+05, 3.9655e+05, 3.7232e+05,
         3.6860e+00, 3.9430e+05, 0.0000e+00, 3.4449e+00, 3.9117e+05, 3.5762e+00,
         3.9653e+05],
        [3.5405e+00, 3.8086e+00, 3.5156e+00, 4.0320e+05, 3.9657e+05, 3.7235e+05,
         3.3578e+00, 3.9432e+05, 3.4449e+00, 0.0000e+00, 3.9119e+05, 3.5166e+00,
         3.9649e+05],
        [3.9121e+05, 3.9119e+05, 3.9119e+05, 7.8061e+05, 8.2247e+05, 7.8081e+05,
         3.9121e+05, 7.8602e+05, 3.9117e+05, 3.9119e+05, 0.0000e+00, 3.9115e+05,
         7.9368e+05],
        [3.4618e+00, 3.6837e+00, 3.4064e+00, 4.0315e+05, 3.9656e+05, 3.7236e+05,
         3.3810e+00, 3.9429e+05, 3.5762e+00, 3.5166e+00, 3.9115e+05, 0.0000e+00,
         3.9657e+05],
        [3.9653e+05, 3.9651e+05, 3.9651e+05, 7.9888e+05, 7.8831e+05, 7.7672e+05,
         3.9651e+05, 8.1707e+05, 3.9653e+05, 3.9649e+05, 7.9368e+05, 3.9657e+05,
         0.0000e+00]])
Krum scores: ['3.50', '3.60', '3.57', '403183.00', '396545.09', '372334.09', '3.48', '394308.34', '3.55', '3.48', '391178.94', '3.47', '396511.94']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']], selected_client_indices: [5, 9, 11, 14, 18, 19, 2, 15, 1, 10, 16, 6, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0050s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:11...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 97 140]
 [119 144]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:11, End: 2025-07-22 15:47:11)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [8, 11, 3, 14, 18, 13, 16, 4, 17, 6, 1, 12, 2, 9], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.8243e+00, 3.3742e+00, 3.9543e+05, 3.8923e+05, 3.8684e+05,
         4.0540e+05, 3.7253e+00, 3.8588e+05, 3.6755e+00, 3.4856e+00, 3.3539e+00,
         3.6569e+00, 3.9321e+00],
        [3.8243e+00, 0.0000e+00, 3.6122e+00, 3.9544e+05, 3.8923e+05, 3.8688e+05,
         4.0541e+05, 3.6174e+00, 3.8592e+05, 3.6104e+00, 3.8457e+00, 3.6920e+00,
         3.6415e+00, 3.6262e+00],
        [3.3742e+00, 3.6122e+00, 0.0000e+00, 3.9541e+05, 3.8918e+05, 3.8688e+05,
         4.0543e+05, 3.3148e+00, 3.8588e+05, 3.3285e+00, 3.3787e+00, 3.2996e+00,
         3.0131e+00, 3.3300e+00],
        [3.9543e+05, 3.9544e+05, 3.9541e+05, 0.0000e+00, 7.6083e+05, 7.9722e+05,
         8.1288e+05, 3.9545e+05, 7.8636e+05, 3.9543e+05, 3.9544e+05, 3.9546e+05,
         3.9540e+05, 3.9548e+05],
        [3.8923e+05, 3.8923e+05, 3.8918e+05, 7.6083e+05, 0.0000e+00, 7.8868e+05,
         7.9037e+05, 3.8919e+05, 7.9322e+05, 3.8921e+05, 3.8920e+05, 3.8923e+05,
         3.8923e+05, 3.8922e+05],
        [3.8684e+05, 3.8688e+05, 3.8688e+05, 7.9722e+05, 7.8868e+05, 0.0000e+00,
         7.8394e+05, 3.8687e+05, 7.7301e+05, 3.8685e+05, 3.8683e+05, 3.8681e+05,
         3.8686e+05, 3.8684e+05],
        [4.0540e+05, 4.0541e+05, 4.0543e+05, 8.1288e+05, 7.9037e+05, 7.8394e+05,
         0.0000e+00, 4.0544e+05, 7.8762e+05, 4.0542e+05, 4.0543e+05, 4.0545e+05,
         4.0545e+05, 4.0543e+05],
        [3.7253e+00, 3.6174e+00, 3.3148e+00, 3.9545e+05, 3.8919e+05, 3.8687e+05,
         4.0544e+05, 0.0000e+00, 3.8582e+05, 3.5183e+00, 3.4725e+00, 3.6813e+00,
         3.4006e+00, 3.4306e+00],
        [3.8588e+05, 3.8592e+05, 3.8588e+05, 7.8636e+05, 7.9322e+05, 7.7301e+05,
         7.8762e+05, 3.8582e+05, 0.0000e+00, 3.8584e+05, 3.8587e+05, 3.8588e+05,
         3.8586e+05, 3.8586e+05],
        [3.6755e+00, 3.6104e+00, 3.3285e+00, 3.9543e+05, 3.8921e+05, 3.8685e+05,
         4.0542e+05, 3.5183e+00, 3.8584e+05, 0.0000e+00, 3.6925e+00, 3.2245e+00,
         3.4116e+00, 3.7420e+00],
        [3.4856e+00, 3.8457e+00, 3.3787e+00, 3.9544e+05, 3.8920e+05, 3.8683e+05,
         4.0543e+05, 3.4725e+00, 3.8587e+05, 3.6925e+00, 0.0000e+00, 3.5425e+00,
         3.7677e+00, 3.5796e+00],
        [3.3539e+00, 3.6920e+00, 3.2996e+00, 3.9546e+05, 3.8923e+05, 3.8681e+05,
         4.0545e+05, 3.6813e+00, 3.8588e+05, 3.2245e+00, 3.5425e+00, 0.0000e+00,
         3.5561e+00, 3.4108e+00],
        [3.6569e+00, 3.6415e+00, 3.0131e+00, 3.9540e+05, 3.8923e+05, 3.8686e+05,
         4.0545e+05, 3.4006e+00, 3.8586e+05, 3.4116e+00, 3.7677e+00, 3.5561e+00,
         0.0000e+00, 3.5970e+00],
        [3.9321e+00, 3.6262e+00, 3.3300e+00, 3.9548e+05, 3.8922e+05, 3.8684e+05,
         4.0543e+05, 3.4306e+00, 3.8586e+05, 3.7420e+00, 3.5796e+00, 3.4108e+00,
         3.5970e+00, 0.0000e+00]])
Krum scores: ['3.59', '3.66', '3.29', '395429.12', '389208.66', '386842.62', '405422.69', '3.49', '385858.44', '3.49', '3.56', '3.44', '3.47', '3.53']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [8, 11, 3, 14, 18, 13, 16, 4, 17, 6, 1, 12, 2, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:11...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 97 140]
 [121 142]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:11, End: 2025-07-22 15:47:11)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [12, 13, 9, 16, 6, 7, 8, 1, 11, 18, 15, 3, 20, 4, 2, 10, 17, 19, 14], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.9350e+05, 3.6385e+00, 3.7701e+05, 3.2863e+00, 3.5114e+00,
         3.4195e+00, 3.7681e+00, 3.7092e+00, 3.7340e+05, 3.8937e+05, 3.3800e+00,
         3.9422e+05, 3.6673e+00, 3.6302e+00, 3.5868e+00, 4.0004e+05, 3.9443e+05,
         3.7733e+05],
        [3.9350e+05, 0.0000e+00, 3.9349e+05, 7.8722e+05, 3.9350e+05, 3.9353e+05,
         3.9355e+05, 3.9357e+05, 3.9352e+05, 7.7738e+05, 7.9468e+05, 3.9354e+05,
         8.0596e+05, 3.9354e+05, 3.9354e+05, 3.9350e+05, 7.9229e+05, 7.7731e+05,
         7.8032e+05],
        [3.6385e+00, 3.9349e+05, 0.0000e+00, 3.7706e+05, 3.8026e+00, 3.9902e+00,
         3.9407e+00, 3.6204e+00, 3.5830e+00, 3.7335e+05, 3.8936e+05, 3.3337e+00,
         3.9425e+05, 3.4604e+00, 3.5596e+00, 3.7818e+00, 4.0003e+05, 3.9450e+05,
         3.7740e+05],
        [3.7701e+05, 7.8722e+05, 3.7706e+05, 0.0000e+00, 3.7700e+05, 3.7701e+05,
         3.7701e+05, 3.7706e+05, 3.7703e+05, 7.5873e+05, 7.6325e+05, 3.7702e+05,
         7.6920e+05, 3.7700e+05, 3.7702e+05, 3.7701e+05, 7.9594e+05, 7.7894e+05,
         7.5429e+05],
        [3.2863e+00, 3.9350e+05, 3.8026e+00, 3.7700e+05, 0.0000e+00, 3.5983e+00,
         3.6451e+00, 3.7287e+00, 3.6110e+00, 3.7339e+05, 3.8937e+05, 3.2894e+00,
         3.9421e+05, 3.4347e+00, 3.4193e+00, 3.5451e+00, 4.0005e+05, 3.9446e+05,
         3.7739e+05],
        [3.5114e+00, 3.9353e+05, 3.9902e+00, 3.7701e+05, 3.5983e+00, 0.0000e+00,
         3.6984e+00, 3.5443e+00, 3.7634e+00, 3.7345e+05, 3.8934e+05, 3.4475e+00,
         3.9418e+05, 3.4160e+00, 3.5251e+00, 3.8088e+00, 4.0006e+05, 3.9453e+05,
         3.7734e+05],
        [3.4195e+00, 3.9355e+05, 3.9407e+00, 3.7701e+05, 3.6451e+00, 3.6984e+00,
         0.0000e+00, 3.4863e+00, 3.8345e+00, 3.7341e+05, 3.8937e+05, 3.3519e+00,
         3.9415e+05, 3.6029e+00, 3.6186e+00, 3.3982e+00, 3.9999e+05, 3.9439e+05,
         3.7738e+05],
        [3.7681e+00, 3.9357e+05, 3.6204e+00, 3.7706e+05, 3.7287e+00, 3.5443e+00,
         3.4863e+00, 0.0000e+00, 3.7175e+00, 3.7340e+05, 3.8941e+05, 3.2700e+00,
         3.9421e+05, 3.4587e+00, 3.6800e+00, 3.5103e+00, 4.0005e+05, 3.9445e+05,
         3.7744e+05],
        [3.7092e+00, 3.9352e+05, 3.5830e+00, 3.7703e+05, 3.6110e+00, 3.7634e+00,
         3.8345e+00, 3.7175e+00, 0.0000e+00, 3.7341e+05, 3.8932e+05, 3.5365e+00,
         3.9418e+05, 3.5575e+00, 3.5354e+00, 3.4169e+00, 3.9998e+05, 3.9439e+05,
         3.7743e+05],
        [3.7340e+05, 7.7738e+05, 3.7335e+05, 7.5873e+05, 3.7339e+05, 3.7345e+05,
         3.7341e+05, 3.7340e+05, 3.7341e+05, 0.0000e+00, 7.4340e+05, 3.7339e+05,
         7.6689e+05, 3.7340e+05, 3.7334e+05, 3.7338e+05, 7.4833e+05, 7.7430e+05,
         7.6674e+05],
        [3.8937e+05, 7.9468e+05, 3.8936e+05, 7.6325e+05, 3.8937e+05, 3.8934e+05,
         3.8937e+05, 3.8941e+05, 3.8932e+05, 7.4340e+05, 0.0000e+00, 3.8936e+05,
         7.4882e+05, 3.8939e+05, 3.8938e+05, 3.8929e+05, 7.7720e+05, 7.9972e+05,
         7.5851e+05],
        [3.3800e+00, 3.9354e+05, 3.3337e+00, 3.7702e+05, 3.2894e+00, 3.4475e+00,
         3.3519e+00, 3.2700e+00, 3.5365e+00, 3.7339e+05, 3.8936e+05, 0.0000e+00,
         3.9420e+05, 3.2213e+00, 2.9784e+00, 3.4316e+00, 4.0008e+05, 3.9442e+05,
         3.7734e+05],
        [3.9422e+05, 8.0596e+05, 3.9425e+05, 7.6920e+05, 3.9421e+05, 3.9418e+05,
         3.9415e+05, 3.9421e+05, 3.9418e+05, 7.6689e+05, 7.4882e+05, 3.9420e+05,
         0.0000e+00, 3.9421e+05, 3.9421e+05, 3.9422e+05, 7.9547e+05, 8.0727e+05,
         7.6654e+05],
        [3.6673e+00, 3.9354e+05, 3.4604e+00, 3.7700e+05, 3.4347e+00, 3.4160e+00,
         3.6029e+00, 3.4587e+00, 3.5575e+00, 3.7340e+05, 3.8939e+05, 3.2213e+00,
         3.9421e+05, 0.0000e+00, 3.3742e+00, 3.5052e+00, 3.9998e+05, 3.9451e+05,
         3.7742e+05],
        [3.6302e+00, 3.9354e+05, 3.5596e+00, 3.7702e+05, 3.4193e+00, 3.5251e+00,
         3.6186e+00, 3.6800e+00, 3.5354e+00, 3.7334e+05, 3.8938e+05, 2.9784e+00,
         3.9421e+05, 3.3742e+00, 0.0000e+00, 3.2511e+00, 4.0001e+05, 3.9444e+05,
         3.7740e+05],
        [3.5868e+00, 3.9350e+05, 3.7818e+00, 3.7701e+05, 3.5451e+00, 3.8088e+00,
         3.3982e+00, 3.5103e+00, 3.4169e+00, 3.7338e+05, 3.8929e+05, 3.4316e+00,
         3.9422e+05, 3.5052e+00, 3.2511e+00, 0.0000e+00, 4.0007e+05, 3.9445e+05,
         3.7736e+05],
        [4.0004e+05, 7.9229e+05, 4.0003e+05, 7.9594e+05, 4.0005e+05, 4.0006e+05,
         3.9999e+05, 4.0005e+05, 3.9998e+05, 7.4833e+05, 7.7720e+05, 4.0008e+05,
         7.9547e+05, 3.9998e+05, 4.0001e+05, 4.0007e+05, 0.0000e+00, 8.0563e+05,
         7.9718e+05],
        [3.9443e+05, 7.7731e+05, 3.9450e+05, 7.7894e+05, 3.9446e+05, 3.9453e+05,
         3.9439e+05, 3.9445e+05, 3.9439e+05, 7.7430e+05, 7.9972e+05, 3.9442e+05,
         8.0727e+05, 3.9451e+05, 3.9444e+05, 3.9445e+05, 8.0563e+05, 0.0000e+00,
         7.8982e+05],
        [3.7733e+05, 7.8032e+05, 3.7740e+05, 7.5429e+05, 3.7739e+05, 3.7734e+05,
         3.7738e+05, 3.7744e+05, 3.7743e+05, 7.6674e+05, 7.5851e+05, 3.7734e+05,
         7.6654e+05, 3.7742e+05, 3.7740e+05, 3.7736e+05, 7.9718e+05, 7.8982e+05,
         0.0000e+00]])
Krum scores: ['3.54', '393516.09', '3.64', '377013.41', '3.51', '3.59', '3.56', '3.56', '3.60', '373383.66', '389350.59', '3.30', '394196.66', '3.45', '3.43', '3.49', '400019.44', '394438.19', '377375.12']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [12, 13, 9, 16, 6, 7, 8, 1, 11, 18, 15, 3, 20, 4, 2, 10, 17, 19, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:12...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [126 137]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:12, End: 2025-07-22 15:47:12)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [18, 17, 11, 7, 10, 5, 19, 2, 3], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 7.7802e+05, 3.6984e+05, 3.6978e+05, 3.6981e+05, 3.6980e+05,
         7.4321e+05, 3.6983e+05, 3.6983e+05],
        [7.7802e+05, 0.0000e+00, 3.9585e+05, 3.9582e+05, 3.9584e+05, 3.9585e+05,
         8.0739e+05, 3.9584e+05, 3.9580e+05],
        [3.6984e+05, 3.9585e+05, 0.0000e+00, 3.6320e+00, 3.3911e+00, 3.5916e+00,
         3.9136e+05, 3.4740e+00, 3.5500e+00],
        [3.6978e+05, 3.9582e+05, 3.6320e+00, 0.0000e+00, 3.8425e+00, 3.6836e+00,
         3.9136e+05, 3.5263e+00, 3.5581e+00],
        [3.6981e+05, 3.9584e+05, 3.3911e+00, 3.8425e+00, 0.0000e+00, 3.5834e+00,
         3.9136e+05, 3.2948e+00, 3.4484e+00],
        [3.6980e+05, 3.9585e+05, 3.5916e+00, 3.6836e+00, 3.5834e+00, 0.0000e+00,
         3.9136e+05, 3.3584e+00, 3.6314e+00],
        [7.4321e+05, 8.0739e+05, 3.9136e+05, 3.9136e+05, 3.9136e+05, 3.9136e+05,
         0.0000e+00, 3.9142e+05, 3.9132e+05],
        [3.6983e+05, 3.9584e+05, 3.4740e+00, 3.5263e+00, 3.2948e+00, 3.3584e+00,
         3.9142e+05, 0.0000e+00, 3.0678e+00],
        [3.6983e+05, 3.9580e+05, 3.5500e+00, 3.5581e+00, 3.4484e+00, 3.6314e+00,
         3.9132e+05, 3.0678e+00, 0.0000e+00]])
Krum scores: ['369804.00', '395824.88', '3.50', '3.60', '3.43', '3.54', '391348.25', '3.30', '3.41']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']], selected_client_indices: [18, 17, 11, 7, 10, 5, 19, 2, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0047s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:12...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [125 138]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:12, End: 2025-07-22 15:47:12)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [9, 11], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 3.6304],
        [3.6304, 0.0000]])
Krum scores: ['nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [9, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0009s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:13...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [126 137]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:13, End: 2025-07-22 15:47:13)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [13, 8, 14, 6, 15, 20, 19, 16, 3, 10, 1, 11, 18, 9, 12, 2, 17, 7], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.8736e+05, 7.6070e+05, 3.8734e+05, 7.7447e+05, 7.8041e+05,
         7.9238e+05, 7.6680e+05, 3.8734e+05, 3.8734e+05, 3.8733e+05, 3.8736e+05,
         7.9151e+05, 3.8739e+05, 3.8734e+05, 3.8732e+05, 7.8701e+05, 3.8735e+05],
        [3.8736e+05, 0.0000e+00, 3.9113e+05, 3.7275e+00, 3.6970e+05, 3.8360e+05,
         3.9581e+05, 3.8690e+05, 3.6192e+00, 3.5083e+00, 3.6862e+00, 3.9866e+00,
         3.7833e+05, 4.1866e+00, 3.5224e+00, 3.7834e+00, 3.9099e+05, 3.8687e+00],
        [7.6070e+05, 3.9113e+05, 0.0000e+00, 3.9115e+05, 7.5059e+05, 7.7681e+05,
         7.7500e+05, 7.6537e+05, 3.9113e+05, 3.9116e+05, 3.9117e+05, 3.9120e+05,
         7.5409e+05, 3.9120e+05, 3.9114e+05, 3.9117e+05, 7.8131e+05, 3.9119e+05],
        [3.8734e+05, 3.7275e+00, 3.9115e+05, 0.0000e+00, 3.6964e+05, 3.8361e+05,
         3.9585e+05, 3.8691e+05, 3.4745e+00, 3.4980e+00, 3.8333e+00, 3.5905e+00,
         3.7829e+05, 3.8015e+00, 3.1287e+00, 3.3870e+00, 3.9090e+05, 3.7229e+00],
        [7.7447e+05, 3.6970e+05, 7.5059e+05, 3.6964e+05, 0.0000e+00, 7.7181e+05,
         7.6118e+05, 7.4941e+05, 3.6968e+05, 3.6968e+05, 3.6970e+05, 3.6970e+05,
         7.3786e+05, 3.6965e+05, 3.6969e+05, 3.6973e+05, 7.3756e+05, 3.6966e+05],
        [7.8041e+05, 3.8360e+05, 7.7681e+05, 3.8361e+05, 7.7181e+05, 0.0000e+00,
         7.8078e+05, 7.5496e+05, 3.8361e+05, 3.8362e+05, 3.8358e+05, 3.8361e+05,
         7.5942e+05, 3.8359e+05, 3.8359e+05, 3.8358e+05, 7.8822e+05, 3.8361e+05],
        [7.9238e+05, 3.9581e+05, 7.7500e+05, 3.9585e+05, 7.6118e+05, 7.8078e+05,
         0.0000e+00, 7.5172e+05, 3.9583e+05, 3.9591e+05, 3.9582e+05, 3.9582e+05,
         7.6948e+05, 3.9586e+05, 3.9586e+05, 3.9583e+05, 7.7503e+05, 3.9583e+05],
        [7.6680e+05, 3.8690e+05, 7.6537e+05, 3.8691e+05, 7.4941e+05, 7.5496e+05,
         7.5172e+05, 0.0000e+00, 3.8692e+05, 3.8695e+05, 3.8689e+05, 3.8688e+05,
         7.5434e+05, 3.8689e+05, 3.8693e+05, 3.8688e+05, 7.7918e+05, 3.8691e+05],
        [3.8734e+05, 3.6192e+00, 3.9113e+05, 3.4745e+00, 3.6968e+05, 3.8361e+05,
         3.9583e+05, 3.8692e+05, 0.0000e+00, 3.4914e+00, 3.3462e+00, 3.5739e+00,
         3.7829e+05, 3.4628e+00, 3.2633e+00, 3.1303e+00, 3.9094e+05, 3.5593e+00],
        [3.8734e+05, 3.5083e+00, 3.9116e+05, 3.4980e+00, 3.6968e+05, 3.8362e+05,
         3.9591e+05, 3.8695e+05, 3.4914e+00, 0.0000e+00, 3.5924e+00, 3.4093e+00,
         3.7831e+05, 3.7821e+00, 3.4862e+00, 3.1899e+00, 3.9092e+05, 3.8448e+00],
        [3.8733e+05, 3.6862e+00, 3.9117e+05, 3.8333e+00, 3.6970e+05, 3.8358e+05,
         3.9582e+05, 3.8689e+05, 3.3462e+00, 3.5924e+00, 0.0000e+00, 3.7392e+00,
         3.7833e+05, 3.5747e+00, 3.6532e+00, 3.6994e+00, 3.9091e+05, 3.5000e+00],
        [3.8736e+05, 3.9866e+00, 3.9120e+05, 3.5905e+00, 3.6970e+05, 3.8361e+05,
         3.9582e+05, 3.8688e+05, 3.5739e+00, 3.4093e+00, 3.7392e+00, 0.0000e+00,
         3.7828e+05, 3.6435e+00, 3.5970e+00, 3.4708e+00, 3.9095e+05, 3.5388e+00],
        [7.9151e+05, 3.7833e+05, 7.5409e+05, 3.7829e+05, 7.3786e+05, 7.5942e+05,
         7.6948e+05, 7.5434e+05, 3.7829e+05, 3.7831e+05, 3.7833e+05, 3.7828e+05,
         0.0000e+00, 3.7835e+05, 3.7830e+05, 3.7833e+05, 7.7770e+05, 3.7829e+05],
        [3.8739e+05, 4.1866e+00, 3.9120e+05, 3.8015e+00, 3.6965e+05, 3.8359e+05,
         3.9586e+05, 3.8689e+05, 3.4628e+00, 3.7821e+00, 3.5747e+00, 3.6435e+00,
         3.7835e+05, 0.0000e+00, 3.5199e+00, 3.5092e+00, 3.9093e+05, 3.8218e+00],
        [3.8734e+05, 3.5224e+00, 3.9114e+05, 3.1287e+00, 3.6969e+05, 3.8359e+05,
         3.9586e+05, 3.8693e+05, 3.2633e+00, 3.4862e+00, 3.6532e+00, 3.5970e+00,
         3.7830e+05, 3.5199e+00, 0.0000e+00, 3.3436e+00, 3.9094e+05, 3.4241e+00],
        [3.8732e+05, 3.7834e+00, 3.9117e+05, 3.3870e+00, 3.6973e+05, 3.8358e+05,
         3.9583e+05, 3.8688e+05, 3.1303e+00, 3.1899e+00, 3.6994e+00, 3.4708e+00,
         3.7833e+05, 3.5092e+00, 3.3436e+00, 0.0000e+00, 3.9088e+05, 3.5329e+00],
        [7.8701e+05, 3.9099e+05, 7.8131e+05, 3.9090e+05, 7.3756e+05, 7.8822e+05,
         7.7503e+05, 7.7918e+05, 3.9094e+05, 3.9092e+05, 3.9091e+05, 3.9095e+05,
         7.7770e+05, 3.9093e+05, 3.9094e+05, 3.9088e+05, 0.0000e+00, 3.9089e+05],
        [3.8735e+05, 3.8687e+00, 3.9119e+05, 3.7229e+00, 3.6966e+05, 3.8361e+05,
         3.9583e+05, 3.8691e+05, 3.5593e+00, 3.8448e+00, 3.5000e+00, 3.5388e+00,
         3.7829e+05, 3.8218e+00, 3.4241e+00, 3.5329e+00, 3.9089e+05, 0.0000e+00]])
Krum scores: ['387339.19', '3.71', '391156.59', '3.54', '369674.00', '383596.84', '395832.66', '386896.78', '3.41', '3.49', '3.60', '3.57', '378302.69', '3.64', '3.41', '3.41', '390912.81', '3.62']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']
 ['Update 16']
 ['Update 17']], selected_client_indices: [13, 8, 14, 6, 15, 20, 19, 16, 3, 10, 1, 11, 18, 9, 12, 2, 17, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0039s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:13...
global Accuracy on shared test data: 47.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[101 136]
 [126 137]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:13, End: 2025-07-22 15:47:13)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [11, 17, 18, 4, 6, 13, 20, 14, 1, 9, 19, 5, 15, 8, 2, 12, 16, 7], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 4.0179e+05, 3.9111e+05, 3.5712e+00, 3.7115e+00, 3.8260e+05,
         3.9000e+05, 3.8577e+05, 3.7549e+00, 3.6881e+00, 4.0047e+05, 3.5342e+00,
         4.0281e+05, 4.1723e+00, 3.5531e+00, 3.6861e+00, 3.9901e+05, 3.6722e+00],
        [4.0179e+05, 0.0000e+00, 7.7921e+05, 4.0178e+05, 4.0176e+05, 7.8638e+05,
         7.7682e+05, 7.8678e+05, 4.0176e+05, 4.0180e+05, 8.0727e+05, 4.0173e+05,
         7.9782e+05, 4.0176e+05, 4.0179e+05, 4.0177e+05, 8.1193e+05, 4.0178e+05],
        [3.9111e+05, 7.7921e+05, 0.0000e+00, 3.9115e+05, 3.9114e+05, 7.9950e+05,
         7.6432e+05, 7.9334e+05, 3.9116e+05, 3.9108e+05, 7.9293e+05, 3.9115e+05,
         8.1215e+05, 3.9109e+05, 3.9109e+05, 3.9115e+05, 7.9156e+05, 3.9118e+05],
        [3.5712e+00, 4.0178e+05, 3.9115e+05, 0.0000e+00, 3.3548e+00, 3.8261e+05,
         3.9004e+05, 3.8571e+05, 3.6259e+00, 3.5762e+00, 4.0046e+05, 3.2691e+00,
         4.0281e+05, 3.5631e+00, 3.3312e+00, 3.4893e+00, 3.9899e+05, 3.4422e+00],
        [3.7115e+00, 4.0176e+05, 3.9114e+05, 3.3548e+00, 0.0000e+00, 3.8265e+05,
         3.9004e+05, 3.8575e+05, 3.8362e+00, 3.8955e+00, 4.0041e+05, 3.7662e+00,
         4.0276e+05, 3.7304e+00, 3.5369e+00, 3.3038e+00, 3.9894e+05, 3.8506e+00],
        [3.8260e+05, 7.8638e+05, 7.9950e+05, 3.8261e+05, 3.8265e+05, 0.0000e+00,
         7.6801e+05, 7.7921e+05, 3.8266e+05, 3.8262e+05, 7.9679e+05, 3.8261e+05,
         7.8831e+05, 3.8264e+05, 3.8264e+05, 3.8263e+05, 7.9510e+05, 3.8262e+05],
        [3.9000e+05, 7.7682e+05, 7.6432e+05, 3.9004e+05, 3.9004e+05, 7.6801e+05,
         0.0000e+00, 7.8655e+05, 3.9004e+05, 3.9006e+05, 8.0094e+05, 3.9005e+05,
         8.0888e+05, 3.9000e+05, 3.9006e+05, 3.9001e+05, 7.7904e+05, 3.9007e+05],
        [3.8577e+05, 7.8678e+05, 7.9334e+05, 3.8571e+05, 3.8575e+05, 7.7921e+05,
         7.8655e+05, 0.0000e+00, 3.8577e+05, 3.8579e+05, 7.6790e+05, 3.8572e+05,
         8.0599e+05, 3.8574e+05, 3.8578e+05, 3.8574e+05, 7.7210e+05, 3.8570e+05],
        [3.7549e+00, 4.0176e+05, 3.9116e+05, 3.6259e+00, 3.8362e+00, 3.8266e+05,
         3.9004e+05, 3.8577e+05, 0.0000e+00, 3.6567e+00, 4.0048e+05, 3.6425e+00,
         4.0282e+05, 3.7874e+00, 3.7851e+00, 3.6767e+00, 3.9903e+05, 3.4914e+00],
        [3.6881e+00, 4.0180e+05, 3.9108e+05, 3.5762e+00, 3.8955e+00, 3.8262e+05,
         3.9006e+05, 3.8579e+05, 3.6567e+00, 0.0000e+00, 4.0047e+05, 3.7127e+00,
         4.0281e+05, 4.2971e+00, 3.5875e+00, 3.4761e+00, 3.9897e+05, 3.8633e+00],
        [4.0047e+05, 8.0727e+05, 7.9293e+05, 4.0046e+05, 4.0041e+05, 7.9679e+05,
         8.0094e+05, 7.6790e+05, 4.0048e+05, 4.0047e+05, 0.0000e+00, 4.0045e+05,
         8.0890e+05, 4.0042e+05, 4.0048e+05, 4.0042e+05, 7.8792e+05, 4.0046e+05],
        [3.5342e+00, 4.0173e+05, 3.9115e+05, 3.2691e+00, 3.7662e+00, 3.8261e+05,
         3.9005e+05, 3.8572e+05, 3.6425e+00, 3.7127e+00, 4.0045e+05, 0.0000e+00,
         4.0282e+05, 4.0296e+00, 3.3745e+00, 3.3518e+00, 3.9899e+05, 3.5443e+00],
        [4.0281e+05, 7.9782e+05, 8.1215e+05, 4.0281e+05, 4.0276e+05, 7.8831e+05,
         8.0888e+05, 8.0599e+05, 4.0282e+05, 4.0281e+05, 8.0890e+05, 4.0282e+05,
         0.0000e+00, 4.0276e+05, 4.0278e+05, 4.0278e+05, 8.2646e+05, 4.0275e+05],
        [4.1723e+00, 4.0176e+05, 3.9109e+05, 3.5631e+00, 3.7304e+00, 3.8264e+05,
         3.9000e+05, 3.8574e+05, 3.7874e+00, 4.2971e+00, 4.0042e+05, 4.0296e+00,
         4.0276e+05, 0.0000e+00, 3.8387e+00, 3.5435e+00, 3.9897e+05, 3.9033e+00],
        [3.5531e+00, 4.0179e+05, 3.9109e+05, 3.3312e+00, 3.5369e+00, 3.8264e+05,
         3.9006e+05, 3.8578e+05, 3.7851e+00, 3.5875e+00, 4.0048e+05, 3.3745e+00,
         4.0278e+05, 3.8387e+00, 0.0000e+00, 3.4447e+00, 3.9899e+05, 3.5314e+00],
        [3.6861e+00, 4.0177e+05, 3.9115e+05, 3.4893e+00, 3.3038e+00, 3.8263e+05,
         3.9001e+05, 3.8574e+05, 3.6767e+00, 3.4761e+00, 4.0042e+05, 3.3518e+00,
         4.0278e+05, 3.5435e+00, 3.4447e+00, 0.0000e+00, 3.9904e+05, 3.4167e+00],
        [3.9901e+05, 8.1193e+05, 7.9156e+05, 3.9899e+05, 3.9894e+05, 7.9510e+05,
         7.7904e+05, 7.7210e+05, 3.9903e+05, 3.9897e+05, 7.8792e+05, 3.9899e+05,
         8.2646e+05, 3.9897e+05, 3.9899e+05, 3.9904e+05, 0.0000e+00, 3.9903e+05],
        [3.6722e+00, 4.0178e+05, 3.9118e+05, 3.4422e+00, 3.8506e+00, 3.8262e+05,
         3.9007e+05, 3.8570e+05, 3.4914e+00, 3.8633e+00, 4.0046e+05, 3.5443e+00,
         4.0275e+05, 3.9033e+00, 3.5314e+00, 3.4167e+00, 3.9903e+05, 0.0000e+00]])
Krum scores: ['3.65', '401765.41', '391121.75', '3.45', '3.64', '382622.53', '390029.62', '385737.44', '3.68', '3.68', '400442.81', '3.52', '402781.41', '3.82', '3.52', '3.46', '398987.34', '3.60']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [11, 17, 18, 4, 6, 13, 20, 14, 1, 9, 19, 5, 15, 8, 2, 12, 16, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0185s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:14...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [125 138]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:14, End: 2025-07-22 15:47:14)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [20, 19, 3, 7, 16, 2, 12, 14, 5, 4], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 7.8495e+05, 3.8884e+05, 3.8882e+05, 7.6519e+05, 3.8887e+05,
         3.8887e+05, 7.7013e+05, 3.8884e+05, 3.8887e+05],
        [7.8495e+05, 0.0000e+00, 3.8812e+05, 3.8814e+05, 7.7824e+05, 3.8806e+05,
         3.8811e+05, 7.8449e+05, 3.8811e+05, 3.8811e+05],
        [3.8884e+05, 3.8812e+05, 0.0000e+00, 3.4459e+00, 3.9208e+05, 3.0625e+00,
         3.1797e+00, 3.8282e+05, 3.6068e+00, 3.1948e+00],
        [3.8882e+05, 3.8814e+05, 3.4459e+00, 0.0000e+00, 3.9205e+05, 3.5406e+00,
         3.3609e+00, 3.8280e+05, 3.5180e+00, 3.4639e+00],
        [7.6519e+05, 7.7824e+05, 3.9208e+05, 3.9205e+05, 0.0000e+00, 3.9208e+05,
         3.9205e+05, 7.8748e+05, 3.9207e+05, 3.9205e+05],
        [3.8887e+05, 3.8806e+05, 3.0625e+00, 3.5406e+00, 3.9208e+05, 0.0000e+00,
         3.4302e+00, 3.8283e+05, 3.3051e+00, 3.4021e+00],
        [3.8887e+05, 3.8811e+05, 3.1797e+00, 3.3609e+00, 3.9205e+05, 3.4302e+00,
         0.0000e+00, 3.8284e+05, 3.2950e+00, 3.5424e+00],
        [7.7013e+05, 7.8449e+05, 3.8282e+05, 3.8280e+05, 7.8748e+05, 3.8283e+05,
         3.8284e+05, 0.0000e+00, 3.8279e+05, 3.8282e+05],
        [3.8884e+05, 3.8811e+05, 3.6068e+00, 3.5180e+00, 3.9207e+05, 3.3051e+00,
         3.2950e+00, 3.8279e+05, 0.0000e+00, 3.3185e+00],
        [3.8887e+05, 3.8811e+05, 3.1948e+00, 3.4639e+00, 3.9205e+05, 3.4021e+00,
         3.5424e+00, 3.8282e+05, 3.3185e+00, 0.0000e+00]])
Krum scores: ['388842.34', '388096.53', '3.22', '3.45', '392055.53', '3.30', '3.32', '382809.41', '3.36', '3.34']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [20, 19, 3, 7, 16, 2, 12, 14, 5, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0030s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:14...
global Accuracy on shared test data: 47.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [127 136]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:14, End: 2025-07-22 15:47:14)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [9, 2, 13, 5, 7, 11, 20, 3, 12, 16, 4], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
tensor([[0.0000e+00, 3.3936e+00, 3.8299e+05, 3.7738e+00, 3.7596e+00, 3.7559e+00,
         3.9134e+05, 3.4801e+00, 3.4421e+00, 3.9285e+05, 3.6333e+00],
        [3.3936e+00, 0.0000e+00, 3.8295e+05, 3.3393e+00, 3.5109e+00, 3.7034e+00,
         3.9144e+05, 3.1948e+00, 3.5249e+00, 3.9285e+05, 3.4668e+00],
        [3.8299e+05, 3.8295e+05, 0.0000e+00, 3.8299e+05, 3.8299e+05, 3.8300e+05,
         7.5401e+05, 3.8296e+05, 3.8300e+05, 7.7927e+05, 3.8297e+05],
        [3.7738e+00, 3.3393e+00, 3.8299e+05, 0.0000e+00, 3.4481e+00, 3.4352e+00,
         3.9141e+05, 3.6431e+00, 3.3186e+00, 3.9283e+05, 3.4083e+00],
        [3.7596e+00, 3.5109e+00, 3.8299e+05, 3.4481e+00, 0.0000e+00, 3.7134e+00,
         3.9141e+05, 3.5106e+00, 3.3958e+00, 3.9282e+05, 3.4172e+00],
        [3.7559e+00, 3.7034e+00, 3.8300e+05, 3.4352e+00, 3.7134e+00, 0.0000e+00,
         3.9138e+05, 3.4670e+00, 3.6985e+00, 3.9276e+05, 3.6063e+00],
        [3.9134e+05, 3.9144e+05, 7.5401e+05, 3.9141e+05, 3.9141e+05, 3.9138e+05,
         0.0000e+00, 3.9144e+05, 3.9140e+05, 7.8134e+05, 3.9139e+05],
        [3.4801e+00, 3.1948e+00, 3.8296e+05, 3.6431e+00, 3.5106e+00, 3.4670e+00,
         3.9144e+05, 0.0000e+00, 3.2857e+00, 3.9285e+05, 3.2449e+00],
        [3.4421e+00, 3.5249e+00, 3.8300e+05, 3.3186e+00, 3.3958e+00, 3.6985e+00,
         3.9140e+05, 3.2857e+00, 0.0000e+00, 3.9287e+05, 3.5850e+00],
        [3.9285e+05, 3.9285e+05, 7.7927e+05, 3.9283e+05, 3.9282e+05, 3.9276e+05,
         7.8134e+05, 3.9285e+05, 3.9287e+05, 0.0000e+00, 3.9282e+05],
        [3.6333e+00, 3.4668e+00, 3.8297e+05, 3.4083e+00, 3.4172e+00, 3.6063e+00,
         3.9139e+05, 3.2449e+00, 3.5850e+00, 3.9282e+05, 0.0000e+00]])
Krum scores: ['3.58', '3.41', '382971.94', '3.43', '3.50', '3.60', '391389.03', '3.36', '3.43', '392821.31', '3.45']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [9, 2, 13, 5, 7, 11, 20, 3, 12, 16, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0023s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:15...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[106 131]
 [129 134]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:15, End: 2025-07-22 15:47:15)
start time is: 98204297680754, end time is: 98217163666355
The total time is: 12865985601ns.

 ------- aggregate method: krum, random_seed: 300 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [11, 13, 7, 19, 12, 15, 18, 17, 1, 6, 4, 14, 20, 16, 5, 3, 10, 9, 8, 2], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 3.8874e+05, 4.3228e+00, 3.8357e+05, 4.2607e+00, 3.7987e+05,
         3.9182e+05, 3.8779e+05, 4.4243e+00, 4.2700e+00, 4.2448e+00, 3.9106e+05,
         3.9619e+05, 4.0240e+05, 4.0035e+00, 4.7100e+00, 4.3771e+00, 4.0670e+00,
         4.5421e+00, 4.2739e+00],
        [3.8874e+05, 0.0000e+00, 3.8879e+05, 8.0227e+05, 3.8882e+05, 7.6871e+05,
         7.5160e+05, 7.7642e+05, 3.8874e+05, 3.8880e+05, 3.8879e+05, 7.9061e+05,
         7.7638e+05, 7.7448e+05, 3.8880e+05, 3.8885e+05, 3.8882e+05, 3.8881e+05,
         3.8878e+05, 3.8877e+05],
        [4.3228e+00, 3.8879e+05, 0.0000e+00, 3.8362e+05, 4.1606e+00, 3.7983e+05,
         3.9176e+05, 3.8782e+05, 4.3314e+00, 4.1769e+00, 4.0574e+00, 3.9113e+05,
         3.9612e+05, 4.0241e+05, 3.8218e+00, 4.3145e+00, 3.8938e+00, 4.3784e+00,
         4.3240e+00, 3.7941e+00],
        [3.8357e+05, 8.0227e+05, 3.8362e+05, 0.0000e+00, 3.8357e+05, 7.6646e+05,
         8.0725e+05, 7.6022e+05, 3.8356e+05, 3.8358e+05, 3.8359e+05, 7.6253e+05,
         7.5772e+05, 7.9086e+05, 3.8360e+05, 3.8362e+05, 3.8359e+05, 3.8359e+05,
         3.8356e+05, 3.8365e+05],
        [4.2607e+00, 3.8882e+05, 4.1606e+00, 3.8357e+05, 0.0000e+00, 3.7980e+05,
         3.9180e+05, 3.8778e+05, 4.7210e+00, 4.2046e+00, 3.9744e+00, 3.9111e+05,
         3.9613e+05, 4.0247e+05, 4.1351e+00, 3.6232e+00, 3.7167e+00, 4.5259e+00,
         4.2048e+00, 4.2503e+00],
        [3.7987e+05, 7.6871e+05, 3.7983e+05, 7.6646e+05, 3.7980e+05, 0.0000e+00,
         8.0317e+05, 7.3358e+05, 3.7975e+05, 3.7979e+05, 3.7985e+05, 7.8229e+05,
         7.7350e+05, 7.8021e+05, 3.7983e+05, 3.7986e+05, 3.7987e+05, 3.7980e+05,
         3.7985e+05, 3.7984e+05],
        [3.9182e+05, 7.5160e+05, 3.9176e+05, 8.0725e+05, 3.9180e+05, 8.0317e+05,
         0.0000e+00, 7.7802e+05, 3.9179e+05, 3.9179e+05, 3.9184e+05, 7.8700e+05,
         7.7224e+05, 7.5187e+05, 3.9180e+05, 3.9177e+05, 3.9180e+05, 3.9183e+05,
         3.9181e+05, 3.9180e+05],
        [3.8779e+05, 7.7642e+05, 3.8782e+05, 7.6022e+05, 3.8778e+05, 7.3358e+05,
         7.7802e+05, 0.0000e+00, 3.8783e+05, 3.8779e+05, 3.8780e+05, 7.7174e+05,
         7.7985e+05, 7.8404e+05, 3.8783e+05, 3.8781e+05, 3.8775e+05, 3.8782e+05,
         3.8778e+05, 3.8785e+05],
        [4.4243e+00, 3.8874e+05, 4.3314e+00, 3.8356e+05, 4.7210e+00, 3.7975e+05,
         3.9179e+05, 3.8783e+05, 0.0000e+00, 4.3664e+00, 4.4607e+00, 3.9113e+05,
         3.9611e+05, 4.0240e+05, 4.4340e+00, 5.0765e+00, 4.1926e+00, 4.3463e+00,
         4.6420e+00, 4.3807e+00],
        [4.2700e+00, 3.8880e+05, 4.1769e+00, 3.8358e+05, 4.2046e+00, 3.7979e+05,
         3.9179e+05, 3.8779e+05, 4.3664e+00, 0.0000e+00, 4.2093e+00, 3.9111e+05,
         3.9616e+05, 4.0240e+05, 4.2356e+00, 4.4276e+00, 4.0959e+00, 4.2120e+00,
         4.2925e+00, 3.8216e+00],
        [4.2448e+00, 3.8879e+05, 4.0574e+00, 3.8359e+05, 3.9744e+00, 3.7985e+05,
         3.9184e+05, 3.8780e+05, 4.4607e+00, 4.2093e+00, 0.0000e+00, 3.9105e+05,
         3.9613e+05, 4.0244e+05, 3.6361e+00, 4.2566e+00, 4.4678e+00, 3.9163e+00,
         4.4370e+00, 3.9718e+00],
        [3.9106e+05, 7.9061e+05, 3.9113e+05, 7.6253e+05, 3.9111e+05, 7.8229e+05,
         7.8700e+05, 7.7174e+05, 3.9113e+05, 3.9111e+05, 3.9105e+05, 0.0000e+00,
         8.0992e+05, 7.9257e+05, 3.9112e+05, 3.9105e+05, 3.9112e+05, 3.9111e+05,
         3.9108e+05, 3.9107e+05],
        [3.9619e+05, 7.7638e+05, 3.9612e+05, 7.5772e+05, 3.9613e+05, 7.7350e+05,
         7.7224e+05, 7.7985e+05, 3.9611e+05, 3.9616e+05, 3.9613e+05, 8.0992e+05,
         0.0000e+00, 7.9487e+05, 3.9615e+05, 3.9619e+05, 3.9618e+05, 3.9615e+05,
         3.9623e+05, 3.9618e+05],
        [4.0240e+05, 7.7448e+05, 4.0241e+05, 7.9086e+05, 4.0247e+05, 7.8021e+05,
         7.5187e+05, 7.8404e+05, 4.0240e+05, 4.0240e+05, 4.0244e+05, 7.9257e+05,
         7.9487e+05, 0.0000e+00, 4.0239e+05, 4.0238e+05, 4.0235e+05, 4.0238e+05,
         4.0242e+05, 4.0241e+05],
        [4.0035e+00, 3.8880e+05, 3.8218e+00, 3.8360e+05, 4.1351e+00, 3.7983e+05,
         3.9180e+05, 3.8783e+05, 4.4340e+00, 4.2356e+00, 3.6361e+00, 3.9112e+05,
         3.9615e+05, 4.0239e+05, 0.0000e+00, 4.2562e+00, 4.1236e+00, 3.8945e+00,
         4.5213e+00, 3.8329e+00],
        [4.7100e+00, 3.8885e+05, 4.3145e+00, 3.8362e+05, 3.6232e+00, 3.7986e+05,
         3.9177e+05, 3.8781e+05, 5.0765e+00, 4.4276e+00, 4.2566e+00, 3.9105e+05,
         3.9619e+05, 4.0238e+05, 4.2562e+00, 0.0000e+00, 4.0159e+00, 4.5233e+00,
         4.2110e+00, 4.1913e+00],
        [4.3771e+00, 3.8882e+05, 3.8938e+00, 3.8359e+05, 3.7167e+00, 3.7987e+05,
         3.9180e+05, 3.8775e+05, 4.1926e+00, 4.0959e+00, 4.4678e+00, 3.9112e+05,
         3.9618e+05, 4.0235e+05, 4.1236e+00, 4.0159e+00, 0.0000e+00, 4.6007e+00,
         3.9096e+00, 4.0314e+00],
        [4.0670e+00, 3.8881e+05, 4.3784e+00, 3.8359e+05, 4.5259e+00, 3.7980e+05,
         3.9183e+05, 3.8782e+05, 4.3463e+00, 4.2120e+00, 3.9163e+00, 3.9111e+05,
         3.9615e+05, 4.0238e+05, 3.8945e+00, 4.5233e+00, 4.6007e+00, 0.0000e+00,
         4.7808e+00, 3.5038e+00],
        [4.5421e+00, 3.8878e+05, 4.3240e+00, 3.8356e+05, 4.2048e+00, 3.7985e+05,
         3.9181e+05, 3.8778e+05, 4.6420e+00, 4.2925e+00, 4.4370e+00, 3.9108e+05,
         3.9623e+05, 4.0242e+05, 4.5213e+00, 4.2110e+00, 3.9096e+00, 4.7808e+00,
         0.0000e+00, 4.4817e+00],
        [4.2739e+00, 3.8877e+05, 3.7941e+00, 3.8365e+05, 4.2503e+00, 3.7984e+05,
         3.9180e+05, 3.8785e+05, 4.3807e+00, 3.8216e+00, 3.9718e+00, 3.9107e+05,
         3.9618e+05, 4.0241e+05, 3.8329e+00, 4.1913e+00, 4.0314e+00, 3.5038e+00,
         4.4817e+00, 0.0000e+00]])
Krum scores: ['4.28', '388782.88', '4.12', '383582.69', '4.11', '379819.94', '391792.50', '387797.88', '4.43', '4.19', '4.12', '391089.09', '396148.72', '402392.72', '4.04', '4.25', '4.08', '4.20', '4.36', '4.01']
Selected index: 19
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Chosen Update']], selected_client_indices: [11, 13, 7, 19, 12, 15, 18, 17, 1, 6, 4, 14, 20, 16, 5, 3, 10, 9, 8, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0047s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:16...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:16, End: 2025-07-22 15:47:16)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [6, 13, 20, 4, 1, 9, 14, 15, 8, 2, 5, 3, 7, 10, 17, 19, 11, 16, 12, 18], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 3.9038e+05, 3.9295e+05, 1.8151e+00, 1.8426e+00, 1.7879e+00,
         3.9416e+05, 3.8099e+05, 1.9247e+00, 1.9222e+00, 1.9577e+00, 2.1129e+00,
         2.0593e+00, 1.9618e+00, 4.0802e+05, 3.9397e+05, 1.8521e+00, 3.9974e+05,
         1.8829e+00, 3.8107e+05],
        [3.9038e+05, 0.0000e+00, 8.0747e+05, 3.9039e+05, 3.9036e+05, 3.9039e+05,
         7.9177e+05, 7.7881e+05, 3.9040e+05, 3.9039e+05, 3.9040e+05, 3.9042e+05,
         3.9038e+05, 3.9041e+05, 7.9937e+05, 7.8127e+05, 3.9037e+05, 7.8541e+05,
         3.9038e+05, 7.6101e+05],
        [3.9295e+05, 8.0747e+05, 0.0000e+00, 3.9293e+05, 3.9294e+05, 3.9290e+05,
         8.1467e+05, 7.6951e+05, 3.9293e+05, 3.9293e+05, 3.9289e+05, 3.9291e+05,
         3.9291e+05, 3.9294e+05, 7.9092e+05, 7.8641e+05, 3.9292e+05, 7.8632e+05,
         3.9296e+05, 7.6867e+05],
        [1.8151e+00, 3.9039e+05, 3.9293e+05, 0.0000e+00, 1.8875e+00, 1.8061e+00,
         3.9421e+05, 3.8097e+05, 1.7343e+00, 1.9886e+00, 1.7611e+00, 1.8639e+00,
         1.7557e+00, 1.8650e+00, 4.0803e+05, 3.9394e+05, 1.7068e+00, 3.9974e+05,
         1.6546e+00, 3.8104e+05],
        [1.8426e+00, 3.9036e+05, 3.9294e+05, 1.8875e+00, 0.0000e+00, 1.7801e+00,
         3.9417e+05, 3.8097e+05, 1.8970e+00, 2.0652e+00, 1.8544e+00, 2.0015e+00,
         1.8862e+00, 1.8505e+00, 4.0798e+05, 3.9395e+05, 1.7885e+00, 3.9975e+05,
         1.8885e+00, 3.8109e+05],
        [1.7879e+00, 3.9039e+05, 3.9290e+05, 1.8061e+00, 1.7801e+00, 0.0000e+00,
         3.9419e+05, 3.8098e+05, 1.8626e+00, 1.8557e+00, 1.8405e+00, 1.8809e+00,
         1.8778e+00, 1.7864e+00, 4.0797e+05, 3.9396e+05, 1.7211e+00, 3.9977e+05,
         1.8522e+00, 3.8105e+05],
        [3.9416e+05, 7.9177e+05, 8.1467e+05, 3.9421e+05, 3.9417e+05, 3.9419e+05,
         0.0000e+00, 7.8252e+05, 3.9418e+05, 3.9416e+05, 3.9420e+05, 3.9417e+05,
         3.9416e+05, 3.9417e+05, 7.9862e+05, 7.7284e+05, 3.9416e+05, 7.8588e+05,
         3.9419e+05, 7.9140e+05],
        [3.8099e+05, 7.7881e+05, 7.6951e+05, 3.8097e+05, 3.8097e+05, 3.8098e+05,
         7.8252e+05, 0.0000e+00, 3.8095e+05, 3.8099e+05, 3.8098e+05, 3.8096e+05,
         3.8097e+05, 3.8097e+05, 7.7620e+05, 7.3969e+05, 3.8095e+05, 7.9108e+05,
         3.8097e+05, 7.5534e+05],
        [1.9247e+00, 3.9040e+05, 3.9293e+05, 1.7343e+00, 1.8970e+00, 1.8626e+00,
         3.9418e+05, 3.8095e+05, 0.0000e+00, 2.1067e+00, 1.9982e+00, 1.8147e+00,
         1.9612e+00, 1.7876e+00, 4.0801e+05, 3.9397e+05, 1.9019e+00, 3.9975e+05,
         1.9313e+00, 3.8106e+05],
        [1.9222e+00, 3.9039e+05, 3.9293e+05, 1.9886e+00, 2.0652e+00, 1.8557e+00,
         3.9416e+05, 3.8099e+05, 2.1067e+00, 0.0000e+00, 2.0929e+00, 1.8597e+00,
         1.9254e+00, 1.8477e+00, 4.0803e+05, 3.9396e+05, 2.0266e+00, 3.9975e+05,
         1.9014e+00, 3.8108e+05],
        [1.9577e+00, 3.9040e+05, 3.9289e+05, 1.7611e+00, 1.8544e+00, 1.8405e+00,
         3.9420e+05, 3.8098e+05, 1.9982e+00, 2.0929e+00, 0.0000e+00, 1.7813e+00,
         1.7180e+00, 1.8407e+00, 4.0800e+05, 3.9395e+05, 1.6578e+00, 3.9975e+05,
         1.7771e+00, 3.8106e+05],
        [2.1129e+00, 3.9042e+05, 3.9291e+05, 1.8639e+00, 2.0015e+00, 1.8809e+00,
         3.9417e+05, 3.8096e+05, 1.8147e+00, 1.8597e+00, 1.7813e+00, 0.0000e+00,
         1.9077e+00, 1.7104e+00, 4.0801e+05, 3.9394e+05, 1.9636e+00, 3.9975e+05,
         1.6618e+00, 3.8105e+05],
        [2.0593e+00, 3.9038e+05, 3.9291e+05, 1.7557e+00, 1.8862e+00, 1.8778e+00,
         3.9416e+05, 3.8097e+05, 1.9612e+00, 1.9254e+00, 1.7180e+00, 1.9077e+00,
         0.0000e+00, 1.7850e+00, 4.0802e+05, 3.9393e+05, 1.7425e+00, 3.9973e+05,
         1.8431e+00, 3.8104e+05],
        [1.9618e+00, 3.9041e+05, 3.9294e+05, 1.8650e+00, 1.8505e+00, 1.7864e+00,
         3.9417e+05, 3.8097e+05, 1.7876e+00, 1.8477e+00, 1.8407e+00, 1.7104e+00,
         1.7850e+00, 0.0000e+00, 4.0801e+05, 3.9395e+05, 1.8237e+00, 3.9972e+05,
         1.7295e+00, 3.8107e+05],
        [4.0802e+05, 7.9937e+05, 7.9092e+05, 4.0803e+05, 4.0798e+05, 4.0797e+05,
         7.9862e+05, 7.7620e+05, 4.0801e+05, 4.0803e+05, 4.0800e+05, 4.0801e+05,
         4.0802e+05, 4.0801e+05, 0.0000e+00, 8.2662e+05, 4.0802e+05, 8.3029e+05,
         4.0800e+05, 7.9119e+05],
        [3.9397e+05, 7.8127e+05, 7.8641e+05, 3.9394e+05, 3.9395e+05, 3.9396e+05,
         7.7284e+05, 7.3969e+05, 3.9397e+05, 3.9396e+05, 3.9395e+05, 3.9394e+05,
         3.9393e+05, 3.9395e+05, 8.2662e+05, 0.0000e+00, 3.9395e+05, 7.8606e+05,
         3.9393e+05, 7.8125e+05],
        [1.8521e+00, 3.9037e+05, 3.9292e+05, 1.7068e+00, 1.7885e+00, 1.7211e+00,
         3.9416e+05, 3.8095e+05, 1.9019e+00, 2.0266e+00, 1.6578e+00, 1.9636e+00,
         1.7425e+00, 1.8237e+00, 4.0802e+05, 3.9395e+05, 0.0000e+00, 3.9977e+05,
         1.8687e+00, 3.8106e+05],
        [3.9974e+05, 7.8541e+05, 7.8632e+05, 3.9974e+05, 3.9975e+05, 3.9977e+05,
         7.8588e+05, 7.9108e+05, 3.9975e+05, 3.9975e+05, 3.9975e+05, 3.9975e+05,
         3.9973e+05, 3.9972e+05, 8.3029e+05, 7.8606e+05, 3.9977e+05, 0.0000e+00,
         3.9974e+05, 7.8131e+05],
        [1.8829e+00, 3.9038e+05, 3.9296e+05, 1.6546e+00, 1.8885e+00, 1.8522e+00,
         3.9419e+05, 3.8097e+05, 1.9313e+00, 1.9014e+00, 1.7771e+00, 1.6618e+00,
         1.8431e+00, 1.7295e+00, 4.0800e+05, 3.9393e+05, 1.8687e+00, 3.9974e+05,
         0.0000e+00, 3.8103e+05],
        [3.8107e+05, 7.6101e+05, 7.6867e+05, 3.8104e+05, 3.8109e+05, 3.8105e+05,
         7.9140e+05, 7.5534e+05, 3.8106e+05, 3.8108e+05, 3.8106e+05, 3.8105e+05,
         3.8104e+05, 3.8107e+05, 7.9119e+05, 7.8125e+05, 3.8106e+05, 7.8131e+05,
         3.8103e+05, 0.0000e+00]])
Krum scores: ['1.90', '390383.12', '392920.78', '1.79', '1.87', '1.82', '394171.09', '380966.00', '1.88', '1.95', '1.82', '1.84', '1.84', '1.80', '408003.28', '393946.56', '1.80', '399741.25', '1.81', '381052.25']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [6, 13, 20, 4, 1, 9, 14, 15, 8, 2, 5, 3, 7, 10, 17, 19, 11, 16, 12, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0064s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:16...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:16, End: 2025-07-22 15:47:16)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [3, 20, 19, 5, 12, 1, 9, 14, 16, 2, 17, 11, 6, 8, 4, 10, 13, 18, 15], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.8068e+05, 3.8849e+05, 1.7818e+00, 1.7835e+00, 1.9489e+00,
         1.8381e+00, 3.8941e+05, 3.9559e+05, 1.8020e+00, 3.9167e+05, 1.9364e+00,
         2.1503e+00, 1.8588e+00, 1.9061e+00, 1.7179e+00, 3.8511e+05, 4.0310e+05,
         3.8525e+05],
        [3.8068e+05, 0.0000e+00, 7.8783e+05, 3.8068e+05, 3.8071e+05, 3.8072e+05,
         3.8072e+05, 7.6712e+05, 7.6552e+05, 3.8072e+05, 7.5872e+05, 3.8076e+05,
         3.8069e+05, 3.8072e+05, 3.8072e+05, 3.8069e+05, 7.5653e+05, 7.8832e+05,
         7.7333e+05],
        [3.8849e+05, 7.8783e+05, 0.0000e+00, 3.8845e+05, 3.8845e+05, 3.8845e+05,
         3.8844e+05, 7.8020e+05, 7.7118e+05, 3.8843e+05, 7.7986e+05, 3.8845e+05,
         3.8845e+05, 3.8844e+05, 3.8844e+05, 3.8848e+05, 7.8762e+05, 7.7639e+05,
         7.7373e+05],
        [1.7818e+00, 3.8068e+05, 3.8845e+05, 0.0000e+00, 1.7926e+00, 1.8495e+00,
         1.9076e+00, 3.8945e+05, 3.9555e+05, 2.0418e+00, 3.9172e+05, 1.7560e+00,
         2.0116e+00, 2.0993e+00, 1.8421e+00, 1.7756e+00, 3.8515e+05, 4.0314e+05,
         3.8527e+05],
        [1.7835e+00, 3.8071e+05, 3.8845e+05, 1.7926e+00, 0.0000e+00, 1.7866e+00,
         1.8232e+00, 3.8943e+05, 3.9554e+05, 1.8775e+00, 3.9167e+05, 1.9094e+00,
         1.9553e+00, 1.9821e+00, 1.7272e+00, 1.7373e+00, 3.8514e+05, 4.0309e+05,
         3.8524e+05],
        [1.9489e+00, 3.8072e+05, 3.8845e+05, 1.8495e+00, 1.7866e+00, 0.0000e+00,
         1.6967e+00, 3.8941e+05, 3.9555e+05, 1.8868e+00, 3.9173e+05, 1.6910e+00,
         1.8249e+00, 1.8339e+00, 1.9091e+00, 1.6844e+00, 3.8508e+05, 4.0309e+05,
         3.8524e+05],
        [1.8381e+00, 3.8072e+05, 3.8844e+05, 1.9076e+00, 1.8232e+00, 1.6967e+00,
         0.0000e+00, 3.8941e+05, 3.9555e+05, 1.7557e+00, 3.9174e+05, 1.6686e+00,
         1.8053e+00, 1.8425e+00, 1.8448e+00, 1.6672e+00, 3.8510e+05, 4.0308e+05,
         3.8522e+05],
        [3.8941e+05, 7.6712e+05, 7.8020e+05, 3.8945e+05, 3.8943e+05, 3.8941e+05,
         3.8941e+05, 0.0000e+00, 7.7060e+05, 3.8938e+05, 7.6991e+05, 3.8942e+05,
         3.8942e+05, 3.8941e+05, 3.8942e+05, 3.8945e+05, 7.5957e+05, 7.9532e+05,
         7.5580e+05],
        [3.9559e+05, 7.6552e+05, 7.7118e+05, 3.9555e+05, 3.9554e+05, 3.9555e+05,
         3.9555e+05, 7.7060e+05, 0.0000e+00, 3.9558e+05, 7.9889e+05, 3.9555e+05,
         3.9558e+05, 3.9556e+05, 3.9555e+05, 3.9558e+05, 7.9062e+05, 8.2152e+05,
         7.5515e+05],
        [1.8020e+00, 3.8072e+05, 3.8843e+05, 2.0418e+00, 1.8775e+00, 1.8868e+00,
         1.7557e+00, 3.8938e+05, 3.9558e+05, 0.0000e+00, 3.9170e+05, 1.9168e+00,
         1.9056e+00, 2.0504e+00, 1.8119e+00, 1.7504e+00, 3.8518e+05, 4.0312e+05,
         3.8522e+05],
        [3.9167e+05, 7.5872e+05, 7.7986e+05, 3.9172e+05, 3.9167e+05, 3.9173e+05,
         3.9174e+05, 7.6991e+05, 7.9889e+05, 3.9170e+05, 0.0000e+00, 3.9174e+05,
         3.9169e+05, 3.9169e+05, 3.9167e+05, 3.9172e+05, 7.6990e+05, 7.9790e+05,
         7.8964e+05],
        [1.9364e+00, 3.8076e+05, 3.8845e+05, 1.7560e+00, 1.9094e+00, 1.6910e+00,
         1.6686e+00, 3.8942e+05, 3.9555e+05, 1.9168e+00, 3.9174e+05, 0.0000e+00,
         1.9201e+00, 1.8976e+00, 1.8474e+00, 1.7420e+00, 3.8512e+05, 4.0313e+05,
         3.8522e+05],
        [2.1503e+00, 3.8069e+05, 3.8845e+05, 2.0116e+00, 1.9553e+00, 1.8249e+00,
         1.8053e+00, 3.8942e+05, 3.9558e+05, 1.9056e+00, 3.9169e+05, 1.9201e+00,
         0.0000e+00, 1.9229e+00, 1.9735e+00, 1.9096e+00, 3.8512e+05, 4.0313e+05,
         3.8528e+05],
        [1.8588e+00, 3.8072e+05, 3.8844e+05, 2.0993e+00, 1.9821e+00, 1.8339e+00,
         1.8425e+00, 3.8941e+05, 3.9556e+05, 2.0504e+00, 3.9169e+05, 1.8976e+00,
         1.9229e+00, 0.0000e+00, 1.8837e+00, 1.7800e+00, 3.8515e+05, 4.0312e+05,
         3.8520e+05],
        [1.9061e+00, 3.8072e+05, 3.8844e+05, 1.8421e+00, 1.7272e+00, 1.9091e+00,
         1.8448e+00, 3.8942e+05, 3.9555e+05, 1.8119e+00, 3.9167e+05, 1.8474e+00,
         1.9735e+00, 1.8837e+00, 0.0000e+00, 1.7806e+00, 3.8513e+05, 4.0314e+05,
         3.8525e+05],
        [1.7179e+00, 3.8069e+05, 3.8848e+05, 1.7756e+00, 1.7373e+00, 1.6844e+00,
         1.6672e+00, 3.8945e+05, 3.9558e+05, 1.7504e+00, 3.9172e+05, 1.7420e+00,
         1.9096e+00, 1.7800e+00, 1.7806e+00, 0.0000e+00, 3.8513e+05, 4.0317e+05,
         3.8523e+05],
        [3.8511e+05, 7.5653e+05, 7.8762e+05, 3.8515e+05, 3.8514e+05, 3.8508e+05,
         3.8510e+05, 7.5957e+05, 7.9062e+05, 3.8518e+05, 7.6990e+05, 3.8512e+05,
         3.8512e+05, 3.8515e+05, 3.8513e+05, 3.8513e+05, 0.0000e+00, 7.6773e+05,
         7.7606e+05],
        [4.0310e+05, 7.8832e+05, 7.7639e+05, 4.0314e+05, 4.0309e+05, 4.0309e+05,
         4.0308e+05, 7.9532e+05, 8.2152e+05, 4.0312e+05, 7.9790e+05, 4.0313e+05,
         4.0313e+05, 4.0312e+05, 4.0314e+05, 4.0317e+05, 7.6773e+05, 0.0000e+00,
         7.8594e+05],
        [3.8525e+05, 7.7333e+05, 7.7373e+05, 3.8527e+05, 3.8524e+05, 3.8524e+05,
         3.8522e+05, 7.5580e+05, 7.5515e+05, 3.8522e+05, 7.8964e+05, 3.8522e+05,
         3.8528e+05, 3.8520e+05, 3.8525e+05, 3.8523e+05, 7.7606e+05, 7.8594e+05,
         0.0000e+00]])
Krum scores: ['1.84', '380704.22', '388442.56', '1.86', '1.82', '1.80', '1.77', '389412.69', '395558.66', '1.86', '391697.41', '1.82', '1.91', '1.89', '1.84', '1.74', '385120.88', '403110.34', '385229.66']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [3, 20, 19, 5, 12, 1, 9, 14, 16, 2, 17, 11, 6, 8, 4, 10, 13, 18, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0209s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:17...
global Accuracy on shared test data: 79.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 42 221]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:17, End: 2025-07-22 15:47:17)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (8): [11, 12, 2, 9, 4, 18, 7, 6], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 8
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([8])
tensor([[0.0000e+00, 1.7470e+00, 1.8768e+00, 1.6388e+00, 1.7349e+00, 4.1251e+05,
         1.7319e+00, 1.8472e+00],
        [1.7470e+00, 0.0000e+00, 1.7521e+00, 1.7086e+00, 1.6835e+00, 4.1249e+05,
         1.8221e+00, 1.8261e+00],
        [1.8768e+00, 1.7521e+00, 0.0000e+00, 1.7740e+00, 1.7891e+00, 4.1248e+05,
         1.7528e+00, 1.8703e+00],
        [1.6388e+00, 1.7086e+00, 1.7740e+00, 0.0000e+00, 1.7966e+00, 4.1249e+05,
         1.8954e+00, 1.7225e+00],
        [1.7349e+00, 1.6835e+00, 1.7891e+00, 1.7966e+00, 0.0000e+00, 4.1251e+05,
         1.7815e+00, 1.8613e+00],
        [4.1251e+05, 4.1249e+05, 4.1248e+05, 4.1249e+05, 4.1251e+05, 0.0000e+00,
         4.1249e+05, 4.1251e+05],
        [1.7319e+00, 1.8221e+00, 1.7528e+00, 1.8954e+00, 1.7815e+00, 4.1249e+05,
         0.0000e+00, 2.0381e+00],
        [1.8472e+00, 1.8261e+00, 1.8703e+00, 1.7225e+00, 1.8613e+00, 4.1251e+05,
         2.0381e+00, 0.0000e+00]])
Krum scores: ['1.74', '1.74', '1.79', '1.73', '1.76', '412493.62', '1.80', '1.83']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']], selected_client_indices: [11, 12, 2, 9, 4, 18, 7, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0017s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:17...
global Accuracy on shared test data: 79.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:17, End: 2025-07-22 15:47:17)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [17, 20, 15, 11, 16, 8, 1, 12, 3, 7, 4, 19, 6, 9], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 7.6202e+05, 7.9330e+05, 3.8158e+05, 7.3493e+05, 3.8159e+05,
         3.8158e+05, 3.8157e+05, 3.8159e+05, 3.8157e+05, 3.8156e+05, 7.8815e+05,
         3.8161e+05, 3.8158e+05],
        [7.6202e+05, 0.0000e+00, 7.8668e+05, 3.8822e+05, 7.5627e+05, 3.8825e+05,
         3.8821e+05, 3.8821e+05, 3.8822e+05, 3.8820e+05, 3.8821e+05, 7.8662e+05,
         3.8822e+05, 3.8822e+05],
        [7.9330e+05, 7.8668e+05, 0.0000e+00, 4.0409e+05, 7.9562e+05, 4.0408e+05,
         4.0405e+05, 4.0411e+05, 4.0414e+05, 4.0409e+05, 4.0412e+05, 7.9125e+05,
         4.0405e+05, 4.0408e+05],
        [3.8158e+05, 3.8822e+05, 4.0409e+05, 0.0000e+00, 3.7268e+05, 1.7779e+00,
         1.6649e+00, 1.7475e+00, 1.8211e+00, 1.6705e+00, 1.6475e+00, 3.8883e+05,
         1.7542e+00, 1.7633e+00],
        [7.3493e+05, 7.5627e+05, 7.9562e+05, 3.7268e+05, 0.0000e+00, 3.7263e+05,
         3.7268e+05, 3.7268e+05, 3.7263e+05, 3.7264e+05, 3.7267e+05, 7.7082e+05,
         3.7266e+05, 3.7268e+05],
        [3.8159e+05, 3.8825e+05, 4.0408e+05, 1.7779e+00, 3.7263e+05, 0.0000e+00,
         1.8360e+00, 1.7403e+00, 1.6808e+00, 1.7985e+00, 1.7397e+00, 3.8883e+05,
         1.7454e+00, 1.9294e+00],
        [3.8158e+05, 3.8821e+05, 4.0405e+05, 1.6649e+00, 3.7268e+05, 1.8360e+00,
         0.0000e+00, 1.7401e+00, 1.7584e+00, 1.7650e+00, 1.7628e+00, 3.8883e+05,
         1.7130e+00, 1.7500e+00],
        [3.8157e+05, 3.8821e+05, 4.0411e+05, 1.7475e+00, 3.7268e+05, 1.7403e+00,
         1.7401e+00, 0.0000e+00, 1.5909e+00, 1.7190e+00, 1.5975e+00, 3.8885e+05,
         1.7194e+00, 1.7250e+00],
        [3.8159e+05, 3.8822e+05, 4.0414e+05, 1.8211e+00, 3.7263e+05, 1.6808e+00,
         1.7584e+00, 1.5909e+00, 0.0000e+00, 1.7854e+00, 1.7069e+00, 3.8884e+05,
         1.8958e+00, 1.7260e+00],
        [3.8157e+05, 3.8820e+05, 4.0409e+05, 1.6705e+00, 3.7264e+05, 1.7985e+00,
         1.7650e+00, 1.7190e+00, 1.7854e+00, 0.0000e+00, 1.7290e+00, 3.8889e+05,
         1.8786e+00, 1.9050e+00],
        [3.8156e+05, 3.8821e+05, 4.0412e+05, 1.6475e+00, 3.7267e+05, 1.7397e+00,
         1.7628e+00, 1.5975e+00, 1.7069e+00, 1.7290e+00, 0.0000e+00, 3.8889e+05,
         1.7426e+00, 1.7170e+00],
        [7.8815e+05, 7.8662e+05, 7.9125e+05, 3.8883e+05, 7.7082e+05, 3.8883e+05,
         3.8883e+05, 3.8885e+05, 3.8884e+05, 3.8889e+05, 3.8889e+05, 0.0000e+00,
         3.8882e+05, 3.8883e+05],
        [3.8161e+05, 3.8822e+05, 4.0405e+05, 1.7542e+00, 3.7266e+05, 1.7454e+00,
         1.7130e+00, 1.7194e+00, 1.8958e+00, 1.8786e+00, 1.7426e+00, 3.8882e+05,
         0.0000e+00, 1.8217e+00],
        [3.8158e+05, 3.8822e+05, 4.0408e+05, 1.7633e+00, 3.7268e+05, 1.9294e+00,
         1.7500e+00, 1.7250e+00, 1.7260e+00, 1.9050e+00, 1.7170e+00, 3.8883e+05,
         1.8217e+00, 0.0000e+00]])
Krum scores: ['381574.88', '388211.75', '404079.84', '1.72', '372654.50', '1.76', '1.74', '1.69', '1.72', '1.76', '1.70', '388831.56', '1.77', '1.77']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [17, 20, 15, 11, 16, 8, 1, 12, 3, 7, 4, 19, 6, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0030s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:18...
global Accuracy on shared test data: 78.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:18, End: 2025-07-22 15:47:18)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (6): [8, 11, 2, 4, 19, 10], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 6
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([6])
tensor([[0.0000e+00, 1.7903e+00, 1.8916e+00, 1.7222e+00, 3.8352e+05, 1.7686e+00],
        [1.7903e+00, 0.0000e+00, 1.8251e+00, 1.6824e+00, 3.8353e+05, 1.6717e+00],
        [1.8916e+00, 1.8251e+00, 0.0000e+00, 1.6042e+00, 3.8351e+05, 1.4897e+00],
        [1.7222e+00, 1.6824e+00, 1.6042e+00, 0.0000e+00, 3.8350e+05, 1.6384e+00],
        [3.8352e+05, 3.8353e+05, 3.8351e+05, 3.8350e+05, 0.0000e+00, 3.8352e+05],
        [1.7686e+00, 1.6717e+00, 1.4897e+00, 1.6384e+00, 3.8352e+05, 0.0000e+00]])
Krum scores: ['1.76', '1.71', '1.64', '1.64', '383506.19', '1.60']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']], selected_client_indices: [8, 11, 2, 4, 19, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0014s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:18...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 49 214]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:18, End: 2025-07-22 15:47:18)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [2, 7, 1, 17, 3, 10, 12, 15, 20, 16, 4, 18, 11, 13, 14, 19, 8], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.5816e+00, 1.6167e+00, 4.0119e+05, 1.6261e+00, 1.6716e+00,
         1.6102e+00, 4.0309e+05, 3.8372e+05, 3.8100e+05, 1.6161e+00, 3.8864e+05,
         1.7022e+00, 3.9539e+05, 3.8828e+05, 3.9281e+05, 1.7763e+00],
        [1.5816e+00, 0.0000e+00, 1.5909e+00, 4.0120e+05, 1.7361e+00, 1.9383e+00,
         1.7030e+00, 4.0310e+05, 3.8378e+05, 3.8104e+05, 1.6063e+00, 3.8869e+05,
         1.5660e+00, 3.9540e+05, 3.8828e+05, 3.9282e+05, 1.6842e+00],
        [1.6167e+00, 1.5909e+00, 0.0000e+00, 4.0118e+05, 1.6310e+00, 1.7305e+00,
         1.6134e+00, 4.0312e+05, 3.8375e+05, 3.8100e+05, 1.5647e+00, 3.8864e+05,
         1.4801e+00, 3.9539e+05, 3.8831e+05, 3.9280e+05, 1.6141e+00],
        [4.0119e+05, 4.0120e+05, 4.0118e+05, 0.0000e+00, 4.0116e+05, 4.0117e+05,
         4.0118e+05, 7.9032e+05, 7.6899e+05, 7.8437e+05, 4.0116e+05, 7.9747e+05,
         4.0115e+05, 7.9484e+05, 7.7990e+05, 8.0136e+05, 4.0116e+05],
        [1.6261e+00, 1.7361e+00, 1.6310e+00, 4.0116e+05, 0.0000e+00, 1.8527e+00,
         1.5122e+00, 4.0311e+05, 3.8373e+05, 3.8101e+05, 1.6661e+00, 3.8866e+05,
         1.7295e+00, 3.9544e+05, 3.8827e+05, 3.9283e+05, 1.6921e+00],
        [1.6716e+00, 1.9383e+00, 1.7305e+00, 4.0117e+05, 1.8527e+00, 0.0000e+00,
         1.6078e+00, 4.0311e+05, 3.8375e+05, 3.8103e+05, 1.8216e+00, 3.8864e+05,
         1.9130e+00, 3.9543e+05, 3.8826e+05, 3.9279e+05, 1.9759e+00],
        [1.6102e+00, 1.7030e+00, 1.6134e+00, 4.0118e+05, 1.5122e+00, 1.6078e+00,
         0.0000e+00, 4.0312e+05, 3.8375e+05, 3.8103e+05, 1.5411e+00, 3.8865e+05,
         1.6529e+00, 3.9539e+05, 3.8826e+05, 3.9281e+05, 1.6082e+00],
        [4.0309e+05, 4.0310e+05, 4.0312e+05, 7.9032e+05, 4.0311e+05, 4.0311e+05,
         4.0312e+05, 0.0000e+00, 7.3711e+05, 7.9294e+05, 4.0310e+05, 8.2039e+05,
         4.0316e+05, 8.0966e+05, 7.8609e+05, 7.7844e+05, 4.0311e+05],
        [3.8372e+05, 3.8378e+05, 3.8375e+05, 7.6899e+05, 3.8373e+05, 3.8375e+05,
         3.8375e+05, 7.3711e+05, 0.0000e+00, 7.7872e+05, 3.8374e+05, 7.7222e+05,
         3.8374e+05, 7.7768e+05, 7.4518e+05, 7.8960e+05, 3.8372e+05],
        [3.8100e+05, 3.8104e+05, 3.8100e+05, 7.8437e+05, 3.8101e+05, 3.8103e+05,
         3.8103e+05, 7.9294e+05, 7.7872e+05, 0.0000e+00, 3.8100e+05, 7.6521e+05,
         3.8105e+05, 7.7793e+05, 7.5577e+05, 7.8179e+05, 3.8101e+05],
        [1.6161e+00, 1.6063e+00, 1.5647e+00, 4.0116e+05, 1.6661e+00, 1.8216e+00,
         1.5411e+00, 4.0310e+05, 3.8374e+05, 3.8100e+05, 0.0000e+00, 3.8865e+05,
         1.5508e+00, 3.9542e+05, 3.8832e+05, 3.9281e+05, 1.6131e+00],
        [3.8864e+05, 3.8869e+05, 3.8864e+05, 7.9747e+05, 3.8866e+05, 3.8864e+05,
         3.8865e+05, 8.2039e+05, 7.7222e+05, 7.6521e+05, 3.8865e+05, 0.0000e+00,
         3.8864e+05, 7.8337e+05, 7.7900e+05, 7.7614e+05, 3.8866e+05],
        [1.7022e+00, 1.5660e+00, 1.4801e+00, 4.0115e+05, 1.7295e+00, 1.9130e+00,
         1.6529e+00, 4.0316e+05, 3.8374e+05, 3.8105e+05, 1.5508e+00, 3.8864e+05,
         0.0000e+00, 3.9543e+05, 3.8828e+05, 3.9281e+05, 1.6606e+00],
        [3.9539e+05, 3.9540e+05, 3.9539e+05, 7.9484e+05, 3.9544e+05, 3.9543e+05,
         3.9539e+05, 8.0966e+05, 7.7768e+05, 7.7793e+05, 3.9542e+05, 7.8337e+05,
         3.9543e+05, 0.0000e+00, 7.6806e+05, 7.9351e+05, 3.9539e+05],
        [3.8828e+05, 3.8828e+05, 3.8831e+05, 7.7990e+05, 3.8827e+05, 3.8826e+05,
         3.8826e+05, 7.8609e+05, 7.4518e+05, 7.5577e+05, 3.8832e+05, 7.7900e+05,
         3.8828e+05, 7.6806e+05, 0.0000e+00, 8.1468e+05, 3.8830e+05],
        [3.9281e+05, 3.9282e+05, 3.9280e+05, 8.0136e+05, 3.9283e+05, 3.9279e+05,
         3.9281e+05, 7.7844e+05, 7.8960e+05, 7.8179e+05, 3.9281e+05, 7.7614e+05,
         3.9281e+05, 7.9351e+05, 8.1468e+05, 0.0000e+00, 3.9282e+05],
        [1.7763e+00, 1.6842e+00, 1.6141e+00, 4.0116e+05, 1.6921e+00, 1.9759e+00,
         1.6082e+00, 4.0311e+05, 3.8372e+05, 3.8101e+05, 1.6131e+00, 3.8866e+05,
         1.6606e+00, 3.9539e+05, 3.8830e+05, 3.9282e+05, 0.0000e+00]])
Krum scores: ['1.63', '1.64', '1.59', '401163.91', '1.66', '1.79', '1.59', '403105.22', '383736.19', '381010.28', '1.59', '388645.81', '1.62', '395401.50', '388276.66', '392803.97', '1.66']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [2, 7, 1, 17, 3, 10, 12, 15, 20, 16, 4, 18, 11, 13, 14, 19, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0082s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:19...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:19, End: 2025-07-22 15:47:19)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [8, 2, 5, 12, 14, 18, 15, 1, 17, 9, 13, 4], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 1.8588e+00, 1.9137e+00, 1.7320e+00, 3.8509e+05, 3.9988e+05,
         4.0185e+05, 1.8991e+00, 3.8738e+05, 1.8285e+00, 3.9845e+05, 1.7436e+00],
        [1.8588e+00, 0.0000e+00, 1.8281e+00, 1.6646e+00, 3.8510e+05, 3.9990e+05,
         4.0186e+05, 1.7241e+00, 3.8738e+05, 1.6130e+00, 3.9847e+05, 1.7192e+00],
        [1.9137e+00, 1.8281e+00, 0.0000e+00, 1.6646e+00, 3.8511e+05, 3.9995e+05,
         4.0188e+05, 1.7912e+00, 3.8732e+05, 1.8048e+00, 3.9844e+05, 1.7444e+00],
        [1.7320e+00, 1.6646e+00, 1.6646e+00, 0.0000e+00, 3.8508e+05, 3.9990e+05,
         4.0185e+05, 1.6420e+00, 3.8737e+05, 1.6460e+00, 3.9848e+05, 1.6266e+00],
        [3.8509e+05, 3.8510e+05, 3.8511e+05, 3.8508e+05, 0.0000e+00, 7.7058e+05,
         7.9097e+05, 3.8510e+05, 7.7430e+05, 3.8509e+05, 7.6401e+05, 3.8512e+05],
        [3.9988e+05, 3.9990e+05, 3.9995e+05, 3.9990e+05, 7.7058e+05, 0.0000e+00,
         8.0710e+05, 3.9990e+05, 7.8693e+05, 3.9989e+05, 8.2095e+05, 3.9993e+05],
        [4.0185e+05, 4.0186e+05, 4.0188e+05, 4.0185e+05, 7.9097e+05, 8.0710e+05,
         0.0000e+00, 4.0184e+05, 8.0668e+05, 4.0188e+05, 8.1327e+05, 4.0185e+05],
        [1.8991e+00, 1.7241e+00, 1.7912e+00, 1.6420e+00, 3.8510e+05, 3.9990e+05,
         4.0184e+05, 0.0000e+00, 3.8737e+05, 1.5769e+00, 3.9851e+05, 1.7253e+00],
        [3.8738e+05, 3.8738e+05, 3.8732e+05, 3.8737e+05, 7.7430e+05, 7.8693e+05,
         8.0668e+05, 3.8737e+05, 0.0000e+00, 3.8734e+05, 7.8315e+05, 3.8737e+05],
        [1.8285e+00, 1.6130e+00, 1.8048e+00, 1.6460e+00, 3.8509e+05, 3.9989e+05,
         4.0188e+05, 1.5769e+00, 3.8734e+05, 0.0000e+00, 3.9845e+05, 1.6905e+00],
        [3.9845e+05, 3.9847e+05, 3.9844e+05, 3.9848e+05, 7.6401e+05, 8.2095e+05,
         8.1327e+05, 3.9851e+05, 7.8315e+05, 3.9845e+05, 0.0000e+00, 3.9848e+05],
        [1.7436e+00, 1.7192e+00, 1.7444e+00, 1.6266e+00, 3.8512e+05, 3.9993e+05,
         4.0185e+05, 1.7253e+00, 3.8737e+05, 1.6905e+00, 3.9848e+05, 0.0000e+00]])
Krum scores: ['1.81', '1.71', '1.77', '1.65', '385090.03', '399893.22', '401849.53', '1.69', '387353.66', '1.67', '398455.62', '1.70']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [8, 2, 5, 12, 14, 18, 15, 1, 17, 9, 13, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0024s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:19...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:19, End: 2025-07-22 15:47:19)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [5, 14, 12, 1, 9, 15, 16], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 3.9745e+05, 1.7786e+00, 1.5703e+00, 1.6017e+00, 3.9055e+05,
         4.0113e+05],
        [3.9745e+05, 0.0000e+00, 3.9745e+05, 3.9747e+05, 3.9749e+05, 8.0266e+05,
         7.8202e+05],
        [1.7786e+00, 3.9745e+05, 0.0000e+00, 1.5832e+00, 1.5732e+00, 3.9054e+05,
         4.0112e+05],
        [1.5703e+00, 3.9747e+05, 1.5832e+00, 0.0000e+00, 1.3697e+00, 3.9055e+05,
         4.0110e+05],
        [1.6017e+00, 3.9749e+05, 1.5732e+00, 1.3697e+00, 0.0000e+00, 3.9058e+05,
         4.0110e+05],
        [3.9055e+05, 8.0266e+05, 3.9054e+05, 3.9055e+05, 3.9058e+05, 0.0000e+00,
         7.8578e+05],
        [4.0113e+05, 7.8202e+05, 4.0112e+05, 4.0110e+05, 4.0110e+05, 7.8578e+05,
         0.0000e+00]])
Krum scores: ['1.59', '397453.41', '1.58', '1.47', '1.47', '390541.84', '401102.06']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [5, 14, 12, 1, 9, 15, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0015s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:20...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:20, End: 2025-07-22 15:47:20)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [12, 16, 7, 17, 3, 2, 5, 19, 14, 13], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 4.1095e+05, 1.7667e+00, 3.9361e+05, 1.5148e+00, 1.5040e+00,
         1.5968e+00, 3.9506e+05, 3.9241e+05, 3.9729e+05],
        [4.1095e+05, 0.0000e+00, 4.1095e+05, 7.9925e+05, 4.1092e+05, 4.1092e+05,
         4.1093e+05, 8.1496e+05, 7.9311e+05, 7.8603e+05],
        [1.7667e+00, 4.1095e+05, 0.0000e+00, 3.9361e+05, 1.4654e+00, 1.3796e+00,
         1.4436e+00, 3.9506e+05, 3.9245e+05, 3.9733e+05],
        [3.9361e+05, 7.9925e+05, 3.9361e+05, 0.0000e+00, 3.9357e+05, 3.9357e+05,
         3.9361e+05, 7.9083e+05, 8.1235e+05, 7.8474e+05],
        [1.5148e+00, 4.1092e+05, 1.4654e+00, 3.9357e+05, 0.0000e+00, 1.4060e+00,
         1.4268e+00, 3.9505e+05, 3.9244e+05, 3.9731e+05],
        [1.5040e+00, 4.1092e+05, 1.3796e+00, 3.9357e+05, 1.4060e+00, 0.0000e+00,
         1.6164e+00, 3.9503e+05, 3.9244e+05, 3.9732e+05],
        [1.5968e+00, 4.1093e+05, 1.4436e+00, 3.9361e+05, 1.4268e+00, 1.6164e+00,
         0.0000e+00, 3.9506e+05, 3.9247e+05, 3.9732e+05],
        [3.9506e+05, 8.1496e+05, 3.9506e+05, 7.9083e+05, 3.9505e+05, 3.9503e+05,
         3.9506e+05, 0.0000e+00, 7.8314e+05, 8.0896e+05],
        [3.9241e+05, 7.9311e+05, 3.9245e+05, 8.1235e+05, 3.9244e+05, 3.9244e+05,
         3.9247e+05, 7.8314e+05, 0.0000e+00, 7.8821e+05],
        [3.9729e+05, 7.8603e+05, 3.9733e+05, 7.8474e+05, 3.9731e+05, 3.9732e+05,
         3.9732e+05, 8.0896e+05, 7.8821e+05, 0.0000e+00]])
Krum scores: ['1.54', '410922.62', '1.43', '393581.53', '1.43', '1.43', '1.49', '395048.00', '392430.53', '397306.66']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [12, 16, 7, 17, 3, 2, 5, 19, 14, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0020s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:20...
global Accuracy on shared test data: 78.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[189  48]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:20, End: 2025-07-22 15:47:20)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [12, 14, 15, 17, 11, 5, 13, 1, 16], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 3.8871e+05, 3.8638e+05, 3.7420e+05, 1.7575e+00, 1.7016e+00,
         3.8713e+05, 1.3858e+00, 3.9037e+05],
        [3.8871e+05, 0.0000e+00, 7.5664e+05, 7.5525e+05, 3.8872e+05, 3.8875e+05,
         7.7424e+05, 3.8873e+05, 7.8696e+05],
        [3.8638e+05, 7.5664e+05, 0.0000e+00, 7.6423e+05, 3.8641e+05, 3.8642e+05,
         7.8260e+05, 3.8639e+05, 7.9765e+05],
        [3.7420e+05, 7.5525e+05, 7.6423e+05, 0.0000e+00, 3.7417e+05, 3.7420e+05,
         7.6223e+05, 3.7423e+05, 7.5789e+05],
        [1.7575e+00, 3.8872e+05, 3.8641e+05, 3.7417e+05, 0.0000e+00, 1.6036e+00,
         3.8711e+05, 1.7311e+00, 3.9036e+05],
        [1.7016e+00, 3.8875e+05, 3.8642e+05, 3.7420e+05, 1.6036e+00, 0.0000e+00,
         3.8713e+05, 1.7340e+00, 3.9038e+05],
        [3.8713e+05, 7.7424e+05, 7.8260e+05, 7.6223e+05, 3.8711e+05, 3.8713e+05,
         0.0000e+00, 3.8715e+05, 7.8559e+05],
        [1.3858e+00, 3.8873e+05, 3.8639e+05, 3.7423e+05, 1.7311e+00, 1.7340e+00,
         3.8715e+05, 0.0000e+00, 3.9041e+05],
        [3.9037e+05, 7.8696e+05, 7.9765e+05, 7.5789e+05, 3.9036e+05, 3.9038e+05,
         7.8559e+05, 3.9041e+05, 0.0000e+00]])
Krum scores: ['1.54', '388716.56', '386388.31', '374185.19', '1.67', '1.65', '387118.34', '1.56', '390360.78']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [12, 14, 15, 17, 11, 5, 13, 1, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0019s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:20...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[187  50]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:20, End: 2025-07-22 15:47:20)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [14, 16, 15, 8, 18, 9, 6, 3, 12, 11, 13], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
tensor([[0.0000e+00, 7.8754e+05, 7.7178e+05, 3.9991e+05, 8.0381e+05, 3.9996e+05,
         3.9995e+05, 3.9990e+05, 3.9993e+05, 3.9991e+05, 7.8067e+05],
        [7.8754e+05, 0.0000e+00, 7.7103e+05, 3.9716e+05, 7.9873e+05, 3.9718e+05,
         3.9718e+05, 3.9722e+05, 3.9718e+05, 3.9718e+05, 7.8125e+05],
        [7.7178e+05, 7.7103e+05, 0.0000e+00, 3.7357e+05, 7.7873e+05, 3.7357e+05,
         3.7357e+05, 3.7359e+05, 3.7359e+05, 3.7357e+05, 7.6900e+05],
        [3.9991e+05, 3.9716e+05, 3.7357e+05, 0.0000e+00, 3.9858e+05, 1.3532e+00,
         1.2023e+00, 1.3450e+00, 1.9994e+00, 1.3096e+00, 3.8732e+05],
        [8.0381e+05, 7.9873e+05, 7.7873e+05, 3.9858e+05, 0.0000e+00, 3.9862e+05,
         3.9863e+05, 3.9863e+05, 3.9859e+05, 3.9858e+05, 7.9981e+05],
        [3.9996e+05, 3.9718e+05, 3.7357e+05, 1.3532e+00, 3.9862e+05, 0.0000e+00,
         1.3126e+00, 1.2105e+00, 1.6527e+00, 1.2314e+00, 3.8727e+05],
        [3.9995e+05, 3.9718e+05, 3.7357e+05, 1.2023e+00, 3.9863e+05, 1.3126e+00,
         0.0000e+00, 1.3825e+00, 2.0183e+00, 1.2615e+00, 3.8729e+05],
        [3.9990e+05, 3.9722e+05, 3.7359e+05, 1.3450e+00, 3.9863e+05, 1.2105e+00,
         1.3825e+00, 0.0000e+00, 1.8024e+00, 1.3634e+00, 3.8730e+05],
        [3.9993e+05, 3.9718e+05, 3.7359e+05, 1.9994e+00, 3.9859e+05, 1.6527e+00,
         2.0183e+00, 1.8024e+00, 0.0000e+00, 1.9521e+00, 3.8731e+05],
        [3.9991e+05, 3.9718e+05, 3.7357e+05, 1.3096e+00, 3.9858e+05, 1.2314e+00,
         1.2615e+00, 1.3634e+00, 1.9521e+00, 0.0000e+00, 3.8731e+05],
        [7.8067e+05, 7.8125e+05, 7.6900e+05, 3.8732e+05, 7.9981e+05, 3.8727e+05,
         3.8729e+05, 3.8730e+05, 3.8731e+05, 3.8731e+05, 0.0000e+00]])
Krum scores: ['399911.78', '397173.75', '373571.34', '1.30', '398589.41', '1.28', '1.29', '1.33', '1.85', '1.29', '387292.28']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [14, 16, 15, 8, 18, 9, 6, 3, 12, 11, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0228s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:21...
global Accuracy on shared test data: 78.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:21, End: 2025-07-22 15:47:21)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [4, 16, 7, 12, 9, 20, 17], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 3.8722e+05, 1.2776e+00, 1.4874e+00, 1.4875e+00, 3.9215e+05,
         3.9393e+05],
        [3.8722e+05, 0.0000e+00, 3.8720e+05, 3.8721e+05, 3.8719e+05, 7.7731e+05,
         7.7716e+05],
        [1.2776e+00, 3.8720e+05, 0.0000e+00, 1.5176e+00, 1.5529e+00, 3.9216e+05,
         3.9390e+05],
        [1.4874e+00, 3.8721e+05, 1.5176e+00, 0.0000e+00, 1.2301e+00, 3.9219e+05,
         3.9391e+05],
        [1.4875e+00, 3.8719e+05, 1.5529e+00, 1.2301e+00, 0.0000e+00, 3.9218e+05,
         3.9389e+05],
        [3.9215e+05, 7.7731e+05, 3.9216e+05, 3.9219e+05, 3.9218e+05, 0.0000e+00,
         7.8713e+05],
        [3.9393e+05, 7.7716e+05, 3.9390e+05, 3.9391e+05, 3.9389e+05, 7.8713e+05,
         0.0000e+00]])
Krum scores: ['1.38', '387195.34', '1.40', '1.36', '1.36', '392158.31', '393894.53']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [4, 16, 7, 12, 9, 20, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0015s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:21...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:21, End: 2025-07-22 15:47:21)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [16, 13], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[     0.0000, 767951.2500],
        [767951.2500,      0.0000]])
Krum scores: ['nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [16, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0008s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:21...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[194  43]
 [214  49]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:21, End: 2025-07-22 15:47:21)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [17, 15, 11, 1, 18, 20, 3, 7, 5, 13, 19, 6, 10, 4, 2, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 7.5389e+05, 3.7669e+05, 3.7667e+05, 7.5815e+05, 7.5977e+05,
         3.7672e+05, 3.7669e+05, 3.7670e+05, 7.6873e+05, 7.7601e+05, 3.7668e+05,
         3.7664e+05, 3.7669e+05, 3.7668e+05, 7.5909e+05, 3.7670e+05],
        [7.5389e+05, 0.0000e+00, 3.8333e+05, 3.8337e+05, 7.9481e+05, 8.0136e+05,
         3.8340e+05, 3.8340e+05, 3.8339e+05, 7.8048e+05, 7.7306e+05, 3.8339e+05,
         3.8340e+05, 3.8338e+05, 3.8339e+05, 7.3392e+05, 3.8337e+05],
        [3.7669e+05, 3.8333e+05, 0.0000e+00, 3.4173e+00, 3.9569e+05, 4.0551e+05,
         3.2508e+00, 3.1900e+00, 3.0846e+00, 3.9453e+05, 3.9177e+05, 3.2564e+00,
         3.2066e+00, 3.3846e+00, 3.2264e+00, 3.7344e+05, 3.2339e+00],
        [3.7667e+05, 3.8337e+05, 3.4173e+00, 0.0000e+00, 3.9560e+05, 4.0546e+05,
         3.2401e+00, 3.1199e+00, 3.2036e+00, 3.9456e+05, 3.9178e+05, 3.6324e+00,
         3.2926e+00, 3.3918e+00, 3.2312e+00, 3.7345e+05, 3.2084e+00],
        [7.5815e+05, 7.9481e+05, 3.9569e+05, 3.9560e+05, 0.0000e+00, 7.8156e+05,
         3.9563e+05, 3.9565e+05, 3.9564e+05, 7.7650e+05, 8.0148e+05, 3.9568e+05,
         3.9566e+05, 3.9566e+05, 3.9568e+05, 7.7232e+05, 3.9568e+05],
        [7.5977e+05, 8.0136e+05, 4.0551e+05, 4.0546e+05, 7.8156e+05, 0.0000e+00,
         4.0550e+05, 4.0547e+05, 4.0546e+05, 7.8834e+05, 7.9616e+05, 4.0549e+05,
         4.0550e+05, 4.0550e+05, 4.0553e+05, 7.8141e+05, 4.0547e+05],
        [3.7672e+05, 3.8340e+05, 3.2508e+00, 3.2401e+00, 3.9563e+05, 4.0550e+05,
         0.0000e+00, 3.2362e+00, 3.1588e+00, 3.9450e+05, 3.9172e+05, 3.3832e+00,
         3.1951e+00, 3.0890e+00, 3.3470e+00, 3.7343e+05, 3.2538e+00],
        [3.7669e+05, 3.8340e+05, 3.1900e+00, 3.1199e+00, 3.9565e+05, 4.0547e+05,
         3.2362e+00, 0.0000e+00, 3.2315e+00, 3.9453e+05, 3.9175e+05, 3.5027e+00,
         3.0591e+00, 3.4562e+00, 3.1033e+00, 3.7341e+05, 3.1234e+00],
        [3.7670e+05, 3.8339e+05, 3.0846e+00, 3.2036e+00, 3.9564e+05, 4.0546e+05,
         3.1588e+00, 3.2315e+00, 0.0000e+00, 3.9457e+05, 3.9172e+05, 3.4684e+00,
         3.1783e+00, 3.2779e+00, 3.3652e+00, 3.7347e+05, 3.4977e+00],
        [7.6873e+05, 7.8048e+05, 3.9453e+05, 3.9456e+05, 7.7650e+05, 7.8834e+05,
         3.9450e+05, 3.9453e+05, 3.9457e+05, 0.0000e+00, 7.9937e+05, 3.9454e+05,
         3.9455e+05, 3.9455e+05, 3.9454e+05, 7.6808e+05, 3.9454e+05],
        [7.7601e+05, 7.7306e+05, 3.9177e+05, 3.9178e+05, 8.0148e+05, 7.9616e+05,
         3.9172e+05, 3.9175e+05, 3.9172e+05, 7.9937e+05, 0.0000e+00, 3.9173e+05,
         3.9177e+05, 3.9174e+05, 3.9174e+05, 7.6096e+05, 3.9171e+05],
        [3.7668e+05, 3.8339e+05, 3.2564e+00, 3.6324e+00, 3.9568e+05, 4.0549e+05,
         3.3832e+00, 3.5027e+00, 3.4684e+00, 3.9454e+05, 3.9173e+05, 0.0000e+00,
         3.2129e+00, 3.3895e+00, 3.3771e+00, 3.7347e+05, 3.5306e+00],
        [3.7664e+05, 3.8340e+05, 3.2066e+00, 3.2926e+00, 3.9566e+05, 4.0550e+05,
         3.1951e+00, 3.0591e+00, 3.1783e+00, 3.9455e+05, 3.9177e+05, 3.2129e+00,
         0.0000e+00, 3.0217e+00, 3.1520e+00, 3.7345e+05, 3.0452e+00],
        [3.7669e+05, 3.8338e+05, 3.3846e+00, 3.3918e+00, 3.9566e+05, 4.0550e+05,
         3.0890e+00, 3.4562e+00, 3.2779e+00, 3.9455e+05, 3.9174e+05, 3.3895e+00,
         3.0217e+00, 0.0000e+00, 3.3720e+00, 3.7347e+05, 3.1177e+00],
        [3.7668e+05, 3.8339e+05, 3.2264e+00, 3.2312e+00, 3.9568e+05, 4.0553e+05,
         3.3470e+00, 3.1033e+00, 3.3652e+00, 3.9454e+05, 3.9174e+05, 3.3771e+00,
         3.1520e+00, 3.3720e+00, 0.0000e+00, 3.7345e+05, 3.1455e+00],
        [7.5909e+05, 7.3392e+05, 3.7344e+05, 3.7345e+05, 7.7232e+05, 7.8141e+05,
         3.7343e+05, 3.7341e+05, 3.7347e+05, 7.6808e+05, 7.6096e+05, 3.7347e+05,
         3.7345e+05, 3.7347e+05, 3.7345e+05, 0.0000e+00, 3.7347e+05],
        [3.7670e+05, 3.8337e+05, 3.2339e+00, 3.2084e+00, 3.9568e+05, 4.0547e+05,
         3.2538e+00, 3.1234e+00, 3.4977e+00, 3.9454e+05, 3.9171e+05, 3.5306e+00,
         3.0452e+00, 3.1177e+00, 3.1455e+00, 3.7347e+05, 0.0000e+00]])
Krum scores: ['376678.28', '383377.53', '3.23', '3.26', '395649.56', '405482.00', '3.22', '3.19', '3.25', '394536.62', '391734.41', '3.39', '3.13', '3.26', '3.24', '373447.44', '3.20']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [17, 15, 11, 1, 18, 20, 3, 7, 5, 13, 19, 6, 10, 4, 2, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:22...
global Accuracy on shared test data: 47.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [210  53]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:22, End: 2025-07-22 15:47:22)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [11, 16, 17, 9, 6, 12, 20], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
tensor([[0.0000e+00, 3.9709e+05, 3.8646e+05, 3.4184e+00, 3.3636e+00, 3.2299e+00,
         4.0155e+05],
        [3.9709e+05, 0.0000e+00, 7.7731e+05, 3.9709e+05, 3.9713e+05, 3.9708e+05,
         7.8926e+05],
        [3.8646e+05, 7.7731e+05, 0.0000e+00, 3.8646e+05, 3.8650e+05, 3.8651e+05,
         8.0929e+05],
        [3.4184e+00, 3.9709e+05, 3.8646e+05, 0.0000e+00, 3.7086e+00, 3.2812e+00,
         4.0157e+05],
        [3.3636e+00, 3.9713e+05, 3.8650e+05, 3.7086e+00, 0.0000e+00, 3.4361e+00,
         4.0152e+05],
        [3.2299e+00, 3.9708e+05, 3.8651e+05, 3.2812e+00, 3.4361e+00, 0.0000e+00,
         4.0157e+05],
        [4.0155e+05, 7.8926e+05, 8.0929e+05, 4.0157e+05, 4.0152e+05, 4.0157e+05,
         0.0000e+00]])
Krum scores: ['3.30', '397084.16', '386459.91', '3.35', '3.40', '3.26', '401535.56']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']], selected_client_indices: [11, 16, 17, 9, 6, 12, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0249s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:22...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [199  64]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:22, End: 2025-07-22 15:47:22)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [12, 10, 17, 18, 19, 4, 7, 2, 3, 8, 16, 5, 20, 1], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.1719e+00, 3.9502e+05, 3.8465e+05, 3.9179e+05, 3.1760e+00,
         3.1153e+00, 3.1272e+00, 3.3586e+00, 3.6754e+00, 3.8005e+05, 3.5870e+00,
         3.8830e+05, 3.2978e+00],
        [3.1719e+00, 0.0000e+00, 3.9500e+05, 3.8466e+05, 3.9179e+05, 3.2230e+00,
         3.2375e+00, 3.2559e+00, 3.3244e+00, 3.5093e+00, 3.8007e+05, 3.2952e+00,
         3.8826e+05, 3.3413e+00],
        [3.9502e+05, 3.9500e+05, 0.0000e+00, 7.8756e+05, 7.7430e+05, 3.9495e+05,
         3.9497e+05, 3.9498e+05, 3.9498e+05, 3.9500e+05, 7.7461e+05, 3.9499e+05,
         7.9089e+05, 3.9497e+05],
        [3.8465e+05, 3.8466e+05, 7.8756e+05, 0.0000e+00, 7.6875e+05, 3.8461e+05,
         3.8465e+05, 3.8465e+05, 3.8463e+05, 3.8463e+05, 7.6357e+05, 3.8454e+05,
         7.7090e+05, 3.8468e+05],
        [3.9179e+05, 3.9179e+05, 7.7430e+05, 7.6875e+05, 0.0000e+00, 3.9182e+05,
         3.9180e+05, 3.9177e+05, 3.9181e+05, 3.9180e+05, 7.7190e+05, 3.9181e+05,
         7.8134e+05, 3.9179e+05],
        [3.1760e+00, 3.2230e+00, 3.9495e+05, 3.8461e+05, 3.9182e+05, 0.0000e+00,
         3.4477e+00, 3.4538e+00, 3.2266e+00, 3.5845e+00, 3.8009e+05, 3.4092e+00,
         3.8830e+05, 3.3674e+00],
        [3.1153e+00, 3.2375e+00, 3.9497e+05, 3.8465e+05, 3.9180e+05, 3.4477e+00,
         0.0000e+00, 3.1333e+00, 3.3472e+00, 3.6233e+00, 3.8006e+05, 3.4343e+00,
         3.8830e+05, 3.4298e+00],
        [3.1272e+00, 3.2559e+00, 3.9498e+05, 3.8465e+05, 3.9177e+05, 3.4538e+00,
         3.1333e+00, 0.0000e+00, 3.3442e+00, 3.4197e+00, 3.8010e+05, 3.4480e+00,
         3.8831e+05, 3.3589e+00],
        [3.3586e+00, 3.3244e+00, 3.9498e+05, 3.8463e+05, 3.9181e+05, 3.2266e+00,
         3.3472e+00, 3.3442e+00, 0.0000e+00, 3.4338e+00, 3.8009e+05, 3.3044e+00,
         3.8829e+05, 3.4354e+00],
        [3.6754e+00, 3.5093e+00, 3.9500e+05, 3.8463e+05, 3.9180e+05, 3.5845e+00,
         3.6233e+00, 3.4197e+00, 3.4338e+00, 0.0000e+00, 3.8009e+05, 3.6421e+00,
         3.8827e+05, 3.6964e+00],
        [3.8005e+05, 3.8007e+05, 7.7461e+05, 7.6357e+05, 7.7190e+05, 3.8009e+05,
         3.8006e+05, 3.8010e+05, 3.8009e+05, 3.8009e+05, 0.0000e+00, 3.8008e+05,
         7.4393e+05, 3.8004e+05],
        [3.5870e+00, 3.2952e+00, 3.9499e+05, 3.8454e+05, 3.9181e+05, 3.4092e+00,
         3.4343e+00, 3.4480e+00, 3.3044e+00, 3.6421e+00, 3.8008e+05, 0.0000e+00,
         3.8829e+05, 3.4305e+00],
        [3.8830e+05, 3.8826e+05, 7.9089e+05, 7.7090e+05, 7.8134e+05, 3.8830e+05,
         3.8830e+05, 3.8831e+05, 3.8829e+05, 3.8827e+05, 7.4393e+05, 3.8829e+05,
         0.0000e+00, 3.8827e+05],
        [3.2978e+00, 3.3413e+00, 3.9497e+05, 3.8468e+05, 3.9179e+05, 3.3674e+00,
         3.4298e+00, 3.3589e+00, 3.4354e+00, 3.6964e+00, 3.8004e+05, 3.4305e+00,
         3.8827e+05, 0.0000e+00]])
Krum scores: ['3.26', '3.26', '394978.06', '384623.25', '391792.16', '3.33', '3.31', '3.30', '3.33', '3.56', '380069.97', '3.42', '388282.09', '3.38']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [12, 10, 17, 18, 19, 4, 7, 2, 3, 8, 16, 5, 20, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0167s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:23...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [192  71]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:23, End: 2025-07-22 15:47:23)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [7, 16, 15, 4, 8], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
tensor([[0.0000e+00, 3.8325e+05, 4.0230e+05, 3.5509e+00, 3.7009e+00],
        [3.8325e+05, 0.0000e+00, 7.7879e+05, 3.8325e+05, 3.8324e+05],
        [4.0230e+05, 7.7879e+05, 0.0000e+00, 4.0235e+05, 4.0230e+05],
        [3.5509e+00, 3.8325e+05, 4.0235e+05, 0.0000e+00, 3.6269e+00],
        [3.7009e+00, 3.8324e+05, 4.0230e+05, 3.6269e+00, 0.0000e+00]])
Krum scores: ['3.55', '383237.53', '402297.38', '3.55', '3.63']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']], selected_client_indices: [7, 16, 15, 4, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0013s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:23...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[160  77]
 [183  80]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:23, End: 2025-07-22 15:47:23)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [9, 2, 18, 5, 10, 16, 11, 3, 6], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 3.5415e+00, 3.9688e+05, 3.5184e+00, 3.8273e+00, 4.0280e+05,
         3.5015e+00, 3.5906e+00, 3.7313e+00],
        [3.5415e+00, 0.0000e+00, 3.9685e+05, 3.3515e+00, 3.2210e+00, 4.0279e+05,
         3.4620e+00, 3.3592e+00, 3.4011e+00],
        [3.9688e+05, 3.9685e+05, 0.0000e+00, 3.9688e+05, 3.9687e+05, 8.2900e+05,
         3.9688e+05, 3.9693e+05, 3.9691e+05],
        [3.5184e+00, 3.3515e+00, 3.9688e+05, 0.0000e+00, 3.3320e+00, 4.0276e+05,
         3.3636e+00, 3.3869e+00, 3.6486e+00],
        [3.8273e+00, 3.2210e+00, 3.9687e+05, 3.3320e+00, 0.0000e+00, 4.0282e+05,
         3.5275e+00, 3.2933e+00, 3.4520e+00],
        [4.0280e+05, 4.0279e+05, 8.2900e+05, 4.0276e+05, 4.0282e+05, 0.0000e+00,
         4.0280e+05, 4.0278e+05, 4.0275e+05],
        [3.5015e+00, 3.4620e+00, 3.9688e+05, 3.3636e+00, 3.5275e+00, 4.0280e+05,
         0.0000e+00, 3.4405e+00, 3.4450e+00],
        [3.5906e+00, 3.3592e+00, 3.9693e+05, 3.3869e+00, 3.2933e+00, 4.0278e+05,
         3.4405e+00, 0.0000e+00, 3.4737e+00],
        [3.7313e+00, 3.4011e+00, 3.9691e+05, 3.6486e+00, 3.4520e+00, 4.0275e+05,
         3.4450e+00, 3.4737e+00, 0.0000e+00]])
Krum scores: ['3.58', '3.36', '396873.41', '3.39', '3.37', '402775.56', '3.44', '3.39', '3.48']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [9, 2, 18, 5, 10, 16, 11, 3, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0019s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:24...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[156  81]
 [172  91]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:24, End: 2025-07-22 15:47:24)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 19, 20, 8, 6, 1, 7, 13, 12, 11, 3, 9, 16, 2, 18, 5, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 7.7116e+05, 7.7990e+05, 3.9102e+05, 3.9100e+05, 3.9100e+05,
         3.9110e+05, 8.1001e+05, 3.9105e+05, 3.9105e+05, 3.9099e+05, 3.9099e+05,
         7.8748e+05, 3.9101e+05, 7.8588e+05, 3.9100e+05, 3.9099e+05, 7.9951e+05],
        [7.7116e+05, 0.0000e+00, 7.7334e+05, 3.8460e+05, 3.8461e+05, 3.8461e+05,
         3.8458e+05, 7.7915e+05, 3.8461e+05, 3.8458e+05, 3.8460e+05, 3.8459e+05,
         7.7927e+05, 3.8462e+05, 7.8497e+05, 3.8461e+05, 3.8459e+05, 8.1057e+05],
        [7.7990e+05, 7.7334e+05, 0.0000e+00, 3.8752e+05, 3.8747e+05, 3.8749e+05,
         3.8747e+05, 7.6678e+05, 3.8747e+05, 3.8748e+05, 3.8748e+05, 3.8749e+05,
         7.6989e+05, 3.8747e+05, 7.7686e+05, 3.8746e+05, 3.8754e+05, 7.9542e+05],
        [3.9102e+05, 3.8460e+05, 3.8752e+05, 0.0000e+00, 3.7324e+00, 3.6558e+00,
         3.8221e+00, 3.9531e+05, 3.6264e+00, 3.9557e+00, 3.4772e+00, 3.7529e+00,
         3.8745e+05, 3.5051e+00, 3.9575e+05, 3.7067e+00, 3.5618e+00, 4.0796e+05],
        [3.9100e+05, 3.8461e+05, 3.8747e+05, 3.7324e+00, 0.0000e+00, 3.7937e+00,
         3.9938e+00, 3.9527e+05, 3.5929e+00, 3.5134e+00, 3.4534e+00, 3.9507e+00,
         3.8753e+05, 3.4769e+00, 3.9570e+05, 3.6534e+00, 3.4510e+00, 4.0799e+05],
        [3.9100e+05, 3.8461e+05, 3.8749e+05, 3.6558e+00, 3.7937e+00, 0.0000e+00,
         3.6243e+00, 3.9535e+05, 3.5493e+00, 3.8804e+00, 3.4178e+00, 3.3957e+00,
         3.8749e+05, 3.3950e+00, 3.9573e+05, 3.4770e+00, 3.4771e+00, 4.0797e+05],
        [3.9110e+05, 3.8458e+05, 3.8747e+05, 3.8221e+00, 3.9938e+00, 3.6243e+00,
         0.0000e+00, 3.9528e+05, 3.5401e+00, 3.6619e+00, 3.5289e+00, 3.7869e+00,
         3.8746e+05, 3.1960e+00, 3.9574e+05, 3.4587e+00, 3.2827e+00, 4.0799e+05],
        [8.1001e+05, 7.7915e+05, 7.6678e+05, 3.9531e+05, 3.9527e+05, 3.9535e+05,
         3.9528e+05, 0.0000e+00, 3.9533e+05, 3.9533e+05, 3.9527e+05, 3.9532e+05,
         7.7895e+05, 3.9534e+05, 7.7776e+05, 3.9533e+05, 3.9535e+05, 8.2670e+05],
        [3.9105e+05, 3.8461e+05, 3.8747e+05, 3.6264e+00, 3.5929e+00, 3.5493e+00,
         3.5401e+00, 3.9533e+05, 0.0000e+00, 3.6300e+00, 3.4501e+00, 3.8267e+00,
         3.8745e+05, 3.2524e+00, 3.9572e+05, 3.7720e+00, 3.2695e+00, 4.0798e+05],
        [3.9105e+05, 3.8458e+05, 3.8748e+05, 3.9557e+00, 3.5134e+00, 3.8804e+00,
         3.6619e+00, 3.9533e+05, 3.6300e+00, 0.0000e+00, 3.5696e+00, 3.6538e+00,
         3.8744e+05, 3.5204e+00, 3.9574e+05, 3.4605e+00, 3.4691e+00, 4.0796e+05],
        [3.9099e+05, 3.8460e+05, 3.8748e+05, 3.4772e+00, 3.4534e+00, 3.4178e+00,
         3.5289e+00, 3.9527e+05, 3.4501e+00, 3.5696e+00, 0.0000e+00, 3.5851e+00,
         3.8746e+05, 3.3226e+00, 3.9573e+05, 3.5124e+00, 3.2203e+00, 4.0797e+05],
        [3.9099e+05, 3.8459e+05, 3.8749e+05, 3.7529e+00, 3.9507e+00, 3.3957e+00,
         3.7869e+00, 3.9532e+05, 3.8267e+00, 3.6538e+00, 3.5851e+00, 0.0000e+00,
         3.8747e+05, 3.6100e+00, 3.9579e+05, 3.5508e+00, 3.8727e+00, 4.0797e+05],
        [7.8748e+05, 7.7927e+05, 7.6989e+05, 3.8745e+05, 3.8753e+05, 3.8749e+05,
         3.8746e+05, 7.7895e+05, 3.8745e+05, 3.8744e+05, 3.8746e+05, 3.8747e+05,
         0.0000e+00, 3.8747e+05, 7.7787e+05, 3.8751e+05, 3.8748e+05, 7.7803e+05],
        [3.9101e+05, 3.8462e+05, 3.8747e+05, 3.5051e+00, 3.4769e+00, 3.3950e+00,
         3.1960e+00, 3.9534e+05, 3.2524e+00, 3.5204e+00, 3.3226e+00, 3.6100e+00,
         3.8747e+05, 0.0000e+00, 3.9571e+05, 3.4272e+00, 3.2254e+00, 4.0798e+05],
        [7.8588e+05, 7.8497e+05, 7.7686e+05, 3.9575e+05, 3.9570e+05, 3.9573e+05,
         3.9574e+05, 7.7776e+05, 3.9572e+05, 3.9574e+05, 3.9573e+05, 3.9579e+05,
         7.7787e+05, 3.9571e+05, 0.0000e+00, 3.9574e+05, 3.9569e+05, 8.2622e+05],
        [3.9100e+05, 3.8461e+05, 3.8746e+05, 3.7067e+00, 3.6534e+00, 3.4770e+00,
         3.4587e+00, 3.9533e+05, 3.7720e+00, 3.4605e+00, 3.5124e+00, 3.5508e+00,
         3.8751e+05, 3.4272e+00, 3.9574e+05, 0.0000e+00, 3.3065e+00, 4.0803e+05],
        [3.9099e+05, 3.8459e+05, 3.8754e+05, 3.5618e+00, 3.4510e+00, 3.4771e+00,
         3.2827e+00, 3.9535e+05, 3.2695e+00, 3.4691e+00, 3.2203e+00, 3.8727e+00,
         3.8748e+05, 3.2254e+00, 3.9569e+05, 3.3065e+00, 0.0000e+00, 4.0799e+05],
        [7.9951e+05, 8.1057e+05, 7.9542e+05, 4.0796e+05, 4.0799e+05, 4.0797e+05,
         4.0799e+05, 8.2670e+05, 4.0798e+05, 4.0796e+05, 4.0797e+05, 4.0797e+05,
         7.7803e+05, 4.0798e+05, 8.2622e+05, 4.0803e+05, 4.0799e+05, 0.0000e+00]])
Krum scores: ['391005.19', '384597.25', '387476.28', '3.65', '3.62', '3.53', '3.54', '395309.28', '3.52', '3.60', '3.44', '3.67', '387464.00', '3.37', '395722.09', '3.51', '3.36', '407974.50']
Selected index: 16
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']
 ['Update 17']], selected_client_indices: [14, 19, 20, 8, 6, 1, 7, 13, 12, 11, 3, 9, 16, 2, 18, 5, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0072s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:24...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[150  87]
 [164  99]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:24, End: 2025-07-22 15:47:24)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [4, 2, 3, 12, 16, 15, 13, 11, 19, 10, 1, 6, 8, 5, 20, 14], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.5564e+00, 3.3968e+00, 3.5278e+00, 3.8631e+05, 3.8536e+05,
         3.8766e+05, 3.7306e+00, 3.9601e+05, 3.3302e+00, 3.6534e+00, 3.3507e+00,
         3.9015e+00, 3.5254e+00, 4.0540e+05, 4.0507e+05],
        [3.5564e+00, 0.0000e+00, 3.4116e+00, 3.2945e+00, 3.8634e+05, 3.8540e+05,
         3.8774e+05, 3.6331e+00, 3.9607e+05, 3.3191e+00, 3.6198e+00, 3.4688e+00,
         3.7194e+00, 3.3763e+00, 4.0546e+05, 4.0504e+05],
        [3.3968e+00, 3.4116e+00, 0.0000e+00, 3.4795e+00, 3.8633e+05, 3.8539e+05,
         3.8775e+05, 3.6057e+00, 3.9600e+05, 3.2992e+00, 3.6717e+00, 3.3589e+00,
         3.6121e+00, 3.5919e+00, 4.0541e+05, 4.0505e+05],
        [3.5278e+00, 3.2945e+00, 3.4795e+00, 0.0000e+00, 3.8632e+05, 3.8547e+05,
         3.8770e+05, 3.7135e+00, 3.9603e+05, 3.2804e+00, 3.8147e+00, 3.6175e+00,
         3.7036e+00, 3.7757e+00, 4.0538e+05, 4.0501e+05],
        [3.8631e+05, 3.8634e+05, 3.8633e+05, 3.8632e+05, 0.0000e+00, 7.6681e+05,
         7.7266e+05, 3.8634e+05, 7.4490e+05, 3.8637e+05, 3.8635e+05, 3.8636e+05,
         3.8636e+05, 3.8629e+05, 7.7843e+05, 7.7210e+05],
        [3.8536e+05, 3.8540e+05, 3.8539e+05, 3.8547e+05, 7.6681e+05, 0.0000e+00,
         7.7308e+05, 3.8542e+05, 7.6392e+05, 3.8540e+05, 3.8541e+05, 3.8548e+05,
         3.8545e+05, 3.8542e+05, 8.0299e+05, 7.8755e+05],
        [3.8766e+05, 3.8774e+05, 3.8775e+05, 3.8770e+05, 7.7266e+05, 7.7308e+05,
         0.0000e+00, 3.8768e+05, 7.7886e+05, 3.8766e+05, 3.8768e+05, 3.8771e+05,
         3.8770e+05, 3.8771e+05, 8.0466e+05, 8.1765e+05],
        [3.7306e+00, 3.6331e+00, 3.6057e+00, 3.7135e+00, 3.8634e+05, 3.8542e+05,
         3.8768e+05, 0.0000e+00, 3.9606e+05, 3.4571e+00, 4.0819e+00, 3.4532e+00,
         4.1914e+00, 3.5219e+00, 4.0541e+05, 4.0510e+05],
        [3.9601e+05, 3.9607e+05, 3.9600e+05, 3.9603e+05, 7.4490e+05, 7.6392e+05,
         7.7886e+05, 3.9606e+05, 0.0000e+00, 3.9599e+05, 3.9598e+05, 3.9606e+05,
         3.9604e+05, 3.9603e+05, 8.1187e+05, 7.8219e+05],
        [3.3302e+00, 3.3191e+00, 3.2992e+00, 3.2804e+00, 3.8637e+05, 3.8540e+05,
         3.8766e+05, 3.4571e+00, 3.9599e+05, 0.0000e+00, 3.6808e+00, 3.3160e+00,
         3.7234e+00, 3.3272e+00, 4.0539e+05, 4.0507e+05],
        [3.6534e+00, 3.6198e+00, 3.6717e+00, 3.8147e+00, 3.8635e+05, 3.8541e+05,
         3.8768e+05, 4.0819e+00, 3.9598e+05, 3.6808e+00, 0.0000e+00, 3.8407e+00,
         4.0826e+00, 3.6403e+00, 4.0539e+05, 4.0506e+05],
        [3.3507e+00, 3.4688e+00, 3.3589e+00, 3.6175e+00, 3.8636e+05, 3.8548e+05,
         3.8771e+05, 3.4532e+00, 3.9606e+05, 3.3160e+00, 3.8407e+00, 0.0000e+00,
         3.8256e+00, 3.5360e+00, 4.0542e+05, 4.0501e+05],
        [3.9015e+00, 3.7194e+00, 3.6121e+00, 3.7036e+00, 3.8636e+05, 3.8545e+05,
         3.8770e+05, 4.1914e+00, 3.9604e+05, 3.7234e+00, 4.0826e+00, 3.8256e+00,
         0.0000e+00, 3.7469e+00, 4.0539e+05, 4.0504e+05],
        [3.5254e+00, 3.3763e+00, 3.5919e+00, 3.7757e+00, 3.8629e+05, 3.8542e+05,
         3.8771e+05, 3.5219e+00, 3.9603e+05, 3.3272e+00, 3.6403e+00, 3.5360e+00,
         3.7469e+00, 0.0000e+00, 4.0542e+05, 4.0507e+05],
        [4.0540e+05, 4.0546e+05, 4.0541e+05, 4.0538e+05, 7.7843e+05, 8.0299e+05,
         8.0466e+05, 4.0541e+05, 8.1187e+05, 4.0539e+05, 4.0539e+05, 4.0542e+05,
         4.0539e+05, 4.0542e+05, 0.0000e+00, 8.1125e+05],
        [4.0507e+05, 4.0504e+05, 4.0505e+05, 4.0501e+05, 7.7210e+05, 7.8755e+05,
         8.1765e+05, 4.0510e+05, 7.8219e+05, 4.0507e+05, 4.0506e+05, 4.0501e+05,
         4.0504e+05, 4.0507e+05, 8.1125e+05, 0.0000e+00]])
Krum scores: ['3.51', '3.46', '3.47', '3.55', '386330.38', '385406.19', '387687.59', '3.65', '396015.62', '3.38', '3.75', '3.49', '3.79', '3.53', '405398.75', '405043.69']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 2, 3, 12, 16, 15, 13, 11, 19, 10, 1, 6, 8, 5, 20, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0158s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:25...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[147  90]
 [161 102]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:25, End: 2025-07-22 15:47:25)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [19, 13, 3, 15, 5, 1, 12, 18, 20, 7], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 7.7788e+05, 3.8348e+05, 8.0862e+05, 3.8342e+05, 3.8345e+05,
         3.8347e+05, 7.6060e+05, 7.7705e+05, 3.8343e+05],
        [7.7788e+05, 0.0000e+00, 3.8545e+05, 7.9311e+05, 3.8550e+05, 3.8547e+05,
         3.8554e+05, 7.8412e+05, 8.0815e+05, 3.8547e+05],
        [3.8348e+05, 3.8545e+05, 0.0000e+00, 4.0181e+05, 3.6773e+00, 3.6625e+00,
         3.5024e+00, 3.8968e+05, 4.0160e+05, 3.6809e+00],
        [8.0862e+05, 7.9311e+05, 4.0181e+05, 0.0000e+00, 4.0178e+05, 4.0181e+05,
         4.0185e+05, 7.9082e+05, 8.0651e+05, 4.0184e+05],
        [3.8342e+05, 3.8550e+05, 3.6773e+00, 4.0178e+05, 0.0000e+00, 3.7106e+00,
         3.8787e+00, 3.8964e+05, 4.0159e+05, 3.6100e+00],
        [3.8345e+05, 3.8547e+05, 3.6625e+00, 4.0181e+05, 3.7106e+00, 0.0000e+00,
         3.8567e+00, 3.8963e+05, 4.0161e+05, 3.9391e+00],
        [3.8347e+05, 3.8554e+05, 3.5024e+00, 4.0185e+05, 3.8787e+00, 3.8567e+00,
         0.0000e+00, 3.8966e+05, 4.0158e+05, 3.5618e+00],
        [7.6060e+05, 7.8412e+05, 3.8968e+05, 7.9082e+05, 3.8964e+05, 3.8963e+05,
         3.8966e+05, 0.0000e+00, 7.9798e+05, 3.8967e+05],
        [7.7705e+05, 8.0815e+05, 4.0160e+05, 8.0651e+05, 4.0159e+05, 4.0161e+05,
         4.0158e+05, 7.9798e+05, 0.0000e+00, 4.0166e+05],
        [3.8343e+05, 3.8547e+05, 3.6809e+00, 4.0184e+05, 3.6100e+00, 3.9391e+00,
         3.5618e+00, 3.8967e+05, 4.0166e+05, 0.0000e+00]])
Krum scores: ['383432.03', '385465.66', '3.61', '401799.06', '3.67', '3.74', '3.64', '389641.03', '401589.78', '3.62']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [19, 13, 3, 15, 5, 1, 12, 18, 20, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0021s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:25...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[142  95]
 [160 103]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:25, End: 2025-07-22 15:47:25)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [18], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
tensor([[0.]])
Krum scores: ['nan']
Selected index: 0
krum, clients_type: [['Chosen Update']], selected_client_indices: [18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:25...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 75 162]
 [ 93 170]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:47:25, End: 2025-07-22 15:47:25)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [19, 7, 11, 12, 18, 4, 8, 17, 3, 14, 1, 6, 13, 20, 16, 10, 15, 5], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.9203e+05, 3.9205e+05, 3.9209e+05, 8.0384e+05, 3.9205e+05,
         3.9204e+05, 7.4621e+05, 3.9203e+05, 8.0970e+05, 3.9204e+05, 3.9207e+05,
         7.6837e+05, 7.7623e+05, 7.7430e+05, 3.9206e+05, 7.8108e+05, 3.9208e+05],
        [3.9203e+05, 0.0000e+00, 4.0594e+00, 3.2727e+00, 3.9824e+05, 3.3936e+00,
         3.8976e+00, 3.7724e+05, 3.6618e+00, 3.9908e+05, 3.6756e+00, 3.7490e+00,
         3.9083e+05, 3.9446e+05, 3.8193e+05, 3.4014e+00, 3.8386e+05, 3.6374e+00],
        [3.9205e+05, 4.0594e+00, 0.0000e+00, 3.6695e+00, 3.9820e+05, 3.7752e+00,
         3.7943e+00, 3.7718e+05, 3.7617e+00, 3.9913e+05, 3.6730e+00, 3.3238e+00,
         3.9085e+05, 3.9443e+05, 3.8194e+05, 3.5275e+00, 3.8386e+05, 3.6421e+00],
        [3.9209e+05, 3.2727e+00, 3.6695e+00, 0.0000e+00, 3.9825e+05, 3.5201e+00,
         3.7828e+00, 3.7724e+05, 3.3416e+00, 3.9908e+05, 3.5443e+00, 3.4399e+00,
         3.9080e+05, 3.9444e+05, 3.8200e+05, 3.5153e+00, 3.8387e+05, 3.3634e+00],
        [8.0384e+05, 3.9824e+05, 3.9820e+05, 3.9825e+05, 0.0000e+00, 3.9822e+05,
         3.9826e+05, 7.7485e+05, 3.9827e+05, 8.0978e+05, 3.9825e+05, 3.9824e+05,
         7.8969e+05, 7.9749e+05, 7.9165e+05, 3.9824e+05, 7.9227e+05, 3.9819e+05],
        [3.9205e+05, 3.3936e+00, 3.7752e+00, 3.5201e+00, 3.9822e+05, 0.0000e+00,
         4.0217e+00, 3.7719e+05, 3.5463e+00, 3.9910e+05, 3.6937e+00, 3.3244e+00,
         3.9088e+05, 3.9439e+05, 3.8193e+05, 3.3636e+00, 3.8383e+05, 3.7524e+00],
        [3.9204e+05, 3.8976e+00, 3.7943e+00, 3.7828e+00, 3.9826e+05, 4.0217e+00,
         0.0000e+00, 3.7722e+05, 3.8122e+00, 3.9908e+05, 3.6443e+00, 3.7689e+00,
         3.9087e+05, 3.9441e+05, 3.8192e+05, 3.5169e+00, 3.8388e+05, 3.6289e+00],
        [7.4621e+05, 3.7724e+05, 3.7718e+05, 3.7724e+05, 7.7485e+05, 3.7719e+05,
         3.7722e+05, 0.0000e+00, 3.7720e+05, 7.8189e+05, 3.7723e+05, 3.7720e+05,
         7.8502e+05, 7.9662e+05, 7.2991e+05, 3.7721e+05, 7.5920e+05, 3.7717e+05],
        [3.9203e+05, 3.6618e+00, 3.7617e+00, 3.3416e+00, 3.9827e+05, 3.5463e+00,
         3.8122e+00, 3.7720e+05, 0.0000e+00, 3.9906e+05, 3.5913e+00, 3.1870e+00,
         3.9085e+05, 3.9443e+05, 3.8197e+05, 3.3527e+00, 3.8388e+05, 3.5033e+00],
        [8.0970e+05, 3.9908e+05, 3.9913e+05, 3.9908e+05, 8.0978e+05, 3.9910e+05,
         3.9908e+05, 7.8189e+05, 3.9906e+05, 0.0000e+00, 3.9910e+05, 3.9909e+05,
         7.9222e+05, 7.8864e+05, 7.7177e+05, 3.9909e+05, 7.6183e+05, 3.9907e+05],
        [3.9204e+05, 3.6756e+00, 3.6730e+00, 3.5443e+00, 3.9825e+05, 3.6937e+00,
         3.6443e+00, 3.7723e+05, 3.5913e+00, 3.9910e+05, 0.0000e+00, 3.4857e+00,
         3.9080e+05, 3.9445e+05, 3.8199e+05, 3.3402e+00, 3.8389e+05, 3.6140e+00],
        [3.9207e+05, 3.7490e+00, 3.3238e+00, 3.4399e+00, 3.9824e+05, 3.3244e+00,
         3.7689e+00, 3.7720e+05, 3.1870e+00, 3.9909e+05, 3.4857e+00, 0.0000e+00,
         3.9082e+05, 3.9441e+05, 3.8194e+05, 3.4649e+00, 3.8385e+05, 3.2828e+00],
        [7.6837e+05, 3.9083e+05, 3.9085e+05, 3.9080e+05, 7.8969e+05, 3.9088e+05,
         3.9087e+05, 7.8502e+05, 3.9085e+05, 7.9222e+05, 3.9080e+05, 3.9082e+05,
         0.0000e+00, 7.6494e+05, 7.8659e+05, 3.9085e+05, 7.8278e+05, 3.9083e+05],
        [7.7623e+05, 3.9446e+05, 3.9443e+05, 3.9444e+05, 7.9749e+05, 3.9439e+05,
         3.9441e+05, 7.9662e+05, 3.9443e+05, 7.8864e+05, 3.9445e+05, 3.9441e+05,
         7.6494e+05, 0.0000e+00, 7.6866e+05, 3.9440e+05, 7.9817e+05, 3.9440e+05],
        [7.7430e+05, 3.8193e+05, 3.8194e+05, 3.8200e+05, 7.9165e+05, 3.8193e+05,
         3.8192e+05, 7.2991e+05, 3.8197e+05, 7.7177e+05, 3.8199e+05, 3.8194e+05,
         7.8659e+05, 7.6866e+05, 0.0000e+00, 3.8199e+05, 7.7655e+05, 3.8194e+05],
        [3.9206e+05, 3.4014e+00, 3.5275e+00, 3.5153e+00, 3.9824e+05, 3.3636e+00,
         3.5169e+00, 3.7721e+05, 3.3527e+00, 3.9909e+05, 3.3402e+00, 3.4649e+00,
         3.9085e+05, 3.9440e+05, 3.8199e+05, 0.0000e+00, 3.8389e+05, 3.4854e+00],
        [7.8108e+05, 3.8386e+05, 3.8386e+05, 3.8387e+05, 7.9227e+05, 3.8383e+05,
         3.8388e+05, 7.5920e+05, 3.8388e+05, 7.6183e+05, 3.8389e+05, 3.8385e+05,
         7.8278e+05, 7.9817e+05, 7.7655e+05, 3.8389e+05, 0.0000e+00, 3.8383e+05],
        [3.9208e+05, 3.6374e+00, 3.6421e+00, 3.3634e+00, 3.9819e+05, 3.7524e+00,
         3.6289e+00, 3.7717e+05, 3.5033e+00, 3.9907e+05, 3.6140e+00, 3.2828e+00,
         3.9083e+05, 3.9440e+05, 3.8194e+05, 3.4854e+00, 3.8383e+05, 0.0000e+00]])
Krum scores: ['392045.44', '3.59', '3.65', '3.46', '398229.38', '3.55', '3.73', '377200.69', '3.49', '399083.34', '3.57', '3.41', '390829.25', '394415.38', '381945.94', '3.43', '383858.19', '3.52']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [19, 7, 11, 12, 18, 4, 8, 17, 3, 14, 1, 6, 13, 20, 16, 10, 15, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0039s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:26...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 75 162]
 [ 99 164]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:26, End: 2025-07-22 15:47:26)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [8, 2, 16, 10, 1, 3, 7, 14, 13, 4, 18, 9, 19, 12, 5, 11], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.5560e+00, 3.9553e+05, 3.4908e+00, 3.6215e+00, 3.8410e+00,
         3.9078e+00, 4.1140e+05, 3.9747e+05, 3.9425e+00, 3.7639e+05, 3.8382e+00,
         3.8401e+05, 3.6626e+00, 3.5418e+00, 3.8493e+00],
        [3.5560e+00, 0.0000e+00, 3.9554e+05, 3.3223e+00, 3.3443e+00, 3.4652e+00,
         3.5527e+00, 4.1135e+05, 3.9752e+05, 3.7251e+00, 3.7640e+05, 3.3952e+00,
         3.8400e+05, 3.4723e+00, 3.4740e+00, 3.6905e+00],
        [3.9553e+05, 3.9554e+05, 0.0000e+00, 3.9552e+05, 3.9557e+05, 3.9557e+05,
         3.9552e+05, 8.0427e+05, 8.0432e+05, 3.9558e+05, 7.6822e+05, 3.9553e+05,
         7.9270e+05, 3.9556e+05, 3.9558e+05, 3.9556e+05],
        [3.4908e+00, 3.3223e+00, 3.9552e+05, 0.0000e+00, 3.3532e+00, 3.4268e+00,
         3.4365e+00, 4.1138e+05, 3.9748e+05, 3.4299e+00, 3.7645e+05, 3.9052e+00,
         3.8400e+05, 3.4658e+00, 3.4200e+00, 3.6183e+00],
        [3.6215e+00, 3.3443e+00, 3.9557e+05, 3.3532e+00, 0.0000e+00, 3.7166e+00,
         3.7686e+00, 4.1135e+05, 3.9745e+05, 3.8420e+00, 3.7640e+05, 3.4066e+00,
         3.8397e+05, 3.5146e+00, 3.5641e+00, 3.7527e+00],
        [3.8410e+00, 3.4652e+00, 3.9557e+05, 3.4268e+00, 3.7166e+00, 0.0000e+00,
         3.8741e+00, 4.1135e+05, 3.9751e+05, 3.7739e+00, 3.7641e+05, 3.7767e+00,
         3.8394e+05, 3.3973e+00, 3.6173e+00, 3.9923e+00],
        [3.9078e+00, 3.5527e+00, 3.9552e+05, 3.4365e+00, 3.7686e+00, 3.8741e+00,
         0.0000e+00, 4.1136e+05, 3.9748e+05, 3.4471e+00, 3.7642e+05, 3.9918e+00,
         3.8398e+05, 3.3136e+00, 3.5894e+00, 4.1430e+00],
        [4.1140e+05, 4.1135e+05, 8.0427e+05, 4.1138e+05, 4.1135e+05, 4.1135e+05,
         4.1136e+05, 0.0000e+00, 8.2213e+05, 4.1136e+05, 7.6567e+05, 4.1141e+05,
         7.8596e+05, 4.1135e+05, 4.1134e+05, 4.1134e+05],
        [3.9747e+05, 3.9752e+05, 8.0432e+05, 3.9748e+05, 3.9745e+05, 3.9751e+05,
         3.9748e+05, 8.2213e+05, 0.0000e+00, 3.9749e+05, 7.7250e+05, 3.9748e+05,
         7.9113e+05, 3.9750e+05, 3.9748e+05, 3.9746e+05],
        [3.9425e+00, 3.7251e+00, 3.9558e+05, 3.4299e+00, 3.8420e+00, 3.7739e+00,
         3.4471e+00, 4.1136e+05, 3.9749e+05, 0.0000e+00, 3.7638e+05, 3.9551e+00,
         3.8400e+05, 3.5329e+00, 3.7244e+00, 3.8221e+00],
        [3.7639e+05, 3.7640e+05, 7.6822e+05, 3.7645e+05, 3.7640e+05, 3.7641e+05,
         3.7642e+05, 7.6567e+05, 7.7250e+05, 3.7638e+05, 0.0000e+00, 3.7644e+05,
         7.4815e+05, 3.7642e+05, 3.7641e+05, 3.7644e+05],
        [3.8382e+00, 3.3952e+00, 3.9553e+05, 3.9052e+00, 3.4066e+00, 3.7767e+00,
         3.9918e+00, 4.1141e+05, 3.9748e+05, 3.9551e+00, 3.7644e+05, 0.0000e+00,
         3.8399e+05, 3.7323e+00, 3.7642e+00, 3.8365e+00],
        [3.8401e+05, 3.8400e+05, 7.9270e+05, 3.8400e+05, 3.8397e+05, 3.8394e+05,
         3.8398e+05, 7.8596e+05, 7.9113e+05, 3.8400e+05, 7.4815e+05, 3.8399e+05,
         0.0000e+00, 3.8394e+05, 3.8398e+05, 3.8395e+05],
        [3.6626e+00, 3.4723e+00, 3.9556e+05, 3.4658e+00, 3.5146e+00, 3.3973e+00,
         3.3136e+00, 4.1135e+05, 3.9750e+05, 3.5329e+00, 3.7642e+05, 3.7323e+00,
         3.8394e+05, 0.0000e+00, 3.2627e+00, 3.7182e+00],
        [3.5418e+00, 3.4740e+00, 3.9558e+05, 3.4200e+00, 3.5641e+00, 3.6173e+00,
         3.5894e+00, 4.1134e+05, 3.9748e+05, 3.7244e+00, 3.7641e+05, 3.7642e+00,
         3.8398e+05, 3.2627e+00, 0.0000e+00, 3.6547e+00],
        [3.8493e+00, 3.6905e+00, 3.9556e+05, 3.6183e+00, 3.7527e+00, 3.9923e+00,
         4.1430e+00, 4.1134e+05, 3.9746e+05, 3.8221e+00, 3.7644e+05, 3.8365e+00,
         3.8395e+05, 3.7182e+00, 3.6547e+00, 0.0000e+00]])
Krum scores: ['3.70', '3.47', '395543.06', '3.44', '3.56', '3.65', '3.65', '411354.50', '397476.03', '3.69', '376409.09', '3.73', '383972.34', '3.48', '3.54', '3.77']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 2, 16, 10, 1, 3, 7, 14, 13, 4, 18, 9, 19, 12, 5, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:26...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 81 156]
 [100 163]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:26, End: 2025-07-22 15:47:26)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [9, 5, 12, 7, 6, 8, 14, 10, 4, 19, 15, 17, 11, 2], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.7320e+00, 3.7087e+00, 3.9365e+00, 3.9830e+00, 3.8404e+00,
         3.9011e+05, 3.8517e+00, 3.9268e+00, 4.0337e+05, 3.7848e+05, 3.9387e+05,
         3.7559e+00, 3.4631e+00],
        [3.7320e+00, 0.0000e+00, 3.2336e+00, 3.6307e+00, 3.4394e+00, 3.5560e+00,
         3.9007e+05, 3.3930e+00, 3.7654e+00, 4.0340e+05, 3.7843e+05, 3.9390e+05,
         3.6818e+00, 3.5140e+00],
        [3.7087e+00, 3.2336e+00, 0.0000e+00, 3.3862e+00, 3.4927e+00, 3.6874e+00,
         3.9010e+05, 3.4643e+00, 3.5750e+00, 4.0335e+05, 3.7845e+05, 3.9394e+05,
         3.6425e+00, 3.5865e+00],
        [3.9365e+00, 3.6307e+00, 3.3862e+00, 0.0000e+00, 3.8325e+00, 3.8979e+00,
         3.9010e+05, 3.4402e+00, 3.5567e+00, 4.0338e+05, 3.7842e+05, 3.9394e+05,
         4.1442e+00, 3.6462e+00],
        [3.9830e+00, 3.4394e+00, 3.4927e+00, 3.8325e+00, 0.0000e+00, 3.7400e+00,
         3.9011e+05, 3.5477e+00, 3.5771e+00, 4.0339e+05, 3.7843e+05, 3.9390e+05,
         3.4629e+00, 3.4512e+00],
        [3.8404e+00, 3.5560e+00, 3.6874e+00, 3.8979e+00, 3.7400e+00, 0.0000e+00,
         3.9011e+05, 3.5379e+00, 4.0620e+00, 4.0338e+05, 3.7843e+05, 3.9394e+05,
         3.9172e+00, 3.5901e+00],
        [3.9011e+05, 3.9007e+05, 3.9010e+05, 3.9010e+05, 3.9011e+05, 3.9011e+05,
         0.0000e+00, 3.9010e+05, 3.9008e+05, 7.9208e+05, 7.6399e+05, 7.8421e+05,
         3.9003e+05, 3.9006e+05],
        [3.8517e+00, 3.3930e+00, 3.4643e+00, 3.4402e+00, 3.5477e+00, 3.5379e+00,
         3.9010e+05, 0.0000e+00, 3.4023e+00, 4.0338e+05, 3.7846e+05, 3.9388e+05,
         3.6227e+00, 3.3665e+00],
        [3.9268e+00, 3.7654e+00, 3.5750e+00, 3.5567e+00, 3.5771e+00, 4.0620e+00,
         3.9008e+05, 3.4023e+00, 0.0000e+00, 4.0334e+05, 3.7850e+05, 3.9390e+05,
         3.9276e+00, 3.9691e+00],
        [4.0337e+05, 4.0340e+05, 4.0335e+05, 4.0338e+05, 4.0339e+05, 4.0338e+05,
         7.9208e+05, 4.0338e+05, 4.0334e+05, 0.0000e+00, 7.5720e+05, 7.9118e+05,
         4.0336e+05, 4.0334e+05],
        [3.7848e+05, 3.7843e+05, 3.7845e+05, 3.7842e+05, 3.7843e+05, 3.7843e+05,
         7.6399e+05, 3.7846e+05, 3.7850e+05, 7.5720e+05, 0.0000e+00, 7.9119e+05,
         3.7846e+05, 3.7842e+05],
        [3.9387e+05, 3.9390e+05, 3.9394e+05, 3.9394e+05, 3.9390e+05, 3.9394e+05,
         7.8421e+05, 3.9388e+05, 3.9390e+05, 7.9118e+05, 7.9119e+05, 0.0000e+00,
         3.9387e+05, 3.9390e+05],
        [3.7559e+00, 3.6818e+00, 3.6425e+00, 4.1442e+00, 3.4629e+00, 3.9172e+00,
         3.9003e+05, 3.6227e+00, 3.9276e+00, 4.0336e+05, 3.7846e+05, 3.9387e+05,
         0.0000e+00, 3.7774e+00],
        [3.4631e+00, 3.5140e+00, 3.5865e+00, 3.6462e+00, 3.4512e+00, 3.5901e+00,
         3.9006e+05, 3.3665e+00, 3.9691e+00, 4.0334e+05, 3.7842e+05, 3.9390e+05,
         3.7774e+00, 0.0000e+00]])
Krum scores: ['3.78', '3.52', '3.51', '3.67', '3.57', '3.72', '390081.94', '3.47', '3.71', '403362.75', '378437.03', '393894.34', '3.72', '3.55']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [9, 5, 12, 7, 6, 8, 14, 10, 4, 19, 15, 17, 11, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:27...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 83 154]
 [102 161]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:27, End: 2025-07-22 15:47:27)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [19], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
tensor([[0.]])
Krum scores: ['nan']
Selected index: 0
krum, clients_type: [['Chosen Update']], selected_client_indices: [19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0006s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:27...
global Accuracy on shared test data: 50.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 25 212]
 [ 35 228]]
Function 'evaluate_global_model' executed in 0.0019 seconds (Start: 2025-07-22 15:47:27, End: 2025-07-22 15:47:27)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [1, 2, 8, 11, 19, 16, 9, 12, 3, 17, 20, 7, 15, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 2.9710e+00, 3.6398e+00, 3.2159e+00, 4.0550e+05, 3.9817e+05,
         3.3465e+00, 3.4536e+00, 2.9578e+00, 4.0627e+05, 3.9930e+05, 3.2823e+00,
         4.0468e+05, 2.9891e+00],
        [2.9710e+00, 0.0000e+00, 3.3350e+00, 3.1744e+00, 4.0549e+05, 3.9820e+05,
         3.2681e+00, 3.2420e+00, 3.1360e+00, 4.0629e+05, 3.9931e+05, 3.3281e+00,
         4.0470e+05, 3.2426e+00],
        [3.6398e+00, 3.3350e+00, 0.0000e+00, 3.5699e+00, 4.0550e+05, 3.9821e+05,
         3.5188e+00, 3.5559e+00, 3.3204e+00, 4.0626e+05, 3.9931e+05, 3.8690e+00,
         4.0471e+05, 3.5819e+00],
        [3.2159e+00, 3.1744e+00, 3.5699e+00, 0.0000e+00, 4.0548e+05, 3.9815e+05,
         3.0996e+00, 3.2909e+00, 3.2634e+00, 4.0631e+05, 3.9928e+05, 3.2656e+00,
         4.0473e+05, 3.1391e+00],
        [4.0550e+05, 4.0549e+05, 4.0550e+05, 4.0548e+05, 0.0000e+00, 8.0641e+05,
         4.0547e+05, 4.0550e+05, 4.0543e+05, 8.3395e+05, 8.0145e+05, 4.0539e+05,
         8.0081e+05, 4.0548e+05],
        [3.9817e+05, 3.9820e+05, 3.9821e+05, 3.9815e+05, 8.0641e+05, 0.0000e+00,
         3.9814e+05, 3.9817e+05, 3.9815e+05, 8.0192e+05, 8.0401e+05, 3.9817e+05,
         7.8698e+05, 3.9816e+05],
        [3.3465e+00, 3.2681e+00, 3.5188e+00, 3.0996e+00, 4.0547e+05, 3.9814e+05,
         0.0000e+00, 3.4556e+00, 3.1999e+00, 4.0628e+05, 3.9929e+05, 3.4069e+00,
         4.0479e+05, 3.2855e+00],
        [3.4536e+00, 3.2420e+00, 3.5559e+00, 3.2909e+00, 4.0550e+05, 3.9817e+05,
         3.4556e+00, 0.0000e+00, 3.3305e+00, 4.0626e+05, 3.9930e+05, 3.4626e+00,
         4.0473e+05, 3.2284e+00],
        [2.9578e+00, 3.1360e+00, 3.3204e+00, 3.2634e+00, 4.0543e+05, 3.9815e+05,
         3.1999e+00, 3.3305e+00, 0.0000e+00, 4.0624e+05, 3.9925e+05, 3.2747e+00,
         4.0474e+05, 2.9447e+00],
        [4.0627e+05, 4.0629e+05, 4.0626e+05, 4.0631e+05, 8.3395e+05, 8.0192e+05,
         4.0628e+05, 4.0626e+05, 4.0624e+05, 0.0000e+00, 8.1376e+05, 4.0628e+05,
         8.0438e+05, 4.0629e+05],
        [3.9930e+05, 3.9931e+05, 3.9931e+05, 3.9928e+05, 8.0145e+05, 8.0401e+05,
         3.9929e+05, 3.9930e+05, 3.9925e+05, 8.1376e+05, 0.0000e+00, 3.9929e+05,
         8.0158e+05, 3.9931e+05],
        [3.2823e+00, 3.3281e+00, 3.8690e+00, 3.2656e+00, 4.0539e+05, 3.9817e+05,
         3.4069e+00, 3.4626e+00, 3.2747e+00, 4.0628e+05, 3.9929e+05, 0.0000e+00,
         4.0475e+05, 3.3740e+00],
        [4.0468e+05, 4.0470e+05, 4.0471e+05, 4.0473e+05, 8.0081e+05, 7.8698e+05,
         4.0479e+05, 4.0473e+05, 4.0474e+05, 8.0438e+05, 8.0158e+05, 4.0475e+05,
         0.0000e+00, 4.0473e+05],
        [2.9891e+00, 3.2426e+00, 3.5819e+00, 3.1391e+00, 4.0548e+05, 3.9816e+05,
         3.2855e+00, 3.2284e+00, 2.9447e+00, 4.0629e+05, 3.9931e+05, 3.3740e+00,
         4.0473e+05, 0.0000e+00]])
Krum scores: ['3.17', '3.19', '3.50', '3.21', '405462.94', '398158.72', '3.29', '3.35', '3.16', '406269.09', '399288.41', '3.34', '404717.59', '3.17']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [1, 2, 8, 11, 19, 16, 9, 12, 3, 17, 20, 7, 15, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:28...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 26 211]
 [ 37 226]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:28, End: 2025-07-22 15:47:28)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 20, 17, 4, 6, 15, 3, 10, 11, 2, 18, 7, 5, 1, 8, 12, 13, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 7.8164e+05, 7.7502e+05, 4.0228e+05, 4.0231e+05, 7.7196e+05,
         4.0227e+05, 4.0224e+05, 4.0226e+05, 4.0227e+05, 7.9929e+05, 4.0226e+05,
         4.0225e+05, 4.0226e+05, 4.0229e+05, 4.0225e+05, 8.0528e+05, 4.0227e+05],
        [7.8164e+05, 0.0000e+00, 7.5431e+05, 3.8125e+05, 3.8122e+05, 7.7964e+05,
         3.8124e+05, 3.8125e+05, 3.8119e+05, 3.8121e+05, 7.6401e+05, 3.8119e+05,
         3.8119e+05, 3.8124e+05, 3.8123e+05, 3.8126e+05, 7.8277e+05, 3.8122e+05],
        [7.7502e+05, 7.5431e+05, 0.0000e+00, 3.8051e+05, 3.8043e+05, 7.8008e+05,
         3.8047e+05, 3.8048e+05, 3.8052e+05, 3.8045e+05, 7.5652e+05, 3.8049e+05,
         3.8048e+05, 3.8051e+05, 3.8048e+05, 3.8047e+05, 7.7212e+05, 3.8051e+05],
        [4.0228e+05, 3.8125e+05, 3.8051e+05, 0.0000e+00, 3.2143e+00, 3.9050e+05,
         3.2254e+00, 3.2573e+00, 3.1959e+00, 3.0943e+00, 3.8812e+05, 3.3212e+00,
         3.3029e+00, 3.2097e+00, 3.7476e+00, 3.5792e+00, 3.9255e+05, 3.4315e+00],
        [4.0231e+05, 3.8122e+05, 3.8043e+05, 3.2143e+00, 0.0000e+00, 3.9049e+05,
         3.0259e+00, 3.2941e+00, 3.1650e+00, 3.2162e+00, 3.8817e+05, 3.3444e+00,
         3.2563e+00, 2.9510e+00, 3.5785e+00, 3.1311e+00, 3.9256e+05, 3.1862e+00],
        [7.7196e+05, 7.7964e+05, 7.8008e+05, 3.9050e+05, 3.9049e+05, 0.0000e+00,
         3.9051e+05, 3.9048e+05, 3.9050e+05, 3.9050e+05, 7.9082e+05, 3.9052e+05,
         3.9052e+05, 3.9052e+05, 3.9048e+05, 3.9049e+05, 7.8595e+05, 3.9054e+05],
        [4.0227e+05, 3.8124e+05, 3.8047e+05, 3.2254e+00, 3.0259e+00, 3.9051e+05,
         0.0000e+00, 3.5468e+00, 3.3793e+00, 3.2216e+00, 3.8814e+05, 3.3907e+00,
         3.1329e+00, 3.0442e+00, 3.4940e+00, 3.3779e+00, 3.9257e+05, 3.1277e+00],
        [4.0224e+05, 3.8125e+05, 3.8048e+05, 3.2573e+00, 3.2941e+00, 3.9048e+05,
         3.5468e+00, 0.0000e+00, 3.3556e+00, 3.2144e+00, 3.8811e+05, 3.3492e+00,
         3.4476e+00, 3.3632e+00, 3.4839e+00, 3.5138e+00, 3.9253e+05, 3.3209e+00],
        [4.0226e+05, 3.8119e+05, 3.8052e+05, 3.1959e+00, 3.1650e+00, 3.9050e+05,
         3.3793e+00, 3.3556e+00, 0.0000e+00, 3.2173e+00, 3.8812e+05, 3.2592e+00,
         3.3441e+00, 3.2879e+00, 3.7041e+00, 3.2674e+00, 3.9250e+05, 3.1275e+00],
        [4.0227e+05, 3.8121e+05, 3.8045e+05, 3.0943e+00, 3.2162e+00, 3.9050e+05,
         3.2216e+00, 3.2144e+00, 3.2173e+00, 0.0000e+00, 3.8815e+05, 3.3195e+00,
         3.0702e+00, 2.9605e+00, 3.4712e+00, 3.2505e+00, 3.9252e+05, 3.2658e+00],
        [7.9929e+05, 7.6401e+05, 7.5652e+05, 3.8812e+05, 3.8817e+05, 7.9082e+05,
         3.8814e+05, 3.8811e+05, 3.8812e+05, 3.8815e+05, 0.0000e+00, 3.8815e+05,
         3.8816e+05, 3.8811e+05, 3.8812e+05, 3.8812e+05, 8.0223e+05, 3.8812e+05],
        [4.0226e+05, 3.8119e+05, 3.8049e+05, 3.3212e+00, 3.3444e+00, 3.9052e+05,
         3.3907e+00, 3.3492e+00, 3.2592e+00, 3.3195e+00, 3.8815e+05, 0.0000e+00,
         3.1872e+00, 3.2214e+00, 3.8674e+00, 3.4422e+00, 3.9252e+05, 3.3522e+00],
        [4.0225e+05, 3.8119e+05, 3.8048e+05, 3.3029e+00, 3.2563e+00, 3.9052e+05,
         3.1329e+00, 3.4476e+00, 3.3441e+00, 3.0702e+00, 3.8816e+05, 3.1872e+00,
         0.0000e+00, 3.3688e+00, 3.5871e+00, 3.3514e+00, 3.9251e+05, 3.2093e+00],
        [4.0226e+05, 3.8124e+05, 3.8051e+05, 3.2097e+00, 2.9510e+00, 3.9052e+05,
         3.0442e+00, 3.3632e+00, 3.2879e+00, 2.9605e+00, 3.8811e+05, 3.2214e+00,
         3.3688e+00, 0.0000e+00, 3.7287e+00, 3.4608e+00, 3.9254e+05, 3.3083e+00],
        [4.0229e+05, 3.8123e+05, 3.8048e+05, 3.7476e+00, 3.5785e+00, 3.9048e+05,
         3.4940e+00, 3.4839e+00, 3.7041e+00, 3.4712e+00, 3.8812e+05, 3.8674e+00,
         3.5871e+00, 3.7287e+00, 0.0000e+00, 3.5618e+00, 3.9257e+05, 3.4659e+00],
        [4.0225e+05, 3.8126e+05, 3.8047e+05, 3.5792e+00, 3.1311e+00, 3.9049e+05,
         3.3779e+00, 3.5138e+00, 3.2674e+00, 3.2505e+00, 3.8812e+05, 3.4422e+00,
         3.3514e+00, 3.4608e+00, 3.5618e+00, 0.0000e+00, 3.9255e+05, 3.3927e+00],
        [8.0528e+05, 7.8277e+05, 7.7212e+05, 3.9255e+05, 3.9256e+05, 7.8595e+05,
         3.9257e+05, 3.9253e+05, 3.9250e+05, 3.9252e+05, 8.0223e+05, 3.9252e+05,
         3.9251e+05, 3.9254e+05, 3.9257e+05, 3.9255e+05, 0.0000e+00, 3.9257e+05],
        [4.0227e+05, 3.8122e+05, 3.8051e+05, 3.4315e+00, 3.1862e+00, 3.9054e+05,
         3.1277e+00, 3.3209e+00, 3.1275e+00, 3.2658e+00, 3.8812e+05, 3.3522e+00,
         3.2093e+00, 3.3083e+00, 3.4659e+00, 3.3927e+00, 3.9257e+05, 0.0000e+00]])
Krum scores: ['402262.44', '381218.31', '380477.84', '3.28', '3.18', '390498.75', '3.24', '3.36', '3.26', '3.18', '388125.81', '3.32', '3.27', '3.22', '3.58', '3.37', '392536.84', '3.27']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 20, 17, 4, 6, 15, 3, 10, 11, 2, 18, 7, 5, 1, 8, 12, 13, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:28...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 29 208]
 [ 42 221]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:28, End: 2025-07-22 15:47:28)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [6, 16, 9, 20, 12, 5, 8, 11, 15, 14, 17, 13, 4, 7, 3, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9625e+05, 3.3178e+00, 3.9691e+05, 3.1742e+00, 3.2483e+00,
         3.6353e+00, 3.1370e+00, 3.9544e+05, 3.8001e+05, 3.8500e+05, 3.8630e+05,
         3.2050e+00, 3.4498e+00, 3.0303e+00, 4.0212e+05],
        [3.9625e+05, 0.0000e+00, 3.9618e+05, 8.0485e+05, 3.9620e+05, 3.9626e+05,
         3.9623e+05, 3.9626e+05, 7.8627e+05, 7.7843e+05, 7.8022e+05, 7.7391e+05,
         3.9623e+05, 3.9624e+05, 3.9621e+05, 7.7793e+05],
        [3.3178e+00, 3.9618e+05, 0.0000e+00, 3.9696e+05, 3.4815e+00, 3.2010e+00,
         3.6142e+00, 3.2246e+00, 3.9547e+05, 3.7998e+05, 3.8499e+05, 3.8631e+05,
         3.4379e+00, 3.4676e+00, 3.1206e+00, 4.0212e+05],
        [3.9691e+05, 8.0485e+05, 3.9696e+05, 0.0000e+00, 3.9690e+05, 3.9691e+05,
         3.9689e+05, 3.9697e+05, 8.0406e+05, 7.8535e+05, 7.8436e+05, 7.9223e+05,
         3.9696e+05, 3.9691e+05, 3.9696e+05, 7.8481e+05],
        [3.1742e+00, 3.9620e+05, 3.4815e+00, 3.9690e+05, 0.0000e+00, 3.3542e+00,
         3.5734e+00, 3.2776e+00, 3.9551e+05, 3.8006e+05, 3.8502e+05, 3.8630e+05,
         3.5639e+00, 3.5258e+00, 3.3882e+00, 4.0214e+05],
        [3.2483e+00, 3.9626e+05, 3.2010e+00, 3.9691e+05, 3.3542e+00, 0.0000e+00,
         3.7099e+00, 3.3739e+00, 3.9548e+05, 3.7999e+05, 3.8498e+05, 3.8630e+05,
         3.2531e+00, 3.2710e+00, 3.0642e+00, 4.0210e+05],
        [3.6353e+00, 3.9623e+05, 3.6142e+00, 3.9689e+05, 3.5734e+00, 3.7099e+00,
         0.0000e+00, 3.7164e+00, 3.9540e+05, 3.8006e+05, 3.8494e+05, 3.8630e+05,
         3.7888e+00, 3.9787e+00, 3.5155e+00, 4.0212e+05],
        [3.1370e+00, 3.9626e+05, 3.2246e+00, 3.9697e+05, 3.2776e+00, 3.3739e+00,
         3.7164e+00, 0.0000e+00, 3.9549e+05, 3.8000e+05, 3.8500e+05, 3.8630e+05,
         3.1115e+00, 3.3226e+00, 3.3219e+00, 4.0215e+05],
        [3.9544e+05, 7.8627e+05, 3.9547e+05, 8.0406e+05, 3.9551e+05, 3.9548e+05,
         3.9540e+05, 3.9549e+05, 0.0000e+00, 7.8217e+05, 7.7803e+05, 7.7683e+05,
         3.9549e+05, 3.9544e+05, 3.9550e+05, 7.8426e+05],
        [3.8001e+05, 7.7843e+05, 3.7998e+05, 7.8535e+05, 3.8006e+05, 3.7999e+05,
         3.8006e+05, 3.8000e+05, 7.8217e+05, 0.0000e+00, 7.6739e+05, 7.6119e+05,
         3.7999e+05, 3.7998e+05, 3.7997e+05, 7.6100e+05],
        [3.8500e+05, 7.8022e+05, 3.8499e+05, 7.8436e+05, 3.8502e+05, 3.8498e+05,
         3.8494e+05, 3.8500e+05, 7.7803e+05, 7.6739e+05, 0.0000e+00, 7.8600e+05,
         3.8499e+05, 3.8497e+05, 3.8498e+05, 7.8523e+05],
        [3.8630e+05, 7.7391e+05, 3.8631e+05, 7.9223e+05, 3.8630e+05, 3.8630e+05,
         3.8630e+05, 3.8630e+05, 7.7683e+05, 7.6119e+05, 7.8600e+05, 0.0000e+00,
         3.8633e+05, 3.8631e+05, 3.8631e+05, 8.0004e+05],
        [3.2050e+00, 3.9623e+05, 3.4379e+00, 3.9696e+05, 3.5639e+00, 3.2531e+00,
         3.7888e+00, 3.1115e+00, 3.9549e+05, 3.7999e+05, 3.8499e+05, 3.8633e+05,
         0.0000e+00, 3.3882e+00, 3.1121e+00, 4.0213e+05],
        [3.4498e+00, 3.9624e+05, 3.4676e+00, 3.9691e+05, 3.5258e+00, 3.2710e+00,
         3.9787e+00, 3.3226e+00, 3.9544e+05, 3.7998e+05, 3.8497e+05, 3.8631e+05,
         3.3882e+00, 0.0000e+00, 3.4553e+00, 4.0214e+05],
        [3.0303e+00, 3.9621e+05, 3.1206e+00, 3.9696e+05, 3.3882e+00, 3.0642e+00,
         3.5155e+00, 3.3219e+00, 3.9550e+05, 3.7997e+05, 3.8498e+05, 3.8631e+05,
         3.1121e+00, 3.4553e+00, 0.0000e+00, 4.0217e+05],
        [4.0212e+05, 7.7793e+05, 4.0212e+05, 7.8481e+05, 4.0214e+05, 4.0210e+05,
         4.0212e+05, 4.0215e+05, 7.8426e+05, 7.6100e+05, 7.8523e+05, 8.0004e+05,
         4.0213e+05, 4.0214e+05, 4.0217e+05, 0.0000e+00]])
Krum scores: ['3.22', '396221.56', '3.32', '396919.16', '3.40', '3.25', '3.65', '3.25', '395459.81', '379987.69', '384977.22', '386301.75', '3.30', '3.41', '3.21', '402125.28']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [6, 16, 9, 20, 12, 5, 8, 11, 15, 14, 17, 13, 4, 7, 3, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0033s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:29...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 33 204]
 [ 44 219]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:29, End: 2025-07-22 15:47:29)
start time is: 98217163669511, end time is: 98231151391209
The total time is: 13987721698ns.

 ------- aggregate method: krum, random_seed: 400 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [8, 15, 4, 19, 5, 17, 2, 6, 12, 9], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.8139e+05, 4.4409e+00, 3.9424e+05, 4.5389e+00, 3.9583e+05,
         4.7619e+00, 4.5639e+00, 4.9557e+00, 4.5951e+00],
        [3.8139e+05, 0.0000e+00, 3.8137e+05, 7.6411e+05, 3.8141e+05, 7.7525e+05,
         3.8137e+05, 3.8133e+05, 3.8133e+05, 3.8142e+05],
        [4.4409e+00, 3.8137e+05, 0.0000e+00, 3.9424e+05, 4.2080e+00, 3.9588e+05,
         4.5909e+00, 4.1380e+00, 4.5841e+00, 4.0409e+00],
        [3.9424e+05, 7.6411e+05, 3.9424e+05, 0.0000e+00, 3.9425e+05, 8.0759e+05,
         3.9427e+05, 3.9430e+05, 3.9425e+05, 3.9430e+05],
        [4.5389e+00, 3.8141e+05, 4.2080e+00, 3.9425e+05, 0.0000e+00, 3.9585e+05,
         4.2540e+00, 4.2262e+00, 4.1637e+00, 4.1776e+00],
        [3.9583e+05, 7.7525e+05, 3.9588e+05, 8.0759e+05, 3.9585e+05, 0.0000e+00,
         3.9582e+05, 3.9580e+05, 3.9580e+05, 3.9588e+05],
        [4.7619e+00, 3.8137e+05, 4.5909e+00, 3.9427e+05, 4.2540e+00, 3.9582e+05,
         0.0000e+00, 4.1395e+00, 4.7909e+00, 4.3349e+00],
        [4.5639e+00, 3.8133e+05, 4.1380e+00, 3.9430e+05, 4.2262e+00, 3.9580e+05,
         4.1395e+00, 0.0000e+00, 4.3151e+00, 4.1475e+00],
        [4.9557e+00, 3.8133e+05, 4.5841e+00, 3.9425e+05, 4.1637e+00, 3.9580e+05,
         4.7909e+00, 4.3151e+00, 0.0000e+00, 4.2778e+00],
        [4.5951e+00, 3.8142e+05, 4.0409e+00, 3.9430e+05, 4.1776e+00, 3.9588e+05,
         4.3349e+00, 4.1475e+00, 4.2778e+00, 0.0000e+00]])
Krum scores: ['4.58', '381358.69', '4.28', '394248.47', '4.21', '395821.41', '4.42', '4.19', '4.43', '4.20']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']], selected_client_indices: [8, 15, 4, 19, 5, 17, 2, 6, 12, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0021s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:29...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:29, End: 2025-07-22 15:47:29)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [5, 17, 18, 9, 20, 8, 16, 1, 7, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.8550e+05, 4.0034e+05, 1.9743e+00, 4.0161e+05, 2.2139e+00,
         3.9363e+05, 1.9918e+00, 2.0003e+00, 1.9905e+00],
        [3.8550e+05, 0.0000e+00, 7.9553e+05, 3.8555e+05, 8.0013e+05, 3.8554e+05,
         7.7361e+05, 3.8555e+05, 3.8554e+05, 3.8549e+05],
        [4.0034e+05, 7.9553e+05, 0.0000e+00, 4.0035e+05, 7.9967e+05, 4.0032e+05,
         7.9959e+05, 4.0031e+05, 4.0037e+05, 4.0033e+05],
        [1.9743e+00, 3.8555e+05, 4.0035e+05, 0.0000e+00, 4.0164e+05, 1.9420e+00,
         3.9363e+05, 1.7688e+00, 2.0394e+00, 1.9294e+00],
        [4.0161e+05, 8.0013e+05, 7.9967e+05, 4.0164e+05, 0.0000e+00, 4.0164e+05,
         7.7883e+05, 4.0163e+05, 4.0167e+05, 4.0161e+05],
        [2.2139e+00, 3.8554e+05, 4.0032e+05, 1.9420e+00, 4.0164e+05, 0.0000e+00,
         3.9358e+05, 2.0993e+00, 2.1737e+00, 2.2043e+00],
        [3.9363e+05, 7.7361e+05, 7.9959e+05, 3.9363e+05, 7.7883e+05, 3.9358e+05,
         0.0000e+00, 3.9368e+05, 3.9363e+05, 3.9367e+05],
        [1.9918e+00, 3.8555e+05, 4.0031e+05, 1.7688e+00, 4.0163e+05, 2.0993e+00,
         3.9368e+05, 0.0000e+00, 1.9258e+00, 2.0545e+00],
        [2.0003e+00, 3.8554e+05, 4.0037e+05, 2.0394e+00, 4.0167e+05, 2.1737e+00,
         3.9363e+05, 1.9258e+00, 0.0000e+00, 2.0649e+00],
        [1.9905e+00, 3.8549e+05, 4.0033e+05, 1.9294e+00, 4.0161e+05, 2.2043e+00,
         3.9367e+05, 2.0545e+00, 2.0649e+00, 0.0000e+00]])
Krum scores: ['1.99', '385516.59', '400323.41', '1.90', '401624.69', '2.10', '393617.88', '1.94', '2.01', '2.01']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [5, 17, 18, 9, 20, 8, 16, 1, 7, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0021s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:30...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 49 214]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:30, End: 2025-07-22 15:47:30)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [13, 10, 18, 12, 16, 20, 5, 3, 8, 1], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.9501e+05, 7.8473e+05, 3.9503e+05, 7.9362e+05, 7.8884e+05,
         3.9505e+05, 3.9504e+05, 3.9503e+05, 3.9504e+05],
        [3.9501e+05, 0.0000e+00, 4.0499e+05, 1.6565e+00, 3.8384e+05, 3.9103e+05,
         1.6528e+00, 1.6369e+00, 1.6836e+00, 1.7110e+00],
        [7.8473e+05, 4.0499e+05, 0.0000e+00, 4.0499e+05, 7.7671e+05, 8.0308e+05,
         4.0497e+05, 4.0498e+05, 4.0497e+05, 4.0500e+05],
        [3.9503e+05, 1.6565e+00, 4.0499e+05, 0.0000e+00, 3.8386e+05, 3.9103e+05,
         1.7921e+00, 1.6324e+00, 1.8099e+00, 1.8152e+00],
        [7.9362e+05, 3.8384e+05, 7.7671e+05, 3.8386e+05, 0.0000e+00, 7.7733e+05,
         3.8383e+05, 3.8385e+05, 3.8385e+05, 3.8385e+05],
        [7.8884e+05, 3.9103e+05, 8.0308e+05, 3.9103e+05, 7.7733e+05, 0.0000e+00,
         3.9101e+05, 3.9102e+05, 3.9102e+05, 3.9101e+05],
        [3.9505e+05, 1.6528e+00, 4.0497e+05, 1.7921e+00, 3.8383e+05, 3.9101e+05,
         0.0000e+00, 1.5881e+00, 1.9344e+00, 1.7891e+00],
        [3.9504e+05, 1.6369e+00, 4.0498e+05, 1.6324e+00, 3.8385e+05, 3.9102e+05,
         1.5881e+00, 0.0000e+00, 1.6877e+00, 1.8002e+00],
        [3.9503e+05, 1.6836e+00, 4.0497e+05, 1.8099e+00, 3.8385e+05, 3.9102e+05,
         1.9344e+00, 1.6877e+00, 0.0000e+00, 1.9966e+00],
        [3.9504e+05, 1.7110e+00, 4.0500e+05, 1.8152e+00, 3.8385e+05, 3.9101e+05,
         1.7891e+00, 1.8002e+00, 1.9966e+00, 0.0000e+00]])
Krum scores: ['395027.53', '1.66', '404975.44', '1.72', '383841.12', '391015.12', '1.71', '1.64', '1.78', '1.78']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']], selected_client_indices: [13, 10, 18, 12, 16, 20, 5, 3, 8, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0020s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:30...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:30, End: 2025-07-22 15:47:30)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [18, 12, 8], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[0.0000e+00, 4.0595e+05, 4.0592e+05],
        [4.0595e+05, 0.0000e+00, 1.7673e+00],
        [4.0592e+05, 1.7673e+00, 0.0000e+00]])
Krum scores: ['nan', 'nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']], selected_client_indices: [18, 12, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0010s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:30...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[213  24]
 [228  35]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:30, End: 2025-07-22 15:47:30)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [20], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
tensor([[0.]])
Krum scores: ['nan']
Selected index: 0
krum, clients_type: [['Chosen Update']], selected_client_indices: [20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:30...
global Accuracy on shared test data: 45.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [211  52]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:47:30, End: 2025-07-22 15:47:30)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [16, 10], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[     0.0000, 385754.8438],
        [385754.8438,      0.0000]])
Krum scores: ['nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [16, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0008s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:31...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[131 106]
 [140 123]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:31, End: 2025-07-22 15:47:31)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [8, 14, 4, 1, 12], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
tensor([[0.0000e+00, 3.7683e+05, 3.7502e+00, 4.1415e+00, 3.9370e+00],
        [3.7683e+05, 0.0000e+00, 3.7689e+05, 3.7688e+05, 3.7686e+05],
        [3.7502e+00, 3.7689e+05, 0.0000e+00, 3.9120e+00, 3.3355e+00],
        [4.1415e+00, 3.7688e+05, 3.9120e+00, 0.0000e+00, 3.7999e+00],
        [3.9370e+00, 3.7686e+05, 3.3355e+00, 3.7999e+00, 0.0000e+00]])
Krum scores: ['3.84', '376847.41', '3.54', '3.86', '3.57']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']], selected_client_indices: [8, 14, 4, 1, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0049s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:31...
global Accuracy on shared test data: 51.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[131 106]
 [139 124]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:31, End: 2025-07-22 15:47:31)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [19, 7, 10, 16, 18, 9, 11, 17, 14, 5, 8, 4, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.8477e+05, 3.8476e+05, 7.7825e+05, 7.7499e+05, 3.8476e+05,
         3.8480e+05, 7.5460e+05, 7.5997e+05, 3.8477e+05, 3.8479e+05, 3.8480e+05,
         7.8585e+05],
        [3.8477e+05, 0.0000e+00, 3.8759e+00, 3.8599e+05, 3.8971e+05, 3.8003e+00,
         3.4200e+00, 3.9510e+05, 3.7907e+05, 4.0344e+00, 3.8544e+00, 3.6600e+00,
         3.8732e+05],
        [3.8476e+05, 3.8759e+00, 0.0000e+00, 3.8599e+05, 3.8977e+05, 3.7155e+00,
         3.5478e+00, 3.9513e+05, 3.7909e+05, 3.7085e+00, 3.6279e+00, 3.5567e+00,
         3.8739e+05],
        [7.7825e+05, 3.8599e+05, 3.8599e+05, 0.0000e+00, 7.8049e+05, 3.8600e+05,
         3.8598e+05, 7.7477e+05, 7.7698e+05, 3.8598e+05, 3.8600e+05, 3.8599e+05,
         7.8147e+05],
        [7.7499e+05, 3.8971e+05, 3.8977e+05, 7.8049e+05, 0.0000e+00, 3.8980e+05,
         3.8977e+05, 7.8995e+05, 7.9371e+05, 3.8979e+05, 3.8977e+05, 3.8977e+05,
         7.7234e+05],
        [3.8476e+05, 3.8003e+00, 3.7155e+00, 3.8600e+05, 3.8980e+05, 0.0000e+00,
         3.4311e+00, 3.9514e+05, 3.7905e+05, 3.7828e+00, 3.8619e+00, 3.8335e+00,
         3.8737e+05],
        [3.8480e+05, 3.4200e+00, 3.5478e+00, 3.8598e+05, 3.8977e+05, 3.4311e+00,
         0.0000e+00, 3.9506e+05, 3.7904e+05, 3.7883e+00, 3.5642e+00, 3.5748e+00,
         3.8738e+05],
        [7.5460e+05, 3.9510e+05, 3.9513e+05, 7.7477e+05, 7.8995e+05, 3.9514e+05,
         3.9506e+05, 0.0000e+00, 7.5782e+05, 3.9507e+05, 3.9512e+05, 3.9514e+05,
         7.8195e+05],
        [7.5997e+05, 3.7907e+05, 3.7909e+05, 7.7698e+05, 7.9371e+05, 3.7905e+05,
         3.7904e+05, 7.5782e+05, 0.0000e+00, 3.7912e+05, 3.7905e+05, 3.7907e+05,
         7.5026e+05],
        [3.8477e+05, 4.0344e+00, 3.7085e+00, 3.8598e+05, 3.8979e+05, 3.7828e+00,
         3.7883e+00, 3.9507e+05, 3.7912e+05, 0.0000e+00, 4.1303e+00, 3.8537e+00,
         3.8735e+05],
        [3.8479e+05, 3.8544e+00, 3.6279e+00, 3.8600e+05, 3.8977e+05, 3.8619e+00,
         3.5642e+00, 3.9512e+05, 3.7905e+05, 4.1303e+00, 0.0000e+00, 3.7067e+00,
         3.8731e+05],
        [3.8480e+05, 3.6600e+00, 3.5567e+00, 3.8599e+05, 3.8977e+05, 3.8335e+00,
         3.5748e+00, 3.9514e+05, 3.7907e+05, 3.8537e+00, 3.7067e+00, 0.0000e+00,
         3.8737e+05],
        [7.8585e+05, 3.8732e+05, 3.8739e+05, 7.8147e+05, 7.7234e+05, 3.8737e+05,
         3.8738e+05, 7.8195e+05, 7.5026e+05, 3.8735e+05, 3.8731e+05, 3.8737e+05,
         0.0000e+00]])
Krum scores: ['384769.47', '3.72', '3.63', '385983.34', '389757.25', '3.71', '3.51', '395095.31', '379055.50', '3.83', '3.72', '3.67', '387345.72']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [19, 7, 10, 16, 18, 9, 11, 17, 14, 5, 8, 4, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0165s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:31...
global Accuracy on shared test data: 51.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[131 106]
 [137 126]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:31, End: 2025-07-22 15:47:31)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 1, 10, 15, 9, 19, 12, 7, 20, 11, 13, 16, 5, 8, 6, 17, 3, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 3.9850e+05, 3.9851e+05, 7.9208e+05, 3.9851e+05, 7.8177e+05,
         3.9851e+05, 3.9847e+05, 8.1302e+05, 3.9851e+05, 7.7937e+05, 7.7128e+05,
         3.9852e+05, 3.9853e+05, 3.9851e+05, 8.0101e+05, 3.9852e+05, 3.9851e+05],
        [3.9850e+05, 0.0000e+00, 3.6432e+00, 3.9463e+05, 3.4555e+00, 3.7735e+05,
         3.7940e+00, 3.7807e+00, 4.0093e+05, 3.5749e+00, 4.0315e+05, 3.8854e+05,
         3.7114e+00, 3.9820e+00, 3.6191e+00, 3.9628e+05, 3.8384e+00, 3.6932e+00],
        [3.9851e+05, 3.6432e+00, 0.0000e+00, 3.9471e+05, 3.7422e+00, 3.7734e+05,
         3.6041e+00, 3.8424e+00, 4.0092e+05, 3.6384e+00, 4.0319e+05, 3.8851e+05,
         3.7583e+00, 3.5919e+00, 3.7041e+00, 3.9630e+05, 3.7073e+00, 3.3545e+00],
        [7.9208e+05, 3.9463e+05, 3.9471e+05, 0.0000e+00, 3.9465e+05, 7.9377e+05,
         3.9463e+05, 3.9471e+05, 8.2080e+05, 3.9468e+05, 8.1807e+05, 7.7086e+05,
         3.9465e+05, 3.9469e+05, 3.9467e+05, 7.7468e+05, 3.9471e+05, 3.9463e+05],
        [3.9851e+05, 3.4555e+00, 3.7422e+00, 3.9465e+05, 0.0000e+00, 3.7735e+05,
         3.6431e+00, 3.7355e+00, 4.0094e+05, 3.4549e+00, 4.0321e+05, 3.8853e+05,
         3.7903e+00, 3.8251e+00, 3.8778e+00, 3.9631e+05, 3.6203e+00, 3.7563e+00],
        [7.8177e+05, 3.7735e+05, 3.7734e+05, 7.9377e+05, 3.7735e+05, 0.0000e+00,
         3.7734e+05, 3.7733e+05, 7.9220e+05, 3.7734e+05, 7.7195e+05, 7.7146e+05,
         3.7738e+05, 3.7733e+05, 3.7735e+05, 7.7806e+05, 3.7733e+05, 3.7733e+05],
        [3.9851e+05, 3.7940e+00, 3.6041e+00, 3.9463e+05, 3.6431e+00, 3.7734e+05,
         0.0000e+00, 3.9464e+00, 4.0092e+05, 3.5869e+00, 4.0317e+05, 3.8854e+05,
         3.5296e+00, 3.8516e+00, 4.0720e+00, 3.9631e+05, 3.8609e+00, 3.9356e+00],
        [3.9847e+05, 3.7807e+00, 3.8424e+00, 3.9471e+05, 3.7355e+00, 3.7733e+05,
         3.9464e+00, 0.0000e+00, 4.0088e+05, 3.4988e+00, 4.0315e+05, 3.8848e+05,
         4.0046e+00, 3.7681e+00, 3.8678e+00, 3.9631e+05, 3.7946e+00, 3.5567e+00],
        [8.1302e+05, 4.0093e+05, 4.0092e+05, 8.2080e+05, 4.0094e+05, 7.9220e+05,
         4.0092e+05, 4.0088e+05, 0.0000e+00, 4.0093e+05, 8.0083e+05, 7.9641e+05,
         4.0091e+05, 4.0090e+05, 4.0088e+05, 7.9687e+05, 4.0085e+05, 4.0093e+05],
        [3.9851e+05, 3.5749e+00, 3.6384e+00, 3.9468e+05, 3.4549e+00, 3.7734e+05,
         3.5869e+00, 3.4988e+00, 4.0093e+05, 0.0000e+00, 4.0324e+05, 3.8855e+05,
         3.9358e+00, 3.6298e+00, 3.9711e+00, 3.9632e+05, 3.5214e+00, 3.7677e+00],
        [7.7937e+05, 4.0315e+05, 4.0319e+05, 8.1807e+05, 4.0321e+05, 7.7195e+05,
         4.0317e+05, 4.0315e+05, 8.0083e+05, 4.0324e+05, 0.0000e+00, 7.7568e+05,
         4.0315e+05, 4.0319e+05, 4.0317e+05, 8.0434e+05, 4.0315e+05, 4.0310e+05],
        [7.7128e+05, 3.8854e+05, 3.8851e+05, 7.7086e+05, 3.8853e+05, 7.7146e+05,
         3.8854e+05, 3.8848e+05, 7.9641e+05, 3.8855e+05, 7.7568e+05, 0.0000e+00,
         3.8850e+05, 3.8853e+05, 3.8851e+05, 7.8598e+05, 3.8857e+05, 3.8853e+05],
        [3.9852e+05, 3.7114e+00, 3.7583e+00, 3.9465e+05, 3.7903e+00, 3.7738e+05,
         3.5296e+00, 4.0046e+00, 4.0091e+05, 3.9358e+00, 4.0315e+05, 3.8850e+05,
         0.0000e+00, 4.2942e+00, 4.1040e+00, 3.9632e+05, 3.9182e+00, 4.0605e+00],
        [3.9853e+05, 3.9820e+00, 3.5919e+00, 3.9469e+05, 3.8251e+00, 3.7733e+05,
         3.8516e+00, 3.7681e+00, 4.0090e+05, 3.6298e+00, 4.0319e+05, 3.8853e+05,
         4.2942e+00, 0.0000e+00, 3.8041e+00, 3.9630e+05, 3.7625e+00, 4.0247e+00],
        [3.9851e+05, 3.6191e+00, 3.7041e+00, 3.9467e+05, 3.8778e+00, 3.7735e+05,
         4.0720e+00, 3.8678e+00, 4.0088e+05, 3.9711e+00, 4.0317e+05, 3.8851e+05,
         4.1040e+00, 3.8041e+00, 0.0000e+00, 3.9634e+05, 4.0003e+00, 3.6663e+00],
        [8.0101e+05, 3.9628e+05, 3.9630e+05, 7.7468e+05, 3.9631e+05, 7.7806e+05,
         3.9631e+05, 3.9631e+05, 7.9687e+05, 3.9632e+05, 8.0434e+05, 7.8598e+05,
         3.9632e+05, 3.9630e+05, 3.9634e+05, 0.0000e+00, 3.9636e+05, 3.9633e+05],
        [3.9852e+05, 3.8384e+00, 3.7073e+00, 3.9471e+05, 3.6203e+00, 3.7733e+05,
         3.8609e+00, 3.7946e+00, 4.0085e+05, 3.5214e+00, 4.0315e+05, 3.8857e+05,
         3.9182e+00, 3.7625e+00, 4.0003e+00, 3.9636e+05, 0.0000e+00, 3.8349e+00],
        [3.9851e+05, 3.6932e+00, 3.3545e+00, 3.9463e+05, 3.7563e+00, 3.7733e+05,
         3.9356e+00, 3.5567e+00, 4.0093e+05, 3.7677e+00, 4.0310e+05, 3.8853e+05,
         4.0605e+00, 4.0247e+00, 3.6663e+00, 3.9633e+05, 3.8349e+00, 0.0000e+00]])
Krum scores: ['398505.84', '3.68', '3.64', '394661.22', '3.67', '377336.12', '3.75', '3.75', '400901.00', '3.62', '403158.19', '388519.12', '3.87', '3.80', '3.84', '396309.00', '3.76', '3.73']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 1, 10, 15, 9, 19, 12, 7, 20, 11, 13, 16, 5, 8, 6, 17, 3, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:32...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[130 107]
 [133 130]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:32, End: 2025-07-22 15:47:32)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [5, 14, 18, 11, 13, 7, 15, 4, 9, 1, 10, 17, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.8021e+05, 3.7291e+05, 3.7400e+00, 3.8855e+05, 3.9066e+00,
         3.8685e+05, 3.8620e+00, 3.7421e+00, 3.6682e+00, 3.6608e+00, 3.8036e+05,
         3.8947e+05],
        [3.8021e+05, 0.0000e+00, 7.5099e+05, 3.8023e+05, 7.8699e+05, 3.8024e+05,
         7.5769e+05, 3.8031e+05, 3.8025e+05, 3.8026e+05, 3.8023e+05, 7.4314e+05,
         7.7776e+05],
        [3.7291e+05, 7.5099e+05, 0.0000e+00, 3.7293e+05, 7.6114e+05, 3.7295e+05,
         7.6761e+05, 3.7291e+05, 3.7292e+05, 3.7291e+05, 3.7286e+05, 7.4309e+05,
         7.5633e+05],
        [3.7400e+00, 3.8023e+05, 3.7293e+05, 0.0000e+00, 3.8859e+05, 3.5497e+00,
         3.8687e+05, 3.4813e+00, 3.4298e+00, 3.5913e+00, 3.5792e+00, 3.8039e+05,
         3.8948e+05],
        [3.8855e+05, 7.8699e+05, 7.6114e+05, 3.8859e+05, 0.0000e+00, 3.8849e+05,
         7.7824e+05, 3.8851e+05, 3.8851e+05, 3.8854e+05, 3.8851e+05, 7.8512e+05,
         7.9586e+05],
        [3.9066e+00, 3.8024e+05, 3.7295e+05, 3.5497e+00, 3.8849e+05, 0.0000e+00,
         3.8680e+05, 3.5249e+00, 3.6945e+00, 3.8536e+00, 3.7954e+00, 3.8035e+05,
         3.8947e+05],
        [3.8685e+05, 7.5769e+05, 7.6761e+05, 3.8687e+05, 7.7824e+05, 3.8680e+05,
         0.0000e+00, 3.8684e+05, 3.8689e+05, 3.8679e+05, 3.8687e+05, 7.7001e+05,
         7.5724e+05],
        [3.8620e+00, 3.8031e+05, 3.7291e+05, 3.4813e+00, 3.8851e+05, 3.5249e+00,
         3.8684e+05, 0.0000e+00, 3.8624e+00, 3.8844e+00, 3.5555e+00, 3.8034e+05,
         3.8949e+05],
        [3.7421e+00, 3.8025e+05, 3.7292e+05, 3.4298e+00, 3.8851e+05, 3.6945e+00,
         3.8689e+05, 3.8624e+00, 0.0000e+00, 3.5068e+00, 3.6884e+00, 3.8036e+05,
         3.8948e+05],
        [3.6682e+00, 3.8026e+05, 3.7291e+05, 3.5913e+00, 3.8854e+05, 3.8536e+00,
         3.8679e+05, 3.8844e+00, 3.5068e+00, 0.0000e+00, 3.6931e+00, 3.8038e+05,
         3.8947e+05],
        [3.6608e+00, 3.8023e+05, 3.7286e+05, 3.5792e+00, 3.8851e+05, 3.7954e+00,
         3.8687e+05, 3.5555e+00, 3.6884e+00, 3.6931e+00, 0.0000e+00, 3.8038e+05,
         3.8948e+05],
        [3.8036e+05, 7.4314e+05, 7.4309e+05, 3.8039e+05, 7.8512e+05, 3.8035e+05,
         7.7001e+05, 3.8034e+05, 3.8036e+05, 3.8038e+05, 3.8038e+05, 0.0000e+00,
         7.7055e+05],
        [3.8947e+05, 7.7776e+05, 7.5633e+05, 3.8948e+05, 7.9586e+05, 3.8947e+05,
         7.5724e+05, 3.8949e+05, 3.8948e+05, 3.8947e+05, 3.8948e+05, 7.7055e+05,
         0.0000e+00]])
Krum scores: ['3.73', '380230.97', '372901.19', '3.53', '388511.66', '3.68', '386830.50', '3.66', '3.61', '3.66', '3.64', '380356.31', '389473.81']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 14, 18, 11, 13, 7, 15, 4, 9, 1, 10, 17, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0027s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:32...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[127 110]
 [131 132]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:32, End: 2025-07-22 15:47:32)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [20], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
tensor([[0.]])
Krum scores: ['nan']
Selected index: 0
krum, clients_type: [['Chosen Update']], selected_client_indices: [20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0006s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:32...
global Accuracy on shared test data: 47.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 94 143]
 [122 141]]
Function 'evaluate_global_model' executed in 0.0019 seconds (Start: 2025-07-22 15:47:32, End: 2025-07-22 15:47:32)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [4, 16, 20, 8, 1, 3, 6, 5, 7, 12, 14, 10, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.8182e+05, 3.9723e+05, 3.9338e+00, 3.9314e+00, 3.8953e+00,
         3.9329e+00, 3.7473e+00, 4.0747e+00, 4.0717e+00, 3.9738e+05, 3.9756e+00,
         3.8919e+05],
        [3.8182e+05, 0.0000e+00, 7.7650e+05, 3.8177e+05, 3.8177e+05, 3.8175e+05,
         3.8180e+05, 3.8177e+05, 3.8178e+05, 3.8180e+05, 7.6757e+05, 3.8178e+05,
         7.5206e+05],
        [3.9723e+05, 7.7650e+05, 0.0000e+00, 3.9725e+05, 3.9727e+05, 3.9728e+05,
         3.9726e+05, 3.9723e+05, 3.9721e+05, 3.9724e+05, 8.1029e+05, 3.9725e+05,
         8.0577e+05],
        [3.9338e+00, 3.8177e+05, 3.9725e+05, 0.0000e+00, 3.8220e+00, 3.9184e+00,
         3.9438e+00, 4.0922e+00, 4.3742e+00, 3.6810e+00, 3.9737e+05, 3.8383e+00,
         3.8921e+05],
        [3.9314e+00, 3.8177e+05, 3.9727e+05, 3.8220e+00, 0.0000e+00, 3.8268e+00,
         3.9091e+00, 3.9890e+00, 4.1240e+00, 3.9525e+00, 3.9733e+05, 3.8873e+00,
         3.8917e+05],
        [3.8953e+00, 3.8175e+05, 3.9728e+05, 3.9184e+00, 3.8268e+00, 0.0000e+00,
         3.8318e+00, 4.0221e+00, 3.8911e+00, 4.0023e+00, 3.9734e+05, 3.8841e+00,
         3.8919e+05],
        [3.9329e+00, 3.8180e+05, 3.9726e+05, 3.9438e+00, 3.9091e+00, 3.8318e+00,
         0.0000e+00, 3.7990e+00, 3.9940e+00, 3.9466e+00, 3.9734e+05, 3.6929e+00,
         3.8919e+05],
        [3.7473e+00, 3.8177e+05, 3.9723e+05, 4.0922e+00, 3.9890e+00, 4.0221e+00,
         3.7990e+00, 0.0000e+00, 4.0895e+00, 4.0150e+00, 3.9739e+05, 4.0617e+00,
         3.8920e+05],
        [4.0747e+00, 3.8178e+05, 3.9721e+05, 4.3742e+00, 4.1240e+00, 3.8911e+00,
         3.9940e+00, 4.0895e+00, 0.0000e+00, 4.1474e+00, 3.9736e+05, 3.8920e+00,
         3.8922e+05],
        [4.0717e+00, 3.8180e+05, 3.9724e+05, 3.6810e+00, 3.9525e+00, 4.0023e+00,
         3.9466e+00, 4.0150e+00, 4.1474e+00, 0.0000e+00, 3.9737e+05, 3.7315e+00,
         3.8921e+05],
        [3.9738e+05, 7.6757e+05, 8.1029e+05, 3.9737e+05, 3.9733e+05, 3.9734e+05,
         3.9734e+05, 3.9739e+05, 3.9736e+05, 3.9737e+05, 0.0000e+00, 3.9738e+05,
         7.9731e+05],
        [3.9756e+00, 3.8178e+05, 3.9725e+05, 3.8383e+00, 3.8873e+00, 3.8841e+00,
         3.6929e+00, 4.0617e+00, 3.8920e+00, 3.7315e+00, 3.9738e+05, 0.0000e+00,
         3.8914e+05],
        [3.8919e+05, 7.5206e+05, 8.0577e+05, 3.8921e+05, 3.8917e+05, 3.8919e+05,
         3.8919e+05, 3.8920e+05, 3.8922e+05, 3.8921e+05, 7.9731e+05, 3.8914e+05,
         0.0000e+00]])
Krum scores: ['3.93', '381774.53', '397236.47', '3.89', '3.90', '3.89', '3.87', '3.96', '4.03', '3.91', '397356.59', '3.84', '389185.00']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']], selected_client_indices: [4, 16, 20, 8, 1, 3, 6, 5, 7, 12, 14, 10, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0064s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:33...
global Accuracy on shared test data: 47.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 96 141]
 [122 141]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:33, End: 2025-07-22 15:47:33)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (8): [6, 12, 19, 17, 1, 8, 7, 18], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 8
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([8])
tensor([[0.0000e+00, 3.8850e+00, 3.8117e+05, 3.9187e+05, 3.8364e+00, 3.7633e+00,
         3.9691e+00, 4.0958e+05],
        [3.8850e+00, 0.0000e+00, 3.8115e+05, 3.9186e+05, 3.9142e+00, 3.6939e+00,
         4.1431e+00, 4.0954e+05],
        [3.8117e+05, 3.8115e+05, 0.0000e+00, 7.7004e+05, 3.8118e+05, 3.8117e+05,
         3.8118e+05, 7.7707e+05],
        [3.9187e+05, 3.9186e+05, 7.7004e+05, 0.0000e+00, 3.9184e+05, 3.9188e+05,
         3.9188e+05, 8.0680e+05],
        [3.8364e+00, 3.9142e+00, 3.8118e+05, 3.9184e+05, 0.0000e+00, 3.7397e+00,
         4.0725e+00, 4.0954e+05],
        [3.7633e+00, 3.6939e+00, 3.8117e+05, 3.9188e+05, 3.7397e+00, 0.0000e+00,
         4.2853e+00, 4.0955e+05],
        [3.9691e+00, 4.1431e+00, 3.8118e+05, 3.9188e+05, 4.0725e+00, 4.2853e+00,
         0.0000e+00, 4.0963e+05],
        [4.0958e+05, 4.0954e+05, 7.7707e+05, 8.0680e+05, 4.0954e+05, 4.0955e+05,
         4.0963e+05, 0.0000e+00]])
Krum scores: ['3.83', '3.83', '381166.12', '391858.72', '3.83', '3.73', '4.06', '409543.47']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']], selected_client_indices: [6, 12, 19, 17, 1, 8, 7, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0017s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:33...
global Accuracy on shared test data: 47.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 96 141]
 [122 141]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:33, End: 2025-07-22 15:47:33)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [4, 6, 12, 5, 8, 1, 3, 18, 11, 16, 2, 15, 19, 7, 9, 14, 10, 17, 13], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 3.8642e+00, 4.2014e+00, 3.8244e+00, 3.9466e+00, 3.9901e+00,
         3.8944e+00, 3.8525e+05, 3.9012e+00, 3.9253e+05, 3.8766e+00, 3.9328e+05,
         3.9144e+05, 4.1571e+00, 4.1613e+00, 3.7901e+05, 3.9995e+00, 3.9311e+05,
         4.1104e+05],
        [3.8642e+00, 0.0000e+00, 4.0276e+00, 4.0291e+00, 3.8228e+00, 3.9949e+00,
         3.8496e+00, 3.8522e+05, 3.8248e+00, 3.9259e+05, 3.9281e+00, 3.9329e+05,
         3.9147e+05, 4.0009e+00, 3.8295e+00, 3.7904e+05, 3.6825e+00, 3.9311e+05,
         4.1107e+05],
        [4.2014e+00, 4.0276e+00, 0.0000e+00, 4.2572e+00, 3.7881e+00, 4.0493e+00,
         4.0890e+00, 3.8521e+05, 3.9039e+00, 3.9253e+05, 3.9402e+00, 3.9334e+05,
         3.9144e+05, 4.2764e+00, 3.9598e+00, 3.7904e+05, 3.8872e+00, 3.9304e+05,
         4.1106e+05],
        [3.8244e+00, 4.0291e+00, 4.2572e+00, 0.0000e+00, 4.2039e+00, 4.1219e+00,
         4.1015e+00, 3.8520e+05, 3.9615e+00, 3.9253e+05, 3.8681e+00, 3.9323e+05,
         3.9145e+05, 4.2387e+00, 4.3214e+00, 3.7905e+05, 4.2185e+00, 3.9313e+05,
         4.1103e+05],
        [3.9466e+00, 3.8228e+00, 3.7881e+00, 4.2039e+00, 0.0000e+00, 3.7983e+00,
         3.9734e+00, 3.8526e+05, 3.7452e+00, 3.9258e+05, 3.8323e+00, 3.9327e+05,
         3.9147e+05, 4.3632e+00, 3.7575e+00, 3.7899e+05, 3.7176e+00, 3.9308e+05,
         4.1107e+05],
        [3.9901e+00, 3.9949e+00, 4.0493e+00, 4.1219e+00, 3.7983e+00, 0.0000e+00,
         3.9268e+00, 3.8526e+05, 3.8691e+00, 3.9254e+05, 3.7671e+00, 3.9334e+05,
         3.9144e+05, 4.1782e+00, 3.5646e+00, 3.7902e+05, 3.9296e+00, 3.9308e+05,
         4.1105e+05],
        [3.8944e+00, 3.8496e+00, 4.0890e+00, 4.1015e+00, 3.9734e+00, 3.9268e+00,
         0.0000e+00, 3.8522e+05, 4.0991e+00, 3.9255e+05, 3.6938e+00, 3.9328e+05,
         3.9144e+05, 3.9595e+00, 3.8841e+00, 3.7903e+05, 3.9547e+00, 3.9309e+05,
         4.1104e+05],
        [3.8525e+05, 3.8522e+05, 3.8521e+05, 3.8520e+05, 3.8526e+05, 3.8526e+05,
         3.8522e+05, 0.0000e+00, 3.8524e+05, 7.8669e+05, 3.8524e+05, 7.7845e+05,
         7.8278e+05, 3.8522e+05, 3.8523e+05, 7.7786e+05, 3.8530e+05, 7.7589e+05,
         7.8246e+05],
        [3.9012e+00, 3.8248e+00, 3.9039e+00, 3.9615e+00, 3.7452e+00, 3.8691e+00,
         4.0991e+00, 3.8524e+05, 0.0000e+00, 3.9255e+05, 3.5793e+00, 3.9325e+05,
         3.9142e+05, 4.2229e+00, 4.0297e+00, 3.7904e+05, 3.9121e+00, 3.9315e+05,
         4.1107e+05],
        [3.9253e+05, 3.9259e+05, 3.9253e+05, 3.9253e+05, 3.9258e+05, 3.9254e+05,
         3.9255e+05, 7.8669e+05, 3.9255e+05, 0.0000e+00, 3.9258e+05, 7.8213e+05,
         7.8214e+05, 3.9258e+05, 3.9250e+05, 7.6127e+05, 3.9254e+05, 7.9466e+05,
         7.9393e+05],
        [3.8766e+00, 3.9281e+00, 3.9402e+00, 3.8681e+00, 3.8323e+00, 3.7671e+00,
         3.6938e+00, 3.8524e+05, 3.5793e+00, 3.9258e+05, 0.0000e+00, 3.9328e+05,
         3.9146e+05, 3.7456e+00, 3.7287e+00, 3.7903e+05, 3.4154e+00, 3.9313e+05,
         4.1107e+05],
        [3.9328e+05, 3.9329e+05, 3.9334e+05, 3.9323e+05, 3.9327e+05, 3.9334e+05,
         3.9328e+05, 7.7845e+05, 3.9325e+05, 7.8213e+05, 3.9328e+05, 0.0000e+00,
         7.9893e+05, 3.9329e+05, 3.9329e+05, 7.7987e+05, 3.9329e+05, 7.8567e+05,
         7.9840e+05],
        [3.9144e+05, 3.9147e+05, 3.9144e+05, 3.9145e+05, 3.9147e+05, 3.9144e+05,
         3.9144e+05, 7.8278e+05, 3.9142e+05, 7.8214e+05, 3.9146e+05, 7.9893e+05,
         0.0000e+00, 3.9148e+05, 3.9145e+05, 7.4736e+05, 3.9146e+05, 7.8605e+05,
         7.8695e+05],
        [4.1571e+00, 4.0009e+00, 4.2764e+00, 4.2387e+00, 4.3632e+00, 4.1782e+00,
         3.9595e+00, 3.8522e+05, 4.2229e+00, 3.9258e+05, 3.7456e+00, 3.9329e+05,
         3.9148e+05, 0.0000e+00, 4.4128e+00, 3.7903e+05, 3.9526e+00, 3.9307e+05,
         4.1104e+05],
        [4.1613e+00, 3.8295e+00, 3.9598e+00, 4.3214e+00, 3.7575e+00, 3.5646e+00,
         3.8841e+00, 3.8523e+05, 4.0297e+00, 3.9250e+05, 3.7287e+00, 3.9329e+05,
         3.9145e+05, 4.4128e+00, 0.0000e+00, 3.7904e+05, 4.0179e+00, 3.9309e+05,
         4.1102e+05],
        [3.7901e+05, 3.7904e+05, 3.7904e+05, 3.7905e+05, 3.7899e+05, 3.7902e+05,
         3.7903e+05, 7.7786e+05, 3.7904e+05, 7.6127e+05, 3.7903e+05, 7.7987e+05,
         7.4736e+05, 3.7903e+05, 3.7904e+05, 0.0000e+00, 3.7906e+05, 7.7566e+05,
         7.8778e+05],
        [3.9995e+00, 3.6825e+00, 3.8872e+00, 4.2185e+00, 3.7176e+00, 3.9296e+00,
         3.9547e+00, 3.8530e+05, 3.9121e+00, 3.9254e+05, 3.4154e+00, 3.9329e+05,
         3.9146e+05, 3.9526e+00, 4.0179e+00, 3.7906e+05, 0.0000e+00, 3.9310e+05,
         4.1101e+05],
        [3.9311e+05, 3.9311e+05, 3.9304e+05, 3.9313e+05, 3.9308e+05, 3.9308e+05,
         3.9309e+05, 7.7589e+05, 3.9315e+05, 7.9466e+05, 3.9313e+05, 7.8567e+05,
         7.8605e+05, 3.9307e+05, 3.9309e+05, 7.7566e+05, 3.9310e+05, 0.0000e+00,
         8.0438e+05],
        [4.1104e+05, 4.1107e+05, 4.1106e+05, 4.1103e+05, 4.1107e+05, 4.1105e+05,
         4.1104e+05, 7.8246e+05, 4.1107e+05, 7.9393e+05, 4.1107e+05, 7.9840e+05,
         7.8695e+05, 4.1104e+05, 4.1102e+05, 7.8778e+05, 4.1101e+05, 8.0438e+05,
         0.0000e+00]])
Krum scores: ['3.96', '3.88', '4.01', '4.08', '3.86', '3.90', '3.93', '385229.00', '3.88', '392542.41', '3.74', '393274.31', '391448.25', '4.11', '3.93', '379027.28', '3.85', '393091.09', '411043.03']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [4, 6, 12, 5, 8, 1, 3, 18, 11, 16, 2, 15, 19, 7, 9, 14, 10, 17, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0287s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:34...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 98 139]
 [128 135]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:34, End: 2025-07-22 15:47:34)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (8): [8, 9, 20, 4, 3, 2, 5, 14], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 8
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([8])
tensor([[0.0000e+00, 3.8004e+00, 3.8193e+05, 4.0336e+00, 4.1108e+00, 3.9258e+00,
         4.2493e+00, 3.8811e+05],
        [3.8004e+00, 0.0000e+00, 3.8194e+05, 4.2293e+00, 4.0100e+00, 3.7176e+00,
         4.3018e+00, 3.8812e+05],
        [3.8193e+05, 3.8194e+05, 0.0000e+00, 3.8197e+05, 3.8199e+05, 3.8197e+05,
         3.8198e+05, 7.6006e+05],
        [4.0336e+00, 4.2293e+00, 3.8197e+05, 0.0000e+00, 3.9652e+00, 3.8856e+00,
         3.8969e+00, 3.8814e+05],
        [4.1108e+00, 4.0100e+00, 3.8199e+05, 3.9652e+00, 0.0000e+00, 3.7462e+00,
         4.1959e+00, 3.8808e+05],
        [3.9258e+00, 3.7176e+00, 3.8197e+05, 3.8856e+00, 3.7462e+00, 0.0000e+00,
         3.9076e+00, 3.8814e+05],
        [4.2493e+00, 4.3018e+00, 3.8198e+05, 3.8969e+00, 4.1959e+00, 3.9076e+00,
         0.0000e+00, 3.8805e+05],
        [3.8811e+05, 3.8812e+05, 7.6006e+05, 3.8814e+05, 3.8808e+05, 3.8814e+05,
         3.8805e+05, 0.0000e+00]])
Krum scores: ['3.97', '3.94', '381953.06', '3.95', '3.96', '3.81', '4.06', '388091.31']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']], selected_client_indices: [8, 9, 20, 4, 3, 2, 5, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0134s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:34...
global Accuracy on shared test data: 46.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 97 140]
 [130 133]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:34, End: 2025-07-22 15:47:34)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [16, 12, 4], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[0.0000e+00, 3.8375e+05, 3.8377e+05],
        [3.8375e+05, 0.0000e+00, 4.2718e+00],
        [3.8377e+05, 4.2718e+00, 0.0000e+00]])
Krum scores: ['nan', 'nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']], selected_client_indices: [16, 12, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0064s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:35...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[145  92]
 [167  96]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:35, End: 2025-07-22 15:47:35)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [2, 7, 9], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[0.0000, 3.3803, 3.7233],
        [3.3803, 0.0000, 4.1432],
        [3.7233, 4.1432, 0.0000]])
Krum scores: ['3.38', '3.38', '3.72']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']], selected_client_indices: [2, 7, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0010s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:35...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[143  94]
 [165  98]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:35, End: 2025-07-22 15:47:35)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [8, 3, 10, 19, 17, 12, 9, 4, 11, 14, 18, 2, 13, 7, 15, 20, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.8497e+00, 3.7612e+00, 4.0199e+05, 4.0452e+05, 3.7529e+00,
         4.4151e+00, 4.2187e+00, 3.9506e+00, 3.8633e+05, 3.8688e+05, 3.8070e+00,
         3.9449e+05, 4.1078e+00, 3.8666e+05, 3.8757e+05, 3.6711e+00],
        [3.8497e+00, 0.0000e+00, 3.6314e+00, 4.0201e+05, 4.0447e+05, 3.6598e+00,
         3.8806e+00, 3.3958e+00, 3.7300e+00, 3.8636e+05, 3.8691e+05, 3.5303e+00,
         3.9450e+05, 3.2428e+00, 3.8667e+05, 3.8756e+05, 3.4802e+00],
        [3.7612e+00, 3.6314e+00, 0.0000e+00, 4.0196e+05, 4.0449e+05, 3.7134e+00,
         4.0643e+00, 3.4111e+00, 3.6054e+00, 3.8628e+05, 3.8694e+05, 3.1609e+00,
         3.9452e+05, 3.4240e+00, 3.8671e+05, 3.8755e+05, 3.2905e+00],
        [4.0199e+05, 4.0201e+05, 4.0196e+05, 0.0000e+00, 8.1326e+05, 4.0202e+05,
         4.0202e+05, 4.0198e+05, 4.0197e+05, 7.8879e+05, 7.6221e+05, 4.0199e+05,
         8.2811e+05, 4.0196e+05, 7.7039e+05, 7.6883e+05, 4.0199e+05],
        [4.0452e+05, 4.0447e+05, 4.0449e+05, 8.1326e+05, 0.0000e+00, 4.0449e+05,
         4.0444e+05, 4.0445e+05, 4.0447e+05, 8.1824e+05, 7.7829e+05, 4.0448e+05,
         7.9137e+05, 4.0450e+05, 7.9475e+05, 7.8233e+05, 4.0449e+05],
        [3.7529e+00, 3.6598e+00, 3.7134e+00, 4.0202e+05, 4.0449e+05, 0.0000e+00,
         4.1172e+00, 3.7684e+00, 3.8252e+00, 3.8634e+05, 3.8692e+05, 3.6670e+00,
         3.9453e+05, 3.9710e+00, 3.8670e+05, 3.8752e+05, 3.8232e+00],
        [4.4151e+00, 3.8806e+00, 4.0643e+00, 4.0202e+05, 4.0444e+05, 4.1172e+00,
         0.0000e+00, 3.7955e+00, 3.3131e+00, 3.8636e+05, 3.8689e+05, 3.6397e+00,
         3.9450e+05, 4.2434e+00, 3.8668e+05, 3.8748e+05, 4.0647e+00],
        [4.2187e+00, 3.3958e+00, 3.4111e+00, 4.0198e+05, 4.0445e+05, 3.7684e+00,
         3.7955e+00, 0.0000e+00, 3.7029e+00, 3.8636e+05, 3.8691e+05, 3.5608e+00,
         3.9451e+05, 3.6589e+00, 3.8667e+05, 3.8756e+05, 3.8861e+00],
        [3.9506e+00, 3.7300e+00, 3.6054e+00, 4.0197e+05, 4.0447e+05, 3.8252e+00,
         3.3131e+00, 3.7029e+00, 0.0000e+00, 3.8630e+05, 3.8689e+05, 3.5118e+00,
         3.9456e+05, 3.9801e+00, 3.8669e+05, 3.8751e+05, 3.5019e+00],
        [3.8633e+05, 3.8636e+05, 3.8628e+05, 7.8879e+05, 8.1824e+05, 3.8634e+05,
         3.8636e+05, 3.8636e+05, 3.8630e+05, 0.0000e+00, 7.4207e+05, 3.8630e+05,
         7.6354e+05, 3.8627e+05, 7.7028e+05, 7.7696e+05, 3.8633e+05],
        [3.8688e+05, 3.8691e+05, 3.8694e+05, 7.6221e+05, 7.7829e+05, 3.8692e+05,
         3.8689e+05, 3.8691e+05, 3.8689e+05, 7.4207e+05, 0.0000e+00, 3.8690e+05,
         7.8193e+05, 3.8685e+05, 7.6224e+05, 7.7066e+05, 3.8691e+05],
        [3.8070e+00, 3.5303e+00, 3.1609e+00, 4.0199e+05, 4.0448e+05, 3.6670e+00,
         3.6397e+00, 3.5608e+00, 3.5118e+00, 3.8630e+05, 3.8690e+05, 0.0000e+00,
         3.9457e+05, 3.3602e+00, 3.8664e+05, 3.8754e+05, 3.6433e+00],
        [3.9449e+05, 3.9450e+05, 3.9452e+05, 8.2811e+05, 7.9137e+05, 3.9453e+05,
         3.9450e+05, 3.9451e+05, 3.9456e+05, 7.6354e+05, 7.8193e+05, 3.9457e+05,
         0.0000e+00, 3.9453e+05, 7.8751e+05, 7.6617e+05, 3.9455e+05],
        [4.1078e+00, 3.2428e+00, 3.4240e+00, 4.0196e+05, 4.0450e+05, 3.9710e+00,
         4.2434e+00, 3.6589e+00, 3.9801e+00, 3.8627e+05, 3.8685e+05, 3.3602e+00,
         3.9453e+05, 0.0000e+00, 3.8668e+05, 3.8747e+05, 3.7832e+00],
        [3.8666e+05, 3.8667e+05, 3.8671e+05, 7.7039e+05, 7.9475e+05, 3.8670e+05,
         3.8668e+05, 3.8667e+05, 3.8669e+05, 7.7028e+05, 7.6224e+05, 3.8664e+05,
         7.8751e+05, 3.8668e+05, 0.0000e+00, 7.7192e+05, 3.8667e+05],
        [3.8757e+05, 3.8756e+05, 3.8755e+05, 7.6883e+05, 7.8233e+05, 3.8752e+05,
         3.8748e+05, 3.8756e+05, 3.8751e+05, 7.7696e+05, 7.7066e+05, 3.8754e+05,
         7.6617e+05, 3.8747e+05, 7.7192e+05, 0.0000e+00, 3.8753e+05],
        [3.6711e+00, 3.4802e+00, 3.2905e+00, 4.0199e+05, 4.0449e+05, 3.8232e+00,
         4.0647e+00, 3.8861e+00, 3.5019e+00, 3.8633e+05, 3.8691e+05, 3.6433e+00,
         3.9455e+05, 3.7832e+00, 3.8667e+05, 3.8753e+05, 0.0000e+00]])
Krum scores: ['3.89', '3.57', '3.50', '401982.47', '404472.94', '3.77', '3.89', '3.65', '3.64', '386312.91', '386892.31', '3.51', '394516.34', '3.69', '386671.62', '387519.25', '3.63']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [8, 3, 10, 19, 17, 12, 9, 4, 11, 14, 18, 2, 13, 7, 15, 20, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0215s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:36...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[141  96]
 [161 102]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:36, End: 2025-07-22 15:47:36)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [1, 13, 4, 18, 9, 14, 15, 2, 7, 17], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 3.9145e+05, 3.5174e+00, 3.8151e+05, 3.7107e+00, 4.0028e+05,
         3.9529e+05, 3.7700e+00, 3.6085e+00, 4.2117e+05],
        [3.9145e+05, 0.0000e+00, 3.9143e+05, 7.6673e+05, 3.9138e+05, 7.9416e+05,
         7.8584e+05, 3.9142e+05, 3.9147e+05, 8.0587e+05],
        [3.5174e+00, 3.9143e+05, 0.0000e+00, 3.8147e+05, 3.8036e+00, 4.0025e+05,
         3.9525e+05, 3.6188e+00, 3.6452e+00, 4.2119e+05],
        [3.8151e+05, 7.6673e+05, 3.8147e+05, 0.0000e+00, 3.8145e+05, 7.8271e+05,
         7.8722e+05, 3.8147e+05, 3.8155e+05, 8.0500e+05],
        [3.7107e+00, 3.9138e+05, 3.8036e+00, 3.8145e+05, 0.0000e+00, 4.0023e+05,
         3.9534e+05, 3.7587e+00, 4.2457e+00, 4.2121e+05],
        [4.0028e+05, 7.9416e+05, 4.0025e+05, 7.8271e+05, 4.0023e+05, 0.0000e+00,
         8.0769e+05, 4.0019e+05, 4.0017e+05, 8.2871e+05],
        [3.9529e+05, 7.8584e+05, 3.9525e+05, 7.8722e+05, 3.9534e+05, 8.0769e+05,
         0.0000e+00, 3.9529e+05, 3.9524e+05, 8.2029e+05],
        [3.7700e+00, 3.9142e+05, 3.6188e+00, 3.8147e+05, 3.7587e+00, 4.0019e+05,
         3.9529e+05, 0.0000e+00, 3.4134e+00, 4.2119e+05],
        [3.6085e+00, 3.9147e+05, 3.6452e+00, 3.8155e+05, 4.2457e+00, 4.0017e+05,
         3.9524e+05, 3.4134e+00, 0.0000e+00, 4.2121e+05],
        [4.2117e+05, 8.0587e+05, 4.2119e+05, 8.0500e+05, 4.2121e+05, 8.2871e+05,
         8.2029e+05, 4.2119e+05, 4.2121e+05, 0.0000e+00]])
Krum scores: ['3.61', '391407.50', '3.59', '381465.34', '3.76', '400194.19', '395258.84', '3.60', '3.56', '421181.84']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']], selected_client_indices: [1, 13, 4, 18, 9, 14, 15, 2, 7, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0051s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:36...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[137 100]
 [156 107]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:36, End: 2025-07-22 15:47:36)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [19, 17, 10, 20, 2, 4, 15, 13, 18], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 7.7790e+05, 3.9140e+05, 7.6872e+05, 3.9143e+05, 3.9143e+05,
         7.7102e+05, 8.1041e+05, 7.7810e+05],
        [7.7790e+05, 0.0000e+00, 3.8346e+05, 7.8132e+05, 3.8344e+05, 3.8349e+05,
         7.8414e+05, 7.6786e+05, 7.8983e+05],
        [3.9140e+05, 3.8346e+05, 0.0000e+00, 3.8425e+05, 3.2542e+00, 3.3368e+00,
         3.9969e+05, 3.9501e+05, 3.8800e+05],
        [7.6872e+05, 7.8132e+05, 3.8425e+05, 0.0000e+00, 3.8426e+05, 3.8429e+05,
         7.7814e+05, 7.7859e+05, 7.8641e+05],
        [3.9143e+05, 3.8344e+05, 3.2542e+00, 3.8426e+05, 0.0000e+00, 3.6602e+00,
         3.9973e+05, 3.9507e+05, 3.8799e+05],
        [3.9143e+05, 3.8349e+05, 3.3368e+00, 3.8429e+05, 3.6602e+00, 0.0000e+00,
         3.9967e+05, 3.9502e+05, 3.8804e+05],
        [7.7102e+05, 7.8414e+05, 3.9969e+05, 7.7814e+05, 3.9973e+05, 3.9967e+05,
         0.0000e+00, 8.2652e+05, 7.8992e+05],
        [8.1041e+05, 7.6786e+05, 3.9501e+05, 7.7859e+05, 3.9507e+05, 3.9502e+05,
         8.2652e+05, 0.0000e+00, 7.7427e+05],
        [7.7810e+05, 7.8983e+05, 3.8800e+05, 7.8641e+05, 3.8799e+05, 3.8804e+05,
         7.8992e+05, 7.7427e+05, 0.0000e+00]])
Krum scores: ['391396.81', '383442.75', '3.25', '384253.22', '3.25', '3.34', '399671.94', '395005.97', '387986.53']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [19, 17, 10, 20, 2, 4, 15, 13, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0019s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:36...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[135 102]
 [153 110]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:36, End: 2025-07-22 15:47:36)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [7, 2], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 3.4339],
        [3.4339, 0.0000]])
Krum scores: ['nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [7, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0007s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:37...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[134 103]
 [151 112]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:47:37, End: 2025-07-22 15:47:37)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [4, 7, 10], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
tensor([[0.0000, 3.5357, 3.3715],
        [3.5357, 0.0000, 3.5004],
        [3.3715, 3.5004, 0.0000]])
Krum scores: ['3.37', '3.50', '3.37']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']], selected_client_indices: [4, 7, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0010s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:37...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[131 106]
 [151 112]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:37, End: 2025-07-22 15:47:37)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [7, 14, 9, 1, 6, 2, 19, 10, 16, 15, 18, 3], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 3.8860e+05, 4.3948e+00, 3.8615e+00, 3.9977e+00, 3.6713e+00,
         3.8914e+05, 3.5172e+00, 3.8972e+05, 3.8555e+05, 3.7662e+05, 3.3628e+00],
        [3.8860e+05, 0.0000e+00, 3.8856e+05, 3.8852e+05, 3.8853e+05, 3.8852e+05,
         7.8193e+05, 3.8858e+05, 7.6338e+05, 7.7104e+05, 7.7609e+05, 3.8856e+05],
        [4.3948e+00, 3.8856e+05, 0.0000e+00, 3.7877e+00, 4.3112e+00, 3.8607e+00,
         3.8918e+05, 4.2147e+00, 3.8976e+05, 3.8551e+05, 3.7667e+05, 3.9307e+00],
        [3.8615e+00, 3.8852e+05, 3.7877e+00, 0.0000e+00, 3.7965e+00, 3.8327e+00,
         3.8919e+05, 3.7052e+00, 3.8974e+05, 3.8553e+05, 3.7673e+05, 3.5601e+00],
        [3.9977e+00, 3.8853e+05, 4.3112e+00, 3.7965e+00, 0.0000e+00, 3.8886e+00,
         3.8915e+05, 3.4734e+00, 3.8979e+05, 3.8549e+05, 3.7668e+05, 3.8160e+00],
        [3.6713e+00, 3.8852e+05, 3.8607e+00, 3.8327e+00, 3.8886e+00, 0.0000e+00,
         3.8922e+05, 3.3218e+00, 3.8974e+05, 3.8549e+05, 3.7668e+05, 3.5980e+00],
        [3.8914e+05, 7.8193e+05, 3.8918e+05, 3.8919e+05, 3.8915e+05, 3.8922e+05,
         0.0000e+00, 3.8915e+05, 7.6839e+05, 7.4605e+05, 7.7077e+05, 3.8914e+05],
        [3.5172e+00, 3.8858e+05, 4.2147e+00, 3.7052e+00, 3.4734e+00, 3.3218e+00,
         3.8915e+05, 0.0000e+00, 3.8972e+05, 3.8554e+05, 3.7675e+05, 3.5377e+00],
        [3.8972e+05, 7.6338e+05, 3.8976e+05, 3.8974e+05, 3.8979e+05, 3.8974e+05,
         7.6839e+05, 3.8972e+05, 0.0000e+00, 7.8688e+05, 7.7984e+05, 3.8974e+05],
        [3.8555e+05, 7.7104e+05, 3.8551e+05, 3.8553e+05, 3.8549e+05, 3.8549e+05,
         7.4605e+05, 3.8554e+05, 7.8688e+05, 0.0000e+00, 7.7939e+05, 3.8549e+05],
        [3.7662e+05, 7.7609e+05, 3.7667e+05, 3.7673e+05, 3.7668e+05, 3.7668e+05,
         7.7077e+05, 3.7675e+05, 7.7984e+05, 7.7939e+05, 0.0000e+00, 3.7669e+05],
        [3.3628e+00, 3.8856e+05, 3.9307e+00, 3.5601e+00, 3.8160e+00, 3.5980e+00,
         3.8914e+05, 3.5377e+00, 3.8974e+05, 3.8549e+05, 3.7669e+05, 0.0000e+00]])
Krum scores: ['3.68', '388536.84', '4.02', '3.74', '3.79', '3.66', '389153.94', '3.51', '389731.28', '385500.88', '376668.69', '3.57']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [7, 14, 9, 1, 6, 2, 19, 10, 16, 15, 18, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0024s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:37...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[127 110]
 [148 115]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:37, End: 2025-07-22 15:47:37)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [19, 13, 18, 3, 2, 17, 11, 5, 15], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 7.5865e+05, 7.7290e+05, 3.8846e+05, 3.8847e+05, 8.0016e+05,
         3.8847e+05, 3.8844e+05, 7.7736e+05],
        [7.5865e+05, 0.0000e+00, 7.5884e+05, 3.7363e+05, 3.7363e+05, 7.6707e+05,
         3.7365e+05, 3.7363e+05, 7.7812e+05],
        [7.7290e+05, 7.5884e+05, 0.0000e+00, 3.9032e+05, 3.9032e+05, 8.0480e+05,
         3.9039e+05, 3.9033e+05, 7.9333e+05],
        [3.8846e+05, 3.7363e+05, 3.9032e+05, 0.0000e+00, 3.6668e+00, 3.9707e+05,
         3.8875e+00, 3.8348e+00, 4.0389e+05],
        [3.8847e+05, 3.7363e+05, 3.9032e+05, 3.6668e+00, 0.0000e+00, 3.9707e+05,
         3.4865e+00, 3.6783e+00, 4.0387e+05],
        [8.0016e+05, 7.6707e+05, 8.0480e+05, 3.9707e+05, 3.9707e+05, 0.0000e+00,
         3.9704e+05, 3.9707e+05, 8.0354e+05],
        [3.8847e+05, 3.7365e+05, 3.9039e+05, 3.8875e+00, 3.4865e+00, 3.9704e+05,
         0.0000e+00, 3.6233e+00, 4.0384e+05],
        [3.8844e+05, 3.7363e+05, 3.9033e+05, 3.8348e+00, 3.6783e+00, 3.9707e+05,
         3.6233e+00, 0.0000e+00, 4.0387e+05],
        [7.7736e+05, 7.7812e+05, 7.9333e+05, 4.0389e+05, 4.0387e+05, 8.0354e+05,
         4.0384e+05, 4.0387e+05, 0.0000e+00]])
Krum scores: ['388451.16', '373631.47', '390321.34', '3.75', '3.58', '397055.88', '3.55', '3.65', '403853.75']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']], selected_client_indices: [19, 13, 18, 3, 2, 17, 11, 5, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0022s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:38...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[125 112]
 [146 117]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:38, End: 2025-07-22 15:47:38)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [18, 4, 1, 16, 5, 19, 20, 17, 11, 2, 15, 8, 9, 13, 12, 6, 10], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.8819e+05, 3.8819e+05, 7.6423e+05, 3.8815e+05, 7.9564e+05,
         7.6686e+05, 7.5377e+05, 3.8818e+05, 3.8818e+05, 7.9318e+05, 3.8820e+05,
         3.8824e+05, 7.8770e+05, 3.8815e+05, 3.8815e+05, 3.8815e+05],
        [3.8819e+05, 0.0000e+00, 3.4468e+00, 3.8773e+05, 3.9556e+00, 3.9751e+05,
         3.8692e+05, 3.6943e+05, 3.7379e+00, 3.6609e+00, 4.0364e+05, 3.9538e+00,
         3.9754e+00, 3.9455e+05, 3.7732e+00, 3.9158e+00, 3.4448e+00],
        [3.8819e+05, 3.4468e+00, 0.0000e+00, 3.8773e+05, 3.9686e+00, 3.9752e+05,
         3.8685e+05, 3.6946e+05, 3.5090e+00, 3.7501e+00, 4.0369e+05, 3.8532e+00,
         3.7275e+00, 3.9457e+05, 3.7543e+00, 3.7321e+00, 3.7485e+00],
        [7.6423e+05, 3.8773e+05, 3.8773e+05, 0.0000e+00, 3.8776e+05, 7.7181e+05,
         7.8016e+05, 7.5524e+05, 3.8773e+05, 3.8775e+05, 7.9410e+05, 3.8779e+05,
         3.8776e+05, 7.7388e+05, 3.8772e+05, 3.8775e+05, 3.8774e+05],
        [3.8815e+05, 3.9556e+00, 3.9686e+00, 3.8776e+05, 0.0000e+00, 3.9749e+05,
         3.8687e+05, 3.6942e+05, 3.5886e+00, 3.7196e+00, 4.0365e+05, 3.9581e+00,
         4.6640e+00, 3.9456e+05, 3.8752e+00, 3.9499e+00, 3.6992e+00],
        [7.9564e+05, 3.9751e+05, 3.9752e+05, 7.7181e+05, 3.9749e+05, 0.0000e+00,
         7.7023e+05, 7.6972e+05, 3.9751e+05, 3.9750e+05, 8.1254e+05, 3.9749e+05,
         3.9750e+05, 7.9005e+05, 3.9749e+05, 3.9752e+05, 3.9756e+05],
        [7.6686e+05, 3.8692e+05, 3.8685e+05, 7.8016e+05, 3.8687e+05, 7.7023e+05,
         0.0000e+00, 7.4885e+05, 3.8681e+05, 3.8680e+05, 7.8116e+05, 3.8683e+05,
         3.8686e+05, 7.6780e+05, 3.8684e+05, 3.8684e+05, 3.8683e+05],
        [7.5377e+05, 3.6943e+05, 3.6946e+05, 7.5524e+05, 3.6942e+05, 7.6972e+05,
         7.4885e+05, 0.0000e+00, 3.6948e+05, 3.6946e+05, 7.7306e+05, 3.6945e+05,
         3.6945e+05, 7.6930e+05, 3.6943e+05, 3.6945e+05, 3.6945e+05],
        [3.8818e+05, 3.7379e+00, 3.5090e+00, 3.8773e+05, 3.5886e+00, 3.9751e+05,
         3.8681e+05, 3.6948e+05, 0.0000e+00, 3.4527e+00, 4.0365e+05, 3.8497e+00,
         3.7798e+00, 3.9457e+05, 3.7289e+00, 3.5957e+00, 3.6238e+00],
        [3.8818e+05, 3.6609e+00, 3.7501e+00, 3.8775e+05, 3.7196e+00, 3.9750e+05,
         3.8680e+05, 3.6946e+05, 3.4527e+00, 0.0000e+00, 4.0365e+05, 3.9182e+00,
         3.8750e+00, 3.9456e+05, 3.7933e+00, 3.7611e+00, 3.3984e+00],
        [7.9318e+05, 4.0364e+05, 4.0369e+05, 7.9410e+05, 4.0365e+05, 8.1254e+05,
         7.8116e+05, 7.7306e+05, 4.0365e+05, 4.0365e+05, 0.0000e+00, 4.0365e+05,
         4.0361e+05, 7.9262e+05, 4.0365e+05, 4.0367e+05, 4.0361e+05],
        [3.8820e+05, 3.9538e+00, 3.8532e+00, 3.8779e+05, 3.9581e+00, 3.9749e+05,
         3.8683e+05, 3.6945e+05, 3.8497e+00, 3.9182e+00, 4.0365e+05, 0.0000e+00,
         4.5935e+00, 3.9455e+05, 3.8197e+00, 3.5720e+00, 3.5521e+00],
        [3.8824e+05, 3.9754e+00, 3.7275e+00, 3.8776e+05, 4.6640e+00, 3.9750e+05,
         3.8686e+05, 3.6945e+05, 3.7798e+00, 3.8750e+00, 4.0361e+05, 4.5935e+00,
         0.0000e+00, 3.9450e+05, 4.2251e+00, 4.3208e+00, 4.1912e+00],
        [7.8770e+05, 3.9455e+05, 3.9457e+05, 7.7388e+05, 3.9456e+05, 7.9005e+05,
         7.6780e+05, 7.6930e+05, 3.9457e+05, 3.9456e+05, 7.9262e+05, 3.9455e+05,
         3.9450e+05, 0.0000e+00, 3.9457e+05, 3.9457e+05, 3.9457e+05],
        [3.8815e+05, 3.7732e+00, 3.7543e+00, 3.8772e+05, 3.8752e+00, 3.9749e+05,
         3.8684e+05, 3.6943e+05, 3.7289e+00, 3.7933e+00, 4.0365e+05, 3.8197e+00,
         4.2251e+00, 3.9457e+05, 0.0000e+00, 3.8761e+00, 3.6292e+00],
        [3.8815e+05, 3.9158e+00, 3.7321e+00, 3.8775e+05, 3.9499e+00, 3.9752e+05,
         3.8684e+05, 3.6945e+05, 3.5957e+00, 3.7611e+00, 4.0367e+05, 3.5720e+00,
         4.3208e+00, 3.9457e+05, 3.8761e+00, 0.0000e+00, 3.3746e+00],
        [3.8815e+05, 3.4448e+00, 3.7485e+00, 3.8774e+05, 3.6992e+00, 3.9756e+05,
         3.8683e+05, 3.6945e+05, 3.6238e+00, 3.3984e+00, 4.0361e+05, 3.5521e+00,
         4.1912e+00, 3.9457e+05, 3.6292e+00, 3.3746e+00, 0.0000e+00]])
Krum scores: ['388167.28', '3.74', '3.69', '387739.31', '3.84', '397499.41', '386832.47', '369441.75', '3.63', '3.68', '403637.03', '3.81', '4.09', '394552.66', '3.78', '3.72', '3.56']
Selected index: 16
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']], selected_client_indices: [18, 4, 1, 16, 5, 19, 20, 17, 11, 2, 15, 8, 9, 13, 12, 6, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0036s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:38...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[125 112]
 [144 119]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:38, End: 2025-07-22 15:47:38)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [9, 5], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
tensor([[0.0000, 4.4962],
        [4.4962, 0.0000]])
Krum scores: ['nan', 'nan']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']], selected_client_indices: [9, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0009s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:39...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[120 117]
 [141 122]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:39, End: 2025-07-22 15:47:39)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [8, 13, 10, 7, 14, 20, 15, 16, 1, 18, 12, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 4.0091e+05, 3.6155e+00, 4.1447e+00, 4.0059e+05, 4.0337e+05,
         3.9040e+05, 3.8237e+05, 3.8800e+00, 3.8622e+05, 3.9514e+00, 3.5757e+00],
        [4.0091e+05, 0.0000e+00, 4.0088e+05, 4.0089e+05, 7.8904e+05, 8.0214e+05,
         7.9311e+05, 7.7804e+05, 4.0094e+05, 7.7543e+05, 4.0086e+05, 4.0087e+05],
        [3.6155e+00, 4.0088e+05, 0.0000e+00, 3.4828e+00, 4.0067e+05, 4.0334e+05,
         3.9038e+05, 3.8234e+05, 3.7660e+00, 3.8623e+05, 3.6844e+00, 3.4586e+00],
        [4.1447e+00, 4.0089e+05, 3.4828e+00, 0.0000e+00, 4.0065e+05, 4.0342e+05,
         3.9041e+05, 3.8237e+05, 3.8696e+00, 3.8624e+05, 4.1536e+00, 4.0437e+00],
        [4.0059e+05, 7.8904e+05, 4.0067e+05, 4.0065e+05, 0.0000e+00, 7.9718e+05,
         7.9855e+05, 8.0946e+05, 4.0066e+05, 7.8983e+05, 4.0063e+05, 4.0066e+05],
        [4.0337e+05, 8.0214e+05, 4.0334e+05, 4.0342e+05, 7.9718e+05, 0.0000e+00,
         7.8057e+05, 7.9418e+05, 4.0337e+05, 7.8842e+05, 4.0339e+05, 4.0336e+05],
        [3.9040e+05, 7.9311e+05, 3.9038e+05, 3.9041e+05, 7.9855e+05, 7.8057e+05,
         0.0000e+00, 7.9744e+05, 3.9047e+05, 7.5478e+05, 3.9040e+05, 3.9041e+05],
        [3.8237e+05, 7.7804e+05, 3.8234e+05, 3.8237e+05, 8.0946e+05, 7.9418e+05,
         7.9744e+05, 0.0000e+00, 3.8234e+05, 7.5910e+05, 3.8240e+05, 3.8236e+05],
        [3.8800e+00, 4.0094e+05, 3.7660e+00, 3.8696e+00, 4.0066e+05, 4.0337e+05,
         3.9047e+05, 3.8234e+05, 0.0000e+00, 3.8624e+05, 3.7910e+00, 3.6433e+00],
        [3.8622e+05, 7.7543e+05, 3.8623e+05, 3.8624e+05, 7.8983e+05, 7.8842e+05,
         7.5478e+05, 7.5910e+05, 3.8624e+05, 0.0000e+00, 3.8627e+05, 3.8626e+05],
        [3.9514e+00, 4.0086e+05, 3.6844e+00, 4.1536e+00, 4.0063e+05, 4.0339e+05,
         3.9040e+05, 3.8240e+05, 3.7910e+00, 3.8627e+05, 0.0000e+00, 3.8446e+00],
        [3.5757e+00, 4.0087e+05, 3.4586e+00, 4.0437e+00, 4.0066e+05, 4.0336e+05,
         3.9041e+05, 3.8236e+05, 3.6433e+00, 3.8626e+05, 3.8446e+00, 0.0000e+00]])
Krum scores: ['3.76', '400877.25', '3.56', '3.89', '400630.78', '403361.72', '390398.09', '382353.44', '3.77', '386233.31', '3.82', '3.63']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [8, 13, 10, 7, 14, 20, 15, 16, 1, 18, 12, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0052s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:39...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[119 118]
 [141 122]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:39, End: 2025-07-22 15:47:39)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [16, 2, 4, 19, 6, 15, 12, 10, 7], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
tensor([[0.0000e+00, 3.8660e+05, 3.8664e+05, 7.8526e+05, 3.8666e+05, 7.6109e+05,
         3.8667e+05, 3.8665e+05, 3.8664e+05],
        [3.8660e+05, 0.0000e+00, 3.5837e+00, 3.9004e+05, 3.6715e+00, 3.9333e+05,
         3.7184e+00, 3.3566e+00, 3.7144e+00],
        [3.8664e+05, 3.5837e+00, 0.0000e+00, 3.9012e+05, 3.7627e+00, 3.9333e+05,
         3.8184e+00, 3.6122e+00, 3.8806e+00],
        [7.8526e+05, 3.9004e+05, 3.9012e+05, 0.0000e+00, 3.9005e+05, 7.7658e+05,
         3.9011e+05, 3.9007e+05, 3.9007e+05],
        [3.8666e+05, 3.6715e+00, 3.7627e+00, 3.9005e+05, 0.0000e+00, 3.9336e+05,
         3.7977e+00, 3.5106e+00, 4.1145e+00],
        [7.6109e+05, 3.9333e+05, 3.9333e+05, 7.7658e+05, 3.9336e+05, 0.0000e+00,
         3.9329e+05, 3.9331e+05, 3.9329e+05],
        [3.8667e+05, 3.7184e+00, 3.8184e+00, 3.9011e+05, 3.7977e+00, 3.9329e+05,
         0.0000e+00, 3.7989e+00, 4.2345e+00],
        [3.8665e+05, 3.3566e+00, 3.6122e+00, 3.9007e+05, 3.5106e+00, 3.9331e+05,
         3.7989e+00, 0.0000e+00, 3.5094e+00],
        [3.8664e+05, 3.7144e+00, 3.8806e+00, 3.9007e+05, 4.1145e+00, 3.9329e+05,
         4.2345e+00, 3.5094e+00, 0.0000e+00]])
Krum scores: ['386632.69', '3.58', '3.69', '390053.84', '3.69', '393303.41', '3.78', '3.50', '3.80']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']], selected_client_indices: [16, 2, 4, 19, 6, 15, 12, 10, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0019s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:39...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[117 120]
 [140 123]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:39, End: 2025-07-22 15:47:39)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [18, 17, 1, 7, 10, 5, 11, 8, 15, 16, 4, 3], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 7.8422e+05, 3.9789e+05, 3.9784e+05, 3.9792e+05, 3.9783e+05,
         3.9789e+05, 3.9791e+05, 7.9339e+05, 7.7212e+05, 3.9784e+05, 3.9785e+05],
        [7.8422e+05, 0.0000e+00, 3.8568e+05, 3.8561e+05, 3.8565e+05, 3.8563e+05,
         3.8564e+05, 3.8563e+05, 7.7279e+05, 7.9210e+05, 3.8565e+05, 3.8567e+05],
        [3.9789e+05, 3.8568e+05, 0.0000e+00, 3.9277e+00, 3.8726e+00, 4.0901e+00,
         3.7317e+00, 3.9193e+00, 3.8798e+05, 3.8609e+05, 3.4136e+00, 3.6589e+00],
        [3.9784e+05, 3.8561e+05, 3.9277e+00, 0.0000e+00, 3.4827e+00, 4.2027e+00,
         3.9658e+00, 4.2542e+00, 3.8799e+05, 3.8612e+05, 3.8535e+00, 3.3776e+00],
        [3.9792e+05, 3.8565e+05, 3.8726e+00, 3.4827e+00, 0.0000e+00, 3.8142e+00,
         3.7044e+00, 3.6643e+00, 3.8799e+05, 3.8607e+05, 3.6078e+00, 3.5032e+00],
        [3.9783e+05, 3.8563e+05, 4.0901e+00, 4.2027e+00, 3.8142e+00, 0.0000e+00,
         3.6844e+00, 4.1123e+00, 3.8798e+05, 3.8607e+05, 4.0811e+00, 3.9824e+00],
        [3.9789e+05, 3.8564e+05, 3.7317e+00, 3.9658e+00, 3.7044e+00, 3.6844e+00,
         0.0000e+00, 4.0373e+00, 3.8802e+05, 3.8604e+05, 3.9174e+00, 4.0511e+00],
        [3.9791e+05, 3.8563e+05, 3.9193e+00, 4.2542e+00, 3.6643e+00, 4.1123e+00,
         4.0373e+00, 0.0000e+00, 3.8800e+05, 3.8603e+05, 3.9954e+00, 3.9889e+00],
        [7.9339e+05, 7.7279e+05, 3.8798e+05, 3.8799e+05, 3.8799e+05, 3.8798e+05,
         3.8802e+05, 3.8800e+05, 0.0000e+00, 7.7055e+05, 3.8797e+05, 3.8797e+05],
        [7.7212e+05, 7.9210e+05, 3.8609e+05, 3.8612e+05, 3.8607e+05, 3.8607e+05,
         3.8604e+05, 3.8603e+05, 7.7055e+05, 0.0000e+00, 3.8607e+05, 3.8610e+05],
        [3.9784e+05, 3.8565e+05, 3.4136e+00, 3.8535e+00, 3.6078e+00, 4.0811e+00,
         3.9174e+00, 3.9954e+00, 3.8797e+05, 3.8607e+05, 0.0000e+00, 3.5186e+00],
        [3.9785e+05, 3.8567e+05, 3.6589e+00, 3.3776e+00, 3.5032e+00, 3.9824e+00,
         4.0511e+00, 3.9889e+00, 3.8797e+05, 3.8610e+05, 3.5186e+00, 0.0000e+00]])
Krum scores: ['397855.44', '385633.00', '3.75', '3.80', '3.63', '3.96', '3.84', '3.95', '387978.56', '386061.66', '3.72', '3.67']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [18, 17, 1, 7, 10, 5, 11, 8, 15, 16, 4, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0317s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:40...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[116 121]
 [140 123]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:40, End: 2025-07-22 15:47:40)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [17, 15, 8, 18, 13, 5, 7, 6, 19, 16, 20, 11, 12, 10, 9, 14, 2, 4], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 7.9990e+05, 3.8726e+05, 7.6669e+05, 7.7851e+05, 3.8716e+05,
         3.8721e+05, 3.8724e+05, 7.7469e+05, 7.9066e+05, 7.8144e+05, 3.8718e+05,
         3.8724e+05, 3.8725e+05, 3.8723e+05, 7.7671e+05, 3.8719e+05, 3.8728e+05],
        [7.9990e+05, 0.0000e+00, 3.9804e+05, 8.2044e+05, 7.6978e+05, 3.9805e+05,
         3.9806e+05, 3.9808e+05, 7.9713e+05, 8.1698e+05, 7.9444e+05, 3.9808e+05,
         3.9804e+05, 3.9805e+05, 3.9805e+05, 7.9808e+05, 3.9800e+05, 3.9807e+05],
        [3.8726e+05, 3.9804e+05, 0.0000e+00, 4.0480e+05, 3.8619e+05, 4.0620e+00,
         4.3243e+00, 3.6646e+00, 3.8786e+05, 3.9437e+05, 4.0255e+05, 3.9635e+00,
         4.0139e+00, 3.7429e+00, 4.7190e+00, 3.8482e+05, 3.9674e+00, 4.0566e+00],
        [7.6669e+05, 8.2044e+05, 4.0480e+05, 0.0000e+00, 7.9299e+05, 4.0481e+05,
         4.0475e+05, 4.0478e+05, 7.6847e+05, 7.9423e+05, 8.2624e+05, 4.0479e+05,
         4.0483e+05, 4.0482e+05, 4.0479e+05, 8.0039e+05, 4.0478e+05, 4.0476e+05],
        [7.7851e+05, 7.6978e+05, 3.8619e+05, 7.9299e+05, 0.0000e+00, 3.8619e+05,
         3.8615e+05, 3.8616e+05, 7.6877e+05, 7.9170e+05, 7.9330e+05, 3.8619e+05,
         3.8623e+05, 3.8615e+05, 3.8617e+05, 7.8268e+05, 3.8616e+05, 3.8615e+05],
        [3.8716e+05, 3.9805e+05, 4.0620e+00, 4.0481e+05, 3.8619e+05, 0.0000e+00,
         4.1902e+00, 3.9273e+00, 3.8779e+05, 3.9439e+05, 4.0257e+05, 3.6620e+00,
         3.8666e+00, 3.8770e+00, 4.6863e+00, 3.8482e+05, 3.8650e+00, 4.0732e+00],
        [3.8721e+05, 3.9806e+05, 4.3243e+00, 4.0475e+05, 3.8615e+05, 4.1902e+00,
         0.0000e+00, 4.1674e+00, 3.8785e+05, 3.9434e+05, 4.0259e+05, 3.8746e+00,
         4.3375e+00, 3.5878e+00, 4.4826e+00, 3.8482e+05, 3.7371e+00, 3.9030e+00],
        [3.8724e+05, 3.9808e+05, 3.6646e+00, 4.0478e+05, 3.8616e+05, 3.9273e+00,
         4.1674e+00, 0.0000e+00, 3.8778e+05, 3.9436e+05, 4.0260e+05, 3.5866e+00,
         3.7767e+00, 3.5546e+00, 4.5020e+00, 3.8483e+05, 3.6197e+00, 3.6979e+00],
        [7.7469e+05, 7.9713e+05, 3.8786e+05, 7.6847e+05, 7.6877e+05, 3.8779e+05,
         3.8785e+05, 3.8778e+05, 0.0000e+00, 7.7290e+05, 8.1466e+05, 3.8776e+05,
         3.8781e+05, 3.8782e+05, 3.8787e+05, 7.6905e+05, 3.8774e+05, 3.8778e+05],
        [7.9066e+05, 8.1698e+05, 3.9437e+05, 7.9423e+05, 7.9170e+05, 3.9439e+05,
         3.9434e+05, 3.9436e+05, 7.7290e+05, 0.0000e+00, 7.8153e+05, 3.9437e+05,
         3.9435e+05, 3.9433e+05, 3.9439e+05, 7.8987e+05, 3.9435e+05, 3.9431e+05],
        [7.8144e+05, 7.9444e+05, 4.0255e+05, 8.2624e+05, 7.9330e+05, 4.0257e+05,
         4.0259e+05, 4.0260e+05, 8.1466e+05, 7.8153e+05, 0.0000e+00, 4.0257e+05,
         4.0258e+05, 4.0261e+05, 4.0257e+05, 7.9311e+05, 4.0263e+05, 4.0262e+05],
        [3.8718e+05, 3.9808e+05, 3.9635e+00, 4.0479e+05, 3.8619e+05, 3.6620e+00,
         3.8746e+00, 3.5866e+00, 3.8776e+05, 3.9437e+05, 4.0257e+05, 0.0000e+00,
         3.8343e+00, 3.7375e+00, 3.9331e+00, 3.8486e+05, 3.5393e+00, 3.9695e+00],
        [3.8724e+05, 3.9804e+05, 4.0139e+00, 4.0483e+05, 3.8623e+05, 3.8666e+00,
         4.3375e+00, 3.7767e+00, 3.8781e+05, 3.9435e+05, 4.0258e+05, 3.8343e+00,
         0.0000e+00, 3.8336e+00, 4.5207e+00, 3.8486e+05, 3.6893e+00, 3.8768e+00],
        [3.8725e+05, 3.9805e+05, 3.7429e+00, 4.0482e+05, 3.8615e+05, 3.8770e+00,
         3.5878e+00, 3.5546e+00, 3.8782e+05, 3.9433e+05, 4.0261e+05, 3.7375e+00,
         3.8336e+00, 0.0000e+00, 4.3072e+00, 3.8480e+05, 3.4753e+00, 3.6986e+00],
        [3.8723e+05, 3.9805e+05, 4.7190e+00, 4.0479e+05, 3.8617e+05, 4.6863e+00,
         4.4826e+00, 4.5020e+00, 3.8787e+05, 3.9439e+05, 4.0257e+05, 3.9331e+00,
         4.5207e+00, 4.3072e+00, 0.0000e+00, 3.8482e+05, 4.0411e+00, 4.5568e+00],
        [7.7671e+05, 7.9808e+05, 3.8482e+05, 8.0039e+05, 7.8268e+05, 3.8482e+05,
         3.8482e+05, 3.8483e+05, 7.6905e+05, 7.8987e+05, 7.9311e+05, 3.8486e+05,
         3.8486e+05, 3.8480e+05, 3.8482e+05, 0.0000e+00, 3.8490e+05, 3.8481e+05],
        [3.8719e+05, 3.9800e+05, 3.9674e+00, 4.0478e+05, 3.8616e+05, 3.8650e+00,
         3.7371e+00, 3.6197e+00, 3.8774e+05, 3.9435e+05, 4.0263e+05, 3.5393e+00,
         3.6893e+00, 3.4753e+00, 4.0411e+00, 3.8490e+05, 0.0000e+00, 3.6423e+00],
        [3.8728e+05, 3.9807e+05, 4.0566e+00, 4.0476e+05, 3.8615e+05, 4.0732e+00,
         3.9030e+00, 3.6979e+00, 3.8778e+05, 3.9431e+05, 4.0262e+05, 3.9695e+00,
         3.8768e+00, 3.6986e+00, 4.5568e+00, 3.8481e+05, 3.6423e+00, 0.0000e+00]])
Krum scores: ['387213.41', '398044.62', '3.97', '404781.69', '386162.69', '3.94', '4.02', '3.75', '387791.44', '394345.91', '402581.59', '3.77', '3.90', '3.69', '4.38', '384823.38', '3.69', '3.86']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [17, 15, 8, 18, 13, 5, 7, 6, 19, 16, 20, 11, 12, 10, 9, 14, 2, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:40...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[115 122]
 [136 127]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:40, End: 2025-07-22 15:47:40)
start time is: 98231151394536, end time is: 98242756227435
The total time is: 11604832899ns.

 ------- aggregate method: mean, random_seed: 0 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [18, 20, 15, 6, 19, 17, 2, 9, 10, 3, 1, 16, 4], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [18, 20, 15, 6, 19, 17, 2, 9, 10, 3, 1, 16, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:41...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 90 147]
 [ 95 168]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:47:41, End: 2025-07-22 15:47:41)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [9, 16, 15, 13, 1, 20, 11, 5, 14, 3], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [9, 16, 15, 13, 1, 20, 11, 5, 14, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:41...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [199  64]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:41, End: 2025-07-22 15:47:41)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [8, 16, 11, 18, 14, 1, 19, 12, 15, 10, 6, 13, 9, 7, 5, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 16, 11, 18, 14, 1, 19, 12, 15, 10, 6, 13, 9, 7, 5, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:42...
global Accuracy on shared test data: 46.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[161  76]
 [190  73]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:42, End: 2025-07-22 15:47:42)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [2, 7, 19], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']], selected_client_indices: [2, 7, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:42...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[125 112]
 [142 121]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:42, End: 2025-07-22 15:47:42)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [10, 14, 4, 17, 13, 16, 2, 8, 15, 19, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [10, 14, 4, 17, 13, 16, 2, 8, 15, 19, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0083s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:42...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [107 156]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:42, End: 2025-07-22 15:47:42)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [14, 6, 19], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']], selected_client_indices: [14, 6, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0003s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:43...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[218  19]
 [234  29]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:43, End: 2025-07-22 15:47:43)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (4): [1, 8, 13, 16], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 4
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([4])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']], selected_client_indices: [1, 8, 13, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:43...
global Accuracy on shared test data: 50.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[156  81]
 [168  95]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:43, End: 2025-07-22 15:47:43)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 8, 17, 1, 5, 20, 6, 2, 12, 3, 18, 16, 9, 19, 11, 13, 7, 4], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 8, 17, 1, 5, 20, 6, 2, 12, 3, 18, 16, 9, 19, 11, 13, 7, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:44...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [189  74]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:44, End: 2025-07-22 15:47:44)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [19, 4, 12, 9, 6, 5, 7, 20, 11], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [19, 4, 12, 9, 6, 5, 7, 20, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:44...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [174  89]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:44, End: 2025-07-22 15:47:44)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [2, 6, 15, 12, 10, 18, 16, 14, 1, 17, 11, 9, 19, 5, 3, 4, 7, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [2, 6, 15, 12, 10, 18, 16, 14, 1, 17, 11, 9, 19, 5, 3, 4, 7, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:45...
global Accuracy on shared test data: 51.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [173  90]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:45, End: 2025-07-22 15:47:45)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [16, 19, 14, 17, 10, 7, 11, 9, 20, 13, 3, 4, 1, 8, 5, 12, 18, 15, 2, 6], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [16, 19, 14, 17, 10, 7, 11, 9, 20, 13, 3, 4, 1, 8, 5, 12, 18, 15, 2, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0038s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:45...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[148  89]
 [152 111]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:45, End: 2025-07-22 15:47:45)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [8, 4, 7, 16, 17, 1, 18, 5, 20, 19, 11, 3, 2, 13, 9, 14, 10, 15, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [8, 4, 7, 16, 17, 1, 18, 5, 20, 19, 11, 3, 2, 13, 9, 14, 10, 15, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0119s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:46...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[140  97]
 [139 124]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:46, End: 2025-07-22 15:47:46)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [17, 20, 7, 18, 16, 6, 9, 12, 19, 2, 5, 3, 13, 14, 8, 1], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [17, 20, 7, 18, 16, 6, 9, 12, 19, 2, 5, 3, 13, 14, 8, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0016s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:47...
global Accuracy on shared test data: 54.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [ 94 169]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:47, End: 2025-07-22 15:47:47)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [20, 16, 2, 17, 15, 3, 11, 10, 1, 4, 12, 7, 14, 6, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [20, 16, 2, 17, 15, 3, 11, 10, 1, 4, 12, 7, 14, 6, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:47...
global Accuracy on shared test data: 53.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[108 129]
 [104 159]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:47, End: 2025-07-22 15:47:47)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [6, 15, 16, 5, 3, 7, 10, 14, 17, 1, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [6, 15, 16, 5, 3, 7, 10, 14, 17, 1, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:48...
global Accuracy on shared test data: 53.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[132 105]
 [130 133]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:48, End: 2025-07-22 15:47:48)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [11, 2, 15, 9, 7, 10, 13, 20, 3, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [11, 2, 15, 9, 7, 10, 13, 20, 3, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0011s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:48...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[164  73]
 [177  86]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:48, End: 2025-07-22 15:47:48)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [15, 9, 10, 19, 11, 1, 12, 14, 3, 5, 2, 4, 18, 16, 6, 17, 7, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [15, 9, 10, 19, 11, 1, 12, 14, 3, 5, 2, 4, 18, 16, 6, 17, 7, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0178s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:49...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [198  65]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:49, End: 2025-07-22 15:47:49)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [17, 14, 3, 10, 6, 12, 19, 13, 11, 5, 1, 2, 7, 16, 8, 9, 15, 4, 18, 20], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [17, 14, 3, 10, 6, 12, 19, 13, 11, 5, 1, 2, 7, 16, 8, 9, 15, 4, 18, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:50...
global Accuracy on shared test data: 50.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[153  84]
 [165  98]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:50, End: 2025-07-22 15:47:50)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [4, 15, 3, 5, 19, 6, 12, 1, 7, 11, 10, 8, 9, 17, 16], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [4, 15, 3, 5, 19, 6, 12, 1, 7, 11, 10, 8, 9, 17, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:50...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [186  77]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:47:50, End: 2025-07-22 15:47:50)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [18, 17], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
mean, clients_type: [['Update 0']
 ['Update 1']], selected_client_indices: [18, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:50...
global Accuracy on shared test data: 44.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[199  38]
 [242  21]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:50, End: 2025-07-22 15:47:50)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [4, 9, 7, 2, 18, 3, 8, 16, 19, 11, 15, 20, 6, 14, 12, 1, 13, 5], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [4, 9, 7, 2, 18, 3, 8, 16, 19, 11, 15, 20, 6, 14, 12, 1, 13, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0031s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:51...
global Accuracy on shared test data: 44.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[195  42]
 [237  26]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:51, End: 2025-07-22 15:47:51)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (6): [16, 19, 2, 4, 7, 9], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 6
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([6])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']], selected_client_indices: [16, 19, 2, 4, 7, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:51...
global Accuracy on shared test data: 46.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[156  81]
 [187  76]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:51, End: 2025-07-22 15:47:51)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [16, 15, 9, 6, 11, 20, 18, 4, 8, 7, 14, 1, 13, 3, 2], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [16, 15, 9, 6, 11, 20, 18, 4, 8, 7, 14, 1, 13, 3, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:52...
global Accuracy on shared test data: 45.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [216  47]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:52, End: 2025-07-22 15:47:52)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 11, 20, 19, 5, 13, 17, 3, 15, 4, 16, 18, 9, 7, 8, 2, 6, 10], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 11, 20, 19, 5, 13, 17, 3, 15, 4, 16, 18, 9, 7, 8, 2, 6, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0096s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:52...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [215  48]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:52, End: 2025-07-22 15:47:52)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [11, 4, 14, 20, 6, 9, 12, 18, 1, 5, 3], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [11, 4, 14, 20, 6, 9, 12, 18, 1, 5, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:53...
global Accuracy on shared test data: 45.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[137 100]
 [171  92]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:53, End: 2025-07-22 15:47:53)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [8, 9, 1, 16, 19, 11, 6, 7, 12, 4, 15, 20, 5], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [8, 9, 1, 16, 19, 11, 6, 7, 12, 4, 15, 20, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0078s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:53...
global Accuracy on shared test data: 44.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[156  81]
 [196  67]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:53, End: 2025-07-22 15:47:53)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [14, 1, 18, 16, 6, 15, 10, 8, 3, 11, 20, 2, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [14, 1, 18, 16, 6, 15, 10, 8, 3, 11, 20, 2, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0049s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:54...
global Accuracy on shared test data: 43.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [211  52]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:54, End: 2025-07-22 15:47:54)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [18, 20, 1, 14, 9, 5, 4, 6, 8, 17, 12, 11, 15, 10, 3, 2], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [18, 20, 1, 14, 9, 5, 4, 6, 8, 17, 12, 11, 15, 10, 3, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0185s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:55...
global Accuracy on shared test data: 44.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [203  60]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:55, End: 2025-07-22 15:47:55)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [2, 7], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
mean, clients_type: [['Update 0']
 ['Update 1']], selected_client_indices: [2, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:55...
global Accuracy on shared test data: 43.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[154  83]
 [198  65]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:55, End: 2025-07-22 15:47:55)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (4): [2, 8, 6, 1], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 4
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([4])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']], selected_client_indices: [2, 8, 6, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:55...
global Accuracy on shared test data: 44.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[149  88]
 [188  75]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:55, End: 2025-07-22 15:47:55)
start time is: 98242756232845, end time is: 98257485360101
The total time is: 14729127256ns.

 ------- aggregate method: mean, random_seed: 100 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [5, 13, 3, 2, 11], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']], selected_client_indices: [5, 13, 3, 2, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:56...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [204  59]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:56, End: 2025-07-22 15:47:56)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [6, 16, 8, 12, 4, 11, 10, 9, 7, 14, 13, 3, 1, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [6, 16, 8, 12, 4, 11, 10, 9, 7, 14, 13, 3, 1, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0014s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:56...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[103 134]
 [112 151]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:56, End: 2025-07-22 15:47:56)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [3, 9, 17, 11, 6, 14, 8], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [3, 9, 17, 11, 6, 14, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:56...
global Accuracy on shared test data: 56.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 85 152]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:56, End: 2025-07-22 15:47:56)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [2, 5, 8, 15, 13, 4, 18], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [2, 5, 8, 15, 13, 4, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:57...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[207  30]
 [229  34]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:57, End: 2025-07-22 15:47:57)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (4): [3, 7, 2, 9], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 4
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([4])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']], selected_client_indices: [3, 7, 2, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:57...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[187  50]
 [211  52]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:57, End: 2025-07-22 15:47:57)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [3, 17, 13, 7, 10, 19, 2, 14, 12, 4, 1, 15, 6, 9, 20, 11, 18, 16, 8], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [3, 17, 13, 7, 10, 19, 2, 14, 12, 4, 1, 15, 6, 9, 20, 11, 18, 16, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0157s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:58...
global Accuracy on shared test data: 55.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[143  94]
 [128 135]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:47:58, End: 2025-07-22 15:47:58)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [14, 8, 11, 19, 2, 6, 7, 20, 9, 13, 17, 12, 16, 1, 3, 10, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [14, 8, 11, 19, 2, 6, 7, 20, 9, 13, 17, 12, 16, 1, 3, 10, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:58...
global Accuracy on shared test data: 53.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 20 217]
 [ 16 247]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:58, End: 2025-07-22 15:47:58)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [15, 9, 20, 14, 3, 7, 2, 12, 11, 8, 5, 16, 18, 10, 17, 6, 4, 19, 13], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [15, 9, 20, 14, 3, 7, 2, 12, 11, 8, 5, 16, 18, 10, 17, 6, 4, 19, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0007s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:59...
global Accuracy on shared test data: 53.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 27 210]
 [ 22 241]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:47:59, End: 2025-07-22 15:47:59)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [16], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
mean, clients_type: [['Update 0']], selected_client_indices: [16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0002s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:47:59...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[193  44]
 [207  56]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:47:59, End: 2025-07-22 15:47:59)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [17, 6, 16, 13, 20, 12, 11, 19, 5, 14, 4, 10, 7, 3, 8, 2], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [17, 6, 16, 13, 20, 12, 11, 19, 5, 14, 4, 10, 7, 3, 8, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0182s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:00...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[194  43]
 [207  56]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:48:00, End: 2025-07-22 15:48:00)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [19, 20], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
mean, clients_type: [['Update 0']
 ['Update 1']], selected_client_indices: [19, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0003s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:00...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[218  19]
 [236  27]]
Function 'evaluate_global_model' executed in 0.0019 seconds (Start: 2025-07-22 15:48:00, End: 2025-07-22 15:48:00)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [10, 3, 16, 20, 9, 8, 14], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [10, 3, 16, 20, 9, 8, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:00...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[211  26]
 [231  32]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:00, End: 2025-07-22 15:48:00)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [16, 15, 4], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']], selected_client_indices: [16, 15, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:00...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[220  17]
 [239  24]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:00, End: 2025-07-22 15:48:00)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [20, 8, 18, 19, 5, 3, 11, 10, 15, 16, 1, 9, 17], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [20, 8, 18, 19, 5, 3, 11, 10, 15, 16, 1, 9, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0056s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:01...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[225  12]
 [245  18]]
Function 'evaluate_global_model' executed in 0.0025 seconds (Start: 2025-07-22 15:48:01, End: 2025-07-22 15:48:01)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [17, 18, 4, 15, 2], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']], selected_client_indices: [17, 18, 4, 15, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:01...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[228   9]
 [258   5]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:01, End: 2025-07-22 15:48:01)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [16, 17, 10, 20, 2, 9, 7, 5, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [16, 17, 10, 20, 2, 9, 7, 5, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:01...
global Accuracy on shared test data: 47.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[229   8]
 [257   6]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:01, End: 2025-07-22 15:48:01)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [7, 8], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
mean, clients_type: [['Update 0']
 ['Update 1']], selected_client_indices: [7, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:02...
global Accuracy on shared test data: 46.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[226  11]
 [255   8]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:02, End: 2025-07-22 15:48:02)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [10, 2, 7, 4, 13, 9, 14, 18, 11, 12], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [10, 2, 7, 4, 13, 9, 14, 18, 11, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:02...
global Accuracy on shared test data: 47.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[224  13]
 [251  12]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:02, End: 2025-07-22 15:48:02)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [4], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
mean, clients_type: [['Update 0']], selected_client_indices: [4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0003s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:02...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[221  16]
 [251  12]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:02, End: 2025-07-22 15:48:02)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [11, 14, 5, 20, 3, 8, 6, 7, 13, 1, 19, 15, 4, 18, 12, 2, 9, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [11, 14, 5, 20, 3, 8, 6, 7, 13, 1, 19, 15, 4, 18, 12, 2, 9, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0081s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:03...
global Accuracy on shared test data: 47.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[226  11]
 [251  12]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:48:03, End: 2025-07-22 15:48:03)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [2, 3, 13, 8, 5, 16, 19, 4, 1, 11, 15, 9, 20, 12, 18, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [2, 3, 13, 8, 5, 16, 19, 4, 1, 11, 15, 9, 20, 12, 18, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:04...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[223  14]
 [246  17]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:04, End: 2025-07-22 15:48:04)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [12, 6, 16, 1, 9, 18, 20, 13, 2, 8, 7, 17, 10, 14, 3, 4, 11, 15, 19], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [12, 6, 16, 1, 9, 18, 20, 13, 2, 8, 7, 17, 10, 14, 3, 4, 11, 15, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:04...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[226  11]
 [246  17]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:04, End: 2025-07-22 15:48:04)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [18, 7, 9, 19, 16, 11, 20, 8, 14, 5, 13, 15, 4, 1, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [18, 7, 9, 19, 16, 11, 20, 8, 14, 5, 13, 15, 4, 1, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:05...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[228   9]
 [247  16]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:05, End: 2025-07-22 15:48:05)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [9, 3, 11, 2, 16, 14, 18, 10, 12, 20, 6, 13, 19, 8, 4, 5, 7, 1, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [9, 3, 11, 2, 16, 14, 18, 10, 12, 20, 6, 13, 19, 8, 4, 5, 7, 1, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0118s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:05...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[224  13]
 [241  22]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:05, End: 2025-07-22 15:48:05)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [16, 8, 4, 9, 19, 14, 7, 11, 10, 3, 15, 2, 13, 1, 18, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [16, 8, 4, 9, 19, 14, 7, 11, 10, 3, 15, 2, 13, 1, 18, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0031s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:06...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[221  16]
 [240  23]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:06, End: 2025-07-22 15:48:06)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [13], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
mean, clients_type: [['Update 0']], selected_client_indices: [13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0003s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:06...
global Accuracy on shared test data: 47.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [208  55]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:48:06, End: 2025-07-22 15:48:06)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [6, 16, 3, 20, 10, 19, 11, 7, 13, 12, 8, 1, 18, 15, 4, 2, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [6, 16, 3, 20, 10, 19, 11, 7, 13, 12, 8, 1, 18, 15, 4, 2, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0023s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:07...
global Accuracy on shared test data: 47.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[188  49]
 [215  48]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:07, End: 2025-07-22 15:48:07)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [5, 17, 14, 4, 3, 19, 1, 2, 8, 18], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [5, 17, 14, 4, 3, 19, 1, 2, 8, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:07...
global Accuracy on shared test data: 47.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [213  50]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:07, End: 2025-07-22 15:48:07)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [17, 18, 4, 8, 14], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']], selected_client_indices: [17, 18, 4, 8, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:07...
global Accuracy on shared test data: 45.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [212  51]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:07, End: 2025-07-22 15:48:07)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [17, 14, 15, 9, 16, 10, 2, 7, 19, 8, 4, 5, 18, 13, 6, 11, 1, 12, 3, 20], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [17, 14, 15, 9, 16, 10, 2, 7, 19, 8, 4, 5, 18, 13, 6, 11, 1, 12, 3, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0182s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:08...
global Accuracy on shared test data: 45.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [208  55]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:08, End: 2025-07-22 15:48:08)
start time is: 98257485363186, end time is: 98270504910648
The total time is: 13019547462ns.

 ------- aggregate method: mean, random_seed: 200 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [17, 7], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
mean, clients_type: [['Update 0']
 ['Update 1']], selected_client_indices: [17, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:08...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[104 133]
 [128 135]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:08, End: 2025-07-22 15:48:08)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [13, 15, 7, 5, 3], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']], selected_client_indices: [13, 15, 7, 5, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:09...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 21 216]
 [ 36 227]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:09, End: 2025-07-22 15:48:09)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [5], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
mean, clients_type: [['Update 0']], selected_client_indices: [5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0003s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:09...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 38 199]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:09, End: 2025-07-22 15:48:09)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [5, 13, 10, 17, 16, 9, 11, 18, 6], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [5, 13, 10, 17, 16, 9, 11, 18, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:09...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 50 187]
 [ 74 189]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:09, End: 2025-07-22 15:48:09)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [16, 5, 18, 10, 19, 9, 14, 11, 20, 4, 8, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [16, 5, 18, 10, 19, 9, 14, 11, 20, 4, 8, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0209s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:10...
global Accuracy on shared test data: 45.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[111 126]
 [148 115]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:10, End: 2025-07-22 15:48:10)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [3, 17, 2, 19, 16, 1, 6, 15, 14, 11, 13, 20, 4, 9, 5, 8], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 17, 2, 19, 16, 1, 6, 15, 14, 11, 13, 20, 4, 9, 5, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:10...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[104 133]
 [134 129]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:10, End: 2025-07-22 15:48:10)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [12, 11], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
mean, clients_type: [['Update 0']
 ['Update 1']], selected_client_indices: [12, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:11...
global Accuracy on shared test data: 47.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[117 120]
 [143 120]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:11, End: 2025-07-22 15:48:11)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (6): [19, 5, 1, 8, 17, 20], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 6
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([6])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']], selected_client_indices: [19, 5, 1, 8, 17, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:11...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[133 104]
 [153 110]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:11, End: 2025-07-22 15:48:11)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [14, 15, 8, 11, 4, 18, 5], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [14, 15, 8, 11, 4, 18, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:11...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[140  97]
 [155 108]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:11, End: 2025-07-22 15:48:11)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [6, 11, 13, 7, 9, 15, 16, 19, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [6, 11, 13, 7, 9, 15, 16, 19, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0038s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:12...
global Accuracy on shared test data: 53.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [174  89]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:12, End: 2025-07-22 15:48:12)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [7, 5, 14], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']], selected_client_indices: [7, 5, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:12...
global Accuracy on shared test data: 54.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [ 94 169]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:12, End: 2025-07-22 15:48:12)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (4): [1, 11, 7, 15], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 4
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([4])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']], selected_client_indices: [1, 11, 7, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:12...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 38 199]
 [ 42 221]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:12, End: 2025-07-22 15:48:12)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [15, 16, 10, 7, 18, 12, 8, 19, 5, 6, 11, 13], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [15, 16, 10, 7, 18, 12, 8, 19, 5, 6, 11, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:13...
global Accuracy on shared test data: 54.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 75 162]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:13, End: 2025-07-22 15:48:13)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [4, 1, 2, 20, 7, 19, 8, 9, 12, 5, 18, 13, 15, 16, 14], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [4, 1, 2, 20, 7, 19, 8, 9, 12, 5, 18, 13, 15, 16, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0038s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:13...
global Accuracy on shared test data: 53.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [ 99 164]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:13, End: 2025-07-22 15:48:13)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [3, 7, 18, 15, 10, 19, 1, 6, 8, 2, 16, 4, 12, 5, 11], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [3, 7, 18, 15, 10, 19, 1, 6, 8, 2, 16, 4, 12, 5, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:14...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 94 143]
 [ 95 168]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:14, End: 2025-07-22 15:48:14)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [20, 16, 7, 4, 17, 15, 14, 11, 13, 19, 10, 8, 2, 3, 1], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [20, 16, 7, 4, 17, 15, 14, 11, 13, 19, 10, 8, 2, 3, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:14...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 88 149]
 [ 91 172]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:14, End: 2025-07-22 15:48:14)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [10, 3, 18, 4, 5, 14, 8, 16, 11, 12, 17, 6, 1, 19, 9, 7, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [10, 3, 18, 4, 5, 14, 8, 16, 11, 12, 17, 6, 1, 19, 9, 7, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0141s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:15...
global Accuracy on shared test data: 47.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[139  98]
 [165  98]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:15, End: 2025-07-22 15:48:15)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [6, 5], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
mean, clients_type: [['Update 0']
 ['Update 1']], selected_client_indices: [6, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:15...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[137 100]
 [158 105]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:15, End: 2025-07-22 15:48:15)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [20, 10], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
mean, clients_type: [['Update 0']
 ['Update 1']], selected_client_indices: [20, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:15...
global Accuracy on shared test data: 47.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 59 178]
 [ 86 177]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:15, End: 2025-07-22 15:48:15)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [9, 18, 20, 3, 13, 17, 5, 2, 11, 7, 4, 10, 6, 16, 14, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 18, 20, 3, 13, 17, 5, 2, 11, 7, 4, 10, 6, 16, 14, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0182s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:16...
global Accuracy on shared test data: 44.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 84 153]
 [127 136]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:16, End: 2025-07-22 15:48:16)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (15): [9, 18, 16, 20, 2, 4, 19, 1, 11, 17, 15, 5, 7, 13, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [9, 18, 16, 20, 2, 4, 19, 1, 11, 17, 15, 5, 7, 13, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:17...
global Accuracy on shared test data: 45.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 82 155]
 [116 147]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:17, End: 2025-07-22 15:48:17)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [5, 9, 11, 14, 18, 19, 2, 15, 1, 10, 16, 6, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 9, 11, 14, 18, 19, 2, 15, 1, 10, 16, 6, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:17...
global Accuracy on shared test data: 43.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[133 104]
 [178  85]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:17, End: 2025-07-22 15:48:17)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [8, 11, 3, 14, 18, 13, 16, 4, 17, 6, 1, 12, 2, 9], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [8, 11, 3, 14, 18, 13, 16, 4, 17, 6, 1, 12, 2, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:18...
global Accuracy on shared test data: 44.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[120 117]
 [160 103]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:18, End: 2025-07-22 15:48:18)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [12, 13, 9, 16, 6, 7, 8, 1, 11, 18, 15, 3, 20, 4, 2, 10, 17, 19, 14], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [12, 13, 9, 16, 6, 7, 8, 1, 11, 18, 15, 3, 20, 4, 2, 10, 17, 19, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0082s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:18...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[134 103]
 [164  99]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:18, End: 2025-07-22 15:48:18)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [18, 17, 11, 7, 10, 5, 19, 2, 3], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [18, 17, 11, 7, 10, 5, 19, 2, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0126s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:19...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[147  90]
 [164  99]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:19, End: 2025-07-22 15:48:19)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [9, 11], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
mean, clients_type: [['Update 0']
 ['Update 1']], selected_client_indices: [9, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:19...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[139  98]
 [156 107]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:19, End: 2025-07-22 15:48:19)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [13, 8, 14, 6, 15, 20, 19, 16, 3, 10, 1, 11, 18, 9, 12, 2, 17, 7], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [13, 8, 14, 6, 15, 20, 19, 16, 3, 10, 1, 11, 18, 9, 12, 2, 17, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0016s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:20...
global Accuracy on shared test data: 47.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[109 128]
 [134 129]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:20, End: 2025-07-22 15:48:20)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [11, 17, 18, 4, 6, 13, 20, 14, 1, 9, 19, 5, 15, 8, 2, 12, 16, 7], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [11, 17, 18, 4, 6, 13, 20, 14, 1, 9, 19, 5, 15, 8, 2, 12, 16, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0016s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:20...
global Accuracy on shared test data: 47.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[134 103]
 [162 101]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:20, End: 2025-07-22 15:48:20)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [20, 19, 3, 7, 16, 2, 12, 14, 5, 4], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [20, 19, 3, 7, 16, 2, 12, 14, 5, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0019s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:21...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[122 115]
 [145 118]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:21, End: 2025-07-22 15:48:21)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [9, 2, 13, 5, 7, 11, 20, 3, 12, 16, 4], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [9, 2, 13, 5, 7, 11, 20, 3, 12, 16, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:21...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[192  45]
 [215  48]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:21, End: 2025-07-22 15:48:21)
start time is: 98270504913703, end time is: 98283424360305
The total time is: 12919446602ns.

 ------- aggregate method: mean, random_seed: 300 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [11, 13, 7, 19, 12, 15, 18, 17, 1, 6, 4, 14, 20, 16, 5, 3, 10, 9, 8, 2], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [11, 13, 7, 19, 12, 15, 18, 17, 1, 6, 4, 14, 20, 16, 5, 3, 10, 9, 8, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:22...
global Accuracy on shared test data: 55.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 19 218]
 [  7 256]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:22, End: 2025-07-22 15:48:22)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (20): [6, 13, 20, 4, 1, 9, 14, 15, 8, 2, 5, 3, 7, 10, 17, 19, 11, 16, 12, 18], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [6, 13, 20, 4, 1, 9, 14, 15, 8, 2, 5, 3, 7, 10, 17, 19, 11, 16, 12, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:23...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 17 220]
 [ 20 243]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:23, End: 2025-07-22 15:48:23)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [3, 20, 19, 5, 12, 1, 9, 14, 16, 2, 17, 11, 6, 8, 4, 10, 13, 18, 15], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [3, 20, 19, 5, 12, 1, 9, 14, 16, 2, 17, 11, 6, 8, 4, 10, 13, 18, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0039s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:23...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[100 137]
 [100 163]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:23, End: 2025-07-22 15:48:23)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (8): [11, 12, 2, 9, 4, 18, 7, 6], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 8
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([8])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']], selected_client_indices: [11, 12, 2, 9, 4, 18, 7, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:24...
global Accuracy on shared test data: 53.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [ 97 166]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:24, End: 2025-07-22 15:48:24)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [17, 20, 15, 11, 16, 8, 1, 12, 3, 7, 4, 19, 6, 9], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [17, 20, 15, 11, 16, 8, 1, 12, 3, 7, 4, 19, 6, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0133s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:24...
global Accuracy on shared test data: 55.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 72 165]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:48:24, End: 2025-07-22 15:48:24)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (6): [8, 11, 2, 4, 19, 10], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 6
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([6])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']], selected_client_indices: [8, 11, 2, 4, 19, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:25...
global Accuracy on shared test data: 50.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 95 142]
 [105 158]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:25, End: 2025-07-22 15:48:25)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [2, 7, 1, 17, 3, 10, 12, 15, 20, 16, 4, 18, 11, 13, 14, 19, 8], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [2, 7, 1, 17, 3, 10, 12, 15, 20, 16, 4, 18, 11, 13, 14, 19, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0021s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:25...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 94 143]
 [109 154]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:25, End: 2025-07-22 15:48:25)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [8, 2, 5, 12, 14, 18, 15, 1, 17, 9, 13, 4], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [8, 2, 5, 12, 14, 18, 15, 1, 17, 9, 13, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0022s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:26...
global Accuracy on shared test data: 53.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[213  24]
 [211  52]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:26, End: 2025-07-22 15:48:26)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [5, 14, 12, 1, 9, 15, 16], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [5, 14, 12, 1, 9, 15, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:26...
global Accuracy on shared test data: 51.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [187  76]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:26, End: 2025-07-22 15:48:26)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [12, 16, 7, 17, 3, 2, 5, 19, 14, 13], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [12, 16, 7, 17, 3, 2, 5, 19, 14, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:26...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[188  49]
 [210  53]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:26, End: 2025-07-22 15:48:26)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [12, 14, 15, 17, 11, 5, 13, 1, 16], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [12, 14, 15, 17, 11, 5, 13, 1, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0009s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:27...
global Accuracy on shared test data: 47.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[153  84]
 [178  85]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:27, End: 2025-07-22 15:48:27)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (11): [14, 16, 15, 8, 18, 9, 6, 3, 12, 11, 13], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [14, 16, 15, 8, 18, 9, 6, 3, 12, 11, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0153s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:27...
global Accuracy on shared test data: 47.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[149  88]
 [177  86]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:27, End: 2025-07-22 15:48:27)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [4, 16, 7, 12, 9, 20, 17], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [4, 16, 7, 12, 9, 20, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:27...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 91 146]
 [107 156]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:27, End: 2025-07-22 15:48:28)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [16, 13], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
mean, clients_type: [['Update 0']
 ['Update 1']], selected_client_indices: [16, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0003s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:28...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[200  37]
 [230  33]]
Function 'evaluate_global_model' executed in 0.0019 seconds (Start: 2025-07-22 15:48:28, End: 2025-07-22 15:48:28)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [17, 15, 11, 1, 18, 20, 3, 7, 5, 13, 19, 6, 10, 4, 2, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [17, 15, 11, 1, 18, 20, 3, 7, 5, 13, 19, 6, 10, 4, 2, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0036s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:28...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[203  34]
 [233  30]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:28, End: 2025-07-22 15:48:28)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (7): [11, 16, 17, 9, 6, 12, 20], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 7
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([7])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']], selected_client_indices: [11, 16, 17, 9, 6, 12, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:28...
global Accuracy on shared test data: 50.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[197  40]
 [207  56]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:28, End: 2025-07-22 15:48:28)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [12, 10, 17, 18, 19, 4, 7, 2, 3, 8, 16, 5, 20, 1], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [12, 10, 17, 18, 19, 4, 7, 2, 3, 8, 16, 5, 20, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0014s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:29...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [194  69]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:29, End: 2025-07-22 15:48:29)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [7, 16, 15, 4, 8], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']], selected_client_indices: [7, 16, 15, 4, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:29...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[205  32]
 [220  43]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:29, End: 2025-07-22 15:48:29)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [9, 2, 18, 5, 10, 16, 11, 3, 6], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [9, 2, 18, 5, 10, 16, 11, 3, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0060s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:30...
global Accuracy on shared test data: 50.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[204  33]
 [216  47]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:30, End: 2025-07-22 15:48:30)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 19, 20, 8, 6, 1, 7, 13, 12, 11, 3, 9, 16, 2, 18, 5, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 19, 20, 8, 6, 1, 7, 13, 12, 11, 3, 9, 16, 2, 18, 5, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0184s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:30...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [182  81]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:30, End: 2025-07-22 15:48:30)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [4, 2, 3, 12, 16, 15, 13, 11, 19, 10, 1, 6, 8, 5, 20, 14], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 2, 3, 12, 16, 15, 13, 11, 19, 10, 1, 6, 8, 5, 20, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:31...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[199  38]
 [220  43]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:31, End: 2025-07-22 15:48:31)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [19, 13, 3, 15, 5, 1, 12, 18, 20, 7], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [19, 13, 3, 15, 5, 1, 12, 18, 20, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0215s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:31...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[211  26]
 [232  31]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:31, End: 2025-07-22 15:48:31)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [18], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
mean, clients_type: [['Update 0']], selected_client_indices: [18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0003s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:31...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[195  42]
 [217  46]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:48:31, End: 2025-07-22 15:48:31)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [19, 7, 11, 12, 18, 4, 8, 17, 3, 14, 1, 6, 13, 20, 16, 10, 15, 5], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [19, 7, 11, 12, 18, 4, 8, 17, 3, 14, 1, 6, 13, 20, 16, 10, 15, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:32...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[195  42]
 [212  51]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:32, End: 2025-07-22 15:48:32)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [8, 2, 16, 10, 1, 3, 7, 14, 13, 4, 18, 9, 19, 12, 5, 11], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 2, 16, 10, 1, 3, 7, 14, 13, 4, 18, 9, 19, 12, 5, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0134s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:33...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[192  45]
 [214  49]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:33, End: 2025-07-22 15:48:33)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [9, 5, 12, 7, 6, 8, 14, 10, 4, 19, 15, 17, 11, 2], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [9, 5, 12, 7, 6, 8, 14, 10, 4, 19, 15, 17, 11, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0012s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:33...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[202  35]
 [218  45]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:33, End: 2025-07-22 15:48:33)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [19], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
mean, clients_type: [['Update 0']], selected_client_indices: [19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0002s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:33...
global Accuracy on shared test data: 46.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[104 133]
 [136 127]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:48:33, End: 2025-07-22 15:48:33)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (14): [1, 2, 8, 11, 19, 16, 9, 12, 3, 17, 20, 7, 15, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [1, 2, 8, 11, 19, 16, 9, 12, 3, 17, 20, 7, 15, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0183s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:34...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [124 139]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:34, End: 2025-07-22 15:48:34)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 20, 17, 4, 6, 15, 3, 10, 11, 2, 18, 7, 5, 1, 8, 12, 13, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 20, 17, 4, 6, 15, 3, 10, 11, 2, 18, 7, 5, 1, 8, 12, 13, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0063s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:34...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 92 145]
 [116 147]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:34, End: 2025-07-22 15:48:34)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (16): [6, 16, 9, 20, 12, 5, 8, 11, 15, 14, 17, 13, 4, 7, 3, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 16, 9, 20, 12, 5, 8, 11, 15, 14, 17, 13, 4, 7, 3, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:35...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 92 145]
 [112 151]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:35, End: 2025-07-22 15:48:35)
start time is: 98283424363491, end time is: 98297367663063
The total time is: 13943299572ns.

 ------- aggregate method: mean, random_seed: 400 --------

[Server] Epoch 0...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [8, 15, 4, 19, 5, 17, 2, 6, 12, 9], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [8, 15, 4, 19, 5, 17, 2, 6, 12, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0116s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:35...
global Accuracy on shared test data: 51.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[211  26]
 [217  46]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:35, End: 2025-07-22 15:48:35)

[Server] Epoch 1...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [5, 17, 18, 9, 20, 8, 16, 1, 7, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [5, 17, 18, 9, 20, 8, 16, 1, 7, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:36...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 71 166]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:36, End: 2025-07-22 15:48:36)

[Server] Epoch 2...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [13, 10, 18, 12, 16, 20, 5, 3, 8, 1], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [13, 10, 18, 12, 16, 20, 5, 3, 8, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0025s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:36...
global Accuracy on shared test data: 51.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[136 101]
 [143 120]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:36, End: 2025-07-22 15:48:36)

[Server] Epoch 3...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [18, 12, 8], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']], selected_client_indices: [18, 12, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:37...
global Accuracy on shared test data: 47.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [197  66]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:37, End: 2025-07-22 15:48:37)

[Server] Epoch 4...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [20], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
mean, clients_type: [['Update 0']], selected_client_indices: [20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0002s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:37...
global Accuracy on shared test data: 50.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[223  14]
 [233  30]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:48:37, End: 2025-07-22 15:48:37)

[Server] Epoch 5...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [16, 10], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
mean, clients_type: [['Update 0']
 ['Update 1']], selected_client_indices: [16, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0003s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:37...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[230   7]
 [254   9]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:37, End: 2025-07-22 15:48:37)

[Server] Epoch 6...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (5): [8, 14, 4, 1, 12], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 5
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([5])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']], selected_client_indices: [8, 14, 4, 1, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:37...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[232   5]
 [255   8]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:37, End: 2025-07-22 15:48:37)

[Server] Epoch 7...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [19, 7, 10, 16, 18, 9, 11, 17, 14, 5, 8, 4, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [19, 7, 10, 16, 18, 9, 11, 17, 14, 5, 8, 4, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0006s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:38...
global Accuracy on shared test data: 47.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[232   5]
 [258   5]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:38, End: 2025-07-22 15:48:38)

[Server] Epoch 8...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [14, 1, 10, 15, 9, 19, 12, 7, 20, 11, 13, 16, 5, 8, 6, 17, 3, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [14, 1, 10, 15, 9, 19, 12, 7, 20, 11, 13, 16, 5, 8, 6, 17, 3, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0010s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:38...
global Accuracy on shared test data: 47.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[232   5]
 [257   6]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:38, End: 2025-07-22 15:48:38)

[Server] Epoch 9...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [5, 14, 18, 11, 13, 7, 15, 4, 9, 1, 10, 17, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 14, 18, 11, 13, 7, 15, 4, 9, 1, 10, 17, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:39...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[227  10]
 [250  13]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:39, End: 2025-07-22 15:48:39)

[Server] Epoch 10...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (1): [20], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 1
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([1])
mean, clients_type: [['Update 0']], selected_client_indices: [20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0002s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:39...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [191  72]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:48:39, End: 2025-07-22 15:48:39)

[Server] Epoch 11...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (13): [4, 16, 20, 8, 1, 3, 6, 5, 7, 12, 14, 10, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [4, 16, 20, 8, 1, 3, 6, 5, 7, 12, 14, 10, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0039s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:39...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[209  28]
 [222  41]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:39, End: 2025-07-22 15:48:39)

[Server] Epoch 12...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (8): [6, 12, 19, 17, 1, 8, 7, 18], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 8
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([8])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']], selected_client_indices: [6, 12, 19, 17, 1, 8, 7, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:39...
global Accuracy on shared test data: 50.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[136 101]
 [148 115]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:39, End: 2025-07-22 15:48:39)

[Server] Epoch 13...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (19): [4, 6, 12, 5, 8, 1, 3, 18, 11, 16, 2, 15, 19, 7, 9, 14, 10, 17, 13], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [4, 6, 12, 5, 8, 1, 3, 18, 11, 16, 2, 15, 19, 7, 9, 14, 10, 17, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0010s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:40...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 89 148]
 [110 153]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:40, End: 2025-07-22 15:48:40)

[Server] Epoch 14...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (8): [8, 9, 20, 4, 3, 2, 5, 14], updated_f: 2
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 8
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([8])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']], selected_client_indices: [8, 9, 20, 4, 3, 2, 5, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:41...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 85 152]
 [ 99 164]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:41, End: 2025-07-22 15:48:41)

[Server] Epoch 15...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [16, 12, 4], updated_f: 1
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']], selected_client_indices: [16, 12, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0003s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:41...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[105 132]
 [122 141]]
Function 'evaluate_global_model' executed in 0.0018 seconds (Start: 2025-07-22 15:48:41, End: 2025-07-22 15:48:41)

[Server] Epoch 16...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [2, 7, 9], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']], selected_client_indices: [2, 7, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:41...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[108 129]
 [125 138]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:41, End: 2025-07-22 15:48:41)

[Server] Epoch 17...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [8, 3, 10, 19, 17, 12, 9, 4, 11, 14, 18, 2, 13, 7, 15, 20, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [8, 3, 10, 19, 17, 12, 9, 4, 11, 14, 18, 2, 13, 7, 15, 20, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0110s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:42...
global Accuracy on shared test data: 51.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[163  74]
 [171  92]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:42, End: 2025-07-22 15:48:42)

[Server] Epoch 18...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (10): [1, 13, 4, 18, 9, 14, 15, 2, 7, 17], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [1, 13, 4, 18, 9, 14, 15, 2, 7, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0013s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:42...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [189  74]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:42, End: 2025-07-22 15:48:42)

[Server] Epoch 19...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [19, 17, 10, 20, 2, 4, 15, 13, 18], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [19, 17, 10, 20, 2, 4, 15, 13, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0014s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:42...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[190  47]
 [208  55]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:42, End: 2025-07-22 15:48:42)

[Server] Epoch 20...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [7, 2], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
mean, clients_type: [['Update 0']
 ['Update 1']], selected_client_indices: [7, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0003s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:43...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [197  66]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:43, End: 2025-07-22 15:48:43)

[Server] Epoch 21...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (3): [4, 7, 10], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 3
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([3])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']], selected_client_indices: [4, 7, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:43...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [192  71]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:43, End: 2025-07-22 15:48:43)

[Server] Epoch 22...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [7, 14, 9, 1, 6, 2, 19, 10, 16, 15, 18, 3], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [7, 14, 9, 1, 6, 2, 19, 10, 16, 15, 18, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0160s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:43...
global Accuracy on shared test data: 46.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[191  46]
 [220  43]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:43, End: 2025-07-22 15:48:43)

[Server] Epoch 23...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [19, 13, 18, 3, 2, 17, 11, 5, 15], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [19, 13, 18, 3, 2, 17, 11, 5, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0009s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:44...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [198  65]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:44, End: 2025-07-22 15:48:44)

[Server] Epoch 24...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (17): [18, 4, 1, 16, 5, 19, 20, 17, 11, 2, 15, 8, 9, 13, 12, 6, 10], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [18, 4, 1, 16, 5, 19, 20, 17, 11, 2, 15, 8, 9, 13, 12, 6, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:44...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[147  90]
 [177  86]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:44, End: 2025-07-22 15:48:44)

[Server] Epoch 25...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (2): [9, 5], updated_f: 0
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 2
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([2])
mean, clients_type: [['Update 0']
 ['Update 1']], selected_client_indices: [9, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:45...
global Accuracy on shared test data: 47.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[140  97]
 [168  95]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:45, End: 2025-07-22 15:48:45)

[Server] Epoch 26...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [8, 13, 10, 7, 14, 20, 15, 16, 1, 18, 12, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [8, 13, 10, 7, 14, 20, 15, 16, 1, 18, 12, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0175s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:45...
global Accuracy on shared test data: 44.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 98 139]
 [137 126]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:45, End: 2025-07-22 15:48:45)

[Server] Epoch 27...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (9): [16, 2, 4, 19, 6, 15, 12, 10, 7], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 9
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([9])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']], selected_client_indices: [16, 2, 4, 19, 6, 15, 12, 10, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0006s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:45...
global Accuracy on shared test data: 44.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[103 134]
 [144 119]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:48:45, End: 2025-07-22 15:48:45)

[Server] Epoch 28...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (12): [18, 17, 1, 7, 10, 5, 11, 8, 15, 16, 4, 3], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [18, 17, 1, 7, 10, 5, 11, 8, 15, 16, 4, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0222s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:46...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 61 176]
 [ 74 189]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:48:46, End: 2025-07-22 15:48:46)

[Server] Epoch 29...
client_indices (20): [7, 20, 4, 16, 9, 3, 17, 10, 15, 1, 14, 11, 2, 18, 5, 19, 6, 8, 12, 13], f:8
select_clients (18): [17, 15, 8, 18, 13, 5, 7, 6, 19, 16, 20, 11, 12, 10, 9, 14, 2, 4], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [17, 15, 8, 18, 13, 5, 7, 6, 19, 16, 20, 11, 12, 10, 9, 14, 2, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0136s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:48:47...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 76 161]
 [ 81 182]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:48:47, End: 2025-07-22 15:48:47)
start time is: 98297367666589, end time is: 98308845137717
The total time is: 11477471128ns.
-----------------------------------------------------------------------------------
[Server] Training complete. Connections closed.



***random_seed:0
rkrum =  [0.77, 0.756, 0.784, 0.766, 0.776, 0.79, 0.762, 0.788, 0.776, 0.77, 0.758, 0.736, 0.772, 0.754, 0.778, 0.768, 0.768, 0.762, 0.746, 0.54, 0.552, 0.562, 0.56, 0.538, 0.534, 0.542, 0.548, 0.546, 0.546, 0.544]
krum =  [0.73, 0.788, 0.784, 0.77, 0.78, 0.514, 0.516, 0.522, 0.532, 0.548, 0.54, 0.536, 0.538, 0.548, 0.548, 0.548, 0.55, 0.548, 0.55, 0.488, 0.486, 0.486, 0.482, 0.494, 0.498, 0.506, 0.51, 0.516, 0.51, 0.516]
mean =  [0.516, 0.498, 0.468, 0.492, 0.516, 0.494, 0.502, 0.504, 0.524, 0.51, 0.518, 0.528, 0.542, 0.534, 0.53, 0.5, 0.488, 0.502, 0.492, 0.44, 0.442, 0.464, 0.454, 0.466, 0.458, 0.446, 0.434, 0.444, 0.438, 0.448]
rkrum =  33137846850
krum =  14773784948
mean =  14729127256

***random_seed:100
rkrum =  [0.744, 0.772, 0.774, 0.782, 0.766, 0.77, 0.772, 0.772, 0.598, 0.598, 0.528, 0.518, 0.516, 0.51, 0.52, 0.522, 0.512, 0.522, 0.528, 0.52, 0.526, 0.524, 0.528, 0.532, 0.532, 0.524, 0.524, 0.526, 0.518, 0.516]
krum =  [0.75, 0.782, 0.784, 0.772, 0.78, 0.766, 0.774, 0.786, 0.51, 0.508, 0.496, 0.504, 0.484, 0.482, 0.442, 0.45, 0.448, 0.438, 0.444, 0.444, 0.444, 0.456, 0.458, 0.466, 0.476, 0.494, 0.492, 0.492, 0.486, 0.482]
mean =  [0.48, 0.508, 0.566, 0.482, 0.478, 0.556, 0.534, 0.536, 0.498, 0.5, 0.49, 0.486, 0.488, 0.486, 0.466, 0.47, 0.468, 0.472, 0.466, 0.476, 0.48, 0.486, 0.488, 0.492, 0.488, 0.474, 0.472, 0.472, 0.458, 0.454]
rkrum =  13149185430
krum =  12919930921
mean =  13019547462

***random_seed:200
rkrum =  [0.468, 0.462, 0.47, 0.47, 0.472, 0.488, 0.494, 0.504, 0.524, 0.52, 0.522, 0.518, 0.524, 0.53, 0.536, 0.534, 0.534, 0.538, 0.466, 0.458, 0.444, 0.444, 0.44, 0.454, 0.44, 0.45, 0.456, 0.456, 0.448, 0.458]
krum =  [0.514, 0.52, 0.52, 0.528, 0.52, 0.528, 0.526, 0.53, 0.538, 0.548, 0.55, 0.552, 0.552, 0.544, 0.542, 0.538, 0.54, 0.536, 0.478, 0.48, 0.476, 0.482, 0.478, 0.478, 0.48, 0.478, 0.476, 0.48, 0.476, 0.48]
mean =  [0.478, 0.496, 0.478, 0.478, 0.452, 0.466, 0.474, 0.486, 0.496, 0.532, 0.542, 0.518, 0.546, 0.532, 0.524, 0.52, 0.474, 0.484, 0.472, 0.44, 0.458, 0.436, 0.446, 0.466, 0.492, 0.492, 0.476, 0.47, 0.48, 0.48]
rkrum =  12859812352
krum =  12865985601
mean =  12919446602

***random_seed:300
rkrum =  [0.74, 0.742, 0.742, 0.76, 0.768, 0.76, 0.75, 0.78, 0.746, 0.756, 0.762, 0.746, 0.77, 0.5, 0.506, 0.518, 0.52, 0.516, 0.522, 0.522, 0.528, 0.532, 0.488, 0.494, 0.494, 0.498, 0.502, 0.502, 0.512, 0.504]
krum =  [0.748, 0.768, 0.792, 0.798, 0.788, 0.776, 0.776, 0.774, 0.768, 0.782, 0.764, 0.786, 0.756, 0.486, 0.474, 0.48, 0.482, 0.48, 0.494, 0.498, 0.498, 0.49, 0.49, 0.478, 0.488, 0.488, 0.506, 0.504, 0.5, 0.504]
mean =  [0.55, 0.52, 0.526, 0.536, 0.558, 0.506, 0.496, 0.53, 0.51, 0.482, 0.476, 0.47, 0.494, 0.466, 0.466, 0.506, 0.508, 0.496, 0.502, 0.516, 0.484, 0.484, 0.482, 0.492, 0.482, 0.494, 0.462, 0.482, 0.478, 0.486]
rkrum =  13975336147
krum =  13987721698
mean =  13943299572

***random_seed:400
rkrum =  [0.742, 0.758, 0.792, 0.766, 0.582, 0.526, 0.524, 0.524, 0.526, 0.526, 0.506, 0.506, 0.508, 0.524, 0.522, 0.526, 0.524, 0.526, 0.526, 0.524, 0.522, 0.516, 0.516, 0.524, 0.522, 0.536, 0.526, 0.52, 0.522, 0.524]
krum =  [0.752, 0.78, 0.776, 0.496, 0.456, 0.508, 0.51, 0.514, 0.52, 0.518, 0.47, 0.474, 0.474, 0.466, 0.46, 0.482, 0.482, 0.486, 0.488, 0.49, 0.492, 0.486, 0.484, 0.484, 0.488, 0.484, 0.482, 0.48, 0.478, 0.484]
mean =  [0.514, 0.522, 0.512, 0.47, 0.506, 0.478, 0.48, 0.474, 0.476, 0.48, 0.496, 0.5, 0.502, 0.484, 0.498, 0.492, 0.492, 0.51, 0.49, 0.49, 0.494, 0.498, 0.468, 0.49, 0.466, 0.47, 0.448, 0.444, 0.5, 0.516]
rkrum =  11628829482
krum =  11604832899
mean =  11477471128


start time is: 98079421908789, end time is: 98308950403128
The total time is: 229528494339ns.
