Namespace(server_ip='127.0.0.1', workspace_dir='out/ws_20_30_1_1', num_clients=20, num_rounds=30)
Number of clients:  20
NUM_BYZANTINE_CLIENTS:  8
NUM_HONEST_CLIENTS:  12
[Server] Starting...
[Server] Waiting for 20 clients to connect...
[Server] Connected to client 5 at ('127.0.0.1', 39922)
[Server] Connected to client 7 at ('127.0.0.1', 39932)
[Server] Connected to client 2 at ('127.0.0.1', 39940)
[Server] Connected to client 19 at ('127.0.0.1', 39946)
[Server] Connected to client 17 at ('127.0.0.1', 39956)
[Server] Connected to client 1 at ('127.0.0.1', 39968)
[Server] Connected to client 9 at ('127.0.0.1', 39976)
[Server] Connected to client 20 at ('127.0.0.1', 39982)
[Server] Connected to client 18 at ('127.0.0.1', 39992)
[Server] Connected to client 8 at ('127.0.0.1', 39996)
[Server] Connected to client 15 at ('127.0.0.1', 40004)
[Server] Connected to client 4 at ('127.0.0.1', 40008)
[Server] Connected to client 3 at ('127.0.0.1', 40022)
[Server] Connected to client 13 at ('127.0.0.1', 40030)
[Server] Connected to client 14 at ('127.0.0.1', 40036)
[Server] Connected to client 11 at ('127.0.0.1', 40050)
[Server] Connected to client 10 at ('127.0.0.1', 40060)
[Server] Connected to client 16 at ('127.0.0.1', 40076)
[Server] Connected to client 6 at ('127.0.0.1', 40086)
[Server] Connected to client 12 at ('127.0.0.1', 40092)
[Server] All clients connected.
-----------------------------------------------------------------------------------

 ------- aggregate method: rkrum, random_seed: 0 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 7.5176e+00, 3.9561e+05, 3.8694e+05, 8.1785e+00, 8.3101e+00,
         3.7942e+05, 3.8870e+05, 7.2869e+00, 8.0699e+00, 6.6562e+00, 3.9966e+05,
         3.8820e+05, 6.6604e+00],
        [7.5176e+00, 0.0000e+00, 3.9550e+05, 3.8693e+05, 5.9370e+00, 6.0922e+00,
         3.7942e+05, 3.8867e+05, 6.3338e+00, 7.1679e+00, 6.6556e+00, 3.9966e+05,
         3.8824e+05, 6.2135e+00],
        [3.9561e+05, 3.9550e+05, 0.0000e+00, 7.6690e+05, 3.9553e+05, 3.9560e+05,
         7.6212e+05, 8.0678e+05, 3.9553e+05, 3.9557e+05, 3.9557e+05, 8.0148e+05,
         7.8248e+05, 3.9557e+05],
        [3.8694e+05, 3.8693e+05, 7.6690e+05, 0.0000e+00, 3.8697e+05, 3.8694e+05,
         7.6961e+05, 7.7799e+05, 3.8694e+05, 3.8695e+05, 3.8692e+05, 7.9953e+05,
         7.9442e+05, 3.8689e+05],
        [8.1785e+00, 5.9370e+00, 3.9553e+05, 3.8697e+05, 0.0000e+00, 5.2571e+00,
         3.7936e+05, 3.8870e+05, 7.9029e+00, 9.7446e+00, 7.7151e+00, 3.9963e+05,
         3.8821e+05, 5.4750e+00],
        [8.3101e+00, 6.0922e+00, 3.9560e+05, 3.8694e+05, 5.2571e+00, 0.0000e+00,
         3.7944e+05, 3.8868e+05, 7.2307e+00, 8.7232e+00, 6.7491e+00, 3.9964e+05,
         3.8820e+05, 5.5100e+00],
        [3.7942e+05, 3.7942e+05, 7.6212e+05, 7.6961e+05, 3.7936e+05, 3.7944e+05,
         0.0000e+00, 7.4317e+05, 3.7937e+05, 3.7936e+05, 3.7937e+05, 7.5579e+05,
         7.6748e+05, 3.7933e+05],
        [3.8870e+05, 3.8867e+05, 8.0678e+05, 7.7799e+05, 3.8870e+05, 3.8868e+05,
         7.4317e+05, 0.0000e+00, 3.8867e+05, 3.8869e+05, 3.8875e+05, 7.9123e+05,
         7.6366e+05, 3.8872e+05],
        [7.2869e+00, 6.3338e+00, 3.9553e+05, 3.8694e+05, 7.9029e+00, 7.2307e+00,
         3.7937e+05, 3.8867e+05, 0.0000e+00, 6.7285e+00, 5.5317e+00, 3.9972e+05,
         3.8817e+05, 5.9968e+00],
        [8.0699e+00, 7.1679e+00, 3.9557e+05, 3.8695e+05, 9.7446e+00, 8.7232e+00,
         3.7936e+05, 3.8869e+05, 6.7285e+00, 0.0000e+00, 7.0921e+00, 3.9969e+05,
         3.8822e+05, 7.7930e+00],
        [6.6562e+00, 6.6556e+00, 3.9557e+05, 3.8692e+05, 7.7151e+00, 6.7491e+00,
         3.7937e+05, 3.8875e+05, 5.5317e+00, 7.0921e+00, 0.0000e+00, 3.9973e+05,
         3.8822e+05, 6.1356e+00],
        [3.9966e+05, 3.9966e+05, 8.0148e+05, 7.9953e+05, 3.9963e+05, 3.9964e+05,
         7.5579e+05, 7.9123e+05, 3.9972e+05, 3.9969e+05, 3.9973e+05, 0.0000e+00,
         8.1646e+05, 3.9971e+05],
        [3.8820e+05, 3.8824e+05, 7.8248e+05, 7.9442e+05, 3.8821e+05, 3.8820e+05,
         7.6748e+05, 7.6366e+05, 3.8817e+05, 3.8822e+05, 3.8822e+05, 8.1646e+05,
         0.0000e+00, 3.8821e+05],
        [6.6604e+00, 6.2135e+00, 3.9557e+05, 3.8689e+05, 5.4750e+00, 5.5100e+00,
         3.7933e+05, 3.8872e+05, 5.9968e+00, 7.7930e+00, 6.1356e+00, 3.9971e+05,
         3.8821e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 6.6562e+00, 6.6604e+00, 7.2869e+00, 7.5176e+00, 8.0699e+00,
        8.1785e+00, 8.3101e+00, 3.7942e+05, 3.8694e+05, 3.8820e+05, 3.8870e+05,
        3.9561e+05, 3.9966e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 5.9370e+00, 6.0922e+00, 6.2135e+00, 6.3338e+00, 6.6556e+00,
        7.1679e+00, 7.5176e+00, 3.7942e+05, 3.8693e+05, 3.8824e+05, 3.8867e+05,
        3.9550e+05, 3.9966e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 395504.5312, 395526.0000, 395529.8750, 395568.5938,
        395573.3125, 395573.6875, 395596.9062, 395608.4062, 762123.8750,
        766904.5000, 782481.1250, 801481.6250, 806778.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386890.0938, 386922.6250, 386927.9062, 386935.7500,
        386935.8438, 386937.6875, 386947.3438, 386973.2188, 766904.5000,
        769614.5625, 777988.1875, 794418.7500, 799530.9375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 5.2571e+00, 5.4750e+00, 5.9370e+00, 7.7151e+00, 7.9029e+00,
        8.1785e+00, 9.7446e+00, 3.7936e+05, 3.8697e+05, 3.8821e+05, 3.8870e+05,
        3.9553e+05, 3.9963e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 5.2571e+00, 5.5100e+00, 6.0922e+00, 6.7491e+00, 7.2307e+00,
        8.3101e+00, 8.7232e+00, 3.7944e+05, 3.8694e+05, 3.8820e+05, 3.8868e+05,
        3.9560e+05, 3.9964e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 379331.3750, 379356.3438, 379358.6250, 379366.9062,
        379372.6562, 379418.9688, 379419.5000, 379444.7812, 743166.5000,
        755786.7500, 762123.8750, 767480.6875, 769614.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388667.6562, 388673.1875, 388681.2812, 388692.7500,
        388702.5938, 388703.8750, 388721.2500, 388751.8438, 743166.5000,
        763664.9375, 777988.1875, 791225.0625, 806778.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 5.5317e+00, 5.9968e+00, 6.3338e+00, 6.7285e+00, 7.2307e+00,
        7.2869e+00, 7.9029e+00, 3.7937e+05, 3.8694e+05, 3.8817e+05, 3.8867e+05,
        3.9553e+05, 3.9972e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 6.7285e+00, 7.0921e+00, 7.1679e+00, 7.7930e+00, 8.0699e+00,
        8.7232e+00, 9.7446e+00, 3.7936e+05, 3.8695e+05, 3.8822e+05, 3.8869e+05,
        3.9557e+05, 3.9969e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 5.5317e+00, 6.1356e+00, 6.6556e+00, 6.6562e+00, 6.7491e+00,
        7.0921e+00, 7.7151e+00, 3.7937e+05, 3.8692e+05, 3.8822e+05, 3.8875e+05,
        3.9557e+05, 3.9973e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 399627.0625, 399639.6562, 399658.5000, 399659.0000,
        399687.0000, 399706.1875, 399717.8125, 399729.9062, 755786.7500,
        791225.0625, 799530.9375, 801481.6250, 816463.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388167.0938, 388201.2812, 388203.9375, 388209.3125,
        388214.3438, 388216.3750, 388220.3125, 388244.7500, 763664.9375,
        767480.6875, 782481.1250, 794418.7500, 816463.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 5.4750e+00, 5.5100e+00, 5.9968e+00, 6.1356e+00, 6.2135e+00,
        6.6604e+00, 7.7930e+00, 3.7933e+05, 3.8689e+05, 3.8821e+05, 3.8872e+05,
        3.9557e+05, 3.9971e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['85156.59', '85154.81', '436289.44', '429152.75', '85153.30', '85158.72', '419803.91', '428084.53', '85149.95', '85151.25', '85149.09', '439245.75', '429926.94', '85140.58']
estimated f for each client, fs: [6, 6, 4, 4, 6, 6, 4, 4, 6, 6, 6, 4, 4, 6]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0123s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:41...
global Accuracy on shared test data: 73.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 76 187]]
Function 'evaluate_global_model' executed in 1.3820 seconds (Start: 2025-07-22 15:28:41, End: 2025-07-22 15:28:42)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 19, 17, 1, 9, 20, 15, 3, 14, 11, 10, 16, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 2.1703e+00, 3.8547e+05, 3.8889e+05, 2.1499e+00, 2.1548e+00,
         3.9759e+05, 3.9557e+05, 2.0681e+00, 3.8034e+05, 2.0895e+00, 2.1789e+00,
         3.8793e+05, 2.0763e+00],
        [2.1703e+00, 0.0000e+00, 3.8550e+05, 3.8891e+05, 2.1232e+00, 2.1643e+00,
         3.9757e+05, 3.9560e+05, 2.2978e+00, 3.8034e+05, 2.2519e+00, 2.1597e+00,
         3.8797e+05, 2.1567e+00],
        [3.8547e+05, 3.8550e+05, 0.0000e+00, 7.7397e+05, 3.8549e+05, 3.8548e+05,
         7.9836e+05, 7.4685e+05, 3.8545e+05, 7.6027e+05, 3.8552e+05, 3.8549e+05,
         8.0239e+05, 3.8547e+05],
        [3.8889e+05, 3.8891e+05, 7.7397e+05, 0.0000e+00, 3.8892e+05, 3.8888e+05,
         8.0328e+05, 7.8514e+05, 3.8888e+05, 7.7377e+05, 3.8886e+05, 3.8893e+05,
         7.9328e+05, 3.8887e+05],
        [2.1499e+00, 2.1232e+00, 3.8549e+05, 3.8892e+05, 0.0000e+00, 2.0036e+00,
         3.9757e+05, 3.9556e+05, 2.2473e+00, 3.8030e+05, 2.1906e+00, 2.1958e+00,
         3.8797e+05, 2.1802e+00],
        [2.1548e+00, 2.1643e+00, 3.8548e+05, 3.8888e+05, 2.0036e+00, 0.0000e+00,
         3.9756e+05, 3.9557e+05, 1.8881e+00, 3.8034e+05, 2.1452e+00, 2.0009e+00,
         3.8796e+05, 2.1105e+00],
        [3.9759e+05, 3.9757e+05, 7.9836e+05, 8.0328e+05, 3.9757e+05, 3.9756e+05,
         0.0000e+00, 8.0129e+05, 3.9755e+05, 7.7897e+05, 3.9760e+05, 3.9759e+05,
         7.6749e+05, 3.9760e+05],
        [3.9557e+05, 3.9560e+05, 7.4685e+05, 7.8514e+05, 3.9556e+05, 3.9557e+05,
         8.0129e+05, 0.0000e+00, 3.9555e+05, 8.0329e+05, 3.9553e+05, 3.9558e+05,
         7.5889e+05, 3.9553e+05],
        [2.0681e+00, 2.2978e+00, 3.8545e+05, 3.8888e+05, 2.2473e+00, 1.8881e+00,
         3.9755e+05, 3.9555e+05, 0.0000e+00, 3.8037e+05, 2.2140e+00, 2.0826e+00,
         3.8796e+05, 2.0982e+00],
        [3.8034e+05, 3.8034e+05, 7.6027e+05, 7.7377e+05, 3.8030e+05, 3.8034e+05,
         7.7897e+05, 8.0329e+05, 3.8037e+05, 0.0000e+00, 3.8035e+05, 3.8034e+05,
         7.9944e+05, 3.8033e+05],
        [2.0895e+00, 2.2519e+00, 3.8552e+05, 3.8886e+05, 2.1906e+00, 2.1452e+00,
         3.9760e+05, 3.9553e+05, 2.2140e+00, 3.8035e+05, 0.0000e+00, 2.2747e+00,
         3.8796e+05, 2.1261e+00],
        [2.1789e+00, 2.1597e+00, 3.8549e+05, 3.8893e+05, 2.1958e+00, 2.0009e+00,
         3.9759e+05, 3.9558e+05, 2.0826e+00, 3.8034e+05, 2.2747e+00, 0.0000e+00,
         3.8794e+05, 2.0675e+00],
        [3.8793e+05, 3.8797e+05, 8.0239e+05, 7.9328e+05, 3.8797e+05, 3.8796e+05,
         7.6749e+05, 7.5889e+05, 3.8796e+05, 7.9944e+05, 3.8796e+05, 3.8794e+05,
         0.0000e+00, 3.8797e+05],
        [2.0763e+00, 2.1567e+00, 3.8547e+05, 3.8887e+05, 2.1802e+00, 2.1105e+00,
         3.9760e+05, 3.9553e+05, 2.0982e+00, 3.8033e+05, 2.1261e+00, 2.0675e+00,
         3.8797e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 2.0681e+00, 2.0763e+00, 2.0895e+00, 2.1499e+00, 2.1548e+00,
        2.1703e+00, 2.1789e+00, 3.8034e+05, 3.8547e+05, 3.8793e+05, 3.8889e+05,
        3.9557e+05, 3.9759e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 2.1232e+00, 2.1567e+00, 2.1597e+00, 2.1643e+00, 2.1703e+00,
        2.2519e+00, 2.2978e+00, 3.8034e+05, 3.8550e+05, 3.8797e+05, 3.8891e+05,
        3.9560e+05, 3.9757e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 385448.3438, 385466.1250, 385471.6875, 385481.2812,
        385485.2812, 385486.5938, 385500.2188, 385521.8125, 746849.3125,
        760269.0625, 773971.3125, 798364.6875, 802385.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388861.7500, 388872.5000, 388876.4375, 388883.2188,
        388887.2500, 388912.3750, 388915.3438, 388932.0625, 773767.6875,
        773971.3125, 785138.1250, 793277.8750, 803281.4375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 2.0036e+00, 2.1232e+00, 2.1499e+00, 2.1802e+00, 2.1906e+00,
        2.1958e+00, 2.2473e+00, 3.8030e+05, 3.8549e+05, 3.8797e+05, 3.8892e+05,
        3.9556e+05, 3.9757e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.8881e+00, 2.0009e+00, 2.0036e+00, 2.1105e+00, 2.1452e+00,
        2.1548e+00, 2.1643e+00, 3.8034e+05, 3.8548e+05, 3.8796e+05, 3.8888e+05,
        3.9557e+05, 3.9756e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397550.5625, 397563.9375, 397565.8125, 397567.1250,
        397591.3750, 397594.4375, 397600.0000, 397602.6875, 767490.0000,
        778970.3125, 798364.6875, 801287.1875, 803281.4375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 395532.0312, 395533.5000, 395553.8438, 395556.1875,
        395567.8125, 395571.8125, 395579.2812, 395601.2500, 746849.3125,
        758887.1875, 785138.1250, 801287.1875, 803293.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.8881e+00, 2.0681e+00, 2.0826e+00, 2.0982e+00, 2.2140e+00,
        2.2473e+00, 2.2978e+00, 3.8037e+05, 3.8545e+05, 3.8796e+05, 3.8888e+05,
        3.9555e+05, 3.9755e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 380296.9688, 380329.4375, 380337.1875, 380339.7188,
        380340.6875, 380342.5312, 380346.8125, 380372.8438, 760269.0625,
        773767.6875, 778970.3125, 799444.2500, 803293.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 2.0895e+00, 2.1261e+00, 2.1452e+00, 2.1906e+00, 2.2140e+00,
        2.2519e+00, 2.2747e+00, 3.8035e+05, 3.8552e+05, 3.8796e+05, 3.8886e+05,
        3.9553e+05, 3.9760e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 2.0009e+00, 2.0675e+00, 2.0826e+00, 2.1597e+00, 2.1789e+00,
        2.1958e+00, 2.2747e+00, 3.8034e+05, 3.8549e+05, 3.8794e+05, 3.8893e+05,
        3.9558e+05, 3.9759e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387927.8125, 387941.2500, 387955.5000, 387955.9375,
        387958.0312, 387966.4375, 387968.3125, 387968.4375, 758887.1875,
        767490.0000, 793277.8750, 799444.2500, 802385.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 2.0675e+00, 2.0763e+00, 2.0982e+00, 2.1105e+00, 2.1261e+00,
        2.1567e+00, 2.1802e+00, 3.8033e+05, 3.8547e+05, 3.8797e+05, 3.8887e+05,
        3.9553e+05, 3.9760e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['85091.92', '85095.02', '425634.47', '431656.47', '85088.59', '85093.13', '438680.69', '434593.91', '85092.89', '422552.78', '85098.20', '85093.19', '429169.88', '85090.04']
estimated f for each client, fs: [6, 6, 4, 4, 6, 6, 4, 4, 6, 4, 6, 6, 4, 6]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 15, 3, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0107s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:48...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[192  45]
 [ 81 182]]
Function 'evaluate_global_model' executed in 0.0040 seconds (Start: 2025-07-22 15:28:48, End: 2025-07-22 15:28:48)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 19, 17, 9, 20, 18, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.8720e+00, 4.0165e+05, 3.9928e+05, 1.8883e+00, 3.7888e+05,
         4.0794e+05, 1.7276e+00, 1.7076e+00, 3.9622e+05, 3.9147e+05, 1.8313e+00,
         4.0071e+05, 1.8861e+00, 1.7318e+00],
        [1.8720e+00, 0.0000e+00, 4.0164e+05, 3.9928e+05, 1.7727e+00, 3.7886e+05,
         4.0794e+05, 1.8113e+00, 1.8812e+00, 3.9622e+05, 3.9149e+05, 1.7489e+00,
         4.0073e+05, 2.0093e+00, 1.8300e+00],
        [4.0165e+05, 4.0164e+05, 0.0000e+00, 7.8715e+05, 4.0163e+05, 7.8956e+05,
         8.3551e+05, 4.0165e+05, 4.0165e+05, 7.8235e+05, 7.9233e+05, 4.0164e+05,
         8.0547e+05, 4.0162e+05, 4.0162e+05],
        [3.9928e+05, 3.9928e+05, 7.8715e+05, 0.0000e+00, 3.9924e+05, 8.0756e+05,
         8.1936e+05, 3.9926e+05, 3.9927e+05, 8.1823e+05, 7.8647e+05, 3.9931e+05,
         7.9426e+05, 3.9925e+05, 3.9926e+05],
        [1.8883e+00, 1.7727e+00, 4.0163e+05, 3.9924e+05, 0.0000e+00, 3.7885e+05,
         4.0795e+05, 1.8674e+00, 1.6332e+00, 3.9621e+05, 3.9152e+05, 1.5934e+00,
         4.0071e+05, 1.7289e+00, 1.7445e+00],
        [3.7888e+05, 3.7886e+05, 7.8956e+05, 8.0756e+05, 3.7885e+05, 0.0000e+00,
         8.0955e+05, 3.7889e+05, 3.7885e+05, 7.7573e+05, 7.6907e+05, 3.7886e+05,
         7.8460e+05, 3.7886e+05, 3.7888e+05],
        [4.0794e+05, 4.0794e+05, 8.3551e+05, 8.1936e+05, 4.0795e+05, 8.0955e+05,
         0.0000e+00, 4.0790e+05, 4.0793e+05, 7.9562e+05, 8.0133e+05, 4.0796e+05,
         8.1016e+05, 4.0795e+05, 4.0791e+05],
        [1.7276e+00, 1.8113e+00, 4.0165e+05, 3.9926e+05, 1.8674e+00, 3.7889e+05,
         4.0790e+05, 0.0000e+00, 1.8491e+00, 3.9624e+05, 3.9150e+05, 1.8548e+00,
         4.0073e+05, 1.8011e+00, 1.7405e+00],
        [1.7076e+00, 1.8812e+00, 4.0165e+05, 3.9927e+05, 1.6332e+00, 3.7885e+05,
         4.0793e+05, 1.8491e+00, 0.0000e+00, 3.9625e+05, 3.9149e+05, 1.6941e+00,
         4.0071e+05, 1.8580e+00, 1.7018e+00],
        [3.9622e+05, 3.9622e+05, 7.8235e+05, 8.1823e+05, 3.9621e+05, 7.7573e+05,
         7.9562e+05, 3.9624e+05, 3.9625e+05, 0.0000e+00, 7.7091e+05, 3.9625e+05,
         8.0794e+05, 3.9619e+05, 3.9621e+05],
        [3.9147e+05, 3.9149e+05, 7.9233e+05, 7.8647e+05, 3.9152e+05, 7.6907e+05,
         8.0133e+05, 3.9150e+05, 3.9149e+05, 7.7091e+05, 0.0000e+00, 3.9151e+05,
         7.7674e+05, 3.9146e+05, 3.9149e+05],
        [1.8313e+00, 1.7489e+00, 4.0164e+05, 3.9931e+05, 1.5934e+00, 3.7886e+05,
         4.0796e+05, 1.8548e+00, 1.6941e+00, 3.9625e+05, 3.9151e+05, 0.0000e+00,
         4.0072e+05, 1.8299e+00, 1.7448e+00],
        [4.0071e+05, 4.0073e+05, 8.0547e+05, 7.9426e+05, 4.0071e+05, 7.8460e+05,
         8.1016e+05, 4.0073e+05, 4.0071e+05, 8.0794e+05, 7.7674e+05, 4.0072e+05,
         0.0000e+00, 4.0070e+05, 4.0072e+05],
        [1.8861e+00, 2.0093e+00, 4.0162e+05, 3.9925e+05, 1.7289e+00, 3.7886e+05,
         4.0795e+05, 1.8011e+00, 1.8580e+00, 3.9619e+05, 3.9146e+05, 1.8299e+00,
         4.0070e+05, 0.0000e+00, 1.7965e+00],
        [1.7318e+00, 1.8300e+00, 4.0162e+05, 3.9926e+05, 1.7445e+00, 3.7888e+05,
         4.0791e+05, 1.7405e+00, 1.7018e+00, 3.9621e+05, 3.9149e+05, 1.7448e+00,
         4.0072e+05, 1.7965e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7076e+00, 1.7276e+00, 1.7318e+00, 1.8313e+00, 1.8720e+00,
        1.8861e+00, 1.8883e+00, 3.7888e+05, 3.9147e+05, 3.9622e+05, 3.9928e+05,
        4.0071e+05, 4.0165e+05, 4.0794e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7489e+00, 1.7727e+00, 1.8113e+00, 1.8300e+00, 1.8720e+00,
        1.8812e+00, 2.0093e+00, 3.7886e+05, 3.9149e+05, 3.9622e+05, 3.9928e+05,
        4.0073e+05, 4.0164e+05, 4.0794e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 401616.0625, 401624.5625, 401633.1875, 401640.9062,
        401642.6875, 401645.7812, 401649.3125, 401653.0000, 782345.4375,
        787151.4375, 789561.0000, 792332.7500, 805474.8750, 835510.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 399237.6562, 399252.4688, 399258.8125, 399260.4062,
        399271.6562, 399276.3125, 399277.0312, 399313.5625, 786473.9375,
        787151.4375, 794258.7500, 807560.6250, 818225.1250, 819359.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5934e+00, 1.6332e+00, 1.7289e+00, 1.7445e+00, 1.7727e+00,
        1.8674e+00, 1.8883e+00, 3.7885e+05, 3.9152e+05, 3.9621e+05, 3.9924e+05,
        4.0071e+05, 4.0163e+05, 4.0795e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 378846.5625, 378847.9062, 378855.3125, 378856.6562,
        378862.6875, 378880.8125, 378881.5000, 378892.7500, 769073.7500,
        775732.4375, 784601.5000, 789561.0000, 807560.6250, 809552.1250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 407895.3438, 407906.7812, 407929.8125, 407938.0625,
        407939.5312, 407945.4688, 407953.2188, 407963.0000, 795621.0625,
        801332.6875, 809552.1250, 810158.2500, 819359.0625, 835510.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7276e+00, 1.7405e+00, 1.8011e+00, 1.8113e+00, 1.8491e+00,
        1.8548e+00, 1.8674e+00, 3.7889e+05, 3.9150e+05, 3.9624e+05, 3.9926e+05,
        4.0073e+05, 4.0165e+05, 4.0790e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6332e+00, 1.6941e+00, 1.7018e+00, 1.7076e+00, 1.8491e+00,
        1.8580e+00, 1.8812e+00, 3.7885e+05, 3.9149e+05, 3.9625e+05, 3.9927e+05,
        4.0071e+05, 4.0165e+05, 4.0793e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396187.9688, 396207.8438, 396211.9375, 396217.2500,
        396219.6875, 396238.4375, 396249.5000, 396252.4688, 770910.7500,
        775732.4375, 782345.4375, 795621.0625, 807942.3750, 818225.1250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391457.7812, 391474.2500, 391489.7188, 391489.8125,
        391490.0625, 391501.5312, 391507.3438, 391517.5625, 769073.7500,
        770910.7500, 776737.6250, 786473.9375, 792332.7500, 801332.6875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5934e+00, 1.6941e+00, 1.7448e+00, 1.7489e+00, 1.8299e+00,
        1.8313e+00, 1.8548e+00, 3.7886e+05, 3.9151e+05, 3.9625e+05, 3.9931e+05,
        4.0072e+05, 4.0164e+05, 4.0796e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400695.1250, 400710.3125, 400714.0312, 400714.2500,
        400720.4688, 400720.4688, 400726.0938, 400733.2188, 776737.6250,
        784601.5000, 794258.7500, 805474.8750, 807942.3750, 810158.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7289e+00, 1.7965e+00, 1.8011e+00, 1.8299e+00, 1.8580e+00,
        1.8861e+00, 2.0093e+00, 3.7886e+05, 3.9146e+05, 3.9619e+05, 3.9925e+05,
        4.0070e+05, 4.0162e+05, 4.0795e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7018e+00, 1.7318e+00, 1.7405e+00, 1.7445e+00, 1.7448e+00,
        1.7965e+00, 1.8300e+00, 3.7888e+05, 3.9149e+05, 3.9621e+05, 3.9926e+05,
        4.0072e+05, 4.0162e+05, 4.0791e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['85596.48', '85595.34', '443939.00', '442291.34', '85597.52', '422222.00', '451010.25', '85600.77', '85594.30', '437855.09', '433444.66', '85597.37', '442496.84', '85592.59', '85598.12']
estimated f for each client, fs: [7, 7, 5, 5, 7, 6, 5, 7, 7, 5, 5, 7, 5, 7, 7]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0105s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:52...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 72 191]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:28:52, End: 2025-07-22 15:28:52)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.8317e+05, 3.7754e+05, 1.8808e+00, 1.8284e+00, 3.9801e+05,
         3.8672e+05, 2.1713e+00, 3.9394e+05, 1.8902e+00, 1.9912e+00, 3.9329e+05,
         3.8746e+05, 1.9665e+00, 1.8811e+00],
        [3.8317e+05, 0.0000e+00, 7.6944e+05, 3.8317e+05, 3.8314e+05, 7.9789e+05,
         7.6924e+05, 3.8315e+05, 7.6223e+05, 3.8322e+05, 3.8314e+05, 7.6875e+05,
         7.9211e+05, 3.8315e+05, 3.8313e+05],
        [3.7754e+05, 7.6944e+05, 0.0000e+00, 3.7757e+05, 3.7753e+05, 7.6587e+05,
         7.6334e+05, 3.7755e+05, 7.8639e+05, 3.7754e+05, 3.7756e+05, 7.8235e+05,
         7.7866e+05, 3.7752e+05, 3.7756e+05],
        [1.8808e+00, 3.8317e+05, 3.7757e+05, 0.0000e+00, 1.6923e+00, 3.9804e+05,
         3.8674e+05, 2.0530e+00, 3.9400e+05, 1.9387e+00, 1.9371e+00, 3.9332e+05,
         3.8741e+05, 1.7022e+00, 1.8504e+00],
        [1.8284e+00, 3.8314e+05, 3.7753e+05, 1.6923e+00, 0.0000e+00, 3.9801e+05,
         3.8675e+05, 1.9254e+00, 3.9397e+05, 1.8519e+00, 1.7554e+00, 3.9332e+05,
         3.8744e+05, 1.8364e+00, 1.7142e+00],
        [3.9801e+05, 7.9789e+05, 7.6587e+05, 3.9804e+05, 3.9801e+05, 0.0000e+00,
         7.9801e+05, 3.9807e+05, 7.7810e+05, 3.9801e+05, 3.9800e+05, 7.8380e+05,
         7.8707e+05, 3.9802e+05, 3.9806e+05],
        [3.8672e+05, 7.6924e+05, 7.6334e+05, 3.8674e+05, 3.8675e+05, 7.9801e+05,
         0.0000e+00, 3.8671e+05, 7.6984e+05, 3.8671e+05, 3.8670e+05, 7.7231e+05,
         7.8537e+05, 3.8668e+05, 3.8669e+05],
        [2.1713e+00, 3.8315e+05, 3.7755e+05, 2.0530e+00, 1.9254e+00, 3.9807e+05,
         3.8671e+05, 0.0000e+00, 3.9401e+05, 1.6970e+00, 2.0111e+00, 3.9326e+05,
         3.8745e+05, 2.0331e+00, 1.8141e+00],
        [3.9394e+05, 7.6223e+05, 7.8639e+05, 3.9400e+05, 3.9397e+05, 7.7810e+05,
         7.6984e+05, 3.9401e+05, 0.0000e+00, 3.9398e+05, 3.9397e+05, 7.7199e+05,
         7.8941e+05, 3.9400e+05, 3.9395e+05],
        [1.8902e+00, 3.8322e+05, 3.7754e+05, 1.9387e+00, 1.8519e+00, 3.9801e+05,
         3.8671e+05, 1.6970e+00, 3.9398e+05, 0.0000e+00, 1.9096e+00, 3.9329e+05,
         3.8743e+05, 2.0384e+00, 1.9118e+00],
        [1.9912e+00, 3.8314e+05, 3.7756e+05, 1.9371e+00, 1.7554e+00, 3.9800e+05,
         3.8670e+05, 2.0111e+00, 3.9397e+05, 1.9096e+00, 0.0000e+00, 3.9329e+05,
         3.8742e+05, 2.0848e+00, 1.7829e+00],
        [3.9329e+05, 7.6875e+05, 7.8235e+05, 3.9332e+05, 3.9332e+05, 7.8380e+05,
         7.7231e+05, 3.9326e+05, 7.7199e+05, 3.9329e+05, 3.9329e+05, 0.0000e+00,
         7.6743e+05, 3.9331e+05, 3.9329e+05],
        [3.8746e+05, 7.9211e+05, 7.7866e+05, 3.8741e+05, 3.8744e+05, 7.8707e+05,
         7.8537e+05, 3.8745e+05, 7.8941e+05, 3.8743e+05, 3.8742e+05, 7.6743e+05,
         0.0000e+00, 3.8745e+05, 3.8744e+05],
        [1.9665e+00, 3.8315e+05, 3.7752e+05, 1.7022e+00, 1.8364e+00, 3.9802e+05,
         3.8668e+05, 2.0331e+00, 3.9400e+05, 2.0384e+00, 2.0848e+00, 3.9331e+05,
         3.8745e+05, 0.0000e+00, 1.9297e+00],
        [1.8811e+00, 3.8313e+05, 3.7756e+05, 1.8504e+00, 1.7142e+00, 3.9806e+05,
         3.8669e+05, 1.8141e+00, 3.9395e+05, 1.9118e+00, 1.7829e+00, 3.9329e+05,
         3.8744e+05, 1.9297e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.8284e+00, 1.8808e+00, 1.8811e+00, 1.8902e+00, 1.9665e+00,
        1.9912e+00, 2.1713e+00, 3.7754e+05, 3.8317e+05, 3.8672e+05, 3.8746e+05,
        3.9329e+05, 3.9394e+05, 3.9801e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 383126.5000, 383143.6875, 383144.0000, 383145.8125,
        383146.1562, 383167.4062, 383171.1562, 383219.3125, 762225.3750,
        768745.8125, 769242.1250, 769444.4375, 792109.0000, 797894.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 377518.3750, 377527.7188, 377536.0312, 377539.4375,
        377552.8438, 377562.0312, 377564.9375, 377570.2500, 763342.4375,
        765871.8750, 769444.4375, 778662.8125, 782347.6875, 786394.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6923e+00, 1.7022e+00, 1.8504e+00, 1.8808e+00, 1.9371e+00,
        1.9387e+00, 2.0530e+00, 3.7757e+05, 3.8317e+05, 3.8674e+05, 3.8741e+05,
        3.9332e+05, 3.9400e+05, 3.9804e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6923e+00, 1.7142e+00, 1.7554e+00, 1.8284e+00, 1.8364e+00,
        1.8519e+00, 1.9254e+00, 3.7753e+05, 3.8314e+05, 3.8675e+05, 3.8744e+05,
        3.9332e+05, 3.9397e+05, 3.9801e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 398002.8750, 398005.1562, 398008.2500, 398014.8750,
        398023.6250, 398037.7188, 398059.2500, 398066.1250, 765871.8750,
        778103.6875, 783801.6250, 787071.2500, 797894.5625, 798007.3750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386680.1562, 386694.1875, 386702.1875, 386705.1875,
        386710.6875, 386719.6875, 386743.0625, 386754.6562, 763342.4375,
        769242.1250, 769836.1250, 772314.8750, 785372.5000, 798007.3750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6970e+00, 1.8141e+00, 1.9254e+00, 2.0111e+00, 2.0331e+00,
        2.0530e+00, 2.1713e+00, 3.7755e+05, 3.8315e+05, 3.8671e+05, 3.8745e+05,
        3.9326e+05, 3.9401e+05, 3.9807e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393944.4375, 393954.3438, 393967.2500, 393971.7188,
        393980.9375, 394001.1562, 394001.6875, 394013.4375, 762225.3750,
        769836.1250, 771985.3750, 778103.6875, 786394.0625, 789409.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6970e+00, 1.8519e+00, 1.8902e+00, 1.9096e+00, 1.9118e+00,
        1.9387e+00, 2.0384e+00, 3.7754e+05, 3.8322e+05, 3.8671e+05, 3.8743e+05,
        3.9329e+05, 3.9398e+05, 3.9801e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7554e+00, 1.7829e+00, 1.9096e+00, 1.9371e+00, 1.9912e+00,
        2.0111e+00, 2.0848e+00, 3.7756e+05, 3.8314e+05, 3.8670e+05, 3.8742e+05,
        3.9329e+05, 3.9397e+05, 3.9800e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393255.4375, 393285.8438, 393288.9062, 393291.8750,
        393294.8125, 393307.0000, 393316.7812, 393321.7812, 767433.6250,
        768745.8125, 771985.3750, 772314.8750, 782347.6875, 783801.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387410.6250, 387421.0625, 387425.4062, 387441.2812,
        387441.8438, 387452.3125, 387454.9688, 387456.0625, 767433.6250,
        778662.8125, 785372.5000, 787071.2500, 789409.2500, 792109.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7022e+00, 1.8364e+00, 1.9297e+00, 1.9665e+00, 2.0331e+00,
        2.0384e+00, 2.0848e+00, 3.7752e+05, 3.8315e+05, 3.8668e+05, 3.8745e+05,
        3.9331e+05, 3.9400e+05, 3.9802e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7142e+00, 1.7829e+00, 1.8141e+00, 1.8504e+00, 1.8811e+00,
        1.9118e+00, 1.9297e+00, 3.7756e+05, 3.8313e+05, 3.8669e+05, 3.8744e+05,
        3.9329e+05, 3.9395e+05, 3.9806e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['84524.53', '425276.62', '420412.69', '84527.85', '84520.48', '438898.84', '428561.38', '84523.59', '434895.59', '84530.22', '84524.69', '434866.25', '429659.66', '84519.79', '84522.38']
estimated f for each client, fs: [7, 5, 6, 7, 7, 5, 5, 7, 5, 7, 7, 5, 5, 7, 7]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']], selected_client_indices: [7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0141s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:52...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:28:52, End: 2025-07-22 15:28:52)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [2, 19, 17, 1, 8, 4, 3, 13, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 3.8897e+05, 3.8548e+05, 1.6193e+00, 1.6102e+00, 1.4891e+00,
         1.5103e+00, 3.9017e+05, 1.4556e+00, 3.8886e+05, 1.5031e+00, 1.5275e+00],
        [3.8897e+05, 0.0000e+00, 7.8951e+05, 3.8897e+05, 3.8897e+05, 3.8897e+05,
         3.8899e+05, 7.6264e+05, 3.8901e+05, 7.7801e+05, 3.8896e+05, 3.8898e+05],
        [3.8548e+05, 7.8951e+05, 0.0000e+00, 3.8546e+05, 3.8549e+05, 3.8545e+05,
         3.8549e+05, 7.9221e+05, 3.8546e+05, 7.8201e+05, 3.8543e+05, 3.8546e+05],
        [1.6193e+00, 3.8897e+05, 3.8546e+05, 0.0000e+00, 1.7494e+00, 1.6289e+00,
         1.6314e+00, 3.9018e+05, 1.5628e+00, 3.8887e+05, 1.4597e+00, 1.5839e+00],
        [1.6102e+00, 3.8897e+05, 3.8549e+05, 1.7494e+00, 0.0000e+00, 1.4127e+00,
         1.6629e+00, 3.9015e+05, 1.4189e+00, 3.8887e+05, 1.6433e+00, 1.5091e+00],
        [1.4891e+00, 3.8897e+05, 3.8545e+05, 1.6289e+00, 1.4127e+00, 0.0000e+00,
         1.5364e+00, 3.9020e+05, 1.4434e+00, 3.8885e+05, 1.4990e+00, 1.4378e+00],
        [1.5103e+00, 3.8899e+05, 3.8549e+05, 1.6314e+00, 1.6629e+00, 1.5364e+00,
         0.0000e+00, 3.9016e+05, 1.4321e+00, 3.8885e+05, 1.5391e+00, 1.4247e+00],
        [3.9017e+05, 7.6264e+05, 7.9221e+05, 3.9018e+05, 3.9015e+05, 3.9020e+05,
         3.9016e+05, 0.0000e+00, 3.9019e+05, 7.9025e+05, 3.9018e+05, 3.9018e+05],
        [1.4556e+00, 3.8901e+05, 3.8546e+05, 1.5628e+00, 1.4189e+00, 1.4434e+00,
         1.4321e+00, 3.9019e+05, 0.0000e+00, 3.8883e+05, 1.5234e+00, 1.4757e+00],
        [3.8886e+05, 7.7801e+05, 7.8201e+05, 3.8887e+05, 3.8887e+05, 3.8885e+05,
         3.8885e+05, 7.9025e+05, 3.8883e+05, 0.0000e+00, 3.8880e+05, 3.8885e+05],
        [1.5031e+00, 3.8896e+05, 3.8543e+05, 1.4597e+00, 1.6433e+00, 1.4990e+00,
         1.5391e+00, 3.9018e+05, 1.5234e+00, 3.8880e+05, 0.0000e+00, 1.5363e+00],
        [1.5275e+00, 3.8898e+05, 3.8546e+05, 1.5839e+00, 1.5091e+00, 1.4378e+00,
         1.4247e+00, 3.9018e+05, 1.4757e+00, 3.8885e+05, 1.5363e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4556e+00, 1.4891e+00, 1.5031e+00, 1.5103e+00, 1.5275e+00,
        1.6102e+00, 1.6193e+00, 3.8548e+05, 3.8886e+05, 3.8897e+05, 3.9017e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 388959.9375, 388965.1875, 388968.9375, 388970.6562,
        388972.6875, 388980.5312, 388989.3125, 389007.6562, 762642.6875,
        778006.4375, 789507.4375])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 385431.5000, 385452.8438, 385460.0625, 385463.4062,
        385463.4688, 385481.4375, 385490.8125, 385493.4375, 782010.4375,
        789507.4375, 792206.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.4597e+00, 1.5628e+00, 1.5839e+00, 1.6193e+00, 1.6289e+00,
        1.6314e+00, 1.7494e+00, 3.8546e+05, 3.8887e+05, 3.8897e+05, 3.9018e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.4127e+00, 1.4189e+00, 1.5091e+00, 1.6102e+00, 1.6433e+00,
        1.6629e+00, 1.7494e+00, 3.8549e+05, 3.8887e+05, 3.8897e+05, 3.9015e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.4127e+00, 1.4378e+00, 1.4434e+00, 1.4891e+00, 1.4990e+00,
        1.5364e+00, 1.6289e+00, 3.8545e+05, 3.8885e+05, 3.8897e+05, 3.9020e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.4247e+00, 1.4321e+00, 1.5103e+00, 1.5364e+00, 1.5391e+00,
        1.6314e+00, 1.6629e+00, 3.8549e+05, 3.8885e+05, 3.8899e+05, 3.9016e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 390146.0312, 390157.9375, 390174.3125, 390176.3125,
        390177.2812, 390177.9375, 390193.8438, 390199.9375, 762642.6875,
        790248.9375, 792206.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.4189e+00, 1.4321e+00, 1.4434e+00, 1.4556e+00, 1.4757e+00,
        1.5234e+00, 1.5628e+00, 3.8546e+05, 3.8883e+05, 3.8901e+05, 3.9019e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 388800.6875, 388834.1875, 388845.0312, 388849.7500,
        388854.7188, 388856.3125, 388865.2500, 388870.6562, 778006.4375,
        782010.4375, 790248.9375])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.4597e+00, 1.4990e+00, 1.5031e+00, 1.5234e+00, 1.5363e+00,
        1.5391e+00, 1.6433e+00, 3.8543e+05, 3.8880e+05, 3.8896e+05, 3.9018e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.4247e+00, 1.4378e+00, 1.4757e+00, 1.5091e+00, 1.5275e+00,
        1.5363e+00, 1.5839e+00, 3.8546e+05, 3.8885e+05, 3.8898e+05, 3.9018e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['48186.52', '388976.88', '385467.12', '48183.91', '48187.73', '48182.91', '48188.02', '390175.47', '48184.23', '388847.09', '48180.28', '48184.24']
estimated f for each client, fs: [4, 2, 3, 4, 4, 4, 4, 2, 4, 3, 4, 4]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']], selected_client_indices: [2, 19, 17, 1, 8, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0097s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:53...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:28:53, End: 2025-07-22 15:28:53)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 2, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.6266e+00, 3.9392e+05, 3.8214e+05, 1.5884e+00, 1.6043e+00,
         3.8756e+05, 1.7248e+00, 3.6560e+05, 1.5559e+00, 1.5388e+00, 3.8638e+05,
         1.7132e+00, 1.5833e+00, 4.0312e+05, 1.7077e+00, 1.5161e+00],
        [1.6266e+00, 0.0000e+00, 3.9392e+05, 3.8215e+05, 1.5754e+00, 1.5384e+00,
         3.8757e+05, 1.5830e+00, 3.6562e+05, 1.5418e+00, 1.5853e+00, 3.8644e+05,
         1.7904e+00, 1.5018e+00, 4.0312e+05, 1.7062e+00, 1.5431e+00],
        [3.9392e+05, 3.9392e+05, 0.0000e+00, 7.7585e+05, 3.9391e+05, 3.9394e+05,
         7.7189e+05, 3.9393e+05, 7.6389e+05, 3.9392e+05, 3.9394e+05, 7.8061e+05,
         3.9387e+05, 3.9390e+05, 7.8454e+05, 3.9392e+05, 3.9392e+05],
        [3.8214e+05, 3.8215e+05, 7.7585e+05, 0.0000e+00, 3.8212e+05, 3.8213e+05,
         7.6601e+05, 3.8214e+05, 7.6549e+05, 3.8214e+05, 3.8216e+05, 7.8076e+05,
         3.8213e+05, 3.8218e+05, 7.9309e+05, 3.8215e+05, 3.8215e+05],
        [1.5884e+00, 1.5754e+00, 3.9391e+05, 3.8212e+05, 0.0000e+00, 1.4713e+00,
         3.8755e+05, 1.7055e+00, 3.6561e+05, 1.7104e+00, 1.6287e+00, 3.8641e+05,
         1.5082e+00, 1.5437e+00, 4.0312e+05, 1.4857e+00, 1.5860e+00],
        [1.6043e+00, 1.5384e+00, 3.9394e+05, 3.8213e+05, 1.4713e+00, 0.0000e+00,
         3.8755e+05, 1.6535e+00, 3.6560e+05, 1.6346e+00, 1.5413e+00, 3.8641e+05,
         1.6899e+00, 1.4390e+00, 4.0315e+05, 1.6206e+00, 1.5896e+00],
        [3.8756e+05, 3.8757e+05, 7.7189e+05, 7.6601e+05, 3.8755e+05, 3.8755e+05,
         0.0000e+00, 3.8755e+05, 7.3696e+05, 3.8757e+05, 3.8757e+05, 7.6652e+05,
         3.8756e+05, 3.8756e+05, 8.1001e+05, 3.8755e+05, 3.8756e+05],
        [1.7248e+00, 1.5830e+00, 3.9393e+05, 3.8214e+05, 1.7055e+00, 1.6535e+00,
         3.8755e+05, 0.0000e+00, 3.6559e+05, 1.4450e+00, 1.6525e+00, 3.8639e+05,
         1.8510e+00, 1.4384e+00, 4.0312e+05, 1.8075e+00, 1.4981e+00],
        [3.6560e+05, 3.6562e+05, 7.6389e+05, 7.6549e+05, 3.6561e+05, 3.6560e+05,
         7.3696e+05, 3.6559e+05, 0.0000e+00, 3.6560e+05, 3.6561e+05, 7.5775e+05,
         3.6564e+05, 3.6562e+05, 7.8076e+05, 3.6561e+05, 3.6559e+05],
        [1.5559e+00, 1.5418e+00, 3.9392e+05, 3.8214e+05, 1.7104e+00, 1.6346e+00,
         3.8757e+05, 1.4450e+00, 3.6560e+05, 0.0000e+00, 1.6254e+00, 3.8640e+05,
         1.9461e+00, 1.5490e+00, 4.0313e+05, 1.8297e+00, 1.4917e+00],
        [1.5388e+00, 1.5853e+00, 3.9394e+05, 3.8216e+05, 1.6287e+00, 1.5413e+00,
         3.8757e+05, 1.6525e+00, 3.6561e+05, 1.6254e+00, 0.0000e+00, 3.8641e+05,
         1.8600e+00, 1.4768e+00, 4.0309e+05, 1.8040e+00, 1.4949e+00],
        [3.8638e+05, 3.8644e+05, 7.8061e+05, 7.8076e+05, 3.8641e+05, 3.8641e+05,
         7.6652e+05, 3.8639e+05, 7.5775e+05, 3.8640e+05, 3.8641e+05, 0.0000e+00,
         3.8639e+05, 3.8642e+05, 7.7772e+05, 3.8635e+05, 3.8642e+05],
        [1.7132e+00, 1.7904e+00, 3.9387e+05, 3.8213e+05, 1.5082e+00, 1.6899e+00,
         3.8756e+05, 1.8510e+00, 3.6564e+05, 1.9461e+00, 1.8600e+00, 3.8639e+05,
         0.0000e+00, 1.7848e+00, 4.0309e+05, 1.4386e+00, 1.8498e+00],
        [1.5833e+00, 1.5018e+00, 3.9390e+05, 3.8218e+05, 1.5437e+00, 1.4390e+00,
         3.8756e+05, 1.4384e+00, 3.6562e+05, 1.5490e+00, 1.4768e+00, 3.8642e+05,
         1.7848e+00, 0.0000e+00, 4.0310e+05, 1.7282e+00, 1.4257e+00],
        [4.0312e+05, 4.0312e+05, 7.8454e+05, 7.9309e+05, 4.0312e+05, 4.0315e+05,
         8.1001e+05, 4.0312e+05, 7.8076e+05, 4.0313e+05, 4.0309e+05, 7.7772e+05,
         4.0309e+05, 4.0310e+05, 0.0000e+00, 4.0311e+05, 4.0307e+05],
        [1.7077e+00, 1.7062e+00, 3.9392e+05, 3.8215e+05, 1.4857e+00, 1.6206e+00,
         3.8755e+05, 1.8075e+00, 3.6561e+05, 1.8297e+00, 1.8040e+00, 3.8635e+05,
         1.4386e+00, 1.7282e+00, 4.0311e+05, 0.0000e+00, 1.7276e+00],
        [1.5161e+00, 1.5431e+00, 3.9392e+05, 3.8215e+05, 1.5860e+00, 1.5896e+00,
         3.8756e+05, 1.4981e+00, 3.6559e+05, 1.4917e+00, 1.4949e+00, 3.8642e+05,
         1.8498e+00, 1.4257e+00, 4.0307e+05, 1.7276e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5161e+00, 1.5388e+00, 1.5559e+00, 1.5833e+00, 1.5884e+00,
        1.6043e+00, 1.6266e+00, 1.7077e+00, 1.7132e+00, 1.7248e+00, 3.6560e+05,
        3.8214e+05, 3.8638e+05, 3.8756e+05, 3.9392e+05, 4.0312e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5018e+00, 1.5384e+00, 1.5418e+00, 1.5431e+00, 1.5754e+00,
        1.5830e+00, 1.5853e+00, 1.6266e+00, 1.7062e+00, 1.7904e+00, 3.6562e+05,
        3.8215e+05, 3.8644e+05, 3.8757e+05, 3.9392e+05, 4.0312e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393866.3438, 393901.2188, 393908.9375, 393915.0625,
        393921.5938, 393924.1250, 393924.2500, 393924.4688, 393929.8750,
        393935.9688, 393937.6250, 763894.0625, 771892.1250, 775851.5000,
        780605.3750, 784539.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382122.1250, 382127.5312, 382128.3438, 382135.6875,
        382136.1250, 382144.5625, 382147.3750, 382148.2812, 382150.0625,
        382159.3750, 382175.2500, 765486.9375, 766007.2500, 775851.5000,
        780760.8125, 793086.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4713e+00, 1.4857e+00, 1.5082e+00, 1.5437e+00, 1.5754e+00,
        1.5860e+00, 1.5884e+00, 1.6287e+00, 1.7055e+00, 1.7104e+00, 3.6561e+05,
        3.8212e+05, 3.8641e+05, 3.8755e+05, 3.9391e+05, 4.0312e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4390e+00, 1.4713e+00, 1.5384e+00, 1.5413e+00, 1.5896e+00,
        1.6043e+00, 1.6206e+00, 1.6346e+00, 1.6535e+00, 1.6899e+00, 3.6560e+05,
        3.8213e+05, 3.8641e+05, 3.8755e+05, 3.9394e+05, 4.0315e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387546.2500, 387551.1250, 387552.0625, 387554.6562,
        387556.2188, 387558.8438, 387560.0625, 387561.0000, 387567.5625,
        387567.8750, 387568.0000, 736955.8750, 766007.2500, 766518.8750,
        771892.1250, 810008.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4384e+00, 1.4450e+00, 1.4981e+00, 1.5830e+00, 1.6525e+00,
        1.6535e+00, 1.7055e+00, 1.7248e+00, 1.8075e+00, 1.8510e+00, 3.6559e+05,
        3.8214e+05, 3.8639e+05, 3.8755e+05, 3.9393e+05, 4.0312e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 365591.5312, 365593.6562, 365596.1250, 365596.5312,
        365600.8438, 365607.1562, 365608.1875, 365613.5625, 365620.1562,
        365624.0312, 365644.4688, 736955.8750, 757749.1250, 763894.0625,
        765486.9375, 780758.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4450e+00, 1.4917e+00, 1.5418e+00, 1.5490e+00, 1.5559e+00,
        1.6254e+00, 1.6346e+00, 1.7104e+00, 1.8297e+00, 1.9461e+00, 3.6560e+05,
        3.8214e+05, 3.8640e+05, 3.8757e+05, 3.9392e+05, 4.0313e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4768e+00, 1.4949e+00, 1.5388e+00, 1.5413e+00, 1.5853e+00,
        1.6254e+00, 1.6287e+00, 1.6525e+00, 1.8040e+00, 1.8600e+00, 3.6561e+05,
        3.8216e+05, 3.8641e+05, 3.8757e+05, 3.9394e+05, 4.0309e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386349.4062, 386378.1562, 386385.8750, 386392.6562,
        386400.9062, 386408.3750, 386410.1875, 386414.5938, 386419.6875,
        386423.5625, 386443.3438, 757749.1250, 766518.8750, 777718.8750,
        780605.3750, 780760.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4386e+00, 1.5082e+00, 1.6899e+00, 1.7132e+00, 1.7848e+00,
        1.7904e+00, 1.8498e+00, 1.8510e+00, 1.8600e+00, 1.9461e+00, 3.6564e+05,
        3.8213e+05, 3.8639e+05, 3.8756e+05, 3.9387e+05, 4.0309e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4257e+00, 1.4384e+00, 1.4390e+00, 1.4768e+00, 1.5018e+00,
        1.5437e+00, 1.5490e+00, 1.5833e+00, 1.7282e+00, 1.7848e+00, 3.6562e+05,
        3.8218e+05, 3.8642e+05, 3.8756e+05, 3.9390e+05, 4.0310e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403066.1562, 403091.7188, 403094.1562, 403103.0625,
        403113.5312, 403115.5000, 403117.3125, 403122.5938, 403123.5625,
        403126.6562, 403154.0312, 777718.8750, 780758.6250, 784539.6250,
        793086.2500, 810008.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4386e+00, 1.4857e+00, 1.6206e+00, 1.7062e+00, 1.7077e+00,
        1.7276e+00, 1.7282e+00, 1.8040e+00, 1.8075e+00, 1.8297e+00, 3.6561e+05,
        3.8215e+05, 3.8635e+05, 3.8755e+05, 3.9392e+05, 4.0311e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4257e+00, 1.4917e+00, 1.4949e+00, 1.4981e+00, 1.5161e+00,
        1.5431e+00, 1.5860e+00, 1.5896e+00, 1.7276e+00, 1.8498e+00, 3.6559e+05,
        3.8215e+05, 3.8642e+05, 3.8756e+05, 3.9392e+05, 4.0307e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.62', '1.60', '393917.19', '382139.91', '1.58', '1.58', '387558.50', '1.64', '365605.19', '1.63', '1.62', '386402.44', '1.74', '1.55', '403111.66', '1.69', '1.57']
estimated f for each client, fs: [6, 6, 4, 6, 6, 6, 4, 6, 6, 6, 6, 4, 6, 6, 4, 6, 6]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0320s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:53...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:28:53, End: 2025-07-22 15:28:53)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 17, 1, 20, 18, 8, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.7501e+00, 1.7212e+00, 3.9117e+05, 1.6561e+00, 3.8817e+05,
         3.8917e+05, 1.8351e+00, 1.6408e+00, 3.9052e+05, 3.8429e+05, 1.7174e+00,
         1.7952e+00, 3.9341e+05, 1.7108e+00, 1.5665e+00],
        [1.7501e+00, 0.0000e+00, 1.6064e+00, 3.9116e+05, 1.6117e+00, 3.8815e+05,
         3.8913e+05, 1.7789e+00, 1.7647e+00, 3.9052e+05, 3.8429e+05, 1.8314e+00,
         1.8283e+00, 3.9340e+05, 1.8472e+00, 1.7581e+00],
        [1.7212e+00, 1.6064e+00, 0.0000e+00, 3.9110e+05, 1.6439e+00, 3.8820e+05,
         3.8914e+05, 1.6682e+00, 1.7031e+00, 3.9054e+05, 3.8430e+05, 1.8454e+00,
         1.6637e+00, 3.9336e+05, 1.7106e+00, 1.5731e+00],
        [3.9117e+05, 3.9116e+05, 3.9110e+05, 0.0000e+00, 3.9113e+05, 7.8058e+05,
         7.8636e+05, 3.9113e+05, 3.9112e+05, 7.8615e+05, 7.5749e+05, 3.9113e+05,
         3.9113e+05, 7.7207e+05, 3.9115e+05, 3.9114e+05],
        [1.6561e+00, 1.6117e+00, 1.6439e+00, 3.9113e+05, 0.0000e+00, 3.8817e+05,
         3.8916e+05, 1.7434e+00, 1.6460e+00, 3.9050e+05, 3.8433e+05, 1.4932e+00,
         1.6395e+00, 3.9337e+05, 1.4512e+00, 1.6589e+00],
        [3.8817e+05, 3.8815e+05, 3.8820e+05, 7.8058e+05, 3.8817e+05, 0.0000e+00,
         7.7537e+05, 3.8818e+05, 3.8816e+05, 7.4052e+05, 7.7470e+05, 3.8820e+05,
         3.8819e+05, 7.9220e+05, 3.8815e+05, 3.8815e+05],
        [3.8917e+05, 3.8913e+05, 3.8914e+05, 7.8636e+05, 3.8916e+05, 7.7537e+05,
         0.0000e+00, 3.8914e+05, 3.8912e+05, 7.8518e+05, 7.8418e+05, 3.8917e+05,
         3.8913e+05, 7.9390e+05, 3.8911e+05, 3.8912e+05],
        [1.8351e+00, 1.7789e+00, 1.6682e+00, 3.9113e+05, 1.7434e+00, 3.8818e+05,
         3.8914e+05, 0.0000e+00, 1.7893e+00, 3.9055e+05, 3.8432e+05, 1.8550e+00,
         1.8319e+00, 3.9340e+05, 1.7952e+00, 1.6217e+00],
        [1.6408e+00, 1.7647e+00, 1.7031e+00, 3.9112e+05, 1.6460e+00, 3.8816e+05,
         3.8912e+05, 1.7893e+00, 0.0000e+00, 3.9054e+05, 3.8430e+05, 1.8864e+00,
         1.7231e+00, 3.9340e+05, 1.7824e+00, 1.6405e+00],
        [3.9052e+05, 3.9052e+05, 3.9054e+05, 7.8615e+05, 3.9050e+05, 7.4052e+05,
         7.8518e+05, 3.9055e+05, 3.9054e+05, 0.0000e+00, 7.9433e+05, 3.9052e+05,
         3.9054e+05, 7.8359e+05, 3.9055e+05, 3.9056e+05],
        [3.8429e+05, 3.8429e+05, 3.8430e+05, 7.5749e+05, 3.8433e+05, 7.7470e+05,
         7.8418e+05, 3.8432e+05, 3.8430e+05, 7.9433e+05, 0.0000e+00, 3.8428e+05,
         3.8433e+05, 7.7724e+05, 3.8429e+05, 3.8426e+05],
        [1.7174e+00, 1.8314e+00, 1.8454e+00, 3.9113e+05, 1.4932e+00, 3.8820e+05,
         3.8917e+05, 1.8550e+00, 1.8864e+00, 3.9052e+05, 3.8428e+05, 0.0000e+00,
         1.6510e+00, 3.9338e+05, 1.4239e+00, 1.8952e+00],
        [1.7952e+00, 1.8283e+00, 1.6637e+00, 3.9113e+05, 1.6395e+00, 3.8819e+05,
         3.8913e+05, 1.8319e+00, 1.7231e+00, 3.9054e+05, 3.8433e+05, 1.6510e+00,
         0.0000e+00, 3.9337e+05, 1.6228e+00, 1.7403e+00],
        [3.9341e+05, 3.9340e+05, 3.9336e+05, 7.7207e+05, 3.9337e+05, 7.9220e+05,
         7.9390e+05, 3.9340e+05, 3.9340e+05, 7.8359e+05, 7.7724e+05, 3.9338e+05,
         3.9337e+05, 0.0000e+00, 3.9339e+05, 3.9336e+05],
        [1.7108e+00, 1.8472e+00, 1.7106e+00, 3.9115e+05, 1.4512e+00, 3.8815e+05,
         3.8911e+05, 1.7952e+00, 1.7824e+00, 3.9055e+05, 3.8429e+05, 1.4239e+00,
         1.6228e+00, 3.9339e+05, 0.0000e+00, 1.6908e+00],
        [1.5665e+00, 1.7581e+00, 1.5731e+00, 3.9114e+05, 1.6589e+00, 3.8815e+05,
         3.8912e+05, 1.6217e+00, 1.6405e+00, 3.9056e+05, 3.8426e+05, 1.8952e+00,
         1.7403e+00, 3.9336e+05, 1.6908e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5665e+00, 1.6408e+00, 1.6561e+00, 1.7108e+00, 1.7174e+00,
        1.7212e+00, 1.7501e+00, 1.7952e+00, 1.8351e+00, 3.8429e+05, 3.8817e+05,
        3.8917e+05, 3.9052e+05, 3.9117e+05, 3.9341e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6064e+00, 1.6117e+00, 1.7501e+00, 1.7581e+00, 1.7647e+00,
        1.7789e+00, 1.8283e+00, 1.8314e+00, 1.8472e+00, 3.8429e+05, 3.8815e+05,
        3.8913e+05, 3.9052e+05, 3.9116e+05, 3.9340e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5731e+00, 1.6064e+00, 1.6439e+00, 1.6637e+00, 1.6682e+00,
        1.7031e+00, 1.7106e+00, 1.7212e+00, 1.8454e+00, 3.8430e+05, 3.8820e+05,
        3.8914e+05, 3.9054e+05, 3.9110e+05, 3.9336e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391100.0625, 391124.1250, 391128.5312, 391131.1875,
        391131.3438, 391133.8438, 391136.3125, 391146.6562, 391158.4688,
        391165.5312, 757486.5000, 772071.5000, 780577.5000, 786147.0625,
        786363.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4512e+00, 1.4932e+00, 1.6117e+00, 1.6395e+00, 1.6439e+00,
        1.6460e+00, 1.6561e+00, 1.6589e+00, 1.7434e+00, 3.8433e+05, 3.8817e+05,
        3.8916e+05, 3.9050e+05, 3.9113e+05, 3.9337e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388145.3125, 388145.5625, 388147.6250, 388160.8750,
        388168.7812, 388170.9688, 388176.0312, 388185.5000, 388197.4375,
        388203.1250, 740520.6250, 774702.6875, 775366.4375, 780577.5000,
        792196.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389114.8125, 389123.8750, 389124.6250, 389125.1562,
        389131.5625, 389137.8125, 389139.8125, 389164.6250, 389165.0938,
        389172.9688, 775366.4375, 784177.1250, 785177.0625, 786363.3750,
        793904.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6217e+00, 1.6682e+00, 1.7434e+00, 1.7789e+00, 1.7893e+00,
        1.7952e+00, 1.8319e+00, 1.8351e+00, 1.8550e+00, 3.8432e+05, 3.8818e+05,
        3.8914e+05, 3.9055e+05, 3.9113e+05, 3.9340e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6405e+00, 1.6408e+00, 1.6460e+00, 1.7031e+00, 1.7231e+00,
        1.7647e+00, 1.7824e+00, 1.7893e+00, 1.8864e+00, 3.8430e+05, 3.8816e+05,
        3.8912e+05, 3.9054e+05, 3.9112e+05, 3.9340e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390504.6875, 390515.3750, 390516.0000, 390519.0625,
        390537.0625, 390540.2500, 390542.1562, 390549.3438, 390552.1562,
        390564.1250, 740520.6250, 783589.8750, 785177.0625, 786147.0625,
        794332.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384263.0938, 384280.5938, 384288.6875, 384291.0000,
        384292.3125, 384301.7188, 384302.4375, 384322.7812, 384334.3125,
        384334.9062, 757486.5000, 774702.6875, 777236.9375, 784177.1250,
        794332.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4239e+00, 1.4932e+00, 1.6510e+00, 1.7174e+00, 1.8314e+00,
        1.8454e+00, 1.8550e+00, 1.8864e+00, 1.8952e+00, 3.8428e+05, 3.8820e+05,
        3.8917e+05, 3.9052e+05, 3.9113e+05, 3.9338e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6228e+00, 1.6395e+00, 1.6510e+00, 1.6637e+00, 1.7231e+00,
        1.7403e+00, 1.7952e+00, 1.8283e+00, 1.8319e+00, 3.8433e+05, 3.8819e+05,
        3.8913e+05, 3.9054e+05, 3.9113e+05, 3.9337e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393355.4375, 393364.8438, 393371.1875, 393371.8750,
        393376.0938, 393385.3125, 393398.7188, 393401.3438, 393401.9375,
        393407.6562, 772071.5000, 777236.9375, 783589.8750, 792196.6875,
        793904.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4239e+00, 1.4512e+00, 1.6228e+00, 1.6908e+00, 1.7106e+00,
        1.7108e+00, 1.7824e+00, 1.7952e+00, 1.8472e+00, 3.8429e+05, 3.8815e+05,
        3.8911e+05, 3.9055e+05, 3.9115e+05, 3.9339e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5665e+00, 1.5731e+00, 1.6217e+00, 1.6405e+00, 1.6589e+00,
        1.6908e+00, 1.7403e+00, 1.7581e+00, 1.8952e+00, 3.8426e+05, 3.8815e+05,
        3.8912e+05, 3.9056e+05, 3.9114e+05, 3.9336e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38430.77', '38430.68', '38431.75', '391135.56', '38434.89', '388170.12', '389140.00', '38433.87', '38431.73', '390534.03', '384301.19', '38429.62', '38435.04', '393383.44', '38430.37', '38427.82']
estimated f for each client, fs: [6, 6, 6, 4, 6, 4, 4, 6, 6, 4, 4, 6, 6, 4, 6, 6]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 17, 1, 20, 18, 8, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0118s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:54...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [ 74 189]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:28:54, End: 2025-07-22 15:28:54)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 17, 1, 9, 8, 15, 3, 13, 11, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.7510e+00, 1.8599e+00, 3.9195e+05, 1.6594e+00, 1.8011e+00,
         1.9545e+00, 3.8440e+05, 1.7175e+00, 3.9454e+05, 1.6438e+00, 1.7946e+00,
         3.8065e+05, 1.7251e+00, 1.6823e+00],
        [1.7510e+00, 0.0000e+00, 1.5375e+00, 3.9191e+05, 1.5509e+00, 1.5346e+00,
         1.7269e+00, 3.8442e+05, 1.6815e+00, 3.9453e+05, 1.6892e+00, 1.6831e+00,
         3.8067e+05, 1.7580e+00, 1.8047e+00],
        [1.8599e+00, 1.5375e+00, 0.0000e+00, 3.9188e+05, 1.5918e+00, 1.6270e+00,
         1.7544e+00, 3.8438e+05, 1.7284e+00, 3.9451e+05, 1.7561e+00, 1.6050e+00,
         3.8065e+05, 1.6964e+00, 1.6839e+00],
        [3.9195e+05, 3.9191e+05, 3.9188e+05, 0.0000e+00, 3.9192e+05, 3.9193e+05,
         3.9192e+05, 7.8775e+05, 3.9190e+05, 8.0860e+05, 3.9191e+05, 3.9190e+05,
         7.9869e+05, 3.9191e+05, 3.9193e+05],
        [1.6594e+00, 1.5509e+00, 1.5918e+00, 3.9192e+05, 0.0000e+00, 1.4648e+00,
         1.7655e+00, 3.8445e+05, 1.6939e+00, 3.9452e+05, 1.4385e+00, 1.5526e+00,
         3.8063e+05, 1.4379e+00, 1.6440e+00],
        [1.8011e+00, 1.5346e+00, 1.6270e+00, 3.9193e+05, 1.4648e+00, 0.0000e+00,
         1.7630e+00, 3.8441e+05, 1.6725e+00, 3.9453e+05, 1.5987e+00, 1.5304e+00,
         3.8067e+05, 1.6004e+00, 1.7531e+00],
        [1.9545e+00, 1.7269e+00, 1.7544e+00, 3.9192e+05, 1.7655e+00, 1.7630e+00,
         0.0000e+00, 3.8443e+05, 1.8602e+00, 3.9450e+05, 1.7453e+00, 1.7367e+00,
         3.8064e+05, 1.7832e+00, 1.7828e+00],
        [3.8440e+05, 3.8442e+05, 3.8438e+05, 7.8775e+05, 3.8445e+05, 3.8441e+05,
         3.8443e+05, 0.0000e+00, 3.8441e+05, 7.8566e+05, 3.8441e+05, 3.8442e+05,
         7.7692e+05, 3.8442e+05, 3.8443e+05],
        [1.7175e+00, 1.6815e+00, 1.7284e+00, 3.9190e+05, 1.6939e+00, 1.6725e+00,
         1.8602e+00, 3.8441e+05, 0.0000e+00, 3.9454e+05, 1.8124e+00, 1.6411e+00,
         3.8063e+05, 1.7693e+00, 1.6954e+00],
        [3.9454e+05, 3.9453e+05, 3.9451e+05, 8.0860e+05, 3.9452e+05, 3.9453e+05,
         3.9450e+05, 7.8566e+05, 3.9454e+05, 0.0000e+00, 3.9454e+05, 3.9453e+05,
         7.6027e+05, 3.9456e+05, 3.9457e+05],
        [1.6438e+00, 1.6892e+00, 1.7561e+00, 3.9191e+05, 1.4385e+00, 1.5987e+00,
         1.7453e+00, 3.8441e+05, 1.8124e+00, 3.9454e+05, 0.0000e+00, 1.5283e+00,
         3.8067e+05, 1.3735e+00, 1.6863e+00],
        [1.7946e+00, 1.6831e+00, 1.6050e+00, 3.9190e+05, 1.5526e+00, 1.5304e+00,
         1.7367e+00, 3.8442e+05, 1.6411e+00, 3.9453e+05, 1.5283e+00, 0.0000e+00,
         3.8065e+05, 1.5229e+00, 1.6003e+00],
        [3.8065e+05, 3.8067e+05, 3.8065e+05, 7.9869e+05, 3.8063e+05, 3.8067e+05,
         3.8064e+05, 7.7692e+05, 3.8063e+05, 7.6027e+05, 3.8067e+05, 3.8065e+05,
         0.0000e+00, 3.8065e+05, 3.8066e+05],
        [1.7251e+00, 1.7580e+00, 1.6964e+00, 3.9191e+05, 1.4379e+00, 1.6004e+00,
         1.7832e+00, 3.8442e+05, 1.7693e+00, 3.9456e+05, 1.3735e+00, 1.5229e+00,
         3.8065e+05, 0.0000e+00, 1.5999e+00],
        [1.6823e+00, 1.8047e+00, 1.6839e+00, 3.9193e+05, 1.6440e+00, 1.7531e+00,
         1.7828e+00, 3.8443e+05, 1.6954e+00, 3.9457e+05, 1.6863e+00, 1.6003e+00,
         3.8066e+05, 1.5999e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6438e+00, 1.6594e+00, 1.6823e+00, 1.7175e+00, 1.7251e+00,
        1.7510e+00, 1.7946e+00, 1.8011e+00, 1.8599e+00, 1.9545e+00, 3.8065e+05,
        3.8440e+05, 3.9195e+05, 3.9454e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5346e+00, 1.5375e+00, 1.5509e+00, 1.6815e+00, 1.6831e+00,
        1.6892e+00, 1.7269e+00, 1.7510e+00, 1.7580e+00, 1.8047e+00, 3.8067e+05,
        3.8442e+05, 3.9191e+05, 3.9453e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5375e+00, 1.5918e+00, 1.6050e+00, 1.6270e+00, 1.6839e+00,
        1.6964e+00, 1.7284e+00, 1.7544e+00, 1.7561e+00, 1.8599e+00, 3.8065e+05,
        3.8438e+05, 3.9188e+05, 3.9451e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391884.1562, 391896.1562, 391903.9062, 391910.3125,
        391912.2188, 391914.9688, 391917.1875, 391923.0625, 391925.7500,
        391926.1875, 391950.3750, 787754.5625, 798693.1875, 808602.4375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4379e+00, 1.4385e+00, 1.4648e+00, 1.5509e+00, 1.5526e+00,
        1.5918e+00, 1.6440e+00, 1.6594e+00, 1.6939e+00, 1.7655e+00, 3.8063e+05,
        3.8445e+05, 3.9192e+05, 3.9452e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4648e+00, 1.5304e+00, 1.5346e+00, 1.5987e+00, 1.6004e+00,
        1.6270e+00, 1.6725e+00, 1.7531e+00, 1.7630e+00, 1.8011e+00, 3.8067e+05,
        3.8441e+05, 3.9193e+05, 3.9453e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7269e+00, 1.7367e+00, 1.7453e+00, 1.7544e+00, 1.7630e+00,
        1.7655e+00, 1.7828e+00, 1.7832e+00, 1.8602e+00, 1.9545e+00, 3.8064e+05,
        3.8443e+05, 3.9192e+05, 3.9450e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 384378.9062, 384401.0938, 384409.2188, 384409.9062,
        384414.1250, 384420.3438, 384421.1562, 384421.8750, 384427.4688,
        384430.4688, 384448.0625, 776924.8125, 785663.3125, 787754.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6411e+00, 1.6725e+00, 1.6815e+00, 1.6939e+00, 1.6954e+00,
        1.7175e+00, 1.7284e+00, 1.7693e+00, 1.8124e+00, 1.8602e+00, 3.8063e+05,
        3.8441e+05, 3.9190e+05, 3.9454e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394497.8750, 394510.6562, 394523.0938, 394527.7500,
        394530.7500, 394534.6250, 394536.2812, 394539.9062, 394544.4375,
        394555.9375, 394566.6875, 760265.5625, 785663.3125, 808602.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3735e+00, 1.4385e+00, 1.5283e+00, 1.5987e+00, 1.6438e+00,
        1.6863e+00, 1.6892e+00, 1.7453e+00, 1.7561e+00, 1.8124e+00, 3.8067e+05,
        3.8441e+05, 3.9191e+05, 3.9454e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5229e+00, 1.5283e+00, 1.5304e+00, 1.5526e+00, 1.6003e+00,
        1.6050e+00, 1.6411e+00, 1.6831e+00, 1.7367e+00, 1.7946e+00, 3.8065e+05,
        3.8442e+05, 3.9190e+05, 3.9453e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 380632.3125, 380633.1875, 380644.5000, 380646.7500,
        380649.4375, 380649.4688, 380651.0312, 380663.3125, 380665.7188,
        380666.7500, 380666.9688, 760265.5625, 776924.8125, 798693.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3735e+00, 1.4379e+00, 1.5229e+00, 1.5999e+00, 1.6004e+00,
        1.6964e+00, 1.7251e+00, 1.7580e+00, 1.7693e+00, 1.7832e+00, 3.8065e+05,
        3.8442e+05, 3.9191e+05, 3.9456e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5999e+00, 1.6003e+00, 1.6440e+00, 1.6823e+00, 1.6839e+00,
        1.6863e+00, 1.6954e+00, 1.7531e+00, 1.7828e+00, 1.8047e+00, 3.8066e+05,
        3.8443e+05, 3.9193e+05, 3.9457e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.74', '1.66', '1.66', '391909.75', '1.56', '1.62', '1.77', '384411.56', '1.71', '394533.50', '1.61', '1.60', '380651.75', '1.61', '1.68']
estimated f for each client, fs: [5, 5, 5, 5, 5, 5, 5, 5, 5, 2, 5, 5, 2, 5, 5]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 17, 1, 9, 8, 15, 3, 13, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0112s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:54...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[188  49]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:28:54, End: 2025-07-22 15:28:54)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.5965e+00, 1.6311e+00, 3.9257e+05, 3.8407e+05, 1.7546e+00,
         3.8415e+05, 4.0716e+05, 1.7590e+00, 3.7828e+05, 1.5754e+00, 1.5007e+00,
         3.8259e+05, 4.0508e+05, 1.6439e+00, 4.0243e+05, 1.6448e+00],
        [1.5965e+00, 0.0000e+00, 1.4337e+00, 3.9254e+05, 3.8406e+05, 1.8240e+00,
         3.8416e+05, 4.0717e+05, 1.6001e+00, 3.7829e+05, 1.4476e+00, 1.5427e+00,
         3.8260e+05, 4.0505e+05, 1.5726e+00, 4.0243e+05, 1.6568e+00],
        [1.6311e+00, 1.4337e+00, 0.0000e+00, 3.9251e+05, 3.8407e+05, 1.7063e+00,
         3.8414e+05, 4.0711e+05, 1.5283e+00, 3.7828e+05, 1.5414e+00, 1.5320e+00,
         3.8261e+05, 4.0504e+05, 1.4910e+00, 4.0242e+05, 1.5400e+00],
        [3.9257e+05, 3.9254e+05, 3.9251e+05, 0.0000e+00, 7.8232e+05, 3.9256e+05,
         7.9122e+05, 7.9479e+05, 3.9255e+05, 7.6577e+05, 3.9256e+05, 3.9251e+05,
         7.9203e+05, 8.0330e+05, 3.9252e+05, 8.1152e+05, 3.9253e+05],
        [3.8407e+05, 3.8406e+05, 3.8407e+05, 7.8232e+05, 0.0000e+00, 3.8405e+05,
         7.7888e+05, 8.0562e+05, 3.8409e+05, 7.3985e+05, 3.8408e+05, 3.8407e+05,
         7.6788e+05, 7.6616e+05, 3.8406e+05, 7.9061e+05, 3.8405e+05],
        [1.7546e+00, 1.8240e+00, 1.7063e+00, 3.9256e+05, 3.8405e+05, 0.0000e+00,
         3.8414e+05, 4.0709e+05, 1.8980e+00, 3.7829e+05, 1.9821e+00, 1.7424e+00,
         3.8260e+05, 4.0503e+05, 1.5991e+00, 4.0242e+05, 1.4530e+00],
        [3.8415e+05, 3.8416e+05, 3.8414e+05, 7.9122e+05, 7.7888e+05, 3.8414e+05,
         0.0000e+00, 7.9116e+05, 3.8417e+05, 7.7121e+05, 3.8413e+05, 3.8414e+05,
         7.5903e+05, 7.9582e+05, 3.8417e+05, 7.7168e+05, 3.8416e+05],
        [4.0716e+05, 4.0717e+05, 4.0711e+05, 7.9479e+05, 8.0562e+05, 4.0709e+05,
         7.9116e+05, 0.0000e+00, 4.0714e+05, 7.8975e+05, 4.0713e+05, 4.0715e+05,
         7.9383e+05, 8.1635e+05, 4.0715e+05, 8.1469e+05, 4.0712e+05],
        [1.7590e+00, 1.6001e+00, 1.5283e+00, 3.9255e+05, 3.8409e+05, 1.8980e+00,
         3.8417e+05, 4.0714e+05, 0.0000e+00, 3.7829e+05, 1.4816e+00, 1.6323e+00,
         3.8257e+05, 4.0509e+05, 1.5249e+00, 4.0242e+05, 1.6474e+00],
        [3.7828e+05, 3.7829e+05, 3.7828e+05, 7.6577e+05, 7.3985e+05, 3.7829e+05,
         7.7121e+05, 7.8975e+05, 3.7829e+05, 0.0000e+00, 3.7828e+05, 3.7831e+05,
         7.4460e+05, 7.8399e+05, 3.7824e+05, 7.7418e+05, 3.7827e+05],
        [1.5754e+00, 1.4476e+00, 1.5414e+00, 3.9256e+05, 3.8408e+05, 1.9821e+00,
         3.8413e+05, 4.0713e+05, 1.4816e+00, 3.7828e+05, 0.0000e+00, 1.6348e+00,
         3.8257e+05, 4.0504e+05, 1.6576e+00, 4.0242e+05, 1.6662e+00],
        [1.5007e+00, 1.5427e+00, 1.5320e+00, 3.9251e+05, 3.8407e+05, 1.7424e+00,
         3.8414e+05, 4.0715e+05, 1.6323e+00, 3.7831e+05, 1.6348e+00, 0.0000e+00,
         3.8258e+05, 4.0509e+05, 1.4756e+00, 4.0243e+05, 1.5941e+00],
        [3.8259e+05, 3.8260e+05, 3.8261e+05, 7.9203e+05, 7.6788e+05, 3.8260e+05,
         7.5903e+05, 7.9383e+05, 3.8257e+05, 7.4460e+05, 3.8257e+05, 3.8258e+05,
         0.0000e+00, 7.8582e+05, 3.8259e+05, 7.9352e+05, 3.8259e+05],
        [4.0508e+05, 4.0505e+05, 4.0504e+05, 8.0330e+05, 7.6616e+05, 4.0503e+05,
         7.9582e+05, 8.1635e+05, 4.0509e+05, 7.8399e+05, 4.0504e+05, 4.0509e+05,
         7.8582e+05, 0.0000e+00, 4.0508e+05, 8.1627e+05, 4.0505e+05],
        [1.6439e+00, 1.5726e+00, 1.4910e+00, 3.9252e+05, 3.8406e+05, 1.5991e+00,
         3.8417e+05, 4.0715e+05, 1.5249e+00, 3.7824e+05, 1.6576e+00, 1.4756e+00,
         3.8259e+05, 4.0508e+05, 0.0000e+00, 4.0242e+05, 1.4604e+00],
        [4.0243e+05, 4.0243e+05, 4.0242e+05, 8.1152e+05, 7.9061e+05, 4.0242e+05,
         7.7168e+05, 8.1469e+05, 4.0242e+05, 7.7418e+05, 4.0242e+05, 4.0243e+05,
         7.9352e+05, 8.1627e+05, 4.0242e+05, 0.0000e+00, 4.0244e+05],
        [1.6448e+00, 1.6568e+00, 1.5400e+00, 3.9253e+05, 3.8405e+05, 1.4530e+00,
         3.8416e+05, 4.0712e+05, 1.6474e+00, 3.7827e+05, 1.6662e+00, 1.5941e+00,
         3.8259e+05, 4.0505e+05, 1.4604e+00, 4.0244e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5007e+00, 1.5754e+00, 1.5965e+00, 1.6311e+00, 1.6439e+00,
        1.6448e+00, 1.7546e+00, 1.7590e+00, 3.7828e+05, 3.8259e+05, 3.8407e+05,
        3.8415e+05, 3.9257e+05, 4.0243e+05, 4.0508e+05, 4.0716e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4337e+00, 1.4476e+00, 1.5427e+00, 1.5726e+00, 1.5965e+00,
        1.6001e+00, 1.6568e+00, 1.8240e+00, 3.7829e+05, 3.8260e+05, 3.8406e+05,
        3.8416e+05, 3.9254e+05, 4.0243e+05, 4.0505e+05, 4.0717e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4337e+00, 1.4910e+00, 1.5283e+00, 1.5320e+00, 1.5400e+00,
        1.5414e+00, 1.6311e+00, 1.7063e+00, 3.7828e+05, 3.8261e+05, 3.8407e+05,
        3.8414e+05, 3.9251e+05, 4.0242e+05, 4.0504e+05, 4.0711e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392513.7500, 392514.9375, 392523.0000, 392527.0938,
        392540.5000, 392554.0938, 392556.9062, 392560.0000, 392570.2812,
        765770.3750, 782324.4375, 791218.3750, 792034.1250, 794786.1250,
        803295.6875, 811521.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384046.4062, 384052.1250, 384059.7500, 384060.2188,
        384067.5312, 384074.0000, 384074.4375, 384077.2188, 384086.6562,
        739845.4375, 766155.0625, 767881.9375, 778878.5625, 782324.4375,
        790612.6875, 805622.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4530e+00, 1.5991e+00, 1.7063e+00, 1.7424e+00, 1.7546e+00,
        1.8240e+00, 1.8980e+00, 1.9821e+00, 3.7829e+05, 3.8260e+05, 3.8405e+05,
        3.8414e+05, 3.9256e+05, 4.0242e+05, 4.0503e+05, 4.0709e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384134.8750, 384137.1875, 384138.0000, 384144.8125,
        384146.9375, 384160.0000, 384164.9688, 384172.8125, 384173.2500,
        759026.1250, 771211.3125, 771681.1250, 778878.5625, 791163.1250,
        791218.3750, 795815.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 407093.6250, 407106.4375, 407118.8125, 407127.2812,
        407135.6875, 407147.7500, 407154.0000, 407164.0625, 407167.6875,
        789754.3125, 791163.1250, 793826.5625, 794786.1250, 805622.6250,
        814690.7500, 816353.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4816e+00, 1.5249e+00, 1.5283e+00, 1.6001e+00, 1.6323e+00,
        1.6474e+00, 1.7590e+00, 1.8980e+00, 3.7829e+05, 3.8257e+05, 3.8409e+05,
        3.8417e+05, 3.9255e+05, 4.0242e+05, 4.0509e+05, 4.0714e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 378237.8750, 378273.7188, 378276.0938, 378277.8125,
        378283.8750, 378289.0625, 378291.6250, 378293.1562, 378306.0000,
        739845.4375, 744598.6250, 765770.3750, 771211.3125, 774178.9375,
        783990.6250, 789754.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4476e+00, 1.4816e+00, 1.5414e+00, 1.5754e+00, 1.6348e+00,
        1.6576e+00, 1.6662e+00, 1.9821e+00, 3.7828e+05, 3.8257e+05, 3.8408e+05,
        3.8413e+05, 3.9256e+05, 4.0242e+05, 4.0504e+05, 4.0713e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4756e+00, 1.5007e+00, 1.5320e+00, 1.5427e+00, 1.5941e+00,
        1.6323e+00, 1.6348e+00, 1.7424e+00, 3.7831e+05, 3.8258e+05, 3.8407e+05,
        3.8414e+05, 3.9251e+05, 4.0243e+05, 4.0509e+05, 4.0715e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382567.2188, 382574.8750, 382577.1250, 382585.1875,
        382586.4688, 382586.5000, 382597.4062, 382601.7500, 382606.1250,
        744598.6250, 759026.1250, 767881.9375, 785815.5000, 792034.1250,
        793521.3125, 793826.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405032.3438, 405037.2500, 405037.2812, 405049.2500,
        405050.8750, 405076.9062, 405082.2812, 405086.0312, 405087.8438,
        766155.0625, 783990.6250, 785815.5000, 795815.3750, 803295.6875,
        816273.6250, 816353.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4604e+00, 1.4756e+00, 1.4910e+00, 1.5249e+00, 1.5726e+00,
        1.5991e+00, 1.6439e+00, 1.6576e+00, 3.7824e+05, 3.8259e+05, 3.8406e+05,
        3.8417e+05, 3.9252e+05, 4.0242e+05, 4.0508e+05, 4.0715e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402417.3125, 402419.8438, 402420.4688, 402422.1875,
        402423.1250, 402427.2188, 402429.1875, 402430.5938, 402437.6250,
        771681.1250, 774178.9375, 790612.6875, 793521.3125, 811521.1250,
        814690.7500, 816273.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4530e+00, 1.4604e+00, 1.5400e+00, 1.5941e+00, 1.6448e+00,
        1.6474e+00, 1.6568e+00, 1.6662e+00, 3.7827e+05, 3.8259e+05, 3.8405e+05,
        3.8416e+05, 3.9253e+05, 4.0244e+05, 4.0505e+05, 4.0712e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76087.75', '76089.92', '76089.46', '429863.06', '419644.38', '76090.73', '421639.88', '445396.97', '76087.34', '414437.47', '76087.17', '76089.58', '418788.12', '441169.47', '76083.68', '439350.88', '76087.16']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 6, 6, 8, 6, 8, 8, 6, 6, 8, 6, 8]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0117s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:55...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[163  74]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:28:55, End: 2025-07-22 15:28:55)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.5291e+00, 1.5685e+00, 4.0022e+05, 3.8328e+05, 1.5467e+00,
         1.5291e+00, 3.9662e+05, 3.8788e+05, 1.6241e+00, 3.9604e+05, 1.5211e+00,
         3.9250e+05, 3.9104e+05, 1.5497e+00, 1.8306e+00, 3.9319e+05, 1.5747e+00,
         1.4322e+00],
        [1.5291e+00, 0.0000e+00, 1.3433e+00, 4.0024e+05, 3.8330e+05, 1.5448e+00,
         1.3821e+00, 3.9660e+05, 3.8790e+05, 1.4307e+00, 3.9605e+05, 1.3431e+00,
         3.9249e+05, 3.9100e+05, 1.5124e+00, 1.9085e+00, 3.9320e+05, 1.5237e+00,
         1.5325e+00],
        [1.5685e+00, 1.3433e+00, 0.0000e+00, 4.0024e+05, 3.8328e+05, 1.5405e+00,
         1.4055e+00, 3.9665e+05, 3.8791e+05, 1.4439e+00, 3.9604e+05, 1.4307e+00,
         3.9249e+05, 3.9103e+05, 1.5570e+00, 1.7828e+00, 3.9320e+05, 1.5030e+00,
         1.3834e+00],
        [4.0022e+05, 4.0024e+05, 4.0024e+05, 0.0000e+00, 7.8449e+05, 4.0026e+05,
         4.0023e+05, 8.2464e+05, 7.6606e+05, 4.0025e+05, 8.1438e+05, 4.0025e+05,
         8.0207e+05, 7.9582e+05, 4.0024e+05, 4.0028e+05, 7.8550e+05, 4.0025e+05,
         4.0023e+05],
        [3.8328e+05, 3.8330e+05, 3.8328e+05, 7.8449e+05, 0.0000e+00, 3.8329e+05,
         3.8329e+05, 7.8049e+05, 7.5877e+05, 3.8330e+05, 7.8234e+05, 3.8327e+05,
         7.8149e+05, 7.5811e+05, 3.8332e+05, 3.8327e+05, 7.9314e+05, 3.8331e+05,
         3.8329e+05],
        [1.5467e+00, 1.5448e+00, 1.5405e+00, 4.0026e+05, 3.8329e+05, 0.0000e+00,
         1.4229e+00, 3.9659e+05, 3.8791e+05, 1.6067e+00, 3.9604e+05, 1.6957e+00,
         3.9248e+05, 3.9106e+05, 1.2892e+00, 1.4197e+00, 3.9317e+05, 1.2949e+00,
         1.3615e+00],
        [1.5291e+00, 1.3821e+00, 1.4055e+00, 4.0023e+05, 3.8329e+05, 1.4229e+00,
         0.0000e+00, 3.9663e+05, 3.8791e+05, 1.4716e+00, 3.9601e+05, 1.5111e+00,
         3.9246e+05, 3.9103e+05, 1.4429e+00, 1.6494e+00, 3.9319e+05, 1.4658e+00,
         1.4455e+00],
        [3.9662e+05, 3.9660e+05, 3.9665e+05, 8.2464e+05, 7.8049e+05, 3.9659e+05,
         3.9663e+05, 0.0000e+00, 7.9778e+05, 3.9662e+05, 7.7031e+05, 3.9660e+05,
         8.0160e+05, 8.0688e+05, 3.9661e+05, 3.9663e+05, 8.1881e+05, 3.9654e+05,
         3.9663e+05],
        [3.8788e+05, 3.8790e+05, 3.8791e+05, 7.6606e+05, 7.5877e+05, 3.8791e+05,
         3.8791e+05, 7.9778e+05, 0.0000e+00, 3.8788e+05, 7.8279e+05, 3.8790e+05,
         7.7885e+05, 7.7545e+05, 3.8789e+05, 3.8794e+05, 7.7580e+05, 3.8794e+05,
         3.8790e+05],
        [1.6241e+00, 1.4307e+00, 1.4439e+00, 4.0025e+05, 3.8330e+05, 1.6067e+00,
         1.4716e+00, 3.9662e+05, 3.8788e+05, 0.0000e+00, 3.9606e+05, 1.3173e+00,
         3.9246e+05, 3.9100e+05, 1.5087e+00, 1.9603e+00, 3.9317e+05, 1.5115e+00,
         1.4134e+00],
        [3.9604e+05, 3.9605e+05, 3.9604e+05, 8.1438e+05, 7.8234e+05, 3.9604e+05,
         3.9601e+05, 7.7031e+05, 7.8279e+05, 3.9606e+05, 0.0000e+00, 3.9604e+05,
         8.0410e+05, 7.8420e+05, 3.9603e+05, 3.9605e+05, 7.7561e+05, 3.9609e+05,
         3.9608e+05],
        [1.5211e+00, 1.3431e+00, 1.4307e+00, 4.0025e+05, 3.8327e+05, 1.6957e+00,
         1.5111e+00, 3.9660e+05, 3.8790e+05, 1.3173e+00, 3.9604e+05, 0.0000e+00,
         3.9244e+05, 3.9102e+05, 1.6183e+00, 1.9985e+00, 3.9321e+05, 1.5500e+00,
         1.4489e+00],
        [3.9250e+05, 3.9249e+05, 3.9249e+05, 8.0207e+05, 7.8149e+05, 3.9248e+05,
         3.9246e+05, 8.0160e+05, 7.7885e+05, 3.9246e+05, 8.0410e+05, 3.9244e+05,
         0.0000e+00, 7.8225e+05, 3.9248e+05, 3.9247e+05, 8.0252e+05, 3.9249e+05,
         3.9248e+05],
        [3.9104e+05, 3.9100e+05, 3.9103e+05, 7.9582e+05, 7.5811e+05, 3.9106e+05,
         3.9103e+05, 8.0688e+05, 7.7545e+05, 3.9100e+05, 7.8420e+05, 3.9102e+05,
         7.8225e+05, 0.0000e+00, 3.9103e+05, 3.9103e+05, 7.6204e+05, 3.9107e+05,
         3.9106e+05],
        [1.5497e+00, 1.5124e+00, 1.5570e+00, 4.0024e+05, 3.8332e+05, 1.2892e+00,
         1.4429e+00, 3.9661e+05, 3.8789e+05, 1.5087e+00, 3.9603e+05, 1.6183e+00,
         3.9248e+05, 3.9103e+05, 0.0000e+00, 1.5068e+00, 3.9320e+05, 1.2683e+00,
         1.4415e+00],
        [1.8306e+00, 1.9085e+00, 1.7828e+00, 4.0028e+05, 3.8327e+05, 1.4197e+00,
         1.6494e+00, 3.9663e+05, 3.8794e+05, 1.9603e+00, 3.9605e+05, 1.9985e+00,
         3.9247e+05, 3.9103e+05, 1.5068e+00, 0.0000e+00, 3.9318e+05, 1.5815e+00,
         1.6294e+00],
        [3.9319e+05, 3.9320e+05, 3.9320e+05, 7.8550e+05, 7.9314e+05, 3.9317e+05,
         3.9319e+05, 8.1881e+05, 7.7580e+05, 3.9317e+05, 7.7561e+05, 3.9321e+05,
         8.0252e+05, 7.6204e+05, 3.9320e+05, 3.9318e+05, 0.0000e+00, 3.9321e+05,
         3.9319e+05],
        [1.5747e+00, 1.5237e+00, 1.5030e+00, 4.0025e+05, 3.8331e+05, 1.2949e+00,
         1.4658e+00, 3.9654e+05, 3.8794e+05, 1.5115e+00, 3.9609e+05, 1.5500e+00,
         3.9249e+05, 3.9107e+05, 1.2683e+00, 1.5815e+00, 3.9321e+05, 0.0000e+00,
         1.3662e+00],
        [1.4322e+00, 1.5325e+00, 1.3834e+00, 4.0023e+05, 3.8329e+05, 1.3615e+00,
         1.4455e+00, 3.9663e+05, 3.8790e+05, 1.4134e+00, 3.9608e+05, 1.4489e+00,
         3.9248e+05, 3.9106e+05, 1.4415e+00, 1.6294e+00, 3.9319e+05, 1.3662e+00,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4322e+00, 1.5211e+00, 1.5291e+00, 1.5291e+00, 1.5467e+00,
        1.5497e+00, 1.5685e+00, 1.5747e+00, 1.6241e+00, 1.8306e+00, 3.8328e+05,
        3.8788e+05, 3.9104e+05, 3.9250e+05, 3.9319e+05, 3.9604e+05, 3.9662e+05,
        4.0022e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3431e+00, 1.3433e+00, 1.3821e+00, 1.4307e+00, 1.5124e+00,
        1.5237e+00, 1.5291e+00, 1.5325e+00, 1.5448e+00, 1.9085e+00, 3.8330e+05,
        3.8790e+05, 3.9100e+05, 3.9249e+05, 3.9320e+05, 3.9605e+05, 3.9660e+05,
        4.0024e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3433e+00, 1.3834e+00, 1.4055e+00, 1.4307e+00, 1.4439e+00,
        1.5030e+00, 1.5405e+00, 1.5570e+00, 1.5685e+00, 1.7828e+00, 3.8328e+05,
        3.8791e+05, 3.9103e+05, 3.9249e+05, 3.9320e+05, 3.9604e+05, 3.9665e+05,
        4.0024e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 400223.5625, 400231.0625, 400231.1250, 400241.5312,
        400242.9062, 400244.2812, 400246.8438, 400252.0000, 400252.3125,
        400260.9375, 400276.5312, 766059.8125, 784489.1250, 785501.8125,
        795820.8750, 802065.2500, 814381.8750, 824640.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 383268.9688, 383272.8125, 383279.5938, 383281.9062,
        383288.3438, 383292.0000, 383294.0312, 383295.0625, 383300.7188,
        383310.6875, 383319.3438, 758108.3750, 758772.6875, 780494.0625,
        781485.5625, 782335.0000, 784489.1250, 793135.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2892e+00, 1.2949e+00, 1.3615e+00, 1.4197e+00, 1.4229e+00,
        1.5405e+00, 1.5448e+00, 1.5467e+00, 1.6067e+00, 1.6957e+00, 3.8329e+05,
        3.8791e+05, 3.9106e+05, 3.9248e+05, 3.9317e+05, 3.9604e+05, 3.9659e+05,
        4.0026e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3821e+00, 1.4055e+00, 1.4229e+00, 1.4429e+00, 1.4455e+00,
        1.4658e+00, 1.4716e+00, 1.5111e+00, 1.5291e+00, 1.6494e+00, 3.8329e+05,
        3.8791e+05, 3.9103e+05, 3.9246e+05, 3.9319e+05, 3.9601e+05, 3.9663e+05,
        4.0023e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396544.6875, 396593.3125, 396600.0625, 396602.0000,
        396605.3125, 396622.6250, 396624.3125, 396626.4688, 396627.0938,
        396627.6875, 396646.0000, 770314.2500, 780494.0625, 797777.8750,
        801598.5625, 806881.8750, 818811.3125, 824640.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387876.9375, 387878.5000, 387894.8750, 387896.3750,
        387896.5938, 387902.1875, 387907.3125, 387909.1875, 387911.8438,
        387937.8438, 387940.5625, 758772.6875, 766059.8125, 775454.8750,
        775801.1250, 778848.3750, 782787.3125, 797777.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3173e+00, 1.4134e+00, 1.4307e+00, 1.4439e+00, 1.4716e+00,
        1.5087e+00, 1.5115e+00, 1.6067e+00, 1.6241e+00, 1.9603e+00, 3.8330e+05,
        3.8788e+05, 3.9100e+05, 3.9246e+05, 3.9317e+05, 3.9606e+05, 3.9662e+05,
        4.0025e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396008.7812, 396031.4062, 396035.0000, 396039.3125,
        396040.5000, 396043.5312, 396046.3125, 396053.3125, 396055.0312,
        396079.3438, 396089.1250, 770314.2500, 775609.1250, 782335.0000,
        782787.3125, 784201.6250, 804098.8750, 814381.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3173e+00, 1.3431e+00, 1.4307e+00, 1.4489e+00, 1.5111e+00,
        1.5211e+00, 1.5500e+00, 1.6183e+00, 1.6957e+00, 1.9985e+00, 3.8327e+05,
        3.8790e+05, 3.9102e+05, 3.9244e+05, 3.9321e+05, 3.9604e+05, 3.9660e+05,
        4.0025e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392444.4062, 392457.6562, 392457.9688, 392468.1562,
        392475.3125, 392475.5625, 392482.0312, 392486.1875, 392490.5938,
        392490.8750, 392498.0000, 778848.3750, 781485.5625, 782250.7500,
        801598.5625, 802065.2500, 802515.9375, 804098.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 390995.8750, 391003.4062, 391020.9375, 391030.0938,
        391030.4375, 391033.0000, 391034.6250, 391040.5625, 391057.3125,
        391058.2812, 391074.3750, 758108.3750, 762043.5000, 775454.8750,
        782250.7500, 784201.6250, 795820.8750, 806881.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2683e+00, 1.2892e+00, 1.4415e+00, 1.4429e+00, 1.5068e+00,
        1.5087e+00, 1.5124e+00, 1.5497e+00, 1.5570e+00, 1.6183e+00, 3.8332e+05,
        3.8789e+05, 3.9103e+05, 3.9248e+05, 3.9320e+05, 3.9603e+05, 3.9661e+05,
        4.0024e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4197e+00, 1.5068e+00, 1.5815e+00, 1.6294e+00, 1.6494e+00,
        1.7828e+00, 1.8306e+00, 1.9085e+00, 1.9603e+00, 1.9985e+00, 3.8327e+05,
        3.8794e+05, 3.9103e+05, 3.9247e+05, 3.9318e+05, 3.9605e+05, 3.9663e+05,
        4.0028e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393169.1875, 393170.4062, 393179.6875, 393193.1562,
        393194.5625, 393194.8750, 393195.1250, 393198.8750, 393203.1875,
        393211.4062, 393213.2812, 762043.5000, 775609.1250, 775801.1250,
        785501.8125, 793135.5000, 802515.9375, 818811.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2683e+00, 1.2949e+00, 1.3662e+00, 1.4658e+00, 1.5030e+00,
        1.5115e+00, 1.5237e+00, 1.5500e+00, 1.5747e+00, 1.5815e+00, 3.8331e+05,
        3.8794e+05, 3.9107e+05, 3.9249e+05, 3.9321e+05, 3.9609e+05, 3.9654e+05,
        4.0025e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3615e+00, 1.3662e+00, 1.3834e+00, 1.4134e+00, 1.4322e+00,
        1.4415e+00, 1.4455e+00, 1.4489e+00, 1.5325e+00, 1.6294e+00, 3.8329e+05,
        3.8790e+05, 3.9106e+05, 3.9248e+05, 3.9319e+05, 3.9608e+05, 3.9663e+05,
        4.0023e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34845.24', '34846.89', '34844.96', '400245.75', '383291.22', '34846.26', '34846.07', '396610.88', '387904.75', '34846.40', '396047.41', '34844.39', '392475.19', '391034.44', '34848.56', '34844.20', '393193.06', '34847.76', '34845.71']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 8, 6, 6, 8, 6, 8, 6, 6, 8, 8, 6, 8, 8]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0312s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:56...
global Accuracy on shared test data: 71.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[158  79]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:28:56, End: 2025-07-22 15:28:56)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 19, 17, 1, 9, 18, 8, 15, 14, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.1422e+00, 1.1869e+00, 3.8474e+05, 4.0030e+05, 1.1594e+00,
         1.1605e+00, 3.9705e+05, 1.2070e+00, 3.9273e+05, 4.0546e+05, 1.8894e+00,
         3.9433e+05, 1.1719e+00],
        [1.1422e+00, 0.0000e+00, 1.0628e+00, 3.8474e+05, 4.0031e+05, 1.1893e+00,
         1.1076e+00, 3.9706e+05, 1.1170e+00, 3.9274e+05, 4.0543e+05, 2.1047e+00,
         3.9431e+05, 1.1787e+00],
        [1.1869e+00, 1.0628e+00, 0.0000e+00, 3.8471e+05, 4.0029e+05, 1.1761e+00,
         1.1379e+00, 3.9707e+05, 1.1252e+00, 3.9272e+05, 4.0546e+05, 1.9919e+00,
         3.9434e+05, 1.1656e+00],
        [3.8474e+05, 3.8474e+05, 3.8471e+05, 0.0000e+00, 8.2389e+05, 3.8473e+05,
         3.8475e+05, 7.7132e+05, 3.8474e+05, 7.9506e+05, 8.1405e+05, 3.8473e+05,
         7.7552e+05, 3.8472e+05],
        [4.0030e+05, 4.0031e+05, 4.0029e+05, 8.2389e+05, 0.0000e+00, 4.0026e+05,
         4.0028e+05, 8.0663e+05, 4.0029e+05, 7.9645e+05, 8.1407e+05, 4.0035e+05,
         7.8894e+05, 4.0030e+05],
        [1.1594e+00, 1.1893e+00, 1.1761e+00, 3.8473e+05, 4.0026e+05, 0.0000e+00,
         1.1020e+00, 3.9705e+05, 1.2074e+00, 3.9273e+05, 4.0546e+05, 1.4459e+00,
         3.9432e+05, 1.0002e+00],
        [1.1605e+00, 1.1076e+00, 1.1379e+00, 3.8475e+05, 4.0028e+05, 1.1020e+00,
         0.0000e+00, 3.9704e+05, 1.1481e+00, 3.9274e+05, 4.0545e+05, 1.8274e+00,
         3.9433e+05, 1.1367e+00],
        [3.9705e+05, 3.9706e+05, 3.9707e+05, 7.7132e+05, 8.0663e+05, 3.9705e+05,
         3.9704e+05, 0.0000e+00, 3.9705e+05, 7.7740e+05, 8.0959e+05, 3.9706e+05,
         8.1878e+05, 3.9707e+05],
        [1.2070e+00, 1.1170e+00, 1.1252e+00, 3.8474e+05, 4.0029e+05, 1.2074e+00,
         1.1481e+00, 3.9705e+05, 0.0000e+00, 3.9275e+05, 4.0546e+05, 2.1546e+00,
         3.9432e+05, 1.1397e+00],
        [3.9273e+05, 3.9274e+05, 3.9272e+05, 7.9506e+05, 7.9645e+05, 3.9273e+05,
         3.9274e+05, 7.7740e+05, 3.9275e+05, 0.0000e+00, 8.0336e+05, 3.9274e+05,
         7.8905e+05, 3.9272e+05],
        [4.0546e+05, 4.0543e+05, 4.0546e+05, 8.1405e+05, 8.1407e+05, 4.0546e+05,
         4.0545e+05, 8.0959e+05, 4.0546e+05, 8.0336e+05, 0.0000e+00, 4.0542e+05,
         8.1457e+05, 4.0546e+05],
        [1.8894e+00, 2.1047e+00, 1.9919e+00, 3.8473e+05, 4.0035e+05, 1.4459e+00,
         1.8274e+00, 3.9706e+05, 2.1546e+00, 3.9274e+05, 4.0542e+05, 0.0000e+00,
         3.9433e+05, 1.6728e+00],
        [3.9433e+05, 3.9431e+05, 3.9434e+05, 7.7552e+05, 7.8894e+05, 3.9432e+05,
         3.9433e+05, 8.1878e+05, 3.9432e+05, 7.8905e+05, 8.1457e+05, 3.9433e+05,
         0.0000e+00, 3.9432e+05],
        [1.1719e+00, 1.1787e+00, 1.1656e+00, 3.8472e+05, 4.0030e+05, 1.0002e+00,
         1.1367e+00, 3.9707e+05, 1.1397e+00, 3.9272e+05, 4.0546e+05, 1.6728e+00,
         3.9432e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1422e+00, 1.1594e+00, 1.1605e+00, 1.1719e+00, 1.1869e+00,
        1.2070e+00, 1.8894e+00, 3.8474e+05, 3.9273e+05, 3.9433e+05, 3.9705e+05,
        4.0030e+05, 4.0546e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0628e+00, 1.1076e+00, 1.1170e+00, 1.1422e+00, 1.1787e+00,
        1.1893e+00, 2.1047e+00, 3.8474e+05, 3.9274e+05, 3.9431e+05, 3.9706e+05,
        4.0031e+05, 4.0543e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0628e+00, 1.1252e+00, 1.1379e+00, 1.1656e+00, 1.1761e+00,
        1.1869e+00, 1.9919e+00, 3.8471e+05, 3.9272e+05, 3.9434e+05, 3.9707e+05,
        4.0029e+05, 4.0546e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 384712.7812, 384720.4375, 384730.2812, 384733.4375,
        384736.8750, 384738.3125, 384741.5938, 384746.2188, 771318.2500,
        775518.0625, 795056.1875, 814046.1250, 823894.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400261.8750, 400283.8438, 400285.5000, 400291.1875,
        400300.5000, 400303.2188, 400305.3438, 400345.2812, 788943.1875,
        796451.0625, 806634.1250, 814068.8750, 823894.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0002e+00, 1.1020e+00, 1.1594e+00, 1.1761e+00, 1.1893e+00,
        1.2074e+00, 1.4459e+00, 3.8473e+05, 3.9273e+05, 3.9432e+05, 3.9705e+05,
        4.0026e+05, 4.0546e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1020e+00, 1.1076e+00, 1.1367e+00, 1.1379e+00, 1.1481e+00,
        1.1605e+00, 1.8274e+00, 3.8475e+05, 3.9274e+05, 3.9433e+05, 3.9704e+05,
        4.0028e+05, 4.0545e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397043.4375, 397049.1875, 397050.2812, 397053.6875,
        397056.3125, 397058.8125, 397066.5625, 397068.5625, 771318.2500,
        777402.2500, 806634.1250, 809588.1875, 818779.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1170e+00, 1.1252e+00, 1.1397e+00, 1.1481e+00, 1.2070e+00,
        1.2074e+00, 2.1546e+00, 3.8474e+05, 3.9275e+05, 3.9432e+05, 3.9705e+05,
        4.0029e+05, 4.0546e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 392716.8750, 392723.5312, 392730.0938, 392732.0625,
        392739.4375, 392742.8750, 392744.3125, 392746.2812, 777402.2500,
        789053.0625, 795056.1875, 796451.0625, 803363.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 405421.0312, 405433.5312, 405451.7500, 405456.0312,
        405457.3750, 405459.5000, 405462.0938, 405463.2188, 803363.1875,
        809588.1875, 814046.1250, 814068.8750, 814566.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4459e+00, 1.6728e+00, 1.8274e+00, 1.8894e+00, 1.9919e+00,
        2.1047e+00, 2.1546e+00, 3.8473e+05, 3.9274e+05, 3.9433e+05, 3.9706e+05,
        4.0035e+05, 4.0542e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394309.5000, 394316.1562, 394320.4688, 394320.7812,
        394329.1875, 394329.4062, 394332.7188, 394336.3750, 775518.0625,
        788943.1875, 789053.0625, 814566.3125, 818779.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0002e+00, 1.1367e+00, 1.1397e+00, 1.1656e+00, 1.1719e+00,
        1.1787e+00, 1.6728e+00, 3.8472e+05, 3.9272e+05, 3.9432e+05, 3.9707e+05,
        4.0030e+05, 4.0546e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['86386.20', '86388.15', '86382.80', '427686.44', '443480.00', '86385.62', '86388.25', '438640.53', '86388.19', '435475.25', '449663.06', '86387.87', '436679.16', '86382.87']
estimated f for each client, fs: [6, 6, 6, 5, 4, 6, 6, 4, 6, 4, 4, 6, 4, 6]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 18, 8, 15, 14, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0185s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:56...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 74 189]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:28:56, End: 2025-07-22 15:28:56)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4022e+00, 1.5214e+00, 3.8904e+05, 3.7679e+05, 1.4171e+00,
         3.9063e+05, 3.9490e+05, 1.4432e+00, 4.0924e+05, 1.2889e+00, 4.0408e+05,
         1.8531e+00, 3.7972e+05, 1.4090e+00, 1.3077e+00],
        [1.4022e+00, 0.0000e+00, 1.5372e+00, 3.8902e+05, 3.7675e+05, 1.4989e+00,
         3.9063e+05, 3.9492e+05, 1.3954e+00, 4.0923e+05, 1.3536e+00, 4.0408e+05,
         2.0778e+00, 3.7975e+05, 1.4236e+00, 1.4709e+00],
        [1.5214e+00, 1.5372e+00, 0.0000e+00, 3.8906e+05, 3.7677e+05, 1.2371e+00,
         3.9064e+05, 3.9489e+05, 1.5135e+00, 4.0927e+05, 1.4161e+00, 4.0408e+05,
         1.4945e+00, 3.7975e+05, 1.3342e+00, 1.3094e+00],
        [3.8904e+05, 3.8902e+05, 3.8906e+05, 0.0000e+00, 7.7858e+05, 3.8905e+05,
         7.7566e+05, 7.8804e+05, 3.8902e+05, 8.1952e+05, 3.8905e+05, 7.8237e+05,
         3.8905e+05, 7.5677e+05, 3.8906e+05, 3.8907e+05],
        [3.7679e+05, 3.7675e+05, 3.7677e+05, 7.7858e+05, 0.0000e+00, 3.7677e+05,
         7.6545e+05, 7.6324e+05, 3.7675e+05, 8.0596e+05, 3.7676e+05, 7.8467e+05,
         3.7679e+05, 7.4202e+05, 3.7677e+05, 3.7680e+05],
        [1.4171e+00, 1.4989e+00, 1.2371e+00, 3.8905e+05, 3.7677e+05, 0.0000e+00,
         3.9062e+05, 3.9489e+05, 1.5163e+00, 4.0927e+05, 1.4185e+00, 4.0408e+05,
         1.3303e+00, 3.7975e+05, 1.1753e+00, 1.2566e+00],
        [3.9063e+05, 3.9063e+05, 3.9064e+05, 7.7566e+05, 7.6545e+05, 3.9062e+05,
         0.0000e+00, 8.0677e+05, 3.9063e+05, 8.0699e+05, 3.9060e+05, 8.3348e+05,
         3.9063e+05, 7.8490e+05, 3.9062e+05, 3.9063e+05],
        [3.9490e+05, 3.9492e+05, 3.9489e+05, 7.8804e+05, 7.6324e+05, 3.9489e+05,
         8.0677e+05, 0.0000e+00, 3.9490e+05, 8.1790e+05, 3.9489e+05, 7.8134e+05,
         3.9489e+05, 7.5369e+05, 3.9490e+05, 3.9487e+05],
        [1.4432e+00, 1.3954e+00, 1.5135e+00, 3.8902e+05, 3.7675e+05, 1.5163e+00,
         3.9063e+05, 3.9490e+05, 0.0000e+00, 4.0922e+05, 1.3844e+00, 4.0408e+05,
         2.0553e+00, 3.7974e+05, 1.4077e+00, 1.4136e+00],
        [4.0924e+05, 4.0923e+05, 4.0927e+05, 8.1952e+05, 8.0596e+05, 4.0927e+05,
         8.0699e+05, 8.1790e+05, 4.0922e+05, 0.0000e+00, 4.0926e+05, 8.0350e+05,
         4.0928e+05, 7.5995e+05, 4.0927e+05, 4.0927e+05],
        [1.2889e+00, 1.3536e+00, 1.4161e+00, 3.8905e+05, 3.7676e+05, 1.4185e+00,
         3.9060e+05, 3.9489e+05, 1.3844e+00, 4.0926e+05, 0.0000e+00, 4.0408e+05,
         1.8381e+00, 3.7975e+05, 1.3924e+00, 1.2737e+00],
        [4.0408e+05, 4.0408e+05, 4.0408e+05, 7.8237e+05, 7.8467e+05, 4.0408e+05,
         8.3348e+05, 7.8134e+05, 4.0408e+05, 8.0350e+05, 4.0408e+05, 0.0000e+00,
         4.0411e+05, 7.8586e+05, 4.0409e+05, 4.0409e+05],
        [1.8531e+00, 2.0778e+00, 1.4945e+00, 3.8905e+05, 3.7679e+05, 1.3303e+00,
         3.9063e+05, 3.9489e+05, 2.0553e+00, 4.0928e+05, 1.8381e+00, 4.0411e+05,
         0.0000e+00, 3.7973e+05, 1.5374e+00, 1.5920e+00],
        [3.7972e+05, 3.7975e+05, 3.7975e+05, 7.5677e+05, 7.4202e+05, 3.7975e+05,
         7.8490e+05, 7.5369e+05, 3.7974e+05, 7.5995e+05, 3.7975e+05, 7.8586e+05,
         3.7973e+05, 0.0000e+00, 3.7977e+05, 3.7976e+05],
        [1.4090e+00, 1.4236e+00, 1.3342e+00, 3.8906e+05, 3.7677e+05, 1.1753e+00,
         3.9062e+05, 3.9490e+05, 1.4077e+00, 4.0927e+05, 1.3924e+00, 4.0409e+05,
         1.5374e+00, 3.7977e+05, 0.0000e+00, 1.2510e+00],
        [1.3077e+00, 1.4709e+00, 1.3094e+00, 3.8907e+05, 3.7680e+05, 1.2566e+00,
         3.9063e+05, 3.9487e+05, 1.4136e+00, 4.0927e+05, 1.2737e+00, 4.0409e+05,
         1.5920e+00, 3.7976e+05, 1.2510e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2889e+00, 1.3077e+00, 1.4022e+00, 1.4090e+00, 1.4171e+00,
        1.4432e+00, 1.5214e+00, 1.8531e+00, 3.7679e+05, 3.7972e+05, 3.8904e+05,
        3.9063e+05, 3.9490e+05, 4.0408e+05, 4.0924e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3536e+00, 1.3954e+00, 1.4022e+00, 1.4236e+00, 1.4709e+00,
        1.4989e+00, 1.5372e+00, 2.0778e+00, 3.7675e+05, 3.7975e+05, 3.8902e+05,
        3.9063e+05, 3.9492e+05, 4.0408e+05, 4.0923e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2371e+00, 1.3094e+00, 1.3342e+00, 1.4161e+00, 1.4945e+00,
        1.5135e+00, 1.5214e+00, 1.5372e+00, 3.7677e+05, 3.7975e+05, 3.8906e+05,
        3.9064e+05, 3.9489e+05, 4.0408e+05, 4.0927e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389022.0312, 389023.8125, 389043.4688, 389045.5312,
        389045.6875, 389051.0000, 389062.7500, 389064.8438, 389072.3750,
        756766.3750, 775657.0625, 778575.5625, 782374.1250, 788036.4375,
        819517.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376748.0625, 376750.4375, 376762.7500, 376765.7812,
        376770.2812, 376770.9688, 376786.7188, 376791.3750, 376795.2500,
        742023.6250, 763240.8750, 765453.9375, 778575.5625, 784673.4375,
        805957.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1753e+00, 1.2371e+00, 1.2566e+00, 1.3303e+00, 1.4171e+00,
        1.4185e+00, 1.4989e+00, 1.5163e+00, 3.7677e+05, 3.7975e+05, 3.8905e+05,
        3.9062e+05, 3.9489e+05, 4.0408e+05, 4.0927e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390599.1875, 390617.3750, 390621.4375, 390626.5938,
        390630.9062, 390631.9375, 390633.5000, 390634.5000, 390635.5938,
        765453.9375, 775657.0625, 784897.6875, 806774.7500, 806992.8125,
        833480.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394874.0312, 394886.6250, 394888.1250, 394889.9688,
        394891.3438, 394898.0625, 394898.6875, 394899.8125, 394918.3750,
        753692.8750, 763240.8750, 781339.5625, 788036.4375, 806774.7500,
        817895.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3844e+00, 1.3954e+00, 1.4077e+00, 1.4136e+00, 1.4432e+00,
        1.5135e+00, 1.5163e+00, 2.0553e+00, 3.7675e+05, 3.7974e+05, 3.8902e+05,
        3.9063e+05, 3.9490e+05, 4.0408e+05, 4.0922e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 409223.2500, 409225.9375, 409238.8125, 409258.1562,
        409267.5000, 409268.6250, 409271.2812, 409273.3125, 409283.5312,
        759954.5000, 803497.7500, 805957.4375, 806992.8125, 817895.4375,
        819517.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2737e+00, 1.2889e+00, 1.3536e+00, 1.3844e+00, 1.3924e+00,
        1.4161e+00, 1.4185e+00, 1.8381e+00, 3.7676e+05, 3.7975e+05, 3.8905e+05,
        3.9060e+05, 3.9489e+05, 4.0408e+05, 4.0926e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404075.9375, 404077.0000, 404079.4688, 404080.1562,
        404084.5625, 404084.8125, 404086.1875, 404090.0625, 404107.2812,
        781339.5625, 782374.1250, 784673.4375, 785861.5000, 803497.7500,
        833480.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3303e+00, 1.4945e+00, 1.5374e+00, 1.5920e+00, 1.8381e+00,
        1.8531e+00, 2.0553e+00, 2.0778e+00, 3.7679e+05, 3.7973e+05, 3.8905e+05,
        3.9063e+05, 3.9489e+05, 4.0411e+05, 4.0928e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379718.2500, 379734.1562, 379739.3750, 379746.4688,
        379750.2812, 379753.0312, 379753.5312, 379757.1250, 379769.4062,
        742023.6250, 753692.8750, 756766.3750, 759954.5000, 784897.6875,
        785861.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1753e+00, 1.2510e+00, 1.3342e+00, 1.3924e+00, 1.4077e+00,
        1.4090e+00, 1.4236e+00, 1.5374e+00, 3.7677e+05, 3.7977e+05, 3.8906e+05,
        3.9062e+05, 3.9490e+05, 4.0409e+05, 4.0927e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2510e+00, 1.2566e+00, 1.2737e+00, 1.3077e+00, 1.3094e+00,
        1.4136e+00, 1.4709e+00, 1.5920e+00, 3.7680e+05, 3.7976e+05, 3.8907e+05,
        3.9063e+05, 3.9487e+05, 4.0409e+05, 4.0927e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75651.67', '75651.30', '75653.54', '425819.81', '413296.56', '75653.47', '428108.50', '430773.81', '75649.95', '444326.50', '75652.06', '441810.50', '75653.92', '415974.50', '75654.62', '75656.33']
estimated f for each client, fs: [7, 7, 7, 5, 5, 7, 5, 5, 7, 5, 7, 5, 7, 5, 7, 7]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0338s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:57...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 75 188]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:28:57, End: 2025-07-22 15:28:57)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 19, 17, 1, 20, 18, 8, 15, 4, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.5622e+00, 3.9575e+05, 3.8987e+05, 1.5114e+00, 3.8451e+05,
         3.8792e+05, 1.7816e+00, 3.8498e+05, 1.4656e+00, 1.4351e+00, 1.7609e+00,
         3.8714e+05, 1.5414e+00, 1.4243e+00],
        [1.5622e+00, 0.0000e+00, 3.9575e+05, 3.8991e+05, 1.3323e+00, 3.8449e+05,
         3.8794e+05, 1.4996e+00, 3.8495e+05, 1.5577e+00, 1.3860e+00, 1.3973e+00,
         3.8717e+05, 1.4354e+00, 1.3686e+00],
        [3.9575e+05, 3.9575e+05, 0.0000e+00, 8.1166e+05, 3.9576e+05, 7.7801e+05,
         7.8742e+05, 3.9577e+05, 7.8974e+05, 3.9576e+05, 3.9573e+05, 3.9577e+05,
         7.9630e+05, 3.9576e+05, 3.9576e+05],
        [3.8987e+05, 3.8991e+05, 8.1166e+05, 0.0000e+00, 3.8991e+05, 7.7611e+05,
         7.6377e+05, 3.8989e+05, 7.9590e+05, 3.8989e+05, 3.8991e+05, 3.8989e+05,
         7.5983e+05, 3.8989e+05, 3.8985e+05],
        [1.5114e+00, 1.3323e+00, 3.9576e+05, 3.8991e+05, 0.0000e+00, 3.8448e+05,
         3.8794e+05, 1.5201e+00, 3.8495e+05, 1.7111e+00, 1.2582e+00, 1.2738e+00,
         3.8714e+05, 1.2914e+00, 1.3586e+00],
        [3.8451e+05, 3.8449e+05, 7.7801e+05, 7.7611e+05, 3.8448e+05, 0.0000e+00,
         7.5268e+05, 3.8449e+05, 7.7323e+05, 3.8450e+05, 3.8452e+05, 3.8449e+05,
         7.8657e+05, 3.8447e+05, 3.8448e+05],
        [3.8792e+05, 3.8794e+05, 7.8742e+05, 7.6377e+05, 3.8794e+05, 7.5268e+05,
         0.0000e+00, 3.8794e+05, 7.8180e+05, 3.8790e+05, 3.8791e+05, 3.8793e+05,
         7.6258e+05, 3.8794e+05, 3.8792e+05],
        [1.7816e+00, 1.4996e+00, 3.9577e+05, 3.8989e+05, 1.5201e+00, 3.8449e+05,
         3.8794e+05, 0.0000e+00, 3.8499e+05, 1.6523e+00, 1.4523e+00, 1.6349e+00,
         3.8716e+05, 1.5807e+00, 1.5419e+00],
        [3.8498e+05, 3.8495e+05, 7.8974e+05, 7.9590e+05, 3.8495e+05, 7.7323e+05,
         7.8180e+05, 3.8499e+05, 0.0000e+00, 3.8499e+05, 3.8498e+05, 3.8497e+05,
         7.7156e+05, 3.8500e+05, 3.8496e+05],
        [1.4656e+00, 1.5577e+00, 3.9576e+05, 3.8989e+05, 1.7111e+00, 3.8450e+05,
         3.8790e+05, 1.6523e+00, 3.8499e+05, 0.0000e+00, 1.5511e+00, 1.9937e+00,
         3.8711e+05, 1.6249e+00, 1.4762e+00],
        [1.4351e+00, 1.3860e+00, 3.9573e+05, 3.8991e+05, 1.2582e+00, 3.8452e+05,
         3.8791e+05, 1.4523e+00, 3.8498e+05, 1.5511e+00, 0.0000e+00, 1.3175e+00,
         3.8715e+05, 1.2762e+00, 1.3495e+00],
        [1.7609e+00, 1.3973e+00, 3.9577e+05, 3.8989e+05, 1.2738e+00, 3.8449e+05,
         3.8793e+05, 1.6349e+00, 3.8497e+05, 1.9937e+00, 1.3175e+00, 0.0000e+00,
         3.8719e+05, 1.4747e+00, 1.4918e+00],
        [3.8714e+05, 3.8717e+05, 7.9630e+05, 7.5983e+05, 3.8714e+05, 7.8657e+05,
         7.6258e+05, 3.8716e+05, 7.7156e+05, 3.8711e+05, 3.8715e+05, 3.8719e+05,
         0.0000e+00, 3.8712e+05, 3.8716e+05],
        [1.5414e+00, 1.4354e+00, 3.9576e+05, 3.8989e+05, 1.2914e+00, 3.8447e+05,
         3.8794e+05, 1.5807e+00, 3.8500e+05, 1.6249e+00, 1.2762e+00, 1.4747e+00,
         3.8712e+05, 0.0000e+00, 1.4217e+00],
        [1.4243e+00, 1.3686e+00, 3.9576e+05, 3.8985e+05, 1.3586e+00, 3.8448e+05,
         3.8792e+05, 1.5419e+00, 3.8496e+05, 1.4762e+00, 1.3495e+00, 1.4918e+00,
         3.8716e+05, 1.4217e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4243e+00, 1.4351e+00, 1.4656e+00, 1.5114e+00, 1.5414e+00,
        1.5622e+00, 1.7609e+00, 1.7816e+00, 3.8451e+05, 3.8498e+05, 3.8714e+05,
        3.8792e+05, 3.8987e+05, 3.9575e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3323e+00, 1.3686e+00, 1.3860e+00, 1.3973e+00, 1.4354e+00,
        1.4996e+00, 1.5577e+00, 1.5622e+00, 3.8449e+05, 3.8495e+05, 3.8717e+05,
        3.8794e+05, 3.8991e+05, 3.9575e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 395727.3438, 395747.8125, 395751.2812, 395757.4062,
        395760.0938, 395763.3125, 395764.0000, 395765.0625, 395767.2812,
        778006.7500, 787422.1875, 789735.5625, 796298.3750, 811655.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389849.4688, 389870.0625, 389885.5625, 389886.2500,
        389887.3438, 389894.0312, 389906.2188, 389907.3750, 389908.0000,
        759832.3125, 763765.1875, 776107.3750, 795897.6875, 811655.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2582e+00, 1.2738e+00, 1.2914e+00, 1.3323e+00, 1.3586e+00,
        1.5114e+00, 1.5201e+00, 1.7111e+00, 3.8448e+05, 3.8495e+05, 3.8714e+05,
        3.8794e+05, 3.8991e+05, 3.9576e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 384474.7812, 384477.6562, 384479.6875, 384486.3125,
        384488.2500, 384488.4062, 384495.3125, 384514.8750, 384515.0000,
        752680.1875, 773234.6875, 776107.3750, 778006.7500, 786568.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387900.7500, 387912.4688, 387919.6250, 387921.3750,
        387928.4062, 387936.6875, 387936.7500, 387940.5938, 387943.9062,
        752680.1875, 762577.1250, 763765.1875, 781799.1875, 787422.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4523e+00, 1.4996e+00, 1.5201e+00, 1.5419e+00, 1.5807e+00,
        1.6349e+00, 1.6523e+00, 1.7816e+00, 3.8449e+05, 3.8499e+05, 3.8716e+05,
        3.8794e+05, 3.8989e+05, 3.9577e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 384946.9375, 384950.1875, 384964.4062, 384967.7500,
        384981.0938, 384982.5625, 384987.6562, 384990.6250, 385003.0312,
        771555.8750, 773234.6875, 781799.1875, 789735.5625, 795897.6875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4656e+00, 1.4762e+00, 1.5511e+00, 1.5577e+00, 1.6249e+00,
        1.6523e+00, 1.7111e+00, 1.9937e+00, 3.8450e+05, 3.8499e+05, 3.8711e+05,
        3.8790e+05, 3.8989e+05, 3.9576e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2582e+00, 1.2762e+00, 1.3175e+00, 1.3495e+00, 1.3860e+00,
        1.4351e+00, 1.4523e+00, 1.5511e+00, 3.8452e+05, 3.8498e+05, 3.8715e+05,
        3.8791e+05, 3.8991e+05, 3.9573e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2738e+00, 1.3175e+00, 1.3973e+00, 1.4747e+00, 1.4918e+00,
        1.6349e+00, 1.7609e+00, 1.9937e+00, 3.8449e+05, 3.8497e+05, 3.8719e+05,
        3.8793e+05, 3.8989e+05, 3.9577e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387111.6250, 387122.0000, 387136.6875, 387143.9062,
        387152.2500, 387159.8750, 387164.3125, 387174.2812, 387190.6875,
        759832.3125, 762577.1250, 771555.8750, 786568.8750, 796298.3750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2762e+00, 1.2914e+00, 1.4217e+00, 1.4354e+00, 1.4747e+00,
        1.5414e+00, 1.5807e+00, 1.6249e+00, 3.8447e+05, 3.8500e+05, 3.8712e+05,
        3.8794e+05, 3.8989e+05, 3.9576e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3495e+00, 1.3586e+00, 1.3686e+00, 1.4217e+00, 1.4243e+00,
        1.4762e+00, 1.4918e+00, 1.5419e+00, 3.8448e+05, 3.8496e+05, 3.8716e+05,
        3.8792e+05, 3.8985e+05, 3.9576e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['42725.27', '42722.20', '395755.94', '389888.28', '42720.99', '384491.12', '387926.72', '42722.34', '384974.91', '42723.14', '42725.12', '42722.07', '387150.62', '42720.72', '42721.24']
estimated f for each client, fs: [6, 6, 4, 4, 6, 4, 4, 6, 5, 6, 6, 6, 4, 6, 6]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']], selected_client_indices: [5, 2, 19, 17, 1, 20, 18, 8, 15, 4, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0124s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:57...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:28:57, End: 2025-07-22 15:28:57)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.3603e+00, 3.8195e+05, 3.7630e+05, 1.4948e+00, 1.2463e+00,
         3.9421e+05, 3.8697e+05, 1.4681e+00, 3.9562e+05, 1.2891e+00, 1.2598e+00,
         3.8940e+05, 4.0048e+05, 1.8165e+00, 3.7964e+05, 1.8462e+00, 1.4182e+00],
        [1.3603e+00, 0.0000e+00, 3.8196e+05, 3.7629e+05, 1.2438e+00, 1.2185e+00,
         3.9423e+05, 3.8700e+05, 1.2138e+00, 3.9562e+05, 1.3332e+00, 1.2484e+00,
         3.8940e+05, 4.0048e+05, 1.3232e+00, 3.7963e+05, 1.4399e+00, 1.1907e+00],
        [3.8195e+05, 3.8196e+05, 0.0000e+00, 7.7535e+05, 3.8199e+05, 3.8195e+05,
         7.8997e+05, 7.5934e+05, 3.8194e+05, 7.9218e+05, 3.8193e+05, 3.8194e+05,
         7.7456e+05, 7.6824e+05, 3.8198e+05, 7.5664e+05, 3.8198e+05, 3.8192e+05],
        [3.7630e+05, 3.7629e+05, 7.7535e+05, 0.0000e+00, 3.7629e+05, 3.7631e+05,
         7.5943e+05, 7.8350e+05, 3.7631e+05, 7.8518e+05, 3.7630e+05, 3.7629e+05,
         7.4991e+05, 7.5026e+05, 3.7633e+05, 7.5284e+05, 3.7628e+05, 3.7632e+05],
        [1.4948e+00, 1.2438e+00, 3.8199e+05, 3.7629e+05, 0.0000e+00, 1.3124e+00,
         3.9423e+05, 3.8695e+05, 1.2969e+00, 3.9566e+05, 1.5877e+00, 1.3992e+00,
         3.8938e+05, 4.0047e+05, 1.1952e+00, 3.7966e+05, 1.2313e+00, 1.2478e+00],
        [1.2463e+00, 1.2185e+00, 3.8195e+05, 3.7631e+05, 1.3124e+00, 0.0000e+00,
         3.9423e+05, 3.8696e+05, 1.3582e+00, 3.9565e+05, 1.3086e+00, 1.2164e+00,
         3.8938e+05, 4.0051e+05, 1.4930e+00, 3.7962e+05, 1.6372e+00, 1.2146e+00],
        [3.9421e+05, 3.9423e+05, 7.8997e+05, 7.5943e+05, 3.9423e+05, 3.9423e+05,
         0.0000e+00, 7.8727e+05, 3.9425e+05, 7.8294e+05, 3.9427e+05, 3.9425e+05,
         7.6911e+05, 8.3540e+05, 3.9424e+05, 7.6881e+05, 3.9423e+05, 3.9425e+05],
        [3.8697e+05, 3.8700e+05, 7.5934e+05, 7.8350e+05, 3.8695e+05, 3.8696e+05,
         7.8727e+05, 0.0000e+00, 3.8698e+05, 7.6588e+05, 3.8696e+05, 3.8697e+05,
         7.9165e+05, 7.8510e+05, 3.8697e+05, 7.8207e+05, 3.8698e+05, 3.8697e+05],
        [1.4681e+00, 1.2138e+00, 3.8194e+05, 3.7631e+05, 1.2969e+00, 1.3582e+00,
         3.9425e+05, 3.8698e+05, 0.0000e+00, 3.9563e+05, 1.3649e+00, 1.3158e+00,
         3.8942e+05, 4.0051e+05, 1.4348e+00, 3.7961e+05, 1.4813e+00, 1.2507e+00],
        [3.9562e+05, 3.9562e+05, 7.9218e+05, 7.8518e+05, 3.9566e+05, 3.9565e+05,
         7.8294e+05, 7.6588e+05, 3.9563e+05, 0.0000e+00, 3.9564e+05, 3.9565e+05,
         7.9313e+05, 7.8241e+05, 3.9564e+05, 7.4712e+05, 3.9568e+05, 3.9568e+05],
        [1.2891e+00, 1.3332e+00, 3.8193e+05, 3.7630e+05, 1.5877e+00, 1.3086e+00,
         3.9427e+05, 3.8696e+05, 1.3649e+00, 3.9564e+05, 0.0000e+00, 1.3118e+00,
         3.8938e+05, 4.0052e+05, 1.8464e+00, 3.7962e+05, 1.9084e+00, 1.3047e+00],
        [1.2598e+00, 1.2484e+00, 3.8194e+05, 3.7629e+05, 1.3992e+00, 1.2164e+00,
         3.9425e+05, 3.8697e+05, 1.3158e+00, 3.9565e+05, 1.3118e+00, 0.0000e+00,
         3.8940e+05, 4.0049e+05, 1.5928e+00, 3.7961e+05, 1.7125e+00, 1.2080e+00],
        [3.8940e+05, 3.8940e+05, 7.7456e+05, 7.4991e+05, 3.8938e+05, 3.8938e+05,
         7.6911e+05, 7.9165e+05, 3.8942e+05, 7.9313e+05, 3.8938e+05, 3.8940e+05,
         0.0000e+00, 7.8790e+05, 3.8943e+05, 7.8985e+05, 3.8940e+05, 3.8941e+05],
        [4.0048e+05, 4.0048e+05, 7.6824e+05, 7.5026e+05, 4.0047e+05, 4.0051e+05,
         8.3540e+05, 7.8510e+05, 4.0051e+05, 7.8241e+05, 4.0052e+05, 4.0049e+05,
         7.8790e+05, 0.0000e+00, 4.0048e+05, 7.7704e+05, 4.0048e+05, 4.0045e+05],
        [1.8165e+00, 1.3232e+00, 3.8198e+05, 3.7633e+05, 1.1952e+00, 1.4930e+00,
         3.9424e+05, 3.8697e+05, 1.4348e+00, 3.9564e+05, 1.8464e+00, 1.5928e+00,
         3.8943e+05, 4.0048e+05, 0.0000e+00, 3.7961e+05, 1.1934e+00, 1.3749e+00],
        [3.7964e+05, 3.7963e+05, 7.5664e+05, 7.5284e+05, 3.7966e+05, 3.7962e+05,
         7.6881e+05, 7.8207e+05, 3.7961e+05, 7.4712e+05, 3.7962e+05, 3.7961e+05,
         7.8985e+05, 7.7704e+05, 3.7961e+05, 0.0000e+00, 3.7964e+05, 3.7962e+05],
        [1.8462e+00, 1.4399e+00, 3.8198e+05, 3.7628e+05, 1.2313e+00, 1.6372e+00,
         3.9423e+05, 3.8698e+05, 1.4813e+00, 3.9568e+05, 1.9084e+00, 1.7125e+00,
         3.8940e+05, 4.0048e+05, 1.1934e+00, 3.7964e+05, 0.0000e+00, 1.4710e+00],
        [1.4182e+00, 1.1907e+00, 3.8192e+05, 3.7632e+05, 1.2478e+00, 1.2146e+00,
         3.9425e+05, 3.8697e+05, 1.2507e+00, 3.9568e+05, 1.3047e+00, 1.2080e+00,
         3.8941e+05, 4.0045e+05, 1.3749e+00, 3.7962e+05, 1.4710e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2463e+00, 1.2598e+00, 1.2891e+00, 1.3603e+00, 1.4182e+00,
        1.4681e+00, 1.4948e+00, 1.8165e+00, 1.8462e+00, 3.7630e+05, 3.7964e+05,
        3.8195e+05, 3.8697e+05, 3.8940e+05, 3.9421e+05, 3.9562e+05, 4.0048e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1907e+00, 1.2138e+00, 1.2185e+00, 1.2438e+00, 1.2484e+00,
        1.3232e+00, 1.3332e+00, 1.3603e+00, 1.4399e+00, 3.7629e+05, 3.7963e+05,
        3.8196e+05, 3.8700e+05, 3.8940e+05, 3.9423e+05, 3.9562e+05, 4.0048e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 381923.0625, 381931.6562, 381941.1562, 381943.4062,
        381952.3125, 381954.4375, 381959.0625, 381979.2188, 381984.6250,
        381989.5938, 756642.8750, 759340.8125, 768240.1250, 774558.0000,
        775353.6875, 789968.0625, 792181.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 376276.9375, 376288.8750, 376291.4375, 376294.9688,
        376298.5625, 376299.1250, 376311.5000, 376314.5312, 376316.1562,
        376328.7188, 749910.2500, 750260.7500, 752838.1250, 759430.2500,
        775353.6875, 783498.3125, 785183.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1952e+00, 1.2313e+00, 1.2438e+00, 1.2478e+00, 1.2969e+00,
        1.3124e+00, 1.3992e+00, 1.4948e+00, 1.5877e+00, 3.7629e+05, 3.7966e+05,
        3.8199e+05, 3.8695e+05, 3.8938e+05, 3.9423e+05, 3.9566e+05, 4.0047e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2146e+00, 1.2164e+00, 1.2185e+00, 1.2463e+00, 1.3086e+00,
        1.3124e+00, 1.3582e+00, 1.4930e+00, 1.6372e+00, 3.7631e+05, 3.7962e+05,
        3.8195e+05, 3.8696e+05, 3.8938e+05, 3.9423e+05, 3.9565e+05, 4.0051e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 394213.1250, 394227.6250, 394228.7812, 394232.0938,
        394232.6875, 394244.9375, 394245.3125, 394245.5312, 394250.2812,
        394269.7500, 759430.2500, 768805.2500, 769113.9375, 782944.6250,
        787273.1250, 789968.0625, 835401.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386951.2500, 386956.9688, 386962.1875, 386967.5000,
        386972.0625, 386973.6875, 386973.7500, 386975.7812, 386980.3125,
        386999.0312, 759340.8125, 765878.9375, 782065.8125, 783498.3125,
        785101.0625, 787273.1250, 791645.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2138e+00, 1.2507e+00, 1.2969e+00, 1.3158e+00, 1.3582e+00,
        1.3649e+00, 1.4348e+00, 1.4681e+00, 1.4813e+00, 3.7631e+05, 3.7961e+05,
        3.8194e+05, 3.8698e+05, 3.8942e+05, 3.9425e+05, 3.9563e+05, 4.0051e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395619.5938, 395620.5312, 395628.5938, 395642.7812,
        395643.6875, 395647.6562, 395649.5938, 395662.6562, 395678.8438,
        395679.5938, 747119.3750, 765878.9375, 782410.5625, 782944.6250,
        785183.4375, 792181.1250, 793131.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2891e+00, 1.3047e+00, 1.3086e+00, 1.3118e+00, 1.3332e+00,
        1.3649e+00, 1.5877e+00, 1.8464e+00, 1.9084e+00, 3.7630e+05, 3.7962e+05,
        3.8193e+05, 3.8696e+05, 3.8938e+05, 3.9427e+05, 3.9564e+05, 4.0052e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2080e+00, 1.2164e+00, 1.2484e+00, 1.2598e+00, 1.3118e+00,
        1.3158e+00, 1.3992e+00, 1.5928e+00, 1.7125e+00, 3.7629e+05, 3.7961e+05,
        3.8194e+05, 3.8697e+05, 3.8940e+05, 3.9425e+05, 3.9565e+05, 4.0049e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 389379.0938, 389381.3438, 389383.0625, 389396.4062,
        389399.4375, 389404.2500, 389404.6250, 389405.5312, 389418.2812,
        389428.2812, 749910.2500, 769113.9375, 774558.0000, 787903.1875,
        789851.8750, 791645.6250, 793131.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 400445.7500, 400473.4062, 400476.3125, 400479.2812,
        400483.3750, 400483.6562, 400488.6250, 400505.4062, 400508.4375,
        400522.5938, 750260.7500, 768240.1250, 777042.0625, 782410.5625,
        785101.0625, 787903.1875, 835401.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1934e+00, 1.1952e+00, 1.3232e+00, 1.3749e+00, 1.4348e+00,
        1.4930e+00, 1.5928e+00, 1.8165e+00, 1.8464e+00, 3.7633e+05, 3.7961e+05,
        3.8198e+05, 3.8697e+05, 3.8943e+05, 3.9424e+05, 3.9564e+05, 4.0048e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 379607.0938, 379607.1250, 379610.6562, 379615.3750,
        379617.9062, 379622.7812, 379627.8750, 379637.5000, 379637.9375,
        379662.1875, 747119.3750, 752838.1250, 756642.8750, 768805.2500,
        777042.0625, 782065.8125, 789851.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1934e+00, 1.2313e+00, 1.4399e+00, 1.4710e+00, 1.4813e+00,
        1.6372e+00, 1.7125e+00, 1.8462e+00, 1.9084e+00, 3.7628e+05, 3.7964e+05,
        3.8198e+05, 3.8698e+05, 3.8940e+05, 3.9423e+05, 3.9568e+05, 4.0048e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1907e+00, 1.2080e+00, 1.2146e+00, 1.2478e+00, 1.2507e+00,
        1.3047e+00, 1.3749e+00, 1.4182e+00, 1.4710e+00, 3.7632e+05, 3.7962e+05,
        3.8192e+05, 3.8697e+05, 3.8941e+05, 3.9425e+05, 3.9568e+05, 4.0045e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['68722.66', '68720.98', '416018.28', '410266.41', '68723.91', '68722.66', '427438.16', '420823.00', '68720.97', '427599.34', '68720.71', '68719.80', '422173.69', '432284.28', '68722.65', '413033.22', '68720.79', '68722.34']
estimated f for each client, fs: [8, 8, 6, 6, 8, 8, 6, 6, 8, 6, 8, 8, 6, 6, 8, 6, 8, 8]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0147s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:58...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:28:58, End: 2025-07-22 15:28:58)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.4716e+00, 1.5018e+00, 3.7759e+05, 3.9345e+05, 1.4751e+00,
         1.4432e+00, 3.9794e+05, 3.9256e+05, 1.6020e+00, 1.4766e+00, 3.9693e+05,
         1.4394e+00, 1.7301e+00, 3.7630e+05, 1.5980e+00, 1.4377e+00],
        [1.4716e+00, 0.0000e+00, 1.4366e+00, 3.7759e+05, 3.9351e+05, 1.5192e+00,
         1.3265e+00, 3.9795e+05, 3.9255e+05, 1.5644e+00, 1.3289e+00, 3.9690e+05,
         1.4296e+00, 1.8588e+00, 3.7632e+05, 1.6492e+00, 1.4925e+00],
        [1.5018e+00, 1.4366e+00, 0.0000e+00, 3.7758e+05, 3.9349e+05, 1.3401e+00,
         1.3622e+00, 3.9794e+05, 3.9255e+05, 1.3619e+00, 1.4679e+00, 3.9693e+05,
         1.3689e+00, 1.4538e+00, 3.7632e+05, 1.4085e+00, 1.3059e+00],
        [3.7759e+05, 3.7759e+05, 3.7758e+05, 0.0000e+00, 7.8217e+05, 3.7758e+05,
         3.7757e+05, 7.8839e+05, 7.7291e+05, 3.7756e+05, 3.7760e+05, 7.9181e+05,
         3.7757e+05, 3.7761e+05, 7.6971e+05, 3.7757e+05, 3.7758e+05],
        [3.9345e+05, 3.9351e+05, 3.9349e+05, 7.8217e+05, 0.0000e+00, 3.9349e+05,
         3.9347e+05, 7.8513e+05, 7.8796e+05, 3.9345e+05, 3.9346e+05, 7.7705e+05,
         3.9350e+05, 3.9347e+05, 7.5642e+05, 3.9351e+05, 3.9350e+05],
        [1.4751e+00, 1.5192e+00, 1.3401e+00, 3.7758e+05, 3.9349e+05, 0.0000e+00,
         1.3874e+00, 3.9794e+05, 3.9256e+05, 1.4239e+00, 1.6759e+00, 3.9690e+05,
         1.2548e+00, 1.3216e+00, 3.7632e+05, 1.1873e+00, 1.3646e+00],
        [1.4432e+00, 1.3265e+00, 1.3622e+00, 3.7757e+05, 3.9347e+05, 1.3874e+00,
         0.0000e+00, 3.9794e+05, 3.9251e+05, 1.5085e+00, 1.4882e+00, 3.9693e+05,
         1.3708e+00, 1.5998e+00, 3.7632e+05, 1.5468e+00, 1.4171e+00],
        [3.9794e+05, 3.9795e+05, 3.9794e+05, 7.8839e+05, 7.8513e+05, 3.9794e+05,
         3.9794e+05, 0.0000e+00, 7.9578e+05, 3.9794e+05, 3.9795e+05, 7.9068e+05,
         3.9796e+05, 3.9795e+05, 7.7898e+05, 3.9794e+05, 3.9794e+05],
        [3.9256e+05, 3.9255e+05, 3.9255e+05, 7.7291e+05, 7.8796e+05, 3.9256e+05,
         3.9251e+05, 7.9578e+05, 0.0000e+00, 3.9255e+05, 3.9256e+05, 7.8684e+05,
         3.9254e+05, 3.9253e+05, 7.7767e+05, 3.9256e+05, 3.9254e+05],
        [1.6020e+00, 1.5644e+00, 1.3619e+00, 3.7756e+05, 3.9345e+05, 1.4239e+00,
         1.5085e+00, 3.9794e+05, 3.9255e+05, 0.0000e+00, 1.4922e+00, 3.9695e+05,
         1.3833e+00, 1.6037e+00, 3.7634e+05, 1.4463e+00, 1.4231e+00],
        [1.4766e+00, 1.3289e+00, 1.4679e+00, 3.7760e+05, 3.9346e+05, 1.6759e+00,
         1.4882e+00, 3.9795e+05, 3.9256e+05, 1.4922e+00, 0.0000e+00, 3.9694e+05,
         1.5110e+00, 1.9616e+00, 3.7631e+05, 1.7628e+00, 1.4658e+00],
        [3.9693e+05, 3.9690e+05, 3.9693e+05, 7.9181e+05, 7.7705e+05, 3.9690e+05,
         3.9693e+05, 7.9068e+05, 7.8684e+05, 3.9695e+05, 3.9694e+05, 0.0000e+00,
         3.9692e+05, 3.9693e+05, 7.6234e+05, 3.9693e+05, 3.9688e+05],
        [1.4394e+00, 1.4296e+00, 1.3689e+00, 3.7757e+05, 3.9350e+05, 1.2548e+00,
         1.3708e+00, 3.9796e+05, 3.9254e+05, 1.3833e+00, 1.5110e+00, 3.9692e+05,
         0.0000e+00, 1.3748e+00, 3.7630e+05, 1.2559e+00, 1.3477e+00],
        [1.7301e+00, 1.8588e+00, 1.4538e+00, 3.7761e+05, 3.9347e+05, 1.3216e+00,
         1.5998e+00, 3.9795e+05, 3.9253e+05, 1.6037e+00, 1.9616e+00, 3.9693e+05,
         1.3748e+00, 0.0000e+00, 3.7634e+05, 1.2988e+00, 1.5079e+00],
        [3.7630e+05, 3.7632e+05, 3.7632e+05, 7.6971e+05, 7.5642e+05, 3.7632e+05,
         3.7632e+05, 7.7898e+05, 7.7767e+05, 3.7634e+05, 3.7631e+05, 7.6234e+05,
         3.7630e+05, 3.7634e+05, 0.0000e+00, 3.7633e+05, 3.7633e+05],
        [1.5980e+00, 1.6492e+00, 1.4085e+00, 3.7757e+05, 3.9351e+05, 1.1873e+00,
         1.5468e+00, 3.9794e+05, 3.9256e+05, 1.4463e+00, 1.7628e+00, 3.9693e+05,
         1.2559e+00, 1.2988e+00, 3.7633e+05, 0.0000e+00, 1.4150e+00],
        [1.4377e+00, 1.4925e+00, 1.3059e+00, 3.7758e+05, 3.9350e+05, 1.3646e+00,
         1.4171e+00, 3.9794e+05, 3.9254e+05, 1.4231e+00, 1.4658e+00, 3.9688e+05,
         1.3477e+00, 1.5079e+00, 3.7633e+05, 1.4150e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4377e+00, 1.4394e+00, 1.4432e+00, 1.4716e+00, 1.4751e+00,
        1.4766e+00, 1.5018e+00, 1.5980e+00, 1.6020e+00, 1.7301e+00, 3.7630e+05,
        3.7759e+05, 3.9256e+05, 3.9345e+05, 3.9693e+05, 3.9794e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3265e+00, 1.3289e+00, 1.4296e+00, 1.4366e+00, 1.4716e+00,
        1.4925e+00, 1.5192e+00, 1.5644e+00, 1.6492e+00, 1.8588e+00, 3.7632e+05,
        3.7759e+05, 3.9255e+05, 3.9351e+05, 3.9690e+05, 3.9795e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3059e+00, 1.3401e+00, 1.3619e+00, 1.3622e+00, 1.3689e+00,
        1.4085e+00, 1.4366e+00, 1.4538e+00, 1.4679e+00, 1.5018e+00, 3.7632e+05,
        3.7758e+05, 3.9255e+05, 3.9349e+05, 3.9693e+05, 3.9794e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377562.0000, 377572.0938, 377573.7188, 377574.6562,
        377578.9062, 377580.1250, 377580.6562, 377588.1250, 377589.7812,
        377599.2500, 377613.8750, 769714.3750, 772912.1250, 782168.8125,
        788387.8750, 791813.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393448.1250, 393450.9688, 393458.6875, 393471.3438,
        393472.5938, 393487.6875, 393491.1250, 393497.3125, 393504.1562,
        393506.1562, 393510.4375, 756423.2500, 777049.8125, 782168.8125,
        785131.9375, 787959.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1873e+00, 1.2548e+00, 1.3216e+00, 1.3401e+00, 1.3646e+00,
        1.3874e+00, 1.4239e+00, 1.4751e+00, 1.5192e+00, 1.6759e+00, 3.7632e+05,
        3.7758e+05, 3.9256e+05, 3.9349e+05, 3.9690e+05, 3.9794e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3265e+00, 1.3622e+00, 1.3708e+00, 1.3874e+00, 1.4171e+00,
        1.4432e+00, 1.4882e+00, 1.5085e+00, 1.5468e+00, 1.5998e+00, 3.7632e+05,
        3.7757e+05, 3.9251e+05, 3.9347e+05, 3.9693e+05, 3.9794e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397937.9688, 397938.1562, 397940.6562, 397941.1250,
        397942.2500, 397942.5000, 397944.2188, 397945.6562, 397946.8125,
        397954.1875, 397963.0625, 778976.8125, 785131.9375, 788387.8750,
        790680.7500, 795783.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392514.2188, 392530.4688, 392538.5312, 392539.4688,
        392548.4375, 392551.2500, 392553.6562, 392556.3750, 392556.3750,
        392558.5625, 392562.0938, 772912.1250, 777671.6250, 786839.1875,
        787959.8750, 795783.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3619e+00, 1.3833e+00, 1.4231e+00, 1.4239e+00, 1.4463e+00,
        1.4922e+00, 1.5085e+00, 1.5644e+00, 1.6020e+00, 1.6037e+00, 3.7634e+05,
        3.7756e+05, 3.9255e+05, 3.9345e+05, 3.9695e+05, 3.9794e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3289e+00, 1.4658e+00, 1.4679e+00, 1.4766e+00, 1.4882e+00,
        1.4922e+00, 1.5110e+00, 1.6759e+00, 1.7628e+00, 1.9616e+00, 3.7631e+05,
        3.7760e+05, 3.9256e+05, 3.9346e+05, 3.9694e+05, 3.9795e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396880.9062, 396898.4375, 396905.0000, 396924.2500,
        396926.0938, 396926.1875, 396927.2188, 396928.2812, 396930.3750,
        396943.3125, 396948.0312, 762339.3750, 777049.8125, 786839.1875,
        790680.7500, 791813.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2548e+00, 1.2559e+00, 1.3477e+00, 1.3689e+00, 1.3708e+00,
        1.3748e+00, 1.3833e+00, 1.4296e+00, 1.4394e+00, 1.5110e+00, 3.7630e+05,
        3.7757e+05, 3.9254e+05, 3.9350e+05, 3.9692e+05, 3.9796e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2988e+00, 1.3216e+00, 1.3748e+00, 1.4538e+00, 1.5079e+00,
        1.5998e+00, 1.6037e+00, 1.7301e+00, 1.8588e+00, 1.9616e+00, 3.7634e+05,
        3.7761e+05, 3.9253e+05, 3.9347e+05, 3.9693e+05, 3.9795e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376301.2500, 376302.3125, 376311.7812, 376316.8125,
        376318.0000, 376323.0625, 376324.0625, 376325.9062, 376328.9688,
        376337.2188, 376338.5938, 756423.2500, 762339.3750, 769714.3750,
        777671.6250, 778976.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1873e+00, 1.2559e+00, 1.2988e+00, 1.4085e+00, 1.4150e+00,
        1.4463e+00, 1.5468e+00, 1.5980e+00, 1.6492e+00, 1.7628e+00, 3.7633e+05,
        3.7757e+05, 3.9256e+05, 3.9351e+05, 3.9693e+05, 3.9794e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3059e+00, 1.3477e+00, 1.3646e+00, 1.4150e+00, 1.4171e+00,
        1.4231e+00, 1.4377e+00, 1.4658e+00, 1.4925e+00, 1.5079e+00, 3.7633e+05,
        3.7758e+05, 3.9254e+05, 3.9350e+05, 3.9688e+05, 3.9794e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.52', '1.51', '1.40', '377579.91', '393481.69', '1.39', '1.45', '397945.09', '392546.28', '1.48', '1.56', '396921.62', '1.37', '1.57', '376318.91', '1.46', '1.42']
estimated f for each client, fs: [6, 6, 6, 6, 4, 6, 6, 4, 4, 6, 6, 4, 6, 6, 6, 6, 6]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0217s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:59...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:28:59, End: 2025-07-22 15:28:59)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8841e+05, 1.1401e+00, 1.2408e+00, 4.0020e+05, 3.9164e+05,
         1.1782e+00, 4.0280e+05, 1.2779e+00, 1.1138e+00, 3.7958e+05, 3.9869e+05,
         1.4832e+00, 1.2342e+00, 3.9173e+05, 1.2511e+00],
        [3.8841e+05, 0.0000e+00, 3.8841e+05, 3.8839e+05, 7.7906e+05, 7.7542e+05,
         3.8843e+05, 8.0879e+05, 3.8841e+05, 3.8842e+05, 7.9756e+05, 7.9938e+05,
         3.8842e+05, 3.8844e+05, 8.0232e+05, 3.8841e+05],
        [1.1401e+00, 3.8841e+05, 0.0000e+00, 1.2219e+00, 4.0016e+05, 3.9165e+05,
         1.2469e+00, 4.0281e+05, 1.4155e+00, 1.1256e+00, 3.7961e+05, 3.9870e+05,
         1.2317e+00, 1.1125e+00, 3.9175e+05, 1.0737e+00],
        [1.2408e+00, 3.8839e+05, 1.2219e+00, 0.0000e+00, 4.0019e+05, 3.9167e+05,
         1.3607e+00, 4.0281e+05, 1.3029e+00, 1.2546e+00, 3.7959e+05, 3.9869e+05,
         1.6610e+00, 1.3927e+00, 3.9177e+05, 1.4043e+00],
        [4.0020e+05, 7.7906e+05, 4.0016e+05, 4.0019e+05, 0.0000e+00, 7.8778e+05,
         4.0018e+05, 8.0927e+05, 4.0018e+05, 4.0018e+05, 7.8733e+05, 8.0002e+05,
         4.0018e+05, 4.0018e+05, 7.9538e+05, 4.0017e+05],
        [3.9164e+05, 7.7542e+05, 3.9165e+05, 3.9167e+05, 7.8778e+05, 0.0000e+00,
         3.9164e+05, 7.9825e+05, 3.9167e+05, 3.9167e+05, 7.7632e+05, 7.9508e+05,
         3.9164e+05, 3.9162e+05, 7.8148e+05, 3.9164e+05],
        [1.1782e+00, 3.8843e+05, 1.2469e+00, 1.3607e+00, 4.0018e+05, 3.9164e+05,
         0.0000e+00, 4.0283e+05, 1.2969e+00, 1.2077e+00, 3.7957e+05, 3.9868e+05,
         1.4766e+00, 1.3690e+00, 3.9175e+05, 1.2873e+00],
        [4.0280e+05, 8.0879e+05, 4.0281e+05, 4.0281e+05, 8.0927e+05, 7.9825e+05,
         4.0283e+05, 0.0000e+00, 4.0281e+05, 4.0283e+05, 7.8398e+05, 8.1978e+05,
         4.0283e+05, 4.0283e+05, 8.0706e+05, 4.0284e+05],
        [1.2779e+00, 3.8841e+05, 1.4155e+00, 1.3029e+00, 4.0018e+05, 3.9167e+05,
         1.2969e+00, 4.0281e+05, 0.0000e+00, 1.3732e+00, 3.7957e+05, 3.9870e+05,
         1.8011e+00, 1.6392e+00, 3.9176e+05, 1.5272e+00],
        [1.1138e+00, 3.8842e+05, 1.1256e+00, 1.2546e+00, 4.0018e+05, 3.9167e+05,
         1.2077e+00, 4.0283e+05, 1.3732e+00, 0.0000e+00, 3.7958e+05, 3.9869e+05,
         1.3258e+00, 1.1677e+00, 3.9177e+05, 1.1892e+00],
        [3.7958e+05, 7.9756e+05, 3.7961e+05, 3.7959e+05, 7.8733e+05, 7.7632e+05,
         3.7957e+05, 7.8398e+05, 3.7957e+05, 3.7958e+05, 0.0000e+00, 7.7205e+05,
         3.7962e+05, 3.7961e+05, 7.7605e+05, 3.7962e+05],
        [3.9869e+05, 7.9938e+05, 3.9870e+05, 3.9869e+05, 8.0002e+05, 7.9508e+05,
         3.9868e+05, 8.1978e+05, 3.9870e+05, 3.9869e+05, 7.7205e+05, 0.0000e+00,
         3.9870e+05, 3.9869e+05, 7.9352e+05, 3.9868e+05],
        [1.4832e+00, 3.8842e+05, 1.2317e+00, 1.6610e+00, 4.0018e+05, 3.9164e+05,
         1.4766e+00, 4.0283e+05, 1.8011e+00, 1.3258e+00, 3.7962e+05, 3.9870e+05,
         0.0000e+00, 1.1865e+00, 3.9173e+05, 1.2260e+00],
        [1.2342e+00, 3.8844e+05, 1.1125e+00, 1.3927e+00, 4.0018e+05, 3.9162e+05,
         1.3690e+00, 4.0283e+05, 1.6392e+00, 1.1677e+00, 3.7961e+05, 3.9869e+05,
         1.1865e+00, 0.0000e+00, 3.9173e+05, 1.1416e+00],
        [3.9173e+05, 8.0232e+05, 3.9175e+05, 3.9177e+05, 7.9538e+05, 7.8148e+05,
         3.9175e+05, 8.0706e+05, 3.9176e+05, 3.9177e+05, 7.7605e+05, 7.9352e+05,
         3.9173e+05, 3.9173e+05, 0.0000e+00, 3.9172e+05],
        [1.2511e+00, 3.8841e+05, 1.0737e+00, 1.4043e+00, 4.0017e+05, 3.9164e+05,
         1.2873e+00, 4.0284e+05, 1.5272e+00, 1.1892e+00, 3.7962e+05, 3.9868e+05,
         1.2260e+00, 1.1416e+00, 3.9172e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1138e+00, 1.1401e+00, 1.1782e+00, 1.2342e+00, 1.2408e+00,
        1.2511e+00, 1.2779e+00, 1.4832e+00, 3.7958e+05, 3.8841e+05, 3.9164e+05,
        3.9173e+05, 3.9869e+05, 4.0020e+05, 4.0280e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388391.3125, 388405.6875, 388410.4375, 388412.6250,
        388413.8750, 388415.0312, 388423.3750, 388425.1250, 388441.5625,
        775423.6875, 779059.6875, 797556.6250, 799376.6875, 802315.2500,
        808787.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0737e+00, 1.1125e+00, 1.1256e+00, 1.1401e+00, 1.2219e+00,
        1.2317e+00, 1.2469e+00, 1.4155e+00, 3.7961e+05, 3.8841e+05, 3.9165e+05,
        3.9175e+05, 3.9870e+05, 4.0016e+05, 4.0281e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2219e+00, 1.2408e+00, 1.2546e+00, 1.3029e+00, 1.3607e+00,
        1.3927e+00, 1.4043e+00, 1.6610e+00, 3.7959e+05, 3.8839e+05, 3.9167e+05,
        3.9177e+05, 3.9869e+05, 4.0019e+05, 4.0281e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400164.9688, 400166.2812, 400175.5312, 400177.6875,
        400180.7500, 400183.2188, 400183.8438, 400194.6250, 400195.8750,
        779059.6875, 787330.8750, 787778.1875, 795377.2500, 800024.2500,
        809267.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391622.8438, 391640.8750, 391641.9062, 391643.3750,
        391643.7500, 391651.0938, 391668.3438, 391673.7812, 391674.8750,
        775423.6875, 776321.5625, 781475.6875, 787778.1875, 795075.6875,
        798245.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1782e+00, 1.2077e+00, 1.2469e+00, 1.2873e+00, 1.2969e+00,
        1.3607e+00, 1.3690e+00, 1.4766e+00, 3.7957e+05, 3.8843e+05, 3.9164e+05,
        3.9175e+05, 3.9868e+05, 4.0018e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402803.5625, 402811.5000, 402811.6250, 402814.5312,
        402825.6875, 402827.9375, 402829.8750, 402834.0625, 402837.3125,
        783979.0625, 798245.1250, 807056.1875, 808787.4375, 809267.8750,
        819779.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2779e+00, 1.2969e+00, 1.3029e+00, 1.3732e+00, 1.4155e+00,
        1.5272e+00, 1.6392e+00, 1.8011e+00, 3.7957e+05, 3.8841e+05, 3.9167e+05,
        3.9176e+05, 3.9870e+05, 4.0018e+05, 4.0281e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1138e+00, 1.1256e+00, 1.1677e+00, 1.1892e+00, 1.2077e+00,
        1.2546e+00, 1.3258e+00, 1.3732e+00, 3.7958e+05, 3.8842e+05, 3.9167e+05,
        3.9177e+05, 3.9869e+05, 4.0018e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379569.5000, 379572.2500, 379582.7812, 379583.4688,
        379590.0000, 379605.6250, 379612.1250, 379615.0000, 379615.4375,
        772053.6875, 776054.6250, 776321.5625, 783979.0625, 787330.8750,
        797556.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398676.4062, 398682.2500, 398685.0312, 398685.2812,
        398687.3750, 398691.6875, 398695.5938, 398695.8750, 398697.3438,
        772053.6875, 793520.3750, 795075.6875, 799376.6875, 800024.2500,
        819779.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1865e+00, 1.2260e+00, 1.2317e+00, 1.3258e+00, 1.4766e+00,
        1.4832e+00, 1.6610e+00, 1.8011e+00, 3.7962e+05, 3.8842e+05, 3.9164e+05,
        3.9173e+05, 3.9870e+05, 4.0018e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1125e+00, 1.1416e+00, 1.1677e+00, 1.1865e+00, 1.2342e+00,
        1.3690e+00, 1.3927e+00, 1.6392e+00, 3.7961e+05, 3.8844e+05, 3.9162e+05,
        3.9173e+05, 3.9869e+05, 4.0018e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391721.9375, 391726.5625, 391728.9375, 391732.0938,
        391746.5000, 391753.1250, 391759.9375, 391771.0625, 391774.0938,
        776054.6250, 781475.6875, 793520.3750, 795377.2500, 802315.2500,
        807056.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0737e+00, 1.1416e+00, 1.1892e+00, 1.2260e+00, 1.2511e+00,
        1.2873e+00, 1.4043e+00, 1.5272e+00, 3.7962e+05, 3.8841e+05, 3.9164e+05,
        3.9172e+05, 3.9868e+05, 4.0017e+05, 4.0284e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76800.73', '427116.31', '76802.09', '76799.22', '438068.25', '430028.44', '76800.79', '440937.50', '76799.16', '76801.59', '418840.00', '436025.06', '76804.15', '76806.39', '430176.91', '76803.81']
estimated f for each client, fs: [7, 5, 7, 7, 5, 5, 7, 5, 7, 7, 6, 5, 7, 7, 5, 7]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0104s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:28:59...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:28:59, End: 2025-07-22 15:28:59)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 9, 18, 8, 15, 4, 3, 13, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.5395e+00, 1.4871e+00, 3.8440e+05, 3.8816e+05, 1.5094e+00,
         3.6364e+05, 1.6957e+00, 3.9545e+05, 1.5178e+00, 1.4333e+00, 3.9657e+05,
         1.7207e+00, 1.5928e+00, 4.0455e+05, 1.5893e+00, 1.4651e+00],
        [1.5395e+00, 0.0000e+00, 1.4976e+00, 3.8436e+05, 3.8811e+05, 1.4214e+00,
         3.6361e+05, 1.6690e+00, 3.9545e+05, 1.5387e+00, 1.4651e+00, 3.9659e+05,
         1.8045e+00, 1.6920e+00, 4.0457e+05, 1.6698e+00, 1.5896e+00],
        [1.4871e+00, 1.4976e+00, 0.0000e+00, 3.8439e+05, 3.8812e+05, 1.4147e+00,
         3.6364e+05, 1.4093e+00, 3.9548e+05, 1.3295e+00, 1.2773e+00, 3.9659e+05,
         1.5165e+00, 1.3347e+00, 4.0455e+05, 1.3858e+00, 1.3239e+00],
        [3.8440e+05, 3.8436e+05, 3.8439e+05, 0.0000e+00, 7.8609e+05, 3.8441e+05,
         7.2887e+05, 3.8440e+05, 7.7137e+05, 3.8436e+05, 3.8438e+05, 7.9987e+05,
         3.8439e+05, 3.8437e+05, 7.9065e+05, 3.8440e+05, 3.8436e+05],
        [3.8816e+05, 3.8811e+05, 3.8812e+05, 7.8609e+05, 0.0000e+00, 3.8812e+05,
         7.8096e+05, 3.8810e+05, 7.8269e+05, 3.8810e+05, 3.8811e+05, 8.1600e+05,
         3.8813e+05, 3.8811e+05, 7.9163e+05, 3.8811e+05, 3.8811e+05],
        [1.5094e+00, 1.4214e+00, 1.4147e+00, 3.8441e+05, 3.8812e+05, 0.0000e+00,
         3.6366e+05, 1.5439e+00, 3.9545e+05, 1.5423e+00, 1.4537e+00, 3.9655e+05,
         1.6654e+00, 1.4611e+00, 4.0455e+05, 1.5211e+00, 1.4664e+00],
        [3.6364e+05, 3.6361e+05, 3.6364e+05, 7.2887e+05, 7.8096e+05, 3.6366e+05,
         0.0000e+00, 3.6363e+05, 7.4701e+05, 3.6361e+05, 3.6364e+05, 7.4458e+05,
         3.6363e+05, 3.6364e+05, 7.6830e+05, 3.6364e+05, 3.6363e+05],
        [1.6957e+00, 1.6690e+00, 1.4093e+00, 3.8440e+05, 3.8810e+05, 1.5439e+00,
         3.6363e+05, 0.0000e+00, 3.9547e+05, 1.4600e+00, 1.4312e+00, 3.9659e+05,
         1.5238e+00, 1.5206e+00, 4.0454e+05, 1.4473e+00, 1.5106e+00],
        [3.9545e+05, 3.9545e+05, 3.9548e+05, 7.7137e+05, 7.8269e+05, 3.9545e+05,
         7.4701e+05, 3.9547e+05, 0.0000e+00, 3.9547e+05, 3.9548e+05, 8.0227e+05,
         3.9544e+05, 3.9543e+05, 8.0817e+05, 3.9542e+05, 3.9547e+05],
        [1.5178e+00, 1.5387e+00, 1.3295e+00, 3.8436e+05, 3.8810e+05, 1.5423e+00,
         3.6361e+05, 1.4600e+00, 3.9547e+05, 0.0000e+00, 1.4241e+00, 3.9657e+05,
         1.4777e+00, 1.4532e+00, 4.0457e+05, 1.4708e+00, 1.4427e+00],
        [1.4333e+00, 1.4651e+00, 1.2773e+00, 3.8438e+05, 3.8811e+05, 1.4537e+00,
         3.6364e+05, 1.4312e+00, 3.9548e+05, 1.4241e+00, 0.0000e+00, 3.9663e+05,
         1.3615e+00, 1.3145e+00, 4.0455e+05, 1.3366e+00, 1.2834e+00],
        [3.9657e+05, 3.9659e+05, 3.9659e+05, 7.9987e+05, 8.1600e+05, 3.9655e+05,
         7.4458e+05, 3.9659e+05, 8.0227e+05, 3.9657e+05, 3.9663e+05, 0.0000e+00,
         3.9656e+05, 3.9658e+05, 8.0298e+05, 3.9659e+05, 3.9656e+05],
        [1.7207e+00, 1.8045e+00, 1.5165e+00, 3.8439e+05, 3.8813e+05, 1.6654e+00,
         3.6363e+05, 1.5238e+00, 3.9544e+05, 1.4777e+00, 1.3615e+00, 3.9656e+05,
         0.0000e+00, 1.2175e+00, 4.0457e+05, 1.2508e+00, 1.5601e+00],
        [1.5928e+00, 1.6920e+00, 1.3347e+00, 3.8437e+05, 3.8811e+05, 1.4611e+00,
         3.6364e+05, 1.5206e+00, 3.9543e+05, 1.4532e+00, 1.3145e+00, 3.9658e+05,
         1.2175e+00, 0.0000e+00, 4.0455e+05, 1.2531e+00, 1.3887e+00],
        [4.0455e+05, 4.0457e+05, 4.0455e+05, 7.9065e+05, 7.9163e+05, 4.0455e+05,
         7.6830e+05, 4.0454e+05, 8.0817e+05, 4.0457e+05, 4.0455e+05, 8.0298e+05,
         4.0457e+05, 4.0455e+05, 0.0000e+00, 4.0453e+05, 4.0454e+05],
        [1.5893e+00, 1.6698e+00, 1.3858e+00, 3.8440e+05, 3.8811e+05, 1.5211e+00,
         3.6364e+05, 1.4473e+00, 3.9542e+05, 1.4708e+00, 1.3366e+00, 3.9659e+05,
         1.2508e+00, 1.2531e+00, 4.0453e+05, 0.0000e+00, 1.4373e+00],
        [1.4651e+00, 1.5896e+00, 1.3239e+00, 3.8436e+05, 3.8811e+05, 1.4664e+00,
         3.6363e+05, 1.5106e+00, 3.9547e+05, 1.4427e+00, 1.2834e+00, 3.9656e+05,
         1.5601e+00, 1.3887e+00, 4.0454e+05, 1.4373e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4333e+00, 1.4651e+00, 1.4871e+00, 1.5094e+00, 1.5178e+00,
        1.5395e+00, 1.5893e+00, 1.5928e+00, 1.6957e+00, 1.7207e+00, 3.6364e+05,
        3.8440e+05, 3.8816e+05, 3.9545e+05, 3.9657e+05, 4.0455e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4214e+00, 1.4651e+00, 1.4976e+00, 1.5387e+00, 1.5395e+00,
        1.5896e+00, 1.6690e+00, 1.6698e+00, 1.6920e+00, 1.8045e+00, 3.6361e+05,
        3.8436e+05, 3.8811e+05, 3.9545e+05, 3.9659e+05, 4.0457e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2773e+00, 1.3239e+00, 1.3295e+00, 1.3347e+00, 1.3858e+00,
        1.4093e+00, 1.4147e+00, 1.4871e+00, 1.4976e+00, 1.5165e+00, 3.6364e+05,
        3.8439e+05, 3.8812e+05, 3.9548e+05, 3.9659e+05, 4.0455e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384357.5000, 384360.7812, 384361.1562, 384367.9375,
        384375.6250, 384386.9062, 384387.6562, 384395.3750, 384397.2500,
        384400.3750, 384406.6875, 728869.0625, 771371.1250, 786089.4375,
        790647.0000, 799872.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388100.8438, 388104.5000, 388106.5000, 388112.3125,
        388112.3438, 388114.2188, 388114.3750, 388120.5312, 388121.6250,
        388131.6875, 388157.5000, 780960.3125, 782693.3750, 786089.4375,
        791634.0000, 815996.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4147e+00, 1.4214e+00, 1.4537e+00, 1.4611e+00, 1.4664e+00,
        1.5094e+00, 1.5211e+00, 1.5423e+00, 1.5439e+00, 1.6654e+00, 3.6366e+05,
        3.8441e+05, 3.8812e+05, 3.9545e+05, 3.9655e+05, 4.0455e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 363608.9375, 363613.0625, 363629.2812, 363630.7188,
        363631.0938, 363635.6250, 363636.2500, 363638.1250, 363638.7500,
        363644.8125, 363663.9375, 728869.0625, 744575.1875, 747005.5000,
        768304.8750, 780960.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4093e+00, 1.4312e+00, 1.4473e+00, 1.4600e+00, 1.5106e+00,
        1.5206e+00, 1.5238e+00, 1.5439e+00, 1.6690e+00, 1.6957e+00, 3.6363e+05,
        3.8440e+05, 3.8810e+05, 3.9547e+05, 3.9659e+05, 4.0454e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395419.2188, 395429.7188, 395443.9688, 395449.2500,
        395452.4375, 395453.7188, 395469.0938, 395471.4688, 395471.4688,
        395475.9062, 395481.1562, 747005.5000, 771371.1250, 782693.3750,
        802271.5000, 808169.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3295e+00, 1.4241e+00, 1.4427e+00, 1.4532e+00, 1.4600e+00,
        1.4708e+00, 1.4777e+00, 1.5178e+00, 1.5387e+00, 1.5423e+00, 3.6361e+05,
        3.8436e+05, 3.8810e+05, 3.9547e+05, 3.9657e+05, 4.0457e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2773e+00, 1.2834e+00, 1.3145e+00, 1.3366e+00, 1.3615e+00,
        1.4241e+00, 1.4312e+00, 1.4333e+00, 1.4537e+00, 1.4651e+00, 3.6364e+05,
        3.8438e+05, 3.8811e+05, 3.9548e+05, 3.9663e+05, 4.0455e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396551.9062, 396562.3125, 396562.8438, 396569.2812,
        396574.1875, 396584.2812, 396586.7500, 396591.4062, 396592.2500,
        396592.3750, 396626.8438, 744575.1875, 799872.5000, 802271.5000,
        802976.3125, 815996.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2175e+00, 1.2508e+00, 1.3615e+00, 1.4777e+00, 1.5165e+00,
        1.5238e+00, 1.5601e+00, 1.6654e+00, 1.7207e+00, 1.8045e+00, 3.6363e+05,
        3.8439e+05, 3.8813e+05, 3.9544e+05, 3.9656e+05, 4.0457e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2175e+00, 1.2531e+00, 1.3145e+00, 1.3347e+00, 1.3887e+00,
        1.4532e+00, 1.4611e+00, 1.5206e+00, 1.5928e+00, 1.6920e+00, 3.6364e+05,
        3.8437e+05, 3.8811e+05, 3.9543e+05, 3.9658e+05, 4.0455e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404527.6875, 404538.7188, 404543.1875, 404548.6250,
        404553.4375, 404553.8750, 404554.3750, 404554.6875, 404566.6250,
        404569.5000, 404574.2500, 768304.8750, 790647.0000, 791634.0000,
        802976.3125, 808169.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2508e+00, 1.2531e+00, 1.3366e+00, 1.3858e+00, 1.4373e+00,
        1.4473e+00, 1.4708e+00, 1.5211e+00, 1.5893e+00, 1.6698e+00, 3.6364e+05,
        3.8440e+05, 3.8811e+05, 3.9542e+05, 3.9659e+05, 4.0453e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2834e+00, 1.3239e+00, 1.3887e+00, 1.4373e+00, 1.4427e+00,
        1.4651e+00, 1.4664e+00, 1.5106e+00, 1.5601e+00, 1.5896e+00, 3.6363e+05,
        3.8436e+05, 3.8811e+05, 3.9547e+05, 3.9656e+05, 4.0454e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.56', '1.59', '1.40', '384381.59', '388113.91', '1.50', '363630.66', '1.52', '395456.12', '1.47', '1.38', '396581.31', '1.51', '1.42', '404553.12', '1.44', '1.45']
estimated f for each client, fs: [6, 6, 6, 4, 6, 6, 6, 6, 4, 6, 6, 4, 6, 6, 4, 6, 6]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 9, 18, 8, 15, 4, 3, 13, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0123s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:00...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:00, End: 2025-07-22 15:29:00)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.9524e+05, 3.9578e+05, 1.3678e+00, 3.8412e+05, 1.4622e+00,
         3.9639e+05, 1.3623e+00, 1.6090e+00, 3.8344e+05, 3.9356e+05, 1.4673e+00,
         1.5382e+00],
        [3.9524e+05, 0.0000e+00, 8.0069e+05, 3.9525e+05, 7.5504e+05, 3.9522e+05,
         8.0636e+05, 3.9522e+05, 3.9521e+05, 7.9123e+05, 8.0348e+05, 3.9520e+05,
         3.9523e+05],
        [3.9578e+05, 8.0069e+05, 0.0000e+00, 3.9580e+05, 7.8714e+05, 3.9581e+05,
         8.0057e+05, 3.9583e+05, 3.9580e+05, 7.8873e+05, 7.9228e+05, 3.9577e+05,
         3.9579e+05],
        [1.3678e+00, 3.9525e+05, 3.9580e+05, 0.0000e+00, 3.8412e+05, 1.2627e+00,
         3.9635e+05, 1.2926e+00, 1.3074e+00, 3.8342e+05, 3.9357e+05, 1.1036e+00,
         1.1930e+00],
        [3.8412e+05, 7.5504e+05, 7.8714e+05, 3.8412e+05, 0.0000e+00, 3.8410e+05,
         8.0196e+05, 3.8410e+05, 3.8409e+05, 7.6616e+05, 7.7261e+05, 3.8407e+05,
         3.8409e+05],
        [1.4622e+00, 3.9522e+05, 3.9581e+05, 1.2627e+00, 3.8410e+05, 0.0000e+00,
         3.9637e+05, 1.2472e+00, 1.5562e+00, 3.8342e+05, 3.9358e+05, 1.3433e+00,
         1.4001e+00],
        [3.9639e+05, 8.0636e+05, 8.0057e+05, 3.9635e+05, 8.0196e+05, 3.9637e+05,
         0.0000e+00, 3.9632e+05, 3.9636e+05, 7.7003e+05, 7.7949e+05, 3.9633e+05,
         3.9635e+05],
        [1.3623e+00, 3.9522e+05, 3.9583e+05, 1.2926e+00, 3.8410e+05, 1.2472e+00,
         3.9632e+05, 0.0000e+00, 1.4901e+00, 3.8337e+05, 3.9357e+05, 1.2525e+00,
         1.3835e+00],
        [1.6090e+00, 3.9521e+05, 3.9580e+05, 1.3074e+00, 3.8409e+05, 1.5562e+00,
         3.9636e+05, 1.4901e+00, 0.0000e+00, 3.8342e+05, 3.9356e+05, 1.1266e+00,
         1.2316e+00],
        [3.8344e+05, 7.9123e+05, 7.8873e+05, 3.8342e+05, 7.6616e+05, 3.8342e+05,
         7.7003e+05, 3.8337e+05, 3.8342e+05, 0.0000e+00, 7.7540e+05, 3.8340e+05,
         3.8341e+05],
        [3.9356e+05, 8.0348e+05, 7.9228e+05, 3.9357e+05, 7.7261e+05, 3.9358e+05,
         7.7949e+05, 3.9357e+05, 3.9356e+05, 7.7540e+05, 0.0000e+00, 3.9355e+05,
         3.9353e+05],
        [1.4673e+00, 3.9520e+05, 3.9577e+05, 1.1036e+00, 3.8407e+05, 1.3433e+00,
         3.9633e+05, 1.2525e+00, 1.1266e+00, 3.8340e+05, 3.9355e+05, 0.0000e+00,
         1.1103e+00],
        [1.5382e+00, 3.9523e+05, 3.9579e+05, 1.1930e+00, 3.8409e+05, 1.4001e+00,
         3.9635e+05, 1.3835e+00, 1.2316e+00, 3.8341e+05, 3.9353e+05, 1.1103e+00,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3623e+00, 1.3678e+00, 1.4622e+00, 1.4673e+00, 1.5382e+00,
        1.6090e+00, 3.8344e+05, 3.8412e+05, 3.9356e+05, 3.9524e+05, 3.9578e+05,
        3.9639e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 395199.5938, 395214.1875, 395219.0938, 395221.0000,
        395225.8125, 395238.6250, 395251.8125, 755035.3750, 791232.1250,
        800685.8750, 803481.0625, 806361.3125])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 395765.9062, 395782.7500, 395788.4375, 395795.1562,
        395797.6875, 395809.9375, 395828.5312, 787141.8750, 788729.8750,
        792277.4375, 800574.1875, 800685.8750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1036e+00, 1.1930e+00, 1.2627e+00, 1.2926e+00, 1.3074e+00,
        1.3678e+00, 3.8342e+05, 3.8412e+05, 3.9357e+05, 3.9525e+05, 3.9580e+05,
        3.9635e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 384072.9375, 384094.1562, 384094.8438, 384095.3125,
        384103.0625, 384117.7500, 384121.6562, 755035.3750, 766160.7500,
        772607.6875, 787141.8750, 801960.6875])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.2472e+00, 1.2627e+00, 1.3433e+00, 1.4001e+00, 1.4622e+00,
        1.5562e+00, 3.8342e+05, 3.8410e+05, 3.9358e+05, 3.9522e+05, 3.9581e+05,
        3.9637e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 396322.3125, 396327.7188, 396346.2812, 396348.6875,
        396362.8438, 396373.8125, 396390.5312, 770033.8750, 779488.7500,
        800574.1875, 801960.6875, 806361.3125])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.2472e+00, 1.2525e+00, 1.2926e+00, 1.3623e+00, 1.3835e+00,
        1.4901e+00, 3.8337e+05, 3.8410e+05, 3.9357e+05, 3.9522e+05, 3.9583e+05,
        3.9632e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1266e+00, 1.2316e+00, 1.3074e+00, 1.4901e+00, 1.5562e+00,
        1.6090e+00, 3.8342e+05, 3.8409e+05, 3.9356e+05, 3.9521e+05, 3.9580e+05,
        3.9636e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 383374.6875, 383404.5938, 383410.0312, 383415.3750,
        383417.6875, 383421.9375, 383437.9688, 766160.7500, 770033.8750,
        775399.3750, 788729.8750, 791232.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 393532.6562, 393554.1562, 393556.0000, 393559.5312,
        393571.7500, 393572.9375, 393579.3125, 772607.6875, 775399.3750,
        779488.7500, 792277.4375, 803481.0625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1036e+00, 1.1103e+00, 1.1266e+00, 1.2525e+00, 1.3433e+00,
        1.4673e+00, 3.8340e+05, 3.8407e+05, 3.9355e+05, 3.9520e+05, 3.9577e+05,
        3.9633e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1103e+00, 1.1930e+00, 1.2316e+00, 1.3835e+00, 1.4001e+00,
        1.5382e+00, 3.8341e+05, 3.8409e+05, 3.9353e+05, 3.9523e+05, 3.9579e+05,
        3.9635e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['95946.05', '440200.69', '444713.78', '95943.40', '430466.91', '95940.84', '443063.25', '95934.75', '95940.11', '431255.38', '440941.75', '95935.62', '95939.01']
estimated f for each client, fs: [6, 4, 4, 6, 4, 6, 4, 6, 6, 4, 4, 6, 6]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0256s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:00...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:00, End: 2025-07-22 15:29:00)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 1, 9, 18, 8, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3444e+00, 1.3864e+00, 3.9682e+05, 1.3648e+00, 1.3608e+00,
         3.6745e+05, 1.4538e+00, 1.6115e+00, 1.3883e+00, 3.9167e+05, 3.8615e+05,
         1.4382e+00, 4.0214e+05, 1.3792e+00, 1.3157e+00],
        [1.3444e+00, 0.0000e+00, 1.3155e+00, 3.9679e+05, 1.3599e+00, 1.2330e+00,
         3.6745e+05, 1.4150e+00, 1.6936e+00, 1.5003e+00, 3.9167e+05, 3.8615e+05,
         1.4898e+00, 4.0213e+05, 1.3685e+00, 1.3671e+00],
        [1.3864e+00, 1.3155e+00, 0.0000e+00, 3.9683e+05, 1.2062e+00, 1.2934e+00,
         3.6748e+05, 1.2455e+00, 1.3840e+00, 1.2820e+00, 3.9166e+05, 3.8615e+05,
         1.2246e+00, 4.0214e+05, 1.2437e+00, 1.2447e+00],
        [3.9682e+05, 3.9679e+05, 3.9683e+05, 0.0000e+00, 3.9681e+05, 3.9680e+05,
         7.5194e+05, 3.9680e+05, 3.9680e+05, 3.9680e+05, 7.9451e+05, 8.1313e+05,
         3.9685e+05, 8.0634e+05, 3.9680e+05, 3.9679e+05],
        [1.3648e+00, 1.3599e+00, 1.2062e+00, 3.9681e+05, 0.0000e+00, 1.2714e+00,
         3.6746e+05, 1.3020e+00, 1.3182e+00, 1.1711e+00, 3.9166e+05, 3.8614e+05,
         1.1357e+00, 4.0212e+05, 1.0860e+00, 1.2280e+00],
        [1.3608e+00, 1.2330e+00, 1.2934e+00, 3.9680e+05, 1.2714e+00, 0.0000e+00,
         3.6744e+05, 1.3166e+00, 1.6147e+00, 1.4490e+00, 3.9167e+05, 3.8616e+05,
         1.3233e+00, 4.0214e+05, 1.2808e+00, 1.3108e+00],
        [3.6745e+05, 3.6745e+05, 3.6748e+05, 7.5194e+05, 3.6746e+05, 3.6744e+05,
         0.0000e+00, 3.6745e+05, 3.6743e+05, 3.6747e+05, 7.6824e+05, 7.5718e+05,
         3.6743e+05, 7.7975e+05, 3.6743e+05, 3.6746e+05],
        [1.4538e+00, 1.4150e+00, 1.2455e+00, 3.9680e+05, 1.3020e+00, 1.3166e+00,
         3.6745e+05, 0.0000e+00, 1.5252e+00, 1.3837e+00, 3.9166e+05, 3.8616e+05,
         1.3900e+00, 4.0212e+05, 1.2666e+00, 1.3381e+00],
        [1.6115e+00, 1.6936e+00, 1.3840e+00, 3.9680e+05, 1.3182e+00, 1.6147e+00,
         3.6743e+05, 1.5252e+00, 0.0000e+00, 1.1857e+00, 3.9165e+05, 3.8615e+05,
         1.2936e+00, 4.0216e+05, 1.3775e+00, 1.5041e+00],
        [1.3883e+00, 1.5003e+00, 1.2820e+00, 3.9680e+05, 1.1711e+00, 1.4490e+00,
         3.6747e+05, 1.3837e+00, 1.1857e+00, 0.0000e+00, 3.9167e+05, 3.8613e+05,
         1.0978e+00, 4.0214e+05, 1.1725e+00, 1.2583e+00],
        [3.9167e+05, 3.9167e+05, 3.9166e+05, 7.9451e+05, 3.9166e+05, 3.9167e+05,
         7.6824e+05, 3.9166e+05, 3.9165e+05, 3.9167e+05, 0.0000e+00, 7.9246e+05,
         3.9166e+05, 7.9309e+05, 3.9165e+05, 3.9168e+05],
        [3.8615e+05, 3.8615e+05, 3.8615e+05, 8.1313e+05, 3.8614e+05, 3.8616e+05,
         7.5718e+05, 3.8616e+05, 3.8615e+05, 3.8613e+05, 7.9246e+05, 0.0000e+00,
         3.8615e+05, 7.8539e+05, 3.8615e+05, 3.8615e+05],
        [1.4382e+00, 1.4898e+00, 1.2246e+00, 3.9685e+05, 1.1357e+00, 1.3233e+00,
         3.6743e+05, 1.3900e+00, 1.2936e+00, 1.0978e+00, 3.9166e+05, 3.8615e+05,
         0.0000e+00, 4.0215e+05, 1.1260e+00, 1.2526e+00],
        [4.0214e+05, 4.0213e+05, 4.0214e+05, 8.0634e+05, 4.0212e+05, 4.0214e+05,
         7.7975e+05, 4.0212e+05, 4.0216e+05, 4.0214e+05, 7.9309e+05, 7.8539e+05,
         4.0215e+05, 0.0000e+00, 4.0215e+05, 4.0213e+05],
        [1.3792e+00, 1.3685e+00, 1.2437e+00, 3.9680e+05, 1.0860e+00, 1.2808e+00,
         3.6743e+05, 1.2666e+00, 1.3775e+00, 1.1725e+00, 3.9165e+05, 3.8615e+05,
         1.1260e+00, 4.0215e+05, 0.0000e+00, 1.2701e+00],
        [1.3157e+00, 1.3671e+00, 1.2447e+00, 3.9679e+05, 1.2280e+00, 1.3108e+00,
         3.6746e+05, 1.3381e+00, 1.5041e+00, 1.2583e+00, 3.9168e+05, 3.8615e+05,
         1.2526e+00, 4.0213e+05, 1.2701e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3157e+00, 1.3444e+00, 1.3608e+00, 1.3648e+00, 1.3792e+00,
        1.3864e+00, 1.3883e+00, 1.4382e+00, 1.4538e+00, 1.6115e+00, 3.6745e+05,
        3.8615e+05, 3.9167e+05, 3.9682e+05, 4.0214e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2330e+00, 1.3155e+00, 1.3444e+00, 1.3599e+00, 1.3671e+00,
        1.3685e+00, 1.4150e+00, 1.4898e+00, 1.5003e+00, 1.6936e+00, 3.6745e+05,
        3.8615e+05, 3.9167e+05, 3.9679e+05, 4.0213e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2062e+00, 1.2246e+00, 1.2437e+00, 1.2447e+00, 1.2455e+00,
        1.2820e+00, 1.2934e+00, 1.3155e+00, 1.3840e+00, 1.3864e+00, 3.6748e+05,
        3.8615e+05, 3.9166e+05, 3.9683e+05, 4.0214e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396787.0000, 396793.8750, 396795.6562, 396795.7812,
        396801.4062, 396804.5938, 396804.8125, 396808.0625, 396819.5312,
        396828.9375, 396846.8750, 751936.8750, 794508.1250, 806341.4375,
        813134.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0860e+00, 1.1357e+00, 1.1711e+00, 1.2062e+00, 1.2280e+00,
        1.2714e+00, 1.3020e+00, 1.3182e+00, 1.3599e+00, 1.3648e+00, 3.6746e+05,
        3.8614e+05, 3.9166e+05, 3.9681e+05, 4.0212e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2330e+00, 1.2714e+00, 1.2808e+00, 1.2934e+00, 1.3108e+00,
        1.3166e+00, 1.3233e+00, 1.3608e+00, 1.4490e+00, 1.6147e+00, 3.6744e+05,
        3.8616e+05, 3.9167e+05, 3.9680e+05, 4.0214e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 367431.4688, 367432.9375, 367434.4375, 367443.5312,
        367448.8438, 367451.1875, 367452.9688, 367457.4375, 367459.4688,
        367466.5000, 367480.5312, 751936.8750, 757183.6250, 768235.0625,
        779749.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2455e+00, 1.2666e+00, 1.3020e+00, 1.3166e+00, 1.3381e+00,
        1.3837e+00, 1.3900e+00, 1.4150e+00, 1.4538e+00, 1.5252e+00, 3.6745e+05,
        3.8616e+05, 3.9166e+05, 3.9680e+05, 4.0212e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1857e+00, 1.2936e+00, 1.3182e+00, 1.3775e+00, 1.3840e+00,
        1.5041e+00, 1.5252e+00, 1.6115e+00, 1.6147e+00, 1.6936e+00, 3.6743e+05,
        3.8615e+05, 3.9165e+05, 3.9680e+05, 4.0216e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0978e+00, 1.1711e+00, 1.1725e+00, 1.1857e+00, 1.2583e+00,
        1.2820e+00, 1.3837e+00, 1.3883e+00, 1.4490e+00, 1.5003e+00, 3.6747e+05,
        3.8613e+05, 3.9167e+05, 3.9680e+05, 4.0214e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391645.7812, 391648.5625, 391660.8125, 391663.0625,
        391663.1250, 391663.8750, 391666.7500, 391667.3438, 391668.0000,
        391669.4375, 391684.1875, 768235.0625, 792459.0000, 793088.2500,
        794508.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386134.9062, 386142.1562, 386145.3750, 386146.2812,
        386146.4375, 386149.2188, 386149.2500, 386149.3750, 386149.9375,
        386156.3125, 386162.7188, 757183.6250, 785394.1250, 792459.0000,
        813134.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0978e+00, 1.1260e+00, 1.1357e+00, 1.2246e+00, 1.2526e+00,
        1.2936e+00, 1.3233e+00, 1.3900e+00, 1.4382e+00, 1.4898e+00, 3.6743e+05,
        3.8615e+05, 3.9166e+05, 3.9685e+05, 4.0215e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402122.4375, 402124.6250, 402129.9375, 402133.1562,
        402135.3438, 402137.1875, 402139.3750, 402141.0938, 402145.9062,
        402147.4688, 402155.1875, 779749.5000, 785394.1250, 793088.2500,
        806341.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0860e+00, 1.1260e+00, 1.1725e+00, 1.2437e+00, 1.2666e+00,
        1.2701e+00, 1.2808e+00, 1.3685e+00, 1.3775e+00, 1.3792e+00, 3.6743e+05,
        3.8615e+05, 3.9165e+05, 3.9680e+05, 4.0215e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2280e+00, 1.2447e+00, 1.2526e+00, 1.2583e+00, 1.2701e+00,
        1.3108e+00, 1.3157e+00, 1.3381e+00, 1.3671e+00, 1.5041e+00, 3.6746e+05,
        3.8615e+05, 3.9168e+05, 3.9679e+05, 4.0213e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.40', '1.41', '1.28', '396807.88', '1.24', '1.35', '367447.91', '1.36', '1.45', '1.29', '391663.72', '386148.38', '1.28', '402137.41', '1.26', '1.31']
estimated f for each client, fs: [5, 5, 5, 3, 5, 5, 5, 5, 5, 5, 3, 3, 5, 3, 5, 5]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 1, 9, 18, 8, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:01...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:01, End: 2025-07-22 15:29:01)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [7, 19, 17, 1, 20, 8, 4, 3, 13, 11, 10, 16, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.8398e+05, 3.9579e+05, 1.8111e+00, 3.8985e+05, 1.3424e+00,
         1.3953e+00, 1.3744e+00, 3.9952e+05, 1.4554e+00, 1.4516e+00, 4.0371e+05,
         1.3321e+00],
        [3.8398e+05, 0.0000e+00, 7.5560e+05, 3.8404e+05, 7.6961e+05, 3.8400e+05,
         3.8400e+05, 3.8400e+05, 7.9990e+05, 3.8400e+05, 3.8401e+05, 7.8026e+05,
         3.8399e+05],
        [3.9579e+05, 7.5560e+05, 0.0000e+00, 3.9579e+05, 7.8878e+05, 3.9580e+05,
         3.9580e+05, 3.9581e+05, 7.8043e+05, 3.9580e+05, 3.9578e+05, 8.0371e+05,
         3.9583e+05],
        [1.8111e+00, 3.8404e+05, 3.9579e+05, 0.0000e+00, 3.8986e+05, 1.5815e+00,
         1.1989e+00, 1.0916e+00, 3.9951e+05, 1.0888e+00, 1.1332e+00, 4.0373e+05,
         1.2410e+00],
        [3.8985e+05, 7.6961e+05, 7.8878e+05, 3.8986e+05, 0.0000e+00, 3.8986e+05,
         3.8984e+05, 3.8984e+05, 8.1222e+05, 3.8986e+05, 3.8987e+05, 8.0510e+05,
         3.8988e+05],
        [1.3424e+00, 3.8400e+05, 3.9580e+05, 1.5815e+00, 3.8986e+05, 0.0000e+00,
         1.2729e+00, 1.2740e+00, 3.9950e+05, 1.3009e+00, 1.2975e+00, 4.0374e+05,
         1.2519e+00],
        [1.3953e+00, 3.8400e+05, 3.9580e+05, 1.1989e+00, 3.8984e+05, 1.2729e+00,
         0.0000e+00, 9.8595e-01, 3.9954e+05, 1.0772e+00, 1.0704e+00, 4.0372e+05,
         1.1421e+00],
        [1.3744e+00, 3.8400e+05, 3.9581e+05, 1.0916e+00, 3.8984e+05, 1.2740e+00,
         9.8595e-01, 0.0000e+00, 3.9955e+05, 9.7917e-01, 9.9548e-01, 4.0373e+05,
         1.0703e+00],
        [3.9952e+05, 7.9990e+05, 7.8043e+05, 3.9951e+05, 8.1222e+05, 3.9950e+05,
         3.9954e+05, 3.9955e+05, 0.0000e+00, 3.9951e+05, 3.9952e+05, 8.0781e+05,
         3.9953e+05],
        [1.4554e+00, 3.8400e+05, 3.9580e+05, 1.0888e+00, 3.8986e+05, 1.3009e+00,
         1.0772e+00, 9.7917e-01, 3.9951e+05, 0.0000e+00, 1.0393e+00, 4.0373e+05,
         1.0969e+00],
        [1.4516e+00, 3.8401e+05, 3.9578e+05, 1.1332e+00, 3.8987e+05, 1.2975e+00,
         1.0704e+00, 9.9548e-01, 3.9952e+05, 1.0393e+00, 0.0000e+00, 4.0371e+05,
         1.1319e+00],
        [4.0371e+05, 7.8026e+05, 8.0371e+05, 4.0373e+05, 8.0510e+05, 4.0374e+05,
         4.0372e+05, 4.0373e+05, 8.0781e+05, 4.0373e+05, 4.0371e+05, 0.0000e+00,
         4.0374e+05],
        [1.3321e+00, 3.8399e+05, 3.9583e+05, 1.2410e+00, 3.8988e+05, 1.2519e+00,
         1.1421e+00, 1.0703e+00, 3.9953e+05, 1.0969e+00, 1.1319e+00, 4.0374e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3321e+00, 1.3424e+00, 1.3744e+00, 1.3953e+00, 1.4516e+00,
        1.4554e+00, 1.8111e+00, 3.8398e+05, 3.8985e+05, 3.9579e+05, 3.9952e+05,
        4.0371e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 383978.6875, 383994.3125, 383997.2500, 383998.1875,
        384002.5312, 384003.4688, 384013.6562, 384041.8125, 755603.6250,
        769612.1875, 780261.5625, 799898.5625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 395785.0000, 395793.2812, 395794.1250, 395796.0312,
        395799.3438, 395800.3750, 395807.1875, 395830.3438, 755603.6250,
        780427.2500, 788782.5000, 803713.5625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.0888e+00, 1.0916e+00, 1.1332e+00, 1.1989e+00, 1.2410e+00,
        1.5815e+00, 1.8111e+00, 3.8404e+05, 3.8986e+05, 3.9579e+05, 3.9951e+05,
        4.0373e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 389836.5000, 389844.0000, 389852.0625, 389855.7500,
        389860.2812, 389863.3750, 389871.3125, 389884.3125, 769612.1875,
        788782.5000, 805100.2500, 812223.2500])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.2519e+00, 1.2729e+00, 1.2740e+00, 1.2975e+00, 1.3009e+00,
        1.3424e+00, 1.5815e+00, 3.8400e+05, 3.8986e+05, 3.9580e+05, 3.9950e+05,
        4.0374e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 9.8595e-01, 1.0704e+00, 1.0772e+00, 1.1421e+00, 1.1989e+00,
        1.2729e+00, 1.3953e+00, 3.8400e+05, 3.8984e+05, 3.9580e+05, 3.9954e+05,
        4.0372e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 9.7917e-01, 9.8595e-01, 9.9548e-01, 1.0703e+00, 1.0916e+00,
        1.2740e+00, 1.3744e+00, 3.8400e+05, 3.8984e+05, 3.9581e+05, 3.9955e+05,
        4.0373e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 399505.0000, 399509.7188, 399513.0938, 399518.8438,
        399522.9375, 399531.0625, 399543.1875, 399547.2812, 780427.2500,
        799898.5625, 807813.8125, 812223.2500])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 9.7917e-01, 1.0393e+00, 1.0772e+00, 1.0888e+00, 1.0969e+00,
        1.3009e+00, 1.4554e+00, 3.8400e+05, 3.8986e+05, 3.9580e+05, 3.9951e+05,
        4.0373e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 9.9548e-01, 1.0393e+00, 1.0704e+00, 1.1319e+00, 1.1332e+00,
        1.2975e+00, 1.4516e+00, 3.8401e+05, 3.8987e+05, 3.9578e+05, 3.9952e+05,
        4.0371e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 403710.8125, 403714.8750, 403715.5312, 403726.9375,
        403727.8438, 403732.1562, 403735.2500, 403738.0938, 780261.5625,
        803713.5625, 805100.2500, 807813.8125])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.0703e+00, 1.0969e+00, 1.1319e+00, 1.1421e+00, 1.2410e+00,
        1.2519e+00, 1.3321e+00, 3.8399e+05, 3.8988e+05, 3.9583e+05, 3.9953e+05,
        4.0374e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['47998.61', '384003.75', '395800.69', '48006.37', '389858.41', '48000.82', '48000.79', '48001.40', '399523.88', '48001.32', '48002.72', '403725.19', '48000.32']
estimated f for each client, fs: [5, 3, 3, 5, 3, 5, 5, 5, 3, 5, 5, 3, 5]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [7, 19, 17, 1, 20, 8, 4, 3, 13, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0083s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:02...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:02, End: 2025-07-22 15:29:02)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 17, 1, 9, 8, 15, 3, 13, 14, 11, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5143e+00, 1.4396e+00, 3.8732e+05, 4.0595e+05, 1.5631e+00,
         1.4532e+00, 1.5064e+00, 3.8860e+05, 1.3462e+00, 4.0724e+05, 3.8736e+05,
         1.4625e+00, 3.8683e+05, 1.4700e+00, 1.3362e+00],
        [1.5143e+00, 0.0000e+00, 1.4592e+00, 3.8731e+05, 4.0600e+05, 1.4066e+00,
         1.4911e+00, 1.5146e+00, 3.8863e+05, 1.3619e+00, 4.0723e+05, 3.8735e+05,
         1.3323e+00, 3.8681e+05, 1.3695e+00, 1.5078e+00],
        [1.4396e+00, 1.4592e+00, 0.0000e+00, 3.8735e+05, 4.0599e+05, 1.3874e+00,
         1.3644e+00, 1.3071e+00, 3.8860e+05, 1.3184e+00, 4.0725e+05, 3.8738e+05,
         1.3951e+00, 3.8685e+05, 1.3656e+00, 1.3422e+00],
        [3.8732e+05, 3.8731e+05, 3.8735e+05, 0.0000e+00, 7.8268e+05, 3.8735e+05,
         3.8734e+05, 3.8736e+05, 8.0359e+05, 3.8734e+05, 7.7714e+05, 7.6657e+05,
         3.8733e+05, 7.8218e+05, 3.8735e+05, 3.8737e+05],
        [4.0595e+05, 4.0600e+05, 4.0599e+05, 7.8268e+05, 0.0000e+00, 4.0598e+05,
         4.0598e+05, 4.0598e+05, 8.0347e+05, 4.0596e+05, 7.9355e+05, 7.8949e+05,
         4.0597e+05, 7.6510e+05, 4.0600e+05, 4.0599e+05],
        [1.5631e+00, 1.4066e+00, 1.3874e+00, 3.8735e+05, 4.0598e+05, 0.0000e+00,
         1.5431e+00, 1.4770e+00, 3.8860e+05, 1.1037e+00, 4.0725e+05, 3.8738e+05,
         1.0956e+00, 3.8681e+05, 1.1797e+00, 1.4462e+00],
        [1.4532e+00, 1.4911e+00, 1.3644e+00, 3.8734e+05, 4.0598e+05, 1.5431e+00,
         0.0000e+00, 1.3634e+00, 3.8859e+05, 1.4740e+00, 4.0725e+05, 3.8738e+05,
         1.4790e+00, 3.8683e+05, 1.4814e+00, 1.3843e+00],
        [1.5064e+00, 1.5146e+00, 1.3071e+00, 3.8736e+05, 4.0598e+05, 1.4770e+00,
         1.3634e+00, 0.0000e+00, 3.8858e+05, 1.4017e+00, 4.0724e+05, 3.8737e+05,
         1.4460e+00, 3.8680e+05, 1.3691e+00, 1.3570e+00],
        [3.8860e+05, 3.8863e+05, 3.8860e+05, 8.0359e+05, 8.0347e+05, 3.8860e+05,
         3.8859e+05, 3.8858e+05, 0.0000e+00, 3.8860e+05, 7.9970e+05, 7.6015e+05,
         3.8860e+05, 7.7689e+05, 3.8862e+05, 3.8856e+05],
        [1.3462e+00, 1.3619e+00, 1.3184e+00, 3.8734e+05, 4.0596e+05, 1.1037e+00,
         1.4740e+00, 1.4017e+00, 3.8860e+05, 0.0000e+00, 4.0721e+05, 3.8736e+05,
         1.1218e+00, 3.8683e+05, 1.2606e+00, 1.2606e+00],
        [4.0724e+05, 4.0723e+05, 4.0725e+05, 7.7714e+05, 7.9355e+05, 4.0725e+05,
         4.0725e+05, 4.0724e+05, 7.9970e+05, 4.0721e+05, 0.0000e+00, 7.9032e+05,
         4.0723e+05, 7.9689e+05, 4.0723e+05, 4.0723e+05],
        [3.8736e+05, 3.8735e+05, 3.8738e+05, 7.6657e+05, 7.8949e+05, 3.8738e+05,
         3.8738e+05, 3.8737e+05, 7.6015e+05, 3.8736e+05, 7.9032e+05, 0.0000e+00,
         3.8736e+05, 7.8639e+05, 3.8738e+05, 3.8737e+05],
        [1.4625e+00, 1.3323e+00, 1.3951e+00, 3.8733e+05, 4.0597e+05, 1.0956e+00,
         1.4790e+00, 1.4460e+00, 3.8860e+05, 1.1218e+00, 4.0723e+05, 3.8736e+05,
         0.0000e+00, 3.8683e+05, 1.2356e+00, 1.4074e+00],
        [3.8683e+05, 3.8681e+05, 3.8685e+05, 7.8218e+05, 7.6510e+05, 3.8681e+05,
         3.8683e+05, 3.8680e+05, 7.7689e+05, 3.8683e+05, 7.9689e+05, 7.8639e+05,
         3.8683e+05, 0.0000e+00, 3.8681e+05, 3.8684e+05],
        [1.4700e+00, 1.3695e+00, 1.3656e+00, 3.8735e+05, 4.0600e+05, 1.1797e+00,
         1.4814e+00, 1.3691e+00, 3.8862e+05, 1.2606e+00, 4.0723e+05, 3.8738e+05,
         1.2356e+00, 3.8681e+05, 0.0000e+00, 1.3685e+00],
        [1.3362e+00, 1.5078e+00, 1.3422e+00, 3.8737e+05, 4.0599e+05, 1.4462e+00,
         1.3843e+00, 1.3570e+00, 3.8856e+05, 1.2606e+00, 4.0723e+05, 3.8737e+05,
         1.4074e+00, 3.8684e+05, 1.3685e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3362e+00, 1.3462e+00, 1.4396e+00, 1.4532e+00, 1.4625e+00,
        1.4700e+00, 1.5064e+00, 1.5143e+00, 1.5631e+00, 3.8683e+05, 3.8732e+05,
        3.8736e+05, 3.8860e+05, 4.0595e+05, 4.0724e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3323e+00, 1.3619e+00, 1.3695e+00, 1.4066e+00, 1.4592e+00,
        1.4911e+00, 1.5078e+00, 1.5143e+00, 1.5146e+00, 3.8681e+05, 3.8731e+05,
        3.8735e+05, 3.8863e+05, 4.0600e+05, 4.0723e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3071e+00, 1.3184e+00, 1.3422e+00, 1.3644e+00, 1.3656e+00,
        1.3874e+00, 1.3951e+00, 1.4396e+00, 1.4592e+00, 3.8685e+05, 3.8735e+05,
        3.8738e+05, 3.8860e+05, 4.0599e+05, 4.0725e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387313.0625, 387322.5000, 387325.5625, 387343.8750,
        387343.9688, 387348.2500, 387352.5625, 387353.7812, 387356.5312,
        387367.1875, 766566.0000, 777139.4375, 782179.1875, 782684.2500,
        803589.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405945.1250, 405958.7188, 405974.9688, 405978.8125,
        405982.2500, 405984.7500, 405989.2500, 405993.4375, 405995.3125,
        406002.0000, 765102.3125, 782684.2500, 789487.8125, 793548.1250,
        803473.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0956e+00, 1.1037e+00, 1.1797e+00, 1.3874e+00, 1.4066e+00,
        1.4462e+00, 1.4770e+00, 1.5431e+00, 1.5631e+00, 3.8681e+05, 3.8735e+05,
        3.8738e+05, 3.8860e+05, 4.0598e+05, 4.0725e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3634e+00, 1.3644e+00, 1.3843e+00, 1.4532e+00, 1.4740e+00,
        1.4790e+00, 1.4814e+00, 1.4911e+00, 1.5431e+00, 3.8683e+05, 3.8734e+05,
        3.8738e+05, 3.8859e+05, 4.0598e+05, 4.0725e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3071e+00, 1.3570e+00, 1.3634e+00, 1.3691e+00, 1.4017e+00,
        1.4460e+00, 1.4770e+00, 1.5064e+00, 1.5146e+00, 3.8680e+05, 3.8736e+05,
        3.8737e+05, 3.8858e+05, 4.0598e+05, 4.0724e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388555.9688, 388575.3750, 388592.2188, 388595.2188,
        388598.3438, 388601.9375, 388603.7500, 388604.6250, 388617.0625,
        388634.6250, 760149.6250, 776885.7500, 799701.8750, 803473.5000,
        803589.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1037e+00, 1.1218e+00, 1.2606e+00, 1.2606e+00, 1.3184e+00,
        1.3462e+00, 1.3619e+00, 1.4017e+00, 1.4740e+00, 3.8683e+05, 3.8734e+05,
        3.8736e+05, 3.8860e+05, 4.0596e+05, 4.0721e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 407213.2812, 407227.9062, 407231.8125, 407232.5312,
        407234.5312, 407242.2500, 407242.8125, 407250.6875, 407250.8125,
        407254.7188, 777139.4375, 790319.9375, 793548.1250, 796893.7500,
        799701.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387352.4375, 387356.4375, 387360.2500, 387362.2812,
        387365.1875, 387365.4688, 387375.4688, 387375.5312, 387377.1250,
        387377.8438, 760149.6250, 766566.0000, 786385.6250, 789487.8125,
        790319.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0956e+00, 1.1218e+00, 1.2356e+00, 1.3323e+00, 1.3951e+00,
        1.4074e+00, 1.4460e+00, 1.4625e+00, 1.4790e+00, 3.8683e+05, 3.8733e+05,
        3.8736e+05, 3.8860e+05, 4.0597e+05, 4.0723e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386804.5625, 386806.6250, 386810.3438, 386814.6250,
        386827.3125, 386828.4375, 386831.7500, 386832.8125, 386838.5625,
        386852.0000, 765102.3125, 776885.7500, 782179.1875, 786385.6250,
        796893.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1797e+00, 1.2356e+00, 1.2606e+00, 1.3656e+00, 1.3685e+00,
        1.3691e+00, 1.3695e+00, 1.4700e+00, 1.4814e+00, 3.8681e+05, 3.8735e+05,
        3.8738e+05, 3.8862e+05, 4.0600e+05, 4.0723e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2606e+00, 1.3362e+00, 1.3422e+00, 1.3570e+00, 1.3685e+00,
        1.3843e+00, 1.4074e+00, 1.4462e+00, 1.5078e+00, 3.8684e+05, 3.8737e+05,
        3.8737e+05, 3.8856e+05, 4.0599e+05, 4.0723e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38684.48', '38682.33', '38686.44', '387342.69', '405980.47', '38682.68', '38684.15', '38681.73', '388597.91', '38684.45', '407238.12', '387366.81', '38683.93', '386824.69', '38681.88', '38685.09']
estimated f for each client, fs: [6, 6, 6, 4, 4, 6, 6, 6, 4, 6, 4, 4, 6, 4, 6, 6]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 8, 15, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0235s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:02...
global Accuracy on shared test data: 73.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:02, End: 2025-07-22 15:29:02)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.4249e+00, 3.9653e+05, 3.9605e+05, 1.4407e+00, 3.8449e+05,
         3.9307e+05, 1.7587e+00, 3.8521e+05, 1.5024e+00, 1.4079e+00, 3.8812e+05,
         3.9692e+05, 1.5610e+00, 1.5496e+00, 3.8672e+05, 1.5136e+00, 1.3209e+00],
        [1.4249e+00, 0.0000e+00, 3.9651e+05, 3.9604e+05, 1.3527e+00, 3.8445e+05,
         3.9307e+05, 1.5318e+00, 3.8525e+05, 1.3019e+00, 1.3016e+00, 3.8810e+05,
         3.9692e+05, 1.4379e+00, 1.3271e+00, 3.8672e+05, 1.4209e+00, 1.3255e+00],
        [3.9653e+05, 3.9651e+05, 0.0000e+00, 7.9218e+05, 3.9650e+05, 7.6409e+05,
         7.9208e+05, 3.9655e+05, 7.8929e+05, 3.9650e+05, 3.9654e+05, 7.9885e+05,
         7.8345e+05, 3.9653e+05, 3.9652e+05, 7.8155e+05, 3.9653e+05, 3.9651e+05],
        [3.9605e+05, 3.9604e+05, 7.9218e+05, 0.0000e+00, 3.9605e+05, 7.7863e+05,
         7.9353e+05, 3.9602e+05, 7.7803e+05, 3.9602e+05, 3.9600e+05, 7.5726e+05,
         8.2022e+05, 3.9603e+05, 3.9604e+05, 7.9247e+05, 3.9604e+05, 3.9601e+05],
        [1.4407e+00, 1.3527e+00, 3.9650e+05, 3.9605e+05, 0.0000e+00, 3.8449e+05,
         3.9305e+05, 1.6588e+00, 3.8524e+05, 1.4713e+00, 1.4303e+00, 3.8811e+05,
         3.9694e+05, 1.4661e+00, 1.3980e+00, 3.8672e+05, 1.5014e+00, 1.3461e+00],
        [3.8449e+05, 3.8445e+05, 7.6409e+05, 7.7863e+05, 3.8449e+05, 0.0000e+00,
         7.9378e+05, 3.8452e+05, 7.6949e+05, 3.8445e+05, 3.8448e+05, 7.6693e+05,
         7.8766e+05, 3.8449e+05, 3.8445e+05, 7.6050e+05, 3.8448e+05, 3.8449e+05],
        [3.9307e+05, 3.9307e+05, 7.9208e+05, 7.9353e+05, 3.9305e+05, 7.9378e+05,
         0.0000e+00, 3.9307e+05, 7.5731e+05, 3.9310e+05, 3.9305e+05, 7.8987e+05,
         7.8715e+05, 3.9307e+05, 3.9306e+05, 7.7301e+05, 3.9307e+05, 3.9307e+05],
        [1.7587e+00, 1.5318e+00, 3.9655e+05, 3.9602e+05, 1.6588e+00, 3.8452e+05,
         3.9307e+05, 0.0000e+00, 3.8522e+05, 1.3667e+00, 1.3747e+00, 3.8810e+05,
         3.9684e+05, 1.3317e+00, 1.3745e+00, 3.8671e+05, 1.4636e+00, 1.5616e+00],
        [3.8521e+05, 3.8525e+05, 7.8929e+05, 7.7803e+05, 3.8524e+05, 7.6949e+05,
         7.5731e+05, 3.8522e+05, 0.0000e+00, 3.8528e+05, 3.8524e+05, 7.7104e+05,
         7.7079e+05, 3.8525e+05, 3.8524e+05, 7.7197e+05, 3.8526e+05, 3.8527e+05],
        [1.5024e+00, 1.3019e+00, 3.9650e+05, 3.9602e+05, 1.4713e+00, 3.8445e+05,
         3.9310e+05, 1.3667e+00, 3.8528e+05, 0.0000e+00, 1.1781e+00, 3.8810e+05,
         3.9688e+05, 1.2240e+00, 1.2470e+00, 3.8671e+05, 1.3242e+00, 1.3742e+00],
        [1.4079e+00, 1.3016e+00, 3.9654e+05, 3.9600e+05, 1.4303e+00, 3.8448e+05,
         3.9305e+05, 1.3747e+00, 3.8524e+05, 1.1781e+00, 0.0000e+00, 3.8811e+05,
         3.9691e+05, 1.1772e+00, 1.1873e+00, 3.8674e+05, 1.3328e+00, 1.2602e+00],
        [3.8812e+05, 3.8810e+05, 7.9885e+05, 7.5726e+05, 3.8811e+05, 7.6693e+05,
         7.8987e+05, 3.8810e+05, 7.7104e+05, 3.8810e+05, 3.8811e+05, 0.0000e+00,
         7.8658e+05, 3.8809e+05, 3.8811e+05, 7.8133e+05, 3.8808e+05, 3.8810e+05],
        [3.9692e+05, 3.9692e+05, 7.8345e+05, 8.2022e+05, 3.9694e+05, 7.8766e+05,
         7.8715e+05, 3.9684e+05, 7.7079e+05, 3.9688e+05, 3.9691e+05, 7.8658e+05,
         0.0000e+00, 3.9690e+05, 3.9688e+05, 7.7354e+05, 3.9688e+05, 3.9692e+05],
        [1.5610e+00, 1.4379e+00, 3.9653e+05, 3.9603e+05, 1.4661e+00, 3.8449e+05,
         3.9307e+05, 1.3317e+00, 3.8525e+05, 1.2240e+00, 1.1772e+00, 3.8809e+05,
         3.9690e+05, 0.0000e+00, 1.2188e+00, 3.8673e+05, 1.3413e+00, 1.4274e+00],
        [1.5496e+00, 1.3271e+00, 3.9652e+05, 3.9604e+05, 1.3980e+00, 3.8445e+05,
         3.9306e+05, 1.3745e+00, 3.8524e+05, 1.2470e+00, 1.1873e+00, 3.8811e+05,
         3.9688e+05, 1.2188e+00, 0.0000e+00, 3.8672e+05, 1.3201e+00, 1.3645e+00],
        [3.8672e+05, 3.8672e+05, 7.8155e+05, 7.9247e+05, 3.8672e+05, 7.6050e+05,
         7.7301e+05, 3.8671e+05, 7.7197e+05, 3.8671e+05, 3.8674e+05, 7.8133e+05,
         7.7354e+05, 3.8673e+05, 3.8672e+05, 0.0000e+00, 3.8671e+05, 3.8669e+05],
        [1.5136e+00, 1.4209e+00, 3.9653e+05, 3.9604e+05, 1.5014e+00, 3.8448e+05,
         3.9307e+05, 1.4636e+00, 3.8526e+05, 1.3242e+00, 1.3328e+00, 3.8808e+05,
         3.9688e+05, 1.3413e+00, 1.3201e+00, 3.8671e+05, 0.0000e+00, 1.4309e+00],
        [1.3209e+00, 1.3255e+00, 3.9651e+05, 3.9601e+05, 1.3461e+00, 3.8449e+05,
         3.9307e+05, 1.5616e+00, 3.8527e+05, 1.3742e+00, 1.2602e+00, 3.8810e+05,
         3.9692e+05, 1.4274e+00, 1.3645e+00, 3.8669e+05, 1.4309e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3209e+00, 1.4079e+00, 1.4249e+00, 1.4407e+00, 1.5024e+00,
        1.5136e+00, 1.5496e+00, 1.5610e+00, 1.7587e+00, 3.8449e+05, 3.8521e+05,
        3.8672e+05, 3.8812e+05, 3.9307e+05, 3.9605e+05, 3.9653e+05, 3.9692e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3016e+00, 1.3019e+00, 1.3255e+00, 1.3271e+00, 1.3527e+00,
        1.4209e+00, 1.4249e+00, 1.4379e+00, 1.5318e+00, 3.8445e+05, 3.8525e+05,
        3.8672e+05, 3.8810e+05, 3.9307e+05, 3.9604e+05, 3.9651e+05, 3.9692e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396496.4688, 396500.2812, 396509.3125, 396511.4375,
        396518.8750, 396525.4688, 396530.9688, 396532.9688, 396544.4688,
        396547.4375, 764086.0625, 781546.6250, 783451.7500, 789286.3125,
        792078.1250, 792184.0000, 798847.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396002.0625, 396013.8125, 396019.4062, 396020.9375,
        396027.5312, 396035.0000, 396039.5625, 396042.0000, 396046.4062,
        396048.7812, 757258.7500, 778032.6250, 778631.0625, 792184.0000,
        792471.9375, 793532.2500, 820216.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3461e+00, 1.3527e+00, 1.3980e+00, 1.4303e+00, 1.4407e+00,
        1.4661e+00, 1.4713e+00, 1.5014e+00, 1.6588e+00, 3.8449e+05, 3.8524e+05,
        3.8672e+05, 3.8811e+05, 3.9305e+05, 3.9605e+05, 3.9650e+05, 3.9694e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384452.1562, 384453.2500, 384453.8125, 384475.1875,
        384477.0312, 384486.1875, 384487.6250, 384488.3750, 384492.8438,
        384520.8750, 760504.0625, 764086.0625, 766931.3125, 769489.6250,
        778631.0625, 787662.4375, 793776.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393051.1875, 393054.3750, 393062.5312, 393066.7188,
        393072.1250, 393072.3750, 393073.0938, 393074.3750, 393074.7812,
        393104.8438, 757313.1250, 773010.9375, 787147.5625, 789867.6250,
        792078.1250, 793532.2500, 793776.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3317e+00, 1.3667e+00, 1.3745e+00, 1.3747e+00, 1.4636e+00,
        1.5318e+00, 1.5616e+00, 1.6588e+00, 1.7587e+00, 3.8452e+05, 3.8522e+05,
        3.8671e+05, 3.8810e+05, 3.9307e+05, 3.9602e+05, 3.9655e+05, 3.9684e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385214.1875, 385221.3750, 385237.6562, 385239.9062,
        385241.1875, 385247.0625, 385253.5312, 385258.7500, 385266.9062,
        385276.3750, 757313.1250, 769489.6250, 770789.3125, 771035.6875,
        771972.3125, 778032.6250, 789286.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1781e+00, 1.2240e+00, 1.2470e+00, 1.3019e+00, 1.3242e+00,
        1.3667e+00, 1.3742e+00, 1.4713e+00, 1.5024e+00, 3.8445e+05, 3.8528e+05,
        3.8671e+05, 3.8810e+05, 3.9310e+05, 3.9602e+05, 3.9650e+05, 3.9688e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1772e+00, 1.1781e+00, 1.1873e+00, 1.2602e+00, 1.3016e+00,
        1.3328e+00, 1.3747e+00, 1.4079e+00, 1.4303e+00, 3.8448e+05, 3.8524e+05,
        3.8674e+05, 3.8811e+05, 3.9305e+05, 3.9600e+05, 3.9654e+05, 3.9691e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388081.8125, 388089.8125, 388096.0000, 388096.2500,
        388097.3750, 388099.4688, 388108.1875, 388109.7500, 388113.5938,
        388119.4688, 757258.7500, 766931.3125, 771035.6875, 781325.5625,
        786579.6875, 789867.6250, 798847.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396845.0000, 396881.1875, 396881.9062, 396884.3750,
        396902.2812, 396910.4688, 396915.0625, 396916.8750, 396923.4062,
        396943.1562, 770789.3125, 773535.7500, 783451.7500, 786579.6875,
        787147.5625, 787662.4375, 820216.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1772e+00, 1.2188e+00, 1.2240e+00, 1.3317e+00, 1.3413e+00,
        1.4274e+00, 1.4379e+00, 1.4661e+00, 1.5610e+00, 3.8449e+05, 3.8525e+05,
        3.8673e+05, 3.8809e+05, 3.9307e+05, 3.9603e+05, 3.9653e+05, 3.9690e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1873e+00, 1.2188e+00, 1.2470e+00, 1.3201e+00, 1.3271e+00,
        1.3645e+00, 1.3745e+00, 1.3980e+00, 1.5496e+00, 3.8445e+05, 3.8524e+05,
        3.8672e+05, 3.8811e+05, 3.9306e+05, 3.9604e+05, 3.9652e+05, 3.9688e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386694.0625, 386706.0000, 386713.0000, 386714.2500,
        386715.6250, 386715.8438, 386719.8750, 386720.0938, 386731.0000,
        386739.5938, 760504.0625, 771972.3125, 773010.9375, 773535.7500,
        781325.5625, 781546.6250, 792471.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3201e+00, 1.3242e+00, 1.3328e+00, 1.3413e+00, 1.4209e+00,
        1.4309e+00, 1.4636e+00, 1.5014e+00, 1.5136e+00, 3.8448e+05, 3.8526e+05,
        3.8671e+05, 3.8808e+05, 3.9307e+05, 3.9604e+05, 3.9653e+05, 3.9688e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2602e+00, 1.3209e+00, 1.3255e+00, 1.3461e+00, 1.3645e+00,
        1.3742e+00, 1.4274e+00, 1.4309e+00, 1.5616e+00, 3.8449e+05, 3.8527e+05,
        3.8669e+05, 3.8810e+05, 3.9307e+05, 3.9601e+05, 3.9651e+05, 3.9692e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['69974.59', '69974.38', '429936.66', '428868.53', '69976.07', '418662.81', '426183.59', '69977.79', '419069.97', '69976.56', '69975.45', '421660.94', '430890.19', '69976.98', '69973.19', '420697.56', '69976.95', '69978.87']
estimated f for each client, fs: [8, 8, 6, 6, 8, 6, 6, 8, 6, 8, 8, 6, 6, 8, 8, 6, 8, 8]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0160s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:03...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[167  70]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:29:03, End: 2025-07-22 15:29:03)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 3, 11, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.2215e+00, 3.8760e+05, 3.9618e+05, 1.3031e+00, 1.2454e+00,
         3.9595e+05, 4.0557e+05, 1.2310e+00, 3.9491e+05, 1.2159e+00, 1.2605e+00,
         3.9620e+05, 1.1936e+00, 1.1713e+00],
        [1.2215e+00, 0.0000e+00, 3.8761e+05, 3.9622e+05, 1.1489e+00, 1.1563e+00,
         3.9602e+05, 4.0558e+05, 1.0956e+00, 3.9492e+05, 1.1335e+00, 1.1840e+00,
         3.9618e+05, 1.0848e+00, 1.1045e+00],
        [3.8760e+05, 3.8761e+05, 0.0000e+00, 7.8215e+05, 3.8762e+05, 3.8764e+05,
         7.8974e+05, 7.9147e+05, 3.8764e+05, 7.7660e+05, 3.8762e+05, 3.8761e+05,
         7.9448e+05, 3.8764e+05, 3.8759e+05],
        [3.9618e+05, 3.9622e+05, 7.8215e+05, 0.0000e+00, 3.9622e+05, 3.9619e+05,
         7.9796e+05, 7.8695e+05, 3.9619e+05, 7.9866e+05, 3.9621e+05, 3.9618e+05,
         7.8020e+05, 3.9622e+05, 3.9621e+05],
        [1.3031e+00, 1.1489e+00, 3.8762e+05, 3.9622e+05, 0.0000e+00, 1.2733e+00,
         3.9600e+05, 4.0557e+05, 9.6211e-01, 3.9491e+05, 9.7285e-01, 9.3838e-01,
         3.9618e+05, 9.8303e-01, 1.1695e+00],
        [1.2454e+00, 1.1563e+00, 3.8764e+05, 3.9619e+05, 1.2733e+00, 0.0000e+00,
         3.9600e+05, 4.0559e+05, 1.1937e+00, 3.9487e+05, 1.2741e+00, 1.2559e+00,
         3.9620e+05, 1.2174e+00, 1.2202e+00],
        [3.9595e+05, 3.9602e+05, 7.8974e+05, 7.9796e+05, 3.9600e+05, 3.9600e+05,
         0.0000e+00, 8.0364e+05, 3.9601e+05, 7.9211e+05, 3.9600e+05, 3.9601e+05,
         8.0254e+05, 3.9598e+05, 3.9598e+05],
        [4.0557e+05, 4.0558e+05, 7.9147e+05, 7.8695e+05, 4.0557e+05, 4.0559e+05,
         8.0364e+05, 0.0000e+00, 4.0556e+05, 8.1182e+05, 4.0556e+05, 4.0556e+05,
         7.9740e+05, 4.0558e+05, 4.0556e+05],
        [1.2310e+00, 1.0956e+00, 3.8764e+05, 3.9619e+05, 9.6211e-01, 1.1937e+00,
         3.9601e+05, 4.0556e+05, 0.0000e+00, 3.9488e+05, 1.0036e+00, 9.8876e-01,
         3.9618e+05, 9.9333e-01, 1.1018e+00],
        [3.9491e+05, 3.9492e+05, 7.7660e+05, 7.9866e+05, 3.9491e+05, 3.9487e+05,
         7.9211e+05, 8.1182e+05, 3.9488e+05, 0.0000e+00, 3.9490e+05, 3.9491e+05,
         7.8856e+05, 3.9491e+05, 3.9490e+05],
        [1.2159e+00, 1.1335e+00, 3.8762e+05, 3.9621e+05, 9.7285e-01, 1.2741e+00,
         3.9600e+05, 4.0556e+05, 1.0036e+00, 3.9490e+05, 0.0000e+00, 1.0394e+00,
         3.9616e+05, 1.0866e+00, 1.0652e+00],
        [1.2605e+00, 1.1840e+00, 3.8761e+05, 3.9618e+05, 9.3838e-01, 1.2559e+00,
         3.9601e+05, 4.0556e+05, 9.8876e-01, 3.9491e+05, 1.0394e+00, 0.0000e+00,
         3.9622e+05, 1.0568e+00, 1.1753e+00],
        [3.9620e+05, 3.9618e+05, 7.9448e+05, 7.8020e+05, 3.9618e+05, 3.9620e+05,
         8.0254e+05, 7.9740e+05, 3.9618e+05, 7.8856e+05, 3.9616e+05, 3.9622e+05,
         0.0000e+00, 3.9618e+05, 3.9618e+05],
        [1.1936e+00, 1.0848e+00, 3.8764e+05, 3.9622e+05, 9.8303e-01, 1.2174e+00,
         3.9598e+05, 4.0558e+05, 9.9333e-01, 3.9491e+05, 1.0866e+00, 1.0568e+00,
         3.9618e+05, 0.0000e+00, 1.0784e+00],
        [1.1713e+00, 1.1045e+00, 3.8759e+05, 3.9621e+05, 1.1695e+00, 1.2202e+00,
         3.9598e+05, 4.0556e+05, 1.1018e+00, 3.9490e+05, 1.0652e+00, 1.1753e+00,
         3.9618e+05, 1.0784e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1713e+00, 1.1936e+00, 1.2159e+00, 1.2215e+00, 1.2310e+00,
        1.2454e+00, 1.2605e+00, 1.3031e+00, 3.8760e+05, 3.9491e+05, 3.9595e+05,
        3.9618e+05, 3.9620e+05, 4.0557e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0848e+00, 1.0956e+00, 1.1045e+00, 1.1335e+00, 1.1489e+00,
        1.1563e+00, 1.1840e+00, 1.2215e+00, 3.8761e+05, 3.9492e+05, 3.9602e+05,
        3.9618e+05, 3.9622e+05, 4.0558e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387586.2500, 387600.0312, 387606.7812, 387613.1875,
        387617.4688, 387624.7500, 387637.1875, 387638.0000, 387641.0625,
        776603.9375, 782152.0000, 789742.6250, 791472.1875, 794476.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396180.3750, 396184.0625, 396190.5625, 396191.8125,
        396207.7188, 396207.9688, 396217.6250, 396218.0625, 396219.6250,
        780197.8750, 782152.0000, 786946.9375, 797955.5000, 798657.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.3838e-01, 9.6211e-01, 9.7285e-01, 9.8303e-01, 1.1489e+00,
        1.1695e+00, 1.2733e+00, 1.3031e+00, 3.8762e+05, 3.9491e+05, 3.9600e+05,
        3.9618e+05, 3.9622e+05, 4.0557e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1563e+00, 1.1937e+00, 1.2174e+00, 1.2202e+00, 1.2454e+00,
        1.2559e+00, 1.2733e+00, 1.2741e+00, 3.8764e+05, 3.9487e+05, 3.9600e+05,
        3.9619e+05, 3.9620e+05, 4.0559e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 395949.2500, 395979.1562, 395984.3750, 395998.2500,
        395999.1250, 395999.8125, 396006.1875, 396012.5312, 396021.0312,
        789742.6250, 792110.5000, 797955.5000, 802543.8125, 803635.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 405555.2500, 405556.5000, 405558.8125, 405559.9688,
        405573.8125, 405574.4375, 405577.0000, 405583.2812, 405587.6562,
        786946.9375, 791472.1875, 797398.7500, 803635.0625, 811821.9375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.6211e-01, 9.8876e-01, 9.9333e-01, 1.0036e+00, 1.0956e+00,
        1.1018e+00, 1.1937e+00, 1.2310e+00, 3.8764e+05, 3.9488e+05, 3.9601e+05,
        3.9618e+05, 3.9619e+05, 4.0556e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394869.1562, 394881.0625, 394900.9062, 394903.4375,
        394906.6250, 394908.7812, 394911.2500, 394911.3750, 394924.0312,
        776603.9375, 788562.1875, 792110.5000, 798657.1875, 811821.9375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.7285e-01, 1.0036e+00, 1.0394e+00, 1.0652e+00, 1.0866e+00,
        1.1335e+00, 1.2159e+00, 1.2741e+00, 3.8762e+05, 3.9490e+05, 3.9600e+05,
        3.9616e+05, 3.9621e+05, 4.0556e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.3838e-01, 9.8876e-01, 1.0394e+00, 1.0568e+00, 1.1753e+00,
        1.1840e+00, 1.2559e+00, 1.2605e+00, 3.8761e+05, 3.9491e+05, 3.9601e+05,
        3.9618e+05, 3.9622e+05, 4.0556e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396164.0625, 396175.1250, 396178.1562, 396179.7812,
        396180.9688, 396183.5625, 396195.1875, 396197.3125, 396218.0000,
        780197.8750, 788562.1875, 794476.1875, 797398.7500, 802543.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.8303e-01, 9.9333e-01, 1.0568e+00, 1.0784e+00, 1.0848e+00,
        1.0866e+00, 1.1936e+00, 1.2174e+00, 3.8764e+05, 3.9491e+05, 3.9598e+05,
        3.9618e+05, 3.9622e+05, 4.0558e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0652e+00, 1.0784e+00, 1.1018e+00, 1.1045e+00, 1.1695e+00,
        1.1713e+00, 1.1753e+00, 1.2202e+00, 3.8759e+05, 3.9490e+05, 3.9598e+05,
        3.9618e+05, 3.9621e+05, 4.0556e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['43067.77', '43068.43', '387618.31', '396201.97', '43069.58', '43072.32', '395994.41', '405569.66', '43071.75', '394901.84', '43070.39', '43069.12', '396185.78', '43071.86', '43066.15']
estimated f for each client, fs: [6, 6, 5, 4, 6, 6, 4, 4, 6, 4, 6, 6, 4, 6, 6]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 3, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0303s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:03...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:03, End: 2025-07-22 15:29:03)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 17, 1, 9, 18, 4, 3, 13, 14, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.2181e+00, 1.2748e+00, 3.9440e+05, 3.9084e+05, 1.4195e+00,
         1.3016e+00, 3.9892e+05, 1.3949e+00, 1.2705e+00, 3.8511e+05, 3.9216e+05,
         3.9034e+05, 1.3268e+00, 1.4218e+00],
        [1.2181e+00, 0.0000e+00, 1.1906e+00, 3.9443e+05, 3.9083e+05, 1.2423e+00,
         1.1604e+00, 3.9892e+05, 1.2100e+00, 1.1877e+00, 3.8511e+05, 3.9217e+05,
         3.9031e+05, 1.1829e+00, 1.3428e+00],
        [1.2748e+00, 1.1906e+00, 0.0000e+00, 3.9442e+05, 3.9082e+05, 1.2053e+00,
         1.1505e+00, 3.9896e+05, 1.1767e+00, 1.1671e+00, 3.8512e+05, 3.9219e+05,
         3.9031e+05, 1.1724e+00, 1.3065e+00],
        [3.9440e+05, 3.9443e+05, 3.9442e+05, 0.0000e+00, 7.8067e+05, 3.9442e+05,
         3.9442e+05, 7.7836e+05, 3.9443e+05, 3.9443e+05, 7.6568e+05, 7.9812e+05,
         7.8439e+05, 3.9443e+05, 3.9442e+05],
        [3.9084e+05, 3.9083e+05, 3.9082e+05, 7.8067e+05, 0.0000e+00, 3.9082e+05,
         3.9084e+05, 7.9626e+05, 3.9082e+05, 3.9082e+05, 7.8728e+05, 7.9263e+05,
         7.8907e+05, 3.9084e+05, 3.9084e+05],
        [1.4195e+00, 1.2423e+00, 1.2053e+00, 3.9442e+05, 3.9082e+05, 0.0000e+00,
         1.3045e+00, 3.9893e+05, 1.0884e+00, 1.0324e+00, 3.8511e+05, 3.9216e+05,
         3.9031e+05, 1.0847e+00, 1.0643e+00],
        [1.3016e+00, 1.1604e+00, 1.1505e+00, 3.9442e+05, 3.9084e+05, 1.3045e+00,
         0.0000e+00, 3.9894e+05, 1.3265e+00, 1.2589e+00, 3.8508e+05, 3.9217e+05,
         3.9032e+05, 1.2429e+00, 1.4524e+00],
        [3.9892e+05, 3.9892e+05, 3.9896e+05, 7.7836e+05, 7.9626e+05, 3.9893e+05,
         3.9894e+05, 0.0000e+00, 3.9893e+05, 3.9894e+05, 7.9488e+05, 7.9763e+05,
         7.9356e+05, 3.9894e+05, 3.9891e+05],
        [1.3949e+00, 1.2100e+00, 1.1767e+00, 3.9443e+05, 3.9082e+05, 1.0884e+00,
         1.3265e+00, 3.9893e+05, 0.0000e+00, 1.1267e+00, 3.8511e+05, 3.9217e+05,
         3.9034e+05, 1.1927e+00, 1.2315e+00],
        [1.2705e+00, 1.1877e+00, 1.1671e+00, 3.9443e+05, 3.9082e+05, 1.0324e+00,
         1.2589e+00, 3.9894e+05, 1.1267e+00, 0.0000e+00, 3.8512e+05, 3.9215e+05,
         3.9036e+05, 1.1635e+00, 1.0714e+00],
        [3.8511e+05, 3.8511e+05, 3.8512e+05, 7.6568e+05, 7.8728e+05, 3.8511e+05,
         3.8508e+05, 7.9488e+05, 3.8511e+05, 3.8512e+05, 0.0000e+00, 7.8810e+05,
         7.7508e+05, 3.8512e+05, 3.8511e+05],
        [3.9216e+05, 3.9217e+05, 3.9219e+05, 7.9812e+05, 7.9263e+05, 3.9216e+05,
         3.9217e+05, 7.9763e+05, 3.9217e+05, 3.9215e+05, 7.8810e+05, 0.0000e+00,
         7.8095e+05, 3.9215e+05, 3.9215e+05],
        [3.9034e+05, 3.9031e+05, 3.9031e+05, 7.8439e+05, 7.8907e+05, 3.9031e+05,
         3.9032e+05, 7.9356e+05, 3.9034e+05, 3.9036e+05, 7.7508e+05, 7.8095e+05,
         0.0000e+00, 3.9035e+05, 3.9032e+05],
        [1.3268e+00, 1.1829e+00, 1.1724e+00, 3.9443e+05, 3.9084e+05, 1.0847e+00,
         1.2429e+00, 3.9894e+05, 1.1927e+00, 1.1635e+00, 3.8512e+05, 3.9215e+05,
         3.9035e+05, 0.0000e+00, 1.2058e+00],
        [1.4218e+00, 1.3428e+00, 1.3065e+00, 3.9442e+05, 3.9084e+05, 1.0643e+00,
         1.4524e+00, 3.9891e+05, 1.2315e+00, 1.0714e+00, 3.8511e+05, 3.9215e+05,
         3.9032e+05, 1.2058e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2181e+00, 1.2705e+00, 1.2748e+00, 1.3016e+00, 1.3268e+00,
        1.3949e+00, 1.4195e+00, 1.4218e+00, 3.8511e+05, 3.9034e+05, 3.9084e+05,
        3.9216e+05, 3.9440e+05, 3.9892e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1604e+00, 1.1829e+00, 1.1877e+00, 1.1906e+00, 1.2100e+00,
        1.2181e+00, 1.2423e+00, 1.3428e+00, 3.8511e+05, 3.9031e+05, 3.9083e+05,
        3.9217e+05, 3.9443e+05, 3.9892e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1505e+00, 1.1671e+00, 1.1724e+00, 1.1767e+00, 1.1906e+00,
        1.2053e+00, 1.2748e+00, 1.3065e+00, 3.8512e+05, 3.9031e+05, 3.9082e+05,
        3.9219e+05, 3.9442e+05, 3.9896e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394404.5312, 394416.5000, 394418.9688, 394419.7812,
        394422.6250, 394428.2500, 394431.5000, 394434.6875, 394434.9375,
        765684.1250, 778357.7500, 780672.6250, 784387.1875, 798116.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390818.9688, 390819.5625, 390820.6562, 390820.8750,
        390833.7188, 390838.0000, 390839.6250, 390839.8125, 390842.1250,
        780672.6250, 787277.3750, 789074.3750, 792631.8125, 796257.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0324e+00, 1.0643e+00, 1.0847e+00, 1.0884e+00, 1.2053e+00,
        1.2423e+00, 1.3045e+00, 1.4195e+00, 3.8511e+05, 3.9031e+05, 3.9082e+05,
        3.9216e+05, 3.9442e+05, 3.9893e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1505e+00, 1.1604e+00, 1.2429e+00, 1.2589e+00, 1.3016e+00,
        1.3045e+00, 1.3265e+00, 1.4524e+00, 3.8508e+05, 3.9032e+05, 3.9084e+05,
        3.9217e+05, 3.9442e+05, 3.9894e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 398914.4688, 398916.6250, 398920.5000, 398925.2188,
        398927.2500, 398936.1250, 398936.5312, 398941.1250, 398956.4688,
        778357.7500, 793564.5625, 794883.7500, 796257.1875, 797631.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0884e+00, 1.1267e+00, 1.1767e+00, 1.1927e+00, 1.2100e+00,
        1.2315e+00, 1.3265e+00, 1.3949e+00, 3.8511e+05, 3.9034e+05, 3.9082e+05,
        3.9217e+05, 3.9443e+05, 3.9893e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0324e+00, 1.0714e+00, 1.1267e+00, 1.1635e+00, 1.1671e+00,
        1.1877e+00, 1.2589e+00, 1.2705e+00, 3.8512e+05, 3.9036e+05, 3.9082e+05,
        3.9215e+05, 3.9443e+05, 3.9894e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 385082.5312, 385106.6562, 385106.6875, 385107.2500,
        385110.5000, 385114.6562, 385117.8125, 385121.2188, 385122.0312,
        765684.1250, 775075.7500, 787277.3750, 788096.2500, 794883.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 392147.3125, 392151.6250, 392153.1250, 392156.7500,
        392161.2500, 392171.3125, 392172.1250, 392174.0000, 392188.6875,
        780949.9375, 788096.2500, 792631.8125, 797631.5000, 798116.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390308.5312, 390309.1250, 390310.2188, 390324.2812,
        390324.7188, 390335.6250, 390337.3750, 390348.5938, 390360.0938,
        775075.7500, 780949.9375, 784387.1875, 789074.3750, 793564.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0847e+00, 1.1635e+00, 1.1724e+00, 1.1829e+00, 1.1927e+00,
        1.2058e+00, 1.2429e+00, 1.3268e+00, 3.8512e+05, 3.9035e+05, 3.9084e+05,
        3.9215e+05, 3.9443e+05, 3.9894e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0643e+00, 1.0714e+00, 1.2058e+00, 1.2315e+00, 1.3065e+00,
        1.3428e+00, 1.4218e+00, 1.4524e+00, 3.8511e+05, 3.9032e+05, 3.9084e+05,
        3.9215e+05, 3.9442e+05, 3.9891e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['42790.81', '42790.78', '42791.94', '394423.53', '390830.38', '42791.56', '42788.08', '398930.50', '42790.71', '42792.37', '385109.94', '392164.03', '390328.72', '42792.31', '42791.18']
estimated f for each client, fs: [6, 6, 6, 4, 4, 6, 6, 4, 6, 6, 4, 4, 4, 6, 6]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 18, 4, 3, 13, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0158s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:04...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:04, End: 2025-07-22 15:29:04)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 9, 20, 18, 8, 15, 4, 3, 13, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2904e+00, 1.3580e+00, 3.9402e+05, 1.5985e+00, 3.8517e+05,
         3.9348e+05, 1.4808e+00, 3.7423e+05, 1.4235e+00, 1.3405e+00, 3.9427e+05,
         1.7213e+00, 3.9030e+05, 1.3918e+00, 1.3255e+00],
        [1.2904e+00, 0.0000e+00, 1.3099e+00, 3.9401e+05, 1.5219e+00, 3.8519e+05,
         3.9348e+05, 1.3394e+00, 3.7427e+05, 1.2939e+00, 1.3255e+00, 3.9426e+05,
         1.5198e+00, 3.9029e+05, 1.3013e+00, 1.3239e+00],
        [1.3580e+00, 1.3099e+00, 0.0000e+00, 3.9402e+05, 1.4788e+00, 3.8517e+05,
         3.9349e+05, 1.3098e+00, 3.7422e+05, 1.2342e+00, 1.2740e+00, 3.9426e+05,
         1.5209e+00, 3.9033e+05, 1.3250e+00, 1.2242e+00],
        [3.9402e+05, 3.9401e+05, 3.9402e+05, 0.0000e+00, 3.9404e+05, 7.7841e+05,
         7.8151e+05, 3.9402e+05, 7.8882e+05, 3.9403e+05, 3.9402e+05, 7.8571e+05,
         3.9402e+05, 7.6474e+05, 3.9407e+05, 3.9401e+05],
        [1.5985e+00, 1.5219e+00, 1.4788e+00, 3.9404e+05, 0.0000e+00, 3.8515e+05,
         3.9346e+05, 1.4591e+00, 3.7424e+05, 1.4252e+00, 1.4045e+00, 3.9430e+05,
         1.2969e+00, 3.9030e+05, 1.4655e+00, 1.3669e+00],
        [3.8517e+05, 3.8519e+05, 3.8517e+05, 7.7841e+05, 3.8515e+05, 0.0000e+00,
         7.6938e+05, 3.8518e+05, 7.6982e+05, 3.8517e+05, 3.8519e+05, 7.7520e+05,
         3.8518e+05, 7.7494e+05, 3.8518e+05, 3.8518e+05],
        [3.9348e+05, 3.9348e+05, 3.9349e+05, 7.8151e+05, 3.9346e+05, 7.6938e+05,
         0.0000e+00, 3.9351e+05, 7.5342e+05, 3.9350e+05, 3.9345e+05, 7.7838e+05,
         3.9345e+05, 7.8629e+05, 3.9347e+05, 3.9349e+05],
        [1.4808e+00, 1.3394e+00, 1.3098e+00, 3.9402e+05, 1.4591e+00, 3.8518e+05,
         3.9351e+05, 0.0000e+00, 3.7426e+05, 1.2524e+00, 1.2617e+00, 3.9430e+05,
         1.3789e+00, 3.9029e+05, 1.2866e+00, 1.2472e+00],
        [3.7423e+05, 3.7427e+05, 3.7422e+05, 7.8882e+05, 3.7424e+05, 7.6982e+05,
         7.5342e+05, 3.7426e+05, 0.0000e+00, 3.7424e+05, 3.7424e+05, 7.7581e+05,
         3.7425e+05, 7.6125e+05, 3.7423e+05, 3.7425e+05],
        [1.4235e+00, 1.2939e+00, 1.2342e+00, 3.9403e+05, 1.4252e+00, 3.8517e+05,
         3.9350e+05, 1.2524e+00, 3.7424e+05, 0.0000e+00, 1.2088e+00, 3.9426e+05,
         1.3493e+00, 3.9030e+05, 1.2979e+00, 1.2038e+00],
        [1.3405e+00, 1.3255e+00, 1.2740e+00, 3.9402e+05, 1.4045e+00, 3.8519e+05,
         3.9345e+05, 1.2617e+00, 3.7424e+05, 1.2088e+00, 0.0000e+00, 3.9428e+05,
         1.2507e+00, 3.9029e+05, 1.2933e+00, 1.0967e+00],
        [3.9427e+05, 3.9426e+05, 3.9426e+05, 7.8571e+05, 3.9430e+05, 7.7520e+05,
         7.7838e+05, 3.9430e+05, 7.7581e+05, 3.9426e+05, 3.9428e+05, 0.0000e+00,
         3.9429e+05, 7.8066e+05, 3.9427e+05, 3.9430e+05],
        [1.7213e+00, 1.5198e+00, 1.5209e+00, 3.9402e+05, 1.2969e+00, 3.8518e+05,
         3.9345e+05, 1.3789e+00, 3.7425e+05, 1.3493e+00, 1.2507e+00, 3.9429e+05,
         0.0000e+00, 3.9029e+05, 1.3851e+00, 1.2160e+00],
        [3.9030e+05, 3.9029e+05, 3.9033e+05, 7.6474e+05, 3.9030e+05, 7.7494e+05,
         7.8629e+05, 3.9029e+05, 7.6125e+05, 3.9030e+05, 3.9029e+05, 7.8066e+05,
         3.9029e+05, 0.0000e+00, 3.9034e+05, 3.9032e+05],
        [1.3918e+00, 1.3013e+00, 1.3250e+00, 3.9407e+05, 1.4655e+00, 3.8518e+05,
         3.9347e+05, 1.2866e+00, 3.7423e+05, 1.2979e+00, 1.2933e+00, 3.9427e+05,
         1.3851e+00, 3.9034e+05, 0.0000e+00, 1.1988e+00],
        [1.3255e+00, 1.3239e+00, 1.2242e+00, 3.9401e+05, 1.3669e+00, 3.8518e+05,
         3.9349e+05, 1.2472e+00, 3.7425e+05, 1.2038e+00, 1.0967e+00, 3.9430e+05,
         1.2160e+00, 3.9032e+05, 1.1988e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2904e+00, 1.3255e+00, 1.3405e+00, 1.3580e+00, 1.3918e+00,
        1.4235e+00, 1.4808e+00, 1.5985e+00, 1.7213e+00, 3.7423e+05, 3.8517e+05,
        3.9030e+05, 3.9348e+05, 3.9402e+05, 3.9427e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2904e+00, 1.2939e+00, 1.3013e+00, 1.3099e+00, 1.3239e+00,
        1.3255e+00, 1.3394e+00, 1.5198e+00, 1.5219e+00, 3.7427e+05, 3.8519e+05,
        3.9029e+05, 3.9348e+05, 3.9401e+05, 3.9426e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2242e+00, 1.2342e+00, 1.2740e+00, 1.3098e+00, 1.3099e+00,
        1.3250e+00, 1.3580e+00, 1.4788e+00, 1.5209e+00, 3.7422e+05, 3.8517e+05,
        3.9033e+05, 3.9349e+05, 3.9402e+05, 3.9426e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394010.4062, 394010.9062, 394017.7812, 394019.0625,
        394021.0938, 394022.4062, 394022.6875, 394025.5938, 394039.2812,
        394069.9375, 764736.1250, 778407.1250, 781512.5625, 785713.7500,
        788824.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2969e+00, 1.3669e+00, 1.4045e+00, 1.4252e+00, 1.4591e+00,
        1.4655e+00, 1.4788e+00, 1.5219e+00, 1.5985e+00, 3.7424e+05, 3.8515e+05,
        3.9030e+05, 3.9346e+05, 3.9404e+05, 3.9430e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385145.7500, 385166.7188, 385172.2500, 385172.8750,
        385175.7188, 385176.7500, 385178.6875, 385182.4375, 385185.3750,
        385187.0938, 769376.8750, 769818.5000, 774940.0000, 775196.1250,
        778407.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393448.5625, 393450.9375, 393461.1875, 393473.0000,
        393475.8438, 393482.6562, 393486.8125, 393489.0312, 393503.3125,
        393505.7500, 753423.2500, 769376.8750, 778383.1875, 781512.5625,
        786285.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2472e+00, 1.2524e+00, 1.2617e+00, 1.2866e+00, 1.3098e+00,
        1.3394e+00, 1.3789e+00, 1.4591e+00, 1.4808e+00, 3.7426e+05, 3.8518e+05,
        3.9029e+05, 3.9351e+05, 3.9402e+05, 3.9430e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374222.8750, 374227.4688, 374230.7500, 374237.8438,
        374240.1562, 374241.5625, 374253.7812, 374253.9062, 374264.3125,
        374270.1250, 753423.2500, 761245.1875, 769818.5000, 775806.8125,
        788824.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2038e+00, 1.2088e+00, 1.2342e+00, 1.2524e+00, 1.2939e+00,
        1.2979e+00, 1.3493e+00, 1.4235e+00, 1.4252e+00, 3.7424e+05, 3.8517e+05,
        3.9030e+05, 3.9350e+05, 3.9403e+05, 3.9426e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0967e+00, 1.2088e+00, 1.2507e+00, 1.2617e+00, 1.2740e+00,
        1.2933e+00, 1.3255e+00, 1.3405e+00, 1.4045e+00, 3.7424e+05, 3.8519e+05,
        3.9029e+05, 3.9345e+05, 3.9402e+05, 3.9428e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394258.1250, 394258.9375, 394263.6250, 394273.2812,
        394274.0938, 394277.0000, 394285.1875, 394302.1562, 394302.3125,
        394302.6562, 775196.1250, 775806.8125, 778383.1875, 780656.2500,
        785713.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2160e+00, 1.2507e+00, 1.2969e+00, 1.3493e+00, 1.3789e+00,
        1.3851e+00, 1.5198e+00, 1.5209e+00, 1.7213e+00, 3.7425e+05, 3.8518e+05,
        3.9029e+05, 3.9345e+05, 3.9402e+05, 3.9429e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390285.4062, 390287.1250, 390287.5625, 390291.1250,
        390295.6562, 390300.5625, 390304.2812, 390322.4375, 390326.5625,
        390336.4375, 761245.1875, 764736.1250, 774940.0000, 780656.2500,
        786285.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1988e+00, 1.2866e+00, 1.2933e+00, 1.2979e+00, 1.3013e+00,
        1.3250e+00, 1.3851e+00, 1.3918e+00, 1.4655e+00, 3.7423e+05, 3.8518e+05,
        3.9034e+05, 3.9347e+05, 3.9407e+05, 3.9427e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0967e+00, 1.1988e+00, 1.2038e+00, 1.2160e+00, 1.2242e+00,
        1.2472e+00, 1.3239e+00, 1.3255e+00, 1.3669e+00, 3.7425e+05, 3.8518e+05,
        3.9032e+05, 3.9349e+05, 3.9401e+05, 3.9430e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37424.37', '37428.23', '37423.49', '394025.91', '37425.09', '385174.38', '393477.69', '37427.63', '374244.28', '37425.19', '37425.30', '394279.75', '37426.66', '390303.69', '37423.94', '37426.50']
estimated f for each client, fs: [6, 6, 6, 4, 6, 4, 4, 6, 5, 6, 6, 4, 6, 4, 6, 6]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 9, 20, 18, 8, 15, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0110s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:04...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:04, End: 2025-07-22 15:29:04)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 1, 20, 18, 8, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.2864e+00, 1.6558e+00, 1.4795e+00, 3.7872e+05, 3.8334e+05,
         1.4676e+00, 1.4460e+00, 1.3336e+00, 3.9647e+05, 3.8126e+05, 1.3984e+00,
         4.0071e+05, 1.4559e+00, 1.3905e+00],
        [1.2864e+00, 0.0000e+00, 1.5398e+00, 1.3649e+00, 3.7870e+05, 3.8336e+05,
         1.3457e+00, 1.3639e+00, 1.3180e+00, 3.9645e+05, 3.8126e+05, 1.2823e+00,
         4.0072e+05, 1.3265e+00, 1.3886e+00],
        [1.6558e+00, 1.5398e+00, 0.0000e+00, 1.2335e+00, 3.7869e+05, 3.8335e+05,
         1.3416e+00, 1.2935e+00, 1.2789e+00, 3.9643e+05, 3.8130e+05, 1.3518e+00,
         4.0071e+05, 1.4394e+00, 1.3072e+00],
        [1.4795e+00, 1.3649e+00, 1.2335e+00, 0.0000e+00, 3.7871e+05, 3.8334e+05,
         1.2087e+00, 1.2573e+00, 1.1437e+00, 3.9647e+05, 3.8126e+05, 1.1202e+00,
         4.0071e+05, 1.2099e+00, 1.1186e+00],
        [3.7872e+05, 3.7870e+05, 3.7869e+05, 3.7871e+05, 0.0000e+00, 7.6782e+05,
         3.7872e+05, 3.7869e+05, 3.7870e+05, 7.4918e+05, 7.7265e+05, 3.7869e+05,
         7.6320e+05, 3.7870e+05, 3.7870e+05],
        [3.8334e+05, 3.8336e+05, 3.8335e+05, 3.8334e+05, 7.6782e+05, 0.0000e+00,
         3.8332e+05, 3.8334e+05, 3.8339e+05, 7.8985e+05, 7.7202e+05, 3.8335e+05,
         7.8700e+05, 3.8330e+05, 3.8337e+05],
        [1.4676e+00, 1.3457e+00, 1.3416e+00, 1.2087e+00, 3.7872e+05, 3.8332e+05,
         0.0000e+00, 1.2278e+00, 1.2293e+00, 3.9646e+05, 3.8127e+05, 1.2266e+00,
         4.0069e+05, 1.2633e+00, 1.2596e+00],
        [1.4460e+00, 1.3639e+00, 1.2935e+00, 1.2573e+00, 3.7869e+05, 3.8334e+05,
         1.2278e+00, 0.0000e+00, 1.2359e+00, 3.9645e+05, 3.8128e+05, 1.2650e+00,
         4.0072e+05, 1.3655e+00, 1.2483e+00],
        [1.3336e+00, 1.3180e+00, 1.2789e+00, 1.1437e+00, 3.7870e+05, 3.8339e+05,
         1.2293e+00, 1.2359e+00, 0.0000e+00, 3.9645e+05, 3.8124e+05, 1.1454e+00,
         4.0070e+05, 1.3483e+00, 1.1067e+00],
        [3.9647e+05, 3.9645e+05, 3.9643e+05, 3.9647e+05, 7.4918e+05, 7.8985e+05,
         3.9646e+05, 3.9645e+05, 3.9645e+05, 0.0000e+00, 7.6414e+05, 3.9645e+05,
         7.9181e+05, 3.9645e+05, 3.9647e+05],
        [3.8126e+05, 3.8126e+05, 3.8130e+05, 3.8126e+05, 7.7265e+05, 7.7202e+05,
         3.8127e+05, 3.8128e+05, 3.8124e+05, 7.6414e+05, 0.0000e+00, 3.8128e+05,
         7.6359e+05, 3.8129e+05, 3.8128e+05],
        [1.3984e+00, 1.2823e+00, 1.3518e+00, 1.1202e+00, 3.7869e+05, 3.8335e+05,
         1.2266e+00, 1.2650e+00, 1.1454e+00, 3.9645e+05, 3.8128e+05, 0.0000e+00,
         4.0073e+05, 1.2609e+00, 1.2204e+00],
        [4.0071e+05, 4.0072e+05, 4.0071e+05, 4.0071e+05, 7.6320e+05, 7.8700e+05,
         4.0069e+05, 4.0072e+05, 4.0070e+05, 7.9181e+05, 7.6359e+05, 4.0073e+05,
         0.0000e+00, 4.0072e+05, 4.0071e+05],
        [1.4559e+00, 1.3265e+00, 1.4394e+00, 1.2099e+00, 3.7870e+05, 3.8330e+05,
         1.2633e+00, 1.3655e+00, 1.3483e+00, 3.9645e+05, 3.8129e+05, 1.2609e+00,
         4.0072e+05, 0.0000e+00, 1.2948e+00],
        [1.3905e+00, 1.3886e+00, 1.3072e+00, 1.1186e+00, 3.7870e+05, 3.8337e+05,
         1.2596e+00, 1.2483e+00, 1.1067e+00, 3.9647e+05, 3.8128e+05, 1.2204e+00,
         4.0071e+05, 1.2948e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2864e+00, 1.3336e+00, 1.3905e+00, 1.3984e+00, 1.4460e+00,
        1.4559e+00, 1.4676e+00, 1.4795e+00, 1.6558e+00, 3.7872e+05, 3.8126e+05,
        3.8334e+05, 3.9647e+05, 4.0071e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2823e+00, 1.2864e+00, 1.3180e+00, 1.3265e+00, 1.3457e+00,
        1.3639e+00, 1.3649e+00, 1.3886e+00, 1.5398e+00, 3.7870e+05, 3.8126e+05,
        3.8336e+05, 3.9645e+05, 4.0072e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2335e+00, 1.2789e+00, 1.2935e+00, 1.3072e+00, 1.3416e+00,
        1.3518e+00, 1.4394e+00, 1.5398e+00, 1.6558e+00, 3.7869e+05, 3.8130e+05,
        3.8335e+05, 3.9643e+05, 4.0071e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1186e+00, 1.1202e+00, 1.1437e+00, 1.2087e+00, 1.2099e+00,
        1.2335e+00, 1.2573e+00, 1.3649e+00, 1.4795e+00, 3.7871e+05, 3.8126e+05,
        3.8334e+05, 3.9647e+05, 4.0071e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 378688.8125, 378689.0938, 378689.6562, 378696.9375,
        378697.3750, 378698.2188, 378704.7812, 378714.3125, 378721.7812,
        378721.8125, 749180.8750, 763204.8750, 767819.3750, 772651.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383303.5000, 383321.0625, 383338.5000, 383341.2500,
        383343.7188, 383349.3125, 383352.0625, 383359.4688, 383368.9375,
        383386.2500, 767819.3750, 772023.4375, 787002.0000, 789848.6875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2087e+00, 1.2266e+00, 1.2278e+00, 1.2293e+00, 1.2596e+00,
        1.2633e+00, 1.3416e+00, 1.3457e+00, 1.4676e+00, 3.7872e+05, 3.8127e+05,
        3.8332e+05, 3.9646e+05, 4.0069e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2278e+00, 1.2359e+00, 1.2483e+00, 1.2573e+00, 1.2650e+00,
        1.2935e+00, 1.3639e+00, 1.3655e+00, 1.4460e+00, 3.7869e+05, 3.8128e+05,
        3.8334e+05, 3.9645e+05, 4.0072e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1067e+00, 1.1437e+00, 1.1454e+00, 1.2293e+00, 1.2359e+00,
        1.2789e+00, 1.3180e+00, 1.3336e+00, 1.3483e+00, 3.7870e+05, 3.8124e+05,
        3.8339e+05, 3.9645e+05, 4.0070e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396429.5000, 396445.6250, 396446.9062, 396447.5000,
        396447.9375, 396452.7812, 396455.0000, 396465.5938, 396469.8750,
        396473.6562, 749180.8750, 764137.0000, 789848.6875, 791805.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381242.6562, 381261.4688, 381262.4062, 381264.9375,
        381266.0625, 381275.6562, 381280.2500, 381282.0000, 381289.5938,
        381301.7188, 763587.8125, 764137.0000, 772023.4375, 772651.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1202e+00, 1.1454e+00, 1.2204e+00, 1.2266e+00, 1.2609e+00,
        1.2650e+00, 1.2823e+00, 1.3518e+00, 1.3984e+00, 3.7869e+05, 3.8128e+05,
        3.8335e+05, 3.9645e+05, 4.0073e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400685.0312, 400700.6250, 400707.3750, 400710.0625,
        400710.5938, 400710.9688, 400718.8125, 400723.8750, 400724.8438,
        400734.9688, 763204.8750, 763587.8125, 787002.0000, 791805.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2099e+00, 1.2609e+00, 1.2633e+00, 1.2948e+00, 1.3265e+00,
        1.3483e+00, 1.3655e+00, 1.4394e+00, 1.4559e+00, 3.7870e+05, 3.8129e+05,
        3.8330e+05, 3.9645e+05, 4.0072e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1067e+00, 1.1186e+00, 1.2204e+00, 1.2483e+00, 1.2596e+00,
        1.2948e+00, 1.3072e+00, 1.3886e+00, 1.3905e+00, 3.7870e+05, 3.8128e+05,
        3.8337e+05, 3.9647e+05, 4.0071e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.43', '1.36', '1.38', '1.24', '378702.28', '383342.00', '1.29', '1.30', '1.24', '396453.41', '381269.44', '1.25', '400712.72', '1.33', '1.26']
estimated f for each client, fs: [5, 5, 5, 5, 3, 5, 5, 5, 5, 3, 5, 5, 3, 5, 5]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 1, 20, 18, 8, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0107s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:05...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:05, End: 2025-07-22 15:29:05)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [7, 19, 17, 1, 18, 8, 4, 3, 13, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 3.9464e+05, 3.9801e+05, 1.6208e+00, 4.0269e+05, 1.1574e+00,
         1.1330e+00, 1.0903e+00, 3.9202e+05, 3.8522e+05, 1.1118e+00, 1.1757e+00],
        [3.9464e+05, 0.0000e+00, 7.9608e+05, 3.9463e+05, 7.9455e+05, 3.9463e+05,
         3.9463e+05, 3.9463e+05, 7.8316e+05, 7.9770e+05, 3.9463e+05, 3.9463e+05],
        [3.9801e+05, 7.9608e+05, 0.0000e+00, 3.9804e+05, 8.0801e+05, 3.9801e+05,
         3.9801e+05, 3.9801e+05, 7.6830e+05, 7.7934e+05, 3.9803e+05, 3.9802e+05],
        [1.6208e+00, 3.9463e+05, 3.9804e+05, 0.0000e+00, 4.0267e+05, 1.3324e+00,
         1.3650e+00, 1.2477e+00, 3.9200e+05, 3.8525e+05, 1.3364e+00, 1.2712e+00],
        [4.0269e+05, 7.9455e+05, 8.0801e+05, 4.0267e+05, 0.0000e+00, 4.0268e+05,
         4.0267e+05, 4.0267e+05, 8.0570e+05, 7.9609e+05, 4.0268e+05, 4.0265e+05],
        [1.1574e+00, 3.9463e+05, 3.9801e+05, 1.3324e+00, 4.0268e+05, 0.0000e+00,
         1.0078e+00, 1.0088e+00, 3.9201e+05, 3.8523e+05, 1.0403e+00, 1.0584e+00],
        [1.1330e+00, 3.9463e+05, 3.9801e+05, 1.3650e+00, 4.0267e+05, 1.0078e+00,
         0.0000e+00, 9.7021e-01, 3.9198e+05, 3.8523e+05, 1.0709e+00, 9.9913e-01],
        [1.0903e+00, 3.9463e+05, 3.9801e+05, 1.2477e+00, 4.0267e+05, 1.0088e+00,
         9.7021e-01, 0.0000e+00, 3.9198e+05, 3.8523e+05, 1.0289e+00, 8.9872e-01],
        [3.9202e+05, 7.8316e+05, 7.6830e+05, 3.9200e+05, 8.0570e+05, 3.9201e+05,
         3.9198e+05, 3.9198e+05, 0.0000e+00, 7.7150e+05, 3.9199e+05, 3.9201e+05],
        [3.8522e+05, 7.9770e+05, 7.7934e+05, 3.8525e+05, 7.9609e+05, 3.8523e+05,
         3.8523e+05, 3.8523e+05, 7.7150e+05, 0.0000e+00, 3.8523e+05, 3.8527e+05],
        [1.1118e+00, 3.9463e+05, 3.9803e+05, 1.3364e+00, 4.0268e+05, 1.0403e+00,
         1.0709e+00, 1.0289e+00, 3.9199e+05, 3.8523e+05, 0.0000e+00, 1.0288e+00],
        [1.1757e+00, 3.9463e+05, 3.9802e+05, 1.2712e+00, 4.0265e+05, 1.0584e+00,
         9.9913e-01, 8.9872e-01, 3.9201e+05, 3.8527e+05, 1.0288e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0903e+00, 1.1118e+00, 1.1330e+00, 1.1574e+00, 1.1757e+00,
        1.6208e+00, 3.8522e+05, 3.9202e+05, 3.9464e+05, 3.9801e+05, 4.0269e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 394625.5625, 394626.6875, 394627.8750, 394630.0000,
        394630.8750, 394633.8438, 394636.3125, 783159.3125, 794553.3750,
        796083.3750, 797699.8750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 398005.6875, 398006.2500, 398013.5625, 398014.7500,
        398021.8438, 398026.0625, 398035.8125, 768301.7500, 779336.5625,
        796083.3750, 808005.6875])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.2477e+00, 1.2712e+00, 1.3324e+00, 1.3364e+00, 1.3650e+00,
        1.6208e+00, 3.8525e+05, 3.9200e+05, 3.9463e+05, 3.9804e+05, 4.0267e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 402652.8125, 402666.0938, 402668.5312, 402673.2500,
        402676.3438, 402684.3750, 402685.3438, 794553.3750, 796091.8125,
        805704.6250, 808005.6875])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.0078e+00, 1.0088e+00, 1.0403e+00, 1.0584e+00, 1.1574e+00,
        1.3324e+00, 3.8523e+05, 3.9201e+05, 3.9463e+05, 3.9801e+05, 4.0268e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 9.7021e-01, 9.9913e-01, 1.0078e+00, 1.0709e+00, 1.1330e+00,
        1.3650e+00, 3.8523e+05, 3.9198e+05, 3.9463e+05, 3.9801e+05, 4.0267e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 8.9872e-01, 9.7021e-01, 1.0088e+00, 1.0289e+00, 1.0903e+00,
        1.2477e+00, 3.8523e+05, 3.9198e+05, 3.9463e+05, 3.9801e+05, 4.0267e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 391977.1250, 391980.1875, 391994.7188, 392003.6250,
        392006.5312, 392013.5625, 392019.0000, 768301.7500, 771495.9375,
        783159.3125, 805704.6250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 385220.8750, 385225.0938, 385227.6250, 385230.1250,
        385231.7812, 385254.1875, 385270.5938, 771495.9375, 779336.5625,
        796091.8125, 797699.8750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.0288e+00, 1.0289e+00, 1.0403e+00, 1.0709e+00, 1.1118e+00,
        1.3364e+00, 3.8523e+05, 3.9199e+05, 3.9463e+05, 3.9803e+05, 4.0268e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 8.9872e-01, 9.9913e-01, 1.0288e+00, 1.0584e+00, 1.1757e+00,
        1.2712e+00, 3.8527e+05, 3.9201e+05, 3.9463e+05, 3.9802e+05, 4.0265e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['97155.90', '443196.34', '444303.25', '97158.25', '451657.53', '97156.30', '97152.32', '97151.07', '439037.09', '433519.53', '97153.62', '97160.45']
estimated f for each client, fs: [5, 3, 3, 5, 3, 5, 5, 5, 3, 4, 5, 5]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [7, 19, 17, 1, 18, 8, 4, 3, 13, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0071s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:06...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:06, End: 2025-07-22 15:29:06)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.1255e+00, 1.2449e+00, 4.0984e+05, 3.8483e+05, 1.3625e+00,
         1.1930e+00, 3.8473e+05, 3.8694e+05, 1.2388e+00, 3.9372e+05, 1.2373e+00,
         1.5069e+00, 3.9375e+05, 4.0477e+05, 1.1764e+00, 3.7477e+05, 1.1925e+00,
         1.1696e+00],
        [1.1255e+00, 0.0000e+00, 1.1424e+00, 4.0986e+05, 3.8482e+05, 1.2610e+00,
         1.0917e+00, 3.8475e+05, 3.8692e+05, 1.1210e+00, 3.9372e+05, 1.0982e+00,
         1.4891e+00, 3.9377e+05, 4.0475e+05, 1.0631e+00, 3.7477e+05, 1.1409e+00,
         1.1541e+00],
        [1.2449e+00, 1.1424e+00, 0.0000e+00, 4.0987e+05, 3.8480e+05, 9.5751e-01,
         9.6890e-01, 3.8469e+05, 3.8693e+05, 1.0081e+00, 3.9369e+05, 9.9860e-01,
         1.1838e+00, 3.9375e+05, 4.0477e+05, 1.0087e+00, 3.7481e+05, 1.0698e+00,
         9.8481e-01],
        [4.0984e+05, 4.0986e+05, 4.0987e+05, 0.0000e+00, 7.9964e+05, 4.0989e+05,
         4.0989e+05, 7.8527e+05, 7.6941e+05, 4.0987e+05, 7.9415e+05, 4.0985e+05,
         4.0985e+05, 8.0898e+05, 8.2118e+05, 4.0988e+05, 7.9352e+05, 4.0987e+05,
         4.0986e+05],
        [3.8483e+05, 3.8482e+05, 3.8480e+05, 7.9964e+05, 0.0000e+00, 3.8483e+05,
         3.8482e+05, 7.6846e+05, 7.9174e+05, 3.8481e+05, 7.7319e+05, 3.8481e+05,
         3.8481e+05, 7.5891e+05, 7.7690e+05, 3.8481e+05, 7.6136e+05, 3.8481e+05,
         3.8481e+05],
        [1.3625e+00, 1.2610e+00, 9.5751e-01, 4.0989e+05, 3.8483e+05, 0.0000e+00,
         1.0784e+00, 3.8471e+05, 3.8696e+05, 1.1009e+00, 3.9369e+05, 1.1466e+00,
         8.9780e-01, 3.9378e+05, 4.0481e+05, 9.6153e-01, 3.7483e+05, 1.1080e+00,
         1.0265e+00],
        [1.1930e+00, 1.0917e+00, 9.6890e-01, 4.0989e+05, 3.8482e+05, 1.0784e+00,
         0.0000e+00, 3.8471e+05, 3.8697e+05, 1.0570e+00, 3.9372e+05, 1.0924e+00,
         1.2765e+00, 3.9378e+05, 4.0479e+05, 1.0139e+00, 3.7481e+05, 1.1107e+00,
         1.0598e+00],
        [3.8473e+05, 3.8475e+05, 3.8469e+05, 7.8527e+05, 7.6846e+05, 3.8471e+05,
         3.8471e+05, 0.0000e+00, 7.7503e+05, 3.8472e+05, 7.9158e+05, 3.8470e+05,
         3.8472e+05, 8.1283e+05, 7.7810e+05, 3.8472e+05, 7.8430e+05, 3.8473e+05,
         3.8472e+05],
        [3.8694e+05, 3.8692e+05, 3.8693e+05, 7.6941e+05, 7.9174e+05, 3.8696e+05,
         3.8697e+05, 7.7503e+05, 0.0000e+00, 3.8697e+05, 7.8007e+05, 3.8695e+05,
         3.8696e+05, 7.6440e+05, 7.8756e+05, 3.8696e+05, 7.5747e+05, 3.8691e+05,
         3.8694e+05],
        [1.2388e+00, 1.1210e+00, 1.0081e+00, 4.0987e+05, 3.8481e+05, 1.1009e+00,
         1.0570e+00, 3.8472e+05, 3.8697e+05, 0.0000e+00, 3.9373e+05, 1.0316e+00,
         1.3249e+00, 3.9375e+05, 4.0480e+05, 1.0396e+00, 3.7479e+05, 1.0414e+00,
         1.0864e+00],
        [3.9372e+05, 3.9372e+05, 3.9369e+05, 7.9415e+05, 7.7319e+05, 3.9369e+05,
         3.9372e+05, 7.9158e+05, 7.8007e+05, 3.9373e+05, 0.0000e+00, 3.9371e+05,
         3.9367e+05, 7.7719e+05, 7.9895e+05, 3.9370e+05, 7.6786e+05, 3.9372e+05,
         3.9370e+05],
        [1.2373e+00, 1.0982e+00, 9.9860e-01, 4.0985e+05, 3.8481e+05, 1.1466e+00,
         1.0924e+00, 3.8470e+05, 3.8695e+05, 1.0316e+00, 3.9371e+05, 0.0000e+00,
         1.3001e+00, 3.9377e+05, 4.0479e+05, 1.0359e+00, 3.7478e+05, 1.1275e+00,
         1.0802e+00],
        [1.5069e+00, 1.4891e+00, 1.1838e+00, 4.0985e+05, 3.8481e+05, 8.9780e-01,
         1.2765e+00, 3.8472e+05, 3.8696e+05, 1.3249e+00, 3.9367e+05, 1.3001e+00,
         0.0000e+00, 3.9374e+05, 4.0483e+05, 1.1527e+00, 3.7480e+05, 1.4166e+00,
         1.1676e+00],
        [3.9375e+05, 3.9377e+05, 3.9375e+05, 8.0898e+05, 7.5891e+05, 3.9378e+05,
         3.9378e+05, 8.1283e+05, 7.6440e+05, 3.9375e+05, 7.7719e+05, 3.9377e+05,
         3.9374e+05, 0.0000e+00, 7.7737e+05, 3.9374e+05, 7.5690e+05, 3.9374e+05,
         3.9376e+05],
        [4.0477e+05, 4.0475e+05, 4.0477e+05, 8.2118e+05, 7.7690e+05, 4.0481e+05,
         4.0479e+05, 7.7810e+05, 7.8756e+05, 4.0480e+05, 7.9895e+05, 4.0479e+05,
         4.0483e+05, 7.7737e+05, 0.0000e+00, 4.0480e+05, 7.9402e+05, 4.0479e+05,
         4.0477e+05],
        [1.1764e+00, 1.0631e+00, 1.0087e+00, 4.0988e+05, 3.8481e+05, 9.6153e-01,
         1.0139e+00, 3.8472e+05, 3.8696e+05, 1.0396e+00, 3.9370e+05, 1.0359e+00,
         1.1527e+00, 3.9374e+05, 4.0480e+05, 0.0000e+00, 3.7480e+05, 1.0363e+00,
         1.0544e+00],
        [3.7477e+05, 3.7477e+05, 3.7481e+05, 7.9352e+05, 7.6136e+05, 3.7483e+05,
         3.7481e+05, 7.8430e+05, 7.5747e+05, 3.7479e+05, 7.6786e+05, 3.7478e+05,
         3.7480e+05, 7.5690e+05, 7.9402e+05, 3.7480e+05, 0.0000e+00, 3.7478e+05,
         3.7476e+05],
        [1.1925e+00, 1.1409e+00, 1.0698e+00, 4.0987e+05, 3.8481e+05, 1.1080e+00,
         1.1107e+00, 3.8473e+05, 3.8691e+05, 1.0414e+00, 3.9372e+05, 1.1275e+00,
         1.4166e+00, 3.9374e+05, 4.0479e+05, 1.0363e+00, 3.7478e+05, 0.0000e+00,
         1.0562e+00],
        [1.1696e+00, 1.1541e+00, 9.8481e-01, 4.0986e+05, 3.8481e+05, 1.0265e+00,
         1.0598e+00, 3.8472e+05, 3.8694e+05, 1.0864e+00, 3.9370e+05, 1.0802e+00,
         1.1676e+00, 3.9376e+05, 4.0477e+05, 1.0544e+00, 3.7476e+05, 1.0562e+00,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1255e+00, 1.1696e+00, 1.1764e+00, 1.1925e+00, 1.1930e+00,
        1.2373e+00, 1.2388e+00, 1.2449e+00, 1.3625e+00, 1.5069e+00, 3.7477e+05,
        3.8473e+05, 3.8483e+05, 3.8694e+05, 3.9372e+05, 3.9375e+05, 4.0477e+05,
        4.0984e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0631e+00, 1.0917e+00, 1.0982e+00, 1.1210e+00, 1.1255e+00,
        1.1409e+00, 1.1424e+00, 1.1541e+00, 1.2610e+00, 1.4891e+00, 3.7477e+05,
        3.8475e+05, 3.8482e+05, 3.8692e+05, 3.9372e+05, 3.9377e+05, 4.0475e+05,
        4.0986e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.5751e-01, 9.6890e-01, 9.8481e-01, 9.9860e-01, 1.0081e+00,
        1.0087e+00, 1.0698e+00, 1.1424e+00, 1.1838e+00, 1.2449e+00, 3.7481e+05,
        3.8469e+05, 3.8480e+05, 3.8693e+05, 3.9369e+05, 3.9375e+05, 4.0477e+05,
        4.0987e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 409840.7500, 409850.2812, 409854.8750, 409855.0000,
        409858.9062, 409869.2812, 409871.0625, 409872.8750, 409882.6562,
        409889.7500, 409894.2812, 769407.5625, 785273.8750, 793516.5000,
        794154.5000, 799638.5000, 808977.7500, 821182.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384804.6250, 384805.4375, 384806.2500, 384808.0625,
        384808.3438, 384811.9375, 384813.3750, 384817.1875, 384824.9062,
        384828.6562, 384829.0312, 758911.6875, 761356.1250, 768457.8750,
        773189.0625, 776899.4375, 791739.1875, 799638.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.9780e-01, 9.5751e-01, 9.6153e-01, 1.0265e+00, 1.0784e+00,
        1.1009e+00, 1.1080e+00, 1.1466e+00, 1.2610e+00, 1.3625e+00, 3.7483e+05,
        3.8471e+05, 3.8483e+05, 3.8696e+05, 3.9369e+05, 3.9378e+05, 4.0481e+05,
        4.0989e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.6890e-01, 1.0139e+00, 1.0570e+00, 1.0598e+00, 1.0784e+00,
        1.0917e+00, 1.0924e+00, 1.1107e+00, 1.1930e+00, 1.2765e+00, 3.7481e+05,
        3.8471e+05, 3.8482e+05, 3.8697e+05, 3.9372e+05, 3.9378e+05, 4.0479e+05,
        4.0989e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384689.8125, 384700.7812, 384708.5938, 384710.0312,
        384715.5312, 384716.5625, 384717.7500, 384718.8125, 384730.9375,
        384732.5938, 384745.4375, 768457.8750, 775030.5000, 778098.3750,
        784297.1875, 785273.8750, 791579.5625, 812827.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386909.2812, 386921.7500, 386930.8438, 386935.0000,
        386944.9688, 386948.7188, 386956.9688, 386962.7188, 386963.1562,
        386968.1250, 386969.6875, 757473.7500, 764403.1250, 769407.5625,
        775030.5000, 780072.1875, 787556.2500, 791739.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0081e+00, 1.0316e+00, 1.0396e+00, 1.0414e+00, 1.0570e+00,
        1.0864e+00, 1.1009e+00, 1.1210e+00, 1.2388e+00, 1.3249e+00, 3.7479e+05,
        3.8472e+05, 3.8481e+05, 3.8697e+05, 3.9373e+05, 3.9375e+05, 4.0480e+05,
        4.0987e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393673.2188, 393688.4688, 393691.8125, 393696.4688,
        393701.6250, 393708.9688, 393721.1562, 393721.3125, 393722.2500,
        393723.4375, 393734.3750, 767855.3125, 773189.0625, 777188.3750,
        780072.1875, 791579.5625, 794154.5000, 798950.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.9860e-01, 1.0316e+00, 1.0359e+00, 1.0802e+00, 1.0924e+00,
        1.0982e+00, 1.1275e+00, 1.1466e+00, 1.2373e+00, 1.3001e+00, 3.7478e+05,
        3.8470e+05, 3.8481e+05, 3.8695e+05, 3.9371e+05, 3.9377e+05, 4.0479e+05,
        4.0985e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.9780e-01, 1.1527e+00, 1.1676e+00, 1.1838e+00, 1.2765e+00,
        1.3001e+00, 1.3249e+00, 1.4166e+00, 1.4891e+00, 1.5069e+00, 3.7480e+05,
        3.8472e+05, 3.8481e+05, 3.8696e+05, 3.9367e+05, 3.9374e+05, 4.0483e+05,
        4.0985e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393743.8125, 393743.9688, 393744.7500, 393746.8125,
        393748.2500, 393754.5000, 393760.3750, 393766.5625, 393772.1875,
        393775.3125, 393780.1562, 756898.8750, 758911.6875, 764403.1250,
        777188.3750, 777374.8750, 808977.7500, 812827.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 404753.8125, 404770.1875, 404771.1250, 404772.4688,
        404791.0625, 404792.3125, 404792.3125, 404797.8750, 404799.6875,
        404809.7188, 404827.8438, 776899.4375, 777374.8750, 778098.3750,
        787556.2500, 794018.2500, 798950.6875, 821182.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.6153e-01, 1.0087e+00, 1.0139e+00, 1.0359e+00, 1.0363e+00,
        1.0396e+00, 1.0544e+00, 1.0631e+00, 1.1527e+00, 1.1764e+00, 3.7480e+05,
        3.8472e+05, 3.8481e+05, 3.8696e+05, 3.9370e+05, 3.9374e+05, 4.0480e+05,
        4.0988e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 374762.5312, 374765.3438, 374767.6250, 374780.3750,
        374783.6875, 374789.5625, 374798.3438, 374802.9375, 374806.9688,
        374811.3125, 374830.4375, 756898.8750, 757473.7500, 761356.1250,
        767855.3125, 784297.1875, 793516.5000, 794018.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0363e+00, 1.0414e+00, 1.0562e+00, 1.0698e+00, 1.1080e+00,
        1.1107e+00, 1.1275e+00, 1.1409e+00, 1.1925e+00, 1.4166e+00, 3.7478e+05,
        3.8473e+05, 3.8481e+05, 3.8691e+05, 3.9372e+05, 3.9374e+05, 4.0479e+05,
        4.0987e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.8481e-01, 1.0265e+00, 1.0544e+00, 1.0562e+00, 1.0598e+00,
        1.0802e+00, 1.0864e+00, 1.1541e+00, 1.1676e+00, 1.1696e+00, 3.7476e+05,
        3.8472e+05, 3.8481e+05, 3.8694e+05, 3.9370e+05, 3.9376e+05, 4.0477e+05,
        4.0986e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34070.71', '34070.85', '34074.72', '409867.19', '384814.34', '34076.49', '34074.36', '384716.97', '386946.47', '34072.78', '393707.56', '34071.96', '34073.73', '393757.91', '404788.97', '34073.95', '374790.84', '34072.27', '34070.30']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 8, 6, 6, 8, 6, 8, 8, 6, 6, 8, 7, 8, 8]
selected_index: 18
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0145s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:06...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 75 188]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:06, End: 2025-07-22 15:29:06)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.1034e+00, 1.2026e+00, 3.8175e+05, 4.0128e+05, 1.1664e+00,
         3.8157e+05, 4.0308e+05, 1.1860e+00, 3.9321e+05, 1.1713e+00, 1.2420e+00,
         4.0838e+05, 3.8817e+05, 1.1331e+00, 1.3654e+00, 1.1280e+00, 1.4828e+00],
        [1.1034e+00, 0.0000e+00, 1.1191e+00, 3.8178e+05, 4.0129e+05, 1.0709e+00,
         3.8159e+05, 4.0310e+05, 1.0981e+00, 3.9321e+05, 1.0700e+00, 1.2537e+00,
         4.0834e+05, 3.8818e+05, 1.0574e+00, 1.2724e+00, 1.0786e+00, 1.5270e+00],
        [1.2026e+00, 1.1191e+00, 0.0000e+00, 3.8174e+05, 4.0133e+05, 9.5633e-01,
         3.8158e+05, 4.0309e+05, 9.6336e-01, 3.9321e+05, 9.6850e-01, 9.6602e-01,
         4.0833e+05, 3.8817e+05, 9.8447e-01, 9.6370e-01, 1.0160e+00, 1.1137e+00],
        [3.8175e+05, 3.8178e+05, 3.8174e+05, 0.0000e+00, 7.7054e+05, 3.8176e+05,
         7.6050e+05, 8.0613e+05, 3.8175e+05, 7.7085e+05, 3.8175e+05, 3.8174e+05,
         7.9864e+05, 7.6449e+05, 3.8178e+05, 3.8175e+05, 3.8172e+05, 3.8178e+05],
        [4.0128e+05, 4.0129e+05, 4.0133e+05, 7.7054e+05, 0.0000e+00, 4.0132e+05,
         7.8365e+05, 8.1027e+05, 4.0129e+05, 7.9364e+05, 4.0129e+05, 4.0132e+05,
         8.1623e+05, 8.0463e+05, 4.0129e+05, 4.0129e+05, 4.0131e+05, 4.0131e+05],
        [1.1664e+00, 1.0709e+00, 9.5633e-01, 3.8176e+05, 4.0132e+05, 0.0000e+00,
         3.8156e+05, 4.0309e+05, 1.0294e+00, 3.9322e+05, 1.0360e+00, 1.0520e+00,
         4.0834e+05, 3.8815e+05, 9.8530e-01, 1.0572e+00, 1.0703e+00, 1.2721e+00],
        [3.8157e+05, 3.8159e+05, 3.8158e+05, 7.6050e+05, 7.8365e+05, 3.8156e+05,
         0.0000e+00, 7.8358e+05, 3.8158e+05, 7.7281e+05, 3.8160e+05, 3.8157e+05,
         7.9305e+05, 7.6759e+05, 3.8156e+05, 3.8156e+05, 3.8156e+05, 3.8156e+05],
        [4.0308e+05, 4.0310e+05, 4.0309e+05, 8.0613e+05, 8.1027e+05, 4.0309e+05,
         7.8358e+05, 0.0000e+00, 4.0309e+05, 7.8224e+05, 4.0309e+05, 4.0307e+05,
         8.1308e+05, 7.9707e+05, 4.0309e+05, 4.0307e+05, 4.0309e+05, 4.0307e+05],
        [1.1860e+00, 1.0981e+00, 9.6336e-01, 3.8175e+05, 4.0129e+05, 1.0294e+00,
         3.8158e+05, 4.0309e+05, 0.0000e+00, 3.9320e+05, 9.8009e-01, 1.0893e+00,
         4.0833e+05, 3.8817e+05, 1.0089e+00, 1.0933e+00, 1.0026e+00, 1.3056e+00],
        [3.9321e+05, 3.9321e+05, 3.9321e+05, 7.7085e+05, 7.9364e+05, 3.9322e+05,
         7.7281e+05, 7.8224e+05, 3.9320e+05, 0.0000e+00, 3.9319e+05, 3.9321e+05,
         7.9715e+05, 8.0230e+05, 3.9320e+05, 3.9322e+05, 3.9321e+05, 3.9320e+05],
        [1.1713e+00, 1.0700e+00, 9.6850e-01, 3.8175e+05, 4.0129e+05, 1.0360e+00,
         3.8160e+05, 4.0309e+05, 9.8009e-01, 3.9319e+05, 0.0000e+00, 1.0717e+00,
         4.0835e+05, 3.8818e+05, 1.0108e+00, 1.1538e+00, 1.0415e+00, 1.2918e+00],
        [1.2420e+00, 1.2537e+00, 9.6602e-01, 3.8174e+05, 4.0132e+05, 1.0520e+00,
         3.8157e+05, 4.0307e+05, 1.0893e+00, 3.9321e+05, 1.0717e+00, 0.0000e+00,
         4.0831e+05, 3.8817e+05, 9.6407e-01, 8.6314e-01, 1.1201e+00, 8.9748e-01],
        [4.0838e+05, 4.0834e+05, 4.0833e+05, 7.9864e+05, 8.1623e+05, 4.0834e+05,
         7.9305e+05, 8.1308e+05, 4.0833e+05, 7.9715e+05, 4.0835e+05, 4.0831e+05,
         0.0000e+00, 7.9607e+05, 4.0834e+05, 4.0835e+05, 4.0832e+05, 4.0834e+05],
        [3.8817e+05, 3.8818e+05, 3.8817e+05, 7.6449e+05, 8.0463e+05, 3.8815e+05,
         7.6759e+05, 7.9707e+05, 3.8817e+05, 8.0230e+05, 3.8818e+05, 3.8817e+05,
         7.9607e+05, 0.0000e+00, 3.8817e+05, 3.8818e+05, 3.8819e+05, 3.8818e+05],
        [1.1331e+00, 1.0574e+00, 9.8447e-01, 3.8178e+05, 4.0129e+05, 9.8530e-01,
         3.8156e+05, 4.0309e+05, 1.0089e+00, 3.9320e+05, 1.0108e+00, 9.6407e-01,
         4.0834e+05, 3.8817e+05, 0.0000e+00, 9.9394e-01, 9.9779e-01, 1.2045e+00],
        [1.3654e+00, 1.2724e+00, 9.6370e-01, 3.8175e+05, 4.0129e+05, 1.0572e+00,
         3.8156e+05, 4.0307e+05, 1.0933e+00, 3.9322e+05, 1.1538e+00, 8.6314e-01,
         4.0835e+05, 3.8818e+05, 9.9394e-01, 0.0000e+00, 1.1229e+00, 9.6592e-01],
        [1.1280e+00, 1.0786e+00, 1.0160e+00, 3.8172e+05, 4.0131e+05, 1.0703e+00,
         3.8156e+05, 4.0309e+05, 1.0026e+00, 3.9321e+05, 1.0415e+00, 1.1201e+00,
         4.0832e+05, 3.8819e+05, 9.9779e-01, 1.1229e+00, 0.0000e+00, 1.3088e+00],
        [1.4828e+00, 1.5270e+00, 1.1137e+00, 3.8178e+05, 4.0131e+05, 1.2721e+00,
         3.8156e+05, 4.0307e+05, 1.3056e+00, 3.9320e+05, 1.2918e+00, 8.9748e-01,
         4.0834e+05, 3.8818e+05, 1.2045e+00, 9.6592e-01, 1.3088e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1034e+00, 1.1280e+00, 1.1331e+00, 1.1664e+00, 1.1713e+00,
        1.1860e+00, 1.2026e+00, 1.2420e+00, 1.3654e+00, 1.4828e+00, 3.8157e+05,
        3.8175e+05, 3.8817e+05, 3.9321e+05, 4.0128e+05, 4.0308e+05, 4.0838e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0574e+00, 1.0700e+00, 1.0709e+00, 1.0786e+00, 1.0981e+00,
        1.1034e+00, 1.1191e+00, 1.2537e+00, 1.2724e+00, 1.5270e+00, 3.8159e+05,
        3.8178e+05, 3.8818e+05, 3.9321e+05, 4.0129e+05, 4.0310e+05, 4.0834e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.5633e-01, 9.6336e-01, 9.6370e-01, 9.6602e-01, 9.6850e-01,
        9.8447e-01, 1.0160e+00, 1.1137e+00, 1.1191e+00, 1.2026e+00, 3.8158e+05,
        3.8174e+05, 3.8817e+05, 3.9321e+05, 4.0133e+05, 4.0309e+05, 4.0833e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 381724.4375, 381740.9688, 381744.5625, 381747.0312,
        381751.1250, 381752.0625, 381753.1875, 381755.0000, 381775.4688,
        381777.9375, 381780.3750, 760497.5000, 764491.2500, 770537.8125,
        770849.4375, 798639.6250, 806126.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 401281.8125, 401287.0625, 401288.1875, 401291.1562,
        401292.3750, 401293.8125, 401306.3750, 401312.0938, 401315.5312,
        401318.4688, 401325.0938, 770537.8125, 783646.9375, 793635.1875,
        804628.6875, 810265.6250, 816230.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.5633e-01, 9.8530e-01, 1.0294e+00, 1.0360e+00, 1.0520e+00,
        1.0572e+00, 1.0703e+00, 1.0709e+00, 1.1664e+00, 1.2721e+00, 3.8156e+05,
        3.8176e+05, 3.8815e+05, 3.9322e+05, 4.0132e+05, 4.0309e+05, 4.0834e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 381561.2500, 381562.6562, 381562.8125, 381563.2812,
        381563.9062, 381565.8750, 381571.3125, 381577.5000, 381584.8750,
        381591.2500, 381600.2188, 760497.5000, 767593.4375, 772810.1250,
        783577.1875, 783646.9375, 793053.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 403067.8750, 403068.3125, 403072.8438, 403083.8438,
        403085.6562, 403089.7500, 403090.4688, 403091.8750, 403092.6875,
        403093.6250, 403102.8438, 782244.5625, 783577.1875, 797068.7500,
        806126.2500, 810265.6250, 813082.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.6336e-01, 9.8009e-01, 1.0026e+00, 1.0089e+00, 1.0294e+00,
        1.0893e+00, 1.0933e+00, 1.0981e+00, 1.1860e+00, 1.3056e+00, 3.8158e+05,
        3.8175e+05, 3.8817e+05, 3.9320e+05, 4.0129e+05, 4.0309e+05, 4.0833e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393191.6250, 393196.3125, 393198.4688, 393204.6250,
        393207.2500, 393208.0938, 393208.2812, 393212.3750, 393213.2500,
        393218.9062, 393219.8750, 770849.4375, 772810.1250, 782244.5625,
        793635.1875, 797152.7500, 802299.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.6850e-01, 9.8009e-01, 1.0108e+00, 1.0360e+00, 1.0415e+00,
        1.0700e+00, 1.0717e+00, 1.1538e+00, 1.1713e+00, 1.2918e+00, 3.8160e+05,
        3.8175e+05, 3.8818e+05, 3.9319e+05, 4.0129e+05, 4.0309e+05, 4.0835e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.6314e-01, 8.9748e-01, 9.6407e-01, 9.6602e-01, 1.0520e+00,
        1.0717e+00, 1.0893e+00, 1.1201e+00, 1.2420e+00, 1.2537e+00, 3.8157e+05,
        3.8174e+05, 3.8817e+05, 3.9321e+05, 4.0132e+05, 4.0307e+05, 4.0831e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 408307.1875, 408319.2500, 408333.8125, 408334.6875,
        408337.5000, 408341.5312, 408342.7500, 408343.9688, 408345.7500,
        408349.0000, 408375.9375, 793053.3750, 796065.4375, 797152.7500,
        798639.6250, 813082.4375, 816230.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388152.6562, 388167.4688, 388169.3750, 388171.8438,
        388173.7500, 388174.2812, 388175.0000, 388176.5000, 388177.8750,
        388179.1562, 388189.7500, 764491.2500, 767593.4375, 796065.4375,
        797068.7500, 802299.6250, 804628.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.6407e-01, 9.8447e-01, 9.8530e-01, 9.9394e-01, 9.9779e-01,
        1.0089e+00, 1.0108e+00, 1.0574e+00, 1.1331e+00, 1.2045e+00, 3.8156e+05,
        3.8178e+05, 3.8817e+05, 3.9320e+05, 4.0129e+05, 4.0309e+05, 4.0834e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.6314e-01, 9.6370e-01, 9.6592e-01, 9.9394e-01, 1.0572e+00,
        1.0933e+00, 1.1229e+00, 1.1538e+00, 1.2724e+00, 1.3654e+00, 3.8156e+05,
        3.8175e+05, 3.8818e+05, 3.9322e+05, 4.0129e+05, 4.0307e+05, 4.0835e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.9779e-01, 1.0026e+00, 1.0160e+00, 1.0415e+00, 1.0703e+00,
        1.0786e+00, 1.1201e+00, 1.1229e+00, 1.1280e+00, 1.3088e+00, 3.8156e+05,
        3.8172e+05, 3.8819e+05, 3.9321e+05, 4.0131e+05, 4.0309e+05, 4.0832e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.9748e-01, 9.6592e-01, 1.1137e+00, 1.2045e+00, 1.2721e+00,
        1.2918e+00, 1.3056e+00, 1.3088e+00, 1.4828e+00, 1.5270e+00, 3.8156e+05,
        3.8178e+05, 3.8818e+05, 3.9320e+05, 4.0131e+05, 4.0307e+05, 4.0834e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34688.91', '34691.17', '34689.79', '381754.72', '401301.03', '34688.35', '381573.16', '403085.44', '34690.51', '393207.16', '34691.91', '34689.25', '408339.22', '388173.41', '34688.46', '34688.50', '34688.56', '34688.75']
estimated f for each client, fs: [7, 7, 7, 5, 5, 7, 5, 5, 7, 5, 7, 7, 5, 5, 7, 7, 7, 7]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0129s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:07...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:07, End: 2025-07-22 15:29:07)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.0923e+00, 1.2004e+00, 3.9910e+05, 3.8817e+05, 1.3211e+00,
         1.5444e+00, 3.9105e+05, 3.9064e+05, 1.1927e+00, 3.9260e+05, 1.1634e+00,
         1.2151e+00, 3.9757e+05, 3.8545e+05, 1.1117e+00, 1.3724e+00, 3.9279e+05,
         1.1831e+00],
        [1.0923e+00, 0.0000e+00, 1.1358e+00, 3.9910e+05, 3.8818e+05, 1.2749e+00,
         1.5112e+00, 3.9106e+05, 3.9063e+05, 1.1338e+00, 3.9257e+05, 1.1145e+00,
         1.2140e+00, 3.9755e+05, 3.8544e+05, 1.0739e+00, 1.2736e+00, 3.9277e+05,
         1.1161e+00],
        [1.2004e+00, 1.1358e+00, 0.0000e+00, 3.9909e+05, 3.8813e+05, 9.4816e-01,
         1.1649e+00, 3.9106e+05, 3.9065e+05, 1.0408e+00, 3.9259e+05, 9.8864e-01,
         9.7481e-01, 3.9756e+05, 3.8545e+05, 1.0147e+00, 1.0131e+00, 3.9280e+05,
         1.0665e+00],
        [3.9910e+05, 3.9910e+05, 3.9909e+05, 0.0000e+00, 7.8216e+05, 3.9910e+05,
         3.9909e+05, 7.9636e+05, 7.9756e+05, 3.9910e+05, 8.0071e+05, 3.9911e+05,
         3.9909e+05, 8.1103e+05, 7.7239e+05, 3.9912e+05, 3.9911e+05, 7.8585e+05,
         3.9909e+05],
        [3.8817e+05, 3.8818e+05, 3.8813e+05, 7.8216e+05, 0.0000e+00, 3.8812e+05,
         3.8815e+05, 7.9201e+05, 7.6314e+05, 3.8815e+05, 7.9915e+05, 3.8818e+05,
         3.8815e+05, 7.8641e+05, 7.6933e+05, 3.8817e+05, 3.8813e+05, 8.0632e+05,
         3.8819e+05],
        [1.3211e+00, 1.2749e+00, 9.4816e-01, 3.9910e+05, 3.8812e+05, 0.0000e+00,
         1.0286e+00, 3.9105e+05, 3.9064e+05, 1.1088e+00, 3.9258e+05, 1.1318e+00,
         8.2713e-01, 3.9756e+05, 3.8541e+05, 9.6146e-01, 8.6230e-01, 3.9279e+05,
         1.0782e+00],
        [1.5444e+00, 1.5112e+00, 1.1649e+00, 3.9909e+05, 3.8815e+05, 1.0286e+00,
         0.0000e+00, 3.9105e+05, 3.9066e+05, 1.3211e+00, 3.9258e+05, 1.3509e+00,
         1.0530e+00, 3.9756e+05, 3.8542e+05, 1.2395e+00, 1.0317e+00, 3.9281e+05,
         1.4084e+00],
        [3.9105e+05, 3.9106e+05, 3.9106e+05, 7.9636e+05, 7.9201e+05, 3.9105e+05,
         3.9105e+05, 0.0000e+00, 7.8928e+05, 3.9108e+05, 7.6986e+05, 3.9106e+05,
         3.9107e+05, 7.7419e+05, 7.7156e+05, 3.9108e+05, 3.9106e+05, 7.9511e+05,
         3.9107e+05],
        [3.9064e+05, 3.9063e+05, 3.9065e+05, 7.9756e+05, 7.6314e+05, 3.9064e+05,
         3.9066e+05, 7.8928e+05, 0.0000e+00, 3.9065e+05, 7.9611e+05, 3.9063e+05,
         3.9062e+05, 7.9829e+05, 7.8955e+05, 3.9063e+05, 3.9067e+05, 7.9060e+05,
         3.9063e+05],
        [1.1927e+00, 1.1338e+00, 1.0408e+00, 3.9910e+05, 3.8815e+05, 1.1088e+00,
         1.3211e+00, 3.9108e+05, 3.9065e+05, 0.0000e+00, 3.9254e+05, 1.0239e+00,
         1.0927e+00, 3.9755e+05, 3.8544e+05, 1.0671e+00, 1.1310e+00, 3.9281e+05,
         1.0515e+00],
        [3.9260e+05, 3.9257e+05, 3.9259e+05, 8.0071e+05, 7.9915e+05, 3.9258e+05,
         3.9258e+05, 7.6986e+05, 7.9611e+05, 3.9254e+05, 0.0000e+00, 3.9258e+05,
         3.9259e+05, 7.7831e+05, 7.7758e+05, 3.9258e+05, 3.9256e+05, 7.8417e+05,
         3.9256e+05],
        [1.1634e+00, 1.1145e+00, 9.8864e-01, 3.9911e+05, 3.8818e+05, 1.1318e+00,
         1.3509e+00, 3.9106e+05, 3.9063e+05, 1.0239e+00, 3.9258e+05, 0.0000e+00,
         1.0743e+00, 3.9758e+05, 3.8544e+05, 1.0396e+00, 1.1775e+00, 3.9279e+05,
         1.0802e+00],
        [1.2151e+00, 1.2140e+00, 9.7481e-01, 3.9909e+05, 3.8815e+05, 8.2713e-01,
         1.0530e+00, 3.9107e+05, 3.9062e+05, 1.0927e+00, 3.9259e+05, 1.0743e+00,
         0.0000e+00, 3.9758e+05, 3.8544e+05, 9.9453e-01, 8.8049e-01, 3.9278e+05,
         1.1519e+00],
        [3.9757e+05, 3.9755e+05, 3.9756e+05, 8.1103e+05, 7.8641e+05, 3.9756e+05,
         3.9756e+05, 7.7419e+05, 7.9829e+05, 3.9755e+05, 7.7831e+05, 3.9758e+05,
         3.9758e+05, 0.0000e+00, 7.8678e+05, 3.9757e+05, 3.9757e+05, 8.0025e+05,
         3.9755e+05],
        [3.8545e+05, 3.8544e+05, 3.8545e+05, 7.7239e+05, 7.6933e+05, 3.8541e+05,
         3.8542e+05, 7.7156e+05, 7.8955e+05, 3.8544e+05, 7.7758e+05, 3.8544e+05,
         3.8544e+05, 7.8678e+05, 0.0000e+00, 3.8544e+05, 3.8545e+05, 7.8202e+05,
         3.8545e+05],
        [1.1117e+00, 1.0739e+00, 1.0147e+00, 3.9912e+05, 3.8817e+05, 9.6146e-01,
         1.2395e+00, 3.9108e+05, 3.9063e+05, 1.0671e+00, 3.9258e+05, 1.0396e+00,
         9.9453e-01, 3.9757e+05, 3.8544e+05, 0.0000e+00, 1.0163e+00, 3.9280e+05,
         1.0454e+00],
        [1.3724e+00, 1.2736e+00, 1.0131e+00, 3.9911e+05, 3.8813e+05, 8.6230e-01,
         1.0317e+00, 3.9106e+05, 3.9067e+05, 1.1310e+00, 3.9256e+05, 1.1775e+00,
         8.8049e-01, 3.9757e+05, 3.8545e+05, 1.0163e+00, 0.0000e+00, 3.9281e+05,
         1.1463e+00],
        [3.9279e+05, 3.9277e+05, 3.9280e+05, 7.8585e+05, 8.0632e+05, 3.9279e+05,
         3.9281e+05, 7.9511e+05, 7.9060e+05, 3.9281e+05, 7.8417e+05, 3.9279e+05,
         3.9278e+05, 8.0025e+05, 7.8202e+05, 3.9280e+05, 3.9281e+05, 0.0000e+00,
         3.9282e+05],
        [1.1831e+00, 1.1161e+00, 1.0665e+00, 3.9909e+05, 3.8819e+05, 1.0782e+00,
         1.4084e+00, 3.9107e+05, 3.9063e+05, 1.0515e+00, 3.9256e+05, 1.0802e+00,
         1.1519e+00, 3.9755e+05, 3.8545e+05, 1.0454e+00, 1.1463e+00, 3.9282e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0923e+00, 1.1117e+00, 1.1634e+00, 1.1831e+00, 1.1927e+00,
        1.2004e+00, 1.2151e+00, 1.3211e+00, 1.3724e+00, 1.5444e+00, 3.8545e+05,
        3.8817e+05, 3.9064e+05, 3.9105e+05, 3.9260e+05, 3.9279e+05, 3.9757e+05,
        3.9910e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0739e+00, 1.0923e+00, 1.1145e+00, 1.1161e+00, 1.1338e+00,
        1.1358e+00, 1.2140e+00, 1.2736e+00, 1.2749e+00, 1.5112e+00, 3.8544e+05,
        3.8818e+05, 3.9063e+05, 3.9106e+05, 3.9257e+05, 3.9277e+05, 3.9755e+05,
        3.9910e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.4816e-01, 9.7481e-01, 9.8864e-01, 1.0131e+00, 1.0147e+00,
        1.0408e+00, 1.0665e+00, 1.1358e+00, 1.1649e+00, 1.2004e+00, 3.8545e+05,
        3.8813e+05, 3.9065e+05, 3.9106e+05, 3.9259e+05, 3.9280e+05, 3.9756e+05,
        3.9909e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 399085.0625, 399089.2500, 399089.3438, 399089.7188,
        399095.2812, 399099.8125, 399102.0000, 399103.0000, 399109.2500,
        399112.0938, 399120.6562, 772388.9375, 782159.9375, 785848.0625,
        796359.2500, 797564.8750, 800713.1875, 811027.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388122.6875, 388127.2188, 388131.5938, 388146.3750,
        388147.3125, 388151.6562, 388166.8125, 388168.7188, 388176.9688,
        388182.5312, 388190.5625, 763141.5625, 769332.6250, 782159.9375,
        786409.4375, 792008.0000, 799147.2500, 806322.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.2713e-01, 8.6230e-01, 9.4816e-01, 9.6146e-01, 1.0286e+00,
        1.0782e+00, 1.1088e+00, 1.1318e+00, 1.2749e+00, 1.3211e+00, 3.8541e+05,
        3.8812e+05, 3.9064e+05, 3.9105e+05, 3.9258e+05, 3.9279e+05, 3.9756e+05,
        3.9910e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0286e+00, 1.0317e+00, 1.0530e+00, 1.1649e+00, 1.2395e+00,
        1.3211e+00, 1.3509e+00, 1.4084e+00, 1.5112e+00, 1.5444e+00, 3.8542e+05,
        3.8815e+05, 3.9066e+05, 3.9105e+05, 3.9258e+05, 3.9281e+05, 3.9756e+05,
        3.9909e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391046.4688, 391046.8438, 391048.3125, 391058.6250,
        391060.0625, 391062.7500, 391063.5625, 391070.0312, 391074.2188,
        391080.8438, 391082.9062, 769856.7500, 771559.5000, 774192.0000,
        789281.1250, 792008.0000, 795108.4375, 796359.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 390623.1875, 390631.1875, 390631.9375, 390634.0938,
        390634.1875, 390635.5938, 390638.5938, 390650.9375, 390651.2188,
        390655.6875, 390667.1562, 763141.5625, 789281.1250, 789549.8125,
        790597.7500, 796112.5000, 797564.8750, 798291.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0239e+00, 1.0408e+00, 1.0515e+00, 1.0671e+00, 1.0927e+00,
        1.1088e+00, 1.1310e+00, 1.1338e+00, 1.1927e+00, 1.3211e+00, 3.8544e+05,
        3.8815e+05, 3.9065e+05, 3.9108e+05, 3.9254e+05, 3.9281e+05, 3.9755e+05,
        3.9910e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392541.7500, 392557.0938, 392558.1875, 392573.6875,
        392576.7500, 392577.1250, 392582.8125, 392584.0625, 392587.7188,
        392593.5625, 392601.4688, 769856.7500, 777579.6250, 778313.4375,
        784170.5625, 796112.5000, 799147.2500, 800713.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.8864e-01, 1.0239e+00, 1.0396e+00, 1.0743e+00, 1.0802e+00,
        1.1145e+00, 1.1318e+00, 1.1634e+00, 1.1775e+00, 1.3509e+00, 3.8544e+05,
        3.8818e+05, 3.9063e+05, 3.9106e+05, 3.9258e+05, 3.9279e+05, 3.9758e+05,
        3.9911e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.2713e-01, 8.8049e-01, 9.7481e-01, 9.9453e-01, 1.0530e+00,
        1.0743e+00, 1.0927e+00, 1.1519e+00, 1.2140e+00, 1.2151e+00, 3.8544e+05,
        3.8815e+05, 3.9062e+05, 3.9107e+05, 3.9259e+05, 3.9278e+05, 3.9758e+05,
        3.9909e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397546.2812, 397548.0000, 397549.7188, 397559.0000,
        397563.0312, 397564.0625, 397571.6250, 397573.9375, 397574.2188,
        397580.8125, 397582.0312, 774192.0000, 778313.4375, 786409.4375,
        786778.0000, 798291.6875, 800248.8750, 811027.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385408.8125, 385422.3438, 385435.7500, 385438.0312,
        385438.1562, 385440.4688, 385440.5625, 385446.9375, 385448.5000,
        385451.1562, 385454.8750, 769332.6250, 771559.5000, 772388.9375,
        777579.6250, 782023.9375, 786778.0000, 789549.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.6146e-01, 9.9453e-01, 1.0147e+00, 1.0163e+00, 1.0396e+00,
        1.0454e+00, 1.0671e+00, 1.0739e+00, 1.1117e+00, 1.2395e+00, 3.8544e+05,
        3.8817e+05, 3.9063e+05, 3.9108e+05, 3.9258e+05, 3.9280e+05, 3.9757e+05,
        3.9912e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.6230e-01, 8.8049e-01, 1.0131e+00, 1.0163e+00, 1.0317e+00,
        1.1310e+00, 1.1463e+00, 1.1775e+00, 1.2736e+00, 1.3724e+00, 3.8545e+05,
        3.8813e+05, 3.9067e+05, 3.9106e+05, 3.9256e+05, 3.9281e+05, 3.9757e+05,
        3.9911e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392768.0312, 392780.5938, 392787.9375, 392789.3750,
        392793.8125, 392797.0312, 392802.3750, 392805.6250, 392807.6562,
        392807.8125, 392815.3750, 782023.9375, 784170.5625, 785848.0625,
        790597.7500, 795108.4375, 800248.8750, 806322.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0454e+00, 1.0515e+00, 1.0665e+00, 1.0782e+00, 1.0802e+00,
        1.1161e+00, 1.1463e+00, 1.1519e+00, 1.1831e+00, 1.4084e+00, 3.8545e+05,
        3.8819e+05, 3.9063e+05, 3.9107e+05, 3.9256e+05, 3.9282e+05, 3.9755e+05,
        3.9909e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['35042.48', '35041.13', '35041.73', '399099.59', '388155.66', '35038.12', '35039.54', '391063.19', '390641.25', '35040.85', '392575.81', '35040.84', '35041.00', '397564.81', '385438.72', '35040.57', '35042.00', '392796.00', '35041.66']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 8, 6, 6, 8, 6, 8, 8, 6, 6, 8, 8, 6, 8]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0142s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:08...
global Accuracy on shared test data: 73.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:08, End: 2025-07-22 15:29:08)
start time is: 97092898275867, end time is: 97129900614569
The total time is: 37002338702ns.

 ------- aggregate method: rkrum, random_seed: 100 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 4.0125e+00, 3.3636e+00, 3.9171e+05, 3.8618e+05, 3.5539e+00,
         3.8668e+05, 3.9435e+05, 3.9612e+00, 3.9874e+05, 3.9647e+05, 3.9901e+05,
         3.1653e+00, 3.3506e+00, 3.9084e+05, 3.7143e+00, 3.2626e+00],
        [4.0125e+00, 0.0000e+00, 3.8335e+00, 3.9165e+05, 3.8611e+05, 4.4806e+00,
         3.8664e+05, 3.9436e+05, 3.9708e+00, 3.9867e+05, 3.9658e+05, 3.9905e+05,
         3.9714e+00, 3.5122e+00, 3.9080e+05, 4.0044e+00, 3.5721e+00],
        [3.3636e+00, 3.8335e+00, 0.0000e+00, 3.9166e+05, 3.8614e+05, 3.7089e+00,
         3.8672e+05, 3.9432e+05, 3.8068e+00, 3.9869e+05, 3.9654e+05, 3.9901e+05,
         3.4196e+00, 3.2075e+00, 3.9078e+05, 3.6277e+00, 3.5117e+00],
        [3.9171e+05, 3.9165e+05, 3.9166e+05, 0.0000e+00, 7.6534e+05, 3.9159e+05,
         7.7615e+05, 7.8658e+05, 3.9168e+05, 7.9318e+05, 7.9512e+05, 7.8578e+05,
         3.9168e+05, 3.9165e+05, 7.9598e+05, 3.9164e+05, 3.9161e+05],
        [3.8618e+05, 3.8611e+05, 3.8614e+05, 7.6534e+05, 0.0000e+00, 3.8609e+05,
         7.7898e+05, 7.7210e+05, 3.8614e+05, 7.9130e+05, 7.6628e+05, 7.8894e+05,
         3.8614e+05, 3.8616e+05, 7.4901e+05, 3.8613e+05, 3.8613e+05],
        [3.5539e+00, 4.4806e+00, 3.7089e+00, 3.9159e+05, 3.8609e+05, 0.0000e+00,
         3.8668e+05, 3.9437e+05, 4.0636e+00, 3.9872e+05, 3.9656e+05, 3.9902e+05,
         3.6410e+00, 3.7115e+00, 3.9085e+05, 3.7412e+00, 3.6968e+00],
        [3.8668e+05, 3.8664e+05, 3.8672e+05, 7.7615e+05, 7.7898e+05, 3.8668e+05,
         0.0000e+00, 7.7954e+05, 3.8667e+05, 8.0050e+05, 7.8527e+05, 8.1098e+05,
         3.8668e+05, 3.8670e+05, 7.6155e+05, 3.8659e+05, 3.8665e+05],
        [3.9435e+05, 3.9436e+05, 3.9432e+05, 7.8658e+05, 7.7210e+05, 3.9437e+05,
         7.7954e+05, 0.0000e+00, 3.9437e+05, 7.8914e+05, 7.5760e+05, 7.9456e+05,
         3.9434e+05, 3.9438e+05, 8.1949e+05, 3.9432e+05, 3.9434e+05],
        [3.9612e+00, 3.9708e+00, 3.8068e+00, 3.9168e+05, 3.8614e+05, 4.0636e+00,
         3.8667e+05, 3.9437e+05, 0.0000e+00, 3.9874e+05, 3.9650e+05, 3.9900e+05,
         3.7942e+00, 3.4208e+00, 3.9081e+05, 3.6522e+00, 3.6498e+00],
        [3.9874e+05, 3.9867e+05, 3.9869e+05, 7.9318e+05, 7.9130e+05, 3.9872e+05,
         8.0050e+05, 7.8914e+05, 3.9874e+05, 0.0000e+00, 7.8048e+05, 7.9703e+05,
         3.9872e+05, 3.9873e+05, 7.7821e+05, 3.9874e+05, 3.9866e+05],
        [3.9647e+05, 3.9658e+05, 3.9654e+05, 7.9512e+05, 7.6628e+05, 3.9656e+05,
         7.8527e+05, 7.5760e+05, 3.9650e+05, 7.8048e+05, 0.0000e+00, 7.8479e+05,
         3.9650e+05, 3.9655e+05, 7.7744e+05, 3.9647e+05, 3.9651e+05],
        [3.9901e+05, 3.9905e+05, 3.9901e+05, 7.8578e+05, 7.8894e+05, 3.9902e+05,
         8.1098e+05, 7.9456e+05, 3.9900e+05, 7.9703e+05, 7.8479e+05, 0.0000e+00,
         3.9899e+05, 3.9901e+05, 7.9900e+05, 3.9902e+05, 3.9898e+05],
        [3.1653e+00, 3.9714e+00, 3.4196e+00, 3.9168e+05, 3.8614e+05, 3.6410e+00,
         3.8668e+05, 3.9434e+05, 3.7942e+00, 3.9872e+05, 3.9650e+05, 3.9899e+05,
         0.0000e+00, 3.1926e+00, 3.9087e+05, 3.7692e+00, 3.3799e+00],
        [3.3506e+00, 3.5122e+00, 3.2075e+00, 3.9165e+05, 3.8616e+05, 3.7115e+00,
         3.8670e+05, 3.9438e+05, 3.4208e+00, 3.9873e+05, 3.9655e+05, 3.9901e+05,
         3.1926e+00, 0.0000e+00, 3.9083e+05, 3.8370e+00, 3.2057e+00],
        [3.9084e+05, 3.9080e+05, 3.9078e+05, 7.9598e+05, 7.4901e+05, 3.9085e+05,
         7.6155e+05, 8.1949e+05, 3.9081e+05, 7.7821e+05, 7.7744e+05, 7.9900e+05,
         3.9087e+05, 3.9083e+05, 0.0000e+00, 3.9082e+05, 3.9085e+05],
        [3.7143e+00, 4.0044e+00, 3.6277e+00, 3.9164e+05, 3.8613e+05, 3.7412e+00,
         3.8659e+05, 3.9432e+05, 3.6522e+00, 3.9874e+05, 3.9647e+05, 3.9902e+05,
         3.7692e+00, 3.8370e+00, 3.9082e+05, 0.0000e+00, 3.8134e+00],
        [3.2626e+00, 3.5721e+00, 3.5117e+00, 3.9161e+05, 3.8613e+05, 3.6968e+00,
         3.8665e+05, 3.9434e+05, 3.6498e+00, 3.9866e+05, 3.9651e+05, 3.9898e+05,
         3.3799e+00, 3.2057e+00, 3.9085e+05, 3.8134e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.1653e+00, 3.2626e+00, 3.3506e+00, 3.3636e+00, 3.5539e+00,
        3.7143e+00, 3.9612e+00, 4.0125e+00, 3.8618e+05, 3.8668e+05, 3.9084e+05,
        3.9171e+05, 3.9435e+05, 3.9647e+05, 3.9874e+05, 3.9901e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5122e+00, 3.5721e+00, 3.8335e+00, 3.9708e+00, 3.9714e+00,
        4.0044e+00, 4.0125e+00, 4.4806e+00, 3.8611e+05, 3.8664e+05, 3.9080e+05,
        3.9165e+05, 3.9436e+05, 3.9658e+05, 3.9867e+05, 3.9905e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2075e+00, 3.3636e+00, 3.4196e+00, 3.5117e+00, 3.6277e+00,
        3.7089e+00, 3.8068e+00, 3.8335e+00, 3.8614e+05, 3.8672e+05, 3.9078e+05,
        3.9166e+05, 3.9432e+05, 3.9654e+05, 3.9869e+05, 3.9901e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391590.8438, 391612.8125, 391641.2188, 391648.4375,
        391651.0312, 391657.7500, 391677.4062, 391681.2500, 391709.2500,
        765343.5625, 776150.6875, 785778.1250, 786581.8750, 793176.1875,
        795118.0000, 795977.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386088.6562, 386112.1250, 386130.0625, 386133.3438,
        386136.8125, 386139.7500, 386144.4375, 386162.0625, 386178.5000,
        749013.6875, 765343.5625, 766280.6875, 772095.6875, 778978.2500,
        788942.1875, 791300.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5539e+00, 3.6410e+00, 3.6968e+00, 3.7089e+00, 3.7115e+00,
        3.7412e+00, 4.0636e+00, 4.4806e+00, 3.8609e+05, 3.8668e+05, 3.9085e+05,
        3.9159e+05, 3.9437e+05, 3.9656e+05, 3.9872e+05, 3.9902e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386590.7188, 386642.8438, 386649.1562, 386665.7188,
        386676.5625, 386677.5312, 386681.2500, 386702.0625, 386715.8750,
        761549.3750, 776150.6875, 778978.2500, 779543.3750, 785267.2500,
        800497.3125, 810979.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394319.1250, 394323.6250, 394335.0938, 394339.1875,
        394353.6562, 394363.2500, 394368.6875, 394374.8438, 394377.4688,
        757598.5625, 772095.6875, 779543.3750, 786581.8750, 789137.5625,
        794558.5625, 819486.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4208e+00, 3.6498e+00, 3.6522e+00, 3.7942e+00, 3.8068e+00,
        3.9612e+00, 3.9708e+00, 4.0636e+00, 3.8614e+05, 3.8667e+05, 3.9081e+05,
        3.9168e+05, 3.9437e+05, 3.9650e+05, 3.9874e+05, 3.9900e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398664.1875, 398667.0625, 398691.4062, 398719.1562,
        398723.0312, 398727.2188, 398735.1562, 398739.0000, 398740.5312,
        778213.5000, 780482.1875, 789137.5625, 791300.5625, 793176.1875,
        797033.1250, 800497.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396465.7812, 396468.5000, 396495.8438, 396504.3438,
        396508.5938, 396537.5625, 396553.2500, 396555.7188, 396578.6875,
        757598.5625, 766280.6875, 777438.5000, 780482.1875, 784791.5000,
        785267.2500, 795118.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398984.4375, 398989.6875, 399002.8750, 399008.4688,
        399010.0000, 399014.1250, 399021.4375, 399023.4688, 399048.3125,
        784791.5000, 785778.1250, 788942.1875, 794558.5625, 797033.1250,
        798995.4375, 810979.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.1653e+00, 3.1926e+00, 3.3799e+00, 3.4196e+00, 3.6410e+00,
        3.7692e+00, 3.7942e+00, 3.9714e+00, 3.8614e+05, 3.8668e+05, 3.9087e+05,
        3.9168e+05, 3.9434e+05, 3.9650e+05, 3.9872e+05, 3.9899e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.1926e+00, 3.2057e+00, 3.2075e+00, 3.3506e+00, 3.4208e+00,
        3.5122e+00, 3.7115e+00, 3.8370e+00, 3.8616e+05, 3.8670e+05, 3.9083e+05,
        3.9165e+05, 3.9438e+05, 3.9655e+05, 3.9873e+05, 3.9901e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390779.6562, 390800.1250, 390808.4375, 390824.0938,
        390833.8125, 390838.7812, 390851.0938, 390851.1875, 390867.5938,
        749013.6875, 761549.3750, 777438.5000, 778213.5000, 795977.7500,
        798995.4375, 819486.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6277e+00, 3.6522e+00, 3.7143e+00, 3.7412e+00, 3.7692e+00,
        3.8134e+00, 3.8370e+00, 4.0044e+00, 3.8613e+05, 3.8659e+05, 3.9082e+05,
        3.9164e+05, 3.9432e+05, 3.9647e+05, 3.9874e+05, 3.9902e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.2057e+00, 3.2626e+00, 3.3799e+00, 3.5117e+00, 3.5721e+00,
        3.6498e+00, 3.6968e+00, 3.8134e+00, 3.8613e+05, 3.8665e+05, 3.9085e+05,
        3.9161e+05, 3.9434e+05, 3.9651e+05, 3.9866e+05, 3.9898e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77288.34', '77278.63', '77288.11', '429021.34', '422423.94', '77279.68', '424155.09', '430675.34', '77283.59', '436662.03', '432626.62', '437589.44', '77285.41', '77289.15', '426646.84', '77275.09', '77281.06']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 6, 6, 8, 6, 6, 6, 8, 8, 6, 8, 8]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0309s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:08...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:08, End: 2025-07-22 15:29:08)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 17, 20, 18, 8, 15, 4, 3, 13, 14, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 2.3075e+00, 3.9140e+05, 3.8794e+05, 3.9138e+05, 2.3983e+00,
         3.8817e+05, 2.1517e+00, 2.0755e+00, 3.9415e+05, 4.0021e+05, 3.7335e+05,
         2.3918e+00, 2.1612e+00],
        [2.3075e+00, 0.0000e+00, 3.9141e+05, 3.8787e+05, 3.9139e+05, 2.2143e+00,
         3.8815e+05, 2.0509e+00, 2.1165e+00, 3.9415e+05, 4.0021e+05, 3.7339e+05,
         2.1592e+00, 2.1133e+00],
        [3.9140e+05, 3.9141e+05, 0.0000e+00, 7.7821e+05, 7.5084e+05, 3.9139e+05,
         7.6288e+05, 3.9141e+05, 3.9142e+05, 7.8979e+05, 7.7675e+05, 7.5718e+05,
         3.9138e+05, 3.9135e+05],
        [3.8794e+05, 3.8787e+05, 7.7821e+05, 0.0000e+00, 7.8919e+05, 3.8792e+05,
         7.7679e+05, 3.8791e+05, 3.8793e+05, 7.6910e+05, 7.8297e+05, 7.8399e+05,
         3.8791e+05, 3.8792e+05],
        [3.9138e+05, 3.9139e+05, 7.5084e+05, 7.8919e+05, 0.0000e+00, 3.9136e+05,
         7.5859e+05, 3.9138e+05, 3.9134e+05, 7.6956e+05, 8.2111e+05, 7.6564e+05,
         3.9142e+05, 3.9137e+05],
        [2.3983e+00, 2.2143e+00, 3.9139e+05, 3.8792e+05, 3.9136e+05, 0.0000e+00,
         3.8813e+05, 2.1143e+00, 2.1268e+00, 3.9413e+05, 4.0022e+05, 3.7333e+05,
         2.2375e+00, 2.1661e+00],
        [3.8817e+05, 3.8815e+05, 7.6288e+05, 7.7679e+05, 7.5859e+05, 3.8813e+05,
         0.0000e+00, 3.8817e+05, 3.8818e+05, 7.9253e+05, 7.8796e+05, 7.5305e+05,
         3.8817e+05, 3.8816e+05],
        [2.1517e+00, 2.0509e+00, 3.9141e+05, 3.8791e+05, 3.9138e+05, 2.1143e+00,
         3.8817e+05, 0.0000e+00, 2.0316e+00, 3.9417e+05, 4.0019e+05, 3.7335e+05,
         2.0813e+00, 2.0434e+00],
        [2.0755e+00, 2.1165e+00, 3.9142e+05, 3.8793e+05, 3.9134e+05, 2.1268e+00,
         3.8818e+05, 2.0316e+00, 0.0000e+00, 3.9416e+05, 4.0022e+05, 3.7336e+05,
         2.4655e+00, 1.9875e+00],
        [3.9415e+05, 3.9415e+05, 7.8979e+05, 7.6910e+05, 7.6956e+05, 3.9413e+05,
         7.9253e+05, 3.9417e+05, 3.9416e+05, 0.0000e+00, 7.9222e+05, 7.7945e+05,
         3.9413e+05, 3.9413e+05],
        [4.0021e+05, 4.0021e+05, 7.7675e+05, 7.8297e+05, 8.2111e+05, 4.0022e+05,
         7.8796e+05, 4.0019e+05, 4.0022e+05, 7.9222e+05, 0.0000e+00, 7.7260e+05,
         4.0020e+05, 4.0021e+05],
        [3.7335e+05, 3.7339e+05, 7.5718e+05, 7.8399e+05, 7.6564e+05, 3.7333e+05,
         7.5305e+05, 3.7335e+05, 3.7336e+05, 7.7945e+05, 7.7260e+05, 0.0000e+00,
         3.7339e+05, 3.7335e+05],
        [2.3918e+00, 2.1592e+00, 3.9138e+05, 3.8791e+05, 3.9142e+05, 2.2375e+00,
         3.8817e+05, 2.0813e+00, 2.4655e+00, 3.9413e+05, 4.0020e+05, 3.7339e+05,
         0.0000e+00, 2.1757e+00],
        [2.1612e+00, 2.1133e+00, 3.9135e+05, 3.8792e+05, 3.9137e+05, 2.1661e+00,
         3.8816e+05, 2.0434e+00, 1.9875e+00, 3.9413e+05, 4.0021e+05, 3.7335e+05,
         2.1757e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 2.0755e+00, 2.1517e+00, 2.1612e+00, 2.3075e+00, 2.3918e+00,
        2.3983e+00, 3.7335e+05, 3.8794e+05, 3.8817e+05, 3.9138e+05, 3.9140e+05,
        3.9415e+05, 4.0021e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 2.0509e+00, 2.1133e+00, 2.1165e+00, 2.1592e+00, 2.2143e+00,
        2.3075e+00, 3.7339e+05, 3.8787e+05, 3.8815e+05, 3.9139e+05, 3.9141e+05,
        3.9415e+05, 4.0021e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391353.8125, 391384.2500, 391394.4062, 391403.6875,
        391408.1875, 391414.3125, 391415.8125, 750838.8125, 757175.7500,
        762876.5625, 776751.0000, 778213.0625, 789791.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387866.5938, 387906.2500, 387914.2500, 387918.5938,
        387923.7188, 387931.2188, 387938.6562, 769103.6875, 776787.3750,
        778213.0625, 782970.1250, 783992.5625, 789187.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391342.0312, 391361.7188, 391365.7188, 391376.6875,
        391377.5312, 391389.7812, 391415.9062, 750838.8125, 758593.1875,
        765636.5000, 769555.0000, 789187.8750, 821111.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 2.1143e+00, 2.1268e+00, 2.1661e+00, 2.2143e+00, 2.2375e+00,
        2.3983e+00, 3.7333e+05, 3.8792e+05, 3.8813e+05, 3.9136e+05, 3.9139e+05,
        3.9413e+05, 4.0022e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388127.4062, 388149.5625, 388156.0000, 388167.4062,
        388171.0938, 388174.0938, 388179.0938, 753051.8750, 758593.1875,
        762876.5625, 776787.3750, 787956.5000, 792534.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 2.0316e+00, 2.0434e+00, 2.0509e+00, 2.0813e+00, 2.1143e+00,
        2.1517e+00, 3.7335e+05, 3.8791e+05, 3.8817e+05, 3.9138e+05, 3.9141e+05,
        3.9417e+05, 4.0019e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.9875e+00, 2.0316e+00, 2.0755e+00, 2.1165e+00, 2.1268e+00,
        2.4655e+00, 3.7336e+05, 3.8793e+05, 3.8818e+05, 3.9134e+05, 3.9142e+05,
        3.9416e+05, 4.0022e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394128.3125, 394131.0625, 394134.4688, 394146.1562,
        394152.6562, 394164.8750, 394167.8750, 769103.6875, 769555.0000,
        779450.0625, 789791.3125, 792223.0000, 792534.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400187.8125, 400203.1875, 400208.1250, 400210.8750,
        400213.3125, 400217.3438, 400225.0000, 772595.0000, 776751.0000,
        782970.1250, 787956.5000, 792223.0000, 821111.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 373331.3125, 373346.5000, 373346.8438, 373352.1250,
        373362.6875, 373385.3125, 373391.5000, 753051.8750, 757175.7500,
        765636.5000, 772595.0000, 779450.0625, 783992.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 2.0813e+00, 2.1592e+00, 2.1757e+00, 2.2375e+00, 2.3918e+00,
        2.4655e+00, 3.7339e+05, 3.8791e+05, 3.8817e+05, 3.9138e+05, 3.9142e+05,
        3.9413e+05, 4.0020e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.9875e+00, 2.0434e+00, 2.1133e+00, 2.1612e+00, 2.1661e+00,
        2.1757e+00, 3.7335e+05, 3.8792e+05, 3.8816e+05, 3.9135e+05, 3.9137e+05,
        3.9413e+05, 4.0021e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['127719.07', '127713.40', '471976.56', '473476.72', '472117.94', '127710.62', '469863.28', '127716.36', '127720.64', '477520.41', '483423.56', '458193.75', '127719.56', '127714.89']
estimated f for each client, fs: [7, 7, 4, 5, 4, 7, 4, 7, 7, 4, 4, 6, 7, 7]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 17, 20, 18, 8, 15, 4, 3, 13, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:09...
global Accuracy on shared test data: 78.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 48 215]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:09, End: 2025-07-22 15:29:09)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 2, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.8265e+00, 3.8344e+05, 1.8863e+00, 1.8494e+00, 3.9515e+05,
         4.0032e+05, 2.1098e+00, 3.9773e+05, 1.7333e+00, 3.7509e+05, 3.8525e+05,
         1.9417e+00, 2.1173e+00, 1.9222e+00],
        [1.8265e+00, 0.0000e+00, 3.8345e+05, 1.8313e+00, 1.6942e+00, 3.9513e+05,
         4.0030e+05, 2.0856e+00, 3.9772e+05, 1.8604e+00, 3.7508e+05, 3.8524e+05,
         1.9156e+00, 1.9619e+00, 1.9514e+00],
        [3.8344e+05, 3.8345e+05, 0.0000e+00, 3.8346e+05, 3.8344e+05, 7.8498e+05,
         7.6954e+05, 3.8344e+05, 7.8770e+05, 3.8342e+05, 7.4431e+05, 7.8385e+05,
         3.8345e+05, 3.8345e+05, 3.8346e+05],
        [1.8863e+00, 1.8313e+00, 3.8346e+05, 0.0000e+00, 1.7661e+00, 3.9515e+05,
         4.0039e+05, 2.0481e+00, 3.9773e+05, 1.7930e+00, 3.7509e+05, 3.8523e+05,
         1.7221e+00, 1.9588e+00, 1.8744e+00],
        [1.8494e+00, 1.6942e+00, 3.8344e+05, 1.7661e+00, 0.0000e+00, 3.9516e+05,
         4.0034e+05, 1.8931e+00, 3.9773e+05, 1.8156e+00, 3.7512e+05, 3.8522e+05,
         1.6832e+00, 1.7921e+00, 1.8153e+00],
        [3.9515e+05, 3.9513e+05, 7.8498e+05, 3.9515e+05, 3.9516e+05, 0.0000e+00,
         8.0215e+05, 3.9517e+05, 7.9520e+05, 3.9517e+05, 7.7930e+05, 7.9343e+05,
         3.9515e+05, 3.9516e+05, 3.9517e+05],
        [4.0032e+05, 4.0030e+05, 7.6954e+05, 4.0039e+05, 4.0034e+05, 8.0215e+05,
         0.0000e+00, 4.0030e+05, 8.2496e+05, 4.0036e+05, 7.8338e+05, 7.7214e+05,
         4.0033e+05, 4.0034e+05, 4.0036e+05],
        [2.1098e+00, 2.0856e+00, 3.8344e+05, 2.0481e+00, 1.8931e+00, 3.9517e+05,
         4.0030e+05, 0.0000e+00, 3.9771e+05, 1.9991e+00, 3.7512e+05, 3.8526e+05,
         1.9885e+00, 1.8659e+00, 2.0685e+00],
        [3.9773e+05, 3.9772e+05, 7.8770e+05, 3.9773e+05, 3.9773e+05, 7.9520e+05,
         8.2496e+05, 3.9771e+05, 0.0000e+00, 3.9772e+05, 7.6289e+05, 7.8118e+05,
         3.9774e+05, 3.9774e+05, 3.9770e+05],
        [1.7333e+00, 1.8604e+00, 3.8342e+05, 1.7930e+00, 1.8156e+00, 3.9517e+05,
         4.0036e+05, 1.9991e+00, 3.9772e+05, 0.0000e+00, 3.7506e+05, 3.8525e+05,
         1.7562e+00, 1.8611e+00, 1.8172e+00],
        [3.7509e+05, 3.7508e+05, 7.4431e+05, 3.7509e+05, 3.7512e+05, 7.7930e+05,
         7.8338e+05, 3.7512e+05, 7.6289e+05, 3.7506e+05, 0.0000e+00, 7.6279e+05,
         3.7511e+05, 3.7506e+05, 3.7509e+05],
        [3.8525e+05, 3.8524e+05, 7.8385e+05, 3.8523e+05, 3.8522e+05, 7.9343e+05,
         7.7214e+05, 3.8526e+05, 7.8118e+05, 3.8525e+05, 7.6279e+05, 0.0000e+00,
         3.8522e+05, 3.8522e+05, 3.8527e+05],
        [1.9417e+00, 1.9156e+00, 3.8345e+05, 1.7221e+00, 1.6832e+00, 3.9515e+05,
         4.0033e+05, 1.9885e+00, 3.9774e+05, 1.7562e+00, 3.7511e+05, 3.8522e+05,
         0.0000e+00, 1.9485e+00, 1.8303e+00],
        [2.1173e+00, 1.9619e+00, 3.8345e+05, 1.9588e+00, 1.7921e+00, 3.9516e+05,
         4.0034e+05, 1.8659e+00, 3.9774e+05, 1.8611e+00, 3.7506e+05, 3.8522e+05,
         1.9485e+00, 0.0000e+00, 2.0125e+00],
        [1.9222e+00, 1.9514e+00, 3.8346e+05, 1.8744e+00, 1.8153e+00, 3.9517e+05,
         4.0036e+05, 2.0685e+00, 3.9770e+05, 1.8172e+00, 3.7509e+05, 3.8527e+05,
         1.8303e+00, 2.0125e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7333e+00, 1.8265e+00, 1.8494e+00, 1.8863e+00, 1.9222e+00,
        1.9417e+00, 2.1098e+00, 2.1173e+00, 3.7509e+05, 3.8344e+05, 3.8525e+05,
        3.9515e+05, 3.9773e+05, 4.0032e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6942e+00, 1.8265e+00, 1.8313e+00, 1.8604e+00, 1.9156e+00,
        1.9514e+00, 1.9619e+00, 2.0856e+00, 3.7508e+05, 3.8345e+05, 3.8524e+05,
        3.9513e+05, 3.9772e+05, 4.0030e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 383417.5938, 383436.0625, 383438.8438, 383440.0312,
        383445.7188, 383449.1875, 383453.7500, 383458.5938, 383464.0625,
        744309.9375, 769538.6250, 783851.1250, 784978.5000, 787700.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7221e+00, 1.7661e+00, 1.7930e+00, 1.8313e+00, 1.8744e+00,
        1.8863e+00, 1.9588e+00, 2.0481e+00, 3.7509e+05, 3.8346e+05, 3.8523e+05,
        3.9515e+05, 3.9773e+05, 4.0039e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6832e+00, 1.6942e+00, 1.7661e+00, 1.7921e+00, 1.8153e+00,
        1.8156e+00, 1.8494e+00, 1.8931e+00, 3.7512e+05, 3.8344e+05, 3.8522e+05,
        3.9516e+05, 3.9773e+05, 4.0034e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 395131.1562, 395145.6875, 395148.5000, 395151.4375,
        395160.0938, 395163.5625, 395172.6875, 395173.9062, 395174.3125,
        779295.6250, 784978.5000, 793425.2500, 795195.3750, 802146.9375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400302.4062, 400303.3750, 400319.7500, 400330.9375,
        400342.5000, 400343.1562, 400356.3438, 400358.9375, 400388.3750,
        769538.6250, 772144.1875, 783384.5000, 802146.9375, 824955.3750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.8659e+00, 1.8931e+00, 1.9885e+00, 1.9991e+00, 2.0481e+00,
        2.0685e+00, 2.0856e+00, 2.1098e+00, 3.7512e+05, 3.8344e+05, 3.8526e+05,
        3.9517e+05, 3.9771e+05, 4.0030e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397699.6562, 397713.5938, 397723.9688, 397724.4375,
        397725.2500, 397726.0312, 397726.1562, 397737.7500, 397744.2500,
        762891.3750, 781177.0000, 787700.7500, 795195.3750, 824955.3750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7333e+00, 1.7562e+00, 1.7930e+00, 1.8156e+00, 1.8172e+00,
        1.8604e+00, 1.8611e+00, 1.9991e+00, 3.7506e+05, 3.8342e+05, 3.8525e+05,
        3.9517e+05, 3.9772e+05, 4.0036e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 375062.9375, 375064.9375, 375082.3438, 375086.0000,
        375089.3438, 375092.1875, 375111.0938, 375118.7188, 375120.3438,
        744309.9375, 762790.2500, 762891.3750, 779295.6250, 783384.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 385217.1875, 385222.2812, 385224.2500, 385229.3438,
        385241.1250, 385245.8438, 385248.9688, 385261.6562, 385267.7188,
        762790.2500, 772144.1875, 781177.0000, 783851.1250, 793425.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6832e+00, 1.7221e+00, 1.7562e+00, 1.8303e+00, 1.9156e+00,
        1.9417e+00, 1.9485e+00, 1.9885e+00, 3.7511e+05, 3.8345e+05, 3.8522e+05,
        3.9515e+05, 3.9774e+05, 4.0033e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7921e+00, 1.8611e+00, 1.8659e+00, 1.9485e+00, 1.9588e+00,
        1.9619e+00, 2.0125e+00, 2.1173e+00, 3.7506e+05, 3.8345e+05, 3.8522e+05,
        3.9516e+05, 3.9774e+05, 4.0034e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.8153e+00, 1.8172e+00, 1.8303e+00, 1.8744e+00, 1.9222e+00,
        1.9514e+00, 2.0125e+00, 2.0685e+00, 3.7509e+05, 3.8346e+05, 3.8527e+05,
        3.9517e+05, 3.9770e+05, 4.0036e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['41677.93', '41677.50', '383444.88', '41678.56', '41681.45', '395157.91', '400338.41', '41681.82', '397724.56', '41675.51', '375092.00', '385239.84', '41680.65', '41675.39', '41678.30']
estimated f for each client, fs: [6, 6, 4, 6, 6, 4, 4, 6, 4, 6, 4, 4, 6, 6, 6]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']], selected_client_indices: [7, 2, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0098s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:09...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:09, End: 2025-07-22 15:29:09)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.8632e+05, 3.9378e+05, 1.5793e+00, 1.4987e+00, 3.8556e+05,
         3.8171e+05, 3.8834e+05, 1.5768e+00, 1.6743e+00, 3.8560e+05, 3.8894e+05,
         1.7090e+00, 1.5322e+00, 3.9111e+05, 1.9968e+00, 1.6526e+00],
        [3.8632e+05, 0.0000e+00, 7.6806e+05, 3.8630e+05, 3.8630e+05, 7.5921e+05,
         7.6815e+05, 7.6818e+05, 3.8631e+05, 3.8629e+05, 7.8524e+05, 7.8190e+05,
         3.8632e+05, 3.8629e+05, 7.7475e+05, 3.8628e+05, 3.8629e+05],
        [3.9378e+05, 7.6806e+05, 0.0000e+00, 3.9381e+05, 3.9378e+05, 7.9018e+05,
         7.7564e+05, 7.8967e+05, 3.9381e+05, 3.9380e+05, 7.9476e+05, 7.9547e+05,
         3.9379e+05, 3.9378e+05, 7.7771e+05, 3.9379e+05, 3.9382e+05],
        [1.5793e+00, 3.8630e+05, 3.9381e+05, 0.0000e+00, 1.5668e+00, 3.8554e+05,
         3.8172e+05, 3.8834e+05, 1.5811e+00, 1.8923e+00, 3.8559e+05, 3.8899e+05,
         1.5563e+00, 1.6175e+00, 3.9109e+05, 2.0246e+00, 1.6268e+00],
        [1.4987e+00, 3.8630e+05, 3.9378e+05, 1.5668e+00, 0.0000e+00, 3.8554e+05,
         3.8169e+05, 3.8835e+05, 1.6257e+00, 1.5942e+00, 3.8558e+05, 3.8899e+05,
         1.5227e+00, 1.4926e+00, 3.9110e+05, 1.8287e+00, 1.5779e+00],
        [3.8556e+05, 7.5921e+05, 7.9018e+05, 3.8554e+05, 3.8554e+05, 0.0000e+00,
         7.6779e+05, 7.5684e+05, 3.8556e+05, 3.8553e+05, 7.6966e+05, 7.6312e+05,
         3.8554e+05, 3.8555e+05, 7.6694e+05, 3.8554e+05, 3.8552e+05],
        [3.8171e+05, 7.6815e+05, 7.7564e+05, 3.8172e+05, 3.8169e+05, 7.6779e+05,
         0.0000e+00, 7.5410e+05, 3.8170e+05, 3.8172e+05, 7.6895e+05, 7.6754e+05,
         3.8172e+05, 3.8171e+05, 7.6594e+05, 3.8169e+05, 3.8170e+05],
        [3.8834e+05, 7.6818e+05, 7.8967e+05, 3.8834e+05, 3.8835e+05, 7.5684e+05,
         7.5410e+05, 0.0000e+00, 3.8832e+05, 3.8835e+05, 7.5842e+05, 7.7599e+05,
         3.8834e+05, 3.8833e+05, 8.0754e+05, 3.8838e+05, 3.8832e+05],
        [1.5768e+00, 3.8631e+05, 3.9381e+05, 1.5811e+00, 1.6257e+00, 3.8556e+05,
         3.8170e+05, 3.8832e+05, 0.0000e+00, 1.6540e+00, 3.8559e+05, 3.8894e+05,
         1.6281e+00, 1.6904e+00, 3.9112e+05, 2.0173e+00, 1.6387e+00],
        [1.6743e+00, 3.8629e+05, 3.9380e+05, 1.8923e+00, 1.5942e+00, 3.8553e+05,
         3.8172e+05, 3.8835e+05, 1.6540e+00, 0.0000e+00, 3.8561e+05, 3.8896e+05,
         1.8185e+00, 1.6004e+00, 3.9114e+05, 2.2000e+00, 1.5725e+00],
        [3.8560e+05, 7.8524e+05, 7.9476e+05, 3.8559e+05, 3.8558e+05, 7.6966e+05,
         7.6895e+05, 7.5842e+05, 3.8559e+05, 3.8561e+05, 0.0000e+00, 7.9476e+05,
         3.8561e+05, 3.8560e+05, 7.7797e+05, 3.8561e+05, 3.8560e+05],
        [3.8894e+05, 7.8190e+05, 7.9547e+05, 3.8899e+05, 3.8899e+05, 7.6312e+05,
         7.6754e+05, 7.7599e+05, 3.8894e+05, 3.8896e+05, 7.9476e+05, 0.0000e+00,
         3.8896e+05, 3.8894e+05, 7.8739e+05, 3.8899e+05, 3.8896e+05],
        [1.7090e+00, 3.8632e+05, 3.9379e+05, 1.5563e+00, 1.5227e+00, 3.8554e+05,
         3.8172e+05, 3.8834e+05, 1.6281e+00, 1.8185e+00, 3.8561e+05, 3.8896e+05,
         0.0000e+00, 1.6186e+00, 3.9110e+05, 2.0197e+00, 1.6476e+00],
        [1.5322e+00, 3.8629e+05, 3.9378e+05, 1.6175e+00, 1.4926e+00, 3.8555e+05,
         3.8171e+05, 3.8833e+05, 1.6904e+00, 1.6004e+00, 3.8560e+05, 3.8894e+05,
         1.6186e+00, 0.0000e+00, 3.9113e+05, 2.1501e+00, 1.5635e+00],
        [3.9111e+05, 7.7475e+05, 7.7771e+05, 3.9109e+05, 3.9110e+05, 7.6694e+05,
         7.6594e+05, 8.0754e+05, 3.9112e+05, 3.9114e+05, 7.7797e+05, 7.8739e+05,
         3.9110e+05, 3.9113e+05, 0.0000e+00, 3.9108e+05, 3.9111e+05],
        [1.9968e+00, 3.8628e+05, 3.9379e+05, 2.0246e+00, 1.8287e+00, 3.8554e+05,
         3.8169e+05, 3.8838e+05, 2.0173e+00, 2.2000e+00, 3.8561e+05, 3.8899e+05,
         2.0197e+00, 2.1501e+00, 3.9108e+05, 0.0000e+00, 2.0981e+00],
        [1.6526e+00, 3.8629e+05, 3.9382e+05, 1.6268e+00, 1.5779e+00, 3.8552e+05,
         3.8170e+05, 3.8832e+05, 1.6387e+00, 1.5725e+00, 3.8560e+05, 3.8896e+05,
         1.6476e+00, 1.5635e+00, 3.9111e+05, 2.0981e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4987e+00, 1.5322e+00, 1.5768e+00, 1.5793e+00, 1.6526e+00,
        1.6743e+00, 1.7090e+00, 1.9968e+00, 3.8171e+05, 3.8556e+05, 3.8560e+05,
        3.8632e+05, 3.8834e+05, 3.8894e+05, 3.9111e+05, 3.9378e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386276.8125, 386286.8125, 386287.9375, 386293.6250,
        386296.3125, 386301.5000, 386314.0625, 386315.2188, 386321.8125,
        759211.8750, 768056.1875, 768154.1875, 768179.3125, 774750.1250,
        781903.1250, 785240.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393778.3750, 393781.7812, 393784.0000, 393793.2500,
        393794.1875, 393800.0938, 393809.8750, 393814.3438, 393822.0312,
        768056.1875, 775643.7500, 777709.5000, 789672.6875, 790175.4375,
        794761.3750, 795472.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5563e+00, 1.5668e+00, 1.5793e+00, 1.5811e+00, 1.6175e+00,
        1.6268e+00, 1.8923e+00, 2.0246e+00, 3.8172e+05, 3.8554e+05, 3.8559e+05,
        3.8630e+05, 3.8834e+05, 3.8899e+05, 3.9109e+05, 3.9381e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4926e+00, 1.4987e+00, 1.5227e+00, 1.5668e+00, 1.5779e+00,
        1.5942e+00, 1.6257e+00, 1.8287e+00, 3.8169e+05, 3.8554e+05, 3.8558e+05,
        3.8630e+05, 3.8835e+05, 3.8899e+05, 3.9110e+05, 3.9378e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385523.4062, 385528.3438, 385535.4375, 385537.7500,
        385540.8125, 385541.8125, 385548.2500, 385556.7812, 385560.3750,
        756841.6875, 759211.8750, 763121.8125, 766937.7500, 767791.8125,
        769658.1250, 790175.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381687.9375, 381690.3750, 381696.5000, 381703.9375,
        381708.0938, 381713.9375, 381715.1875, 381721.1875, 381721.9062,
        754102.6250, 765935.2500, 767537.1875, 767791.8125, 768154.1875,
        768946.8750, 775643.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388315.6562, 388323.9688, 388325.2188, 388338.4375,
        388340.0938, 388340.8438, 388345.6562, 388353.9688, 388383.8438,
        754102.6250, 756841.6875, 758421.4375, 768179.3125, 775994.0000,
        789672.6875, 807543.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5768e+00, 1.5811e+00, 1.6257e+00, 1.6281e+00, 1.6387e+00,
        1.6540e+00, 1.6904e+00, 2.0173e+00, 3.8170e+05, 3.8556e+05, 3.8559e+05,
        3.8631e+05, 3.8832e+05, 3.8894e+05, 3.9112e+05, 3.9381e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5725e+00, 1.5942e+00, 1.6004e+00, 1.6540e+00, 1.6743e+00,
        1.8185e+00, 1.8923e+00, 2.2000e+00, 3.8172e+05, 3.8553e+05, 3.8561e+05,
        3.8629e+05, 3.8835e+05, 3.8896e+05, 3.9114e+05, 3.9380e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385577.1250, 385588.7500, 385593.1562, 385598.6250,
        385600.5312, 385604.6250, 385608.0938, 385608.7188, 385609.1875,
        758421.4375, 768946.8750, 769658.1250, 777969.8125, 785240.1875,
        794756.5000, 794761.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388942.2812, 388943.0625, 388944.4688, 388957.3125,
        388962.0312, 388964.2500, 388992.3438, 388993.4062, 388994.0312,
        763121.8125, 767537.1875, 775994.0000, 781903.1250, 787392.5000,
        794756.5000, 795472.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5227e+00, 1.5563e+00, 1.6186e+00, 1.6281e+00, 1.6476e+00,
        1.7090e+00, 1.8185e+00, 2.0197e+00, 3.8172e+05, 3.8554e+05, 3.8561e+05,
        3.8632e+05, 3.8834e+05, 3.8896e+05, 3.9110e+05, 3.9379e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4926e+00, 1.5322e+00, 1.5635e+00, 1.6004e+00, 1.6175e+00,
        1.6186e+00, 1.6904e+00, 2.1501e+00, 3.8171e+05, 3.8555e+05, 3.8560e+05,
        3.8629e+05, 3.8833e+05, 3.8894e+05, 3.9113e+05, 3.9378e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391080.7188, 391091.7500, 391100.9062, 391101.9688,
        391107.9688, 391111.6562, 391121.4688, 391128.9062, 391142.0625,
        765935.2500, 766937.7500, 774750.1250, 777709.5000, 777969.8125,
        787392.5000, 807543.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8287e+00, 1.9968e+00, 2.0173e+00, 2.0197e+00, 2.0246e+00,
        2.0981e+00, 2.1501e+00, 2.2000e+00, 3.8169e+05, 3.8554e+05, 3.8561e+05,
        3.8628e+05, 3.8838e+05, 3.8899e+05, 3.9108e+05, 3.9379e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5635e+00, 1.5725e+00, 1.5779e+00, 1.6268e+00, 1.6387e+00,
        1.6476e+00, 1.6526e+00, 2.0981e+00, 3.8170e+05, 3.8552e+05, 3.8560e+05,
        3.8629e+05, 3.8832e+05, 3.8896e+05, 3.9111e+05, 3.9382e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76728.39', '423590.56', '431223.38', '76726.62', '76724.39', '422671.47', '418946.16', '424917.00', '76727.77', '76726.41', '422881.00', '426381.50', '76727.64', '76726.95', '428592.25', '76723.97', '76723.34']
estimated f for each client, fs: [8, 6, 6, 8, 8, 6, 6, 6, 8, 8, 6, 6, 8, 8, 6, 8, 8]
selected_index: 16
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']], selected_client_indices: [2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0119s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:10...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:10, End: 2025-07-22 15:29:10)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.6920e+00, 1.8207e+00, 3.8111e+05, 4.0374e+05, 1.7867e+00,
         1.7590e+00, 3.9671e+05, 3.8425e+05, 1.9064e+00, 1.7475e+00, 1.7582e+00,
         4.0265e+05, 3.9626e+05, 1.5804e+00, 1.7957e+00, 3.7342e+05, 2.0386e+00,
         1.8901e+00],
        [1.6920e+00, 0.0000e+00, 1.6320e+00, 3.8117e+05, 4.0371e+05, 1.6759e+00,
         1.6401e+00, 3.9669e+05, 3.8424e+05, 1.7971e+00, 1.5772e+00, 1.7754e+00,
         4.0268e+05, 3.9625e+05, 1.7076e+00, 1.5795e+00, 3.7343e+05, 2.0828e+00,
         1.8899e+00],
        [1.8207e+00, 1.6320e+00, 0.0000e+00, 3.8113e+05, 4.0373e+05, 1.6598e+00,
         1.5714e+00, 3.9670e+05, 3.8425e+05, 1.8403e+00, 1.6670e+00, 1.7928e+00,
         4.0268e+05, 3.9629e+05, 1.7368e+00, 1.5589e+00, 3.7341e+05, 1.9591e+00,
         1.9061e+00],
        [3.8111e+05, 3.8117e+05, 3.8113e+05, 0.0000e+00, 7.7764e+05, 3.8113e+05,
         3.8109e+05, 7.6666e+05, 7.6465e+05, 3.8113e+05, 3.8110e+05, 3.8111e+05,
         8.1102e+05, 7.8240e+05, 3.8110e+05, 3.8114e+05, 7.6208e+05, 3.8115e+05,
         3.8109e+05],
        [4.0374e+05, 4.0371e+05, 4.0373e+05, 7.7764e+05, 0.0000e+00, 4.0372e+05,
         4.0368e+05, 7.7640e+05, 7.6721e+05, 4.0367e+05, 4.0370e+05, 4.0373e+05,
         8.2798e+05, 7.8282e+05, 4.0374e+05, 4.0368e+05, 7.9222e+05, 4.0368e+05,
         4.0369e+05],
        [1.7867e+00, 1.6759e+00, 1.6598e+00, 3.8113e+05, 4.0372e+05, 0.0000e+00,
         1.6414e+00, 3.9676e+05, 3.8426e+05, 1.7250e+00, 1.6216e+00, 1.9870e+00,
         4.0267e+05, 3.9627e+05, 1.6226e+00, 1.6959e+00, 3.7341e+05, 1.9048e+00,
         1.7982e+00],
        [1.7590e+00, 1.6401e+00, 1.5714e+00, 3.8109e+05, 4.0368e+05, 1.6414e+00,
         0.0000e+00, 3.9674e+05, 3.8428e+05, 1.6767e+00, 1.6827e+00, 1.6706e+00,
         4.0265e+05, 3.9630e+05, 1.5209e+00, 1.4987e+00, 3.7345e+05, 1.8006e+00,
         1.7367e+00],
        [3.9671e+05, 3.9669e+05, 3.9670e+05, 7.6666e+05, 7.7640e+05, 3.9676e+05,
         3.9674e+05, 0.0000e+00, 7.8170e+05, 3.9675e+05, 3.9673e+05, 3.9672e+05,
         8.0833e+05, 8.0737e+05, 3.9675e+05, 3.9674e+05, 7.6254e+05, 3.9675e+05,
         3.9669e+05],
        [3.8425e+05, 3.8424e+05, 3.8425e+05, 7.6465e+05, 7.6721e+05, 3.8426e+05,
         3.8428e+05, 7.8170e+05, 0.0000e+00, 3.8425e+05, 3.8424e+05, 3.8427e+05,
         7.9946e+05, 7.7221e+05, 3.8428e+05, 3.8427e+05, 7.4164e+05, 3.8422e+05,
         3.8424e+05],
        [1.9064e+00, 1.7971e+00, 1.8403e+00, 3.8113e+05, 4.0367e+05, 1.7250e+00,
         1.6767e+00, 3.9675e+05, 3.8425e+05, 0.0000e+00, 1.7221e+00, 1.7819e+00,
         4.0264e+05, 3.9628e+05, 1.7961e+00, 1.7775e+00, 3.7339e+05, 1.6885e+00,
         1.7790e+00],
        [1.7475e+00, 1.5772e+00, 1.6670e+00, 3.8110e+05, 4.0370e+05, 1.6216e+00,
         1.6827e+00, 3.9673e+05, 3.8424e+05, 1.7221e+00, 0.0000e+00, 1.7678e+00,
         4.0266e+05, 3.9626e+05, 1.6722e+00, 1.7569e+00, 3.7340e+05, 1.9499e+00,
         1.8569e+00],
        [1.7582e+00, 1.7754e+00, 1.7928e+00, 3.8111e+05, 4.0373e+05, 1.9870e+00,
         1.6706e+00, 3.9672e+05, 3.8427e+05, 1.7819e+00, 1.7678e+00, 0.0000e+00,
         4.0266e+05, 3.9625e+05, 1.9047e+00, 1.7064e+00, 3.7341e+05, 2.1293e+00,
         1.6960e+00],
        [4.0265e+05, 4.0268e+05, 4.0268e+05, 8.1102e+05, 8.2798e+05, 4.0267e+05,
         4.0265e+05, 8.0833e+05, 7.9946e+05, 4.0264e+05, 4.0266e+05, 4.0266e+05,
         0.0000e+00, 8.0628e+05, 4.0265e+05, 4.0269e+05, 7.8370e+05, 4.0264e+05,
         4.0267e+05],
        [3.9626e+05, 3.9625e+05, 3.9629e+05, 7.8240e+05, 7.8282e+05, 3.9627e+05,
         3.9630e+05, 8.0737e+05, 7.7221e+05, 3.9628e+05, 3.9626e+05, 3.9625e+05,
         8.0628e+05, 0.0000e+00, 3.9625e+05, 3.9626e+05, 7.4990e+05, 3.9627e+05,
         3.9624e+05],
        [1.5804e+00, 1.7076e+00, 1.7368e+00, 3.8110e+05, 4.0374e+05, 1.6226e+00,
         1.5209e+00, 3.9675e+05, 3.8428e+05, 1.7961e+00, 1.6722e+00, 1.9047e+00,
         4.0265e+05, 3.9625e+05, 0.0000e+00, 1.6243e+00, 3.7341e+05, 1.9600e+00,
         1.8340e+00],
        [1.7957e+00, 1.5795e+00, 1.5589e+00, 3.8114e+05, 4.0368e+05, 1.6959e+00,
         1.4987e+00, 3.9674e+05, 3.8427e+05, 1.7775e+00, 1.7569e+00, 1.7064e+00,
         4.0269e+05, 3.9626e+05, 1.6243e+00, 0.0000e+00, 3.7340e+05, 1.9964e+00,
         1.7648e+00],
        [3.7342e+05, 3.7343e+05, 3.7341e+05, 7.6208e+05, 7.9222e+05, 3.7341e+05,
         3.7345e+05, 7.6254e+05, 7.4164e+05, 3.7339e+05, 3.7340e+05, 3.7341e+05,
         7.8370e+05, 7.4990e+05, 3.7341e+05, 3.7340e+05, 0.0000e+00, 3.7340e+05,
         3.7340e+05],
        [2.0386e+00, 2.0828e+00, 1.9591e+00, 3.8115e+05, 4.0368e+05, 1.9048e+00,
         1.8006e+00, 3.9675e+05, 3.8422e+05, 1.6885e+00, 1.9499e+00, 2.1293e+00,
         4.0264e+05, 3.9627e+05, 1.9600e+00, 1.9964e+00, 3.7340e+05, 0.0000e+00,
         1.7559e+00],
        [1.8901e+00, 1.8899e+00, 1.9061e+00, 3.8109e+05, 4.0369e+05, 1.7982e+00,
         1.7367e+00, 3.9669e+05, 3.8424e+05, 1.7790e+00, 1.8569e+00, 1.6960e+00,
         4.0267e+05, 3.9624e+05, 1.8340e+00, 1.7648e+00, 3.7340e+05, 1.7559e+00,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5804e+00, 1.6920e+00, 1.7475e+00, 1.7582e+00, 1.7590e+00,
        1.7867e+00, 1.7957e+00, 1.8207e+00, 1.8901e+00, 1.9064e+00, 2.0386e+00,
        3.7342e+05, 3.8111e+05, 3.8425e+05, 3.9626e+05, 3.9671e+05, 4.0265e+05,
        4.0374e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5772e+00, 1.5795e+00, 1.6320e+00, 1.6401e+00, 1.6759e+00,
        1.6920e+00, 1.7076e+00, 1.7754e+00, 1.7971e+00, 1.8899e+00, 2.0828e+00,
        3.7343e+05, 3.8117e+05, 3.8424e+05, 3.9625e+05, 3.9669e+05, 4.0268e+05,
        4.0371e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5589e+00, 1.5714e+00, 1.6320e+00, 1.6598e+00, 1.6670e+00,
        1.7368e+00, 1.7928e+00, 1.8207e+00, 1.8403e+00, 1.9061e+00, 1.9591e+00,
        3.7341e+05, 3.8113e+05, 3.8425e+05, 3.9629e+05, 3.9670e+05, 4.0268e+05,
        4.0373e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 381087.5312, 381087.9375, 381099.0312, 381099.7812,
        381105.5312, 381112.5312, 381125.9375, 381127.6875, 381129.3750,
        381142.1250, 381146.5312, 381167.5000, 762078.0625, 764650.8750,
        766655.0000, 777640.0625, 782403.0000, 811022.6875])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 403669.8438, 403678.3438, 403680.0312, 403682.9688,
        403691.7812, 403700.4062, 403714.7812, 403722.1250, 403725.9688,
        403726.1875, 403736.0000, 403739.1250, 767207.3125, 776404.6875,
        777640.0625, 782822.5000, 792222.7500, 827980.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.6216e+00, 1.6226e+00, 1.6414e+00, 1.6598e+00, 1.6759e+00,
        1.6959e+00, 1.7250e+00, 1.7867e+00, 1.7982e+00, 1.9048e+00, 1.9870e+00,
        3.7341e+05, 3.8113e+05, 3.8426e+05, 3.9627e+05, 3.9676e+05, 4.0267e+05,
        4.0372e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4987e+00, 1.5209e+00, 1.5714e+00, 1.6401e+00, 1.6414e+00,
        1.6706e+00, 1.6767e+00, 1.6827e+00, 1.7367e+00, 1.7590e+00, 1.8006e+00,
        3.7345e+05, 3.8109e+05, 3.8428e+05, 3.9630e+05, 3.9674e+05, 4.0265e+05,
        4.0368e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396690.9688, 396692.4688, 396704.9375, 396706.9688,
        396716.4062, 396728.8125, 396738.9375, 396742.6875, 396748.1875,
        396750.3750, 396750.8125, 396755.0312, 762543.0000, 766655.0000,
        776404.6875, 781699.2500, 807373.6250, 808332.3750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 384215.0000, 384236.5938, 384238.5625, 384243.6250,
        384245.3438, 384245.3438, 384253.5625, 384263.5312, 384268.9062,
        384271.1562, 384280.6562, 384280.9375, 741643.1250, 764650.8750,
        767207.3125, 772208.5625, 781699.2500, 799461.0000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.6767e+00, 1.6885e+00, 1.7221e+00, 1.7250e+00, 1.7775e+00,
        1.7790e+00, 1.7819e+00, 1.7961e+00, 1.7971e+00, 1.8403e+00, 1.9064e+00,
        3.7339e+05, 3.8113e+05, 3.8425e+05, 3.9628e+05, 3.9675e+05, 4.0264e+05,
        4.0367e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5772e+00, 1.6216e+00, 1.6670e+00, 1.6722e+00, 1.6827e+00,
        1.7221e+00, 1.7475e+00, 1.7569e+00, 1.7678e+00, 1.8569e+00, 1.9499e+00,
        3.7340e+05, 3.8110e+05, 3.8424e+05, 3.9626e+05, 3.9673e+05, 4.0266e+05,
        4.0370e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6706e+00, 1.6960e+00, 1.7064e+00, 1.7582e+00, 1.7678e+00,
        1.7754e+00, 1.7819e+00, 1.7928e+00, 1.9047e+00, 1.9870e+00, 2.1293e+00,
        3.7341e+05, 3.8111e+05, 3.8427e+05, 3.9625e+05, 3.9672e+05, 4.0266e+05,
        4.0373e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 402636.4062, 402643.7500, 402647.4375, 402650.1250,
        402652.7812, 402656.1875, 402664.4688, 402670.4375, 402672.9375,
        402676.1875, 402680.8750, 402691.3125, 783702.5000, 799461.0000,
        806278.6250, 808332.3750, 811022.6875, 827980.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 396243.8125, 396247.8750, 396249.6562, 396253.5625,
        396258.7812, 396259.1562, 396260.4688, 396272.1250, 396274.5000,
        396282.1250, 396292.5312, 396297.2188, 749901.2500, 772208.5625,
        782403.0000, 782822.5000, 806278.6250, 807373.6250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.5209e+00, 1.5804e+00, 1.6226e+00, 1.6243e+00, 1.6722e+00,
        1.7076e+00, 1.7368e+00, 1.7961e+00, 1.8340e+00, 1.9047e+00, 1.9600e+00,
        3.7341e+05, 3.8110e+05, 3.8428e+05, 3.9625e+05, 3.9675e+05, 4.0265e+05,
        4.0374e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4987e+00, 1.5589e+00, 1.5795e+00, 1.6243e+00, 1.6959e+00,
        1.7064e+00, 1.7569e+00, 1.7648e+00, 1.7775e+00, 1.7957e+00, 1.9964e+00,
        3.7340e+05, 3.8114e+05, 3.8427e+05, 3.9626e+05, 3.9674e+05, 4.0269e+05,
        4.0368e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 373391.8750, 373395.9688, 373396.5000, 373397.3750,
        373399.6250, 373407.8438, 373410.0625, 373411.0000, 373411.0312,
        373415.9375, 373432.4375, 373451.2500, 741643.1250, 749901.2500,
        762078.0625, 762543.0000, 783702.5000, 792222.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.6885e+00, 1.7559e+00, 1.8006e+00, 1.9048e+00, 1.9499e+00,
        1.9591e+00, 1.9600e+00, 1.9964e+00, 2.0386e+00, 2.0828e+00, 2.1293e+00,
        3.7340e+05, 3.8115e+05, 3.8422e+05, 3.9627e+05, 3.9675e+05, 4.0264e+05,
        4.0368e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6960e+00, 1.7367e+00, 1.7559e+00, 1.7648e+00, 1.7790e+00,
        1.7982e+00, 1.8340e+00, 1.8569e+00, 1.8899e+00, 1.8901e+00, 1.9061e+00,
        3.7340e+05, 3.8109e+05, 3.8424e+05, 3.9624e+05, 3.9669e+05, 4.0267e+05,
        4.0369e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['1.80', '1.73', '1.74', '381119.34', '403705.62', '1.74', '1.65', '396727.22', '384253.59', '1.77', '1.73', '1.82', '402661.91', '396266.00', '1.72', '1.70', '373410.09', '1.93', '1.81']
estimated f for each client, fs: [7, 7, 7, 5, 5, 7, 7, 5, 5, 7, 7, 7, 5, 5, 7, 7, 5, 7, 7]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0230s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:11...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:11, End: 2025-07-22 15:29:11)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.5492e+00, 3.9630e+05, 3.9280e+05, 1.6662e+00, 1.7577e+00,
         3.7861e+05, 3.8523e+05, 3.9164e+05, 1.5604e+00, 1.7515e+00, 3.8288e+05,
         3.9767e+05, 1.6601e+00, 1.5432e+00, 3.9543e+05, 2.0109e+00, 1.7303e+00],
        [1.5492e+00, 0.0000e+00, 3.9630e+05, 3.9279e+05, 1.5882e+00, 1.6923e+00,
         3.7860e+05, 3.8525e+05, 3.9161e+05, 1.6284e+00, 1.6799e+00, 3.8287e+05,
         3.9761e+05, 1.6971e+00, 1.4535e+00, 3.9545e+05, 1.8085e+00, 1.7207e+00],
        [3.9630e+05, 3.9630e+05, 0.0000e+00, 7.8832e+05, 3.9629e+05, 3.9628e+05,
         7.7301e+05, 7.8664e+05, 8.1844e+05, 3.9631e+05, 3.9630e+05, 7.9053e+05,
         8.0418e+05, 3.9627e+05, 3.9630e+05, 7.8284e+05, 3.9629e+05, 3.9626e+05],
        [3.9280e+05, 3.9279e+05, 7.8832e+05, 0.0000e+00, 3.9282e+05, 3.9282e+05,
         7.7794e+05, 7.8621e+05, 7.8290e+05, 3.9278e+05, 3.9278e+05, 7.7714e+05,
         8.2177e+05, 3.9279e+05, 3.9281e+05, 7.8838e+05, 3.9279e+05, 3.9280e+05],
        [1.6662e+00, 1.5882e+00, 3.9629e+05, 3.9282e+05, 0.0000e+00, 1.7301e+00,
         3.7861e+05, 3.8526e+05, 3.9159e+05, 1.5908e+00, 1.8856e+00, 3.8288e+05,
         3.9762e+05, 1.5550e+00, 1.5782e+00, 3.9543e+05, 1.8081e+00, 1.6789e+00],
        [1.7577e+00, 1.6923e+00, 3.9628e+05, 3.9282e+05, 1.7301e+00, 0.0000e+00,
         3.7862e+05, 3.8525e+05, 3.9160e+05, 1.7483e+00, 1.7110e+00, 3.8287e+05,
         3.9765e+05, 1.6787e+00, 1.5383e+00, 3.9546e+05, 1.6081e+00, 1.5481e+00],
        [3.7861e+05, 3.7860e+05, 7.7301e+05, 7.7794e+05, 3.7861e+05, 3.7862e+05,
         0.0000e+00, 7.6095e+05, 7.6840e+05, 3.7863e+05, 3.7859e+05, 7.5916e+05,
         7.7519e+05, 3.7862e+05, 3.7863e+05, 7.9058e+05, 3.7858e+05, 3.7861e+05],
        [3.8523e+05, 3.8525e+05, 7.8664e+05, 7.8621e+05, 3.8526e+05, 3.8525e+05,
         7.6095e+05, 0.0000e+00, 7.7788e+05, 3.8523e+05, 3.8523e+05, 7.8467e+05,
         7.8192e+05, 3.8524e+05, 3.8524e+05, 7.9182e+05, 3.8525e+05, 3.8528e+05],
        [3.9164e+05, 3.9161e+05, 8.1844e+05, 7.8290e+05, 3.9159e+05, 3.9160e+05,
         7.6840e+05, 7.7788e+05, 0.0000e+00, 3.9162e+05, 3.9160e+05, 7.9633e+05,
         7.8105e+05, 3.9161e+05, 3.9161e+05, 7.9666e+05, 3.9161e+05, 3.9163e+05],
        [1.5604e+00, 1.6284e+00, 3.9631e+05, 3.9278e+05, 1.5908e+00, 1.7483e+00,
         3.7863e+05, 3.8523e+05, 3.9162e+05, 0.0000e+00, 1.6899e+00, 3.8293e+05,
         3.9763e+05, 1.6289e+00, 1.6691e+00, 3.9541e+05, 1.8501e+00, 1.6583e+00],
        [1.7515e+00, 1.6799e+00, 3.9630e+05, 3.9278e+05, 1.8856e+00, 1.7110e+00,
         3.7859e+05, 3.8523e+05, 3.9160e+05, 1.6899e+00, 0.0000e+00, 3.8289e+05,
         3.9761e+05, 1.8101e+00, 1.6350e+00, 3.9544e+05, 2.0984e+00, 1.5356e+00],
        [3.8288e+05, 3.8287e+05, 7.9053e+05, 7.7714e+05, 3.8288e+05, 3.8287e+05,
         7.5916e+05, 7.8467e+05, 7.9633e+05, 3.8293e+05, 3.8289e+05, 0.0000e+00,
         7.8863e+05, 3.8292e+05, 3.8291e+05, 7.7171e+05, 3.8289e+05, 3.8289e+05],
        [3.9767e+05, 3.9761e+05, 8.0418e+05, 8.2177e+05, 3.9762e+05, 3.9765e+05,
         7.7519e+05, 7.8192e+05, 7.8105e+05, 3.9763e+05, 3.9761e+05, 7.8863e+05,
         0.0000e+00, 3.9765e+05, 3.9765e+05, 7.7426e+05, 3.9759e+05, 3.9763e+05],
        [1.6601e+00, 1.6971e+00, 3.9627e+05, 3.9279e+05, 1.5550e+00, 1.6787e+00,
         3.7862e+05, 3.8524e+05, 3.9161e+05, 1.6289e+00, 1.8101e+00, 3.8292e+05,
         3.9765e+05, 0.0000e+00, 1.5543e+00, 3.9541e+05, 1.8948e+00, 1.6700e+00],
        [1.5432e+00, 1.4535e+00, 3.9630e+05, 3.9281e+05, 1.5782e+00, 1.5383e+00,
         3.7863e+05, 3.8524e+05, 3.9161e+05, 1.6691e+00, 1.6350e+00, 3.8291e+05,
         3.9765e+05, 1.5543e+00, 0.0000e+00, 3.9547e+05, 1.8542e+00, 1.6006e+00],
        [3.9543e+05, 3.9545e+05, 7.8284e+05, 7.8838e+05, 3.9543e+05, 3.9546e+05,
         7.9058e+05, 7.9182e+05, 7.9666e+05, 3.9541e+05, 3.9544e+05, 7.7171e+05,
         7.7426e+05, 3.9541e+05, 3.9547e+05, 0.0000e+00, 3.9546e+05, 3.9543e+05],
        [2.0109e+00, 1.8085e+00, 3.9629e+05, 3.9279e+05, 1.8081e+00, 1.6081e+00,
         3.7858e+05, 3.8525e+05, 3.9161e+05, 1.8501e+00, 2.0984e+00, 3.8289e+05,
         3.9759e+05, 1.8948e+00, 1.8542e+00, 3.9546e+05, 0.0000e+00, 1.6496e+00],
        [1.7303e+00, 1.7207e+00, 3.9626e+05, 3.9280e+05, 1.6789e+00, 1.5481e+00,
         3.7861e+05, 3.8528e+05, 3.9163e+05, 1.6583e+00, 1.5356e+00, 3.8289e+05,
         3.9763e+05, 1.6700e+00, 1.6006e+00, 3.9543e+05, 1.6496e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5432e+00, 1.5492e+00, 1.5604e+00, 1.6601e+00, 1.6662e+00,
        1.7303e+00, 1.7515e+00, 1.7577e+00, 2.0109e+00, 3.7861e+05, 3.8288e+05,
        3.8523e+05, 3.9164e+05, 3.9280e+05, 3.9543e+05, 3.9630e+05, 3.9767e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4535e+00, 1.5492e+00, 1.5882e+00, 1.6284e+00, 1.6799e+00,
        1.6923e+00, 1.6971e+00, 1.7207e+00, 1.8085e+00, 3.7860e+05, 3.8287e+05,
        3.8525e+05, 3.9161e+05, 3.9279e+05, 3.9545e+05, 3.9630e+05, 3.9761e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396261.9375, 396267.0312, 396281.7500, 396291.0625,
        396294.3125, 396296.8125, 396301.0000, 396303.4062, 396304.0938,
        396307.9688, 773011.8750, 782838.7500, 786638.3750, 788320.8750,
        790533.5625, 804179.0000, 818439.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392776.0625, 392784.4688, 392789.5312, 392790.5938,
        392793.3438, 392795.3125, 392803.7188, 392805.0312, 392819.2500,
        392820.5938, 777143.7500, 777942.4375, 782897.2500, 786213.6875,
        788320.8750, 788383.8750, 821770.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5550e+00, 1.5782e+00, 1.5882e+00, 1.5908e+00, 1.6662e+00,
        1.6789e+00, 1.7301e+00, 1.8081e+00, 1.8856e+00, 3.7861e+05, 3.8288e+05,
        3.8526e+05, 3.9159e+05, 3.9282e+05, 3.9543e+05, 3.9629e+05, 3.9762e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5383e+00, 1.5481e+00, 1.6081e+00, 1.6787e+00, 1.6923e+00,
        1.7110e+00, 1.7301e+00, 1.7483e+00, 1.7577e+00, 3.7862e+05, 3.8287e+05,
        3.8525e+05, 3.9160e+05, 3.9282e+05, 3.9546e+05, 3.9628e+05, 3.9765e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 378581.6875, 378593.0625, 378600.2188, 378608.2812,
        378610.7812, 378611.0938, 378615.8125, 378622.5625, 378625.6562,
        378630.7500, 759159.1250, 760949.5000, 768395.7500, 773011.8750,
        775187.6250, 777942.4375, 790580.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385227.2500, 385227.4062, 385231.6875, 385238.5000,
        385243.3438, 385245.7188, 385251.4375, 385252.5625, 385259.5625,
        385284.3125, 760949.5000, 777880.9375, 781917.2500, 784669.1875,
        786213.6875, 786638.3750, 791818.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391594.7812, 391598.2188, 391598.2500, 391605.6562,
        391607.3750, 391609.1875, 391613.5938, 391617.8438, 391625.0312,
        391638.9375, 768395.7500, 777880.9375, 781048.5625, 782897.2500,
        796333.5000, 796659.1875, 818439.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5604e+00, 1.5908e+00, 1.6284e+00, 1.6289e+00, 1.6583e+00,
        1.6691e+00, 1.6899e+00, 1.7483e+00, 1.8501e+00, 3.7863e+05, 3.8293e+05,
        3.8523e+05, 3.9162e+05, 3.9278e+05, 3.9541e+05, 3.9631e+05, 3.9763e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5356e+00, 1.6350e+00, 1.6799e+00, 1.6899e+00, 1.7110e+00,
        1.7515e+00, 1.8101e+00, 1.8856e+00, 2.0984e+00, 3.7859e+05, 3.8289e+05,
        3.8523e+05, 3.9160e+05, 3.9278e+05, 3.9544e+05, 3.9630e+05, 3.9761e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382868.1875, 382870.7812, 382880.4375, 382881.7188,
        382889.6562, 382893.1250, 382893.3125, 382914.1875, 382923.4688,
        382926.6250, 759159.1250, 771709.1875, 777143.7500, 784669.1875,
        788630.6875, 790533.5625, 796333.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397591.1875, 397613.8750, 397614.8438, 397618.2812,
        397629.6875, 397630.9375, 397646.2500, 397648.9375, 397654.1875,
        397674.7812, 774264.3125, 775187.6250, 781048.5625, 781917.2500,
        788630.6875, 804179.0000, 821770.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5543e+00, 1.5550e+00, 1.6289e+00, 1.6601e+00, 1.6700e+00,
        1.6787e+00, 1.6971e+00, 1.8101e+00, 1.8948e+00, 3.7862e+05, 3.8292e+05,
        3.8524e+05, 3.9161e+05, 3.9279e+05, 3.9541e+05, 3.9627e+05, 3.9765e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4535e+00, 1.5383e+00, 1.5432e+00, 1.5543e+00, 1.5782e+00,
        1.6006e+00, 1.6350e+00, 1.6691e+00, 1.8542e+00, 3.7863e+05, 3.8291e+05,
        3.8524e+05, 3.9161e+05, 3.9281e+05, 3.9547e+05, 3.9630e+05, 3.9765e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395407.4062, 395412.3750, 395426.0312, 395432.0000,
        395434.0000, 395435.4375, 395452.9062, 395457.4062, 395461.8750,
        395471.5312, 771709.1875, 774264.3125, 782838.7500, 788383.8750,
        790580.5000, 791818.8125, 796659.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6081e+00, 1.6496e+00, 1.8081e+00, 1.8085e+00, 1.8501e+00,
        1.8542e+00, 1.8948e+00, 2.0109e+00, 2.0984e+00, 3.7858e+05, 3.8289e+05,
        3.8525e+05, 3.9161e+05, 3.9279e+05, 3.9546e+05, 3.9629e+05, 3.9759e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5356e+00, 1.5481e+00, 1.6006e+00, 1.6496e+00, 1.6583e+00,
        1.6700e+00, 1.6789e+00, 1.7207e+00, 1.7303e+00, 3.7861e+05, 3.8289e+05,
        3.8528e+05, 3.9163e+05, 3.9280e+05, 3.9543e+05, 3.9626e+05, 3.9763e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['69227.98', '69225.73', '430538.28', '427738.31', '69227.88', '69228.03', '413205.38', '419401.00', '425864.00', '69233.85', '69227.46', '417100.03', '431871.50', '69232.22', '69232.20', '429645.44', '69226.48', '69228.43']
estimated f for each client, fs: [8, 8, 6, 6, 8, 8, 7, 6, 6, 8, 8, 6, 6, 8, 8, 6, 8, 8]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0129s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:11...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:11, End: 2025-07-22 15:29:11)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 11, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.8876e+00, 3.9157e+05, 1.6679e+00, 1.7685e+00, 3.8681e+05,
         1.8020e+00, 4.0391e+05, 1.7071e+00, 1.7400e+00, 1.5451e+00, 1.7046e+00,
         3.9538e+05, 2.0469e+00, 1.7198e+00],
        [1.8876e+00, 0.0000e+00, 3.9158e+05, 1.8183e+00, 1.5954e+00, 3.8680e+05,
         1.8709e+00, 4.0390e+05, 1.8648e+00, 1.8182e+00, 1.9093e+00, 1.6994e+00,
         3.9541e+05, 1.7518e+00, 1.7400e+00],
        [3.9157e+05, 3.9158e+05, 0.0000e+00, 3.9159e+05, 3.9158e+05, 7.7853e+05,
         3.9157e+05, 8.1849e+05, 3.9158e+05, 3.9157e+05, 3.9162e+05, 3.9155e+05,
         7.8041e+05, 3.9157e+05, 3.9159e+05],
        [1.6679e+00, 1.8183e+00, 3.9159e+05, 0.0000e+00, 1.6885e+00, 3.8684e+05,
         1.7662e+00, 4.0394e+05, 1.6973e+00, 1.9599e+00, 1.6032e+00, 1.7510e+00,
         3.9541e+05, 1.8796e+00, 1.6510e+00],
        [1.7685e+00, 1.5954e+00, 3.9158e+05, 1.6885e+00, 0.0000e+00, 3.8682e+05,
         1.6121e+00, 4.0392e+05, 1.7630e+00, 1.7697e+00, 1.6323e+00, 1.6498e+00,
         3.9542e+05, 1.6503e+00, 1.5534e+00],
        [3.8681e+05, 3.8680e+05, 7.7853e+05, 3.8684e+05, 3.8682e+05, 0.0000e+00,
         3.8684e+05, 7.7982e+05, 3.8685e+05, 3.8686e+05, 3.8681e+05, 3.8681e+05,
         8.1962e+05, 3.8680e+05, 3.8683e+05],
        [1.8020e+00, 1.8709e+00, 3.9157e+05, 1.7662e+00, 1.6121e+00, 3.8684e+05,
         0.0000e+00, 4.0394e+05, 1.7737e+00, 1.7814e+00, 1.7373e+00, 1.7664e+00,
         3.9539e+05, 1.6934e+00, 1.7018e+00],
        [4.0391e+05, 4.0390e+05, 8.1849e+05, 4.0394e+05, 4.0392e+05, 7.7982e+05,
         4.0394e+05, 0.0000e+00, 4.0391e+05, 4.0391e+05, 4.0391e+05, 4.0390e+05,
         7.9573e+05, 4.0395e+05, 4.0393e+05],
        [1.7071e+00, 1.8648e+00, 3.9158e+05, 1.6973e+00, 1.7630e+00, 3.8685e+05,
         1.7737e+00, 4.0391e+05, 0.0000e+00, 1.7993e+00, 1.7121e+00, 1.8695e+00,
         3.9541e+05, 1.9344e+00, 1.7013e+00],
        [1.7400e+00, 1.8182e+00, 3.9157e+05, 1.9599e+00, 1.7697e+00, 3.8686e+05,
         1.7814e+00, 4.0391e+05, 1.7993e+00, 0.0000e+00, 1.8658e+00, 1.7372e+00,
         3.9542e+05, 2.1891e+00, 1.6127e+00],
        [1.5451e+00, 1.9093e+00, 3.9162e+05, 1.6032e+00, 1.6323e+00, 3.8681e+05,
         1.7373e+00, 4.0391e+05, 1.7121e+00, 1.8658e+00, 0.0000e+00, 1.7247e+00,
         3.9540e+05, 1.9262e+00, 1.6931e+00],
        [1.7046e+00, 1.6994e+00, 3.9155e+05, 1.7510e+00, 1.6498e+00, 3.8681e+05,
         1.7664e+00, 4.0390e+05, 1.8695e+00, 1.7372e+00, 1.7247e+00, 0.0000e+00,
         3.9542e+05, 1.9676e+00, 1.6870e+00],
        [3.9538e+05, 3.9541e+05, 7.8041e+05, 3.9541e+05, 3.9542e+05, 8.1962e+05,
         3.9539e+05, 7.9573e+05, 3.9541e+05, 3.9542e+05, 3.9540e+05, 3.9542e+05,
         0.0000e+00, 3.9538e+05, 3.9539e+05],
        [2.0469e+00, 1.7518e+00, 3.9157e+05, 1.8796e+00, 1.6503e+00, 3.8680e+05,
         1.6934e+00, 4.0395e+05, 1.9344e+00, 2.1891e+00, 1.9262e+00, 1.9676e+00,
         3.9538e+05, 0.0000e+00, 1.7448e+00],
        [1.7198e+00, 1.7400e+00, 3.9159e+05, 1.6510e+00, 1.5534e+00, 3.8683e+05,
         1.7018e+00, 4.0393e+05, 1.7013e+00, 1.6127e+00, 1.6931e+00, 1.6870e+00,
         3.9539e+05, 1.7448e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5451e+00, 1.6679e+00, 1.7046e+00, 1.7071e+00, 1.7198e+00,
        1.7400e+00, 1.7685e+00, 1.8020e+00, 1.8876e+00, 2.0469e+00, 3.8681e+05,
        3.9157e+05, 3.9538e+05, 4.0391e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5954e+00, 1.6994e+00, 1.7400e+00, 1.7518e+00, 1.8182e+00,
        1.8183e+00, 1.8648e+00, 1.8709e+00, 1.8876e+00, 1.9093e+00, 3.8680e+05,
        3.9158e+05, 3.9541e+05, 4.0390e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391547.6250, 391565.1250, 391565.2500, 391572.1250,
        391574.7188, 391578.5938, 391579.5000, 391584.0000, 391587.0625,
        391592.0938, 391621.8125, 778528.5000, 780405.3750, 818489.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6032e+00, 1.6510e+00, 1.6679e+00, 1.6885e+00, 1.6973e+00,
        1.7510e+00, 1.7662e+00, 1.8183e+00, 1.8796e+00, 1.9599e+00, 3.8684e+05,
        3.9159e+05, 3.9541e+05, 4.0394e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5534e+00, 1.5954e+00, 1.6121e+00, 1.6323e+00, 1.6498e+00,
        1.6503e+00, 1.6885e+00, 1.7630e+00, 1.7685e+00, 1.7697e+00, 3.8682e+05,
        3.9158e+05, 3.9542e+05, 4.0392e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386797.1875, 386797.5938, 386808.3750, 386810.5625,
        386812.7500, 386818.5625, 386826.2500, 386842.9062, 386844.4062,
        386847.3438, 386857.1250, 778528.5000, 779818.3750, 819622.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6121e+00, 1.6934e+00, 1.7018e+00, 1.7373e+00, 1.7662e+00,
        1.7664e+00, 1.7737e+00, 1.7814e+00, 1.8020e+00, 1.8709e+00, 3.8684e+05,
        3.9157e+05, 3.9539e+05, 4.0394e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 403895.6875, 403902.8750, 403909.9688, 403912.5938,
        403913.1250, 403914.9375, 403921.0625, 403928.8125, 403943.0312,
        403944.6875, 403947.5938, 779818.3750, 795730.4375, 818489.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6973e+00, 1.7013e+00, 1.7071e+00, 1.7121e+00, 1.7630e+00,
        1.7737e+00, 1.7993e+00, 1.8648e+00, 1.8695e+00, 1.9344e+00, 3.8685e+05,
        3.9158e+05, 3.9541e+05, 4.0391e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6127e+00, 1.7372e+00, 1.7400e+00, 1.7697e+00, 1.7814e+00,
        1.7993e+00, 1.8182e+00, 1.8658e+00, 1.9599e+00, 2.1891e+00, 3.8686e+05,
        3.9157e+05, 3.9542e+05, 4.0391e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5451e+00, 1.6032e+00, 1.6323e+00, 1.6931e+00, 1.7121e+00,
        1.7247e+00, 1.7373e+00, 1.8658e+00, 1.9093e+00, 1.9262e+00, 3.8681e+05,
        3.9162e+05, 3.9540e+05, 4.0391e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6498e+00, 1.6870e+00, 1.6994e+00, 1.7046e+00, 1.7247e+00,
        1.7372e+00, 1.7510e+00, 1.7664e+00, 1.8695e+00, 1.9676e+00, 3.8681e+05,
        3.9155e+05, 3.9542e+05, 4.0390e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 395383.4375, 395384.3125, 395387.5000, 395388.2812,
        395396.4688, 395405.2500, 395409.0625, 395411.8125, 395418.7500,
        395421.8750, 395424.9375, 780405.3750, 795730.4375, 819622.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6503e+00, 1.6934e+00, 1.7448e+00, 1.7518e+00, 1.8796e+00,
        1.9262e+00, 1.9344e+00, 1.9676e+00, 2.0469e+00, 2.1891e+00, 3.8680e+05,
        3.9157e+05, 3.9538e+05, 4.0395e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5534e+00, 1.6127e+00, 1.6510e+00, 1.6870e+00, 1.6931e+00,
        1.7013e+00, 1.7018e+00, 1.7198e+00, 1.7400e+00, 1.7448e+00, 3.8683e+05,
        3.9159e+05, 3.9539e+05, 4.0393e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.73', '1.78', '391578.91', '1.72', '1.66', '386817.66', '1.74', '403921.31', '1.77', '1.79', '1.71', '1.73', '395402.88', '1.84', '1.67']
estimated f for each client, fs: [5, 5, 2, 5, 5, 5, 5, 2, 5, 5, 5, 5, 2, 5, 5]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0182s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:12...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:12, End: 2025-07-22 15:29:12)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 17, 1, 9, 20, 18, 15, 4, 3, 14, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.3763e+00, 3.8345e+05, 1.4326e+00, 1.8115e+00, 3.8766e+05,
         3.8837e+05, 3.8660e+05, 1.4216e+00, 1.4859e+00, 3.9620e+05, 1.4789e+00,
         4.0600e+05, 1.6373e+00, 1.4749e+00],
        [1.3763e+00, 0.0000e+00, 3.8348e+05, 1.5051e+00, 1.8274e+00, 3.8768e+05,
         3.8837e+05, 3.8660e+05, 1.3992e+00, 1.5326e+00, 3.9620e+05, 1.4324e+00,
         4.0603e+05, 1.6300e+00, 1.5076e+00],
        [3.8345e+05, 3.8348e+05, 0.0000e+00, 3.8343e+05, 3.8343e+05, 7.7320e+05,
         7.8520e+05, 7.5108e+05, 3.8346e+05, 3.8345e+05, 7.8679e+05, 3.8345e+05,
         7.8759e+05, 3.8345e+05, 3.8345e+05],
        [1.4326e+00, 1.5051e+00, 3.8343e+05, 0.0000e+00, 1.8563e+00, 3.8766e+05,
         3.8835e+05, 3.8660e+05, 1.4451e+00, 1.6660e+00, 3.9622e+05, 1.4938e+00,
         4.0602e+05, 1.5554e+00, 1.4896e+00],
        [1.8115e+00, 1.8274e+00, 3.8343e+05, 1.8563e+00, 0.0000e+00, 3.8767e+05,
         3.8833e+05, 3.8657e+05, 1.9180e+00, 1.8433e+00, 3.9622e+05, 1.7546e+00,
         4.0597e+05, 1.5407e+00, 1.6068e+00],
        [3.8766e+05, 3.8768e+05, 7.7320e+05, 3.8766e+05, 3.8767e+05, 0.0000e+00,
         7.9831e+05, 7.4868e+05, 3.8769e+05, 3.8767e+05, 8.1295e+05, 3.8769e+05,
         7.8772e+05, 3.8770e+05, 3.8769e+05],
        [3.8837e+05, 3.8837e+05, 7.8520e+05, 3.8835e+05, 3.8833e+05, 7.9831e+05,
         0.0000e+00, 7.7662e+05, 3.8835e+05, 3.8835e+05, 7.8710e+05, 3.8834e+05,
         7.7996e+05, 3.8836e+05, 3.8835e+05],
        [3.8660e+05, 3.8660e+05, 7.5108e+05, 3.8660e+05, 3.8657e+05, 7.4868e+05,
         7.7662e+05, 0.0000e+00, 3.8660e+05, 3.8658e+05, 7.7652e+05, 3.8659e+05,
         7.9824e+05, 3.8661e+05, 3.8659e+05],
        [1.4216e+00, 1.3992e+00, 3.8346e+05, 1.4451e+00, 1.9180e+00, 3.8769e+05,
         3.8835e+05, 3.8660e+05, 0.0000e+00, 1.5223e+00, 3.9619e+05, 1.5610e+00,
         4.0598e+05, 1.5392e+00, 1.4710e+00],
        [1.4859e+00, 1.5326e+00, 3.8345e+05, 1.6660e+00, 1.8433e+00, 3.8767e+05,
         3.8835e+05, 3.8658e+05, 1.5223e+00, 0.0000e+00, 3.9624e+05, 1.4767e+00,
         4.0600e+05, 1.7908e+00, 1.3753e+00],
        [3.9620e+05, 3.9620e+05, 7.8679e+05, 3.9622e+05, 3.9622e+05, 8.1295e+05,
         7.8710e+05, 7.7652e+05, 3.9619e+05, 3.9624e+05, 0.0000e+00, 3.9620e+05,
         8.0897e+05, 3.9619e+05, 3.9621e+05],
        [1.4789e+00, 1.4324e+00, 3.8345e+05, 1.4938e+00, 1.7546e+00, 3.8769e+05,
         3.8834e+05, 3.8659e+05, 1.5610e+00, 1.4767e+00, 3.9620e+05, 0.0000e+00,
         4.0599e+05, 1.5876e+00, 1.4295e+00],
        [4.0600e+05, 4.0603e+05, 7.8759e+05, 4.0602e+05, 4.0597e+05, 7.8772e+05,
         7.7996e+05, 7.9824e+05, 4.0598e+05, 4.0600e+05, 8.0897e+05, 4.0599e+05,
         0.0000e+00, 4.0599e+05, 4.0602e+05],
        [1.6373e+00, 1.6300e+00, 3.8345e+05, 1.5554e+00, 1.5407e+00, 3.8770e+05,
         3.8836e+05, 3.8661e+05, 1.5392e+00, 1.7908e+00, 3.9619e+05, 1.5876e+00,
         4.0599e+05, 0.0000e+00, 1.4456e+00],
        [1.4749e+00, 1.5076e+00, 3.8345e+05, 1.4896e+00, 1.6068e+00, 3.8769e+05,
         3.8835e+05, 3.8659e+05, 1.4710e+00, 1.3753e+00, 3.9621e+05, 1.4295e+00,
         4.0602e+05, 1.4456e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3763e+00, 1.4216e+00, 1.4326e+00, 1.4749e+00, 1.4789e+00,
        1.4859e+00, 1.6373e+00, 1.8115e+00, 3.8345e+05, 3.8660e+05, 3.8766e+05,
        3.8837e+05, 3.9620e+05, 4.0600e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3763e+00, 1.3992e+00, 1.4324e+00, 1.5051e+00, 1.5076e+00,
        1.5326e+00, 1.6300e+00, 1.8274e+00, 3.8348e+05, 3.8660e+05, 3.8768e+05,
        3.8837e+05, 3.9620e+05, 4.0603e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 383433.4375, 383434.7500, 383445.8125, 383448.7188,
        383451.5938, 383454.5000, 383454.8125, 383456.3125, 383478.1875,
        751080.7500, 773198.5000, 785203.6875, 786793.4375, 787590.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4326e+00, 1.4451e+00, 1.4896e+00, 1.4938e+00, 1.5051e+00,
        1.5554e+00, 1.6660e+00, 1.8563e+00, 3.8343e+05, 3.8660e+05, 3.8766e+05,
        3.8835e+05, 3.9622e+05, 4.0602e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5407e+00, 1.6068e+00, 1.7546e+00, 1.8115e+00, 1.8274e+00,
        1.8433e+00, 1.8563e+00, 1.9180e+00, 3.8343e+05, 3.8657e+05, 3.8767e+05,
        3.8833e+05, 3.9622e+05, 4.0597e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387658.3125, 387664.5000, 387666.3750, 387667.7188,
        387680.2500, 387686.6250, 387692.1562, 387693.6562, 387695.4375,
        748681.0000, 773198.5000, 787722.0000, 798310.6250, 812953.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388334.7500, 388344.9375, 388346.4062, 388347.0938,
        388349.3438, 388354.3438, 388361.4062, 388368.9375, 388369.8750,
        776621.3750, 779957.6875, 785203.6875, 787101.5625, 798310.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386571.2812, 386583.8750, 386587.7500, 386593.0312,
        386601.4375, 386601.7500, 386602.7500, 386604.7188, 386606.9375,
        748681.0000, 751080.7500, 776521.4375, 776621.3750, 798241.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3992e+00, 1.4216e+00, 1.4451e+00, 1.4710e+00, 1.5223e+00,
        1.5392e+00, 1.5610e+00, 1.9180e+00, 3.8346e+05, 3.8660e+05, 3.8769e+05,
        3.8835e+05, 3.9619e+05, 4.0598e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3753e+00, 1.4767e+00, 1.4859e+00, 1.5223e+00, 1.5326e+00,
        1.6660e+00, 1.7908e+00, 1.8433e+00, 3.8345e+05, 3.8658e+05, 3.8767e+05,
        3.8835e+05, 3.9624e+05, 4.0600e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396185.0938, 396192.5000, 396195.5000, 396197.2812,
        396202.9688, 396207.4375, 396216.1250, 396221.1250, 396243.7812,
        776521.4375, 786793.4375, 787101.5625, 808966.6250, 812953.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4295e+00, 1.4324e+00, 1.4767e+00, 1.4789e+00, 1.4938e+00,
        1.5610e+00, 1.5876e+00, 1.7546e+00, 3.8345e+05, 3.8659e+05, 3.8769e+05,
        3.8834e+05, 3.9620e+05, 4.0599e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 405974.3438, 405981.7188, 405985.4062, 405994.9688,
        405998.5312, 406004.8125, 406021.0625, 406022.1875, 406032.5000,
        779957.6875, 787590.1875, 787722.0000, 798241.3125, 808966.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4456e+00, 1.5392e+00, 1.5407e+00, 1.5554e+00, 1.5876e+00,
        1.6300e+00, 1.6373e+00, 1.7908e+00, 3.8345e+05, 3.8661e+05, 3.8770e+05,
        3.8836e+05, 3.9619e+05, 4.0599e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3753e+00, 1.4295e+00, 1.4456e+00, 1.4710e+00, 1.4749e+00,
        1.4896e+00, 1.5076e+00, 1.6068e+00, 3.8345e+05, 3.8659e+05, 3.8769e+05,
        3.8835e+05, 3.9621e+05, 4.0602e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['42607.40', '42610.04', '383450.94', '42605.24', '42605.29', '387678.34', '388353.03', '386594.84', '42607.62', '42606.82', '396206.84', '42607.09', '406001.72', '42606.50', '42607.40']
estimated f for each client, fs: [6, 6, 4, 6, 6, 4, 4, 4, 6, 6, 4, 6, 4, 6, 6]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 17, 1, 9, 20, 18, 15, 4, 3, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0100s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:12...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:12, End: 2025-07-22 15:29:12)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.4995e+00, 1.7030e+00, 3.9235e+05, 3.8741e+05, 1.8349e+00,
         3.9687e+05, 3.8544e+05, 1.6930e+00, 3.8856e+05, 1.5992e+00, 1.5792e+00,
         3.8029e+05, 3.9402e+05, 1.6255e+00, 3.7962e+05, 1.7896e+00, 1.5991e+00],
        [1.4995e+00, 0.0000e+00, 1.5637e+00, 3.9240e+05, 3.8745e+05, 1.7974e+00,
         3.9688e+05, 3.8546e+05, 1.6069e+00, 3.8858e+05, 1.4914e+00, 1.5970e+00,
         3.8025e+05, 3.9403e+05, 1.5323e+00, 3.7962e+05, 1.8037e+00, 1.6103e+00],
        [1.7030e+00, 1.5637e+00, 0.0000e+00, 3.9237e+05, 3.8741e+05, 1.5154e+00,
         3.9683e+05, 3.8548e+05, 1.6678e+00, 3.8859e+05, 1.7085e+00, 1.6093e+00,
         3.8028e+05, 3.9404e+05, 1.5911e+00, 3.7962e+05, 1.5503e+00, 1.5635e+00],
        [3.9235e+05, 3.9240e+05, 3.9237e+05, 0.0000e+00, 7.8964e+05, 3.9236e+05,
         7.8693e+05, 7.9170e+05, 3.9238e+05, 7.9129e+05, 3.9237e+05, 3.9238e+05,
         7.6808e+05, 7.9644e+05, 3.9236e+05, 7.6629e+05, 3.9237e+05, 3.9237e+05],
        [3.8741e+05, 3.8745e+05, 3.8741e+05, 7.8964e+05, 0.0000e+00, 3.8745e+05,
         7.8708e+05, 7.8222e+05, 3.8741e+05, 7.7033e+05, 3.8740e+05, 3.8746e+05,
         7.6019e+05, 7.6376e+05, 3.8747e+05, 7.6366e+05, 3.8743e+05, 3.8742e+05],
        [1.8349e+00, 1.7974e+00, 1.5154e+00, 3.9236e+05, 3.8745e+05, 0.0000e+00,
         3.9688e+05, 3.8544e+05, 1.6467e+00, 3.8854e+05, 1.8956e+00, 1.7966e+00,
         3.8028e+05, 3.9396e+05, 1.7667e+00, 3.7958e+05, 1.5659e+00, 1.5513e+00],
        [3.9687e+05, 3.9688e+05, 3.9683e+05, 7.8693e+05, 7.8708e+05, 3.9688e+05,
         0.0000e+00, 7.6354e+05, 3.9687e+05, 8.0712e+05, 3.9683e+05, 3.9689e+05,
         7.6211e+05, 7.9985e+05, 3.9685e+05, 7.6030e+05, 3.9685e+05, 3.9686e+05],
        [3.8544e+05, 3.8546e+05, 3.8548e+05, 7.9170e+05, 7.8222e+05, 3.8544e+05,
         7.6354e+05, 0.0000e+00, 3.8544e+05, 7.9069e+05, 3.8543e+05, 3.8541e+05,
         7.6995e+05, 7.7477e+05, 3.8545e+05, 7.5905e+05, 3.8543e+05, 3.8547e+05],
        [1.6930e+00, 1.6069e+00, 1.6678e+00, 3.9238e+05, 3.8741e+05, 1.6467e+00,
         3.9687e+05, 3.8544e+05, 0.0000e+00, 3.8856e+05, 1.6608e+00, 1.6535e+00,
         3.8030e+05, 3.9401e+05, 1.6100e+00, 3.7958e+05, 1.5364e+00, 1.5091e+00],
        [3.8856e+05, 3.8858e+05, 3.8859e+05, 7.9129e+05, 7.7033e+05, 3.8854e+05,
         8.0712e+05, 7.9069e+05, 3.8856e+05, 0.0000e+00, 3.8853e+05, 3.8855e+05,
         7.5120e+05, 7.9738e+05, 3.8853e+05, 7.7381e+05, 3.8860e+05, 3.8860e+05],
        [1.5992e+00, 1.4914e+00, 1.7085e+00, 3.9237e+05, 3.8740e+05, 1.8956e+00,
         3.9683e+05, 3.8543e+05, 1.6608e+00, 3.8853e+05, 0.0000e+00, 1.7011e+00,
         3.8029e+05, 3.9402e+05, 1.7344e+00, 3.7963e+05, 1.7504e+00, 1.6366e+00],
        [1.5792e+00, 1.5970e+00, 1.6093e+00, 3.9238e+05, 3.8746e+05, 1.7966e+00,
         3.9689e+05, 3.8541e+05, 1.6535e+00, 3.8855e+05, 1.7011e+00, 0.0000e+00,
         3.8025e+05, 3.9401e+05, 1.5873e+00, 3.7963e+05, 1.9271e+00, 1.4955e+00],
        [3.8029e+05, 3.8025e+05, 3.8028e+05, 7.6808e+05, 7.6019e+05, 3.8028e+05,
         7.6211e+05, 7.6995e+05, 3.8030e+05, 7.5120e+05, 3.8029e+05, 3.8025e+05,
         0.0000e+00, 7.7876e+05, 3.8026e+05, 7.5893e+05, 3.8031e+05, 3.8027e+05],
        [3.9402e+05, 3.9403e+05, 3.9404e+05, 7.9644e+05, 7.6376e+05, 3.9396e+05,
         7.9985e+05, 7.7477e+05, 3.9401e+05, 7.9738e+05, 3.9402e+05, 3.9401e+05,
         7.7876e+05, 0.0000e+00, 3.9399e+05, 7.6129e+05, 3.9399e+05, 3.9401e+05],
        [1.6255e+00, 1.5323e+00, 1.5911e+00, 3.9236e+05, 3.8747e+05, 1.7667e+00,
         3.9685e+05, 3.8545e+05, 1.6100e+00, 3.8853e+05, 1.7344e+00, 1.5873e+00,
         3.8026e+05, 3.9399e+05, 0.0000e+00, 3.7961e+05, 1.7729e+00, 1.6181e+00],
        [3.7962e+05, 3.7962e+05, 3.7962e+05, 7.6629e+05, 7.6366e+05, 3.7958e+05,
         7.6030e+05, 7.5905e+05, 3.7958e+05, 7.7381e+05, 3.7963e+05, 3.7963e+05,
         7.5893e+05, 7.6129e+05, 3.7961e+05, 0.0000e+00, 3.7960e+05, 3.7962e+05],
        [1.7896e+00, 1.8037e+00, 1.5503e+00, 3.9237e+05, 3.8743e+05, 1.5659e+00,
         3.9685e+05, 3.8543e+05, 1.5364e+00, 3.8860e+05, 1.7504e+00, 1.9271e+00,
         3.8031e+05, 3.9399e+05, 1.7729e+00, 3.7960e+05, 0.0000e+00, 1.6078e+00],
        [1.5991e+00, 1.6103e+00, 1.5635e+00, 3.9237e+05, 3.8742e+05, 1.5513e+00,
         3.9686e+05, 3.8547e+05, 1.5091e+00, 3.8860e+05, 1.6366e+00, 1.4955e+00,
         3.8027e+05, 3.9401e+05, 1.6181e+00, 3.7962e+05, 1.6078e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4995e+00, 1.5792e+00, 1.5991e+00, 1.5992e+00, 1.6255e+00,
        1.6930e+00, 1.7030e+00, 1.7896e+00, 1.8349e+00, 3.7962e+05, 3.8029e+05,
        3.8544e+05, 3.8741e+05, 3.8856e+05, 3.9235e+05, 3.9402e+05, 3.9687e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4914e+00, 1.4995e+00, 1.5323e+00, 1.5637e+00, 1.5970e+00,
        1.6069e+00, 1.6103e+00, 1.7974e+00, 1.8037e+00, 3.7962e+05, 3.8025e+05,
        3.8546e+05, 3.8745e+05, 3.8858e+05, 3.9240e+05, 3.9403e+05, 3.9688e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5154e+00, 1.5503e+00, 1.5635e+00, 1.5637e+00, 1.5911e+00,
        1.6093e+00, 1.6678e+00, 1.7030e+00, 1.7085e+00, 3.7962e+05, 3.8028e+05,
        3.8548e+05, 3.8741e+05, 3.8859e+05, 3.9237e+05, 3.9404e+05, 3.9683e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392348.5938, 392358.9375, 392362.3750, 392366.0000,
        392367.5000, 392368.1562, 392372.8125, 392377.3438, 392379.0625,
        392402.7188, 766290.2500, 768076.5625, 786929.0000, 789637.8750,
        791293.0625, 791702.6250, 796435.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387397.1562, 387405.2500, 387414.0000, 387414.1250,
        387417.9375, 387428.0000, 387445.8438, 387447.1562, 387463.8750,
        387469.6875, 760194.6250, 763664.6875, 763755.2500, 770325.6875,
        782220.5625, 787078.1875, 789637.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5154e+00, 1.5513e+00, 1.5659e+00, 1.6467e+00, 1.7667e+00,
        1.7966e+00, 1.7974e+00, 1.8349e+00, 1.8956e+00, 3.7958e+05, 3.8028e+05,
        3.8544e+05, 3.8745e+05, 3.8854e+05, 3.9236e+05, 3.9396e+05, 3.9688e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396825.4688, 396832.9375, 396846.8438, 396851.1875,
        396864.4375, 396865.4062, 396866.4688, 396875.0938, 396884.0625,
        396888.1250, 760299.0625, 762107.0625, 763538.5625, 786929.0000,
        787078.1875, 799845.2500, 807124.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385406.5312, 385430.1250, 385433.1250, 385437.4375,
        385440.0312, 385444.6562, 385445.0312, 385462.4062, 385470.5625,
        385480.0000, 759048.5625, 763538.5625, 769954.5625, 774773.9375,
        782220.5625, 790690.3125, 791702.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5091e+00, 1.5364e+00, 1.6069e+00, 1.6100e+00, 1.6467e+00,
        1.6535e+00, 1.6608e+00, 1.6678e+00, 1.6930e+00, 3.7958e+05, 3.8030e+05,
        3.8544e+05, 3.8741e+05, 3.8856e+05, 3.9238e+05, 3.9401e+05, 3.9687e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388531.4375, 388534.0312, 388539.5000, 388547.6875,
        388556.1875, 388560.1875, 388578.9375, 388590.5625, 388596.5312,
        388601.2500, 751195.3125, 770325.6875, 773814.0625, 790690.3125,
        791293.0625, 797384.1875, 807124.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4914e+00, 1.5992e+00, 1.6366e+00, 1.6608e+00, 1.7011e+00,
        1.7085e+00, 1.7344e+00, 1.7504e+00, 1.8956e+00, 3.7963e+05, 3.8029e+05,
        3.8543e+05, 3.8740e+05, 3.8853e+05, 3.9237e+05, 3.9402e+05, 3.9683e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4955e+00, 1.5792e+00, 1.5873e+00, 1.5970e+00, 1.6093e+00,
        1.6535e+00, 1.7011e+00, 1.7966e+00, 1.9271e+00, 3.7963e+05, 3.8025e+05,
        3.8541e+05, 3.8746e+05, 3.8855e+05, 3.9238e+05, 3.9401e+05, 3.9689e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 380246.2188, 380253.9688, 380264.5312, 380267.3125,
        380281.6562, 380283.8125, 380287.3750, 380288.4688, 380298.0312,
        380312.0312, 751195.3125, 758928.7500, 760194.6250, 762107.0625,
        768076.5625, 769954.5625, 778763.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393964.3438, 393989.9062, 393993.6250, 394005.6562,
        394008.2500, 394009.8125, 394020.0312, 394022.2188, 394029.6875,
        394039.0625, 761289.5625, 763755.2500, 774773.9375, 778763.1875,
        796435.3750, 797384.1875, 799845.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5323e+00, 1.5873e+00, 1.5911e+00, 1.6100e+00, 1.6181e+00,
        1.6255e+00, 1.7344e+00, 1.7667e+00, 1.7729e+00, 3.7961e+05, 3.8026e+05,
        3.8545e+05, 3.8747e+05, 3.8853e+05, 3.9236e+05, 3.9399e+05, 3.9685e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 379578.4688, 379582.8125, 379595.9688, 379613.9375,
        379615.0625, 379615.8438, 379621.0625, 379622.4688, 379630.5625,
        379631.6875, 758928.7500, 759048.5625, 760299.0625, 761289.5625,
        763664.6875, 766290.2500, 773814.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5364e+00, 1.5503e+00, 1.5659e+00, 1.6078e+00, 1.7504e+00,
        1.7729e+00, 1.7896e+00, 1.8037e+00, 1.9271e+00, 3.7960e+05, 3.8031e+05,
        3.8543e+05, 3.8743e+05, 3.8860e+05, 3.9237e+05, 3.9399e+05, 3.9685e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4955e+00, 1.5091e+00, 1.5513e+00, 1.5635e+00, 1.5991e+00,
        1.6078e+00, 1.6103e+00, 1.6181e+00, 1.6366e+00, 3.7962e+05, 3.8027e+05,
        3.8547e+05, 3.8742e+05, 3.8860e+05, 3.9237e+05, 3.9401e+05, 3.9686e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['69083.92', '69080.99', '69082.91', '426363.06', '421317.97', '69079.79', '429899.91', '419408.91', '69081.40', '421530.09', '69085.02', '69081.07', '413998.03', '427397.44', '69081.21', '414094.22', '69083.93', '69081.50']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 6, 6, 8, 6, 8, 8, 6, 6, 8, 6, 8, 8]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0936s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:13...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:29:13, End: 2025-07-22 15:29:13)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.3260e+00, 3.8884e+05, 3.9502e+05, 1.2446e+00, 1.8486e+00,
         3.8326e+05, 3.8473e+05, 1.2640e+00, 3.9130e+05, 1.2579e+00, 3.9333e+05,
         3.9509e+05, 1.1483e+00, 1.3009e+00, 1.3101e+00, 1.2425e+00],
        [1.3260e+00, 0.0000e+00, 3.8886e+05, 3.9505e+05, 1.1996e+00, 1.5403e+00,
         3.8324e+05, 3.8475e+05, 1.2723e+00, 3.9131e+05, 1.2984e+00, 3.9330e+05,
         3.9507e+05, 1.3149e+00, 1.2625e+00, 1.1556e+00, 1.2407e+00],
        [3.8884e+05, 3.8886e+05, 0.0000e+00, 7.6321e+05, 3.8888e+05, 3.8885e+05,
         7.8135e+05, 7.7091e+05, 3.8885e+05, 7.8121e+05, 3.8886e+05, 7.9151e+05,
         7.9221e+05, 3.8882e+05, 3.8883e+05, 3.8882e+05, 3.8886e+05],
        [3.9502e+05, 3.9505e+05, 7.6321e+05, 0.0000e+00, 3.9508e+05, 3.9505e+05,
         7.6497e+05, 7.7129e+05, 3.9502e+05, 7.8100e+05, 3.9503e+05, 7.9349e+05,
         8.0912e+05, 3.9504e+05, 3.9507e+05, 3.9506e+05, 3.9504e+05],
        [1.2446e+00, 1.1996e+00, 3.8888e+05, 3.9508e+05, 0.0000e+00, 1.4837e+00,
         3.8327e+05, 3.8477e+05, 1.2806e+00, 3.9130e+05, 1.2702e+00, 3.9333e+05,
         3.9507e+05, 1.2392e+00, 1.3319e+00, 1.1994e+00, 1.1974e+00],
        [1.8486e+00, 1.5403e+00, 3.8885e+05, 3.9505e+05, 1.4837e+00, 0.0000e+00,
         3.8328e+05, 3.8477e+05, 1.6245e+00, 3.9131e+05, 1.9564e+00, 3.9328e+05,
         3.9507e+05, 1.8340e+00, 1.8217e+00, 1.5485e+00, 1.5949e+00],
        [3.8326e+05, 3.8324e+05, 7.8135e+05, 7.6497e+05, 3.8327e+05, 3.8328e+05,
         0.0000e+00, 7.6329e+05, 3.8326e+05, 7.7222e+05, 3.8323e+05, 8.0815e+05,
         7.6864e+05, 3.8326e+05, 3.8323e+05, 3.8327e+05, 3.8325e+05],
        [3.8473e+05, 3.8475e+05, 7.7091e+05, 7.7129e+05, 3.8477e+05, 3.8477e+05,
         7.6329e+05, 0.0000e+00, 3.8475e+05, 7.8301e+05, 3.8476e+05, 7.8622e+05,
         7.6763e+05, 3.8472e+05, 3.8477e+05, 3.8477e+05, 3.8476e+05],
        [1.2640e+00, 1.2723e+00, 3.8885e+05, 3.9502e+05, 1.2806e+00, 1.6245e+00,
         3.8326e+05, 3.8475e+05, 0.0000e+00, 3.9125e+05, 1.2898e+00, 3.9331e+05,
         3.9506e+05, 1.2508e+00, 1.2383e+00, 1.1520e+00, 1.1751e+00],
        [3.9130e+05, 3.9131e+05, 7.8121e+05, 7.8100e+05, 3.9130e+05, 3.9131e+05,
         7.7222e+05, 7.8301e+05, 3.9125e+05, 0.0000e+00, 3.9128e+05, 7.9227e+05,
         7.8730e+05, 3.9127e+05, 3.9129e+05, 3.9132e+05, 3.9128e+05],
        [1.2579e+00, 1.2984e+00, 3.8886e+05, 3.9503e+05, 1.2702e+00, 1.9564e+00,
         3.8323e+05, 3.8476e+05, 1.2898e+00, 3.9128e+05, 0.0000e+00, 3.9331e+05,
         3.9506e+05, 1.2821e+00, 1.3696e+00, 1.2846e+00, 1.2416e+00],
        [3.9333e+05, 3.9330e+05, 7.9151e+05, 7.9349e+05, 3.9333e+05, 3.9328e+05,
         8.0815e+05, 7.8622e+05, 3.9331e+05, 7.9227e+05, 3.9331e+05, 0.0000e+00,
         7.9130e+05, 3.9331e+05, 3.9334e+05, 3.9331e+05, 3.9331e+05],
        [3.9509e+05, 3.9507e+05, 7.9221e+05, 8.0912e+05, 3.9507e+05, 3.9507e+05,
         7.6864e+05, 7.6763e+05, 3.9506e+05, 7.8730e+05, 3.9506e+05, 7.9130e+05,
         0.0000e+00, 3.9508e+05, 3.9505e+05, 3.9508e+05, 3.9507e+05],
        [1.1483e+00, 1.3149e+00, 3.8882e+05, 3.9504e+05, 1.2392e+00, 1.8340e+00,
         3.8326e+05, 3.8472e+05, 1.2508e+00, 3.9127e+05, 1.2821e+00, 3.9331e+05,
         3.9508e+05, 0.0000e+00, 1.3202e+00, 1.3095e+00, 1.2324e+00],
        [1.3009e+00, 1.2625e+00, 3.8883e+05, 3.9507e+05, 1.3319e+00, 1.8217e+00,
         3.8323e+05, 3.8477e+05, 1.2383e+00, 3.9129e+05, 1.3696e+00, 3.9334e+05,
         3.9505e+05, 1.3202e+00, 0.0000e+00, 1.3192e+00, 1.2638e+00],
        [1.3101e+00, 1.1556e+00, 3.8882e+05, 3.9506e+05, 1.1994e+00, 1.5485e+00,
         3.8327e+05, 3.8477e+05, 1.1520e+00, 3.9132e+05, 1.2846e+00, 3.9331e+05,
         3.9508e+05, 1.3095e+00, 1.3192e+00, 0.0000e+00, 1.2166e+00],
        [1.2425e+00, 1.2407e+00, 3.8886e+05, 3.9504e+05, 1.1974e+00, 1.5949e+00,
         3.8325e+05, 3.8476e+05, 1.1751e+00, 3.9128e+05, 1.2416e+00, 3.9331e+05,
         3.9507e+05, 1.2324e+00, 1.2638e+00, 1.2166e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1483e+00, 1.2425e+00, 1.2446e+00, 1.2579e+00, 1.2640e+00,
        1.3009e+00, 1.3101e+00, 1.3260e+00, 1.8486e+00, 3.8326e+05, 3.8473e+05,
        3.8884e+05, 3.9130e+05, 3.9333e+05, 3.9502e+05, 3.9509e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1556e+00, 1.1996e+00, 1.2407e+00, 1.2625e+00, 1.2723e+00,
        1.2984e+00, 1.3149e+00, 1.3260e+00, 1.5403e+00, 3.8324e+05, 3.8475e+05,
        3.8886e+05, 3.9131e+05, 3.9330e+05, 3.9505e+05, 3.9507e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388822.9375, 388823.0625, 388831.6875, 388842.9375,
        388852.7500, 388854.0938, 388858.4375, 388860.2500, 388861.5625,
        388879.2500, 763209.3750, 770910.1250, 781207.5625, 781348.1250,
        791506.9375, 792207.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395018.0625, 395024.5000, 395027.5625, 395043.9375,
        395043.9688, 395045.7500, 395046.2500, 395057.4688, 395066.5938,
        395079.0000, 763209.3750, 764966.6875, 771290.8750, 781000.8750,
        793487.1250, 809119.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1974e+00, 1.1994e+00, 1.1996e+00, 1.2392e+00, 1.2446e+00,
        1.2702e+00, 1.2806e+00, 1.3319e+00, 1.4837e+00, 3.8327e+05, 3.8477e+05,
        3.8888e+05, 3.9130e+05, 3.9333e+05, 3.9507e+05, 3.9508e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4837e+00, 1.5403e+00, 1.5485e+00, 1.5949e+00, 1.6245e+00,
        1.8217e+00, 1.8340e+00, 1.8486e+00, 1.9564e+00, 3.8328e+05, 3.8477e+05,
        3.8885e+05, 3.9131e+05, 3.9328e+05, 3.9505e+05, 3.9507e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383230.3125, 383233.9062, 383241.9062, 383253.5625,
        383260.2812, 383263.5312, 383264.3750, 383268.2500, 383271.3750,
        383282.4375, 763290.9375, 764966.6875, 768635.5000, 772223.2500,
        781348.1250, 808147.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384723.0312, 384733.0625, 384751.0625, 384751.0938,
        384764.2188, 384764.2188, 384767.3438, 384767.8125, 384769.8750,
        384772.9375, 763290.9375, 767631.5625, 770910.1250, 771290.8750,
        783008.6250, 786215.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1520e+00, 1.1751e+00, 1.2383e+00, 1.2508e+00, 1.2640e+00,
        1.2723e+00, 1.2806e+00, 1.2898e+00, 1.6245e+00, 3.8326e+05, 3.8475e+05,
        3.8885e+05, 3.9125e+05, 3.9331e+05, 3.9502e+05, 3.9506e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391251.5000, 391266.1250, 391277.5312, 391279.1875,
        391289.6562, 391299.2188, 391304.4062, 391308.1875, 391309.3750,
        391322.7500, 772223.2500, 781000.8750, 781207.5625, 783008.6250,
        787295.1250, 792268.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2416e+00, 1.2579e+00, 1.2702e+00, 1.2821e+00, 1.2846e+00,
        1.2898e+00, 1.2984e+00, 1.3696e+00, 1.9564e+00, 3.8323e+05, 3.8476e+05,
        3.8886e+05, 3.9128e+05, 3.9331e+05, 3.9503e+05, 3.9506e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393281.9062, 393304.3438, 393305.1875, 393306.4375,
        393307.8438, 393308.9375, 393309.3125, 393327.4688, 393329.3438,
        393338.3125, 786215.2500, 791300.5000, 791506.9375, 792268.0625,
        793487.1250, 808147.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395047.0938, 395058.5312, 395061.1250, 395070.6875,
        395071.4688, 395071.7188, 395074.3438, 395081.5000, 395081.7812,
        395085.3125, 767631.5625, 768635.5000, 787295.1250, 791300.5000,
        792207.8750, 809119.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1483e+00, 1.2324e+00, 1.2392e+00, 1.2508e+00, 1.2821e+00,
        1.3095e+00, 1.3149e+00, 1.3202e+00, 1.8340e+00, 3.8326e+05, 3.8472e+05,
        3.8882e+05, 3.9127e+05, 3.9331e+05, 3.9504e+05, 3.9508e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2383e+00, 1.2625e+00, 1.2638e+00, 1.3009e+00, 1.3192e+00,
        1.3202e+00, 1.3319e+00, 1.3696e+00, 1.8217e+00, 3.8323e+05, 3.8477e+05,
        3.8883e+05, 3.9129e+05, 3.9334e+05, 3.9505e+05, 3.9507e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1520e+00, 1.1556e+00, 1.1994e+00, 1.2166e+00, 1.2846e+00,
        1.3095e+00, 1.3101e+00, 1.3192e+00, 1.5485e+00, 3.8327e+05, 3.8477e+05,
        3.8882e+05, 3.9132e+05, 3.9331e+05, 3.9506e+05, 3.9508e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1751e+00, 1.1974e+00, 1.2166e+00, 1.2324e+00, 1.2407e+00,
        1.2416e+00, 1.2425e+00, 1.2638e+00, 1.5949e+00, 3.8325e+05, 3.8476e+05,
        3.8886e+05, 3.9128e+05, 3.9331e+05, 3.9504e+05, 3.9507e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38327.54', '38325.35', '388848.69', '395045.28', '38327.96', '38329.77', '383256.97', '384756.47', '38327.59', '391290.78', '38324.25', '393311.88', '395070.38', '38327.22', '38324.61', '38328.29', '38326.49']
estimated f for each client, fs: [7, 7, 5, 5, 7, 7, 5, 5, 7, 5, 7, 5, 5, 7, 7, 7, 7]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0129s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:14...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:14, End: 2025-07-22 15:29:14)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 17, 9, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.8951e+05, 1.8174e+00, 3.7753e+05, 1.6140e+00, 3.9352e+05,
         1.6029e+00, 1.5726e+00, 3.9613e+05, 3.9305e+05, 1.5126e+00, 1.5135e+00,
         3.8736e+05, 1.6651e+00, 1.6200e+00],
        [3.8951e+05, 0.0000e+00, 3.8948e+05, 7.6599e+05, 3.8948e+05, 8.0539e+05,
         3.8948e+05, 3.8946e+05, 7.8162e+05, 7.8736e+05, 3.8948e+05, 3.8950e+05,
         7.6795e+05, 3.8949e+05, 3.8945e+05],
        [1.8174e+00, 3.8948e+05, 0.0000e+00, 3.7757e+05, 1.6022e+00, 3.9351e+05,
         1.4824e+00, 1.7924e+00, 3.9614e+05, 3.9306e+05, 1.7525e+00, 1.7508e+00,
         3.8739e+05, 1.4705e+00, 1.5331e+00],
        [3.7753e+05, 7.6599e+05, 3.7757e+05, 0.0000e+00, 3.7757e+05, 7.7281e+05,
         3.7755e+05, 3.7757e+05, 7.8497e+05, 8.0833e+05, 3.7756e+05, 3.7755e+05,
         7.7680e+05, 3.7756e+05, 3.7758e+05],
        [1.6140e+00, 3.8948e+05, 1.6022e+00, 3.7757e+05, 0.0000e+00, 3.9351e+05,
         1.6027e+00, 1.5309e+00, 3.9613e+05, 3.9307e+05, 1.5458e+00, 1.5175e+00,
         3.8733e+05, 1.4566e+00, 1.4651e+00],
        [3.9352e+05, 8.0539e+05, 3.9351e+05, 7.7281e+05, 3.9351e+05, 0.0000e+00,
         3.9348e+05, 3.9352e+05, 7.9248e+05, 7.8881e+05, 3.9351e+05, 3.9349e+05,
         7.7718e+05, 3.9349e+05, 3.9351e+05],
        [1.6029e+00, 3.8948e+05, 1.4824e+00, 3.7755e+05, 1.6027e+00, 3.9348e+05,
         0.0000e+00, 1.6659e+00, 3.9614e+05, 3.9311e+05, 1.6694e+00, 1.7131e+00,
         3.8737e+05, 1.5427e+00, 1.5337e+00],
        [1.5726e+00, 3.8946e+05, 1.7924e+00, 3.7757e+05, 1.5309e+00, 3.9352e+05,
         1.6659e+00, 0.0000e+00, 3.9613e+05, 3.9308e+05, 1.6110e+00, 1.5063e+00,
         3.8735e+05, 1.7539e+00, 1.4464e+00],
        [3.9613e+05, 7.8162e+05, 3.9614e+05, 7.8497e+05, 3.9613e+05, 7.9248e+05,
         3.9614e+05, 3.9613e+05, 0.0000e+00, 8.1133e+05, 3.9611e+05, 3.9612e+05,
         7.5675e+05, 3.9612e+05, 3.9613e+05],
        [3.9305e+05, 7.8736e+05, 3.9306e+05, 8.0833e+05, 3.9307e+05, 7.8881e+05,
         3.9311e+05, 3.9308e+05, 8.1133e+05, 0.0000e+00, 3.9309e+05, 3.9306e+05,
         7.5232e+05, 3.9308e+05, 3.9307e+05],
        [1.5126e+00, 3.8948e+05, 1.7525e+00, 3.7756e+05, 1.5458e+00, 3.9351e+05,
         1.6694e+00, 1.6110e+00, 3.9611e+05, 3.9309e+05, 0.0000e+00, 1.5054e+00,
         3.8734e+05, 1.5532e+00, 1.5308e+00],
        [1.5135e+00, 3.8950e+05, 1.7508e+00, 3.7755e+05, 1.5175e+00, 3.9349e+05,
         1.7131e+00, 1.5063e+00, 3.9612e+05, 3.9306e+05, 1.5054e+00, 0.0000e+00,
         3.8734e+05, 1.6040e+00, 1.4905e+00],
        [3.8736e+05, 7.6795e+05, 3.8739e+05, 7.7680e+05, 3.8733e+05, 7.7718e+05,
         3.8737e+05, 3.8735e+05, 7.5675e+05, 7.5232e+05, 3.8734e+05, 3.8734e+05,
         0.0000e+00, 3.8737e+05, 3.8737e+05],
        [1.6651e+00, 3.8949e+05, 1.4705e+00, 3.7756e+05, 1.4566e+00, 3.9349e+05,
         1.5427e+00, 1.7539e+00, 3.9612e+05, 3.9308e+05, 1.5532e+00, 1.6040e+00,
         3.8737e+05, 0.0000e+00, 1.5394e+00],
        [1.6200e+00, 3.8945e+05, 1.5331e+00, 3.7758e+05, 1.4651e+00, 3.9351e+05,
         1.5337e+00, 1.4464e+00, 3.9613e+05, 3.9307e+05, 1.5308e+00, 1.4905e+00,
         3.8737e+05, 1.5394e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5126e+00, 1.5135e+00, 1.5726e+00, 1.6029e+00, 1.6140e+00,
        1.6200e+00, 1.6651e+00, 1.8174e+00, 3.7753e+05, 3.8736e+05, 3.8951e+05,
        3.9305e+05, 3.9352e+05, 3.9613e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389446.3125, 389460.1875, 389476.8125, 389477.3438,
        389479.1250, 389481.3125, 389492.9688, 389499.0938, 389514.6562,
        765986.6250, 767950.5000, 781619.7500, 787364.4375, 805386.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4705e+00, 1.4824e+00, 1.5331e+00, 1.6022e+00, 1.7508e+00,
        1.7525e+00, 1.7924e+00, 1.8174e+00, 3.7757e+05, 3.8739e+05, 3.8948e+05,
        3.9306e+05, 3.9351e+05, 3.9614e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 377528.4062, 377548.0938, 377548.3125, 377557.2188,
        377560.9062, 377568.3438, 377568.4062, 377569.5000, 377579.6250,
        765986.6250, 772805.0625, 776804.9375, 784971.7500, 808331.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4566e+00, 1.4651e+00, 1.5175e+00, 1.5309e+00, 1.5458e+00,
        1.6022e+00, 1.6027e+00, 1.6140e+00, 3.7757e+05, 3.8733e+05, 3.8948e+05,
        3.9307e+05, 3.9351e+05, 3.9613e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393480.8750, 393487.9688, 393493.7188, 393508.0938,
        393510.8750, 393512.3750, 393512.6250, 393517.1562, 393517.7188,
        772805.0625, 777179.3125, 788805.1250, 792475.5000, 805386.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4824e+00, 1.5337e+00, 1.5427e+00, 1.6027e+00, 1.6029e+00,
        1.6659e+00, 1.6694e+00, 1.7131e+00, 3.7755e+05, 3.8737e+05, 3.8948e+05,
        3.9311e+05, 3.9348e+05, 3.9614e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4464e+00, 1.5063e+00, 1.5309e+00, 1.5726e+00, 1.6110e+00,
        1.6659e+00, 1.7539e+00, 1.7924e+00, 3.7757e+05, 3.8735e+05, 3.8946e+05,
        3.9308e+05, 3.9352e+05, 3.9613e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396113.5312, 396123.7188, 396124.5625, 396130.4062,
        396130.9375, 396133.0625, 396133.6250, 396137.1250, 396140.0938,
        756750.5625, 781619.7500, 784971.7500, 792475.5000, 811325.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393053.7500, 393057.2188, 393059.5938, 393066.7812,
        393073.4062, 393078.0625, 393083.1250, 393091.8125, 393106.0938,
        752316.0000, 787364.4375, 788805.1250, 808331.8125, 811325.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5054e+00, 1.5126e+00, 1.5308e+00, 1.5458e+00, 1.5532e+00,
        1.6110e+00, 1.6694e+00, 1.7525e+00, 3.7756e+05, 3.8734e+05, 3.8948e+05,
        3.9309e+05, 3.9351e+05, 3.9611e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4905e+00, 1.5054e+00, 1.5063e+00, 1.5135e+00, 1.5175e+00,
        1.6040e+00, 1.7131e+00, 1.7508e+00, 3.7755e+05, 3.8734e+05, 3.8950e+05,
        3.9306e+05, 3.9349e+05, 3.9612e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387328.6250, 387337.2188, 387337.3438, 387348.7812,
        387363.8750, 387371.8125, 387372.8438, 387374.0625, 387386.9375,
        752316.0000, 756750.5625, 767950.5000, 776804.9375, 777179.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4566e+00, 1.4705e+00, 1.5394e+00, 1.5427e+00, 1.5532e+00,
        1.6040e+00, 1.6651e+00, 1.7539e+00, 3.7756e+05, 3.8737e+05, 3.8949e+05,
        3.9308e+05, 3.9349e+05, 3.9612e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4464e+00, 1.4651e+00, 1.4905e+00, 1.5308e+00, 1.5331e+00,
        1.5337e+00, 1.5394e+00, 1.6200e+00, 3.7758e+05, 3.8737e+05, 3.8945e+05,
        3.9307e+05, 3.9351e+05, 3.9613e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['41949.04', '389480.91', '41953.51', '377558.75', '41953.54', '393504.62', '41951.21', '41953.48', '396129.66', '393074.44', '41952.62', '41951.21', '387357.97', '41952.21', '41954.64']
estimated f for each client, fs: [6, 4, 6, 5, 6, 4, 6, 6, 4, 4, 6, 6, 4, 6, 6]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [7, 17, 9, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0232s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:14...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:14, End: 2025-07-22 15:29:14)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 6, 12], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.7022e+00, 1.7270e+00, 1.6334e+00, 1.8230e+00, 3.9090e+05,
         1.5998e+00, 3.8496e+05, 1.5751e+00, 1.5641e+00, 3.9700e+05, 1.4795e+00,
         1.6390e+00, 1.6723e+00, 1.5684e+00],
        [1.7022e+00, 0.0000e+00, 1.5733e+00, 1.6928e+00, 1.4622e+00, 3.9091e+05,
         1.6749e+00, 3.8501e+05, 1.5043e+00, 1.7900e+00, 3.9695e+05, 1.7571e+00,
         1.7115e+00, 1.6368e+00, 1.6666e+00],
        [1.7270e+00, 1.5733e+00, 0.0000e+00, 1.6029e+00, 1.5174e+00, 3.9088e+05,
         1.5967e+00, 3.8497e+05, 1.4909e+00, 1.6353e+00, 3.9697e+05, 1.6979e+00,
         1.5612e+00, 1.4199e+00, 1.5890e+00],
        [1.6334e+00, 1.6928e+00, 1.6029e+00, 0.0000e+00, 1.4972e+00, 3.9094e+05,
         1.6241e+00, 3.8494e+05, 1.5006e+00, 1.8040e+00, 3.9698e+05, 1.5783e+00,
         1.6515e+00, 1.5078e+00, 1.6068e+00],
        [1.8230e+00, 1.4622e+00, 1.5174e+00, 1.4972e+00, 0.0000e+00, 3.9090e+05,
         1.6087e+00, 3.8494e+05, 1.5534e+00, 1.7979e+00, 3.9700e+05, 1.8002e+00,
         1.7652e+00, 1.5013e+00, 1.5290e+00],
        [3.9090e+05, 3.9091e+05, 3.9088e+05, 3.9094e+05, 3.9090e+05, 0.0000e+00,
         3.9092e+05, 7.6754e+05, 3.9088e+05, 3.9090e+05, 7.9814e+05, 3.9089e+05,
         3.9090e+05, 3.9086e+05, 3.9092e+05],
        [1.5998e+00, 1.6749e+00, 1.5967e+00, 1.6241e+00, 1.6087e+00, 3.9092e+05,
         0.0000e+00, 3.8498e+05, 1.5571e+00, 1.5350e+00, 3.9697e+05, 1.5598e+00,
         1.5265e+00, 1.4406e+00, 1.5125e+00],
        [3.8496e+05, 3.8501e+05, 3.8497e+05, 3.8494e+05, 3.8494e+05, 7.6754e+05,
         3.8498e+05, 0.0000e+00, 3.8494e+05, 3.8495e+05, 8.0322e+05, 3.8499e+05,
         3.8497e+05, 3.8495e+05, 3.8496e+05],
        [1.5751e+00, 1.5043e+00, 1.4909e+00, 1.5006e+00, 1.5534e+00, 3.9088e+05,
         1.5571e+00, 3.8494e+05, 0.0000e+00, 1.5914e+00, 3.9700e+05, 1.6024e+00,
         1.7045e+00, 1.5045e+00, 1.5111e+00],
        [1.5641e+00, 1.7900e+00, 1.6353e+00, 1.8040e+00, 1.7979e+00, 3.9090e+05,
         1.5350e+00, 3.8495e+05, 1.5914e+00, 0.0000e+00, 3.9699e+05, 1.6780e+00,
         1.6159e+00, 1.7217e+00, 1.4812e+00],
        [3.9700e+05, 3.9695e+05, 3.9697e+05, 3.9698e+05, 3.9700e+05, 7.9814e+05,
         3.9697e+05, 8.0322e+05, 3.9700e+05, 3.9699e+05, 0.0000e+00, 3.9696e+05,
         3.9699e+05, 3.9696e+05, 3.9700e+05],
        [1.4795e+00, 1.7571e+00, 1.6979e+00, 1.5783e+00, 1.8002e+00, 3.9089e+05,
         1.5598e+00, 3.8499e+05, 1.6024e+00, 1.6780e+00, 3.9696e+05, 0.0000e+00,
         1.5868e+00, 1.5967e+00, 1.5711e+00],
        [1.6390e+00, 1.7115e+00, 1.5612e+00, 1.6515e+00, 1.7652e+00, 3.9090e+05,
         1.5265e+00, 3.8497e+05, 1.7045e+00, 1.6159e+00, 3.9699e+05, 1.5868e+00,
         0.0000e+00, 1.6042e+00, 1.5913e+00],
        [1.6723e+00, 1.6368e+00, 1.4199e+00, 1.5078e+00, 1.5013e+00, 3.9086e+05,
         1.4406e+00, 3.8495e+05, 1.5045e+00, 1.7217e+00, 3.9696e+05, 1.5967e+00,
         1.6042e+00, 0.0000e+00, 1.5671e+00],
        [1.5684e+00, 1.6666e+00, 1.5890e+00, 1.6068e+00, 1.5290e+00, 3.9092e+05,
         1.5125e+00, 3.8496e+05, 1.5111e+00, 1.4812e+00, 3.9700e+05, 1.5711e+00,
         1.5913e+00, 1.5671e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4795e+00, 1.5641e+00, 1.5684e+00, 1.5751e+00, 1.5998e+00,
        1.6334e+00, 1.6390e+00, 1.6723e+00, 1.7022e+00, 1.7270e+00, 1.8230e+00,
        3.8496e+05, 3.9090e+05, 3.9700e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4622e+00, 1.5043e+00, 1.5733e+00, 1.6368e+00, 1.6666e+00,
        1.6749e+00, 1.6928e+00, 1.7022e+00, 1.7115e+00, 1.7571e+00, 1.7900e+00,
        3.8501e+05, 3.9091e+05, 3.9695e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4199e+00, 1.4909e+00, 1.5174e+00, 1.5612e+00, 1.5733e+00,
        1.5890e+00, 1.5967e+00, 1.6029e+00, 1.6353e+00, 1.6979e+00, 1.7270e+00,
        3.8497e+05, 3.9088e+05, 3.9697e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4972e+00, 1.5006e+00, 1.5078e+00, 1.5783e+00, 1.6029e+00,
        1.6068e+00, 1.6241e+00, 1.6334e+00, 1.6515e+00, 1.6928e+00, 1.8040e+00,
        3.8494e+05, 3.9094e+05, 3.9698e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4622e+00, 1.4972e+00, 1.5013e+00, 1.5174e+00, 1.5290e+00,
        1.5534e+00, 1.6087e+00, 1.7652e+00, 1.7979e+00, 1.8002e+00, 1.8230e+00,
        3.8494e+05, 3.9090e+05, 3.9700e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390864.4062, 390881.3125, 390882.4688, 390893.8750,
        390895.0938, 390896.1250, 390896.5625, 390896.7188, 390908.0625,
        390919.5000, 390925.0000, 390938.3125, 767540.6250, 798139.5625])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4406e+00, 1.5125e+00, 1.5265e+00, 1.5350e+00, 1.5571e+00,
        1.5598e+00, 1.5967e+00, 1.5998e+00, 1.6087e+00, 1.6241e+00, 1.6749e+00,
        3.8498e+05, 3.9092e+05, 3.9697e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 384941.5000, 384942.8125, 384943.1875, 384946.8750,
        384948.3438, 384956.1875, 384958.5000, 384965.3125, 384969.7500,
        384980.3750, 384987.0938, 385006.9062, 767540.6250, 803221.6250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4909e+00, 1.5006e+00, 1.5043e+00, 1.5045e+00, 1.5111e+00,
        1.5534e+00, 1.5571e+00, 1.5751e+00, 1.5914e+00, 1.6024e+00, 1.7045e+00,
        3.8494e+05, 3.9088e+05, 3.9700e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4812e+00, 1.5350e+00, 1.5641e+00, 1.5914e+00, 1.6159e+00,
        1.6353e+00, 1.6780e+00, 1.7217e+00, 1.7900e+00, 1.7979e+00, 1.8040e+00,
        3.8495e+05, 3.9090e+05, 3.9699e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396947.1875, 396957.5938, 396962.2812, 396970.4375,
        396974.0625, 396977.1250, 396987.7500, 396991.0625, 396995.8438,
        396997.1562, 397001.9688, 397004.3750, 798139.5625, 803221.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4795e+00, 1.5598e+00, 1.5711e+00, 1.5783e+00, 1.5868e+00,
        1.5967e+00, 1.6024e+00, 1.6780e+00, 1.6979e+00, 1.7571e+00, 1.8002e+00,
        3.8499e+05, 3.9089e+05, 3.9696e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5265e+00, 1.5612e+00, 1.5868e+00, 1.5913e+00, 1.6042e+00,
        1.6159e+00, 1.6390e+00, 1.6515e+00, 1.7045e+00, 1.7115e+00, 1.7652e+00,
        3.8497e+05, 3.9090e+05, 3.9699e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4199e+00, 1.4406e+00, 1.5013e+00, 1.5045e+00, 1.5078e+00,
        1.5671e+00, 1.5967e+00, 1.6042e+00, 1.6368e+00, 1.6723e+00, 1.7217e+00,
        3.8495e+05, 3.9086e+05, 3.9696e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4812e+00, 1.5111e+00, 1.5125e+00, 1.5290e+00, 1.5671e+00,
        1.5684e+00, 1.5711e+00, 1.5890e+00, 1.5913e+00, 1.6068e+00, 1.6666e+00,
        3.8496e+05, 3.9092e+05, 3.9700e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.60', '1.62', '1.55', '1.58', '1.58', '390899.81', '1.55', '384962.22', '1.53', '1.62', '396973.72', '1.59', '1.61', '1.53', '1.55']
estimated f for each client, fs: [5, 5, 5, 5, 5, 1, 5, 1, 5, 5, 5, 5, 5, 5, 5]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']], selected_client_indices: [5, 7, 2, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0120s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:15...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:15, End: 2025-07-22 15:29:15)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5133e+00, 3.9826e+05, 1.4568e+00, 1.6282e+00, 3.8842e+05,
         3.7821e+05, 4.0641e+05, 1.4775e+00, 1.3664e+00, 3.6986e+05, 3.8333e+05,
         1.2956e+00, 1.4721e+00, 4.0164e+05, 1.8054e+00],
        [1.5133e+00, 0.0000e+00, 3.9825e+05, 1.4148e+00, 1.3510e+00, 3.8842e+05,
         3.7826e+05, 4.0638e+05, 1.3697e+00, 1.3982e+00, 3.6985e+05, 3.8332e+05,
         1.4699e+00, 1.3986e+00, 4.0167e+05, 1.5027e+00],
        [3.9826e+05, 3.9825e+05, 0.0000e+00, 3.9827e+05, 3.9823e+05, 7.8568e+05,
         7.7296e+05, 8.3550e+05, 3.9825e+05, 3.9825e+05, 8.0011e+05, 7.8156e+05,
         3.9825e+05, 3.9825e+05, 7.9289e+05, 3.9824e+05],
        [1.4568e+00, 1.4148e+00, 3.9827e+05, 0.0000e+00, 1.3355e+00, 3.8839e+05,
         3.7823e+05, 4.0640e+05, 1.3722e+00, 1.5554e+00, 3.6985e+05, 3.8334e+05,
         1.3819e+00, 1.4956e+00, 4.0165e+05, 1.5877e+00],
        [1.6282e+00, 1.3510e+00, 3.9823e+05, 1.3355e+00, 0.0000e+00, 3.8841e+05,
         3.7824e+05, 4.0641e+05, 1.4069e+00, 1.6178e+00, 3.6980e+05, 3.8336e+05,
         1.5793e+00, 1.5927e+00, 4.0161e+05, 1.2176e+00],
        [3.8842e+05, 3.8842e+05, 7.8568e+05, 3.8839e+05, 3.8841e+05, 0.0000e+00,
         7.5200e+05, 8.0946e+05, 3.8838e+05, 3.8842e+05, 7.6277e+05, 7.9387e+05,
         3.8842e+05, 3.8840e+05, 8.0593e+05, 3.8841e+05],
        [3.7821e+05, 3.7826e+05, 7.7296e+05, 3.7823e+05, 3.7824e+05, 7.5200e+05,
         0.0000e+00, 7.7969e+05, 3.7823e+05, 3.7824e+05, 7.6498e+05, 7.5981e+05,
         3.7822e+05, 3.7823e+05, 7.7419e+05, 3.7826e+05],
        [4.0641e+05, 4.0638e+05, 8.3550e+05, 4.0640e+05, 4.0641e+05, 8.0946e+05,
         7.7969e+05, 0.0000e+00, 4.0639e+05, 4.0637e+05, 7.9098e+05, 7.7264e+05,
         4.0639e+05, 4.0641e+05, 8.0722e+05, 4.0640e+05],
        [1.4775e+00, 1.3697e+00, 3.9825e+05, 1.3722e+00, 1.4069e+00, 3.8838e+05,
         3.7823e+05, 4.0639e+05, 0.0000e+00, 1.4180e+00, 3.6983e+05, 3.8333e+05,
         1.4663e+00, 1.5150e+00, 4.0165e+05, 1.5432e+00],
        [1.3664e+00, 1.3982e+00, 3.9825e+05, 1.5554e+00, 1.6178e+00, 3.8842e+05,
         3.7824e+05, 4.0637e+05, 1.4180e+00, 0.0000e+00, 3.6983e+05, 3.8330e+05,
         1.4712e+00, 1.4049e+00, 4.0165e+05, 1.7970e+00],
        [3.6986e+05, 3.6985e+05, 8.0011e+05, 3.6985e+05, 3.6980e+05, 7.6277e+05,
         7.6498e+05, 7.9098e+05, 3.6983e+05, 3.6983e+05, 0.0000e+00, 7.5695e+05,
         3.6985e+05, 3.6985e+05, 7.6236e+05, 3.6976e+05],
        [3.8333e+05, 3.8332e+05, 7.8156e+05, 3.8334e+05, 3.8336e+05, 7.9387e+05,
         7.5981e+05, 7.7264e+05, 3.8333e+05, 3.8330e+05, 7.5695e+05, 0.0000e+00,
         3.8333e+05, 3.8331e+05, 7.8287e+05, 3.8337e+05],
        [1.2956e+00, 1.4699e+00, 3.9825e+05, 1.3819e+00, 1.5793e+00, 3.8842e+05,
         3.7822e+05, 4.0639e+05, 1.4663e+00, 1.4712e+00, 3.6985e+05, 3.8333e+05,
         0.0000e+00, 1.4345e+00, 4.0166e+05, 1.7354e+00],
        [1.4721e+00, 1.3986e+00, 3.9825e+05, 1.4956e+00, 1.5927e+00, 3.8840e+05,
         3.7823e+05, 4.0641e+05, 1.5150e+00, 1.4049e+00, 3.6985e+05, 3.8331e+05,
         1.4345e+00, 0.0000e+00, 4.0158e+05, 1.7447e+00],
        [4.0164e+05, 4.0167e+05, 7.9289e+05, 4.0165e+05, 4.0161e+05, 8.0593e+05,
         7.7419e+05, 8.0722e+05, 4.0165e+05, 4.0165e+05, 7.6236e+05, 7.8287e+05,
         4.0166e+05, 4.0158e+05, 0.0000e+00, 4.0160e+05],
        [1.8054e+00, 1.5027e+00, 3.9824e+05, 1.5877e+00, 1.2176e+00, 3.8841e+05,
         3.7826e+05, 4.0640e+05, 1.5432e+00, 1.7970e+00, 3.6976e+05, 3.8337e+05,
         1.7354e+00, 1.7447e+00, 4.0160e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2956e+00, 1.3664e+00, 1.4568e+00, 1.4721e+00, 1.4775e+00,
        1.5133e+00, 1.6282e+00, 1.8054e+00, 3.6986e+05, 3.7821e+05, 3.8333e+05,
        3.8842e+05, 3.9826e+05, 4.0164e+05, 4.0641e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3510e+00, 1.3697e+00, 1.3982e+00, 1.3986e+00, 1.4148e+00,
        1.4699e+00, 1.5027e+00, 1.5133e+00, 3.6985e+05, 3.7826e+05, 3.8332e+05,
        3.8842e+05, 3.9825e+05, 4.0167e+05, 4.0638e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398231.5312, 398238.7188, 398245.5938, 398245.6562,
        398251.9062, 398252.0625, 398253.3750, 398256.4688, 398271.8750,
        772963.5000, 781560.5625, 785684.6875, 792893.0625, 800111.0000,
        835499.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3355e+00, 1.3722e+00, 1.3819e+00, 1.4148e+00, 1.4568e+00,
        1.4956e+00, 1.5554e+00, 1.5877e+00, 3.6985e+05, 3.7823e+05, 3.8334e+05,
        3.8839e+05, 3.9827e+05, 4.0165e+05, 4.0640e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2176e+00, 1.3355e+00, 1.3510e+00, 1.4069e+00, 1.5793e+00,
        1.5927e+00, 1.6178e+00, 1.6282e+00, 3.6980e+05, 3.7824e+05, 3.8336e+05,
        3.8841e+05, 3.9823e+05, 4.0161e+05, 4.0641e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388379.9062, 388394.7500, 388397.8750, 388407.5312,
        388408.8125, 388416.3125, 388416.5000, 388417.0938, 388417.1875,
        751996.0000, 762769.7500, 785684.6875, 793874.3750, 805925.7500,
        809462.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 378210.8125, 378223.1250, 378229.0625, 378232.7188,
        378233.2188, 378235.0312, 378236.6875, 378260.3750, 378261.5000,
        751996.0000, 759814.6875, 764977.3125, 772963.5000, 774194.2500,
        779693.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406365.8750, 406381.5000, 406393.1250, 406393.4688,
        406399.3438, 406404.9688, 406405.1875, 406408.1562, 406413.0625,
        772640.8125, 779693.3125, 790983.1250, 807224.1875, 809462.0000,
        835499.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3697e+00, 1.3722e+00, 1.4069e+00, 1.4180e+00, 1.4663e+00,
        1.4775e+00, 1.5150e+00, 1.5432e+00, 3.6983e+05, 3.7823e+05, 3.8333e+05,
        3.8838e+05, 3.9825e+05, 4.0165e+05, 4.0639e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3664e+00, 1.3982e+00, 1.4049e+00, 1.4180e+00, 1.4712e+00,
        1.5554e+00, 1.6178e+00, 1.7970e+00, 3.6983e+05, 3.7824e+05, 3.8330e+05,
        3.8842e+05, 3.9825e+05, 4.0165e+05, 4.0637e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 369755.1875, 369798.2812, 369831.1875, 369833.6875,
        369845.7812, 369845.9375, 369846.6875, 369847.5625, 369855.6875,
        756945.3750, 762358.4375, 762769.7500, 764977.3125, 790983.1250,
        800111.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383298.9688, 383312.6562, 383321.4688, 383328.3750,
        383329.1250, 383329.4062, 383343.9062, 383363.6875, 383374.3750,
        756945.3750, 759814.6875, 772640.8125, 781560.5625, 782870.7500,
        793874.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2956e+00, 1.3819e+00, 1.4345e+00, 1.4663e+00, 1.4699e+00,
        1.4712e+00, 1.5793e+00, 1.7354e+00, 3.6985e+05, 3.7822e+05, 3.8333e+05,
        3.8842e+05, 3.9825e+05, 4.0166e+05, 4.0639e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3986e+00, 1.4049e+00, 1.4345e+00, 1.4721e+00, 1.4956e+00,
        1.5150e+00, 1.5927e+00, 1.7447e+00, 3.6985e+05, 3.7823e+05, 3.8331e+05,
        3.8840e+05, 3.9825e+05, 4.0158e+05, 4.0641e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401581.6875, 401601.6562, 401613.6875, 401644.8125,
        401647.5625, 401649.1875, 401652.2812, 401655.5625, 401669.0625,
        762358.4375, 774194.2500, 782870.7500, 792893.0625, 805925.7500,
        807224.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2176e+00, 1.5027e+00, 1.5432e+00, 1.5877e+00, 1.7354e+00,
        1.7447e+00, 1.7970e+00, 1.8054e+00, 3.6976e+05, 3.7826e+05, 3.8337e+05,
        3.8841e+05, 3.9824e+05, 4.0160e+05, 4.0640e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['74807.86', '74811.85', '435721.09', '74809.05', '74804.50', '424765.19', '415611.84', '443020.56', '74807.44', '74807.99', '408540.56', '420694.69', '74808.26', '74809.06', '437707.41', '74802.96']
estimated f for each client, fs: [7, 7, 5, 7, 7, 5, 5, 5, 7, 7, 6, 5, 7, 7, 5, 7]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [5, 2, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0104s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:15...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:15, End: 2025-07-22 15:29:15)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1493e+00, 3.9223e+05, 4.1452e+05, 1.3253e+00, 3.8941e+05,
         3.8790e+05, 1.1761e+00, 3.7922e+05, 1.2089e+00, 1.1208e+00, 3.8734e+05,
         4.0359e+05, 3.7420e+05, 1.7972e+00, 1.1902e+00],
        [1.1493e+00, 0.0000e+00, 3.9224e+05, 4.1455e+05, 1.0659e+00, 3.8941e+05,
         3.8795e+05, 1.1910e+00, 3.7921e+05, 1.0814e+00, 1.1651e+00, 3.8733e+05,
         4.0358e+05, 3.7424e+05, 1.4671e+00, 1.1277e+00],
        [3.9223e+05, 3.9224e+05, 0.0000e+00, 8.1544e+05, 3.9223e+05, 7.9340e+05,
         7.7016e+05, 3.9222e+05, 7.6427e+05, 3.9222e+05, 3.9225e+05, 7.7738e+05,
         7.9072e+05, 7.7981e+05, 3.9225e+05, 3.9224e+05],
        [4.1452e+05, 4.1455e+05, 8.1544e+05, 0.0000e+00, 4.1449e+05, 8.1089e+05,
         8.0552e+05, 4.1450e+05, 7.8383e+05, 4.1451e+05, 4.1450e+05, 8.0268e+05,
         8.1274e+05, 7.7539e+05, 4.1450e+05, 4.1449e+05],
        [1.3253e+00, 1.0659e+00, 3.9223e+05, 4.1449e+05, 0.0000e+00, 3.8939e+05,
         3.8793e+05, 1.2052e+00, 3.7920e+05, 1.1152e+00, 1.2767e+00, 3.8736e+05,
         4.0356e+05, 3.7422e+05, 1.0091e+00, 1.0991e+00],
        [3.8941e+05, 3.8941e+05, 7.9340e+05, 8.1089e+05, 3.8939e+05, 0.0000e+00,
         7.9722e+05, 3.8937e+05, 7.5790e+05, 3.8941e+05, 3.8941e+05, 7.7060e+05,
         7.9147e+05, 7.8042e+05, 3.8939e+05, 3.8937e+05],
        [3.8790e+05, 3.8795e+05, 7.7016e+05, 8.0552e+05, 3.8793e+05, 7.9722e+05,
         0.0000e+00, 3.8796e+05, 7.8488e+05, 3.8793e+05, 3.8794e+05, 7.8623e+05,
         7.9440e+05, 7.6891e+05, 3.8796e+05, 3.8793e+05],
        [1.1761e+00, 1.1910e+00, 3.9222e+05, 4.1450e+05, 1.2052e+00, 3.8937e+05,
         3.8796e+05, 0.0000e+00, 3.7920e+05, 1.1276e+00, 1.1306e+00, 3.8736e+05,
         4.0359e+05, 3.7421e+05, 1.5867e+00, 1.1559e+00],
        [3.7922e+05, 3.7921e+05, 7.6427e+05, 7.8383e+05, 3.7920e+05, 7.5790e+05,
         7.8488e+05, 3.7920e+05, 0.0000e+00, 3.7918e+05, 3.7918e+05, 7.8017e+05,
         7.7628e+05, 7.6501e+05, 3.7921e+05, 3.7921e+05],
        [1.2089e+00, 1.0814e+00, 3.9222e+05, 4.1451e+05, 1.1152e+00, 3.8941e+05,
         3.8793e+05, 1.1276e+00, 3.7918e+05, 0.0000e+00, 1.1405e+00, 3.8732e+05,
         4.0359e+05, 3.7423e+05, 1.4632e+00, 1.1339e+00],
        [1.1208e+00, 1.1651e+00, 3.9225e+05, 4.1450e+05, 1.2767e+00, 3.8941e+05,
         3.8794e+05, 1.1306e+00, 3.7918e+05, 1.1405e+00, 0.0000e+00, 3.8735e+05,
         4.0360e+05, 3.7420e+05, 1.7221e+00, 1.1191e+00],
        [3.8734e+05, 3.8733e+05, 7.7738e+05, 8.0268e+05, 3.8736e+05, 7.7060e+05,
         7.8623e+05, 3.8736e+05, 7.8017e+05, 3.8732e+05, 3.8735e+05, 0.0000e+00,
         7.9226e+05, 7.8748e+05, 3.8737e+05, 3.8736e+05],
        [4.0359e+05, 4.0358e+05, 7.9072e+05, 8.1274e+05, 4.0356e+05, 7.9147e+05,
         7.9440e+05, 4.0359e+05, 7.7628e+05, 4.0359e+05, 4.0360e+05, 7.9226e+05,
         0.0000e+00, 7.6530e+05, 4.0353e+05, 4.0358e+05],
        [3.7420e+05, 3.7424e+05, 7.7981e+05, 7.7539e+05, 3.7422e+05, 7.8042e+05,
         7.6891e+05, 3.7421e+05, 7.6501e+05, 3.7423e+05, 3.7420e+05, 7.8748e+05,
         7.6530e+05, 0.0000e+00, 3.7424e+05, 3.7422e+05],
        [1.7972e+00, 1.4671e+00, 3.9225e+05, 4.1450e+05, 1.0091e+00, 3.8939e+05,
         3.8796e+05, 1.5867e+00, 3.7921e+05, 1.4632e+00, 1.7221e+00, 3.8737e+05,
         4.0353e+05, 3.7424e+05, 0.0000e+00, 1.4079e+00],
        [1.1902e+00, 1.1277e+00, 3.9224e+05, 4.1449e+05, 1.0991e+00, 3.8937e+05,
         3.8793e+05, 1.1559e+00, 3.7921e+05, 1.1339e+00, 1.1191e+00, 3.8736e+05,
         4.0358e+05, 3.7422e+05, 1.4079e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1208e+00, 1.1493e+00, 1.1761e+00, 1.1902e+00, 1.2089e+00,
        1.3253e+00, 1.7972e+00, 3.7420e+05, 3.7922e+05, 3.8734e+05, 3.8790e+05,
        3.8941e+05, 3.9223e+05, 4.0359e+05, 4.1452e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0659e+00, 1.0814e+00, 1.1277e+00, 1.1493e+00, 1.1651e+00,
        1.1910e+00, 1.4671e+00, 3.7424e+05, 3.7921e+05, 3.8733e+05, 3.8795e+05,
        3.8941e+05, 3.9224e+05, 4.0358e+05, 4.1455e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392216.2812, 392224.5312, 392231.9062, 392232.1875,
        392235.0625, 392235.1875, 392245.1875, 392245.5938, 764274.8750,
        770157.3125, 777378.6250, 779812.3750, 790722.8750, 793404.4375,
        815442.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 414489.2812, 414493.6250, 414495.3125, 414502.8125,
        414504.7500, 414509.1250, 414524.4375, 414546.8438, 775386.6875,
        783829.0000, 802680.9375, 805519.5625, 810889.8750, 812739.0000,
        815442.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0091e+00, 1.0659e+00, 1.0991e+00, 1.1152e+00, 1.2052e+00,
        1.2767e+00, 1.3253e+00, 3.7422e+05, 3.7920e+05, 3.8736e+05, 3.8793e+05,
        3.8939e+05, 3.9223e+05, 4.0356e+05, 4.1449e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389369.6875, 389371.3750, 389387.3750, 389388.0938,
        389406.0625, 389407.3750, 389411.9375, 389414.6250, 757902.3750,
        770598.0000, 780418.5000, 791474.6875, 793404.4375, 797221.6250,
        810889.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387897.6250, 387926.4062, 387931.5625, 387933.5938,
        387936.3438, 387954.8438, 387956.3438, 387963.7812, 768906.3125,
        770157.3125, 784881.8125, 786231.1250, 794399.5625, 797221.6250,
        805519.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1276e+00, 1.1306e+00, 1.1559e+00, 1.1761e+00, 1.1910e+00,
        1.2052e+00, 1.5867e+00, 3.7421e+05, 3.7920e+05, 3.8736e+05, 3.8796e+05,
        3.8937e+05, 3.9222e+05, 4.0359e+05, 4.1450e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379180.3125, 379181.8125, 379196.0938, 379204.3125,
        379209.5000, 379213.4062, 379214.5938, 379220.8750, 757902.3750,
        764274.8750, 765012.2500, 776278.7500, 780170.3125, 783829.0000,
        784881.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0814e+00, 1.1152e+00, 1.1276e+00, 1.1339e+00, 1.1405e+00,
        1.2089e+00, 1.4632e+00, 3.7423e+05, 3.7918e+05, 3.8732e+05, 3.8793e+05,
        3.8941e+05, 3.9222e+05, 4.0359e+05, 4.1451e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1191e+00, 1.1208e+00, 1.1306e+00, 1.1405e+00, 1.1651e+00,
        1.2767e+00, 1.7221e+00, 3.7420e+05, 3.7918e+05, 3.8735e+05, 3.8794e+05,
        3.8941e+05, 3.9225e+05, 4.0360e+05, 4.1450e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387317.4375, 387330.0312, 387335.1875, 387349.9375,
        387359.3750, 387364.1250, 387364.2812, 387365.1875, 770598.0000,
        777378.6250, 780170.3125, 786231.1250, 787476.5000, 792260.0625,
        802680.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403530.0625, 403563.4375, 403584.2812, 403584.6250,
        403588.3750, 403589.7500, 403593.8750, 403598.1875, 765303.4375,
        776278.7500, 790722.8750, 791474.6875, 792260.0625, 794399.5625,
        812739.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374196.7500, 374199.9688, 374213.7500, 374221.8438,
        374222.2812, 374228.5312, 374241.7500, 374244.2500, 765012.2500,
        765303.4375, 768906.3125, 775386.6875, 779812.3750, 780418.5000,
        787476.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0091e+00, 1.4079e+00, 1.4632e+00, 1.4671e+00, 1.5867e+00,
        1.7221e+00, 1.7972e+00, 3.7424e+05, 3.7921e+05, 3.8737e+05, 3.8796e+05,
        3.8939e+05, 3.9225e+05, 4.0353e+05, 4.1450e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0991e+00, 1.1191e+00, 1.1277e+00, 1.1339e+00, 1.1559e+00,
        1.1902e+00, 1.4079e+00, 3.7422e+05, 3.7921e+05, 3.8736e+05, 3.8793e+05,
        3.8937e+05, 3.9224e+05, 4.0358e+05, 4.1449e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['114076.17', '114078.95', '467229.81', '487528.19', '114079.08', '464365.69', '464256.41', '114078.60', '455579.81', '114073.45', '114074.04', '464676.19', '477021.44', '452408.50', '114083.33', '114080.89']
estimated f for each client, fs: [8, 8, 5, 5, 8, 5, 5, 8, 6, 8, 8, 6, 5, 7, 8, 8]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0103s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:16...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:16, End: 2025-07-22 15:29:16)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 10, 16, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1887e+00, 4.0220e+05, 3.8595e+05, 1.2550e+00, 1.2264e+00,
         3.9916e+05, 3.9185e+05, 1.2704e+00, 4.0501e+05, 1.3749e+00, 3.9507e+05,
         3.9580e+05, 1.3182e+00, 4.0190e+05, 1.2650e+00],
        [1.1887e+00, 0.0000e+00, 4.0222e+05, 3.8598e+05, 1.2790e+00, 1.2330e+00,
         3.9917e+05, 3.9185e+05, 1.3267e+00, 4.0500e+05, 1.3902e+00, 3.9505e+05,
         3.9580e+05, 1.2812e+00, 4.0193e+05, 1.2528e+00],
        [4.0220e+05, 4.0222e+05, 0.0000e+00, 7.8740e+05, 4.0221e+05, 4.0225e+05,
         8.1152e+05, 8.0095e+05, 4.0222e+05, 8.0347e+05, 4.0223e+05, 7.7816e+05,
         7.9104e+05, 4.0218e+05, 8.0148e+05, 4.0219e+05],
        [3.8595e+05, 3.8598e+05, 7.8740e+05, 0.0000e+00, 3.8595e+05, 3.8595e+05,
         7.9552e+05, 7.9080e+05, 3.8591e+05, 7.6732e+05, 3.8594e+05, 7.7825e+05,
         8.0496e+05, 3.8596e+05, 7.9019e+05, 3.8596e+05],
        [1.2550e+00, 1.2790e+00, 4.0221e+05, 3.8595e+05, 0.0000e+00, 1.2274e+00,
         3.9916e+05, 3.9183e+05, 1.2920e+00, 4.0503e+05, 1.3769e+00, 3.9505e+05,
         3.9582e+05, 1.3359e+00, 4.0193e+05, 1.3123e+00],
        [1.2264e+00, 1.2330e+00, 4.0225e+05, 3.8595e+05, 1.2274e+00, 0.0000e+00,
         3.9915e+05, 3.9184e+05, 1.3809e+00, 4.0501e+05, 1.1118e+00, 3.9510e+05,
         3.9581e+05, 1.5595e+00, 4.0196e+05, 1.3054e+00],
        [3.9916e+05, 3.9917e+05, 8.1152e+05, 7.9552e+05, 3.9916e+05, 3.9915e+05,
         0.0000e+00, 7.7190e+05, 3.9916e+05, 8.1407e+05, 3.9914e+05, 8.0751e+05,
         7.9604e+05, 3.9915e+05, 7.9915e+05, 3.9917e+05],
        [3.9185e+05, 3.9185e+05, 8.0095e+05, 7.9080e+05, 3.9183e+05, 3.9184e+05,
         7.7190e+05, 0.0000e+00, 3.9184e+05, 7.8177e+05, 3.9186e+05, 7.8334e+05,
         7.8455e+05, 3.9186e+05, 7.9641e+05, 3.9187e+05],
        [1.2704e+00, 1.3267e+00, 4.0222e+05, 3.8591e+05, 1.2920e+00, 1.3809e+00,
         3.9916e+05, 3.9184e+05, 0.0000e+00, 4.0503e+05, 1.4972e+00, 3.9506e+05,
         3.9580e+05, 1.2709e+00, 4.0190e+05, 1.1897e+00],
        [4.0501e+05, 4.0500e+05, 8.0347e+05, 7.6732e+05, 4.0503e+05, 4.0501e+05,
         8.1407e+05, 7.8177e+05, 4.0503e+05, 0.0000e+00, 4.0503e+05, 8.1416e+05,
         8.1167e+05, 4.0502e+05, 8.0557e+05, 4.0500e+05],
        [1.3749e+00, 1.3902e+00, 4.0223e+05, 3.8594e+05, 1.3769e+00, 1.1118e+00,
         3.9914e+05, 3.9186e+05, 1.4972e+00, 4.0503e+05, 0.0000e+00, 3.9505e+05,
         3.9583e+05, 1.6991e+00, 4.0193e+05, 1.4304e+00],
        [3.9507e+05, 3.9505e+05, 7.7816e+05, 7.7825e+05, 3.9505e+05, 3.9510e+05,
         8.0751e+05, 7.8334e+05, 3.9506e+05, 8.1416e+05, 3.9505e+05, 0.0000e+00,
         7.9382e+05, 3.9507e+05, 7.9304e+05, 3.9505e+05],
        [3.9580e+05, 3.9580e+05, 7.9104e+05, 8.0496e+05, 3.9582e+05, 3.9581e+05,
         7.9604e+05, 7.8455e+05, 3.9580e+05, 8.1167e+05, 3.9583e+05, 7.9382e+05,
         0.0000e+00, 3.9580e+05, 8.2370e+05, 3.9582e+05],
        [1.3182e+00, 1.2812e+00, 4.0218e+05, 3.8596e+05, 1.3359e+00, 1.5595e+00,
         3.9915e+05, 3.9186e+05, 1.2709e+00, 4.0502e+05, 1.6991e+00, 3.9507e+05,
         3.9580e+05, 0.0000e+00, 4.0192e+05, 1.3101e+00],
        [4.0190e+05, 4.0193e+05, 8.0148e+05, 7.9019e+05, 4.0193e+05, 4.0196e+05,
         7.9915e+05, 7.9641e+05, 4.0190e+05, 8.0557e+05, 4.0193e+05, 7.9304e+05,
         8.2370e+05, 4.0192e+05, 0.0000e+00, 4.0192e+05],
        [1.2650e+00, 1.2528e+00, 4.0219e+05, 3.8596e+05, 1.3123e+00, 1.3054e+00,
         3.9917e+05, 3.9187e+05, 1.1897e+00, 4.0500e+05, 1.4304e+00, 3.9505e+05,
         3.9582e+05, 1.3101e+00, 4.0192e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1887e+00, 1.2264e+00, 1.2550e+00, 1.2650e+00, 1.2704e+00,
        1.3182e+00, 1.3749e+00, 3.8595e+05, 3.9185e+05, 3.9507e+05, 3.9580e+05,
        3.9916e+05, 4.0190e+05, 4.0220e+05, 4.0501e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1887e+00, 1.2330e+00, 1.2528e+00, 1.2790e+00, 1.2812e+00,
        1.3267e+00, 1.3902e+00, 3.8598e+05, 3.9185e+05, 3.9505e+05, 3.9580e+05,
        3.9917e+05, 4.0193e+05, 4.0222e+05, 4.0500e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402175.5938, 402191.5312, 402203.9375, 402213.3438,
        402219.0625, 402219.6562, 402226.8750, 402250.6250, 778156.8125,
        787399.8750, 791037.8750, 800953.8125, 801482.0000, 803468.7500,
        811517.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385914.2500, 385935.5938, 385945.6250, 385948.8750,
        385952.9688, 385955.6875, 385958.4062, 385978.1875, 767315.8750,
        778251.8750, 787399.8750, 790191.6250, 790798.6250, 795516.7500,
        804957.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2274e+00, 1.2550e+00, 1.2790e+00, 1.2920e+00, 1.3123e+00,
        1.3359e+00, 1.3769e+00, 3.8595e+05, 3.9183e+05, 3.9505e+05, 3.9582e+05,
        3.9916e+05, 4.0193e+05, 4.0221e+05, 4.0503e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1118e+00, 1.2264e+00, 1.2274e+00, 1.2330e+00, 1.3054e+00,
        1.3809e+00, 1.5595e+00, 3.8595e+05, 3.9184e+05, 3.9510e+05, 3.9581e+05,
        3.9915e+05, 4.0196e+05, 4.0225e+05, 4.0501e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399144.9375, 399146.1250, 399151.2500, 399156.7500,
        399157.9688, 399159.4062, 399165.3125, 399165.5312, 771899.6875,
        795516.7500, 796041.5000, 799151.4375, 807506.6250, 811517.6875,
        814067.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391832.5000, 391837.0312, 391844.5625, 391849.1875,
        391850.8438, 391855.5938, 391863.1875, 391865.9688, 771899.6875,
        781772.0625, 783342.5625, 784553.8750, 790798.6250, 796414.0625,
        800953.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1897e+00, 1.2704e+00, 1.2709e+00, 1.2920e+00, 1.3267e+00,
        1.3809e+00, 1.4972e+00, 3.8591e+05, 3.9184e+05, 3.9506e+05, 3.9580e+05,
        3.9916e+05, 4.0190e+05, 4.0222e+05, 4.0503e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405001.9062, 405002.7500, 405007.5625, 405012.1875,
        405018.6250, 405026.7188, 405029.7188, 405033.6250, 767315.8750,
        781772.0625, 803468.7500, 805566.0625, 811666.0625, 814067.3750,
        814157.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1118e+00, 1.3749e+00, 1.3769e+00, 1.3902e+00, 1.4304e+00,
        1.4972e+00, 1.6991e+00, 3.8594e+05, 3.9186e+05, 3.9505e+05, 3.9583e+05,
        3.9914e+05, 4.0193e+05, 4.0223e+05, 4.0503e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395048.8125, 395052.5312, 395054.7188, 395054.7188,
        395062.2812, 395067.5000, 395073.2500, 395104.3125, 778156.8125,
        778251.8750, 783342.5625, 793041.5000, 793818.8750, 807506.6250,
        814157.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395795.7500, 395796.0000, 395798.0000, 395803.9688,
        395811.3750, 395816.8125, 395818.9062, 395833.9062, 784553.8750,
        791037.8750, 793818.8750, 796041.5000, 804957.5625, 811666.0625,
        823702.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2709e+00, 1.2812e+00, 1.3101e+00, 1.3182e+00, 1.3359e+00,
        1.5595e+00, 1.6991e+00, 3.8596e+05, 3.9186e+05, 3.9507e+05, 3.9580e+05,
        3.9915e+05, 4.0192e+05, 4.0218e+05, 4.0502e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401896.0312, 401898.3438, 401915.6250, 401921.6875,
        401925.3750, 401925.4375, 401932.7188, 401959.0938, 790191.6250,
        793041.5000, 796414.0625, 799151.4375, 801482.0000, 805566.0625,
        823702.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1897e+00, 1.2528e+00, 1.2650e+00, 1.3054e+00, 1.3101e+00,
        1.3123e+00, 1.4304e+00, 3.8596e+05, 3.9187e+05, 3.9505e+05, 3.9582e+05,
        3.9917e+05, 4.0192e+05, 4.0219e+05, 4.0500e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['117287.70', '117289.27', '478325.75', '463315.69', '117284.70', '117289.94', '476066.41', '468847.06', '117283.02', '478922.09', '117285.75', '471692.69', '474206.66', '117288.85', '479860.69', '117288.81']
estimated f for each client, fs: [8, 8, 5, 6, 8, 8, 5, 5, 8, 5, 8, 5, 5, 8, 5, 8]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0105s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:17...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:17, End: 2025-07-22 15:29:17)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.2838e+00, 1.3496e+00, 3.8876e+05, 3.8754e+05, 1.3007e+00,
         3.8775e+05, 3.8285e+05, 1.6354e+00, 3.8744e+05, 1.5136e+00, 1.3132e+00,
         3.9268e+05, 3.9298e+05, 1.2103e+00, 1.3820e+00, 4.0026e+05],
        [1.2838e+00, 0.0000e+00, 1.1905e+00, 3.8875e+05, 3.8756e+05, 1.2422e+00,
         3.8777e+05, 3.8285e+05, 1.4612e+00, 3.8741e+05, 1.2558e+00, 1.3489e+00,
         3.9265e+05, 3.9301e+05, 1.2916e+00, 1.3251e+00, 4.0028e+05],
        [1.3496e+00, 1.1905e+00, 0.0000e+00, 3.8875e+05, 3.8758e+05, 1.2401e+00,
         3.8772e+05, 3.8287e+05, 1.4621e+00, 3.8742e+05, 1.2472e+00, 1.2989e+00,
         3.9265e+05, 3.9300e+05, 1.3141e+00, 1.2459e+00, 4.0026e+05],
        [3.8876e+05, 3.8875e+05, 3.8875e+05, 0.0000e+00, 7.6561e+05, 3.8875e+05,
         7.6283e+05, 7.6915e+05, 3.8877e+05, 7.6063e+05, 3.8875e+05, 3.8875e+05,
         7.5768e+05, 7.6884e+05, 3.8872e+05, 3.8874e+05, 7.8433e+05],
        [3.8754e+05, 3.8756e+05, 3.8758e+05, 7.6561e+05, 0.0000e+00, 3.8756e+05,
         7.6123e+05, 7.6691e+05, 3.8754e+05, 7.5902e+05, 3.8756e+05, 3.8755e+05,
         8.0375e+05, 7.9212e+05, 3.8754e+05, 3.8754e+05, 7.7924e+05],
        [1.3007e+00, 1.2422e+00, 1.2401e+00, 3.8875e+05, 3.8756e+05, 0.0000e+00,
         3.8775e+05, 3.8286e+05, 1.5028e+00, 3.8741e+05, 1.2647e+00, 1.3943e+00,
         3.9268e+05, 3.9298e+05, 1.2519e+00, 1.3142e+00, 4.0026e+05],
        [3.8775e+05, 3.8777e+05, 3.8772e+05, 7.6283e+05, 7.6123e+05, 3.8775e+05,
         0.0000e+00, 7.6912e+05, 3.8774e+05, 7.7881e+05, 3.8777e+05, 3.8779e+05,
         7.8123e+05, 7.9677e+05, 3.8776e+05, 3.8777e+05, 7.8144e+05],
        [3.8285e+05, 3.8285e+05, 3.8287e+05, 7.6915e+05, 7.6691e+05, 3.8286e+05,
         7.6912e+05, 0.0000e+00, 3.8284e+05, 7.6887e+05, 3.8286e+05, 3.8284e+05,
         7.6371e+05, 7.8206e+05, 3.8285e+05, 3.8287e+05, 8.0382e+05],
        [1.6354e+00, 1.4612e+00, 1.4621e+00, 3.8877e+05, 3.8754e+05, 1.5028e+00,
         3.8774e+05, 3.8284e+05, 0.0000e+00, 3.8745e+05, 1.1928e+00, 1.5849e+00,
         3.9267e+05, 3.9303e+05, 1.6119e+00, 1.5569e+00, 4.0027e+05],
        [3.8744e+05, 3.8741e+05, 3.8742e+05, 7.6063e+05, 7.5902e+05, 3.8741e+05,
         7.7881e+05, 7.6887e+05, 3.8745e+05, 0.0000e+00, 3.8743e+05, 3.8743e+05,
         7.9698e+05, 7.8483e+05, 3.8743e+05, 3.8745e+05, 7.9153e+05],
        [1.5136e+00, 1.2558e+00, 1.2472e+00, 3.8875e+05, 3.8756e+05, 1.2647e+00,
         3.8777e+05, 3.8286e+05, 1.1928e+00, 3.8743e+05, 0.0000e+00, 1.4838e+00,
         3.9269e+05, 3.9304e+05, 1.4643e+00, 1.4498e+00, 4.0024e+05],
        [1.3132e+00, 1.3489e+00, 1.2989e+00, 3.8875e+05, 3.8755e+05, 1.3943e+00,
         3.8779e+05, 3.8284e+05, 1.5849e+00, 3.8743e+05, 1.4838e+00, 0.0000e+00,
         3.9267e+05, 3.9300e+05, 1.3992e+00, 1.3494e+00, 4.0027e+05],
        [3.9268e+05, 3.9265e+05, 3.9265e+05, 7.5768e+05, 8.0375e+05, 3.9268e+05,
         7.8123e+05, 7.6371e+05, 3.9267e+05, 7.9698e+05, 3.9269e+05, 3.9267e+05,
         0.0000e+00, 7.8643e+05, 3.9268e+05, 3.9264e+05, 7.8650e+05],
        [3.9298e+05, 3.9301e+05, 3.9300e+05, 7.6884e+05, 7.9212e+05, 3.9298e+05,
         7.9677e+05, 7.8206e+05, 3.9303e+05, 7.8483e+05, 3.9304e+05, 3.9300e+05,
         7.8643e+05, 0.0000e+00, 3.9301e+05, 3.9300e+05, 8.0208e+05],
        [1.2103e+00, 1.2916e+00, 1.3141e+00, 3.8872e+05, 3.8754e+05, 1.2519e+00,
         3.8776e+05, 3.8285e+05, 1.6119e+00, 3.8743e+05, 1.4643e+00, 1.3992e+00,
         3.9268e+05, 3.9301e+05, 0.0000e+00, 1.3478e+00, 4.0024e+05],
        [1.3820e+00, 1.3251e+00, 1.2459e+00, 3.8874e+05, 3.8754e+05, 1.3142e+00,
         3.8777e+05, 3.8287e+05, 1.5569e+00, 3.8745e+05, 1.4498e+00, 1.3494e+00,
         3.9264e+05, 3.9300e+05, 1.3478e+00, 0.0000e+00, 4.0029e+05],
        [4.0026e+05, 4.0028e+05, 4.0026e+05, 7.8433e+05, 7.7924e+05, 4.0026e+05,
         7.8144e+05, 8.0382e+05, 4.0027e+05, 7.9153e+05, 4.0024e+05, 4.0027e+05,
         7.8650e+05, 8.0208e+05, 4.0024e+05, 4.0029e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2103e+00, 1.2838e+00, 1.3007e+00, 1.3132e+00, 1.3496e+00,
        1.3820e+00, 1.5136e+00, 1.6354e+00, 3.8285e+05, 3.8744e+05, 3.8754e+05,
        3.8775e+05, 3.8876e+05, 3.9268e+05, 3.9298e+05, 4.0026e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1905e+00, 1.2422e+00, 1.2558e+00, 1.2838e+00, 1.2916e+00,
        1.3251e+00, 1.3489e+00, 1.4612e+00, 3.8285e+05, 3.8741e+05, 3.8756e+05,
        3.8777e+05, 3.8875e+05, 3.9265e+05, 3.9301e+05, 4.0028e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1905e+00, 1.2401e+00, 1.2459e+00, 1.2472e+00, 1.2989e+00,
        1.3141e+00, 1.3496e+00, 1.4621e+00, 3.8287e+05, 3.8742e+05, 3.8758e+05,
        3.8772e+05, 3.8875e+05, 3.9265e+05, 3.9300e+05, 4.0026e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388721.3750, 388736.3438, 388746.3438, 388747.4062,
        388748.7500, 388749.9688, 388753.2500, 388756.1250, 388767.4375,
        757678.1250, 760626.3125, 762828.0000, 765608.5000, 768836.2500,
        769153.6250, 784326.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387537.6875, 387542.9375, 387542.9375, 387543.1875,
        387550.2812, 387563.5625, 387563.5938, 387563.7812, 387576.2188,
        759015.6875, 761231.8125, 765608.5000, 766907.5625, 779239.9375,
        792123.6250, 803747.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2401e+00, 1.2422e+00, 1.2519e+00, 1.2647e+00, 1.3007e+00,
        1.3142e+00, 1.3943e+00, 1.5028e+00, 3.8286e+05, 3.8741e+05, 3.8756e+05,
        3.8775e+05, 3.8875e+05, 3.9268e+05, 3.9298e+05, 4.0026e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387722.3125, 387742.6250, 387746.3125, 387754.8125,
        387757.8750, 387765.1875, 387767.3438, 387772.1250, 387786.6250,
        761231.8125, 762828.0000, 769119.5000, 778814.1250, 781225.4375,
        781443.5000, 796767.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382840.7500, 382841.3438, 382851.2188, 382852.7500,
        382852.8750, 382855.3125, 382859.2500, 382869.0625, 382873.7188,
        763712.1250, 766907.5625, 768869.2500, 769119.5000, 769153.6250,
        782064.8750, 803817.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1928e+00, 1.4612e+00, 1.4621e+00, 1.5028e+00, 1.5569e+00,
        1.5849e+00, 1.6119e+00, 1.6354e+00, 3.8284e+05, 3.8745e+05, 3.8754e+05,
        3.8774e+05, 3.8877e+05, 3.9267e+05, 3.9303e+05, 4.0027e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387409.7188, 387414.1875, 387423.9062, 387428.0312,
        387430.2188, 387434.2500, 387444.5000, 387448.2812, 387449.8125,
        759015.6875, 760626.3125, 768869.2500, 778814.1250, 784825.1250,
        791534.8750, 796975.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1928e+00, 1.2472e+00, 1.2558e+00, 1.2647e+00, 1.4498e+00,
        1.4643e+00, 1.4838e+00, 1.5136e+00, 3.8286e+05, 3.8743e+05, 3.8756e+05,
        3.8777e+05, 3.8875e+05, 3.9269e+05, 3.9304e+05, 4.0024e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2989e+00, 1.3132e+00, 1.3489e+00, 1.3494e+00, 1.3943e+00,
        1.3992e+00, 1.4838e+00, 1.5849e+00, 3.8284e+05, 3.8743e+05, 3.8755e+05,
        3.8779e+05, 3.8875e+05, 3.9267e+05, 3.9300e+05, 4.0027e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392643.5000, 392650.6562, 392653.2500, 392667.0625,
        392670.4688, 392678.6875, 392678.7188, 392681.8750, 392686.0938,
        757678.1250, 763712.1250, 781225.4375, 786432.8750, 786495.0000,
        796975.4375, 803747.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392980.1250, 392982.8438, 392998.3125, 393000.7500,
        393002.3438, 393005.1562, 393006.4375, 393031.3750, 393038.2188,
        768836.2500, 782064.8750, 784825.1250, 786432.8750, 792123.6250,
        796767.2500, 802083.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2103e+00, 1.2519e+00, 1.2916e+00, 1.3141e+00, 1.3478e+00,
        1.3992e+00, 1.4643e+00, 1.6119e+00, 3.8285e+05, 3.8743e+05, 3.8754e+05,
        3.8776e+05, 3.8872e+05, 3.9268e+05, 3.9301e+05, 4.0024e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2459e+00, 1.3142e+00, 1.3251e+00, 1.3478e+00, 1.3494e+00,
        1.3820e+00, 1.4498e+00, 1.5569e+00, 3.8287e+05, 3.8745e+05, 3.8754e+05,
        3.8777e+05, 3.8874e+05, 3.9264e+05, 3.9300e+05, 4.0029e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400240.1875, 400242.9375, 400259.0000, 400263.5625,
        400263.7500, 400269.2188, 400273.5938, 400277.1562, 400285.2812,
        779239.9375, 781443.5000, 784326.0000, 786495.0000, 791534.8750,
        802083.6250, 803817.7500])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77030.67', '77027.29', '77030.80', '425640.50', '424700.00', '77028.01', '425104.69', '420940.84', '77030.10', '424589.88', '77030.44', '77028.27', '429168.84', '430588.16', '77029.16', '77032.98', '438161.44']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 6, 6, 8, 6, 8, 8, 6, 6, 8, 8, 6]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0124s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:17...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:17, End: 2025-07-22 15:29:17)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 19, 17, 1, 9, 18, 8, 4, 3, 14, 11, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.4037e+00, 3.7889e+05, 3.8368e+05, 1.3471e+00, 1.4402e+00,
         3.9939e+05, 1.3529e+00, 1.4702e+00, 1.2701e+00, 3.8316e+05, 1.2033e+00,
         1.5418e+00, 1.2600e+00],
        [1.4037e+00, 0.0000e+00, 3.7891e+05, 3.8370e+05, 1.2955e+00, 1.2028e+00,
         3.9939e+05, 1.2774e+00, 1.2373e+00, 1.2994e+00, 3.8316e+05, 1.3599e+00,
         1.2635e+00, 1.2123e+00],
        [3.7889e+05, 3.7891e+05, 0.0000e+00, 7.9029e+05, 3.7890e+05, 3.7889e+05,
         7.7305e+05, 3.7891e+05, 3.7890e+05, 3.7892e+05, 7.4323e+05, 3.7891e+05,
         3.7891e+05, 3.7890e+05],
        [3.8368e+05, 3.8370e+05, 7.9029e+05, 0.0000e+00, 3.8367e+05, 3.8368e+05,
         8.0199e+05, 3.8364e+05, 3.8369e+05, 3.8368e+05, 7.5915e+05, 3.8366e+05,
         3.8369e+05, 3.8367e+05],
        [1.3471e+00, 1.2955e+00, 3.7890e+05, 3.8367e+05, 0.0000e+00, 1.2339e+00,
         3.9940e+05, 1.2908e+00, 1.2910e+00, 1.4196e+00, 3.8314e+05, 1.2968e+00,
         1.3092e+00, 1.2834e+00],
        [1.4402e+00, 1.2028e+00, 3.7889e+05, 3.8368e+05, 1.2339e+00, 0.0000e+00,
         3.9937e+05, 1.0325e+00, 1.0676e+00, 1.4054e+00, 3.8312e+05, 1.3889e+00,
         9.1526e-01, 1.2200e+00],
        [3.9939e+05, 3.9939e+05, 7.7305e+05, 8.0199e+05, 3.9940e+05, 3.9937e+05,
         0.0000e+00, 3.9941e+05, 3.9940e+05, 3.9940e+05, 7.8151e+05, 3.9939e+05,
         3.9938e+05, 3.9936e+05],
        [1.3529e+00, 1.2774e+00, 3.7891e+05, 3.8364e+05, 1.2908e+00, 1.0325e+00,
         3.9941e+05, 0.0000e+00, 1.1121e+00, 1.3010e+00, 3.8314e+05, 1.3650e+00,
         1.0172e+00, 1.1471e+00],
        [1.4702e+00, 1.2373e+00, 3.7890e+05, 3.8369e+05, 1.2910e+00, 1.0676e+00,
         3.9940e+05, 1.1121e+00, 0.0000e+00, 1.4088e+00, 3.8315e+05, 1.4366e+00,
         1.0127e+00, 1.2437e+00],
        [1.2701e+00, 1.2994e+00, 3.7892e+05, 3.8368e+05, 1.4196e+00, 1.4054e+00,
         3.9940e+05, 1.3010e+00, 1.4088e+00, 0.0000e+00, 3.8314e+05, 1.3652e+00,
         1.5118e+00, 1.1324e+00],
        [3.8316e+05, 3.8316e+05, 7.4323e+05, 7.5915e+05, 3.8314e+05, 3.8312e+05,
         7.8151e+05, 3.8314e+05, 3.8315e+05, 3.8314e+05, 0.0000e+00, 3.8315e+05,
         3.8311e+05, 3.8314e+05],
        [1.2033e+00, 1.3599e+00, 3.7891e+05, 3.8366e+05, 1.2968e+00, 1.3889e+00,
         3.9939e+05, 1.3650e+00, 1.4366e+00, 1.3652e+00, 3.8315e+05, 0.0000e+00,
         1.4745e+00, 1.2188e+00],
        [1.5418e+00, 1.2635e+00, 3.7891e+05, 3.8369e+05, 1.3092e+00, 9.1526e-01,
         3.9938e+05, 1.0172e+00, 1.0127e+00, 1.5118e+00, 3.8311e+05, 1.4745e+00,
         0.0000e+00, 1.2653e+00],
        [1.2600e+00, 1.2123e+00, 3.7890e+05, 3.8367e+05, 1.2834e+00, 1.2200e+00,
         3.9936e+05, 1.1471e+00, 1.2437e+00, 1.1324e+00, 3.8314e+05, 1.2188e+00,
         1.2653e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2033e+00, 1.2600e+00, 1.2701e+00, 1.3471e+00, 1.3529e+00,
        1.4037e+00, 1.4402e+00, 1.4702e+00, 1.5418e+00, 3.7889e+05, 3.8316e+05,
        3.8368e+05, 3.9939e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2028e+00, 1.2123e+00, 1.2373e+00, 1.2635e+00, 1.2774e+00,
        1.2955e+00, 1.2994e+00, 1.3599e+00, 1.4037e+00, 3.7891e+05, 3.8316e+05,
        3.8370e+05, 3.9939e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 378889.6875, 378892.7500, 378895.5312, 378896.2500,
        378900.8125, 378906.2500, 378911.3750, 378911.6875, 378914.8125,
        378917.9062, 743234.2500, 773050.6875, 790285.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383643.4688, 383664.8750, 383672.3438, 383673.4062,
        383676.6562, 383677.1562, 383681.5312, 383686.4375, 383686.6250,
        383696.4375, 759145.4375, 790285.9375, 801991.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2339e+00, 1.2834e+00, 1.2908e+00, 1.2910e+00, 1.2955e+00,
        1.2968e+00, 1.3092e+00, 1.3471e+00, 1.4196e+00, 3.7890e+05, 3.8314e+05,
        3.8367e+05, 3.9940e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.1526e-01, 1.0325e+00, 1.0676e+00, 1.2028e+00, 1.2200e+00,
        1.2339e+00, 1.3889e+00, 1.4054e+00, 1.4402e+00, 3.7889e+05, 3.8312e+05,
        3.8368e+05, 3.9937e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 399364.7500, 399368.8438, 399377.2812, 399386.3750,
        399388.0000, 399394.0625, 399397.1562, 399397.4375, 399398.6562,
        399410.1875, 773050.6875, 781508.4375, 801991.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0172e+00, 1.0325e+00, 1.1121e+00, 1.1471e+00, 1.2774e+00,
        1.2908e+00, 1.3010e+00, 1.3529e+00, 1.3650e+00, 3.7891e+05, 3.8314e+05,
        3.8364e+05, 3.9941e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0127e+00, 1.0676e+00, 1.1121e+00, 1.2373e+00, 1.2437e+00,
        1.2910e+00, 1.4088e+00, 1.4366e+00, 1.4702e+00, 3.7890e+05, 3.8315e+05,
        3.8369e+05, 3.9940e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1324e+00, 1.2701e+00, 1.2994e+00, 1.3010e+00, 1.3652e+00,
        1.4054e+00, 1.4088e+00, 1.4196e+00, 1.5118e+00, 3.7892e+05, 3.8314e+05,
        3.8368e+05, 3.9940e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 383112.8125, 383124.6250, 383137.6562, 383138.5625,
        383139.4062, 383144.4375, 383146.0312, 383147.5938, 383157.1875,
        383164.0312, 743234.2500, 759145.4375, 781508.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2033e+00, 1.2188e+00, 1.2968e+00, 1.3599e+00, 1.3650e+00,
        1.3652e+00, 1.3889e+00, 1.4366e+00, 1.4745e+00, 3.7891e+05, 3.8315e+05,
        3.8366e+05, 3.9939e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.1526e-01, 1.0127e+00, 1.0172e+00, 1.2635e+00, 1.2653e+00,
        1.3092e+00, 1.4745e+00, 1.5118e+00, 1.5418e+00, 3.7891e+05, 3.8311e+05,
        3.8369e+05, 3.9938e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1324e+00, 1.1471e+00, 1.2123e+00, 1.2188e+00, 1.2200e+00,
        1.2437e+00, 1.2600e+00, 1.2653e+00, 1.2834e+00, 3.7890e+05, 3.8314e+05,
        3.8367e+05, 3.9936e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.37', '1.28', '378903.66', '383675.91', '1.31', '1.21', '399388.28', '1.21', '1.25', '1.35', '383141.25', '1.35', '1.26', '1.22']
estimated f for each client, fs: [4, 4, 2, 2, 4, 4, 2, 4, 4, 4, 2, 4, 4, 4]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 19, 17, 1, 9, 18, 8, 4, 3, 14, 11, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0334s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:18...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:18, End: 2025-07-22 15:29:18)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 9, 20, 18, 15, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.2044e+00, 1.1803e+00, 3.8678e+05, 1.1650e+00, 1.3271e+00,
         3.8879e+05, 3.7934e+05, 4.0684e+05, 1.2406e+00, 3.8998e+05, 3.9585e+05,
         1.0530e+00, 1.1748e+00, 4.0170e+05, 1.3695e+00, 1.1440e+00],
        [1.2044e+00, 0.0000e+00, 1.1327e+00, 3.8678e+05, 1.1415e+00, 9.4087e-01,
         3.8881e+05, 3.7933e+05, 4.0680e+05, 1.0117e+00, 3.8998e+05, 3.9583e+05,
         1.2469e+00, 1.2816e+00, 4.0169e+05, 9.4449e-01, 1.1629e+00],
        [1.1803e+00, 1.1327e+00, 0.0000e+00, 3.8683e+05, 1.1208e+00, 1.0999e+00,
         3.8881e+05, 3.7933e+05, 4.0683e+05, 1.0852e+00, 3.8998e+05, 3.9584e+05,
         1.1652e+00, 1.0756e+00, 4.0169e+05, 1.1779e+00, 1.1069e+00],
        [3.8678e+05, 3.8678e+05, 3.8683e+05, 0.0000e+00, 3.8679e+05, 3.8677e+05,
         7.9540e+05, 7.8228e+05, 7.8194e+05, 3.8681e+05, 7.9263e+05, 7.8269e+05,
         3.8682e+05, 3.8680e+05, 7.9288e+05, 3.8678e+05, 3.8679e+05],
        [1.1650e+00, 1.1415e+00, 1.1208e+00, 3.8679e+05, 0.0000e+00, 1.1276e+00,
         3.8879e+05, 3.7934e+05, 4.0679e+05, 1.1144e+00, 3.8997e+05, 3.9587e+05,
         1.1084e+00, 1.1275e+00, 4.0169e+05, 1.2245e+00, 1.1465e+00],
        [1.3271e+00, 9.4087e-01, 1.0999e+00, 3.8677e+05, 1.1276e+00, 0.0000e+00,
         3.8879e+05, 3.7936e+05, 4.0678e+05, 9.7589e-01, 3.9000e+05, 3.9585e+05,
         1.2716e+00, 1.2243e+00, 4.0168e+05, 8.7674e-01, 1.1409e+00],
        [3.8879e+05, 3.8881e+05, 3.8881e+05, 7.9540e+05, 3.8879e+05, 3.8879e+05,
         0.0000e+00, 7.5573e+05, 7.8624e+05, 3.8880e+05, 7.7799e+05, 7.8205e+05,
         3.8878e+05, 3.8878e+05, 7.8218e+05, 3.8878e+05, 3.8877e+05],
        [3.7934e+05, 3.7933e+05, 3.7933e+05, 7.8228e+05, 3.7934e+05, 3.7936e+05,
         7.5573e+05, 0.0000e+00, 7.8745e+05, 3.7935e+05, 7.6055e+05, 7.7484e+05,
         3.7935e+05, 3.7935e+05, 7.8257e+05, 3.7936e+05, 3.7934e+05],
        [4.0684e+05, 4.0680e+05, 4.0683e+05, 7.8194e+05, 4.0679e+05, 4.0678e+05,
         7.8624e+05, 7.8745e+05, 0.0000e+00, 4.0679e+05, 7.7461e+05, 7.6924e+05,
         4.0681e+05, 4.0680e+05, 7.9687e+05, 4.0681e+05, 4.0679e+05],
        [1.2406e+00, 1.0117e+00, 1.0852e+00, 3.8681e+05, 1.1144e+00, 9.7589e-01,
         3.8880e+05, 3.7935e+05, 4.0679e+05, 0.0000e+00, 3.8996e+05, 3.9586e+05,
         1.2096e+00, 1.2482e+00, 4.0167e+05, 9.4104e-01, 1.1143e+00],
        [3.8998e+05, 3.8998e+05, 3.8998e+05, 7.9263e+05, 3.8997e+05, 3.9000e+05,
         7.7799e+05, 7.6055e+05, 7.7461e+05, 3.8996e+05, 0.0000e+00, 7.9118e+05,
         3.9000e+05, 3.8998e+05, 7.8685e+05, 3.8998e+05, 3.8998e+05],
        [3.9585e+05, 3.9583e+05, 3.9584e+05, 7.8269e+05, 3.9587e+05, 3.9585e+05,
         7.8205e+05, 7.7484e+05, 7.6924e+05, 3.9586e+05, 7.9118e+05, 0.0000e+00,
         3.9586e+05, 3.9586e+05, 8.0883e+05, 3.9586e+05, 3.9587e+05],
        [1.0530e+00, 1.2469e+00, 1.1652e+00, 3.8682e+05, 1.1084e+00, 1.2716e+00,
         3.8878e+05, 3.7935e+05, 4.0681e+05, 1.2096e+00, 3.9000e+05, 3.9586e+05,
         0.0000e+00, 1.1579e+00, 4.0165e+05, 1.3628e+00, 1.1029e+00],
        [1.1748e+00, 1.2816e+00, 1.0756e+00, 3.8680e+05, 1.1275e+00, 1.2243e+00,
         3.8878e+05, 3.7935e+05, 4.0680e+05, 1.2482e+00, 3.8998e+05, 3.9586e+05,
         1.1579e+00, 0.0000e+00, 4.0167e+05, 1.3530e+00, 1.1232e+00],
        [4.0170e+05, 4.0169e+05, 4.0169e+05, 7.9288e+05, 4.0169e+05, 4.0168e+05,
         7.8218e+05, 7.8257e+05, 7.9687e+05, 4.0167e+05, 7.8685e+05, 8.0883e+05,
         4.0165e+05, 4.0167e+05, 0.0000e+00, 4.0169e+05, 4.0170e+05],
        [1.3695e+00, 9.4449e-01, 1.1779e+00, 3.8678e+05, 1.2245e+00, 8.7674e-01,
         3.8878e+05, 3.7936e+05, 4.0681e+05, 9.4104e-01, 3.8998e+05, 3.9586e+05,
         1.3628e+00, 1.3530e+00, 4.0169e+05, 0.0000e+00, 1.1735e+00],
        [1.1440e+00, 1.1629e+00, 1.1069e+00, 3.8679e+05, 1.1465e+00, 1.1409e+00,
         3.8877e+05, 3.7934e+05, 4.0679e+05, 1.1143e+00, 3.8998e+05, 3.9587e+05,
         1.1029e+00, 1.1232e+00, 4.0170e+05, 1.1735e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0530e+00, 1.1440e+00, 1.1650e+00, 1.1748e+00, 1.1803e+00,
        1.2044e+00, 1.2406e+00, 1.3271e+00, 1.3695e+00, 3.7934e+05, 3.8678e+05,
        3.8879e+05, 3.8998e+05, 3.9585e+05, 4.0170e+05, 4.0684e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4087e-01, 9.4449e-01, 1.0117e+00, 1.1327e+00, 1.1415e+00,
        1.1629e+00, 1.2044e+00, 1.2469e+00, 1.2816e+00, 3.7933e+05, 3.8678e+05,
        3.8881e+05, 3.8998e+05, 3.9583e+05, 4.0169e+05, 4.0680e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0756e+00, 1.0852e+00, 1.0999e+00, 1.1069e+00, 1.1208e+00,
        1.1327e+00, 1.1652e+00, 1.1779e+00, 1.1803e+00, 3.7933e+05, 3.8683e+05,
        3.8881e+05, 3.8998e+05, 3.9584e+05, 4.0169e+05, 4.0683e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386767.0000, 386776.6562, 386782.4688, 386783.5625,
        386785.6250, 386791.8125, 386797.7188, 386808.4375, 386816.9688,
        386833.7500, 781941.5000, 782278.4375, 782686.2500, 792630.5625,
        792880.7500, 795402.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1084e+00, 1.1144e+00, 1.1208e+00, 1.1275e+00, 1.1276e+00,
        1.1415e+00, 1.1465e+00, 1.1650e+00, 1.2245e+00, 3.7934e+05, 3.8679e+05,
        3.8879e+05, 3.8997e+05, 3.9587e+05, 4.0169e+05, 4.0679e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7674e-01, 9.4087e-01, 9.7589e-01, 1.0999e+00, 1.1276e+00,
        1.1409e+00, 1.2243e+00, 1.2716e+00, 1.3271e+00, 3.7936e+05, 3.8677e+05,
        3.8879e+05, 3.9000e+05, 3.9585e+05, 4.0168e+05, 4.0678e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388773.1250, 388776.1250, 388781.3750, 388782.7812,
        388785.6250, 388792.0625, 388793.6875, 388803.2500, 388805.7188,
        388806.5938, 755726.1250, 777989.7500, 782046.1250, 782176.3750,
        786238.4375, 795402.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379329.1562, 379332.7188, 379336.0000, 379338.9062,
        379343.1250, 379345.7188, 379346.0312, 379350.5938, 379360.2500,
        379362.2500, 755726.1250, 760545.1250, 774840.0625, 782278.4375,
        782565.6250, 787452.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406782.0000, 406786.3125, 406788.7188, 406791.7188,
        406801.4688, 406803.6562, 406809.8750, 406812.4688, 406827.8750,
        406838.0000, 769236.6875, 774612.1875, 781941.5000, 786238.4375,
        787452.6250, 796868.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4104e-01, 9.7589e-01, 1.0117e+00, 1.0852e+00, 1.1143e+00,
        1.1144e+00, 1.2096e+00, 1.2406e+00, 1.2482e+00, 3.7935e+05, 3.8681e+05,
        3.8880e+05, 3.8996e+05, 3.9586e+05, 4.0167e+05, 4.0679e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389961.9688, 389974.2812, 389977.5000, 389977.6250,
        389981.8438, 389982.1250, 389983.0000, 389984.9375, 389995.8125,
        389998.8438, 760545.1250, 774612.1875, 777989.7500, 786849.0625,
        791183.2500, 792630.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395833.0312, 395836.5312, 395849.5312, 395852.3750,
        395857.3750, 395861.2188, 395861.4062, 395864.9062, 395866.0625,
        395871.5000, 769236.6875, 774840.0625, 782046.1250, 782686.2500,
        791183.2500, 808832.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0530e+00, 1.1029e+00, 1.1084e+00, 1.1579e+00, 1.1652e+00,
        1.2096e+00, 1.2469e+00, 1.2716e+00, 1.3628e+00, 3.7935e+05, 3.8682e+05,
        3.8878e+05, 3.9000e+05, 3.9586e+05, 4.0165e+05, 4.0681e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0756e+00, 1.1232e+00, 1.1275e+00, 1.1579e+00, 1.1748e+00,
        1.2243e+00, 1.2482e+00, 1.2816e+00, 1.3530e+00, 3.7935e+05, 3.8680e+05,
        3.8878e+05, 3.8998e+05, 3.9586e+05, 4.0167e+05, 4.0680e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401651.0938, 401670.3750, 401673.2500, 401676.2188,
        401685.6250, 401690.9375, 401691.3438, 401692.3750, 401695.5625,
        401702.4688, 782176.3750, 782565.6250, 786849.0625, 792880.7500,
        796868.4375, 808832.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7674e-01, 9.4104e-01, 9.4449e-01, 1.1735e+00, 1.1779e+00,
        1.2245e+00, 1.3530e+00, 1.3628e+00, 1.3695e+00, 3.7936e+05, 3.8678e+05,
        3.8878e+05, 3.8998e+05, 3.9586e+05, 4.0169e+05, 4.0681e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1029e+00, 1.1069e+00, 1.1143e+00, 1.1232e+00, 1.1409e+00,
        1.1440e+00, 1.1465e+00, 1.1629e+00, 1.1735e+00, 3.7934e+05, 3.8679e+05,
        3.8877e+05, 3.8998e+05, 3.9587e+05, 4.0170e+05, 4.0679e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37935.39', '37933.92', '37934.28', '386794.38', '37934.92', '37937.02', '388790.03', '379344.44', '406804.16', '37935.59', '389981.78', '395855.41', '37935.64', '37936.14', '401682.91', '37937.26', '37934.62']
estimated f for each client, fs: [7, 7, 7, 6, 7, 7, 5, 5, 5, 7, 5, 5, 7, 7, 5, 7, 7]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 15, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0119s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:18...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:18, End: 2025-07-22 15:29:18)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 19, 1, 9, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1900e+00, 3.8814e+05, 1.1638e+00, 1.2215e+00, 4.0481e+05,
         1.3111e+00, 4.0047e+05, 1.1966e+00, 4.1314e+05, 3.7998e+05, 1.0321e+00,
         1.1695e+00, 3.9698e+05, 1.2720e+00, 1.1147e+00],
        [1.1900e+00, 0.0000e+00, 3.8813e+05, 1.0872e+00, 1.0101e+00, 4.0484e+05,
         1.1978e+00, 4.0049e+05, 1.0173e+00, 4.1314e+05, 3.7998e+05, 1.1468e+00,
         1.0613e+00, 3.9702e+05, 1.0810e+00, 1.0449e+00],
        [3.8814e+05, 3.8813e+05, 0.0000e+00, 3.8811e+05, 3.8815e+05, 7.8738e+05,
         3.8813e+05, 7.6499e+05, 3.8814e+05, 8.1201e+05, 7.8290e+05, 3.8815e+05,
         3.8812e+05, 7.8136e+05, 3.8814e+05, 3.8813e+05],
        [1.1638e+00, 1.0872e+00, 3.8811e+05, 0.0000e+00, 1.0452e+00, 4.0482e+05,
         1.2300e+00, 4.0048e+05, 1.0730e+00, 4.1317e+05, 3.7995e+05, 1.0962e+00,
         1.1210e+00, 3.9697e+05, 1.1213e+00, 1.1001e+00],
        [1.2215e+00, 1.0101e+00, 3.8815e+05, 1.0452e+00, 0.0000e+00, 4.0483e+05,
         8.7962e-01, 4.0050e+05, 9.3998e-01, 4.1317e+05, 3.7997e+05, 1.1954e+00,
         1.1828e+00, 3.9698e+05, 7.9018e-01, 1.0763e+00],
        [4.0481e+05, 4.0484e+05, 7.8738e+05, 4.0482e+05, 4.0483e+05, 0.0000e+00,
         4.0476e+05, 8.0546e+05, 4.0480e+05, 8.0476e+05, 7.9243e+05, 4.0481e+05,
         4.0484e+05, 7.8861e+05, 4.0481e+05, 4.0478e+05],
        [1.3111e+00, 1.1978e+00, 3.8813e+05, 1.2300e+00, 8.7962e-01, 4.0476e+05,
         0.0000e+00, 4.0050e+05, 1.0054e+00, 4.1315e+05, 3.7996e+05, 1.3544e+00,
         1.3024e+00, 3.9698e+05, 7.9869e-01, 1.1420e+00],
        [4.0047e+05, 4.0049e+05, 7.6499e+05, 4.0048e+05, 4.0050e+05, 8.0546e+05,
         4.0050e+05, 0.0000e+00, 4.0049e+05, 8.0170e+05, 7.6200e+05, 4.0050e+05,
         4.0047e+05, 8.0596e+05, 4.0049e+05, 4.0047e+05],
        [1.1966e+00, 1.0173e+00, 3.8814e+05, 1.0730e+00, 9.3998e-01, 4.0480e+05,
         1.0054e+00, 4.0049e+05, 0.0000e+00, 4.1316e+05, 3.7993e+05, 1.1870e+00,
         1.1532e+00, 3.9699e+05, 8.9502e-01, 1.0714e+00],
        [4.1314e+05, 4.1314e+05, 8.1201e+05, 4.1317e+05, 4.1317e+05, 8.0476e+05,
         4.1315e+05, 8.0170e+05, 4.1316e+05, 0.0000e+00, 7.5612e+05, 4.1315e+05,
         4.1317e+05, 8.2672e+05, 4.1315e+05, 4.1314e+05],
        [3.7998e+05, 3.7998e+05, 7.8290e+05, 3.7995e+05, 3.7997e+05, 7.9243e+05,
         3.7996e+05, 7.6200e+05, 3.7993e+05, 7.5612e+05, 0.0000e+00, 3.7998e+05,
         3.7996e+05, 7.7464e+05, 3.7996e+05, 3.7995e+05],
        [1.0321e+00, 1.1468e+00, 3.8815e+05, 1.0962e+00, 1.1954e+00, 4.0481e+05,
         1.3544e+00, 4.0050e+05, 1.1870e+00, 4.1315e+05, 3.7998e+05, 0.0000e+00,
         1.1406e+00, 3.9697e+05, 1.2738e+00, 1.1002e+00],
        [1.1695e+00, 1.0613e+00, 3.8812e+05, 1.1210e+00, 1.1828e+00, 4.0484e+05,
         1.3024e+00, 4.0047e+05, 1.1532e+00, 4.1317e+05, 3.7996e+05, 1.1406e+00,
         0.0000e+00, 3.9698e+05, 1.2384e+00, 1.0971e+00],
        [3.9698e+05, 3.9702e+05, 7.8136e+05, 3.9697e+05, 3.9698e+05, 7.8861e+05,
         3.9698e+05, 8.0596e+05, 3.9699e+05, 8.2672e+05, 7.7464e+05, 3.9697e+05,
         3.9698e+05, 0.0000e+00, 3.9699e+05, 3.9698e+05],
        [1.2720e+00, 1.0810e+00, 3.8814e+05, 1.1213e+00, 7.9018e-01, 4.0481e+05,
         7.9869e-01, 4.0049e+05, 8.9502e-01, 4.1315e+05, 3.7996e+05, 1.2738e+00,
         1.2384e+00, 3.9699e+05, 0.0000e+00, 1.0786e+00],
        [1.1147e+00, 1.0449e+00, 3.8813e+05, 1.1001e+00, 1.0763e+00, 4.0478e+05,
         1.1420e+00, 4.0047e+05, 1.0714e+00, 4.1314e+05, 3.7995e+05, 1.1002e+00,
         1.0971e+00, 3.9698e+05, 1.0786e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0321e+00, 1.1147e+00, 1.1638e+00, 1.1695e+00, 1.1900e+00,
        1.1966e+00, 1.2215e+00, 1.2720e+00, 1.3111e+00, 3.7998e+05, 3.8814e+05,
        3.9698e+05, 4.0047e+05, 4.0481e+05, 4.1314e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0101e+00, 1.0173e+00, 1.0449e+00, 1.0613e+00, 1.0810e+00,
        1.0872e+00, 1.1468e+00, 1.1900e+00, 1.1978e+00, 3.7998e+05, 3.8813e+05,
        3.9702e+05, 4.0049e+05, 4.0484e+05, 4.1314e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388110.3438, 388121.9062, 388126.9062, 388129.3125,
        388133.8125, 388137.8125, 388139.7500, 388142.5312, 388145.9375,
        388150.0000, 764989.5625, 781361.7500, 782900.6250, 787376.3125,
        812011.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0452e+00, 1.0730e+00, 1.0872e+00, 1.0962e+00, 1.1001e+00,
        1.1210e+00, 1.1213e+00, 1.1638e+00, 1.2300e+00, 3.7995e+05, 3.8811e+05,
        3.9697e+05, 4.0048e+05, 4.0482e+05, 4.1317e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.9018e-01, 8.7962e-01, 9.3998e-01, 1.0101e+00, 1.0452e+00,
        1.0763e+00, 1.1828e+00, 1.1954e+00, 1.2215e+00, 3.7997e+05, 3.8815e+05,
        3.9698e+05, 4.0050e+05, 4.0483e+05, 4.1317e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404762.7500, 404782.1250, 404797.4062, 404806.2188,
        404806.6562, 404812.1250, 404824.4375, 404826.5625, 404838.0625,
        404843.5938, 787376.3125, 788614.5000, 792433.3750, 804761.0000,
        805462.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.9869e-01, 8.7962e-01, 1.0054e+00, 1.1420e+00, 1.1978e+00,
        1.2300e+00, 1.3024e+00, 1.3111e+00, 1.3544e+00, 3.7996e+05, 3.8813e+05,
        3.9698e+05, 4.0050e+05, 4.0476e+05, 4.1315e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400469.1875, 400469.5938, 400470.3750, 400476.4375,
        400488.6875, 400491.3125, 400493.6250, 400495.3750, 400496.9375,
        400499.7188, 762000.6875, 764989.5625, 801704.1250, 805462.3125,
        805955.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9502e-01, 9.3998e-01, 1.0054e+00, 1.0173e+00, 1.0714e+00,
        1.0730e+00, 1.1532e+00, 1.1870e+00, 1.1966e+00, 3.7993e+05, 3.8814e+05,
        3.9699e+05, 4.0049e+05, 4.0480e+05, 4.1316e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 413135.0625, 413137.0000, 413142.2500, 413146.0938,
        413151.7812, 413153.0312, 413158.9375, 413165.9688, 413168.6562,
        413174.5625, 756116.0000, 801704.1250, 804761.0000, 812011.5000,
        826721.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379933.9062, 379953.5312, 379954.9688, 379956.9375,
        379962.7812, 379963.0938, 379971.7500, 379977.9688, 379978.9688,
        379981.6875, 756116.0000, 762000.6875, 774643.8125, 782900.6250,
        792433.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0321e+00, 1.0962e+00, 1.1002e+00, 1.1406e+00, 1.1468e+00,
        1.1870e+00, 1.1954e+00, 1.2738e+00, 1.3544e+00, 3.7998e+05, 3.8815e+05,
        3.9697e+05, 4.0050e+05, 4.0481e+05, 4.1315e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0613e+00, 1.0971e+00, 1.1210e+00, 1.1406e+00, 1.1532e+00,
        1.1695e+00, 1.1828e+00, 1.2384e+00, 1.3024e+00, 3.7996e+05, 3.8812e+05,
        3.9698e+05, 4.0047e+05, 4.0484e+05, 4.1317e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396967.9688, 396970.1875, 396976.5312, 396979.2500,
        396981.5625, 396983.0000, 396984.0625, 396987.4062, 396991.7812,
        397023.8125, 774643.8125, 781361.7500, 788614.5000, 805955.4375,
        826721.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.9018e-01, 7.9869e-01, 8.9502e-01, 1.0786e+00, 1.0810e+00,
        1.1213e+00, 1.2384e+00, 1.2720e+00, 1.2738e+00, 3.7996e+05, 3.8814e+05,
        3.9699e+05, 4.0049e+05, 4.0481e+05, 4.1315e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0449e+00, 1.0714e+00, 1.0763e+00, 1.0786e+00, 1.0971e+00,
        1.1001e+00, 1.1002e+00, 1.1147e+00, 1.1420e+00, 3.7995e+05, 3.8813e+05,
        3.9698e+05, 4.0047e+05, 4.0478e+05, 4.1314e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37999.23', '37998.78', '388133.81', '37996.35', '37998.10', '404810.00', '37996.71', '400485.16', '37994.34', '413153.31', '379963.56', '37998.95', '37997.32', '396984.56', '37997.27', '37996.48']
estimated f for each client, fs: [6, 6, 4, 6, 6, 4, 6, 4, 6, 4, 4, 6, 6, 4, 6, 6]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 2, 19, 1, 9, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0108s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:19...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:19, End: 2025-07-22 15:29:19)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3791e+00, 3.8991e+05, 3.9594e+05, 1.1393e+00, 1.2527e+00,
         3.8661e+05, 3.9413e+05, 1.2486e+00, 3.9247e+05, 1.1069e+00, 3.8467e+05,
         1.1355e+00, 4.1038e+05, 1.3332e+00, 1.1079e+00],
        [1.3791e+00, 0.0000e+00, 3.8993e+05, 3.9593e+05, 1.2547e+00, 9.1652e-01,
         3.8663e+05, 3.9413e+05, 8.5543e-01, 3.9248e+05, 1.4423e+00, 3.8469e+05,
         1.3891e+00, 4.1037e+05, 8.6459e-01, 1.2544e+00],
        [3.8991e+05, 3.8993e+05, 0.0000e+00, 7.7167e+05, 3.8993e+05, 3.8994e+05,
         7.6325e+05, 7.8578e+05, 3.8993e+05, 7.8532e+05, 3.8992e+05, 7.7362e+05,
         3.8996e+05, 7.7983e+05, 3.8996e+05, 3.8993e+05],
        [3.9594e+05, 3.9593e+05, 7.7167e+05, 0.0000e+00, 3.9594e+05, 3.9593e+05,
         7.8919e+05, 7.8007e+05, 3.9592e+05, 7.9951e+05, 3.9592e+05, 7.9478e+05,
         3.9595e+05, 7.9650e+05, 3.9595e+05, 3.9592e+05],
        [1.1393e+00, 1.2547e+00, 3.8993e+05, 3.9594e+05, 0.0000e+00, 1.0861e+00,
         3.8663e+05, 3.9415e+05, 1.1630e+00, 3.9247e+05, 1.1655e+00, 3.8472e+05,
         1.0975e+00, 4.1037e+05, 1.1624e+00, 1.0852e+00],
        [1.2527e+00, 9.1652e-01, 3.8994e+05, 3.9593e+05, 1.0861e+00, 0.0000e+00,
         3.8664e+05, 3.9414e+05, 8.6325e-01, 3.9248e+05, 1.2185e+00, 3.8469e+05,
         1.1941e+00, 4.1038e+05, 8.3388e-01, 1.0818e+00],
        [3.8661e+05, 3.8663e+05, 7.6325e+05, 7.8919e+05, 3.8663e+05, 3.8664e+05,
         0.0000e+00, 7.9865e+05, 3.8663e+05, 7.7060e+05, 3.8665e+05, 7.7660e+05,
         3.8663e+05, 8.0955e+05, 3.8664e+05, 3.8665e+05],
        [3.9413e+05, 3.9413e+05, 7.8578e+05, 7.8007e+05, 3.9415e+05, 3.9414e+05,
         7.9865e+05, 0.0000e+00, 3.9412e+05, 8.0716e+05, 3.9413e+05, 7.6230e+05,
         3.9416e+05, 8.0720e+05, 3.9411e+05, 3.9416e+05],
        [1.2486e+00, 8.5543e-01, 3.8993e+05, 3.9592e+05, 1.1630e+00, 8.6325e-01,
         3.8663e+05, 3.9412e+05, 0.0000e+00, 3.9248e+05, 1.2120e+00, 3.8469e+05,
         1.2097e+00, 4.1039e+05, 8.3192e-01, 1.0493e+00],
        [3.9247e+05, 3.9248e+05, 7.8532e+05, 7.9951e+05, 3.9247e+05, 3.9248e+05,
         7.7060e+05, 8.0716e+05, 3.9248e+05, 0.0000e+00, 3.9250e+05, 7.8269e+05,
         3.9251e+05, 7.9859e+05, 3.9250e+05, 3.9248e+05],
        [1.1069e+00, 1.4423e+00, 3.8992e+05, 3.9592e+05, 1.1655e+00, 1.2185e+00,
         3.8665e+05, 3.9413e+05, 1.2120e+00, 3.9250e+05, 0.0000e+00, 3.8467e+05,
         1.1091e+00, 4.1034e+05, 1.3060e+00, 9.9263e-01],
        [3.8467e+05, 3.8469e+05, 7.7362e+05, 7.9478e+05, 3.8472e+05, 3.8469e+05,
         7.7660e+05, 7.6230e+05, 3.8469e+05, 7.8269e+05, 3.8467e+05, 0.0000e+00,
         3.8469e+05, 7.9306e+05, 3.8469e+05, 3.8467e+05],
        [1.1355e+00, 1.3891e+00, 3.8996e+05, 3.9595e+05, 1.0975e+00, 1.1941e+00,
         3.8663e+05, 3.9416e+05, 1.2097e+00, 3.9251e+05, 1.1091e+00, 3.8469e+05,
         0.0000e+00, 4.1038e+05, 1.2566e+00, 1.0663e+00],
        [4.1038e+05, 4.1037e+05, 7.7983e+05, 7.9650e+05, 4.1037e+05, 4.1038e+05,
         8.0955e+05, 8.0720e+05, 4.1039e+05, 7.9859e+05, 4.1034e+05, 7.9306e+05,
         4.1038e+05, 0.0000e+00, 4.1038e+05, 4.1037e+05],
        [1.3332e+00, 8.6459e-01, 3.8996e+05, 3.9595e+05, 1.1624e+00, 8.3388e-01,
         3.8664e+05, 3.9411e+05, 8.3192e-01, 3.9250e+05, 1.3060e+00, 3.8469e+05,
         1.2566e+00, 4.1038e+05, 0.0000e+00, 1.1282e+00],
        [1.1079e+00, 1.2544e+00, 3.8993e+05, 3.9592e+05, 1.0852e+00, 1.0818e+00,
         3.8665e+05, 3.9416e+05, 1.0493e+00, 3.9248e+05, 9.9263e-01, 3.8467e+05,
         1.0663e+00, 4.1037e+05, 1.1282e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1069e+00, 1.1079e+00, 1.1355e+00, 1.1393e+00, 1.2486e+00,
        1.2527e+00, 1.3332e+00, 1.3791e+00, 3.8467e+05, 3.8661e+05, 3.8991e+05,
        3.9247e+05, 3.9413e+05, 3.9594e+05, 4.1038e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.5543e-01, 8.6459e-01, 9.1652e-01, 1.2544e+00, 1.2547e+00,
        1.3791e+00, 1.3891e+00, 1.4423e+00, 3.8469e+05, 3.8663e+05, 3.8993e+05,
        3.9248e+05, 3.9413e+05, 3.9593e+05, 4.1037e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389914.1250, 389924.8750, 389925.8125, 389927.1250,
        389927.5000, 389931.8438, 389941.1562, 389955.3125, 389963.2500,
        763251.0625, 771674.5625, 773617.8125, 779830.1875, 785316.3125,
        785776.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395917.3125, 395923.1875, 395924.1250, 395925.3125,
        395930.1250, 395938.5312, 395939.5000, 395946.2188, 395954.3438,
        771674.5625, 780065.9375, 789194.0000, 794782.6250, 796501.7500,
        799508.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0852e+00, 1.0861e+00, 1.0975e+00, 1.1393e+00, 1.1624e+00,
        1.1630e+00, 1.1655e+00, 1.2547e+00, 3.8472e+05, 3.8663e+05, 3.8993e+05,
        3.9247e+05, 3.9415e+05, 3.9594e+05, 4.1037e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3388e-01, 8.6325e-01, 9.1652e-01, 1.0818e+00, 1.0861e+00,
        1.1941e+00, 1.2185e+00, 1.2527e+00, 3.8469e+05, 3.8664e+05, 3.8994e+05,
        3.9248e+05, 3.9414e+05, 3.9593e+05, 4.1038e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386611.9688, 386630.9375, 386633.3125, 386634.5312,
        386634.8750, 386638.6250, 386640.4375, 386645.0938, 386649.7500,
        763251.0625, 770597.5000, 776603.2500, 789194.0000, 798651.6250,
        809548.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394107.5625, 394116.0312, 394130.5000, 394130.9688,
        394131.5625, 394139.6875, 394150.0000, 394155.2188, 394157.6250,
        762304.8750, 780065.9375, 785776.5000, 798651.6250, 807161.5000,
        807197.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3192e-01, 8.5543e-01, 8.6325e-01, 1.0493e+00, 1.1630e+00,
        1.2097e+00, 1.2120e+00, 1.2486e+00, 3.8469e+05, 3.8663e+05, 3.8993e+05,
        3.9248e+05, 3.9412e+05, 3.9592e+05, 4.1039e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392471.1250, 392474.8750, 392477.1250, 392480.8750,
        392482.0625, 392485.0000, 392498.0000, 392504.3750, 392507.4375,
        770597.5000, 782692.0000, 785316.3125, 798587.5000, 799508.6875,
        807161.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.9263e-01, 1.1069e+00, 1.1091e+00, 1.1655e+00, 1.2120e+00,
        1.2185e+00, 1.3060e+00, 1.4423e+00, 3.8467e+05, 3.8665e+05, 3.8992e+05,
        3.9250e+05, 3.9413e+05, 3.9592e+05, 4.1034e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384666.4375, 384670.1875, 384671.2188, 384686.9062,
        384687.4375, 384688.2188, 384688.5938, 384692.7500, 384716.4688,
        762304.8750, 773617.8125, 776603.2500, 782692.0000, 793058.5000,
        794782.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0663e+00, 1.0975e+00, 1.1091e+00, 1.1355e+00, 1.1941e+00,
        1.2097e+00, 1.2566e+00, 1.3891e+00, 3.8469e+05, 3.8663e+05, 3.8996e+05,
        3.9251e+05, 3.9416e+05, 3.9595e+05, 4.1038e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 410339.0312, 410366.1875, 410368.3125, 410371.8750,
        410375.7188, 410377.1562, 410377.5000, 410382.6250, 410393.9688,
        779830.1875, 793058.5000, 796501.7500, 798587.5000, 807197.0625,
        809548.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3192e-01, 8.3388e-01, 8.6459e-01, 1.1282e+00, 1.1624e+00,
        1.2566e+00, 1.3060e+00, 1.3332e+00, 3.8469e+05, 3.8664e+05, 3.8996e+05,
        3.9250e+05, 3.9411e+05, 3.9595e+05, 4.1038e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.9263e-01, 1.0493e+00, 1.0663e+00, 1.0818e+00, 1.0852e+00,
        1.1079e+00, 1.1282e+00, 1.2544e+00, 3.8467e+05, 3.8665e+05, 3.8993e+05,
        3.9248e+05, 3.9416e+05, 3.9592e+05, 4.1037e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77129.18', '77132.89', '427266.19', '433507.31', '77136.02', '77133.39', '424297.06', '430952.41', '77133.45', '430297.84', '77132.58', '422447.31', '77133.26', '447318.25', '77133.66', '77132.51']
estimated f for each client, fs: [7, 7, 5, 5, 7, 7, 5, 5, 7, 5, 7, 5, 7, 5, 7, 7]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0133s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:20...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:20, End: 2025-07-22 15:29:20)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 1.0848e+00, 1.3703e+00, 3.7723e+05, 3.8217e+05, 1.3052e+00,
         1.1440e+00, 3.9093e+05, 4.0522e+05, 1.1495e+00, 3.8422e+05, 1.1317e+00,
         1.3779e+00, 4.1087e+05, 3.8656e+05, 1.3104e+00, 1.3571e+00, 4.1344e+05,
         1.1652e+00, 1.2408e+00],
        [1.0848e+00, 0.0000e+00, 1.3173e+00, 3.7723e+05, 3.8217e+05, 1.3478e+00,
         9.7671e-01, 3.9095e+05, 4.0520e+05, 9.4837e-01, 3.8421e+05, 8.6115e-01,
         1.4802e+00, 4.1087e+05, 3.8654e+05, 1.4804e+00, 1.4021e+00, 4.1341e+05,
         9.2705e-01, 1.3483e+00],
        [1.3703e+00, 1.3173e+00, 0.0000e+00, 3.7722e+05, 3.8219e+05, 1.2589e+00,
         1.1907e+00, 3.9096e+05, 4.0520e+05, 1.3274e+00, 3.8422e+05, 1.2545e+00,
         1.2503e+00, 4.1088e+05, 3.8658e+05, 1.3098e+00, 1.1967e+00, 4.1346e+05,
         1.2186e+00, 1.2264e+00],
        [3.7723e+05, 3.7723e+05, 3.7722e+05, 0.0000e+00, 7.5337e+05, 3.7727e+05,
         3.7723e+05, 7.6865e+05, 7.8398e+05, 3.7723e+05, 7.5375e+05, 3.7723e+05,
         3.7724e+05, 8.0066e+05, 7.6701e+05, 3.7722e+05, 3.7722e+05, 8.1343e+05,
         3.7725e+05, 3.7726e+05],
        [3.8217e+05, 3.8217e+05, 3.8219e+05, 7.5337e+05, 0.0000e+00, 3.8215e+05,
         3.8216e+05, 7.4869e+05, 7.8712e+05, 3.8219e+05, 7.7178e+05, 3.8216e+05,
         3.8217e+05, 7.8958e+05, 7.7265e+05, 3.8216e+05, 3.8215e+05, 8.0093e+05,
         3.8214e+05, 3.8219e+05],
        [1.3052e+00, 1.3478e+00, 1.2589e+00, 3.7727e+05, 3.8215e+05, 0.0000e+00,
         1.1792e+00, 3.9096e+05, 4.0524e+05, 1.3540e+00, 3.8422e+05, 1.3305e+00,
         1.2918e+00, 4.1089e+05, 3.8657e+05, 1.2233e+00, 1.1644e+00, 4.1341e+05,
         1.2386e+00, 1.2298e+00],
        [1.1440e+00, 9.7671e-01, 1.1907e+00, 3.7723e+05, 3.8216e+05, 1.1792e+00,
         0.0000e+00, 3.9098e+05, 4.0523e+05, 9.8559e-01, 3.8421e+05, 9.7823e-01,
         1.2881e+00, 4.1089e+05, 3.8656e+05, 1.3662e+00, 1.2419e+00, 4.1341e+05,
         9.1945e-01, 1.2161e+00],
        [3.9093e+05, 3.9095e+05, 3.9096e+05, 7.6865e+05, 7.4869e+05, 3.9096e+05,
         3.9098e+05, 0.0000e+00, 8.0028e+05, 3.9098e+05, 7.7055e+05, 3.9099e+05,
         3.9099e+05, 8.1423e+05, 7.7122e+05, 3.9097e+05, 3.9094e+05, 8.1571e+05,
         3.9097e+05, 3.9095e+05],
        [4.0522e+05, 4.0520e+05, 4.0520e+05, 7.8398e+05, 7.8712e+05, 4.0524e+05,
         4.0523e+05, 8.0028e+05, 0.0000e+00, 4.0520e+05, 7.8093e+05, 4.0522e+05,
         4.0523e+05, 8.1818e+05, 7.9825e+05, 4.0522e+05, 4.0522e+05, 8.4042e+05,
         4.0522e+05, 4.0524e+05],
        [1.1495e+00, 9.4837e-01, 1.3274e+00, 3.7723e+05, 3.8219e+05, 1.3540e+00,
         9.8559e-01, 3.9098e+05, 4.0520e+05, 0.0000e+00, 3.8422e+05, 9.7713e-01,
         1.3939e+00, 4.1089e+05, 3.8654e+05, 1.4726e+00, 1.3578e+00, 4.1343e+05,
         9.4719e-01, 1.2718e+00],
        [3.8422e+05, 3.8421e+05, 3.8422e+05, 7.5375e+05, 7.7178e+05, 3.8422e+05,
         3.8421e+05, 7.7055e+05, 7.8093e+05, 3.8422e+05, 0.0000e+00, 3.8422e+05,
         3.8425e+05, 7.9349e+05, 7.6056e+05, 3.8421e+05, 3.8423e+05, 7.9265e+05,
         3.8421e+05, 3.8425e+05],
        [1.1317e+00, 8.6115e-01, 1.2545e+00, 3.7723e+05, 3.8216e+05, 1.3305e+00,
         9.7823e-01, 3.9099e+05, 4.0522e+05, 9.7713e-01, 3.8422e+05, 0.0000e+00,
         1.4683e+00, 4.1090e+05, 3.8654e+05, 1.5253e+00, 1.3985e+00, 4.1341e+05,
         9.0215e-01, 1.3042e+00],
        [1.3779e+00, 1.4802e+00, 1.2503e+00, 3.7724e+05, 3.8217e+05, 1.2918e+00,
         1.2881e+00, 3.9099e+05, 4.0523e+05, 1.3939e+00, 3.8425e+05, 1.4683e+00,
         0.0000e+00, 4.1088e+05, 3.8653e+05, 1.3085e+00, 1.1641e+00, 4.1343e+05,
         1.4115e+00, 1.1568e+00],
        [4.1087e+05, 4.1087e+05, 4.1088e+05, 8.0066e+05, 7.8958e+05, 4.1089e+05,
         4.1089e+05, 8.1423e+05, 8.1818e+05, 4.1089e+05, 7.9349e+05, 4.1090e+05,
         4.1088e+05, 0.0000e+00, 7.7460e+05, 4.1086e+05, 4.1088e+05, 8.3987e+05,
         4.1088e+05, 4.1087e+05],
        [3.8656e+05, 3.8654e+05, 3.8658e+05, 7.6701e+05, 7.7265e+05, 3.8657e+05,
         3.8656e+05, 7.7122e+05, 7.9825e+05, 3.8654e+05, 7.6056e+05, 3.8654e+05,
         3.8653e+05, 7.7460e+05, 0.0000e+00, 3.8656e+05, 3.8656e+05, 7.8902e+05,
         3.8654e+05, 3.8653e+05],
        [1.3104e+00, 1.4804e+00, 1.3098e+00, 3.7722e+05, 3.8216e+05, 1.2233e+00,
         1.3662e+00, 3.9097e+05, 4.0522e+05, 1.4726e+00, 3.8421e+05, 1.5253e+00,
         1.3085e+00, 4.1086e+05, 3.8656e+05, 0.0000e+00, 1.2126e+00, 4.1342e+05,
         1.4431e+00, 1.2340e+00],
        [1.3571e+00, 1.4021e+00, 1.1967e+00, 3.7722e+05, 3.8215e+05, 1.1644e+00,
         1.2419e+00, 3.9094e+05, 4.0522e+05, 1.3578e+00, 3.8423e+05, 1.3985e+00,
         1.1641e+00, 4.1088e+05, 3.8656e+05, 1.2126e+00, 0.0000e+00, 4.1342e+05,
         1.2985e+00, 1.1846e+00],
        [4.1344e+05, 4.1341e+05, 4.1346e+05, 8.1343e+05, 8.0093e+05, 4.1341e+05,
         4.1341e+05, 8.1571e+05, 8.4042e+05, 4.1343e+05, 7.9265e+05, 4.1341e+05,
         4.1343e+05, 8.3987e+05, 7.8902e+05, 4.1342e+05, 4.1342e+05, 0.0000e+00,
         4.1341e+05, 4.1344e+05],
        [1.1652e+00, 9.2705e-01, 1.2186e+00, 3.7725e+05, 3.8214e+05, 1.2386e+00,
         9.1945e-01, 3.9097e+05, 4.0522e+05, 9.4719e-01, 3.8421e+05, 9.0215e-01,
         1.4115e+00, 4.1088e+05, 3.8654e+05, 1.4431e+00, 1.2985e+00, 4.1341e+05,
         0.0000e+00, 1.2378e+00],
        [1.2408e+00, 1.3483e+00, 1.2264e+00, 3.7726e+05, 3.8219e+05, 1.2298e+00,
         1.2161e+00, 3.9095e+05, 4.0524e+05, 1.2718e+00, 3.8425e+05, 1.3042e+00,
         1.1568e+00, 4.1087e+05, 3.8653e+05, 1.2340e+00, 1.1846e+00, 4.1344e+05,
         1.2378e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0848e+00, 1.1317e+00, 1.1440e+00, 1.1495e+00, 1.1652e+00,
        1.2408e+00, 1.3052e+00, 1.3104e+00, 1.3571e+00, 1.3703e+00, 1.3779e+00,
        3.7723e+05, 3.8217e+05, 3.8422e+05, 3.8656e+05, 3.9093e+05, 4.0522e+05,
        4.1087e+05, 4.1344e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 8.6115e-01, 9.2705e-01, 9.4837e-01, 9.7671e-01, 1.0848e+00,
        1.3173e+00, 1.3478e+00, 1.3483e+00, 1.4021e+00, 1.4802e+00, 1.4804e+00,
        3.7723e+05, 3.8217e+05, 3.8421e+05, 3.8654e+05, 3.9095e+05, 4.0520e+05,
        4.1087e+05, 4.1341e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.1907e+00, 1.1967e+00, 1.2186e+00, 1.2264e+00, 1.2503e+00,
        1.2545e+00, 1.2589e+00, 1.3098e+00, 1.3173e+00, 1.3274e+00, 1.3703e+00,
        3.7722e+05, 3.8219e+05, 3.8422e+05, 3.8658e+05, 3.9096e+05, 4.0520e+05,
        4.1088e+05, 4.1346e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 377215.1875, 377219.6875, 377223.1562, 377229.3438,
        377231.9062, 377234.2500, 377234.7500, 377234.8125, 377241.8750,
        377250.0938, 377255.3125, 377274.3125, 753372.0000, 753745.2500,
        767006.6250, 768652.3750, 783978.2500, 800655.0000, 813429.0000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 382141.5938, 382146.8750, 382154.5000, 382156.4688,
        382157.3750, 382157.4688, 382167.2812, 382169.1250, 382170.7812,
        382186.1250, 382189.0000, 382192.2500, 748687.8750, 753372.0000,
        771777.5000, 772648.6875, 787118.9375, 789582.7500, 800932.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.1644e+00, 1.1792e+00, 1.2233e+00, 1.2298e+00, 1.2386e+00,
        1.2589e+00, 1.2918e+00, 1.3052e+00, 1.3305e+00, 1.3478e+00, 1.3540e+00,
        3.7727e+05, 3.8215e+05, 3.8422e+05, 3.8657e+05, 3.9096e+05, 4.0524e+05,
        4.1089e+05, 4.1341e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 9.1945e-01, 9.7671e-01, 9.7823e-01, 9.8559e-01, 1.1440e+00,
        1.1792e+00, 1.1907e+00, 1.2161e+00, 1.2419e+00, 1.2881e+00, 1.3662e+00,
        3.7723e+05, 3.8216e+05, 3.8421e+05, 3.8656e+05, 3.9098e+05, 4.0523e+05,
        4.1089e+05, 4.1341e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 390927.5000, 390938.7188, 390953.0938, 390954.3750,
        390961.7188, 390963.1875, 390967.0625, 390970.9375, 390978.0625,
        390979.9688, 390987.4688, 390990.2812, 748687.8750, 768652.3750,
        770547.2500, 771218.5625, 800281.7500, 814226.6875, 815711.1250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 405199.1250, 405199.6250, 405200.3125, 405219.4375,
        405221.4375, 405221.9062, 405223.5000, 405223.5625, 405229.7500,
        405234.6875, 405237.1875, 405239.9375, 780929.0625, 783978.2500,
        787118.9375, 798254.0000, 800281.7500, 818184.0000, 840424.5000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 9.4719e-01, 9.4837e-01, 9.7713e-01, 9.8559e-01, 1.1495e+00,
        1.2718e+00, 1.3274e+00, 1.3540e+00, 1.3578e+00, 1.3939e+00, 1.4726e+00,
        3.7723e+05, 3.8219e+05, 3.8422e+05, 3.8654e+05, 3.9098e+05, 4.0520e+05,
        4.1089e+05, 4.1343e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 384208.7500, 384208.9375, 384212.7812, 384213.6875,
        384215.4062, 384217.9375, 384219.7188, 384220.8125, 384221.8750,
        384225.2500, 384249.5000, 384250.9688, 753745.2500, 760561.2500,
        770547.2500, 771777.5000, 780929.0625, 792653.4375, 793490.2500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 8.6115e-01, 9.0215e-01, 9.7713e-01, 9.7823e-01, 1.1317e+00,
        1.2545e+00, 1.3042e+00, 1.3305e+00, 1.3985e+00, 1.4683e+00, 1.5253e+00,
        3.7723e+05, 3.8216e+05, 3.8422e+05, 3.8654e+05, 3.9099e+05, 4.0522e+05,
        4.1090e+05, 4.1341e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.1568e+00, 1.1641e+00, 1.2503e+00, 1.2881e+00, 1.2918e+00,
        1.3085e+00, 1.3779e+00, 1.3939e+00, 1.4115e+00, 1.4683e+00, 1.4802e+00,
        3.7724e+05, 3.8217e+05, 3.8425e+05, 3.8653e+05, 3.9099e+05, 4.0523e+05,
        4.1088e+05, 4.1343e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 410864.0000, 410867.6875, 410869.2812, 410874.7500,
        410878.8438, 410881.6250, 410882.5000, 410883.6250, 410885.0625,
        410886.1875, 410890.1250, 410903.4375, 774597.5625, 789582.7500,
        793490.2500, 800655.0000, 814226.6875, 818184.0000, 839874.4375])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 386526.8125, 386533.0625, 386536.1250, 386537.2188,
        386539.7812, 386540.6875, 386556.9062, 386557.5000, 386557.6562,
        386558.9062, 386568.9375, 386579.5625, 760561.2500, 767006.6250,
        771218.5625, 772648.6875, 774597.5625, 789023.0000, 798254.0000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.2126e+00, 1.2233e+00, 1.2340e+00, 1.3085e+00, 1.3098e+00,
        1.3104e+00, 1.3662e+00, 1.4431e+00, 1.4726e+00, 1.4804e+00, 1.5253e+00,
        3.7722e+05, 3.8216e+05, 3.8421e+05, 3.8656e+05, 3.9097e+05, 4.0522e+05,
        4.1086e+05, 4.1342e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.1641e+00, 1.1644e+00, 1.1846e+00, 1.1967e+00, 1.2126e+00,
        1.2419e+00, 1.2985e+00, 1.3571e+00, 1.3578e+00, 1.3985e+00, 1.4021e+00,
        3.7722e+05, 3.8215e+05, 3.8423e+05, 3.8656e+05, 3.9094e+05, 4.0522e+05,
        4.1088e+05, 4.1342e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 413411.6250, 413412.3438, 413413.2812, 413413.5938,
        413414.7812, 413420.3438, 413424.9688, 413427.4688, 413430.6875,
        413438.0312, 413439.7812, 413456.1562, 789023.0000, 792653.4375,
        800932.7500, 813429.0000, 815711.1250, 839874.4375, 840424.5000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 9.0215e-01, 9.1945e-01, 9.2705e-01, 9.4719e-01, 1.1652e+00,
        1.2186e+00, 1.2378e+00, 1.2386e+00, 1.2985e+00, 1.4115e+00, 1.4431e+00,
        3.7725e+05, 3.8214e+05, 3.8421e+05, 3.8654e+05, 3.9097e+05, 4.0522e+05,
        4.1088e+05, 4.1341e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.1568e+00, 1.1846e+00, 1.2161e+00, 1.2264e+00, 1.2298e+00,
        1.2340e+00, 1.2378e+00, 1.2408e+00, 1.2718e+00, 1.3042e+00, 1.3483e+00,
        3.7726e+05, 3.8219e+05, 3.8425e+05, 3.8653e+05, 3.9095e+05, 4.0524e+05,
        4.1087e+05, 4.1344e+05])
Index of maximum distance difference after half of values: 12
adaptive_Krum scores:  ['31437.32', '31437.33', '31436.13', '377237.00', '382165.69', '31440.68', '31436.81', '390964.31', '405220.81', '31437.32', '384222.09', '31437.08', '31438.04', '410880.53', '386549.38', '31435.84', '31436.42', '413425.19', '31438.57', '31439.07']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 8, 6, 6, 8, 6, 8, 8, 6, 6, 8, 8, 6, 8, 8]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0152s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:20...
global Accuracy on shared test data: 71.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[147  90]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:20, End: 2025-07-22 15:29:20)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 19, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3902e+00, 3.8959e+05, 1.2869e+00, 1.2484e+00, 3.8695e+05,
         1.1289e+00, 3.8095e+05, 1.1851e+00, 1.3642e+00, 3.8107e+05, 3.9655e+05,
         1.1929e+00, 1.3669e+00, 4.1351e+05, 1.2454e+00],
        [1.3902e+00, 0.0000e+00, 3.8961e+05, 1.3343e+00, 1.3279e+00, 3.8698e+05,
         1.3135e+00, 3.8098e+05, 1.3523e+00, 1.3297e+00, 3.8104e+05, 3.9653e+05,
         1.5005e+00, 1.2851e+00, 4.1349e+05, 1.2989e+00],
        [3.8959e+05, 3.8961e+05, 0.0000e+00, 3.8962e+05, 3.8958e+05, 7.7959e+05,
         3.8959e+05, 7.8525e+05, 3.8957e+05, 3.8962e+05, 7.8677e+05, 7.5965e+05,
         3.8958e+05, 3.8958e+05, 8.0624e+05, 3.8960e+05],
        [1.2869e+00, 1.3343e+00, 3.8962e+05, 0.0000e+00, 1.3128e+00, 3.8696e+05,
         1.3276e+00, 3.8098e+05, 1.3642e+00, 1.3912e+00, 3.8105e+05, 3.9652e+05,
         1.4500e+00, 1.2806e+00, 4.1353e+05, 1.2737e+00],
        [1.2484e+00, 1.3279e+00, 3.8958e+05, 1.3128e+00, 0.0000e+00, 3.8693e+05,
         1.0550e+00, 3.8098e+05, 1.0740e+00, 1.4325e+00, 3.8109e+05, 3.9655e+05,
         1.2929e+00, 1.4526e+00, 4.1354e+05, 1.3301e+00],
        [3.8695e+05, 3.8698e+05, 7.7959e+05, 3.8696e+05, 3.8693e+05, 0.0000e+00,
         3.8695e+05, 7.8825e+05, 3.8695e+05, 3.8693e+05, 7.8516e+05, 7.8755e+05,
         3.8693e+05, 3.8694e+05, 8.0337e+05, 3.8697e+05],
        [1.1289e+00, 1.3135e+00, 3.8959e+05, 1.3276e+00, 1.0550e+00, 3.8695e+05,
         0.0000e+00, 3.8097e+05, 1.0241e+00, 1.3520e+00, 3.8107e+05, 3.9654e+05,
         1.1824e+00, 1.3222e+00, 4.1352e+05, 1.2120e+00],
        [3.8095e+05, 3.8098e+05, 7.8525e+05, 3.8098e+05, 3.8098e+05, 7.8825e+05,
         3.8097e+05, 0.0000e+00, 3.8097e+05, 3.8099e+05, 7.6746e+05, 7.7187e+05,
         3.8094e+05, 3.8099e+05, 8.0699e+05, 3.8099e+05],
        [1.1851e+00, 1.3523e+00, 3.8957e+05, 1.3642e+00, 1.0740e+00, 3.8695e+05,
         1.0241e+00, 3.8097e+05, 0.0000e+00, 1.4848e+00, 3.8105e+05, 3.9656e+05,
         1.2460e+00, 1.4946e+00, 4.1354e+05, 1.3397e+00],
        [1.3642e+00, 1.3297e+00, 3.8962e+05, 1.3912e+00, 1.4325e+00, 3.8693e+05,
         1.3520e+00, 3.8099e+05, 1.4848e+00, 0.0000e+00, 3.8109e+05, 3.9654e+05,
         1.5758e+00, 1.2529e+00, 4.1354e+05, 1.2105e+00],
        [3.8107e+05, 3.8104e+05, 7.8677e+05, 3.8105e+05, 3.8109e+05, 7.8516e+05,
         3.8107e+05, 7.6746e+05, 3.8105e+05, 3.8109e+05, 0.0000e+00, 7.7221e+05,
         3.8104e+05, 3.8104e+05, 7.9482e+05, 3.8108e+05],
        [3.9655e+05, 3.9653e+05, 7.5965e+05, 3.9652e+05, 3.9655e+05, 7.8755e+05,
         3.9654e+05, 7.7187e+05, 3.9656e+05, 3.9654e+05, 7.7221e+05, 0.0000e+00,
         3.9653e+05, 3.9651e+05, 8.0220e+05, 3.9654e+05],
        [1.1929e+00, 1.5005e+00, 3.8958e+05, 1.4500e+00, 1.2929e+00, 3.8693e+05,
         1.1824e+00, 3.8094e+05, 1.2460e+00, 1.5758e+00, 3.8104e+05, 3.9653e+05,
         0.0000e+00, 1.5073e+00, 4.1350e+05, 1.3310e+00],
        [1.3669e+00, 1.2851e+00, 3.8958e+05, 1.2806e+00, 1.4526e+00, 3.8694e+05,
         1.3222e+00, 3.8099e+05, 1.4946e+00, 1.2529e+00, 3.8104e+05, 3.9651e+05,
         1.5073e+00, 0.0000e+00, 4.1354e+05, 1.2616e+00],
        [4.1351e+05, 4.1349e+05, 8.0624e+05, 4.1353e+05, 4.1354e+05, 8.0337e+05,
         4.1352e+05, 8.0699e+05, 4.1354e+05, 4.1354e+05, 7.9482e+05, 8.0220e+05,
         4.1350e+05, 4.1354e+05, 0.0000e+00, 4.1352e+05],
        [1.2454e+00, 1.2989e+00, 3.8960e+05, 1.2737e+00, 1.3301e+00, 3.8697e+05,
         1.2120e+00, 3.8099e+05, 1.3397e+00, 1.2105e+00, 3.8108e+05, 3.9654e+05,
         1.3310e+00, 1.2616e+00, 4.1352e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1289e+00, 1.1851e+00, 1.1929e+00, 1.2454e+00, 1.2484e+00,
        1.2869e+00, 1.3642e+00, 1.3669e+00, 1.3902e+00, 3.8095e+05, 3.8107e+05,
        3.8695e+05, 3.8959e+05, 3.9655e+05, 4.1351e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2851e+00, 1.2989e+00, 1.3135e+00, 1.3279e+00, 1.3297e+00,
        1.3343e+00, 1.3523e+00, 1.3902e+00, 1.5005e+00, 3.8098e+05, 3.8104e+05,
        3.8698e+05, 3.8961e+05, 3.9653e+05, 4.1349e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389567.3438, 389580.5000, 389583.6875, 389584.4688,
        389585.8125, 389592.8438, 389601.5312, 389606.6562, 389615.4375,
        389623.9375, 759653.0625, 779589.7500, 785254.7500, 786765.2500,
        806240.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2737e+00, 1.2806e+00, 1.2869e+00, 1.3128e+00, 1.3276e+00,
        1.3343e+00, 1.3642e+00, 1.3912e+00, 1.4500e+00, 3.8098e+05, 3.8105e+05,
        3.8696e+05, 3.8962e+05, 3.9652e+05, 4.1353e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0550e+00, 1.0740e+00, 1.2484e+00, 1.2929e+00, 1.3128e+00,
        1.3279e+00, 1.3301e+00, 1.4325e+00, 1.4526e+00, 3.8098e+05, 3.8109e+05,
        3.8693e+05, 3.8958e+05, 3.9655e+05, 4.1354e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386925.4688, 386926.6562, 386934.4688, 386938.5312,
        386946.7500, 386948.6875, 386949.5000, 386956.0625, 386965.7500,
        386980.0938, 779589.7500, 785164.1875, 787552.0625, 788245.3125,
        803369.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0241e+00, 1.0550e+00, 1.1289e+00, 1.1824e+00, 1.2120e+00,
        1.3135e+00, 1.3222e+00, 1.3276e+00, 1.3520e+00, 3.8097e+05, 3.8107e+05,
        3.8695e+05, 3.8959e+05, 3.9654e+05, 4.1352e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380938.6562, 380946.5938, 380968.3750, 380970.8750,
        380977.8438, 380979.8125, 380982.5000, 380985.3438, 380988.7812,
        380994.2812, 767461.9375, 771869.8750, 785254.7500, 788245.3125,
        806990.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0241e+00, 1.0740e+00, 1.1851e+00, 1.2460e+00, 1.3397e+00,
        1.3523e+00, 1.3642e+00, 1.4848e+00, 1.4946e+00, 3.8097e+05, 3.8105e+05,
        3.8695e+05, 3.8957e+05, 3.9656e+05, 4.1354e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2105e+00, 1.2529e+00, 1.3297e+00, 1.3520e+00, 1.3642e+00,
        1.3912e+00, 1.4325e+00, 1.4848e+00, 1.5758e+00, 3.8099e+05, 3.8109e+05,
        3.8693e+05, 3.8962e+05, 3.9654e+05, 4.1354e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381036.1250, 381039.7188, 381043.8125, 381051.4375,
        381051.5938, 381069.9062, 381071.8125, 381079.6875, 381093.4062,
        381094.5312, 767461.9375, 772208.7500, 785164.1875, 786765.2500,
        794819.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396506.9375, 396520.5625, 396525.2812, 396531.2500,
        396536.8125, 396538.5312, 396540.7500, 396548.3750, 396554.0000,
        396558.0312, 759653.0625, 771869.8750, 772208.7500, 787552.0625,
        802198.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1824e+00, 1.1929e+00, 1.2460e+00, 1.2929e+00, 1.3310e+00,
        1.4500e+00, 1.5005e+00, 1.5073e+00, 1.5758e+00, 3.8094e+05, 3.8104e+05,
        3.8693e+05, 3.8958e+05, 3.9653e+05, 4.1350e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2529e+00, 1.2616e+00, 1.2806e+00, 1.2851e+00, 1.3222e+00,
        1.3669e+00, 1.4526e+00, 1.4946e+00, 1.5073e+00, 3.8099e+05, 3.8104e+05,
        3.8694e+05, 3.8958e+05, 3.9651e+05, 4.1354e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 413494.8125, 413502.9375, 413507.0625, 413517.8438,
        413520.0312, 413525.6562, 413536.5312, 413541.3750, 413544.2500,
        413544.3438, 794819.6875, 802198.8750, 803369.4375, 806240.5000,
        806990.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2105e+00, 1.2120e+00, 1.2454e+00, 1.2616e+00, 1.2737e+00,
        1.2989e+00, 1.3301e+00, 1.3310e+00, 1.3397e+00, 3.8099e+05, 3.8108e+05,
        3.8697e+05, 3.8960e+05, 3.9654e+05, 4.1352e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38095.80', '38099.20', '389594.22', '38098.99', '38099.40', '386947.19', '38098.18', '380973.28', '38098.00', '38100.67', '381063.19', '396536.06', '38095.09', '38099.75', '413523.50', '38100.04']
estimated f for each client, fs: [6, 6, 4, 6, 6, 5, 6, 5, 6, 6, 5, 4, 6, 6, 4, 6]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 2, 19, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0104s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:21...
global Accuracy on shared test data: 69.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[148  89]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:21, End: 2025-07-22 15:29:21)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 13, 14, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 9.5970e-01, 1.1246e+00, 3.9368e+05, 3.8236e+05, 1.0612e+00,
         9.8323e-01, 3.9194e+05, 3.8917e+05, 9.5123e-01, 3.8272e+05, 3.9698e+05,
         3.8633e+05, 1.0727e+00],
        [9.5970e-01, 0.0000e+00, 1.0955e+00, 3.9368e+05, 3.8238e+05, 1.1273e+00,
         9.0355e-01, 3.9197e+05, 3.8918e+05, 8.5888e-01, 3.8276e+05, 3.9698e+05,
         3.8633e+05, 1.1364e+00],
        [1.1246e+00, 1.0955e+00, 0.0000e+00, 3.9364e+05, 3.8236e+05, 1.0646e+00,
         1.0530e+00, 3.9196e+05, 3.8916e+05, 1.0855e+00, 3.8272e+05, 3.9695e+05,
         3.8635e+05, 1.0931e+00],
        [3.9368e+05, 3.9368e+05, 3.9364e+05, 0.0000e+00, 7.7010e+05, 3.9366e+05,
         3.9362e+05, 7.7246e+05, 7.6894e+05, 3.9367e+05, 7.8240e+05, 7.6478e+05,
         7.8754e+05, 3.9363e+05],
        [3.8236e+05, 3.8238e+05, 3.8236e+05, 7.7010e+05, 0.0000e+00, 3.8237e+05,
         3.8237e+05, 7.6315e+05, 7.5589e+05, 3.8237e+05, 7.6372e+05, 7.8485e+05,
         7.6302e+05, 3.8236e+05],
        [1.0612e+00, 1.1273e+00, 1.0646e+00, 3.9366e+05, 3.8237e+05, 0.0000e+00,
         1.0068e+00, 3.9198e+05, 3.8916e+05, 1.0860e+00, 3.8273e+05, 3.9696e+05,
         3.8634e+05, 1.0688e+00],
        [9.8323e-01, 9.0355e-01, 1.0530e+00, 3.9362e+05, 3.8237e+05, 1.0068e+00,
         0.0000e+00, 3.9195e+05, 3.8918e+05, 8.7312e-01, 3.8277e+05, 3.9696e+05,
         3.8635e+05, 1.0395e+00],
        [3.9194e+05, 3.9197e+05, 3.9196e+05, 7.7246e+05, 7.6315e+05, 3.9198e+05,
         3.9195e+05, 0.0000e+00, 7.9576e+05, 3.9194e+05, 7.7953e+05, 7.9919e+05,
         7.9151e+05, 3.9197e+05],
        [3.8917e+05, 3.8918e+05, 3.8916e+05, 7.6894e+05, 7.5589e+05, 3.8916e+05,
         3.8918e+05, 7.9576e+05, 0.0000e+00, 3.8915e+05, 7.6871e+05, 7.8098e+05,
         7.5988e+05, 3.8916e+05],
        [9.5123e-01, 8.5888e-01, 1.0855e+00, 3.9367e+05, 3.8237e+05, 1.0860e+00,
         8.7312e-01, 3.9194e+05, 3.8915e+05, 0.0000e+00, 3.8274e+05, 3.9699e+05,
         3.8634e+05, 1.0138e+00],
        [3.8272e+05, 3.8276e+05, 3.8272e+05, 7.8240e+05, 7.6372e+05, 3.8273e+05,
         3.8277e+05, 7.7953e+05, 7.6871e+05, 3.8274e+05, 0.0000e+00, 8.0092e+05,
         7.7327e+05, 3.8271e+05],
        [3.9698e+05, 3.9698e+05, 3.9695e+05, 7.6478e+05, 7.8485e+05, 3.9696e+05,
         3.9696e+05, 7.9919e+05, 7.8098e+05, 3.9699e+05, 8.0092e+05, 0.0000e+00,
         7.6359e+05, 3.9699e+05],
        [3.8633e+05, 3.8633e+05, 3.8635e+05, 7.8754e+05, 7.6302e+05, 3.8634e+05,
         3.8635e+05, 7.9151e+05, 7.5988e+05, 3.8634e+05, 7.7327e+05, 7.6359e+05,
         0.0000e+00, 3.8634e+05],
        [1.0727e+00, 1.1364e+00, 1.0931e+00, 3.9363e+05, 3.8236e+05, 1.0688e+00,
         1.0395e+00, 3.9197e+05, 3.8916e+05, 1.0138e+00, 3.8271e+05, 3.9699e+05,
         3.8634e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.5123e-01, 9.5970e-01, 9.8323e-01, 1.0612e+00, 1.0727e+00,
        1.1246e+00, 3.8236e+05, 3.8272e+05, 3.8633e+05, 3.8917e+05, 3.9194e+05,
        3.9368e+05, 3.9698e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 8.5888e-01, 9.0355e-01, 9.5970e-01, 1.0955e+00, 1.1273e+00,
        1.1364e+00, 3.8238e+05, 3.8276e+05, 3.8633e+05, 3.8918e+05, 3.9197e+05,
        3.9368e+05, 3.9698e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0530e+00, 1.0646e+00, 1.0855e+00, 1.0931e+00, 1.0955e+00,
        1.1246e+00, 3.8236e+05, 3.8272e+05, 3.8635e+05, 3.8916e+05, 3.9196e+05,
        3.9364e+05, 3.9695e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393620.4375, 393633.5938, 393641.4062, 393658.5938,
        393667.3750, 393677.4688, 393684.6250, 764783.3125, 768944.0625,
        770099.0625, 772461.7500, 782398.8125, 787541.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 382360.6562, 382362.4375, 382363.5000, 382367.8438,
        382369.8438, 382372.9375, 382382.0938, 755891.5000, 763025.0000,
        763153.6250, 763719.7500, 770099.0625, 784848.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0068e+00, 1.0612e+00, 1.0646e+00, 1.0688e+00, 1.0860e+00,
        1.1273e+00, 3.8237e+05, 3.8273e+05, 3.8634e+05, 3.8916e+05, 3.9198e+05,
        3.9366e+05, 3.9696e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 8.7312e-01, 9.0355e-01, 9.8323e-01, 1.0068e+00, 1.0395e+00,
        1.0530e+00, 3.8237e+05, 3.8277e+05, 3.8635e+05, 3.8918e+05, 3.9195e+05,
        3.9362e+05, 3.9696e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391936.8125, 391942.7500, 391953.8750, 391958.8750,
        391965.7500, 391969.6875, 391984.8750, 763153.6250, 772461.7500,
        779525.1250, 791512.0000, 795756.2500, 799190.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389148.1875, 389160.9688, 389161.9375, 389164.9375,
        389170.0938, 389176.3125, 389180.5312, 755891.5000, 759875.3750,
        768705.6250, 768944.0625, 780980.1250, 795756.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 8.5888e-01, 8.7312e-01, 9.5123e-01, 1.0138e+00, 1.0855e+00,
        1.0860e+00, 3.8237e+05, 3.8274e+05, 3.8634e+05, 3.8915e+05, 3.9194e+05,
        3.9367e+05, 3.9699e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 382707.3125, 382716.3750, 382724.4375, 382732.0625,
        382744.3750, 382760.8125, 382767.2500, 763719.7500, 768705.6250,
        773265.9375, 779525.1250, 782398.8125, 800918.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396947.5938, 396960.7500, 396963.3125, 396975.3438,
        396984.1562, 396988.2500, 396992.0938, 763585.1250, 764783.3125,
        780980.1250, 784848.5000, 799190.3125, 800918.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386334.0625, 386334.8125, 386335.1875, 386335.4375,
        386343.4062, 386349.1250, 386351.2188, 759875.3750, 763025.0000,
        763585.1250, 773265.9375, 787541.6250, 791512.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0138e+00, 1.0395e+00, 1.0688e+00, 1.0727e+00, 1.0931e+00,
        1.1364e+00, 3.8236e+05, 3.8271e+05, 3.8634e+05, 3.8916e+05, 3.9197e+05,
        3.9363e+05, 3.9699e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['127936.22', '127942.56', '127937.16', '476590.09', '466166.19', '127937.95', '127943.80', '475480.91', '471103.31', '127939.84', '467953.06', '478575.53', '469698.16', '127935.62']
estimated f for each client, fs: [7, 7, 7, 4, 4, 7, 7, 4, 4, 7, 5, 4, 4, 7]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 13, 14, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0090s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:21...
global Accuracy on shared test data: 71.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 76 187]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:21, End: 2025-07-22 15:29:21)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.9413e+05, 3.9413e+05, 8.1133e+05, 3.9412e+05, 3.9413e+05,
         3.9411e+05, 7.7785e+05, 7.8570e+05, 3.9414e+05, 3.9411e+05, 7.8644e+05,
         3.9411e+05, 3.9413e+05],
        [3.9413e+05, 0.0000e+00, 1.1461e+00, 4.1667e+05, 1.1877e+00, 1.2113e+00,
         1.2595e+00, 3.8105e+05, 3.8280e+05, 1.2643e+00, 1.1106e+00, 3.9481e+05,
         1.2191e+00, 1.4452e+00],
        [3.9413e+05, 1.1461e+00, 0.0000e+00, 4.1668e+05, 1.0020e+00, 1.0498e+00,
         1.2790e+00, 3.8104e+05, 3.8282e+05, 1.0277e+00, 1.2275e+00, 3.9478e+05,
         1.0143e+00, 1.2166e+00],
        [8.1133e+05, 4.1667e+05, 4.1668e+05, 0.0000e+00, 4.1667e+05, 4.1668e+05,
         4.1664e+05, 7.9426e+05, 7.8366e+05, 4.1669e+05, 4.1666e+05, 8.1962e+05,
         4.1666e+05, 4.1668e+05],
        [3.9412e+05, 1.1877e+00, 1.0020e+00, 4.1667e+05, 0.0000e+00, 9.4312e-01,
         1.2345e+00, 3.8104e+05, 3.8280e+05, 9.8557e-01, 1.1063e+00, 3.9477e+05,
         9.7551e-01, 1.1517e+00],
        [3.9413e+05, 1.2113e+00, 1.0498e+00, 4.1668e+05, 9.4312e-01, 0.0000e+00,
         1.3529e+00, 3.8104e+05, 3.8279e+05, 9.6782e-01, 1.2566e+00, 3.9478e+05,
         9.7115e-01, 1.1605e+00],
        [3.9411e+05, 1.2595e+00, 1.2790e+00, 4.1664e+05, 1.2345e+00, 1.3529e+00,
         0.0000e+00, 3.8101e+05, 3.8276e+05, 1.4564e+00, 1.1380e+00, 3.9482e+05,
         1.4129e+00, 1.4299e+00],
        [7.7785e+05, 3.8105e+05, 3.8104e+05, 7.9426e+05, 3.8104e+05, 3.8104e+05,
         3.8101e+05, 0.0000e+00, 7.6101e+05, 3.8102e+05, 3.8102e+05, 7.6893e+05,
         3.8104e+05, 3.8101e+05],
        [7.8570e+05, 3.8280e+05, 3.8282e+05, 7.8366e+05, 3.8280e+05, 3.8279e+05,
         3.8276e+05, 7.6101e+05, 0.0000e+00, 3.8281e+05, 3.8277e+05, 7.7759e+05,
         3.8281e+05, 3.8278e+05],
        [3.9414e+05, 1.2643e+00, 1.0277e+00, 4.1669e+05, 9.8557e-01, 9.6782e-01,
         1.4564e+00, 3.8102e+05, 3.8281e+05, 0.0000e+00, 1.3292e+00, 3.9480e+05,
         9.9781e-01, 1.0793e+00],
        [3.9411e+05, 1.1106e+00, 1.2275e+00, 4.1666e+05, 1.1063e+00, 1.2566e+00,
         1.1380e+00, 3.8102e+05, 3.8277e+05, 1.3292e+00, 0.0000e+00, 3.9480e+05,
         1.2880e+00, 1.5346e+00],
        [7.8644e+05, 3.9481e+05, 3.9478e+05, 8.1962e+05, 3.9477e+05, 3.9478e+05,
         3.9482e+05, 7.6893e+05, 7.7759e+05, 3.9480e+05, 3.9480e+05, 0.0000e+00,
         3.9479e+05, 3.9482e+05],
        [3.9411e+05, 1.2191e+00, 1.0143e+00, 4.1666e+05, 9.7551e-01, 9.7115e-01,
         1.4129e+00, 3.8104e+05, 3.8281e+05, 9.9781e-01, 1.2880e+00, 3.9479e+05,
         0.0000e+00, 1.1905e+00],
        [3.9413e+05, 1.4452e+00, 1.2166e+00, 4.1668e+05, 1.1517e+00, 1.1605e+00,
         1.4299e+00, 3.8101e+05, 3.8278e+05, 1.0793e+00, 1.5346e+00, 3.9482e+05,
         1.1905e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 394106.9375, 394109.1875, 394111.3750, 394122.8125,
        394132.0938, 394132.4375, 394133.1875, 394133.3125, 394136.5000,
        777846.2500, 785700.6250, 786442.3750, 811326.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1106e+00, 1.1461e+00, 1.1877e+00, 1.2113e+00, 1.2191e+00,
        1.2595e+00, 1.2643e+00, 1.4452e+00, 3.8105e+05, 3.8280e+05, 3.9413e+05,
        3.9481e+05, 4.1667e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0020e+00, 1.0143e+00, 1.0277e+00, 1.0498e+00, 1.1461e+00,
        1.2166e+00, 1.2275e+00, 1.2790e+00, 3.8104e+05, 3.8282e+05, 3.9413e+05,
        3.9478e+05, 4.1668e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 416638.9062, 416658.5625, 416662.5312, 416673.8125,
        416674.2812, 416675.1562, 416676.8750, 416683.1875, 416686.0000,
        783657.8750, 794262.3125, 811326.8125, 819615.1250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.4312e-01, 9.7551e-01, 9.8557e-01, 1.0020e+00, 1.1063e+00,
        1.1517e+00, 1.1877e+00, 1.2345e+00, 3.8104e+05, 3.8280e+05, 3.9412e+05,
        3.9477e+05, 4.1667e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.4312e-01, 9.6782e-01, 9.7115e-01, 1.0498e+00, 1.1605e+00,
        1.2113e+00, 1.2566e+00, 1.3529e+00, 3.8104e+05, 3.8279e+05, 3.9413e+05,
        3.9478e+05, 4.1668e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1380e+00, 1.2345e+00, 1.2595e+00, 1.2790e+00, 1.3529e+00,
        1.4129e+00, 1.4299e+00, 1.4564e+00, 3.8101e+05, 3.8276e+05, 3.9411e+05,
        3.9482e+05, 4.1664e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 381012.6250, 381013.6562, 381019.5000, 381022.2812,
        381035.8125, 381038.1875, 381041.5625, 381044.0938, 381046.5938,
        761012.3125, 768925.5000, 777846.2500, 794262.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 382759.1250, 382771.3750, 382778.1875, 382793.2812,
        382799.8750, 382800.2188, 382805.1875, 382808.7500, 382817.6562,
        761012.3125, 777589.6250, 783657.8750, 785700.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.6782e-01, 9.8557e-01, 9.9781e-01, 1.0277e+00, 1.0793e+00,
        1.2643e+00, 1.3292e+00, 1.4564e+00, 3.8102e+05, 3.8281e+05, 3.9414e+05,
        3.9480e+05, 4.1669e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1063e+00, 1.1106e+00, 1.1380e+00, 1.2275e+00, 1.2566e+00,
        1.2880e+00, 1.3292e+00, 1.5346e+00, 3.8102e+05, 3.8277e+05, 3.9411e+05,
        3.9480e+05, 4.1666e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394771.2188, 394780.5625, 394783.0000, 394794.0000,
        394798.6875, 394801.9688, 394809.5938, 394816.7500, 394817.3438,
        768925.5000, 777589.6250, 786442.3750, 819615.1250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.7115e-01, 9.7551e-01, 9.9781e-01, 1.0143e+00, 1.1905e+00,
        1.2191e+00, 1.2880e+00, 1.4129e+00, 3.8104e+05, 3.8281e+05, 3.9411e+05,
        3.9479e+05, 4.1666e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0793e+00, 1.1517e+00, 1.1605e+00, 1.1905e+00, 1.2166e+00,
        1.4299e+00, 1.4452e+00, 1.5346e+00, 3.8101e+05, 3.8278e+05, 3.9413e+05,
        3.9482e+05, 4.1668e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['394124.19', '42339.60', '42338.57', '416669.91', '42338.90', '42338.30', '42335.91', '381030.47', '382792.62', '42336.82', '42336.61', '394797.00', '42339.24', '42335.98']
estimated f for each client, fs: [3, 5, 5, 3, 5, 5, 5, 3, 3, 5, 5, 3, 5, 5]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0100s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:22...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[153  84]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:22, End: 2025-07-22 15:29:22)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.0966e+00, 1.3295e+00, 3.9611e+05, 3.8199e+05, 1.2760e+00,
         3.9082e+05, 1.1968e+00, 3.9310e+05, 1.2159e+00, 1.3129e+00, 3.9212e+05,
         3.8280e+05, 1.0263e+00, 1.2721e+00, 3.9571e+05, 1.2205e+00, 1.2028e+00],
        [1.0966e+00, 0.0000e+00, 1.2299e+00, 3.9610e+05, 3.8200e+05, 1.2670e+00,
         3.9084e+05, 1.0382e+00, 3.9306e+05, 9.8707e-01, 1.1820e+00, 3.9208e+05,
         3.8282e+05, 9.9530e-01, 1.3126e+00, 3.9572e+05, 1.1099e+00, 1.0857e+00],
        [1.3295e+00, 1.2299e+00, 0.0000e+00, 3.9612e+05, 3.8200e+05, 1.1969e+00,
         3.9085e+05, 1.2974e+00, 3.9310e+05, 1.2689e+00, 1.3701e+00, 3.9206e+05,
         3.8282e+05, 1.3041e+00, 1.1493e+00, 3.9573e+05, 1.1943e+00, 1.3498e+00],
        [3.9611e+05, 3.9610e+05, 3.9612e+05, 0.0000e+00, 7.8799e+05, 3.9614e+05,
         7.9138e+05, 3.9613e+05, 8.1116e+05, 3.9613e+05, 3.9613e+05, 7.9143e+05,
         7.8175e+05, 3.9611e+05, 3.9614e+05, 8.1220e+05, 3.9615e+05, 3.9611e+05],
        [3.8199e+05, 3.8200e+05, 3.8200e+05, 7.8799e+05, 0.0000e+00, 3.8200e+05,
         7.7786e+05, 3.8200e+05, 7.8974e+05, 3.8200e+05, 3.8200e+05, 7.9582e+05,
         7.6443e+05, 3.8198e+05, 3.8201e+05, 7.9360e+05, 3.8200e+05, 3.8199e+05],
        [1.2760e+00, 1.2670e+00, 1.1969e+00, 3.9614e+05, 3.8200e+05, 0.0000e+00,
         3.9084e+05, 1.2911e+00, 3.9308e+05, 1.2994e+00, 1.4701e+00, 3.9207e+05,
         3.8281e+05, 1.2423e+00, 1.2236e+00, 3.9574e+05, 1.2017e+00, 1.3045e+00],
        [3.9082e+05, 3.9084e+05, 3.9085e+05, 7.9138e+05, 7.7786e+05, 3.9084e+05,
         0.0000e+00, 3.9083e+05, 8.0882e+05, 3.9087e+05, 3.9086e+05, 7.5518e+05,
         7.5443e+05, 3.9083e+05, 3.9085e+05, 8.1821e+05, 3.9086e+05, 3.9084e+05],
        [1.1968e+00, 1.0382e+00, 1.2974e+00, 3.9613e+05, 3.8200e+05, 1.2911e+00,
         3.9083e+05, 0.0000e+00, 3.9308e+05, 1.0786e+00, 1.2430e+00, 3.9210e+05,
         3.8282e+05, 1.0919e+00, 1.2601e+00, 3.9568e+05, 1.0475e+00, 1.0930e+00],
        [3.9310e+05, 3.9306e+05, 3.9310e+05, 8.1116e+05, 7.8974e+05, 3.9308e+05,
         8.0882e+05, 3.9308e+05, 0.0000e+00, 3.9305e+05, 3.9308e+05, 7.9335e+05,
         7.7915e+05, 3.9306e+05, 3.9306e+05, 7.8627e+05, 3.9308e+05, 3.9304e+05],
        [1.2159e+00, 9.8707e-01, 1.2689e+00, 3.9613e+05, 3.8200e+05, 1.2994e+00,
         3.9087e+05, 1.0786e+00, 3.9305e+05, 0.0000e+00, 1.2090e+00, 3.9208e+05,
         3.8284e+05, 1.0631e+00, 1.3747e+00, 3.9569e+05, 1.0307e+00, 1.0901e+00],
        [1.3129e+00, 1.1820e+00, 1.3701e+00, 3.9613e+05, 3.8200e+05, 1.4701e+00,
         3.9086e+05, 1.2430e+00, 3.9308e+05, 1.2090e+00, 0.0000e+00, 3.9208e+05,
         3.8282e+05, 1.2740e+00, 1.4226e+00, 3.9571e+05, 1.2597e+00, 1.0781e+00],
        [3.9212e+05, 3.9208e+05, 3.9206e+05, 7.9143e+05, 7.9582e+05, 3.9207e+05,
         7.5518e+05, 3.9210e+05, 7.9335e+05, 3.9208e+05, 3.9208e+05, 0.0000e+00,
         7.4627e+05, 3.9207e+05, 3.9208e+05, 8.0181e+05, 3.9209e+05, 3.9209e+05],
        [3.8280e+05, 3.8282e+05, 3.8282e+05, 7.8175e+05, 7.6443e+05, 3.8281e+05,
         7.5443e+05, 3.8282e+05, 7.7915e+05, 3.8284e+05, 3.8282e+05, 7.4627e+05,
         0.0000e+00, 3.8283e+05, 3.8281e+05, 7.8684e+05, 3.8281e+05, 3.8283e+05],
        [1.0263e+00, 9.9530e-01, 1.3041e+00, 3.9611e+05, 3.8198e+05, 1.2423e+00,
         3.9083e+05, 1.0919e+00, 3.9306e+05, 1.0631e+00, 1.2740e+00, 3.9207e+05,
         3.8283e+05, 0.0000e+00, 1.3407e+00, 3.9570e+05, 1.0401e+00, 1.0252e+00],
        [1.2721e+00, 1.3126e+00, 1.1493e+00, 3.9614e+05, 3.8201e+05, 1.2236e+00,
         3.9085e+05, 1.2601e+00, 3.9306e+05, 1.3747e+00, 1.4226e+00, 3.9208e+05,
         3.8281e+05, 1.3407e+00, 0.0000e+00, 3.9574e+05, 1.2943e+00, 1.3820e+00],
        [3.9571e+05, 3.9572e+05, 3.9573e+05, 8.1220e+05, 7.9360e+05, 3.9574e+05,
         8.1821e+05, 3.9568e+05, 7.8627e+05, 3.9569e+05, 3.9571e+05, 8.0181e+05,
         7.8684e+05, 3.9570e+05, 3.9574e+05, 0.0000e+00, 3.9569e+05, 3.9570e+05],
        [1.2205e+00, 1.1099e+00, 1.1943e+00, 3.9615e+05, 3.8200e+05, 1.2017e+00,
         3.9086e+05, 1.0475e+00, 3.9308e+05, 1.0307e+00, 1.2597e+00, 3.9209e+05,
         3.8281e+05, 1.0401e+00, 1.2943e+00, 3.9569e+05, 0.0000e+00, 1.0867e+00],
        [1.2028e+00, 1.0857e+00, 1.3498e+00, 3.9611e+05, 3.8199e+05, 1.3045e+00,
         3.9084e+05, 1.0930e+00, 3.9304e+05, 1.0901e+00, 1.0781e+00, 3.9209e+05,
         3.8283e+05, 1.0252e+00, 1.3820e+00, 3.9570e+05, 1.0867e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0263e+00, 1.0966e+00, 1.1968e+00, 1.2028e+00, 1.2159e+00,
        1.2205e+00, 1.2721e+00, 1.2760e+00, 1.3129e+00, 1.3295e+00, 3.8199e+05,
        3.8280e+05, 3.9082e+05, 3.9212e+05, 3.9310e+05, 3.9571e+05, 3.9611e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.8707e-01, 9.9530e-01, 1.0382e+00, 1.0857e+00, 1.0966e+00,
        1.1099e+00, 1.1820e+00, 1.2299e+00, 1.2670e+00, 1.3126e+00, 3.8200e+05,
        3.8282e+05, 3.9084e+05, 3.9208e+05, 3.9306e+05, 3.9572e+05, 3.9610e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1493e+00, 1.1943e+00, 1.1969e+00, 1.2299e+00, 1.2689e+00,
        1.2974e+00, 1.3041e+00, 1.3295e+00, 1.3498e+00, 1.3701e+00, 3.8200e+05,
        3.8282e+05, 3.9085e+05, 3.9206e+05, 3.9310e+05, 3.9573e+05, 3.9612e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396104.7812, 396108.7812, 396111.4688, 396112.0625,
        396124.1875, 396129.7812, 396130.9375, 396133.9062, 396144.4375,
        396144.6562, 396149.5000, 781749.1250, 787989.8125, 791380.6875,
        791433.7500, 811160.0625, 812199.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 381975.5312, 381988.0625, 381988.4688, 381995.7500,
        381997.5625, 381998.1250, 381998.2500, 382000.2500, 382000.2812,
        382003.8125, 382012.7188, 764431.8750, 777864.1250, 787989.8125,
        789742.7500, 793601.1250, 795819.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1969e+00, 1.2017e+00, 1.2236e+00, 1.2423e+00, 1.2670e+00,
        1.2760e+00, 1.2911e+00, 1.2994e+00, 1.3045e+00, 1.4701e+00, 3.8200e+05,
        3.8281e+05, 3.9084e+05, 3.9207e+05, 3.9308e+05, 3.9574e+05, 3.9614e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 390821.7500, 390830.6250, 390831.8750, 390836.0938,
        390839.0312, 390842.5312, 390846.1250, 390852.1250, 390862.2500,
        390864.0625, 390868.3750, 754425.4375, 755184.2500, 777864.1250,
        791380.6875, 808815.5000, 818206.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0382e+00, 1.0475e+00, 1.0786e+00, 1.0919e+00, 1.0930e+00,
        1.1968e+00, 1.2430e+00, 1.2601e+00, 1.2911e+00, 1.2974e+00, 3.8200e+05,
        3.8282e+05, 3.9083e+05, 3.9210e+05, 3.9308e+05, 3.9568e+05, 3.9613e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393036.3750, 393054.8125, 393057.3125, 393057.4375,
        393061.8750, 393077.8125, 393077.8750, 393079.1562, 393084.2500,
        393102.0938, 393103.0625, 779149.2500, 786271.6250, 789742.7500,
        793349.5000, 808815.5000, 811160.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.8707e-01, 1.0307e+00, 1.0631e+00, 1.0786e+00, 1.0901e+00,
        1.2090e+00, 1.2159e+00, 1.2689e+00, 1.2994e+00, 1.3747e+00, 3.8200e+05,
        3.8284e+05, 3.9087e+05, 3.9208e+05, 3.9305e+05, 3.9569e+05, 3.9613e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0781e+00, 1.1820e+00, 1.2090e+00, 1.2430e+00, 1.2597e+00,
        1.2740e+00, 1.3129e+00, 1.3701e+00, 1.4226e+00, 1.4701e+00, 3.8200e+05,
        3.8282e+05, 3.9086e+05, 3.9208e+05, 3.9308e+05, 3.9571e+05, 3.9613e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392055.5625, 392065.5000, 392067.9688, 392075.4062,
        392078.8750, 392084.6562, 392084.9688, 392088.9688, 392090.6250,
        392097.9688, 392119.8438, 746271.2500, 755184.2500, 791433.7500,
        793349.5000, 795819.9375, 801805.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382801.4062, 382811.9375, 382812.3750, 382813.6562,
        382815.2188, 382816.0625, 382823.9375, 382824.7500, 382825.6250,
        382827.2500, 382840.0312, 746271.2500, 754425.4375, 764431.8750,
        779149.2500, 781749.1250, 786841.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.9530e-01, 1.0252e+00, 1.0263e+00, 1.0401e+00, 1.0631e+00,
        1.0919e+00, 1.2423e+00, 1.2740e+00, 1.3041e+00, 1.3407e+00, 3.8198e+05,
        3.8283e+05, 3.9083e+05, 3.9207e+05, 3.9306e+05, 3.9570e+05, 3.9611e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1493e+00, 1.2236e+00, 1.2601e+00, 1.2721e+00, 1.2943e+00,
        1.3126e+00, 1.3407e+00, 1.3747e+00, 1.3820e+00, 1.4226e+00, 3.8201e+05,
        3.8281e+05, 3.9085e+05, 3.9208e+05, 3.9306e+05, 3.9574e+05, 3.9614e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395679.9062, 395686.0625, 395690.7500, 395697.1875,
        395702.8750, 395707.8750, 395711.3125, 395722.4062, 395733.6250,
        395743.1250, 395744.9062, 786271.6250, 786841.4375, 793601.1250,
        801805.1250, 812199.1250, 818206.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0307e+00, 1.0401e+00, 1.0475e+00, 1.0867e+00, 1.1099e+00,
        1.1943e+00, 1.2017e+00, 1.2205e+00, 1.2597e+00, 1.2943e+00, 3.8200e+05,
        3.8281e+05, 3.9086e+05, 3.9209e+05, 3.9308e+05, 3.9569e+05, 3.9615e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0252e+00, 1.0781e+00, 1.0857e+00, 1.0867e+00, 1.0901e+00,
        1.0930e+00, 1.2028e+00, 1.3045e+00, 1.3498e+00, 1.3820e+00, 3.8199e+05,
        3.8283e+05, 3.9084e+05, 3.9209e+05, 3.9304e+05, 3.9570e+05, 3.9611e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34727.29', '34728.08', '34728.27', '396126.78', '381996.25', '34728.45', '390844.97', '34728.36', '393071.97', '34728.67', '34728.27', '392082.72', '382819.28', '34726.08', '34729.61', '395710.88', '34727.93', '34727.29']
estimated f for each client, fs: [7, 7, 7, 5, 6, 7, 5, 7, 5, 7, 7, 5, 5, 7, 7, 5, 7, 7]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0387s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:23...
global Accuracy on shared test data: 71.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[160  77]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:23, End: 2025-07-22 15:29:23)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.7803e-01, 3.8790e+05, 1.0793e+00, 1.0235e+00, 3.8324e+05,
         9.9345e-01, 9.7116e-01, 1.0351e+00, 3.9807e+05, 3.8091e+05, 1.2602e+00,
         1.1023e+00, 3.9099e+05, 1.0381e+00, 1.0323e+00],
        [9.7803e-01, 0.0000e+00, 3.8792e+05, 1.0667e+00, 9.1805e-01, 3.8325e+05,
         8.7250e-01, 8.2315e-01, 9.1248e-01, 3.9808e+05, 3.8092e+05, 1.1129e+00,
         1.1217e+00, 3.9095e+05, 9.3810e-01, 9.4752e-01],
        [3.8790e+05, 3.8792e+05, 0.0000e+00, 3.8795e+05, 3.8795e+05, 7.6500e+05,
         3.8792e+05, 3.8791e+05, 3.8792e+05, 7.6495e+05, 7.5540e+05, 3.8793e+05,
         3.8792e+05, 7.7073e+05, 3.8792e+05, 3.8792e+05],
        [1.0793e+00, 1.0667e+00, 3.8795e+05, 0.0000e+00, 9.5760e-01, 3.8324e+05,
         1.0573e+00, 1.0036e+00, 1.0439e+00, 3.9807e+05, 3.8092e+05, 1.4954e+00,
         1.0358e+00, 3.9097e+05, 1.0287e+00, 1.0413e+00],
        [1.0235e+00, 9.1805e-01, 3.8795e+05, 9.5760e-01, 0.0000e+00, 3.8325e+05,
         9.0308e-01, 8.7405e-01, 9.1919e-01, 3.9808e+05, 3.8093e+05, 1.1806e+00,
         1.0855e+00, 3.9097e+05, 8.8698e-01, 8.9819e-01],
        [3.8324e+05, 3.8325e+05, 7.6500e+05, 3.8324e+05, 3.8325e+05, 0.0000e+00,
         3.8323e+05, 3.8326e+05, 3.8324e+05, 7.6241e+05, 7.6704e+05, 3.8326e+05,
         3.8324e+05, 7.6922e+05, 3.8324e+05, 3.8323e+05],
        [9.9345e-01, 8.7250e-01, 3.8792e+05, 1.0573e+00, 9.0308e-01, 3.8323e+05,
         0.0000e+00, 8.3863e-01, 9.2569e-01, 3.9807e+05, 3.8091e+05, 1.1877e+00,
         1.0320e+00, 3.9096e+05, 8.6507e-01, 9.0091e-01],
        [9.7116e-01, 8.2315e-01, 3.8791e+05, 1.0036e+00, 8.7405e-01, 3.8326e+05,
         8.3863e-01, 0.0000e+00, 8.8589e-01, 3.9806e+05, 3.8092e+05, 1.1075e+00,
         1.0994e+00, 3.9096e+05, 8.4564e-01, 8.7914e-01],
        [1.0351e+00, 9.1248e-01, 3.8792e+05, 1.0439e+00, 9.1919e-01, 3.8324e+05,
         9.2569e-01, 8.8589e-01, 0.0000e+00, 3.9807e+05, 3.8090e+05, 1.2647e+00,
         1.0320e+00, 3.9096e+05, 9.5712e-01, 8.3981e-01],
        [3.9807e+05, 3.9808e+05, 7.6495e+05, 3.9807e+05, 3.9808e+05, 7.6241e+05,
         3.9807e+05, 3.9806e+05, 3.9807e+05, 0.0000e+00, 7.8209e+05, 3.9806e+05,
         3.9809e+05, 7.9176e+05, 3.9807e+05, 3.9807e+05],
        [3.8091e+05, 3.8092e+05, 7.5540e+05, 3.8092e+05, 3.8093e+05, 7.6704e+05,
         3.8091e+05, 3.8092e+05, 3.8090e+05, 7.8209e+05, 0.0000e+00, 3.8091e+05,
         3.8089e+05, 7.9109e+05, 3.8092e+05, 3.8092e+05],
        [1.2602e+00, 1.1129e+00, 3.8793e+05, 1.4954e+00, 1.1806e+00, 3.8326e+05,
         1.1877e+00, 1.1075e+00, 1.2647e+00, 3.9806e+05, 3.8091e+05, 0.0000e+00,
         1.6151e+00, 3.9095e+05, 1.1528e+00, 1.0328e+00],
        [1.1023e+00, 1.1217e+00, 3.8792e+05, 1.0358e+00, 1.0855e+00, 3.8324e+05,
         1.0320e+00, 1.0994e+00, 1.0320e+00, 3.9809e+05, 3.8089e+05, 1.6151e+00,
         0.0000e+00, 3.9093e+05, 1.1043e+00, 1.1769e+00],
        [3.9099e+05, 3.9095e+05, 7.7073e+05, 3.9097e+05, 3.9097e+05, 7.6922e+05,
         3.9096e+05, 3.9096e+05, 3.9096e+05, 7.9176e+05, 7.9109e+05, 3.9095e+05,
         3.9093e+05, 0.0000e+00, 3.9095e+05, 3.9095e+05],
        [1.0381e+00, 9.3810e-01, 3.8792e+05, 1.0287e+00, 8.8698e-01, 3.8324e+05,
         8.6507e-01, 8.4564e-01, 9.5712e-01, 3.9807e+05, 3.8092e+05, 1.1528e+00,
         1.1043e+00, 3.9095e+05, 0.0000e+00, 8.8597e-01],
        [1.0323e+00, 9.4752e-01, 3.8792e+05, 1.0413e+00, 8.9819e-01, 3.8323e+05,
         9.0091e-01, 8.7914e-01, 8.3981e-01, 3.9807e+05, 3.8092e+05, 1.0328e+00,
         1.1769e+00, 3.9095e+05, 8.8597e-01, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.7116e-01, 9.7803e-01, 9.9345e-01, 1.0235e+00, 1.0323e+00,
        1.0351e+00, 1.0381e+00, 1.0793e+00, 1.1023e+00, 1.2602e+00, 3.8091e+05,
        3.8324e+05, 3.8790e+05, 3.9099e+05, 3.9807e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.2315e-01, 8.7250e-01, 9.1248e-01, 9.1805e-01, 9.3810e-01,
        9.4752e-01, 9.7803e-01, 1.0667e+00, 1.1129e+00, 1.1217e+00, 3.8092e+05,
        3.8325e+05, 3.8792e+05, 3.9095e+05, 3.9808e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387904.8750, 387906.5312, 387916.5000, 387917.3125,
        387919.1562, 387919.3438, 387921.2188, 387924.6875, 387925.0312,
        387945.3438, 387952.8750, 755398.1250, 764954.1250, 764996.8750,
        770733.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.5760e-01, 1.0036e+00, 1.0287e+00, 1.0358e+00, 1.0413e+00,
        1.0439e+00, 1.0573e+00, 1.0667e+00, 1.0793e+00, 1.4954e+00, 3.8092e+05,
        3.8324e+05, 3.8795e+05, 3.9097e+05, 3.9807e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7405e-01, 8.8698e-01, 8.9819e-01, 9.0308e-01, 9.1805e-01,
        9.1919e-01, 9.5760e-01, 1.0235e+00, 1.0855e+00, 1.1806e+00, 3.8093e+05,
        3.8325e+05, 3.8795e+05, 3.9097e+05, 3.9808e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383227.2500, 383231.6250, 383237.8750, 383240.9062,
        383241.8750, 383244.0312, 383244.4688, 383245.0625, 383245.4375,
        383256.3750, 383261.9062, 762414.4375, 764996.8750, 767041.7500,
        769217.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.3863e-01, 8.6507e-01, 8.7250e-01, 9.0091e-01, 9.0308e-01,
        9.2569e-01, 9.9345e-01, 1.0320e+00, 1.0573e+00, 1.1877e+00, 3.8091e+05,
        3.8323e+05, 3.8792e+05, 3.9096e+05, 3.9807e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.2315e-01, 8.3863e-01, 8.4564e-01, 8.7405e-01, 8.7914e-01,
        8.8589e-01, 9.7116e-01, 1.0036e+00, 1.0994e+00, 1.1075e+00, 3.8092e+05,
        3.8326e+05, 3.8791e+05, 3.9096e+05, 3.9806e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3981e-01, 8.8589e-01, 9.1248e-01, 9.1919e-01, 9.2569e-01,
        9.5712e-01, 1.0320e+00, 1.0351e+00, 1.0439e+00, 1.2647e+00, 3.8090e+05,
        3.8324e+05, 3.8792e+05, 3.9096e+05, 3.9807e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398060.7812, 398062.2812, 398069.0000, 398070.9375,
        398071.8125, 398072.2188, 398073.0312, 398074.6562, 398077.0938,
        398081.1875, 398089.1250, 762414.4375, 764954.1250, 782089.2500,
        791761.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 380892.3125, 380901.2188, 380907.3750, 380909.6875,
        380913.5312, 380915.9375, 380916.3125, 380918.5312, 380924.4062,
        380924.6875, 380929.7812, 755398.1250, 767041.7500, 782089.2500,
        791087.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0328e+00, 1.1075e+00, 1.1129e+00, 1.1528e+00, 1.1806e+00,
        1.1877e+00, 1.2602e+00, 1.2647e+00, 1.4954e+00, 1.6151e+00, 3.8091e+05,
        3.8326e+05, 3.8793e+05, 3.9095e+05, 3.9806e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0320e+00, 1.0320e+00, 1.0358e+00, 1.0855e+00, 1.0994e+00,
        1.1023e+00, 1.1043e+00, 1.1217e+00, 1.1769e+00, 1.6151e+00, 3.8089e+05,
        3.8324e+05, 3.8792e+05, 3.9093e+05, 3.9809e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390926.0312, 390946.1875, 390948.0312, 390953.4688,
        390954.4062, 390957.3438, 390958.5938, 390958.5938, 390969.3750,
        390970.8750, 390989.3125, 769217.8125, 770733.8750, 791087.5000,
        791761.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.4564e-01, 8.6507e-01, 8.8597e-01, 8.8698e-01, 9.3810e-01,
        9.5712e-01, 1.0287e+00, 1.0381e+00, 1.1043e+00, 1.1528e+00, 3.8092e+05,
        3.8324e+05, 3.8792e+05, 3.9095e+05, 3.9807e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3981e-01, 8.7914e-01, 8.8597e-01, 8.9819e-01, 9.0091e-01,
        9.4752e-01, 1.0323e+00, 1.0328e+00, 1.0413e+00, 1.1769e+00, 3.8092e+05,
        3.8323e+05, 3.8792e+05, 3.9095e+05, 3.9807e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.05', '0.97', '387922.97', '1.08', '0.96', '383243.38', '0.96', '0.93', '0.98', '398072.91', '380914.00', '1.24', '1.14', '390957.47', '0.97', '0.96']
estimated f for each client, fs: [5, 5, 3, 5, 5, 3, 5, 5, 5, 3, 3, 5, 5, 3, 5, 5]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0134s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:23...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:23, End: 2025-07-22 15:29:23)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 9.7240e-01, 1.1187e+00, 3.8239e+05, 3.8225e+05, 1.0671e+00,
         9.8687e-01, 3.9906e+05, 4.0508e+05, 1.0048e+00, 1.2583e+00, 9.9953e-01,
         3.8730e+05, 3.8425e+05, 1.0109e+00, 1.0775e+00, 3.8726e+05, 1.0064e+00,
         1.0099e+00],
        [9.7240e-01, 0.0000e+00, 1.0422e+00, 3.8236e+05, 3.8226e+05, 1.0828e+00,
         9.2734e-01, 3.9908e+05, 4.0508e+05, 9.1972e-01, 1.0237e+00, 9.7163e-01,
         3.8727e+05, 3.8424e+05, 9.3013e-01, 1.1742e+00, 3.8723e+05, 9.2758e-01,
         9.7604e-01],
        [1.1187e+00, 1.0422e+00, 0.0000e+00, 3.8242e+05, 3.8229e+05, 1.0342e+00,
         9.9221e-01, 3.9904e+05, 4.0507e+05, 1.1052e+00, 1.3749e+00, 1.0028e+00,
         3.8727e+05, 3.8421e+05, 1.2444e+00, 1.0405e+00, 3.8724e+05, 1.0237e+00,
         1.0701e+00],
        [3.8239e+05, 3.8236e+05, 3.8242e+05, 0.0000e+00, 7.6781e+05, 3.8238e+05,
         3.8239e+05, 7.5909e+05, 7.8890e+05, 3.8239e+05, 3.8238e+05, 3.8239e+05,
         7.8963e+05, 7.6437e+05, 3.8238e+05, 3.8241e+05, 7.6045e+05, 3.8237e+05,
         3.8237e+05],
        [3.8225e+05, 3.8226e+05, 3.8229e+05, 7.6781e+05, 0.0000e+00, 3.8229e+05,
         3.8225e+05, 7.8803e+05, 7.7973e+05, 3.8226e+05, 3.8227e+05, 3.8227e+05,
         7.7654e+05, 7.6103e+05, 3.8228e+05, 3.8227e+05, 7.6008e+05, 3.8227e+05,
         3.8226e+05],
        [1.0671e+00, 1.0828e+00, 1.0342e+00, 3.8238e+05, 3.8229e+05, 0.0000e+00,
         9.8687e-01, 3.9907e+05, 4.0508e+05, 1.1284e+00, 1.4095e+00, 1.0582e+00,
         3.8727e+05, 3.8423e+05, 1.2298e+00, 1.0798e+00, 3.8726e+05, 1.0584e+00,
         1.0547e+00],
        [9.8687e-01, 9.2734e-01, 9.9221e-01, 3.8239e+05, 3.8225e+05, 9.8687e-01,
         0.0000e+00, 3.9908e+05, 4.0505e+05, 9.0536e-01, 1.1038e+00, 9.2918e-01,
         3.8725e+05, 3.8422e+05, 9.5097e-01, 1.1037e+00, 3.8722e+05, 8.3981e-01,
         8.9775e-01],
        [3.9906e+05, 3.9908e+05, 3.9904e+05, 7.5909e+05, 7.8803e+05, 3.9907e+05,
         3.9908e+05, 0.0000e+00, 8.2292e+05, 3.9908e+05, 3.9910e+05, 3.9906e+05,
         7.7916e+05, 7.8558e+05, 3.9908e+05, 3.9908e+05, 7.8162e+05, 3.9908e+05,
         3.9908e+05],
        [4.0508e+05, 4.0508e+05, 4.0507e+05, 7.8890e+05, 7.7973e+05, 4.0508e+05,
         4.0505e+05, 8.2292e+05, 0.0000e+00, 4.0510e+05, 4.0511e+05, 4.0508e+05,
         7.8969e+05, 7.9425e+05, 4.0508e+05, 4.0508e+05, 7.9972e+05, 4.0507e+05,
         4.0509e+05],
        [1.0048e+00, 9.1972e-01, 1.1052e+00, 3.8239e+05, 3.8226e+05, 1.1284e+00,
         9.0536e-01, 3.9908e+05, 4.0510e+05, 0.0000e+00, 1.0774e+00, 9.7871e-01,
         3.8728e+05, 3.8421e+05, 9.8398e-01, 1.0650e+00, 3.8724e+05, 9.0467e-01,
         9.1404e-01],
        [1.2583e+00, 1.0237e+00, 1.3749e+00, 3.8238e+05, 3.8227e+05, 1.4095e+00,
         1.1038e+00, 3.9910e+05, 4.0511e+05, 1.0774e+00, 0.0000e+00, 1.1772e+00,
         3.8728e+05, 3.8423e+05, 8.8296e-01, 1.5554e+00, 3.8723e+05, 1.0296e+00,
         1.0548e+00],
        [9.9953e-01, 9.7163e-01, 1.0028e+00, 3.8239e+05, 3.8227e+05, 1.0582e+00,
         9.2918e-01, 3.9906e+05, 4.0508e+05, 9.7871e-01, 1.1772e+00, 0.0000e+00,
         3.8726e+05, 3.8423e+05, 1.0347e+00, 1.0543e+00, 3.8723e+05, 9.4963e-01,
         8.6024e-01],
        [3.8730e+05, 3.8727e+05, 3.8727e+05, 7.8963e+05, 7.7654e+05, 3.8727e+05,
         3.8725e+05, 7.7916e+05, 7.8969e+05, 3.8728e+05, 3.8728e+05, 3.8726e+05,
         0.0000e+00, 7.8532e+05, 3.8729e+05, 3.8729e+05, 7.6846e+05, 3.8728e+05,
         3.8726e+05],
        [3.8425e+05, 3.8424e+05, 3.8421e+05, 7.6437e+05, 7.6103e+05, 3.8423e+05,
         3.8422e+05, 7.8558e+05, 7.9425e+05, 3.8421e+05, 3.8423e+05, 3.8423e+05,
         7.8532e+05, 0.0000e+00, 3.8423e+05, 3.8422e+05, 7.7352e+05, 3.8426e+05,
         3.8424e+05],
        [1.0109e+00, 9.3013e-01, 1.2444e+00, 3.8238e+05, 3.8228e+05, 1.2298e+00,
         9.5097e-01, 3.9908e+05, 4.0508e+05, 9.8398e-01, 8.8296e-01, 1.0347e+00,
         3.8729e+05, 3.8423e+05, 0.0000e+00, 1.3529e+00, 3.8723e+05, 9.1845e-01,
         8.9717e-01],
        [1.0775e+00, 1.1742e+00, 1.0405e+00, 3.8241e+05, 3.8227e+05, 1.0798e+00,
         1.1037e+00, 3.9908e+05, 4.0508e+05, 1.0650e+00, 1.5554e+00, 1.0543e+00,
         3.8729e+05, 3.8422e+05, 1.3529e+00, 0.0000e+00, 3.8726e+05, 1.1200e+00,
         1.1793e+00],
        [3.8726e+05, 3.8723e+05, 3.8724e+05, 7.6045e+05, 7.6008e+05, 3.8726e+05,
         3.8722e+05, 7.8162e+05, 7.9972e+05, 3.8724e+05, 3.8723e+05, 3.8723e+05,
         7.6846e+05, 7.7352e+05, 3.8723e+05, 3.8726e+05, 0.0000e+00, 3.8725e+05,
         3.8726e+05],
        [1.0064e+00, 9.2758e-01, 1.0237e+00, 3.8237e+05, 3.8227e+05, 1.0584e+00,
         8.3981e-01, 3.9908e+05, 4.0507e+05, 9.0467e-01, 1.0296e+00, 9.4963e-01,
         3.8728e+05, 3.8426e+05, 9.1845e-01, 1.1200e+00, 3.8725e+05, 0.0000e+00,
         8.9767e-01],
        [1.0099e+00, 9.7604e-01, 1.0701e+00, 3.8237e+05, 3.8226e+05, 1.0547e+00,
         8.9775e-01, 3.9908e+05, 4.0509e+05, 9.1404e-01, 1.0548e+00, 8.6024e-01,
         3.8726e+05, 3.8424e+05, 8.9717e-01, 1.1793e+00, 3.8726e+05, 8.9767e-01,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.7240e-01, 9.8687e-01, 9.9953e-01, 1.0048e+00, 1.0064e+00,
        1.0099e+00, 1.0109e+00, 1.0671e+00, 1.0775e+00, 1.1187e+00, 1.2583e+00,
        3.8225e+05, 3.8239e+05, 3.8425e+05, 3.8726e+05, 3.8730e+05, 3.9906e+05,
        4.0508e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.1972e-01, 9.2734e-01, 9.2758e-01, 9.3013e-01, 9.7163e-01,
        9.7240e-01, 9.7604e-01, 1.0237e+00, 1.0422e+00, 1.0828e+00, 1.1742e+00,
        3.8226e+05, 3.8236e+05, 3.8424e+05, 3.8723e+05, 3.8727e+05, 3.9908e+05,
        4.0508e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.9221e-01, 1.0028e+00, 1.0237e+00, 1.0342e+00, 1.0405e+00,
        1.0422e+00, 1.0701e+00, 1.1052e+00, 1.1187e+00, 1.2444e+00, 1.3749e+00,
        3.8229e+05, 3.8242e+05, 3.8421e+05, 3.8724e+05, 3.8727e+05, 3.9904e+05,
        4.0507e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382358.1875, 382365.8750, 382372.3750, 382375.0625,
        382375.6875, 382377.6250, 382385.1875, 382386.0938, 382386.9688,
        382388.3125, 382413.1250, 382416.2500, 759088.5000, 760449.1875,
        764368.5625, 767813.0000, 788896.7500, 789625.1250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 382246.9688, 382249.6250, 382261.5000, 382263.4062,
        382263.9688, 382265.5938, 382266.5938, 382267.3125, 382269.5000,
        382278.5312, 382291.6875, 382294.4688, 760075.1250, 761026.9375,
        767813.0000, 776537.0000, 779731.3750, 788034.9375])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 9.8687e-01, 1.0342e+00, 1.0547e+00, 1.0582e+00, 1.0584e+00,
        1.0671e+00, 1.0798e+00, 1.0828e+00, 1.1284e+00, 1.2298e+00, 1.4095e+00,
        3.8229e+05, 3.8238e+05, 3.8423e+05, 3.8726e+05, 3.8727e+05, 3.9907e+05,
        4.0508e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.3981e-01, 8.9775e-01, 9.0536e-01, 9.2734e-01, 9.2918e-01,
        9.5097e-01, 9.8687e-01, 9.8687e-01, 9.9221e-01, 1.1037e+00, 1.1038e+00,
        3.8225e+05, 3.8239e+05, 3.8422e+05, 3.8722e+05, 3.8725e+05, 3.9908e+05,
        4.0505e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 399037.4688, 399060.1875, 399061.2812, 399074.4688,
        399075.8125, 399076.7188, 399078.0000, 399078.6250, 399078.6250,
        399082.7812, 399084.1875, 399097.0938, 759088.5000, 779163.0000,
        781624.0625, 785578.2500, 788034.9375, 822918.0000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 405051.4062, 405065.1250, 405071.5625, 405075.8750,
        405078.1250, 405079.8125, 405082.0938, 405084.1875, 405084.7188,
        405092.1875, 405104.9062, 405111.1875, 779731.3750, 788896.7500,
        789689.5625, 794252.3750, 799724.2500, 822918.0000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 9.0467e-01, 9.0536e-01, 9.1404e-01, 9.1972e-01, 9.7871e-01,
        9.8398e-01, 1.0048e+00, 1.0650e+00, 1.0774e+00, 1.1052e+00, 1.1284e+00,
        3.8226e+05, 3.8239e+05, 3.8421e+05, 3.8724e+05, 3.8728e+05, 3.9908e+05,
        4.0510e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.8296e-01, 1.0237e+00, 1.0296e+00, 1.0548e+00, 1.0774e+00,
        1.1038e+00, 1.1772e+00, 1.2583e+00, 1.3749e+00, 1.4095e+00, 1.5554e+00,
        3.8227e+05, 3.8238e+05, 3.8423e+05, 3.8723e+05, 3.8728e+05, 3.9910e+05,
        4.0511e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.6024e-01, 9.2918e-01, 9.4963e-01, 9.7163e-01, 9.7871e-01,
        9.9953e-01, 1.0028e+00, 1.0347e+00, 1.0543e+00, 1.0582e+00, 1.1772e+00,
        3.8227e+05, 3.8239e+05, 3.8423e+05, 3.8723e+05, 3.8726e+05, 3.9906e+05,
        4.0508e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387254.0938, 387263.1562, 387264.8750, 387269.8438,
        387270.6562, 387270.7500, 387276.9375, 387277.0938, 387280.8438,
        387294.0625, 387294.2188, 387295.9062, 768455.6875, 776537.0000,
        779163.0000, 785324.6875, 789625.1250, 789689.5625])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 384209.2812, 384213.2188, 384221.4062, 384223.5938,
        384225.7500, 384229.9688, 384230.8438, 384233.9375, 384238.2500,
        384242.7188, 384247.9375, 384261.0625, 761026.9375, 764368.5625,
        773518.8750, 785324.6875, 785578.2500, 794252.3750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 8.8296e-01, 8.9717e-01, 9.1845e-01, 9.3013e-01, 9.5097e-01,
        9.8398e-01, 1.0109e+00, 1.0347e+00, 1.2298e+00, 1.2444e+00, 1.3529e+00,
        3.8228e+05, 3.8238e+05, 3.8423e+05, 3.8723e+05, 3.8729e+05, 3.9908e+05,
        4.0508e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0405e+00, 1.0543e+00, 1.0650e+00, 1.0775e+00, 1.0798e+00,
        1.1037e+00, 1.1200e+00, 1.1742e+00, 1.1793e+00, 1.3529e+00, 1.5554e+00,
        3.8227e+05, 3.8241e+05, 3.8422e+05, 3.8726e+05, 3.8729e+05, 3.9908e+05,
        4.0508e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387220.0000, 387227.8750, 387231.7500, 387234.3438,
        387234.4375, 387239.5312, 387241.5625, 387248.0625, 387258.6250,
        387260.6875, 387261.0000, 387261.5000, 760075.1250, 760449.1875,
        768455.6875, 773518.8750, 781624.0625, 799724.2500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 8.3981e-01, 8.9767e-01, 9.0467e-01, 9.1845e-01, 9.2758e-01,
        9.4963e-01, 1.0064e+00, 1.0237e+00, 1.0296e+00, 1.0584e+00, 1.1200e+00,
        3.8227e+05, 3.8237e+05, 3.8426e+05, 3.8725e+05, 3.8728e+05, 3.9908e+05,
        4.0507e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.6024e-01, 8.9717e-01, 8.9767e-01, 8.9775e-01, 9.1404e-01,
        9.7604e-01, 1.0099e+00, 1.0547e+00, 1.0548e+00, 1.0701e+00, 1.1793e+00,
        3.8226e+05, 3.8237e+05, 3.8424e+05, 3.8726e+05, 3.8726e+05, 3.9908e+05,
        4.0509e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['1.05', '1.00', '1.10', '382383.38', '382268.28', '1.11', '0.97', '399073.78', '405081.81', '1.00', '1.18', '1.00', '387276.06', '384231.53', '1.04', '1.16', '387243.31', '0.97', '0.98']
estimated f for each client, fs: [7, 7, 7, 5, 5, 7, 7, 5, 5, 7, 7, 7, 5, 5, 7, 7, 5, 7, 7]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0228s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:24...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[167  70]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:24, End: 2025-07-22 15:29:24)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 9.4382e-01, 3.7227e+05, 3.8395e+05, 1.2218e+00, 3.9416e+05,
         3.8063e+05, 1.0033e+00, 3.9132e+05, 1.0190e+00, 9.9933e-01, 3.8974e+05,
         3.7570e+05, 1.1048e+00, 3.8680e+05, 1.0116e+00, 9.8357e-01],
        [9.4382e-01, 0.0000e+00, 3.7226e+05, 3.8397e+05, 9.5953e-01, 3.9414e+05,
         3.8066e+05, 8.7080e-01, 3.9132e+05, 8.4052e-01, 9.3959e-01, 3.8973e+05,
         3.7572e+05, 1.1516e+00, 3.8677e+05, 9.0769e-01, 9.2614e-01],
        [3.7227e+05, 3.7226e+05, 0.0000e+00, 7.5805e+05, 3.7224e+05, 7.8142e+05,
         7.5499e+05, 3.7223e+05, 7.8500e+05, 3.7226e+05, 3.7223e+05, 7.7299e+05,
         7.6761e+05, 3.7223e+05, 7.6348e+05, 3.7224e+05, 3.7225e+05],
        [3.8395e+05, 3.8397e+05, 7.5805e+05, 0.0000e+00, 3.8398e+05, 7.5943e+05,
         7.6753e+05, 3.8395e+05, 7.8929e+05, 3.8396e+05, 3.8396e+05, 7.8940e+05,
         7.4586e+05, 3.8397e+05, 7.9047e+05, 3.8397e+05, 3.8395e+05],
        [1.2218e+00, 9.5953e-01, 3.7224e+05, 3.8398e+05, 0.0000e+00, 3.9412e+05,
         3.8064e+05, 1.0422e+00, 3.9134e+05, 8.6047e-01, 1.1673e+00, 3.8971e+05,
         3.7571e+05, 1.4688e+00, 3.8678e+05, 9.3211e-01, 9.9045e-01],
        [3.9416e+05, 3.9414e+05, 7.8142e+05, 7.5943e+05, 3.9412e+05, 0.0000e+00,
         7.6942e+05, 3.9417e+05, 7.9594e+05, 3.9414e+05, 3.9413e+05, 7.9563e+05,
         7.7672e+05, 3.9411e+05, 7.9192e+05, 3.9413e+05, 3.9414e+05],
        [3.8063e+05, 3.8066e+05, 7.5499e+05, 7.6753e+05, 3.8064e+05, 7.6942e+05,
         0.0000e+00, 3.8066e+05, 7.9502e+05, 3.8065e+05, 3.8063e+05, 7.7148e+05,
         7.6814e+05, 3.8065e+05, 7.5593e+05, 3.8065e+05, 3.8063e+05],
        [1.0033e+00, 8.7080e-01, 3.7223e+05, 3.8395e+05, 1.0422e+00, 3.9417e+05,
         3.8066e+05, 0.0000e+00, 3.9133e+05, 9.0583e-01, 9.7633e-01, 3.8974e+05,
         3.7572e+05, 1.0349e+00, 3.8677e+05, 8.9471e-01, 8.8581e-01],
        [3.9132e+05, 3.9132e+05, 7.8500e+05, 7.8929e+05, 3.9134e+05, 7.9594e+05,
         7.9502e+05, 3.9133e+05, 0.0000e+00, 3.9133e+05, 3.9131e+05, 7.6484e+05,
         7.7653e+05, 3.9132e+05, 7.8428e+05, 3.9129e+05, 3.9133e+05],
        [1.0190e+00, 8.4052e-01, 3.7226e+05, 3.8396e+05, 8.6047e-01, 3.9414e+05,
         3.8065e+05, 9.0583e-01, 3.9133e+05, 0.0000e+00, 9.9795e-01, 3.8972e+05,
         3.7571e+05, 1.2547e+00, 3.8674e+05, 8.3724e-01, 8.6493e-01],
        [9.9933e-01, 9.3959e-01, 3.7223e+05, 3.8396e+05, 1.1673e+00, 3.9413e+05,
         3.8063e+05, 9.7633e-01, 3.9131e+05, 9.9795e-01, 0.0000e+00, 3.8972e+05,
         3.7570e+05, 1.0279e+00, 3.8675e+05, 9.9288e-01, 8.6674e-01],
        [3.8974e+05, 3.8973e+05, 7.7299e+05, 7.8940e+05, 3.8971e+05, 7.9563e+05,
         7.7148e+05, 3.8974e+05, 7.6484e+05, 3.8972e+05, 3.8972e+05, 0.0000e+00,
         7.5607e+05, 3.8973e+05, 7.4207e+05, 3.8973e+05, 3.8974e+05],
        [3.7570e+05, 3.7572e+05, 7.6761e+05, 7.4586e+05, 3.7571e+05, 7.7672e+05,
         7.6814e+05, 3.7572e+05, 7.7653e+05, 3.7571e+05, 3.7570e+05, 7.5607e+05,
         0.0000e+00, 3.7572e+05, 7.7973e+05, 3.7571e+05, 3.7570e+05],
        [1.1048e+00, 1.1516e+00, 3.7223e+05, 3.8397e+05, 1.4688e+00, 3.9411e+05,
         3.8065e+05, 1.0349e+00, 3.9132e+05, 1.2547e+00, 1.0279e+00, 3.8973e+05,
         3.7572e+05, 0.0000e+00, 3.8677e+05, 1.1104e+00, 1.1200e+00],
        [3.8680e+05, 3.8677e+05, 7.6348e+05, 7.9047e+05, 3.8678e+05, 7.9192e+05,
         7.5593e+05, 3.8677e+05, 7.8428e+05, 3.8674e+05, 3.8675e+05, 7.4207e+05,
         7.7973e+05, 3.8677e+05, 0.0000e+00, 3.8675e+05, 3.8673e+05],
        [1.0116e+00, 9.0769e-01, 3.7224e+05, 3.8397e+05, 9.3211e-01, 3.9413e+05,
         3.8065e+05, 8.9471e-01, 3.9129e+05, 8.3724e-01, 9.9288e-01, 3.8973e+05,
         3.7571e+05, 1.1104e+00, 3.8675e+05, 0.0000e+00, 8.6272e-01],
        [9.8357e-01, 9.2614e-01, 3.7225e+05, 3.8395e+05, 9.9045e-01, 3.9414e+05,
         3.8063e+05, 8.8581e-01, 3.9133e+05, 8.6493e-01, 8.6674e-01, 3.8974e+05,
         3.7570e+05, 1.1200e+00, 3.8673e+05, 8.6272e-01, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.4382e-01, 9.8357e-01, 9.9933e-01, 1.0033e+00, 1.0116e+00,
        1.0190e+00, 1.1048e+00, 1.2218e+00, 3.7227e+05, 3.7570e+05, 3.8063e+05,
        3.8395e+05, 3.8680e+05, 3.8974e+05, 3.9132e+05, 3.9416e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4052e-01, 8.7080e-01, 9.0769e-01, 9.2614e-01, 9.3959e-01,
        9.4382e-01, 9.5953e-01, 1.1516e+00, 3.7226e+05, 3.7572e+05, 3.8066e+05,
        3.8397e+05, 3.8677e+05, 3.8973e+05, 3.9132e+05, 3.9414e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 372231.7812, 372232.0625, 372233.6562, 372239.9375,
        372243.0938, 372246.9688, 372255.1875, 372263.9062, 372265.3438,
        754987.1250, 758049.8125, 763475.8125, 767613.3750, 772994.2500,
        781420.8125, 785004.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383949.3750, 383950.5000, 383954.3750, 383960.3438,
        383963.0000, 383965.4062, 383966.2500, 383973.1875, 383981.9375,
        745864.5625, 758049.8125, 759434.3750, 767528.9375, 789286.5625,
        789402.2500, 790469.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6047e-01, 9.3211e-01, 9.5953e-01, 9.9045e-01, 1.0422e+00,
        1.1673e+00, 1.2218e+00, 1.4688e+00, 3.7224e+05, 3.7571e+05, 3.8064e+05,
        3.8398e+05, 3.8678e+05, 3.8971e+05, 3.9134e+05, 3.9412e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394114.2500, 394121.6250, 394131.6875, 394134.5625,
        394139.2500, 394142.6250, 394144.4062, 394162.7188, 394166.2188,
        759434.3750, 769415.8750, 776718.1250, 781420.8125, 791923.4375,
        795625.3750, 795937.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380628.6250, 380631.1875, 380633.8438, 380637.6250,
        380652.9375, 380653.4062, 380653.8750, 380661.5000, 380662.0000,
        754987.1250, 755927.5000, 767528.9375, 768137.1875, 769415.8750,
        771479.2500, 795022.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7080e-01, 8.8581e-01, 8.9471e-01, 9.0583e-01, 9.7633e-01,
        1.0033e+00, 1.0349e+00, 1.0422e+00, 3.7223e+05, 3.7572e+05, 3.8066e+05,
        3.8395e+05, 3.8677e+05, 3.8974e+05, 3.9133e+05, 3.9417e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391287.9062, 391309.7500, 391320.0938, 391320.4062,
        391321.0625, 391325.7188, 391327.8125, 391332.5312, 391337.2500,
        764843.6250, 776525.4375, 784282.2500, 785004.6250, 789286.5625,
        795022.2500, 795937.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3724e-01, 8.4052e-01, 8.6047e-01, 8.6493e-01, 9.0583e-01,
        9.9795e-01, 1.0190e+00, 1.2547e+00, 3.7226e+05, 3.7571e+05, 3.8065e+05,
        3.8396e+05, 3.8674e+05, 3.8972e+05, 3.9133e+05, 3.9414e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6674e-01, 9.3959e-01, 9.7633e-01, 9.9288e-01, 9.9795e-01,
        9.9933e-01, 1.0279e+00, 1.1673e+00, 3.7223e+05, 3.7570e+05, 3.8063e+05,
        3.8396e+05, 3.8675e+05, 3.8972e+05, 3.9131e+05, 3.9413e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389711.4688, 389722.6250, 389725.0000, 389725.3750,
        389726.4688, 389730.4062, 389735.5000, 389742.1875, 389742.3750,
        742074.4375, 756066.2500, 764843.6250, 771479.2500, 772994.2500,
        789402.2500, 795625.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 375699.2500, 375700.7188, 375701.0938, 375706.5000,
        375710.2188, 375712.4688, 375717.7188, 375718.9688, 375719.3750,
        745864.5625, 756066.2500, 767613.3750, 768137.1875, 776525.4375,
        776718.1250, 779734.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0279e+00, 1.0349e+00, 1.1048e+00, 1.1104e+00, 1.1200e+00,
        1.1516e+00, 1.2547e+00, 1.4688e+00, 3.7223e+05, 3.7572e+05, 3.8065e+05,
        3.8397e+05, 3.8677e+05, 3.8973e+05, 3.9132e+05, 3.9411e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386727.6250, 386744.2500, 386749.3750, 386750.7188,
        386765.7500, 386770.6250, 386774.8750, 386776.0938, 386802.3750,
        742074.4375, 755927.5000, 763475.8125, 779734.1250, 784282.2500,
        790469.5625, 791923.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3724e-01, 8.6272e-01, 8.9471e-01, 9.0769e-01, 9.3211e-01,
        9.9288e-01, 1.0116e+00, 1.1104e+00, 3.7224e+05, 3.7571e+05, 3.8065e+05,
        3.8397e+05, 3.8675e+05, 3.8973e+05, 3.9129e+05, 3.9413e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6272e-01, 8.6493e-01, 8.6674e-01, 8.8581e-01, 9.2614e-01,
        9.8357e-01, 9.9045e-01, 1.1200e+00, 3.7225e+05, 3.7570e+05, 3.8063e+05,
        3.8395e+05, 3.8673e+05, 3.8974e+05, 3.9133e+05, 3.9414e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['74797.46', '74798.20', '410519.88', '420152.88', '74796.41', '430669.16', '418080.22', '74795.90', '428672.59', '74798.17', '74794.05', '424963.56', '412725.06', '74796.02', '422293.59', '74795.40', '74795.37']
estimated f for each client, fs: [8, 8, 7, 6, 8, 6, 6, 8, 6, 8, 8, 6, 6, 8, 6, 8, 8]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0116s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:24...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[164  73]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:24, End: 2025-07-22 15:29:24)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 9.2163e-01, 3.9591e+05, 3.8231e+05, 1.0443e+00, 1.0003e+00,
         3.7471e+05, 4.0567e+05, 1.0178e+00, 3.9821e+05, 1.0184e+00, 1.1873e+00,
         4.0510e+05, 4.0560e+05, 1.0659e+00, 1.0278e+00, 9.7706e-01],
        [9.2163e-01, 0.0000e+00, 3.9591e+05, 3.8226e+05, 1.0553e+00, 8.3912e-01,
         3.7473e+05, 4.0565e+05, 9.2795e-01, 3.9821e+05, 8.3637e-01, 1.0469e+00,
         4.0509e+05, 4.0560e+05, 1.0840e+00, 9.6653e-01, 9.2484e-01],
        [3.9591e+05, 3.9591e+05, 0.0000e+00, 7.6890e+05, 3.9591e+05, 3.9592e+05,
         7.7195e+05, 8.1625e+05, 3.9592e+05, 7.7588e+05, 3.9591e+05, 3.9589e+05,
         8.2899e+05, 8.1947e+05, 3.9595e+05, 3.9593e+05, 3.9590e+05],
        [3.8231e+05, 3.8226e+05, 7.6890e+05, 0.0000e+00, 3.8227e+05, 3.8229e+05,
         7.4563e+05, 7.9338e+05, 3.8227e+05, 7.9063e+05, 3.8228e+05, 3.8228e+05,
         7.7255e+05, 7.9304e+05, 3.8229e+05, 3.8231e+05, 3.8230e+05],
        [1.0443e+00, 1.0553e+00, 3.9591e+05, 3.8227e+05, 0.0000e+00, 1.0847e+00,
         3.7472e+05, 4.0565e+05, 1.0590e+00, 3.9820e+05, 1.1637e+00, 1.3490e+00,
         4.0510e+05, 4.0561e+05, 1.0307e+00, 1.0576e+00, 1.0242e+00],
        [1.0003e+00, 8.3912e-01, 3.9592e+05, 3.8229e+05, 1.0847e+00, 0.0000e+00,
         3.7473e+05, 4.0563e+05, 9.1072e-01, 3.9820e+05, 7.4143e-01, 8.8881e-01,
         4.0510e+05, 4.0559e+05, 1.2195e+00, 8.3915e-01, 8.6119e-01],
        [3.7471e+05, 3.7473e+05, 7.7195e+05, 7.4563e+05, 3.7472e+05, 3.7473e+05,
         0.0000e+00, 7.9209e+05, 3.7473e+05, 7.6568e+05, 3.7471e+05, 3.7471e+05,
         7.9133e+05, 7.9600e+05, 3.7474e+05, 3.7472e+05, 3.7471e+05],
        [4.0567e+05, 4.0565e+05, 8.1625e+05, 7.9338e+05, 4.0565e+05, 4.0563e+05,
         7.9209e+05, 0.0000e+00, 4.0563e+05, 8.0270e+05, 4.0565e+05, 4.0566e+05,
         7.8548e+05, 8.1403e+05, 4.0565e+05, 4.0561e+05, 4.0563e+05],
        [1.0178e+00, 9.2795e-01, 3.9592e+05, 3.8227e+05, 1.0590e+00, 9.1072e-01,
         3.7473e+05, 4.0563e+05, 0.0000e+00, 3.9823e+05, 9.3747e-01, 1.1367e+00,
         4.0507e+05, 4.0560e+05, 1.0093e+00, 9.3477e-01, 9.1202e-01],
        [3.9821e+05, 3.9821e+05, 7.7588e+05, 7.9063e+05, 3.9820e+05, 3.9820e+05,
         7.6568e+05, 8.0270e+05, 3.9823e+05, 0.0000e+00, 3.9822e+05, 3.9821e+05,
         8.1895e+05, 8.1271e+05, 3.9822e+05, 3.9822e+05, 3.9820e+05],
        [1.0184e+00, 8.3637e-01, 3.9591e+05, 3.8228e+05, 1.1637e+00, 7.4143e-01,
         3.7471e+05, 4.0565e+05, 9.3747e-01, 3.9822e+05, 0.0000e+00, 9.2571e-01,
         4.0508e+05, 4.0558e+05, 1.2251e+00, 8.8218e-01, 8.8085e-01],
        [1.1873e+00, 1.0469e+00, 3.9589e+05, 3.8228e+05, 1.3490e+00, 8.8881e-01,
         3.7471e+05, 4.0566e+05, 1.1367e+00, 3.9821e+05, 9.2571e-01, 0.0000e+00,
         4.0507e+05, 4.0561e+05, 1.3135e+00, 1.0997e+00, 9.8204e-01],
        [4.0510e+05, 4.0509e+05, 8.2899e+05, 7.7255e+05, 4.0510e+05, 4.0510e+05,
         7.9133e+05, 7.8548e+05, 4.0507e+05, 8.1895e+05, 4.0508e+05, 4.0507e+05,
         0.0000e+00, 8.1717e+05, 4.0509e+05, 4.0507e+05, 4.0508e+05],
        [4.0560e+05, 4.0560e+05, 8.1947e+05, 7.9304e+05, 4.0561e+05, 4.0559e+05,
         7.9600e+05, 8.1403e+05, 4.0560e+05, 8.1271e+05, 4.0558e+05, 4.0561e+05,
         8.1717e+05, 0.0000e+00, 4.0563e+05, 4.0562e+05, 4.0561e+05],
        [1.0659e+00, 1.0840e+00, 3.9595e+05, 3.8229e+05, 1.0307e+00, 1.2195e+00,
         3.7474e+05, 4.0565e+05, 1.0093e+00, 3.9822e+05, 1.2251e+00, 1.3135e+00,
         4.0509e+05, 4.0563e+05, 0.0000e+00, 1.0899e+00, 1.0835e+00],
        [1.0278e+00, 9.6653e-01, 3.9593e+05, 3.8231e+05, 1.0576e+00, 8.3915e-01,
         3.7472e+05, 4.0561e+05, 9.3477e-01, 3.9822e+05, 8.8218e-01, 1.0997e+00,
         4.0507e+05, 4.0562e+05, 1.0899e+00, 0.0000e+00, 8.9684e-01],
        [9.7706e-01, 9.2484e-01, 3.9590e+05, 3.8230e+05, 1.0242e+00, 8.6119e-01,
         3.7471e+05, 4.0563e+05, 9.1202e-01, 3.9820e+05, 8.8085e-01, 9.8204e-01,
         4.0508e+05, 4.0561e+05, 1.0835e+00, 8.9684e-01, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.2163e-01, 9.7706e-01, 1.0003e+00, 1.0178e+00, 1.0184e+00,
        1.0278e+00, 1.0443e+00, 1.0659e+00, 1.1873e+00, 3.7471e+05, 3.8231e+05,
        3.9591e+05, 3.9821e+05, 4.0510e+05, 4.0560e+05, 4.0567e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3637e-01, 8.3912e-01, 9.2163e-01, 9.2484e-01, 9.2795e-01,
        9.6653e-01, 1.0469e+00, 1.0553e+00, 1.0840e+00, 3.7473e+05, 3.8226e+05,
        3.9591e+05, 3.9821e+05, 4.0509e+05, 4.0560e+05, 4.0565e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395890.6250, 395899.5938, 395905.0938, 395906.6250,
        395908.6875, 395914.5000, 395915.0000, 395923.0625, 395927.9062,
        395954.2500, 768898.4375, 771948.2500, 775884.8750, 816253.1875,
        819472.0625, 828991.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382263.1562, 382267.2812, 382268.1875, 382279.6562,
        382284.8750, 382291.2500, 382293.3750, 382296.9688, 382306.0625,
        382308.3750, 745627.9375, 768898.4375, 772553.1875, 790627.6875,
        793041.0000, 793375.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0242e+00, 1.0307e+00, 1.0443e+00, 1.0553e+00, 1.0576e+00,
        1.0590e+00, 1.0847e+00, 1.1637e+00, 1.3490e+00, 3.7472e+05, 3.8227e+05,
        3.9591e+05, 3.9820e+05, 4.0510e+05, 4.0561e+05, 4.0565e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.4143e-01, 8.3912e-01, 8.3915e-01, 8.6119e-01, 8.8881e-01,
        9.1072e-01, 1.0003e+00, 1.0847e+00, 1.2195e+00, 3.7473e+05, 3.8229e+05,
        3.9592e+05, 3.9820e+05, 4.0510e+05, 4.0559e+05, 4.0563e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374707.1250, 374708.0000, 374712.0625, 374714.9688,
        374719.1875, 374724.6875, 374726.4688, 374730.4062, 374733.8438,
        374740.5938, 745627.9375, 765680.5000, 771948.2500, 791326.7500,
        792093.5625, 795998.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405608.1562, 405625.6562, 405627.9375, 405628.8438,
        405645.7500, 405648.2812, 405652.4375, 405654.9375, 405662.5000,
        405668.2500, 785478.4375, 792093.5625, 793375.0000, 802696.8750,
        814030.8125, 816253.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1072e-01, 9.1202e-01, 9.2795e-01, 9.3477e-01, 9.3747e-01,
        1.0093e+00, 1.0178e+00, 1.0590e+00, 1.1367e+00, 3.7473e+05, 3.8227e+05,
        3.9592e+05, 3.9823e+05, 4.0507e+05, 4.0560e+05, 4.0563e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398200.8125, 398202.7812, 398203.0625, 398210.5312,
        398211.7812, 398212.3438, 398215.4688, 398218.6250, 398220.7812,
        398228.4375, 765680.5000, 775884.8750, 790627.6875, 802696.8750,
        812710.1875, 818948.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.4143e-01, 8.3637e-01, 8.8085e-01, 8.8218e-01, 9.2571e-01,
        9.3747e-01, 1.0184e+00, 1.1637e+00, 1.2251e+00, 3.7471e+05, 3.8228e+05,
        3.9591e+05, 3.9822e+05, 4.0508e+05, 4.0558e+05, 4.0565e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8881e-01, 9.2571e-01, 9.8204e-01, 1.0469e+00, 1.0997e+00,
        1.1367e+00, 1.1873e+00, 1.3135e+00, 1.3490e+00, 3.7471e+05, 3.8228e+05,
        3.9589e+05, 3.9821e+05, 4.0507e+05, 4.0561e+05, 4.0566e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405069.4688, 405069.8125, 405072.7500, 405078.5938,
        405080.4375, 405085.0312, 405089.1562, 405095.8438, 405098.4375,
        405098.6875, 772553.1875, 785478.4375, 791326.7500, 817170.0000,
        818948.3750, 828991.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405582.9688, 405587.1562, 405595.8750, 405595.9375,
        405600.4062, 405605.5938, 405607.5312, 405611.7812, 405621.6562,
        405629.6875, 793041.0000, 795998.7500, 812710.1875, 814030.8125,
        817170.0000, 819472.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0093e+00, 1.0307e+00, 1.0659e+00, 1.0835e+00, 1.0840e+00,
        1.0899e+00, 1.2195e+00, 1.2251e+00, 1.3135e+00, 3.7474e+05, 3.8229e+05,
        3.9595e+05, 3.9822e+05, 4.0509e+05, 4.0563e+05, 4.0565e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3915e-01, 8.8218e-01, 8.9684e-01, 9.3477e-01, 9.6653e-01,
        1.0278e+00, 1.0576e+00, 1.0899e+00, 1.0997e+00, 3.7472e+05, 3.8231e+05,
        3.9593e+05, 3.9822e+05, 4.0507e+05, 4.0561e+05, 4.0562e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6119e-01, 8.8085e-01, 8.9684e-01, 9.1202e-01, 9.2484e-01,
        9.7706e-01, 9.8204e-01, 1.0242e+00, 1.0835e+00, 3.7471e+05, 3.8230e+05,
        3.9590e+05, 3.9820e+05, 4.0508e+05, 4.0561e+05, 4.0563e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37472.13', '37473.51', '395914.53', '382285.88', '37472.91', '37473.88', '374721.72', '405642.25', '37474.27', '398212.44', '37471.66', '37472.49', '405083.81', '405603.84', '37475.07', '37473.35', '37471.57']
estimated f for each client, fs: [7, 7, 5, 5, 7, 7, 5, 5, 7, 5, 7, 7, 5, 5, 7, 7, 7]
selected_index: 16
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0250s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:25...
global Accuracy on shared test data: 73.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:29:25, End: 2025-07-22 15:29:25)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 9, 20, 18, 8, 4, 14, 11, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 9.0224e-01, 1.0939e+00, 3.8669e+05, 1.0274e+00, 3.9922e+05,
         3.8930e+05, 9.8005e-01, 1.0511e+00, 3.9043e+05, 9.6870e-01, 1.0400e+00,
         3.8675e+05, 1.0293e+00, 1.2619e+00],
        [9.0224e-01, 0.0000e+00, 9.6278e-01, 3.8670e+05, 8.5150e-01, 3.9925e+05,
         3.8930e+05, 8.7633e-01, 8.4287e-01, 3.9038e+05, 8.7545e-01, 1.0667e+00,
         3.8673e+05, 9.3902e-01, 1.0718e+00],
        [1.0939e+00, 9.6278e-01, 0.0000e+00, 3.8671e+05, 1.0899e+00, 3.9924e+05,
         3.8928e+05, 1.0971e+00, 1.1082e+00, 3.9038e+05, 1.1438e+00, 1.0031e+00,
         3.8671e+05, 9.9597e-01, 1.3816e+00],
        [3.8669e+05, 3.8670e+05, 3.8671e+05, 0.0000e+00, 3.8670e+05, 7.6797e+05,
         8.0046e+05, 3.8669e+05, 3.8670e+05, 7.7196e+05, 3.8669e+05, 3.8671e+05,
         7.7822e+05, 3.8669e+05, 3.8670e+05],
        [1.0274e+00, 8.5150e-01, 1.0899e+00, 3.8670e+05, 0.0000e+00, 3.9925e+05,
         3.8930e+05, 9.1140e-01, 7.9350e-01, 3.9036e+05, 7.3219e-01, 1.2211e+00,
         3.8671e+05, 8.3554e-01, 8.6174e-01],
        [3.9922e+05, 3.9925e+05, 3.9924e+05, 7.6797e+05, 3.9925e+05, 0.0000e+00,
         7.9766e+05, 3.9927e+05, 3.9925e+05, 7.7605e+05, 3.9926e+05, 3.9925e+05,
         7.8930e+05, 3.9927e+05, 3.9927e+05],
        [3.8930e+05, 3.8930e+05, 3.8928e+05, 8.0046e+05, 3.8930e+05, 7.9766e+05,
         0.0000e+00, 3.8929e+05, 3.8925e+05, 7.7443e+05, 3.8928e+05, 3.8928e+05,
         8.0289e+05, 3.8928e+05, 3.8928e+05],
        [9.8005e-01, 8.7633e-01, 1.0971e+00, 3.8669e+05, 9.1140e-01, 3.9927e+05,
         3.8929e+05, 0.0000e+00, 9.0983e-01, 3.9043e+05, 9.4342e-01, 1.0476e+00,
         3.8673e+05, 8.9686e-01, 1.0799e+00],
        [1.0511e+00, 8.4287e-01, 1.1082e+00, 3.8670e+05, 7.9350e-01, 3.9925e+05,
         3.8925e+05, 9.0983e-01, 0.0000e+00, 3.9041e+05, 7.8352e-01, 1.2091e+00,
         3.8673e+05, 8.7820e-01, 9.5230e-01],
        [3.9043e+05, 3.9038e+05, 3.9038e+05, 7.7196e+05, 3.9036e+05, 7.7605e+05,
         7.7443e+05, 3.9043e+05, 3.9041e+05, 0.0000e+00, 3.9041e+05, 3.9041e+05,
         7.9248e+05, 3.9042e+05, 3.9041e+05],
        [9.6870e-01, 8.7545e-01, 1.1438e+00, 3.8669e+05, 7.3219e-01, 3.9926e+05,
         3.8928e+05, 9.4342e-01, 7.8352e-01, 3.9041e+05, 0.0000e+00, 1.2146e+00,
         3.8671e+05, 9.0965e-01, 8.8966e-01],
        [1.0400e+00, 1.0667e+00, 1.0031e+00, 3.8671e+05, 1.2211e+00, 3.9925e+05,
         3.8928e+05, 1.0476e+00, 1.2091e+00, 3.9041e+05, 1.2146e+00, 0.0000e+00,
         3.8673e+05, 1.1198e+00, 1.5123e+00],
        [3.8675e+05, 3.8673e+05, 3.8671e+05, 7.7822e+05, 3.8671e+05, 7.8930e+05,
         8.0289e+05, 3.8673e+05, 3.8673e+05, 7.9248e+05, 3.8671e+05, 3.8673e+05,
         0.0000e+00, 3.8675e+05, 3.8674e+05],
        [1.0293e+00, 9.3902e-01, 9.9597e-01, 3.8669e+05, 8.3554e-01, 3.9927e+05,
         3.8928e+05, 8.9686e-01, 8.7820e-01, 3.9042e+05, 9.0965e-01, 1.1198e+00,
         3.8675e+05, 0.0000e+00, 1.0750e+00],
        [1.2619e+00, 1.0718e+00, 1.3816e+00, 3.8670e+05, 8.6174e-01, 3.9927e+05,
         3.8928e+05, 1.0799e+00, 9.5230e-01, 3.9041e+05, 8.8966e-01, 1.5123e+00,
         3.8674e+05, 1.0750e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.0224e-01, 9.6870e-01, 9.8005e-01, 1.0274e+00, 1.0293e+00,
        1.0400e+00, 1.0511e+00, 1.0939e+00, 1.2619e+00, 3.8669e+05, 3.8675e+05,
        3.8930e+05, 3.9043e+05, 3.9922e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 8.4287e-01, 8.5150e-01, 8.7545e-01, 8.7633e-01, 9.0224e-01,
        9.3902e-01, 9.6278e-01, 1.0667e+00, 1.0718e+00, 3.8670e+05, 3.8673e+05,
        3.8930e+05, 3.9038e+05, 3.9925e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.6278e-01, 9.9597e-01, 1.0031e+00, 1.0899e+00, 1.0939e+00,
        1.0971e+00, 1.1082e+00, 1.1438e+00, 1.3816e+00, 3.8671e+05, 3.8671e+05,
        3.8928e+05, 3.9038e+05, 3.9924e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386687.3750, 386688.4688, 386692.9688, 386693.4062,
        386699.9688, 386701.5625, 386701.9062, 386703.1250, 386707.0000,
        386707.4375, 767972.1250, 771955.1875, 778219.3125, 800457.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.3219e-01, 7.9350e-01, 8.3554e-01, 8.5150e-01, 8.6174e-01,
        9.1140e-01, 1.0274e+00, 1.0899e+00, 1.2211e+00, 3.8670e+05, 3.8671e+05,
        3.8930e+05, 3.9036e+05, 3.9925e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 399217.3125, 399235.0625, 399248.2188, 399250.0312,
        399250.4688, 399254.8125, 399258.8750, 399266.1875, 399270.1250,
        399274.7188, 767972.1250, 776048.5000, 789298.3125, 797664.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389252.5312, 389277.1250, 389279.3750, 389281.5938,
        389283.7500, 389284.0938, 389293.4688, 389298.4375, 389298.7812,
        389304.3125, 774427.4375, 797664.1250, 800457.7500, 802893.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7633e-01, 8.9686e-01, 9.0983e-01, 9.1140e-01, 9.4342e-01,
        9.8005e-01, 1.0476e+00, 1.0799e+00, 1.0971e+00, 3.8669e+05, 3.8673e+05,
        3.8929e+05, 3.9043e+05, 3.9927e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 7.8352e-01, 7.9350e-01, 8.4287e-01, 8.7820e-01, 9.0983e-01,
        9.5230e-01, 1.0511e+00, 1.1082e+00, 1.2091e+00, 3.8670e+05, 3.8673e+05,
        3.8925e+05, 3.9041e+05, 3.9925e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390364.4062, 390379.9688, 390382.4375, 390405.0625,
        390406.5625, 390409.6562, 390410.0625, 390423.5625, 390428.0938,
        390431.1562, 771955.1875, 774427.4375, 776048.5000, 792482.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.3219e-01, 7.8352e-01, 8.7545e-01, 8.8966e-01, 9.0965e-01,
        9.4342e-01, 9.6870e-01, 1.1438e+00, 1.2146e+00, 3.8669e+05, 3.8671e+05,
        3.8928e+05, 3.9041e+05, 3.9926e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0031e+00, 1.0400e+00, 1.0476e+00, 1.0667e+00, 1.1198e+00,
        1.2091e+00, 1.2146e+00, 1.2211e+00, 1.5123e+00, 3.8671e+05, 3.8673e+05,
        3.8928e+05, 3.9041e+05, 3.9925e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386711.7188, 386713.5312, 386714.9062, 386726.7500,
        386730.4062, 386732.4375, 386734.8750, 386737.4375, 386745.5000,
        386752.8750, 778219.3125, 789298.3125, 792482.5000, 802893.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 8.3554e-01, 8.7820e-01, 8.9686e-01, 9.0965e-01, 9.3902e-01,
        9.9597e-01, 1.0293e+00, 1.0750e+00, 1.1198e+00, 3.8669e+05, 3.8675e+05,
        3.8928e+05, 3.9042e+05, 3.9927e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 8.6174e-01, 8.8966e-01, 9.5230e-01, 1.0718e+00, 1.0750e+00,
        1.0799e+00, 1.2619e+00, 1.3816e+00, 1.5123e+00, 3.8670e+05, 3.8674e+05,
        3.8928e+05, 3.9041e+05, 3.9927e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.04', '0.93', '1.10', '386698.31', '0.92', '399252.59', '389285.34', '0.97', '0.95', '390404.09', '0.94', '1.16', '386727.50', '0.96', '1.12']
estimated f for each client, fs: [5, 5, 5, 3, 5, 3, 3, 5, 5, 3, 5, 5, 5, 5, 5]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 9, 20, 18, 8, 4, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0106s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:26...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:26, End: 2025-07-22 15:29:26)
start time is: 97129900617815, end time is: 97147974628426
The total time is: 18074010611ns.

 ------- aggregate method: rkrum, random_seed: 200 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 5.1268e+00, 6.6411e+00, 3.8894e+05, 6.0219e+00, 6.3376e+00,
         3.8887e+05, 3.8434e+05, 5.6875e+00, 3.8647e+05, 5.4625e+00, 4.2939e+00,
         3.9817e+05, 5.3249e+00, 4.9283e+00, 3.8466e+05, 5.2473e+00, 5.2951e+00],
        [5.1268e+00, 0.0000e+00, 5.3506e+00, 3.8900e+05, 5.1887e+00, 5.4473e+00,
         3.8874e+05, 3.8439e+05, 5.2048e+00, 3.8639e+05, 5.0351e+00, 5.0676e+00,
         3.9810e+05, 4.5855e+00, 5.0913e+00, 3.8459e+05, 5.0065e+00, 5.2416e+00],
        [6.6411e+00, 5.3506e+00, 0.0000e+00, 3.8890e+05, 4.7181e+00, 5.2758e+00,
         3.8881e+05, 3.8436e+05, 5.6001e+00, 3.8639e+05, 5.3964e+00, 5.7193e+00,
         3.9814e+05, 5.2085e+00, 5.9319e+00, 3.8461e+05, 5.2938e+00, 6.1368e+00],
        [3.8894e+05, 3.8900e+05, 3.8890e+05, 0.0000e+00, 3.8893e+05, 3.8895e+05,
         7.8735e+05, 7.7921e+05, 3.8892e+05, 7.6857e+05, 3.8886e+05, 3.8893e+05,
         7.7923e+05, 3.8895e+05, 3.8893e+05, 7.5882e+05, 3.8898e+05, 3.8891e+05],
        [6.0219e+00, 5.1887e+00, 4.7181e+00, 3.8893e+05, 0.0000e+00, 5.1682e+00,
         3.8880e+05, 3.8438e+05, 4.7586e+00, 3.8644e+05, 5.5572e+00, 5.5260e+00,
         3.9811e+05, 4.6128e+00, 6.1028e+00, 3.8468e+05, 5.2033e+00, 5.5625e+00],
        [6.3376e+00, 5.4473e+00, 5.2758e+00, 3.8895e+05, 5.1682e+00, 0.0000e+00,
         3.8886e+05, 3.8436e+05, 5.6110e+00, 3.8643e+05, 5.6579e+00, 5.7440e+00,
         3.9809e+05, 4.8081e+00, 5.7297e+00, 3.8460e+05, 5.2781e+00, 6.0994e+00],
        [3.8887e+05, 3.8874e+05, 3.8881e+05, 7.8735e+05, 3.8880e+05, 3.8886e+05,
         0.0000e+00, 7.8709e+05, 3.8880e+05, 7.7863e+05, 3.8877e+05, 3.8885e+05,
         7.9040e+05, 3.8876e+05, 3.8874e+05, 7.9059e+05, 3.8883e+05, 3.8876e+05],
        [3.8434e+05, 3.8439e+05, 3.8436e+05, 7.7921e+05, 3.8438e+05, 3.8436e+05,
         7.8709e+05, 0.0000e+00, 3.8437e+05, 7.8592e+05, 3.8439e+05, 3.8440e+05,
         8.0098e+05, 3.8440e+05, 3.8434e+05, 7.5650e+05, 3.8438e+05, 3.8437e+05],
        [5.6875e+00, 5.2048e+00, 5.6001e+00, 3.8892e+05, 4.7586e+00, 5.6110e+00,
         3.8880e+05, 3.8437e+05, 0.0000e+00, 3.8636e+05, 5.2143e+00, 5.2521e+00,
         3.9813e+05, 4.9698e+00, 5.3423e+00, 3.8461e+05, 5.3002e+00, 5.2223e+00],
        [3.8647e+05, 3.8639e+05, 3.8639e+05, 7.6857e+05, 3.8644e+05, 3.8643e+05,
         7.7863e+05, 7.8592e+05, 3.8636e+05, 0.0000e+00, 3.8642e+05, 3.8639e+05,
         7.6630e+05, 3.8645e+05, 3.8644e+05, 7.6220e+05, 3.8643e+05, 3.8637e+05],
        [5.4625e+00, 5.0351e+00, 5.3964e+00, 3.8886e+05, 5.5572e+00, 5.6579e+00,
         3.8877e+05, 3.8439e+05, 5.2143e+00, 3.8642e+05, 0.0000e+00, 5.0483e+00,
         3.9815e+05, 5.0805e+00, 4.9786e+00, 3.8467e+05, 4.9791e+00, 4.8595e+00],
        [4.2939e+00, 5.0676e+00, 5.7193e+00, 3.8893e+05, 5.5260e+00, 5.7440e+00,
         3.8885e+05, 3.8440e+05, 5.2521e+00, 3.8639e+05, 5.0483e+00, 0.0000e+00,
         3.9812e+05, 4.9222e+00, 4.9966e+00, 3.8472e+05, 5.3438e+00, 5.0608e+00],
        [3.9817e+05, 3.9810e+05, 3.9814e+05, 7.7923e+05, 3.9811e+05, 3.9809e+05,
         7.9040e+05, 8.0098e+05, 3.9813e+05, 7.6630e+05, 3.9815e+05, 3.9812e+05,
         0.0000e+00, 3.9809e+05, 3.9817e+05, 7.9219e+05, 3.9815e+05, 3.9812e+05],
        [5.3249e+00, 4.5855e+00, 5.2085e+00, 3.8895e+05, 4.6128e+00, 4.8081e+00,
         3.8876e+05, 3.8440e+05, 4.9698e+00, 3.8645e+05, 5.0805e+00, 4.9222e+00,
         3.9809e+05, 0.0000e+00, 5.2865e+00, 3.8468e+05, 4.9885e+00, 5.3728e+00],
        [4.9283e+00, 5.0913e+00, 5.9319e+00, 3.8893e+05, 6.1028e+00, 5.7297e+00,
         3.8874e+05, 3.8434e+05, 5.3423e+00, 3.8644e+05, 4.9786e+00, 4.9966e+00,
         3.9817e+05, 5.2865e+00, 0.0000e+00, 3.8466e+05, 5.1273e+00, 4.9075e+00],
        [3.8466e+05, 3.8459e+05, 3.8461e+05, 7.5882e+05, 3.8468e+05, 3.8460e+05,
         7.9059e+05, 7.5650e+05, 3.8461e+05, 7.6220e+05, 3.8467e+05, 3.8472e+05,
         7.9219e+05, 3.8468e+05, 3.8466e+05, 0.0000e+00, 3.8461e+05, 3.8470e+05],
        [5.2473e+00, 5.0065e+00, 5.2938e+00, 3.8898e+05, 5.2033e+00, 5.2781e+00,
         3.8883e+05, 3.8438e+05, 5.3002e+00, 3.8643e+05, 4.9791e+00, 5.3438e+00,
         3.9815e+05, 4.9885e+00, 5.1273e+00, 3.8461e+05, 0.0000e+00, 5.1908e+00],
        [5.2951e+00, 5.2416e+00, 6.1368e+00, 3.8891e+05, 5.5625e+00, 6.0994e+00,
         3.8876e+05, 3.8437e+05, 5.2223e+00, 3.8637e+05, 4.8595e+00, 5.0608e+00,
         3.9812e+05, 5.3728e+00, 4.9075e+00, 3.8470e+05, 5.1908e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 4.2939e+00, 4.9283e+00, 5.1268e+00, 5.2473e+00, 5.2951e+00,
        5.3249e+00, 5.4625e+00, 5.6875e+00, 6.0219e+00, 6.3376e+00, 6.6411e+00,
        3.8434e+05, 3.8466e+05, 3.8647e+05, 3.8887e+05, 3.8894e+05, 3.9817e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 4.5855e+00, 5.0065e+00, 5.0351e+00, 5.0676e+00, 5.0913e+00,
        5.1268e+00, 5.1887e+00, 5.2048e+00, 5.2416e+00, 5.3506e+00, 5.4473e+00,
        3.8439e+05, 3.8459e+05, 3.8639e+05, 3.8874e+05, 3.8900e+05, 3.9810e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 4.7181e+00, 5.2085e+00, 5.2758e+00, 5.2938e+00, 5.3506e+00,
        5.3964e+00, 5.6001e+00, 5.7193e+00, 5.9319e+00, 6.1368e+00, 6.6411e+00,
        3.8436e+05, 3.8461e+05, 3.8639e+05, 3.8881e+05, 3.8890e+05, 3.9814e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388864.4375, 388902.2500, 388905.8750, 388918.9062,
        388930.8125, 388932.4062, 388934.9375, 388937.6875, 388947.4688,
        388954.0000, 388977.9062, 388999.4688, 758819.2500, 768569.1250,
        779205.3750, 779228.2500, 787351.8125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 4.6128e+00, 4.7181e+00, 4.7586e+00, 5.1682e+00, 5.1887e+00,
        5.2033e+00, 5.5260e+00, 5.5572e+00, 5.5625e+00, 6.0219e+00, 6.1028e+00,
        3.8438e+05, 3.8468e+05, 3.8644e+05, 3.8880e+05, 3.8893e+05, 3.9811e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 4.8081e+00, 5.1682e+00, 5.2758e+00, 5.2781e+00, 5.4473e+00,
        5.6110e+00, 5.6579e+00, 5.7297e+00, 5.7440e+00, 6.0994e+00, 6.3376e+00,
        3.8436e+05, 3.8460e+05, 3.8643e+05, 3.8886e+05, 3.8895e+05, 3.9809e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388736.2188, 388741.8438, 388762.8438, 388763.4062,
        388768.8125, 388796.6562, 388797.6875, 388809.8750, 388831.7500,
        388846.3125, 388855.9688, 388866.5625, 778634.2500, 787087.9375,
        787351.8125, 790403.1250, 790590.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384337.8438, 384339.8125, 384356.0312, 384364.6562,
        384365.5938, 384369.2500, 384377.8750, 384379.1875, 384389.6875,
        384391.9688, 384395.9062, 384398.2188, 756497.5000, 779205.3750,
        785921.7500, 787087.9375, 800980.8125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 4.7586e+00, 4.9698e+00, 5.2048e+00, 5.2143e+00, 5.2223e+00,
        5.2521e+00, 5.3002e+00, 5.3423e+00, 5.6001e+00, 5.6110e+00, 5.6875e+00,
        3.8437e+05, 3.8461e+05, 3.8636e+05, 3.8880e+05, 3.8892e+05, 3.9813e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386364.3750, 386367.0000, 386394.4062, 386394.6250,
        386394.6562, 386417.3750, 386429.8750, 386433.2812, 386438.8750,
        386444.4062, 386449.6250, 386467.0312, 762196.5000, 766302.8125,
        768569.1250, 778634.2500, 785921.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 4.8595e+00, 4.9786e+00, 4.9791e+00, 5.0351e+00, 5.0483e+00,
        5.0805e+00, 5.2143e+00, 5.3964e+00, 5.4625e+00, 5.5572e+00, 5.6579e+00,
        3.8439e+05, 3.8467e+05, 3.8642e+05, 3.8877e+05, 3.8886e+05, 3.9815e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 4.2939e+00, 4.9222e+00, 4.9966e+00, 5.0483e+00, 5.0608e+00,
        5.0676e+00, 5.2521e+00, 5.3438e+00, 5.5260e+00, 5.7193e+00, 5.7440e+00,
        3.8440e+05, 3.8472e+05, 3.8639e+05, 3.8885e+05, 3.8893e+05, 3.9812e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398089.3750, 398091.7500, 398099.8125, 398114.5625,
        398118.6875, 398121.3438, 398132.5000, 398142.6875, 398145.8125,
        398153.6250, 398166.2500, 398169.9688, 766302.8125, 779228.2500,
        790403.1250, 792189.6875, 800980.8125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 4.5855e+00, 4.6128e+00, 4.8081e+00, 4.9222e+00, 4.9698e+00,
        4.9885e+00, 5.0805e+00, 5.2085e+00, 5.2865e+00, 5.3249e+00, 5.3728e+00,
        3.8440e+05, 3.8468e+05, 3.8645e+05, 3.8876e+05, 3.8895e+05, 3.9809e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 4.9075e+00, 4.9283e+00, 4.9786e+00, 4.9966e+00, 5.0913e+00,
        5.1273e+00, 5.2865e+00, 5.3423e+00, 5.7297e+00, 5.9319e+00, 6.1028e+00,
        3.8434e+05, 3.8466e+05, 3.8644e+05, 3.8874e+05, 3.8893e+05, 3.9817e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384586.4062, 384603.6250, 384608.2812, 384608.3438,
        384613.1875, 384660.4375, 384663.6250, 384666.3750, 384682.5938,
        384683.9375, 384697.0000, 384715.1875, 756497.5000, 758819.2500,
        762196.5000, 790590.3750, 792189.6875])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 4.9791e+00, 4.9885e+00, 5.0065e+00, 5.1273e+00, 5.1908e+00,
        5.2033e+00, 5.2473e+00, 5.2781e+00, 5.2938e+00, 5.3002e+00, 5.3438e+00,
        3.8438e+05, 3.8461e+05, 3.8643e+05, 3.8883e+05, 3.8898e+05, 3.9815e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 4.8595e+00, 4.9075e+00, 5.0608e+00, 5.1908e+00, 5.2223e+00,
        5.2416e+00, 5.2951e+00, 5.3728e+00, 5.5625e+00, 6.0994e+00, 6.1368e+00,
        3.8437e+05, 3.8470e+05, 3.8637e+05, 3.8876e+05, 3.8891e+05, 3.9812e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['5.49', '5.12', '5.57', '388933.84', '5.31', '5.56', '388791.91', '384372.12', '5.29', '386416.28', '5.21', '5.18', '398128.81', '5.01', '5.31', '384649.06', '5.18', '5.36']
estimated f for each client, fs: [6, 6, 6, 4, 6, 6, 6, 4, 6, 4, 6, 6, 4, 6, 6, 4, 6, 6]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0171s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:26...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[163  74]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:26, End: 2025-07-22 15:29:26)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.8801e+00, 1.9792e+00, 3.8298e+05, 3.8617e+05, 2.1239e+00,
         3.8529e+05, 2.2260e+00, 3.9586e+05, 1.9308e+00, 1.9139e+00, 3.8944e+05,
         3.9274e+05, 2.0044e+00, 2.0259e+00, 3.9491e+05, 2.0995e+00, 1.9700e+00],
        [1.8801e+00, 0.0000e+00, 1.9308e+00, 3.8296e+05, 3.8618e+05, 2.0744e+00,
         3.8528e+05, 2.1491e+00, 3.9587e+05, 1.8227e+00, 1.9775e+00, 3.8945e+05,
         3.9281e+05, 2.0385e+00, 1.9824e+00, 3.9488e+05, 2.3403e+00, 2.0044e+00],
        [1.9792e+00, 1.9308e+00, 0.0000e+00, 3.8297e+05, 3.8618e+05, 2.0102e+00,
         3.8528e+05, 2.1637e+00, 3.9592e+05, 1.9319e+00, 2.0011e+00, 3.8943e+05,
         3.9278e+05, 2.1694e+00, 1.9358e+00, 3.9489e+05, 1.9465e+00, 1.9529e+00],
        [3.8298e+05, 3.8296e+05, 3.8297e+05, 0.0000e+00, 7.8197e+05, 3.8296e+05,
         7.5311e+05, 3.8297e+05, 7.9279e+05, 3.8297e+05, 3.8296e+05, 7.4701e+05,
         7.7203e+05, 3.8298e+05, 3.8298e+05, 7.7254e+05, 3.8296e+05, 3.8297e+05],
        [3.8617e+05, 3.8618e+05, 3.8618e+05, 7.8197e+05, 0.0000e+00, 3.8618e+05,
         7.6415e+05, 3.8612e+05, 7.5288e+05, 3.8612e+05, 3.8615e+05, 7.5374e+05,
         7.7713e+05, 3.8616e+05, 3.8613e+05, 8.0231e+05, 3.8616e+05, 3.8614e+05],
        [2.1239e+00, 2.0744e+00, 2.0102e+00, 3.8296e+05, 3.8618e+05, 0.0000e+00,
         3.8528e+05, 2.2743e+00, 3.9586e+05, 2.0093e+00, 2.2552e+00, 3.8942e+05,
         3.9280e+05, 2.0866e+00, 2.0006e+00, 3.9491e+05, 2.1906e+00, 2.0407e+00],
        [3.8529e+05, 3.8528e+05, 3.8528e+05, 7.5311e+05, 7.6415e+05, 3.8528e+05,
         0.0000e+00, 3.8530e+05, 7.8120e+05, 3.8528e+05, 3.8527e+05, 7.9710e+05,
         7.8165e+05, 3.8526e+05, 3.8526e+05, 7.5226e+05, 3.8527e+05, 3.8528e+05],
        [2.2260e+00, 2.1491e+00, 2.1637e+00, 3.8297e+05, 3.8612e+05, 2.2743e+00,
         3.8530e+05, 0.0000e+00, 3.9585e+05, 1.8640e+00, 2.0066e+00, 3.8946e+05,
         3.9282e+05, 2.2352e+00, 2.0081e+00, 3.9490e+05, 2.1422e+00, 2.0795e+00],
        [3.9586e+05, 3.9587e+05, 3.9592e+05, 7.9279e+05, 7.5288e+05, 3.9586e+05,
         7.8120e+05, 3.9585e+05, 0.0000e+00, 3.9587e+05, 3.9584e+05, 7.6780e+05,
         8.0060e+05, 3.9587e+05, 3.9588e+05, 8.1472e+05, 3.9586e+05, 3.9589e+05],
        [1.9308e+00, 1.8227e+00, 1.9319e+00, 3.8297e+05, 3.8612e+05, 2.0093e+00,
         3.8528e+05, 1.8640e+00, 3.9587e+05, 0.0000e+00, 1.8371e+00, 3.8945e+05,
         3.9280e+05, 1.9250e+00, 1.9028e+00, 3.9489e+05, 1.8551e+00, 1.7678e+00],
        [1.9139e+00, 1.9775e+00, 2.0011e+00, 3.8296e+05, 3.8615e+05, 2.2552e+00,
         3.8527e+05, 2.0066e+00, 3.9584e+05, 1.8371e+00, 0.0000e+00, 3.8939e+05,
         3.9283e+05, 2.0942e+00, 1.9921e+00, 3.9488e+05, 2.2414e+00, 1.8265e+00],
        [3.8944e+05, 3.8945e+05, 3.8943e+05, 7.4701e+05, 7.5374e+05, 3.8942e+05,
         7.9710e+05, 3.8946e+05, 7.6780e+05, 3.8945e+05, 3.8939e+05, 0.0000e+00,
         7.7738e+05, 3.8947e+05, 3.8946e+05, 8.0529e+05, 3.8947e+05, 3.8945e+05],
        [3.9274e+05, 3.9281e+05, 3.9278e+05, 7.7203e+05, 7.7713e+05, 3.9280e+05,
         7.8165e+05, 3.9282e+05, 8.0060e+05, 3.9280e+05, 3.9283e+05, 7.7738e+05,
         0.0000e+00, 3.9282e+05, 3.9284e+05, 7.6993e+05, 3.9282e+05, 3.9280e+05],
        [2.0044e+00, 2.0385e+00, 2.1694e+00, 3.8298e+05, 3.8616e+05, 2.0866e+00,
         3.8526e+05, 2.2352e+00, 3.9587e+05, 1.9250e+00, 2.0942e+00, 3.8947e+05,
         3.9282e+05, 0.0000e+00, 2.0407e+00, 3.9489e+05, 2.1180e+00, 2.0684e+00],
        [2.0259e+00, 1.9824e+00, 1.9358e+00, 3.8298e+05, 3.8613e+05, 2.0006e+00,
         3.8526e+05, 2.0081e+00, 3.9588e+05, 1.9028e+00, 1.9921e+00, 3.8946e+05,
         3.9284e+05, 2.0407e+00, 0.0000e+00, 3.9490e+05, 2.0997e+00, 1.8949e+00],
        [3.9491e+05, 3.9488e+05, 3.9489e+05, 7.7254e+05, 8.0231e+05, 3.9491e+05,
         7.5226e+05, 3.9490e+05, 8.1472e+05, 3.9489e+05, 3.9488e+05, 8.0529e+05,
         7.6993e+05, 3.9489e+05, 3.9490e+05, 0.0000e+00, 3.9493e+05, 3.9489e+05],
        [2.0995e+00, 2.3403e+00, 1.9465e+00, 3.8296e+05, 3.8616e+05, 2.1906e+00,
         3.8527e+05, 2.1422e+00, 3.9586e+05, 1.8551e+00, 2.2414e+00, 3.8947e+05,
         3.9282e+05, 2.1180e+00, 2.0997e+00, 3.9493e+05, 0.0000e+00, 2.0820e+00],
        [1.9700e+00, 2.0044e+00, 1.9529e+00, 3.8297e+05, 3.8614e+05, 2.0407e+00,
         3.8528e+05, 2.0795e+00, 3.9589e+05, 1.7678e+00, 1.8265e+00, 3.8945e+05,
         3.9280e+05, 2.0684e+00, 1.8949e+00, 3.9489e+05, 2.0820e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.8801e+00, 1.9139e+00, 1.9308e+00, 1.9700e+00, 1.9792e+00,
        2.0044e+00, 2.0259e+00, 2.0995e+00, 2.1239e+00, 2.2260e+00, 3.8298e+05,
        3.8529e+05, 3.8617e+05, 3.8944e+05, 3.9274e+05, 3.9491e+05, 3.9586e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.8227e+00, 1.8801e+00, 1.9308e+00, 1.9775e+00, 1.9824e+00,
        2.0044e+00, 2.0385e+00, 2.0744e+00, 2.1491e+00, 2.3403e+00, 3.8296e+05,
        3.8528e+05, 3.8618e+05, 3.8945e+05, 3.9281e+05, 3.9488e+05, 3.9587e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.9308e+00, 1.9319e+00, 1.9358e+00, 1.9465e+00, 1.9529e+00,
        1.9792e+00, 2.0011e+00, 2.0102e+00, 2.1637e+00, 2.1694e+00, 3.8297e+05,
        3.8528e+05, 3.8618e+05, 3.8943e+05, 3.9278e+05, 3.9489e+05, 3.9592e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382956.1875, 382956.3438, 382959.8750, 382963.0000,
        382966.6250, 382968.0000, 382968.0000, 382973.7500, 382976.1250,
        382978.5312, 382982.0625, 747009.9375, 753114.8125, 772032.9375,
        772540.7500, 781966.6250, 792787.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386117.3750, 386118.1562, 386126.0312, 386138.0938,
        386152.6250, 386155.1250, 386157.5938, 386173.0625, 386175.9375,
        386178.4062, 386184.0625, 752877.2500, 753743.6250, 764149.0625,
        777131.7500, 781966.6250, 802306.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 2.0006e+00, 2.0093e+00, 2.0102e+00, 2.0407e+00, 2.0744e+00,
        2.0866e+00, 2.1239e+00, 2.1906e+00, 2.2552e+00, 2.2743e+00, 3.8296e+05,
        3.8528e+05, 3.8618e+05, 3.8942e+05, 3.9280e+05, 3.9491e+05, 3.9586e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385261.2812, 385262.5625, 385268.7500, 385269.2812,
        385279.0938, 385280.5625, 385281.0312, 385281.4688, 385284.8125,
        385286.6875, 385304.0625, 752263.8750, 753114.8125, 764149.0625,
        781204.6875, 781651.3750, 797101.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.8640e+00, 2.0066e+00, 2.0081e+00, 2.0795e+00, 2.1422e+00,
        2.1491e+00, 2.1637e+00, 2.2260e+00, 2.2352e+00, 2.2743e+00, 3.8297e+05,
        3.8530e+05, 3.8612e+05, 3.8946e+05, 3.9282e+05, 3.9490e+05, 3.9585e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395836.6250, 395851.8438, 395858.1875, 395860.0625,
        395863.8125, 395866.6250, 395872.0625, 395872.1250, 395879.3125,
        395886.5312, 395915.3438, 752877.2500, 767796.4375, 781204.6875,
        792787.4375, 800597.2500, 814718.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7678e+00, 1.8227e+00, 1.8371e+00, 1.8551e+00, 1.8640e+00,
        1.9028e+00, 1.9250e+00, 1.9308e+00, 1.9319e+00, 2.0093e+00, 3.8297e+05,
        3.8528e+05, 3.8612e+05, 3.8945e+05, 3.9280e+05, 3.9489e+05, 3.9587e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.8265e+00, 1.8371e+00, 1.9139e+00, 1.9775e+00, 1.9921e+00,
        2.0011e+00, 2.0066e+00, 2.0942e+00, 2.2414e+00, 2.2552e+00, 3.8296e+05,
        3.8527e+05, 3.8615e+05, 3.8939e+05, 3.9283e+05, 3.9488e+05, 3.9584e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 389387.3125, 389421.8125, 389426.5000, 389436.7188,
        389445.8125, 389448.6875, 389449.9375, 389455.0000, 389459.1562,
        389467.2812, 389471.1562, 747009.9375, 753743.6250, 767796.4375,
        777377.6875, 797101.3125, 805285.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392743.6250, 392776.5625, 392802.2812, 392803.2500,
        392803.8438, 392810.3125, 392818.3438, 392818.6562, 392818.8438,
        392829.0625, 392837.3750, 769926.0625, 772032.9375, 777131.7500,
        777377.6875, 781651.3750, 800597.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.9250e+00, 2.0044e+00, 2.0385e+00, 2.0407e+00, 2.0684e+00,
        2.0866e+00, 2.0942e+00, 2.1180e+00, 2.1694e+00, 2.2352e+00, 3.8298e+05,
        3.8526e+05, 3.8616e+05, 3.8947e+05, 3.9282e+05, 3.9489e+05, 3.9587e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.8949e+00, 1.9028e+00, 1.9358e+00, 1.9824e+00, 1.9921e+00,
        2.0006e+00, 2.0081e+00, 2.0259e+00, 2.0407e+00, 2.0997e+00, 3.8298e+05,
        3.8526e+05, 3.8613e+05, 3.8946e+05, 3.9284e+05, 3.9490e+05, 3.9588e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 394877.9688, 394880.1875, 394888.0000, 394888.8438,
        394890.1562, 394893.5625, 394903.1875, 394904.4375, 394913.2500,
        394914.8750, 394929.7188, 752263.8750, 769926.0625, 772540.7500,
        802306.0625, 805285.5625, 814718.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.8551e+00, 1.9465e+00, 2.0820e+00, 2.0995e+00, 2.0997e+00,
        2.1180e+00, 2.1422e+00, 2.1906e+00, 2.2414e+00, 2.3403e+00, 3.8296e+05,
        3.8527e+05, 3.8616e+05, 3.8947e+05, 3.9282e+05, 3.9493e+05, 3.9586e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7678e+00, 1.8265e+00, 1.8949e+00, 1.9529e+00, 1.9700e+00,
        2.0044e+00, 2.0407e+00, 2.0684e+00, 2.0795e+00, 2.0820e+00, 3.8297e+05,
        3.8528e+05, 3.8614e+05, 3.8945e+05, 3.9280e+05, 3.9489e+05, 3.9589e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34817.84', '34816.37', '34816.96', '382968.03', '386152.38', '34816.73', '385278.09', '34817.19', '395869.31', '34817.51', '34816.04', '389442.66', '392805.66', '34818.44', '34818.04', '394898.53', '34816.11', '34817.06']
estimated f for each client, fs: [7, 7, 7, 5, 5, 7, 5, 7, 5, 7, 7, 5, 5, 7, 7, 5, 7, 7]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0145s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:27...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:27, End: 2025-07-22 15:29:27)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 17, 9, 20, 8, 15, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.7353e+00, 3.9879e+05, 1.6720e+00, 3.8693e+05, 1.9827e+00,
         3.9775e+05, 3.9304e+05, 3.8091e+05, 1.6294e+00, 1.7204e+00, 3.8572e+05,
         1.7599e+00, 1.7286e+00],
        [1.7353e+00, 0.0000e+00, 3.9881e+05, 1.4636e+00, 3.8692e+05, 1.7904e+00,
         3.9769e+05, 3.9301e+05, 3.8090e+05, 1.7694e+00, 1.5196e+00, 3.8572e+05,
         1.5608e+00, 1.6417e+00],
        [3.9879e+05, 3.9881e+05, 0.0000e+00, 3.9879e+05, 7.6976e+05, 3.9876e+05,
         8.1543e+05, 7.7651e+05, 7.9178e+05, 3.9880e+05, 3.9878e+05, 7.9327e+05,
         3.9878e+05, 3.9882e+05],
        [1.6720e+00, 1.4636e+00, 3.9879e+05, 0.0000e+00, 3.8691e+05, 1.6324e+00,
         3.9770e+05, 3.9302e+05, 3.8093e+05, 1.5461e+00, 1.5080e+00, 3.8574e+05,
         1.5232e+00, 1.6528e+00],
        [3.8693e+05, 3.8692e+05, 7.6976e+05, 3.8691e+05, 0.0000e+00, 3.8689e+05,
         7.9005e+05, 7.8689e+05, 7.7643e+05, 3.8693e+05, 3.8692e+05, 7.7742e+05,
         3.8692e+05, 3.8693e+05],
        [1.9827e+00, 1.7904e+00, 3.9876e+05, 1.6324e+00, 3.8689e+05, 0.0000e+00,
         3.9769e+05, 3.9305e+05, 3.8091e+05, 1.8191e+00, 1.6298e+00, 3.8573e+05,
         1.7285e+00, 1.7745e+00],
        [3.9775e+05, 3.9769e+05, 8.1543e+05, 3.9770e+05, 7.9005e+05, 3.9769e+05,
         0.0000e+00, 7.8489e+05, 7.6276e+05, 3.9771e+05, 3.9772e+05, 7.7822e+05,
         3.9774e+05, 3.9769e+05],
        [3.9304e+05, 3.9301e+05, 7.7651e+05, 3.9302e+05, 7.8689e+05, 3.9305e+05,
         7.8489e+05, 0.0000e+00, 7.6041e+05, 3.9304e+05, 3.9302e+05, 7.9811e+05,
         3.9301e+05, 3.9306e+05],
        [3.8091e+05, 3.8090e+05, 7.9178e+05, 3.8093e+05, 7.7643e+05, 3.8091e+05,
         7.6276e+05, 7.6041e+05, 0.0000e+00, 3.8093e+05, 3.8096e+05, 7.9095e+05,
         3.8091e+05, 3.8093e+05],
        [1.6294e+00, 1.7694e+00, 3.9880e+05, 1.5461e+00, 3.8693e+05, 1.8191e+00,
         3.9771e+05, 3.9304e+05, 3.8093e+05, 0.0000e+00, 1.7238e+00, 3.8574e+05,
         1.7394e+00, 1.7501e+00],
        [1.7204e+00, 1.5196e+00, 3.9878e+05, 1.5080e+00, 3.8692e+05, 1.6298e+00,
         3.9772e+05, 3.9302e+05, 3.8096e+05, 1.7238e+00, 0.0000e+00, 3.8573e+05,
         1.7208e+00, 1.6486e+00],
        [3.8572e+05, 3.8572e+05, 7.9327e+05, 3.8574e+05, 7.7742e+05, 3.8573e+05,
         7.7822e+05, 7.9811e+05, 7.9095e+05, 3.8574e+05, 3.8573e+05, 0.0000e+00,
         3.8573e+05, 3.8571e+05],
        [1.7599e+00, 1.5608e+00, 3.9878e+05, 1.5232e+00, 3.8692e+05, 1.7285e+00,
         3.9774e+05, 3.9301e+05, 3.8091e+05, 1.7394e+00, 1.7208e+00, 3.8573e+05,
         0.0000e+00, 1.6915e+00],
        [1.7286e+00, 1.6417e+00, 3.9882e+05, 1.6528e+00, 3.8693e+05, 1.7745e+00,
         3.9769e+05, 3.9306e+05, 3.8093e+05, 1.7501e+00, 1.6486e+00, 3.8571e+05,
         1.6915e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6294e+00, 1.6720e+00, 1.7204e+00, 1.7286e+00, 1.7353e+00,
        1.7599e+00, 1.9827e+00, 3.8091e+05, 3.8572e+05, 3.8693e+05, 3.9304e+05,
        3.9775e+05, 3.9879e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4636e+00, 1.5196e+00, 1.5608e+00, 1.6417e+00, 1.7353e+00,
        1.7694e+00, 1.7904e+00, 3.8090e+05, 3.8572e+05, 3.8692e+05, 3.9301e+05,
        3.9769e+05, 3.9881e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 398760.1250, 398778.3438, 398780.3125, 398785.5938,
        398788.1875, 398796.5625, 398807.0938, 398823.6250, 769762.6250,
        776509.2500, 791784.3125, 793266.2500, 815425.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4636e+00, 1.5080e+00, 1.5232e+00, 1.5461e+00, 1.6324e+00,
        1.6528e+00, 1.6720e+00, 3.8093e+05, 3.8574e+05, 3.8691e+05, 3.9302e+05,
        3.9770e+05, 3.9879e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386894.0938, 386906.6250, 386916.1250, 386919.0625,
        386920.9688, 386930.2812, 386932.0625, 386932.3750, 769762.6250,
        776431.8125, 777416.7500, 786893.6250, 790054.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6298e+00, 1.6324e+00, 1.7285e+00, 1.7745e+00, 1.7904e+00,
        1.8191e+00, 1.9827e+00, 3.8091e+05, 3.8573e+05, 3.8689e+05, 3.9305e+05,
        3.9769e+05, 3.9876e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397688.3438, 397689.0000, 397694.6875, 397705.0000,
        397705.2188, 397720.5625, 397736.0938, 397753.2500, 762756.6875,
        778216.2500, 784887.5625, 790054.5000, 815425.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393007.1250, 393013.1562, 393015.5625, 393021.1250,
        393042.3125, 393043.8438, 393045.1875, 393060.1562, 760407.0625,
        776509.2500, 784887.5625, 786893.6250, 798106.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 380904.2500, 380905.9688, 380906.4062, 380913.1250,
        380925.3750, 380925.9688, 380930.9375, 380957.9688, 760407.0625,
        762756.6875, 776431.8125, 790945.1875, 791784.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5461e+00, 1.6294e+00, 1.7238e+00, 1.7394e+00, 1.7501e+00,
        1.7694e+00, 1.8191e+00, 3.8093e+05, 3.8574e+05, 3.8693e+05, 3.9304e+05,
        3.9771e+05, 3.9880e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5080e+00, 1.5196e+00, 1.6298e+00, 1.6486e+00, 1.7204e+00,
        1.7208e+00, 1.7238e+00, 3.8096e+05, 3.8573e+05, 3.8692e+05, 3.9302e+05,
        3.9772e+05, 3.9878e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 385709.5000, 385720.2188, 385721.1562, 385725.4062,
        385731.4688, 385731.4688, 385736.5938, 385742.4688, 777416.7500,
        778216.2500, 790945.1875, 793266.2500, 798106.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5232e+00, 1.5608e+00, 1.6915e+00, 1.7208e+00, 1.7285e+00,
        1.7394e+00, 1.7599e+00, 3.8091e+05, 3.8573e+05, 3.8692e+05, 3.9301e+05,
        3.9774e+05, 3.9878e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6417e+00, 1.6486e+00, 1.6528e+00, 1.6915e+00, 1.7286e+00,
        1.7501e+00, 1.7745e+00, 3.8093e+05, 3.8571e+05, 3.8693e+05, 3.9306e+05,
        3.9769e+05, 3.9882e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['85182.95', '85181.77', '440009.12', '85185.88', '429457.12', '85183.31', '438272.06', '433850.59', '423086.34', '85186.71', '85188.31', '429248.31', '85183.28', '85183.59']
estimated f for each client, fs: [6, 6, 4, 6, 4, 6, 4, 4, 4, 6, 6, 5, 6, 6]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 17, 9, 20, 8, 15, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0097s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:28...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:28, End: 2025-07-22 15:29:28)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 3, 13, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.6985e+00, 1.9341e+00, 3.9868e+05, 1.8706e+00, 1.8710e+00,
         3.8031e+05, 3.8804e+05, 2.0308e+00, 3.9871e+05, 1.8183e+00, 3.9498e+05,
         1.7753e+00, 1.8400e+00, 3.9451e+05, 2.0043e+00, 1.8265e+00],
        [1.6985e+00, 0.0000e+00, 1.7565e+00, 3.9868e+05, 1.7787e+00, 1.7175e+00,
         3.8027e+05, 3.8806e+05, 1.9080e+00, 3.9872e+05, 1.9551e+00, 3.9499e+05,
         1.8478e+00, 1.6993e+00, 3.9451e+05, 2.0104e+00, 1.7700e+00],
        [1.9341e+00, 1.7565e+00, 0.0000e+00, 3.9870e+05, 1.8397e+00, 1.7124e+00,
         3.8033e+05, 3.8806e+05, 1.9483e+00, 3.9872e+05, 1.7959e+00, 3.9500e+05,
         1.8357e+00, 1.8072e+00, 3.9448e+05, 1.8615e+00, 1.8669e+00],
        [3.9868e+05, 3.9868e+05, 3.9870e+05, 0.0000e+00, 3.9871e+05, 3.9869e+05,
         7.9908e+05, 7.8738e+05, 3.9867e+05, 8.2423e+05, 3.9868e+05, 8.0467e+05,
         3.9867e+05, 3.9872e+05, 7.8525e+05, 3.9867e+05, 3.9868e+05],
        [1.8706e+00, 1.7787e+00, 1.8397e+00, 3.9871e+05, 0.0000e+00, 1.6198e+00,
         3.8033e+05, 3.8808e+05, 1.8657e+00, 3.9870e+05, 2.0920e+00, 3.9500e+05,
         1.8602e+00, 1.7652e+00, 3.9449e+05, 1.8252e+00, 1.8534e+00],
        [1.8710e+00, 1.7175e+00, 1.7124e+00, 3.9869e+05, 1.6198e+00, 0.0000e+00,
         3.8033e+05, 3.8809e+05, 1.7701e+00, 3.9872e+05, 1.7846e+00, 3.9500e+05,
         1.6597e+00, 1.7136e+00, 3.9453e+05, 1.7627e+00, 1.8120e+00],
        [3.8031e+05, 3.8027e+05, 3.8033e+05, 7.9908e+05, 3.8033e+05, 3.8033e+05,
         0.0000e+00, 7.8003e+05, 3.8028e+05, 7.7872e+05, 3.8033e+05, 7.5900e+05,
         3.8031e+05, 3.8033e+05, 7.8921e+05, 3.8032e+05, 3.8031e+05],
        [3.8804e+05, 3.8806e+05, 3.8806e+05, 7.8738e+05, 3.8808e+05, 3.8809e+05,
         7.8003e+05, 0.0000e+00, 3.8809e+05, 7.9157e+05, 3.8810e+05, 8.0713e+05,
         3.8807e+05, 3.8804e+05, 7.6777e+05, 3.8806e+05, 3.8804e+05],
        [2.0308e+00, 1.9080e+00, 1.9483e+00, 3.9867e+05, 1.8657e+00, 1.7701e+00,
         3.8028e+05, 3.8809e+05, 0.0000e+00, 3.9870e+05, 1.9267e+00, 3.9503e+05,
         1.9155e+00, 1.6909e+00, 3.9450e+05, 1.8119e+00, 1.8709e+00],
        [3.9871e+05, 3.9872e+05, 3.9872e+05, 8.2423e+05, 3.9870e+05, 3.9872e+05,
         7.7872e+05, 7.9157e+05, 3.9870e+05, 0.0000e+00, 3.9870e+05, 7.9648e+05,
         3.9877e+05, 3.9870e+05, 8.0410e+05, 3.9873e+05, 3.9870e+05],
        [1.8183e+00, 1.9551e+00, 1.7959e+00, 3.9868e+05, 2.0920e+00, 1.7846e+00,
         3.8033e+05, 3.8810e+05, 1.9267e+00, 3.9870e+05, 0.0000e+00, 3.9498e+05,
         1.8438e+00, 1.8479e+00, 3.9452e+05, 2.1736e+00, 1.7701e+00],
        [3.9498e+05, 3.9499e+05, 3.9500e+05, 8.0467e+05, 3.9500e+05, 3.9500e+05,
         7.5900e+05, 8.0713e+05, 3.9503e+05, 7.9648e+05, 3.9498e+05, 0.0000e+00,
         3.9499e+05, 3.9500e+05, 7.7642e+05, 3.9504e+05, 3.9503e+05],
        [1.7753e+00, 1.8478e+00, 1.8357e+00, 3.9867e+05, 1.8602e+00, 1.6597e+00,
         3.8031e+05, 3.8807e+05, 1.9155e+00, 3.9877e+05, 1.8438e+00, 3.9499e+05,
         0.0000e+00, 1.8598e+00, 3.9455e+05, 1.9287e+00, 1.8765e+00],
        [1.8400e+00, 1.6993e+00, 1.8072e+00, 3.9872e+05, 1.7652e+00, 1.7136e+00,
         3.8033e+05, 3.8804e+05, 1.6909e+00, 3.9870e+05, 1.8479e+00, 3.9500e+05,
         1.8598e+00, 0.0000e+00, 3.9452e+05, 1.9056e+00, 1.7129e+00],
        [3.9451e+05, 3.9451e+05, 3.9448e+05, 7.8525e+05, 3.9449e+05, 3.9453e+05,
         7.8921e+05, 7.6777e+05, 3.9450e+05, 8.0410e+05, 3.9452e+05, 7.7642e+05,
         3.9455e+05, 3.9452e+05, 0.0000e+00, 3.9449e+05, 3.9449e+05],
        [2.0043e+00, 2.0104e+00, 1.8615e+00, 3.9867e+05, 1.8252e+00, 1.7627e+00,
         3.8032e+05, 3.8806e+05, 1.8119e+00, 3.9873e+05, 2.1736e+00, 3.9504e+05,
         1.9287e+00, 1.9056e+00, 3.9449e+05, 0.0000e+00, 1.8289e+00],
        [1.8265e+00, 1.7700e+00, 1.8669e+00, 3.9868e+05, 1.8534e+00, 1.8120e+00,
         3.8031e+05, 3.8804e+05, 1.8709e+00, 3.9870e+05, 1.7701e+00, 3.9503e+05,
         1.8765e+00, 1.7129e+00, 3.9449e+05, 1.8289e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6985e+00, 1.7753e+00, 1.8183e+00, 1.8265e+00, 1.8400e+00,
        1.8706e+00, 1.8710e+00, 1.9341e+00, 2.0043e+00, 2.0308e+00, 3.8031e+05,
        3.8804e+05, 3.9451e+05, 3.9498e+05, 3.9868e+05, 3.9871e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6985e+00, 1.6993e+00, 1.7175e+00, 1.7565e+00, 1.7700e+00,
        1.7787e+00, 1.8478e+00, 1.9080e+00, 1.9551e+00, 2.0104e+00, 3.8027e+05,
        3.8806e+05, 3.9451e+05, 3.9499e+05, 3.9868e+05, 3.9872e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7124e+00, 1.7565e+00, 1.7959e+00, 1.8072e+00, 1.8357e+00,
        1.8397e+00, 1.8615e+00, 1.8669e+00, 1.9341e+00, 1.9483e+00, 3.8033e+05,
        3.8806e+05, 3.9448e+05, 3.9500e+05, 3.9870e+05, 3.9872e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398665.2188, 398665.2812, 398665.7188, 398676.5000,
        398678.8750, 398679.4375, 398684.6562, 398687.6562, 398700.4062,
        398712.5312, 398720.0625, 785252.6250, 787384.6250, 799084.9375,
        804671.1250, 824228.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6198e+00, 1.7652e+00, 1.7787e+00, 1.8252e+00, 1.8397e+00,
        1.8534e+00, 1.8602e+00, 1.8657e+00, 1.8706e+00, 2.0920e+00, 3.8033e+05,
        3.8808e+05, 3.9449e+05, 3.9500e+05, 3.9870e+05, 3.9871e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6198e+00, 1.6597e+00, 1.7124e+00, 1.7136e+00, 1.7175e+00,
        1.7627e+00, 1.7701e+00, 1.7846e+00, 1.8120e+00, 1.8710e+00, 3.8033e+05,
        3.8809e+05, 3.9453e+05, 3.9500e+05, 3.9869e+05, 3.9872e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380271.3125, 380282.4375, 380310.1875, 380313.0000,
        380313.6562, 380316.1875, 380327.5312, 380328.6875, 380328.8125,
        380331.3750, 380334.8438, 759001.6875, 778715.2500, 780031.5625,
        789214.8750, 799084.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388038.7188, 388040.9688, 388042.8125, 388060.6875,
        388061.0938, 388064.4062, 388074.3750, 388076.4062, 388087.4062,
        388091.7188, 388098.2188, 767771.0000, 780031.5625, 787384.6250,
        791569.0625, 807130.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6909e+00, 1.7701e+00, 1.8119e+00, 1.8657e+00, 1.8709e+00,
        1.9080e+00, 1.9155e+00, 1.9267e+00, 1.9483e+00, 2.0308e+00, 3.8028e+05,
        3.8809e+05, 3.9450e+05, 3.9503e+05, 3.9867e+05, 3.9870e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398698.4688, 398699.6562, 398701.1875, 398704.6250,
        398704.8125, 398711.9688, 398718.0000, 398719.8125, 398720.6250,
        398728.0625, 398770.1875, 778715.2500, 791569.0625, 796475.4375,
        804098.0000, 824228.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7701e+00, 1.7846e+00, 1.7959e+00, 1.8183e+00, 1.8438e+00,
        1.8479e+00, 1.9267e+00, 1.9551e+00, 2.0920e+00, 2.1736e+00, 3.8033e+05,
        3.8810e+05, 3.9452e+05, 3.9498e+05, 3.9868e+05, 3.9870e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394976.5000, 394982.5000, 394986.2188, 394990.9375,
        394995.4062, 394997.1562, 394999.9375, 395001.0312, 395026.1562,
        395029.0000, 395037.7812, 759001.6875, 776423.7500, 796475.4375,
        804671.1250, 807130.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6597e+00, 1.7753e+00, 1.8357e+00, 1.8438e+00, 1.8478e+00,
        1.8598e+00, 1.8602e+00, 1.8765e+00, 1.9155e+00, 1.9287e+00, 3.8031e+05,
        3.8807e+05, 3.9455e+05, 3.9499e+05, 3.9867e+05, 3.9877e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6909e+00, 1.6993e+00, 1.7129e+00, 1.7136e+00, 1.7652e+00,
        1.8072e+00, 1.8400e+00, 1.8479e+00, 1.8598e+00, 1.9056e+00, 3.8033e+05,
        3.8804e+05, 3.9452e+05, 3.9500e+05, 3.9870e+05, 3.9872e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394480.4375, 394487.7188, 394491.6875, 394492.5312,
        394500.1875, 394514.9062, 394514.9375, 394515.0000, 394520.7812,
        394526.6250, 394549.3750, 767771.0000, 776423.7500, 785252.6250,
        789214.8750, 804098.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7627e+00, 1.8119e+00, 1.8252e+00, 1.8289e+00, 1.8615e+00,
        1.9056e+00, 1.9287e+00, 2.0043e+00, 2.0104e+00, 2.1736e+00, 3.8032e+05,
        3.8806e+05, 3.9449e+05, 3.9504e+05, 3.9867e+05, 3.9873e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7129e+00, 1.7700e+00, 1.7701e+00, 1.8120e+00, 1.8265e+00,
        1.8289e+00, 1.8534e+00, 1.8669e+00, 1.8709e+00, 1.8765e+00, 3.8031e+05,
        3.8804e+05, 3.9449e+05, 3.9503e+05, 3.9868e+05, 3.9870e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.87', '1.81', '1.84', '398685.16', '1.84', '1.74', '380314.38', '388066.97', '1.87', '398716.09', '1.90', '395002.09', '1.84', '1.78', '394508.56', '1.91', '1.82']
estimated f for each client, fs: [6, 6, 6, 4, 6, 6, 4, 4, 6, 4, 6, 4, 6, 6, 4, 6, 6]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 3, 13, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0124s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:28...
global Accuracy on shared test data: 77.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 49 214]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:28, End: 2025-07-22 15:29:28)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [7, 2, 19, 17, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.6724e+00, 4.1037e+05, 3.8714e+05, 4.0091e+05, 4.0583e+05,
         1.8187e+00, 3.9099e+05, 1.6510e+00, 1.9177e+00, 3.9891e+05, 3.8332e+05,
         1.8145e+00, 1.8287e+00, 3.9502e+05, 1.9637e+00, 1.6937e+00],
        [1.6724e+00, 0.0000e+00, 4.1038e+05, 3.8712e+05, 4.0092e+05, 4.0583e+05,
         1.8070e+00, 3.9100e+05, 1.8240e+00, 1.6521e+00, 3.9890e+05, 3.8332e+05,
         1.7487e+00, 1.7369e+00, 3.9503e+05, 1.7528e+00, 1.7798e+00],
        [4.1037e+05, 4.1038e+05, 0.0000e+00, 8.1809e+05, 7.9907e+05, 8.1164e+05,
         4.1038e+05, 8.0617e+05, 4.1036e+05, 4.1041e+05, 8.0533e+05, 8.0694e+05,
         4.1039e+05, 4.1038e+05, 8.3657e+05, 4.1040e+05, 4.1039e+05],
        [3.8714e+05, 3.8712e+05, 8.1809e+05, 0.0000e+00, 7.9431e+05, 7.8665e+05,
         3.8710e+05, 7.6471e+05, 3.8716e+05, 3.8713e+05, 7.7338e+05, 7.7207e+05,
         3.8710e+05, 3.8712e+05, 7.7591e+05, 3.8711e+05, 3.8713e+05],
        [4.0091e+05, 4.0092e+05, 7.9907e+05, 7.9431e+05, 0.0000e+00, 8.1526e+05,
         4.0090e+05, 7.8367e+05, 4.0091e+05, 4.0091e+05, 8.0545e+05, 7.9409e+05,
         4.0087e+05, 4.0092e+05, 7.8817e+05, 4.0091e+05, 4.0092e+05],
        [4.0583e+05, 4.0583e+05, 8.1164e+05, 7.8665e+05, 8.1526e+05, 0.0000e+00,
         4.0585e+05, 7.7197e+05, 4.0585e+05, 4.0587e+05, 7.8421e+05, 7.9621e+05,
         4.0585e+05, 4.0580e+05, 7.8294e+05, 4.0585e+05, 4.0584e+05],
        [1.8187e+00, 1.8070e+00, 4.1038e+05, 3.8710e+05, 4.0090e+05, 4.0585e+05,
         0.0000e+00, 3.9100e+05, 1.6654e+00, 1.8069e+00, 3.9893e+05, 3.8330e+05,
         1.8504e+00, 1.6556e+00, 3.9503e+05, 1.7304e+00, 1.7436e+00],
        [3.9099e+05, 3.9100e+05, 8.0617e+05, 7.6471e+05, 7.8367e+05, 7.7197e+05,
         3.9100e+05, 0.0000e+00, 3.9096e+05, 3.9098e+05, 7.9024e+05, 7.7282e+05,
         3.9098e+05, 3.9098e+05, 7.7973e+05, 3.9098e+05, 3.9098e+05],
        [1.6510e+00, 1.8240e+00, 4.1036e+05, 3.8716e+05, 4.0091e+05, 4.0585e+05,
         1.6654e+00, 3.9096e+05, 0.0000e+00, 1.9146e+00, 3.9890e+05, 3.8329e+05,
         1.6596e+00, 1.8199e+00, 3.9505e+05, 1.6400e+00, 1.5933e+00],
        [1.9177e+00, 1.6521e+00, 4.1041e+05, 3.8713e+05, 4.0091e+05, 4.0587e+05,
         1.8069e+00, 3.9098e+05, 1.9146e+00, 0.0000e+00, 3.9891e+05, 3.8334e+05,
         1.8327e+00, 1.7669e+00, 3.9503e+05, 2.0114e+00, 1.6853e+00],
        [3.9891e+05, 3.9890e+05, 8.0533e+05, 7.7338e+05, 8.0545e+05, 7.8421e+05,
         3.9893e+05, 7.9024e+05, 3.9890e+05, 3.9891e+05, 0.0000e+00, 7.8657e+05,
         3.9892e+05, 3.9888e+05, 7.7868e+05, 3.9892e+05, 3.9890e+05],
        [3.8332e+05, 3.8332e+05, 8.0694e+05, 7.7207e+05, 7.9409e+05, 7.9621e+05,
         3.8330e+05, 7.7282e+05, 3.8329e+05, 3.8334e+05, 7.8657e+05, 0.0000e+00,
         3.8334e+05, 3.8331e+05, 7.7465e+05, 3.8333e+05, 3.8334e+05],
        [1.8145e+00, 1.7487e+00, 4.1039e+05, 3.8710e+05, 4.0087e+05, 4.0585e+05,
         1.8504e+00, 3.9098e+05, 1.6596e+00, 1.8327e+00, 3.9892e+05, 3.8334e+05,
         0.0000e+00, 1.8617e+00, 3.9501e+05, 1.8900e+00, 1.8394e+00],
        [1.8287e+00, 1.7369e+00, 4.1038e+05, 3.8712e+05, 4.0092e+05, 4.0580e+05,
         1.6556e+00, 3.9098e+05, 1.8199e+00, 1.7669e+00, 3.9888e+05, 3.8331e+05,
         1.8617e+00, 0.0000e+00, 3.9502e+05, 1.8552e+00, 1.6432e+00],
        [3.9502e+05, 3.9503e+05, 8.3657e+05, 7.7591e+05, 7.8817e+05, 7.8294e+05,
         3.9503e+05, 7.7973e+05, 3.9505e+05, 3.9503e+05, 7.7868e+05, 7.7465e+05,
         3.9501e+05, 3.9502e+05, 0.0000e+00, 3.9502e+05, 3.9504e+05],
        [1.9637e+00, 1.7528e+00, 4.1040e+05, 3.8711e+05, 4.0091e+05, 4.0585e+05,
         1.7304e+00, 3.9098e+05, 1.6400e+00, 2.0114e+00, 3.9892e+05, 3.8333e+05,
         1.8900e+00, 1.8552e+00, 3.9502e+05, 0.0000e+00, 1.7964e+00],
        [1.6937e+00, 1.7798e+00, 4.1039e+05, 3.8713e+05, 4.0092e+05, 4.0584e+05,
         1.7436e+00, 3.9098e+05, 1.5933e+00, 1.6853e+00, 3.9890e+05, 3.8334e+05,
         1.8394e+00, 1.6432e+00, 3.9504e+05, 1.7964e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6510e+00, 1.6724e+00, 1.6937e+00, 1.8145e+00, 1.8187e+00,
        1.8287e+00, 1.9177e+00, 1.9637e+00, 3.8332e+05, 3.8714e+05, 3.9099e+05,
        3.9502e+05, 3.9891e+05, 4.0091e+05, 4.0583e+05, 4.1037e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6521e+00, 1.6724e+00, 1.7369e+00, 1.7487e+00, 1.7528e+00,
        1.7798e+00, 1.8070e+00, 1.8240e+00, 3.8332e+05, 3.8712e+05, 3.9100e+05,
        3.9503e+05, 3.9890e+05, 4.0092e+05, 4.0583e+05, 4.1038e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 410355.9062, 410372.7500, 410378.8438, 410379.2188,
        410382.6875, 410385.8125, 410389.0312, 410403.7500, 410406.8750,
        799067.0000, 805326.4375, 806168.8750, 806935.7500, 811641.6250,
        818089.8125, 836566.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387096.4375, 387103.0000, 387111.9062, 387118.3750,
        387122.9062, 387127.1562, 387128.3125, 387141.2500, 387161.3125,
        764714.2500, 772072.8125, 773379.3125, 775909.5625, 786645.2500,
        794311.5625, 818089.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400872.7812, 400897.8750, 400905.6875, 400907.1875,
        400909.9375, 400910.1562, 400917.3125, 400917.4688, 400924.3750,
        783666.5625, 788171.5625, 794092.2500, 794311.5625, 799067.0000,
        805451.3750, 815260.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405802.6875, 405830.6250, 405833.0625, 405837.5625,
        405846.8438, 405849.2812, 405851.0938, 405852.7188, 405871.9688,
        771969.5000, 782936.4375, 784213.5000, 786645.2500, 796205.9375,
        811641.6250, 815260.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6556e+00, 1.6654e+00, 1.7304e+00, 1.7436e+00, 1.8069e+00,
        1.8070e+00, 1.8187e+00, 1.8504e+00, 3.8330e+05, 3.8710e+05, 3.9100e+05,
        3.9503e+05, 3.9893e+05, 4.0090e+05, 4.0585e+05, 4.1038e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390964.5000, 390976.0000, 390976.3750, 390978.0625,
        390978.4375, 390979.8438, 390994.8438, 390999.1562, 391003.1875,
        764714.2500, 771969.5000, 772821.1250, 779733.6875, 783666.5625,
        790245.0000, 806168.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5933e+00, 1.6400e+00, 1.6510e+00, 1.6596e+00, 1.6654e+00,
        1.8199e+00, 1.8240e+00, 1.9146e+00, 3.8329e+05, 3.8716e+05, 3.9096e+05,
        3.9505e+05, 3.9890e+05, 4.0091e+05, 4.0585e+05, 4.1036e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6521e+00, 1.6853e+00, 1.7669e+00, 1.8069e+00, 1.8327e+00,
        1.9146e+00, 1.9177e+00, 2.0114e+00, 3.8334e+05, 3.8713e+05, 3.9098e+05,
        3.9503e+05, 3.9891e+05, 4.0091e+05, 4.0587e+05, 4.1041e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398876.8438, 398897.6562, 398900.3750, 398903.5000,
        398908.9062, 398910.2500, 398920.0000, 398924.1875, 398925.7812,
        773379.3125, 778678.6875, 784213.5000, 786566.1875, 790245.0000,
        805326.4375, 805451.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383286.1250, 383298.0000, 383310.2188, 383319.3438,
        383323.0000, 383334.3438, 383337.1250, 383337.3125, 383344.2500,
        772072.8125, 772821.1250, 774651.3125, 786566.1875, 794092.2500,
        796205.9375, 806935.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6596e+00, 1.7487e+00, 1.8145e+00, 1.8327e+00, 1.8394e+00,
        1.8504e+00, 1.8617e+00, 1.8900e+00, 3.8334e+05, 3.8710e+05, 3.9098e+05,
        3.9501e+05, 3.9892e+05, 4.0087e+05, 4.0585e+05, 4.1039e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6432e+00, 1.6556e+00, 1.7369e+00, 1.7669e+00, 1.8199e+00,
        1.8287e+00, 1.8552e+00, 1.8617e+00, 3.8331e+05, 3.8712e+05, 3.9098e+05,
        3.9502e+05, 3.9888e+05, 4.0092e+05, 4.0580e+05, 4.1038e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395012.4688, 395016.1562, 395019.8125, 395025.0000,
        395025.8438, 395027.5312, 395031.5000, 395039.2812, 395051.9062,
        774651.3125, 775909.5625, 778678.6875, 779733.6875, 782936.4375,
        788171.5625, 836566.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6400e+00, 1.7304e+00, 1.7528e+00, 1.7964e+00, 1.8552e+00,
        1.8900e+00, 1.9637e+00, 2.0114e+00, 3.8333e+05, 3.8711e+05, 3.9098e+05,
        3.9502e+05, 3.9892e+05, 4.0091e+05, 4.0585e+05, 4.1040e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5933e+00, 1.6432e+00, 1.6853e+00, 1.6937e+00, 1.7436e+00,
        1.7798e+00, 1.7964e+00, 1.8394e+00, 3.8334e+05, 3.8713e+05, 3.9098e+05,
        3.9504e+05, 3.9890e+05, 4.0092e+05, 4.0584e+05, 4.1039e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77047.87', '77045.61', '449252.19', '424882.47', '439182.94', '442454.53', '77040.84', '428356.44', '77046.12', '77047.90', '436354.66', '422196.22', '77046.17', '77044.27', '432990.03', '77046.08', '77047.92']
estimated f for each client, fs: [8, 8, 6, 6, 6, 6, 8, 6, 8, 8, 6, 7, 8, 8, 6, 8, 8]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [7, 2, 19, 17, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0122s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:29...
global Accuracy on shared test data: 77.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:29, End: 2025-07-22 15:29:29)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 13, 14, 11, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.7599e+00, 1.8987e+00, 3.9943e+05, 3.9154e+05, 1.8497e+00,
         3.9014e+05, 3.8310e+05, 2.1442e+00, 3.8638e+05, 1.8305e+00, 3.8284e+05,
         3.9992e+05, 1.8283e+00, 3.8707e+05, 1.9557e+00, 1.8316e+00],
        [1.7599e+00, 0.0000e+00, 1.7782e+00, 3.9944e+05, 3.9156e+05, 1.8173e+00,
         3.9012e+05, 3.8310e+05, 2.0438e+00, 3.8635e+05, 2.0316e+00, 3.8281e+05,
         3.9992e+05, 1.9547e+00, 3.8704e+05, 2.0872e+00, 1.9091e+00],
        [1.8987e+00, 1.7782e+00, 0.0000e+00, 3.9946e+05, 3.9155e+05, 1.7546e+00,
         3.9011e+05, 3.8309e+05, 1.9439e+00, 3.8638e+05, 1.7430e+00, 3.8277e+05,
         3.9993e+05, 1.9007e+00, 3.8707e+05, 1.7726e+00, 1.8499e+00],
        [3.9943e+05, 3.9944e+05, 3.9946e+05, 0.0000e+00, 7.8747e+05, 3.9946e+05,
         7.9189e+05, 7.9433e+05, 3.9948e+05, 7.8523e+05, 3.9945e+05, 7.7851e+05,
         8.1382e+05, 3.9948e+05, 7.7504e+05, 3.9948e+05, 3.9948e+05],
        [3.9154e+05, 3.9156e+05, 3.9155e+05, 7.8747e+05, 0.0000e+00, 3.9156e+05,
         8.0053e+05, 7.8914e+05, 3.9155e+05, 7.6298e+05, 3.9154e+05, 7.6159e+05,
         8.0186e+05, 3.9158e+05, 7.7384e+05, 3.9155e+05, 3.9158e+05],
        [1.8497e+00, 1.8173e+00, 1.7546e+00, 3.9946e+05, 3.9156e+05, 0.0000e+00,
         3.9010e+05, 3.8311e+05, 1.9767e+00, 3.8636e+05, 2.0698e+00, 3.8279e+05,
         3.9993e+05, 1.8853e+00, 3.8708e+05, 1.8154e+00, 1.8560e+00],
        [3.9014e+05, 3.9012e+05, 3.9011e+05, 7.9189e+05, 8.0053e+05, 3.9010e+05,
         0.0000e+00, 7.8255e+05, 3.9008e+05, 7.8023e+05, 3.9012e+05, 7.7352e+05,
         7.9665e+05, 3.9010e+05, 7.8058e+05, 3.9011e+05, 3.9010e+05],
        [3.8310e+05, 3.8310e+05, 3.8309e+05, 7.9433e+05, 7.8914e+05, 3.8311e+05,
         7.8255e+05, 0.0000e+00, 3.8308e+05, 7.6754e+05, 3.8309e+05, 7.8101e+05,
         7.8339e+05, 3.8311e+05, 7.6362e+05, 3.8312e+05, 3.8311e+05],
        [2.1442e+00, 2.0438e+00, 1.9439e+00, 3.9948e+05, 3.9155e+05, 1.9767e+00,
         3.9008e+05, 3.8308e+05, 0.0000e+00, 3.8638e+05, 1.9042e+00, 3.8279e+05,
         3.9992e+05, 1.8681e+00, 3.8708e+05, 1.9593e+00, 1.9461e+00],
        [3.8638e+05, 3.8635e+05, 3.8638e+05, 7.8523e+05, 7.6298e+05, 3.8636e+05,
         7.8023e+05, 7.6754e+05, 3.8638e+05, 0.0000e+00, 3.8638e+05, 7.8020e+05,
         7.7106e+05, 3.8638e+05, 7.6263e+05, 3.8636e+05, 3.8639e+05],
        [1.8305e+00, 2.0316e+00, 1.7430e+00, 3.9945e+05, 3.9154e+05, 2.0698e+00,
         3.9012e+05, 3.8309e+05, 1.9042e+00, 3.8638e+05, 0.0000e+00, 3.8280e+05,
         3.9994e+05, 1.8815e+00, 3.8705e+05, 2.0918e+00, 1.7768e+00],
        [3.8284e+05, 3.8281e+05, 3.8277e+05, 7.7851e+05, 7.6159e+05, 3.8279e+05,
         7.7352e+05, 7.8101e+05, 3.8279e+05, 7.8020e+05, 3.8280e+05, 0.0000e+00,
         7.8517e+05, 3.8281e+05, 7.9380e+05, 3.8278e+05, 3.8280e+05],
        [3.9992e+05, 3.9992e+05, 3.9993e+05, 8.1382e+05, 8.0186e+05, 3.9993e+05,
         7.9665e+05, 7.8339e+05, 3.9992e+05, 7.7106e+05, 3.9994e+05, 7.8517e+05,
         0.0000e+00, 3.9992e+05, 7.7911e+05, 3.9992e+05, 3.9992e+05],
        [1.8283e+00, 1.9547e+00, 1.9007e+00, 3.9948e+05, 3.9158e+05, 1.8853e+00,
         3.9010e+05, 3.8311e+05, 1.8681e+00, 3.8638e+05, 1.8815e+00, 3.8281e+05,
         3.9992e+05, 0.0000e+00, 3.8708e+05, 2.0222e+00, 1.9140e+00],
        [3.8707e+05, 3.8704e+05, 3.8707e+05, 7.7504e+05, 7.7384e+05, 3.8708e+05,
         7.8058e+05, 7.6362e+05, 3.8708e+05, 7.6263e+05, 3.8705e+05, 7.9380e+05,
         7.7911e+05, 3.8708e+05, 0.0000e+00, 3.8708e+05, 3.8707e+05],
        [1.9557e+00, 2.0872e+00, 1.7726e+00, 3.9948e+05, 3.9155e+05, 1.8154e+00,
         3.9011e+05, 3.8312e+05, 1.9593e+00, 3.8636e+05, 2.0918e+00, 3.8278e+05,
         3.9992e+05, 2.0222e+00, 3.8708e+05, 0.0000e+00, 1.8430e+00],
        [1.8316e+00, 1.9091e+00, 1.8499e+00, 3.9948e+05, 3.9158e+05, 1.8560e+00,
         3.9010e+05, 3.8311e+05, 1.9461e+00, 3.8639e+05, 1.7768e+00, 3.8280e+05,
         3.9992e+05, 1.9140e+00, 3.8707e+05, 1.8430e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7599e+00, 1.8283e+00, 1.8305e+00, 1.8316e+00, 1.8497e+00,
        1.8987e+00, 1.9557e+00, 2.1442e+00, 3.8284e+05, 3.8310e+05, 3.8638e+05,
        3.8707e+05, 3.9014e+05, 3.9154e+05, 3.9943e+05, 3.9992e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7599e+00, 1.7782e+00, 1.8173e+00, 1.9091e+00, 1.9547e+00,
        2.0316e+00, 2.0438e+00, 2.0872e+00, 3.8281e+05, 3.8310e+05, 3.8635e+05,
        3.8704e+05, 3.9012e+05, 3.9156e+05, 3.9944e+05, 3.9992e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7430e+00, 1.7546e+00, 1.7726e+00, 1.7782e+00, 1.8499e+00,
        1.8987e+00, 1.9007e+00, 1.9439e+00, 3.8277e+05, 3.8309e+05, 3.8638e+05,
        3.8707e+05, 3.9011e+05, 3.9155e+05, 3.9946e+05, 3.9993e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399433.6562, 399444.8125, 399448.5000, 399456.1562,
        399458.7812, 399476.8750, 399477.9062, 399478.7188, 399484.8125,
        775042.6875, 778511.7500, 785226.1875, 787466.5000, 791894.2500,
        794329.3125, 813824.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391535.0938, 391538.8750, 391548.7500, 391550.7812,
        391554.0312, 391556.0938, 391564.2188, 391582.3438, 391583.9688,
        761589.1250, 762976.5000, 773835.5625, 787466.5000, 789140.1875,
        800527.8125, 801864.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7546e+00, 1.8154e+00, 1.8173e+00, 1.8497e+00, 1.8560e+00,
        1.8853e+00, 1.9767e+00, 2.0698e+00, 3.8279e+05, 3.8311e+05, 3.8636e+05,
        3.8708e+05, 3.9010e+05, 3.9156e+05, 3.9946e+05, 3.9993e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390075.0312, 390101.6875, 390101.9375, 390102.4688,
        390107.3125, 390109.8125, 390117.2500, 390122.6562, 390138.3438,
        773523.2500, 780232.8125, 780583.8125, 782554.3750, 791894.2500,
        796649.0625, 800527.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383077.6562, 383089.1875, 383093.0000, 383101.2812,
        383104.9688, 383109.8125, 383114.1875, 383114.5938, 383118.9688,
        763623.2500, 767538.4375, 781013.0000, 782554.3750, 783394.6875,
        789140.1875, 794329.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8681e+00, 1.9042e+00, 1.9439e+00, 1.9461e+00, 1.9593e+00,
        1.9767e+00, 2.0438e+00, 2.1442e+00, 3.8279e+05, 3.8308e+05, 3.8638e+05,
        3.8708e+05, 3.9008e+05, 3.9155e+05, 3.9948e+05, 3.9992e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386347.3750, 386357.2812, 386360.4375, 386375.2500,
        386376.0312, 386380.8125, 386381.2500, 386383.6250, 386393.8750,
        762625.9375, 762976.5000, 767538.4375, 771055.9375, 780200.7500,
        780232.8125, 785226.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7430e+00, 1.7768e+00, 1.8305e+00, 1.8815e+00, 1.9042e+00,
        2.0316e+00, 2.0698e+00, 2.0918e+00, 3.8280e+05, 3.8309e+05, 3.8638e+05,
        3.8705e+05, 3.9012e+05, 3.9154e+05, 3.9945e+05, 3.9994e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382774.9688, 382778.9688, 382786.7500, 382788.5938,
        382796.5938, 382800.3438, 382805.3750, 382806.5625, 382840.1250,
        761589.1250, 773523.2500, 778511.7500, 780200.7500, 781013.0000,
        785165.9375, 793799.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399919.6250, 399920.8438, 399921.1562, 399921.7500,
        399922.0312, 399924.5000, 399927.3125, 399928.9062, 399936.8125,
        771055.9375, 779112.8750, 783394.6875, 785165.9375, 796649.0625,
        801864.2500, 813824.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8283e+00, 1.8681e+00, 1.8815e+00, 1.8853e+00, 1.9007e+00,
        1.9140e+00, 1.9547e+00, 2.0222e+00, 3.8281e+05, 3.8311e+05, 3.8638e+05,
        3.8708e+05, 3.9010e+05, 3.9158e+05, 3.9948e+05, 3.9992e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387039.2188, 387045.7812, 387067.5625, 387068.4688,
        387070.9375, 387075.7500, 387081.4375, 387082.0938, 387082.4375,
        762625.9375, 763623.2500, 773835.5625, 775042.6875, 779112.8750,
        780583.8125, 793799.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7726e+00, 1.8154e+00, 1.8430e+00, 1.9557e+00, 1.9593e+00,
        2.0222e+00, 2.0872e+00, 2.0918e+00, 3.8278e+05, 3.8312e+05, 3.8636e+05,
        3.8708e+05, 3.9011e+05, 3.9155e+05, 3.9948e+05, 3.9992e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7768e+00, 1.8316e+00, 1.8430e+00, 1.8499e+00, 1.8560e+00,
        1.9091e+00, 1.9140e+00, 1.9461e+00, 3.8280e+05, 3.8311e+05, 3.8639e+05,
        3.8707e+05, 3.9010e+05, 3.9158e+05, 3.9948e+05, 3.9992e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76595.66', '76592.69', '76587.88', '437020.28', '428560.31', '76591.33', '428449.94', '421154.69', '76588.02', '423998.19', '76590.49', '420676.72', '437037.91', '76593.52', '424623.94', '76591.34', '76592.95']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 6, 6, 8, 6, 8, 6, 6, 8, 6, 8, 8]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0115s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:29...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0023 seconds (Start: 2025-07-22 15:29:29, End: 2025-07-22 15:29:29)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.5724e+00, 1.8961e+00, 3.8426e+05, 3.7931e+05, 1.5680e+00,
         1.7500e+00, 3.8921e+05, 4.0772e+05, 3.9034e+05, 1.6517e+00, 1.6500e+00,
         3.9127e+05, 3.8422e+05, 1.6784e+00, 1.6947e+00, 3.8244e+05, 1.8082e+00,
         1.6521e+00],
        [1.5724e+00, 0.0000e+00, 1.7759e+00, 3.8429e+05, 3.7929e+05, 1.6260e+00,
         1.6932e+00, 3.8918e+05, 4.0772e+05, 3.9035e+05, 1.5594e+00, 1.7711e+00,
         3.9130e+05, 3.8421e+05, 1.7455e+00, 1.6055e+00, 3.8244e+05, 1.8290e+00,
         1.5924e+00],
        [1.8961e+00, 1.7759e+00, 0.0000e+00, 3.8429e+05, 3.7937e+05, 1.8327e+00,
         1.5983e+00, 3.8921e+05, 4.0771e+05, 3.9035e+05, 1.8548e+00, 1.6227e+00,
         3.9132e+05, 3.8423e+05, 1.7702e+00, 1.8259e+00, 3.8245e+05, 1.9238e+00,
         1.8401e+00],
        [3.8426e+05, 3.8429e+05, 3.8429e+05, 0.0000e+00, 7.5619e+05, 3.8422e+05,
         3.8424e+05, 7.6143e+05, 7.8135e+05, 7.8751e+05, 3.8424e+05, 3.8421e+05,
         7.8131e+05, 7.8059e+05, 3.8424e+05, 3.8425e+05, 7.5644e+05, 3.8420e+05,
         3.8420e+05],
        [3.7931e+05, 3.7929e+05, 3.7937e+05, 7.5619e+05, 0.0000e+00, 3.7929e+05,
         3.7931e+05, 7.8555e+05, 7.9959e+05, 7.6318e+05, 3.7930e+05, 3.7934e+05,
         7.6836e+05, 7.7545e+05, 3.7931e+05, 3.7932e+05, 7.4517e+05, 3.7929e+05,
         3.7931e+05],
        [1.5680e+00, 1.6260e+00, 1.8327e+00, 3.8422e+05, 3.7929e+05, 0.0000e+00,
         1.5305e+00, 3.8919e+05, 4.0769e+05, 3.9037e+05, 1.5982e+00, 1.8516e+00,
         3.9128e+05, 3.8419e+05, 1.7178e+00, 1.5669e+00, 3.8244e+05, 1.6427e+00,
         1.5566e+00],
        [1.7500e+00, 1.6932e+00, 1.5983e+00, 3.8424e+05, 3.7931e+05, 1.5305e+00,
         0.0000e+00, 3.8920e+05, 4.0770e+05, 3.9040e+05, 1.6435e+00, 1.5380e+00,
         3.9128e+05, 3.8419e+05, 1.5135e+00, 1.6360e+00, 3.8240e+05, 1.6761e+00,
         1.6946e+00],
        [3.8921e+05, 3.8918e+05, 3.8921e+05, 7.6143e+05, 7.8555e+05, 3.8919e+05,
         3.8920e+05, 0.0000e+00, 7.9496e+05, 7.9770e+05, 3.8920e+05, 3.8922e+05,
         7.9019e+05, 7.6554e+05, 3.8918e+05, 3.8921e+05, 7.7399e+05, 3.8922e+05,
         3.8917e+05],
        [4.0772e+05, 4.0772e+05, 4.0771e+05, 7.8135e+05, 7.9959e+05, 4.0769e+05,
         4.0770e+05, 7.9496e+05, 0.0000e+00, 8.1328e+05, 4.0773e+05, 4.0774e+05,
         7.9315e+05, 8.0146e+05, 4.0770e+05, 4.0770e+05, 7.9392e+05, 4.0768e+05,
         4.0772e+05],
        [3.9034e+05, 3.9035e+05, 3.9035e+05, 7.8751e+05, 7.6318e+05, 3.9037e+05,
         3.9040e+05, 7.9770e+05, 8.1328e+05, 0.0000e+00, 3.9032e+05, 3.9034e+05,
         7.8439e+05, 7.7645e+05, 3.9034e+05, 3.9034e+05, 7.8034e+05, 3.9030e+05,
         3.9033e+05],
        [1.6517e+00, 1.5594e+00, 1.8548e+00, 3.8424e+05, 3.7930e+05, 1.5982e+00,
         1.6435e+00, 3.8920e+05, 4.0773e+05, 3.9032e+05, 0.0000e+00, 1.7173e+00,
         3.9128e+05, 3.8417e+05, 1.6412e+00, 1.7329e+00, 3.8241e+05, 1.5250e+00,
         1.5291e+00],
        [1.6500e+00, 1.7711e+00, 1.6227e+00, 3.8421e+05, 3.7934e+05, 1.8516e+00,
         1.5380e+00, 3.8922e+05, 4.0774e+05, 3.9034e+05, 1.7173e+00, 0.0000e+00,
         3.9130e+05, 3.8421e+05, 1.7297e+00, 1.6803e+00, 3.8243e+05, 1.8924e+00,
         1.5700e+00],
        [3.9127e+05, 3.9130e+05, 3.9132e+05, 7.8131e+05, 7.6836e+05, 3.9128e+05,
         3.9128e+05, 7.9019e+05, 7.9315e+05, 7.8439e+05, 3.9128e+05, 3.9130e+05,
         0.0000e+00, 7.7435e+05, 3.9127e+05, 3.9130e+05, 7.8589e+05, 3.9124e+05,
         3.9131e+05],
        [3.8422e+05, 3.8421e+05, 3.8423e+05, 7.8059e+05, 7.7545e+05, 3.8419e+05,
         3.8419e+05, 7.6554e+05, 8.0146e+05, 7.7645e+05, 3.8417e+05, 3.8421e+05,
         7.7435e+05, 0.0000e+00, 3.8419e+05, 3.8422e+05, 7.7166e+05, 3.8420e+05,
         3.8423e+05],
        [1.6784e+00, 1.7455e+00, 1.7702e+00, 3.8424e+05, 3.7931e+05, 1.7178e+00,
         1.5135e+00, 3.8918e+05, 4.0770e+05, 3.9034e+05, 1.6412e+00, 1.7297e+00,
         3.9127e+05, 3.8419e+05, 0.0000e+00, 1.7590e+00, 3.8246e+05, 1.8229e+00,
         1.7298e+00],
        [1.6947e+00, 1.6055e+00, 1.8259e+00, 3.8425e+05, 3.7932e+05, 1.5669e+00,
         1.6360e+00, 3.8921e+05, 4.0770e+05, 3.9034e+05, 1.7329e+00, 1.6803e+00,
         3.9130e+05, 3.8422e+05, 1.7590e+00, 0.0000e+00, 3.8240e+05, 1.7658e+00,
         1.5827e+00],
        [3.8244e+05, 3.8244e+05, 3.8245e+05, 7.5644e+05, 7.4517e+05, 3.8244e+05,
         3.8240e+05, 7.7399e+05, 7.9392e+05, 7.8034e+05, 3.8241e+05, 3.8243e+05,
         7.8589e+05, 7.7166e+05, 3.8246e+05, 3.8240e+05, 0.0000e+00, 3.8243e+05,
         3.8244e+05],
        [1.8082e+00, 1.8290e+00, 1.9238e+00, 3.8420e+05, 3.7929e+05, 1.6427e+00,
         1.6761e+00, 3.8922e+05, 4.0768e+05, 3.9030e+05, 1.5250e+00, 1.8924e+00,
         3.9124e+05, 3.8420e+05, 1.8229e+00, 1.7658e+00, 3.8243e+05, 0.0000e+00,
         1.6715e+00],
        [1.6521e+00, 1.5924e+00, 1.8401e+00, 3.8420e+05, 3.7931e+05, 1.5566e+00,
         1.6946e+00, 3.8917e+05, 4.0772e+05, 3.9033e+05, 1.5291e+00, 1.5700e+00,
         3.9131e+05, 3.8423e+05, 1.7298e+00, 1.5827e+00, 3.8244e+05, 1.6715e+00,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5680e+00, 1.5724e+00, 1.6500e+00, 1.6517e+00, 1.6521e+00,
        1.6784e+00, 1.6947e+00, 1.7500e+00, 1.8082e+00, 1.8961e+00, 3.7931e+05,
        3.8244e+05, 3.8422e+05, 3.8426e+05, 3.8921e+05, 3.9034e+05, 3.9127e+05,
        4.0772e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5594e+00, 1.5724e+00, 1.5924e+00, 1.6055e+00, 1.6260e+00,
        1.6932e+00, 1.7455e+00, 1.7711e+00, 1.7759e+00, 1.8290e+00, 3.7929e+05,
        3.8244e+05, 3.8421e+05, 3.8429e+05, 3.8918e+05, 3.9035e+05, 3.9130e+05,
        4.0772e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5983e+00, 1.6227e+00, 1.7702e+00, 1.7759e+00, 1.8259e+00,
        1.8327e+00, 1.8401e+00, 1.8548e+00, 1.8961e+00, 1.9238e+00, 3.7937e+05,
        3.8245e+05, 3.8423e+05, 3.8429e+05, 3.8921e+05, 3.9035e+05, 3.9132e+05,
        4.0771e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384197.3438, 384199.7500, 384213.1250, 384224.0625,
        384238.0312, 384238.1250, 384239.0625, 384250.3438, 384260.2812,
        384286.0625, 384287.3125, 756190.2500, 756443.6875, 761425.8125,
        780587.5000, 781314.8750, 781345.5000, 787506.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 379289.7500, 379292.7188, 379294.7500, 379304.9375,
        379312.0312, 379312.2188, 379314.2500, 379314.7500, 379316.4688,
        379340.0000, 379369.2188, 745166.5625, 756190.2500, 763176.0000,
        768363.4375, 775446.3125, 785552.5000, 799586.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5305e+00, 1.5566e+00, 1.5669e+00, 1.5680e+00, 1.5982e+00,
        1.6260e+00, 1.6427e+00, 1.7178e+00, 1.8327e+00, 1.8516e+00, 3.7929e+05,
        3.8244e+05, 3.8419e+05, 3.8422e+05, 3.8919e+05, 3.9037e+05, 3.9128e+05,
        4.0769e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5135e+00, 1.5305e+00, 1.5380e+00, 1.5983e+00, 1.6360e+00,
        1.6435e+00, 1.6761e+00, 1.6932e+00, 1.6946e+00, 1.7500e+00, 3.7931e+05,
        3.8240e+05, 3.8419e+05, 3.8424e+05, 3.8920e+05, 3.9040e+05, 3.9128e+05,
        4.0770e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 389167.0000, 389183.1875, 389183.4375, 389185.5312,
        389195.5000, 389196.9688, 389206.5312, 389210.0000, 389214.7812,
        389215.8750, 389217.1562, 761425.8125, 765543.5000, 773988.1250,
        785552.5000, 790185.2500, 794956.1250, 797702.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 407683.5625, 407685.9688, 407699.0000, 407703.4375,
        407704.6562, 407710.1250, 407716.6562, 407719.0625, 407720.0625,
        407726.3750, 407738.1562, 781345.5000, 793150.2500, 793918.2500,
        794956.1250, 799586.1875, 801455.9375, 813279.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 390297.4062, 390322.3125, 390327.3750, 390336.5000,
        390340.3438, 390341.0938, 390341.2500, 390348.5312, 390354.9688,
        390368.3125, 390397.4688, 763176.0000, 776451.5000, 780335.6875,
        784390.4375, 787506.7500, 797702.3125, 813279.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5250e+00, 1.5291e+00, 1.5594e+00, 1.5982e+00, 1.6412e+00,
        1.6435e+00, 1.6517e+00, 1.7173e+00, 1.7329e+00, 1.8548e+00, 3.7930e+05,
        3.8241e+05, 3.8417e+05, 3.8424e+05, 3.8920e+05, 3.9032e+05, 3.9128e+05,
        4.0773e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5380e+00, 1.5700e+00, 1.6227e+00, 1.6500e+00, 1.6803e+00,
        1.7173e+00, 1.7297e+00, 1.7711e+00, 1.8516e+00, 1.8924e+00, 3.7934e+05,
        3.8243e+05, 3.8421e+05, 3.8421e+05, 3.8922e+05, 3.9034e+05, 3.9130e+05,
        4.0774e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391244.8438, 391273.8438, 391274.5312, 391282.6250,
        391282.9062, 391284.8125, 391296.8125, 391297.2500, 391300.8125,
        391305.2500, 391317.9688, 768363.4375, 774353.3750, 781314.8750,
        784390.4375, 785885.8750, 790185.2500, 793150.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384173.9375, 384186.0625, 384193.4375, 384194.5625,
        384198.9375, 384206.0000, 384211.3125, 384217.3438, 384223.0625,
        384225.2188, 384231.0312, 765543.5000, 771655.5625, 774353.3750,
        775446.3125, 776451.5000, 780587.5000, 801455.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5135e+00, 1.6412e+00, 1.6784e+00, 1.7178e+00, 1.7297e+00,
        1.7298e+00, 1.7455e+00, 1.7590e+00, 1.7702e+00, 1.8229e+00, 3.7931e+05,
        3.8246e+05, 3.8419e+05, 3.8424e+05, 3.8918e+05, 3.9034e+05, 3.9127e+05,
        4.0770e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5669e+00, 1.5827e+00, 1.6055e+00, 1.6360e+00, 1.6803e+00,
        1.6947e+00, 1.7329e+00, 1.7590e+00, 1.7658e+00, 1.8259e+00, 3.7932e+05,
        3.8240e+05, 3.8422e+05, 3.8425e+05, 3.8921e+05, 3.9034e+05, 3.9130e+05,
        4.0770e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382397.8750, 382402.5625, 382414.3750, 382427.9062,
        382430.2500, 382437.0625, 382438.0625, 382439.7812, 382443.6875,
        382450.4375, 382455.8438, 745166.5625, 756443.6875, 771655.5625,
        773988.1250, 780335.6875, 785885.8750, 793918.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5250e+00, 1.6427e+00, 1.6715e+00, 1.6761e+00, 1.7658e+00,
        1.8082e+00, 1.8229e+00, 1.8290e+00, 1.8924e+00, 1.9238e+00, 3.7929e+05,
        3.8243e+05, 3.8420e+05, 3.8420e+05, 3.8922e+05, 3.9030e+05, 3.9124e+05,
        4.0768e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5291e+00, 1.5566e+00, 1.5700e+00, 1.5827e+00, 1.5924e+00,
        1.6521e+00, 1.6715e+00, 1.6946e+00, 1.7298e+00, 1.8401e+00, 3.7931e+05,
        3.8244e+05, 3.8420e+05, 3.8423e+05, 3.8917e+05, 3.9033e+05, 3.9131e+05,
        4.0772e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34484.70', '34482.41', '34489.74', '384239.44', '379314.66', '34482.65', '34484.39', '389197.81', '407709.72', '390343.25', '34483.76', '34487.00', '391287.44', '384205.59', '34484.48', '34484.85', '382430.72', '34482.94', '34484.61']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 8, 6, 6, 6, 8, 8, 6, 6, 8, 8, 6, 8, 8]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0138s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:30...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:30, End: 2025-07-22 15:29:30)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 19, 1, 9, 20, 18, 8, 15, 4, 14, 11, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.8935e+00, 3.9470e+05, 1.7485e+00, 1.8831e+00, 3.9087e+05,
         3.9632e+05, 1.9224e+00, 3.7772e+05, 1.7796e+00, 3.7888e+05, 1.7649e+00,
         3.9026e+05, 1.8860e+00, 1.8075e+00],
        [1.8935e+00, 0.0000e+00, 3.9472e+05, 1.7902e+00, 1.7528e+00, 3.9084e+05,
         3.9629e+05, 1.7826e+00, 3.7775e+05, 1.7910e+00, 3.7886e+05, 1.8134e+00,
         3.9034e+05, 2.0288e+00, 1.9366e+00],
        [3.9470e+05, 3.9472e+05, 0.0000e+00, 3.9471e+05, 3.9470e+05, 7.7399e+05,
         7.9466e+05, 3.9464e+05, 7.8520e+05, 3.9474e+05, 7.8476e+05, 3.9469e+05,
         7.7259e+05, 3.9473e+05, 3.9472e+05],
        [1.7485e+00, 1.7902e+00, 3.9471e+05, 0.0000e+00, 1.6223e+00, 3.9091e+05,
         3.9632e+05, 1.8027e+00, 3.7770e+05, 1.7058e+00, 3.7890e+05, 1.7656e+00,
         3.9029e+05, 1.7121e+00, 1.7936e+00],
        [1.8831e+00, 1.7528e+00, 3.9470e+05, 1.6223e+00, 0.0000e+00, 3.9086e+05,
         3.9632e+05, 1.6725e+00, 3.7771e+05, 1.7540e+00, 3.7888e+05, 1.5412e+00,
         3.9029e+05, 1.7513e+00, 1.7902e+00],
        [3.9087e+05, 3.9084e+05, 7.7399e+05, 3.9091e+05, 3.9086e+05, 0.0000e+00,
         8.0460e+05, 3.9086e+05, 7.8937e+05, 3.9085e+05, 7.7837e+05, 3.9090e+05,
         7.8968e+05, 3.9089e+05, 3.9090e+05],
        [3.9632e+05, 3.9629e+05, 7.9466e+05, 3.9632e+05, 3.9632e+05, 8.0460e+05,
         0.0000e+00, 3.9630e+05, 7.5329e+05, 3.9631e+05, 7.8208e+05, 3.9637e+05,
         7.9881e+05, 3.9633e+05, 3.9629e+05],
        [1.9224e+00, 1.7826e+00, 3.9464e+05, 1.8027e+00, 1.6725e+00, 3.9086e+05,
         3.9630e+05, 0.0000e+00, 3.7770e+05, 1.7258e+00, 3.7888e+05, 1.7528e+00,
         3.9026e+05, 1.8268e+00, 1.8341e+00],
        [3.7772e+05, 3.7775e+05, 7.8520e+05, 3.7770e+05, 3.7771e+05, 7.8937e+05,
         7.5329e+05, 3.7770e+05, 0.0000e+00, 3.7768e+05, 7.7316e+05, 3.7772e+05,
         7.5169e+05, 3.7771e+05, 3.7770e+05],
        [1.7796e+00, 1.7910e+00, 3.9474e+05, 1.7058e+00, 1.7540e+00, 3.9085e+05,
         3.9631e+05, 1.7258e+00, 3.7768e+05, 0.0000e+00, 3.7887e+05, 1.7729e+00,
         3.9028e+05, 1.6348e+00, 1.7508e+00],
        [3.7888e+05, 3.7886e+05, 7.8476e+05, 3.7890e+05, 3.7888e+05, 7.7837e+05,
         7.8208e+05, 3.7888e+05, 7.7316e+05, 3.7887e+05, 0.0000e+00, 3.7889e+05,
         7.8967e+05, 3.7888e+05, 3.7889e+05],
        [1.7649e+00, 1.8134e+00, 3.9469e+05, 1.7656e+00, 1.5412e+00, 3.9090e+05,
         3.9637e+05, 1.7528e+00, 3.7772e+05, 1.7729e+00, 3.7889e+05, 0.0000e+00,
         3.9031e+05, 1.9469e+00, 1.8373e+00],
        [3.9026e+05, 3.9034e+05, 7.7259e+05, 3.9029e+05, 3.9029e+05, 7.8968e+05,
         7.9881e+05, 3.9026e+05, 7.5169e+05, 3.9028e+05, 7.8967e+05, 3.9031e+05,
         0.0000e+00, 3.9030e+05, 3.9033e+05],
        [1.8860e+00, 2.0288e+00, 3.9473e+05, 1.7121e+00, 1.7513e+00, 3.9089e+05,
         3.9633e+05, 1.8268e+00, 3.7771e+05, 1.6348e+00, 3.7888e+05, 1.9469e+00,
         3.9030e+05, 0.0000e+00, 1.7827e+00],
        [1.8075e+00, 1.9366e+00, 3.9472e+05, 1.7936e+00, 1.7902e+00, 3.9090e+05,
         3.9629e+05, 1.8341e+00, 3.7770e+05, 1.7508e+00, 3.7889e+05, 1.8373e+00,
         3.9033e+05, 1.7827e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7485e+00, 1.7649e+00, 1.7796e+00, 1.8075e+00, 1.8831e+00,
        1.8860e+00, 1.8935e+00, 1.9224e+00, 3.7772e+05, 3.7888e+05, 3.9026e+05,
        3.9087e+05, 3.9470e+05, 3.9632e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7528e+00, 1.7826e+00, 1.7902e+00, 1.7910e+00, 1.8134e+00,
        1.8935e+00, 1.9366e+00, 2.0288e+00, 3.7775e+05, 3.7886e+05, 3.9034e+05,
        3.9084e+05, 3.9472e+05, 3.9629e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394641.7188, 394688.9062, 394703.0000, 394703.5625,
        394710.5000, 394715.8125, 394724.1562, 394727.1250, 394743.5000,
        772590.9375, 773992.5000, 784758.7500, 785197.6250, 794656.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6223e+00, 1.7058e+00, 1.7121e+00, 1.7485e+00, 1.7656e+00,
        1.7902e+00, 1.7936e+00, 1.8027e+00, 3.7770e+05, 3.7890e+05, 3.9029e+05,
        3.9091e+05, 3.9471e+05, 3.9632e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5412e+00, 1.6223e+00, 1.6725e+00, 1.7513e+00, 1.7528e+00,
        1.7540e+00, 1.7902e+00, 1.8831e+00, 3.7771e+05, 3.7888e+05, 3.9029e+05,
        3.9086e+05, 3.9470e+05, 3.9632e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390838.2812, 390854.6875, 390861.1562, 390864.6875,
        390874.9375, 390890.2188, 390903.1875, 390904.9062, 390905.0625,
        773992.5000, 778372.5625, 789371.5000, 789684.9375, 804597.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396289.0938, 396290.6250, 396299.9375, 396310.8750,
        396319.4062, 396320.8438, 396323.2500, 396325.6250, 396367.7812,
        753292.5000, 782078.6250, 794656.6250, 798814.8750, 804597.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6725e+00, 1.7258e+00, 1.7528e+00, 1.7826e+00, 1.8027e+00,
        1.8268e+00, 1.8341e+00, 1.9224e+00, 3.7770e+05, 3.7888e+05, 3.9026e+05,
        3.9086e+05, 3.9464e+05, 3.9630e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 377683.7188, 377697.1875, 377698.2188, 377700.1562,
        377713.4375, 377714.6562, 377721.1875, 377724.9375, 377747.4375,
        751687.5625, 753292.5000, 773156.7500, 785197.6250, 789371.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6348e+00, 1.7058e+00, 1.7258e+00, 1.7508e+00, 1.7540e+00,
        1.7729e+00, 1.7796e+00, 1.7910e+00, 3.7768e+05, 3.7887e+05, 3.9028e+05,
        3.9085e+05, 3.9474e+05, 3.9631e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 378855.8750, 378872.8750, 378875.1250, 378876.0938,
        378878.2188, 378879.8750, 378890.4062, 378890.8750, 378902.5625,
        773156.7500, 778372.5625, 782078.6250, 784758.7500, 789674.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5412e+00, 1.7528e+00, 1.7649e+00, 1.7656e+00, 1.7729e+00,
        1.8134e+00, 1.8373e+00, 1.9469e+00, 3.7772e+05, 3.7889e+05, 3.9031e+05,
        3.9090e+05, 3.9469e+05, 3.9637e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390256.7500, 390257.5000, 390283.3750, 390289.1250,
        390294.5312, 390304.3125, 390310.8125, 390332.5000, 390336.5625,
        751687.5625, 772590.9375, 789674.0625, 789684.9375, 798814.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6348e+00, 1.7121e+00, 1.7513e+00, 1.7827e+00, 1.8268e+00,
        1.8860e+00, 1.9469e+00, 2.0288e+00, 3.7771e+05, 3.7888e+05, 3.9030e+05,
        3.9089e+05, 3.9473e+05, 3.9633e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7508e+00, 1.7827e+00, 1.7902e+00, 1.7936e+00, 1.8075e+00,
        1.8341e+00, 1.8373e+00, 1.9366e+00, 3.7770e+05, 3.7889e+05, 3.9033e+05,
        3.9090e+05, 3.9472e+05, 3.9629e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['41971.07', '41973.58', '394706.47', '41968.02', '41969.82', '390877.47', '396316.38', '41967.95', '377711.19', '41966.41', '378880.22', '41970.60', '390296.16', '41969.77', '41968.30']
estimated f for each client, fs: [6, 6, 4, 6, 6, 4, 4, 6, 4, 6, 5, 6, 4, 6, 6]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 19, 1, 9, 20, 18, 8, 15, 4, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0098s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:31...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:31, End: 2025-07-22 15:29:31)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.8133e+00, 1.9433e+00, 3.9856e+05, 4.0673e+05, 1.7715e+00,
         3.9390e+05, 3.7826e+05, 2.0817e+00, 3.8283e+05, 1.7874e+00, 1.7477e+00,
         3.8952e+05, 3.9716e+05, 1.7955e+00, 1.8272e+00, 3.8187e+05, 1.7819e+00],
        [1.8133e+00, 0.0000e+00, 1.6424e+00, 3.9857e+05, 4.0676e+05, 1.7645e+00,
         3.9385e+05, 3.7831e+05, 1.8261e+00, 3.8277e+05, 1.7007e+00, 1.7869e+00,
         3.8950e+05, 3.9718e+05, 1.8181e+00, 1.7055e+00, 3.8187e+05, 1.8359e+00],
        [1.9433e+00, 1.6424e+00, 0.0000e+00, 3.9860e+05, 4.0679e+05, 1.8061e+00,
         3.9389e+05, 3.7829e+05, 1.7307e+00, 3.8280e+05, 1.6814e+00, 1.5836e+00,
         3.8951e+05, 3.9717e+05, 1.7490e+00, 1.7216e+00, 3.8185e+05, 1.8933e+00],
        [3.9856e+05, 3.9857e+05, 3.9860e+05, 0.0000e+00, 8.1998e+05, 3.9858e+05,
         7.7956e+05, 7.7215e+05, 3.9858e+05, 7.8026e+05, 3.9859e+05, 3.9859e+05,
         7.7375e+05, 7.8381e+05, 3.9858e+05, 3.9856e+05, 7.6471e+05, 3.9856e+05],
        [4.0673e+05, 4.0676e+05, 4.0679e+05, 8.1998e+05, 0.0000e+00, 4.0672e+05,
         7.9320e+05, 7.8138e+05, 4.0680e+05, 7.8378e+05, 4.0675e+05, 4.0677e+05,
         7.9721e+05, 8.2962e+05, 4.0678e+05, 4.0678e+05, 7.8119e+05, 4.0675e+05],
        [1.7715e+00, 1.7645e+00, 1.8061e+00, 3.9858e+05, 4.0672e+05, 0.0000e+00,
         3.9391e+05, 3.7830e+05, 1.8404e+00, 3.8280e+05, 1.7609e+00, 1.8630e+00,
         3.8949e+05, 3.9714e+05, 1.7339e+00, 1.6425e+00, 3.8185e+05, 1.7698e+00],
        [3.9390e+05, 3.9385e+05, 3.9389e+05, 7.7956e+05, 7.9320e+05, 3.9391e+05,
         0.0000e+00, 7.7469e+05, 3.9387e+05, 7.7347e+05, 3.9391e+05, 3.9390e+05,
         8.0287e+05, 8.0617e+05, 3.9387e+05, 3.9387e+05, 7.8411e+05, 3.9388e+05],
        [3.7826e+05, 3.7831e+05, 3.7829e+05, 7.7215e+05, 7.8138e+05, 3.7830e+05,
         7.7469e+05, 0.0000e+00, 3.7832e+05, 7.8337e+05, 3.7826e+05, 3.7831e+05,
         7.7555e+05, 7.4718e+05, 3.7830e+05, 3.7827e+05, 7.6953e+05, 3.7831e+05],
        [2.0817e+00, 1.8261e+00, 1.7307e+00, 3.9858e+05, 4.0680e+05, 1.8404e+00,
         3.9387e+05, 3.7832e+05, 0.0000e+00, 3.8278e+05, 1.8206e+00, 1.7327e+00,
         3.8948e+05, 3.9721e+05, 1.8618e+00, 1.7043e+00, 3.8189e+05, 1.8814e+00],
        [3.8283e+05, 3.8277e+05, 3.8280e+05, 7.8026e+05, 7.8378e+05, 3.8280e+05,
         7.7347e+05, 7.8337e+05, 3.8278e+05, 0.0000e+00, 3.8280e+05, 3.8278e+05,
         7.5240e+05, 7.9444e+05, 3.8280e+05, 3.8280e+05, 7.5872e+05, 3.8282e+05],
        [1.7874e+00, 1.7007e+00, 1.6814e+00, 3.9859e+05, 4.0675e+05, 1.7609e+00,
         3.9391e+05, 3.7826e+05, 1.8206e+00, 3.8280e+05, 0.0000e+00, 1.7898e+00,
         3.8953e+05, 3.9722e+05, 1.7459e+00, 1.8343e+00, 3.8190e+05, 1.8143e+00],
        [1.7477e+00, 1.7869e+00, 1.5836e+00, 3.9859e+05, 4.0677e+05, 1.8630e+00,
         3.9390e+05, 3.7831e+05, 1.7327e+00, 3.8278e+05, 1.7898e+00, 0.0000e+00,
         3.8952e+05, 3.9721e+05, 1.8242e+00, 1.6655e+00, 3.8186e+05, 1.6405e+00],
        [3.8952e+05, 3.8950e+05, 3.8951e+05, 7.7375e+05, 7.9721e+05, 3.8949e+05,
         8.0287e+05, 7.7555e+05, 3.8948e+05, 7.5240e+05, 3.8953e+05, 3.8952e+05,
         0.0000e+00, 7.9731e+05, 3.8952e+05, 3.8950e+05, 7.9185e+05, 3.8950e+05],
        [3.9716e+05, 3.9718e+05, 3.9717e+05, 7.8381e+05, 8.2962e+05, 3.9714e+05,
         8.0617e+05, 7.4718e+05, 3.9721e+05, 7.9444e+05, 3.9722e+05, 3.9721e+05,
         7.9731e+05, 0.0000e+00, 3.9720e+05, 3.9717e+05, 7.5814e+05, 3.9717e+05],
        [1.7955e+00, 1.8181e+00, 1.7490e+00, 3.9858e+05, 4.0678e+05, 1.7339e+00,
         3.9387e+05, 3.7830e+05, 1.8618e+00, 3.8280e+05, 1.7459e+00, 1.8242e+00,
         3.8952e+05, 3.9720e+05, 0.0000e+00, 1.7333e+00, 3.8186e+05, 1.8330e+00],
        [1.8272e+00, 1.7055e+00, 1.7216e+00, 3.9856e+05, 4.0678e+05, 1.6425e+00,
         3.9387e+05, 3.7827e+05, 1.7043e+00, 3.8280e+05, 1.8343e+00, 1.6655e+00,
         3.8950e+05, 3.9717e+05, 1.7333e+00, 0.0000e+00, 3.8193e+05, 1.6643e+00],
        [3.8187e+05, 3.8187e+05, 3.8185e+05, 7.6471e+05, 7.8119e+05, 3.8185e+05,
         7.8411e+05, 7.6953e+05, 3.8189e+05, 7.5872e+05, 3.8190e+05, 3.8186e+05,
         7.9185e+05, 7.5814e+05, 3.8186e+05, 3.8193e+05, 0.0000e+00, 3.8189e+05],
        [1.7819e+00, 1.8359e+00, 1.8933e+00, 3.9856e+05, 4.0675e+05, 1.7698e+00,
         3.9388e+05, 3.7831e+05, 1.8814e+00, 3.8282e+05, 1.8143e+00, 1.6405e+00,
         3.8950e+05, 3.9717e+05, 1.8330e+00, 1.6643e+00, 3.8189e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7477e+00, 1.7715e+00, 1.7819e+00, 1.7874e+00, 1.7955e+00,
        1.8133e+00, 1.8272e+00, 1.9433e+00, 2.0817e+00, 3.7826e+05, 3.8187e+05,
        3.8283e+05, 3.8952e+05, 3.9390e+05, 3.9716e+05, 3.9856e+05, 4.0673e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6424e+00, 1.7007e+00, 1.7055e+00, 1.7645e+00, 1.7869e+00,
        1.8133e+00, 1.8181e+00, 1.8261e+00, 1.8359e+00, 3.7831e+05, 3.8187e+05,
        3.8277e+05, 3.8950e+05, 3.9385e+05, 3.9718e+05, 3.9857e+05, 4.0676e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5836e+00, 1.6424e+00, 1.6814e+00, 1.7216e+00, 1.7307e+00,
        1.7490e+00, 1.8061e+00, 1.8933e+00, 1.9433e+00, 3.7829e+05, 3.8185e+05,
        3.8280e+05, 3.8951e+05, 3.9389e+05, 3.9717e+05, 3.9860e+05, 4.0679e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398560.2188, 398564.5625, 398564.8750, 398572.0312,
        398576.7500, 398580.0000, 398580.0625, 398588.9062, 398593.4375,
        398600.5625, 764708.1250, 772146.1250, 773754.5625, 779563.8125,
        780255.3125, 783811.1875, 819975.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 406722.9688, 406732.4375, 406746.0938, 406748.1562,
        406759.0938, 406768.4688, 406780.2500, 406783.4375, 406788.9375,
        406798.0000, 781192.1875, 781376.8750, 783782.3750, 793203.1875,
        797209.6250, 819975.0000, 829619.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6425e+00, 1.7339e+00, 1.7609e+00, 1.7645e+00, 1.7698e+00,
        1.7715e+00, 1.8061e+00, 1.8404e+00, 1.8630e+00, 3.7830e+05, 3.8185e+05,
        3.8280e+05, 3.8949e+05, 3.9391e+05, 3.9714e+05, 3.9858e+05, 4.0672e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393854.1250, 393866.5938, 393872.8750, 393873.8125,
        393883.7188, 393891.9688, 393895.2500, 393904.4062, 393908.2188,
        393913.8125, 773472.5000, 774689.1250, 779563.8125, 784106.8750,
        793203.1875, 802870.0000, 806172.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 378261.3125, 378263.6250, 378271.8750, 378290.6875,
        378300.0000, 378304.9062, 378306.0312, 378310.4688, 378311.0312,
        378321.8750, 747175.0000, 769532.5625, 772146.1250, 774689.1250,
        775550.1250, 781376.8750, 783371.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7043e+00, 1.7307e+00, 1.7327e+00, 1.8206e+00, 1.8261e+00,
        1.8404e+00, 1.8618e+00, 1.8814e+00, 2.0817e+00, 3.7832e+05, 3.8189e+05,
        3.8278e+05, 3.8948e+05, 3.9387e+05, 3.9721e+05, 3.9858e+05, 4.0680e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382769.9688, 382776.1562, 382777.2188, 382795.2500,
        382797.1875, 382797.6875, 382800.7812, 382801.0938, 382820.0938,
        382831.1562, 752399.3750, 758719.2500, 773472.5000, 780255.3125,
        783371.6250, 783782.3750, 794437.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6814e+00, 1.7007e+00, 1.7459e+00, 1.7609e+00, 1.7874e+00,
        1.7898e+00, 1.8143e+00, 1.8206e+00, 1.8343e+00, 3.7826e+05, 3.8190e+05,
        3.8280e+05, 3.8953e+05, 3.9391e+05, 3.9722e+05, 3.9859e+05, 4.0675e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5836e+00, 1.6405e+00, 1.6655e+00, 1.7327e+00, 1.7477e+00,
        1.7869e+00, 1.7898e+00, 1.8242e+00, 1.8630e+00, 3.7831e+05, 3.8186e+05,
        3.8278e+05, 3.8952e+05, 3.9390e+05, 3.9721e+05, 3.9859e+05, 4.0677e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 389482.3438, 389489.8750, 389495.4375, 389495.8125,
        389497.4688, 389505.4062, 389519.3125, 389523.1875, 389523.4062,
        389532.8125, 752399.3750, 773754.5625, 775550.1250, 791851.3750,
        797209.6250, 797311.4375, 802870.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397145.0000, 397162.4688, 397167.5625, 397170.2812,
        397174.3750, 397175.6562, 397200.7500, 397207.5625, 397214.5000,
        397220.6562, 747175.0000, 758142.8750, 783811.1875, 794437.3125,
        797311.4375, 806172.5000, 829619.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.7333e+00, 1.7339e+00, 1.7459e+00, 1.7490e+00, 1.7955e+00,
        1.8181e+00, 1.8242e+00, 1.8330e+00, 1.8618e+00, 3.7830e+05, 3.8186e+05,
        3.8280e+05, 3.8952e+05, 3.9387e+05, 3.9720e+05, 3.9858e+05, 4.0678e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6425e+00, 1.6643e+00, 1.6655e+00, 1.7043e+00, 1.7055e+00,
        1.7216e+00, 1.7333e+00, 1.8272e+00, 1.8343e+00, 3.7827e+05, 3.8193e+05,
        3.8280e+05, 3.8950e+05, 3.9387e+05, 3.9717e+05, 3.9856e+05, 4.0678e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 381851.9062, 381853.4062, 381855.3750, 381864.5938,
        381871.9375, 381874.8125, 381885.7188, 381886.9688, 381904.4375,
        381931.5312, 758142.8750, 758719.2500, 764708.1250, 769532.5625,
        781192.1875, 784106.8750, 791851.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6405e+00, 1.6643e+00, 1.7698e+00, 1.7819e+00, 1.8143e+00,
        1.8330e+00, 1.8359e+00, 1.8814e+00, 1.8933e+00, 3.7831e+05, 3.8189e+05,
        3.8282e+05, 3.8950e+05, 3.9388e+05, 3.9717e+05, 3.9856e+05, 4.0675e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['69105.00', '69108.98', '69105.44', '431862.66', '440801.81', '69106.16', '428394.25', '411828.78', '69111.27', '416396.91', '69107.41', '69107.40', '422496.72', '429001.22', '69107.79', '69110.80', '416083.94', '69109.91']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 6, 6, 8, 6, 8, 8, 6, 6, 8, 8, 6, 8]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0220s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:31...
global Accuracy on shared test data: 79.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 47 216]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:31, End: 2025-07-22 15:29:31)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (11): [5, 19, 17, 20, 18, 15, 13, 14, 11, 16, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
tensor([[0.0000e+00, 3.7043e+05, 3.9276e+05, 3.9084e+05, 3.7202e+05, 3.9440e+05,
         3.9174e+05, 3.9371e+05, 1.7530e+00, 3.7026e+05, 1.7752e+00],
        [3.7043e+05, 0.0000e+00, 7.5010e+05, 7.7731e+05, 7.3542e+05, 7.4044e+05,
         7.5373e+05, 7.4869e+05, 3.7045e+05, 7.4768e+05, 3.7046e+05],
        [3.9276e+05, 7.5010e+05, 0.0000e+00, 7.8557e+05, 7.5518e+05, 7.8933e+05,
         7.9917e+05, 7.6430e+05, 3.9278e+05, 7.6607e+05, 3.9279e+05],
        [3.9084e+05, 7.7731e+05, 7.8557e+05, 0.0000e+00, 7.6199e+05, 7.8284e+05,
         7.7602e+05, 7.7871e+05, 3.9088e+05, 7.6656e+05, 3.9087e+05],
        [3.7202e+05, 7.3542e+05, 7.5518e+05, 7.6199e+05, 0.0000e+00, 7.5193e+05,
         7.6562e+05, 7.6659e+05, 3.7201e+05, 7.4268e+05, 3.7202e+05],
        [3.9440e+05, 7.4044e+05, 7.8933e+05, 7.8284e+05, 7.5193e+05, 0.0000e+00,
         7.7268e+05, 7.7552e+05, 3.9438e+05, 7.9890e+05, 3.9437e+05],
        [3.9174e+05, 7.5373e+05, 7.9917e+05, 7.7602e+05, 7.6562e+05, 7.7268e+05,
         0.0000e+00, 7.9339e+05, 3.9173e+05, 7.5135e+05, 3.9169e+05],
        [3.9371e+05, 7.4869e+05, 7.6430e+05, 7.7871e+05, 7.6659e+05, 7.7552e+05,
         7.9339e+05, 0.0000e+00, 3.9370e+05, 7.6632e+05, 3.9368e+05],
        [1.7530e+00, 3.7045e+05, 3.9278e+05, 3.9088e+05, 3.7201e+05, 3.9438e+05,
         3.9173e+05, 3.9370e+05, 0.0000e+00, 3.7027e+05, 1.7588e+00],
        [3.7026e+05, 7.4768e+05, 7.6607e+05, 7.6656e+05, 7.4268e+05, 7.9890e+05,
         7.5135e+05, 7.6632e+05, 3.7027e+05, 0.0000e+00, 3.7025e+05],
        [1.7752e+00, 3.7046e+05, 3.9279e+05, 3.9087e+05, 3.7202e+05, 3.9437e+05,
         3.9169e+05, 3.9368e+05, 1.7588e+00, 3.7025e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7530e+00, 1.7752e+00, 3.7026e+05, 3.7043e+05, 3.7202e+05,
        3.9084e+05, 3.9174e+05, 3.9276e+05, 3.9371e+05, 3.9440e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 370426.6562, 370450.2500, 370461.4062, 735419.7500,
        740437.0000, 747675.8750, 748687.8125, 750098.6250, 753733.7500,
        777314.2500])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 392761.9375, 392784.2500, 392787.9688, 750098.6250,
        755176.6250, 764301.7500, 766071.3750, 785570.1250, 789333.0000,
        799173.0000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 390842.8438, 390869.5625, 390884.6875, 761991.3125,
        766565.0000, 776019.0000, 777314.2500, 778712.8750, 782841.1250,
        785570.1250])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 372010.4688, 372016.6250, 372022.9688, 735419.7500,
        742676.3125, 751932.0625, 755176.6250, 761991.3125, 765618.6250,
        766589.2500])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 394370.5625, 394381.1562, 394400.6250, 740437.0000,
        751932.0625, 772675.6250, 775524.8750, 782841.1250, 789333.0000,
        798902.0000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 391689.5625, 391729.5000, 391737.3750, 751351.5000,
        753733.7500, 765618.6250, 772675.6250, 776019.0000, 793388.5625,
        799173.0000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 393684.4375, 393697.3750, 393714.4375, 748687.8125,
        764301.7500, 766318.6875, 766589.2500, 775524.8750, 778712.8750,
        793388.5625])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.7530e+00, 1.7588e+00, 3.7027e+05, 3.7045e+05, 3.7201e+05,
        3.9088e+05, 3.9173e+05, 3.9278e+05, 3.9370e+05, 3.9438e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 370248.5625, 370262.6875, 370271.6250, 742676.3125,
        747675.8750, 751351.5000, 766071.3750, 766318.6875, 766565.0000,
        798902.0000])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.7588e+00, 1.7752e+00, 3.7025e+05, 3.7046e+05, 3.7202e+05,
        3.9087e+05, 3.9169e+05, 3.9279e+05, 3.9368e+05, 3.9437e+05])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['270756.59', '583365.62', '601997.50', '607783.88', '585893.62', '603388.81', '602648.06', '603856.31', '270764.28', '588365.44', '270755.62']
estimated f for each client, fs: [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']], selected_client_indices: [5, 19, 17, 20, 18, 15, 13, 14, 11, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0110s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:32...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:32, End: 2025-07-22 15:29:32)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 17, 20, 18, 8, 15, 4, 3, 14, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.6677e+00, 1.9199e+00, 3.8832e+05, 3.8956e+05, 3.8586e+05,
         4.0066e+05, 1.9043e+00, 3.8152e+05, 1.6458e+00, 1.7108e+00, 4.0246e+05,
         1.8131e+00, 4.0156e+05, 1.6745e+00],
        [1.6677e+00, 0.0000e+00, 1.5823e+00, 3.8834e+05, 3.8956e+05, 3.8589e+05,
         4.0069e+05, 1.7055e+00, 3.8154e+05, 1.6048e+00, 1.6709e+00, 4.0248e+05,
         1.6089e+00, 4.0159e+05, 1.6952e+00],
        [1.9199e+00, 1.5823e+00, 0.0000e+00, 3.8830e+05, 3.8957e+05, 3.8589e+05,
         4.0066e+05, 1.7844e+00, 3.8152e+05, 1.6896e+00, 1.6602e+00, 4.0244e+05,
         1.6813e+00, 4.0162e+05, 1.8093e+00],
        [3.8832e+05, 3.8834e+05, 3.8830e+05, 0.0000e+00, 7.7777e+05, 7.6625e+05,
         7.8891e+05, 3.8834e+05, 7.4500e+05, 3.8832e+05, 3.8834e+05, 7.8086e+05,
         3.8831e+05, 7.9762e+05, 3.8831e+05],
        [3.8956e+05, 3.8956e+05, 3.8957e+05, 7.7777e+05, 0.0000e+00, 7.7714e+05,
         7.8827e+05, 3.8956e+05, 7.7545e+05, 3.8957e+05, 3.8959e+05, 7.8085e+05,
         3.8959e+05, 8.0881e+05, 3.8959e+05],
        [3.8586e+05, 3.8589e+05, 3.8589e+05, 7.6625e+05, 7.7714e+05, 0.0000e+00,
         7.9734e+05, 3.8592e+05, 7.6324e+05, 3.8590e+05, 3.8590e+05, 8.0700e+05,
         3.8591e+05, 7.7124e+05, 3.8591e+05],
        [4.0066e+05, 4.0069e+05, 4.0066e+05, 7.8891e+05, 7.8827e+05, 7.9734e+05,
         0.0000e+00, 4.0066e+05, 7.7751e+05, 4.0066e+05, 4.0069e+05, 7.9979e+05,
         4.0071e+05, 7.8131e+05, 4.0067e+05],
        [1.9043e+00, 1.7055e+00, 1.7844e+00, 3.8834e+05, 3.8956e+05, 3.8592e+05,
         4.0066e+05, 0.0000e+00, 3.8152e+05, 1.7164e+00, 1.8268e+00, 4.0249e+05,
         1.6449e+00, 4.0160e+05, 1.7634e+00],
        [3.8152e+05, 3.8154e+05, 3.8152e+05, 7.4500e+05, 7.7545e+05, 7.6324e+05,
         7.7751e+05, 3.8152e+05, 0.0000e+00, 3.8148e+05, 3.8154e+05, 7.6387e+05,
         3.8150e+05, 7.8330e+05, 3.8152e+05],
        [1.6458e+00, 1.6048e+00, 1.6896e+00, 3.8832e+05, 3.8957e+05, 3.8590e+05,
         4.0066e+05, 1.7164e+00, 3.8148e+05, 0.0000e+00, 1.7455e+00, 4.0248e+05,
         1.7578e+00, 4.0157e+05, 1.6573e+00],
        [1.7108e+00, 1.6709e+00, 1.6602e+00, 3.8834e+05, 3.8959e+05, 3.8590e+05,
         4.0069e+05, 1.8268e+00, 3.8154e+05, 1.7455e+00, 0.0000e+00, 4.0246e+05,
         1.6798e+00, 4.0156e+05, 1.6471e+00],
        [4.0246e+05, 4.0248e+05, 4.0244e+05, 7.8086e+05, 7.8085e+05, 8.0700e+05,
         7.9979e+05, 4.0249e+05, 7.6387e+05, 4.0248e+05, 4.0246e+05, 0.0000e+00,
         4.0244e+05, 8.1128e+05, 4.0244e+05],
        [1.8131e+00, 1.6089e+00, 1.6813e+00, 3.8831e+05, 3.8959e+05, 3.8591e+05,
         4.0071e+05, 1.6449e+00, 3.8150e+05, 1.7578e+00, 1.6798e+00, 4.0244e+05,
         0.0000e+00, 4.0160e+05, 1.7228e+00],
        [4.0156e+05, 4.0159e+05, 4.0162e+05, 7.9762e+05, 8.0881e+05, 7.7124e+05,
         7.8131e+05, 4.0160e+05, 7.8330e+05, 4.0157e+05, 4.0156e+05, 8.1128e+05,
         4.0160e+05, 0.0000e+00, 4.0160e+05],
        [1.6745e+00, 1.6952e+00, 1.8093e+00, 3.8831e+05, 3.8959e+05, 3.8591e+05,
         4.0067e+05, 1.7634e+00, 3.8152e+05, 1.6573e+00, 1.6471e+00, 4.0244e+05,
         1.7228e+00, 4.0160e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6458e+00, 1.6677e+00, 1.6745e+00, 1.7108e+00, 1.8131e+00,
        1.9043e+00, 1.9199e+00, 3.8152e+05, 3.8586e+05, 3.8832e+05, 3.8956e+05,
        4.0066e+05, 4.0156e+05, 4.0246e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5823e+00, 1.6048e+00, 1.6089e+00, 1.6677e+00, 1.6709e+00,
        1.6952e+00, 1.7055e+00, 3.8154e+05, 3.8589e+05, 3.8834e+05, 3.8956e+05,
        4.0069e+05, 4.0159e+05, 4.0248e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5823e+00, 1.6602e+00, 1.6813e+00, 1.6896e+00, 1.7844e+00,
        1.8093e+00, 1.9199e+00, 3.8152e+05, 3.8589e+05, 3.8830e+05, 3.8957e+05,
        4.0066e+05, 4.0162e+05, 4.0244e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388299.3750, 388311.5625, 388314.1250, 388318.4062,
        388322.5938, 388335.7500, 388337.7500, 388341.2812, 745003.3750,
        766246.0000, 777773.0000, 780857.5625, 788912.5625, 797617.6875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389555.6250, 389557.6875, 389564.1250, 389572.9375,
        389573.5625, 389586.7812, 389587.1562, 389588.6562, 775446.2500,
        777141.4375, 777773.0000, 780854.3750, 788273.5000, 808811.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 385863.8750, 385887.5625, 385888.5000, 385899.7188,
        385901.4062, 385908.2812, 385909.2812, 385917.8750, 763239.8750,
        766246.0000, 771243.1250, 777141.4375, 797343.8125, 806996.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400660.2500, 400660.6875, 400661.0000, 400663.6875,
        400669.3750, 400688.5000, 400689.6875, 400708.3125, 777508.1250,
        781314.4375, 788273.5000, 788912.5625, 797343.8125, 799790.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6449e+00, 1.7055e+00, 1.7164e+00, 1.7634e+00, 1.7844e+00,
        1.8268e+00, 1.9043e+00, 3.8152e+05, 3.8592e+05, 3.8834e+05, 3.8956e+05,
        4.0066e+05, 4.0160e+05, 4.0249e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 381477.9375, 381503.8438, 381518.5312, 381519.0625,
        381520.3750, 381522.9062, 381542.0312, 381543.1562, 745003.3750,
        763239.8750, 763870.2500, 775446.2500, 777508.1250, 783301.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6048e+00, 1.6458e+00, 1.6573e+00, 1.6896e+00, 1.7164e+00,
        1.7455e+00, 1.7578e+00, 3.8148e+05, 3.8590e+05, 3.8832e+05, 3.8957e+05,
        4.0066e+05, 4.0157e+05, 4.0248e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6471e+00, 1.6602e+00, 1.6709e+00, 1.6798e+00, 1.7108e+00,
        1.7455e+00, 1.8268e+00, 3.8154e+05, 3.8590e+05, 3.8834e+05, 3.8959e+05,
        4.0069e+05, 4.0156e+05, 4.0246e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 402435.4375, 402439.0625, 402444.6875, 402456.0938,
        402459.3750, 402475.2188, 402483.1875, 402494.5000, 763870.2500,
        780854.3750, 780857.5625, 799790.8125, 806996.5000, 811280.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6089e+00, 1.6449e+00, 1.6798e+00, 1.6813e+00, 1.7228e+00,
        1.7578e+00, 1.8131e+00, 3.8150e+05, 3.8591e+05, 3.8831e+05, 3.8959e+05,
        4.0071e+05, 4.0160e+05, 4.0244e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 401560.3438, 401562.1562, 401569.9375, 401586.3125,
        401595.1562, 401597.3125, 401599.1875, 401618.8125, 771243.1250,
        781314.4375, 783301.2500, 797617.6875, 808811.5625, 811280.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6471e+00, 1.6573e+00, 1.6745e+00, 1.6952e+00, 1.7228e+00,
        1.7634e+00, 1.8093e+00, 3.8152e+05, 3.8591e+05, 3.8831e+05, 3.8959e+05,
        4.0067e+05, 4.0160e+05, 4.0244e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['85266.14', '85271.47', '85268.91', '427953.81', '432448.09', '427824.03', '442545.50', '85272.57', '421905.72', '85265.69', '85272.62', '442617.59', '85269.45', '442659.16', '85270.98']
estimated f for each client, fs: [7, 7, 7, 5, 5, 5, 5, 7, 5, 7, 7, 5, 7, 5, 7]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 17, 20, 18, 8, 15, 4, 3, 14, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:32...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:32, End: 2025-07-22 15:29:32)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 17, 1, 9, 20, 18, 15, 4, 13, 14, 11, 10, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5057e+00, 1.6724e+00, 3.8208e+05, 1.6301e+00, 1.6654e+00,
         3.8790e+05, 3.9045e+05, 4.0590e+05, 1.5382e+00, 3.9656e+05, 3.7695e+05,
         1.5547e+00, 1.6372e+00, 1.7335e+00, 1.4134e+00],
        [1.5057e+00, 0.0000e+00, 1.4202e+00, 3.8209e+05, 1.4726e+00, 1.5273e+00,
         3.8791e+05, 3.9046e+05, 4.0586e+05, 1.6149e+00, 3.9658e+05, 3.7697e+05,
         1.5567e+00, 1.4790e+00, 1.6716e+00, 1.5179e+00],
        [1.6724e+00, 1.4202e+00, 0.0000e+00, 3.8210e+05, 1.5318e+00, 1.4465e+00,
         3.8792e+05, 3.9046e+05, 4.0584e+05, 1.5733e+00, 3.9661e+05, 3.7694e+05,
         1.5590e+00, 1.4890e+00, 1.6269e+00, 1.5532e+00],
        [3.8208e+05, 3.8209e+05, 3.8210e+05, 0.0000e+00, 3.8211e+05, 3.8206e+05,
         7.6039e+05, 7.4749e+05, 8.1962e+05, 3.8206e+05, 7.8405e+05, 7.4675e+05,
         3.8209e+05, 3.8206e+05, 3.8206e+05, 3.8204e+05],
        [1.6301e+00, 1.4726e+00, 1.5318e+00, 3.8211e+05, 0.0000e+00, 1.4327e+00,
         3.8794e+05, 3.9049e+05, 4.0587e+05, 1.6881e+00, 3.9659e+05, 3.7695e+05,
         1.4882e+00, 1.4368e+00, 1.4194e+00, 1.5396e+00],
        [1.6654e+00, 1.5273e+00, 1.4465e+00, 3.8206e+05, 1.4327e+00, 0.0000e+00,
         3.8792e+05, 3.9047e+05, 4.0589e+05, 1.5552e+00, 3.9657e+05, 3.7695e+05,
         1.4146e+00, 1.5081e+00, 1.6233e+00, 1.6063e+00],
        [3.8790e+05, 3.8791e+05, 3.8792e+05, 7.6039e+05, 3.8794e+05, 3.8792e+05,
         0.0000e+00, 7.9266e+05, 7.6780e+05, 3.8790e+05, 7.5558e+05, 7.5574e+05,
         3.8791e+05, 3.8792e+05, 3.8789e+05, 3.8793e+05],
        [3.9045e+05, 3.9046e+05, 3.9046e+05, 7.4749e+05, 3.9049e+05, 3.9047e+05,
         7.9266e+05, 0.0000e+00, 7.8202e+05, 3.9043e+05, 7.9434e+05, 7.5560e+05,
         3.9048e+05, 3.9046e+05, 3.9049e+05, 3.9046e+05],
        [4.0590e+05, 4.0586e+05, 4.0584e+05, 8.1962e+05, 4.0587e+05, 4.0589e+05,
         7.6780e+05, 7.8202e+05, 0.0000e+00, 4.0585e+05, 8.0379e+05, 7.8945e+05,
         4.0584e+05, 4.0588e+05, 4.0585e+05, 4.0586e+05],
        [1.5382e+00, 1.6149e+00, 1.5733e+00, 3.8206e+05, 1.6881e+00, 1.5552e+00,
         3.8790e+05, 3.9043e+05, 4.0585e+05, 0.0000e+00, 3.9660e+05, 3.7696e+05,
         1.5909e+00, 1.7347e+00, 1.7628e+00, 1.5205e+00],
        [3.9656e+05, 3.9658e+05, 3.9661e+05, 7.8405e+05, 3.9659e+05, 3.9657e+05,
         7.5558e+05, 7.9434e+05, 8.0379e+05, 3.9660e+05, 0.0000e+00, 7.7285e+05,
         3.9660e+05, 3.9661e+05, 3.9656e+05, 3.9657e+05],
        [3.7695e+05, 3.7697e+05, 3.7694e+05, 7.4675e+05, 3.7695e+05, 3.7695e+05,
         7.5574e+05, 7.5560e+05, 7.8945e+05, 3.7696e+05, 7.7285e+05, 0.0000e+00,
         3.7695e+05, 3.7695e+05, 3.7699e+05, 3.7695e+05],
        [1.5547e+00, 1.5567e+00, 1.5590e+00, 3.8209e+05, 1.4882e+00, 1.4146e+00,
         3.8791e+05, 3.9048e+05, 4.0584e+05, 1.5909e+00, 3.9660e+05, 3.7695e+05,
         0.0000e+00, 1.5292e+00, 1.7303e+00, 1.5538e+00],
        [1.6372e+00, 1.4790e+00, 1.4890e+00, 3.8206e+05, 1.4368e+00, 1.5081e+00,
         3.8792e+05, 3.9046e+05, 4.0588e+05, 1.7347e+00, 3.9661e+05, 3.7695e+05,
         1.5292e+00, 0.0000e+00, 1.6084e+00, 1.5223e+00],
        [1.7335e+00, 1.6716e+00, 1.6269e+00, 3.8206e+05, 1.4194e+00, 1.6233e+00,
         3.8789e+05, 3.9049e+05, 4.0585e+05, 1.7628e+00, 3.9656e+05, 3.7699e+05,
         1.7303e+00, 1.6084e+00, 0.0000e+00, 1.6190e+00],
        [1.4134e+00, 1.5179e+00, 1.5532e+00, 3.8204e+05, 1.5396e+00, 1.6063e+00,
         3.8793e+05, 3.9046e+05, 4.0586e+05, 1.5205e+00, 3.9657e+05, 3.7695e+05,
         1.5538e+00, 1.5223e+00, 1.6190e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4134e+00, 1.5057e+00, 1.5382e+00, 1.5547e+00, 1.6301e+00,
        1.6372e+00, 1.6654e+00, 1.6724e+00, 1.7335e+00, 3.7695e+05, 3.8208e+05,
        3.8790e+05, 3.9045e+05, 3.9656e+05, 4.0590e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4202e+00, 1.4726e+00, 1.4790e+00, 1.5057e+00, 1.5179e+00,
        1.5273e+00, 1.5567e+00, 1.6149e+00, 1.6716e+00, 3.7697e+05, 3.8209e+05,
        3.8791e+05, 3.9046e+05, 3.9658e+05, 4.0586e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4202e+00, 1.4465e+00, 1.4890e+00, 1.5318e+00, 1.5532e+00,
        1.5590e+00, 1.5733e+00, 1.6269e+00, 1.6724e+00, 3.7694e+05, 3.8210e+05,
        3.8792e+05, 3.9046e+05, 3.9661e+05, 4.0584e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382041.0938, 382055.5625, 382057.8125, 382062.3438,
        382062.4062, 382078.3438, 382091.2500, 382094.7812, 382104.6562,
        382105.9375, 746751.6250, 747485.3125, 760393.1250, 784047.7500,
        819624.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4194e+00, 1.4327e+00, 1.4368e+00, 1.4726e+00, 1.4882e+00,
        1.5318e+00, 1.5396e+00, 1.6301e+00, 1.6881e+00, 3.7695e+05, 3.8211e+05,
        3.8794e+05, 3.9049e+05, 3.9659e+05, 4.0587e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4146e+00, 1.4327e+00, 1.4465e+00, 1.5081e+00, 1.5273e+00,
        1.5552e+00, 1.6063e+00, 1.6233e+00, 1.6654e+00, 3.7695e+05, 3.8206e+05,
        3.8792e+05, 3.9047e+05, 3.9657e+05, 4.0589e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387887.1250, 387897.1562, 387902.1250, 387906.2812,
        387913.0625, 387920.4062, 387921.0938, 387924.0312, 387929.5000,
        387938.5625, 755579.7500, 755740.6875, 760393.1250, 767798.1875,
        792664.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390433.0625, 390449.6250, 390459.8750, 390462.1875,
        390463.1250, 390463.8125, 390470.3750, 390484.2812, 390486.3750,
        390493.7500, 747485.3125, 755602.1250, 782022.2500, 792664.9375,
        794336.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405843.3125, 405844.4375, 405847.0312, 405854.1875,
        405858.1250, 405858.9062, 405874.7500, 405882.3438, 405886.9062,
        405898.7500, 767798.1875, 782022.2500, 789452.0000, 803786.0000,
        819624.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5205e+00, 1.5382e+00, 1.5552e+00, 1.5733e+00, 1.5909e+00,
        1.6149e+00, 1.6881e+00, 1.7347e+00, 1.7628e+00, 3.7696e+05, 3.8206e+05,
        3.8790e+05, 3.9043e+05, 3.9660e+05, 4.0585e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396557.6875, 396561.6250, 396569.3438, 396573.0000,
        396579.5938, 396586.0625, 396601.1562, 396604.6875, 396605.1562,
        396606.5312, 755579.7500, 772853.0000, 784047.7500, 794336.9375,
        803786.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376941.2188, 376945.6875, 376948.8438, 376949.1875,
        376951.1562, 376951.3438, 376953.9375, 376958.9062, 376965.1250,
        376990.0000, 746751.6250, 755602.1250, 755740.6875, 772853.0000,
        789452.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4146e+00, 1.4882e+00, 1.5292e+00, 1.5538e+00, 1.5547e+00,
        1.5567e+00, 1.5590e+00, 1.5909e+00, 1.7303e+00, 3.7695e+05, 3.8209e+05,
        3.8791e+05, 3.9048e+05, 3.9660e+05, 4.0584e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4368e+00, 1.4790e+00, 1.4890e+00, 1.5081e+00, 1.5223e+00,
        1.5292e+00, 1.6084e+00, 1.6372e+00, 1.7347e+00, 3.7695e+05, 3.8206e+05,
        3.8792e+05, 3.9046e+05, 3.9661e+05, 4.0588e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4194e+00, 1.6084e+00, 1.6190e+00, 1.6233e+00, 1.6269e+00,
        1.6716e+00, 1.7303e+00, 1.7335e+00, 1.7628e+00, 3.7699e+05, 3.8206e+05,
        3.8789e+05, 3.9049e+05, 3.9656e+05, 4.0585e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4134e+00, 1.5179e+00, 1.5205e+00, 1.5223e+00, 1.5396e+00,
        1.5532e+00, 1.5538e+00, 1.6063e+00, 1.6190e+00, 3.7695e+05, 3.8204e+05,
        3.8793e+05, 3.9046e+05, 3.9657e+05, 4.0586e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37696.35', '37697.89', '37695.51', '382075.41', '37696.48', '37696.51', '387913.94', '390466.62', '405864.91', '37697.35', '396584.50', '376955.56', '37696.29', '37695.96', '37700.47', '37696.78']
estimated f for each client, fs: [6, 6, 6, 4, 6, 6, 4, 4, 4, 6, 4, 4, 6, 6, 6, 6]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 17, 1, 9, 20, 18, 15, 4, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0108s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:33...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:33, End: 2025-07-22 15:29:33)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.3753e+00, 1.7375e+00, 4.0009e+05, 3.9707e+05, 1.4576e+00,
         1.4769e+00, 3.9384e+05, 3.8011e+05, 1.5301e+00, 3.8788e+05, 1.3641e+00,
         1.3646e+00, 3.9824e+05, 3.6825e+05, 1.4076e+00, 3.9364e+05, 1.5865e+00,
         1.3427e+00],
        [1.3753e+00, 0.0000e+00, 1.6478e+00, 4.0007e+05, 3.9707e+05, 1.4320e+00,
         1.3742e+00, 3.9380e+05, 3.8012e+05, 1.4327e+00, 3.8786e+05, 1.4049e+00,
         1.4994e+00, 3.9826e+05, 3.6828e+05, 1.4243e+00, 3.9364e+05, 1.5483e+00,
         1.4154e+00],
        [1.7375e+00, 1.6478e+00, 0.0000e+00, 4.0011e+05, 3.9708e+05, 1.8612e+00,
         1.5778e+00, 3.9382e+05, 3.8015e+05, 1.7470e+00, 3.8787e+05, 1.5162e+00,
         1.6880e+00, 3.9828e+05, 3.6826e+05, 1.7051e+00, 3.9363e+05, 1.9840e+00,
         1.6667e+00],
        [4.0009e+05, 4.0007e+05, 4.0011e+05, 0.0000e+00, 8.0455e+05, 4.0012e+05,
         4.0009e+05, 7.9242e+05, 7.8675e+05, 4.0007e+05, 7.8267e+05, 4.0008e+05,
         4.0010e+05, 7.8382e+05, 7.6482e+05, 4.0008e+05, 8.1578e+05, 4.0014e+05,
         4.0011e+05],
        [3.9707e+05, 3.9707e+05, 3.9708e+05, 8.0455e+05, 0.0000e+00, 3.9709e+05,
         3.9706e+05, 7.6794e+05, 7.5318e+05, 3.9705e+05, 8.0511e+05, 3.9707e+05,
         3.9705e+05, 8.0855e+05, 7.6129e+05, 3.9706e+05, 8.0192e+05, 3.9708e+05,
         3.9706e+05],
        [1.4576e+00, 1.4320e+00, 1.8612e+00, 4.0012e+05, 3.9709e+05, 0.0000e+00,
         1.3365e+00, 3.9384e+05, 3.8012e+05, 1.4222e+00, 3.8790e+05, 1.4810e+00,
         1.5096e+00, 3.9824e+05, 3.6826e+05, 1.3645e+00, 3.9365e+05, 1.3413e+00,
         1.4195e+00],
        [1.4769e+00, 1.3742e+00, 1.5778e+00, 4.0009e+05, 3.9706e+05, 1.3365e+00,
         0.0000e+00, 3.9379e+05, 3.8011e+05, 1.3787e+00, 3.8788e+05, 1.3413e+00,
         1.3798e+00, 3.9827e+05, 3.6825e+05, 1.3027e+00, 3.9362e+05, 1.4282e+00,
         1.4375e+00],
        [3.9384e+05, 3.9380e+05, 3.9382e+05, 7.9242e+05, 7.6794e+05, 3.9384e+05,
         3.9379e+05, 0.0000e+00, 7.4771e+05, 3.9384e+05, 7.7679e+05, 3.9379e+05,
         3.9383e+05, 7.9072e+05, 7.5641e+05, 3.9383e+05, 7.8685e+05, 3.9383e+05,
         3.9378e+05],
        [3.8011e+05, 3.8012e+05, 3.8015e+05, 7.8675e+05, 7.5318e+05, 3.8012e+05,
         3.8011e+05, 7.4771e+05, 0.0000e+00, 3.8013e+05, 7.4707e+05, 3.8013e+05,
         3.8009e+05, 7.9560e+05, 7.4841e+05, 3.8012e+05, 7.7948e+05, 3.8014e+05,
         3.8011e+05],
        [1.5301e+00, 1.4327e+00, 1.7470e+00, 4.0007e+05, 3.9705e+05, 1.4222e+00,
         1.3787e+00, 3.9384e+05, 3.8013e+05, 0.0000e+00, 3.8788e+05, 1.4202e+00,
         1.4104e+00, 3.9826e+05, 3.6827e+05, 1.4657e+00, 3.9363e+05, 1.4079e+00,
         1.4548e+00],
        [3.8788e+05, 3.8786e+05, 3.8787e+05, 7.8267e+05, 8.0511e+05, 3.8790e+05,
         3.8788e+05, 7.7679e+05, 7.4707e+05, 3.8788e+05, 0.0000e+00, 3.8788e+05,
         3.8789e+05, 7.9499e+05, 7.6431e+05, 3.8788e+05, 7.8755e+05, 3.8789e+05,
         3.8789e+05],
        [1.3641e+00, 1.4049e+00, 1.5162e+00, 4.0008e+05, 3.9707e+05, 1.4810e+00,
         1.3413e+00, 3.9379e+05, 3.8013e+05, 1.4202e+00, 3.8788e+05, 0.0000e+00,
         1.4196e+00, 3.9827e+05, 3.6826e+05, 1.3436e+00, 3.9360e+05, 1.5650e+00,
         1.3082e+00],
        [1.3646e+00, 1.4994e+00, 1.6880e+00, 4.0010e+05, 3.9705e+05, 1.5096e+00,
         1.3798e+00, 3.9383e+05, 3.8009e+05, 1.4104e+00, 3.8789e+05, 1.4196e+00,
         0.0000e+00, 3.9825e+05, 3.6824e+05, 1.4918e+00, 3.9362e+05, 1.5484e+00,
         1.2840e+00],
        [3.9824e+05, 3.9826e+05, 3.9828e+05, 7.8382e+05, 8.0855e+05, 3.9824e+05,
         3.9827e+05, 7.9072e+05, 7.9560e+05, 3.9826e+05, 7.9499e+05, 3.9827e+05,
         3.9825e+05, 0.0000e+00, 7.5894e+05, 3.9825e+05, 8.1785e+05, 3.9826e+05,
         3.9825e+05],
        [3.6825e+05, 3.6828e+05, 3.6826e+05, 7.6482e+05, 7.6129e+05, 3.6826e+05,
         3.6825e+05, 7.5641e+05, 7.4841e+05, 3.6827e+05, 7.6431e+05, 3.6826e+05,
         3.6824e+05, 7.5894e+05, 0.0000e+00, 3.6824e+05, 7.6465e+05, 3.6823e+05,
         3.6826e+05],
        [1.4076e+00, 1.4243e+00, 1.7051e+00, 4.0008e+05, 3.9706e+05, 1.3645e+00,
         1.3027e+00, 3.9383e+05, 3.8012e+05, 1.4657e+00, 3.8788e+05, 1.3436e+00,
         1.4918e+00, 3.9825e+05, 3.6824e+05, 0.0000e+00, 3.9364e+05, 1.5054e+00,
         1.3787e+00],
        [3.9364e+05, 3.9364e+05, 3.9363e+05, 8.1578e+05, 8.0192e+05, 3.9365e+05,
         3.9362e+05, 7.8685e+05, 7.7948e+05, 3.9363e+05, 7.8755e+05, 3.9360e+05,
         3.9362e+05, 8.1785e+05, 7.6465e+05, 3.9364e+05, 0.0000e+00, 3.9367e+05,
         3.9360e+05],
        [1.5865e+00, 1.5483e+00, 1.9840e+00, 4.0014e+05, 3.9708e+05, 1.3413e+00,
         1.4282e+00, 3.9383e+05, 3.8014e+05, 1.4079e+00, 3.8789e+05, 1.5650e+00,
         1.5484e+00, 3.9826e+05, 3.6823e+05, 1.5054e+00, 3.9367e+05, 0.0000e+00,
         1.4503e+00],
        [1.3427e+00, 1.4154e+00, 1.6667e+00, 4.0011e+05, 3.9706e+05, 1.4195e+00,
         1.4375e+00, 3.9378e+05, 3.8011e+05, 1.4548e+00, 3.8789e+05, 1.3082e+00,
         1.2840e+00, 3.9825e+05, 3.6826e+05, 1.3787e+00, 3.9360e+05, 1.4503e+00,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3427e+00, 1.3641e+00, 1.3646e+00, 1.3753e+00, 1.4076e+00,
        1.4576e+00, 1.4769e+00, 1.5301e+00, 1.5865e+00, 1.7375e+00, 3.6825e+05,
        3.8011e+05, 3.8788e+05, 3.9364e+05, 3.9384e+05, 3.9707e+05, 3.9824e+05,
        4.0009e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3742e+00, 1.3753e+00, 1.4049e+00, 1.4154e+00, 1.4243e+00,
        1.4320e+00, 1.4327e+00, 1.4994e+00, 1.5483e+00, 1.6478e+00, 3.6828e+05,
        3.8012e+05, 3.8786e+05, 3.9364e+05, 3.9380e+05, 3.9707e+05, 3.9826e+05,
        4.0007e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5162e+00, 1.5778e+00, 1.6478e+00, 1.6667e+00, 1.6880e+00,
        1.7051e+00, 1.7375e+00, 1.7470e+00, 1.8612e+00, 1.9840e+00, 3.6826e+05,
        3.8015e+05, 3.8787e+05, 3.9363e+05, 3.9382e+05, 3.9708e+05, 3.9828e+05,
        4.0011e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 400066.9688, 400069.9688, 400075.4688, 400081.6562,
        400086.3750, 400087.9375, 400100.5312, 400108.0938, 400114.1562,
        400117.0312, 400137.0000, 764820.1250, 782669.9375, 783822.8125,
        786749.2500, 792420.8750, 804552.5000, 815778.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397047.6875, 397048.4062, 397059.7812, 397060.3750,
        397060.8750, 397072.6875, 397073.7812, 397074.7500, 397075.0000,
        397082.5000, 397088.2500, 753181.9375, 761292.4375, 767939.2500,
        801920.1250, 804552.5000, 805114.0625, 808549.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3365e+00, 1.3413e+00, 1.3645e+00, 1.4195e+00, 1.4222e+00,
        1.4320e+00, 1.4576e+00, 1.4810e+00, 1.5096e+00, 1.8612e+00, 3.6826e+05,
        3.8012e+05, 3.8790e+05, 3.9365e+05, 3.9384e+05, 3.9709e+05, 3.9824e+05,
        4.0012e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3027e+00, 1.3365e+00, 1.3413e+00, 1.3742e+00, 1.3787e+00,
        1.3798e+00, 1.4282e+00, 1.4375e+00, 1.4769e+00, 1.5778e+00, 3.6825e+05,
        3.8011e+05, 3.8788e+05, 3.9362e+05, 3.9379e+05, 3.9706e+05, 3.9827e+05,
        4.0009e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393783.4688, 393789.5625, 393791.0625, 393802.4375,
        393820.3750, 393827.9375, 393828.4688, 393829.0625, 393839.0000,
        393839.4375, 393840.7500, 747710.7500, 756411.6875, 767939.2500,
        776794.9375, 786845.7500, 790719.6875, 792420.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 380093.5625, 380106.3125, 380112.8125, 380114.0625,
        380119.0938, 380121.7812, 380121.9062, 380125.1875, 380130.1875,
        380141.5625, 380149.5625, 747069.6250, 747710.7500, 748408.9375,
        753181.9375, 779482.6875, 786749.2500, 795595.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3787e+00, 1.4079e+00, 1.4104e+00, 1.4202e+00, 1.4222e+00,
        1.4327e+00, 1.4548e+00, 1.4657e+00, 1.5301e+00, 1.7470e+00, 3.6827e+05,
        3.8013e+05, 3.8788e+05, 3.9363e+05, 3.9384e+05, 3.9705e+05, 3.9826e+05,
        4.0007e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387861.6875, 387870.0938, 387875.4375, 387877.4375,
        387877.6875, 387880.2188, 387884.2500, 387892.1875, 387894.0312,
        387894.2188, 387899.9062, 747069.6250, 764311.5625, 776794.9375,
        782669.9375, 787546.4375, 794994.2500, 805114.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3082e+00, 1.3413e+00, 1.3436e+00, 1.3641e+00, 1.4049e+00,
        1.4196e+00, 1.4202e+00, 1.4810e+00, 1.5162e+00, 1.5650e+00, 3.6826e+05,
        3.8013e+05, 3.8788e+05, 3.9360e+05, 3.9379e+05, 3.9707e+05, 3.9827e+05,
        4.0008e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2840e+00, 1.3646e+00, 1.3798e+00, 1.4104e+00, 1.4196e+00,
        1.4918e+00, 1.4994e+00, 1.5096e+00, 1.5484e+00, 1.6880e+00, 3.6824e+05,
        3.8009e+05, 3.8789e+05, 3.9362e+05, 3.9383e+05, 3.9705e+05, 3.9825e+05,
        4.0010e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398239.5312, 398241.4688, 398246.1562, 398250.7500,
        398254.5938, 398255.5312, 398257.9375, 398259.7812, 398268.5000,
        398274.8750, 398275.3438, 758939.3125, 783822.8125, 790719.6875,
        794994.2500, 795595.9375, 808549.8125, 817846.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 368227.7812, 368238.6875, 368243.1250, 368247.1250,
        368252.8750, 368257.0000, 368259.5938, 368261.6875, 368262.5938,
        368265.7500, 368275.0938, 748408.9375, 756411.6875, 758939.3125,
        761292.4375, 764311.5625, 764646.6875, 764820.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3027e+00, 1.3436e+00, 1.3645e+00, 1.3787e+00, 1.4076e+00,
        1.4243e+00, 1.4657e+00, 1.4918e+00, 1.5054e+00, 1.7051e+00, 3.6824e+05,
        3.8012e+05, 3.8788e+05, 3.9364e+05, 3.9383e+05, 3.9706e+05, 3.9825e+05,
        4.0008e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393598.0625, 393598.3438, 393616.9375, 393618.1875,
        393628.0938, 393634.8125, 393637.3750, 393638.5000, 393639.3125,
        393648.8438, 393668.6562, 764646.6875, 779482.6875, 786845.7500,
        787546.4375, 801920.1250, 815778.5625, 817846.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3413e+00, 1.4079e+00, 1.4282e+00, 1.4503e+00, 1.5054e+00,
        1.5483e+00, 1.5484e+00, 1.5650e+00, 1.5865e+00, 1.9840e+00, 3.6823e+05,
        3.8014e+05, 3.8789e+05, 3.9367e+05, 3.9383e+05, 3.9708e+05, 3.9826e+05,
        4.0014e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2840e+00, 1.3082e+00, 1.3427e+00, 1.3787e+00, 1.4154e+00,
        1.4195e+00, 1.4375e+00, 1.4503e+00, 1.4548e+00, 1.6667e+00, 3.6826e+05,
        3.8011e+05, 3.8789e+05, 3.9360e+05, 3.9378e+05, 3.9706e+05, 3.9825e+05,
        4.0011e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['33478.34', '33480.88', '33479.98', '400095.03', '397067.66', '33479.24', '33478.80', '393817.41', '380121.47', '33480.04', '387882.47', '33479.62', '33477.97', '398256.75', '368253.75', '33477.55', '393629.72', '33476.65', '33479.43']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 8, 6, 6, 8, 6, 8, 8, 6, 7, 8, 6, 8, 8]
selected_index: 17
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Chosen Update']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0316s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:33...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:33, End: 2025-07-22 15:29:33)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.5492e+00, 1.7090e+00, 3.6763e+05, 4.0331e+05, 1.7293e+00,
         1.6047e+00, 3.9814e+05, 3.8892e+05, 1.7372e+00, 3.9513e+05, 1.5001e+00,
         1.5217e+00, 3.8139e+05, 1.5910e+00, 1.6888e+00, 3.9454e+05, 1.6965e+00],
        [1.5492e+00, 0.0000e+00, 1.6222e+00, 3.6765e+05, 4.0332e+05, 1.6581e+00,
         1.5777e+00, 3.9812e+05, 3.8894e+05, 1.6361e+00, 3.9513e+05, 1.5757e+00,
         1.6174e+00, 3.8137e+05, 1.6176e+00, 1.5489e+00, 3.9456e+05, 1.7318e+00],
        [1.7090e+00, 1.6222e+00, 0.0000e+00, 3.6767e+05, 4.0330e+05, 1.7973e+00,
         1.5672e+00, 3.9813e+05, 3.8891e+05, 1.7311e+00, 3.9512e+05, 1.4962e+00,
         1.6488e+00, 3.8142e+05, 1.6752e+00, 1.7370e+00, 3.9454e+05, 1.6637e+00],
        [3.6763e+05, 3.6765e+05, 3.6767e+05, 0.0000e+00, 7.6711e+05, 3.6765e+05,
         3.6764e+05, 7.7838e+05, 7.5017e+05, 3.6763e+05, 7.6858e+05, 3.6765e+05,
         3.6767e+05, 7.4792e+05, 3.6763e+05, 3.6766e+05, 7.6735e+05, 3.6764e+05],
        [4.0331e+05, 4.0332e+05, 4.0330e+05, 7.6711e+05, 0.0000e+00, 4.0332e+05,
         4.0328e+05, 7.9434e+05, 7.7842e+05, 4.0329e+05, 8.1510e+05, 4.0325e+05,
         4.0328e+05, 7.7506e+05, 4.0333e+05, 4.0329e+05, 7.9452e+05, 4.0328e+05],
        [1.7293e+00, 1.6581e+00, 1.7973e+00, 3.6765e+05, 4.0332e+05, 0.0000e+00,
         1.5248e+00, 3.9811e+05, 3.8892e+05, 1.6397e+00, 3.9509e+05, 1.6633e+00,
         1.7642e+00, 3.8139e+05, 1.5165e+00, 1.5081e+00, 3.9455e+05, 1.6590e+00],
        [1.6047e+00, 1.5777e+00, 1.5672e+00, 3.6764e+05, 4.0328e+05, 1.5248e+00,
         0.0000e+00, 3.9813e+05, 3.8893e+05, 1.6072e+00, 3.9513e+05, 1.5035e+00,
         1.5188e+00, 3.8140e+05, 1.4867e+00, 1.5616e+00, 3.9457e+05, 1.5760e+00],
        [3.9814e+05, 3.9812e+05, 3.9813e+05, 7.7838e+05, 7.9434e+05, 3.9811e+05,
         3.9813e+05, 0.0000e+00, 7.9089e+05, 3.9810e+05, 8.0592e+05, 3.9809e+05,
         3.9812e+05, 7.9767e+05, 3.9811e+05, 3.9813e+05, 8.0410e+05, 3.9811e+05],
        [3.8892e+05, 3.8894e+05, 3.8891e+05, 7.5017e+05, 7.7842e+05, 3.8892e+05,
         3.8893e+05, 7.9089e+05, 0.0000e+00, 3.8893e+05, 7.7565e+05, 3.8892e+05,
         3.8891e+05, 7.7918e+05, 3.8891e+05, 3.8896e+05, 7.7807e+05, 3.8892e+05],
        [1.7372e+00, 1.6361e+00, 1.7311e+00, 3.6763e+05, 4.0329e+05, 1.6397e+00,
         1.6072e+00, 3.9810e+05, 3.8893e+05, 0.0000e+00, 3.9507e+05, 1.5683e+00,
         1.5933e+00, 3.8142e+05, 1.6780e+00, 1.5029e+00, 3.9455e+05, 1.6541e+00],
        [3.9513e+05, 3.9513e+05, 3.9512e+05, 7.6858e+05, 8.1510e+05, 3.9509e+05,
         3.9513e+05, 8.0592e+05, 7.7565e+05, 3.9507e+05, 0.0000e+00, 3.9509e+05,
         3.9511e+05, 7.7722e+05, 3.9510e+05, 3.9508e+05, 7.5883e+05, 3.9507e+05],
        [1.5001e+00, 1.5757e+00, 1.4962e+00, 3.6765e+05, 4.0325e+05, 1.6633e+00,
         1.5035e+00, 3.9809e+05, 3.8892e+05, 1.5683e+00, 3.9509e+05, 0.0000e+00,
         1.5717e+00, 3.8139e+05, 1.5025e+00, 1.6501e+00, 3.9457e+05, 1.6097e+00],
        [1.5217e+00, 1.6174e+00, 1.6488e+00, 3.6767e+05, 4.0328e+05, 1.7642e+00,
         1.5188e+00, 3.9812e+05, 3.8891e+05, 1.5933e+00, 3.9511e+05, 1.5717e+00,
         0.0000e+00, 3.8139e+05, 1.6666e+00, 1.5680e+00, 3.9458e+05, 1.7262e+00],
        [3.8139e+05, 3.8137e+05, 3.8142e+05, 7.4792e+05, 7.7506e+05, 3.8139e+05,
         3.8140e+05, 7.9767e+05, 7.7918e+05, 3.8142e+05, 7.7722e+05, 3.8139e+05,
         3.8139e+05, 0.0000e+00, 3.8142e+05, 3.8142e+05, 7.9165e+05, 3.8140e+05],
        [1.5910e+00, 1.6176e+00, 1.6752e+00, 3.6763e+05, 4.0333e+05, 1.5165e+00,
         1.4867e+00, 3.9811e+05, 3.8891e+05, 1.6780e+00, 3.9510e+05, 1.5025e+00,
         1.6666e+00, 3.8142e+05, 0.0000e+00, 1.6116e+00, 3.9455e+05, 1.6955e+00],
        [1.6888e+00, 1.5489e+00, 1.7370e+00, 3.6766e+05, 4.0329e+05, 1.5081e+00,
         1.5616e+00, 3.9813e+05, 3.8896e+05, 1.5029e+00, 3.9508e+05, 1.6501e+00,
         1.5680e+00, 3.8142e+05, 1.6116e+00, 0.0000e+00, 3.9453e+05, 1.6667e+00],
        [3.9454e+05, 3.9456e+05, 3.9454e+05, 7.6735e+05, 7.9452e+05, 3.9455e+05,
         3.9457e+05, 8.0410e+05, 7.7807e+05, 3.9455e+05, 7.5883e+05, 3.9457e+05,
         3.9458e+05, 7.9165e+05, 3.9455e+05, 3.9453e+05, 0.0000e+00, 3.9454e+05],
        [1.6965e+00, 1.7318e+00, 1.6637e+00, 3.6764e+05, 4.0328e+05, 1.6590e+00,
         1.5760e+00, 3.9811e+05, 3.8892e+05, 1.6541e+00, 3.9507e+05, 1.6097e+00,
         1.7262e+00, 3.8140e+05, 1.6955e+00, 1.6667e+00, 3.9454e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5001e+00, 1.5217e+00, 1.5492e+00, 1.5910e+00, 1.6047e+00,
        1.6888e+00, 1.6965e+00, 1.7090e+00, 1.7293e+00, 1.7372e+00, 3.6763e+05,
        3.8139e+05, 3.8892e+05, 3.9454e+05, 3.9513e+05, 3.9814e+05, 4.0331e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5489e+00, 1.5492e+00, 1.5757e+00, 1.5777e+00, 1.6174e+00,
        1.6176e+00, 1.6222e+00, 1.6361e+00, 1.6581e+00, 1.7318e+00, 3.6765e+05,
        3.8137e+05, 3.8894e+05, 3.9456e+05, 3.9513e+05, 3.9812e+05, 4.0332e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4962e+00, 1.5672e+00, 1.6222e+00, 1.6488e+00, 1.6637e+00,
        1.6752e+00, 1.7090e+00, 1.7311e+00, 1.7370e+00, 1.7973e+00, 3.6767e+05,
        3.8142e+05, 3.8891e+05, 3.9454e+05, 3.9512e+05, 3.9813e+05, 4.0330e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 367628.5000, 367629.0938, 367633.6875, 367635.1562,
        367639.7500, 367649.7188, 367652.5938, 367654.6875, 367658.0000,
        367666.2812, 367669.5625, 747922.0625, 750166.6250, 767106.6250,
        767352.2500, 768577.1875, 778375.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 403250.6875, 403279.4375, 403281.0312, 403282.4375,
        403289.0938, 403291.0000, 403302.3125, 403305.8750, 403317.8750,
        403321.0000, 403334.5312, 767106.6250, 775064.0625, 778420.6250,
        794341.8125, 794523.0000, 815098.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5081e+00, 1.5165e+00, 1.5248e+00, 1.6397e+00, 1.6581e+00,
        1.6590e+00, 1.6633e+00, 1.7293e+00, 1.7642e+00, 1.7973e+00, 3.6765e+05,
        3.8139e+05, 3.8892e+05, 3.9455e+05, 3.9509e+05, 3.9811e+05, 4.0332e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4867e+00, 1.5035e+00, 1.5188e+00, 1.5248e+00, 1.5616e+00,
        1.5672e+00, 1.5760e+00, 1.5777e+00, 1.6047e+00, 1.6072e+00, 3.6764e+05,
        3.8140e+05, 3.8893e+05, 3.9457e+05, 3.9513e+05, 3.9813e+05, 4.0328e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398093.1562, 398101.1562, 398105.0938, 398112.6875,
        398113.2812, 398117.0312, 398119.0938, 398125.7500, 398130.9688,
        398131.4375, 398135.4375, 778375.5000, 790892.7500, 794341.8125,
        797668.8750, 804098.3125, 805917.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388907.4375, 388908.0938, 388912.4375, 388915.7812,
        388917.5312, 388921.1250, 388924.3125, 388925.0625, 388932.6875,
        388935.3125, 388956.8438, 750166.6250, 775647.9375, 778073.5000,
        778420.6250, 779175.5000, 790892.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5029e+00, 1.5683e+00, 1.5933e+00, 1.6072e+00, 1.6361e+00,
        1.6397e+00, 1.6541e+00, 1.6780e+00, 1.7311e+00, 1.7372e+00, 3.6763e+05,
        3.8142e+05, 3.8893e+05, 3.9455e+05, 3.9507e+05, 3.9810e+05, 4.0329e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395068.4375, 395071.8125, 395084.1875, 395086.0000,
        395094.1875, 395097.3750, 395110.9688, 395124.2812, 395125.9688,
        395128.3125, 395129.3438, 758827.1250, 768577.1875, 775647.9375,
        777216.1875, 805917.8125, 815098.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4962e+00, 1.5001e+00, 1.5025e+00, 1.5035e+00, 1.5683e+00,
        1.5717e+00, 1.5757e+00, 1.6097e+00, 1.6501e+00, 1.6633e+00, 3.6765e+05,
        3.8139e+05, 3.8892e+05, 3.9457e+05, 3.9509e+05, 3.9809e+05, 4.0325e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5188e+00, 1.5217e+00, 1.5680e+00, 1.5717e+00, 1.5933e+00,
        1.6174e+00, 1.6488e+00, 1.6666e+00, 1.7262e+00, 1.7642e+00, 3.6767e+05,
        3.8139e+05, 3.8891e+05, 3.9458e+05, 3.9511e+05, 3.9812e+05, 4.0328e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 381373.9375, 381385.6875, 381391.0625, 381393.9062,
        381394.0625, 381396.4062, 381404.7500, 381416.1875, 381419.8438,
        381422.3125, 381422.4062, 747922.0625, 775064.0625, 777216.1875,
        779175.5000, 791651.1875, 797668.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4867e+00, 1.5025e+00, 1.5165e+00, 1.5910e+00, 1.6116e+00,
        1.6176e+00, 1.6666e+00, 1.6752e+00, 1.6780e+00, 1.6955e+00, 3.6763e+05,
        3.8142e+05, 3.8891e+05, 3.9455e+05, 3.9510e+05, 3.9811e+05, 4.0333e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5029e+00, 1.5081e+00, 1.5489e+00, 1.5616e+00, 1.5680e+00,
        1.6116e+00, 1.6501e+00, 1.6667e+00, 1.6888e+00, 1.7370e+00, 3.6766e+05,
        3.8142e+05, 3.8896e+05, 3.9453e+05, 3.9508e+05, 3.9813e+05, 4.0329e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 394527.0938, 394536.4688, 394539.3125, 394541.8125,
        394547.3438, 394548.6250, 394551.0938, 394561.0625, 394565.2812,
        394567.0938, 394575.6562, 758827.1250, 767352.2500, 778073.5000,
        791651.1875, 794523.0000, 804098.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5760e+00, 1.6097e+00, 1.6541e+00, 1.6590e+00, 1.6637e+00,
        1.6667e+00, 1.6955e+00, 1.6965e+00, 1.7262e+00, 1.7318e+00, 3.6764e+05,
        3.8140e+05, 3.8892e+05, 3.9454e+05, 3.9507e+05, 3.9811e+05, 4.0328e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['33422.31', '33424.43', '33426.02', '367646.97', '403295.94', '33424.19', '33423.20', '398116.81', '388923.34', '33422.73', '395101.84', '33424.58', '33425.68', '381401.88', '33422.23', '33424.91', '394550.97', '33422.89']
estimated f for each client, fs: [7, 7, 7, 6, 5, 7, 7, 5, 5, 7, 5, 7, 7, 5, 7, 7, 5, 7]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0190s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:34...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 49 214]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:29:34, End: 2025-07-22 15:29:34)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 19, 17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.9384e+05, 3.9035e+05, 1.5153e+00, 1.4572e+00, 4.0296e+05,
         1.5203e+00, 1.3455e+00, 1.3862e+00, 3.8369e+05, 3.9011e+05, 1.5802e+00,
         1.5169e+00, 3.8848e+05, 1.3579e+00],
        [3.9384e+05, 0.0000e+00, 7.8183e+05, 3.9383e+05, 3.9385e+05, 7.8816e+05,
         3.9382e+05, 3.9383e+05, 3.9382e+05, 7.7945e+05, 7.8355e+05, 3.9386e+05,
         3.9385e+05, 7.9435e+05, 3.9381e+05],
        [3.9035e+05, 7.8183e+05, 0.0000e+00, 3.9033e+05, 3.9033e+05, 8.0626e+05,
         3.9033e+05, 3.9034e+05, 3.9038e+05, 7.6749e+05, 7.7004e+05, 3.9035e+05,
         3.9032e+05, 7.9793e+05, 3.9032e+05],
        [1.5153e+00, 3.9383e+05, 3.9033e+05, 0.0000e+00, 1.3596e+00, 4.0292e+05,
         1.4778e+00, 1.4915e+00, 1.5675e+00, 3.8370e+05, 3.9009e+05, 1.6766e+00,
         1.3328e+00, 3.8849e+05, 1.4997e+00],
        [1.4572e+00, 3.9385e+05, 3.9033e+05, 1.3596e+00, 0.0000e+00, 4.0293e+05,
         1.4310e+00, 1.3367e+00, 1.3406e+00, 3.8370e+05, 3.9007e+05, 1.4935e+00,
         1.3923e+00, 3.8844e+05, 1.4100e+00],
        [4.0296e+05, 7.8816e+05, 8.0626e+05, 4.0292e+05, 4.0293e+05, 0.0000e+00,
         4.0295e+05, 4.0294e+05, 4.0295e+05, 7.9046e+05, 7.8694e+05, 4.0293e+05,
         4.0295e+05, 8.0821e+05, 4.0293e+05],
        [1.5203e+00, 3.9382e+05, 3.9033e+05, 1.4778e+00, 1.4310e+00, 4.0295e+05,
         0.0000e+00, 1.4701e+00, 1.5066e+00, 3.8369e+05, 3.9009e+05, 1.7198e+00,
         1.3265e+00, 3.8844e+05, 1.4424e+00],
        [1.3455e+00, 3.9383e+05, 3.9034e+05, 1.4915e+00, 1.3367e+00, 4.0294e+05,
         1.4701e+00, 0.0000e+00, 1.4250e+00, 3.8369e+05, 3.9011e+05, 1.4256e+00,
         1.4715e+00, 3.8846e+05, 1.3622e+00],
        [1.3862e+00, 3.9382e+05, 3.9038e+05, 1.5675e+00, 1.3406e+00, 4.0295e+05,
         1.5066e+00, 1.4250e+00, 0.0000e+00, 3.8372e+05, 3.9009e+05, 1.6413e+00,
         1.4275e+00, 3.8847e+05, 1.3413e+00],
        [3.8369e+05, 7.7945e+05, 7.6749e+05, 3.8370e+05, 3.8370e+05, 7.9046e+05,
         3.8369e+05, 3.8369e+05, 3.8372e+05, 0.0000e+00, 7.6009e+05, 3.8372e+05,
         3.8369e+05, 7.8229e+05, 3.8370e+05],
        [3.9011e+05, 7.8355e+05, 7.7004e+05, 3.9009e+05, 3.9007e+05, 7.8694e+05,
         3.9009e+05, 3.9011e+05, 3.9009e+05, 7.6009e+05, 0.0000e+00, 3.9010e+05,
         3.9010e+05, 7.6407e+05, 3.9008e+05],
        [1.5802e+00, 3.9386e+05, 3.9035e+05, 1.6766e+00, 1.4935e+00, 4.0293e+05,
         1.7198e+00, 1.4256e+00, 1.6413e+00, 3.8372e+05, 3.9010e+05, 0.0000e+00,
         1.7744e+00, 3.8846e+05, 1.5520e+00],
        [1.5169e+00, 3.9385e+05, 3.9032e+05, 1.3328e+00, 1.3923e+00, 4.0295e+05,
         1.3265e+00, 1.4715e+00, 1.4275e+00, 3.8369e+05, 3.9010e+05, 1.7744e+00,
         0.0000e+00, 3.8848e+05, 1.3855e+00],
        [3.8848e+05, 7.9435e+05, 7.9793e+05, 3.8849e+05, 3.8844e+05, 8.0821e+05,
         3.8844e+05, 3.8846e+05, 3.8847e+05, 7.8229e+05, 7.6407e+05, 3.8846e+05,
         3.8848e+05, 0.0000e+00, 3.8847e+05],
        [1.3579e+00, 3.9381e+05, 3.9032e+05, 1.4997e+00, 1.4100e+00, 4.0293e+05,
         1.4424e+00, 1.3622e+00, 1.3413e+00, 3.8370e+05, 3.9008e+05, 1.5520e+00,
         1.3855e+00, 3.8847e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3455e+00, 1.3579e+00, 1.3862e+00, 1.4572e+00, 1.5153e+00,
        1.5169e+00, 1.5203e+00, 1.5802e+00, 3.8369e+05, 3.8848e+05, 3.9011e+05,
        3.9035e+05, 3.9384e+05, 4.0296e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393810.4688, 393820.9688, 393823.6875, 393827.3750,
        393829.1562, 393837.7812, 393852.6562, 393853.7500, 393857.1562,
        779451.9375, 781826.3125, 783548.3750, 788164.0625, 794351.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390320.3750, 390324.5312, 390328.1875, 390333.5000,
        390334.6250, 390336.1875, 390350.3750, 390353.9375, 390376.5000,
        767492.5000, 770038.2500, 781826.3125, 797931.3125, 806260.4375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3328e+00, 1.3596e+00, 1.4778e+00, 1.4915e+00, 1.4997e+00,
        1.5153e+00, 1.5675e+00, 1.6766e+00, 3.8370e+05, 3.8849e+05, 3.9009e+05,
        3.9033e+05, 3.9383e+05, 4.0292e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3367e+00, 1.3406e+00, 1.3596e+00, 1.3923e+00, 1.4100e+00,
        1.4310e+00, 1.4572e+00, 1.4935e+00, 3.8370e+05, 3.8844e+05, 3.9007e+05,
        3.9033e+05, 3.9385e+05, 4.0293e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 402916.5625, 402927.5312, 402933.3438, 402934.5625,
        402943.1562, 402948.8125, 402950.4375, 402950.8750, 402955.3750,
        786942.3750, 788164.0625, 790463.0000, 806260.4375, 808210.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3265e+00, 1.4310e+00, 1.4424e+00, 1.4701e+00, 1.4778e+00,
        1.5066e+00, 1.5203e+00, 1.7198e+00, 3.8369e+05, 3.8844e+05, 3.9009e+05,
        3.9033e+05, 3.9382e+05, 4.0295e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3367e+00, 1.3455e+00, 1.3622e+00, 1.4250e+00, 1.4256e+00,
        1.4701e+00, 1.4715e+00, 1.4915e+00, 3.8369e+05, 3.8846e+05, 3.9011e+05,
        3.9034e+05, 3.9383e+05, 4.0294e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3406e+00, 1.3413e+00, 1.3862e+00, 1.4250e+00, 1.4275e+00,
        1.5066e+00, 1.5675e+00, 1.6413e+00, 3.8372e+05, 3.8847e+05, 3.9009e+05,
        3.9038e+05, 3.9382e+05, 4.0295e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 383688.4062, 383688.4375, 383691.0625, 383692.3438,
        383695.7500, 383699.7500, 383703.9375, 383715.6562, 383718.7812,
        760088.1250, 767492.5000, 779451.9375, 782292.1875, 790463.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390066.2500, 390078.9062, 390087.5000, 390092.1875,
        390094.6250, 390095.0625, 390097.5312, 390106.0625, 390107.9375,
        760088.1250, 764067.8750, 770038.2500, 783548.3750, 786942.3750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4256e+00, 1.4935e+00, 1.5520e+00, 1.5802e+00, 1.6413e+00,
        1.6766e+00, 1.7198e+00, 1.7744e+00, 3.8372e+05, 3.8846e+05, 3.9010e+05,
        3.9035e+05, 3.9386e+05, 4.0293e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3265e+00, 1.3328e+00, 1.3855e+00, 1.3923e+00, 1.4275e+00,
        1.4715e+00, 1.5169e+00, 1.7744e+00, 3.8369e+05, 3.8848e+05, 3.9010e+05,
        3.9032e+05, 3.9385e+05, 4.0295e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388438.9062, 388444.5312, 388459.2188, 388464.5938,
        388466.8125, 388467.7188, 388479.8438, 388482.0312, 388491.9375,
        764067.8750, 782292.1875, 794351.0625, 797931.3125, 808210.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3413e+00, 1.3579e+00, 1.3622e+00, 1.3855e+00, 1.4100e+00,
        1.4424e+00, 1.4997e+00, 1.5520e+00, 3.8370e+05, 3.8847e+05, 3.9008e+05,
        3.9032e+05, 3.9381e+05, 4.0293e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['42633.35', '393834.81', '390339.81', '42635.09', '42634.55', '402940.03', '42633.80', '42633.30', '42636.37', '383699.38', '390091.81', '42636.86', '42633.63', '388466.16', '42634.12']
estimated f for each client, fs: [6, 4, 4, 6, 6, 4, 6, 6, 6, 4, 4, 6, 6, 4, 6]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 19, 17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0099s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:35...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:35, End: 2025-07-22 15:29:35)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 19, 17, 1, 20, 18, 15, 4, 3, 13, 11, 10, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.3636e+00, 3.8584e+05, 3.8785e+05, 1.3753e+00, 3.9702e+05,
         3.8936e+05, 3.8548e+05, 1.4526e+00, 1.3055e+00, 3.9057e+05, 1.2714e+00,
         1.3664e+00, 3.9182e+05],
        [1.3636e+00, 0.0000e+00, 3.8584e+05, 3.8786e+05, 1.3800e+00, 3.9709e+05,
         3.8937e+05, 3.8549e+05, 1.1934e+00, 1.2536e+00, 3.9052e+05, 1.1266e+00,
         1.3530e+00, 3.9179e+05],
        [3.8584e+05, 3.8584e+05, 0.0000e+00, 7.8670e+05, 3.8585e+05, 7.6784e+05,
         7.7220e+05, 7.6760e+05, 3.8584e+05, 3.8582e+05, 7.8922e+05, 3.8583e+05,
         3.8579e+05, 7.8954e+05],
        [3.8785e+05, 3.8786e+05, 7.8670e+05, 0.0000e+00, 3.8785e+05, 7.7064e+05,
         7.7529e+05, 7.8229e+05, 3.8788e+05, 3.8786e+05, 7.5797e+05, 3.8787e+05,
         3.8783e+05, 7.8443e+05],
        [1.3753e+00, 1.3800e+00, 3.8585e+05, 3.8785e+05, 0.0000e+00, 3.9707e+05,
         3.8938e+05, 3.8547e+05, 1.6550e+00, 1.3137e+00, 3.9054e+05, 1.3255e+00,
         1.1641e+00, 3.9180e+05],
        [3.9702e+05, 3.9709e+05, 7.6784e+05, 7.7064e+05, 3.9707e+05, 0.0000e+00,
         7.8203e+05, 7.5977e+05, 3.9707e+05, 3.9706e+05, 7.7962e+05, 3.9703e+05,
         3.9705e+05, 7.7437e+05],
        [3.8936e+05, 3.8937e+05, 7.7220e+05, 7.7529e+05, 3.8938e+05, 7.8203e+05,
         0.0000e+00, 7.7103e+05, 3.8938e+05, 3.8939e+05, 7.7281e+05, 3.8939e+05,
         3.8937e+05, 7.8351e+05],
        [3.8548e+05, 3.8549e+05, 7.6760e+05, 7.8229e+05, 3.8547e+05, 7.5977e+05,
         7.7103e+05, 0.0000e+00, 3.8549e+05, 3.8548e+05, 7.6856e+05, 3.8548e+05,
         3.8547e+05, 7.7049e+05],
        [1.4526e+00, 1.1934e+00, 3.8584e+05, 3.8788e+05, 1.6550e+00, 3.9707e+05,
         3.8938e+05, 3.8549e+05, 0.0000e+00, 1.5535e+00, 3.9055e+05, 1.2021e+00,
         1.6118e+00, 3.9177e+05],
        [1.3055e+00, 1.2536e+00, 3.8582e+05, 3.8786e+05, 1.3137e+00, 3.9706e+05,
         3.8939e+05, 3.8548e+05, 1.5535e+00, 0.0000e+00, 3.9054e+05, 1.3260e+00,
         1.2313e+00, 3.9180e+05],
        [3.9057e+05, 3.9052e+05, 7.8922e+05, 7.5797e+05, 3.9054e+05, 7.7962e+05,
         7.7281e+05, 7.6856e+05, 3.9055e+05, 3.9054e+05, 0.0000e+00, 3.9053e+05,
         3.9052e+05, 7.8470e+05],
        [1.2714e+00, 1.1266e+00, 3.8583e+05, 3.8787e+05, 1.3255e+00, 3.9703e+05,
         3.8939e+05, 3.8548e+05, 1.2021e+00, 1.3260e+00, 3.9053e+05, 0.0000e+00,
         1.3507e+00, 3.9181e+05],
        [1.3664e+00, 1.3530e+00, 3.8579e+05, 3.8783e+05, 1.1641e+00, 3.9705e+05,
         3.8937e+05, 3.8547e+05, 1.6118e+00, 1.2313e+00, 3.9052e+05, 1.3507e+00,
         0.0000e+00, 3.9180e+05],
        [3.9182e+05, 3.9179e+05, 7.8954e+05, 7.8443e+05, 3.9180e+05, 7.7437e+05,
         7.8351e+05, 7.7049e+05, 3.9177e+05, 3.9180e+05, 7.8470e+05, 3.9181e+05,
         3.9180e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2714e+00, 1.3055e+00, 1.3636e+00, 1.3664e+00, 1.3753e+00,
        1.4526e+00, 3.8548e+05, 3.8584e+05, 3.8785e+05, 3.8936e+05, 3.9057e+05,
        3.9182e+05, 3.9702e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1266e+00, 1.1934e+00, 1.2536e+00, 1.3530e+00, 1.3636e+00,
        1.3800e+00, 3.8549e+05, 3.8584e+05, 3.8786e+05, 3.8937e+05, 3.9052e+05,
        3.9179e+05, 3.9709e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 385786.6875, 385823.3750, 385830.9062, 385835.4062,
        385837.5312, 385844.5312, 385853.0938, 767595.8750, 767844.8750,
        772195.9375, 786703.3750, 789218.2500, 789544.3750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387833.7188, 387845.4688, 387847.1562, 387858.1875,
        387861.5000, 387869.8750, 387879.4688, 757967.3125, 770644.5000,
        775292.5000, 782291.3125, 784434.6250, 786703.3750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1641e+00, 1.3137e+00, 1.3255e+00, 1.3753e+00, 1.3800e+00,
        1.6550e+00, 3.8547e+05, 3.8585e+05, 3.8785e+05, 3.8938e+05, 3.9054e+05,
        3.9180e+05, 3.9707e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397024.1875, 397028.2500, 397049.9375, 397060.9062,
        397065.1562, 397072.2500, 397087.5938, 759772.5000, 767844.8750,
        770644.5000, 774369.4375, 779623.7500, 782027.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389356.5312, 389367.1250, 389368.2500, 389381.7812,
        389383.0625, 389388.8438, 389390.3438, 771026.3750, 772195.9375,
        772809.4375, 775292.5000, 782027.0625, 783512.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 385465.6875, 385466.0625, 385475.8438, 385479.5000,
        385484.2188, 385486.2188, 385490.1562, 759772.5000, 767595.8750,
        768556.5000, 770489.8125, 771026.3750, 782291.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1934e+00, 1.2021e+00, 1.4526e+00, 1.5535e+00, 1.6118e+00,
        1.6550e+00, 3.8549e+05, 3.8584e+05, 3.8788e+05, 3.8938e+05, 3.9055e+05,
        3.9177e+05, 3.9707e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2313e+00, 1.2536e+00, 1.3055e+00, 1.3137e+00, 1.3260e+00,
        1.5535e+00, 3.8548e+05, 3.8582e+05, 3.8786e+05, 3.8939e+05, 3.9054e+05,
        3.9180e+05, 3.9706e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390515.2500, 390519.0000, 390532.4375, 390536.9688,
        390538.5938, 390550.7500, 390566.3125, 757967.3125, 768556.5000,
        772809.4375, 779623.7500, 784696.5000, 789218.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1266e+00, 1.2021e+00, 1.2714e+00, 1.3255e+00, 1.3260e+00,
        1.3507e+00, 3.8548e+05, 3.8583e+05, 3.8787e+05, 3.8939e+05, 3.9053e+05,
        3.9181e+05, 3.9703e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1641e+00, 1.2313e+00, 1.3507e+00, 1.3530e+00, 1.3664e+00,
        1.6118e+00, 3.8547e+05, 3.8579e+05, 3.8783e+05, 3.8937e+05, 3.9052e+05,
        3.9180e+05, 3.9705e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391772.6875, 391793.4688, 391798.1562, 391798.2188,
        391800.1250, 391805.2500, 391824.5938, 770489.8125, 774369.4375,
        783512.6250, 784434.6250, 784696.5000, 789544.3750])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['128796.32', '128798.97', '470694.69', '471511.91', '128797.16', '478556.19', '474317.59', '469524.00', '128802.54', '128797.09', '473364.75', '128798.64', '128788.23', '476383.50']
estimated f for each client, fs: [7, 7, 4, 4, 7, 4, 4, 4, 7, 7, 4, 7, 7, 4]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']], selected_client_indices: [5, 2, 19, 17, 1, 20, 18, 15, 4, 3, 13, 11, 10, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0091s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:35...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[163  74]
 [ 47 216]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:35, End: 2025-07-22 15:29:35)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3762e+00, 3.8671e+05, 3.8545e+05, 1.4748e+00, 1.4439e+00,
         3.9254e+05, 1.4694e+00, 3.9583e+05, 1.3809e+00, 1.3872e+00, 3.7965e+05,
         3.8864e+05, 1.3881e+00, 1.4632e+00, 1.2630e+00],
        [1.3762e+00, 0.0000e+00, 3.8669e+05, 3.8547e+05, 1.4589e+00, 1.3645e+00,
         3.9253e+05, 1.3898e+00, 3.9586e+05, 1.4472e+00, 1.4500e+00, 3.7966e+05,
         3.8864e+05, 1.4172e+00, 1.4750e+00, 1.3131e+00],
        [3.8671e+05, 3.8669e+05, 0.0000e+00, 7.8368e+05, 3.8667e+05, 3.8669e+05,
         7.7366e+05, 3.8673e+05, 7.7174e+05, 3.8672e+05, 3.8670e+05, 7.6546e+05,
         8.0126e+05, 3.8669e+05, 3.8668e+05, 3.8670e+05],
        [3.8545e+05, 3.8547e+05, 7.8368e+05, 0.0000e+00, 3.8547e+05, 3.8546e+05,
         7.8887e+05, 3.8548e+05, 7.6326e+05, 3.8546e+05, 3.8548e+05, 7.4452e+05,
         7.7160e+05, 3.8547e+05, 3.8543e+05, 3.8547e+05],
        [1.4748e+00, 1.4589e+00, 3.8667e+05, 3.8547e+05, 0.0000e+00, 1.3312e+00,
         3.9256e+05, 1.3789e+00, 3.9586e+05, 1.5702e+00, 1.4639e+00, 3.7965e+05,
         3.8866e+05, 1.4666e+00, 1.3599e+00, 1.3507e+00],
        [1.4439e+00, 1.3645e+00, 3.8669e+05, 3.8546e+05, 1.3312e+00, 0.0000e+00,
         3.9253e+05, 1.3867e+00, 3.9587e+05, 1.3602e+00, 1.3579e+00, 3.7969e+05,
         3.8867e+05, 1.3152e+00, 1.3779e+00, 1.3449e+00],
        [3.9254e+05, 3.9253e+05, 7.7366e+05, 7.8887e+05, 3.9256e+05, 3.9253e+05,
         0.0000e+00, 3.9251e+05, 8.1938e+05, 3.9251e+05, 3.9254e+05, 7.5925e+05,
         7.7959e+05, 3.9252e+05, 3.9253e+05, 3.9253e+05],
        [1.4694e+00, 1.3898e+00, 3.8673e+05, 3.8548e+05, 1.3789e+00, 1.3867e+00,
         3.9251e+05, 0.0000e+00, 3.9584e+05, 1.4744e+00, 1.4060e+00, 3.7968e+05,
         3.8867e+05, 1.4843e+00, 1.3677e+00, 1.3330e+00],
        [3.9583e+05, 3.9586e+05, 7.7174e+05, 7.6326e+05, 3.9586e+05, 3.9587e+05,
         8.1938e+05, 3.9584e+05, 0.0000e+00, 3.9585e+05, 3.9585e+05, 7.5976e+05,
         7.9927e+05, 3.9585e+05, 3.9586e+05, 3.9584e+05],
        [1.3809e+00, 1.4472e+00, 3.8672e+05, 3.8546e+05, 1.5702e+00, 1.3602e+00,
         3.9251e+05, 1.4744e+00, 3.9585e+05, 0.0000e+00, 1.4931e+00, 3.7967e+05,
         3.8867e+05, 1.1647e+00, 1.4136e+00, 1.3278e+00],
        [1.3872e+00, 1.4500e+00, 3.8670e+05, 3.8548e+05, 1.4639e+00, 1.3579e+00,
         3.9254e+05, 1.4060e+00, 3.9585e+05, 1.4931e+00, 0.0000e+00, 3.7967e+05,
         3.8866e+05, 1.4728e+00, 1.5132e+00, 1.2398e+00],
        [3.7965e+05, 3.7966e+05, 7.6546e+05, 7.4452e+05, 3.7965e+05, 3.7969e+05,
         7.5925e+05, 3.7968e+05, 7.5976e+05, 3.7967e+05, 3.7967e+05, 0.0000e+00,
         8.0144e+05, 3.7966e+05, 3.7968e+05, 3.7967e+05],
        [3.8864e+05, 3.8864e+05, 8.0126e+05, 7.7160e+05, 3.8866e+05, 3.8867e+05,
         7.7959e+05, 3.8867e+05, 7.9927e+05, 3.8867e+05, 3.8866e+05, 8.0144e+05,
         0.0000e+00, 3.8865e+05, 3.8867e+05, 3.8862e+05],
        [1.3881e+00, 1.4172e+00, 3.8669e+05, 3.8547e+05, 1.4666e+00, 1.3152e+00,
         3.9252e+05, 1.4843e+00, 3.9585e+05, 1.1647e+00, 1.4728e+00, 3.7966e+05,
         3.8865e+05, 0.0000e+00, 1.4593e+00, 1.3422e+00],
        [1.4632e+00, 1.4750e+00, 3.8668e+05, 3.8543e+05, 1.3599e+00, 1.3779e+00,
         3.9253e+05, 1.3677e+00, 3.9586e+05, 1.4136e+00, 1.5132e+00, 3.7968e+05,
         3.8867e+05, 1.4593e+00, 0.0000e+00, 1.3280e+00],
        [1.2630e+00, 1.3131e+00, 3.8670e+05, 3.8547e+05, 1.3507e+00, 1.3449e+00,
         3.9253e+05, 1.3330e+00, 3.9584e+05, 1.3278e+00, 1.2398e+00, 3.7967e+05,
         3.8862e+05, 1.3422e+00, 1.3280e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2630e+00, 1.3762e+00, 1.3809e+00, 1.3872e+00, 1.3881e+00,
        1.4439e+00, 1.4632e+00, 1.4694e+00, 1.4748e+00, 3.7965e+05, 3.8545e+05,
        3.8671e+05, 3.8864e+05, 3.9254e+05, 3.9583e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3131e+00, 1.3645e+00, 1.3762e+00, 1.3898e+00, 1.4172e+00,
        1.4472e+00, 1.4500e+00, 1.4589e+00, 1.4750e+00, 3.7966e+05, 3.8547e+05,
        3.8669e+05, 3.8864e+05, 3.9253e+05, 3.9586e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386674.7188, 386675.0000, 386685.1250, 386694.1562,
        386694.6875, 386700.4688, 386702.1250, 386713.3125, 386721.4688,
        386732.5312, 765461.3750, 771744.7500, 773660.2500, 783682.6250,
        801257.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385433.2500, 385450.0000, 385461.1250, 385463.8750,
        385466.2812, 385471.4062, 385472.5000, 385474.5000, 385476.7500,
        385483.4375, 744519.3125, 763256.1250, 771598.5625, 783682.6250,
        788865.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3312e+00, 1.3507e+00, 1.3599e+00, 1.3789e+00, 1.4589e+00,
        1.4639e+00, 1.4666e+00, 1.4748e+00, 1.5702e+00, 3.7965e+05, 3.8547e+05,
        3.8667e+05, 3.8866e+05, 3.9256e+05, 3.9586e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3152e+00, 1.3312e+00, 1.3449e+00, 1.3579e+00, 1.3602e+00,
        1.3645e+00, 1.3779e+00, 1.3867e+00, 1.4439e+00, 3.7969e+05, 3.8546e+05,
        3.8669e+05, 3.8867e+05, 3.9253e+05, 3.9587e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392508.9688, 392514.0000, 392517.6875, 392529.7188,
        392530.6562, 392531.7500, 392533.9688, 392535.0000, 392538.4062,
        392561.1250, 759251.4375, 773660.2500, 779588.1875, 788865.6875,
        819381.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3330e+00, 1.3677e+00, 1.3789e+00, 1.3867e+00, 1.3898e+00,
        1.4060e+00, 1.4694e+00, 1.4744e+00, 1.4843e+00, 3.7968e+05, 3.8548e+05,
        3.8673e+05, 3.8867e+05, 3.9251e+05, 3.9584e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395827.2500, 395840.9062, 395843.6250, 395847.1250,
        395848.9688, 395849.1562, 395858.6250, 395860.4062, 395861.8750,
        395874.8750, 759762.0625, 763256.1250, 771744.7500, 799265.6875,
        819381.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1647e+00, 1.3278e+00, 1.3602e+00, 1.3809e+00, 1.4136e+00,
        1.4472e+00, 1.4744e+00, 1.4931e+00, 1.5702e+00, 3.7967e+05, 3.8546e+05,
        3.8672e+05, 3.8867e+05, 3.9251e+05, 3.9585e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2398e+00, 1.3579e+00, 1.3872e+00, 1.4060e+00, 1.4500e+00,
        1.4639e+00, 1.4728e+00, 1.4931e+00, 1.5132e+00, 3.7967e+05, 3.8548e+05,
        3.8670e+05, 3.8866e+05, 3.9254e+05, 3.9585e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379651.2500, 379653.5625, 379656.9375, 379661.2500,
        379665.5938, 379669.0938, 379670.7500, 379677.2500, 379684.9375,
        379686.7812, 744519.3125, 759251.4375, 759762.0625, 765461.3750,
        801435.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388618.0625, 388636.8750, 388644.4688, 388650.5938,
        388656.1250, 388658.6875, 388668.4375, 388669.4062, 388670.1250,
        388673.6562, 771598.5625, 779588.1875, 799265.6875, 801257.5000,
        801435.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1647e+00, 1.3152e+00, 1.3422e+00, 1.3881e+00, 1.4172e+00,
        1.4593e+00, 1.4666e+00, 1.4728e+00, 1.4843e+00, 3.7966e+05, 3.8547e+05,
        3.8669e+05, 3.8865e+05, 3.9252e+05, 3.9585e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3280e+00, 1.3599e+00, 1.3677e+00, 1.3779e+00, 1.4136e+00,
        1.4593e+00, 1.4632e+00, 1.4750e+00, 1.5132e+00, 3.7968e+05, 3.8543e+05,
        3.8668e+05, 3.8867e+05, 3.9253e+05, 3.9586e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2398e+00, 1.2630e+00, 1.3131e+00, 1.3278e+00, 1.3280e+00,
        1.3330e+00, 1.3422e+00, 1.3449e+00, 1.3507e+00, 3.7967e+05, 3.8547e+05,
        3.8670e+05, 3.8862e+05, 3.9253e+05, 3.9584e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37966.38', '37967.39', '386699.38', '385465.31', '37966.64', '37969.91', '392530.16', '37969.76', '395851.31', '37967.82', '37968.18', '379667.72', '388654.69', '37966.94', '37969.00', '37968.26']
estimated f for each client, fs: [6, 6, 4, 4, 6, 6, 4, 6, 4, 6, 6, 4, 4, 6, 6, 6]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0223s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:36...
global Accuracy on shared test data: 78.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 45 218]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:36, End: 2025-07-22 15:29:36)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 19, 17, 1, 9, 18, 4, 3, 11, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.5074e+00, 3.8233e+05, 3.6977e+05, 1.6570e+00, 1.5662e+00,
         3.9951e+05, 1.2400e+00, 1.5065e+00, 1.3213e+00, 1.4166e+00, 3.7819e+05,
         1.5621e+00, 1.4142e+00],
        [1.5074e+00, 0.0000e+00, 3.8235e+05, 3.6978e+05, 1.3371e+00, 1.2954e+00,
         3.9950e+05, 1.3975e+00, 1.3429e+00, 1.3230e+00, 1.2192e+00, 3.7820e+05,
         1.3435e+00, 1.2877e+00],
        [3.8233e+05, 3.8235e+05, 0.0000e+00, 7.4292e+05, 3.8233e+05, 3.8232e+05,
         7.9327e+05, 3.8234e+05, 3.8229e+05, 3.8233e+05, 3.8227e+05, 7.5357e+05,
         3.8235e+05, 3.8233e+05],
        [3.6977e+05, 3.6978e+05, 7.4292e+05, 0.0000e+00, 3.6977e+05, 3.6976e+05,
         7.6217e+05, 3.6975e+05, 3.6976e+05, 3.6976e+05, 3.6978e+05, 7.4295e+05,
         3.6979e+05, 3.6978e+05],
        [1.6570e+00, 1.3371e+00, 3.8233e+05, 3.6977e+05, 0.0000e+00, 1.2442e+00,
         3.9949e+05, 1.4809e+00, 1.3328e+00, 1.3363e+00, 1.2434e+00, 3.7820e+05,
         1.2151e+00, 1.2701e+00],
        [1.5662e+00, 1.2954e+00, 3.8232e+05, 3.6976e+05, 1.2442e+00, 0.0000e+00,
         3.9948e+05, 1.2762e+00, 1.2634e+00, 1.2165e+00, 1.1961e+00, 3.7816e+05,
         1.2508e+00, 1.3234e+00],
        [3.9951e+05, 3.9950e+05, 7.9327e+05, 7.6217e+05, 3.9949e+05, 3.9948e+05,
         0.0000e+00, 3.9951e+05, 3.9950e+05, 3.9950e+05, 3.9947e+05, 7.4763e+05,
         3.9951e+05, 3.9950e+05],
        [1.2400e+00, 1.3975e+00, 3.8234e+05, 3.6975e+05, 1.4809e+00, 1.2762e+00,
         3.9951e+05, 0.0000e+00, 1.4109e+00, 1.1293e+00, 1.2407e+00, 3.7818e+05,
         1.3457e+00, 1.2964e+00],
        [1.5065e+00, 1.3429e+00, 3.8229e+05, 3.6976e+05, 1.3328e+00, 1.2634e+00,
         3.9950e+05, 1.4109e+00, 0.0000e+00, 1.3452e+00, 1.2185e+00, 3.7819e+05,
         1.3312e+00, 1.2215e+00],
        [1.3213e+00, 1.3230e+00, 3.8233e+05, 3.6976e+05, 1.3363e+00, 1.2165e+00,
         3.9950e+05, 1.1293e+00, 1.3452e+00, 0.0000e+00, 1.2165e+00, 3.7817e+05,
         1.2988e+00, 1.2795e+00],
        [1.4166e+00, 1.2192e+00, 3.8227e+05, 3.6978e+05, 1.2434e+00, 1.1961e+00,
         3.9947e+05, 1.2407e+00, 1.2185e+00, 1.2165e+00, 0.0000e+00, 3.7818e+05,
         1.2626e+00, 1.2238e+00],
        [3.7819e+05, 3.7820e+05, 7.5357e+05, 7.4295e+05, 3.7820e+05, 3.7816e+05,
         7.4763e+05, 3.7818e+05, 3.7819e+05, 3.7817e+05, 3.7818e+05, 0.0000e+00,
         3.7817e+05, 3.7818e+05],
        [1.5621e+00, 1.3435e+00, 3.8235e+05, 3.6979e+05, 1.2151e+00, 1.2508e+00,
         3.9951e+05, 1.3457e+00, 1.3312e+00, 1.2988e+00, 1.2626e+00, 3.7817e+05,
         0.0000e+00, 1.2178e+00],
        [1.4142e+00, 1.2877e+00, 3.8233e+05, 3.6978e+05, 1.2701e+00, 1.3234e+00,
         3.9950e+05, 1.2964e+00, 1.2215e+00, 1.2795e+00, 1.2238e+00, 3.7818e+05,
         1.2178e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2400e+00, 1.3213e+00, 1.4142e+00, 1.4166e+00, 1.5065e+00,
        1.5074e+00, 1.5621e+00, 1.5662e+00, 1.6570e+00, 3.6977e+05, 3.7819e+05,
        3.8233e+05, 3.9951e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2192e+00, 1.2877e+00, 1.2954e+00, 1.3230e+00, 1.3371e+00,
        1.3429e+00, 1.3435e+00, 1.3975e+00, 1.5074e+00, 3.6978e+05, 3.7820e+05,
        3.8235e+05, 3.9950e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 382271.8125, 382291.5938, 382322.4062, 382325.0625,
        382326.4688, 382331.7500, 382333.7812, 382335.8750, 382346.0000,
        382353.6875, 742919.1875, 753571.4375, 793270.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 369753.9375, 369755.5625, 369757.8125, 369761.8125,
        369766.9062, 369771.2500, 369775.3125, 369782.9688, 369784.0000,
        369790.5625, 742919.1875, 742952.3125, 762172.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2151e+00, 1.2434e+00, 1.2442e+00, 1.2701e+00, 1.3328e+00,
        1.3363e+00, 1.3371e+00, 1.4809e+00, 1.6570e+00, 3.6977e+05, 3.7820e+05,
        3.8233e+05, 3.9949e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1961e+00, 1.2165e+00, 1.2442e+00, 1.2508e+00, 1.2634e+00,
        1.2762e+00, 1.2954e+00, 1.3234e+00, 1.5662e+00, 3.6976e+05, 3.7816e+05,
        3.8232e+05, 3.9948e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 399473.1250, 399476.3125, 399486.1562, 399496.3125,
        399504.1562, 399504.5000, 399504.9062, 399505.4375, 399508.3438,
        399514.9375, 747629.1875, 762172.3125, 793270.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1293e+00, 1.2400e+00, 1.2407e+00, 1.2762e+00, 1.2964e+00,
        1.3457e+00, 1.3975e+00, 1.4109e+00, 1.4809e+00, 3.6975e+05, 3.7818e+05,
        3.8234e+05, 3.9951e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2185e+00, 1.2215e+00, 1.2634e+00, 1.3312e+00, 1.3328e+00,
        1.3429e+00, 1.3452e+00, 1.4109e+00, 1.5065e+00, 3.6976e+05, 3.7819e+05,
        3.8229e+05, 3.9950e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1293e+00, 1.2165e+00, 1.2165e+00, 1.2795e+00, 1.2988e+00,
        1.3213e+00, 1.3230e+00, 1.3363e+00, 1.3452e+00, 3.6976e+05, 3.7817e+05,
        3.8233e+05, 3.9950e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1961e+00, 1.2165e+00, 1.2185e+00, 1.2192e+00, 1.2238e+00,
        1.2407e+00, 1.2434e+00, 1.2626e+00, 1.4166e+00, 3.6978e+05, 3.7818e+05,
        3.8227e+05, 3.9947e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 378156.8438, 378165.7500, 378170.9375, 378176.6562,
        378179.2188, 378184.7188, 378185.8125, 378189.2500, 378202.9688,
        378203.6875, 742952.3125, 747629.1875, 753571.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2151e+00, 1.2178e+00, 1.2508e+00, 1.2626e+00, 1.2988e+00,
        1.3312e+00, 1.3435e+00, 1.3457e+00, 1.5621e+00, 3.6979e+05, 3.7817e+05,
        3.8235e+05, 3.9951e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2178e+00, 1.2215e+00, 1.2238e+00, 1.2701e+00, 1.2795e+00,
        1.2877e+00, 1.2964e+00, 1.3234e+00, 1.4142e+00, 3.6978e+05, 3.7818e+05,
        3.8233e+05, 3.9950e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.47', '1.34', '382323.81', '369767.69', '1.35', '1.29', '399497.41', '1.31', '1.33', '1.27', '1.25', '378181.62', '1.31', '1.28']
estimated f for each client, fs: [4, 4, 2, 4, 4, 4, 2, 4, 4, 4, 4, 2, 4, 4]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 19, 17, 1, 9, 18, 4, 3, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0224s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:36...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:36, End: 2025-07-22 15:29:36)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 19, 17, 9, 20, 18, 8, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2496e+00, 4.1833e+05, 3.7933e+05, 1.3896e+00, 3.8601e+05,
         3.9241e+05, 1.3653e+00, 1.0844e+00, 3.9078e+05, 3.8764e+05, 1.1452e+00,
         1.2537e+00, 3.8490e+05, 1.3692e+00, 1.2089e+00],
        [1.2496e+00, 0.0000e+00, 4.1833e+05, 3.7931e+05, 1.2164e+00, 3.8603e+05,
         3.9246e+05, 1.2540e+00, 1.0894e+00, 3.9078e+05, 3.8766e+05, 1.1885e+00,
         1.2938e+00, 3.8490e+05, 1.2360e+00, 1.2707e+00],
        [4.1833e+05, 4.1833e+05, 0.0000e+00, 7.7247e+05, 4.1835e+05, 8.1244e+05,
         8.2445e+05, 4.1831e+05, 4.1836e+05, 8.2638e+05, 8.1236e+05, 4.1835e+05,
         4.1835e+05, 8.0233e+05, 4.1836e+05, 4.1834e+05],
        [3.7933e+05, 3.7931e+05, 7.7247e+05, 0.0000e+00, 3.7937e+05, 7.7971e+05,
         7.4480e+05, 3.7933e+05, 3.7930e+05, 7.6082e+05, 7.5180e+05, 3.7932e+05,
         3.7932e+05, 7.7918e+05, 3.7930e+05, 3.7932e+05],
        [1.3896e+00, 1.2164e+00, 4.1835e+05, 3.7937e+05, 0.0000e+00, 3.8597e+05,
         3.9240e+05, 1.2544e+00, 1.2538e+00, 3.9079e+05, 3.8762e+05, 1.2014e+00,
         1.4871e+00, 3.8490e+05, 1.2898e+00, 1.2831e+00],
        [3.8601e+05, 3.8603e+05, 8.1244e+05, 7.7971e+05, 3.8597e+05, 0.0000e+00,
         7.7503e+05, 3.8601e+05, 3.8601e+05, 7.7223e+05, 7.6381e+05, 3.8602e+05,
         3.8602e+05, 7.6404e+05, 3.8603e+05, 3.8603e+05],
        [3.9241e+05, 3.9246e+05, 8.2445e+05, 7.4480e+05, 3.9240e+05, 7.7503e+05,
         0.0000e+00, 3.9240e+05, 3.9241e+05, 8.1442e+05, 7.7666e+05, 3.9243e+05,
         3.9240e+05, 7.8771e+05, 3.9239e+05, 3.9243e+05],
        [1.3653e+00, 1.2540e+00, 4.1831e+05, 3.7933e+05, 1.2544e+00, 3.8601e+05,
         3.9240e+05, 0.0000e+00, 1.3045e+00, 3.9082e+05, 3.8764e+05, 1.2831e+00,
         1.5710e+00, 3.8489e+05, 1.1815e+00, 1.1805e+00],
        [1.0844e+00, 1.0894e+00, 4.1836e+05, 3.7930e+05, 1.2538e+00, 3.8601e+05,
         3.9241e+05, 1.3045e+00, 0.0000e+00, 3.9079e+05, 3.8767e+05, 1.0706e+00,
         1.1879e+00, 3.8489e+05, 1.2928e+00, 1.2137e+00],
        [3.9078e+05, 3.9078e+05, 8.2638e+05, 7.6082e+05, 3.9079e+05, 7.7223e+05,
         8.1442e+05, 3.9082e+05, 3.9079e+05, 0.0000e+00, 7.7463e+05, 3.9081e+05,
         3.9084e+05, 7.6581e+05, 3.9079e+05, 3.9080e+05],
        [3.8764e+05, 3.8766e+05, 8.1236e+05, 7.5180e+05, 3.8762e+05, 7.6381e+05,
         7.7666e+05, 3.8764e+05, 3.8767e+05, 7.7463e+05, 0.0000e+00, 3.8765e+05,
         3.8764e+05, 7.7721e+05, 3.8765e+05, 3.8762e+05],
        [1.1452e+00, 1.1885e+00, 4.1835e+05, 3.7932e+05, 1.2014e+00, 3.8602e+05,
         3.9243e+05, 1.2831e+00, 1.0706e+00, 3.9081e+05, 3.8765e+05, 0.0000e+00,
         1.2955e+00, 3.8488e+05, 1.2473e+00, 1.1959e+00],
        [1.2537e+00, 1.2938e+00, 4.1835e+05, 3.7932e+05, 1.4871e+00, 3.8602e+05,
         3.9240e+05, 1.5710e+00, 1.1879e+00, 3.9084e+05, 3.8764e+05, 1.2955e+00,
         0.0000e+00, 3.8491e+05, 1.5832e+00, 1.4687e+00],
        [3.8490e+05, 3.8490e+05, 8.0233e+05, 7.7918e+05, 3.8490e+05, 7.6404e+05,
         7.8771e+05, 3.8489e+05, 3.8489e+05, 7.6581e+05, 7.7721e+05, 3.8488e+05,
         3.8491e+05, 0.0000e+00, 3.8489e+05, 3.8489e+05],
        [1.3692e+00, 1.2360e+00, 4.1836e+05, 3.7930e+05, 1.2898e+00, 3.8603e+05,
         3.9239e+05, 1.1815e+00, 1.2928e+00, 3.9079e+05, 3.8765e+05, 1.2473e+00,
         1.5832e+00, 3.8489e+05, 0.0000e+00, 1.2072e+00],
        [1.2089e+00, 1.2707e+00, 4.1834e+05, 3.7932e+05, 1.2831e+00, 3.8603e+05,
         3.9243e+05, 1.1805e+00, 1.2137e+00, 3.9080e+05, 3.8762e+05, 1.1959e+00,
         1.4687e+00, 3.8489e+05, 1.2072e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0844e+00, 1.1452e+00, 1.2089e+00, 1.2496e+00, 1.2537e+00,
        1.3653e+00, 1.3692e+00, 1.3896e+00, 3.7933e+05, 3.8490e+05, 3.8601e+05,
        3.8764e+05, 3.9078e+05, 3.9241e+05, 4.1833e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0894e+00, 1.1885e+00, 1.2164e+00, 1.2360e+00, 1.2496e+00,
        1.2540e+00, 1.2707e+00, 1.2938e+00, 3.7931e+05, 3.8490e+05, 3.8603e+05,
        3.8766e+05, 3.9078e+05, 3.9246e+05, 4.1833e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 418307.0938, 418328.9688, 418331.1875, 418342.4688,
        418346.6250, 418349.4375, 418350.0312, 418357.9062, 418359.6875,
        772469.3750, 802331.3750, 812356.6250, 812442.2500, 824448.0625,
        826379.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379299.1875, 379303.8438, 379311.7812, 379316.9062,
        379322.4688, 379322.9375, 379326.3438, 379330.8750, 379373.2812,
        744799.0000, 751796.3750, 760816.0000, 772469.3750, 779176.6875,
        779714.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2014e+00, 1.2164e+00, 1.2538e+00, 1.2544e+00, 1.2831e+00,
        1.2898e+00, 1.3896e+00, 1.4871e+00, 3.7937e+05, 3.8490e+05, 3.8597e+05,
        3.8762e+05, 3.9079e+05, 3.9240e+05, 4.1835e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385968.1250, 386007.1562, 386010.6562, 386012.2812,
        386016.8750, 386023.3125, 386028.5938, 386029.4688, 386033.0000,
        763805.5625, 764036.6875, 772233.5000, 775034.0625, 779714.6250,
        812442.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392386.4062, 392395.5625, 392403.4062, 392404.3125,
        392409.6250, 392413.5000, 392425.2812, 392426.0312, 392457.8125,
        744799.0000, 775034.0625, 776656.2500, 787705.1875, 814419.7500,
        824448.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1805e+00, 1.1815e+00, 1.2540e+00, 1.2544e+00, 1.2831e+00,
        1.3045e+00, 1.3653e+00, 1.5710e+00, 3.7933e+05, 3.8489e+05, 3.8601e+05,
        3.8764e+05, 3.9082e+05, 3.9240e+05, 4.1831e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0706e+00, 1.0844e+00, 1.0894e+00, 1.1879e+00, 1.2137e+00,
        1.2538e+00, 1.2928e+00, 1.3045e+00, 3.7930e+05, 3.8489e+05, 3.8601e+05,
        3.8767e+05, 3.9079e+05, 3.9241e+05, 4.1836e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390780.8750, 390782.7188, 390785.0312, 390787.4688,
        390789.9688, 390799.2812, 390809.5000, 390820.9062, 390835.5312,
        760816.0000, 765807.5000, 772233.5000, 774630.4375, 814419.7500,
        826379.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387621.1562, 387624.6562, 387635.0000, 387636.6875,
        387640.8125, 387645.4062, 387645.6875, 387661.4375, 387674.7812,
        751796.3750, 763805.5625, 774630.4375, 776656.2500, 777208.6250,
        812356.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0706e+00, 1.1452e+00, 1.1885e+00, 1.1959e+00, 1.2014e+00,
        1.2473e+00, 1.2831e+00, 1.2955e+00, 3.7932e+05, 3.8488e+05, 3.8602e+05,
        3.8765e+05, 3.9081e+05, 3.9243e+05, 4.1835e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1879e+00, 1.2537e+00, 1.2938e+00, 1.2955e+00, 1.4687e+00,
        1.4871e+00, 1.5710e+00, 1.5832e+00, 3.7932e+05, 3.8491e+05, 3.8602e+05,
        3.8764e+05, 3.9084e+05, 3.9240e+05, 4.1835e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384884.0000, 384886.1250, 384888.2500, 384889.0312,
        384891.0625, 384896.9375, 384899.3750, 384902.5000, 384908.0000,
        764036.6875, 765807.5000, 777208.6250, 779176.6875, 787705.1875,
        802331.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1815e+00, 1.2072e+00, 1.2360e+00, 1.2473e+00, 1.2898e+00,
        1.2928e+00, 1.3692e+00, 1.5832e+00, 3.7930e+05, 3.8489e+05, 3.8603e+05,
        3.8765e+05, 3.9079e+05, 3.9239e+05, 4.1836e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1805e+00, 1.1959e+00, 1.2072e+00, 1.2089e+00, 1.2137e+00,
        1.2707e+00, 1.2831e+00, 1.4687e+00, 3.7932e+05, 3.8489e+05, 3.8603e+05,
        3.8762e+05, 3.9080e+05, 3.9243e+05, 4.1834e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76423.33', '76422.09', '453754.31', '415870.69', '76428.61', '423793.44', '427652.09', '76422.95', '76420.43', '427800.75', '424058.19', '76421.05', '76424.20', '422808.19', '76419.58', '76422.14']
estimated f for each client, fs: [7, 7, 5, 5, 7, 5, 5, 7, 7, 5, 5, 7, 7, 5, 7, 7]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [5, 2, 19, 17, 9, 20, 18, 8, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0147s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:37...
global Accuracy on shared test data: 78.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:37, End: 2025-07-22 15:29:37)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 1, 9, 20, 18, 8, 15, 4, 3, 10, 16, 6], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.3671e+00, 1.3206e+00, 1.4735e+00, 1.3896e+00, 3.9772e+05,
         3.9241e+05, 1.4318e+00, 3.9828e+05, 1.1711e+00, 1.3559e+00, 1.1885e+00,
         3.7095e+05, 1.3008e+00],
        [1.3671e+00, 0.0000e+00, 1.3413e+00, 1.4020e+00, 1.3173e+00, 3.9774e+05,
         3.9240e+05, 1.3138e+00, 3.9826e+05, 1.3776e+00, 1.3564e+00, 1.4163e+00,
         3.7095e+05, 1.5188e+00],
        [1.3206e+00, 1.3413e+00, 0.0000e+00, 1.4118e+00, 1.2683e+00, 3.9774e+05,
         3.9240e+05, 1.3547e+00, 3.9827e+05, 1.1600e+00, 1.3411e+00, 1.2198e+00,
         3.7095e+05, 1.2447e+00],
        [1.4735e+00, 1.4020e+00, 1.4118e+00, 0.0000e+00, 1.2216e+00, 3.9773e+05,
         3.9241e+05, 1.3017e+00, 3.9828e+05, 1.4835e+00, 1.3612e+00, 1.4661e+00,
         3.7097e+05, 1.4577e+00],
        [1.3896e+00, 1.3173e+00, 1.2683e+00, 1.2216e+00, 0.0000e+00, 3.9774e+05,
         3.9242e+05, 1.2972e+00, 3.9826e+05, 1.2951e+00, 1.3185e+00, 1.3473e+00,
         3.7096e+05, 1.3968e+00],
        [3.9772e+05, 3.9774e+05, 3.9774e+05, 3.9773e+05, 3.9774e+05, 0.0000e+00,
         7.8685e+05, 3.9775e+05, 8.1425e+05, 3.9772e+05, 3.9773e+05, 3.9773e+05,
         7.5260e+05, 3.9774e+05],
        [3.9241e+05, 3.9240e+05, 3.9240e+05, 3.9241e+05, 3.9242e+05, 7.8685e+05,
         0.0000e+00, 3.9243e+05, 7.8970e+05, 3.9242e+05, 3.9240e+05, 3.9244e+05,
         7.7242e+05, 3.9237e+05],
        [1.4318e+00, 1.3138e+00, 1.3547e+00, 1.3017e+00, 1.2972e+00, 3.9775e+05,
         3.9243e+05, 0.0000e+00, 3.9828e+05, 1.3977e+00, 1.3118e+00, 1.4147e+00,
         3.7096e+05, 1.4217e+00],
        [3.9828e+05, 3.9826e+05, 3.9827e+05, 3.9828e+05, 3.9826e+05, 8.1425e+05,
         7.8970e+05, 3.9828e+05, 0.0000e+00, 3.9829e+05, 3.9830e+05, 3.9828e+05,
         7.8380e+05, 3.9828e+05],
        [1.1711e+00, 1.3776e+00, 1.1600e+00, 1.4835e+00, 1.2951e+00, 3.9772e+05,
         3.9242e+05, 1.3977e+00, 3.9829e+05, 0.0000e+00, 1.4180e+00, 1.1046e+00,
         3.7097e+05, 1.2407e+00],
        [1.3559e+00, 1.3564e+00, 1.3411e+00, 1.3612e+00, 1.3185e+00, 3.9773e+05,
         3.9240e+05, 1.3118e+00, 3.9830e+05, 1.4180e+00, 0.0000e+00, 1.3951e+00,
         3.7094e+05, 1.4650e+00],
        [1.1885e+00, 1.4163e+00, 1.2198e+00, 1.4661e+00, 1.3473e+00, 3.9773e+05,
         3.9244e+05, 1.4147e+00, 3.9828e+05, 1.1046e+00, 1.3951e+00, 0.0000e+00,
         3.7095e+05, 1.2619e+00],
        [3.7095e+05, 3.7095e+05, 3.7095e+05, 3.7097e+05, 3.7096e+05, 7.5260e+05,
         7.7242e+05, 3.7096e+05, 7.8380e+05, 3.7097e+05, 3.7094e+05, 3.7095e+05,
         0.0000e+00, 3.7094e+05],
        [1.3008e+00, 1.5188e+00, 1.2447e+00, 1.4577e+00, 1.3968e+00, 3.9774e+05,
         3.9237e+05, 1.4217e+00, 3.9828e+05, 1.2407e+00, 1.4650e+00, 1.2619e+00,
         3.7094e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1711e+00, 1.1885e+00, 1.3008e+00, 1.3206e+00, 1.3559e+00,
        1.3671e+00, 1.3896e+00, 1.4318e+00, 1.4735e+00, 3.7095e+05, 3.9241e+05,
        3.9772e+05, 3.9828e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3138e+00, 1.3173e+00, 1.3413e+00, 1.3564e+00, 1.3671e+00,
        1.3776e+00, 1.4020e+00, 1.4163e+00, 1.5188e+00, 3.7095e+05, 3.9240e+05,
        3.9774e+05, 3.9826e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1600e+00, 1.2198e+00, 1.2447e+00, 1.2683e+00, 1.3206e+00,
        1.3411e+00, 1.3413e+00, 1.3547e+00, 1.4118e+00, 3.7095e+05, 3.9240e+05,
        3.9774e+05, 3.9827e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2216e+00, 1.3017e+00, 1.3612e+00, 1.4020e+00, 1.4118e+00,
        1.4577e+00, 1.4661e+00, 1.4735e+00, 1.4835e+00, 3.7097e+05, 3.9241e+05,
        3.9773e+05, 3.9828e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2216e+00, 1.2683e+00, 1.2951e+00, 1.2972e+00, 1.3173e+00,
        1.3185e+00, 1.3473e+00, 1.3896e+00, 1.3968e+00, 3.7096e+05, 3.9242e+05,
        3.9774e+05, 3.9826e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397719.0312, 397723.8125, 397726.0312, 397726.2812,
        397729.0625, 397736.2500, 397738.0000, 397740.2812, 397742.6250,
        397753.5625, 752601.8750, 786854.0625, 814251.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392373.6250, 392396.3125, 392400.6875, 392403.8750,
        392405.6875, 392413.9062, 392418.8750, 392423.2188, 392433.3438,
        392437.0312, 772416.6250, 786854.0625, 789698.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2972e+00, 1.3017e+00, 1.3118e+00, 1.3138e+00, 1.3547e+00,
        1.3977e+00, 1.4147e+00, 1.4217e+00, 1.4318e+00, 3.7096e+05, 3.9243e+05,
        3.9775e+05, 3.9828e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 398259.4062, 398262.2812, 398271.6875, 398275.8750,
        398277.3438, 398278.0938, 398278.5938, 398281.1875, 398285.9375,
        398304.5625, 783796.6250, 789698.1250, 814251.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1046e+00, 1.1600e+00, 1.1711e+00, 1.2407e+00, 1.2951e+00,
        1.3776e+00, 1.3977e+00, 1.4180e+00, 1.4835e+00, 3.7097e+05, 3.9242e+05,
        3.9772e+05, 3.9829e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3118e+00, 1.3185e+00, 1.3411e+00, 1.3559e+00, 1.3564e+00,
        1.3612e+00, 1.3951e+00, 1.4180e+00, 1.4650e+00, 3.7094e+05, 3.9240e+05,
        3.9773e+05, 3.9830e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1046e+00, 1.1885e+00, 1.2198e+00, 1.2619e+00, 1.3473e+00,
        1.3951e+00, 1.4147e+00, 1.4163e+00, 1.4661e+00, 3.7095e+05, 3.9244e+05,
        3.9773e+05, 3.9828e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 370940.3125, 370941.5938, 370947.4375, 370951.3125,
        370954.3750, 370954.9062, 370955.8125, 370956.2500, 370968.1250,
        370974.5625, 752601.8750, 772416.6250, 783796.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2407e+00, 1.2447e+00, 1.2619e+00, 1.3008e+00, 1.3968e+00,
        1.4217e+00, 1.4577e+00, 1.4650e+00, 1.5188e+00, 3.7094e+05, 3.9237e+05,
        3.9774e+05, 3.9828e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.33', '1.38', '1.30', '1.40', '1.32', '397733.47', '392410.62', '1.36', '398277.47', '1.29', '1.37', '1.31', '370952.25', '1.37']
estimated f for each client, fs: [4, 4, 4, 4, 4, 2, 2, 4, 2, 4, 4, 4, 4, 4]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 1, 9, 20, 18, 8, 15, 4, 3, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0097s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:38...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:38, End: 2025-07-22 15:29:38)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.1632e+00, 1.1121e+00, 3.9873e+05, 1.2348e+00, 3.9473e+05,
         3.8721e+05, 1.2427e+00, 3.8113e+05, 1.2110e+00, 1.1720e+00, 3.7706e+05,
         3.9386e+05, 1.0120e+00, 9.8198e-01, 3.8102e+05, 1.0293e+00, 1.0605e+00],
        [1.1632e+00, 0.0000e+00, 1.1851e+00, 3.9875e+05, 1.2135e+00, 3.9474e+05,
         3.8718e+05, 1.1666e+00, 3.8113e+05, 1.6419e+00, 1.1969e+00, 3.7704e+05,
         3.9385e+05, 1.1184e+00, 1.1701e+00, 3.8101e+05, 1.2003e+00, 1.1026e+00],
        [1.1121e+00, 1.1851e+00, 0.0000e+00, 3.9875e+05, 1.1803e+00, 3.9471e+05,
         3.8721e+05, 1.1596e+00, 3.8114e+05, 1.2288e+00, 1.1154e+00, 3.7703e+05,
         3.9382e+05, 1.0436e+00, 1.0006e+00, 3.8105e+05, 9.7708e-01, 1.1221e+00],
        [3.9873e+05, 3.9875e+05, 3.9875e+05, 0.0000e+00, 3.9874e+05, 7.9089e+05,
         7.9346e+05, 3.9877e+05, 7.7138e+05, 3.9877e+05, 3.9874e+05, 7.6485e+05,
         8.0600e+05, 3.9873e+05, 3.9874e+05, 7.8504e+05, 3.9872e+05, 3.9873e+05],
        [1.2348e+00, 1.2135e+00, 1.1803e+00, 3.9874e+05, 0.0000e+00, 3.9473e+05,
         3.8718e+05, 1.1057e+00, 3.8114e+05, 1.8108e+00, 1.1284e+00, 3.7705e+05,
         3.9384e+05, 1.1165e+00, 1.1890e+00, 3.8101e+05, 1.1325e+00, 1.0659e+00],
        [3.9473e+05, 3.9474e+05, 3.9471e+05, 7.9089e+05, 3.9473e+05, 0.0000e+00,
         7.5828e+05, 3.9475e+05, 7.7682e+05, 3.9472e+05, 3.9473e+05, 7.6536e+05,
         7.9204e+05, 3.9472e+05, 3.9472e+05, 7.7137e+05, 3.9473e+05, 3.9475e+05],
        [3.8721e+05, 3.8718e+05, 3.8721e+05, 7.9346e+05, 3.8718e+05, 7.5828e+05,
         0.0000e+00, 3.8719e+05, 7.6694e+05, 3.8720e+05, 3.8716e+05, 7.7435e+05,
         7.7878e+05, 3.8721e+05, 3.8720e+05, 7.5835e+05, 3.8722e+05, 3.8717e+05],
        [1.2427e+00, 1.1666e+00, 1.1596e+00, 3.9877e+05, 1.1057e+00, 3.9475e+05,
         3.8719e+05, 0.0000e+00, 3.8111e+05, 1.6959e+00, 1.1713e+00, 3.7702e+05,
         3.9382e+05, 1.1325e+00, 1.1945e+00, 3.8101e+05, 1.1309e+00, 1.1084e+00],
        [3.8113e+05, 3.8113e+05, 3.8114e+05, 7.7138e+05, 3.8114e+05, 7.7682e+05,
         7.6694e+05, 3.8111e+05, 0.0000e+00, 3.8113e+05, 3.8111e+05, 7.7622e+05,
         7.6330e+05, 3.8112e+05, 3.8112e+05, 7.7427e+05, 3.8112e+05, 3.8113e+05],
        [1.2110e+00, 1.6419e+00, 1.2288e+00, 3.9877e+05, 1.8108e+00, 3.9472e+05,
         3.8720e+05, 1.6959e+00, 3.8113e+05, 0.0000e+00, 1.5995e+00, 3.7703e+05,
         3.9386e+05, 1.2475e+00, 1.1006e+00, 3.8100e+05, 1.2763e+00, 1.5656e+00],
        [1.1720e+00, 1.1969e+00, 1.1154e+00, 3.9874e+05, 1.1284e+00, 3.9473e+05,
         3.8716e+05, 1.1713e+00, 3.8111e+05, 1.5995e+00, 0.0000e+00, 3.7704e+05,
         3.9384e+05, 1.1687e+00, 1.1368e+00, 3.8103e+05, 1.1650e+00, 1.0307e+00],
        [3.7706e+05, 3.7704e+05, 3.7703e+05, 7.6485e+05, 3.7705e+05, 7.6536e+05,
         7.7435e+05, 3.7702e+05, 7.7622e+05, 3.7703e+05, 3.7704e+05, 0.0000e+00,
         7.5637e+05, 3.7704e+05, 3.7703e+05, 7.6132e+05, 3.7704e+05, 3.7704e+05],
        [3.9386e+05, 3.9385e+05, 3.9382e+05, 8.0600e+05, 3.9384e+05, 7.9204e+05,
         7.7878e+05, 3.9382e+05, 7.6330e+05, 3.9386e+05, 3.9384e+05, 7.5637e+05,
         0.0000e+00, 3.9383e+05, 3.9384e+05, 7.9349e+05, 3.9383e+05, 3.9384e+05],
        [1.0120e+00, 1.1184e+00, 1.0436e+00, 3.9873e+05, 1.1165e+00, 3.9472e+05,
         3.8721e+05, 1.1325e+00, 3.8112e+05, 1.2475e+00, 1.1687e+00, 3.7704e+05,
         3.9383e+05, 0.0000e+00, 9.9057e-01, 3.8101e+05, 9.8657e-01, 1.0728e+00],
        [9.8198e-01, 1.1701e+00, 1.0006e+00, 3.9874e+05, 1.1890e+00, 3.9472e+05,
         3.8720e+05, 1.1945e+00, 3.8112e+05, 1.1006e+00, 1.1368e+00, 3.7703e+05,
         3.9384e+05, 9.9057e-01, 0.0000e+00, 3.8104e+05, 9.8087e-01, 1.0709e+00],
        [3.8102e+05, 3.8101e+05, 3.8105e+05, 7.8504e+05, 3.8101e+05, 7.7137e+05,
         7.5835e+05, 3.8101e+05, 7.7427e+05, 3.8100e+05, 3.8103e+05, 7.6132e+05,
         7.9349e+05, 3.8101e+05, 3.8104e+05, 0.0000e+00, 3.8102e+05, 3.8101e+05],
        [1.0293e+00, 1.2003e+00, 9.7708e-01, 3.9872e+05, 1.1325e+00, 3.9473e+05,
         3.8722e+05, 1.1309e+00, 3.8112e+05, 1.2763e+00, 1.1650e+00, 3.7704e+05,
         3.9383e+05, 9.8657e-01, 9.8087e-01, 3.8102e+05, 0.0000e+00, 1.0819e+00],
        [1.0605e+00, 1.1026e+00, 1.1221e+00, 3.9873e+05, 1.0659e+00, 3.9475e+05,
         3.8717e+05, 1.1084e+00, 3.8113e+05, 1.5656e+00, 1.0307e+00, 3.7704e+05,
         3.9384e+05, 1.0728e+00, 1.0709e+00, 3.8101e+05, 1.0819e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.8198e-01, 1.0120e+00, 1.0293e+00, 1.0605e+00, 1.1121e+00,
        1.1632e+00, 1.1720e+00, 1.2110e+00, 1.2348e+00, 1.2427e+00, 3.7706e+05,
        3.8102e+05, 3.8113e+05, 3.8721e+05, 3.9386e+05, 3.9473e+05, 3.9873e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1026e+00, 1.1184e+00, 1.1632e+00, 1.1666e+00, 1.1701e+00,
        1.1851e+00, 1.1969e+00, 1.2003e+00, 1.2135e+00, 1.6419e+00, 3.7704e+05,
        3.8101e+05, 3.8113e+05, 3.8718e+05, 3.9385e+05, 3.9474e+05, 3.9875e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.7708e-01, 1.0006e+00, 1.0436e+00, 1.1121e+00, 1.1154e+00,
        1.1221e+00, 1.1596e+00, 1.1803e+00, 1.1851e+00, 1.2288e+00, 3.7703e+05,
        3.8105e+05, 3.8114e+05, 3.8721e+05, 3.9382e+05, 3.9471e+05, 3.9875e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398722.9375, 398729.2500, 398733.0938, 398733.5938,
        398737.8750, 398739.7500, 398743.1250, 398748.1875, 398752.6250,
        398765.5000, 398766.6875, 764847.6250, 771380.6875, 785038.1875,
        790886.5000, 793457.6250, 806001.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0659e+00, 1.1057e+00, 1.1165e+00, 1.1284e+00, 1.1325e+00,
        1.1803e+00, 1.1890e+00, 1.2135e+00, 1.2348e+00, 1.8108e+00, 3.7705e+05,
        3.8101e+05, 3.8114e+05, 3.8718e+05, 3.9384e+05, 3.9473e+05, 3.9874e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 394707.0000, 394720.2188, 394720.3750, 394724.2188,
        394725.8750, 394726.0625, 394726.5000, 394727.2500, 394743.3438,
        394745.7188, 394749.1875, 758283.7500, 765359.6875, 771367.2500,
        776819.1875, 790886.5000, 792039.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387157.2812, 387168.3438, 387176.5000, 387176.8125,
        387193.3750, 387196.8125, 387197.1250, 387205.3750, 387209.9375,
        387212.2188, 387221.8125, 758283.7500, 758350.2500, 766942.2500,
        774348.8125, 778780.1250, 793457.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1057e+00, 1.1084e+00, 1.1309e+00, 1.1325e+00, 1.1596e+00,
        1.1666e+00, 1.1713e+00, 1.1945e+00, 1.2427e+00, 1.6959e+00, 3.7702e+05,
        3.8101e+05, 3.8111e+05, 3.8719e+05, 3.9382e+05, 3.9475e+05, 3.9877e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 381109.1562, 381114.5625, 381117.2812, 381121.7812,
        381124.2188, 381127.5000, 381127.6562, 381128.0938, 381131.1875,
        381135.4375, 381139.8125, 763298.6250, 766942.2500, 771380.6875,
        774274.3750, 776224.8125, 776819.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1006e+00, 1.2110e+00, 1.2288e+00, 1.2475e+00, 1.2763e+00,
        1.5656e+00, 1.5995e+00, 1.6419e+00, 1.6959e+00, 1.8108e+00, 3.7703e+05,
        3.8100e+05, 3.8113e+05, 3.8720e+05, 3.9386e+05, 3.9472e+05, 3.9877e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0307e+00, 1.1154e+00, 1.1284e+00, 1.1368e+00, 1.1650e+00,
        1.1687e+00, 1.1713e+00, 1.1720e+00, 1.1969e+00, 1.5995e+00, 3.7704e+05,
        3.8103e+05, 3.8111e+05, 3.8716e+05, 3.9384e+05, 3.9473e+05, 3.9874e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 377025.0000, 377030.2500, 377031.0000, 377032.1562,
        377036.3438, 377036.7500, 377038.2188, 377041.1250, 377043.3750,
        377051.6250, 377061.6875, 756374.8750, 761315.6250, 764847.6250,
        765359.6875, 774348.8125, 776224.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393815.3125, 393819.2188, 393828.5938, 393831.1250,
        393835.1875, 393835.8125, 393838.8750, 393842.0312, 393849.3125,
        393859.5625, 393860.3125, 756374.8750, 763298.6250, 778780.1250,
        792039.9375, 793489.9375, 806001.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.8657e-01, 9.9057e-01, 1.0120e+00, 1.0436e+00, 1.0728e+00,
        1.1165e+00, 1.1184e+00, 1.1325e+00, 1.1687e+00, 1.2475e+00, 3.7704e+05,
        3.8101e+05, 3.8112e+05, 3.8721e+05, 3.9383e+05, 3.9472e+05, 3.9873e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.8087e-01, 9.8198e-01, 9.9057e-01, 1.0006e+00, 1.0709e+00,
        1.1006e+00, 1.1368e+00, 1.1701e+00, 1.1890e+00, 1.1945e+00, 3.7703e+05,
        3.8104e+05, 3.8112e+05, 3.8720e+05, 3.9384e+05, 3.9472e+05, 3.9874e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 381004.2812, 381005.6562, 381013.0000, 381013.1250,
        381013.9375, 381014.7500, 381018.2812, 381018.8750, 381032.1875,
        381043.8750, 381047.8125, 758350.2500, 761315.6250, 771367.2500,
        774274.3750, 785038.1875, 793489.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.7708e-01, 9.8087e-01, 9.8657e-01, 1.0293e+00, 1.0819e+00,
        1.1309e+00, 1.1325e+00, 1.1650e+00, 1.2003e+00, 1.2763e+00, 3.7704e+05,
        3.8102e+05, 3.8112e+05, 3.8722e+05, 3.9383e+05, 3.9473e+05, 3.9872e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0307e+00, 1.0605e+00, 1.0659e+00, 1.0709e+00, 1.0728e+00,
        1.0819e+00, 1.1026e+00, 1.1084e+00, 1.1221e+00, 1.5656e+00, 3.7704e+05,
        3.8101e+05, 3.8113e+05, 3.8717e+05, 3.9384e+05, 3.9475e+05, 3.9873e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34279.35', '34277.13', '34276.49', '398742.91', '34278.53', '394728.69', '387192.31', '34276.10', '381125.12', '34276.84', '34277.54', '377038.84', '393837.69', '34277.06', '34276.62', '381020.50', '34277.66', '34277.22']
estimated f for each client, fs: [7, 7, 7, 5, 7, 5, 5, 7, 6, 7, 7, 6, 5, 7, 7, 5, 7, 7]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0125s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:38...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:38, End: 2025-07-22 15:29:38)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2380e+00, 1.2140e+00, 4.1465e+05, 1.4048e+00, 1.2269e+00,
         3.9095e+05, 3.9888e+05, 1.2327e+00, 3.7955e+05, 1.0834e+00, 1.3027e+00,
         4.0281e+05, 3.9364e+05, 1.1315e+00, 1.1806e+00],
        [1.2380e+00, 0.0000e+00, 1.3085e+00, 4.1467e+05, 1.3236e+00, 1.2235e+00,
         3.9095e+05, 3.9888e+05, 1.3831e+00, 3.7956e+05, 1.4852e+00, 1.2817e+00,
         4.0281e+05, 3.9362e+05, 1.2972e+00, 1.2101e+00],
        [1.2140e+00, 1.3085e+00, 0.0000e+00, 4.1466e+05, 1.3306e+00, 1.2070e+00,
         3.9095e+05, 3.9887e+05, 1.1865e+00, 3.7956e+05, 1.0883e+00, 1.2276e+00,
         4.0280e+05, 3.9364e+05, 1.0670e+00, 1.2556e+00],
        [4.1465e+05, 4.1467e+05, 4.1466e+05, 0.0000e+00, 4.1466e+05, 4.1469e+05,
         7.9345e+05, 8.1843e+05, 4.1467e+05, 7.8009e+05, 4.1466e+05, 4.1470e+05,
         8.0936e+05, 8.0151e+05, 4.1469e+05, 4.1467e+05],
        [1.4048e+00, 1.3236e+00, 1.3306e+00, 4.1466e+05, 0.0000e+00, 1.1976e+00,
         3.9093e+05, 3.9884e+05, 1.3871e+00, 3.7956e+05, 1.5811e+00, 1.2525e+00,
         4.0279e+05, 3.9362e+05, 1.2190e+00, 1.1965e+00],
        [1.2269e+00, 1.2235e+00, 1.2070e+00, 4.1469e+05, 1.1976e+00, 0.0000e+00,
         3.9095e+05, 3.9887e+05, 1.2869e+00, 3.7957e+05, 1.3258e+00, 1.1979e+00,
         4.0279e+05, 3.9360e+05, 1.1734e+00, 1.1436e+00],
        [3.9095e+05, 3.9095e+05, 3.9095e+05, 7.9345e+05, 3.9093e+05, 3.9095e+05,
         0.0000e+00, 7.7543e+05, 3.9097e+05, 7.6542e+05, 3.9096e+05, 3.9097e+05,
         7.8168e+05, 7.8622e+05, 3.9094e+05, 3.9096e+05],
        [3.9888e+05, 3.9888e+05, 3.9887e+05, 8.1843e+05, 3.9884e+05, 3.9887e+05,
         7.7543e+05, 0.0000e+00, 3.9885e+05, 7.6942e+05, 3.9888e+05, 3.9888e+05,
         7.8302e+05, 8.1607e+05, 3.9887e+05, 3.9884e+05],
        [1.2327e+00, 1.3831e+00, 1.1865e+00, 4.1467e+05, 1.3871e+00, 1.2869e+00,
         3.9097e+05, 3.9885e+05, 0.0000e+00, 3.7959e+05, 1.1189e+00, 1.3744e+00,
         4.0278e+05, 3.9367e+05, 1.1527e+00, 1.2956e+00],
        [3.7955e+05, 3.7956e+05, 3.7956e+05, 7.8009e+05, 3.7956e+05, 3.7957e+05,
         7.6542e+05, 7.6942e+05, 3.7959e+05, 0.0000e+00, 3.7955e+05, 3.7959e+05,
         7.8928e+05, 7.6248e+05, 3.7958e+05, 3.7958e+05],
        [1.0834e+00, 1.4852e+00, 1.0883e+00, 4.1466e+05, 1.5811e+00, 1.3258e+00,
         3.9096e+05, 3.9888e+05, 1.1189e+00, 3.7955e+05, 0.0000e+00, 1.4661e+00,
         4.0279e+05, 3.9362e+05, 1.1004e+00, 1.4066e+00],
        [1.3027e+00, 1.2817e+00, 1.2276e+00, 4.1470e+05, 1.2525e+00, 1.1979e+00,
         3.9097e+05, 3.9888e+05, 1.3744e+00, 3.7959e+05, 1.4661e+00, 0.0000e+00,
         4.0280e+05, 3.9362e+05, 1.2554e+00, 1.1418e+00],
        [4.0281e+05, 4.0281e+05, 4.0280e+05, 8.0936e+05, 4.0279e+05, 4.0279e+05,
         7.8168e+05, 7.8302e+05, 4.0278e+05, 7.8928e+05, 4.0279e+05, 4.0280e+05,
         0.0000e+00, 8.0410e+05, 4.0278e+05, 4.0280e+05],
        [3.9364e+05, 3.9362e+05, 3.9364e+05, 8.0151e+05, 3.9362e+05, 3.9360e+05,
         7.8622e+05, 8.1607e+05, 3.9367e+05, 7.6248e+05, 3.9362e+05, 3.9362e+05,
         8.0410e+05, 0.0000e+00, 3.9362e+05, 3.9363e+05],
        [1.1315e+00, 1.2972e+00, 1.0670e+00, 4.1469e+05, 1.2190e+00, 1.1734e+00,
         3.9094e+05, 3.9887e+05, 1.1527e+00, 3.7958e+05, 1.1004e+00, 1.2554e+00,
         4.0278e+05, 3.9362e+05, 0.0000e+00, 1.1618e+00],
        [1.1806e+00, 1.2101e+00, 1.2556e+00, 4.1467e+05, 1.1965e+00, 1.1436e+00,
         3.9096e+05, 3.9884e+05, 1.2956e+00, 3.7958e+05, 1.4066e+00, 1.1418e+00,
         4.0280e+05, 3.9363e+05, 1.1618e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0834e+00, 1.1315e+00, 1.1806e+00, 1.2140e+00, 1.2269e+00,
        1.2327e+00, 1.2380e+00, 1.3027e+00, 1.4048e+00, 3.7955e+05, 3.9095e+05,
        3.9364e+05, 3.9888e+05, 4.0281e+05, 4.1465e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2101e+00, 1.2235e+00, 1.2380e+00, 1.2817e+00, 1.2972e+00,
        1.3085e+00, 1.3236e+00, 1.3831e+00, 1.4852e+00, 3.7956e+05, 3.9095e+05,
        3.9362e+05, 3.9888e+05, 4.0281e+05, 4.1467e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0670e+00, 1.0883e+00, 1.1865e+00, 1.2070e+00, 1.2140e+00,
        1.2276e+00, 1.2556e+00, 1.3085e+00, 1.3306e+00, 3.7956e+05, 3.9095e+05,
        3.9364e+05, 3.9887e+05, 4.0280e+05, 4.1466e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 414652.5938, 414655.5625, 414660.3125, 414660.5625,
        414665.3438, 414669.7188, 414674.6875, 414687.0938, 414689.2812,
        414701.1250, 780088.8750, 793445.2500, 801509.1875, 809360.1875,
        818429.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1965e+00, 1.1976e+00, 1.2190e+00, 1.2525e+00, 1.3236e+00,
        1.3306e+00, 1.3871e+00, 1.4048e+00, 1.5811e+00, 3.7956e+05, 3.9093e+05,
        3.9362e+05, 3.9884e+05, 4.0279e+05, 4.1466e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1436e+00, 1.1734e+00, 1.1976e+00, 1.1979e+00, 1.2070e+00,
        1.2235e+00, 1.2269e+00, 1.2869e+00, 1.3258e+00, 3.7957e+05, 3.9095e+05,
        3.9360e+05, 3.9887e+05, 4.0279e+05, 4.1469e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390932.3125, 390944.3750, 390945.0312, 390945.3750,
        390947.5938, 390949.5000, 390955.1562, 390961.8125, 390967.8125,
        390968.0625, 765416.1250, 775428.4375, 781684.3750, 786218.3750,
        793445.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398841.3438, 398842.5000, 398853.0000, 398866.7188,
        398868.2812, 398868.3125, 398875.4375, 398875.9375, 398878.0625,
        398878.1562, 769418.6250, 775428.4375, 783024.6250, 816074.0000,
        818429.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1189e+00, 1.1527e+00, 1.1865e+00, 1.2327e+00, 1.2869e+00,
        1.2956e+00, 1.3744e+00, 1.3831e+00, 1.3871e+00, 3.7959e+05, 3.9097e+05,
        3.9367e+05, 3.9885e+05, 4.0278e+05, 4.1467e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379551.9375, 379554.4688, 379555.0625, 379558.9688,
        379564.5000, 379574.8125, 379579.3125, 379581.5938, 379591.9375,
        379594.1875, 762481.3750, 765416.1250, 769418.6250, 780088.8750,
        789280.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0834e+00, 1.0883e+00, 1.1004e+00, 1.1189e+00, 1.3258e+00,
        1.4066e+00, 1.4661e+00, 1.4852e+00, 1.5811e+00, 3.7955e+05, 3.9096e+05,
        3.9362e+05, 3.9888e+05, 4.0279e+05, 4.1466e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1418e+00, 1.1979e+00, 1.2276e+00, 1.2525e+00, 1.2554e+00,
        1.2817e+00, 1.3027e+00, 1.3744e+00, 1.4661e+00, 3.7959e+05, 3.9097e+05,
        3.9362e+05, 3.9888e+05, 4.0280e+05, 4.1470e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402783.3125, 402783.7500, 402786.9688, 402791.1250,
        402791.5625, 402797.0312, 402797.8750, 402800.6250, 402807.4375,
        402809.6875, 781684.3750, 783024.6250, 789280.5000, 804099.2500,
        809360.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393604.3438, 393616.8750, 393619.2500, 393621.3125,
        393622.1562, 393623.6562, 393634.9375, 393641.4375, 393643.7188,
        393670.5625, 762481.3750, 786218.3750, 801509.1875, 804099.2500,
        816074.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0670e+00, 1.1004e+00, 1.1315e+00, 1.1527e+00, 1.1618e+00,
        1.1734e+00, 1.2190e+00, 1.2554e+00, 1.2972e+00, 3.7958e+05, 3.9094e+05,
        3.9362e+05, 3.9887e+05, 4.0278e+05, 4.1469e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1418e+00, 1.1436e+00, 1.1618e+00, 1.1806e+00, 1.1965e+00,
        1.2101e+00, 1.2556e+00, 1.2956e+00, 1.4066e+00, 3.7958e+05, 3.9096e+05,
        3.9363e+05, 3.9884e+05, 4.0280e+05, 4.1467e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37956.55', '37957.07', '37956.60', '414671.59', '37957.64', '37958.58', '390951.69', '398864.78', '37960.33', '379570.66', '37956.36', '37960.57', '402794.94', '393629.84', '37959.21', '37959.03']
estimated f for each client, fs: [6, 6, 6, 4, 6, 6, 4, 4, 6, 5, 6, 6, 4, 4, 6, 6]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0191s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:39...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:39, End: 2025-07-22 15:29:39)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.0201e+00, 9.8760e-01, 3.8080e+05, 3.9299e+05, 1.0616e+00,
         1.0064e+00, 3.9208e+05, 3.8687e+05, 9.5207e-01, 3.9126e+05, 1.2286e+00,
         4.0067e+05, 3.9280e+05, 9.1311e-01, 3.8812e+05, 9.1074e-01, 9.7147e-01],
        [1.0201e+00, 0.0000e+00, 1.0598e+00, 3.8081e+05, 3.9299e+05, 1.0564e+00,
         9.9956e-01, 3.9207e+05, 3.8688e+05, 1.0517e+00, 3.9133e+05, 1.6932e+00,
         4.0065e+05, 3.9282e+05, 1.0088e+00, 3.8811e+05, 1.0545e+00, 9.9589e-01],
        [9.8760e-01, 1.0598e+00, 0.0000e+00, 3.8079e+05, 3.9299e+05, 1.0177e+00,
         9.2112e-01, 3.9207e+05, 3.8687e+05, 9.0763e-01, 3.9129e+05, 1.2197e+00,
         4.0063e+05, 3.9279e+05, 9.2704e-01, 3.8809e+05, 8.5451e-01, 9.9749e-01],
        [3.8080e+05, 3.8081e+05, 3.8079e+05, 0.0000e+00, 7.7112e+05, 3.8082e+05,
         3.8083e+05, 7.6970e+05, 7.5410e+05, 3.8083e+05, 7.7222e+05, 3.8082e+05,
         8.0858e+05, 8.0655e+05, 3.8080e+05, 7.7932e+05, 3.8083e+05, 3.8082e+05],
        [3.9299e+05, 3.9299e+05, 3.9299e+05, 7.7112e+05, 0.0000e+00, 3.9300e+05,
         3.9298e+05, 7.7873e+05, 7.7538e+05, 3.9301e+05, 7.9542e+05, 3.9298e+05,
         7.8909e+05, 7.8630e+05, 3.9299e+05, 7.7428e+05, 3.9300e+05, 3.9295e+05],
        [1.0616e+00, 1.0564e+00, 1.0177e+00, 3.8082e+05, 3.9300e+05, 0.0000e+00,
         9.4384e-01, 3.9211e+05, 3.8685e+05, 1.0198e+00, 3.9127e+05, 1.7409e+00,
         4.0064e+05, 3.9282e+05, 9.7948e-01, 3.8814e+05, 9.6449e-01, 9.4980e-01],
        [1.0064e+00, 9.9956e-01, 9.2112e-01, 3.8083e+05, 3.9298e+05, 9.4384e-01,
         0.0000e+00, 3.9207e+05, 3.8686e+05, 9.8651e-01, 3.9131e+05, 1.5116e+00,
         4.0063e+05, 3.9280e+05, 9.0415e-01, 3.8814e+05, 9.5044e-01, 9.5740e-01],
        [3.9208e+05, 3.9207e+05, 3.9207e+05, 7.6970e+05, 7.7873e+05, 3.9211e+05,
         3.9207e+05, 0.0000e+00, 7.6102e+05, 3.9209e+05, 7.8634e+05, 3.9205e+05,
         7.9770e+05, 7.7955e+05, 3.9208e+05, 7.6709e+05, 3.9208e+05, 3.9209e+05],
        [3.8687e+05, 3.8688e+05, 3.8687e+05, 7.5410e+05, 7.7538e+05, 3.8685e+05,
         3.8686e+05, 7.6102e+05, 0.0000e+00, 3.8686e+05, 7.9090e+05, 3.8686e+05,
         7.8169e+05, 7.7030e+05, 3.8687e+05, 7.9650e+05, 3.8686e+05, 3.8686e+05],
        [9.5207e-01, 1.0517e+00, 9.0763e-01, 3.8083e+05, 3.9301e+05, 1.0198e+00,
         9.8651e-01, 3.9209e+05, 3.8686e+05, 0.0000e+00, 3.9129e+05, 1.2051e+00,
         4.0064e+05, 3.9281e+05, 9.4653e-01, 3.8814e+05, 8.9512e-01, 9.8401e-01],
        [3.9126e+05, 3.9133e+05, 3.9129e+05, 7.7222e+05, 7.9542e+05, 3.9127e+05,
         3.9131e+05, 7.8634e+05, 7.9090e+05, 3.9129e+05, 0.0000e+00, 3.9127e+05,
         7.8070e+05, 7.6582e+05, 3.9129e+05, 7.7602e+05, 3.9130e+05, 3.9131e+05],
        [1.2286e+00, 1.6932e+00, 1.2197e+00, 3.8082e+05, 3.9298e+05, 1.7409e+00,
         1.5116e+00, 3.9205e+05, 3.8686e+05, 1.2051e+00, 3.9127e+05, 0.0000e+00,
         4.0068e+05, 3.9279e+05, 1.2853e+00, 3.8812e+05, 1.2604e+00, 1.6360e+00],
        [4.0067e+05, 4.0065e+05, 4.0063e+05, 8.0858e+05, 7.8909e+05, 4.0064e+05,
         4.0063e+05, 7.9770e+05, 7.8169e+05, 4.0064e+05, 7.8070e+05, 4.0068e+05,
         0.0000e+00, 7.9940e+05, 4.0066e+05, 8.0828e+05, 4.0065e+05, 4.0066e+05],
        [3.9280e+05, 3.9282e+05, 3.9279e+05, 8.0655e+05, 7.8630e+05, 3.9282e+05,
         3.9280e+05, 7.7955e+05, 7.7030e+05, 3.9281e+05, 7.6582e+05, 3.9279e+05,
         7.9940e+05, 0.0000e+00, 3.9281e+05, 7.9261e+05, 3.9280e+05, 3.9284e+05],
        [9.1311e-01, 1.0088e+00, 9.2704e-01, 3.8080e+05, 3.9299e+05, 9.7948e-01,
         9.0415e-01, 3.9208e+05, 3.8687e+05, 9.4653e-01, 3.9129e+05, 1.2853e+00,
         4.0066e+05, 3.9281e+05, 0.0000e+00, 3.8813e+05, 8.7960e-01, 9.7944e-01],
        [3.8812e+05, 3.8811e+05, 3.8809e+05, 7.7932e+05, 7.7428e+05, 3.8814e+05,
         3.8814e+05, 7.6709e+05, 7.9650e+05, 3.8814e+05, 7.7602e+05, 3.8812e+05,
         8.0828e+05, 7.9261e+05, 3.8813e+05, 0.0000e+00, 3.8811e+05, 3.8813e+05],
        [9.1074e-01, 1.0545e+00, 8.5451e-01, 3.8083e+05, 3.9300e+05, 9.6449e-01,
         9.5044e-01, 3.9208e+05, 3.8686e+05, 8.9512e-01, 3.9130e+05, 1.2604e+00,
         4.0065e+05, 3.9280e+05, 8.7960e-01, 3.8811e+05, 0.0000e+00, 9.4901e-01],
        [9.7147e-01, 9.9589e-01, 9.9749e-01, 3.8082e+05, 3.9295e+05, 9.4980e-01,
         9.5740e-01, 3.9209e+05, 3.8686e+05, 9.8401e-01, 3.9131e+05, 1.6360e+00,
         4.0066e+05, 3.9284e+05, 9.7944e-01, 3.8813e+05, 9.4901e-01, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.1074e-01, 9.1311e-01, 9.5207e-01, 9.7147e-01, 9.8760e-01,
        1.0064e+00, 1.0201e+00, 1.0616e+00, 1.2286e+00, 3.8080e+05, 3.8687e+05,
        3.8812e+05, 3.9126e+05, 3.9208e+05, 3.9280e+05, 3.9299e+05, 4.0067e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.9589e-01, 9.9956e-01, 1.0088e+00, 1.0201e+00, 1.0517e+00,
        1.0545e+00, 1.0564e+00, 1.0598e+00, 1.6932e+00, 3.8081e+05, 3.8688e+05,
        3.8811e+05, 3.9133e+05, 3.9207e+05, 3.9282e+05, 3.9299e+05, 4.0065e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.5451e-01, 9.0763e-01, 9.2112e-01, 9.2704e-01, 9.8760e-01,
        9.9749e-01, 1.0177e+00, 1.0598e+00, 1.2197e+00, 3.8079e+05, 3.8687e+05,
        3.8809e+05, 3.9129e+05, 3.9207e+05, 3.9279e+05, 3.9299e+05, 4.0063e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 380794.0000, 380798.4062, 380800.6875, 380807.2188,
        380818.0625, 380821.4375, 380824.2500, 380825.7500, 380829.5625,
        380832.6875, 754102.9375, 769696.6875, 771121.8750, 772217.3750,
        779323.8750, 806551.5625, 808576.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392949.6250, 392977.2188, 392980.6875, 392985.1250,
        392988.0625, 392988.0625, 392990.5312, 393002.8750, 393004.5625,
        393006.6562, 771121.8750, 774276.6875, 775384.1875, 778732.6250,
        786297.3750, 789091.1250, 795419.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.4384e-01, 9.4980e-01, 9.6449e-01, 9.7948e-01, 1.0177e+00,
        1.0198e+00, 1.0564e+00, 1.0616e+00, 1.7409e+00, 3.8082e+05, 3.8685e+05,
        3.8814e+05, 3.9127e+05, 3.9211e+05, 3.9282e+05, 3.9300e+05, 4.0064e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.0415e-01, 9.2112e-01, 9.4384e-01, 9.5044e-01, 9.5740e-01,
        9.8651e-01, 9.9956e-01, 1.0064e+00, 1.5116e+00, 3.8083e+05, 3.8686e+05,
        3.8814e+05, 3.9131e+05, 3.9207e+05, 3.9280e+05, 3.9298e+05, 4.0063e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392047.1562, 392065.6875, 392068.1562, 392072.8125,
        392075.7500, 392080.9062, 392081.2500, 392085.7500, 392090.5000,
        392110.7500, 761019.7500, 767085.3750, 769696.6875, 778732.6250,
        779552.5000, 786335.7500, 797701.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386849.3438, 386856.0000, 386857.0625, 386860.5625,
        386861.4375, 386862.6875, 386867.4375, 386870.5000, 386872.7188,
        386884.6562, 754102.9375, 761019.7500, 770296.2500, 775384.1875,
        781689.7500, 790898.8125, 796495.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.9512e-01, 9.0763e-01, 9.4653e-01, 9.5207e-01, 9.8401e-01,
        9.8651e-01, 1.0198e+00, 1.0517e+00, 1.2051e+00, 3.8083e+05, 3.8686e+05,
        3.8814e+05, 3.9129e+05, 3.9209e+05, 3.9281e+05, 3.9301e+05, 4.0064e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391261.3438, 391267.9062, 391273.6875, 391285.9062,
        391292.3750, 391293.6875, 391303.5312, 391308.1562, 391308.6875,
        391327.8750, 765821.5000, 772217.3750, 776023.3750, 780700.5000,
        786335.7500, 790898.8125, 795419.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2051e+00, 1.2197e+00, 1.2286e+00, 1.2604e+00, 1.2853e+00,
        1.5116e+00, 1.6360e+00, 1.6932e+00, 1.7409e+00, 3.8082e+05, 3.8686e+05,
        3.8812e+05, 3.9127e+05, 3.9205e+05, 3.9279e+05, 3.9298e+05, 4.0068e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 400630.8750, 400634.5000, 400642.2188, 400645.0000,
        400649.5938, 400652.9375, 400655.7188, 400658.8125, 400674.3750,
        400680.5000, 780700.5000, 781689.7500, 789091.1250, 797701.7500,
        799396.0000, 808276.1250, 808576.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392790.7188, 392792.5938, 392798.4062, 392800.6562,
        392804.7188, 392805.7188, 392805.9375, 392816.4375, 392821.3125,
        392836.1875, 765821.5000, 770296.2500, 779552.5000, 786297.3750,
        792609.5000, 799396.0000, 806551.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.7960e-01, 9.0415e-01, 9.1311e-01, 9.2704e-01, 9.4653e-01,
        9.7944e-01, 9.7948e-01, 1.0088e+00, 1.2853e+00, 3.8080e+05, 3.8687e+05,
        3.8813e+05, 3.9129e+05, 3.9208e+05, 3.9281e+05, 3.9299e+05, 4.0066e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388093.6250, 388111.7500, 388114.7500, 388116.2812,
        388123.6250, 388126.4688, 388129.4062, 388136.0000, 388137.6250,
        388144.5625, 767085.3750, 774276.6875, 776023.3750, 779323.8750,
        792609.5000, 796495.1875, 808276.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.5451e-01, 8.7960e-01, 8.9512e-01, 9.1074e-01, 9.4901e-01,
        9.5044e-01, 9.6449e-01, 1.0545e+00, 1.2604e+00, 3.8083e+05, 3.8686e+05,
        3.8811e+05, 3.9130e+05, 3.9208e+05, 3.9280e+05, 3.9300e+05, 4.0065e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.4901e-01, 9.4980e-01, 9.5740e-01, 9.7147e-01, 9.7944e-01,
        9.8401e-01, 9.9589e-01, 9.9749e-01, 1.6360e+00, 3.8082e+05, 3.8686e+05,
        3.8813e+05, 3.9131e+05, 3.9209e+05, 3.9284e+05, 3.9295e+05, 4.0066e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['69788.62', '69791.06', '69788.68', '414750.44', '427363.19', '69789.14', '69790.17', '425618.03', '420249.56', '69791.11', '425340.44', '69790.20', '435202.28', '426717.66', '69789.09', '422574.47', '69790.38', '69790.58']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 8, 6, 6, 8, 6, 8, 6, 6, 8, 6, 8, 8]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0130s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:39...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:39, End: 2025-07-22 15:29:39)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.3864e+00, 1.2163e+00, 3.9580e+05, 3.9772e+05, 1.5556e+00,
         1.3668e+00, 3.9276e+05, 3.8556e+05, 3.9182e+05, 7.5455e-01, 1.3831e+00,
         3.8758e+05, 3.8217e+05, 1.0382e+00, 3.8773e+05, 1.1405e+00, 1.3384e+00],
        [1.3864e+00, 0.0000e+00, 1.0602e+00, 3.9580e+05, 3.9768e+05, 1.1155e+00,
         1.0188e+00, 3.9280e+05, 3.8558e+05, 3.9186e+05, 1.4389e+00, 1.0591e+00,
         3.8760e+05, 3.8218e+05, 1.0067e+00, 3.8770e+05, 1.0561e+00, 9.9403e-01],
        [1.2163e+00, 1.0602e+00, 0.0000e+00, 3.9578e+05, 3.9772e+05, 1.0705e+00,
         9.7507e-01, 3.9277e+05, 3.8557e+05, 3.9182e+05, 1.0715e+00, 1.0027e+00,
         3.8761e+05, 3.8220e+05, 8.8109e-01, 3.8772e+05, 8.6501e-01, 9.9624e-01],
        [3.9580e+05, 3.9580e+05, 3.9578e+05, 0.0000e+00, 8.1425e+05, 3.9580e+05,
         3.9579e+05, 7.9494e+05, 7.7314e+05, 8.0424e+05, 3.9577e+05, 3.9579e+05,
         7.8938e+05, 7.8636e+05, 3.9579e+05, 7.8375e+05, 3.9579e+05, 3.9578e+05],
        [3.9772e+05, 3.9768e+05, 3.9772e+05, 8.1425e+05, 0.0000e+00, 3.9769e+05,
         3.9773e+05, 7.9713e+05, 7.7752e+05, 7.9692e+05, 3.9771e+05, 3.9774e+05,
         7.8916e+05, 7.8707e+05, 3.9770e+05, 7.9561e+05, 3.9769e+05, 3.9770e+05],
        [1.5556e+00, 1.1155e+00, 1.0705e+00, 3.9580e+05, 3.9769e+05, 0.0000e+00,
         1.0052e+00, 3.9277e+05, 3.8559e+05, 3.9185e+05, 1.5701e+00, 1.0155e+00,
         3.8758e+05, 3.8218e+05, 1.0864e+00, 3.8775e+05, 1.0074e+00, 9.8421e-01],
        [1.3668e+00, 1.0188e+00, 9.7507e-01, 3.9579e+05, 3.9773e+05, 1.0052e+00,
         0.0000e+00, 3.9280e+05, 3.8558e+05, 3.9183e+05, 1.3030e+00, 9.8519e-01,
         3.8759e+05, 3.8222e+05, 9.2071e-01, 3.8773e+05, 9.6317e-01, 9.6733e-01],
        [3.9276e+05, 3.9280e+05, 3.9277e+05, 7.9494e+05, 7.9713e+05, 3.9277e+05,
         3.9280e+05, 0.0000e+00, 7.4739e+05, 7.9579e+05, 3.9278e+05, 3.9280e+05,
         7.5353e+05, 7.8637e+05, 3.9278e+05, 7.7312e+05, 3.9279e+05, 3.9277e+05],
        [3.8556e+05, 3.8558e+05, 3.8557e+05, 7.7314e+05, 7.7752e+05, 3.8559e+05,
         3.8558e+05, 7.4739e+05, 0.0000e+00, 7.8313e+05, 3.8556e+05, 3.8557e+05,
         7.5858e+05, 7.7643e+05, 3.8557e+05, 7.8921e+05, 3.8558e+05, 3.8558e+05],
        [3.9182e+05, 3.9186e+05, 3.9182e+05, 8.0424e+05, 7.9692e+05, 3.9185e+05,
         3.9183e+05, 7.9579e+05, 7.8313e+05, 0.0000e+00, 3.9182e+05, 3.9185e+05,
         7.7664e+05, 7.8238e+05, 3.9182e+05, 7.8416e+05, 3.9184e+05, 3.9187e+05],
        [7.5455e-01, 1.4389e+00, 1.0715e+00, 3.9577e+05, 3.9771e+05, 1.5701e+00,
         1.3030e+00, 3.9278e+05, 3.8556e+05, 3.9182e+05, 0.0000e+00, 1.3568e+00,
         3.8758e+05, 3.8218e+05, 9.3806e-01, 3.8773e+05, 1.0590e+00, 1.3890e+00],
        [1.3831e+00, 1.0591e+00, 1.0027e+00, 3.9579e+05, 3.9774e+05, 1.0155e+00,
         9.8519e-01, 3.9280e+05, 3.8557e+05, 3.9185e+05, 1.3568e+00, 0.0000e+00,
         3.8761e+05, 3.8220e+05, 9.4335e-01, 3.8774e+05, 9.8557e-01, 9.4724e-01],
        [3.8758e+05, 3.8760e+05, 3.8761e+05, 7.8938e+05, 7.8916e+05, 3.8758e+05,
         3.8759e+05, 7.5353e+05, 7.5858e+05, 7.7664e+05, 3.8758e+05, 3.8761e+05,
         0.0000e+00, 7.7104e+05, 3.8760e+05, 7.8230e+05, 3.8761e+05, 3.8760e+05],
        [3.8217e+05, 3.8218e+05, 3.8220e+05, 7.8636e+05, 7.8707e+05, 3.8218e+05,
         3.8222e+05, 7.8637e+05, 7.7643e+05, 7.8238e+05, 3.8218e+05, 3.8220e+05,
         7.7104e+05, 0.0000e+00, 3.8216e+05, 7.7330e+05, 3.8218e+05, 3.8217e+05],
        [1.0382e+00, 1.0067e+00, 8.8109e-01, 3.9579e+05, 3.9770e+05, 1.0864e+00,
         9.2071e-01, 3.9278e+05, 3.8557e+05, 3.9182e+05, 9.3806e-01, 9.4335e-01,
         3.8760e+05, 3.8216e+05, 0.0000e+00, 3.8774e+05, 8.4715e-01, 9.3779e-01],
        [3.8773e+05, 3.8770e+05, 3.8772e+05, 7.8375e+05, 7.9561e+05, 3.8775e+05,
         3.8773e+05, 7.7312e+05, 7.8921e+05, 7.8416e+05, 3.8773e+05, 3.8774e+05,
         7.8230e+05, 7.7330e+05, 3.8774e+05, 0.0000e+00, 3.8773e+05, 3.8773e+05],
        [1.1405e+00, 1.0561e+00, 8.6501e-01, 3.9579e+05, 3.9769e+05, 1.0074e+00,
         9.6317e-01, 3.9279e+05, 3.8558e+05, 3.9184e+05, 1.0590e+00, 9.8557e-01,
         3.8761e+05, 3.8218e+05, 8.4715e-01, 3.8773e+05, 0.0000e+00, 9.2662e-01],
        [1.3384e+00, 9.9403e-01, 9.9624e-01, 3.9578e+05, 3.9770e+05, 9.8421e-01,
         9.6733e-01, 3.9277e+05, 3.8558e+05, 3.9187e+05, 1.3890e+00, 9.4724e-01,
         3.8760e+05, 3.8217e+05, 9.3779e-01, 3.8773e+05, 9.2662e-01, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 7.5455e-01, 1.0382e+00, 1.1405e+00, 1.2163e+00, 1.3384e+00,
        1.3668e+00, 1.3831e+00, 1.3864e+00, 1.5556e+00, 3.8217e+05, 3.8556e+05,
        3.8758e+05, 3.8773e+05, 3.9182e+05, 3.9276e+05, 3.9580e+05, 3.9772e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.9403e-01, 1.0067e+00, 1.0188e+00, 1.0561e+00, 1.0591e+00,
        1.0602e+00, 1.1155e+00, 1.3864e+00, 1.4389e+00, 3.8218e+05, 3.8558e+05,
        3.8760e+05, 3.8770e+05, 3.9186e+05, 3.9280e+05, 3.9580e+05, 3.9768e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.6501e-01, 8.8109e-01, 9.7507e-01, 9.9624e-01, 1.0027e+00,
        1.0602e+00, 1.0705e+00, 1.0715e+00, 1.2163e+00, 3.8220e+05, 3.8557e+05,
        3.8761e+05, 3.8772e+05, 3.9182e+05, 3.9277e+05, 3.9578e+05, 3.9772e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395766.5000, 395778.5625, 395784.3125, 395788.3125,
        395789.7500, 395790.9062, 395792.8125, 395795.6562, 395800.9375,
        395804.5625, 773140.2500, 783753.3750, 786356.8750, 789375.5625,
        794937.6875, 804235.8125, 814247.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397682.2500, 397685.2500, 397688.1875, 397702.3125,
        397702.4375, 397711.2500, 397716.8125, 397721.6875, 397730.0625,
        397741.6875, 777524.6875, 787071.5000, 789162.5000, 795606.1875,
        796924.8750, 797126.0625, 814247.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.8421e-01, 1.0052e+00, 1.0074e+00, 1.0155e+00, 1.0705e+00,
        1.0864e+00, 1.1155e+00, 1.5556e+00, 1.5701e+00, 3.8218e+05, 3.8559e+05,
        3.8758e+05, 3.8775e+05, 3.9185e+05, 3.9277e+05, 3.9580e+05, 3.9769e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.2071e-01, 9.6317e-01, 9.6733e-01, 9.7507e-01, 9.8519e-01,
        1.0052e+00, 1.0188e+00, 1.3030e+00, 1.3668e+00, 3.8222e+05, 3.8558e+05,
        3.8759e+05, 3.8773e+05, 3.9183e+05, 3.9280e+05, 3.9579e+05, 3.9773e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392756.4375, 392765.2500, 392771.8750, 392772.5625,
        392775.8438, 392776.0938, 392791.0312, 392795.4062, 392796.8750,
        392798.0312, 747393.5000, 753526.6250, 773115.1250, 786366.1875,
        794937.6875, 795793.1250, 797126.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385561.8438, 385563.6250, 385568.2500, 385569.5625,
        385570.8125, 385575.7500, 385577.2812, 385580.2812, 385581.5000,
        385593.8438, 747393.5000, 758579.6875, 773140.2500, 776426.3750,
        777524.6875, 783128.1250, 789212.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391816.8438, 391817.5312, 391820.8125, 391821.0938,
        391831.2500, 391840.7188, 391846.9688, 391849.5000, 391864.7812,
        391870.0312, 776638.4375, 782375.6875, 783128.1250, 784155.4375,
        795793.1250, 796924.8750, 804235.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 7.5455e-01, 9.3806e-01, 1.0590e+00, 1.0715e+00, 1.3030e+00,
        1.3568e+00, 1.3890e+00, 1.4389e+00, 1.5701e+00, 3.8218e+05, 3.8556e+05,
        3.8758e+05, 3.8773e+05, 3.9182e+05, 3.9278e+05, 3.9577e+05, 3.9771e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.4335e-01, 9.4724e-01, 9.8519e-01, 9.8557e-01, 1.0027e+00,
        1.0155e+00, 1.0591e+00, 1.3568e+00, 1.3831e+00, 3.8220e+05, 3.8557e+05,
        3.8761e+05, 3.8774e+05, 3.9185e+05, 3.9280e+05, 3.9579e+05, 3.9774e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387582.9062, 387583.1250, 387583.6250, 387589.5000,
        387601.1875, 387602.7812, 387604.6562, 387610.5000, 387613.0000,
        387613.2500, 753526.6250, 758579.6875, 771035.2500, 776638.4375,
        782301.3125, 789162.5000, 789375.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382155.9375, 382168.1250, 382172.0000, 382175.5625,
        382178.3125, 382180.4375, 382184.8750, 382198.1875, 382200.8125,
        382215.0000, 771035.2500, 773304.3125, 776426.3750, 782375.6875,
        786356.8750, 786366.1875, 787071.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.4715e-01, 8.8109e-01, 9.2071e-01, 9.3779e-01, 9.3806e-01,
        9.4335e-01, 1.0067e+00, 1.0382e+00, 1.0864e+00, 3.8216e+05, 3.8557e+05,
        3.8760e+05, 3.8774e+05, 3.9182e+05, 3.9278e+05, 3.9579e+05, 3.9770e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387700.8125, 387718.3125, 387725.5000, 387725.5625,
        387725.6875, 387726.8438, 387727.1562, 387735.2188, 387739.6875,
        387747.5312, 773115.1250, 773304.3125, 782301.3125, 783753.3750,
        784155.4375, 789212.5625, 795606.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.4715e-01, 8.6501e-01, 9.2662e-01, 9.6317e-01, 9.8557e-01,
        1.0074e+00, 1.0561e+00, 1.0590e+00, 1.1405e+00, 3.8218e+05, 3.8558e+05,
        3.8761e+05, 3.8773e+05, 3.9184e+05, 3.9279e+05, 3.9579e+05, 3.9769e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.2662e-01, 9.3779e-01, 9.4724e-01, 9.6733e-01, 9.8421e-01,
        9.9403e-01, 9.9624e-01, 1.3384e+00, 1.3890e+00, 3.8217e+05, 3.8558e+05,
        3.8760e+05, 3.8773e+05, 3.9187e+05, 3.9277e+05, 3.9578e+05, 3.9770e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['69795.00', '69796.62', '69797.89', '430093.84', '432236.94', '69798.40', '69800.02', '425017.50', '418466.94', '426819.81', '69795.90', '69798.05', '420864.62', '417533.09', '69794.11', '422762.50', '69797.73', '69796.16']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 8, 6, 6, 6, 8, 8, 6, 7, 8, 6, 8, 8]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0187s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:40...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:29:40, End: 2025-07-22 15:29:40)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 17, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.1858e+00, 3.9835e+05, 3.8582e+05, 1.0325e+00, 3.9770e+05,
         7.1499e-01, 1.2233e+00, 3.9709e+05, 4.0546e+05, 8.4963e-01, 3.8259e+05,
         1.0181e+00, 1.1846e+00],
        [1.1858e+00, 0.0000e+00, 3.9835e+05, 3.8581e+05, 1.0056e+00, 3.9767e+05,
         1.3951e+00, 1.0920e+00, 3.9711e+05, 4.0545e+05, 1.4104e+00, 3.8261e+05,
         1.0839e+00, 1.0140e+00],
        [3.9835e+05, 3.9835e+05, 0.0000e+00, 7.9894e+05, 3.9838e+05, 7.8876e+05,
         3.9839e+05, 3.9837e+05, 7.7278e+05, 7.8253e+05, 3.9840e+05, 8.0365e+05,
         3.9837e+05, 3.9835e+05],
        [3.8582e+05, 3.8581e+05, 7.9894e+05, 0.0000e+00, 3.8580e+05, 7.7223e+05,
         3.8581e+05, 3.8584e+05, 7.7986e+05, 7.8321e+05, 3.8580e+05, 7.8301e+05,
         3.8585e+05, 3.8584e+05],
        [1.0325e+00, 1.0056e+00, 3.9838e+05, 3.8580e+05, 0.0000e+00, 3.9768e+05,
         1.0135e+00, 1.0490e+00, 3.9713e+05, 4.0546e+05, 1.1595e+00, 3.8261e+05,
         9.0845e-01, 9.4028e-01],
        [3.9770e+05, 3.9767e+05, 7.8876e+05, 7.7223e+05, 3.9768e+05, 0.0000e+00,
         3.9772e+05, 3.9772e+05, 8.0704e+05, 8.1347e+05, 3.9773e+05, 7.8737e+05,
         3.9770e+05, 3.9770e+05],
        [7.1499e-01, 1.3951e+00, 3.9839e+05, 3.8581e+05, 1.0135e+00, 3.9772e+05,
         0.0000e+00, 1.3404e+00, 3.9709e+05, 4.0547e+05, 7.4170e-01, 3.8258e+05,
         1.0622e+00, 1.3478e+00],
        [1.2233e+00, 1.0920e+00, 3.9837e+05, 3.8584e+05, 1.0490e+00, 3.9772e+05,
         1.3404e+00, 0.0000e+00, 3.9711e+05, 4.0546e+05, 1.3740e+00, 3.8260e+05,
         1.0386e+00, 9.7107e-01],
        [3.9709e+05, 3.9711e+05, 7.7278e+05, 7.7986e+05, 3.9713e+05, 8.0704e+05,
         3.9709e+05, 3.9711e+05, 0.0000e+00, 8.1404e+05, 3.9708e+05, 7.9192e+05,
         3.9710e+05, 3.9709e+05],
        [4.0546e+05, 4.0545e+05, 7.8253e+05, 7.8321e+05, 4.0546e+05, 8.1347e+05,
         4.0547e+05, 4.0546e+05, 8.1404e+05, 0.0000e+00, 4.0547e+05, 7.9115e+05,
         4.0546e+05, 4.0544e+05],
        [8.4963e-01, 1.4104e+00, 3.9840e+05, 3.8580e+05, 1.1595e+00, 3.9773e+05,
         7.4170e-01, 1.3740e+00, 3.9708e+05, 4.0547e+05, 0.0000e+00, 3.8256e+05,
         1.1565e+00, 1.3674e+00],
        [3.8259e+05, 3.8261e+05, 8.0365e+05, 7.8301e+05, 3.8261e+05, 7.8737e+05,
         3.8258e+05, 3.8260e+05, 7.9192e+05, 7.9115e+05, 3.8256e+05, 0.0000e+00,
         3.8260e+05, 3.8260e+05],
        [1.0181e+00, 1.0839e+00, 3.9837e+05, 3.8585e+05, 9.0845e-01, 3.9770e+05,
         1.0622e+00, 1.0386e+00, 3.9710e+05, 4.0546e+05, 1.1565e+00, 3.8260e+05,
         0.0000e+00, 9.6029e-01],
        [1.1846e+00, 1.0140e+00, 3.9835e+05, 3.8584e+05, 9.4028e-01, 3.9770e+05,
         1.3478e+00, 9.7107e-01, 3.9709e+05, 4.0544e+05, 1.3674e+00, 3.8260e+05,
         9.6029e-01, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 7.1499e-01, 8.4963e-01, 1.0181e+00, 1.0325e+00, 1.1846e+00,
        1.1858e+00, 1.2233e+00, 3.8259e+05, 3.8582e+05, 3.9709e+05, 3.9770e+05,
        3.9835e+05, 4.0546e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0056e+00, 1.0140e+00, 1.0839e+00, 1.0920e+00, 1.1858e+00,
        1.3951e+00, 1.4104e+00, 3.8261e+05, 3.8581e+05, 3.9711e+05, 3.9767e+05,
        3.9835e+05, 4.0545e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 398347.0938, 398351.6875, 398352.3438, 398367.1562,
        398371.6250, 398379.5312, 398387.2188, 398401.5312, 772777.6250,
        782531.1875, 788763.2500, 798935.6250, 803645.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 385797.6875, 385799.1875, 385808.1250, 385809.5312,
        385820.6250, 385839.8125, 385840.2500, 385848.3438, 772232.2500,
        779857.1250, 783006.8125, 783211.1250, 798935.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.0845e-01, 9.4028e-01, 1.0056e+00, 1.0135e+00, 1.0325e+00,
        1.0490e+00, 1.1595e+00, 3.8261e+05, 3.8580e+05, 3.9713e+05, 3.9768e+05,
        3.9838e+05, 4.0546e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397672.8750, 397684.5000, 397698.2812, 397699.2188,
        397704.3438, 397717.9062, 397718.1250, 397726.0625, 772232.2500,
        787365.6250, 788763.2500, 807042.3750, 813471.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 7.1499e-01, 7.4170e-01, 1.0135e+00, 1.0622e+00, 1.3404e+00,
        1.3478e+00, 1.3951e+00, 3.8258e+05, 3.8581e+05, 3.9709e+05, 3.9772e+05,
        3.9839e+05, 4.0547e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.7107e-01, 1.0386e+00, 1.0490e+00, 1.0920e+00, 1.2233e+00,
        1.3404e+00, 1.3740e+00, 3.8260e+05, 3.8584e+05, 3.9711e+05, 3.9772e+05,
        3.9837e+05, 4.0546e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397081.9375, 397087.7500, 397093.6875, 397094.4375,
        397096.2500, 397108.5938, 397112.0625, 397126.9688, 772777.6250,
        779857.1250, 791919.3750, 807042.3750, 814040.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 405438.2188, 405447.4062, 405458.3125, 405462.5312,
        405464.6250, 405464.9375, 405469.5000, 405474.2500, 782531.1875,
        783211.1250, 791150.1250, 813471.0625, 814040.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 7.4170e-01, 8.4963e-01, 1.1565e+00, 1.1595e+00, 1.3674e+00,
        1.3740e+00, 1.4104e+00, 3.8256e+05, 3.8580e+05, 3.9708e+05, 3.9773e+05,
        3.9840e+05, 4.0547e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 382556.1875, 382582.6875, 382585.8125, 382597.3438,
        382600.8125, 382601.8438, 382609.0625, 382613.3125, 783006.8125,
        787365.6250, 791150.1250, 791919.3750, 803645.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.0845e-01, 9.6029e-01, 1.0181e+00, 1.0386e+00, 1.0622e+00,
        1.0839e+00, 1.1565e+00, 3.8260e+05, 3.8585e+05, 3.9710e+05, 3.9770e+05,
        3.9837e+05, 4.0546e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.4028e-01, 9.6029e-01, 9.7107e-01, 1.0140e+00, 1.1846e+00,
        1.3478e+00, 1.3674e+00, 3.8260e+05, 3.8584e+05, 3.9709e+05, 3.9770e+05,
        3.9835e+05, 4.0544e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['85379.28', '85380.76', '439970.69', '428755.06', '85379.78', '439317.06', '85377.59', '85382.80', '438842.16', '447356.75', '85373.70', '427083.72', '85384.16', '85383.20']
estimated f for each client, fs: [6, 6, 4, 5, 6, 4, 6, 6, 4, 4, 6, 5, 6, 6]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 17, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0088s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:41...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:41, End: 2025-07-22 15:29:41)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 9.6303e-01, 8.6044e-01, 3.8590e+05, 3.8303e+05, 1.0534e+00,
         3.9284e+05, 3.9647e+05, 8.6718e-01, 4.0702e+05, 9.9015e-01, 3.8391e+05,
         3.9562e+05, 8.2292e-01, 8.3306e-01, 3.8279e+05, 8.3142e-01, 9.2699e-01],
        [9.6303e-01, 0.0000e+00, 9.5820e-01, 3.8590e+05, 3.8304e+05, 1.0138e+00,
         3.9282e+05, 3.9646e+05, 9.2829e-01, 4.0701e+05, 1.0198e+00, 3.8388e+05,
         3.9564e+05, 9.4828e-01, 1.5489e+00, 3.8281e+05, 9.7952e-01, 9.3237e-01],
        [8.6044e-01, 9.5820e-01, 0.0000e+00, 3.8588e+05, 3.8306e+05, 9.8628e-01,
         3.9281e+05, 3.9647e+05, 8.3402e-01, 4.0703e+05, 9.1135e-01, 3.8391e+05,
         3.9562e+05, 8.9490e-01, 1.1730e+00, 3.8281e+05, 8.2138e-01, 9.3662e-01],
        [3.8590e+05, 3.8590e+05, 3.8588e+05, 0.0000e+00, 7.6067e+05, 3.8588e+05,
         7.7798e+05, 7.6244e+05, 3.8589e+05, 7.8600e+05, 3.8590e+05, 7.8136e+05,
         7.6696e+05, 3.8587e+05, 3.8592e+05, 7.6970e+05, 3.8590e+05, 3.8587e+05],
        [3.8303e+05, 3.8304e+05, 3.8306e+05, 7.6067e+05, 0.0000e+00, 3.8307e+05,
         7.6617e+05, 7.8548e+05, 3.8306e+05, 7.9960e+05, 3.8304e+05, 7.7606e+05,
         7.6218e+05, 3.8306e+05, 3.8305e+05, 7.5907e+05, 3.8305e+05, 3.8306e+05],
        [1.0534e+00, 1.0138e+00, 9.8628e-01, 3.8588e+05, 3.8307e+05, 0.0000e+00,
         3.9283e+05, 3.9646e+05, 9.5528e-01, 4.0703e+05, 9.4242e-01, 3.8391e+05,
         3.9563e+05, 9.2753e-01, 1.6814e+00, 3.8283e+05, 9.1560e-01, 8.8404e-01],
        [3.9284e+05, 3.9282e+05, 3.9281e+05, 7.7798e+05, 7.6617e+05, 3.9283e+05,
         0.0000e+00, 7.6932e+05, 3.9284e+05, 8.0382e+05, 3.9281e+05, 7.7744e+05,
         7.8293e+05, 3.9283e+05, 3.9284e+05, 7.7021e+05, 3.9281e+05, 3.9284e+05],
        [3.9647e+05, 3.9646e+05, 3.9647e+05, 7.6244e+05, 7.8548e+05, 3.9646e+05,
         7.6932e+05, 0.0000e+00, 3.9646e+05, 8.0737e+05, 3.9644e+05, 7.6877e+05,
         8.0135e+05, 3.9647e+05, 3.9649e+05, 7.6041e+05, 3.9647e+05, 3.9644e+05],
        [8.6718e-01, 9.2829e-01, 8.3402e-01, 3.8589e+05, 3.8306e+05, 9.5528e-01,
         3.9284e+05, 3.9646e+05, 0.0000e+00, 4.0700e+05, 9.4284e-01, 3.8390e+05,
         3.9560e+05, 9.0221e-01, 1.3057e+00, 3.8281e+05, 8.2501e-01, 8.5595e-01],
        [4.0702e+05, 4.0701e+05, 4.0703e+05, 7.8600e+05, 7.9960e+05, 4.0703e+05,
         8.0382e+05, 8.0737e+05, 4.0700e+05, 0.0000e+00, 4.0701e+05, 7.8080e+05,
         7.8729e+05, 4.0702e+05, 4.0701e+05, 7.9485e+05, 4.0705e+05, 4.0702e+05],
        [9.9015e-01, 1.0198e+00, 9.1135e-01, 3.8590e+05, 3.8304e+05, 9.4242e-01,
         3.9281e+05, 3.9644e+05, 9.4284e-01, 4.0701e+05, 0.0000e+00, 3.8392e+05,
         3.9562e+05, 9.6503e-01, 1.5173e+00, 3.8282e+05, 9.3507e-01, 8.7318e-01],
        [3.8391e+05, 3.8388e+05, 3.8391e+05, 7.8136e+05, 7.7606e+05, 3.8391e+05,
         7.7744e+05, 7.6877e+05, 3.8390e+05, 7.8080e+05, 3.8392e+05, 0.0000e+00,
         7.7069e+05, 3.8390e+05, 3.8391e+05, 7.7293e+05, 3.8391e+05, 3.8388e+05],
        [3.9562e+05, 3.9564e+05, 3.9562e+05, 7.6696e+05, 7.6218e+05, 3.9563e+05,
         7.8293e+05, 8.0135e+05, 3.9560e+05, 7.8729e+05, 3.9562e+05, 7.7069e+05,
         0.0000e+00, 3.9561e+05, 3.9559e+05, 7.8174e+05, 3.9560e+05, 3.9563e+05],
        [8.2292e-01, 9.4828e-01, 8.9490e-01, 3.8587e+05, 3.8306e+05, 9.2753e-01,
         3.9283e+05, 3.9647e+05, 9.0221e-01, 4.0702e+05, 9.6503e-01, 3.8390e+05,
         3.9561e+05, 0.0000e+00, 1.2593e+00, 3.8282e+05, 8.5210e-01, 9.0403e-01],
        [8.3306e-01, 1.5489e+00, 1.1730e+00, 3.8592e+05, 3.8305e+05, 1.6814e+00,
         3.9284e+05, 3.9649e+05, 1.3057e+00, 4.0701e+05, 1.5173e+00, 3.8391e+05,
         3.9559e+05, 1.2593e+00, 0.0000e+00, 3.8280e+05, 1.2515e+00, 1.5006e+00],
        [3.8279e+05, 3.8281e+05, 3.8281e+05, 7.6970e+05, 7.5907e+05, 3.8283e+05,
         7.7021e+05, 7.6041e+05, 3.8281e+05, 7.9485e+05, 3.8282e+05, 7.7293e+05,
         7.8174e+05, 3.8282e+05, 3.8280e+05, 0.0000e+00, 3.8281e+05, 3.8281e+05],
        [8.3142e-01, 9.7952e-01, 8.2138e-01, 3.8590e+05, 3.8305e+05, 9.1560e-01,
         3.9281e+05, 3.9647e+05, 8.2501e-01, 4.0705e+05, 9.3507e-01, 3.8391e+05,
         3.9560e+05, 8.5210e-01, 1.2515e+00, 3.8281e+05, 0.0000e+00, 8.5500e-01],
        [9.2699e-01, 9.3237e-01, 9.3662e-01, 3.8587e+05, 3.8306e+05, 8.8404e-01,
         3.9284e+05, 3.9644e+05, 8.5595e-01, 4.0702e+05, 8.7318e-01, 3.8388e+05,
         3.9563e+05, 9.0403e-01, 1.5006e+00, 3.8281e+05, 8.5500e-01, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.2292e-01, 8.3142e-01, 8.3306e-01, 8.6044e-01, 8.6718e-01,
        9.2699e-01, 9.6303e-01, 9.9015e-01, 1.0534e+00, 3.8279e+05, 3.8303e+05,
        3.8391e+05, 3.8590e+05, 3.9284e+05, 3.9562e+05, 3.9647e+05, 4.0702e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.2829e-01, 9.3237e-01, 9.4828e-01, 9.5820e-01, 9.6303e-01,
        9.7952e-01, 1.0138e+00, 1.0198e+00, 1.5489e+00, 3.8281e+05, 3.8304e+05,
        3.8388e+05, 3.8590e+05, 3.9282e+05, 3.9564e+05, 3.9646e+05, 4.0701e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.2138e-01, 8.3402e-01, 8.6044e-01, 8.9490e-01, 9.1135e-01,
        9.3662e-01, 9.5820e-01, 9.8628e-01, 1.1730e+00, 3.8281e+05, 3.8306e+05,
        3.8391e+05, 3.8588e+05, 3.9281e+05, 3.9562e+05, 3.9647e+05, 4.0703e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385869.4375, 385872.0312, 385876.3750, 385884.9375,
        385892.1250, 385895.8125, 385896.4062, 385898.4375, 385903.8750,
        385923.1875, 760665.3750, 762437.4375, 766957.9375, 769698.4375,
        777980.0000, 781358.0625, 785999.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 383034.2812, 383035.3750, 383043.5938, 383048.8750,
        383050.5000, 383055.1562, 383056.1250, 383059.4375, 383064.3125,
        383067.9062, 759069.0000, 760665.3750, 762176.5625, 766166.7500,
        776063.0000, 785484.1250, 799603.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.8404e-01, 9.1560e-01, 9.2753e-01, 9.4242e-01, 9.5528e-01,
        9.8628e-01, 1.0138e+00, 1.0534e+00, 1.6814e+00, 3.8283e+05, 3.8307e+05,
        3.8391e+05, 3.8588e+05, 3.9283e+05, 3.9563e+05, 3.9646e+05, 4.0703e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392809.0938, 392812.5000, 392812.7812, 392818.3750,
        392833.3125, 392834.9375, 392835.1562, 392836.6875, 392841.9688,
        392842.8750, 766166.7500, 769323.1875, 770209.0000, 777438.1250,
        777980.0000, 782925.3125, 803815.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396436.3750, 396437.9375, 396455.4062, 396456.1250,
        396462.4375, 396466.1875, 396466.6250, 396467.0938, 396473.1562,
        396487.0938, 760412.8125, 762437.4375, 768770.0000, 769323.1875,
        785484.1250, 801351.6250, 807372.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.2501e-01, 8.3402e-01, 8.5595e-01, 8.6718e-01, 9.0221e-01,
        9.2829e-01, 9.4284e-01, 9.5528e-01, 1.3057e+00, 3.8281e+05, 3.8306e+05,
        3.8390e+05, 3.8589e+05, 3.9284e+05, 3.9560e+05, 3.9646e+05, 4.0700e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 407004.3125, 407008.7812, 407008.8750, 407011.7812,
        407017.9062, 407018.8125, 407019.6875, 407032.0938, 407034.0938,
        407049.4375, 780796.8750, 785999.2500, 787292.0000, 794849.1250,
        799603.3750, 803815.8750, 807372.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.7318e-01, 9.1135e-01, 9.3507e-01, 9.4242e-01, 9.4284e-01,
        9.6503e-01, 9.9015e-01, 1.0198e+00, 1.5173e+00, 3.8282e+05, 3.8304e+05,
        3.8392e+05, 3.8590e+05, 3.9281e+05, 3.9562e+05, 3.9644e+05, 4.0701e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 383882.2188, 383884.5312, 383895.2500, 383897.9375,
        383905.2188, 383906.1250, 383907.7500, 383909.3125, 383910.6875,
        383920.0625, 768770.0000, 770693.3750, 772932.6250, 776063.0000,
        777438.1250, 780796.8750, 781358.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395592.1250, 395601.6250, 395603.0000, 395609.6250,
        395616.1250, 395617.4688, 395621.5938, 395625.7500, 395631.0000,
        395636.3125, 762176.5625, 766957.9375, 770693.3750, 781737.5000,
        782925.3125, 787292.0000, 801351.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.2292e-01, 8.5210e-01, 8.9490e-01, 9.0221e-01, 9.0403e-01,
        9.2753e-01, 9.4828e-01, 9.6503e-01, 1.2593e+00, 3.8282e+05, 3.8306e+05,
        3.8390e+05, 3.8587e+05, 3.9283e+05, 3.9561e+05, 3.9647e+05, 4.0702e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.3306e-01, 1.1730e+00, 1.2515e+00, 1.2593e+00, 1.3057e+00,
        1.5006e+00, 1.5173e+00, 1.5489e+00, 1.6814e+00, 3.8280e+05, 3.8305e+05,
        3.8391e+05, 3.8592e+05, 3.9284e+05, 3.9559e+05, 3.9649e+05, 4.0701e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382786.1875, 382804.9375, 382806.9688, 382809.0000,
        382811.1250, 382811.9062, 382814.7500, 382819.4375, 382824.8438,
        382830.7812, 759069.0000, 760412.8125, 769698.4375, 770209.0000,
        772932.6250, 781737.5000, 794849.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.2138e-01, 8.2501e-01, 8.3142e-01, 8.5210e-01, 8.5500e-01,
        9.1560e-01, 9.3507e-01, 9.7952e-01, 1.2515e+00, 3.8281e+05, 3.8305e+05,
        3.8391e+05, 3.8590e+05, 3.9281e+05, 3.9560e+05, 3.9647e+05, 4.0705e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.5500e-01, 8.5595e-01, 8.7318e-01, 8.8404e-01, 9.0403e-01,
        9.2699e-01, 9.3237e-01, 9.3662e-01, 1.5006e+00, 3.8281e+05, 3.8306e+05,
        3.8388e+05, 3.8587e+05, 3.9284e+05, 3.9563e+05, 3.9644e+05, 4.0702e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['69620.78', '69623.32', '69625.29', '419961.56', '417234.94', '69628.00', '426767.62', '429547.38', '69624.86', '441000.22', '69624.73', '418889.88', '428939.16', '69627.05', '69624.18', '417017.12', '69624.16', '69625.38']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 6, 6, 8, 6, 8, 7, 6, 8, 8, 6, 8, 8]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0307s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:41...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:41, End: 2025-07-22 15:29:41)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.3970e+00, 1.1219e+00, 3.8733e+05, 3.7605e+05, 1.5530e+00,
         1.3605e+00, 3.9996e+05, 1.1864e+00, 6.2182e-01, 1.3601e+00, 3.8703e+05,
         3.9052e+05, 1.1386e+00, 5.4331e-01, 3.9474e+05, 1.2189e+00, 1.3796e+00],
        [1.3970e+00, 0.0000e+00, 9.4856e-01, 3.8733e+05, 3.7607e+05, 1.0489e+00,
         9.4590e-01, 3.9995e+05, 9.1147e-01, 1.1764e+00, 1.0044e+00, 3.8705e+05,
         3.9047e+05, 9.5183e-01, 1.2079e+00, 3.9474e+05, 9.6828e-01, 9.6087e-01],
        [1.1219e+00, 9.4856e-01, 0.0000e+00, 3.8733e+05, 3.7606e+05, 9.8266e-01,
         8.8498e-01, 3.9998e+05, 8.0416e-01, 8.5477e-01, 8.3968e-01, 3.8703e+05,
         3.9049e+05, 8.5142e-01, 8.8010e-01, 3.9478e+05, 7.6942e-01, 9.2331e-01],
        [3.8733e+05, 3.8733e+05, 3.8733e+05, 0.0000e+00, 7.6838e+05, 3.8730e+05,
         3.8733e+05, 7.8668e+05, 3.8732e+05, 3.8734e+05, 3.8733e+05, 7.8267e+05,
         7.8227e+05, 3.8732e+05, 3.8733e+05, 7.9850e+05, 3.8733e+05, 3.8730e+05],
        [3.7605e+05, 3.7607e+05, 3.7606e+05, 7.6838e+05, 0.0000e+00, 3.7606e+05,
         3.7606e+05, 7.6722e+05, 3.7606e+05, 3.7606e+05, 3.7609e+05, 7.7680e+05,
         7.9455e+05, 3.7607e+05, 3.7605e+05, 7.7424e+05, 3.7605e+05, 3.7609e+05],
        [1.5530e+00, 1.0489e+00, 9.8266e-01, 3.8730e+05, 3.7606e+05, 0.0000e+00,
         9.2274e-01, 3.9993e+05, 9.7665e-01, 1.2883e+00, 9.5932e-01, 3.8706e+05,
         3.9049e+05, 9.4738e-01, 1.3378e+00, 3.9474e+05, 8.9857e-01, 9.2710e-01],
        [1.3605e+00, 9.4590e-01, 8.8498e-01, 3.8733e+05, 3.7606e+05, 9.2274e-01,
         0.0000e+00, 3.9996e+05, 8.9543e-01, 1.0752e+00, 9.1183e-01, 3.8707e+05,
         3.9049e+05, 8.7612e-01, 1.0969e+00, 3.9473e+05, 8.9033e-01, 9.1863e-01],
        [3.9996e+05, 3.9995e+05, 3.9998e+05, 7.8668e+05, 7.6722e+05, 3.9993e+05,
         3.9996e+05, 0.0000e+00, 3.9996e+05, 3.9996e+05, 3.9996e+05, 7.9621e+05,
         7.9418e+05, 3.9995e+05, 3.9997e+05, 7.9423e+05, 3.9995e+05, 3.9998e+05],
        [1.1864e+00, 9.1147e-01, 8.0416e-01, 3.8732e+05, 3.7606e+05, 9.7665e-01,
         8.9543e-01, 3.9996e+05, 0.0000e+00, 8.8521e-01, 9.3022e-01, 3.8705e+05,
         3.9050e+05, 8.6647e-01, 9.4432e-01, 3.9474e+05, 7.9727e-01, 8.6878e-01],
        [6.2182e-01, 1.1764e+00, 8.5477e-01, 3.8734e+05, 3.7606e+05, 1.2883e+00,
         1.0752e+00, 3.9996e+05, 8.8521e-01, 0.0000e+00, 1.1000e+00, 3.8705e+05,
         3.9052e+05, 9.1296e-01, 4.8083e-01, 3.9475e+05, 9.3899e-01, 1.1250e+00],
        [1.3601e+00, 1.0044e+00, 8.3968e-01, 3.8733e+05, 3.7609e+05, 9.5932e-01,
         9.1183e-01, 3.9996e+05, 9.3022e-01, 1.1000e+00, 0.0000e+00, 3.8705e+05,
         3.9051e+05, 9.2307e-01, 1.1571e+00, 3.9477e+05, 8.8332e-01, 8.8398e-01],
        [3.8703e+05, 3.8705e+05, 3.8703e+05, 7.8267e+05, 7.7680e+05, 3.8706e+05,
         3.8707e+05, 7.9621e+05, 3.8705e+05, 3.8705e+05, 3.8705e+05, 0.0000e+00,
         7.6481e+05, 3.8703e+05, 3.8705e+05, 7.8086e+05, 3.8704e+05, 3.8705e+05],
        [3.9052e+05, 3.9047e+05, 3.9049e+05, 7.8227e+05, 7.9455e+05, 3.9049e+05,
         3.9049e+05, 7.9418e+05, 3.9050e+05, 3.9052e+05, 3.9051e+05, 7.6481e+05,
         0.0000e+00, 3.9051e+05, 3.9050e+05, 7.8169e+05, 3.9049e+05, 3.9050e+05],
        [1.1386e+00, 9.5183e-01, 8.5142e-01, 3.8732e+05, 3.7607e+05, 9.4738e-01,
         8.7612e-01, 3.9995e+05, 8.6647e-01, 9.1296e-01, 9.2307e-01, 3.8703e+05,
         3.9051e+05, 0.0000e+00, 9.2421e-01, 3.9474e+05, 8.2368e-01, 8.9176e-01],
        [5.4331e-01, 1.2079e+00, 8.8010e-01, 3.8733e+05, 3.7605e+05, 1.3378e+00,
         1.0969e+00, 3.9997e+05, 9.4432e-01, 4.8083e-01, 1.1571e+00, 3.8705e+05,
         3.9050e+05, 9.2421e-01, 0.0000e+00, 3.9477e+05, 9.6656e-01, 1.1433e+00],
        [3.9474e+05, 3.9474e+05, 3.9478e+05, 7.9850e+05, 7.7424e+05, 3.9474e+05,
         3.9473e+05, 7.9423e+05, 3.9474e+05, 3.9475e+05, 3.9477e+05, 7.8086e+05,
         7.8169e+05, 3.9474e+05, 3.9477e+05, 0.0000e+00, 3.9475e+05, 3.9474e+05],
        [1.2189e+00, 9.6828e-01, 7.6942e-01, 3.8733e+05, 3.7605e+05, 8.9857e-01,
         8.9033e-01, 3.9995e+05, 7.9727e-01, 9.3899e-01, 8.8332e-01, 3.8704e+05,
         3.9049e+05, 8.2368e-01, 9.6656e-01, 3.9475e+05, 0.0000e+00, 8.6480e-01],
        [1.3796e+00, 9.6087e-01, 9.2331e-01, 3.8730e+05, 3.7609e+05, 9.2710e-01,
         9.1863e-01, 3.9998e+05, 8.6878e-01, 1.1250e+00, 8.8398e-01, 3.8705e+05,
         3.9050e+05, 8.9176e-01, 1.1433e+00, 3.9474e+05, 8.6480e-01, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 5.4331e-01, 6.2182e-01, 1.1219e+00, 1.1386e+00, 1.1864e+00,
        1.2189e+00, 1.3601e+00, 1.3605e+00, 1.3796e+00, 1.3970e+00, 1.5530e+00,
        3.7605e+05, 3.8703e+05, 3.8733e+05, 3.9052e+05, 3.9474e+05, 3.9996e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.1147e-01, 9.4590e-01, 9.4856e-01, 9.5183e-01, 9.6087e-01,
        9.6828e-01, 1.0044e+00, 1.0489e+00, 1.1764e+00, 1.2079e+00, 1.3970e+00,
        3.7607e+05, 3.8705e+05, 3.8733e+05, 3.9047e+05, 3.9474e+05, 3.9995e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 7.6942e-01, 8.0416e-01, 8.3968e-01, 8.5142e-01, 8.5477e-01,
        8.8010e-01, 8.8498e-01, 9.2331e-01, 9.4856e-01, 9.8266e-01, 1.1219e+00,
        3.7606e+05, 3.8703e+05, 3.8733e+05, 3.9049e+05, 3.9478e+05, 3.9998e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387295.6250, 387297.2188, 387320.2812, 387324.4062,
        387327.4688, 387330.1250, 387330.2500, 387330.5938, 387331.8750,
        387332.9062, 387334.1562, 387343.6250, 768383.0625, 782270.5000,
        782672.5000, 786682.5625, 798500.0000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 376047.7500, 376050.3750, 376053.5938, 376056.5938,
        376057.5312, 376063.9375, 376064.1250, 376064.7500, 376066.2500,
        376072.2188, 376088.0938, 376091.0312, 767217.9375, 768383.0625,
        774244.3750, 776795.1250, 794545.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.9857e-01, 9.2274e-01, 9.2710e-01, 9.4738e-01, 9.5932e-01,
        9.7665e-01, 9.8266e-01, 1.0489e+00, 1.2883e+00, 1.3378e+00, 1.5530e+00,
        3.7606e+05, 3.8706e+05, 3.8730e+05, 3.9049e+05, 3.9474e+05, 3.9993e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.7612e-01, 8.8498e-01, 8.9033e-01, 8.9543e-01, 9.1183e-01,
        9.1863e-01, 9.2274e-01, 9.4590e-01, 1.0752e+00, 1.0969e+00, 1.3605e+00,
        3.7606e+05, 3.8707e+05, 3.8733e+05, 3.9049e+05, 3.9473e+05, 3.9996e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 399931.3125, 399945.6250, 399946.2188, 399949.5000,
        399959.1250, 399960.0312, 399962.0938, 399963.5312, 399964.9688,
        399974.4062, 399975.3750, 399984.4062, 767217.9375, 786682.5625,
        794178.0625, 794234.0000, 796206.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 7.9727e-01, 8.0416e-01, 8.6647e-01, 8.6878e-01, 8.8521e-01,
        8.9543e-01, 9.1147e-01, 9.3022e-01, 9.4432e-01, 9.7665e-01, 1.1864e+00,
        3.7606e+05, 3.8705e+05, 3.8732e+05, 3.9050e+05, 3.9474e+05, 3.9996e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 4.8083e-01, 6.2182e-01, 8.5477e-01, 8.8521e-01, 9.1296e-01,
        9.3899e-01, 1.0752e+00, 1.1000e+00, 1.1250e+00, 1.1764e+00, 1.2883e+00,
        3.7606e+05, 3.8705e+05, 3.8734e+05, 3.9052e+05, 3.9475e+05, 3.9996e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.3968e-01, 8.8332e-01, 8.8398e-01, 9.1183e-01, 9.2307e-01,
        9.3022e-01, 9.5932e-01, 1.0044e+00, 1.1000e+00, 1.1571e+00, 1.3601e+00,
        3.7609e+05, 3.8705e+05, 3.8733e+05, 3.9051e+05, 3.9477e+05, 3.9996e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387031.0938, 387032.6250, 387033.5000, 387042.8438,
        387046.4062, 387047.8750, 387048.0938, 387049.6562, 387049.9062,
        387050.1875, 387061.2812, 387065.4375, 764813.4375, 776795.1250,
        780858.8750, 782672.5000, 796206.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 390471.7500, 390486.5312, 390489.6562, 390493.5312,
        390493.7188, 390497.7500, 390499.0938, 390502.3750, 390508.3125,
        390513.7812, 390518.2812, 390521.6562, 764813.4375, 781685.7500,
        782270.5000, 794178.0625, 794545.6250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 8.2368e-01, 8.5142e-01, 8.6647e-01, 8.7612e-01, 8.9176e-01,
        9.1296e-01, 9.2307e-01, 9.2421e-01, 9.4738e-01, 9.5183e-01, 1.1386e+00,
        3.7607e+05, 3.8703e+05, 3.8732e+05, 3.9051e+05, 3.9474e+05, 3.9995e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 4.8083e-01, 5.4331e-01, 8.8010e-01, 9.2421e-01, 9.4432e-01,
        9.6656e-01, 1.0969e+00, 1.1433e+00, 1.1571e+00, 1.2079e+00, 1.3378e+00,
        3.7605e+05, 3.8705e+05, 3.8733e+05, 3.9050e+05, 3.9477e+05, 3.9997e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 394730.5625, 394735.0000, 394739.2812, 394739.9375,
        394740.1562, 394742.1875, 394742.9375, 394748.3438, 394749.1562,
        394768.6562, 394769.4062, 394777.8750, 774244.3750, 780858.8750,
        781685.7500, 794234.0000, 798500.0000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 7.6942e-01, 7.9727e-01, 8.2368e-01, 8.6480e-01, 8.8332e-01,
        8.9033e-01, 8.9857e-01, 9.3899e-01, 9.6656e-01, 9.6828e-01, 1.2189e+00,
        3.7605e+05, 3.8704e+05, 3.8733e+05, 3.9049e+05, 3.9475e+05, 3.9995e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.6480e-01, 8.6878e-01, 8.8398e-01, 8.9176e-01, 9.1863e-01,
        9.2331e-01, 9.2710e-01, 9.6087e-01, 1.1250e+00, 1.1433e+00, 1.3796e+00,
        3.7609e+05, 3.8705e+05, 3.8730e+05, 3.9050e+05, 3.9474e+05, 3.9998e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['1.17', '1.05', '0.90', '387324.84', '376062.25', '1.08', '0.98', '399959.66', '0.92', '0.95', '1.00', '387046.53', '390499.66', '0.92', '0.97', '394748.62', '0.91', '0.99']
estimated f for each client, fs: [6, 6, 6, 4, 6, 6, 6, 4, 6, 6, 6, 4, 4, 6, 6, 4, 6, 6]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0148s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:42...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:42, End: 2025-07-22 15:29:42)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.1345e+00, 7.4828e-01, 3.8358e+05, 1.3431e+00, 1.1555e+00,
         3.9926e+05, 3.8979e+05, 3.9652e+05, 5.4799e-01, 1.1446e+00, 3.9187e+05,
         3.8763e+05, 9.2829e-01, 5.2250e-01, 3.8598e+05, 9.8726e-01],
        [1.1345e+00, 0.0000e+00, 1.2872e+00, 3.8359e+05, 1.0437e+00, 1.0008e+00,
         3.9926e+05, 3.8977e+05, 3.9652e+05, 1.2162e+00, 1.0223e+00, 3.9188e+05,
         3.8765e+05, 9.4998e-01, 1.2722e+00, 3.8598e+05, 1.0203e+00],
        [7.4828e-01, 1.2872e+00, 0.0000e+00, 3.8359e+05, 1.4528e+00, 1.2159e+00,
         3.9925e+05, 3.8979e+05, 3.9649e+05, 7.0789e-01, 1.2454e+00, 3.9187e+05,
         3.8762e+05, 1.0721e+00, 7.2274e-01, 3.8597e+05, 1.0995e+00],
        [3.8358e+05, 3.8359e+05, 3.8359e+05, 0.0000e+00, 3.8358e+05, 3.8358e+05,
         7.9409e+05, 7.7921e+05, 7.6427e+05, 3.8358e+05, 3.8358e+05, 7.9248e+05,
         7.5430e+05, 3.8356e+05, 3.8355e+05, 7.6613e+05, 3.8359e+05],
        [1.3431e+00, 1.0437e+00, 1.4528e+00, 3.8358e+05, 0.0000e+00, 9.9983e-01,
         3.9926e+05, 3.8976e+05, 3.9654e+05, 1.4122e+00, 1.0141e+00, 3.9188e+05,
         3.8764e+05, 9.9069e-01, 1.4963e+00, 3.8596e+05, 1.0363e+00],
        [1.1555e+00, 1.0008e+00, 1.2159e+00, 3.8358e+05, 9.9983e-01, 0.0000e+00,
         3.9925e+05, 3.8977e+05, 3.9654e+05, 1.1318e+00, 9.7511e-01, 3.9186e+05,
         3.8761e+05, 9.0723e-01, 1.2052e+00, 3.8600e+05, 1.0153e+00],
        [3.9926e+05, 3.9926e+05, 3.9925e+05, 7.9409e+05, 3.9926e+05, 3.9925e+05,
         0.0000e+00, 7.9432e+05, 8.0215e+05, 3.9926e+05, 3.9924e+05, 8.2334e+05,
         7.6985e+05, 3.9926e+05, 3.9926e+05, 7.8755e+05, 3.9925e+05],
        [3.8979e+05, 3.8977e+05, 3.8979e+05, 7.7921e+05, 3.8976e+05, 3.8977e+05,
         7.9432e+05, 0.0000e+00, 7.7057e+05, 3.8978e+05, 3.8976e+05, 7.7740e+05,
         7.5710e+05, 3.8977e+05, 3.8977e+05, 7.7697e+05, 3.8977e+05],
        [3.9652e+05, 3.9652e+05, 3.9649e+05, 7.6427e+05, 3.9654e+05, 3.9654e+05,
         8.0215e+05, 7.7057e+05, 0.0000e+00, 3.9653e+05, 3.9650e+05, 7.9369e+05,
         7.9924e+05, 3.9650e+05, 3.9649e+05, 7.4418e+05, 3.9652e+05],
        [5.4799e-01, 1.2162e+00, 7.0789e-01, 3.8358e+05, 1.4122e+00, 1.1318e+00,
         3.9926e+05, 3.8978e+05, 3.9653e+05, 0.0000e+00, 1.1797e+00, 3.9186e+05,
         3.8763e+05, 9.4036e-01, 5.2770e-01, 3.8598e+05, 9.7520e-01],
        [1.1446e+00, 1.0223e+00, 1.2454e+00, 3.8358e+05, 1.0141e+00, 9.7511e-01,
         3.9924e+05, 3.8976e+05, 3.9650e+05, 1.1797e+00, 0.0000e+00, 3.9186e+05,
         3.8762e+05, 9.7143e-01, 1.2515e+00, 3.8599e+05, 9.8302e-01],
        [3.9187e+05, 3.9188e+05, 3.9187e+05, 7.9248e+05, 3.9188e+05, 3.9186e+05,
         8.2334e+05, 7.7740e+05, 7.9369e+05, 3.9186e+05, 3.9186e+05, 0.0000e+00,
         7.8441e+05, 3.9186e+05, 3.9185e+05, 7.7763e+05, 3.9188e+05],
        [3.8763e+05, 3.8765e+05, 3.8762e+05, 7.5430e+05, 3.8764e+05, 3.8761e+05,
         7.6985e+05, 7.5710e+05, 7.9924e+05, 3.8763e+05, 3.8762e+05, 7.8441e+05,
         0.0000e+00, 3.8764e+05, 3.8763e+05, 7.8526e+05, 3.8764e+05],
        [9.2829e-01, 9.4998e-01, 1.0721e+00, 3.8356e+05, 9.9069e-01, 9.0723e-01,
         3.9926e+05, 3.8977e+05, 3.9650e+05, 9.4036e-01, 9.7143e-01, 3.9186e+05,
         3.8764e+05, 0.0000e+00, 1.0146e+00, 3.8599e+05, 8.9019e-01],
        [5.2250e-01, 1.2722e+00, 7.2274e-01, 3.8355e+05, 1.4963e+00, 1.2052e+00,
         3.9926e+05, 3.8977e+05, 3.9649e+05, 5.2770e-01, 1.2515e+00, 3.9185e+05,
         3.8763e+05, 1.0146e+00, 0.0000e+00, 3.8599e+05, 1.0510e+00],
        [3.8598e+05, 3.8598e+05, 3.8597e+05, 7.6613e+05, 3.8596e+05, 3.8600e+05,
         7.8755e+05, 7.7697e+05, 7.4418e+05, 3.8598e+05, 3.8599e+05, 7.7763e+05,
         7.8526e+05, 3.8599e+05, 3.8599e+05, 0.0000e+00, 3.8595e+05],
        [9.8726e-01, 1.0203e+00, 1.0995e+00, 3.8359e+05, 1.0363e+00, 1.0153e+00,
         3.9925e+05, 3.8977e+05, 3.9652e+05, 9.7520e-01, 9.8302e-01, 3.9188e+05,
         3.8764e+05, 8.9019e-01, 1.0510e+00, 3.8595e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 5.2250e-01, 5.4799e-01, 7.4828e-01, 9.2829e-01, 9.8726e-01,
        1.1345e+00, 1.1446e+00, 1.1555e+00, 1.3431e+00, 3.8358e+05, 3.8598e+05,
        3.8763e+05, 3.8979e+05, 3.9187e+05, 3.9652e+05, 3.9926e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4998e-01, 1.0008e+00, 1.0203e+00, 1.0223e+00, 1.0437e+00,
        1.1345e+00, 1.2162e+00, 1.2722e+00, 1.2872e+00, 3.8359e+05, 3.8598e+05,
        3.8765e+05, 3.8977e+05, 3.9188e+05, 3.9652e+05, 3.9926e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.0789e-01, 7.2274e-01, 7.4828e-01, 1.0721e+00, 1.0995e+00,
        1.2159e+00, 1.2454e+00, 1.2872e+00, 1.4528e+00, 3.8359e+05, 3.8597e+05,
        3.8762e+05, 3.8979e+05, 3.9187e+05, 3.9649e+05, 3.9925e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383554.5625, 383559.1562, 383576.5625, 383577.9062,
        383579.5625, 383580.8125, 383584.0312, 383589.5625, 383592.5625,
        383593.0938, 754301.6875, 764267.2500, 766134.3750, 779210.3750,
        792480.2500, 794090.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.9069e-01, 9.9983e-01, 1.0141e+00, 1.0363e+00, 1.0437e+00,
        1.3431e+00, 1.4122e+00, 1.4528e+00, 1.4963e+00, 3.8358e+05, 3.8596e+05,
        3.8764e+05, 3.8976e+05, 3.9188e+05, 3.9654e+05, 3.9926e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.0723e-01, 9.7511e-01, 9.9983e-01, 1.0008e+00, 1.0153e+00,
        1.1318e+00, 1.1555e+00, 1.2052e+00, 1.2159e+00, 3.8358e+05, 3.8600e+05,
        3.8761e+05, 3.8977e+05, 3.9186e+05, 3.9654e+05, 3.9925e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399238.2812, 399250.2500, 399252.1562, 399253.7188,
        399255.5312, 399255.6875, 399260.2812, 399260.3125, 399263.1250,
        399263.5938, 769852.6875, 787548.6250, 794090.6875, 794316.9375,
        802153.5625, 823341.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389760.3125, 389762.1875, 389766.8750, 389767.4375,
        389769.6875, 389773.5625, 389774.6562, 389777.3750, 389785.6562,
        389792.9688, 757098.6250, 770569.7500, 776973.7500, 777404.1250,
        779210.3750, 794316.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396486.5938, 396493.3750, 396497.4375, 396501.6250,
        396518.5938, 396522.8438, 396523.8750, 396530.2188, 396538.4062,
        396539.9062, 744182.0000, 764267.2500, 770569.7500, 793691.4375,
        799235.1250, 802153.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.2770e-01, 5.4799e-01, 7.0789e-01, 9.4036e-01, 9.7520e-01,
        1.1318e+00, 1.1797e+00, 1.2162e+00, 1.4122e+00, 3.8358e+05, 3.8598e+05,
        3.8763e+05, 3.8978e+05, 3.9186e+05, 3.9653e+05, 3.9926e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7143e-01, 9.7511e-01, 9.8302e-01, 1.0141e+00, 1.0223e+00,
        1.1446e+00, 1.1797e+00, 1.2454e+00, 1.2515e+00, 3.8358e+05, 3.8599e+05,
        3.8762e+05, 3.8976e+05, 3.9186e+05, 3.9650e+05, 3.9924e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391847.8438, 391856.5000, 391856.8750, 391857.7500,
        391863.8125, 391866.9375, 391868.2812, 391875.5625, 391875.8438,
        391881.8750, 777404.1250, 777633.0625, 784414.2500, 792480.2500,
        793691.4375, 823341.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387612.2188, 387617.6875, 387624.5000, 387625.6875,
        387628.6250, 387628.9062, 387635.8125, 387640.9688, 387642.1250,
        387652.7500, 754301.6875, 757098.6250, 769852.6875, 784414.2500,
        785258.8125, 799235.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9019e-01, 9.0723e-01, 9.2829e-01, 9.4036e-01, 9.4998e-01,
        9.7143e-01, 9.9069e-01, 1.0146e+00, 1.0721e+00, 3.8356e+05, 3.8599e+05,
        3.8764e+05, 3.8977e+05, 3.9186e+05, 3.9650e+05, 3.9926e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.2250e-01, 5.2770e-01, 7.2274e-01, 1.0146e+00, 1.0510e+00,
        1.2052e+00, 1.2515e+00, 1.2722e+00, 1.4963e+00, 3.8355e+05, 3.8599e+05,
        3.8763e+05, 3.8977e+05, 3.9185e+05, 3.9649e+05, 3.9926e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385945.5938, 385964.2500, 385973.0000, 385975.3438,
        385980.4688, 385983.4375, 385985.6875, 385986.9375, 385990.1875,
        385996.9688, 744182.0000, 766134.3750, 776973.7500, 777633.0625,
        785258.8125, 787548.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9019e-01, 9.7520e-01, 9.8302e-01, 9.8726e-01, 1.0153e+00,
        1.0203e+00, 1.0363e+00, 1.0510e+00, 1.0995e+00, 3.8359e+05, 3.8595e+05,
        3.8764e+05, 3.8977e+05, 3.9188e+05, 3.9652e+05, 3.9925e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38358.64', '38360.25', '38359.91', '383578.78', '38359.04', '38359.36', '399255.28', '389773.03', '396515.28', '38358.95', '38358.64', '391865.12', '387630.94', '38356.78', '38356.36', '385978.19', '38360.21']
estimated f for each client, fs: [7, 7, 7, 5, 7, 7, 5, 5, 5, 7, 7, 5, 5, 7, 7, 5, 7]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0385s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:43...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:43, End: 2025-07-22 15:29:43)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.0072e+00, 6.5615e-01, 3.9134e+05, 3.9495e+05, 1.1897e+00,
         1.0160e+00, 3.7745e+05, 3.9509e+05, 9.4640e-01, 3.8686e+05, 5.2234e-01,
         1.0593e+00, 3.8708e+05, 9.1309e-01, 6.1504e-01, 4.0691e+05, 9.1716e-01,
         1.0370e+00],
        [1.0072e+00, 0.0000e+00, 9.5327e-01, 3.9133e+05, 3.9499e+05, 1.0111e+00,
         9.0930e-01, 3.7745e+05, 3.9509e+05, 8.7646e-01, 3.8689e+05, 1.0278e+00,
         9.4485e-01, 3.8710e+05, 9.0452e-01, 1.5578e+00, 4.0692e+05, 9.1230e-01,
         9.0000e-01],
        [6.5615e-01, 9.5327e-01, 0.0000e+00, 3.9134e+05, 3.9497e+05, 1.0142e+00,
         8.8322e-01, 3.7742e+05, 3.9508e+05, 8.3365e-01, 3.8687e+05, 5.7550e-01,
         9.0784e-01, 3.8706e+05, 8.3732e-01, 8.4162e-01, 4.0694e+05, 7.9770e-01,
         9.4364e-01],
        [3.9134e+05, 3.9133e+05, 3.9134e+05, 0.0000e+00, 7.6007e+05, 3.9137e+05,
         3.9132e+05, 7.6828e+05, 7.7666e+05, 3.9133e+05, 7.9371e+05, 3.9132e+05,
         3.9134e+05, 7.8951e+05, 3.9134e+05, 3.9133e+05, 8.0544e+05, 3.9133e+05,
         3.9133e+05],
        [3.9495e+05, 3.9499e+05, 3.9497e+05, 7.6007e+05, 0.0000e+00, 3.9500e+05,
         3.9499e+05, 7.9101e+05, 8.0916e+05, 3.9496e+05, 7.8023e+05, 3.9494e+05,
         3.9496e+05, 7.8014e+05, 3.9498e+05, 3.9496e+05, 8.1728e+05, 3.9495e+05,
         3.9498e+05],
        [1.1897e+00, 1.0111e+00, 1.0142e+00, 3.9137e+05, 3.9500e+05, 0.0000e+00,
         9.3807e-01, 3.7742e+05, 3.9508e+05, 9.3621e-01, 3.8687e+05, 1.1672e+00,
         9.1594e-01, 3.8710e+05, 9.0891e-01, 1.7769e+00, 4.0694e+05, 9.1641e-01,
         8.5417e-01],
        [1.0160e+00, 9.0930e-01, 8.8322e-01, 3.9132e+05, 3.9499e+05, 9.3807e-01,
         0.0000e+00, 3.7743e+05, 3.9509e+05, 8.6060e-01, 3.8688e+05, 9.2895e-01,
         8.7881e-01, 3.8709e+05, 8.4522e-01, 1.4762e+00, 4.0695e+05, 8.9265e-01,
         8.6839e-01],
        [3.7745e+05, 3.7745e+05, 3.7742e+05, 7.6828e+05, 7.9101e+05, 3.7742e+05,
         3.7743e+05, 0.0000e+00, 7.7951e+05, 3.7743e+05, 7.6327e+05, 3.7743e+05,
         3.7741e+05, 7.7296e+05, 3.7741e+05, 3.7743e+05, 7.8127e+05, 3.7742e+05,
         3.7742e+05],
        [3.9509e+05, 3.9509e+05, 3.9508e+05, 7.7666e+05, 8.0916e+05, 3.9508e+05,
         3.9509e+05, 7.7951e+05, 0.0000e+00, 3.9509e+05, 7.6754e+05, 3.9510e+05,
         3.9507e+05, 7.9264e+05, 3.9511e+05, 3.9507e+05, 7.9678e+05, 3.9509e+05,
         3.9511e+05],
        [9.4640e-01, 8.7646e-01, 8.3365e-01, 3.9133e+05, 3.9496e+05, 9.3621e-01,
         8.6060e-01, 3.7743e+05, 3.9509e+05, 0.0000e+00, 3.8688e+05, 8.5749e-01,
         8.9151e-01, 3.8710e+05, 8.8004e-01, 1.3902e+00, 4.0690e+05, 8.3434e-01,
         8.3132e-01],
        [3.8686e+05, 3.8689e+05, 3.8687e+05, 7.9371e+05, 7.8023e+05, 3.8687e+05,
         3.8688e+05, 7.6327e+05, 7.6754e+05, 3.8688e+05, 0.0000e+00, 3.8688e+05,
         3.8689e+05, 7.7309e+05, 3.8686e+05, 3.8687e+05, 7.7168e+05, 3.8689e+05,
         3.8687e+05],
        [5.2234e-01, 1.0278e+00, 5.7550e-01, 3.9132e+05, 3.9494e+05, 1.1672e+00,
         9.2895e-01, 3.7743e+05, 3.9510e+05, 8.5749e-01, 3.8688e+05, 0.0000e+00,
         1.0246e+00, 3.8710e+05, 8.4937e-01, 6.4309e-01, 4.0693e+05, 8.3867e-01,
         9.9024e-01],
        [1.0593e+00, 9.4485e-01, 9.0784e-01, 3.9134e+05, 3.9496e+05, 9.1594e-01,
         8.7881e-01, 3.7741e+05, 3.9507e+05, 8.9151e-01, 3.8689e+05, 1.0246e+00,
         0.0000e+00, 3.8710e+05, 9.1696e-01, 1.5771e+00, 4.0693e+05, 8.8709e-01,
         8.3195e-01],
        [3.8708e+05, 3.8710e+05, 3.8706e+05, 7.8951e+05, 7.8014e+05, 3.8710e+05,
         3.8709e+05, 7.7296e+05, 7.9264e+05, 3.8710e+05, 7.7309e+05, 3.8710e+05,
         3.8710e+05, 0.0000e+00, 3.8713e+05, 3.8708e+05, 7.8440e+05, 3.8709e+05,
         3.8710e+05],
        [9.1309e-01, 9.0452e-01, 8.3732e-01, 3.9134e+05, 3.9498e+05, 9.0891e-01,
         8.4522e-01, 3.7741e+05, 3.9511e+05, 8.8004e-01, 3.8686e+05, 8.4937e-01,
         9.1696e-01, 3.8713e+05, 0.0000e+00, 1.3531e+00, 4.0693e+05, 8.2940e-01,
         8.5842e-01],
        [6.1504e-01, 1.5578e+00, 8.4162e-01, 3.9133e+05, 3.9496e+05, 1.7769e+00,
         1.4762e+00, 3.7743e+05, 3.9507e+05, 1.3902e+00, 3.8687e+05, 6.4309e-01,
         1.5771e+00, 3.8708e+05, 1.3531e+00, 0.0000e+00, 4.0690e+05, 1.3432e+00,
         1.5729e+00],
        [4.0691e+05, 4.0692e+05, 4.0694e+05, 8.0544e+05, 8.1728e+05, 4.0694e+05,
         4.0695e+05, 7.8127e+05, 7.9678e+05, 4.0690e+05, 7.7168e+05, 4.0693e+05,
         4.0693e+05, 7.8440e+05, 4.0693e+05, 4.0690e+05, 0.0000e+00, 4.0691e+05,
         4.0693e+05],
        [9.1716e-01, 9.1230e-01, 7.9770e-01, 3.9133e+05, 3.9495e+05, 9.1641e-01,
         8.9265e-01, 3.7742e+05, 3.9509e+05, 8.3434e-01, 3.8689e+05, 8.3867e-01,
         8.8709e-01, 3.8709e+05, 8.2940e-01, 1.3432e+00, 4.0691e+05, 0.0000e+00,
         8.4519e-01],
        [1.0370e+00, 9.0000e-01, 9.4364e-01, 3.9133e+05, 3.9498e+05, 8.5417e-01,
         8.6839e-01, 3.7742e+05, 3.9511e+05, 8.3132e-01, 3.8687e+05, 9.9024e-01,
         8.3195e-01, 3.8710e+05, 8.5842e-01, 1.5729e+00, 4.0693e+05, 8.4519e-01,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 5.2234e-01, 6.1504e-01, 6.5615e-01, 9.1309e-01, 9.1716e-01,
        9.4640e-01, 1.0072e+00, 1.0160e+00, 1.0370e+00, 1.0593e+00, 1.1897e+00,
        3.7745e+05, 3.8686e+05, 3.8708e+05, 3.9134e+05, 3.9495e+05, 3.9509e+05,
        4.0691e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.7646e-01, 9.0000e-01, 9.0452e-01, 9.0930e-01, 9.1230e-01,
        9.4485e-01, 9.5327e-01, 1.0072e+00, 1.0111e+00, 1.0278e+00, 1.5578e+00,
        3.7745e+05, 3.8689e+05, 3.8710e+05, 3.9133e+05, 3.9499e+05, 3.9509e+05,
        4.0692e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 5.7550e-01, 6.5615e-01, 7.9770e-01, 8.3365e-01, 8.3732e-01,
        8.4162e-01, 8.8322e-01, 9.0784e-01, 9.4364e-01, 9.5327e-01, 1.0142e+00,
        3.7742e+05, 3.8687e+05, 3.8706e+05, 3.9134e+05, 3.9497e+05, 3.9508e+05,
        4.0694e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391319.3125, 391322.4062, 391325.9062, 391326.7188,
        391326.8125, 391328.6875, 391330.5938, 391336.3438, 391336.6562,
        391339.8750, 391342.3438, 391370.2500, 760073.7500, 768276.8750,
        776659.2500, 789511.6875, 793714.9375, 805438.7500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 394942.9062, 394949.2500, 394954.5312, 394957.4062,
        394960.9688, 394963.0625, 394965.7500, 394981.0625, 394984.5938,
        394990.1250, 394990.2812, 394996.6875, 760073.7500, 780136.6250,
        780234.3125, 791011.1875, 809155.0000, 817281.5625])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 8.5417e-01, 9.0891e-01, 9.1594e-01, 9.1641e-01, 9.3621e-01,
        9.3807e-01, 1.0111e+00, 1.0142e+00, 1.1672e+00, 1.1897e+00, 1.7769e+00,
        3.7742e+05, 3.8687e+05, 3.8710e+05, 3.9137e+05, 3.9500e+05, 3.9508e+05,
        4.0694e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.4522e-01, 8.6060e-01, 8.6839e-01, 8.7881e-01, 8.8322e-01,
        8.9265e-01, 9.0930e-01, 9.2895e-01, 9.3807e-01, 1.0160e+00, 1.4762e+00,
        3.7743e+05, 3.8688e+05, 3.8709e+05, 3.9132e+05, 3.9499e+05, 3.9509e+05,
        4.0695e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 377410.1250, 377410.9062, 377418.2812, 377419.5625,
        377420.9375, 377422.7812, 377429.7500, 377429.8125, 377431.1250,
        377434.3438, 377449.4688, 377452.6562, 763270.6250, 768276.8750,
        772964.5625, 779512.0625, 781274.1875, 791011.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395071.1562, 395074.7500, 395080.2500, 395082.2500,
        395086.3438, 395088.8750, 395089.0938, 395090.6875, 395093.0625,
        395095.8125, 395107.0938, 395109.0625, 767537.2500, 776659.2500,
        779512.0625, 792644.8750, 796778.8125, 809155.0000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 8.3132e-01, 8.3365e-01, 8.3434e-01, 8.5749e-01, 8.6060e-01,
        8.7646e-01, 8.8004e-01, 8.9151e-01, 9.3621e-01, 9.4640e-01, 1.3902e+00,
        3.7743e+05, 3.8688e+05, 3.8710e+05, 3.9133e+05, 3.9496e+05, 3.9509e+05,
        4.0690e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386860.8125, 386863.4062, 386869.5000, 386870.0938,
        386873.8125, 386874.7500, 386875.0000, 386875.1562, 386883.9062,
        386886.5000, 386891.9375, 386894.1875, 763270.6250, 767537.2500,
        771681.8750, 773093.0625, 780234.3125, 793714.9375])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 5.2234e-01, 5.7550e-01, 6.4309e-01, 8.3867e-01, 8.4937e-01,
        8.5749e-01, 9.2895e-01, 9.9024e-01, 1.0246e+00, 1.0278e+00, 1.1672e+00,
        3.7743e+05, 3.8688e+05, 3.8710e+05, 3.9132e+05, 3.9494e+05, 3.9510e+05,
        4.0693e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.3195e-01, 8.7881e-01, 8.8709e-01, 8.9151e-01, 9.0784e-01,
        9.1594e-01, 9.1696e-01, 9.4485e-01, 1.0246e+00, 1.0593e+00, 1.5771e+00,
        3.7741e+05, 3.8689e+05, 3.8710e+05, 3.9134e+05, 3.9496e+05, 3.9507e+05,
        4.0693e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387060.8438, 387080.7500, 387084.5625, 387089.4688,
        387090.5938, 387095.6875, 387096.0938, 387097.2812, 387097.9062,
        387100.1562, 387104.8125, 387127.9688, 772964.5625, 773093.0625,
        780136.6250, 784400.8750, 789511.6875, 792644.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 8.2940e-01, 8.3732e-01, 8.4522e-01, 8.4937e-01, 8.5842e-01,
        8.8004e-01, 9.0452e-01, 9.0891e-01, 9.1309e-01, 9.1696e-01, 1.3531e+00,
        3.7741e+05, 3.8686e+05, 3.8713e+05, 3.9134e+05, 3.9498e+05, 3.9511e+05,
        4.0693e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 6.1504e-01, 6.4309e-01, 8.4162e-01, 1.3432e+00, 1.3531e+00,
        1.3902e+00, 1.4762e+00, 1.5578e+00, 1.5729e+00, 1.5771e+00, 1.7769e+00,
        3.7743e+05, 3.8687e+05, 3.8708e+05, 3.9133e+05, 3.9496e+05, 3.9507e+05,
        4.0690e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 406896.5312, 406900.2500, 406910.5312, 406913.7188,
        406923.1562, 406925.2188, 406925.3438, 406927.0312, 406934.6875,
        406941.4062, 406942.7500, 406948.2500, 771681.8750, 781274.1875,
        784400.8750, 796778.8125, 805438.7500, 817281.5625])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 7.9770e-01, 8.2940e-01, 8.3434e-01, 8.3867e-01, 8.4519e-01,
        8.8709e-01, 8.9265e-01, 9.1230e-01, 9.1641e-01, 9.1716e-01, 1.3432e+00,
        3.7742e+05, 3.8689e+05, 3.8709e+05, 3.9133e+05, 3.9495e+05, 3.9509e+05,
        4.0691e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.3132e-01, 8.3195e-01, 8.4519e-01, 8.5417e-01, 8.5842e-01,
        8.6839e-01, 9.0000e-01, 9.4364e-01, 9.9024e-01, 1.0370e+00, 1.5729e+00,
        3.7742e+05, 3.8687e+05, 3.8710e+05, 3.9133e+05, 3.9498e+05, 3.9511e+05,
        4.0693e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['0.90', '1.00', '0.84', '391333.88', '394969.75', '1.06', '0.95', '377425.22', '395089.06', '0.92', '386876.59', '0.86', '0.99', '387093.88', '0.92', '1.29', '406924.16', '0.91', '0.96']
estimated f for each client, fs: [7, 7, 7, 5, 5, 7, 7, 7, 5, 7, 5, 7, 7, 5, 7, 7, 5, 7, 7]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0384s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:43...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:43, End: 2025-07-22 15:29:43)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [7, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 11], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 3.9443e+05, 9.9161e-01, 8.9340e-01, 3.9828e+05, 3.9048e+05,
         8.6455e-01, 3.8595e+05, 9.6894e-01, 9.2162e-01, 3.9122e+05, 8.6950e-01],
        [3.9443e+05, 0.0000e+00, 3.9446e+05, 3.9445e+05, 7.5841e+05, 7.8848e+05,
         3.9446e+05, 7.7462e+05, 3.9446e+05, 3.9444e+05, 7.7448e+05, 3.9448e+05],
        [9.9161e-01, 3.9446e+05, 0.0000e+00, 9.7314e-01, 3.9830e+05, 3.9049e+05,
         9.4901e-01, 3.8596e+05, 1.1453e+00, 9.5385e-01, 3.9119e+05, 9.2819e-01],
        [8.9340e-01, 3.9445e+05, 9.7314e-01, 0.0000e+00, 3.9828e+05, 3.9050e+05,
         8.7184e-01, 3.8596e+05, 9.1392e-01, 8.9817e-01, 3.9123e+05, 8.4535e-01],
        [3.9828e+05, 7.5841e+05, 3.9830e+05, 3.9828e+05, 0.0000e+00, 7.9913e+05,
         3.9830e+05, 7.8010e+05, 3.9827e+05, 3.9827e+05, 7.9216e+05, 3.9829e+05],
        [3.9048e+05, 7.8848e+05, 3.9049e+05, 3.9050e+05, 7.9913e+05, 0.0000e+00,
         3.9050e+05, 7.8378e+05, 3.9049e+05, 3.9047e+05, 7.9015e+05, 3.9050e+05],
        [8.6455e-01, 3.9446e+05, 9.4901e-01, 8.7184e-01, 3.9830e+05, 3.9050e+05,
         0.0000e+00, 3.8597e+05, 8.1006e-01, 8.9234e-01, 3.9123e+05, 8.2427e-01],
        [3.8595e+05, 7.7462e+05, 3.8596e+05, 3.8596e+05, 7.8010e+05, 7.8378e+05,
         3.8597e+05, 0.0000e+00, 3.8594e+05, 3.8593e+05, 7.7704e+05, 3.8594e+05],
        [9.6894e-01, 3.9446e+05, 1.1453e+00, 9.1392e-01, 3.9827e+05, 3.9049e+05,
         8.1006e-01, 3.8594e+05, 0.0000e+00, 9.6945e-01, 3.9123e+05, 7.8807e-01],
        [9.2162e-01, 3.9444e+05, 9.5385e-01, 8.9817e-01, 3.9827e+05, 3.9047e+05,
         8.9234e-01, 3.8593e+05, 9.6945e-01, 0.0000e+00, 3.9123e+05, 8.9595e-01],
        [3.9122e+05, 7.7448e+05, 3.9119e+05, 3.9123e+05, 7.9216e+05, 7.9015e+05,
         3.9123e+05, 7.7704e+05, 3.9123e+05, 3.9123e+05, 0.0000e+00, 3.9121e+05],
        [8.6950e-01, 3.9448e+05, 9.2819e-01, 8.4535e-01, 3.9829e+05, 3.9050e+05,
         8.2427e-01, 3.8594e+05, 7.8807e-01, 8.9595e-01, 3.9121e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.6455e-01, 8.6950e-01, 8.9340e-01, 9.2162e-01, 9.6894e-01,
        9.9161e-01, 3.8595e+05, 3.9048e+05, 3.9122e+05, 3.9443e+05, 3.9828e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 394434.7500, 394444.1875, 394449.3750, 394455.2500,
        394457.6250, 394461.5938, 394475.1250, 758413.8750, 774482.8750,
        774623.3125, 788483.6875])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 9.2819e-01, 9.4901e-01, 9.5385e-01, 9.7314e-01, 9.9161e-01,
        1.1453e+00, 3.8596e+05, 3.9049e+05, 3.9119e+05, 3.9446e+05, 3.9830e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 8.4535e-01, 8.7184e-01, 8.9340e-01, 8.9817e-01, 9.1392e-01,
        9.7314e-01, 3.8596e+05, 3.9050e+05, 3.9123e+05, 3.9445e+05, 3.9828e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 398266.8438, 398271.3125, 398278.9062, 398281.0000,
        398289.0625, 398295.0000, 398301.1250, 758413.8750, 780100.5625,
        792158.8750, 799127.6875])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 390474.9375, 390483.1875, 390489.1562, 390489.3438,
        390496.4375, 390501.7188, 390503.4375, 783777.1250, 788483.6875,
        790150.0625, 799127.6875])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 8.1006e-01, 8.2427e-01, 8.6455e-01, 8.7184e-01, 8.9234e-01,
        9.4901e-01, 3.8597e+05, 3.9050e+05, 3.9123e+05, 3.9446e+05, 3.9830e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 385927.7188, 385942.5938, 385943.9688, 385949.3750,
        385956.3750, 385956.8438, 385967.5938, 774623.3125, 777039.6875,
        780100.5625, 783777.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 7.8807e-01, 8.1006e-01, 9.1392e-01, 9.6894e-01, 9.6945e-01,
        1.1453e+00, 3.8594e+05, 3.9049e+05, 3.9123e+05, 3.9446e+05, 3.9827e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 8.9234e-01, 8.9595e-01, 8.9817e-01, 9.2162e-01, 9.5385e-01,
        9.6945e-01, 3.8593e+05, 3.9047e+05, 3.9123e+05, 3.9444e+05, 3.9827e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 391188.3125, 391213.3125, 391216.3125, 391225.4062,
        391227.6250, 391228.2812, 391230.2500, 774482.8750, 777039.6875,
        790150.0625, 792158.8750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 7.8807e-01, 8.2427e-01, 8.4535e-01, 8.6950e-01, 8.9595e-01,
        9.2819e-01, 3.8594e+05, 3.9050e+05, 3.9121e+05, 3.9448e+05, 3.9829e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['97054.77', '439949.00', '97056.44', '97058.21', '443299.72', '439651.94', '97059.32', '434533.47', '97054.87', '97051.03', '439126.56', '97055.53']
estimated f for each client, fs: [5, 3, 5, 5, 3, 4, 5, 4, 5, 5, 3, 5]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']], selected_client_indices: [7, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0072s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:44...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:44, End: 2025-07-22 15:29:44)
start time is: 97147974631672, end time is: 97165953587768
The total time is: 17978956096ns.

 ------- aggregate method: rkrum, random_seed: 300 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 4.5885e+00, 5.3059e+00, 3.9461e+05, 5.9678e+00, 5.8961e+00,
         3.8581e+05, 4.0084e+05, 6.6234e+00, 3.8757e+05, 5.0162e+00, 6.8802e+00,
         3.9450e+05, 4.9404e+00, 5.7607e+00, 3.9215e+05, 6.7969e+00],
        [4.5885e+00, 0.0000e+00, 6.3460e+00, 3.9455e+05, 5.6344e+00, 5.8609e+00,
         3.8574e+05, 4.0085e+05, 7.4839e+00, 3.8757e+05, 4.8732e+00, 6.9788e+00,
         3.9446e+05, 5.3335e+00, 5.3128e+00, 3.9217e+05, 7.2557e+00],
        [5.3059e+00, 6.3460e+00, 0.0000e+00, 3.9455e+05, 5.6893e+00, 5.2117e+00,
         3.8580e+05, 4.0085e+05, 5.6795e+00, 3.8756e+05, 6.2364e+00, 5.2810e+00,
         3.9444e+05, 4.8866e+00, 5.9773e+00, 3.9210e+05, 5.3004e+00],
        [3.9461e+05, 3.9455e+05, 3.9455e+05, 0.0000e+00, 3.9460e+05, 3.9462e+05,
         7.6432e+05, 8.0061e+05, 3.9459e+05, 7.7157e+05, 3.9458e+05, 3.9459e+05,
         8.0581e+05, 3.9457e+05, 3.9459e+05, 7.8088e+05, 3.9458e+05],
        [5.9678e+00, 5.6344e+00, 5.6893e+00, 3.9460e+05, 0.0000e+00, 4.5143e+00,
         3.8583e+05, 4.0087e+05, 6.4382e+00, 3.8749e+05, 5.3623e+00, 5.8694e+00,
         3.9444e+05, 4.6684e+00, 5.7243e+00, 3.9216e+05, 5.4096e+00],
        [5.8961e+00, 5.8609e+00, 5.2117e+00, 3.9462e+05, 4.5143e+00, 0.0000e+00,
         3.8575e+05, 4.0086e+05, 5.7349e+00, 3.8750e+05, 5.5761e+00, 4.9495e+00,
         3.9440e+05, 4.4820e+00, 5.4640e+00, 3.9215e+05, 5.7777e+00],
        [3.8581e+05, 3.8574e+05, 3.8580e+05, 7.6432e+05, 3.8583e+05, 3.8575e+05,
         0.0000e+00, 7.9970e+05, 3.8581e+05, 7.9490e+05, 3.8573e+05, 3.8577e+05,
         7.7936e+05, 3.8575e+05, 3.8575e+05, 7.9082e+05, 3.8585e+05],
        [4.0084e+05, 4.0085e+05, 4.0085e+05, 8.0061e+05, 4.0087e+05, 4.0086e+05,
         7.9970e+05, 0.0000e+00, 4.0091e+05, 7.8148e+05, 4.0081e+05, 4.0087e+05,
         7.8355e+05, 4.0087e+05, 4.0088e+05, 8.0225e+05, 4.0091e+05],
        [6.6234e+00, 7.4839e+00, 5.6795e+00, 3.9459e+05, 6.4382e+00, 5.7349e+00,
         3.8581e+05, 4.0091e+05, 0.0000e+00, 3.8753e+05, 7.2751e+00, 5.5815e+00,
         3.9449e+05, 6.2644e+00, 6.9607e+00, 3.9213e+05, 6.5382e+00],
        [3.8757e+05, 3.8757e+05, 3.8756e+05, 7.7157e+05, 3.8749e+05, 3.8750e+05,
         7.9490e+05, 7.8148e+05, 3.8753e+05, 0.0000e+00, 3.8754e+05, 3.8748e+05,
         7.8689e+05, 3.8752e+05, 3.8746e+05, 7.8301e+05, 3.8755e+05],
        [5.0162e+00, 4.8732e+00, 6.2364e+00, 3.9458e+05, 5.3623e+00, 5.5761e+00,
         3.8573e+05, 4.0081e+05, 7.2751e+00, 3.8754e+05, 0.0000e+00, 6.9478e+00,
         3.9438e+05, 5.0830e+00, 5.0606e+00, 3.9221e+05, 6.4705e+00],
        [6.8802e+00, 6.9788e+00, 5.2810e+00, 3.9459e+05, 5.8694e+00, 4.9495e+00,
         3.8577e+05, 4.0087e+05, 5.5815e+00, 3.8748e+05, 6.9478e+00, 0.0000e+00,
         3.9448e+05, 5.7410e+00, 6.0610e+00, 3.9213e+05, 5.9763e+00],
        [3.9450e+05, 3.9446e+05, 3.9444e+05, 8.0581e+05, 3.9444e+05, 3.9440e+05,
         7.7936e+05, 7.8355e+05, 3.9449e+05, 7.8689e+05, 3.9438e+05, 3.9448e+05,
         0.0000e+00, 3.9440e+05, 3.9444e+05, 8.0577e+05, 3.9442e+05],
        [4.9404e+00, 5.3335e+00, 4.8866e+00, 3.9457e+05, 4.6684e+00, 4.4820e+00,
         3.8575e+05, 4.0087e+05, 6.2644e+00, 3.8752e+05, 5.0830e+00, 5.7410e+00,
         3.9440e+05, 0.0000e+00, 4.7754e+00, 3.9221e+05, 5.0823e+00],
        [5.7607e+00, 5.3128e+00, 5.9773e+00, 3.9459e+05, 5.7243e+00, 5.4640e+00,
         3.8575e+05, 4.0088e+05, 6.9607e+00, 3.8746e+05, 5.0606e+00, 6.0610e+00,
         3.9444e+05, 4.7754e+00, 0.0000e+00, 3.9221e+05, 6.5818e+00],
        [3.9215e+05, 3.9217e+05, 3.9210e+05, 7.8088e+05, 3.9216e+05, 3.9215e+05,
         7.9082e+05, 8.0225e+05, 3.9213e+05, 7.8301e+05, 3.9221e+05, 3.9213e+05,
         8.0577e+05, 3.9221e+05, 3.9221e+05, 0.0000e+00, 3.9213e+05],
        [6.7969e+00, 7.2557e+00, 5.3004e+00, 3.9458e+05, 5.4096e+00, 5.7777e+00,
         3.8585e+05, 4.0091e+05, 6.5382e+00, 3.8755e+05, 6.4705e+00, 5.9763e+00,
         3.9442e+05, 5.0823e+00, 6.5818e+00, 3.9213e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 4.5885e+00, 4.9404e+00, 5.0162e+00, 5.3059e+00, 5.7607e+00,
        5.8961e+00, 5.9678e+00, 6.6234e+00, 6.7969e+00, 6.8802e+00, 3.8581e+05,
        3.8757e+05, 3.9215e+05, 3.9450e+05, 3.9461e+05, 4.0084e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.5885e+00, 4.8732e+00, 5.3128e+00, 5.3335e+00, 5.6344e+00,
        5.8609e+00, 6.3460e+00, 6.9788e+00, 7.2557e+00, 7.4839e+00, 3.8574e+05,
        3.8757e+05, 3.9217e+05, 3.9446e+05, 3.9455e+05, 4.0085e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.8866e+00, 5.2117e+00, 5.2810e+00, 5.3004e+00, 5.3059e+00,
        5.6795e+00, 5.6893e+00, 5.9773e+00, 6.2364e+00, 6.3460e+00, 3.8580e+05,
        3.8756e+05, 3.9210e+05, 3.9444e+05, 3.9455e+05, 4.0085e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394551.6562, 394553.5938, 394570.6875, 394577.6562,
        394578.0625, 394587.2188, 394593.3438, 394593.8750, 394601.3750,
        394614.5312, 394621.1875, 764319.0625, 771571.7500, 780878.5000,
        800614.8750, 805807.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 4.5143e+00, 4.6684e+00, 5.3623e+00, 5.4096e+00, 5.6344e+00,
        5.6893e+00, 5.7243e+00, 5.8694e+00, 5.9678e+00, 6.4382e+00, 3.8583e+05,
        3.8749e+05, 3.9216e+05, 3.9444e+05, 3.9460e+05, 4.0087e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.4820e+00, 4.5143e+00, 4.9495e+00, 5.2117e+00, 5.4640e+00,
        5.5761e+00, 5.7349e+00, 5.7777e+00, 5.8609e+00, 5.8961e+00, 3.8575e+05,
        3.8750e+05, 3.9215e+05, 3.9440e+05, 3.9462e+05, 4.0086e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385734.3750, 385743.2188, 385746.3438, 385746.6875,
        385747.5312, 385766.4062, 385801.3438, 385811.4375, 385814.7812,
        385827.2500, 385848.4375, 764319.0625, 779360.9375, 790817.3750,
        794899.2500, 799696.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 400805.5938, 400842.6250, 400846.6875, 400849.5000,
        400858.1250, 400865.8438, 400868.3125, 400870.1875, 400877.0625,
        400906.2500, 400910.4375, 781481.1875, 783549.8750, 799696.6250,
        800614.8750, 802246.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 5.5815e+00, 5.6795e+00, 5.7349e+00, 6.2644e+00, 6.4382e+00,
        6.5382e+00, 6.6234e+00, 6.9607e+00, 7.2751e+00, 7.4839e+00, 3.8581e+05,
        3.8753e+05, 3.9213e+05, 3.9449e+05, 3.9459e+05, 4.0091e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387464.9375, 387480.5312, 387493.1250, 387496.3125,
        387524.9375, 387534.2188, 387535.7812, 387545.5312, 387559.8750,
        387569.5938, 387574.3438, 771571.7500, 781481.1875, 783008.0000,
        786893.5625, 794899.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 4.8732e+00, 5.0162e+00, 5.0606e+00, 5.0830e+00, 5.3623e+00,
        5.5761e+00, 6.2364e+00, 6.4705e+00, 6.9478e+00, 7.2751e+00, 3.8573e+05,
        3.8754e+05, 3.9221e+05, 3.9438e+05, 3.9458e+05, 4.0081e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.9495e+00, 5.2810e+00, 5.5815e+00, 5.7410e+00, 5.8694e+00,
        5.9763e+00, 6.0610e+00, 6.8802e+00, 6.9478e+00, 6.9788e+00, 3.8577e+05,
        3.8748e+05, 3.9213e+05, 3.9448e+05, 3.9459e+05, 4.0087e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394383.8750, 394399.3125, 394402.2812, 394420.9688,
        394441.6875, 394443.8750, 394444.6250, 394460.6250, 394481.0938,
        394485.8438, 394502.0625, 779360.9375, 783549.8750, 786893.5625,
        805772.8750, 805807.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 4.4820e+00, 4.6684e+00, 4.7754e+00, 4.8866e+00, 4.9404e+00,
        5.0823e+00, 5.0830e+00, 5.3335e+00, 5.7410e+00, 6.2644e+00, 3.8575e+05,
        3.8752e+05, 3.9221e+05, 3.9440e+05, 3.9457e+05, 4.0087e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.7754e+00, 5.0606e+00, 5.3128e+00, 5.4640e+00, 5.7243e+00,
        5.7607e+00, 5.9773e+00, 6.0610e+00, 6.5818e+00, 6.9607e+00, 3.8575e+05,
        3.8746e+05, 3.9221e+05, 3.9444e+05, 3.9459e+05, 4.0088e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392097.8438, 392129.5000, 392132.2812, 392134.6875,
        392147.7188, 392148.8438, 392163.3125, 392171.7500, 392207.2812,
        392213.5312, 392214.2188, 780878.5000, 783008.0000, 790817.3750,
        802246.6250, 805772.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 5.0823e+00, 5.3004e+00, 5.4096e+00, 5.7777e+00, 5.9763e+00,
        6.4705e+00, 6.5382e+00, 6.5818e+00, 6.7969e+00, 7.2557e+00, 3.8585e+05,
        3.8755e+05, 3.9213e+05, 3.9442e+05, 3.9458e+05, 4.0091e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['5.78', '5.97', '5.59', '394585.75', '5.53', '5.35', '385780.69', '400863.66', '6.46', '387525.38', '5.79', '6.03', '394442.38', '5.13', '5.77', '392160.06', '6.12']
estimated f for each client, fs: [6, 6, 6, 4, 6, 6, 4, 4, 6, 4, 6, 6, 4, 6, 6, 4, 6]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0165s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:44...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[159  78]
 [ 47 216]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:44, End: 2025-07-22 15:29:44)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 2, 19, 17, 9, 18, 15, 3, 11, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 2.0684e+00, 3.9862e+05, 4.0224e+05, 2.1047e+00, 4.1277e+05,
         4.0107e+05, 1.9702e+00, 1.9938e+00, 1.9584e+00, 4.1013e+05, 2.1077e+00,
         1.9828e+00],
        [2.0684e+00, 0.0000e+00, 3.9858e+05, 4.0223e+05, 1.9201e+00, 4.1272e+05,
         4.0108e+05, 2.0285e+00, 2.2364e+00, 1.9571e+00, 4.1013e+05, 1.9088e+00,
         1.9611e+00],
        [3.9862e+05, 3.9858e+05, 0.0000e+00, 8.0320e+05, 3.9859e+05, 7.9528e+05,
         8.1099e+05, 3.9865e+05, 3.9861e+05, 3.9864e+05, 8.0255e+05, 3.9861e+05,
         3.9862e+05],
        [4.0224e+05, 4.0223e+05, 8.0320e+05, 0.0000e+00, 4.0225e+05, 8.2243e+05,
         8.2939e+05, 4.0221e+05, 4.0227e+05, 4.0220e+05, 7.7486e+05, 4.0217e+05,
         4.0223e+05],
        [2.1047e+00, 1.9201e+00, 3.9859e+05, 4.0225e+05, 0.0000e+00, 4.1279e+05,
         4.0108e+05, 1.7668e+00, 2.0740e+00, 1.9203e+00, 4.1014e+05, 1.9554e+00,
         1.9082e+00],
        [4.1277e+05, 4.1272e+05, 7.9528e+05, 8.2243e+05, 4.1279e+05, 0.0000e+00,
         8.2454e+05, 4.1276e+05, 4.1278e+05, 4.1275e+05, 8.1169e+05, 4.1278e+05,
         4.1273e+05],
        [4.0107e+05, 4.0108e+05, 8.1099e+05, 8.2939e+05, 4.0108e+05, 8.2454e+05,
         0.0000e+00, 4.0111e+05, 4.0108e+05, 4.0112e+05, 8.1508e+05, 4.0111e+05,
         4.0110e+05],
        [1.9702e+00, 2.0285e+00, 3.9865e+05, 4.0221e+05, 1.7668e+00, 4.1276e+05,
         4.0111e+05, 0.0000e+00, 2.2952e+00, 1.9507e+00, 4.1013e+05, 2.1434e+00,
         1.8534e+00],
        [1.9938e+00, 2.2364e+00, 3.9861e+05, 4.0227e+05, 2.0740e+00, 4.1278e+05,
         4.0108e+05, 2.2952e+00, 0.0000e+00, 2.1515e+00, 4.1009e+05, 2.1816e+00,
         2.0532e+00],
        [1.9584e+00, 1.9571e+00, 3.9864e+05, 4.0220e+05, 1.9203e+00, 4.1275e+05,
         4.0112e+05, 1.9507e+00, 2.1515e+00, 0.0000e+00, 4.1011e+05, 1.9822e+00,
         1.8601e+00],
        [4.1013e+05, 4.1013e+05, 8.0255e+05, 7.7486e+05, 4.1014e+05, 8.1169e+05,
         8.1508e+05, 4.1013e+05, 4.1009e+05, 4.1011e+05, 0.0000e+00, 4.1008e+05,
         4.1012e+05],
        [2.1077e+00, 1.9088e+00, 3.9861e+05, 4.0217e+05, 1.9554e+00, 4.1278e+05,
         4.0111e+05, 2.1434e+00, 2.1816e+00, 1.9822e+00, 4.1008e+05, 0.0000e+00,
         1.9709e+00],
        [1.9828e+00, 1.9611e+00, 3.9862e+05, 4.0223e+05, 1.9082e+00, 4.1273e+05,
         4.0110e+05, 1.8534e+00, 2.0532e+00, 1.8601e+00, 4.1012e+05, 1.9709e+00,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.9584e+00, 1.9702e+00, 1.9828e+00, 1.9938e+00, 2.0684e+00,
        2.1047e+00, 2.1077e+00, 3.9862e+05, 4.0107e+05, 4.0224e+05, 4.1013e+05,
        4.1277e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.9088e+00, 1.9201e+00, 1.9571e+00, 1.9611e+00, 2.0285e+00,
        2.0684e+00, 2.2364e+00, 3.9858e+05, 4.0108e+05, 4.0223e+05, 4.1013e+05,
        4.1272e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 398576.0625, 398588.3750, 398605.1875, 398611.0000,
        398616.2188, 398617.5625, 398642.1562, 398650.7812, 795278.5625,
        802546.0000, 803199.8750, 810990.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 402172.3125, 402203.8438, 402206.5625, 402227.7188,
        402232.9062, 402238.9062, 402251.1562, 402265.2500, 774864.3125,
        803199.8750, 822428.2500, 829392.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.7668e+00, 1.9082e+00, 1.9201e+00, 1.9203e+00, 1.9554e+00,
        2.0740e+00, 2.1047e+00, 3.9859e+05, 4.0108e+05, 4.0225e+05, 4.1014e+05,
        4.1279e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 412718.8125, 412727.4688, 412751.2500, 412760.9688,
        412771.6562, 412778.5938, 412783.4688, 412788.9375, 795278.5625,
        811685.5000, 822428.2500, 824541.8750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 401073.3125, 401078.6875, 401083.5000, 401083.8438,
        401098.6250, 401106.8750, 401109.6562, 401116.4375, 810990.1250,
        815082.1875, 824541.8750, 829392.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.7668e+00, 1.8534e+00, 1.9507e+00, 1.9702e+00, 2.0285e+00,
        2.1434e+00, 2.2952e+00, 3.9865e+05, 4.0111e+05, 4.0221e+05, 4.1013e+05,
        4.1276e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.9938e+00, 2.0532e+00, 2.0740e+00, 2.1515e+00, 2.1816e+00,
        2.2364e+00, 2.2952e+00, 3.9861e+05, 4.0108e+05, 4.0227e+05, 4.1009e+05,
        4.1278e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.8601e+00, 1.9203e+00, 1.9507e+00, 1.9571e+00, 1.9584e+00,
        1.9822e+00, 2.1515e+00, 3.9864e+05, 4.0112e+05, 4.0220e+05, 4.1011e+05,
        4.1275e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 410076.1250, 410087.0625, 410108.9375, 410119.7812,
        410128.6875, 410133.7812, 410134.6250, 410141.5625, 774864.3125,
        802546.0000, 811685.5000, 815082.1875])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.9088e+00, 1.9554e+00, 1.9709e+00, 1.9822e+00, 2.1077e+00,
        2.1434e+00, 2.1816e+00, 3.9861e+05, 4.0111e+05, 4.0217e+05, 4.1008e+05,
        4.1278e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.8534e+00, 1.8601e+00, 1.9082e+00, 1.9611e+00, 1.9709e+00,
        1.9828e+00, 2.0532e+00, 3.9862e+05, 4.0110e+05, 4.0223e+05, 4.1012e+05,
        4.1273e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['49828.97', '49823.77', '398613.41', '402224.84', '49825.25', '412760.16', '401093.88', '49833.10', '49828.25', '49832.00', '410116.31', '49827.43', '49828.73']
estimated f for each client, fs: [5, 5, 3, 3, 5, 3, 4, 5, 5, 5, 3, 5, 5]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 2, 19, 17, 9, 18, 15, 3, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0099s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:45...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:45, End: 2025-07-22 15:29:45)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 11, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.7864e+05, 3.9776e+05, 1.7282e+00, 3.8811e+05, 3.9795e+05,
         1.9295e+00, 3.9783e+05, 1.7983e+00, 1.9129e+00, 3.8403e+05, 1.9312e+00,
         3.9576e+05, 1.9667e+00, 1.8219e+00],
        [3.7864e+05, 0.0000e+00, 7.6989e+05, 3.7860e+05, 7.5174e+05, 7.7253e+05,
         3.7864e+05, 7.6803e+05, 3.7862e+05, 3.7860e+05, 7.6854e+05, 3.7863e+05,
         7.8642e+05, 3.7864e+05, 3.7861e+05],
        [3.9776e+05, 7.6989e+05, 0.0000e+00, 3.9780e+05, 7.7036e+05, 8.0155e+05,
         3.9777e+05, 7.8726e+05, 3.9777e+05, 3.9776e+05, 7.9839e+05, 3.9778e+05,
         7.9338e+05, 3.9779e+05, 3.9777e+05],
        [1.7282e+00, 3.7860e+05, 3.9780e+05, 0.0000e+00, 3.8817e+05, 3.9792e+05,
         1.7320e+00, 3.9787e+05, 1.7701e+00, 1.5995e+00, 3.8404e+05, 1.7450e+00,
         3.9574e+05, 1.7549e+00, 1.7260e+00],
        [3.8811e+05, 7.5174e+05, 7.7036e+05, 3.8817e+05, 0.0000e+00, 7.7004e+05,
         3.8816e+05, 7.7276e+05, 3.8814e+05, 3.8811e+05, 7.8064e+05, 3.8816e+05,
         7.8478e+05, 3.8816e+05, 3.8814e+05],
        [3.9795e+05, 7.7253e+05, 8.0155e+05, 3.9792e+05, 7.7004e+05, 0.0000e+00,
         3.9794e+05, 7.9241e+05, 3.9792e+05, 3.9795e+05, 7.7061e+05, 3.9791e+05,
         7.7544e+05, 3.9792e+05, 3.9793e+05],
        [1.9295e+00, 3.7864e+05, 3.9777e+05, 1.7320e+00, 3.8816e+05, 3.9794e+05,
         0.0000e+00, 3.9784e+05, 1.6882e+00, 1.8451e+00, 3.8401e+05, 1.9157e+00,
         3.9577e+05, 1.8357e+00, 1.8180e+00],
        [3.9783e+05, 7.6803e+05, 7.8726e+05, 3.9787e+05, 7.7276e+05, 7.9241e+05,
         3.9784e+05, 0.0000e+00, 3.9785e+05, 3.9786e+05, 7.7416e+05, 3.9780e+05,
         7.6102e+05, 3.9784e+05, 3.9783e+05],
        [1.7983e+00, 3.7862e+05, 3.9777e+05, 1.7701e+00, 3.8814e+05, 3.9792e+05,
         1.6882e+00, 3.9785e+05, 0.0000e+00, 1.8505e+00, 3.8405e+05, 1.8196e+00,
         3.9578e+05, 1.7818e+00, 1.6692e+00],
        [1.9129e+00, 3.7860e+05, 3.9776e+05, 1.5995e+00, 3.8811e+05, 3.9795e+05,
         1.8451e+00, 3.9786e+05, 1.8505e+00, 0.0000e+00, 3.8405e+05, 1.9613e+00,
         3.9578e+05, 1.9675e+00, 1.6571e+00],
        [3.8403e+05, 7.6854e+05, 7.9839e+05, 3.8404e+05, 7.8064e+05, 7.7061e+05,
         3.8401e+05, 7.7416e+05, 3.8405e+05, 3.8405e+05, 0.0000e+00, 3.8402e+05,
         7.5325e+05, 3.8400e+05, 3.8404e+05],
        [1.9312e+00, 3.7863e+05, 3.9778e+05, 1.7450e+00, 3.8816e+05, 3.9791e+05,
         1.9157e+00, 3.9780e+05, 1.8196e+00, 1.9613e+00, 3.8402e+05, 0.0000e+00,
         3.9577e+05, 1.8927e+00, 1.8794e+00],
        [3.9576e+05, 7.8642e+05, 7.9338e+05, 3.9574e+05, 7.8478e+05, 7.7544e+05,
         3.9577e+05, 7.6102e+05, 3.9578e+05, 3.9578e+05, 7.5325e+05, 3.9577e+05,
         0.0000e+00, 3.9574e+05, 3.9579e+05],
        [1.9667e+00, 3.7864e+05, 3.9779e+05, 1.7549e+00, 3.8816e+05, 3.9792e+05,
         1.8357e+00, 3.9784e+05, 1.7818e+00, 1.9675e+00, 3.8400e+05, 1.8927e+00,
         3.9574e+05, 0.0000e+00, 1.7921e+00],
        [1.8219e+00, 3.7861e+05, 3.9777e+05, 1.7260e+00, 3.8814e+05, 3.9793e+05,
         1.8180e+00, 3.9783e+05, 1.6692e+00, 1.6571e+00, 3.8404e+05, 1.8794e+00,
         3.9579e+05, 1.7921e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7282e+00, 1.7983e+00, 1.8219e+00, 1.9129e+00, 1.9295e+00,
        1.9312e+00, 1.9667e+00, 3.7864e+05, 3.8403e+05, 3.8811e+05, 3.9576e+05,
        3.9776e+05, 3.9783e+05, 3.9795e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 378599.3750, 378604.5000, 378607.5938, 378622.0000,
        378634.7188, 378638.8750, 378642.6250, 378644.1562, 751735.0625,
        768031.3750, 768542.8750, 769885.2500, 772533.2500, 786421.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397756.5312, 397759.6250, 397767.7500, 397768.0938,
        397769.4062, 397783.0000, 397791.1562, 397799.1875, 769885.2500,
        770358.9375, 787264.3750, 793377.5000, 798385.5625, 801550.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5995e+00, 1.7260e+00, 1.7282e+00, 1.7320e+00, 1.7450e+00,
        1.7549e+00, 1.7701e+00, 3.7860e+05, 3.8404e+05, 3.8817e+05, 3.9574e+05,
        3.9780e+05, 3.9787e+05, 3.9792e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388109.3438, 388113.7812, 388135.1875, 388138.9062,
        388157.6562, 388160.9062, 388161.5938, 388168.0625, 751735.0625,
        770044.7500, 770358.9375, 772760.8750, 780638.8750, 784779.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397913.0625, 397917.1250, 397922.6875, 397923.3125,
        397928.0312, 397939.8750, 397946.0312, 397950.2812, 770044.7500,
        770610.2500, 772533.2500, 775437.8125, 792414.0625, 801550.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6882e+00, 1.7320e+00, 1.8180e+00, 1.8357e+00, 1.8451e+00,
        1.9157e+00, 1.9295e+00, 3.7864e+05, 3.8401e+05, 3.8816e+05, 3.9577e+05,
        3.9777e+05, 3.9784e+05, 3.9794e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397799.5312, 397830.9688, 397831.1250, 397840.1250,
        397842.5938, 397849.1562, 397855.2812, 397865.3438, 761022.7500,
        768031.3750, 772760.8750, 774155.5625, 787264.3750, 792414.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6692e+00, 1.6882e+00, 1.7701e+00, 1.7818e+00, 1.7983e+00,
        1.8196e+00, 1.8505e+00, 3.7862e+05, 3.8405e+05, 3.8814e+05, 3.9578e+05,
        3.9777e+05, 3.9785e+05, 3.9792e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5995e+00, 1.6571e+00, 1.8451e+00, 1.8505e+00, 1.9129e+00,
        1.9613e+00, 1.9675e+00, 3.7860e+05, 3.8405e+05, 3.8811e+05, 3.9578e+05,
        3.9776e+05, 3.9786e+05, 3.9795e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 384002.3125, 384011.0312, 384020.2500, 384034.7812,
        384040.4062, 384040.8438, 384045.3125, 384046.8125, 753248.6875,
        768542.8750, 770610.2500, 774155.5625, 780638.8750, 798385.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7450e+00, 1.8196e+00, 1.8794e+00, 1.8927e+00, 1.9157e+00,
        1.9312e+00, 1.9613e+00, 3.7863e+05, 3.8402e+05, 3.8816e+05, 3.9577e+05,
        3.9778e+05, 3.9780e+05, 3.9791e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 395743.3125, 395744.8438, 395757.0938, 395765.2500,
        395772.1562, 395776.5938, 395780.3750, 395788.7188, 753248.6875,
        761022.7500, 775437.8125, 784779.0625, 786421.6250, 793377.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7549e+00, 1.7818e+00, 1.7921e+00, 1.8357e+00, 1.8927e+00,
        1.9667e+00, 1.9675e+00, 3.7864e+05, 3.8400e+05, 3.8816e+05, 3.9574e+05,
        3.9779e+05, 3.9784e+05, 3.9792e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6571e+00, 1.6692e+00, 1.7260e+00, 1.7921e+00, 1.8180e+00,
        1.8219e+00, 1.8794e+00, 3.7861e+05, 3.8404e+05, 3.8814e+05, 3.9579e+05,
        3.9777e+05, 3.9783e+05, 3.9793e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['84743.39', '420080.97', '439119.97', '84739.71', '428542.25', '439276.12', '84740.88', '438193.00', '84742.35', '84739.73', '425054.50', '84740.91', '435486.38', '84739.36', '84740.04']
estimated f for each client, fs: [7, 5, 5, 7, 5, 5, 7, 5, 7, 7, 5, 7, 5, 7, 7]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']], selected_client_indices: [7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0142s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:45...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:45, End: 2025-07-22 15:29:45)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 9, 20, 8, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.7405e+00, 1.8461e+00, 3.8913e+05, 1.8156e+00, 3.9505e+05,
         1.9908e+00, 1.7147e+00, 1.7944e+00, 4.0620e+05, 4.0241e+05, 1.7635e+00,
         1.7309e+00, 3.9076e+05, 1.8205e+00],
        [1.7405e+00, 0.0000e+00, 1.8177e+00, 3.8916e+05, 1.7150e+00, 3.9503e+05,
         2.0114e+00, 1.8211e+00, 1.9260e+00, 4.0620e+05, 4.0239e+05, 1.9193e+00,
         1.6787e+00, 3.9075e+05, 1.7680e+00],
        [1.8461e+00, 1.8177e+00, 0.0000e+00, 3.8916e+05, 1.6730e+00, 3.9502e+05,
         1.8959e+00, 1.8465e+00, 1.8028e+00, 4.0621e+05, 4.0240e+05, 1.8288e+00,
         1.7131e+00, 3.9074e+05, 1.7743e+00],
        [3.8913e+05, 3.8916e+05, 3.8916e+05, 0.0000e+00, 3.8915e+05, 7.6655e+05,
         3.8915e+05, 3.8916e+05, 3.8914e+05, 8.0217e+05, 7.7392e+05, 3.8913e+05,
         3.8911e+05, 7.8056e+05, 3.8916e+05],
        [1.8156e+00, 1.7150e+00, 1.6730e+00, 3.8915e+05, 0.0000e+00, 3.9506e+05,
         1.7066e+00, 1.7492e+00, 1.6093e+00, 4.0622e+05, 4.0240e+05, 1.7831e+00,
         1.6472e+00, 3.9077e+05, 1.6815e+00],
        [3.9505e+05, 3.9503e+05, 3.9502e+05, 7.6655e+05, 3.9506e+05, 0.0000e+00,
         3.9500e+05, 3.9501e+05, 3.9501e+05, 8.0716e+05, 7.9041e+05, 3.9503e+05,
         3.9499e+05, 7.7364e+05, 3.9502e+05],
        [1.9908e+00, 2.0114e+00, 1.8959e+00, 3.8915e+05, 1.7066e+00, 3.9500e+05,
         0.0000e+00, 1.6462e+00, 1.7411e+00, 4.0619e+05, 4.0243e+05, 1.9161e+00,
         1.6777e+00, 3.9072e+05, 1.7933e+00],
        [1.7147e+00, 1.8211e+00, 1.8465e+00, 3.8916e+05, 1.7492e+00, 3.9501e+05,
         1.6462e+00, 0.0000e+00, 1.8521e+00, 4.0619e+05, 4.0243e+05, 1.7457e+00,
         1.7899e+00, 3.9076e+05, 1.6793e+00],
        [1.7944e+00, 1.9260e+00, 1.8028e+00, 3.8914e+05, 1.6093e+00, 3.9501e+05,
         1.7411e+00, 1.8521e+00, 0.0000e+00, 4.0623e+05, 4.0242e+05, 2.0050e+00,
         1.6927e+00, 3.9077e+05, 1.6711e+00],
        [4.0620e+05, 4.0620e+05, 4.0621e+05, 8.0217e+05, 4.0622e+05, 8.0716e+05,
         4.0619e+05, 4.0619e+05, 4.0623e+05, 0.0000e+00, 8.1930e+05, 4.0617e+05,
         4.0623e+05, 8.0249e+05, 4.0623e+05],
        [4.0241e+05, 4.0239e+05, 4.0240e+05, 7.7392e+05, 4.0240e+05, 7.9041e+05,
         4.0243e+05, 4.0243e+05, 4.0242e+05, 8.1930e+05, 0.0000e+00, 4.0242e+05,
         4.0240e+05, 7.9112e+05, 4.0238e+05],
        [1.7635e+00, 1.9193e+00, 1.8288e+00, 3.8913e+05, 1.7831e+00, 3.9503e+05,
         1.9161e+00, 1.7457e+00, 2.0050e+00, 4.0617e+05, 4.0242e+05, 0.0000e+00,
         1.8458e+00, 3.9075e+05, 1.8773e+00],
        [1.7309e+00, 1.6787e+00, 1.7131e+00, 3.8911e+05, 1.6472e+00, 3.9499e+05,
         1.6777e+00, 1.7899e+00, 1.6927e+00, 4.0623e+05, 4.0240e+05, 1.8458e+00,
         0.0000e+00, 3.9076e+05, 1.6489e+00],
        [3.9076e+05, 3.9075e+05, 3.9074e+05, 7.8056e+05, 3.9077e+05, 7.7364e+05,
         3.9072e+05, 3.9076e+05, 3.9077e+05, 8.0249e+05, 7.9112e+05, 3.9075e+05,
         3.9076e+05, 0.0000e+00, 3.9074e+05],
        [1.8205e+00, 1.7680e+00, 1.7743e+00, 3.8916e+05, 1.6815e+00, 3.9502e+05,
         1.7933e+00, 1.6793e+00, 1.6711e+00, 4.0623e+05, 4.0238e+05, 1.8773e+00,
         1.6489e+00, 3.9074e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7147e+00, 1.7309e+00, 1.7405e+00, 1.7635e+00, 1.7944e+00,
        1.8156e+00, 1.8205e+00, 1.8461e+00, 1.9908e+00, 3.8913e+05, 3.9076e+05,
        3.9505e+05, 4.0241e+05, 4.0620e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6787e+00, 1.7150e+00, 1.7405e+00, 1.7680e+00, 1.8177e+00,
        1.8211e+00, 1.9193e+00, 1.9260e+00, 2.0114e+00, 3.8916e+05, 3.9075e+05,
        3.9503e+05, 4.0239e+05, 4.0620e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6730e+00, 1.7131e+00, 1.7743e+00, 1.8028e+00, 1.8177e+00,
        1.8288e+00, 1.8461e+00, 1.8465e+00, 1.8959e+00, 3.8916e+05, 3.9074e+05,
        3.9502e+05, 4.0240e+05, 4.0621e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389113.7812, 389126.9375, 389133.3438, 389141.3750,
        389148.4688, 389149.6250, 389156.6562, 389158.2812, 389161.8750,
        389163.4688, 766547.3750, 773920.3750, 780560.5000, 802166.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6093e+00, 1.6472e+00, 1.6730e+00, 1.6815e+00, 1.7066e+00,
        1.7150e+00, 1.7492e+00, 1.7831e+00, 1.8156e+00, 3.8915e+05, 3.9077e+05,
        3.9506e+05, 4.0240e+05, 4.0622e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394993.5938, 395001.3750, 395005.7500, 395011.1875,
        395015.2500, 395021.5312, 395030.1250, 395032.0312, 395048.7500,
        395057.6250, 766547.3750, 773636.5000, 790412.8125, 807162.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6462e+00, 1.6777e+00, 1.7066e+00, 1.7411e+00, 1.7933e+00,
        1.8959e+00, 1.9161e+00, 1.9908e+00, 2.0114e+00, 3.8915e+05, 3.9072e+05,
        3.9500e+05, 4.0243e+05, 4.0619e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6462e+00, 1.6793e+00, 1.7147e+00, 1.7457e+00, 1.7492e+00,
        1.7899e+00, 1.8211e+00, 1.8465e+00, 1.8521e+00, 3.8916e+05, 3.9076e+05,
        3.9501e+05, 4.0243e+05, 4.0619e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6093e+00, 1.6711e+00, 1.6927e+00, 1.7411e+00, 1.7944e+00,
        1.8028e+00, 1.8521e+00, 1.9260e+00, 2.0050e+00, 3.8914e+05, 3.9077e+05,
        3.9501e+05, 4.0242e+05, 4.0623e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 406172.2812, 406189.2812, 406189.8750, 406196.4375,
        406202.6875, 406212.4062, 406221.9375, 406228.2500, 406229.8750,
        406233.8125, 802166.9375, 802492.8750, 807162.3750, 819301.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402382.4375, 402389.9375, 402396.3750, 402396.6875,
        402403.6875, 402409.8750, 402417.3125, 402417.8125, 402426.5000,
        402431.3438, 773920.3750, 790412.8125, 791119.2500, 819301.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7457e+00, 1.7635e+00, 1.7831e+00, 1.8288e+00, 1.8458e+00,
        1.8773e+00, 1.9161e+00, 1.9193e+00, 2.0050e+00, 3.8913e+05, 3.9075e+05,
        3.9503e+05, 4.0242e+05, 4.0617e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6472e+00, 1.6489e+00, 1.6777e+00, 1.6787e+00, 1.6927e+00,
        1.7131e+00, 1.7309e+00, 1.7899e+00, 1.8458e+00, 3.8911e+05, 3.9076e+05,
        3.9499e+05, 4.0240e+05, 4.0623e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390723.6875, 390742.5000, 390743.3750, 390747.3750,
        390750.3438, 390756.8438, 390759.9062, 390764.3125, 390768.9688,
        390772.8750, 773636.5000, 780560.5000, 791119.2500, 802492.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6489e+00, 1.6711e+00, 1.6793e+00, 1.6815e+00, 1.7680e+00,
        1.7743e+00, 1.7933e+00, 1.8205e+00, 1.8773e+00, 3.8916e+05, 3.9074e+05,
        3.9502e+05, 4.0238e+05, 4.0623e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.80', '1.82', '1.80', '389145.41', '1.71', '395021.75', '1.82', '1.76', '1.79', '406207.72', '402407.25', '1.85', '1.71', '390753.00', '1.75']
estimated f for each client, fs: [5, 5, 5, 3, 5, 3, 5, 5, 5, 3, 3, 5, 5, 3, 5]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 9, 20, 8, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0107s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:46...
global Accuracy on shared test data: 80.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 42 221]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:46, End: 2025-07-22 15:29:46)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 1.6023e+00, 1.6490e+00, 3.8993e+05, 3.8824e+05, 1.5709e+00,
         1.7538e+00, 3.9515e+05, 3.9028e+05, 1.7961e+00, 3.7561e+05, 1.5337e+00,
         1.5965e+00, 3.9298e+05, 3.9420e+05, 1.6091e+00, 1.5912e+00, 3.8175e+05,
         1.6554e+00, 1.6073e+00],
        [1.6023e+00, 0.0000e+00, 1.6720e+00, 3.8997e+05, 3.8821e+05, 1.6249e+00,
         1.7681e+00, 3.9515e+05, 3.9028e+05, 1.8431e+00, 3.7565e+05, 1.6046e+00,
         1.7817e+00, 3.9298e+05, 3.9420e+05, 1.6992e+00, 1.6328e+00, 3.8176e+05,
         1.7698e+00, 1.6293e+00],
        [1.6490e+00, 1.6720e+00, 0.0000e+00, 3.8993e+05, 3.8822e+05, 1.6826e+00,
         1.5800e+00, 3.9511e+05, 3.9028e+05, 1.7458e+00, 3.7562e+05, 1.7145e+00,
         1.6549e+00, 3.9300e+05, 3.9418e+05, 1.6179e+00, 1.6058e+00, 3.8173e+05,
         1.4819e+00, 1.6124e+00],
        [3.8993e+05, 3.8997e+05, 3.8993e+05, 0.0000e+00, 7.9006e+05, 3.8998e+05,
         3.8997e+05, 7.7992e+05, 7.7088e+05, 3.8997e+05, 7.5984e+05, 3.8995e+05,
         3.8995e+05, 7.7936e+05, 8.1041e+05, 3.9000e+05, 3.8993e+05, 7.8732e+05,
         3.8996e+05, 3.8995e+05],
        [3.8824e+05, 3.8821e+05, 3.8822e+05, 7.9006e+05, 0.0000e+00, 3.8822e+05,
         3.8825e+05, 7.7775e+05, 7.7933e+05, 3.8824e+05, 7.5965e+05, 3.8826e+05,
         3.8823e+05, 7.8070e+05, 7.9821e+05, 3.8824e+05, 3.8822e+05, 7.6925e+05,
         3.8822e+05, 3.8823e+05],
        [1.5709e+00, 1.6249e+00, 1.6826e+00, 3.8998e+05, 3.8822e+05, 0.0000e+00,
         1.5766e+00, 3.9511e+05, 3.9027e+05, 1.7916e+00, 3.7567e+05, 1.6397e+00,
         1.6933e+00, 3.9299e+05, 3.9422e+05, 1.5786e+00, 1.6659e+00, 3.8178e+05,
         1.5788e+00, 1.5926e+00],
        [1.7538e+00, 1.7681e+00, 1.5800e+00, 3.8997e+05, 3.8825e+05, 1.5766e+00,
         0.0000e+00, 3.9511e+05, 3.9032e+05, 1.7522e+00, 3.7563e+05, 1.7448e+00,
         1.6179e+00, 3.9299e+05, 3.9419e+05, 1.6135e+00, 1.6324e+00, 3.8173e+05,
         1.6086e+00, 1.6277e+00],
        [3.9515e+05, 3.9515e+05, 3.9511e+05, 7.7992e+05, 7.7775e+05, 3.9511e+05,
         3.9511e+05, 0.0000e+00, 7.8362e+05, 3.9518e+05, 7.7323e+05, 3.9516e+05,
         3.9514e+05, 7.8828e+05, 8.0242e+05, 3.9514e+05, 3.9512e+05, 7.6867e+05,
         3.9514e+05, 3.9513e+05],
        [3.9028e+05, 3.9028e+05, 3.9028e+05, 7.7088e+05, 7.7933e+05, 3.9027e+05,
         3.9032e+05, 7.8362e+05, 0.0000e+00, 3.9030e+05, 7.6962e+05, 3.9028e+05,
         3.9028e+05, 8.0082e+05, 7.9231e+05, 3.9026e+05, 3.9027e+05, 7.6606e+05,
         3.9029e+05, 3.9026e+05],
        [1.7961e+00, 1.8431e+00, 1.7458e+00, 3.8997e+05, 3.8824e+05, 1.7916e+00,
         1.7522e+00, 3.9518e+05, 3.9030e+05, 0.0000e+00, 3.7562e+05, 1.5420e+00,
         1.6754e+00, 3.9306e+05, 3.9421e+05, 1.7776e+00, 1.6277e+00, 3.8174e+05,
         1.6695e+00, 1.6479e+00],
        [3.7561e+05, 3.7565e+05, 3.7562e+05, 7.5984e+05, 7.5965e+05, 3.7567e+05,
         3.7563e+05, 7.7323e+05, 7.6962e+05, 3.7562e+05, 0.0000e+00, 3.7561e+05,
         3.7562e+05, 7.8325e+05, 7.3849e+05, 3.7560e+05, 3.7564e+05, 7.6885e+05,
         3.7566e+05, 3.7562e+05],
        [1.5337e+00, 1.6046e+00, 1.7145e+00, 3.8995e+05, 3.8826e+05, 1.6397e+00,
         1.7448e+00, 3.9516e+05, 3.9028e+05, 1.5420e+00, 3.7561e+05, 0.0000e+00,
         1.6828e+00, 3.9301e+05, 3.9418e+05, 1.5660e+00, 1.6884e+00, 3.8175e+05,
         1.6707e+00, 1.4812e+00],
        [1.5965e+00, 1.7817e+00, 1.6549e+00, 3.8995e+05, 3.8823e+05, 1.6933e+00,
         1.6179e+00, 3.9514e+05, 3.9028e+05, 1.6754e+00, 3.7562e+05, 1.6828e+00,
         0.0000e+00, 3.9302e+05, 3.9422e+05, 1.7965e+00, 1.6403e+00, 3.8172e+05,
         1.7567e+00, 1.5243e+00],
        [3.9298e+05, 3.9298e+05, 3.9300e+05, 7.7936e+05, 7.8070e+05, 3.9299e+05,
         3.9299e+05, 7.8828e+05, 8.0082e+05, 3.9306e+05, 7.8325e+05, 3.9301e+05,
         3.9302e+05, 0.0000e+00, 7.8645e+05, 3.9302e+05, 3.9299e+05, 7.6188e+05,
         3.9299e+05, 3.9303e+05],
        [3.9420e+05, 3.9420e+05, 3.9418e+05, 8.1041e+05, 7.9821e+05, 3.9422e+05,
         3.9419e+05, 8.0242e+05, 7.9231e+05, 3.9421e+05, 7.3849e+05, 3.9418e+05,
         3.9422e+05, 7.8645e+05, 0.0000e+00, 3.9417e+05, 3.9421e+05, 7.9650e+05,
         3.9419e+05, 3.9420e+05],
        [1.6091e+00, 1.6992e+00, 1.6179e+00, 3.9000e+05, 3.8824e+05, 1.5786e+00,
         1.6135e+00, 3.9514e+05, 3.9026e+05, 1.7776e+00, 3.7560e+05, 1.5660e+00,
         1.7965e+00, 3.9302e+05, 3.9417e+05, 0.0000e+00, 1.7509e+00, 3.8175e+05,
         1.6123e+00, 1.7073e+00],
        [1.5912e+00, 1.6328e+00, 1.6058e+00, 3.8993e+05, 3.8822e+05, 1.6659e+00,
         1.6324e+00, 3.9512e+05, 3.9027e+05, 1.6277e+00, 3.7564e+05, 1.6884e+00,
         1.6403e+00, 3.9299e+05, 3.9421e+05, 1.7509e+00, 0.0000e+00, 3.8174e+05,
         1.7183e+00, 1.5390e+00],
        [3.8175e+05, 3.8176e+05, 3.8173e+05, 7.8732e+05, 7.6925e+05, 3.8178e+05,
         3.8173e+05, 7.6867e+05, 7.6606e+05, 3.8174e+05, 7.6885e+05, 3.8175e+05,
         3.8172e+05, 7.6188e+05, 7.9650e+05, 3.8175e+05, 3.8174e+05, 0.0000e+00,
         3.8172e+05, 3.8175e+05],
        [1.6554e+00, 1.7698e+00, 1.4819e+00, 3.8996e+05, 3.8822e+05, 1.5788e+00,
         1.6086e+00, 3.9514e+05, 3.9029e+05, 1.6695e+00, 3.7566e+05, 1.6707e+00,
         1.7567e+00, 3.9299e+05, 3.9419e+05, 1.6123e+00, 1.7183e+00, 3.8172e+05,
         0.0000e+00, 1.5922e+00],
        [1.6073e+00, 1.6293e+00, 1.6124e+00, 3.8995e+05, 3.8823e+05, 1.5926e+00,
         1.6277e+00, 3.9513e+05, 3.9026e+05, 1.6479e+00, 3.7562e+05, 1.4812e+00,
         1.5243e+00, 3.9303e+05, 3.9420e+05, 1.7073e+00, 1.5390e+00, 3.8175e+05,
         1.5922e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5337e+00, 1.5709e+00, 1.5912e+00, 1.5965e+00, 1.6023e+00,
        1.6073e+00, 1.6091e+00, 1.6490e+00, 1.6554e+00, 1.7538e+00, 1.7961e+00,
        3.7561e+05, 3.8175e+05, 3.8824e+05, 3.8993e+05, 3.9028e+05, 3.9298e+05,
        3.9420e+05, 3.9515e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.6023e+00, 1.6046e+00, 1.6249e+00, 1.6293e+00, 1.6328e+00,
        1.6720e+00, 1.6992e+00, 1.7681e+00, 1.7698e+00, 1.7817e+00, 1.8431e+00,
        3.7565e+05, 3.8176e+05, 3.8821e+05, 3.8997e+05, 3.9028e+05, 3.9298e+05,
        3.9420e+05, 3.9515e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4819e+00, 1.5800e+00, 1.6058e+00, 1.6124e+00, 1.6179e+00,
        1.6490e+00, 1.6549e+00, 1.6720e+00, 1.6826e+00, 1.7145e+00, 1.7458e+00,
        3.7562e+05, 3.8173e+05, 3.8822e+05, 3.8993e+05, 3.9028e+05, 3.9300e+05,
        3.9418e+05, 3.9511e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 389925.3438, 389928.7188, 389933.5625, 389945.5000,
        389946.8438, 389953.1875, 389958.7188, 389968.0000, 389970.6562,
        389973.5000, 389977.3750, 390004.7188, 759839.5000, 770875.6250,
        779363.3125, 779921.3125, 787324.7500, 790058.7500, 810406.3125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 388208.0625, 388216.3438, 388217.5625, 388221.3125,
        388224.5312, 388230.6562, 388234.6562, 388239.1250, 388243.4375,
        388244.2812, 388249.2500, 388258.4375, 759652.8750, 769247.6250,
        777751.6875, 779326.4375, 780697.1250, 790058.7500, 798207.2500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.5709e+00, 1.5766e+00, 1.5786e+00, 1.5788e+00, 1.5926e+00,
        1.6249e+00, 1.6397e+00, 1.6659e+00, 1.6826e+00, 1.6933e+00, 1.7916e+00,
        3.7567e+05, 3.8178e+05, 3.8822e+05, 3.8998e+05, 3.9027e+05, 3.9299e+05,
        3.9422e+05, 3.9511e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.5766e+00, 1.5800e+00, 1.6086e+00, 1.6135e+00, 1.6179e+00,
        1.6277e+00, 1.6324e+00, 1.7448e+00, 1.7522e+00, 1.7538e+00, 1.7681e+00,
        3.7563e+05, 3.8173e+05, 3.8825e+05, 3.8997e+05, 3.9032e+05, 3.9299e+05,
        3.9419e+05, 3.9511e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 395106.2188, 395110.1250, 395113.2188, 395121.7500,
        395125.3125, 395137.3125, 395138.4375, 395139.1875, 395149.7188,
        395151.7500, 395155.3750, 395182.7500, 768671.9375, 773231.4375,
        777751.6875, 779921.3125, 783617.3750, 788276.0625, 802424.3750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 390264.5625, 390265.0000, 390270.3125, 390273.2188,
        390278.5938, 390281.7812, 390282.6562, 390284.5000, 390284.8125,
        390292.0625, 390305.0000, 390315.9688, 766056.2500, 769619.8125,
        770875.6250, 779326.4375, 783617.3750, 792310.3750, 800818.0000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.5420e+00, 1.6277e+00, 1.6479e+00, 1.6695e+00, 1.6754e+00,
        1.7458e+00, 1.7522e+00, 1.7776e+00, 1.7916e+00, 1.7961e+00, 1.8431e+00,
        3.7562e+05, 3.8174e+05, 3.8824e+05, 3.8997e+05, 3.9030e+05, 3.9306e+05,
        3.9421e+05, 3.9518e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 375598.4375, 375609.1250, 375612.0312, 375616.6250,
        375619.8438, 375622.5625, 375624.9688, 375626.9375, 375637.6875,
        375651.8125, 375657.1875, 375668.4375, 738489.9375, 759652.8750,
        759839.5000, 768851.1250, 769619.8125, 773231.4375, 783246.9375])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4812e+00, 1.5337e+00, 1.5420e+00, 1.5660e+00, 1.6046e+00,
        1.6397e+00, 1.6707e+00, 1.6828e+00, 1.6884e+00, 1.7145e+00, 1.7448e+00,
        3.7561e+05, 3.8175e+05, 3.8826e+05, 3.8995e+05, 3.9028e+05, 3.9301e+05,
        3.9418e+05, 3.9516e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.5243e+00, 1.5965e+00, 1.6179e+00, 1.6403e+00, 1.6549e+00,
        1.6754e+00, 1.6828e+00, 1.6933e+00, 1.7567e+00, 1.7817e+00, 1.7965e+00,
        3.7562e+05, 3.8172e+05, 3.8823e+05, 3.8995e+05, 3.9028e+05, 3.9302e+05,
        3.9422e+05, 3.9514e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 392978.0312, 392984.8750, 392987.0938, 392990.4062,
        392992.3750, 392994.1875, 392997.8750, 393007.5625, 393015.5312,
        393024.8125, 393032.6250, 393057.1562, 761883.4375, 779363.3125,
        780697.1250, 783246.9375, 786450.6250, 788276.0625, 800818.0000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 394166.4375, 394177.7500, 394178.0938, 394186.8125,
        394191.0938, 394196.2500, 394198.5312, 394202.4062, 394205.3438,
        394206.0625, 394219.9688, 394221.5000, 738489.9375, 786450.6250,
        792310.3750, 796498.3750, 798207.2500, 802424.3750, 810406.3125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.5660e+00, 1.5786e+00, 1.6091e+00, 1.6123e+00, 1.6135e+00,
        1.6179e+00, 1.6992e+00, 1.7073e+00, 1.7509e+00, 1.7776e+00, 1.7965e+00,
        3.7560e+05, 3.8175e+05, 3.8824e+05, 3.9000e+05, 3.9026e+05, 3.9302e+05,
        3.9417e+05, 3.9514e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.5390e+00, 1.5912e+00, 1.6058e+00, 1.6277e+00, 1.6324e+00,
        1.6328e+00, 1.6403e+00, 1.6659e+00, 1.6884e+00, 1.7183e+00, 1.7509e+00,
        3.7564e+05, 3.8174e+05, 3.8822e+05, 3.8993e+05, 3.9027e+05, 3.9299e+05,
        3.9421e+05, 3.9512e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 381720.2500, 381724.2812, 381726.1250, 381729.0312,
        381740.2812, 381744.5938, 381746.3125, 381751.2188, 381751.3125,
        381753.1875, 381756.4375, 381782.9375, 761883.4375, 766056.2500,
        768671.9375, 768851.1250, 769247.6250, 787324.7500, 796498.3750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4819e+00, 1.5788e+00, 1.5922e+00, 1.6086e+00, 1.6123e+00,
        1.6554e+00, 1.6695e+00, 1.6707e+00, 1.7183e+00, 1.7567e+00, 1.7698e+00,
        3.7566e+05, 3.8172e+05, 3.8822e+05, 3.8996e+05, 3.9029e+05, 3.9299e+05,
        3.9419e+05, 3.9514e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4812e+00, 1.5243e+00, 1.5390e+00, 1.5922e+00, 1.5926e+00,
        1.6073e+00, 1.6124e+00, 1.6277e+00, 1.6293e+00, 1.6479e+00, 1.7073e+00,
        3.7562e+05, 3.8175e+05, 3.8823e+05, 3.8995e+05, 3.9026e+05, 3.9303e+05,
        3.9420e+05, 3.9513e+05])
Index of maximum distance difference after half of values: 12
adaptive_Krum scores:  ['31302.25', '31305.87', '31303.57', '389957.12', '388232.25', '31307.20', '31303.76', '395135.88', '390283.12', '31303.45', '375628.75', '31302.49', '31303.18', '393005.12', '394195.81', '31301.38', '31304.65', '381743.81', '31306.27', '31302.85']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 8, 6, 6, 8, 6, 8, 8, 6, 6, 8, 8, 6, 8, 8]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0151s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:47...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 48 215]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:29:47, End: 2025-07-22 15:29:47)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.5544e+00, 1.6648e+00, 3.8880e+05, 3.7985e+05, 1.5549e+00,
         1.7172e+00, 3.8890e+05, 3.8240e+05, 4.0805e+05, 3.8568e+05, 3.9225e+05,
         1.8610e+00, 1.5814e+00, 3.9746e+05, 1.6536e+00, 1.6001e+00],
        [1.5544e+00, 0.0000e+00, 1.4877e+00, 3.8882e+05, 3.7989e+05, 1.5333e+00,
         1.5723e+00, 3.8892e+05, 3.8239e+05, 4.0805e+05, 3.8569e+05, 3.9224e+05,
         1.8583e+00, 1.5461e+00, 3.9746e+05, 1.6423e+00, 1.5271e+00],
        [1.6648e+00, 1.4877e+00, 0.0000e+00, 3.8881e+05, 3.7985e+05, 1.6064e+00,
         1.4550e+00, 3.8891e+05, 3.8240e+05, 4.0804e+05, 3.8575e+05, 3.9221e+05,
         1.7448e+00, 1.5604e+00, 3.9748e+05, 1.3677e+00, 1.5684e+00],
        [3.8880e+05, 3.8882e+05, 3.8881e+05, 0.0000e+00, 7.8590e+05, 3.8881e+05,
         3.8881e+05, 7.7635e+05, 7.6331e+05, 8.0270e+05, 7.9179e+05, 7.6877e+05,
         3.8881e+05, 3.8884e+05, 8.0366e+05, 3.8882e+05, 3.8883e+05],
        [3.7985e+05, 3.7989e+05, 3.7985e+05, 7.8590e+05, 0.0000e+00, 3.7991e+05,
         3.7986e+05, 7.4204e+05, 7.6058e+05, 7.9944e+05, 7.5115e+05, 7.5322e+05,
         3.7983e+05, 3.7984e+05, 7.6816e+05, 3.7984e+05, 3.7983e+05],
        [1.5549e+00, 1.5333e+00, 1.6064e+00, 3.8881e+05, 3.7991e+05, 0.0000e+00,
         1.4968e+00, 3.8891e+05, 3.8239e+05, 4.0803e+05, 3.8575e+05, 3.9226e+05,
         1.7244e+00, 1.6296e+00, 3.9746e+05, 1.5086e+00, 1.5105e+00],
        [1.7172e+00, 1.5723e+00, 1.4550e+00, 3.8881e+05, 3.7986e+05, 1.4968e+00,
         0.0000e+00, 3.8892e+05, 3.8240e+05, 4.0807e+05, 3.8572e+05, 3.9223e+05,
         1.5598e+00, 1.5854e+00, 3.9743e+05, 1.4630e+00, 1.5913e+00],
        [3.8890e+05, 3.8892e+05, 3.8891e+05, 7.7635e+05, 7.4204e+05, 3.8891e+05,
         3.8892e+05, 0.0000e+00, 7.6301e+05, 7.9595e+05, 7.8615e+05, 7.8743e+05,
         3.8892e+05, 3.8889e+05, 7.8292e+05, 3.8889e+05, 3.8891e+05],
        [3.8240e+05, 3.8239e+05, 3.8240e+05, 7.6331e+05, 7.6058e+05, 3.8239e+05,
         3.8240e+05, 7.6301e+05, 0.0000e+00, 8.0941e+05, 7.6633e+05, 7.8291e+05,
         3.8243e+05, 3.8242e+05, 7.8824e+05, 3.8242e+05, 3.8239e+05],
        [4.0805e+05, 4.0805e+05, 4.0804e+05, 8.0270e+05, 7.9944e+05, 4.0803e+05,
         4.0807e+05, 7.9595e+05, 8.0941e+05, 0.0000e+00, 7.9833e+05, 8.0562e+05,
         4.0805e+05, 4.0802e+05, 8.1032e+05, 4.0804e+05, 4.0803e+05],
        [3.8568e+05, 3.8569e+05, 3.8575e+05, 7.9179e+05, 7.5115e+05, 3.8575e+05,
         3.8572e+05, 7.8615e+05, 7.6633e+05, 7.9833e+05, 0.0000e+00, 7.7645e+05,
         3.8571e+05, 3.8568e+05, 7.9474e+05, 3.8573e+05, 3.8570e+05],
        [3.9225e+05, 3.9224e+05, 3.9221e+05, 7.6877e+05, 7.5322e+05, 3.9226e+05,
         3.9223e+05, 7.8743e+05, 7.8291e+05, 8.0562e+05, 7.7645e+05, 0.0000e+00,
         3.9225e+05, 3.9225e+05, 7.7856e+05, 3.9223e+05, 3.9225e+05],
        [1.8610e+00, 1.8583e+00, 1.7448e+00, 3.8881e+05, 3.7983e+05, 1.7244e+00,
         1.5598e+00, 3.8892e+05, 3.8243e+05, 4.0805e+05, 3.8571e+05, 3.9225e+05,
         0.0000e+00, 1.9502e+00, 3.9746e+05, 1.7026e+00, 1.9225e+00],
        [1.5814e+00, 1.5461e+00, 1.5604e+00, 3.8884e+05, 3.7984e+05, 1.6296e+00,
         1.5854e+00, 3.8889e+05, 3.8242e+05, 4.0802e+05, 3.8568e+05, 3.9225e+05,
         1.9502e+00, 0.0000e+00, 3.9745e+05, 1.6128e+00, 1.4884e+00],
        [3.9746e+05, 3.9746e+05, 3.9748e+05, 8.0366e+05, 7.6816e+05, 3.9746e+05,
         3.9743e+05, 7.8292e+05, 7.8824e+05, 8.1032e+05, 7.9474e+05, 7.7856e+05,
         3.9746e+05, 3.9745e+05, 0.0000e+00, 3.9751e+05, 3.9746e+05],
        [1.6536e+00, 1.6423e+00, 1.3677e+00, 3.8882e+05, 3.7984e+05, 1.5086e+00,
         1.4630e+00, 3.8889e+05, 3.8242e+05, 4.0804e+05, 3.8573e+05, 3.9223e+05,
         1.7026e+00, 1.6128e+00, 3.9751e+05, 0.0000e+00, 1.5534e+00],
        [1.6001e+00, 1.5271e+00, 1.5684e+00, 3.8883e+05, 3.7983e+05, 1.5105e+00,
         1.5913e+00, 3.8891e+05, 3.8239e+05, 4.0803e+05, 3.8570e+05, 3.9225e+05,
         1.9225e+00, 1.4884e+00, 3.9746e+05, 1.5534e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5544e+00, 1.5549e+00, 1.5814e+00, 1.6001e+00, 1.6536e+00,
        1.6648e+00, 1.7172e+00, 1.8610e+00, 3.7985e+05, 3.8240e+05, 3.8568e+05,
        3.8880e+05, 3.8890e+05, 3.9225e+05, 3.9746e+05, 4.0805e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4877e+00, 1.5271e+00, 1.5333e+00, 1.5461e+00, 1.5544e+00,
        1.5723e+00, 1.6423e+00, 1.8583e+00, 3.7989e+05, 3.8239e+05, 3.8569e+05,
        3.8882e+05, 3.8892e+05, 3.9224e+05, 3.9746e+05, 4.0805e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3677e+00, 1.4550e+00, 1.4877e+00, 1.5604e+00, 1.5684e+00,
        1.6064e+00, 1.6648e+00, 1.7448e+00, 3.7985e+05, 3.8240e+05, 3.8575e+05,
        3.8881e+05, 3.8891e+05, 3.9221e+05, 3.9748e+05, 4.0804e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388802.1562, 388808.4375, 388811.4375, 388813.4375,
        388814.8125, 388819.2500, 388821.7812, 388825.6875, 388842.2500,
        763308.2500, 768774.3750, 776346.5000, 785903.8125, 791793.5000,
        802698.5625, 803655.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379827.6250, 379830.9688, 379840.6875, 379843.0312,
        379846.9688, 379847.3438, 379855.4375, 379887.8125, 379909.2812,
        742039.2500, 751149.2500, 753221.0000, 760584.9375, 768160.9375,
        785903.8125, 799438.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4968e+00, 1.5086e+00, 1.5105e+00, 1.5333e+00, 1.5549e+00,
        1.6064e+00, 1.6296e+00, 1.7244e+00, 3.7991e+05, 3.8239e+05, 3.8575e+05,
        3.8881e+05, 3.8891e+05, 3.9226e+05, 3.9746e+05, 4.0803e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4550e+00, 1.4630e+00, 1.4968e+00, 1.5598e+00, 1.5723e+00,
        1.5854e+00, 1.5913e+00, 1.7172e+00, 3.7986e+05, 3.8240e+05, 3.8572e+05,
        3.8881e+05, 3.8892e+05, 3.9223e+05, 3.9743e+05, 4.0807e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388887.5938, 388894.6250, 388898.0000, 388909.0000,
        388910.5312, 388913.5000, 388919.1562, 388921.3125, 388924.8125,
        742039.2500, 763013.4375, 776346.5000, 782924.1250, 786145.5000,
        787429.0000, 795949.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382385.1250, 382391.0000, 382392.0625, 382398.0938,
        382401.5625, 382403.4375, 382421.3125, 382424.8750, 382427.8750,
        760584.9375, 763013.4375, 763308.2500, 766329.0000, 782914.9375,
        788237.5625, 809411.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 408023.6875, 408034.5312, 408034.8750, 408037.4375,
        408043.8750, 408050.6562, 408051.4688, 408051.7500, 408068.5625,
        795949.2500, 798331.3750, 799438.5625, 802698.5625, 805623.8125,
        809411.9375, 810322.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385680.9688, 385683.9688, 385690.0312, 385697.5938,
        385712.4062, 385716.2188, 385730.0000, 385745.1875, 385746.5938,
        751149.2500, 766329.0000, 776449.8750, 786145.5000, 791793.5000,
        794736.0625, 798331.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392214.2500, 392232.1250, 392233.1250, 392237.8125,
        392245.3438, 392252.0625, 392253.7500, 392254.4375, 392260.3125,
        753221.0000, 768774.3750, 776449.8750, 778556.1875, 782914.9375,
        787429.0000, 805623.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5598e+00, 1.7026e+00, 1.7244e+00, 1.7448e+00, 1.8583e+00,
        1.8610e+00, 1.9225e+00, 1.9502e+00, 3.7983e+05, 3.8243e+05, 3.8571e+05,
        3.8881e+05, 3.8892e+05, 3.9225e+05, 3.9746e+05, 4.0805e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4884e+00, 1.5461e+00, 1.5604e+00, 1.5814e+00, 1.5854e+00,
        1.6128e+00, 1.6296e+00, 1.9502e+00, 3.7984e+05, 3.8242e+05, 3.8568e+05,
        3.8884e+05, 3.8889e+05, 3.9225e+05, 3.9745e+05, 4.0802e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397433.1875, 397451.7188, 397461.4688, 397462.4375,
        397462.6250, 397462.6562, 397463.5938, 397477.2500, 397505.5000,
        768160.9375, 778556.1875, 782924.1250, 788237.5625, 794736.0625,
        803655.8750, 810322.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3677e+00, 1.4630e+00, 1.5086e+00, 1.5534e+00, 1.6128e+00,
        1.6423e+00, 1.6536e+00, 1.7026e+00, 3.7984e+05, 3.8242e+05, 3.8573e+05,
        3.8882e+05, 3.8889e+05, 3.9223e+05, 3.9751e+05, 4.0804e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4884e+00, 1.5105e+00, 1.5271e+00, 1.5534e+00, 1.5684e+00,
        1.5913e+00, 1.6001e+00, 1.9225e+00, 3.7983e+05, 3.8239e+05, 3.8570e+05,
        3.8883e+05, 3.8891e+05, 3.9225e+05, 3.9746e+05, 4.0803e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76226.16', '76228.56', '76225.79', '426266.72', '416072.81', '76231.40', '76227.13', '424221.75', '420223.00', '446834.56', '422255.19', '428340.41', '76226.98', '76227.72', '434534.09', '76227.80', '76223.47']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 8, 6, 6, 6, 6, 6, 8, 8, 6, 8, 8]
selected_index: 16
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0220s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:47...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:47, End: 2025-07-22 15:29:47)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.8317e+00, 3.8568e+05, 3.8745e+05, 1.6109e+00, 1.7285e+00,
         4.0371e+05, 3.9309e+05, 1.8017e+00, 3.8546e+05, 1.6634e+00, 3.9205e+05,
         3.8000e+05, 1.7915e+00, 1.6695e+00, 3.8658e+05, 1.7648e+00, 1.7700e+00],
        [1.8317e+00, 0.0000e+00, 3.8572e+05, 3.8751e+05, 1.6678e+00, 1.5272e+00,
         4.0372e+05, 3.9305e+05, 1.7720e+00, 3.8544e+05, 1.6170e+00, 3.9203e+05,
         3.8003e+05, 1.7332e+00, 1.6631e+00, 3.8656e+05, 1.5045e+00, 1.7617e+00],
        [3.8568e+05, 3.8572e+05, 0.0000e+00, 7.8236e+05, 3.8572e+05, 3.8569e+05,
         7.9742e+05, 7.7532e+05, 3.8567e+05, 7.7361e+05, 3.8570e+05, 7.8909e+05,
         7.5825e+05, 3.8569e+05, 3.8569e+05, 7.5581e+05, 3.8573e+05, 3.8570e+05],
        [3.8745e+05, 3.8751e+05, 7.8236e+05, 0.0000e+00, 3.8744e+05, 3.8751e+05,
         7.9626e+05, 8.0802e+05, 3.8752e+05, 7.8092e+05, 3.8745e+05, 7.8557e+05,
         7.6296e+05, 3.8751e+05, 3.8749e+05, 7.4006e+05, 3.8751e+05, 3.8748e+05],
        [1.6109e+00, 1.6678e+00, 3.8572e+05, 3.8744e+05, 0.0000e+00, 1.4792e+00,
         4.0369e+05, 3.9309e+05, 1.6991e+00, 3.8544e+05, 1.6568e+00, 3.9201e+05,
         3.7999e+05, 1.6875e+00, 1.6498e+00, 3.8657e+05, 1.5397e+00, 1.7263e+00],
        [1.7285e+00, 1.5272e+00, 3.8569e+05, 3.8751e+05, 1.4792e+00, 0.0000e+00,
         4.0372e+05, 3.9305e+05, 1.6279e+00, 3.8546e+05, 1.4441e+00, 3.9203e+05,
         3.8001e+05, 1.5345e+00, 1.5347e+00, 3.8657e+05, 1.4998e+00, 1.5826e+00],
        [4.0371e+05, 4.0372e+05, 7.9742e+05, 7.9626e+05, 4.0369e+05, 4.0372e+05,
         0.0000e+00, 8.0453e+05, 4.0371e+05, 7.9612e+05, 4.0369e+05, 8.0462e+05,
         7.8614e+05, 4.0372e+05, 4.0368e+05, 7.9197e+05, 4.0372e+05, 4.0371e+05],
        [3.9309e+05, 3.9305e+05, 7.7532e+05, 8.0802e+05, 3.9309e+05, 3.9305e+05,
         8.0453e+05, 0.0000e+00, 3.9308e+05, 7.8285e+05, 3.9307e+05, 8.0078e+05,
         7.7369e+05, 3.9305e+05, 3.9310e+05, 7.7244e+05, 3.9306e+05, 3.9307e+05],
        [1.8017e+00, 1.7720e+00, 3.8567e+05, 3.8752e+05, 1.6991e+00, 1.6279e+00,
         4.0371e+05, 3.9308e+05, 0.0000e+00, 3.8546e+05, 1.6987e+00, 3.9207e+05,
         3.7999e+05, 1.9393e+00, 1.6351e+00, 3.8659e+05, 1.6583e+00, 1.8078e+00],
        [3.8546e+05, 3.8544e+05, 7.7361e+05, 7.8092e+05, 3.8544e+05, 3.8546e+05,
         7.9612e+05, 7.8285e+05, 3.8546e+05, 0.0000e+00, 3.8546e+05, 7.8625e+05,
         7.5224e+05, 3.8544e+05, 3.8544e+05, 7.7331e+05, 3.8546e+05, 3.8545e+05],
        [1.6634e+00, 1.6170e+00, 3.8570e+05, 3.8745e+05, 1.6568e+00, 1.4441e+00,
         4.0369e+05, 3.9307e+05, 1.6987e+00, 3.8546e+05, 0.0000e+00, 3.9204e+05,
         3.8002e+05, 1.8715e+00, 1.6174e+00, 3.8657e+05, 1.6591e+00, 1.6319e+00],
        [3.9205e+05, 3.9203e+05, 7.8909e+05, 7.8557e+05, 3.9201e+05, 3.9203e+05,
         8.0462e+05, 8.0078e+05, 3.9207e+05, 7.8625e+05, 3.9204e+05, 0.0000e+00,
         7.7098e+05, 3.9202e+05, 3.9205e+05, 7.9361e+05, 3.9205e+05, 3.9205e+05],
        [3.8000e+05, 3.8003e+05, 7.5825e+05, 7.6296e+05, 3.7999e+05, 3.8001e+05,
         7.8614e+05, 7.7369e+05, 3.7999e+05, 7.5224e+05, 3.8002e+05, 7.7098e+05,
         0.0000e+00, 3.8001e+05, 3.7998e+05, 7.4743e+05, 3.7999e+05, 3.7997e+05],
        [1.7915e+00, 1.7332e+00, 3.8569e+05, 3.8751e+05, 1.6875e+00, 1.5345e+00,
         4.0372e+05, 3.9305e+05, 1.9393e+00, 3.8544e+05, 1.8715e+00, 3.9202e+05,
         3.8001e+05, 0.0000e+00, 1.8573e+00, 3.8659e+05, 1.6959e+00, 1.7369e+00],
        [1.6695e+00, 1.6631e+00, 3.8569e+05, 3.8749e+05, 1.6498e+00, 1.5347e+00,
         4.0368e+05, 3.9310e+05, 1.6351e+00, 3.8544e+05, 1.6174e+00, 3.9205e+05,
         3.7998e+05, 1.8573e+00, 0.0000e+00, 3.8658e+05, 1.7200e+00, 1.7025e+00],
        [3.8658e+05, 3.8656e+05, 7.5581e+05, 7.4006e+05, 3.8657e+05, 3.8657e+05,
         7.9197e+05, 7.7244e+05, 3.8659e+05, 7.7331e+05, 3.8657e+05, 7.9361e+05,
         7.4743e+05, 3.8659e+05, 3.8658e+05, 0.0000e+00, 3.8657e+05, 3.8659e+05],
        [1.7648e+00, 1.5045e+00, 3.8573e+05, 3.8751e+05, 1.5397e+00, 1.4998e+00,
         4.0372e+05, 3.9306e+05, 1.6583e+00, 3.8546e+05, 1.6591e+00, 3.9205e+05,
         3.7999e+05, 1.6959e+00, 1.7200e+00, 3.8657e+05, 0.0000e+00, 1.6868e+00],
        [1.7700e+00, 1.7617e+00, 3.8570e+05, 3.8748e+05, 1.7263e+00, 1.5826e+00,
         4.0371e+05, 3.9307e+05, 1.8078e+00, 3.8545e+05, 1.6319e+00, 3.9205e+05,
         3.7997e+05, 1.7369e+00, 1.7025e+00, 3.8659e+05, 1.6868e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6109e+00, 1.6634e+00, 1.6695e+00, 1.7285e+00, 1.7648e+00,
        1.7700e+00, 1.7915e+00, 1.8017e+00, 1.8317e+00, 3.8000e+05, 3.8546e+05,
        3.8568e+05, 3.8658e+05, 3.8745e+05, 3.9205e+05, 3.9309e+05, 4.0371e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5045e+00, 1.5272e+00, 1.6170e+00, 1.6631e+00, 1.6678e+00,
        1.7332e+00, 1.7617e+00, 1.7720e+00, 1.8317e+00, 3.8003e+05, 3.8544e+05,
        3.8572e+05, 3.8656e+05, 3.8751e+05, 3.9203e+05, 3.9305e+05, 4.0372e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385673.0000, 385677.0312, 385686.8125, 385689.8750,
        385694.6562, 385696.7812, 385699.6250, 385716.3750, 385716.6250,
        385731.2188, 755812.9375, 758248.0625, 773614.5625, 775322.5000,
        782359.4375, 789087.2500, 797418.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387435.9688, 387448.3125, 387450.3750, 387479.1875,
        387486.8125, 387507.7188, 387507.8750, 387508.5000, 387510.8750,
        387517.9062, 740057.1875, 762957.8125, 780922.8750, 782359.4375,
        785565.1875, 796264.0000, 808018.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4792e+00, 1.5397e+00, 1.6109e+00, 1.6498e+00, 1.6568e+00,
        1.6678e+00, 1.6875e+00, 1.6991e+00, 1.7263e+00, 3.7999e+05, 3.8544e+05,
        3.8572e+05, 3.8657e+05, 3.8744e+05, 3.9201e+05, 3.9309e+05, 4.0369e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4441e+00, 1.4792e+00, 1.4998e+00, 1.5272e+00, 1.5345e+00,
        1.5347e+00, 1.5826e+00, 1.6279e+00, 1.7285e+00, 3.8001e+05, 3.8546e+05,
        3.8569e+05, 3.8657e+05, 3.8751e+05, 3.9203e+05, 3.9305e+05, 4.0372e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 403685.0000, 403689.0625, 403691.2188, 403708.9375,
        403710.2500, 403711.3438, 403715.2500, 403718.2500, 403721.8125,
        403724.5625, 786136.8750, 791971.4375, 796122.0000, 796264.0000,
        797418.6250, 804529.0625, 804623.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393052.6875, 393053.2500, 393053.5312, 393062.8125,
        393068.4688, 393069.7188, 393075.8750, 393086.7812, 393088.3125,
        393097.1562, 772440.6875, 773689.2500, 775322.5000, 782846.5625,
        800784.8125, 804529.0625, 808018.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6279e+00, 1.6351e+00, 1.6583e+00, 1.6987e+00, 1.6991e+00,
        1.7720e+00, 1.8017e+00, 1.8078e+00, 1.9393e+00, 3.7999e+05, 3.8546e+05,
        3.8567e+05, 3.8659e+05, 3.8752e+05, 3.9207e+05, 3.9308e+05, 4.0371e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385435.2188, 385435.4375, 385439.4688, 385440.1250,
        385446.3125, 385459.5312, 385462.1562, 385462.6875, 385463.6562,
        385464.0625, 752241.3125, 773313.8750, 773614.5625, 780922.8750,
        782846.5625, 786245.3125, 796122.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4441e+00, 1.6170e+00, 1.6174e+00, 1.6319e+00, 1.6568e+00,
        1.6591e+00, 1.6634e+00, 1.6987e+00, 1.8715e+00, 3.8002e+05, 3.8546e+05,
        3.8570e+05, 3.8657e+05, 3.8745e+05, 3.9204e+05, 3.9307e+05, 4.0369e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392013.0625, 392020.1562, 392030.2500, 392031.9688,
        392038.6562, 392047.2500, 392048.2188, 392051.7812, 392053.8125,
        392072.2500, 770976.7500, 785565.1875, 786245.3125, 789087.2500,
        793608.5000, 800784.8125, 804623.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 379965.6875, 379980.8125, 379990.1875, 379993.6250,
        379994.7500, 379997.7500, 380013.9688, 380014.4062, 380018.8750,
        380027.7500, 747429.6250, 752241.3125, 758248.0625, 762957.8125,
        770976.7500, 773689.2500, 786136.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5345e+00, 1.6875e+00, 1.6959e+00, 1.7332e+00, 1.7369e+00,
        1.7915e+00, 1.8573e+00, 1.8715e+00, 1.9393e+00, 3.8001e+05, 3.8544e+05,
        3.8569e+05, 3.8659e+05, 3.8751e+05, 3.9202e+05, 3.9305e+05, 4.0372e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5347e+00, 1.6174e+00, 1.6351e+00, 1.6498e+00, 1.6631e+00,
        1.6695e+00, 1.7025e+00, 1.7200e+00, 1.8573e+00, 3.7998e+05, 3.8544e+05,
        3.8569e+05, 3.8658e+05, 3.8749e+05, 3.9205e+05, 3.9310e+05, 4.0368e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 386555.3438, 386565.7500, 386570.6875, 386573.0312,
        386573.9688, 386579.8438, 386582.8750, 386590.7500, 386592.2188,
        386593.1875, 740057.1875, 747429.6250, 755812.9375, 772440.6875,
        773313.8750, 791971.4375, 793608.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4998e+00, 1.5045e+00, 1.5397e+00, 1.6583e+00, 1.6591e+00,
        1.6868e+00, 1.6959e+00, 1.7200e+00, 1.7648e+00, 3.7999e+05, 3.8546e+05,
        3.8573e+05, 3.8657e+05, 3.8751e+05, 3.9205e+05, 3.9306e+05, 4.0372e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5826e+00, 1.6319e+00, 1.6868e+00, 1.7025e+00, 1.7263e+00,
        1.7369e+00, 1.7617e+00, 1.7700e+00, 1.8078e+00, 3.7997e+05, 3.8545e+05,
        3.8570e+05, 3.8659e+05, 3.8748e+05, 3.9205e+05, 3.9307e+05, 4.0371e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['69588.69', '69589.36', '419344.94', '419537.31', '69585.80', '69590.06', '438473.81', '427559.00', '69588.16', '418795.44', '69590.68', '426489.47', '413402.44', '69587.77', '69585.02', '418712.22', '69588.09', '69584.30']
estimated f for each client, fs: [8, 8, 6, 6, 8, 8, 6, 6, 8, 6, 8, 6, 6, 8, 8, 6, 8, 8]
selected_index: 17
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Chosen Update']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0174s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:48...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:48, End: 2025-07-22 15:29:48)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.3544e+00, 1.4962e+00, 3.8280e+05, 3.8854e+05, 1.3777e+00,
         1.4418e+00, 3.8342e+05, 3.7829e+05, 1.4807e+00, 3.7812e+05, 1.3568e+00,
         1.3598e+00, 4.0369e+05, 3.9583e+05, 1.4562e+00, 1.3955e+00, 1.5172e+00,
         1.7325e+00],
        [1.3544e+00, 0.0000e+00, 1.3931e+00, 3.8284e+05, 3.8855e+05, 1.3812e+00,
         1.4173e+00, 3.8343e+05, 3.7830e+05, 1.4794e+00, 3.7811e+05, 1.3604e+00,
         1.4237e+00, 4.0369e+05, 3.9582e+05, 1.5903e+00, 1.3932e+00, 1.5128e+00,
         1.9595e+00],
        [1.4962e+00, 1.3931e+00, 0.0000e+00, 3.8281e+05, 3.8856e+05, 1.3498e+00,
         1.2391e+00, 3.8342e+05, 3.7829e+05, 1.4531e+00, 3.7809e+05, 1.4257e+00,
         1.2871e+00, 4.0367e+05, 3.9585e+05, 1.4216e+00, 1.3526e+00, 1.2542e+00,
         1.6630e+00],
        [3.8280e+05, 3.8284e+05, 3.8281e+05, 0.0000e+00, 7.5068e+05, 3.8280e+05,
         3.8283e+05, 7.7603e+05, 7.5730e+05, 3.8283e+05, 7.4289e+05, 3.8282e+05,
         3.8283e+05, 7.7481e+05, 7.8092e+05, 3.8281e+05, 3.8283e+05, 3.8282e+05,
         3.8281e+05],
        [3.8854e+05, 3.8855e+05, 3.8856e+05, 7.5068e+05, 0.0000e+00, 3.8853e+05,
         3.8855e+05, 7.8395e+05, 7.7480e+05, 3.8854e+05, 7.8971e+05, 3.8858e+05,
         3.8853e+05, 7.9710e+05, 7.8506e+05, 3.8857e+05, 3.8855e+05, 3.8855e+05,
         3.8858e+05],
        [1.3777e+00, 1.3812e+00, 1.3498e+00, 3.8280e+05, 3.8853e+05, 0.0000e+00,
         1.2323e+00, 3.8340e+05, 3.7833e+05, 1.4295e+00, 3.7812e+05, 1.3966e+00,
         1.3568e+00, 4.0367e+05, 3.9584e+05, 1.4246e+00, 1.3798e+00, 1.2999e+00,
         1.7430e+00],
        [1.4418e+00, 1.4173e+00, 1.2391e+00, 3.8283e+05, 3.8855e+05, 1.2323e+00,
         0.0000e+00, 3.8344e+05, 3.7831e+05, 1.3627e+00, 3.7812e+05, 1.4276e+00,
         1.2413e+00, 4.0366e+05, 3.9582e+05, 1.2841e+00, 1.3310e+00, 1.2837e+00,
         1.4744e+00],
        [3.8342e+05, 3.8343e+05, 3.8342e+05, 7.7603e+05, 7.8395e+05, 3.8340e+05,
         3.8344e+05, 0.0000e+00, 7.4973e+05, 3.8343e+05, 7.8943e+05, 3.8343e+05,
         3.8343e+05, 7.8907e+05, 7.6396e+05, 3.8343e+05, 3.8342e+05, 3.8343e+05,
         3.8345e+05],
        [3.7829e+05, 3.7830e+05, 3.7829e+05, 7.5730e+05, 7.7480e+05, 3.7833e+05,
         3.7831e+05, 7.4973e+05, 0.0000e+00, 3.7834e+05, 7.3770e+05, 3.7830e+05,
         3.7830e+05, 7.8620e+05, 7.6200e+05, 3.7833e+05, 3.7832e+05, 3.7830e+05,
         3.7833e+05],
        [1.4807e+00, 1.4794e+00, 1.4531e+00, 3.8283e+05, 3.8854e+05, 1.4295e+00,
         1.3627e+00, 3.8343e+05, 3.7834e+05, 0.0000e+00, 3.7811e+05, 1.3323e+00,
         1.4492e+00, 4.0366e+05, 3.9585e+05, 1.6102e+00, 1.3916e+00, 1.4181e+00,
         1.8985e+00],
        [3.7812e+05, 3.7811e+05, 3.7809e+05, 7.4289e+05, 7.8971e+05, 3.7812e+05,
         3.7812e+05, 7.8943e+05, 7.3770e+05, 3.7811e+05, 0.0000e+00, 3.7811e+05,
         3.7809e+05, 7.8680e+05, 7.8532e+05, 3.7812e+05, 3.7811e+05, 3.7810e+05,
         3.7809e+05],
        [1.3568e+00, 1.3604e+00, 1.4257e+00, 3.8282e+05, 3.8858e+05, 1.3966e+00,
         1.4276e+00, 3.8343e+05, 3.7830e+05, 1.3323e+00, 3.7811e+05, 0.0000e+00,
         1.4894e+00, 4.0369e+05, 3.9584e+05, 1.5382e+00, 1.4771e+00, 1.4433e+00,
         1.9304e+00],
        [1.3598e+00, 1.4237e+00, 1.2871e+00, 3.8283e+05, 3.8853e+05, 1.3568e+00,
         1.2413e+00, 3.8343e+05, 3.7830e+05, 1.4492e+00, 3.7809e+05, 1.4894e+00,
         0.0000e+00, 4.0365e+05, 3.9584e+05, 1.5923e+00, 1.3447e+00, 1.4262e+00,
         1.6129e+00],
        [4.0369e+05, 4.0369e+05, 4.0367e+05, 7.7481e+05, 7.9710e+05, 4.0367e+05,
         4.0366e+05, 7.8907e+05, 7.8620e+05, 4.0366e+05, 7.8680e+05, 4.0369e+05,
         4.0365e+05, 0.0000e+00, 7.8113e+05, 4.0363e+05, 4.0370e+05, 4.0366e+05,
         4.0366e+05],
        [3.9583e+05, 3.9582e+05, 3.9585e+05, 7.8092e+05, 7.8506e+05, 3.9584e+05,
         3.9582e+05, 7.6396e+05, 7.6200e+05, 3.9585e+05, 7.8532e+05, 3.9584e+05,
         3.9584e+05, 7.8113e+05, 0.0000e+00, 3.9582e+05, 3.9580e+05, 3.9582e+05,
         3.9579e+05],
        [1.4562e+00, 1.5903e+00, 1.4216e+00, 3.8281e+05, 3.8857e+05, 1.4246e+00,
         1.2841e+00, 3.8343e+05, 3.7833e+05, 1.6102e+00, 3.7812e+05, 1.5382e+00,
         1.5923e+00, 4.0363e+05, 3.9582e+05, 0.0000e+00, 1.5527e+00, 1.4212e+00,
         1.5401e+00],
        [1.3955e+00, 1.3932e+00, 1.3526e+00, 3.8283e+05, 3.8855e+05, 1.3798e+00,
         1.3310e+00, 3.8342e+05, 3.7832e+05, 1.3916e+00, 3.7811e+05, 1.4771e+00,
         1.3447e+00, 4.0370e+05, 3.9580e+05, 1.5527e+00, 0.0000e+00, 1.4447e+00,
         1.8288e+00],
        [1.5172e+00, 1.5128e+00, 1.2542e+00, 3.8282e+05, 3.8855e+05, 1.2999e+00,
         1.2837e+00, 3.8343e+05, 3.7830e+05, 1.4181e+00, 3.7810e+05, 1.4433e+00,
         1.4262e+00, 4.0366e+05, 3.9582e+05, 1.4212e+00, 1.4447e+00, 0.0000e+00,
         1.7127e+00],
        [1.7325e+00, 1.9595e+00, 1.6630e+00, 3.8281e+05, 3.8858e+05, 1.7430e+00,
         1.4744e+00, 3.8345e+05, 3.7833e+05, 1.8985e+00, 3.7809e+05, 1.9304e+00,
         1.6129e+00, 4.0366e+05, 3.9579e+05, 1.5401e+00, 1.8288e+00, 1.7127e+00,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3544e+00, 1.3568e+00, 1.3598e+00, 1.3777e+00, 1.3955e+00,
        1.4418e+00, 1.4562e+00, 1.4807e+00, 1.4962e+00, 1.5172e+00, 1.7325e+00,
        3.7812e+05, 3.7829e+05, 3.8280e+05, 3.8342e+05, 3.8854e+05, 3.9583e+05,
        4.0369e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3544e+00, 1.3604e+00, 1.3812e+00, 1.3931e+00, 1.3932e+00,
        1.4173e+00, 1.4237e+00, 1.4794e+00, 1.5128e+00, 1.5903e+00, 1.9595e+00,
        3.7811e+05, 3.7830e+05, 3.8284e+05, 3.8343e+05, 3.8855e+05, 3.9582e+05,
        4.0369e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2391e+00, 1.2542e+00, 1.2871e+00, 1.3498e+00, 1.3526e+00,
        1.3931e+00, 1.4216e+00, 1.4257e+00, 1.4531e+00, 1.4962e+00, 1.6630e+00,
        3.7809e+05, 3.7829e+05, 3.8281e+05, 3.8342e+05, 3.8856e+05, 3.9585e+05,
        4.0367e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382797.2812, 382804.1250, 382813.1875, 382813.7188,
        382814.3750, 382815.0312, 382823.0625, 382830.9062, 382831.6562,
        382833.2500, 382833.5000, 382837.1562, 742891.8125, 750682.9375,
        757295.4375, 774810.6250, 776030.9375, 780919.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 388528.2812, 388534.9062, 388539.7500, 388541.0625,
        388546.2500, 388553.2812, 388553.6875, 388554.6562, 388561.0625,
        388572.9375, 388578.8750, 388580.5000, 750682.9375, 774795.1250,
        783946.0625, 785056.1875, 789713.5625, 797097.8125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.2323e+00, 1.2999e+00, 1.3498e+00, 1.3568e+00, 1.3777e+00,
        1.3798e+00, 1.3812e+00, 1.3966e+00, 1.4246e+00, 1.4295e+00, 1.7430e+00,
        3.7812e+05, 3.7833e+05, 3.8280e+05, 3.8340e+05, 3.8853e+05, 3.9584e+05,
        4.0367e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2323e+00, 1.2391e+00, 1.2413e+00, 1.2837e+00, 1.2841e+00,
        1.3310e+00, 1.3627e+00, 1.4173e+00, 1.4276e+00, 1.4418e+00, 1.4744e+00,
        3.7812e+05, 3.7831e+05, 3.8283e+05, 3.8344e+05, 3.8855e+05, 3.9582e+05,
        4.0366e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 383400.1875, 383421.4375, 383422.5000, 383423.2500,
        383428.3438, 383429.0625, 383429.0938, 383432.5000, 383433.5000,
        383434.0938, 383443.3750, 383445.3750, 749729.9375, 763957.8125,
        776030.9375, 783946.0625, 789071.2500, 789425.1875])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 378285.8125, 378292.5938, 378299.5938, 378300.4375,
        378303.5938, 378304.7188, 378306.9375, 378319.7188, 378327.7188,
        378330.2188, 378334.2188, 378338.1875, 737702.0000, 749729.9375,
        757295.4375, 761998.3750, 774795.1250, 786200.1250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.3323e+00, 1.3627e+00, 1.3916e+00, 1.4181e+00, 1.4295e+00,
        1.4492e+00, 1.4531e+00, 1.4794e+00, 1.4807e+00, 1.6102e+00, 1.8985e+00,
        3.7811e+05, 3.7834e+05, 3.8283e+05, 3.8343e+05, 3.8854e+05, 3.9585e+05,
        4.0366e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 378085.9688, 378088.3750, 378092.6250, 378101.0625,
        378105.3125, 378109.0938, 378110.4375, 378113.6875, 378116.2188,
        378116.7500, 378117.4688, 378119.3125, 737702.0000, 742891.8125,
        785318.4375, 786795.9375, 789425.1875, 789713.5625])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.3323e+00, 1.3568e+00, 1.3604e+00, 1.3966e+00, 1.4257e+00,
        1.4276e+00, 1.4433e+00, 1.4771e+00, 1.4894e+00, 1.5382e+00, 1.9304e+00,
        3.7811e+05, 3.7830e+05, 3.8282e+05, 3.8343e+05, 3.8858e+05, 3.9584e+05,
        4.0369e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2413e+00, 1.2871e+00, 1.3447e+00, 1.3568e+00, 1.3598e+00,
        1.4237e+00, 1.4262e+00, 1.4492e+00, 1.4894e+00, 1.5923e+00, 1.6129e+00,
        3.7809e+05, 3.7830e+05, 3.8283e+05, 3.8343e+05, 3.8853e+05, 3.9584e+05,
        4.0365e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 403633.9375, 403649.5000, 403657.7188, 403661.3750,
        403662.7500, 403665.0000, 403668.8125, 403670.6875, 403685.3125,
        403690.3125, 403690.5000, 403698.9688, 774810.6250, 781125.6250,
        786200.1250, 786795.9375, 789071.2500, 797097.8125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 395788.5625, 395803.1875, 395815.0000, 395818.0000,
        395818.2500, 395819.7188, 395826.2812, 395838.6250, 395839.7188,
        395839.7500, 395846.3750, 395849.3750, 761998.3750, 763957.8125,
        780919.8750, 781125.6250, 785056.1875, 785318.4375])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.2841e+00, 1.4212e+00, 1.4216e+00, 1.4246e+00, 1.4562e+00,
        1.5382e+00, 1.5401e+00, 1.5527e+00, 1.5903e+00, 1.5923e+00, 1.6102e+00,
        3.7812e+05, 3.7833e+05, 3.8281e+05, 3.8343e+05, 3.8857e+05, 3.9582e+05,
        4.0363e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3310e+00, 1.3447e+00, 1.3526e+00, 1.3798e+00, 1.3916e+00,
        1.3932e+00, 1.3955e+00, 1.4447e+00, 1.4771e+00, 1.5527e+00, 1.8288e+00,
        3.7811e+05, 3.7832e+05, 3.8283e+05, 3.8342e+05, 3.8855e+05, 3.9580e+05,
        4.0370e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2542e+00, 1.2837e+00, 1.2999e+00, 1.4181e+00, 1.4212e+00,
        1.4262e+00, 1.4433e+00, 1.4447e+00, 1.5128e+00, 1.5172e+00, 1.7127e+00,
        3.7810e+05, 3.7830e+05, 3.8282e+05, 3.8343e+05, 3.8855e+05, 3.9582e+05,
        4.0366e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4744e+00, 1.5401e+00, 1.6129e+00, 1.6630e+00, 1.7127e+00,
        1.7325e+00, 1.7430e+00, 1.8288e+00, 1.8985e+00, 1.9304e+00, 1.9595e+00,
        3.7809e+05, 3.7833e+05, 3.8281e+05, 3.8345e+05, 3.8858e+05, 3.9579e+05,
        4.0366e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['1.45', '1.48', '1.39', '382820.62', '388553.78', '1.40', '1.34', '383428.56', '378312.00', '1.48', '378106.41', '1.47', '1.42', '403669.59', '395825.31', '1.49', '1.44', '1.43', '1.74']
estimated f for each client, fs: [7, 7, 7, 5, 5, 7, 7, 5, 5, 7, 5, 7, 7, 5, 5, 7, 7, 7, 7]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0197s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:49...
global Accuracy on shared test data: 78.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 44 219]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:49, End: 2025-07-22 15:29:49)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4337e+00, 3.8209e+05, 1.3308e+00, 1.6709e+00, 3.9568e+05,
         1.4362e+00, 3.7509e+05, 1.2790e+00, 1.2942e+00, 3.9722e+05, 4.0223e+05,
         1.3350e+00, 3.8448e+05, 1.4057e+00, 1.5023e+00],
        [1.4337e+00, 0.0000e+00, 3.8211e+05, 1.3844e+00, 1.3740e+00, 3.9567e+05,
         1.4268e+00, 3.7506e+05, 1.3819e+00, 1.3108e+00, 3.9720e+05, 4.0225e+05,
         1.3274e+00, 3.8448e+05, 1.2285e+00, 1.4075e+00],
        [3.8209e+05, 3.8211e+05, 0.0000e+00, 3.8210e+05, 3.8211e+05, 7.8321e+05,
         3.8208e+05, 7.7635e+05, 3.8209e+05, 3.8212e+05, 8.0597e+05, 7.7703e+05,
         3.8209e+05, 7.3117e+05, 3.8210e+05, 3.8210e+05],
        [1.3308e+00, 1.3844e+00, 3.8210e+05, 0.0000e+00, 1.5093e+00, 3.9563e+05,
         1.4425e+00, 3.7507e+05, 1.4216e+00, 1.3577e+00, 3.9725e+05, 4.0226e+05,
         1.3537e+00, 3.8448e+05, 1.2778e+00, 1.4978e+00],
        [1.6709e+00, 1.3740e+00, 3.8211e+05, 1.5093e+00, 0.0000e+00, 3.9563e+05,
         1.6431e+00, 3.7505e+05, 1.7325e+00, 1.4794e+00, 3.9723e+05, 4.0228e+05,
         1.5662e+00, 3.8448e+05, 1.4861e+00, 1.2534e+00],
        [3.9568e+05, 3.9567e+05, 7.8321e+05, 3.9563e+05, 3.9563e+05, 0.0000e+00,
         3.9565e+05, 7.7328e+05, 3.9567e+05, 3.9568e+05, 7.8514e+05, 8.0490e+05,
         3.9567e+05, 7.9616e+05, 3.9566e+05, 3.9564e+05],
        [1.4362e+00, 1.4268e+00, 3.8208e+05, 1.4425e+00, 1.6431e+00, 3.9565e+05,
         0.0000e+00, 3.7505e+05, 1.3225e+00, 1.4028e+00, 3.9727e+05, 4.0226e+05,
         1.3586e+00, 3.8446e+05, 1.3693e+00, 1.5971e+00],
        [3.7509e+05, 3.7506e+05, 7.7635e+05, 3.7507e+05, 3.7505e+05, 7.7328e+05,
         3.7505e+05, 0.0000e+00, 3.7508e+05, 3.7509e+05, 7.8047e+05, 7.6481e+05,
         3.7508e+05, 7.7079e+05, 3.7507e+05, 3.7508e+05],
        [1.2790e+00, 1.3819e+00, 3.8209e+05, 1.4216e+00, 1.7325e+00, 3.9567e+05,
         1.3225e+00, 3.7508e+05, 0.0000e+00, 1.4105e+00, 3.9719e+05, 4.0226e+05,
         1.4255e+00, 3.8446e+05, 1.4113e+00, 1.6341e+00],
        [1.2942e+00, 1.3108e+00, 3.8212e+05, 1.3577e+00, 1.4794e+00, 3.9568e+05,
         1.4028e+00, 3.7509e+05, 1.4105e+00, 0.0000e+00, 3.9725e+05, 4.0228e+05,
         1.2943e+00, 3.8447e+05, 1.3853e+00, 1.3823e+00],
        [3.9722e+05, 3.9720e+05, 8.0597e+05, 3.9725e+05, 3.9723e+05, 7.8514e+05,
         3.9727e+05, 7.8047e+05, 3.9719e+05, 3.9725e+05, 0.0000e+00, 8.1585e+05,
         3.9722e+05, 7.6813e+05, 3.9724e+05, 3.9722e+05],
        [4.0223e+05, 4.0225e+05, 7.7703e+05, 4.0226e+05, 4.0228e+05, 8.0490e+05,
         4.0226e+05, 7.6481e+05, 4.0226e+05, 4.0228e+05, 8.1585e+05, 0.0000e+00,
         4.0226e+05, 7.8375e+05, 4.0226e+05, 4.0228e+05],
        [1.3350e+00, 1.3274e+00, 3.8209e+05, 1.3537e+00, 1.5662e+00, 3.9567e+05,
         1.3586e+00, 3.7508e+05, 1.4255e+00, 1.2943e+00, 3.9722e+05, 4.0226e+05,
         0.0000e+00, 3.8449e+05, 1.3806e+00, 1.5683e+00],
        [3.8448e+05, 3.8448e+05, 7.3117e+05, 3.8448e+05, 3.8448e+05, 7.9616e+05,
         3.8446e+05, 7.7079e+05, 3.8446e+05, 3.8447e+05, 7.6813e+05, 7.8375e+05,
         3.8449e+05, 0.0000e+00, 3.8448e+05, 3.8447e+05],
        [1.4057e+00, 1.2285e+00, 3.8210e+05, 1.2778e+00, 1.4861e+00, 3.9566e+05,
         1.3693e+00, 3.7507e+05, 1.4113e+00, 1.3853e+00, 3.9724e+05, 4.0226e+05,
         1.3806e+00, 3.8448e+05, 0.0000e+00, 1.4558e+00],
        [1.5023e+00, 1.4075e+00, 3.8210e+05, 1.4978e+00, 1.2534e+00, 3.9564e+05,
         1.5971e+00, 3.7508e+05, 1.6341e+00, 1.3823e+00, 3.9722e+05, 4.0228e+05,
         1.5683e+00, 3.8447e+05, 1.4558e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2790e+00, 1.2942e+00, 1.3308e+00, 1.3350e+00, 1.4057e+00,
        1.4337e+00, 1.4362e+00, 1.5023e+00, 1.6709e+00, 3.7509e+05, 3.8209e+05,
        3.8448e+05, 3.9568e+05, 3.9722e+05, 4.0223e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2285e+00, 1.3108e+00, 1.3274e+00, 1.3740e+00, 1.3819e+00,
        1.3844e+00, 1.4075e+00, 1.4268e+00, 1.4337e+00, 3.7506e+05, 3.8211e+05,
        3.8448e+05, 3.9567e+05, 3.9720e+05, 4.0225e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382076.6250, 382092.5312, 382094.2500, 382094.3125,
        382095.8125, 382101.5312, 382104.7812, 382106.1250, 382109.4375,
        382115.0000, 731172.0000, 776345.5000, 777026.2500, 783214.1250,
        805971.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2778e+00, 1.3308e+00, 1.3537e+00, 1.3577e+00, 1.3844e+00,
        1.4216e+00, 1.4425e+00, 1.4978e+00, 1.5093e+00, 3.7507e+05, 3.8210e+05,
        3.8448e+05, 3.9563e+05, 3.9725e+05, 4.0226e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2534e+00, 1.3740e+00, 1.4794e+00, 1.4861e+00, 1.5093e+00,
        1.5662e+00, 1.6431e+00, 1.6709e+00, 1.7325e+00, 3.7505e+05, 3.8211e+05,
        3.8448e+05, 3.9563e+05, 3.9723e+05, 4.0228e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395630.4062, 395632.5000, 395641.0312, 395645.1250,
        395661.9688, 395667.0938, 395669.6250, 395673.6250, 395681.9375,
        395683.6875, 773283.7500, 783214.1250, 785135.4375, 796157.3125,
        804895.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3225e+00, 1.3586e+00, 1.3693e+00, 1.4028e+00, 1.4268e+00,
        1.4362e+00, 1.4425e+00, 1.5971e+00, 1.6431e+00, 3.7505e+05, 3.8208e+05,
        3.8446e+05, 3.9565e+05, 3.9727e+05, 4.0226e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 375052.5625, 375054.6562, 375064.0312, 375065.1250,
        375074.7500, 375076.6250, 375078.1875, 375080.5938, 375091.5938,
        375094.5312, 764809.2500, 770787.6875, 773283.7500, 776345.5000,
        780467.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2790e+00, 1.3225e+00, 1.3819e+00, 1.4105e+00, 1.4113e+00,
        1.4216e+00, 1.4255e+00, 1.6341e+00, 1.7325e+00, 3.7508e+05, 3.8209e+05,
        3.8446e+05, 3.9567e+05, 3.9719e+05, 4.0226e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2942e+00, 1.2943e+00, 1.3108e+00, 1.3577e+00, 1.3823e+00,
        1.3853e+00, 1.4028e+00, 1.4105e+00, 1.4794e+00, 3.7509e+05, 3.8212e+05,
        3.8447e+05, 3.9568e+05, 3.9725e+05, 4.0228e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397192.7188, 397199.1562, 397217.6250, 397218.2500,
        397220.9688, 397226.8125, 397239.9062, 397252.4062, 397253.8750,
        397268.1875, 768132.6250, 780467.4375, 785135.4375, 805971.2500,
        815854.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402234.5000, 402253.9375, 402256.0312, 402256.0625,
        402256.3750, 402256.9375, 402263.0000, 402278.9688, 402281.5938,
        402283.5312, 764809.2500, 777026.2500, 783747.6250, 804895.2500,
        815854.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2943e+00, 1.3274e+00, 1.3350e+00, 1.3537e+00, 1.3586e+00,
        1.3806e+00, 1.4255e+00, 1.5662e+00, 1.5683e+00, 3.7508e+05, 3.8209e+05,
        3.8449e+05, 3.9567e+05, 3.9722e+05, 4.0226e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384460.1875, 384461.2812, 384465.8750, 384474.9375,
        384478.4062, 384479.8750, 384483.8750, 384484.0312, 384484.7188,
        384488.0312, 731172.0000, 768132.6250, 770787.6875, 783747.6250,
        796157.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2285e+00, 1.2778e+00, 1.3693e+00, 1.3806e+00, 1.3853e+00,
        1.4057e+00, 1.4113e+00, 1.4558e+00, 1.4861e+00, 3.7507e+05, 3.8210e+05,
        3.8448e+05, 3.9566e+05, 3.9724e+05, 4.0226e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2534e+00, 1.3823e+00, 1.4075e+00, 1.4558e+00, 1.4978e+00,
        1.5023e+00, 1.5683e+00, 1.5971e+00, 1.6341e+00, 3.7508e+05, 3.8210e+05,
        3.8447e+05, 3.9564e+05, 3.9722e+05, 4.0228e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37510.43', '37507.63', '382099.00', '37508.73', '37506.62', '395658.66', '37506.77', '375073.28', '37509.36', '37510.68', '397229.00', '402262.09', '37509.07', '384476.16', '37507.75', '37508.99']
estimated f for each client, fs: [6, 6, 4, 6, 6, 4, 6, 5, 6, 6, 4, 4, 6, 4, 6, 6]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0105s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:49...
global Accuracy on shared test data: 78.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 48 215]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:49, End: 2025-07-22 15:29:49)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [5, 7, 19, 17, 9, 20, 18, 8, 3, 14, 11, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 1.1599e+00, 3.8646e+05, 3.8661e+05, 1.8748e+00, 3.7985e+05,
         3.9168e+05, 1.2211e+00, 1.1071e+00, 3.8613e+05, 1.2275e+00, 1.3113e+00],
        [1.1599e+00, 0.0000e+00, 3.8646e+05, 3.8662e+05, 1.8603e+00, 3.7983e+05,
         3.9171e+05, 1.2373e+00, 1.2181e+00, 3.8612e+05, 1.2611e+00, 1.3989e+00],
        [3.8646e+05, 3.8646e+05, 0.0000e+00, 7.5076e+05, 3.8647e+05, 7.7908e+05,
         7.9056e+05, 3.8647e+05, 3.8647e+05, 7.7928e+05, 3.8645e+05, 3.8648e+05],
        [3.8661e+05, 3.8662e+05, 7.5076e+05, 0.0000e+00, 3.8663e+05, 7.9733e+05,
         7.6281e+05, 3.8660e+05, 3.8659e+05, 7.8252e+05, 3.8662e+05, 3.8661e+05],
        [1.8748e+00, 1.8603e+00, 3.8647e+05, 3.8663e+05, 0.0000e+00, 3.7982e+05,
         3.9169e+05, 1.8327e+00, 1.6438e+00, 3.8613e+05, 1.2802e+00, 1.2180e+00],
        [3.7985e+05, 3.7983e+05, 7.7908e+05, 7.9733e+05, 3.7982e+05, 0.0000e+00,
         7.8966e+05, 3.7982e+05, 3.7984e+05, 7.7650e+05, 3.7986e+05, 3.7985e+05],
        [3.9168e+05, 3.9171e+05, 7.9056e+05, 7.6281e+05, 3.9169e+05, 7.8966e+05,
         0.0000e+00, 3.9170e+05, 3.9170e+05, 7.9242e+05, 3.9169e+05, 3.9169e+05],
        [1.2211e+00, 1.2373e+00, 3.8647e+05, 3.8660e+05, 1.8327e+00, 3.7982e+05,
         3.9170e+05, 0.0000e+00, 1.1690e+00, 3.8612e+05, 1.2966e+00, 1.3108e+00],
        [1.1071e+00, 1.2181e+00, 3.8647e+05, 3.8659e+05, 1.6438e+00, 3.7984e+05,
         3.9170e+05, 1.1690e+00, 0.0000e+00, 3.8613e+05, 1.2698e+00, 1.1851e+00],
        [3.8613e+05, 3.8612e+05, 7.7928e+05, 7.8252e+05, 3.8613e+05, 7.7650e+05,
         7.9242e+05, 3.8612e+05, 3.8613e+05, 0.0000e+00, 3.8610e+05, 3.8613e+05],
        [1.2275e+00, 1.2611e+00, 3.8645e+05, 3.8662e+05, 1.2802e+00, 3.7986e+05,
         3.9169e+05, 1.2966e+00, 1.2698e+00, 3.8610e+05, 0.0000e+00, 1.0803e+00],
        [1.3113e+00, 1.3989e+00, 3.8648e+05, 3.8661e+05, 1.2180e+00, 3.7985e+05,
         3.9169e+05, 1.3108e+00, 1.1851e+00, 3.8613e+05, 1.0803e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1071e+00, 1.1599e+00, 1.2211e+00, 1.2275e+00, 1.3113e+00,
        1.8748e+00, 3.7985e+05, 3.8613e+05, 3.8646e+05, 3.8661e+05, 3.9168e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1599e+00, 1.2181e+00, 1.2373e+00, 1.2611e+00, 1.3989e+00,
        1.8603e+00, 3.7983e+05, 3.8612e+05, 3.8646e+05, 3.8662e+05, 3.9171e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 386446.4375, 386459.1875, 386464.5312, 386465.0625,
        386469.4375, 386473.6875, 386482.3438, 750763.8750, 779082.5625,
        779283.4375, 790563.7500])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 386587.9688, 386600.0625, 386608.0000, 386611.0000,
        386616.0000, 386620.8438, 386625.7188, 750763.8750, 762805.5625,
        782515.5625, 797328.5000])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.2180e+00, 1.2802e+00, 1.6438e+00, 1.8327e+00, 1.8603e+00,
        1.8748e+00, 3.7982e+05, 3.8613e+05, 3.8647e+05, 3.8663e+05, 3.9169e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 379817.4062, 379820.6875, 379832.5000, 379839.2812,
        379849.2188, 379852.2812, 379855.0938, 776497.3750, 779082.5625,
        789655.1250, 797328.5000])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 391681.5312, 391688.2812, 391689.7500, 391693.9062,
        391695.8438, 391703.3438, 391713.4062, 762805.5625, 789655.1250,
        790563.7500, 792415.0000])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1690e+00, 1.2211e+00, 1.2373e+00, 1.2966e+00, 1.3108e+00,
        1.8327e+00, 3.7982e+05, 3.8612e+05, 3.8647e+05, 3.8660e+05, 3.9170e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1071e+00, 1.1690e+00, 1.1851e+00, 1.2181e+00, 1.2698e+00,
        1.6438e+00, 3.7984e+05, 3.8613e+05, 3.8647e+05, 3.8659e+05, 3.9170e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 386104.9062, 386116.6875, 386124.8750, 386125.9375,
        386129.8438, 386130.3125, 386132.9688, 776497.3750, 779283.4375,
        782515.5625, 792415.0000])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.0803e+00, 1.2275e+00, 1.2611e+00, 1.2698e+00, 1.2802e+00,
        1.2966e+00, 3.7986e+05, 3.8610e+05, 3.8645e+05, 3.8662e+05, 3.9169e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.0803e+00, 1.1851e+00, 1.2180e+00, 1.3108e+00, 1.3113e+00,
        1.3989e+00, 3.7985e+05, 3.8613e+05, 3.8648e+05, 3.8661e+05, 3.9169e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['95749.16', '95744.67', '432003.12', '432129.22', '95744.63', '429420.50', '438083.97', '95744.21', '95746.61', '434920.44', '95745.93', '95748.38']
estimated f for each client, fs: [5, 5, 3, 3, 5, 4, 3, 5, 5, 4, 5, 5]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 8, 3, 14, 11, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0085s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:50...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:50, End: 2025-07-22 15:29:50)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 1, 9, 20, 18, 8, 15, 4, 14, 10, 16, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.3023e+00, 1.4099e+00, 1.3243e+00, 1.7875e+00, 3.9352e+05,
         4.0049e+05, 1.5382e+00, 3.9109e+05, 1.2790e+00, 3.7758e+05, 1.3234e+00,
         3.9419e+05, 1.4050e+00],
        [1.3023e+00, 0.0000e+00, 1.3666e+00, 1.3445e+00, 1.8581e+00, 3.9352e+05,
         4.0053e+05, 1.6183e+00, 3.9108e+05, 1.3164e+00, 3.7761e+05, 1.3305e+00,
         3.9419e+05, 1.4128e+00],
        [1.4099e+00, 1.3666e+00, 0.0000e+00, 1.3634e+00, 1.4477e+00, 3.9350e+05,
         4.0052e+05, 1.4208e+00, 3.9105e+05, 1.3275e+00, 3.7761e+05, 1.3117e+00,
         3.9421e+05, 1.2941e+00],
        [1.3243e+00, 1.3445e+00, 1.3634e+00, 0.0000e+00, 1.6516e+00, 3.9355e+05,
         4.0051e+05, 1.5189e+00, 3.9107e+05, 1.3614e+00, 3.7758e+05, 1.2921e+00,
         3.9416e+05, 1.2411e+00],
        [1.7875e+00, 1.8581e+00, 1.4477e+00, 1.6516e+00, 0.0000e+00, 3.9355e+05,
         4.0050e+05, 1.4067e+00, 3.9109e+05, 1.8717e+00, 3.7759e+05, 1.6892e+00,
         3.9421e+05, 1.6238e+00],
        [3.9352e+05, 3.9352e+05, 3.9350e+05, 3.9355e+05, 3.9355e+05, 0.0000e+00,
         7.8852e+05, 3.9355e+05, 8.0922e+05, 3.9354e+05, 7.7033e+05, 3.9351e+05,
         8.0714e+05, 3.9354e+05],
        [4.0049e+05, 4.0053e+05, 4.0052e+05, 4.0051e+05, 4.0050e+05, 7.8852e+05,
         0.0000e+00, 4.0053e+05, 7.9544e+05, 4.0054e+05, 7.8235e+05, 4.0051e+05,
         8.1275e+05, 4.0051e+05],
        [1.5382e+00, 1.6183e+00, 1.4208e+00, 1.5189e+00, 1.4067e+00, 3.9355e+05,
         4.0053e+05, 0.0000e+00, 3.9107e+05, 1.4930e+00, 3.7759e+05, 1.4695e+00,
         3.9418e+05, 1.4442e+00],
        [3.9109e+05, 3.9108e+05, 3.9105e+05, 3.9107e+05, 3.9109e+05, 8.0922e+05,
         7.9544e+05, 3.9107e+05, 0.0000e+00, 3.9106e+05, 7.7812e+05, 3.9107e+05,
         7.7905e+05, 3.9106e+05],
        [1.2790e+00, 1.3164e+00, 1.3275e+00, 1.3614e+00, 1.8717e+00, 3.9354e+05,
         4.0054e+05, 1.4930e+00, 3.9106e+05, 0.0000e+00, 3.7756e+05, 1.3358e+00,
         3.9420e+05, 1.3662e+00],
        [3.7758e+05, 3.7761e+05, 3.7761e+05, 3.7758e+05, 3.7759e+05, 7.7033e+05,
         7.8235e+05, 3.7759e+05, 7.7812e+05, 3.7756e+05, 0.0000e+00, 3.7760e+05,
         7.6003e+05, 3.7758e+05],
        [1.3234e+00, 1.3305e+00, 1.3117e+00, 1.2921e+00, 1.6892e+00, 3.9351e+05,
         4.0051e+05, 1.4695e+00, 3.9107e+05, 1.3358e+00, 3.7760e+05, 0.0000e+00,
         3.9420e+05, 1.3374e+00],
        [3.9419e+05, 3.9419e+05, 3.9421e+05, 3.9416e+05, 3.9421e+05, 8.0714e+05,
         8.1275e+05, 3.9418e+05, 7.7905e+05, 3.9420e+05, 7.6003e+05, 3.9420e+05,
         0.0000e+00, 3.9422e+05],
        [1.4050e+00, 1.4128e+00, 1.2941e+00, 1.2411e+00, 1.6238e+00, 3.9354e+05,
         4.0051e+05, 1.4442e+00, 3.9106e+05, 1.3662e+00, 3.7758e+05, 1.3374e+00,
         3.9422e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2790e+00, 1.3023e+00, 1.3234e+00, 1.3243e+00, 1.4050e+00,
        1.4099e+00, 1.5382e+00, 1.7875e+00, 3.7758e+05, 3.9109e+05, 3.9352e+05,
        3.9419e+05, 4.0049e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3023e+00, 1.3164e+00, 1.3305e+00, 1.3445e+00, 1.3666e+00,
        1.4128e+00, 1.6183e+00, 1.8581e+00, 3.7761e+05, 3.9108e+05, 3.9352e+05,
        3.9419e+05, 4.0053e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2941e+00, 1.3117e+00, 1.3275e+00, 1.3634e+00, 1.3666e+00,
        1.4099e+00, 1.4208e+00, 1.4477e+00, 3.7761e+05, 3.9105e+05, 3.9350e+05,
        3.9421e+05, 4.0052e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2411e+00, 1.2921e+00, 1.3243e+00, 1.3445e+00, 1.3614e+00,
        1.3634e+00, 1.5189e+00, 1.6516e+00, 3.7758e+05, 3.9107e+05, 3.9355e+05,
        3.9416e+05, 4.0051e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4067e+00, 1.4477e+00, 1.6238e+00, 1.6516e+00, 1.6892e+00,
        1.7875e+00, 1.8581e+00, 1.8717e+00, 3.7759e+05, 3.9109e+05, 3.9355e+05,
        3.9421e+05, 4.0050e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393499.7812, 393506.7500, 393515.9688, 393524.6250,
        393535.4375, 393536.4375, 393546.0625, 393551.0312, 393554.2812,
        770325.0625, 788523.1250, 807143.5625, 809220.1250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400493.1875, 400498.1250, 400508.9375, 400512.8125,
        400513.3438, 400517.1562, 400525.7812, 400530.0000, 400539.2500,
        782349.5000, 788523.1250, 795441.7500, 812746.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4067e+00, 1.4208e+00, 1.4442e+00, 1.4695e+00, 1.4930e+00,
        1.5189e+00, 1.5382e+00, 1.6183e+00, 3.7759e+05, 3.9107e+05, 3.9355e+05,
        3.9418e+05, 4.0053e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391052.6250, 391056.9688, 391060.2188, 391069.8750,
        391072.7188, 391072.8125, 391075.9688, 391086.8750, 391087.3750,
        778117.2500, 779049.7500, 795441.7500, 809220.1250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2790e+00, 1.3164e+00, 1.3275e+00, 1.3358e+00, 1.3614e+00,
        1.3662e+00, 1.4930e+00, 1.8717e+00, 3.7756e+05, 3.9106e+05, 3.9354e+05,
        3.9420e+05, 4.0054e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 377559.1250, 377579.0000, 377579.3125, 377584.0000,
        377585.5938, 377592.7188, 377600.1250, 377607.6875, 377610.5938,
        760032.8750, 770325.0625, 778117.2500, 782349.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2921e+00, 1.3117e+00, 1.3234e+00, 1.3305e+00, 1.3358e+00,
        1.3374e+00, 1.4695e+00, 1.6892e+00, 3.7760e+05, 3.9107e+05, 3.9351e+05,
        3.9420e+05, 4.0051e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394156.6250, 394176.5000, 394185.0312, 394187.8438,
        394197.0938, 394201.3125, 394209.7812, 394212.3125, 394221.5938,
        760032.8750, 779049.7500, 807143.5625, 812746.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2411e+00, 1.2941e+00, 1.3374e+00, 1.3662e+00, 1.4050e+00,
        1.4128e+00, 1.4442e+00, 1.6238e+00, 3.7758e+05, 3.9106e+05, 3.9354e+05,
        3.9422e+05, 4.0051e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['41954.52', '41958.02', '41957.62', '41954.45', '41956.22', '393530.06', '400515.38', '41955.28', '391070.62', '41952.28', '377588.66', '41956.80', '394194.22', '41955.01']
estimated f for each client, fs: [5, 5, 5, 5, 5, 3, 3, 5, 3, 5, 4, 5, 3, 5]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 1, 9, 20, 18, 8, 15, 4, 14, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0206s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:50...
global Accuracy on shared test data: 78.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:50, End: 2025-07-22 15:29:50)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 13, 11, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.4181e+00, 1.5463e+00, 3.9704e+05, 4.0392e+05, 1.4908e+00,
         1.7953e+00, 3.9602e+05, 3.8907e+05, 1.5659e+00, 1.4230e+00, 3.8529e+05,
         1.6009e+00, 1.5841e+00, 1.6278e+00],
        [1.4181e+00, 0.0000e+00, 1.4566e+00, 3.9704e+05, 4.0393e+05, 1.4528e+00,
         1.7567e+00, 3.9600e+05, 3.8898e+05, 1.6233e+00, 1.4594e+00, 3.8530e+05,
         1.6070e+00, 1.5374e+00, 1.6920e+00],
        [1.5463e+00, 1.4566e+00, 0.0000e+00, 3.9706e+05, 4.0393e+05, 1.4994e+00,
         1.4728e+00, 3.9598e+05, 3.8903e+05, 1.4535e+00, 1.4199e+00, 3.8530e+05,
         1.4980e+00, 1.4241e+00, 1.5008e+00],
        [3.9704e+05, 3.9704e+05, 3.9706e+05, 0.0000e+00, 8.1265e+05, 3.9704e+05,
         3.9706e+05, 7.8673e+05, 8.0210e+05, 3.9704e+05, 3.9707e+05, 8.0042e+05,
         3.9708e+05, 3.9707e+05, 3.9706e+05],
        [4.0392e+05, 4.0393e+05, 4.0393e+05, 8.1265e+05, 0.0000e+00, 4.0392e+05,
         4.0389e+05, 7.9965e+05, 8.0223e+05, 4.0394e+05, 4.0394e+05, 8.0825e+05,
         4.0393e+05, 4.0390e+05, 4.0391e+05],
        [1.4908e+00, 1.4528e+00, 1.4994e+00, 3.9704e+05, 4.0392e+05, 0.0000e+00,
         1.6377e+00, 3.9601e+05, 3.8903e+05, 1.5624e+00, 1.4489e+00, 3.8529e+05,
         1.5159e+00, 1.3979e+00, 1.5955e+00],
        [1.7953e+00, 1.7567e+00, 1.4728e+00, 3.9706e+05, 4.0389e+05, 1.6377e+00,
         0.0000e+00, 3.9600e+05, 3.8907e+05, 1.3697e+00, 1.4355e+00, 3.8530e+05,
         1.2208e+00, 1.5986e+00, 1.2161e+00],
        [3.9602e+05, 3.9600e+05, 3.9598e+05, 7.8673e+05, 7.9965e+05, 3.9601e+05,
         3.9600e+05, 0.0000e+00, 7.7200e+05, 3.9600e+05, 3.9598e+05, 7.7235e+05,
         3.9600e+05, 3.9603e+05, 3.9598e+05],
        [3.8907e+05, 3.8898e+05, 3.8903e+05, 8.0210e+05, 8.0223e+05, 3.8903e+05,
         3.8907e+05, 7.7200e+05, 0.0000e+00, 3.8906e+05, 3.8905e+05, 7.8650e+05,
         3.8907e+05, 3.8904e+05, 3.8906e+05],
        [1.5659e+00, 1.6233e+00, 1.4535e+00, 3.9704e+05, 4.0394e+05, 1.5624e+00,
         1.3697e+00, 3.9600e+05, 3.8906e+05, 0.0000e+00, 1.3310e+00, 3.8529e+05,
         1.4080e+00, 1.4660e+00, 1.3878e+00],
        [1.4230e+00, 1.4594e+00, 1.4199e+00, 3.9707e+05, 4.0394e+05, 1.4489e+00,
         1.4355e+00, 3.9598e+05, 3.8905e+05, 1.3310e+00, 0.0000e+00, 3.8525e+05,
         1.3657e+00, 1.5216e+00, 1.4506e+00],
        [3.8529e+05, 3.8530e+05, 3.8530e+05, 8.0042e+05, 8.0825e+05, 3.8529e+05,
         3.8530e+05, 7.7235e+05, 7.8650e+05, 3.8529e+05, 3.8525e+05, 0.0000e+00,
         3.8527e+05, 3.8528e+05, 3.8528e+05],
        [1.6009e+00, 1.6070e+00, 1.4980e+00, 3.9708e+05, 4.0393e+05, 1.5159e+00,
         1.2208e+00, 3.9600e+05, 3.8907e+05, 1.4080e+00, 1.3657e+00, 3.8527e+05,
         0.0000e+00, 1.5291e+00, 1.3801e+00],
        [1.5841e+00, 1.5374e+00, 1.4241e+00, 3.9707e+05, 4.0390e+05, 1.3979e+00,
         1.5986e+00, 3.9603e+05, 3.8904e+05, 1.4660e+00, 1.5216e+00, 3.8528e+05,
         1.5291e+00, 0.0000e+00, 1.5552e+00],
        [1.6278e+00, 1.6920e+00, 1.5008e+00, 3.9706e+05, 4.0391e+05, 1.5955e+00,
         1.2161e+00, 3.9598e+05, 3.8906e+05, 1.3878e+00, 1.4506e+00, 3.8528e+05,
         1.3801e+00, 1.5552e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4181e+00, 1.4230e+00, 1.4908e+00, 1.5463e+00, 1.5659e+00,
        1.5841e+00, 1.6009e+00, 1.6278e+00, 1.7953e+00, 3.8529e+05, 3.8907e+05,
        3.9602e+05, 3.9704e+05, 4.0392e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4181e+00, 1.4528e+00, 1.4566e+00, 1.4594e+00, 1.5374e+00,
        1.6070e+00, 1.6233e+00, 1.6920e+00, 1.7567e+00, 3.8530e+05, 3.8898e+05,
        3.9600e+05, 3.9704e+05, 4.0393e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4199e+00, 1.4241e+00, 1.4535e+00, 1.4566e+00, 1.4728e+00,
        1.4980e+00, 1.4994e+00, 1.5008e+00, 1.5463e+00, 3.8530e+05, 3.8903e+05,
        3.9598e+05, 3.9706e+05, 4.0393e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397035.2188, 397039.0312, 397043.6250, 397044.1250,
        397057.3750, 397059.6875, 397060.9062, 397073.9375, 397074.1875,
        397079.3750, 786731.2500, 800424.8125, 802096.6250, 812645.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403887.4688, 403904.3438, 403908.0312, 403915.9375,
        403924.9062, 403929.1250, 403929.4375, 403929.5625, 403935.8125,
        403939.6562, 799649.1875, 802232.5000, 808249.5000, 812645.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3979e+00, 1.4489e+00, 1.4528e+00, 1.4908e+00, 1.4994e+00,
        1.5159e+00, 1.5624e+00, 1.5955e+00, 1.6377e+00, 3.8529e+05, 3.8903e+05,
        3.9601e+05, 3.9704e+05, 4.0392e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2161e+00, 1.2208e+00, 1.3697e+00, 1.4355e+00, 1.4728e+00,
        1.5986e+00, 1.6377e+00, 1.7567e+00, 1.7953e+00, 3.8530e+05, 3.8907e+05,
        3.9600e+05, 3.9706e+05, 4.0389e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 395975.6875, 395978.7812, 395984.6875, 395995.6562,
        395997.8125, 395998.3125, 396001.0000, 396011.5625, 396022.3125,
        396032.9375, 772001.4375, 772345.3750, 786731.2500, 799649.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388984.6250, 389027.4688, 389032.0625, 389038.0625,
        389051.1250, 389056.1250, 389056.4062, 389065.3125, 389069.2500,
        389070.2188, 772001.4375, 786503.9375, 802096.6250, 802232.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3310e+00, 1.3697e+00, 1.3878e+00, 1.4080e+00, 1.4535e+00,
        1.4660e+00, 1.5624e+00, 1.5659e+00, 1.6233e+00, 3.8529e+05, 3.8906e+05,
        3.9600e+05, 3.9704e+05, 4.0394e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3310e+00, 1.3657e+00, 1.4199e+00, 1.4230e+00, 1.4355e+00,
        1.4489e+00, 1.4506e+00, 1.4594e+00, 1.5216e+00, 3.8525e+05, 3.8905e+05,
        3.9598e+05, 3.9707e+05, 4.0394e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 385252.8125, 385271.8125, 385277.0938, 385280.7812,
        385287.3750, 385289.1875, 385291.3750, 385295.4062, 385296.1875,
        385302.6250, 772345.3750, 786503.9375, 800424.8125, 808249.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2208e+00, 1.3657e+00, 1.3801e+00, 1.4080e+00, 1.4980e+00,
        1.5159e+00, 1.5291e+00, 1.6009e+00, 1.6070e+00, 3.8527e+05, 3.8907e+05,
        3.9600e+05, 3.9708e+05, 4.0393e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3979e+00, 1.4241e+00, 1.4660e+00, 1.5216e+00, 1.5291e+00,
        1.5374e+00, 1.5552e+00, 1.5841e+00, 1.5986e+00, 3.8528e+05, 3.8904e+05,
        3.9603e+05, 3.9707e+05, 4.0390e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2161e+00, 1.3801e+00, 1.3878e+00, 1.4506e+00, 1.5008e+00,
        1.5552e+00, 1.5955e+00, 1.6278e+00, 1.6920e+00, 3.8528e+05, 3.8906e+05,
        3.9598e+05, 3.9706e+05, 4.0391e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.56', '1.56', '1.47', '397056.75', '403920.41', '1.51', '1.50', '395999.91', '389045.06', '1.46', '1.43', '385282.47', '1.46', '1.51', '1.49']
estimated f for each client, fs: [5, 5, 5, 3, 3, 5, 5, 3, 3, 5, 5, 5, 5, 5, 5]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 13, 11, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0135s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:51...
global Accuracy on shared test data: 79.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:29:51, End: 2025-07-22 15:29:51)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.2096e+00, 1.2942e+00, 3.8026e+05, 1.2546e+00, 3.9161e+05,
         3.9395e+05, 1.3289e+00, 1.5681e+00, 1.2196e+00, 3.9088e+05, 3.7908e+05,
         1.3242e+00, 1.2530e+00, 4.0228e+05, 1.3232e+00, 1.3793e+00],
        [1.2096e+00, 0.0000e+00, 1.2194e+00, 3.8023e+05, 1.2626e+00, 3.9161e+05,
         3.9398e+05, 1.3678e+00, 1.5914e+00, 1.2916e+00, 3.9090e+05, 3.7909e+05,
         1.3040e+00, 1.2144e+00, 4.0230e+05, 1.3009e+00, 1.4328e+00],
        [1.2942e+00, 1.2194e+00, 0.0000e+00, 3.8024e+05, 1.2791e+00, 3.9161e+05,
         3.9396e+05, 1.1951e+00, 1.4704e+00, 1.1585e+00, 3.9089e+05, 3.7910e+05,
         1.2162e+00, 1.1999e+00, 4.0229e+05, 1.2088e+00, 1.3136e+00],
        [3.8026e+05, 3.8023e+05, 3.8024e+05, 0.0000e+00, 3.8024e+05, 7.4466e+05,
         7.7673e+05, 3.8027e+05, 3.8025e+05, 3.8026e+05, 7.7776e+05, 7.7435e+05,
         3.8024e+05, 3.8022e+05, 7.7147e+05, 3.8022e+05, 3.8024e+05],
        [1.2546e+00, 1.2626e+00, 1.2791e+00, 3.8024e+05, 0.0000e+00, 3.9158e+05,
         3.9394e+05, 1.3093e+00, 1.5580e+00, 1.2881e+00, 3.9087e+05, 3.7909e+05,
         1.2850e+00, 1.2137e+00, 4.0225e+05, 1.2007e+00, 1.3731e+00],
        [3.9161e+05, 3.9161e+05, 3.9161e+05, 7.4466e+05, 3.9158e+05, 0.0000e+00,
         7.7355e+05, 3.9162e+05, 3.9164e+05, 3.9162e+05, 7.8798e+05, 7.8291e+05,
         3.9161e+05, 3.9159e+05, 8.0489e+05, 3.9159e+05, 3.9160e+05],
        [3.9395e+05, 3.9398e+05, 3.9396e+05, 7.7673e+05, 3.9394e+05, 7.7355e+05,
         0.0000e+00, 3.9398e+05, 3.9399e+05, 3.9399e+05, 7.9877e+05, 7.6113e+05,
         3.9394e+05, 3.9397e+05, 7.9148e+05, 3.9396e+05, 3.9396e+05],
        [1.3289e+00, 1.3678e+00, 1.1951e+00, 3.8027e+05, 1.3093e+00, 3.9162e+05,
         3.9398e+05, 0.0000e+00, 1.3273e+00, 1.2525e+00, 3.9089e+05, 3.7912e+05,
         1.1831e+00, 1.2251e+00, 4.0229e+05, 1.2318e+00, 1.2036e+00],
        [1.5681e+00, 1.5914e+00, 1.4704e+00, 3.8025e+05, 1.5580e+00, 3.9164e+05,
         3.9399e+05, 1.3273e+00, 0.0000e+00, 1.5866e+00, 3.9088e+05, 3.7913e+05,
         1.2692e+00, 1.6721e+00, 4.0231e+05, 1.5964e+00, 1.2952e+00],
        [1.2196e+00, 1.2916e+00, 1.1585e+00, 3.8026e+05, 1.2881e+00, 3.9162e+05,
         3.9399e+05, 1.2525e+00, 1.5866e+00, 0.0000e+00, 3.9090e+05, 3.7907e+05,
         1.3475e+00, 1.2193e+00, 4.0225e+05, 1.2394e+00, 1.3158e+00],
        [3.9088e+05, 3.9090e+05, 3.9089e+05, 7.7776e+05, 3.9087e+05, 7.8798e+05,
         7.9877e+05, 3.9089e+05, 3.9088e+05, 3.9090e+05, 0.0000e+00, 7.7504e+05,
         3.9087e+05, 3.9087e+05, 8.1137e+05, 3.9088e+05, 3.9091e+05],
        [3.7908e+05, 3.7909e+05, 3.7910e+05, 7.7435e+05, 3.7909e+05, 7.8291e+05,
         7.6113e+05, 3.7912e+05, 3.7913e+05, 3.7907e+05, 7.7504e+05, 0.0000e+00,
         3.7908e+05, 3.7908e+05, 7.8297e+05, 3.7910e+05, 3.7908e+05],
        [1.3242e+00, 1.3040e+00, 1.2162e+00, 3.8024e+05, 1.2850e+00, 3.9161e+05,
         3.9394e+05, 1.1831e+00, 1.2692e+00, 1.3475e+00, 3.9087e+05, 3.7908e+05,
         0.0000e+00, 1.3717e+00, 4.0226e+05, 1.2656e+00, 1.1941e+00],
        [1.2530e+00, 1.2144e+00, 1.1999e+00, 3.8022e+05, 1.2137e+00, 3.9159e+05,
         3.9397e+05, 1.2251e+00, 1.6721e+00, 1.2193e+00, 3.9087e+05, 3.7908e+05,
         1.3717e+00, 0.0000e+00, 4.0228e+05, 1.2237e+00, 1.3440e+00],
        [4.0228e+05, 4.0230e+05, 4.0229e+05, 7.7147e+05, 4.0225e+05, 8.0489e+05,
         7.9148e+05, 4.0229e+05, 4.0231e+05, 4.0225e+05, 8.1137e+05, 7.8297e+05,
         4.0226e+05, 4.0228e+05, 0.0000e+00, 4.0226e+05, 4.0230e+05],
        [1.3232e+00, 1.3009e+00, 1.2088e+00, 3.8022e+05, 1.2007e+00, 3.9159e+05,
         3.9396e+05, 1.2318e+00, 1.5964e+00, 1.2394e+00, 3.9088e+05, 3.7910e+05,
         1.2656e+00, 1.2237e+00, 4.0226e+05, 0.0000e+00, 1.3253e+00],
        [1.3793e+00, 1.4328e+00, 1.3136e+00, 3.8024e+05, 1.3731e+00, 3.9160e+05,
         3.9396e+05, 1.2036e+00, 1.2952e+00, 1.3158e+00, 3.9091e+05, 3.7908e+05,
         1.1941e+00, 1.3440e+00, 4.0230e+05, 1.3253e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2096e+00, 1.2196e+00, 1.2530e+00, 1.2546e+00, 1.2942e+00,
        1.3232e+00, 1.3242e+00, 1.3289e+00, 1.3793e+00, 1.5681e+00, 3.7908e+05,
        3.8026e+05, 3.9088e+05, 3.9161e+05, 3.9395e+05, 4.0228e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2096e+00, 1.2144e+00, 1.2194e+00, 1.2626e+00, 1.2916e+00,
        1.3009e+00, 1.3040e+00, 1.3678e+00, 1.4328e+00, 1.5914e+00, 3.7909e+05,
        3.8023e+05, 3.9090e+05, 3.9161e+05, 3.9398e+05, 4.0230e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1585e+00, 1.1951e+00, 1.1999e+00, 1.2088e+00, 1.2162e+00,
        1.2194e+00, 1.2791e+00, 1.2942e+00, 1.3136e+00, 1.4704e+00, 3.7910e+05,
        3.8024e+05, 3.9089e+05, 3.9161e+05, 3.9396e+05, 4.0229e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380215.2500, 380224.6250, 380234.2188, 380237.0312,
        380239.3750, 380240.4688, 380244.1875, 380250.2188, 380259.0938,
        380260.3438, 380274.0625, 744657.8750, 771469.9375, 774350.4375,
        776734.8750, 777761.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2007e+00, 1.2137e+00, 1.2546e+00, 1.2626e+00, 1.2791e+00,
        1.2850e+00, 1.2881e+00, 1.3093e+00, 1.3731e+00, 1.5580e+00, 3.7909e+05,
        3.8024e+05, 3.9087e+05, 3.9158e+05, 3.9394e+05, 4.0225e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391578.3438, 391587.9688, 391591.8750, 391604.1875,
        391606.5625, 391608.0625, 391610.2500, 391612.7500, 391619.2188,
        391623.6562, 391638.1875, 744657.8750, 773547.2500, 782909.1250,
        787979.2500, 804894.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393941.0312, 393942.2188, 393946.5000, 393959.2812,
        393960.5625, 393963.7500, 393965.3125, 393979.1250, 393981.5625,
        393993.5625, 393993.5625, 761134.7500, 773547.2500, 776734.8750,
        791483.1250, 798768.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1831e+00, 1.1951e+00, 1.2036e+00, 1.2251e+00, 1.2318e+00,
        1.2525e+00, 1.3093e+00, 1.3273e+00, 1.3289e+00, 1.3678e+00, 3.7912e+05,
        3.8027e+05, 3.9089e+05, 3.9162e+05, 3.9398e+05, 4.0229e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2692e+00, 1.2952e+00, 1.3273e+00, 1.4704e+00, 1.5580e+00,
        1.5681e+00, 1.5866e+00, 1.5914e+00, 1.5964e+00, 1.6721e+00, 3.7913e+05,
        3.8025e+05, 3.9088e+05, 3.9164e+05, 3.9399e+05, 4.0231e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1585e+00, 1.2193e+00, 1.2196e+00, 1.2394e+00, 1.2525e+00,
        1.2881e+00, 1.2916e+00, 1.3158e+00, 1.3475e+00, 1.5866e+00, 3.7907e+05,
        3.8026e+05, 3.9090e+05, 3.9162e+05, 3.9399e+05, 4.0225e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390866.5938, 390870.7188, 390873.7500, 390879.7812,
        390880.1250, 390883.3438, 390892.2188, 390893.7812, 390897.7188,
        390900.1250, 390907.0625, 775044.2500, 777761.2500, 787979.2500,
        798768.1250, 811374.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 379068.5000, 379080.1562, 379081.1875, 379081.3438,
        379084.5312, 379089.6875, 379093.4062, 379095.8125, 379099.3438,
        379115.9375, 379131.7188, 761134.7500, 774350.4375, 775044.2500,
        782909.1250, 782973.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1831e+00, 1.1941e+00, 1.2162e+00, 1.2656e+00, 1.2692e+00,
        1.2850e+00, 1.3040e+00, 1.3242e+00, 1.3475e+00, 1.3717e+00, 3.7908e+05,
        3.8024e+05, 3.9087e+05, 3.9161e+05, 3.9394e+05, 4.0226e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1999e+00, 1.2137e+00, 1.2144e+00, 1.2193e+00, 1.2237e+00,
        1.2251e+00, 1.2530e+00, 1.3440e+00, 1.3717e+00, 1.6721e+00, 3.7908e+05,
        3.8022e+05, 3.9087e+05, 3.9159e+05, 3.9397e+05, 4.0228e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402246.8125, 402252.1875, 402256.8438, 402261.9375,
        402275.5625, 402279.5625, 402290.3125, 402291.9375, 402300.5000,
        402303.6875, 402306.0625, 771469.9375, 782973.0625, 791483.1250,
        804894.8125, 811374.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2007e+00, 1.2088e+00, 1.2237e+00, 1.2318e+00, 1.2394e+00,
        1.2656e+00, 1.3009e+00, 1.3232e+00, 1.3253e+00, 1.5964e+00, 3.7910e+05,
        3.8022e+05, 3.9088e+05, 3.9159e+05, 3.9396e+05, 4.0226e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1941e+00, 1.2036e+00, 1.2952e+00, 1.3136e+00, 1.3158e+00,
        1.3253e+00, 1.3440e+00, 1.3731e+00, 1.3793e+00, 1.4328e+00, 3.7908e+05,
        3.8024e+05, 3.9091e+05, 3.9160e+05, 3.9396e+05, 4.0230e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.32', '1.32', '1.26', '380243.53', '1.30', '391607.38', '393966.06', '1.26', '1.49', '1.29', '390885.91', '379088.97', '1.28', '1.29', '402278.66', '1.29', '1.32']
estimated f for each client, fs: [6, 6, 6, 4, 6, 4, 4, 6, 6, 6, 4, 6, 6, 6, 4, 6, 6]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0276s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:51...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:51, End: 2025-07-22 15:29:51)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.2874e+00, 3.8807e+05, 3.9643e+05, 1.2481e+00, 1.6217e+00,
         4.0972e+05, 1.2966e+00, 3.7517e+05, 1.2805e+00, 1.2220e+00, 3.9117e+05,
         4.0837e+05, 1.3563e+00, 3.8720e+05, 1.3694e+00, 1.3572e+00],
        [1.2874e+00, 0.0000e+00, 3.8801e+05, 3.9646e+05, 1.3080e+00, 1.6373e+00,
         4.0972e+05, 1.3835e+00, 3.7521e+05, 1.3592e+00, 1.3667e+00, 3.9119e+05,
         4.0836e+05, 1.3570e+00, 3.8719e+05, 1.3681e+00, 1.4316e+00],
        [3.8807e+05, 3.8801e+05, 0.0000e+00, 8.0997e+05, 3.8804e+05, 3.8803e+05,
         8.1448e+05, 3.8804e+05, 7.5726e+05, 3.8802e+05, 3.8806e+05, 7.7094e+05,
         7.9959e+05, 3.8805e+05, 7.8100e+05, 3.8801e+05, 3.8803e+05],
        [3.9643e+05, 3.9646e+05, 8.0997e+05, 0.0000e+00, 3.9642e+05, 3.9644e+05,
         8.0029e+05, 3.9644e+05, 7.6175e+05, 3.9643e+05, 3.9641e+05, 7.8296e+05,
         8.0976e+05, 3.9640e+05, 8.0709e+05, 3.9641e+05, 3.9641e+05],
        [1.2481e+00, 1.3080e+00, 3.8804e+05, 3.9642e+05, 0.0000e+00, 1.5564e+00,
         4.0970e+05, 1.2947e+00, 3.7520e+05, 1.3418e+00, 1.3064e+00, 3.9119e+05,
         4.0837e+05, 1.3194e+00, 3.8719e+05, 1.3018e+00, 1.3827e+00],
        [1.6217e+00, 1.6373e+00, 3.8803e+05, 3.9644e+05, 1.5564e+00, 0.0000e+00,
         4.0974e+05, 1.2997e+00, 3.7519e+05, 1.0982e+00, 1.5116e+00, 3.9122e+05,
         4.0834e+05, 1.1664e+00, 3.8719e+05, 1.5828e+00, 1.1790e+00],
        [4.0972e+05, 4.0972e+05, 8.1448e+05, 8.0029e+05, 4.0970e+05, 4.0974e+05,
         0.0000e+00, 4.0970e+05, 7.8057e+05, 4.0973e+05, 4.0973e+05, 7.9428e+05,
         8.0084e+05, 4.0971e+05, 8.0296e+05, 4.0971e+05, 4.0972e+05],
        [1.2966e+00, 1.3835e+00, 3.8804e+05, 3.9644e+05, 1.2947e+00, 1.2997e+00,
         4.0970e+05, 0.0000e+00, 3.7520e+05, 1.0799e+00, 1.2429e+00, 3.9119e+05,
         4.0836e+05, 1.2192e+00, 3.8721e+05, 1.2880e+00, 1.2018e+00],
        [3.7517e+05, 3.7521e+05, 7.5726e+05, 7.6175e+05, 3.7520e+05, 3.7519e+05,
         7.8057e+05, 3.7520e+05, 0.0000e+00, 3.7518e+05, 3.7520e+05, 7.6356e+05,
         8.0686e+05, 3.7519e+05, 7.6504e+05, 3.7519e+05, 3.7516e+05],
        [1.2805e+00, 1.3592e+00, 3.8802e+05, 3.9643e+05, 1.3418e+00, 1.0982e+00,
         4.0973e+05, 1.0799e+00, 3.7518e+05, 0.0000e+00, 1.3097e+00, 3.9120e+05,
         4.0836e+05, 1.0928e+00, 3.8719e+05, 1.3633e+00, 1.1245e+00],
        [1.2220e+00, 1.3667e+00, 3.8806e+05, 3.9641e+05, 1.3064e+00, 1.5116e+00,
         4.0973e+05, 1.2429e+00, 3.7520e+05, 1.3097e+00, 0.0000e+00, 3.9120e+05,
         4.0838e+05, 1.3957e+00, 3.8717e+05, 1.3188e+00, 1.2733e+00],
        [3.9117e+05, 3.9119e+05, 7.7094e+05, 7.8296e+05, 3.9119e+05, 3.9122e+05,
         7.9428e+05, 3.9119e+05, 7.6356e+05, 3.9120e+05, 3.9120e+05, 0.0000e+00,
         8.1571e+05, 3.9122e+05, 7.7053e+05, 3.9117e+05, 3.9119e+05],
        [4.0837e+05, 4.0836e+05, 7.9959e+05, 8.0976e+05, 4.0837e+05, 4.0834e+05,
         8.0084e+05, 4.0836e+05, 8.0686e+05, 4.0836e+05, 4.0838e+05, 8.1571e+05,
         0.0000e+00, 4.0830e+05, 7.9854e+05, 4.0837e+05, 4.0836e+05],
        [1.3563e+00, 1.3570e+00, 3.8805e+05, 3.9640e+05, 1.3194e+00, 1.1664e+00,
         4.0971e+05, 1.2192e+00, 3.7519e+05, 1.0928e+00, 1.3957e+00, 3.9122e+05,
         4.0830e+05, 0.0000e+00, 3.8715e+05, 1.3395e+00, 1.2188e+00],
        [3.8720e+05, 3.8719e+05, 7.8100e+05, 8.0709e+05, 3.8719e+05, 3.8719e+05,
         8.0296e+05, 3.8721e+05, 7.6504e+05, 3.8719e+05, 3.8717e+05, 7.7053e+05,
         7.9854e+05, 3.8715e+05, 0.0000e+00, 3.8718e+05, 3.8720e+05],
        [1.3694e+00, 1.3681e+00, 3.8801e+05, 3.9641e+05, 1.3018e+00, 1.5828e+00,
         4.0971e+05, 1.2880e+00, 3.7519e+05, 1.3633e+00, 1.3188e+00, 3.9117e+05,
         4.0837e+05, 1.3395e+00, 3.8718e+05, 0.0000e+00, 1.3477e+00],
        [1.3572e+00, 1.4316e+00, 3.8803e+05, 3.9641e+05, 1.3827e+00, 1.1790e+00,
         4.0972e+05, 1.2018e+00, 3.7516e+05, 1.1245e+00, 1.2733e+00, 3.9119e+05,
         4.0836e+05, 1.2188e+00, 3.8720e+05, 1.3477e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2220e+00, 1.2481e+00, 1.2805e+00, 1.2874e+00, 1.2966e+00,
        1.3563e+00, 1.3572e+00, 1.3694e+00, 1.6217e+00, 3.7517e+05, 3.8720e+05,
        3.8807e+05, 3.9117e+05, 3.9643e+05, 4.0837e+05, 4.0972e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2874e+00, 1.3080e+00, 1.3570e+00, 1.3592e+00, 1.3667e+00,
        1.3681e+00, 1.3835e+00, 1.4316e+00, 1.6373e+00, 3.7521e+05, 3.8719e+05,
        3.8801e+05, 3.9119e+05, 3.9646e+05, 4.0836e+05, 4.0972e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388012.3750, 388013.7188, 388023.6250, 388026.4062,
        388033.4688, 388040.8125, 388042.4688, 388052.1250, 388055.3438,
        388072.8438, 757264.3750, 770944.3125, 781002.2500, 799594.2500,
        809971.8750, 814475.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396404.5938, 396407.4688, 396410.1875, 396412.4688,
        396418.0938, 396426.5312, 396431.6250, 396435.8438, 396437.7812,
        396459.6875, 761746.3750, 782960.6250, 800287.6250, 807092.2500,
        809761.1250, 809971.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2481e+00, 1.2947e+00, 1.3018e+00, 1.3064e+00, 1.3080e+00,
        1.3194e+00, 1.3418e+00, 1.3827e+00, 1.5564e+00, 3.7520e+05, 3.8719e+05,
        3.8804e+05, 3.9119e+05, 3.9642e+05, 4.0837e+05, 4.0970e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0982e+00, 1.1664e+00, 1.1790e+00, 1.2997e+00, 1.5116e+00,
        1.5564e+00, 1.5828e+00, 1.6217e+00, 1.6373e+00, 3.7519e+05, 3.8719e+05,
        3.8803e+05, 3.9122e+05, 3.9644e+05, 4.0834e+05, 4.0974e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 409695.1250, 409696.8750, 409706.9062, 409711.7500,
        409717.4375, 409720.5000, 409720.5312, 409727.2500, 409731.3438,
        409737.0312, 780565.3750, 794276.1875, 800287.6250, 800843.2500,
        802957.1250, 814475.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0799e+00, 1.2018e+00, 1.2192e+00, 1.2429e+00, 1.2880e+00,
        1.2947e+00, 1.2966e+00, 1.2997e+00, 1.3835e+00, 3.7520e+05, 3.8721e+05,
        3.8804e+05, 3.9119e+05, 3.9644e+05, 4.0836e+05, 4.0970e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 375164.9375, 375171.2188, 375179.0000, 375187.6562,
        375189.9062, 375191.6562, 375195.9062, 375198.9375, 375199.3750,
        375214.4375, 757264.3750, 761746.3750, 763562.3125, 765040.5000,
        780565.3750, 806859.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0799e+00, 1.0928e+00, 1.0982e+00, 1.1245e+00, 1.2805e+00,
        1.3097e+00, 1.3418e+00, 1.3592e+00, 1.3633e+00, 3.7518e+05, 3.8719e+05,
        3.8802e+05, 3.9120e+05, 3.9643e+05, 4.0836e+05, 4.0973e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2220e+00, 1.2429e+00, 1.2733e+00, 1.3064e+00, 1.3097e+00,
        1.3188e+00, 1.3667e+00, 1.3957e+00, 1.5116e+00, 3.7520e+05, 3.8717e+05,
        3.8806e+05, 3.9120e+05, 3.9641e+05, 4.0838e+05, 4.0973e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391167.0625, 391167.6562, 391185.3750, 391185.7188,
        391188.8125, 391189.4062, 391197.2500, 391199.9688, 391220.1562,
        391220.2188, 763562.3125, 770532.9375, 770944.3125, 782960.6250,
        794276.1875, 815705.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 408298.8750, 408337.3750, 408357.0000, 408358.3438,
        408362.1250, 408364.2500, 408367.2188, 408370.7500, 408373.0625,
        408382.2812, 798539.0000, 799594.2500, 800843.2500, 806859.1875,
        809761.1250, 815705.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0928e+00, 1.1664e+00, 1.2188e+00, 1.2192e+00, 1.3194e+00,
        1.3395e+00, 1.3563e+00, 1.3570e+00, 1.3957e+00, 3.7519e+05, 3.8715e+05,
        3.8805e+05, 3.9122e+05, 3.9640e+05, 4.0830e+05, 4.0971e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387154.1875, 387171.8125, 387180.0000, 387188.1562,
        387189.5000, 387192.9688, 387194.9375, 387196.0312, 387199.6875,
        387213.3125, 765040.5000, 770532.9375, 781002.2500, 798539.0000,
        802957.1250, 807092.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2880e+00, 1.3018e+00, 1.3188e+00, 1.3395e+00, 1.3477e+00,
        1.3633e+00, 1.3681e+00, 1.3694e+00, 1.5828e+00, 3.7519e+05, 3.8718e+05,
        3.8801e+05, 3.9117e+05, 3.9641e+05, 4.0837e+05, 4.0971e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1245e+00, 1.1790e+00, 1.2018e+00, 1.2188e+00, 1.2733e+00,
        1.3477e+00, 1.3572e+00, 1.3827e+00, 1.4316e+00, 3.7516e+05, 3.8720e+05,
        3.8803e+05, 3.9119e+05, 3.9641e+05, 4.0836e+05, 4.0972e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37518.33', '37522.69', '388037.31', '396424.41', '37521.14', '37520.03', '409716.44', '37521.02', '375189.28', '37519.00', '37520.78', '391192.16', '408357.09', '37520.31', '387188.09', '37520.22', '37517.65']
estimated f for each client, fs: [7, 7, 5, 5, 7, 7, 5, 7, 6, 7, 7, 5, 5, 7, 5, 7, 7]
selected_index: 16
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0117s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:52...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:52, End: 2025-07-22 15:29:52)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.1006e+00, 3.9603e+05, 3.7953e+05, 1.1646e+00, 1.4739e+00,
         3.9829e+05, 3.9135e+05, 1.1790e+00, 3.8855e+05, 1.1025e+00, 3.9349e+05,
         3.9510e+05, 1.1882e+00, 1.1617e+00, 3.8414e+05, 1.2013e+00, 1.6736e+00],
        [1.1006e+00, 0.0000e+00, 3.9600e+05, 3.7951e+05, 1.1685e+00, 1.4539e+00,
         3.9828e+05, 3.9136e+05, 1.2023e+00, 3.8855e+05, 1.1466e+00, 3.9350e+05,
         3.9512e+05, 1.1518e+00, 1.1223e+00, 3.8418e+05, 1.1874e+00, 1.7369e+00],
        [3.9603e+05, 3.9600e+05, 0.0000e+00, 7.6466e+05, 3.9602e+05, 3.9600e+05,
         7.9022e+05, 7.8116e+05, 3.9600e+05, 7.7394e+05, 3.9602e+05, 7.8426e+05,
         8.0137e+05, 3.9602e+05, 3.9602e+05, 7.8537e+05, 3.9599e+05, 3.9602e+05],
        [3.7953e+05, 3.7951e+05, 7.6466e+05, 0.0000e+00, 3.7951e+05, 3.7954e+05,
         7.6433e+05, 7.7412e+05, 3.7950e+05, 7.6059e+05, 3.7949e+05, 7.8170e+05,
         7.9250e+05, 3.7951e+05, 3.7949e+05, 7.4588e+05, 3.7952e+05, 3.7954e+05],
        [1.1646e+00, 1.1685e+00, 3.9602e+05, 3.7951e+05, 0.0000e+00, 1.4018e+00,
         3.9827e+05, 3.9133e+05, 1.1970e+00, 3.8855e+05, 1.1915e+00, 3.9348e+05,
         3.9510e+05, 1.1713e+00, 1.1580e+00, 3.8413e+05, 1.1341e+00, 1.7161e+00],
        [1.4739e+00, 1.4539e+00, 3.9600e+05, 3.7954e+05, 1.4018e+00, 0.0000e+00,
         3.9828e+05, 3.9137e+05, 1.2293e+00, 3.8855e+05, 1.3407e+00, 3.9351e+05,
         3.9511e+05, 1.0589e+00, 1.4302e+00, 3.8417e+05, 1.4236e+00, 1.0203e+00],
        [3.9829e+05, 3.9828e+05, 7.9022e+05, 7.6433e+05, 3.9827e+05, 3.9828e+05,
         0.0000e+00, 7.9066e+05, 3.9827e+05, 7.7018e+05, 3.9829e+05, 7.9135e+05,
         7.9011e+05, 3.9829e+05, 3.9829e+05, 7.6447e+05, 3.9826e+05, 3.9828e+05],
        [3.9135e+05, 3.9136e+05, 7.8116e+05, 7.7412e+05, 3.9133e+05, 3.9137e+05,
         7.9066e+05, 0.0000e+00, 3.9138e+05, 7.9001e+05, 3.9136e+05, 7.6929e+05,
         7.9298e+05, 3.9138e+05, 3.9133e+05, 7.7301e+05, 3.9138e+05, 3.9133e+05],
        [1.1790e+00, 1.2023e+00, 3.9600e+05, 3.7950e+05, 1.1970e+00, 1.2293e+00,
         3.9827e+05, 3.9138e+05, 0.0000e+00, 3.8855e+05, 1.1645e+00, 3.9349e+05,
         3.9510e+05, 1.1300e+00, 1.1572e+00, 3.8417e+05, 1.1872e+00, 1.4571e+00],
        [3.8855e+05, 3.8855e+05, 7.7394e+05, 7.6059e+05, 3.8855e+05, 3.8855e+05,
         7.7018e+05, 7.9001e+05, 3.8855e+05, 0.0000e+00, 3.8854e+05, 7.7088e+05,
         7.8076e+05, 3.8854e+05, 3.8856e+05, 7.6327e+05, 3.8854e+05, 3.8855e+05],
        [1.1025e+00, 1.1466e+00, 3.9602e+05, 3.7949e+05, 1.1915e+00, 1.3407e+00,
         3.9829e+05, 3.9136e+05, 1.1645e+00, 3.8854e+05, 0.0000e+00, 3.9352e+05,
         3.9509e+05, 1.2489e+00, 1.1323e+00, 3.8416e+05, 1.1672e+00, 1.5836e+00],
        [3.9349e+05, 3.9350e+05, 7.8426e+05, 7.8170e+05, 3.9348e+05, 3.9351e+05,
         7.9135e+05, 7.6929e+05, 3.9349e+05, 7.7088e+05, 3.9352e+05, 0.0000e+00,
         8.0163e+05, 3.9351e+05, 3.9351e+05, 7.7204e+05, 3.9348e+05, 3.9350e+05],
        [3.9510e+05, 3.9512e+05, 8.0137e+05, 7.9250e+05, 3.9510e+05, 3.9511e+05,
         7.9011e+05, 7.9298e+05, 3.9510e+05, 7.8076e+05, 3.9509e+05, 8.0163e+05,
         0.0000e+00, 3.9511e+05, 3.9510e+05, 7.9052e+05, 3.9511e+05, 3.9512e+05],
        [1.1882e+00, 1.1518e+00, 3.9602e+05, 3.7951e+05, 1.1713e+00, 1.0589e+00,
         3.9829e+05, 3.9138e+05, 1.1300e+00, 3.8854e+05, 1.2489e+00, 3.9351e+05,
         3.9511e+05, 0.0000e+00, 1.2552e+00, 3.8415e+05, 1.1848e+00, 1.3157e+00],
        [1.1617e+00, 1.1223e+00, 3.9602e+05, 3.7949e+05, 1.1580e+00, 1.4302e+00,
         3.9829e+05, 3.9133e+05, 1.1572e+00, 3.8856e+05, 1.1323e+00, 3.9351e+05,
         3.9510e+05, 1.2552e+00, 0.0000e+00, 3.8416e+05, 1.1596e+00, 1.7710e+00],
        [3.8414e+05, 3.8418e+05, 7.8537e+05, 7.4588e+05, 3.8413e+05, 3.8417e+05,
         7.6447e+05, 7.7301e+05, 3.8417e+05, 7.6327e+05, 3.8416e+05, 7.7204e+05,
         7.9052e+05, 3.8415e+05, 3.8416e+05, 0.0000e+00, 3.8418e+05, 3.8418e+05],
        [1.2013e+00, 1.1874e+00, 3.9599e+05, 3.7952e+05, 1.1341e+00, 1.4236e+00,
         3.9826e+05, 3.9138e+05, 1.1872e+00, 3.8854e+05, 1.1672e+00, 3.9348e+05,
         3.9511e+05, 1.1848e+00, 1.1596e+00, 3.8418e+05, 0.0000e+00, 1.6656e+00],
        [1.6736e+00, 1.7369e+00, 3.9602e+05, 3.7954e+05, 1.7161e+00, 1.0203e+00,
         3.9828e+05, 3.9133e+05, 1.4571e+00, 3.8855e+05, 1.5836e+00, 3.9350e+05,
         3.9512e+05, 1.3157e+00, 1.7710e+00, 3.8418e+05, 1.6656e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1006e+00, 1.1025e+00, 1.1617e+00, 1.1646e+00, 1.1790e+00,
        1.1882e+00, 1.2013e+00, 1.4739e+00, 1.6736e+00, 3.7953e+05, 3.8414e+05,
        3.8855e+05, 3.9135e+05, 3.9349e+05, 3.9510e+05, 3.9603e+05, 3.9829e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1006e+00, 1.1223e+00, 1.1466e+00, 1.1518e+00, 1.1685e+00,
        1.1874e+00, 1.2023e+00, 1.4539e+00, 1.7369e+00, 3.7951e+05, 3.8418e+05,
        3.8855e+05, 3.9136e+05, 3.9350e+05, 3.9512e+05, 3.9600e+05, 3.9828e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395986.5312, 395996.1250, 395997.2812, 396004.0312,
        396015.3750, 396018.0938, 396020.3750, 396023.4062, 396023.6250,
        396031.5625, 764663.9375, 773936.7500, 781162.7500, 784255.2500,
        785368.3750, 790217.5000, 801370.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 379493.1562, 379494.8750, 379502.6562, 379505.5625,
        379507.2500, 379512.2500, 379518.6562, 379533.0625, 379535.6875,
        379542.1562, 745878.5625, 760589.4375, 764325.5625, 764663.9375,
        774121.5000, 781696.1250, 792501.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1341e+00, 1.1580e+00, 1.1646e+00, 1.1685e+00, 1.1713e+00,
        1.1915e+00, 1.1970e+00, 1.4018e+00, 1.7161e+00, 3.7951e+05, 3.8413e+05,
        3.8855e+05, 3.9133e+05, 3.9348e+05, 3.9510e+05, 3.9602e+05, 3.9827e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0203e+00, 1.0589e+00, 1.2293e+00, 1.3407e+00, 1.4018e+00,
        1.4236e+00, 1.4302e+00, 1.4539e+00, 1.4739e+00, 3.7954e+05, 3.8417e+05,
        3.8855e+05, 3.9137e+05, 3.9351e+05, 3.9511e+05, 3.9600e+05, 3.9828e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398263.5938, 398266.6562, 398271.8750, 398275.1875,
        398283.5000, 398284.9062, 398287.0000, 398290.0000, 398293.5000,
        398293.6250, 764325.5625, 764472.1250, 770175.2500, 790106.6250,
        790217.5000, 790664.8125, 791353.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391328.7812, 391334.0312, 391334.3438, 391350.4062,
        391355.7188, 391363.1875, 391372.4375, 391375.9062, 391379.6875,
        391381.3750, 769288.0000, 773006.1875, 774121.5000, 781162.7500,
        790007.4375, 790664.8125, 792978.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1300e+00, 1.1572e+00, 1.1645e+00, 1.1790e+00, 1.1872e+00,
        1.1970e+00, 1.2023e+00, 1.2293e+00, 1.4571e+00, 3.7950e+05, 3.8417e+05,
        3.8855e+05, 3.9138e+05, 3.9349e+05, 3.9510e+05, 3.9600e+05, 3.9827e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388536.9375, 388538.1562, 388538.7812, 388545.9688,
        388548.3750, 388550.5000, 388550.5625, 388552.6875, 388553.5000,
        388560.7812, 760589.4375, 763274.3125, 770175.2500, 770880.3750,
        773936.7500, 780757.3750, 790007.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1025e+00, 1.1323e+00, 1.1466e+00, 1.1645e+00, 1.1672e+00,
        1.1915e+00, 1.2489e+00, 1.3407e+00, 1.5836e+00, 3.7949e+05, 3.8416e+05,
        3.8854e+05, 3.9136e+05, 3.9352e+05, 3.9509e+05, 3.9602e+05, 3.9829e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393479.1875, 393482.7500, 393491.2188, 393491.5625,
        393500.0312, 393504.2188, 393513.5000, 393513.6875, 393514.8750,
        393521.5938, 769288.0000, 770880.3750, 772041.9375, 781696.1250,
        784255.2500, 791353.5000, 801633.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395085.3125, 395099.8438, 395100.2188, 395100.7812,
        395101.1250, 395108.5938, 395111.0000, 395111.9375, 395119.9688,
        395121.2500, 780757.3750, 790106.6250, 790524.5625, 792501.9375,
        792978.0000, 801370.2500, 801633.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0589e+00, 1.1300e+00, 1.1518e+00, 1.1713e+00, 1.1848e+00,
        1.1882e+00, 1.2489e+00, 1.2552e+00, 1.3157e+00, 3.7951e+05, 3.8415e+05,
        3.8854e+05, 3.9138e+05, 3.9351e+05, 3.9511e+05, 3.9602e+05, 3.9829e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1223e+00, 1.1323e+00, 1.1572e+00, 1.1580e+00, 1.1596e+00,
        1.1617e+00, 1.2552e+00, 1.4302e+00, 1.7710e+00, 3.7949e+05, 3.8416e+05,
        3.8856e+05, 3.9133e+05, 3.9351e+05, 3.9510e+05, 3.9602e+05, 3.9829e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 384134.6250, 384141.9375, 384148.8750, 384155.6875,
        384156.8750, 384165.8438, 384174.5312, 384175.1250, 384175.7500,
        384184.4688, 745878.5625, 763274.3125, 764472.1250, 772041.9375,
        773006.1875, 785368.3750, 790524.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1341e+00, 1.1596e+00, 1.1672e+00, 1.1848e+00, 1.1872e+00,
        1.1874e+00, 1.2013e+00, 1.4236e+00, 1.6656e+00, 3.7952e+05, 3.8418e+05,
        3.8854e+05, 3.9138e+05, 3.9348e+05, 3.9511e+05, 3.9599e+05, 3.9826e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0203e+00, 1.3157e+00, 1.4571e+00, 1.5836e+00, 1.6656e+00,
        1.6736e+00, 1.7161e+00, 1.7369e+00, 1.7710e+00, 3.7954e+05, 3.8418e+05,
        3.8855e+05, 3.9133e+05, 3.9350e+05, 3.9512e+05, 3.9602e+05, 3.9828e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['69426.03', '69426.75', '429525.47', '412820.31', '69423.47', '69429.27', '431557.78', '425714.88', '69425.39', '422369.59', '69423.78', '427663.66', '430165.19', '69424.10', '69423.75', '417044.72', '69428.58', '69430.12']
estimated f for each client, fs: [8, 8, 6, 6, 8, 8, 6, 6, 8, 6, 8, 6, 6, 8, 8, 6, 8, 8]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0130s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:53...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:53, End: 2025-07-22 15:29:53)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.3180e+00, 1.4483e+00, 3.9713e+05, 3.7564e+05, 1.6491e+00,
         3.9955e+05, 3.9325e+05, 1.3231e+00, 4.0029e+05, 1.2903e+00, 1.1970e+00,
         4.0126e+05, 3.9538e+05, 1.3661e+00, 1.3066e+00, 1.3977e+00, 1.5809e+00],
        [1.3180e+00, 0.0000e+00, 1.3601e+00, 3.9711e+05, 3.7567e+05, 1.6008e+00,
         3.9952e+05, 3.9327e+05, 1.3467e+00, 4.0028e+05, 1.3321e+00, 1.2701e+00,
         4.0126e+05, 3.9541e+05, 1.3105e+00, 1.2783e+00, 1.3595e+00, 1.6397e+00],
        [1.4483e+00, 1.3601e+00, 0.0000e+00, 3.9709e+05, 3.7567e+05, 1.1311e+00,
         3.9951e+05, 3.9327e+05, 1.2187e+00, 4.0026e+05, 1.0899e+00, 1.2778e+00,
         4.0125e+05, 3.9539e+05, 1.1586e+00, 1.3406e+00, 1.3312e+00, 1.1944e+00],
        [3.9713e+05, 3.9711e+05, 3.9709e+05, 0.0000e+00, 7.8764e+05, 3.9710e+05,
         7.7172e+05, 7.9429e+05, 3.9713e+05, 8.0108e+05, 3.9710e+05, 3.9710e+05,
         8.0277e+05, 8.0445e+05, 3.9709e+05, 3.9712e+05, 3.9712e+05, 3.9711e+05],
        [3.7564e+05, 3.7567e+05, 3.7567e+05, 7.8764e+05, 0.0000e+00, 3.7566e+05,
         8.0064e+05, 7.7081e+05, 3.7569e+05, 7.5509e+05, 3.7566e+05, 3.7567e+05,
         7.7404e+05, 7.6521e+05, 3.7568e+05, 3.7567e+05, 3.7566e+05, 3.7566e+05],
        [1.6491e+00, 1.6008e+00, 1.1311e+00, 3.9710e+05, 3.7566e+05, 0.0000e+00,
         3.9952e+05, 3.9325e+05, 1.3332e+00, 4.0027e+05, 1.1450e+00, 1.4393e+00,
         4.0127e+05, 3.9540e+05, 1.1429e+00, 1.5369e+00, 1.5470e+00, 1.0172e+00],
        [3.9955e+05, 3.9952e+05, 3.9951e+05, 7.7172e+05, 8.0064e+05, 3.9952e+05,
         0.0000e+00, 7.8225e+05, 3.9952e+05, 8.1013e+05, 3.9952e+05, 3.9956e+05,
         8.1602e+05, 7.8931e+05, 3.9953e+05, 3.9957e+05, 3.9954e+05, 3.9952e+05],
        [3.9325e+05, 3.9327e+05, 3.9327e+05, 7.9429e+05, 7.7081e+05, 3.9325e+05,
         7.8225e+05, 0.0000e+00, 3.9326e+05, 8.0312e+05, 3.9325e+05, 3.9325e+05,
         7.6634e+05, 7.7894e+05, 3.9330e+05, 3.9325e+05, 3.9327e+05, 3.9326e+05],
        [1.3231e+00, 1.3467e+00, 1.2187e+00, 3.9713e+05, 3.7569e+05, 1.3332e+00,
         3.9952e+05, 3.9326e+05, 0.0000e+00, 4.0029e+05, 1.1167e+00, 1.2505e+00,
         4.0126e+05, 3.9540e+05, 1.2489e+00, 1.2264e+00, 1.2930e+00, 1.3351e+00],
        [4.0029e+05, 4.0028e+05, 4.0026e+05, 8.0108e+05, 7.5509e+05, 4.0027e+05,
         8.1013e+05, 8.0312e+05, 4.0029e+05, 0.0000e+00, 4.0026e+05, 4.0026e+05,
         7.9299e+05, 7.9796e+05, 4.0030e+05, 4.0030e+05, 4.0025e+05, 4.0025e+05],
        [1.2903e+00, 1.3321e+00, 1.0899e+00, 3.9710e+05, 3.7566e+05, 1.1450e+00,
         3.9952e+05, 3.9325e+05, 1.1167e+00, 4.0026e+05, 0.0000e+00, 1.3146e+00,
         4.0126e+05, 3.9539e+05, 1.0991e+00, 1.4078e+00, 1.3595e+00, 1.1457e+00],
        [1.1970e+00, 1.2701e+00, 1.2778e+00, 3.9710e+05, 3.7567e+05, 1.4393e+00,
         3.9956e+05, 3.9325e+05, 1.2505e+00, 4.0026e+05, 1.3146e+00, 0.0000e+00,
         4.0125e+05, 3.9542e+05, 1.3364e+00, 1.2155e+00, 1.2943e+00, 1.4659e+00],
        [4.0126e+05, 4.0126e+05, 4.0125e+05, 8.0277e+05, 7.7404e+05, 4.0127e+05,
         8.1602e+05, 7.6634e+05, 4.0126e+05, 7.9299e+05, 4.0126e+05, 4.0125e+05,
         0.0000e+00, 7.7658e+05, 4.0123e+05, 4.0124e+05, 4.0129e+05, 4.0126e+05],
        [3.9538e+05, 3.9541e+05, 3.9539e+05, 8.0445e+05, 7.6521e+05, 3.9540e+05,
         7.8931e+05, 7.7894e+05, 3.9540e+05, 7.9796e+05, 3.9539e+05, 3.9542e+05,
         7.7658e+05, 0.0000e+00, 3.9538e+05, 3.9540e+05, 3.9538e+05, 3.9538e+05],
        [1.3661e+00, 1.3105e+00, 1.1586e+00, 3.9709e+05, 3.7568e+05, 1.1429e+00,
         3.9953e+05, 3.9330e+05, 1.2489e+00, 4.0030e+05, 1.0991e+00, 1.3364e+00,
         4.0123e+05, 3.9538e+05, 0.0000e+00, 1.4136e+00, 1.2923e+00, 1.2139e+00],
        [1.3066e+00, 1.2783e+00, 1.3406e+00, 3.9712e+05, 3.7567e+05, 1.5369e+00,
         3.9957e+05, 3.9325e+05, 1.2264e+00, 4.0030e+05, 1.4078e+00, 1.2155e+00,
         4.0124e+05, 3.9540e+05, 1.4136e+00, 0.0000e+00, 1.2875e+00, 1.5930e+00],
        [1.3977e+00, 1.3595e+00, 1.3312e+00, 3.9712e+05, 3.7566e+05, 1.5470e+00,
         3.9954e+05, 3.9327e+05, 1.2930e+00, 4.0025e+05, 1.3595e+00, 1.2943e+00,
         4.0129e+05, 3.9538e+05, 1.2923e+00, 1.2875e+00, 0.0000e+00, 1.5377e+00],
        [1.5809e+00, 1.6397e+00, 1.1944e+00, 3.9711e+05, 3.7566e+05, 1.0172e+00,
         3.9952e+05, 3.9326e+05, 1.3351e+00, 4.0025e+05, 1.1457e+00, 1.4659e+00,
         4.0126e+05, 3.9538e+05, 1.2139e+00, 1.5930e+00, 1.5377e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1970e+00, 1.2903e+00, 1.3066e+00, 1.3180e+00, 1.3231e+00,
        1.3661e+00, 1.3977e+00, 1.4483e+00, 1.5809e+00, 1.6491e+00, 3.7564e+05,
        3.9325e+05, 3.9538e+05, 3.9713e+05, 3.9955e+05, 4.0029e+05, 4.0126e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2701e+00, 1.2783e+00, 1.3105e+00, 1.3180e+00, 1.3321e+00,
        1.3467e+00, 1.3595e+00, 1.3601e+00, 1.6008e+00, 1.6397e+00, 3.7567e+05,
        3.9327e+05, 3.9541e+05, 3.9711e+05, 3.9952e+05, 4.0028e+05, 4.0126e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0899e+00, 1.1311e+00, 1.1586e+00, 1.1944e+00, 1.2187e+00,
        1.2778e+00, 1.3312e+00, 1.3406e+00, 1.3601e+00, 1.4483e+00, 3.7567e+05,
        3.9327e+05, 3.9539e+05, 3.9709e+05, 3.9951e+05, 4.0026e+05, 4.0125e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397089.2812, 397091.0625, 397097.3438, 397098.5938,
        397104.2500, 397107.9375, 397109.3125, 397118.0625, 397122.8438,
        397125.6250, 397131.7500, 771721.3750, 787639.7500, 794290.8750,
        801075.3125, 802772.5000, 804452.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 375637.0312, 375657.4688, 375659.0625, 375660.5625,
        375664.8125, 375666.3438, 375667.0312, 375669.6562, 375672.8750,
        375677.5000, 375687.1875, 755093.1250, 765205.5625, 770814.5625,
        774038.3750, 787639.7500, 800643.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0172e+00, 1.1311e+00, 1.1429e+00, 1.1450e+00, 1.3332e+00,
        1.4393e+00, 1.5369e+00, 1.5470e+00, 1.6008e+00, 1.6491e+00, 3.7566e+05,
        3.9325e+05, 3.9540e+05, 3.9710e+05, 3.9952e+05, 4.0027e+05, 4.0127e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 399505.7812, 399517.2188, 399520.6562, 399522.0938,
        399523.0312, 399523.1250, 399528.7500, 399541.0625, 399550.6250,
        399559.4375, 399566.1250, 771721.3750, 782253.1250, 789307.8750,
        800643.5625, 810131.8750, 816024.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393245.3438, 393246.5938, 393248.0312, 393253.6875,
        393253.8125, 393255.3125, 393260.5938, 393266.3750, 393268.3125,
        393272.2500, 393300.8438, 766335.5000, 770814.5625, 778943.8125,
        782253.1250, 794290.8750, 803122.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1167e+00, 1.2187e+00, 1.2264e+00, 1.2489e+00, 1.2505e+00,
        1.2930e+00, 1.3231e+00, 1.3332e+00, 1.3351e+00, 1.3467e+00, 3.7569e+05,
        3.9326e+05, 3.9540e+05, 3.9713e+05, 3.9952e+05, 4.0029e+05, 4.0126e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 400253.5625, 400253.5938, 400258.6875, 400259.0312,
        400259.9375, 400266.5625, 400281.6562, 400286.5312, 400286.6875,
        400299.2500, 400300.0938, 755093.1250, 792991.8750, 797958.2500,
        801075.3125, 803122.3125, 810131.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0899e+00, 1.0991e+00, 1.1167e+00, 1.1450e+00, 1.1457e+00,
        1.2903e+00, 1.3146e+00, 1.3321e+00, 1.3595e+00, 1.4078e+00, 3.7566e+05,
        3.9325e+05, 3.9539e+05, 3.9710e+05, 3.9952e+05, 4.0026e+05, 4.0126e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1970e+00, 1.2155e+00, 1.2505e+00, 1.2701e+00, 1.2778e+00,
        1.2943e+00, 1.3146e+00, 1.3364e+00, 1.4393e+00, 1.4659e+00, 3.7567e+05,
        3.9325e+05, 3.9542e+05, 3.9710e+05, 3.9956e+05, 4.0026e+05, 4.0125e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 401231.6875, 401244.8125, 401249.2188, 401249.4375,
        401256.2812, 401260.8750, 401262.2812, 401262.7188, 401263.0312,
        401267.2500, 401290.0000, 766335.5000, 774038.3750, 776582.1875,
        792991.8750, 802772.5000, 816024.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395376.5625, 395377.3125, 395378.0312, 395382.5312,
        395393.1875, 395394.6250, 395395.7812, 395398.5000, 395401.4688,
        395413.4062, 395418.0000, 765205.5625, 776582.1875, 778943.8125,
        789307.8750, 797958.2500, 804452.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0991e+00, 1.1429e+00, 1.1586e+00, 1.2139e+00, 1.2489e+00,
        1.2923e+00, 1.3105e+00, 1.3364e+00, 1.3661e+00, 1.4136e+00, 3.7568e+05,
        3.9330e+05, 3.9538e+05, 3.9709e+05, 3.9953e+05, 4.0030e+05, 4.0123e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2155e+00, 1.2264e+00, 1.2783e+00, 1.2875e+00, 1.3066e+00,
        1.3406e+00, 1.4078e+00, 1.4136e+00, 1.5369e+00, 1.5930e+00, 3.7567e+05,
        3.9325e+05, 3.9540e+05, 3.9712e+05, 3.9957e+05, 4.0030e+05, 4.0124e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2875e+00, 1.2923e+00, 1.2930e+00, 1.2943e+00, 1.3312e+00,
        1.3595e+00, 1.3595e+00, 1.3977e+00, 1.5377e+00, 1.5470e+00, 3.7566e+05,
        3.9327e+05, 3.9538e+05, 3.9712e+05, 3.9954e+05, 4.0025e+05, 4.0129e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0172e+00, 1.1457e+00, 1.1944e+00, 1.2139e+00, 1.3351e+00,
        1.4659e+00, 1.5377e+00, 1.5809e+00, 1.5930e+00, 1.6397e+00, 3.7566e+05,
        3.9326e+05, 3.9538e+05, 3.9711e+05, 3.9952e+05, 4.0025e+05, 4.0126e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34150.08', '34152.80', '34152.62', '397108.69', '375665.38', '34152.58', '399532.53', '393261.00', '34154.54', '400273.19', '34152.08', '34152.97', '401257.94', '395393.56', '34153.64', '34153.31', '34152.07', '34151.93']
estimated f for each client, fs: [7, 7, 7, 5, 6, 7, 5, 5, 7, 5, 7, 7, 5, 5, 7, 7, 7, 7]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0128s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:53...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:53, End: 2025-07-22 15:29:53)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 11, 10, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5709e+00, 3.9088e+05, 3.8416e+05, 1.3474e+00, 1.3553e+00,
         4.0470e+05, 3.8563e+05, 1.5687e+00, 4.0325e+05, 1.3501e+00, 3.9576e+05,
         1.4094e+00, 1.6305e+00, 1.6711e+00, 1.3436e+00],
        [1.5709e+00, 0.0000e+00, 3.9090e+05, 3.8418e+05, 1.4858e+00, 1.5443e+00,
         4.0472e+05, 3.8568e+05, 1.4085e+00, 4.0325e+05, 1.4520e+00, 3.9576e+05,
         1.3954e+00, 1.2962e+00, 1.3961e+00, 1.6803e+00],
        [3.9088e+05, 3.9090e+05, 0.0000e+00, 7.8213e+05, 3.9088e+05, 3.9091e+05,
         7.8896e+05, 7.7952e+05, 3.9090e+05, 7.6886e+05, 3.9091e+05, 7.7473e+05,
         3.9091e+05, 3.9085e+05, 3.9090e+05, 3.9091e+05],
        [3.8416e+05, 3.8418e+05, 7.8213e+05, 0.0000e+00, 3.8418e+05, 3.8419e+05,
         7.8430e+05, 7.6901e+05, 3.8417e+05, 7.9021e+05, 3.8419e+05, 7.6269e+05,
         3.8416e+05, 3.8415e+05, 3.8418e+05, 3.8416e+05],
        [1.3474e+00, 1.4858e+00, 3.9088e+05, 3.8418e+05, 0.0000e+00, 1.1912e+00,
         4.0472e+05, 3.8562e+05, 1.4109e+00, 4.0325e+05, 1.2694e+00, 3.9576e+05,
         1.2793e+00, 1.4383e+00, 1.3739e+00, 1.2908e+00],
        [1.3553e+00, 1.5443e+00, 3.9091e+05, 3.8419e+05, 1.1912e+00, 0.0000e+00,
         4.0473e+05, 3.8565e+05, 1.3738e+00, 4.0325e+05, 1.1673e+00, 3.9575e+05,
         1.2315e+00, 1.5542e+00, 1.5277e+00, 1.0670e+00],
        [4.0470e+05, 4.0472e+05, 7.8896e+05, 7.8430e+05, 4.0472e+05, 4.0473e+05,
         0.0000e+00, 7.8394e+05, 4.0472e+05, 8.1588e+05, 4.0471e+05, 8.1354e+05,
         4.0472e+05, 4.0472e+05, 4.0473e+05, 4.0470e+05],
        [3.8563e+05, 3.8568e+05, 7.7952e+05, 7.6901e+05, 3.8562e+05, 3.8565e+05,
         7.8394e+05, 0.0000e+00, 3.8563e+05, 7.9062e+05, 3.8563e+05, 7.7371e+05,
         3.8565e+05, 3.8566e+05, 3.8563e+05, 3.8565e+05],
        [1.5687e+00, 1.4085e+00, 3.9090e+05, 3.8417e+05, 1.4109e+00, 1.3738e+00,
         4.0472e+05, 3.8563e+05, 0.0000e+00, 4.0324e+05, 1.2660e+00, 3.9573e+05,
         1.3873e+00, 1.3088e+00, 1.3410e+00, 1.4333e+00],
        [4.0325e+05, 4.0325e+05, 7.6886e+05, 7.9021e+05, 4.0325e+05, 4.0325e+05,
         8.1588e+05, 7.9062e+05, 4.0324e+05, 0.0000e+00, 4.0328e+05, 8.0152e+05,
         4.0322e+05, 4.0323e+05, 4.0327e+05, 4.0327e+05],
        [1.3501e+00, 1.4520e+00, 3.9091e+05, 3.8419e+05, 1.2694e+00, 1.1673e+00,
         4.0471e+05, 3.8563e+05, 1.2660e+00, 4.0328e+05, 0.0000e+00, 3.9577e+05,
         1.2810e+00, 1.5234e+00, 1.4748e+00, 1.2238e+00],
        [3.9576e+05, 3.9576e+05, 7.7473e+05, 7.6269e+05, 3.9576e+05, 3.9575e+05,
         8.1354e+05, 7.7371e+05, 3.9573e+05, 8.0152e+05, 3.9577e+05, 0.0000e+00,
         3.9576e+05, 3.9572e+05, 3.9575e+05, 3.9576e+05],
        [1.4094e+00, 1.3954e+00, 3.9091e+05, 3.8416e+05, 1.2793e+00, 1.2315e+00,
         4.0472e+05, 3.8565e+05, 1.3873e+00, 4.0322e+05, 1.2810e+00, 3.9576e+05,
         0.0000e+00, 1.5121e+00, 1.3679e+00, 1.3541e+00],
        [1.6305e+00, 1.2962e+00, 3.9085e+05, 3.8415e+05, 1.4383e+00, 1.5542e+00,
         4.0472e+05, 3.8566e+05, 1.3088e+00, 4.0323e+05, 1.5234e+00, 3.9572e+05,
         1.5121e+00, 0.0000e+00, 1.2964e+00, 1.6490e+00],
        [1.6711e+00, 1.3961e+00, 3.9090e+05, 3.8418e+05, 1.3739e+00, 1.5277e+00,
         4.0473e+05, 3.8563e+05, 1.3410e+00, 4.0327e+05, 1.4748e+00, 3.9575e+05,
         1.3679e+00, 1.2964e+00, 0.0000e+00, 1.5931e+00],
        [1.3436e+00, 1.6803e+00, 3.9091e+05, 3.8416e+05, 1.2908e+00, 1.0670e+00,
         4.0470e+05, 3.8565e+05, 1.4333e+00, 4.0327e+05, 1.2238e+00, 3.9576e+05,
         1.3541e+00, 1.6490e+00, 1.5931e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3436e+00, 1.3474e+00, 1.3501e+00, 1.3553e+00, 1.4094e+00,
        1.5687e+00, 1.5709e+00, 1.6305e+00, 1.6711e+00, 3.8416e+05, 3.8563e+05,
        3.9088e+05, 3.9576e+05, 4.0325e+05, 4.0470e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2962e+00, 1.3954e+00, 1.3961e+00, 1.4085e+00, 1.4520e+00,
        1.4858e+00, 1.5443e+00, 1.5709e+00, 1.6803e+00, 3.8418e+05, 3.8568e+05,
        3.9090e+05, 3.9576e+05, 4.0325e+05, 4.0472e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390847.7812, 390879.4688, 390882.5000, 390895.0625,
        390901.2500, 390902.3125, 390905.8125, 390908.9062, 390909.9062,
        390912.5000, 768859.3750, 774731.1250, 779518.8125, 782133.5625,
        788955.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384148.2500, 384158.3438, 384160.0938, 384160.4688,
        384167.3750, 384181.5000, 384181.5625, 384183.2812, 384187.6562,
        384188.9375, 762686.2500, 769008.9375, 782133.5625, 784303.7500,
        790212.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1912e+00, 1.2694e+00, 1.2793e+00, 1.2908e+00, 1.3474e+00,
        1.3739e+00, 1.4109e+00, 1.4383e+00, 1.4858e+00, 3.8418e+05, 3.8562e+05,
        3.9088e+05, 3.9576e+05, 4.0325e+05, 4.0472e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0670e+00, 1.1673e+00, 1.1912e+00, 1.2315e+00, 1.3553e+00,
        1.3738e+00, 1.5277e+00, 1.5443e+00, 1.5542e+00, 3.8419e+05, 3.8565e+05,
        3.9091e+05, 3.9575e+05, 4.0325e+05, 4.0473e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404702.5625, 404703.4375, 404710.7500, 404717.4062,
        404717.7500, 404718.9375, 404721.0625, 404722.9688, 404725.3438,
        404727.7812, 783937.5000, 784303.7500, 788955.8750, 813536.6875,
        815880.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385622.4688, 385627.2188, 385629.1250, 385629.7500,
        385631.9062, 385646.0312, 385650.0938, 385652.2812, 385658.4375,
        385684.5625, 769008.9375, 773711.6250, 779518.8125, 783937.5000,
        790615.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2660e+00, 1.3088e+00, 1.3410e+00, 1.3738e+00, 1.3873e+00,
        1.4085e+00, 1.4109e+00, 1.4333e+00, 1.5687e+00, 3.8417e+05, 3.8563e+05,
        3.9090e+05, 3.9573e+05, 4.0324e+05, 4.0472e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403220.9688, 403234.0938, 403244.3438, 403245.4688,
        403247.6875, 403249.3125, 403253.0000, 403267.5625, 403267.9062,
        403279.6875, 768859.3750, 790212.9375, 790615.6250, 801520.6250,
        815880.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1673e+00, 1.2238e+00, 1.2660e+00, 1.2694e+00, 1.2810e+00,
        1.3501e+00, 1.4520e+00, 1.4748e+00, 1.5234e+00, 3.8419e+05, 3.8563e+05,
        3.9091e+05, 3.9577e+05, 4.0328e+05, 4.0471e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395721.4688, 395732.6250, 395745.5938, 395748.5312,
        395756.2500, 395757.4688, 395757.7188, 395758.1250, 395760.8750,
        395768.1875, 762686.2500, 773711.6250, 774731.1250, 801520.6250,
        813536.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2315e+00, 1.2793e+00, 1.2810e+00, 1.3541e+00, 1.3679e+00,
        1.3873e+00, 1.3954e+00, 1.4094e+00, 1.5121e+00, 3.8416e+05, 3.8565e+05,
        3.9091e+05, 3.9576e+05, 4.0322e+05, 4.0472e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2962e+00, 1.2964e+00, 1.3088e+00, 1.4383e+00, 1.5121e+00,
        1.5234e+00, 1.5542e+00, 1.6305e+00, 1.6490e+00, 3.8415e+05, 3.8566e+05,
        3.9085e+05, 3.9572e+05, 4.0323e+05, 4.0472e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2964e+00, 1.3410e+00, 1.3679e+00, 1.3739e+00, 1.3961e+00,
        1.4748e+00, 1.5277e+00, 1.5931e+00, 1.6711e+00, 3.8418e+05, 3.8563e+05,
        3.9090e+05, 3.9575e+05, 4.0327e+05, 4.0473e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0670e+00, 1.2238e+00, 1.2908e+00, 1.3436e+00, 1.3541e+00,
        1.4333e+00, 1.5931e+00, 1.6490e+00, 1.6803e+00, 3.8416e+05, 3.8565e+05,
        3.9091e+05, 3.9576e+05, 4.0327e+05, 4.0470e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38417.33', '38419.65', '390894.56', '384171.72', '38419.36', '38419.96', '404716.81', '385643.19', '38417.99', '403251.00', '38420.09', '395750.69', '38417.05', '38416.14', '38419.46', '38417.31']
estimated f for each client, fs: [6, 6, 4, 4, 6, 6, 4, 4, 6, 4, 6, 4, 6, 6, 6, 6]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:54...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:54, End: 2025-07-22 15:29:54)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [2, 19, 17, 1, 9, 20, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.8927e+05, 3.8068e+05, 1.3608e+00, 1.2930e+00, 4.0024e+05,
         3.8493e+05, 1.2203e+00, 1.3741e+00, 3.7762e+05, 3.8698e+05, 1.3868e+00,
         3.9706e+05, 1.3941e+00, 1.3383e+00],
        [3.8927e+05, 0.0000e+00, 7.4902e+05, 3.8927e+05, 3.8926e+05, 7.8805e+05,
         7.6204e+05, 3.8927e+05, 3.8927e+05, 7.6105e+05, 7.8512e+05, 3.8928e+05,
         7.8236e+05, 3.8928e+05, 3.8926e+05],
        [3.8068e+05, 7.4902e+05, 0.0000e+00, 3.8066e+05, 3.8066e+05, 7.7812e+05,
         7.7510e+05, 3.8066e+05, 3.8064e+05, 7.5118e+05, 7.5794e+05, 3.8067e+05,
         7.6367e+05, 3.8067e+05, 3.8065e+05],
        [1.3608e+00, 3.8927e+05, 3.8066e+05, 0.0000e+00, 1.3082e+00, 4.0022e+05,
         3.8493e+05, 1.2993e+00, 1.4840e+00, 3.7766e+05, 3.8696e+05, 1.3925e+00,
         3.9708e+05, 1.4162e+00, 1.3326e+00],
        [1.2930e+00, 3.8926e+05, 3.8066e+05, 1.3082e+00, 0.0000e+00, 4.0021e+05,
         3.8491e+05, 1.2772e+00, 1.5030e+00, 3.7764e+05, 3.8699e+05, 1.3330e+00,
         3.9704e+05, 1.5682e+00, 1.1594e+00],
        [4.0024e+05, 7.8805e+05, 7.7812e+05, 4.0022e+05, 4.0021e+05, 0.0000e+00,
         7.9188e+05, 4.0026e+05, 4.0026e+05, 7.8525e+05, 7.6058e+05, 4.0023e+05,
         7.7956e+05, 4.0023e+05, 4.0021e+05],
        [3.8493e+05, 7.6204e+05, 7.7510e+05, 3.8493e+05, 3.8491e+05, 7.9188e+05,
         0.0000e+00, 3.8493e+05, 3.8493e+05, 7.4567e+05, 7.7629e+05, 3.8495e+05,
         7.7154e+05, 3.8492e+05, 3.8492e+05],
        [1.2203e+00, 3.8927e+05, 3.8066e+05, 1.2993e+00, 1.2772e+00, 4.0026e+05,
         3.8493e+05, 0.0000e+00, 1.4290e+00, 3.7764e+05, 3.8697e+05, 1.3869e+00,
         3.9702e+05, 1.3860e+00, 1.2627e+00],
        [1.3741e+00, 3.8927e+05, 3.8064e+05, 1.4840e+00, 1.5030e+00, 4.0026e+05,
         3.8493e+05, 1.4290e+00, 0.0000e+00, 3.7764e+05, 3.8699e+05, 1.4788e+00,
         3.9704e+05, 1.4498e+00, 1.5072e+00],
        [3.7762e+05, 7.6105e+05, 7.5118e+05, 3.7766e+05, 3.7764e+05, 7.8525e+05,
         7.4567e+05, 3.7764e+05, 3.7764e+05, 0.0000e+00, 7.6525e+05, 3.7765e+05,
         7.7643e+05, 3.7765e+05, 3.7767e+05],
        [3.8698e+05, 7.8512e+05, 7.5794e+05, 3.8696e+05, 3.8699e+05, 7.6058e+05,
         7.7629e+05, 3.8697e+05, 3.8699e+05, 7.6525e+05, 0.0000e+00, 3.8695e+05,
         7.9813e+05, 3.8697e+05, 3.8697e+05],
        [1.3868e+00, 3.8928e+05, 3.8067e+05, 1.3925e+00, 1.3330e+00, 4.0023e+05,
         3.8495e+05, 1.3869e+00, 1.4788e+00, 3.7765e+05, 3.8695e+05, 0.0000e+00,
         3.9705e+05, 1.5724e+00, 1.3290e+00],
        [3.9706e+05, 7.8236e+05, 7.6367e+05, 3.9708e+05, 3.9704e+05, 7.7956e+05,
         7.7154e+05, 3.9702e+05, 3.9704e+05, 7.7643e+05, 7.9813e+05, 3.9705e+05,
         0.0000e+00, 3.9708e+05, 3.9704e+05],
        [1.3941e+00, 3.8928e+05, 3.8067e+05, 1.4162e+00, 1.5682e+00, 4.0023e+05,
         3.8492e+05, 1.3860e+00, 1.4498e+00, 3.7765e+05, 3.8697e+05, 1.5724e+00,
         3.9708e+05, 0.0000e+00, 1.5674e+00],
        [1.3383e+00, 3.8926e+05, 3.8065e+05, 1.3326e+00, 1.1594e+00, 4.0021e+05,
         3.8492e+05, 1.2627e+00, 1.5072e+00, 3.7767e+05, 3.8697e+05, 1.3290e+00,
         3.9704e+05, 1.5674e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2203e+00, 1.2930e+00, 1.3383e+00, 1.3608e+00, 1.3741e+00,
        1.3868e+00, 1.3941e+00, 3.7762e+05, 3.8068e+05, 3.8493e+05, 3.8698e+05,
        3.8927e+05, 3.9706e+05, 4.0024e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389259.6250, 389261.2188, 389267.6250, 389269.4375,
        389270.2500, 389274.3750, 389275.2812, 389284.6875, 749015.0000,
        761052.0000, 762041.4375, 782355.1250, 785123.0625, 788051.6875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 380636.5000, 380646.9062, 380656.7188, 380658.8438,
        380660.0625, 380665.7188, 380670.2188, 380680.0938, 749015.0000,
        751179.9375, 757944.0625, 763667.3750, 775099.3750, 778116.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2993e+00, 1.3082e+00, 1.3326e+00, 1.3608e+00, 1.3925e+00,
        1.4162e+00, 1.4840e+00, 3.7766e+05, 3.8066e+05, 3.8493e+05, 3.8696e+05,
        3.8927e+05, 3.9708e+05, 4.0022e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1594e+00, 1.2772e+00, 1.2930e+00, 1.3082e+00, 1.3330e+00,
        1.5030e+00, 1.5682e+00, 3.7764e+05, 3.8066e+05, 3.8491e+05, 3.8699e+05,
        3.8926e+05, 3.9704e+05, 4.0021e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400207.6562, 400208.5625, 400217.7500, 400228.6250,
        400234.7500, 400242.9375, 400257.3750, 400259.0312, 760582.5625,
        778116.0000, 779557.8125, 785247.8125, 788051.6875, 791881.1250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 384909.2812, 384916.9375, 384917.8125, 384926.3125,
        384929.2188, 384931.4062, 384932.7500, 384945.2500, 745674.3125,
        762041.4375, 771541.5000, 775099.3750, 776286.7500, 791881.1250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2203e+00, 1.2627e+00, 1.2772e+00, 1.2993e+00, 1.3860e+00,
        1.3869e+00, 1.4290e+00, 3.7764e+05, 3.8066e+05, 3.8493e+05, 3.8697e+05,
        3.8927e+05, 3.9702e+05, 4.0026e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3741e+00, 1.4290e+00, 1.4498e+00, 1.4788e+00, 1.4840e+00,
        1.5030e+00, 1.5072e+00, 3.7764e+05, 3.8064e+05, 3.8493e+05, 3.8699e+05,
        3.8927e+05, 3.9704e+05, 4.0026e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 377623.6875, 377637.1250, 377640.5312, 377643.0312,
        377649.4375, 377653.3125, 377661.2500, 377666.8438, 745674.3125,
        751179.9375, 761052.0000, 765250.2500, 776428.3750, 785247.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386946.0625, 386955.6875, 386972.3438, 386973.2188,
        386973.2500, 386980.1875, 386986.9062, 386988.5312, 757944.0625,
        760582.5625, 765250.2500, 776286.7500, 785123.0625, 798130.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3290e+00, 1.3330e+00, 1.3868e+00, 1.3869e+00, 1.3925e+00,
        1.4788e+00, 1.5724e+00, 3.7765e+05, 3.8067e+05, 3.8495e+05, 3.8695e+05,
        3.8928e+05, 3.9705e+05, 4.0023e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397024.1875, 397035.8438, 397041.3438, 397043.2812,
        397053.2500, 397061.3750, 397079.3750, 397083.2500, 763667.3750,
        771541.5000, 776428.3750, 779557.8125, 782355.1250, 798130.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3860e+00, 1.3941e+00, 1.4162e+00, 1.4498e+00, 1.5674e+00,
        1.5682e+00, 1.5724e+00, 3.7765e+05, 3.8067e+05, 3.8492e+05, 3.8697e+05,
        3.8928e+05, 3.9708e+05, 4.0023e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1594e+00, 1.2627e+00, 1.3290e+00, 1.3326e+00, 1.3383e+00,
        1.5072e+00, 1.5674e+00, 3.7767e+05, 3.8065e+05, 3.8492e+05, 3.8697e+05,
        3.8926e+05, 3.9704e+05, 4.0021e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['84257.02', '429241.97', '421587.78', '84258.62', '84256.54', '440271.03', '425009.25', '84256.92', '84253.76', '418538.88', '428191.16', '84258.34', '437787.69', '84259.32', '84258.13']
estimated f for each client, fs: [7, 5, 5, 7, 7, 5, 5, 7, 7, 5, 5, 7, 5, 7, 7]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [2, 19, 17, 1, 9, 20, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0137s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:54...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:54, End: 2025-07-22 15:29:54)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.4459e+00, 3.9168e+05, 4.1281e+05, 1.2730e+00, 1.3835e+00,
         3.9053e+05, 4.0725e+05, 1.4772e+00, 1.2679e+00, 1.3828e+00, 3.8555e+05,
         3.9193e+05, 1.3114e+00, 1.3480e+00, 3.9394e+05, 1.5081e+00, 1.3186e+00],
        [1.4459e+00, 0.0000e+00, 3.9168e+05, 4.1286e+05, 1.3822e+00, 1.6440e+00,
         3.9052e+05, 4.0728e+05, 1.4303e+00, 1.4074e+00, 1.7551e+00, 3.8556e+05,
         3.9190e+05, 1.3840e+00, 1.4424e+00, 3.9394e+05, 1.4479e+00, 1.6286e+00],
        [3.9168e+05, 3.9168e+05, 0.0000e+00, 8.1245e+05, 3.9166e+05, 3.9164e+05,
         7.6892e+05, 7.9754e+05, 3.9168e+05, 3.9167e+05, 3.9166e+05, 7.7892e+05,
         7.7715e+05, 3.9167e+05, 3.9167e+05, 7.8252e+05, 3.9168e+05, 3.9166e+05],
        [4.1281e+05, 4.1286e+05, 8.1245e+05, 0.0000e+00, 4.1281e+05, 4.1280e+05,
         8.1805e+05, 8.2706e+05, 4.1281e+05, 4.1282e+05, 4.1283e+05, 8.1708e+05,
         8.2050e+05, 4.1287e+05, 4.1282e+05, 8.2013e+05, 4.1284e+05, 4.1282e+05],
        [1.2730e+00, 1.3822e+00, 3.9166e+05, 4.1281e+05, 0.0000e+00, 1.2612e+00,
         3.9049e+05, 4.0727e+05, 1.3981e+00, 1.3104e+00, 1.4921e+00, 3.8558e+05,
         3.9193e+05, 1.2791e+00, 1.2788e+00, 3.9396e+05, 1.3305e+00, 1.3203e+00],
        [1.3835e+00, 1.6440e+00, 3.9164e+05, 4.1280e+05, 1.2612e+00, 0.0000e+00,
         3.9046e+05, 4.0724e+05, 1.4511e+00, 1.2969e+00, 1.2920e+00, 3.8556e+05,
         3.9195e+05, 1.3131e+00, 1.2627e+00, 3.9395e+05, 1.5917e+00, 1.1465e+00],
        [3.9053e+05, 3.9052e+05, 7.6892e+05, 8.1805e+05, 3.9049e+05, 3.9046e+05,
         0.0000e+00, 7.9855e+05, 3.9047e+05, 3.9049e+05, 3.9050e+05, 7.5150e+05,
         7.7971e+05, 3.9052e+05, 3.9047e+05, 7.9173e+05, 3.9053e+05, 3.9048e+05],
        [4.0725e+05, 4.0728e+05, 7.9754e+05, 8.2706e+05, 4.0727e+05, 4.0724e+05,
         7.9855e+05, 0.0000e+00, 4.0725e+05, 4.0727e+05, 4.0725e+05, 7.9721e+05,
         8.1190e+05, 4.0727e+05, 4.0727e+05, 7.7853e+05, 4.0726e+05, 4.0722e+05],
        [1.4772e+00, 1.4303e+00, 3.9168e+05, 4.1281e+05, 1.3981e+00, 1.4511e+00,
         3.9047e+05, 4.0725e+05, 0.0000e+00, 1.2390e+00, 1.5836e+00, 3.8555e+05,
         3.9192e+05, 1.3938e+00, 1.3925e+00, 3.9394e+05, 1.3571e+00, 1.4064e+00],
        [1.2679e+00, 1.4074e+00, 3.9167e+05, 4.1282e+05, 1.3104e+00, 1.2969e+00,
         3.9049e+05, 4.0727e+05, 1.2390e+00, 0.0000e+00, 1.4177e+00, 3.8555e+05,
         3.9193e+05, 1.2287e+00, 1.3411e+00, 3.9395e+05, 1.4233e+00, 1.2606e+00],
        [1.3828e+00, 1.7551e+00, 3.9166e+05, 4.1283e+05, 1.4921e+00, 1.2920e+00,
         3.9050e+05, 4.0725e+05, 1.5836e+00, 1.4177e+00, 0.0000e+00, 3.8556e+05,
         3.9193e+05, 1.5454e+00, 1.3226e+00, 3.9395e+05, 1.7118e+00, 1.2890e+00],
        [3.8555e+05, 3.8556e+05, 7.7892e+05, 8.1708e+05, 3.8558e+05, 3.8556e+05,
         7.5150e+05, 7.9721e+05, 3.8555e+05, 3.8555e+05, 3.8556e+05, 0.0000e+00,
         7.9189e+05, 3.8554e+05, 3.8557e+05, 7.8015e+05, 3.8555e+05, 3.8554e+05],
        [3.9193e+05, 3.9190e+05, 7.7715e+05, 8.2050e+05, 3.9193e+05, 3.9195e+05,
         7.7971e+05, 8.1190e+05, 3.9192e+05, 3.9193e+05, 3.9193e+05, 7.9189e+05,
         0.0000e+00, 3.9192e+05, 3.9196e+05, 8.0854e+05, 3.9194e+05, 3.9193e+05],
        [1.3114e+00, 1.3840e+00, 3.9167e+05, 4.1287e+05, 1.2791e+00, 1.3131e+00,
         3.9052e+05, 4.0727e+05, 1.3938e+00, 1.2287e+00, 1.5454e+00, 3.8554e+05,
         3.9192e+05, 0.0000e+00, 1.3861e+00, 3.9394e+05, 1.3338e+00, 1.3758e+00],
        [1.3480e+00, 1.4424e+00, 3.9167e+05, 4.1282e+05, 1.2788e+00, 1.2627e+00,
         3.9047e+05, 4.0727e+05, 1.3925e+00, 1.3411e+00, 1.3226e+00, 3.8557e+05,
         3.9196e+05, 1.3861e+00, 0.0000e+00, 3.9397e+05, 1.4755e+00, 1.2814e+00],
        [3.9394e+05, 3.9394e+05, 7.8252e+05, 8.2013e+05, 3.9396e+05, 3.9395e+05,
         7.9173e+05, 7.7853e+05, 3.9394e+05, 3.9395e+05, 3.9395e+05, 7.8015e+05,
         8.0854e+05, 3.9394e+05, 3.9397e+05, 0.0000e+00, 3.9394e+05, 3.9392e+05],
        [1.5081e+00, 1.4479e+00, 3.9168e+05, 4.1284e+05, 1.3305e+00, 1.5917e+00,
         3.9053e+05, 4.0726e+05, 1.3571e+00, 1.4233e+00, 1.7118e+00, 3.8555e+05,
         3.9194e+05, 1.3338e+00, 1.4755e+00, 3.9394e+05, 0.0000e+00, 1.5317e+00],
        [1.3186e+00, 1.6286e+00, 3.9166e+05, 4.1282e+05, 1.3203e+00, 1.1465e+00,
         3.9048e+05, 4.0722e+05, 1.4064e+00, 1.2606e+00, 1.2890e+00, 3.8554e+05,
         3.9193e+05, 1.3758e+00, 1.2814e+00, 3.9392e+05, 1.5317e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2679e+00, 1.2730e+00, 1.3114e+00, 1.3186e+00, 1.3480e+00,
        1.3828e+00, 1.3835e+00, 1.4459e+00, 1.4772e+00, 1.5081e+00, 3.8555e+05,
        3.9053e+05, 3.9168e+05, 3.9193e+05, 3.9394e+05, 4.0725e+05, 4.1281e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3822e+00, 1.3840e+00, 1.4074e+00, 1.4303e+00, 1.4424e+00,
        1.4459e+00, 1.4479e+00, 1.6286e+00, 1.6440e+00, 1.7551e+00, 3.8556e+05,
        3.9052e+05, 3.9168e+05, 3.9190e+05, 3.9394e+05, 4.0728e+05, 4.1286e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391644.6562, 391659.4375, 391661.5625, 391661.7500,
        391669.4375, 391669.7500, 391673.0938, 391677.8750, 391678.2500,
        391681.4062, 391683.3750, 768920.1250, 777151.2500, 778922.9375,
        782523.0000, 797537.8125, 812451.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 412795.7500, 412809.8125, 412812.9688, 412813.3438,
        412816.2812, 412816.7500, 412823.4062, 412825.6250, 412839.4062,
        412862.0312, 412870.3125, 812451.5625, 817078.9375, 818048.3125,
        820129.4375, 820497.7500, 827061.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2612e+00, 1.2730e+00, 1.2788e+00, 1.2791e+00, 1.3104e+00,
        1.3203e+00, 1.3305e+00, 1.3822e+00, 1.3981e+00, 1.4921e+00, 3.8558e+05,
        3.9049e+05, 3.9166e+05, 3.9193e+05, 3.9396e+05, 4.0727e+05, 4.1281e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1465e+00, 1.2612e+00, 1.2627e+00, 1.2920e+00, 1.2969e+00,
        1.3131e+00, 1.3835e+00, 1.4511e+00, 1.5917e+00, 1.6440e+00, 3.8556e+05,
        3.9046e+05, 3.9164e+05, 3.9195e+05, 3.9395e+05, 4.0724e+05, 4.1280e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 390460.3750, 390471.0000, 390471.9062, 390482.5625,
        390494.0625, 390494.8750, 390498.7812, 390515.5000, 390517.8750,
        390527.1875, 390532.0000, 751503.6875, 768920.1250, 779709.7500,
        791728.8125, 798554.8125, 818048.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 407215.1875, 407241.2500, 407245.7188, 407246.0000,
        407248.7812, 407261.2188, 407266.0625, 407266.2500, 407268.4062,
        407273.9375, 407275.3125, 778527.8750, 797207.1875, 797537.8125,
        798554.8125, 811902.5625, 827061.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2390e+00, 1.3571e+00, 1.3925e+00, 1.3938e+00, 1.3981e+00,
        1.4064e+00, 1.4303e+00, 1.4511e+00, 1.4772e+00, 1.5836e+00, 3.8555e+05,
        3.9047e+05, 3.9168e+05, 3.9192e+05, 3.9394e+05, 4.0725e+05, 4.1281e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2287e+00, 1.2390e+00, 1.2606e+00, 1.2679e+00, 1.2969e+00,
        1.3104e+00, 1.3411e+00, 1.4074e+00, 1.4177e+00, 1.4233e+00, 3.8555e+05,
        3.9049e+05, 3.9167e+05, 3.9193e+05, 3.9395e+05, 4.0727e+05, 4.1282e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2890e+00, 1.2920e+00, 1.3226e+00, 1.3828e+00, 1.4177e+00,
        1.4921e+00, 1.5454e+00, 1.5836e+00, 1.7118e+00, 1.7551e+00, 3.8556e+05,
        3.9050e+05, 3.9166e+05, 3.9193e+05, 3.9395e+05, 4.0725e+05, 4.1283e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385535.6250, 385536.2500, 385548.0938, 385548.6250,
        385549.7812, 385554.2500, 385555.3438, 385557.3438, 385559.1562,
        385571.9688, 385575.8438, 751503.6875, 778922.9375, 780145.9375,
        791892.0625, 797207.1875, 817078.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391904.1875, 391919.6875, 391921.0000, 391925.6875,
        391926.7500, 391928.3438, 391928.5000, 391931.4375, 391937.2500,
        391945.9375, 391963.2188, 777151.2500, 779709.7500, 791892.0625,
        808545.0000, 811902.5625, 820497.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2287e+00, 1.2791e+00, 1.3114e+00, 1.3131e+00, 1.3338e+00,
        1.3758e+00, 1.3840e+00, 1.3861e+00, 1.3938e+00, 1.5454e+00, 3.8554e+05,
        3.9052e+05, 3.9167e+05, 3.9192e+05, 3.9394e+05, 4.0727e+05, 4.1287e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2627e+00, 1.2788e+00, 1.2814e+00, 1.3226e+00, 1.3411e+00,
        1.3480e+00, 1.3861e+00, 1.3925e+00, 1.4424e+00, 1.4755e+00, 3.8557e+05,
        3.9047e+05, 3.9167e+05, 3.9196e+05, 3.9397e+05, 4.0727e+05, 4.1282e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393918.9688, 393936.9375, 393939.0000, 393941.0938,
        393941.9375, 393941.9688, 393947.7812, 393948.8438, 393950.5625,
        393961.7188, 393967.9688, 778527.8750, 780145.9375, 782523.0000,
        791728.8125, 808545.0000, 820129.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3305e+00, 1.3338e+00, 1.3571e+00, 1.4233e+00, 1.4479e+00,
        1.4755e+00, 1.5081e+00, 1.5317e+00, 1.5917e+00, 1.7118e+00, 3.8555e+05,
        3.9053e+05, 3.9168e+05, 3.9194e+05, 3.9394e+05, 4.0726e+05, 4.1284e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1465e+00, 1.2606e+00, 1.2814e+00, 1.2890e+00, 1.3186e+00,
        1.3203e+00, 1.3758e+00, 1.4064e+00, 1.5317e+00, 1.6286e+00, 3.8554e+05,
        3.9048e+05, 3.9166e+05, 3.9193e+05, 3.9392e+05, 4.0722e+05, 4.1282e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['35051.07', '35052.19', '391669.12', '412825.94', '35053.55', '35051.72', '390496.91', '407255.28', '35051.67', '35051.18', '35052.01', '385553.84', '391930.19', '35049.98', '35053.22', '393945.12', '35051.21', '35049.93']
estimated f for each client, fs: [7, 7, 5, 5, 7, 7, 5, 5, 7, 7, 7, 5, 5, 7, 7, 5, 7, 7]
selected_index: 17
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Chosen Update']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0177s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:55...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:55, End: 2025-07-22 15:29:55)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 2, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.1700e+00, 4.0635e+05, 3.9286e+05, 1.0476e+00, 1.1775e+00,
         3.8680e+05, 1.1733e+00, 3.9051e+05, 1.0249e+00, 1.0492e+00, 3.7922e+05,
         3.8732e+05, 1.0695e+00, 1.0838e+00, 3.8607e+05, 1.4538e+00],
        [1.1700e+00, 0.0000e+00, 4.0630e+05, 3.9282e+05, 1.0960e+00, 1.0674e+00,
         3.8680e+05, 1.1365e+00, 3.9051e+05, 1.0414e+00, 1.0602e+00, 3.7924e+05,
         3.8734e+05, 1.0942e+00, 1.1015e+00, 3.8612e+05, 1.4507e+00],
        [4.0635e+05, 4.0630e+05, 0.0000e+00, 8.1245e+05, 4.0631e+05, 4.0631e+05,
         7.9665e+05, 4.0633e+05, 8.0084e+05, 4.0631e+05, 4.0630e+05, 7.8426e+05,
         7.7797e+05, 4.0630e+05, 4.0631e+05, 7.8287e+05, 4.0627e+05],
        [3.9286e+05, 3.9282e+05, 8.1245e+05, 0.0000e+00, 3.9287e+05, 3.9284e+05,
         7.7528e+05, 3.9286e+05, 7.8469e+05, 3.9288e+05, 3.9285e+05, 7.9502e+05,
         7.8558e+05, 3.9284e+05, 3.9286e+05, 7.6479e+05, 3.9286e+05],
        [1.0476e+00, 1.0960e+00, 4.0631e+05, 3.9287e+05, 0.0000e+00, 1.0663e+00,
         3.8682e+05, 1.1589e+00, 3.9049e+05, 1.0475e+00, 1.0862e+00, 3.7925e+05,
         3.8734e+05, 1.0265e+00, 1.0618e+00, 3.8608e+05, 1.4582e+00],
        [1.1775e+00, 1.0674e+00, 4.0631e+05, 3.9284e+05, 1.0663e+00, 0.0000e+00,
         3.8680e+05, 1.2030e+00, 3.9050e+05, 1.0902e+00, 1.0132e+00, 3.7924e+05,
         3.8736e+05, 1.1058e+00, 1.1308e+00, 3.8611e+05, 1.1046e+00],
        [3.8680e+05, 3.8680e+05, 7.9665e+05, 7.7528e+05, 3.8682e+05, 3.8680e+05,
         0.0000e+00, 3.8679e+05, 7.8652e+05, 3.8682e+05, 3.8679e+05, 7.5249e+05,
         7.9035e+05, 3.8678e+05, 3.8679e+05, 7.8466e+05, 3.8679e+05],
        [1.1733e+00, 1.1365e+00, 4.0633e+05, 3.9286e+05, 1.1589e+00, 1.2030e+00,
         3.8679e+05, 0.0000e+00, 3.9052e+05, 1.0134e+00, 1.1814e+00, 3.7926e+05,
         3.8732e+05, 1.1536e+00, 1.1627e+00, 3.8608e+05, 1.6422e+00],
        [3.9051e+05, 3.9051e+05, 8.0084e+05, 7.8469e+05, 3.9049e+05, 3.9050e+05,
         7.8652e+05, 3.9052e+05, 0.0000e+00, 3.9051e+05, 3.9051e+05, 7.5537e+05,
         7.8546e+05, 3.9052e+05, 3.9052e+05, 7.6196e+05, 3.9051e+05],
        [1.0249e+00, 1.0414e+00, 4.0631e+05, 3.9288e+05, 1.0475e+00, 1.0902e+00,
         3.8682e+05, 1.0134e+00, 3.9051e+05, 0.0000e+00, 1.0647e+00, 3.7925e+05,
         3.8732e+05, 1.0220e+00, 1.1458e+00, 3.8609e+05, 1.4164e+00],
        [1.0492e+00, 1.0602e+00, 4.0630e+05, 3.9285e+05, 1.0862e+00, 1.0132e+00,
         3.8679e+05, 1.1814e+00, 3.9051e+05, 1.0647e+00, 0.0000e+00, 3.7923e+05,
         3.8734e+05, 1.1809e+00, 1.0404e+00, 3.8607e+05, 1.2150e+00],
        [3.7922e+05, 3.7924e+05, 7.8426e+05, 7.9502e+05, 3.7925e+05, 3.7924e+05,
         7.5249e+05, 3.7926e+05, 7.5537e+05, 3.7925e+05, 3.7923e+05, 0.0000e+00,
         7.4977e+05, 3.7924e+05, 3.7922e+05, 7.7947e+05, 3.7919e+05],
        [3.8732e+05, 3.8734e+05, 7.7797e+05, 7.8558e+05, 3.8734e+05, 3.8736e+05,
         7.9035e+05, 3.8732e+05, 7.8546e+05, 3.8732e+05, 3.8734e+05, 7.4977e+05,
         0.0000e+00, 3.8733e+05, 3.8732e+05, 7.5846e+05, 3.8734e+05],
        [1.0695e+00, 1.0942e+00, 4.0630e+05, 3.9284e+05, 1.0265e+00, 1.1058e+00,
         3.8678e+05, 1.1536e+00, 3.9052e+05, 1.0220e+00, 1.1809e+00, 3.7924e+05,
         3.8733e+05, 0.0000e+00, 1.1339e+00, 3.8608e+05, 1.5236e+00],
        [1.0838e+00, 1.1015e+00, 4.0631e+05, 3.9286e+05, 1.0618e+00, 1.1308e+00,
         3.8679e+05, 1.1627e+00, 3.9052e+05, 1.1458e+00, 1.0404e+00, 3.7922e+05,
         3.8732e+05, 1.1339e+00, 0.0000e+00, 3.8607e+05, 1.4555e+00],
        [3.8607e+05, 3.8612e+05, 7.8287e+05, 7.6479e+05, 3.8608e+05, 3.8611e+05,
         7.8466e+05, 3.8608e+05, 7.6196e+05, 3.8609e+05, 3.8607e+05, 7.7947e+05,
         7.5846e+05, 3.8608e+05, 3.8607e+05, 0.0000e+00, 3.8609e+05],
        [1.4538e+00, 1.4507e+00, 4.0627e+05, 3.9286e+05, 1.4582e+00, 1.1046e+00,
         3.8679e+05, 1.6422e+00, 3.9051e+05, 1.4164e+00, 1.2150e+00, 3.7919e+05,
         3.8734e+05, 1.5236e+00, 1.4555e+00, 3.8609e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0249e+00, 1.0476e+00, 1.0492e+00, 1.0695e+00, 1.0838e+00,
        1.1700e+00, 1.1733e+00, 1.1775e+00, 1.4538e+00, 3.7922e+05, 3.8607e+05,
        3.8680e+05, 3.8732e+05, 3.9051e+05, 3.9286e+05, 4.0635e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0414e+00, 1.0602e+00, 1.0674e+00, 1.0942e+00, 1.0960e+00,
        1.1015e+00, 1.1365e+00, 1.1700e+00, 1.4507e+00, 3.7924e+05, 3.8612e+05,
        3.8680e+05, 3.8734e+05, 3.9051e+05, 3.9282e+05, 4.0630e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406273.4375, 406297.4062, 406300.3125, 406301.9375,
        406305.5938, 406307.2500, 406312.8750, 406314.5312, 406327.2500,
        406348.1875, 777971.8750, 782873.7500, 784257.6875, 796646.0625,
        800841.7500, 812446.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392817.4375, 392840.6250, 392842.5938, 392847.2500,
        392857.9062, 392859.0625, 392859.4688, 392861.4688, 392874.8438,
        392880.9375, 764791.4375, 775282.4375, 784687.4375, 785581.5000,
        795018.6250, 812446.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0265e+00, 1.0475e+00, 1.0476e+00, 1.0618e+00, 1.0663e+00,
        1.0862e+00, 1.0960e+00, 1.1589e+00, 1.4582e+00, 3.7925e+05, 3.8608e+05,
        3.8682e+05, 3.8734e+05, 3.9049e+05, 3.9287e+05, 4.0631e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0132e+00, 1.0663e+00, 1.0674e+00, 1.0902e+00, 1.1046e+00,
        1.1058e+00, 1.1308e+00, 1.1775e+00, 1.2030e+00, 3.7924e+05, 3.8611e+05,
        3.8680e+05, 3.8736e+05, 3.9050e+05, 3.9284e+05, 4.0631e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386779.7500, 386788.1875, 386788.3750, 386791.5625,
        386793.6250, 386796.5000, 386797.4688, 386800.2188, 386816.1875,
        386822.4375, 752494.3750, 775282.4375, 784656.0000, 786515.5625,
        790350.3750, 796646.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0134e+00, 1.1365e+00, 1.1536e+00, 1.1589e+00, 1.1627e+00,
        1.1733e+00, 1.1814e+00, 1.2030e+00, 1.6422e+00, 3.7926e+05, 3.8608e+05,
        3.8679e+05, 3.8732e+05, 3.9052e+05, 3.9286e+05, 4.0633e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390485.6875, 390499.6250, 390505.0625, 390507.3750,
        390513.6875, 390513.9375, 390514.3125, 390518.2188, 390519.6562,
        390522.3750, 755367.3125, 761955.7500, 784687.4375, 785464.3125,
        786515.5625, 800841.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0134e+00, 1.0220e+00, 1.0249e+00, 1.0414e+00, 1.0475e+00,
        1.0647e+00, 1.0902e+00, 1.1458e+00, 1.4164e+00, 3.7925e+05, 3.8609e+05,
        3.8682e+05, 3.8732e+05, 3.9051e+05, 3.9288e+05, 4.0631e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0132e+00, 1.0404e+00, 1.0492e+00, 1.0602e+00, 1.0647e+00,
        1.0862e+00, 1.1809e+00, 1.1814e+00, 1.2150e+00, 3.7923e+05, 3.8607e+05,
        3.8679e+05, 3.8734e+05, 3.9051e+05, 3.9285e+05, 4.0630e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379189.0312, 379221.6250, 379223.0000, 379225.5625,
        379236.4688, 379238.6250, 379240.0938, 379251.1562, 379251.8125,
        379255.9375, 749774.1875, 752494.3750, 755367.3125, 779466.0000,
        784257.6875, 795018.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387316.1875, 387322.0625, 387322.4062, 387323.1250,
        387333.3125, 387337.7812, 387339.0938, 387340.8125, 387341.5938,
        387355.0000, 749774.1875, 758455.3125, 777971.8750, 785464.3125,
        785581.5000, 790350.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0220e+00, 1.0265e+00, 1.0695e+00, 1.0942e+00, 1.1058e+00,
        1.1339e+00, 1.1536e+00, 1.1809e+00, 1.5236e+00, 3.7924e+05, 3.8608e+05,
        3.8678e+05, 3.8733e+05, 3.9052e+05, 3.9284e+05, 4.0630e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0404e+00, 1.0618e+00, 1.0838e+00, 1.1015e+00, 1.1308e+00,
        1.1339e+00, 1.1458e+00, 1.1627e+00, 1.4555e+00, 3.7922e+05, 3.8607e+05,
        3.8679e+05, 3.8732e+05, 3.9052e+05, 3.9286e+05, 4.0631e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386065.4688, 386071.6250, 386074.4062, 386075.9375,
        386079.1875, 386084.4062, 386089.5000, 386092.5000, 386110.0000,
        386117.9062, 758455.3125, 761955.7500, 764791.4375, 779466.0000,
        782873.7500, 784656.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1046e+00, 1.2150e+00, 1.4164e+00, 1.4507e+00, 1.4538e+00,
        1.4555e+00, 1.4582e+00, 1.5236e+00, 1.6422e+00, 3.7919e+05, 3.8609e+05,
        3.8679e+05, 3.8734e+05, 3.9051e+05, 3.9286e+05, 4.0627e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37923.19', '37924.66', '406308.84', '392854.12', '37926.12', '37924.85', '386797.44', '37926.68', '390509.97', '37926.17', '37923.55', '379233.31', '387333.12', '37925.04', '37923.33', '386086.09', '37920.18']
estimated f for each client, fs: [7, 7, 5, 5, 7, 7, 5, 7, 5, 7, 7, 5, 5, 7, 7, 5, 7]
selected_index: 16
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0118s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:56...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:56, End: 2025-07-22 15:29:56)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 9.5662e-01, 9.4478e-01, 3.9298e+05, 4.0133e+05, 9.0208e-01,
         9.0884e-01, 3.8816e+05, 3.9916e+05, 9.9695e-01, 4.1036e+05, 8.9342e-01,
         3.7397e+05, 3.9092e+05, 8.7605e-01, 9.0423e-01, 3.9465e+05, 1.0332e+00,
         1.4932e+00],
        [9.5662e-01, 0.0000e+00, 9.5378e-01, 3.9296e+05, 4.0132e+05, 9.8581e-01,
         1.0336e+00, 3.8817e+05, 3.9915e+05, 9.8252e-01, 4.1034e+05, 9.7044e-01,
         3.7397e+05, 3.9093e+05, 9.2524e-01, 9.6265e-01, 3.9466e+05, 1.0126e+00,
         1.8658e+00],
        [9.4478e-01, 9.5378e-01, 0.0000e+00, 3.9296e+05, 4.0136e+05, 8.7649e-01,
         8.0850e-01, 3.8815e+05, 3.9919e+05, 9.1607e-01, 4.1035e+05, 8.4552e-01,
         3.7396e+05, 3.9094e+05, 8.4623e-01, 8.7858e-01, 3.9466e+05, 9.3103e-01,
         1.3987e+00],
        [3.9298e+05, 3.9296e+05, 3.9296e+05, 0.0000e+00, 7.7823e+05, 3.9297e+05,
         3.9295e+05, 7.9407e+05, 8.1620e+05, 3.9295e+05, 8.2559e+05, 3.9298e+05,
         7.7515e+05, 7.9816e+05, 3.9299e+05, 3.9297e+05, 8.0846e+05, 3.9298e+05,
         3.9295e+05],
        [4.0133e+05, 4.0132e+05, 4.0136e+05, 7.7823e+05, 0.0000e+00, 4.0133e+05,
         4.0136e+05, 7.9123e+05, 8.0609e+05, 4.0132e+05, 8.3395e+05, 4.0133e+05,
         7.6678e+05, 7.9615e+05, 4.0135e+05, 4.0135e+05, 8.0208e+05, 4.0132e+05,
         4.0139e+05],
        [9.0208e-01, 9.8581e-01, 8.7649e-01, 3.9297e+05, 4.0133e+05, 0.0000e+00,
         8.3397e-01, 3.8818e+05, 3.9915e+05, 9.6291e-01, 4.1036e+05, 8.9706e-01,
         3.7397e+05, 3.9092e+05, 8.2325e-01, 8.6441e-01, 3.9466e+05, 9.1197e-01,
         1.4665e+00],
        [9.0884e-01, 1.0336e+00, 8.0850e-01, 3.9295e+05, 4.0136e+05, 8.3397e-01,
         0.0000e+00, 3.8816e+05, 3.9917e+05, 9.0618e-01, 4.1036e+05, 8.5143e-01,
         3.7397e+05, 3.9091e+05, 8.1123e-01, 8.7641e-01, 3.9463e+05, 1.0440e+00,
         9.9996e-01],
        [3.8816e+05, 3.8817e+05, 3.8815e+05, 7.9407e+05, 7.9123e+05, 3.8818e+05,
         3.8816e+05, 0.0000e+00, 7.9598e+05, 3.8817e+05, 8.0116e+05, 3.8816e+05,
         7.5818e+05, 7.7971e+05, 3.8817e+05, 3.8817e+05, 7.9377e+05, 3.8819e+05,
         3.8815e+05],
        [3.9916e+05, 3.9915e+05, 3.9919e+05, 8.1620e+05, 8.0609e+05, 3.9915e+05,
         3.9917e+05, 7.9598e+05, 0.0000e+00, 3.9916e+05, 8.1182e+05, 3.9916e+05,
         7.4457e+05, 7.7976e+05, 3.9916e+05, 3.9915e+05, 8.2010e+05, 3.9918e+05,
         3.9914e+05],
        [9.9695e-01, 9.8252e-01, 9.1607e-01, 3.9295e+05, 4.0132e+05, 9.6291e-01,
         9.0618e-01, 3.8817e+05, 3.9916e+05, 0.0000e+00, 4.1035e+05, 8.4669e-01,
         3.7397e+05, 3.9092e+05, 9.2492e-01, 9.2440e-01, 3.9467e+05, 9.5319e-01,
         1.6051e+00],
        [4.1036e+05, 4.1034e+05, 4.1035e+05, 8.2559e+05, 8.3395e+05, 4.1036e+05,
         4.1036e+05, 8.0116e+05, 8.1182e+05, 4.1035e+05, 0.0000e+00, 4.1032e+05,
         7.6433e+05, 8.0555e+05, 4.1032e+05, 4.1035e+05, 7.9236e+05, 4.1033e+05,
         4.1035e+05],
        [8.9342e-01, 9.7044e-01, 8.4552e-01, 3.9298e+05, 4.0133e+05, 8.9706e-01,
         8.5143e-01, 3.8816e+05, 3.9916e+05, 8.4669e-01, 4.1032e+05, 0.0000e+00,
         3.7398e+05, 3.9092e+05, 8.2547e-01, 9.4742e-01, 3.9463e+05, 9.4871e-01,
         1.5046e+00],
        [3.7397e+05, 3.7397e+05, 3.7396e+05, 7.7515e+05, 7.6678e+05, 3.7397e+05,
         3.7397e+05, 7.5818e+05, 7.4457e+05, 3.7397e+05, 7.6433e+05, 3.7398e+05,
         0.0000e+00, 7.6196e+05, 3.7396e+05, 3.7397e+05, 7.6198e+05, 3.7401e+05,
         3.7398e+05],
        [3.9092e+05, 3.9093e+05, 3.9094e+05, 7.9816e+05, 7.9615e+05, 3.9092e+05,
         3.9091e+05, 7.7971e+05, 7.7976e+05, 3.9092e+05, 8.0555e+05, 3.9092e+05,
         7.6196e+05, 0.0000e+00, 3.9092e+05, 3.9092e+05, 7.9105e+05, 3.9092e+05,
         3.9094e+05],
        [8.7605e-01, 9.2524e-01, 8.4623e-01, 3.9299e+05, 4.0135e+05, 8.2325e-01,
         8.1123e-01, 3.8817e+05, 3.9916e+05, 9.2492e-01, 4.1032e+05, 8.2547e-01,
         3.7396e+05, 3.9092e+05, 0.0000e+00, 8.7501e-01, 3.9463e+05, 9.1692e-01,
         1.4363e+00],
        [9.0423e-01, 9.6265e-01, 8.7858e-01, 3.9297e+05, 4.0135e+05, 8.6441e-01,
         8.7641e-01, 3.8817e+05, 3.9915e+05, 9.2440e-01, 4.1035e+05, 9.4742e-01,
         3.7397e+05, 3.9092e+05, 8.7501e-01, 0.0000e+00, 3.9467e+05, 9.8160e-01,
         1.4696e+00],
        [3.9465e+05, 3.9466e+05, 3.9466e+05, 8.0846e+05, 8.0208e+05, 3.9466e+05,
         3.9463e+05, 7.9377e+05, 8.2010e+05, 3.9467e+05, 7.9236e+05, 3.9463e+05,
         7.6198e+05, 7.9105e+05, 3.9463e+05, 3.9467e+05, 0.0000e+00, 3.9465e+05,
         3.9467e+05],
        [1.0332e+00, 1.0126e+00, 9.3103e-01, 3.9298e+05, 4.0132e+05, 9.1197e-01,
         1.0440e+00, 3.8819e+05, 3.9918e+05, 9.5319e-01, 4.1033e+05, 9.4871e-01,
         3.7401e+05, 3.9092e+05, 9.1692e-01, 9.8160e-01, 3.9465e+05, 0.0000e+00,
         1.8228e+00],
        [1.4932e+00, 1.8658e+00, 1.3987e+00, 3.9295e+05, 4.0139e+05, 1.4665e+00,
         9.9996e-01, 3.8815e+05, 3.9914e+05, 1.6051e+00, 4.1035e+05, 1.5046e+00,
         3.7398e+05, 3.9094e+05, 1.4363e+00, 1.4696e+00, 3.9467e+05, 1.8228e+00,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.7605e-01, 8.9342e-01, 9.0208e-01, 9.0423e-01, 9.0884e-01,
        9.4478e-01, 9.5662e-01, 9.9695e-01, 1.0332e+00, 1.4932e+00, 3.7397e+05,
        3.8816e+05, 3.9092e+05, 3.9298e+05, 3.9465e+05, 3.9916e+05, 4.0133e+05,
        4.1036e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.2524e-01, 9.5378e-01, 9.5662e-01, 9.6265e-01, 9.7044e-01,
        9.8252e-01, 9.8581e-01, 1.0126e+00, 1.0336e+00, 1.8658e+00, 3.7397e+05,
        3.8817e+05, 3.9093e+05, 3.9296e+05, 3.9466e+05, 3.9915e+05, 4.0132e+05,
        4.1034e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.0850e-01, 8.4552e-01, 8.4623e-01, 8.7649e-01, 8.7858e-01,
        9.1607e-01, 9.3103e-01, 9.4478e-01, 9.5378e-01, 1.3987e+00, 3.7396e+05,
        3.8815e+05, 3.9094e+05, 3.9296e+05, 3.9466e+05, 3.9919e+05, 4.0136e+05,
        4.1035e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392948.9688, 392949.4688, 392950.1250, 392963.2500,
        392964.1875, 392965.1562, 392967.3125, 392980.0312, 392980.8125,
        392983.1875, 392985.7188, 775154.8125, 778227.8750, 794074.1875,
        798160.2500, 808463.0000, 816196.3750, 825591.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 401316.5312, 401319.4688, 401321.0000, 401326.3125,
        401330.9375, 401334.6562, 401349.6562, 401350.8125, 401356.1875,
        401361.5000, 401385.1250, 766777.6875, 778227.8750, 791227.6250,
        796149.6875, 802079.3125, 806089.2500, 833953.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.2325e-01, 8.3397e-01, 8.6441e-01, 8.7649e-01, 8.9706e-01,
        9.0208e-01, 9.1197e-01, 9.6291e-01, 9.8581e-01, 1.4665e+00, 3.7397e+05,
        3.8818e+05, 3.9092e+05, 3.9297e+05, 3.9466e+05, 3.9915e+05, 4.0133e+05,
        4.1036e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.0850e-01, 8.1123e-01, 8.3397e-01, 8.5143e-01, 8.7641e-01,
        9.0618e-01, 9.0884e-01, 9.9996e-01, 1.0336e+00, 1.0440e+00, 3.7397e+05,
        3.8816e+05, 3.9091e+05, 3.9295e+05, 3.9463e+05, 3.9917e+05, 4.0136e+05,
        4.1036e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 388147.7500, 388148.3125, 388161.5000, 388163.2500,
        388164.6875, 388166.3750, 388168.2812, 388172.2500, 388174.9062,
        388178.8125, 388190.0312, 758176.3750, 779711.2500, 791227.6250,
        793770.8750, 794074.1875, 795980.7500, 801155.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 399144.5312, 399145.1250, 399148.0625, 399149.5000,
        399158.1562, 399159.7812, 399161.1250, 399161.2500, 399169.3750,
        399178.0312, 399188.5625, 744570.6875, 779764.1250, 795980.7500,
        806089.2500, 811818.3125, 816196.3750, 820102.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.4669e-01, 9.0618e-01, 9.1607e-01, 9.2440e-01, 9.2492e-01,
        9.5319e-01, 9.6291e-01, 9.8252e-01, 9.9695e-01, 1.6051e+00, 3.7397e+05,
        3.8817e+05, 3.9092e+05, 3.9295e+05, 3.9467e+05, 3.9916e+05, 4.0132e+05,
        4.1035e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 410317.7188, 410322.8750, 410327.8438, 410341.5312,
        410345.2500, 410345.4375, 410348.5938, 410349.5312, 410356.5312,
        410357.5000, 410358.6875, 764330.3125, 792356.6250, 801155.8125,
        805545.4375, 811818.3125, 825591.0000, 833953.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.2547e-01, 8.4552e-01, 8.4669e-01, 8.5143e-01, 8.9342e-01,
        8.9706e-01, 9.4742e-01, 9.4871e-01, 9.7044e-01, 1.5046e+00, 3.7398e+05,
        3.8816e+05, 3.9092e+05, 3.9298e+05, 3.9463e+05, 3.9916e+05, 4.0133e+05,
        4.1032e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 373961.2812, 373964.8438, 373965.7500, 373965.7500,
        373967.3125, 373969.9375, 373970.0000, 373970.9375, 373975.3125,
        373976.5000, 374008.0625, 744570.6875, 758176.3750, 761958.7500,
        761982.1875, 764330.3125, 766777.6875, 775154.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 390907.8750, 390916.0312, 390920.3125, 390920.7188,
        390921.9062, 390921.9375, 390922.2500, 390923.9375, 390928.6562,
        390937.0625, 390943.1875, 761958.7500, 779711.2500, 779764.1250,
        791052.9375, 796149.6875, 798160.2500, 805545.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.1123e-01, 8.2325e-01, 8.2547e-01, 8.4623e-01, 8.7501e-01,
        8.7605e-01, 9.1692e-01, 9.2492e-01, 9.2524e-01, 1.4363e+00, 3.7396e+05,
        3.8817e+05, 3.9092e+05, 3.9299e+05, 3.9463e+05, 3.9916e+05, 4.0135e+05,
        4.1032e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.6441e-01, 8.7501e-01, 8.7641e-01, 8.7858e-01, 9.0423e-01,
        9.2440e-01, 9.4742e-01, 9.6265e-01, 9.8160e-01, 1.4696e+00, 3.7397e+05,
        3.8817e+05, 3.9092e+05, 3.9297e+05, 3.9467e+05, 3.9915e+05, 4.0135e+05,
        4.1035e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 394629.0312, 394630.8750, 394634.4062, 394650.5625,
        394652.4688, 394656.7500, 394656.9062, 394656.9688, 394665.6875,
        394666.1250, 394667.5000, 761982.1875, 791052.9375, 792356.6250,
        793770.8750, 802079.3125, 808463.0000, 820102.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.1197e-01, 9.1692e-01, 9.3103e-01, 9.4871e-01, 9.5319e-01,
        9.8160e-01, 1.0126e+00, 1.0332e+00, 1.0440e+00, 1.8228e+00, 3.7401e+05,
        3.8819e+05, 3.9092e+05, 3.9298e+05, 3.9465e+05, 3.9918e+05, 4.0132e+05,
        4.1033e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.9996e-01, 1.3987e+00, 1.4363e+00, 1.4665e+00, 1.4696e+00,
        1.4932e+00, 1.5046e+00, 1.6051e+00, 1.8228e+00, 1.8658e+00, 3.7398e+05,
        3.8815e+05, 3.9094e+05, 3.9295e+05, 3.9467e+05, 3.9914e+05, 4.0139e+05,
        4.1035e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['33998.26', '33998.00', '33997.66', '392967.09', '401341.09', '33998.14', '33998.09', '388166.94', '399160.34', '33997.80', '410342.91', '33998.73', '373972.34', '390924.00', '33997.32', '33997.77', '394651.59', '34001.70', '33999.13']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 8, 6, 6, 8, 6, 8, 6, 6, 8, 8, 6, 8, 8]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0293s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:56...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:29:56, End: 2025-07-22 15:29:56)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [2, 19, 17, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.7136e+05, 3.9374e+05, 3.9741e+05, 3.9178e+05, 8.7960e-01,
         8.8595e-01, 3.7663e+05, 3.7339e+05, 1.1133e+00, 9.1394e-01, 3.8390e+05,
         9.6734e-01, 1.0349e+00],
        [3.7136e+05, 0.0000e+00, 7.5045e+05, 7.4552e+05, 7.6504e+05, 3.7135e+05,
         3.7137e+05, 7.6267e+05, 7.4801e+05, 3.7136e+05, 3.7133e+05, 7.5642e+05,
         3.7137e+05, 3.7136e+05],
        [3.9374e+05, 7.5045e+05, 0.0000e+00, 7.8496e+05, 7.7963e+05, 3.9373e+05,
         3.9374e+05, 7.7196e+05, 7.6162e+05, 3.9376e+05, 3.9375e+05, 7.8275e+05,
         3.9374e+05, 3.9374e+05],
        [3.9741e+05, 7.4552e+05, 7.8496e+05, 0.0000e+00, 7.9179e+05, 3.9740e+05,
         3.9740e+05, 7.7156e+05, 7.7869e+05, 3.9741e+05, 3.9738e+05, 7.9426e+05,
         3.9740e+05, 3.9739e+05],
        [3.9178e+05, 7.6504e+05, 7.7963e+05, 7.9179e+05, 0.0000e+00, 3.9179e+05,
         3.9179e+05, 7.9191e+05, 7.6595e+05, 3.9176e+05, 3.9179e+05, 7.8147e+05,
         3.9178e+05, 3.9178e+05],
        [8.7960e-01, 3.7135e+05, 3.9373e+05, 3.9740e+05, 3.9179e+05, 0.0000e+00,
         8.8847e-01, 3.7664e+05, 3.7341e+05, 1.0101e+00, 9.6685e-01, 3.8388e+05,
         1.0230e+00, 9.9538e-01],
        [8.8595e-01, 3.7137e+05, 3.9374e+05, 3.9740e+05, 3.9179e+05, 8.8847e-01,
         0.0000e+00, 3.7664e+05, 3.7338e+05, 1.0910e+00, 8.7483e-01, 3.8392e+05,
         1.0712e+00, 8.7402e-01],
        [3.7663e+05, 7.6267e+05, 7.7196e+05, 7.7156e+05, 7.9191e+05, 3.7664e+05,
         3.7664e+05, 0.0000e+00, 7.4598e+05, 3.7664e+05, 3.7663e+05, 7.7628e+05,
         3.7664e+05, 3.7663e+05],
        [3.7339e+05, 7.4801e+05, 7.6162e+05, 7.7869e+05, 7.6595e+05, 3.7341e+05,
         3.7338e+05, 7.4598e+05, 0.0000e+00, 3.7340e+05, 3.7341e+05, 7.5317e+05,
         3.7340e+05, 3.7340e+05],
        [1.1133e+00, 3.7136e+05, 3.9376e+05, 3.9741e+05, 3.9176e+05, 1.0101e+00,
         1.0910e+00, 3.7664e+05, 3.7340e+05, 0.0000e+00, 1.1311e+00, 3.8390e+05,
         1.3005e+00, 7.6214e-01],
        [9.1394e-01, 3.7133e+05, 3.9375e+05, 3.9738e+05, 3.9179e+05, 9.6685e-01,
         8.7483e-01, 3.7663e+05, 3.7341e+05, 1.1311e+00, 0.0000e+00, 3.8389e+05,
         1.0479e+00, 1.0412e+00],
        [3.8390e+05, 7.5642e+05, 7.8275e+05, 7.9426e+05, 7.8147e+05, 3.8388e+05,
         3.8392e+05, 7.7628e+05, 7.5317e+05, 3.8390e+05, 3.8389e+05, 0.0000e+00,
         3.8390e+05, 3.8390e+05],
        [9.6734e-01, 3.7137e+05, 3.9374e+05, 3.9740e+05, 3.9178e+05, 1.0230e+00,
         1.0712e+00, 3.7664e+05, 3.7340e+05, 1.3005e+00, 1.0479e+00, 3.8390e+05,
         0.0000e+00, 1.3872e+00],
        [1.0349e+00, 3.7136e+05, 3.9374e+05, 3.9739e+05, 3.9178e+05, 9.9538e-01,
         8.7402e-01, 3.7663e+05, 3.7340e+05, 7.6214e-01, 1.0412e+00, 3.8390e+05,
         1.3872e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.7960e-01, 8.8595e-01, 9.1394e-01, 9.6734e-01, 1.0349e+00,
        1.1133e+00, 3.7136e+05, 3.7339e+05, 3.7663e+05, 3.8390e+05, 3.9178e+05,
        3.9374e+05, 3.9741e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 371334.8438, 371348.2812, 371359.9062, 371360.0625,
        371364.5625, 371365.4375, 371372.3125, 745516.8750, 748010.4375,
        750450.2500, 756421.0000, 762666.6250, 765044.3750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393725.5312, 393736.5000, 393737.5938, 393739.8750,
        393743.4375, 393750.1875, 393755.6875, 750450.2500, 761624.6250,
        771964.0000, 779632.6875, 782745.8750, 784959.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397383.0312, 397387.4688, 397396.1250, 397399.2812,
        397403.6562, 397406.5625, 397414.4375, 745516.8750, 771561.6250,
        778687.5000, 784959.8750, 791787.7500, 794261.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391755.6250, 391778.3750, 391779.5938, 391781.4688,
        391785.7500, 391789.8438, 391792.5938, 765044.3750, 765951.6250,
        779632.6875, 781474.3750, 791787.7500, 791907.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 8.7960e-01, 8.8847e-01, 9.6685e-01, 9.9538e-01, 1.0101e+00,
        1.0230e+00, 3.7135e+05, 3.7341e+05, 3.7664e+05, 3.8388e+05, 3.9179e+05,
        3.9373e+05, 3.9740e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 8.7402e-01, 8.7483e-01, 8.8595e-01, 8.8847e-01, 1.0712e+00,
        1.0910e+00, 3.7137e+05, 3.7338e+05, 3.7664e+05, 3.8392e+05, 3.9179e+05,
        3.9374e+05, 3.9740e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 376630.1875, 376633.7188, 376634.7500, 376635.4062,
        376637.1250, 376638.8750, 376644.7812, 745984.1250, 762666.6250,
        771561.6250, 771964.0000, 776277.6250, 791907.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 373383.0625, 373389.5938, 373398.9375, 373400.1250,
        373403.3125, 373405.6250, 373410.3750, 745984.1250, 748010.4375,
        753172.6875, 761624.6250, 765951.6250, 778687.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 7.6214e-01, 1.0101e+00, 1.0910e+00, 1.1133e+00, 1.1311e+00,
        1.3005e+00, 3.7136e+05, 3.7340e+05, 3.7664e+05, 3.8390e+05, 3.9176e+05,
        3.9376e+05, 3.9741e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 8.7483e-01, 9.1394e-01, 9.6685e-01, 1.0412e+00, 1.0479e+00,
        1.1311e+00, 3.7133e+05, 3.7341e+05, 3.7663e+05, 3.8389e+05, 3.9179e+05,
        3.9375e+05, 3.9738e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 383881.2500, 383894.6875, 383896.8750, 383898.1562,
        383898.6562, 383902.6875, 383915.0938, 753172.6875, 756421.0000,
        776277.6250, 781474.3750, 782745.8750, 794261.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.6734e-01, 1.0230e+00, 1.0479e+00, 1.0712e+00, 1.3005e+00,
        1.3872e+00, 3.7137e+05, 3.7340e+05, 3.7664e+05, 3.8390e+05, 3.9178e+05,
        3.9374e+05, 3.9740e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 7.6214e-01, 8.7402e-01, 9.9538e-01, 1.0349e+00, 1.0412e+00,
        1.3872e+00, 3.7136e+05, 3.7340e+05, 3.7663e+05, 3.8390e+05, 3.9178e+05,
        3.9374e+05, 3.9739e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['124598.77', '454781.41', '474251.53', '477652.09', '474828.78', '124599.97', '124599.99', '460567.28', '456420.62', '124600.78', '124597.39', '466320.12', '124601.90', '124600.46']
estimated f for each client, fs: [7, 6, 4, 4, 4, 7, 7, 5, 5, 7, 7, 4, 7, 7]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [2, 19, 17, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0094s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:57...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:57, End: 2025-07-22 15:29:57)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.0175e+00, 1.0218e+00, 3.8976e+05, 9.5521e-01, 1.0287e+00,
         3.9561e+05, 3.9668e+05, 1.0426e+00, 9.4071e-01, 8.8991e-01, 3.9922e+05,
         4.0354e+05, 9.5153e-01, 1.1323e+00, 1.0796e+00, 1.1784e+00],
        [1.0175e+00, 0.0000e+00, 1.0211e+00, 3.8978e+05, 1.0594e+00, 1.1961e+00,
         3.9562e+05, 3.9665e+05, 1.0280e+00, 1.0252e+00, 1.1161e+00, 3.9924e+05,
         4.0354e+05, 1.1603e+00, 1.3671e+00, 1.0151e+00, 1.5705e+00],
        [1.0218e+00, 1.0211e+00, 0.0000e+00, 3.8977e+05, 9.8030e-01, 9.8136e-01,
         3.9564e+05, 3.9668e+05, 1.0271e+00, 9.7104e-01, 9.3338e-01, 3.9922e+05,
         4.0353e+05, 1.0306e+00, 1.1438e+00, 1.0276e+00, 1.1723e+00],
        [3.8976e+05, 3.8978e+05, 3.8977e+05, 0.0000e+00, 3.8978e+05, 3.8975e+05,
         7.7218e+05, 7.6654e+05, 3.8975e+05, 3.8977e+05, 3.8978e+05, 7.8645e+05,
         7.9991e+05, 3.8975e+05, 3.8977e+05, 3.8976e+05, 3.8976e+05],
        [9.5521e-01, 1.0594e+00, 9.8030e-01, 3.8978e+05, 0.0000e+00, 1.0058e+00,
         3.9564e+05, 3.9670e+05, 1.0645e+00, 9.8379e-01, 9.5331e-01, 3.9922e+05,
         4.0354e+05, 9.8273e-01, 1.1342e+00, 1.0166e+00, 1.2135e+00],
        [1.0287e+00, 1.1961e+00, 9.8136e-01, 3.8975e+05, 1.0058e+00, 0.0000e+00,
         3.9564e+05, 3.9672e+05, 1.0925e+00, 9.8982e-01, 9.0350e-01, 3.9922e+05,
         4.0353e+05, 8.0160e-01, 9.4727e-01, 1.2105e+00, 8.4889e-01],
        [3.9561e+05, 3.9562e+05, 3.9564e+05, 7.7218e+05, 3.9564e+05, 3.9564e+05,
         0.0000e+00, 7.9535e+05, 3.9563e+05, 3.9562e+05, 3.9564e+05, 7.9124e+05,
         8.1687e+05, 3.9563e+05, 3.9563e+05, 3.9563e+05, 3.9564e+05],
        [3.9668e+05, 3.9665e+05, 3.9668e+05, 7.6654e+05, 3.9670e+05, 3.9672e+05,
         7.9535e+05, 0.0000e+00, 3.9670e+05, 3.9670e+05, 3.9667e+05, 7.8947e+05,
         7.9942e+05, 3.9669e+05, 3.9669e+05, 3.9669e+05, 3.9670e+05],
        [1.0426e+00, 1.0280e+00, 1.0271e+00, 3.8975e+05, 1.0645e+00, 1.0925e+00,
         3.9563e+05, 3.9670e+05, 0.0000e+00, 9.3941e-01, 1.0406e+00, 3.9922e+05,
         4.0354e+05, 1.0991e+00, 1.3296e+00, 1.0284e+00, 1.3868e+00],
        [9.4071e-01, 1.0252e+00, 9.7104e-01, 3.8977e+05, 9.8379e-01, 9.8982e-01,
         3.9562e+05, 3.9670e+05, 9.3941e-01, 0.0000e+00, 9.5074e-01, 3.9925e+05,
         4.0352e+05, 9.3132e-01, 1.1767e+00, 1.0304e+00, 1.1671e+00],
        [8.8991e-01, 1.1161e+00, 9.3338e-01, 3.8978e+05, 9.5331e-01, 9.0350e-01,
         3.9564e+05, 3.9667e+05, 1.0406e+00, 9.5074e-01, 0.0000e+00, 3.9920e+05,
         4.0356e+05, 9.6805e-01, 1.0001e+00, 1.0901e+00, 9.6156e-01],
        [3.9922e+05, 3.9924e+05, 3.9922e+05, 7.8645e+05, 3.9922e+05, 3.9922e+05,
         7.9124e+05, 7.8947e+05, 3.9922e+05, 3.9925e+05, 3.9920e+05, 0.0000e+00,
         8.1505e+05, 3.9922e+05, 3.9919e+05, 3.9927e+05, 3.9921e+05],
        [4.0354e+05, 4.0354e+05, 4.0353e+05, 7.9991e+05, 4.0354e+05, 4.0353e+05,
         8.1687e+05, 7.9942e+05, 4.0354e+05, 4.0352e+05, 4.0356e+05, 8.1505e+05,
         0.0000e+00, 4.0357e+05, 4.0354e+05, 4.0354e+05, 4.0354e+05],
        [9.5153e-01, 1.1603e+00, 1.0306e+00, 3.8975e+05, 9.8273e-01, 8.0160e-01,
         3.9563e+05, 3.9669e+05, 1.0991e+00, 9.3132e-01, 9.6805e-01, 3.9922e+05,
         4.0357e+05, 0.0000e+00, 9.4556e-01, 1.1564e+00, 8.3930e-01],
        [1.1323e+00, 1.3671e+00, 1.1438e+00, 3.8977e+05, 1.1342e+00, 9.4727e-01,
         3.9563e+05, 3.9669e+05, 1.3296e+00, 1.1767e+00, 1.0001e+00, 3.9919e+05,
         4.0354e+05, 9.4556e-01, 0.0000e+00, 1.4074e+00, 8.3994e-01],
        [1.0796e+00, 1.0151e+00, 1.0276e+00, 3.8976e+05, 1.0166e+00, 1.2105e+00,
         3.9563e+05, 3.9669e+05, 1.0284e+00, 1.0304e+00, 1.0901e+00, 3.9927e+05,
         4.0354e+05, 1.1564e+00, 1.4074e+00, 0.0000e+00, 1.4890e+00],
        [1.1784e+00, 1.5705e+00, 1.1723e+00, 3.8976e+05, 1.2135e+00, 8.4889e-01,
         3.9564e+05, 3.9670e+05, 1.3868e+00, 1.1671e+00, 9.6156e-01, 3.9921e+05,
         4.0354e+05, 8.3930e-01, 8.3994e-01, 1.4890e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.8991e-01, 9.4071e-01, 9.5153e-01, 9.5521e-01, 1.0175e+00,
        1.0218e+00, 1.0287e+00, 1.0426e+00, 1.0796e+00, 1.1323e+00, 1.1784e+00,
        3.8976e+05, 3.9561e+05, 3.9668e+05, 3.9922e+05, 4.0354e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0151e+00, 1.0175e+00, 1.0211e+00, 1.0252e+00, 1.0280e+00,
        1.0594e+00, 1.1161e+00, 1.1603e+00, 1.1961e+00, 1.3671e+00, 1.5705e+00,
        3.8978e+05, 3.9562e+05, 3.9665e+05, 3.9924e+05, 4.0354e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.3338e-01, 9.7104e-01, 9.8030e-01, 9.8136e-01, 1.0211e+00,
        1.0218e+00, 1.0271e+00, 1.0276e+00, 1.0306e+00, 1.1438e+00, 1.1723e+00,
        3.8977e+05, 3.9564e+05, 3.9668e+05, 3.9922e+05, 4.0353e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389752.7500, 389753.1875, 389754.5625, 389755.9375,
        389756.5938, 389761.0000, 389772.5625, 389772.6250, 389773.5000,
        389778.0312, 389784.0312, 389784.0938, 766536.1250, 772181.5000,
        786450.5000, 799910.3125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 9.5331e-01, 9.5521e-01, 9.8030e-01, 9.8273e-01, 9.8379e-01,
        1.0058e+00, 1.0166e+00, 1.0594e+00, 1.0645e+00, 1.1342e+00, 1.2135e+00,
        3.8978e+05, 3.9564e+05, 3.9670e+05, 3.9922e+05, 4.0354e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0160e-01, 8.4889e-01, 9.0350e-01, 9.4727e-01, 9.8136e-01,
        9.8982e-01, 1.0058e+00, 1.0287e+00, 1.0925e+00, 1.1961e+00, 1.2105e+00,
        3.8975e+05, 3.9564e+05, 3.9672e+05, 3.9922e+05, 4.0353e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395607.5625, 395620.7812, 395623.9375, 395625.1562,
        395629.6250, 395629.8125, 395633.1562, 395635.4062, 395636.0938,
        395637.7500, 395638.0625, 395639.3750, 772181.5000, 791236.9375,
        795353.1875, 816867.1875])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 396651.3125, 396671.0938, 396684.1875, 396684.8125,
        396689.9375, 396692.6562, 396693.8438, 396695.0625, 396698.1875,
        396698.7188, 396700.6875, 396720.7812, 766536.1250, 789470.1875,
        795353.1875, 799419.1250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 9.3941e-01, 1.0271e+00, 1.0280e+00, 1.0284e+00, 1.0406e+00,
        1.0426e+00, 1.0645e+00, 1.0925e+00, 1.0991e+00, 1.3296e+00, 1.3868e+00,
        3.8975e+05, 3.9563e+05, 3.9670e+05, 3.9922e+05, 4.0354e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.3132e-01, 9.3941e-01, 9.4071e-01, 9.5074e-01, 9.7104e-01,
        9.8379e-01, 9.8982e-01, 1.0252e+00, 1.0304e+00, 1.1671e+00, 1.1767e+00,
        3.8977e+05, 3.9562e+05, 3.9670e+05, 3.9925e+05, 4.0352e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8991e-01, 9.0350e-01, 9.3338e-01, 9.5074e-01, 9.5331e-01,
        9.6156e-01, 9.6805e-01, 1.0001e+00, 1.0406e+00, 1.0901e+00, 1.1161e+00,
        3.8978e+05, 3.9564e+05, 3.9667e+05, 3.9920e+05, 4.0356e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399193.0312, 399204.6562, 399206.9375, 399215.7188,
        399216.1562, 399217.1562, 399220.0312, 399221.2500, 399221.9062,
        399235.5625, 399248.5000, 399265.3125, 786450.5000, 789470.1875,
        791236.9375, 815048.3750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 403517.7188, 403531.0625, 403533.1250, 403535.9375,
        403536.5000, 403536.6875, 403540.3125, 403540.6250, 403542.3125,
        403543.8750, 403561.9688, 403573.7812, 799419.1250, 799910.3125,
        815048.3750, 816867.1875])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 8.0160e-01, 8.3930e-01, 9.3132e-01, 9.4556e-01, 9.5153e-01,
        9.6805e-01, 9.8273e-01, 1.0306e+00, 1.0991e+00, 1.1564e+00, 1.1603e+00,
        3.8975e+05, 3.9563e+05, 3.9669e+05, 3.9922e+05, 4.0357e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3994e-01, 9.4556e-01, 9.4727e-01, 1.0001e+00, 1.1323e+00,
        1.1342e+00, 1.1438e+00, 1.1767e+00, 1.3296e+00, 1.3671e+00, 1.4074e+00,
        3.8977e+05, 3.9563e+05, 3.9669e+05, 3.9919e+05, 4.0354e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0151e+00, 1.0166e+00, 1.0276e+00, 1.0284e+00, 1.0304e+00,
        1.0796e+00, 1.0901e+00, 1.1564e+00, 1.2105e+00, 1.4074e+00, 1.4890e+00,
        3.8976e+05, 3.9563e+05, 3.9669e+05, 3.9927e+05, 4.0354e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3930e-01, 8.3994e-01, 8.4889e-01, 9.6156e-01, 1.1671e+00,
        1.1723e+00, 1.1784e+00, 1.2135e+00, 1.3868e+00, 1.4890e+00, 1.5705e+00,
        3.8976e+05, 3.9564e+05, 3.9670e+05, 3.9921e+05, 4.0354e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.01', '1.10', '1.01', '389766.56', '1.01', '0.98', '395629.75', '396690.12', '1.07', '0.99', '0.97', '399222.19', '403541.16', '0.97', '1.10', '1.11', '1.11']
estimated f for each client, fs: [6, 6, 6, 3, 6, 6, 3, 3, 6, 6, 6, 3, 3, 6, 6, 6, 6]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0254s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:58...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:58, End: 2025-07-22 15:29:58)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 17, 1, 8, 15, 4, 3, 13, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.0594e+00, 1.0548e+00, 3.8295e+05, 3.9060e+05, 9.8340e-01,
         1.0733e+00, 4.0059e+05, 9.7836e-01, 1.1702e+00, 3.8063e+05, 1.0005e+00,
         3.7946e+05, 1.1073e+00, 1.1740e+00],
        [1.0594e+00, 0.0000e+00, 1.0274e+00, 3.8294e+05, 3.9060e+05, 1.0519e+00,
         1.0215e+00, 4.0060e+05, 1.0237e+00, 1.5484e+00, 3.8065e+05, 1.1774e+00,
         3.7948e+05, 1.0405e+00, 1.5283e+00],
        [1.0548e+00, 1.0274e+00, 0.0000e+00, 3.8293e+05, 3.9059e+05, 9.8513e-01,
         1.0006e+00, 4.0061e+05, 9.5972e-01, 1.1947e+00, 3.8065e+05, 9.7976e-01,
         3.7945e+05, 9.9563e-01, 1.0955e+00],
        [3.8295e+05, 3.8294e+05, 3.8293e+05, 0.0000e+00, 7.8200e+05, 3.8291e+05,
         3.8292e+05, 7.8605e+05, 3.8294e+05, 3.8294e+05, 7.8456e+05, 3.8298e+05,
         7.6845e+05, 3.8289e+05, 3.8298e+05],
        [3.9060e+05, 3.9060e+05, 3.9059e+05, 7.8200e+05, 0.0000e+00, 3.9062e+05,
         3.9058e+05, 7.9486e+05, 3.9061e+05, 3.9062e+05, 7.7161e+05, 3.9061e+05,
         7.7152e+05, 3.9059e+05, 3.9060e+05],
        [9.8340e-01, 1.0519e+00, 9.8513e-01, 3.8291e+05, 3.9062e+05, 0.0000e+00,
         1.0478e+00, 4.0061e+05, 9.7285e-01, 1.2432e+00, 3.8066e+05, 9.8202e-01,
         3.7949e+05, 1.0020e+00, 1.2001e+00],
        [1.0733e+00, 1.0215e+00, 1.0006e+00, 3.8292e+05, 3.9058e+05, 1.0478e+00,
         0.0000e+00, 4.0063e+05, 9.1183e-01, 1.4250e+00, 3.8065e+05, 1.1264e+00,
         3.7947e+05, 1.0003e+00, 1.3297e+00],
        [4.0059e+05, 4.0060e+05, 4.0061e+05, 7.8605e+05, 7.9486e+05, 4.0061e+05,
         4.0063e+05, 0.0000e+00, 4.0062e+05, 4.0063e+05, 7.9284e+05, 4.0060e+05,
         7.8514e+05, 4.0060e+05, 4.0063e+05],
        [9.7836e-01, 1.0237e+00, 9.5972e-01, 3.8294e+05, 3.9061e+05, 9.7285e-01,
         9.1183e-01, 4.0062e+05, 0.0000e+00, 1.1924e+00, 3.8063e+05, 1.0030e+00,
         3.7946e+05, 1.0265e+00, 1.1643e+00],
        [1.1702e+00, 1.5484e+00, 1.1947e+00, 3.8294e+05, 3.9062e+05, 1.2432e+00,
         1.4250e+00, 4.0063e+05, 1.1924e+00, 0.0000e+00, 3.8063e+05, 8.5610e-01,
         3.7946e+05, 1.5375e+00, 7.3922e-01],
        [3.8063e+05, 3.8065e+05, 3.8065e+05, 7.8456e+05, 7.7161e+05, 3.8066e+05,
         3.8065e+05, 7.9284e+05, 3.8063e+05, 3.8063e+05, 0.0000e+00, 3.8067e+05,
         7.5596e+05, 3.8067e+05, 3.8064e+05],
        [1.0005e+00, 1.1774e+00, 9.7976e-01, 3.8298e+05, 3.9061e+05, 9.8202e-01,
         1.1264e+00, 4.0060e+05, 1.0030e+00, 8.5610e-01, 3.8067e+05, 0.0000e+00,
         3.7950e+05, 1.2104e+00, 7.8679e-01],
        [3.7946e+05, 3.7948e+05, 3.7945e+05, 7.6845e+05, 7.7152e+05, 3.7949e+05,
         3.7947e+05, 7.8514e+05, 3.7946e+05, 3.7946e+05, 7.5596e+05, 3.7950e+05,
         0.0000e+00, 3.7948e+05, 3.7949e+05],
        [1.1073e+00, 1.0405e+00, 9.9563e-01, 3.8289e+05, 3.9059e+05, 1.0020e+00,
         1.0003e+00, 4.0060e+05, 1.0265e+00, 1.5375e+00, 3.8067e+05, 1.2104e+00,
         3.7948e+05, 0.0000e+00, 1.4547e+00],
        [1.1740e+00, 1.5283e+00, 1.0955e+00, 3.8298e+05, 3.9060e+05, 1.2001e+00,
         1.3297e+00, 4.0063e+05, 1.1643e+00, 7.3922e-01, 3.8064e+05, 7.8679e-01,
         3.7949e+05, 1.4547e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.7836e-01, 9.8340e-01, 1.0005e+00, 1.0548e+00, 1.0594e+00,
        1.0733e+00, 1.1073e+00, 1.1702e+00, 1.1740e+00, 3.7946e+05, 3.8063e+05,
        3.8295e+05, 3.9060e+05, 4.0059e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0215e+00, 1.0237e+00, 1.0274e+00, 1.0405e+00, 1.0519e+00,
        1.0594e+00, 1.1774e+00, 1.5283e+00, 1.5484e+00, 3.7948e+05, 3.8065e+05,
        3.8294e+05, 3.9060e+05, 4.0060e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.5972e-01, 9.7976e-01, 9.8513e-01, 9.9563e-01, 1.0006e+00,
        1.0274e+00, 1.0548e+00, 1.0955e+00, 1.1947e+00, 3.7945e+05, 3.8065e+05,
        3.8293e+05, 3.9059e+05, 4.0061e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 382893.0625, 382908.6562, 382917.0938, 382925.0938,
        382938.0625, 382939.3750, 382940.0000, 382950.2500, 382975.2500,
        382984.1875, 768451.6875, 782004.8750, 784561.5000, 786046.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390580.9688, 390589.5625, 390590.0000, 390595.7812,
        390601.5625, 390601.8125, 390611.0938, 390611.8750, 390618.9062,
        390623.1250, 771521.3750, 771609.1250, 782004.8750, 794864.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7285e-01, 9.8202e-01, 9.8340e-01, 9.8513e-01, 1.0020e+00,
        1.0478e+00, 1.0519e+00, 1.2001e+00, 1.2432e+00, 3.7949e+05, 3.8066e+05,
        3.8291e+05, 3.9062e+05, 4.0061e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.1183e-01, 1.0003e+00, 1.0006e+00, 1.0215e+00, 1.0478e+00,
        1.0733e+00, 1.1264e+00, 1.3297e+00, 1.4250e+00, 3.7947e+05, 3.8065e+05,
        3.8292e+05, 3.9058e+05, 4.0063e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400591.3750, 400595.4688, 400598.9062, 400602.3750,
        400610.8750, 400611.9375, 400623.0000, 400625.1875, 400625.2812,
        400626.5625, 785138.1875, 786046.2500, 792839.3125, 794864.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1183e-01, 9.5972e-01, 9.7285e-01, 9.7836e-01, 1.0030e+00,
        1.0237e+00, 1.0265e+00, 1.1643e+00, 1.1924e+00, 3.7946e+05, 3.8063e+05,
        3.8294e+05, 3.9061e+05, 4.0062e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 7.3922e-01, 8.5610e-01, 1.1702e+00, 1.1924e+00, 1.1947e+00,
        1.2432e+00, 1.4250e+00, 1.5375e+00, 1.5484e+00, 3.7946e+05, 3.8063e+05,
        3.8294e+05, 3.9062e+05, 4.0063e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 380631.3125, 380631.7812, 380632.1250, 380638.1250,
        380645.4375, 380653.4375, 380653.7812, 380663.4688, 380667.9688,
        380670.7500, 755961.8125, 771609.1250, 784561.5000, 792839.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.8679e-01, 8.5610e-01, 9.7976e-01, 9.8202e-01, 1.0005e+00,
        1.0030e+00, 1.1264e+00, 1.1774e+00, 1.2104e+00, 3.7950e+05, 3.8067e+05,
        3.8298e+05, 3.9061e+05, 4.0060e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 379450.3125, 379460.6250, 379461.7500, 379462.0312,
        379472.5000, 379475.4688, 379478.3125, 379490.4375, 379491.5312,
        379497.3438, 755961.8125, 768451.6875, 771521.3750, 785138.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.9563e-01, 1.0003e+00, 1.0020e+00, 1.0265e+00, 1.0405e+00,
        1.1073e+00, 1.2104e+00, 1.4547e+00, 1.5375e+00, 3.7948e+05, 3.8067e+05,
        3.8289e+05, 3.9059e+05, 4.0060e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 7.3922e-01, 7.8679e-01, 1.0955e+00, 1.1643e+00, 1.1740e+00,
        1.2001e+00, 1.3297e+00, 1.4547e+00, 1.5283e+00, 3.7949e+05, 3.8064e+05,
        3.8298e+05, 3.9060e+05, 4.0063e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.07', '1.16', '1.03', '382931.88', '390602.50', '1.05', '1.10', '400611.12', '1.03', '1.21', '380648.81', '1.01', '379474.03', '1.15', '1.16']
estimated f for each client, fs: [5, 5, 5, 5, 3, 5, 5, 3, 5, 5, 3, 5, 3, 5, 5]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 17, 1, 8, 15, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0106s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:58...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:58, End: 2025-07-22 15:29:58)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 9.3709e-01, 9.1738e-01, 3.8015e+05, 3.9443e+05, 8.8429e-01,
         9.4565e-01, 3.8527e+05, 3.9447e+05, 9.4866e-01, 3.7240e+05, 8.6237e-01,
         9.5949e-01, 4.0410e+05, 8.7361e-01, 1.2796e+00, 4.0031e+05, 9.4953e-01],
        [9.3709e-01, 0.0000e+00, 8.9209e-01, 3.8014e+05, 3.9446e+05, 9.7992e-01,
         1.0591e+00, 3.8527e+05, 3.9447e+05, 9.2746e-01, 3.7240e+05, 9.1642e-01,
         1.2167e+00, 4.0410e+05, 9.9296e-01, 1.5191e+00, 4.0033e+05, 9.4606e-01],
        [9.1738e-01, 8.9209e-01, 0.0000e+00, 3.8016e+05, 3.9445e+05, 8.6450e-01,
         8.8044e-01, 3.8531e+05, 3.9450e+05, 8.8102e-01, 3.7242e+05, 8.5601e-01,
         9.8366e-01, 4.0411e+05, 8.7418e-01, 1.2817e+00, 4.0032e+05, 8.6768e-01],
        [3.8015e+05, 3.8014e+05, 3.8016e+05, 0.0000e+00, 7.6806e+05, 3.8015e+05,
         3.8012e+05, 7.7412e+05, 7.8313e+05, 3.8015e+05, 7.4755e+05, 3.8017e+05,
         3.8013e+05, 7.6784e+05, 3.8013e+05, 3.8014e+05, 7.9307e+05, 3.8017e+05],
        [3.9443e+05, 3.9446e+05, 3.9445e+05, 7.6806e+05, 0.0000e+00, 3.9446e+05,
         3.9444e+05, 7.9126e+05, 8.0616e+05, 3.9445e+05, 7.7459e+05, 3.9445e+05,
         3.9444e+05, 8.0156e+05, 3.9446e+05, 3.9444e+05, 7.8844e+05, 3.9445e+05],
        [8.8429e-01, 9.7992e-01, 8.6450e-01, 3.8015e+05, 3.9446e+05, 0.0000e+00,
         9.1830e-01, 3.8529e+05, 3.9446e+05, 9.4967e-01, 3.7241e+05, 9.0730e-01,
         1.0021e+00, 4.0412e+05, 8.8761e-01, 1.2920e+00, 4.0032e+05, 9.0390e-01],
        [9.4565e-01, 1.0591e+00, 8.8044e-01, 3.8012e+05, 3.9444e+05, 9.1830e-01,
         0.0000e+00, 3.8527e+05, 3.9450e+05, 9.8897e-01, 3.7238e+05, 9.1274e-01,
         7.8462e-01, 4.0409e+05, 7.5547e-01, 9.2900e-01, 4.0033e+05, 1.0754e+00],
        [3.8527e+05, 3.8527e+05, 3.8531e+05, 7.7412e+05, 7.9126e+05, 3.8529e+05,
         3.8527e+05, 0.0000e+00, 7.7547e+05, 3.8528e+05, 7.7491e+05, 3.8526e+05,
         3.8528e+05, 7.8043e+05, 3.8528e+05, 3.8529e+05, 7.6075e+05, 3.8527e+05],
        [3.9447e+05, 3.9447e+05, 3.9450e+05, 7.8313e+05, 8.0616e+05, 3.9446e+05,
         3.9450e+05, 7.7547e+05, 0.0000e+00, 3.9449e+05, 7.7363e+05, 3.9446e+05,
         3.9448e+05, 8.1322e+05, 3.9448e+05, 3.9447e+05, 7.8185e+05, 3.9445e+05],
        [9.4866e-01, 9.2746e-01, 8.8102e-01, 3.8015e+05, 3.9445e+05, 9.4967e-01,
         9.8897e-01, 3.8528e+05, 3.9449e+05, 0.0000e+00, 3.7241e+05, 8.3823e-01,
         1.1364e+00, 4.0410e+05, 9.5411e-01, 1.5013e+00, 4.0032e+05, 9.2702e-01],
        [3.7240e+05, 3.7240e+05, 3.7242e+05, 7.4755e+05, 7.7459e+05, 3.7241e+05,
         3.7238e+05, 7.7491e+05, 7.7363e+05, 3.7241e+05, 0.0000e+00, 3.7238e+05,
         3.7241e+05, 7.9956e+05, 3.7239e+05, 3.7241e+05, 7.7695e+05, 3.7239e+05],
        [8.6237e-01, 9.1642e-01, 8.5601e-01, 3.8017e+05, 3.9445e+05, 9.0730e-01,
         9.1274e-01, 3.8526e+05, 3.9446e+05, 8.3823e-01, 3.7238e+05, 0.0000e+00,
         9.9788e-01, 4.0413e+05, 8.3485e-01, 1.3186e+00, 4.0030e+05, 9.3807e-01],
        [9.5949e-01, 1.2167e+00, 9.8366e-01, 3.8013e+05, 3.9444e+05, 1.0021e+00,
         7.8462e-01, 3.8528e+05, 3.9448e+05, 1.1364e+00, 3.7241e+05, 9.9788e-01,
         0.0000e+00, 4.0414e+05, 8.4738e-01, 7.7431e-01, 4.0032e+05, 1.1963e+00],
        [4.0410e+05, 4.0410e+05, 4.0411e+05, 7.6784e+05, 8.0156e+05, 4.0412e+05,
         4.0409e+05, 7.8043e+05, 8.1322e+05, 4.0410e+05, 7.9956e+05, 4.0413e+05,
         4.0414e+05, 0.0000e+00, 4.0409e+05, 4.0412e+05, 7.8857e+05, 4.0411e+05],
        [8.7361e-01, 9.9296e-01, 8.7418e-01, 3.8013e+05, 3.9446e+05, 8.8761e-01,
         7.5547e-01, 3.8528e+05, 3.9448e+05, 9.5411e-01, 3.7239e+05, 8.3485e-01,
         8.4738e-01, 4.0409e+05, 0.0000e+00, 9.9739e-01, 4.0033e+05, 9.7814e-01],
        [1.2796e+00, 1.5191e+00, 1.2817e+00, 3.8014e+05, 3.9444e+05, 1.2920e+00,
         9.2900e-01, 3.8529e+05, 3.9447e+05, 1.5013e+00, 3.7241e+05, 1.3186e+00,
         7.7431e-01, 4.0412e+05, 9.9739e-01, 0.0000e+00, 4.0036e+05, 1.5675e+00],
        [4.0031e+05, 4.0033e+05, 4.0032e+05, 7.9307e+05, 7.8844e+05, 4.0032e+05,
         4.0033e+05, 7.6075e+05, 7.8185e+05, 4.0032e+05, 7.7695e+05, 4.0030e+05,
         4.0032e+05, 7.8857e+05, 4.0033e+05, 4.0036e+05, 0.0000e+00, 4.0031e+05],
        [9.4953e-01, 9.4606e-01, 8.6768e-01, 3.8017e+05, 3.9445e+05, 9.0390e-01,
         1.0754e+00, 3.8527e+05, 3.9445e+05, 9.2702e-01, 3.7239e+05, 9.3807e-01,
         1.1963e+00, 4.0411e+05, 9.7814e-01, 1.5675e+00, 4.0031e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.6237e-01, 8.7361e-01, 8.8429e-01, 9.1738e-01, 9.3709e-01,
        9.4565e-01, 9.4866e-01, 9.4953e-01, 9.5949e-01, 1.2796e+00, 3.7240e+05,
        3.8015e+05, 3.8527e+05, 3.9443e+05, 3.9447e+05, 4.0031e+05, 4.0410e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.9209e-01, 9.1642e-01, 9.2746e-01, 9.3709e-01, 9.4606e-01,
        9.7992e-01, 9.9296e-01, 1.0591e+00, 1.2167e+00, 1.5191e+00, 3.7240e+05,
        3.8014e+05, 3.8527e+05, 3.9446e+05, 3.9447e+05, 4.0033e+05, 4.0410e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.5601e-01, 8.6450e-01, 8.6768e-01, 8.7418e-01, 8.8044e-01,
        8.8102e-01, 8.9209e-01, 9.1738e-01, 9.8366e-01, 1.2817e+00, 3.7242e+05,
        3.8016e+05, 3.8531e+05, 3.9445e+05, 3.9450e+05, 4.0032e+05, 4.0411e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 380121.2812, 380129.3125, 380129.8750, 380139.5625,
        380141.2812, 380151.1250, 380152.7188, 380153.2812, 380156.6875,
        380166.3438, 380170.0000, 747545.8750, 767840.8750, 768055.5625,
        774116.3750, 783128.9375, 793070.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 394432.6250, 394436.3125, 394441.0625, 394441.3438,
        394449.4375, 394452.3125, 394452.7500, 394453.2812, 394461.2500,
        394462.4375, 394462.6562, 768055.5625, 774591.1250, 788442.4375,
        791264.3750, 801555.3125, 806158.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.6450e-01, 8.8429e-01, 8.8761e-01, 9.0390e-01, 9.0730e-01,
        9.1830e-01, 9.4967e-01, 9.7992e-01, 1.0021e+00, 1.2920e+00, 3.7241e+05,
        3.8015e+05, 3.8529e+05, 3.9446e+05, 3.9446e+05, 4.0032e+05, 4.0412e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 7.5547e-01, 7.8462e-01, 8.8044e-01, 9.1274e-01, 9.1830e-01,
        9.2900e-01, 9.4565e-01, 9.8897e-01, 1.0591e+00, 1.0754e+00, 3.7238e+05,
        3.8012e+05, 3.8527e+05, 3.9444e+05, 3.9450e+05, 4.0033e+05, 4.0409e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385260.9062, 385268.1250, 385268.2500, 385269.3750,
        385274.2812, 385275.4062, 385275.9375, 385284.2500, 385286.9062,
        385292.0938, 385308.9375, 760748.5625, 774116.3750, 774914.7500,
        775471.0625, 780425.1250, 791264.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 394446.5625, 394458.1562, 394461.5625, 394465.0312,
        394471.5312, 394472.6875, 394478.6250, 394479.5000, 394488.5938,
        394496.7812, 394498.4062, 773633.4375, 775471.0625, 781852.3750,
        783128.9375, 806158.1250, 813217.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.3823e-01, 8.8102e-01, 9.2702e-01, 9.2746e-01, 9.4866e-01,
        9.4967e-01, 9.5411e-01, 9.8897e-01, 1.1364e+00, 1.5013e+00, 3.7241e+05,
        3.8015e+05, 3.8528e+05, 3.9445e+05, 3.9449e+05, 4.0032e+05, 4.0410e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 372379.1562, 372382.1250, 372389.4688, 372394.5625,
        372400.1250, 372401.3125, 372406.5625, 372407.5938, 372411.3125,
        372413.0312, 372417.9375, 747545.8750, 773633.4375, 774591.1250,
        774914.7500, 776948.1250, 799563.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.3485e-01, 8.3823e-01, 8.5601e-01, 8.6237e-01, 9.0730e-01,
        9.1274e-01, 9.1642e-01, 9.3807e-01, 9.9788e-01, 1.3186e+00, 3.7238e+05,
        3.8017e+05, 3.8526e+05, 3.9445e+05, 3.9446e+05, 4.0030e+05, 4.0413e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 7.7431e-01, 7.8462e-01, 8.4738e-01, 9.5949e-01, 9.8366e-01,
        9.9788e-01, 1.0021e+00, 1.1364e+00, 1.1963e+00, 1.2167e+00, 3.7241e+05,
        3.8013e+05, 3.8528e+05, 3.9444e+05, 3.9448e+05, 4.0032e+05, 4.0414e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 404086.4688, 404086.5000, 404096.5000, 404097.6562,
        404104.0938, 404109.2812, 404112.1875, 404119.5000, 404122.3438,
        404125.5625, 404135.5625, 767840.8750, 780425.1250, 788573.1875,
        799563.8750, 801555.3125, 813217.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 7.5547e-01, 8.3485e-01, 8.4738e-01, 8.7361e-01, 8.7418e-01,
        8.8761e-01, 9.5411e-01, 9.7814e-01, 9.9296e-01, 9.9739e-01, 3.7239e+05,
        3.8013e+05, 3.8528e+05, 3.9446e+05, 3.9448e+05, 4.0033e+05, 4.0409e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 7.7431e-01, 9.2900e-01, 9.9739e-01, 1.2796e+00, 1.2817e+00,
        1.2920e+00, 1.3186e+00, 1.5013e+00, 1.5191e+00, 1.5675e+00, 3.7241e+05,
        3.8014e+05, 3.8529e+05, 3.9444e+05, 3.9447e+05, 4.0036e+05, 4.0412e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 400304.5625, 400305.1250, 400313.0625, 400315.3125,
        400317.8750, 400318.0000, 400321.1562, 400326.2188, 400329.2188,
        400329.7500, 400355.0625, 760748.5625, 776948.1250, 781852.3750,
        788442.4375, 788573.1875, 793070.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.6768e-01, 9.0390e-01, 9.2702e-01, 9.3807e-01, 9.4606e-01,
        9.4953e-01, 9.7814e-01, 1.0754e+00, 1.1963e+00, 1.5675e+00, 3.7239e+05,
        3.8017e+05, 3.8527e+05, 3.9445e+05, 3.9445e+05, 4.0031e+05, 4.0411e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['33855.54', '33855.50', '33857.02', '380146.47', '394449.56', '33856.60', '33853.76', '385278.56', '394474.28', '33856.48', '372400.28', '33853.50', '33856.13', '404108.69', '33854.41', '33856.27', '400321.31', '33855.00']
estimated f for each client, fs: [7, 7, 7, 5, 5, 7, 7, 5, 5, 7, 6, 7, 7, 5, 7, 7, 5, 7]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0165s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:59...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:59, End: 2025-07-22 15:29:59)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 19, 17, 9, 20, 8, 15, 4, 3, 13, 11, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 9.9392e-01, 3.9457e+05, 4.0120e+05, 9.9495e-01, 3.8914e+05,
         1.0497e+00, 3.9372e+05, 1.1094e+00, 9.6721e-01, 4.1453e+05, 9.1509e-01,
         4.0312e+05, 1.0620e+00],
        [9.9392e-01, 0.0000e+00, 3.9458e+05, 4.0117e+05, 9.1622e-01, 3.8914e+05,
         1.0088e+00, 3.9369e+05, 1.1239e+00, 9.9525e-01, 4.1453e+05, 9.2084e-01,
         4.0310e+05, 1.0208e+00],
        [3.9457e+05, 3.9458e+05, 0.0000e+00, 8.1820e+05, 3.9457e+05, 7.8635e+05,
         3.9457e+05, 7.9670e+05, 3.9454e+05, 3.9457e+05, 8.3206e+05, 3.9457e+05,
         7.8824e+05, 3.9456e+05],
        [4.0120e+05, 4.0117e+05, 8.1820e+05, 0.0000e+00, 4.0118e+05, 7.9994e+05,
         4.0122e+05, 7.8274e+05, 4.0118e+05, 4.0119e+05, 8.2102e+05, 4.0120e+05,
         8.1471e+05, 4.0118e+05],
        [9.9495e-01, 9.1622e-01, 3.9457e+05, 4.0118e+05, 0.0000e+00, 3.8912e+05,
         1.0512e+00, 3.9371e+05, 9.2364e-01, 8.1190e-01, 4.1451e+05, 7.8039e-01,
         4.0312e+05, 1.1562e+00],
        [3.8914e+05, 3.8914e+05, 7.8635e+05, 7.9994e+05, 3.8912e+05, 0.0000e+00,
         3.8913e+05, 7.8696e+05, 3.8910e+05, 3.8914e+05, 7.8063e+05, 3.8912e+05,
         7.9516e+05, 3.8915e+05],
        [1.0497e+00, 1.0088e+00, 3.9457e+05, 4.0122e+05, 1.0512e+00, 3.8913e+05,
         0.0000e+00, 3.9372e+05, 1.2241e+00, 1.1541e+00, 4.1454e+05, 1.0374e+00,
         4.0313e+05, 1.0397e+00],
        [3.9372e+05, 3.9369e+05, 7.9670e+05, 7.8274e+05, 3.9371e+05, 7.8696e+05,
         3.9372e+05, 0.0000e+00, 3.9370e+05, 3.9370e+05, 7.9950e+05, 3.9372e+05,
         7.9405e+05, 3.9373e+05],
        [1.1094e+00, 1.1239e+00, 3.9454e+05, 4.0118e+05, 9.2364e-01, 3.8910e+05,
         1.2241e+00, 3.9370e+05, 0.0000e+00, 8.5294e-01, 4.1450e+05, 8.8231e-01,
         4.0307e+05, 1.3969e+00],
        [9.6721e-01, 9.9525e-01, 3.9457e+05, 4.0119e+05, 8.1190e-01, 3.8914e+05,
         1.1541e+00, 3.9370e+05, 8.5294e-01, 0.0000e+00, 4.1450e+05, 8.4712e-01,
         4.0309e+05, 1.2748e+00],
        [4.1453e+05, 4.1453e+05, 8.3206e+05, 8.2102e+05, 4.1451e+05, 7.8063e+05,
         4.1454e+05, 7.9950e+05, 4.1450e+05, 4.1450e+05, 0.0000e+00, 4.1455e+05,
         8.0323e+05, 4.1451e+05],
        [9.1509e-01, 9.2084e-01, 3.9457e+05, 4.0120e+05, 7.8039e-01, 3.8912e+05,
         1.0374e+00, 3.9372e+05, 8.8231e-01, 8.4712e-01, 4.1455e+05, 0.0000e+00,
         4.0312e+05, 1.1033e+00],
        [4.0312e+05, 4.0310e+05, 7.8824e+05, 8.1471e+05, 4.0312e+05, 7.9516e+05,
         4.0313e+05, 7.9405e+05, 4.0307e+05, 4.0309e+05, 8.0323e+05, 4.0312e+05,
         0.0000e+00, 4.0312e+05],
        [1.0620e+00, 1.0208e+00, 3.9456e+05, 4.0118e+05, 1.1562e+00, 3.8915e+05,
         1.0397e+00, 3.9373e+05, 1.3969e+00, 1.2748e+00, 4.1451e+05, 1.1033e+00,
         4.0312e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.1509e-01, 9.6721e-01, 9.9392e-01, 9.9495e-01, 1.0497e+00,
        1.0620e+00, 1.1094e+00, 3.8914e+05, 3.9372e+05, 3.9457e+05, 4.0120e+05,
        4.0312e+05, 4.1453e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.1622e-01, 9.2084e-01, 9.9392e-01, 9.9525e-01, 1.0088e+00,
        1.0208e+00, 1.1239e+00, 3.8914e+05, 3.9369e+05, 3.9458e+05, 4.0117e+05,
        4.0310e+05, 4.1453e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394537.6562, 394556.7500, 394566.0312, 394567.2500,
        394568.0000, 394570.8125, 394571.3125, 394577.6875, 786347.7500,
        788243.4375, 796700.8750, 818202.8750, 832061.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 401169.9375, 401177.4688, 401180.5625, 401183.4375,
        401191.0000, 401195.9062, 401195.9375, 401220.9688, 782740.3750,
        799938.9375, 814713.8750, 818202.8750, 821023.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 7.8039e-01, 8.1190e-01, 9.1622e-01, 9.2364e-01, 9.9495e-01,
        1.0512e+00, 1.1562e+00, 3.8912e+05, 3.9371e+05, 3.9457e+05, 4.0118e+05,
        4.0312e+05, 4.1451e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389098.1250, 389116.9375, 389124.5000, 389132.7500,
        389137.9062, 389138.1250, 389144.8125, 389154.5625, 780628.5000,
        786347.7500, 786963.9375, 795158.4375, 799938.9375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0088e+00, 1.0374e+00, 1.0397e+00, 1.0497e+00, 1.0512e+00,
        1.1541e+00, 1.2241e+00, 3.8913e+05, 3.9372e+05, 3.9457e+05, 4.0122e+05,
        4.0313e+05, 4.1454e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393692.9375, 393699.4375, 393703.4375, 393707.5938,
        393715.2812, 393716.1562, 393723.9375, 393728.5625, 782740.3750,
        786963.9375, 794049.8125, 796700.8750, 799500.6875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 8.5294e-01, 8.8231e-01, 9.2364e-01, 1.1094e+00, 1.1239e+00,
        1.2241e+00, 1.3969e+00, 3.8910e+05, 3.9370e+05, 3.9454e+05, 4.0118e+05,
        4.0307e+05, 4.1450e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 8.1190e-01, 8.4712e-01, 8.5294e-01, 9.6721e-01, 9.9525e-01,
        1.1541e+00, 1.2748e+00, 3.8914e+05, 3.9370e+05, 3.9457e+05, 4.0119e+05,
        4.0309e+05, 4.1450e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 414502.9062, 414503.0312, 414510.8750, 414512.0312,
        414527.7188, 414530.1250, 414541.5938, 414545.3750, 780628.5000,
        799500.6875, 803233.4375, 821023.6250, 832061.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 7.8039e-01, 8.4712e-01, 8.8231e-01, 9.1509e-01, 9.2084e-01,
        1.0374e+00, 1.1033e+00, 3.8912e+05, 3.9372e+05, 3.9457e+05, 4.0120e+05,
        4.0312e+05, 4.1455e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 403069.3125, 403091.1875, 403102.5625, 403119.7812,
        403120.2500, 403121.5625, 403124.4375, 403130.5938, 788243.4375,
        794049.8125, 795158.4375, 803233.4375, 814713.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0208e+00, 1.0397e+00, 1.0620e+00, 1.1033e+00, 1.1562e+00,
        1.2748e+00, 1.3969e+00, 3.8915e+05, 3.9373e+05, 3.9456e+05, 4.0118e+05,
        4.0312e+05, 4.1451e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['86985.23', '86982.01', '438095.88', '443583.94', '86982.08', '432630.69', '86984.91', '436936.38', '86978.34', '86983.13', '455200.19', '86982.17', '445902.59', '86987.91']
estimated f for each client, fs: [6, 6, 4, 4, 6, 5, 6, 4, 6, 6, 4, 6, 4, 6]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 19, 17, 9, 20, 8, 15, 4, 3, 13, 11, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0147s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:29:59...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:29:59, End: 2025-07-22 15:29:59)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 8.9459e-01, 8.7316e-01, 3.8277e+05, 8.3403e-01, 8.7372e-01,
         4.0046e+05, 4.1039e+05, 9.4248e-01, 1.2943e+00, 8.2210e-01, 3.8664e+05,
         3.7374e+05, 3.9096e+05, 9.2917e-01, 9.4341e-01],
        [8.9459e-01, 0.0000e+00, 8.8047e-01, 3.8277e+05, 9.1144e-01, 9.6482e-01,
         4.0049e+05, 4.1038e+05, 9.3769e-01, 1.5613e+00, 1.0104e+00, 3.8664e+05,
         3.7375e+05, 3.9096e+05, 9.3319e-01, 1.1246e+00],
        [8.7316e-01, 8.8047e-01, 0.0000e+00, 3.8277e+05, 8.2780e-01, 8.0075e-01,
         4.0045e+05, 4.1038e+05, 8.7667e-01, 1.2911e+00, 8.4600e-01, 3.8663e+05,
         3.7377e+05, 3.9100e+05, 8.7059e-01, 8.9358e-01],
        [3.8277e+05, 3.8277e+05, 3.8277e+05, 0.0000e+00, 3.8276e+05, 3.8276e+05,
         7.7880e+05, 7.7669e+05, 3.8277e+05, 3.8277e+05, 3.8276e+05, 7.8051e+05,
         7.6069e+05, 7.6938e+05, 3.8279e+05, 3.8276e+05],
        [8.3403e-01, 9.1144e-01, 8.2780e-01, 3.8276e+05, 0.0000e+00, 8.1240e-01,
         4.0050e+05, 4.1039e+05, 9.0606e-01, 1.3074e+00, 8.2963e-01, 3.8665e+05,
         3.7377e+05, 3.9094e+05, 8.6451e-01, 9.3286e-01],
        [8.7372e-01, 9.6482e-01, 8.0075e-01, 3.8276e+05, 8.1240e-01, 0.0000e+00,
         4.0048e+05, 4.1042e+05, 9.1107e-01, 1.0039e+00, 6.8467e-01, 3.8662e+05,
         3.7376e+05, 3.9097e+05, 9.9518e-01, 7.1031e-01],
        [4.0046e+05, 4.0049e+05, 4.0045e+05, 7.7880e+05, 4.0050e+05, 4.0048e+05,
         0.0000e+00, 8.1168e+05, 4.0049e+05, 4.0048e+05, 4.0046e+05, 7.6840e+05,
         7.9070e+05, 7.8643e+05, 4.0046e+05, 4.0047e+05],
        [4.1039e+05, 4.1038e+05, 4.1038e+05, 7.7669e+05, 4.1039e+05, 4.1042e+05,
         8.1168e+05, 0.0000e+00, 4.1041e+05, 4.1039e+05, 4.1041e+05, 7.9358e+05,
         7.9313e+05, 7.9246e+05, 4.1041e+05, 4.1042e+05],
        [9.4248e-01, 9.3769e-01, 8.7667e-01, 3.8277e+05, 9.0606e-01, 9.1107e-01,
         4.0049e+05, 4.1041e+05, 0.0000e+00, 1.4055e+00, 9.3719e-01, 3.8664e+05,
         3.7379e+05, 3.9096e+05, 9.3980e-01, 1.0270e+00],
        [1.2943e+00, 1.5613e+00, 1.2911e+00, 3.8277e+05, 1.3074e+00, 1.0039e+00,
         4.0048e+05, 4.1039e+05, 1.4055e+00, 0.0000e+00, 8.4741e-01, 3.8665e+05,
         3.7375e+05, 3.9096e+05, 1.5578e+00, 7.0854e-01],
        [8.2210e-01, 1.0104e+00, 8.4600e-01, 3.8276e+05, 8.2963e-01, 6.8467e-01,
         4.0046e+05, 4.1041e+05, 9.3719e-01, 8.4741e-01, 0.0000e+00, 3.8665e+05,
         3.7376e+05, 3.9093e+05, 1.0422e+00, 5.9775e-01],
        [3.8664e+05, 3.8664e+05, 3.8663e+05, 7.8051e+05, 3.8665e+05, 3.8662e+05,
         7.6840e+05, 7.9358e+05, 3.8664e+05, 3.8665e+05, 3.8665e+05, 0.0000e+00,
         7.6703e+05, 8.0296e+05, 3.8663e+05, 3.8666e+05],
        [3.7374e+05, 3.7375e+05, 3.7377e+05, 7.6069e+05, 3.7377e+05, 3.7376e+05,
         7.9070e+05, 7.9313e+05, 3.7379e+05, 3.7375e+05, 3.7376e+05, 7.6703e+05,
         0.0000e+00, 7.4810e+05, 3.7375e+05, 3.7374e+05],
        [3.9096e+05, 3.9096e+05, 3.9100e+05, 7.6938e+05, 3.9094e+05, 3.9097e+05,
         7.8643e+05, 7.9246e+05, 3.9096e+05, 3.9096e+05, 3.9093e+05, 8.0296e+05,
         7.4810e+05, 0.0000e+00, 3.9096e+05, 3.9096e+05],
        [9.2917e-01, 9.3319e-01, 8.7059e-01, 3.8279e+05, 8.6451e-01, 9.9518e-01,
         4.0046e+05, 4.1041e+05, 9.3980e-01, 1.5578e+00, 1.0422e+00, 3.8663e+05,
         3.7375e+05, 3.9096e+05, 0.0000e+00, 1.1050e+00],
        [9.4341e-01, 1.1246e+00, 8.9358e-01, 3.8276e+05, 9.3286e-01, 7.1031e-01,
         4.0047e+05, 4.1042e+05, 1.0270e+00, 7.0854e-01, 5.9775e-01, 3.8666e+05,
         3.7374e+05, 3.9096e+05, 1.1050e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.2210e-01, 8.3403e-01, 8.7316e-01, 8.7372e-01, 8.9459e-01,
        9.2917e-01, 9.4248e-01, 9.4341e-01, 1.2943e+00, 3.7374e+05, 3.8277e+05,
        3.8664e+05, 3.9096e+05, 4.0046e+05, 4.1039e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8047e-01, 8.9459e-01, 9.1144e-01, 9.3319e-01, 9.3769e-01,
        9.6482e-01, 1.0104e+00, 1.1246e+00, 1.5613e+00, 3.7375e+05, 3.8277e+05,
        3.8664e+05, 3.9096e+05, 4.0049e+05, 4.1038e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0075e-01, 8.2780e-01, 8.4600e-01, 8.7059e-01, 8.7316e-01,
        8.7667e-01, 8.8047e-01, 8.9358e-01, 1.2911e+00, 3.7377e+05, 3.8277e+05,
        3.8663e+05, 3.9100e+05, 4.0045e+05, 4.1038e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382755.7500, 382758.1562, 382759.0000, 382760.8125,
        382767.6250, 382770.3438, 382773.3438, 382774.3750, 382774.5625,
        382789.5000, 760685.6875, 769384.2500, 776693.2500, 778798.8750,
        780513.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.1240e-01, 8.2780e-01, 8.2963e-01, 8.3403e-01, 8.6451e-01,
        9.0606e-01, 9.1144e-01, 9.3286e-01, 1.3074e+00, 3.7377e+05, 3.8276e+05,
        3.8665e+05, 3.9094e+05, 4.0050e+05, 4.1039e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.8467e-01, 7.1031e-01, 8.0075e-01, 8.1240e-01, 8.7372e-01,
        9.1107e-01, 9.6482e-01, 9.9518e-01, 1.0039e+00, 3.7376e+05, 3.8276e+05,
        3.8662e+05, 3.9097e+05, 4.0048e+05, 4.1042e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400448.6875, 400459.3750, 400460.1875, 400460.6875,
        400466.4062, 400475.7188, 400484.2188, 400487.4375, 400491.1250,
        400498.4375, 768396.6875, 778798.8750, 786431.4375, 790702.8125,
        811681.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 410382.7500, 410383.0312, 410387.6875, 410388.0938,
        410391.0938, 410407.5312, 410410.0312, 410411.0625, 410417.1562,
        410421.3125, 776693.2500, 792460.5625, 793134.7500, 793582.8125,
        811681.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7667e-01, 9.0606e-01, 9.1107e-01, 9.3719e-01, 9.3769e-01,
        9.3980e-01, 9.4248e-01, 1.0270e+00, 1.4055e+00, 3.7379e+05, 3.8277e+05,
        3.8664e+05, 3.9096e+05, 4.0049e+05, 4.1041e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.0854e-01, 8.4741e-01, 1.0039e+00, 1.2911e+00, 1.2943e+00,
        1.3074e+00, 1.4055e+00, 1.5578e+00, 1.5613e+00, 3.7375e+05, 3.8277e+05,
        3.8665e+05, 3.9096e+05, 4.0048e+05, 4.1039e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.9775e-01, 6.8467e-01, 8.2210e-01, 8.2963e-01, 8.4600e-01,
        8.4741e-01, 9.3719e-01, 1.0104e+00, 1.0422e+00, 3.7376e+05, 3.8276e+05,
        3.8665e+05, 3.9093e+05, 4.0046e+05, 4.1041e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386624.8125, 386627.1875, 386629.2188, 386635.4688,
        386640.5312, 386642.9688, 386648.5000, 386653.6562, 386654.0625,
        386659.0312, 767025.4375, 768396.6875, 780513.3750, 793582.8125,
        802963.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 373741.4375, 373744.6875, 373746.1562, 373754.3438,
        373754.7188, 373761.4688, 373764.5000, 373765.4375, 373772.3438,
        373791.6875, 748099.2500, 760685.6875, 767025.4375, 790702.8125,
        793134.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390927.8750, 390943.1250, 390955.2188, 390956.2812,
        390957.4375, 390959.2500, 390960.8438, 390964.4062, 390973.2188,
        391000.1250, 748099.2500, 769384.2500, 786431.4375, 792460.5625,
        802963.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6451e-01, 8.7059e-01, 9.2917e-01, 9.3319e-01, 9.3980e-01,
        9.9518e-01, 1.0422e+00, 1.1050e+00, 1.5578e+00, 3.7375e+05, 3.8279e+05,
        3.8663e+05, 3.9096e+05, 4.0046e+05, 4.1041e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.9775e-01, 7.0854e-01, 7.1031e-01, 8.9358e-01, 9.3286e-01,
        9.4341e-01, 1.0270e+00, 1.1050e+00, 1.1246e+00, 3.7374e+05, 3.8276e+05,
        3.8666e+05, 3.9096e+05, 4.0047e+05, 4.1042e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37374.98', '37376.39', '37377.36', '382768.34', '37378.06', '37377.23', '400473.25', '410399.94', '37380.05', '37376.53', '37376.91', '386641.56', '373759.69', '390959.81', '37375.54', '37375.27']
estimated f for each client, fs: [6, 6, 6, 4, 6, 6, 4, 4, 6, 6, 6, 4, 5, 4, 6, 6]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0138s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:00...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:00, End: 2025-07-22 15:30:00)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 16, 6], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.3255e+00, 3.8627e+05, 4.0545e+05, 1.1604e+00, 9.7929e-01,
         3.8657e+05, 3.8980e+05, 1.4263e+00, 4.0296e+05, 8.6881e-01, 3.9237e+05,
         3.8247e+05, 3.9948e+05, 1.4236e+00],
        [1.3255e+00, 0.0000e+00, 3.8625e+05, 4.0542e+05, 9.7775e-01, 1.0625e+00,
         3.8658e+05, 3.8984e+05, 1.0008e+00, 4.0297e+05, 1.1231e+00, 3.9241e+05,
         3.8246e+05, 3.9945e+05, 9.9638e-01],
        [3.8627e+05, 3.8625e+05, 0.0000e+00, 8.0568e+05, 3.8627e+05, 3.8626e+05,
         7.8339e+05, 7.9467e+05, 3.8626e+05, 7.9755e+05, 3.8627e+05, 7.6726e+05,
         7.8150e+05, 7.8537e+05, 3.8626e+05],
        [4.0545e+05, 4.0542e+05, 8.0568e+05, 0.0000e+00, 4.0542e+05, 4.0542e+05,
         7.9568e+05, 7.7854e+05, 4.0546e+05, 7.9264e+05, 4.0542e+05, 7.9348e+05,
         7.6509e+05, 8.3185e+05, 4.0543e+05],
        [1.1604e+00, 9.7775e-01, 3.8627e+05, 4.0542e+05, 0.0000e+00, 9.3601e-01,
         3.8656e+05, 3.8982e+05, 1.0232e+00, 4.0294e+05, 9.5471e-01, 3.9239e+05,
         3.8245e+05, 3.9946e+05, 9.3510e-01],
        [9.7929e-01, 1.0625e+00, 3.8626e+05, 4.0542e+05, 9.3601e-01, 0.0000e+00,
         3.8657e+05, 3.8980e+05, 1.0509e+00, 4.0297e+05, 7.6913e-01, 3.9238e+05,
         3.8246e+05, 3.9945e+05, 1.1163e+00],
        [3.8657e+05, 3.8658e+05, 7.8339e+05, 7.9568e+05, 3.8656e+05, 3.8657e+05,
         0.0000e+00, 7.6974e+05, 3.8654e+05, 8.0676e+05, 3.8659e+05, 7.7680e+05,
         7.8083e+05, 8.0473e+05, 3.8656e+05],
        [3.8980e+05, 3.8984e+05, 7.9467e+05, 7.7854e+05, 3.8982e+05, 3.8980e+05,
         7.6974e+05, 0.0000e+00, 3.8983e+05, 7.7984e+05, 3.8981e+05, 7.8522e+05,
         7.8437e+05, 7.9474e+05, 3.8983e+05],
        [1.4263e+00, 1.0008e+00, 3.8626e+05, 4.0546e+05, 1.0232e+00, 1.0509e+00,
         3.8654e+05, 3.8983e+05, 0.0000e+00, 4.0297e+05, 1.1033e+00, 3.9238e+05,
         3.8245e+05, 3.9947e+05, 1.0199e+00],
        [4.0296e+05, 4.0297e+05, 7.9755e+05, 7.9264e+05, 4.0294e+05, 4.0297e+05,
         8.0676e+05, 7.7984e+05, 4.0297e+05, 0.0000e+00, 4.0297e+05, 7.9717e+05,
         7.8255e+05, 8.1262e+05, 4.0296e+05],
        [8.6881e-01, 1.1231e+00, 3.8627e+05, 4.0542e+05, 9.5471e-01, 7.6913e-01,
         3.8659e+05, 3.8981e+05, 1.1033e+00, 4.0297e+05, 0.0000e+00, 3.9238e+05,
         3.8246e+05, 3.9946e+05, 1.1845e+00],
        [3.9237e+05, 3.9241e+05, 7.6726e+05, 7.9348e+05, 3.9239e+05, 3.9238e+05,
         7.7680e+05, 7.8522e+05, 3.9238e+05, 7.9717e+05, 3.9238e+05, 0.0000e+00,
         7.9356e+05, 7.7788e+05, 3.9237e+05],
        [3.8247e+05, 3.8246e+05, 7.8150e+05, 7.6509e+05, 3.8245e+05, 3.8246e+05,
         7.8083e+05, 7.8437e+05, 3.8245e+05, 7.8255e+05, 3.8246e+05, 7.9356e+05,
         0.0000e+00, 7.8745e+05, 3.8245e+05],
        [3.9948e+05, 3.9945e+05, 7.8537e+05, 8.3185e+05, 3.9946e+05, 3.9945e+05,
         8.0473e+05, 7.9474e+05, 3.9947e+05, 8.1262e+05, 3.9946e+05, 7.7788e+05,
         7.8745e+05, 0.0000e+00, 3.9944e+05],
        [1.4236e+00, 9.9638e-01, 3.8626e+05, 4.0543e+05, 9.3510e-01, 1.1163e+00,
         3.8656e+05, 3.8983e+05, 1.0199e+00, 4.0296e+05, 1.1845e+00, 3.9237e+05,
         3.8245e+05, 3.9944e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.6881e-01, 9.7929e-01, 1.1604e+00, 1.3255e+00, 1.4236e+00,
        1.4263e+00, 3.8247e+05, 3.8627e+05, 3.8657e+05, 3.8980e+05, 3.9237e+05,
        3.9948e+05, 4.0296e+05, 4.0545e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.7775e-01, 9.9638e-01, 1.0008e+00, 1.0625e+00, 1.1231e+00,
        1.3255e+00, 3.8246e+05, 3.8625e+05, 3.8658e+05, 3.8984e+05, 3.9241e+05,
        3.9945e+05, 4.0297e+05, 4.0542e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386247.4688, 386256.1875, 386261.8750, 386263.0625,
        386266.7188, 386269.5625, 386270.6875, 767263.3750, 781501.0625,
        783391.9375, 785374.5625, 794670.0000, 797554.6250, 805681.4375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 405419.0938, 405420.2188, 405420.3125, 405421.3125,
        405428.3750, 405445.6875, 405462.6250, 765086.6250, 778538.9375,
        792640.1250, 793484.3750, 795679.2500, 805681.4375, 831848.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.3510e-01, 9.3601e-01, 9.5471e-01, 9.7775e-01, 1.0232e+00,
        1.1604e+00, 3.8245e+05, 3.8627e+05, 3.8656e+05, 3.8982e+05, 3.9239e+05,
        3.9946e+05, 4.0294e+05, 4.0542e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 7.6913e-01, 9.3601e-01, 9.7929e-01, 1.0509e+00, 1.0625e+00,
        1.1163e+00, 3.8246e+05, 3.8626e+05, 3.8657e+05, 3.8980e+05, 3.9238e+05,
        3.9945e+05, 4.0297e+05, 4.0542e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386537.9375, 386556.5000, 386559.1875, 386568.0312,
        386571.5312, 386575.8438, 386588.1562, 769744.7500, 776797.7500,
        780834.1250, 783391.9375, 795679.2500, 804731.9375, 806755.9375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389802.3438, 389804.2500, 389813.4375, 389820.1250,
        389825.2188, 389830.5000, 389835.2188, 769744.7500, 778538.9375,
        779838.6875, 784374.7500, 785215.1250, 794670.0000, 794735.4375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0008e+00, 1.0199e+00, 1.0232e+00, 1.0509e+00, 1.1033e+00,
        1.4263e+00, 3.8245e+05, 3.8626e+05, 3.8654e+05, 3.8983e+05, 3.9238e+05,
        3.9947e+05, 4.0297e+05, 4.0546e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 402939.7812, 402957.1562, 402958.1562, 402965.6562,
        402969.4062, 402970.0312, 402970.1250, 779838.6875, 782547.1250,
        792640.1250, 797168.6250, 797554.6250, 806755.9375, 812623.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 7.6913e-01, 8.6881e-01, 9.5471e-01, 1.1033e+00, 1.1231e+00,
        1.1845e+00, 3.8246e+05, 3.8627e+05, 3.8659e+05, 3.8981e+05, 3.9238e+05,
        3.9946e+05, 4.0297e+05, 4.0542e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 392371.2500, 392373.6250, 392376.6875, 392377.1562,
        392383.8125, 392392.5000, 392408.3438, 767263.3750, 776797.7500,
        777882.5000, 785215.1250, 793484.3750, 793559.8750, 797168.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 382445.3438, 382447.5938, 382453.6250, 382455.9688,
        382458.5000, 382464.6562, 382473.6875, 765086.6250, 780834.1250,
        781501.0625, 782547.1250, 784374.7500, 787450.9375, 793559.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 399444.6250, 399446.6875, 399452.3125, 399455.2812,
        399456.9375, 399474.5625, 399475.1875, 777882.5000, 785374.5625,
        787450.9375, 794735.4375, 804731.9375, 812623.0625, 831848.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 9.3510e-01, 9.9638e-01, 1.0199e+00, 1.1163e+00, 1.1845e+00,
        1.4236e+00, 3.8245e+05, 3.8626e+05, 3.8656e+05, 3.8983e+05, 3.9237e+05,
        3.9944e+05, 4.0296e+05, 4.0543e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['128368.72', '128365.07', '472511.12', '486849.25', '128365.06', '128367.25', '472499.97', '475223.88', '128360.69', '487012.91', '128369.27', '476749.41', '469235.56', '484384.78', '128363.64']
estimated f for each client, fs: [5, 5, 6, 5, 5, 5, 6, 5, 5, 5, 5, 5, 7, 5, 5]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0123s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:00...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[189  48]
 [ 75 188]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:00, End: 2025-07-22 15:30:00)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 7, 19, 17, 20, 18, 4, 3, 14, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 1.2038e+00, 3.8490e+05, 3.9098e+05, 3.8838e+05, 3.9261e+05,
         9.2646e-01, 8.5784e-01, 4.0966e+05, 8.7892e-01, 3.9631e+05, 1.3412e+00,
         9.0504e-01],
        [1.2038e+00, 0.0000e+00, 3.8488e+05, 3.9098e+05, 3.8837e+05, 3.9263e+05,
         1.5630e+00, 1.2759e+00, 4.0961e+05, 1.3554e+00, 3.9632e+05, 1.1315e+00,
         1.5101e+00],
        [3.8490e+05, 3.8488e+05, 0.0000e+00, 7.7664e+05, 7.6754e+05, 7.9138e+05,
         3.8492e+05, 3.8491e+05, 7.9721e+05, 3.8492e+05, 7.7817e+05, 3.8492e+05,
         3.8491e+05],
        [3.9098e+05, 3.9098e+05, 7.7664e+05, 0.0000e+00, 7.5527e+05, 8.0537e+05,
         3.9096e+05, 3.9097e+05, 8.2514e+05, 3.9098e+05, 8.0216e+05, 3.9098e+05,
         3.9099e+05],
        [3.8838e+05, 3.8837e+05, 7.6754e+05, 7.5527e+05, 0.0000e+00, 7.7142e+05,
         3.8836e+05, 3.8839e+05, 8.0120e+05, 3.8837e+05, 8.0185e+05, 3.8835e+05,
         3.8836e+05],
        [3.9261e+05, 3.9263e+05, 7.9138e+05, 8.0537e+05, 7.7142e+05, 0.0000e+00,
         3.9261e+05, 3.9263e+05, 8.0943e+05, 3.9260e+05, 7.9853e+05, 3.9264e+05,
         3.9263e+05],
        [9.2646e-01, 1.5630e+00, 3.8492e+05, 3.9096e+05, 3.8836e+05, 3.9261e+05,
         0.0000e+00, 8.7960e-01, 4.0966e+05, 8.1212e-01, 3.9630e+05, 1.6541e+00,
         7.8204e-01],
        [8.5784e-01, 1.2759e+00, 3.8491e+05, 3.9097e+05, 3.8839e+05, 3.9263e+05,
         8.7960e-01, 0.0000e+00, 4.0966e+05, 7.8093e-01, 3.9633e+05, 1.3586e+00,
         8.2177e-01],
        [4.0966e+05, 4.0961e+05, 7.9721e+05, 8.2514e+05, 8.0120e+05, 8.0943e+05,
         4.0966e+05, 4.0966e+05, 0.0000e+00, 4.0966e+05, 8.1022e+05, 4.0960e+05,
         4.0965e+05],
        [8.7892e-01, 1.3554e+00, 3.8492e+05, 3.9098e+05, 3.8837e+05, 3.9260e+05,
         8.1212e-01, 7.8093e-01, 4.0966e+05, 0.0000e+00, 3.9632e+05, 1.4555e+00,
         7.9111e-01],
        [3.9631e+05, 3.9632e+05, 7.7817e+05, 8.0216e+05, 8.0185e+05, 7.9853e+05,
         3.9630e+05, 3.9633e+05, 8.1022e+05, 3.9632e+05, 0.0000e+00, 3.9634e+05,
         3.9629e+05],
        [1.3412e+00, 1.1315e+00, 3.8492e+05, 3.9098e+05, 3.8835e+05, 3.9264e+05,
         1.6541e+00, 1.3586e+00, 4.0960e+05, 1.4555e+00, 3.9634e+05, 0.0000e+00,
         1.5278e+00],
        [9.0504e-01, 1.5101e+00, 3.8491e+05, 3.9099e+05, 3.8836e+05, 3.9263e+05,
         7.8204e-01, 8.2177e-01, 4.0965e+05, 7.9111e-01, 3.9629e+05, 1.5278e+00,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.5784e-01, 8.7892e-01, 9.0504e-01, 9.2646e-01, 1.2038e+00,
        1.3412e+00, 3.8490e+05, 3.8838e+05, 3.9098e+05, 3.9261e+05, 3.9631e+05,
        4.0966e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1315e+00, 1.2038e+00, 1.2759e+00, 1.3554e+00, 1.5101e+00,
        1.5630e+00, 3.8488e+05, 3.8837e+05, 3.9098e+05, 3.9263e+05, 3.9632e+05,
        4.0961e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 384883.8750, 384904.2500, 384907.7188, 384911.3125,
        384919.7188, 384922.6250, 384922.9375, 767538.7500, 776640.7500,
        778173.1250, 791375.5000, 797207.8125])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 390961.8125, 390972.8125, 390975.5000, 390981.8438,
        390982.3750, 390984.8750, 390985.7812, 755268.2500, 776640.7500,
        802161.9375, 805365.9375, 825142.5000])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 388347.0625, 388357.6250, 388363.0938, 388368.4375,
        388371.7188, 388384.6875, 388389.3750, 755268.2500, 767538.7500,
        771420.6875, 801203.9375, 801854.3125])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 392603.1250, 392606.4375, 392614.7188, 392626.6250,
        392632.6562, 392634.7500, 392639.5938, 771420.6875, 791375.5000,
        798529.8750, 805365.9375, 809431.0625])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 7.8204e-01, 8.1212e-01, 8.7960e-01, 9.2646e-01, 1.5630e+00,
        1.6541e+00, 3.8492e+05, 3.8836e+05, 3.9096e+05, 3.9261e+05, 3.9630e+05,
        4.0966e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 7.8093e-01, 8.2177e-01, 8.5784e-01, 8.7960e-01, 1.2759e+00,
        1.3586e+00, 3.8491e+05, 3.8839e+05, 3.9097e+05, 3.9263e+05, 3.9633e+05,
        4.0966e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 409596.8125, 409614.3438, 409649.6250, 409657.7500,
        409659.9062, 409662.2812, 409663.1250, 797207.8125, 801203.9375,
        809431.0625, 810215.6875, 825142.5000])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 7.8093e-01, 7.9111e-01, 8.1212e-01, 8.7892e-01, 1.3554e+00,
        1.4555e+00, 3.8492e+05, 3.8837e+05, 3.9098e+05, 3.9260e+05, 3.9632e+05,
        4.0966e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 396291.3438, 396301.2188, 396313.2812, 396316.0625,
        396318.5625, 396328.3438, 396338.7812, 778173.1250, 798529.8750,
        801854.3125, 802161.9375, 810215.6875])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1315e+00, 1.3412e+00, 1.3586e+00, 1.4555e+00, 1.5278e+00,
        1.6541e+00, 3.8492e+05, 3.8835e+05, 3.9098e+05, 3.9264e+05, 3.9634e+05,
        4.0960e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 7.8204e-01, 7.9111e-01, 8.2177e-01, 9.0504e-01, 1.5101e+00,
        1.5278e+00, 3.8491e+05, 3.8836e+05, 3.9099e+05, 3.9263e+05, 3.9629e+05,
        4.0965e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['96661.88', '96657.95', '432738.91', '436514.12', '434231.25', '439972.34', '96661.55', '96662.88', '458088.97', '96662.18', '444047.59', '96659.41', '96659.41']
estimated f for each client, fs: [6, 6, 4, 4, 4, 4, 6, 6, 4, 6, 4, 6, 6]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 7, 19, 17, 20, 18, 4, 3, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0079s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:01...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:30:01, End: 2025-07-22 15:30:01)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 7, 2, 19, 17, 1, 9, 15, 4, 3, 14, 11, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 1.1715e+00, 1.2542e+00, 3.9479e+05, 3.9287e+05, 1.2340e+00,
         1.1121e+00, 3.9112e+05, 1.0190e+00, 1.0075e+00, 3.9061e+05, 1.0308e+00,
         9.4164e-01],
        [1.1715e+00, 0.0000e+00, 1.2358e+00, 3.9480e+05, 3.9284e+05, 1.3700e+00,
         1.1809e+00, 3.9113e+05, 1.1534e+00, 1.1910e+00, 3.9060e+05, 1.1345e+00,
         1.1366e+00],
        [1.2542e+00, 1.2358e+00, 0.0000e+00, 3.9482e+05, 3.9287e+05, 1.1332e+00,
         1.1677e+00, 3.9115e+05, 1.2782e+00, 1.1562e+00, 3.9062e+05, 1.1393e+00,
         1.2212e+00],
        [3.9479e+05, 3.9480e+05, 3.9482e+05, 0.0000e+00, 8.0776e+05, 3.9481e+05,
         3.9480e+05, 7.9560e+05, 3.9481e+05, 3.9478e+05, 7.9307e+05, 3.9482e+05,
         3.9479e+05],
        [3.9287e+05, 3.9284e+05, 3.9287e+05, 8.0776e+05, 0.0000e+00, 3.9286e+05,
         3.9287e+05, 7.8447e+05, 3.9284e+05, 3.9288e+05, 7.8536e+05, 3.9286e+05,
         3.9288e+05],
        [1.2340e+00, 1.3700e+00, 1.1332e+00, 3.9481e+05, 3.9286e+05, 0.0000e+00,
         1.1560e+00, 3.9111e+05, 1.3962e+00, 1.2168e+00, 3.9061e+05, 1.1701e+00,
         1.3097e+00],
        [1.1121e+00, 1.1809e+00, 1.1677e+00, 3.9480e+05, 3.9287e+05, 1.1560e+00,
         0.0000e+00, 3.9114e+05, 1.0804e+00, 1.0552e+00, 3.9061e+05, 1.0167e+00,
         1.0095e+00],
        [3.9112e+05, 3.9113e+05, 3.9115e+05, 7.9560e+05, 7.8447e+05, 3.9111e+05,
         3.9114e+05, 0.0000e+00, 3.9114e+05, 3.9115e+05, 7.7568e+05, 3.9113e+05,
         3.9115e+05],
        [1.0190e+00, 1.1534e+00, 1.2782e+00, 3.9481e+05, 3.9284e+05, 1.3962e+00,
         1.0804e+00, 3.9114e+05, 0.0000e+00, 9.5654e-01, 3.9062e+05, 1.0402e+00,
         8.4046e-01],
        [1.0075e+00, 1.1910e+00, 1.1562e+00, 3.9478e+05, 3.9288e+05, 1.2168e+00,
         1.0552e+00, 3.9115e+05, 9.5654e-01, 0.0000e+00, 3.9062e+05, 1.1090e+00,
         9.0456e-01],
        [3.9061e+05, 3.9060e+05, 3.9062e+05, 7.9307e+05, 7.8536e+05, 3.9061e+05,
         3.9061e+05, 7.7568e+05, 3.9062e+05, 3.9062e+05, 0.0000e+00, 3.9061e+05,
         3.9063e+05],
        [1.0308e+00, 1.1345e+00, 1.1393e+00, 3.9482e+05, 3.9286e+05, 1.1701e+00,
         1.0167e+00, 3.9113e+05, 1.0402e+00, 1.1090e+00, 3.9061e+05, 0.0000e+00,
         1.0273e+00],
        [9.4164e-01, 1.1366e+00, 1.2212e+00, 3.9479e+05, 3.9288e+05, 1.3097e+00,
         1.0095e+00, 3.9115e+05, 8.4046e-01, 9.0456e-01, 3.9063e+05, 1.0273e+00,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.4164e-01, 1.0075e+00, 1.0190e+00, 1.0308e+00, 1.1121e+00,
        1.1715e+00, 1.2340e+00, 1.2542e+00, 3.9061e+05, 3.9112e+05, 3.9287e+05,
        3.9479e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1345e+00, 1.1366e+00, 1.1534e+00, 1.1715e+00, 1.1809e+00,
        1.1910e+00, 1.2358e+00, 1.3700e+00, 3.9060e+05, 3.9113e+05, 3.9284e+05,
        3.9480e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1332e+00, 1.1393e+00, 1.1562e+00, 1.1677e+00, 1.2212e+00,
        1.2358e+00, 1.2542e+00, 1.2782e+00, 3.9062e+05, 3.9115e+05, 3.9287e+05,
        3.9482e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 394783.0000, 394791.5312, 394793.6562, 394797.8750,
        394799.4062, 394812.7500, 394814.2500, 394820.2500, 394822.8438,
        793071.0625, 795604.5625, 807755.6250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 392843.1250, 392844.0000, 392861.3750, 392862.9688,
        392865.6875, 392867.0000, 392867.2500, 392878.8750, 392880.5938,
        784465.2500, 785363.1875, 807755.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1332e+00, 1.1560e+00, 1.1701e+00, 1.2168e+00, 1.2340e+00,
        1.3097e+00, 1.3700e+00, 1.3962e+00, 3.9061e+05, 3.9111e+05, 3.9286e+05,
        3.9481e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.0095e+00, 1.0167e+00, 1.0552e+00, 1.0804e+00, 1.1121e+00,
        1.1560e+00, 1.1677e+00, 1.1809e+00, 3.9061e+05, 3.9114e+05, 3.9287e+05,
        3.9480e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 391112.3125, 391123.0625, 391125.7500, 391129.6250,
        391135.2188, 391142.3438, 391147.0312, 391148.6562, 391154.6875,
        775678.2500, 784465.2500, 795604.5625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 8.4046e-01, 9.5654e-01, 1.0190e+00, 1.0402e+00, 1.0804e+00,
        1.1534e+00, 1.2782e+00, 1.3962e+00, 3.9062e+05, 3.9114e+05, 3.9284e+05,
        3.9481e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 9.0456e-01, 9.5654e-01, 1.0075e+00, 1.0552e+00, 1.1090e+00,
        1.1562e+00, 1.1910e+00, 1.2168e+00, 3.9062e+05, 3.9115e+05, 3.9288e+05,
        3.9478e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 390600.6562, 390608.7812, 390609.6875, 390612.3438,
        390614.2812, 390616.7188, 390619.9688, 390620.7812, 390630.1250,
        775678.2500, 785363.1875, 793071.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0167e+00, 1.0273e+00, 1.0308e+00, 1.0402e+00, 1.1090e+00,
        1.1345e+00, 1.1393e+00, 1.1701e+00, 3.9061e+05, 3.9113e+05, 3.9286e+05,
        3.9482e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 8.4046e-01, 9.0456e-01, 9.4164e-01, 1.0095e+00, 1.0273e+00,
        1.1366e+00, 1.2212e+00, 1.3097e+00, 3.9063e+05, 3.9115e+05, 3.9288e+05,
        3.9479e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['1.10', '1.20', '1.20', '394801.59', '392863.41', '1.25', '1.10', '391135.41', '1.10', '1.07', '390614.81', '1.08', '1.05']
estimated f for each client, fs: [4, 4, 4, 4, 2, 4, 4, 2, 4, 4, 2, 4, 4]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 15, 4, 3, 14, 11, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0087s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:01...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [ 76 187]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:01, End: 2025-07-22 15:30:01)
start time is: 97165953591154, end time is: 97183784216782
The total time is: 17830625628ns.

 ------- aggregate method: rkrum, random_seed: 400 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 19, 17, 1, 18, 15, 4, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.9042e+00, 4.0203e+05, 3.8702e+05, 4.4521e+00, 3.8657e+05,
         3.8793e+05, 4.2120e+00, 3.8881e+05, 4.1921e+00, 4.2974e+00, 3.8817e+05,
         4.6164e+00, 4.2701e+00],
        [3.9042e+00, 0.0000e+00, 4.0204e+05, 3.8709e+05, 4.2723e+00, 3.8660e+05,
         3.8791e+05, 3.6665e+00, 3.8881e+05, 4.0366e+00, 4.0966e+00, 3.8814e+05,
         4.3993e+00, 4.0285e+00],
        [4.0203e+05, 4.0204e+05, 0.0000e+00, 7.7712e+05, 4.0204e+05, 7.8334e+05,
         7.7618e+05, 4.0201e+05, 7.7146e+05, 4.0202e+05, 4.0201e+05, 7.9011e+05,
         4.0204e+05, 4.0197e+05],
        [3.8702e+05, 3.8709e+05, 7.7712e+05, 0.0000e+00, 3.8708e+05, 7.8984e+05,
         7.9574e+05, 3.8707e+05, 7.7642e+05, 3.8701e+05, 3.8707e+05, 7.6599e+05,
         3.8712e+05, 3.8707e+05],
        [4.4521e+00, 4.2723e+00, 4.0204e+05, 3.8708e+05, 0.0000e+00, 3.8661e+05,
         3.8790e+05, 4.1030e+00, 3.8877e+05, 4.3000e+00, 4.3793e+00, 3.8810e+05,
         4.5585e+00, 4.4926e+00],
        [3.8657e+05, 3.8660e+05, 7.8334e+05, 7.8984e+05, 3.8661e+05, 0.0000e+00,
         7.8931e+05, 3.8658e+05, 7.7065e+05, 3.8658e+05, 3.8660e+05, 7.6659e+05,
         3.8658e+05, 3.8663e+05],
        [3.8793e+05, 3.8791e+05, 7.7618e+05, 7.9574e+05, 3.8790e+05, 7.8931e+05,
         0.0000e+00, 3.8795e+05, 7.9834e+05, 3.8791e+05, 3.8792e+05, 7.6400e+05,
         3.8789e+05, 3.8796e+05],
        [4.2120e+00, 3.6665e+00, 4.0201e+05, 3.8707e+05, 4.1030e+00, 3.8658e+05,
         3.8795e+05, 0.0000e+00, 3.8882e+05, 4.0056e+00, 4.2586e+00, 3.8813e+05,
         4.3839e+00, 3.9820e+00],
        [3.8881e+05, 3.8881e+05, 7.7146e+05, 7.7642e+05, 3.8877e+05, 7.7065e+05,
         7.9834e+05, 3.8882e+05, 0.0000e+00, 3.8879e+05, 3.8880e+05, 7.7807e+05,
         3.8883e+05, 3.8881e+05],
        [4.1921e+00, 4.0366e+00, 4.0202e+05, 3.8701e+05, 4.3000e+00, 3.8658e+05,
         3.8791e+05, 4.0056e+00, 3.8879e+05, 0.0000e+00, 4.0584e+00, 3.8810e+05,
         4.6289e+00, 4.0788e+00],
        [4.2974e+00, 4.0966e+00, 4.0201e+05, 3.8707e+05, 4.3793e+00, 3.8660e+05,
         3.8792e+05, 4.2586e+00, 3.8880e+05, 4.0584e+00, 0.0000e+00, 3.8812e+05,
         4.4074e+00, 4.0654e+00],
        [3.8817e+05, 3.8814e+05, 7.9011e+05, 7.6599e+05, 3.8810e+05, 7.6659e+05,
         7.6400e+05, 3.8813e+05, 7.7807e+05, 3.8810e+05, 3.8812e+05, 0.0000e+00,
         3.8809e+05, 3.8815e+05],
        [4.6164e+00, 4.3993e+00, 4.0204e+05, 3.8712e+05, 4.5585e+00, 3.8658e+05,
         3.8789e+05, 4.3839e+00, 3.8883e+05, 4.6289e+00, 4.4074e+00, 3.8809e+05,
         0.0000e+00, 4.5724e+00],
        [4.2701e+00, 4.0285e+00, 4.0197e+05, 3.8707e+05, 4.4926e+00, 3.8663e+05,
         3.8796e+05, 3.9820e+00, 3.8881e+05, 4.0788e+00, 4.0654e+00, 3.8815e+05,
         4.5724e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 3.9042e+00, 4.1921e+00, 4.2120e+00, 4.2701e+00, 4.2974e+00,
        4.4521e+00, 4.6164e+00, 3.8657e+05, 3.8702e+05, 3.8793e+05, 3.8817e+05,
        3.8881e+05, 4.0203e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.6665e+00, 3.9042e+00, 4.0285e+00, 4.0366e+00, 4.0966e+00,
        4.2723e+00, 4.3993e+00, 3.8660e+05, 3.8709e+05, 3.8791e+05, 3.8814e+05,
        3.8881e+05, 4.0204e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 401969.5938, 402011.9688, 402014.1562, 402015.5000,
        402034.1250, 402035.0625, 402038.3750, 402040.9688, 771457.2500,
        776175.5000, 777122.1875, 783339.1250, 790111.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387005.0625, 387024.9688, 387066.5625, 387067.5312,
        387070.2188, 387077.2188, 387090.0625, 387116.6250, 765986.6875,
        776420.0625, 777122.1875, 789835.0625, 795736.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 4.1030e+00, 4.2723e+00, 4.3000e+00, 4.3793e+00, 4.4521e+00,
        4.4926e+00, 4.5585e+00, 3.8661e+05, 3.8708e+05, 3.8790e+05, 3.8810e+05,
        3.8877e+05, 4.0204e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386566.6875, 386578.1875, 386578.9062, 386584.0938,
        386601.1250, 386601.4062, 386614.5625, 386627.6250, 766590.4375,
        770645.3125, 783339.1250, 789314.8750, 789835.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387892.9688, 387900.5000, 387906.9062, 387908.6562,
        387922.8750, 387926.0000, 387947.4375, 387960.3438, 764002.0000,
        776175.5000, 789314.8750, 795736.0000, 798340.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.6665e+00, 3.9820e+00, 4.0056e+00, 4.1030e+00, 4.2120e+00,
        4.2586e+00, 4.3839e+00, 3.8658e+05, 3.8707e+05, 3.8795e+05, 3.8813e+05,
        3.8882e+05, 4.0201e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388770.7188, 388788.2812, 388802.5938, 388810.6875,
        388810.8438, 388813.0000, 388822.3750, 388831.0625, 770645.3125,
        771457.2500, 776420.0625, 778068.1875, 798340.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 4.0056e+00, 4.0366e+00, 4.0584e+00, 4.0788e+00, 4.1921e+00,
        4.3000e+00, 4.6289e+00, 3.8658e+05, 3.8701e+05, 3.8791e+05, 3.8810e+05,
        3.8879e+05, 4.0202e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 4.0584e+00, 4.0654e+00, 4.0966e+00, 4.2586e+00, 4.2974e+00,
        4.3793e+00, 4.4074e+00, 3.8660e+05, 3.8707e+05, 3.8792e+05, 3.8812e+05,
        3.8880e+05, 4.0201e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388092.9062, 388095.8125, 388101.8125, 388118.0938,
        388127.1875, 388136.9375, 388154.1562, 388170.7812, 764002.0000,
        765986.6875, 766590.4375, 778068.1875, 790111.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 4.3839e+00, 4.3993e+00, 4.4074e+00, 4.5585e+00, 4.5724e+00,
        4.6164e+00, 4.6289e+00, 3.8658e+05, 3.8712e+05, 3.8789e+05, 3.8809e+05,
        3.8883e+05, 4.0204e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 3.9820e+00, 4.0285e+00, 4.0654e+00, 4.0788e+00, 4.2701e+00,
        4.4926e+00, 4.5724e+00, 3.8663e+05, 3.8707e+05, 3.8796e+05, 3.8815e+05,
        3.8881e+05, 4.0197e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['85957.95', '85968.84', '443068.50', '429167.25', '85969.14', '428815.88', '429707.50', '85964.77', '431232.72', '85957.02', '85966.38', '429888.81', '85969.59', '85969.40']
estimated f for each client, fs: [6, 6, 4, 4, 6, 4, 4, 6, 4, 6, 6, 4, 6, 6]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 19, 17, 1, 18, 15, 4, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0089s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:02...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:02, End: 2025-07-22 15:30:02)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [5, 7, 19, 17, 1, 20, 8, 3, 13, 14, 10, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 2.0704e+00, 3.8794e+05, 3.8457e+05, 2.3271e+00, 3.8761e+05,
         2.4549e+00, 2.1788e+00, 3.6635e+05, 3.8915e+05, 2.2471e+00, 2.3328e+00],
        [2.0704e+00, 0.0000e+00, 3.8796e+05, 3.8453e+05, 2.3650e+00, 3.8765e+05,
         2.3773e+00, 2.1587e+00, 3.6635e+05, 3.8914e+05, 2.1688e+00, 2.5549e+00],
        [3.8794e+05, 3.8796e+05, 0.0000e+00, 7.8573e+05, 3.8793e+05, 7.9094e+05,
         3.8796e+05, 3.8792e+05, 7.5753e+05, 7.9357e+05, 3.8791e+05, 3.8793e+05],
        [3.8457e+05, 3.8453e+05, 7.8573e+05, 0.0000e+00, 3.8454e+05, 7.6381e+05,
         3.8450e+05, 3.8455e+05, 7.4069e+05, 7.7613e+05, 3.8454e+05, 3.8454e+05],
        [2.3271e+00, 2.3650e+00, 3.8793e+05, 3.8454e+05, 0.0000e+00, 3.8763e+05,
         2.5470e+00, 2.3511e+00, 3.6636e+05, 3.8914e+05, 2.1282e+00, 2.3353e+00],
        [3.8761e+05, 3.8765e+05, 7.9094e+05, 7.6381e+05, 3.8763e+05, 0.0000e+00,
         3.8765e+05, 3.8763e+05, 7.3970e+05, 7.7658e+05, 3.8766e+05, 3.8762e+05],
        [2.4549e+00, 2.3773e+00, 3.8796e+05, 3.8450e+05, 2.5470e+00, 3.8765e+05,
         0.0000e+00, 2.2540e+00, 3.6633e+05, 3.8911e+05, 2.1491e+00, 2.3232e+00],
        [2.1788e+00, 2.1587e+00, 3.8792e+05, 3.8455e+05, 2.3511e+00, 3.8763e+05,
         2.2540e+00, 0.0000e+00, 3.6636e+05, 3.8914e+05, 2.0458e+00, 2.4331e+00],
        [3.6635e+05, 3.6635e+05, 7.5753e+05, 7.4069e+05, 3.6636e+05, 7.3970e+05,
         3.6633e+05, 3.6636e+05, 0.0000e+00, 7.6836e+05, 3.6634e+05, 3.6631e+05],
        [3.8915e+05, 3.8914e+05, 7.9357e+05, 7.7613e+05, 3.8914e+05, 7.7658e+05,
         3.8911e+05, 3.8914e+05, 7.6836e+05, 0.0000e+00, 3.8912e+05, 3.8916e+05],
        [2.2471e+00, 2.1688e+00, 3.8791e+05, 3.8454e+05, 2.1282e+00, 3.8766e+05,
         2.1491e+00, 2.0458e+00, 3.6634e+05, 3.8912e+05, 0.0000e+00, 2.2153e+00],
        [2.3328e+00, 2.5549e+00, 3.8793e+05, 3.8454e+05, 2.3353e+00, 3.8762e+05,
         2.3232e+00, 2.4331e+00, 3.6631e+05, 3.8916e+05, 2.2153e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 2.0704e+00, 2.1788e+00, 2.2471e+00, 2.3271e+00, 2.3328e+00,
        2.4549e+00, 3.6635e+05, 3.8457e+05, 3.8761e+05, 3.8794e+05, 3.8915e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 2.0704e+00, 2.1587e+00, 2.1688e+00, 2.3650e+00, 2.3773e+00,
        2.5549e+00, 3.6635e+05, 3.8453e+05, 3.8765e+05, 3.8796e+05, 3.8914e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 387913.6875, 387917.8750, 387928.8438, 387931.4062,
        387937.3125, 387958.0625, 387958.4062, 757528.7500, 785734.1250,
        790940.1875, 793571.8125])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 384497.3438, 384526.7812, 384537.1875, 384539.5000,
        384544.2188, 384547.1562, 384572.3438, 740691.2500, 763812.0000,
        776130.8750, 785734.1250])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 2.1282e+00, 2.3271e+00, 2.3353e+00, 2.3511e+00, 2.3650e+00,
        2.5470e+00, 3.6636e+05, 3.8454e+05, 3.8763e+05, 3.8793e+05, 3.8914e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 387609.7188, 387617.0000, 387626.4062, 387628.1875,
        387645.9062, 387647.2812, 387661.7500, 739702.3750, 763812.0000,
        776582.7500, 790940.1875])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 2.1491e+00, 2.2540e+00, 2.3232e+00, 2.3773e+00, 2.4549e+00,
        2.5470e+00, 3.6633e+05, 3.8450e+05, 3.8765e+05, 3.8796e+05, 3.8911e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 2.0458e+00, 2.1587e+00, 2.1788e+00, 2.2540e+00, 2.3511e+00,
        2.4331e+00, 3.6636e+05, 3.8455e+05, 3.8763e+05, 3.8792e+05, 3.8914e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 366311.9688, 366327.8750, 366340.0625, 366351.0000,
        366352.6875, 366356.5625, 366362.1250, 739702.3750, 740691.2500,
        757528.7500, 768364.8125])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 389113.2812, 389122.4062, 389135.0938, 389141.9375,
        389144.7500, 389149.5625, 389155.7500, 768364.8125, 776130.8750,
        776582.7500, 793571.8125])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 2.0458e+00, 2.1282e+00, 2.1491e+00, 2.1688e+00, 2.2153e+00,
        2.2471e+00, 3.6634e+05, 3.8454e+05, 3.8766e+05, 3.8791e+05, 3.8912e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 2.2153e+00, 2.3232e+00, 2.3328e+00, 2.3353e+00, 2.4331e+00,
        2.5549e+00, 3.6631e+05, 3.8454e+05, 3.8762e+05, 3.8793e+05, 3.8916e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['93867.34', '93861.44', '434134.34', '429057.03', '93865.06', '431642.38', '93854.92', '93864.65', '413013.12', '436541.00', '93861.29', '93858.22']
estimated f for each client, fs: [5, 5, 3, 3, 5, 3, 5, 5, 4, 3, 5, 5]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [5, 7, 19, 17, 1, 20, 8, 3, 13, 14, 10, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0088s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:02...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:30:02, End: 2025-07-22 15:30:02)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 17, 1, 9, 20, 18, 8, 3, 13, 14, 11, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 4.0232e+05, 1.8304e+00, 1.9076e+00, 3.9513e+05, 3.8467e+05,
         2.2948e+00, 1.8862e+00, 3.9103e+05, 3.8592e+05, 1.7167e+00, 1.8743e+00,
         3.9167e+05, 1.9209e+00],
        [4.0232e+05, 0.0000e+00, 4.0233e+05, 4.0235e+05, 7.9957e+05, 7.9230e+05,
         4.0234e+05, 4.0233e+05, 7.9971e+05, 7.9994e+05, 4.0231e+05, 4.0233e+05,
         7.6781e+05, 4.0235e+05],
        [1.8304e+00, 4.0233e+05, 0.0000e+00, 1.7300e+00, 3.9513e+05, 3.8468e+05,
         2.2969e+00, 2.0277e+00, 3.9101e+05, 3.8585e+05, 1.9311e+00, 1.7725e+00,
         3.9171e+05, 1.8220e+00],
        [1.9076e+00, 4.0235e+05, 1.7300e+00, 0.0000e+00, 3.9511e+05, 3.8469e+05,
         2.0651e+00, 1.7687e+00, 3.9102e+05, 3.8590e+05, 1.8491e+00, 1.6670e+00,
         3.9169e+05, 1.7660e+00],
        [3.9513e+05, 7.9957e+05, 3.9513e+05, 3.9511e+05, 0.0000e+00, 7.8520e+05,
         3.9513e+05, 3.9510e+05, 8.0345e+05, 7.8718e+05, 3.9515e+05, 3.9516e+05,
         7.9212e+05, 3.9510e+05],
        [3.8467e+05, 7.9230e+05, 3.8468e+05, 3.8469e+05, 7.8520e+05, 0.0000e+00,
         3.8468e+05, 3.8467e+05, 7.8436e+05, 7.6700e+05, 3.8468e+05, 3.8468e+05,
         7.6759e+05, 3.8467e+05],
        [2.2948e+00, 4.0234e+05, 2.2969e+00, 2.0651e+00, 3.9513e+05, 3.8468e+05,
         0.0000e+00, 2.1479e+00, 3.9102e+05, 3.8586e+05, 2.0637e+00, 2.1457e+00,
         3.9170e+05, 2.1354e+00],
        [1.8862e+00, 4.0233e+05, 2.0277e+00, 1.7687e+00, 3.9510e+05, 3.8467e+05,
         2.1479e+00, 0.0000e+00, 3.9102e+05, 3.8587e+05, 2.0660e+00, 1.8016e+00,
         3.9165e+05, 2.0328e+00],
        [3.9103e+05, 7.9971e+05, 3.9101e+05, 3.9102e+05, 8.0345e+05, 7.8436e+05,
         3.9102e+05, 3.9102e+05, 0.0000e+00, 7.8780e+05, 3.9102e+05, 3.9105e+05,
         7.8199e+05, 3.9097e+05],
        [3.8592e+05, 7.9994e+05, 3.8585e+05, 3.8590e+05, 7.8718e+05, 7.6700e+05,
         3.8586e+05, 3.8587e+05, 7.8780e+05, 0.0000e+00, 3.8585e+05, 3.8585e+05,
         7.8815e+05, 3.8586e+05],
        [1.7167e+00, 4.0231e+05, 1.9311e+00, 1.8491e+00, 3.9515e+05, 3.8468e+05,
         2.0637e+00, 2.0660e+00, 3.9102e+05, 3.8585e+05, 0.0000e+00, 1.9486e+00,
         3.9170e+05, 1.9856e+00],
        [1.8743e+00, 4.0233e+05, 1.7725e+00, 1.6670e+00, 3.9516e+05, 3.8468e+05,
         2.1457e+00, 1.8016e+00, 3.9105e+05, 3.8585e+05, 1.9486e+00, 0.0000e+00,
         3.9170e+05, 1.8880e+00],
        [3.9167e+05, 7.6781e+05, 3.9171e+05, 3.9169e+05, 7.9212e+05, 7.6759e+05,
         3.9170e+05, 3.9165e+05, 7.8199e+05, 7.8815e+05, 3.9170e+05, 3.9170e+05,
         0.0000e+00, 3.9170e+05],
        [1.9209e+00, 4.0235e+05, 1.8220e+00, 1.7660e+00, 3.9510e+05, 3.8467e+05,
         2.1354e+00, 2.0328e+00, 3.9097e+05, 3.8586e+05, 1.9856e+00, 1.8880e+00,
         3.9170e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7167e+00, 1.8304e+00, 1.8743e+00, 1.8862e+00, 1.9076e+00,
        1.9209e+00, 2.2948e+00, 3.8467e+05, 3.8592e+05, 3.9103e+05, 3.9167e+05,
        3.9513e+05, 4.0232e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 402305.5000, 402323.8438, 402329.1875, 402331.6562,
        402333.3125, 402335.2500, 402351.6250, 402352.8750, 767805.1250,
        792303.4375, 799573.8125, 799711.6875, 799935.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7300e+00, 1.7725e+00, 1.8220e+00, 1.8304e+00, 1.9311e+00,
        2.0277e+00, 2.2969e+00, 3.8468e+05, 3.8585e+05, 3.9101e+05, 3.9171e+05,
        3.9513e+05, 4.0233e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6670e+00, 1.7300e+00, 1.7660e+00, 1.7687e+00, 1.8491e+00,
        1.9076e+00, 2.0651e+00, 3.8469e+05, 3.8590e+05, 3.9102e+05, 3.9169e+05,
        3.9511e+05, 4.0235e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 395100.8438, 395102.7500, 395111.5000, 395125.2188,
        395127.6250, 395129.1875, 395145.9375, 395159.2188, 785199.2500,
        787182.7500, 792117.0000, 799573.8125, 803448.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 384668.7500, 384670.0312, 384671.1875, 384676.4062,
        384678.8438, 384680.0000, 384682.3750, 384690.7812, 766997.0000,
        767585.2500, 784361.1875, 785199.2500, 792303.4375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 2.0637e+00, 2.0651e+00, 2.1354e+00, 2.1457e+00, 2.1479e+00,
        2.2948e+00, 2.2969e+00, 3.8468e+05, 3.8586e+05, 3.9102e+05, 3.9170e+05,
        3.9513e+05, 4.0234e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7687e+00, 1.8016e+00, 1.8862e+00, 2.0277e+00, 2.0328e+00,
        2.0660e+00, 2.1479e+00, 3.8467e+05, 3.8587e+05, 3.9102e+05, 3.9165e+05,
        3.9510e+05, 4.0233e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390973.3750, 391006.9062, 391016.6562, 391017.9688,
        391018.7188, 391020.9062, 391028.1250, 391052.2500, 781988.2500,
        784361.1875, 787803.7500, 799711.6875, 803448.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 385845.5625, 385850.6875, 385852.1875, 385857.7812,
        385860.2812, 385865.2188, 385896.2500, 385923.5625, 766997.0000,
        787182.7500, 787803.7500, 788151.8750, 799935.8125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7167e+00, 1.8491e+00, 1.9311e+00, 1.9486e+00, 1.9856e+00,
        2.0637e+00, 2.0660e+00, 3.8468e+05, 3.8585e+05, 3.9102e+05, 3.9170e+05,
        3.9515e+05, 4.0231e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6670e+00, 1.7725e+00, 1.8016e+00, 1.8743e+00, 1.8880e+00,
        1.9486e+00, 2.1457e+00, 3.8468e+05, 3.8585e+05, 3.9105e+05, 3.9170e+05,
        3.9516e+05, 4.0233e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391651.7500, 391669.1250, 391691.4375, 391702.0938,
        391702.3125, 391702.8750, 391703.8750, 391714.4688, 767585.2500,
        767805.1250, 781988.2500, 788151.8750, 792117.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.7660e+00, 1.8220e+00, 1.8880e+00, 1.9209e+00, 1.9856e+00,
        2.0328e+00, 2.1354e+00, 3.8467e+05, 3.8586e+05, 3.9097e+05, 3.9170e+05,
        3.9510e+05, 4.0235e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['85622.86', '442940.91', '85616.05', '85622.20', '438466.84', '427157.22', '85617.27', '85616.68', '434458.12', '428216.50', '85616.29', '85615.00', '433458.09', '85615.70']
estimated f for each client, fs: [6, 4, 6, 6, 4, 4, 6, 6, 4, 4, 6, 6, 4, 6]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 17, 1, 9, 20, 18, 8, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0128s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:03...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:03, End: 2025-07-22 15:30:03)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6929e+00, 1.9690e+00, 3.8378e+05, 1.8709e+00, 1.9713e+00,
         4.1167e+05, 3.9205e+05, 2.1874e+00, 3.8002e+05, 1.8617e+00, 3.7554e+05,
         3.8626e+05, 1.7436e+00, 2.0466e+00, 3.9387e+05],
        [1.6929e+00, 0.0000e+00, 1.6795e+00, 3.8380e+05, 1.7709e+00, 1.8815e+00,
         4.1167e+05, 3.9202e+05, 2.0935e+00, 3.8005e+05, 1.9197e+00, 3.7557e+05,
         3.8625e+05, 1.8469e+00, 1.9636e+00, 3.9388e+05],
        [1.9690e+00, 1.6795e+00, 0.0000e+00, 3.8379e+05, 1.7178e+00, 1.7554e+00,
         4.1166e+05, 3.9200e+05, 2.2160e+00, 3.8005e+05, 1.7796e+00, 3.7556e+05,
         3.8625e+05, 1.9249e+00, 1.8184e+00, 3.9387e+05],
        [3.8378e+05, 3.8380e+05, 3.8379e+05, 0.0000e+00, 3.8379e+05, 3.8380e+05,
         8.1318e+05, 7.6517e+05, 3.8375e+05, 7.6864e+05, 3.8378e+05, 7.5964e+05,
         7.5077e+05, 3.8377e+05, 3.8371e+05, 7.5911e+05],
        [1.8709e+00, 1.7709e+00, 1.7178e+00, 3.8379e+05, 0.0000e+00, 1.7229e+00,
         4.1160e+05, 3.9201e+05, 2.1148e+00, 3.8001e+05, 1.9588e+00, 3.7556e+05,
         3.8625e+05, 1.7453e+00, 1.9172e+00, 3.9388e+05],
        [1.9713e+00, 1.8815e+00, 1.7554e+00, 3.8380e+05, 1.7229e+00, 0.0000e+00,
         4.1165e+05, 3.9202e+05, 1.9624e+00, 3.8003e+05, 1.7810e+00, 3.7554e+05,
         3.8622e+05, 1.8352e+00, 1.8047e+00, 3.9388e+05],
        [4.1167e+05, 4.1167e+05, 4.1166e+05, 8.1318e+05, 4.1160e+05, 4.1165e+05,
         0.0000e+00, 8.2347e+05, 4.1167e+05, 7.9272e+05, 4.1166e+05, 7.9320e+05,
         8.2403e+05, 4.1165e+05, 4.1168e+05, 8.2331e+05],
        [3.9205e+05, 3.9202e+05, 3.9200e+05, 7.6517e+05, 3.9201e+05, 3.9202e+05,
         8.2347e+05, 0.0000e+00, 3.9199e+05, 7.5534e+05, 3.9203e+05, 7.6458e+05,
         7.8155e+05, 3.9201e+05, 3.9201e+05, 7.7813e+05],
        [2.1874e+00, 2.0935e+00, 2.2160e+00, 3.8375e+05, 2.1148e+00, 1.9624e+00,
         4.1167e+05, 3.9199e+05, 0.0000e+00, 3.8000e+05, 1.9921e+00, 3.7556e+05,
         3.8628e+05, 1.8900e+00, 1.9530e+00, 3.9385e+05],
        [3.8002e+05, 3.8005e+05, 3.8005e+05, 7.6864e+05, 3.8001e+05, 3.8003e+05,
         7.9272e+05, 7.5534e+05, 3.8000e+05, 0.0000e+00, 3.8003e+05, 7.4408e+05,
         7.5728e+05, 3.8000e+05, 3.8003e+05, 7.7865e+05],
        [1.8617e+00, 1.9197e+00, 1.7796e+00, 3.8378e+05, 1.9588e+00, 1.7810e+00,
         4.1166e+05, 3.9203e+05, 1.9921e+00, 3.8003e+05, 0.0000e+00, 3.7555e+05,
         3.8625e+05, 1.9659e+00, 1.8805e+00, 3.9388e+05],
        [3.7554e+05, 3.7557e+05, 3.7556e+05, 7.5964e+05, 3.7556e+05, 3.7554e+05,
         7.9320e+05, 7.6458e+05, 3.7556e+05, 7.4408e+05, 3.7555e+05, 0.0000e+00,
         7.6410e+05, 3.7555e+05, 3.7551e+05, 7.5524e+05],
        [3.8626e+05, 3.8625e+05, 3.8625e+05, 7.5077e+05, 3.8625e+05, 3.8622e+05,
         8.2403e+05, 7.8155e+05, 3.8628e+05, 7.5728e+05, 3.8625e+05, 7.6410e+05,
         0.0000e+00, 3.8626e+05, 3.8626e+05, 7.8833e+05],
        [1.7436e+00, 1.8469e+00, 1.9249e+00, 3.8377e+05, 1.7453e+00, 1.8352e+00,
         4.1165e+05, 3.9201e+05, 1.8900e+00, 3.8000e+05, 1.9659e+00, 3.7555e+05,
         3.8626e+05, 0.0000e+00, 1.8546e+00, 3.9389e+05],
        [2.0466e+00, 1.9636e+00, 1.8184e+00, 3.8371e+05, 1.9172e+00, 1.8047e+00,
         4.1168e+05, 3.9201e+05, 1.9530e+00, 3.8003e+05, 1.8805e+00, 3.7551e+05,
         3.8626e+05, 1.8546e+00, 0.0000e+00, 3.9387e+05],
        [3.9387e+05, 3.9388e+05, 3.9387e+05, 7.5911e+05, 3.9388e+05, 3.9388e+05,
         8.2331e+05, 7.7813e+05, 3.9385e+05, 7.7865e+05, 3.9388e+05, 7.5524e+05,
         7.8833e+05, 3.9389e+05, 3.9387e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6929e+00, 1.7436e+00, 1.8617e+00, 1.8709e+00, 1.9690e+00,
        1.9713e+00, 2.0466e+00, 2.1874e+00, 3.7554e+05, 3.8002e+05, 3.8378e+05,
        3.8626e+05, 3.9205e+05, 3.9387e+05, 4.1167e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6795e+00, 1.6929e+00, 1.7709e+00, 1.8469e+00, 1.8815e+00,
        1.9197e+00, 1.9636e+00, 2.0935e+00, 3.7557e+05, 3.8005e+05, 3.8380e+05,
        3.8625e+05, 3.9202e+05, 3.9388e+05, 4.1167e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6795e+00, 1.7178e+00, 1.7554e+00, 1.7796e+00, 1.8184e+00,
        1.9249e+00, 1.9690e+00, 2.2160e+00, 3.7556e+05, 3.8005e+05, 3.8379e+05,
        3.8625e+05, 3.9200e+05, 3.9387e+05, 4.1166e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383708.2500, 383754.2188, 383768.6250, 383782.1250,
        383784.0000, 383788.0312, 383790.5625, 383795.3125, 383796.0938,
        750770.8750, 759108.7500, 759637.7500, 765167.8750, 768637.1250,
        813177.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7178e+00, 1.7229e+00, 1.7453e+00, 1.7709e+00, 1.8709e+00,
        1.9172e+00, 1.9588e+00, 2.1148e+00, 3.7556e+05, 3.8001e+05, 3.8379e+05,
        3.8625e+05, 3.9201e+05, 3.9388e+05, 4.1160e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7229e+00, 1.7554e+00, 1.7810e+00, 1.8047e+00, 1.8352e+00,
        1.8815e+00, 1.9624e+00, 1.9713e+00, 3.7554e+05, 3.8003e+05, 3.8380e+05,
        3.8622e+05, 3.9202e+05, 3.9388e+05, 4.1165e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 411596.2812, 411650.5938, 411651.5312, 411658.9062,
        411662.7500, 411668.0000, 411669.9688, 411671.3750, 411683.1562,
        792715.1250, 793205.0000, 813177.8125, 823313.5000, 823465.6250,
        824032.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391990.0000, 391996.5000, 392006.6250, 392008.6250,
        392009.5938, 392015.8438, 392019.2188, 392031.0625, 392052.4688,
        755343.8750, 764583.0000, 765167.8750, 778125.1250, 781546.4375,
        823465.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8900e+00, 1.9530e+00, 1.9624e+00, 1.9921e+00, 2.0935e+00,
        2.1148e+00, 2.1874e+00, 2.2160e+00, 3.7556e+05, 3.8000e+05, 3.8375e+05,
        3.8628e+05, 3.9199e+05, 3.9385e+05, 4.1167e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379995.2500, 379995.5000, 380005.5000, 380016.0000,
        380026.7188, 380028.7500, 380028.8438, 380046.1250, 380053.9062,
        744077.8750, 755343.8750, 757281.8125, 768637.1250, 778653.1250,
        792715.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7796e+00, 1.7810e+00, 1.8617e+00, 1.8805e+00, 1.9197e+00,
        1.9588e+00, 1.9659e+00, 1.9921e+00, 3.7555e+05, 3.8003e+05, 3.8378e+05,
        3.8625e+05, 3.9203e+05, 3.9388e+05, 4.1166e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 375509.8750, 375535.5312, 375541.8438, 375549.7188,
        375553.2500, 375555.9062, 375556.3438, 375561.5938, 375574.2500,
        744077.8750, 755244.3750, 759637.7500, 764096.8750, 764583.0000,
        793205.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386223.2812, 386245.5625, 386248.9062, 386250.1875,
        386251.6875, 386257.2500, 386260.5625, 386262.5312, 386283.1250,
        750770.8750, 757281.8125, 764096.8750, 781546.4375, 788325.1250,
        824032.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7436e+00, 1.7453e+00, 1.8352e+00, 1.8469e+00, 1.8546e+00,
        1.8900e+00, 1.9249e+00, 1.9659e+00, 3.7555e+05, 3.8000e+05, 3.8377e+05,
        3.8626e+05, 3.9201e+05, 3.9389e+05, 4.1165e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8047e+00, 1.8184e+00, 1.8546e+00, 1.8805e+00, 1.9172e+00,
        1.9530e+00, 1.9636e+00, 2.0466e+00, 3.7551e+05, 3.8003e+05, 3.8371e+05,
        3.8626e+05, 3.9201e+05, 3.9387e+05, 4.1168e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393846.0625, 393870.5000, 393870.6250, 393871.5000,
        393875.3125, 393876.4062, 393881.2812, 393881.8125, 393894.4062,
        755244.3750, 759108.7500, 778125.1250, 778653.1250, 788325.1250,
        823313.5000])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75557.33', '75563.52', '75562.51', '420473.81', '75558.20', '75557.70', '449762.81', '428347.34', '75556.77', '416427.44', '75559.36', '412401.59', '422705.41', '75556.33', '75555.40', '430011.25']
estimated f for each client, fs: [7, 7, 7, 5, 7, 7, 5, 5, 7, 5, 7, 5, 5, 7, 7, 5]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0301s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:04...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 45 218]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:04, End: 2025-07-22 15:30:04)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 1.3988e+00, 1.5676e+00, 3.7403e+05, 3.9563e+05, 1.5077e+00,
         1.6002e+00, 3.8686e+05, 3.7487e+05, 1.6884e+00, 3.9001e+05, 1.4493e+00,
         1.4437e+00, 4.0130e+05, 4.1019e+05, 1.4016e+00, 2.0273e+00, 3.9124e+05,
         1.6619e+00, 1.4798e+00],
        [1.3988e+00, 0.0000e+00, 1.4126e+00, 3.7404e+05, 3.9559e+05, 1.5092e+00,
         1.5922e+00, 3.8685e+05, 3.7491e+05, 1.6193e+00, 3.9002e+05, 1.3685e+00,
         1.5980e+00, 4.0127e+05, 4.1018e+05, 1.5317e+00, 2.1068e+00, 3.9122e+05,
         1.6330e+00, 1.5004e+00],
        [1.5676e+00, 1.4126e+00, 0.0000e+00, 3.7406e+05, 3.9560e+05, 1.4157e+00,
         1.5100e+00, 3.8692e+05, 3.7495e+05, 1.6886e+00, 3.9000e+05, 1.4514e+00,
         1.4219e+00, 4.0129e+05, 4.1015e+05, 1.5670e+00, 1.9567e+00, 3.9127e+05,
         1.4693e+00, 1.4795e+00],
        [3.7403e+05, 3.7404e+05, 3.7406e+05, 0.0000e+00, 7.7251e+05, 3.7401e+05,
         3.7406e+05, 7.4395e+05, 7.4318e+05, 3.7404e+05, 7.6250e+05, 3.7402e+05,
         3.7405e+05, 7.7386e+05, 8.1057e+05, 3.7403e+05, 3.7401e+05, 7.7275e+05,
         3.7403e+05, 3.7405e+05],
        [3.9563e+05, 3.9559e+05, 3.9560e+05, 7.7251e+05, 0.0000e+00, 3.9560e+05,
         3.9560e+05, 7.8729e+05, 7.8263e+05, 3.9562e+05, 7.8329e+05, 3.9559e+05,
         3.9561e+05, 8.0004e+05, 8.1753e+05, 3.9563e+05, 3.9560e+05, 7.8865e+05,
         3.9561e+05, 3.9562e+05],
        [1.5077e+00, 1.5092e+00, 1.4157e+00, 3.7401e+05, 3.9560e+05, 0.0000e+00,
         1.4863e+00, 3.8684e+05, 3.7493e+05, 1.6701e+00, 3.9002e+05, 1.4176e+00,
         1.6129e+00, 4.0127e+05, 4.1018e+05, 1.4188e+00, 1.9531e+00, 3.9123e+05,
         1.5512e+00, 1.4655e+00],
        [1.6002e+00, 1.5922e+00, 1.5100e+00, 3.7406e+05, 3.9560e+05, 1.4863e+00,
         0.0000e+00, 3.8687e+05, 3.7491e+05, 1.5651e+00, 3.9000e+05, 1.5356e+00,
         1.4955e+00, 4.0128e+05, 4.1014e+05, 1.4935e+00, 1.8756e+00, 3.9124e+05,
         1.5585e+00, 1.5478e+00],
        [3.8686e+05, 3.8685e+05, 3.8692e+05, 7.4395e+05, 7.8729e+05, 3.8684e+05,
         3.8687e+05, 0.0000e+00, 7.6188e+05, 3.8685e+05, 7.7729e+05, 3.8684e+05,
         3.8683e+05, 7.8931e+05, 8.0436e+05, 3.8684e+05, 3.8685e+05, 7.7136e+05,
         3.8685e+05, 3.8687e+05],
        [3.7487e+05, 3.7491e+05, 3.7495e+05, 7.4318e+05, 7.8263e+05, 3.7493e+05,
         3.7491e+05, 7.6188e+05, 0.0000e+00, 3.7493e+05, 7.5751e+05, 3.7493e+05,
         3.7490e+05, 7.5506e+05, 7.8020e+05, 3.7492e+05, 3.7491e+05, 7.8815e+05,
         3.7491e+05, 3.7490e+05],
        [1.6884e+00, 1.6193e+00, 1.6886e+00, 3.7404e+05, 3.9562e+05, 1.6701e+00,
         1.5651e+00, 3.8685e+05, 3.7493e+05, 0.0000e+00, 3.8998e+05, 1.5617e+00,
         1.5819e+00, 4.0128e+05, 4.1019e+05, 1.5073e+00, 1.8047e+00, 3.9121e+05,
         1.6245e+00, 1.5986e+00],
        [3.9001e+05, 3.9002e+05, 3.9000e+05, 7.6250e+05, 7.8329e+05, 3.9002e+05,
         3.9000e+05, 7.7729e+05, 7.5751e+05, 3.8998e+05, 0.0000e+00, 3.9000e+05,
         3.9002e+05, 7.7458e+05, 7.7578e+05, 3.9001e+05, 3.9000e+05, 7.8160e+05,
         3.9002e+05, 3.9002e+05],
        [1.4493e+00, 1.3685e+00, 1.4514e+00, 3.7402e+05, 3.9559e+05, 1.4176e+00,
         1.5356e+00, 3.8684e+05, 3.7493e+05, 1.5617e+00, 3.9000e+05, 0.0000e+00,
         1.5446e+00, 4.0130e+05, 4.1018e+05, 1.4167e+00, 2.0683e+00, 3.9125e+05,
         1.4845e+00, 1.4504e+00],
        [1.4437e+00, 1.5980e+00, 1.4219e+00, 3.7405e+05, 3.9561e+05, 1.6129e+00,
         1.4955e+00, 3.8683e+05, 3.7490e+05, 1.5819e+00, 3.9002e+05, 1.5446e+00,
         0.0000e+00, 4.0134e+05, 4.1021e+05, 1.5886e+00, 1.9025e+00, 3.9124e+05,
         1.6424e+00, 1.4498e+00],
        [4.0130e+05, 4.0127e+05, 4.0129e+05, 7.7386e+05, 8.0004e+05, 4.0127e+05,
         4.0128e+05, 7.8931e+05, 7.5506e+05, 4.0128e+05, 7.7458e+05, 4.0130e+05,
         4.0134e+05, 0.0000e+00, 8.1696e+05, 4.0126e+05, 4.0126e+05, 7.8146e+05,
         4.0130e+05, 4.0129e+05],
        [4.1019e+05, 4.1018e+05, 4.1015e+05, 8.1057e+05, 8.1753e+05, 4.1018e+05,
         4.1014e+05, 8.0436e+05, 7.8020e+05, 4.1019e+05, 7.7578e+05, 4.1018e+05,
         4.1021e+05, 8.1696e+05, 0.0000e+00, 4.1022e+05, 4.1017e+05, 7.7940e+05,
         4.1016e+05, 4.1018e+05],
        [1.4016e+00, 1.5317e+00, 1.5670e+00, 3.7403e+05, 3.9563e+05, 1.4188e+00,
         1.4935e+00, 3.8684e+05, 3.7492e+05, 1.5073e+00, 3.9001e+05, 1.4167e+00,
         1.5886e+00, 4.0126e+05, 4.1022e+05, 0.0000e+00, 1.7596e+00, 3.9125e+05,
         1.6135e+00, 1.5101e+00],
        [2.0273e+00, 2.1068e+00, 1.9567e+00, 3.7401e+05, 3.9560e+05, 1.9531e+00,
         1.8756e+00, 3.8685e+05, 3.7491e+05, 1.8047e+00, 3.9000e+05, 2.0683e+00,
         1.9025e+00, 4.0126e+05, 4.1017e+05, 1.7596e+00, 0.0000e+00, 3.9124e+05,
         2.2326e+00, 2.0556e+00],
        [3.9124e+05, 3.9122e+05, 3.9127e+05, 7.7275e+05, 7.8865e+05, 3.9123e+05,
         3.9124e+05, 7.7136e+05, 7.8815e+05, 3.9121e+05, 7.8160e+05, 3.9125e+05,
         3.9124e+05, 7.8146e+05, 7.7940e+05, 3.9125e+05, 3.9124e+05, 0.0000e+00,
         3.9125e+05, 3.9124e+05],
        [1.6619e+00, 1.6330e+00, 1.4693e+00, 3.7403e+05, 3.9561e+05, 1.5512e+00,
         1.5585e+00, 3.8685e+05, 3.7491e+05, 1.6245e+00, 3.9002e+05, 1.4845e+00,
         1.6424e+00, 4.0130e+05, 4.1016e+05, 1.6135e+00, 2.2326e+00, 3.9125e+05,
         0.0000e+00, 1.6111e+00],
        [1.4798e+00, 1.5004e+00, 1.4795e+00, 3.7405e+05, 3.9562e+05, 1.4655e+00,
         1.5478e+00, 3.8687e+05, 3.7490e+05, 1.5986e+00, 3.9002e+05, 1.4504e+00,
         1.4498e+00, 4.0129e+05, 4.1018e+05, 1.5101e+00, 2.0556e+00, 3.9124e+05,
         1.6111e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3988e+00, 1.4016e+00, 1.4437e+00, 1.4493e+00, 1.4798e+00,
        1.5077e+00, 1.5676e+00, 1.6002e+00, 1.6619e+00, 1.6884e+00, 2.0273e+00,
        3.7403e+05, 3.7487e+05, 3.8686e+05, 3.9001e+05, 3.9124e+05, 3.9563e+05,
        4.0130e+05, 4.1019e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.3685e+00, 1.3988e+00, 1.4126e+00, 1.5004e+00, 1.5092e+00,
        1.5317e+00, 1.5922e+00, 1.5980e+00, 1.6193e+00, 1.6330e+00, 2.1068e+00,
        3.7404e+05, 3.7491e+05, 3.8685e+05, 3.9002e+05, 3.9122e+05, 3.9559e+05,
        4.0127e+05, 4.1018e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4126e+00, 1.4157e+00, 1.4219e+00, 1.4514e+00, 1.4693e+00,
        1.4795e+00, 1.5100e+00, 1.5670e+00, 1.5676e+00, 1.6886e+00, 1.9567e+00,
        3.7406e+05, 3.7495e+05, 3.8692e+05, 3.9000e+05, 3.9127e+05, 3.9560e+05,
        4.0129e+05, 4.1015e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 374011.5000, 374014.9688, 374022.2500, 374027.0000,
        374031.8750, 374034.1875, 374038.3125, 374043.3750, 374051.9688,
        374052.5000, 374056.6875, 374061.5000, 743180.6250, 743948.3125,
        762504.6250, 772509.8125, 772754.7500, 773860.7500, 810571.6875])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 395591.8750, 395593.5000, 395595.1875, 395596.9688,
        395599.2812, 395602.9062, 395607.2500, 395607.3438, 395615.7188,
        395621.1250, 395625.4062, 395633.1250, 772509.8125, 782634.3750,
        783292.8750, 787285.6250, 788649.8750, 800040.8125, 817531.2500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4157e+00, 1.4176e+00, 1.4188e+00, 1.4655e+00, 1.4863e+00,
        1.5077e+00, 1.5092e+00, 1.5512e+00, 1.6129e+00, 1.6701e+00, 1.9531e+00,
        3.7401e+05, 3.7493e+05, 3.8684e+05, 3.9002e+05, 3.9123e+05, 3.9560e+05,
        4.0127e+05, 4.1018e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4863e+00, 1.4935e+00, 1.4955e+00, 1.5100e+00, 1.5356e+00,
        1.5478e+00, 1.5585e+00, 1.5651e+00, 1.5922e+00, 1.6002e+00, 1.8756e+00,
        3.7406e+05, 3.7491e+05, 3.8687e+05, 3.9000e+05, 3.9124e+05, 3.9560e+05,
        4.0128e+05, 4.1014e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 386825.8438, 386836.4688, 386841.8750, 386842.9375,
        386845.0938, 386849.8125, 386850.7500, 386853.1562, 386862.2188,
        386866.5312, 386868.3125, 386920.4688, 743948.3125, 761882.5000,
        771359.0000, 777288.1250, 787285.6250, 789310.5000, 804355.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 374871.2188, 374897.9062, 374901.4688, 374908.2188,
        374909.6562, 374911.3125, 374912.3125, 374918.6562, 374925.7188,
        374928.5625, 374930.8438, 374948.0938, 743180.6250, 755055.4375,
        757513.8750, 761882.5000, 780200.1250, 782634.3750, 788149.5000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.5073e+00, 1.5617e+00, 1.5651e+00, 1.5819e+00, 1.5986e+00,
        1.6193e+00, 1.6245e+00, 1.6701e+00, 1.6884e+00, 1.6886e+00, 1.8047e+00,
        3.7404e+05, 3.7493e+05, 3.8685e+05, 3.8998e+05, 3.9121e+05, 3.9562e+05,
        4.0128e+05, 4.1019e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 389983.1875, 389995.8125, 390001.0000, 390001.3438,
        390001.9062, 390006.6562, 390011.9688, 390017.5000, 390020.7500,
        390020.8438, 390021.8438, 390024.8125, 757513.8750, 762504.6250,
        774582.3125, 775783.4375, 777288.1250, 781597.6250, 783292.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.3685e+00, 1.4167e+00, 1.4176e+00, 1.4493e+00, 1.4504e+00,
        1.4514e+00, 1.4845e+00, 1.5356e+00, 1.5446e+00, 1.5617e+00, 2.0683e+00,
        3.7402e+05, 3.7493e+05, 3.8684e+05, 3.9000e+05, 3.9125e+05, 3.9559e+05,
        4.0130e+05, 4.1018e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4219e+00, 1.4437e+00, 1.4498e+00, 1.4955e+00, 1.5446e+00,
        1.5819e+00, 1.5886e+00, 1.5980e+00, 1.6129e+00, 1.6424e+00, 1.9025e+00,
        3.7405e+05, 3.7490e+05, 3.8683e+05, 3.9002e+05, 3.9124e+05, 3.9561e+05,
        4.0134e+05, 4.1021e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 401259.8125, 401261.8125, 401267.4062, 401273.3750,
        401279.7188, 401282.0312, 401289.4375, 401289.9688, 401295.1562,
        401296.2188, 401304.9375, 401335.8438, 755055.4375, 773860.7500,
        774582.3125, 781455.4375, 789310.5000, 800040.8125, 816957.8125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 410136.6562, 410148.3750, 410156.2500, 410168.2500,
        410176.6562, 410180.7500, 410181.1875, 410183.7500, 410186.1562,
        410187.8438, 410210.4062, 410220.5625, 775783.4375, 779398.1250,
        780200.1250, 804355.8750, 810571.6875, 816957.8125, 817531.2500])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4016e+00, 1.4167e+00, 1.4188e+00, 1.4935e+00, 1.5073e+00,
        1.5101e+00, 1.5317e+00, 1.5670e+00, 1.5886e+00, 1.6135e+00, 1.7596e+00,
        3.7403e+05, 3.7492e+05, 3.8684e+05, 3.9001e+05, 3.9125e+05, 3.9563e+05,
        4.0126e+05, 4.1022e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.7596e+00, 1.8047e+00, 1.8756e+00, 1.9025e+00, 1.9531e+00,
        1.9567e+00, 2.0273e+00, 2.0556e+00, 2.0683e+00, 2.1068e+00, 2.2326e+00,
        3.7401e+05, 3.7491e+05, 3.8685e+05, 3.9000e+05, 3.9124e+05, 3.9560e+05,
        4.0126e+05, 4.1017e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 391209.9375, 391216.6875, 391228.8125, 391235.1562,
        391235.2188, 391236.5625, 391240.6562, 391242.9688, 391245.7812,
        391252.1875, 391252.9375, 391268.7500, 771359.0000, 772754.7500,
        779398.1250, 781455.4375, 781597.6250, 788149.5000, 788649.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4693e+00, 1.4845e+00, 1.5512e+00, 1.5585e+00, 1.6111e+00,
        1.6135e+00, 1.6245e+00, 1.6330e+00, 1.6424e+00, 1.6619e+00, 2.2326e+00,
        3.7403e+05, 3.7491e+05, 3.8685e+05, 3.9002e+05, 3.9125e+05, 3.9561e+05,
        4.0130e+05, 4.1016e+05])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.4498e+00, 1.4504e+00, 1.4655e+00, 1.4795e+00, 1.4798e+00,
        1.5004e+00, 1.5101e+00, 1.5478e+00, 1.5986e+00, 1.6111e+00, 2.0556e+00,
        3.7405e+05, 3.7490e+05, 3.8687e+05, 3.9002e+05, 3.9124e+05, 3.9562e+05,
        4.0129e+05, 4.1018e+05])
Index of maximum distance difference after half of values: 12
adaptive_Krum scores:  ['31170.76', '31171.72', '31173.20', '374037.12', '395607.44', '31169.04', '31172.82', '386855.22', '374913.62', '31171.35', '390008.91', '31169.91', '31172.48', '401286.25', '410178.03', '31170.31', '31169.72', '391238.81', '31171.02', '31172.43']
estimated f for each client, fs: [8, 8, 8, 6, 6, 8, 8, 6, 6, 8, 6, 8, 8, 6, 6, 8, 8, 6, 8, 8]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0158s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:04...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:30:04, End: 2025-07-22 15:30:04)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.5972e+00, 3.9524e+05, 3.8640e+05, 1.8059e+00, 4.1270e+05,
         3.9705e+05, 1.8145e+00, 3.8978e+05, 1.6213e+00, 1.7569e+00, 3.8631e+05,
         3.9692e+05, 1.8306e+00, 2.1085e+00, 1.8491e+00, 1.6794e+00],
        [1.5972e+00, 0.0000e+00, 3.9524e+05, 3.8641e+05, 1.7399e+00, 4.1272e+05,
         3.9703e+05, 1.9172e+00, 3.8981e+05, 1.7034e+00, 1.6235e+00, 3.8629e+05,
         3.9690e+05, 1.8049e+00, 1.9500e+00, 1.6880e+00, 1.7055e+00],
        [3.9524e+05, 3.9524e+05, 0.0000e+00, 7.7626e+05, 3.9522e+05, 7.8367e+05,
         7.9615e+05, 3.9523e+05, 7.8478e+05, 3.9524e+05, 3.9522e+05, 7.9069e+05,
         7.8454e+05, 3.9528e+05, 3.9523e+05, 3.9526e+05, 3.9524e+05],
        [3.8640e+05, 3.8641e+05, 7.7626e+05, 0.0000e+00, 3.8645e+05, 8.1251e+05,
         8.1456e+05, 3.8645e+05, 7.8189e+05, 3.8641e+05, 3.8640e+05, 7.6877e+05,
         7.6985e+05, 3.8639e+05, 3.8640e+05, 3.8641e+05, 3.8641e+05],
        [1.8059e+00, 1.7399e+00, 3.9522e+05, 3.8645e+05, 0.0000e+00, 4.1268e+05,
         3.9701e+05, 1.8266e+00, 3.8983e+05, 1.7792e+00, 1.6789e+00, 3.8629e+05,
         3.9689e+05, 1.7603e+00, 1.8779e+00, 1.7735e+00, 1.7758e+00],
        [4.1270e+05, 4.1272e+05, 7.8367e+05, 8.1251e+05, 4.1268e+05, 0.0000e+00,
         8.0433e+05, 4.1269e+05, 8.1514e+05, 4.1272e+05, 4.1272e+05, 7.9335e+05,
         8.0678e+05, 4.1272e+05, 4.1274e+05, 4.1269e+05, 4.1270e+05],
        [3.9705e+05, 3.9703e+05, 7.9615e+05, 8.1456e+05, 3.9701e+05, 8.0433e+05,
         0.0000e+00, 3.9702e+05, 7.7536e+05, 3.9708e+05, 3.9704e+05, 8.0599e+05,
         8.0653e+05, 3.9709e+05, 3.9707e+05, 3.9705e+05, 3.9704e+05],
        [1.8145e+00, 1.9172e+00, 3.9523e+05, 3.8645e+05, 1.8266e+00, 4.1269e+05,
         3.9702e+05, 0.0000e+00, 3.8981e+05, 1.8167e+00, 1.7303e+00, 3.8629e+05,
         3.9688e+05, 1.8099e+00, 1.8217e+00, 1.8481e+00, 1.7341e+00],
        [3.8978e+05, 3.8981e+05, 7.8478e+05, 7.8189e+05, 3.8983e+05, 8.1514e+05,
         7.7536e+05, 3.8981e+05, 0.0000e+00, 3.8982e+05, 3.8978e+05, 7.6476e+05,
         8.0573e+05, 3.8979e+05, 3.8980e+05, 3.8978e+05, 3.8982e+05],
        [1.6213e+00, 1.7034e+00, 3.9524e+05, 3.8641e+05, 1.7792e+00, 4.1272e+05,
         3.9708e+05, 1.8167e+00, 3.8982e+05, 0.0000e+00, 1.6957e+00, 3.8631e+05,
         3.9690e+05, 1.7498e+00, 2.0876e+00, 1.6905e+00, 1.6643e+00],
        [1.7569e+00, 1.6235e+00, 3.9522e+05, 3.8640e+05, 1.6789e+00, 4.1272e+05,
         3.9704e+05, 1.7303e+00, 3.8978e+05, 1.6957e+00, 0.0000e+00, 3.8631e+05,
         3.9691e+05, 1.7960e+00, 1.8674e+00, 1.8117e+00, 1.5741e+00],
        [3.8631e+05, 3.8629e+05, 7.9069e+05, 7.6877e+05, 3.8629e+05, 7.9335e+05,
         8.0599e+05, 3.8629e+05, 7.6476e+05, 3.8631e+05, 3.8631e+05, 0.0000e+00,
         7.9025e+05, 3.8629e+05, 3.8628e+05, 3.8632e+05, 3.8629e+05],
        [3.9692e+05, 3.9690e+05, 7.8454e+05, 7.6985e+05, 3.9689e+05, 8.0678e+05,
         8.0653e+05, 3.9688e+05, 8.0573e+05, 3.9690e+05, 3.9691e+05, 7.9025e+05,
         0.0000e+00, 3.9689e+05, 3.9687e+05, 3.9692e+05, 3.9693e+05],
        [1.8306e+00, 1.8049e+00, 3.9528e+05, 3.8639e+05, 1.7603e+00, 4.1272e+05,
         3.9709e+05, 1.8099e+00, 3.8979e+05, 1.7498e+00, 1.7960e+00, 3.8629e+05,
         3.9689e+05, 0.0000e+00, 1.7762e+00, 1.8044e+00, 1.6797e+00],
        [2.1085e+00, 1.9500e+00, 3.9523e+05, 3.8640e+05, 1.8779e+00, 4.1274e+05,
         3.9707e+05, 1.8217e+00, 3.8980e+05, 2.0876e+00, 1.8674e+00, 3.8628e+05,
         3.9687e+05, 1.7762e+00, 0.0000e+00, 2.1848e+00, 1.9744e+00],
        [1.8491e+00, 1.6880e+00, 3.9526e+05, 3.8641e+05, 1.7735e+00, 4.1269e+05,
         3.9705e+05, 1.8481e+00, 3.8978e+05, 1.6905e+00, 1.8117e+00, 3.8632e+05,
         3.9692e+05, 1.8044e+00, 2.1848e+00, 0.0000e+00, 1.7943e+00],
        [1.6794e+00, 1.7055e+00, 3.9524e+05, 3.8641e+05, 1.7758e+00, 4.1270e+05,
         3.9704e+05, 1.7341e+00, 3.8982e+05, 1.6643e+00, 1.5741e+00, 3.8629e+05,
         3.9693e+05, 1.6797e+00, 1.9744e+00, 1.7943e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5972e+00, 1.6213e+00, 1.6794e+00, 1.7569e+00, 1.8059e+00,
        1.8145e+00, 1.8306e+00, 1.8491e+00, 2.1085e+00, 3.8631e+05, 3.8640e+05,
        3.8978e+05, 3.9524e+05, 3.9692e+05, 3.9705e+05, 4.1270e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5972e+00, 1.6235e+00, 1.6880e+00, 1.7034e+00, 1.7055e+00,
        1.7399e+00, 1.8049e+00, 1.9172e+00, 1.9500e+00, 3.8629e+05, 3.8641e+05,
        3.8981e+05, 3.9524e+05, 3.9690e+05, 3.9703e+05, 4.1272e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395218.8750, 395222.5938, 395227.1562, 395227.2500,
        395236.8125, 395240.6562, 395241.0312, 395241.7500, 395260.1875,
        395283.7500, 776264.1875, 783668.0000, 784543.1875, 784785.0000,
        790692.7500, 796146.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386394.9062, 386395.6250, 386395.6875, 386400.1250,
        386407.1250, 386408.3125, 386410.4062, 386411.5938, 386448.3125,
        386453.7188, 768769.6875, 769850.4375, 776264.1875, 781890.6250,
        812507.0625, 814561.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6789e+00, 1.7399e+00, 1.7603e+00, 1.7735e+00, 1.7758e+00,
        1.7792e+00, 1.8059e+00, 1.8266e+00, 1.8779e+00, 3.8629e+05, 3.8645e+05,
        3.8983e+05, 3.9522e+05, 3.9689e+05, 3.9701e+05, 4.1268e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 412684.9688, 412685.0938, 412693.9375, 412699.4062,
        412701.2188, 412717.7500, 412717.9375, 412719.8438, 412723.0625,
        412740.0312, 783668.0000, 793353.5000, 804334.2500, 806775.4375,
        812507.0625, 815137.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397011.6250, 397021.1875, 397031.0938, 397042.2812,
        397044.1250, 397045.4688, 397052.8750, 397072.2812, 397077.5312,
        397092.8750, 775363.6250, 796146.0625, 804334.2500, 805993.1250,
        806527.6250, 814561.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7303e+00, 1.7341e+00, 1.8099e+00, 1.8145e+00, 1.8167e+00,
        1.8217e+00, 1.8266e+00, 1.8481e+00, 1.9172e+00, 3.8629e+05, 3.8645e+05,
        3.8981e+05, 3.9523e+05, 3.9688e+05, 3.9702e+05, 4.1269e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389775.8125, 389776.3750, 389779.2188, 389792.4688,
        389798.2812, 389808.4375, 389813.7500, 389816.5312, 389818.3438,
        389831.2500, 764755.7500, 775363.6250, 781890.6250, 784785.0000,
        805726.5000, 815137.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6213e+00, 1.6643e+00, 1.6905e+00, 1.6957e+00, 1.7034e+00,
        1.7498e+00, 1.7792e+00, 1.8167e+00, 2.0876e+00, 3.8631e+05, 3.8641e+05,
        3.8982e+05, 3.9524e+05, 3.9690e+05, 3.9708e+05, 4.1272e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5741e+00, 1.6235e+00, 1.6789e+00, 1.6957e+00, 1.7303e+00,
        1.7569e+00, 1.7960e+00, 1.8117e+00, 1.8674e+00, 3.8631e+05, 3.8640e+05,
        3.8978e+05, 3.9522e+05, 3.9691e+05, 3.9704e+05, 4.1272e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386284.2812, 386285.9062, 386286.4688, 386286.5938,
        386289.4688, 386293.9375, 386309.6875, 386310.1250, 386310.2188,
        386320.5312, 764755.7500, 768769.6875, 790250.2500, 790692.7500,
        793353.5000, 805993.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396870.5312, 396884.8750, 396885.6875, 396888.1250,
        396902.0312, 396904.7500, 396905.7188, 396915.7188, 396921.7500,
        396929.5938, 769850.4375, 784543.1875, 790250.2500, 805726.5000,
        806527.6250, 806775.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6797e+00, 1.7498e+00, 1.7603e+00, 1.7762e+00, 1.7960e+00,
        1.8044e+00, 1.8049e+00, 1.8099e+00, 1.8306e+00, 3.8629e+05, 3.8639e+05,
        3.8979e+05, 3.9528e+05, 3.9689e+05, 3.9709e+05, 4.1272e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7762e+00, 1.8217e+00, 1.8674e+00, 1.8779e+00, 1.9500e+00,
        1.9744e+00, 2.0876e+00, 2.1085e+00, 2.1848e+00, 3.8628e+05, 3.8640e+05,
        3.8980e+05, 3.9523e+05, 3.9687e+05, 3.9707e+05, 4.1274e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6880e+00, 1.6905e+00, 1.7735e+00, 1.7943e+00, 1.8044e+00,
        1.8117e+00, 1.8481e+00, 1.8491e+00, 2.1848e+00, 3.8632e+05, 3.8641e+05,
        3.8978e+05, 3.9526e+05, 3.9692e+05, 3.9705e+05, 4.1269e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5741e+00, 1.6643e+00, 1.6794e+00, 1.6797e+00, 1.7055e+00,
        1.7341e+00, 1.7758e+00, 1.7943e+00, 1.9744e+00, 3.8629e+05, 3.8641e+05,
        3.8982e+05, 3.9524e+05, 3.9693e+05, 3.9704e+05, 4.1270e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38632.58', '38630.52', '395240.00', '386412.59', '38631.00', '412708.34', '397049.06', '38630.23', '389801.03', '38632.59', '38632.57', '386297.69', '396900.88', '38630.25', '38630.20', '38633.70', '38630.21']
estimated f for each client, fs: [7, 7, 5, 5, 7, 5, 5, 7, 5, 7, 7, 5, 5, 7, 7, 7, 7]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']], selected_client_indices: [7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0120s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:05...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:05, End: 2025-07-22 15:30:05)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 17, 1, 9, 20, 8, 15, 4, 3, 14, 11, 10, 16, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.2021e+00, 3.9779e+05, 1.3351e+00, 1.3333e+00, 3.9034e+05,
         1.4359e+00, 3.9735e+05, 1.2930e+00, 1.2882e+00, 3.9213e+05, 1.2350e+00,
         2.1705e+00, 3.9225e+05, 1.2670e+00],
        [1.2021e+00, 0.0000e+00, 3.9784e+05, 1.3710e+00, 1.3260e+00, 3.9040e+05,
         1.3287e+00, 3.9734e+05, 1.2169e+00, 1.3709e+00, 3.9215e+05, 1.2903e+00,
         2.2802e+00, 3.9226e+05, 1.2358e+00],
        [3.9779e+05, 3.9784e+05, 0.0000e+00, 3.9785e+05, 3.9781e+05, 7.9548e+05,
         3.9783e+05, 7.8023e+05, 3.9779e+05, 3.9780e+05, 7.6822e+05, 3.9784e+05,
         3.9781e+05, 7.7936e+05, 3.9779e+05],
        [1.3351e+00, 1.3710e+00, 3.9785e+05, 0.0000e+00, 1.2676e+00, 3.9035e+05,
         1.3264e+00, 3.9735e+05, 1.3727e+00, 1.4210e+00, 3.9211e+05, 1.2020e+00,
         1.6687e+00, 3.9228e+05, 1.2811e+00],
        [1.3333e+00, 1.3260e+00, 3.9781e+05, 1.2676e+00, 0.0000e+00, 3.9038e+05,
         1.3340e+00, 3.9735e+05, 1.3663e+00, 1.3286e+00, 3.9217e+05, 1.2818e+00,
         2.1022e+00, 3.9226e+05, 1.3016e+00],
        [3.9034e+05, 3.9040e+05, 7.9548e+05, 3.9035e+05, 3.9038e+05, 0.0000e+00,
         3.9036e+05, 7.7997e+05, 3.9037e+05, 3.9036e+05, 7.8916e+05, 3.9036e+05,
         3.9034e+05, 7.9254e+05, 3.9034e+05],
        [1.4359e+00, 1.3287e+00, 3.9783e+05, 1.3264e+00, 1.3340e+00, 3.9036e+05,
         0.0000e+00, 3.9731e+05, 1.3880e+00, 1.3684e+00, 3.9209e+05, 1.3207e+00,
         1.9432e+00, 3.9228e+05, 1.3295e+00],
        [3.9735e+05, 3.9734e+05, 7.8023e+05, 3.9735e+05, 3.9735e+05, 7.7997e+05,
         3.9731e+05, 0.0000e+00, 3.9735e+05, 3.9732e+05, 7.8897e+05, 3.9733e+05,
         3.9734e+05, 7.9906e+05, 3.9733e+05],
        [1.2930e+00, 1.2169e+00, 3.9779e+05, 1.3727e+00, 1.3663e+00, 3.9037e+05,
         1.3880e+00, 3.9735e+05, 0.0000e+00, 1.3905e+00, 3.9212e+05, 1.2548e+00,
         2.3211e+00, 3.9226e+05, 1.2829e+00],
        [1.2882e+00, 1.3709e+00, 3.9780e+05, 1.4210e+00, 1.3286e+00, 3.9036e+05,
         1.3684e+00, 3.9732e+05, 1.3905e+00, 0.0000e+00, 3.9213e+05, 1.3749e+00,
         2.0534e+00, 3.9227e+05, 1.2525e+00],
        [3.9213e+05, 3.9215e+05, 7.6822e+05, 3.9211e+05, 3.9217e+05, 7.8916e+05,
         3.9209e+05, 7.8897e+05, 3.9212e+05, 3.9213e+05, 0.0000e+00, 3.9212e+05,
         3.9213e+05, 7.6713e+05, 3.9212e+05],
        [1.2350e+00, 1.2903e+00, 3.9784e+05, 1.2020e+00, 1.2818e+00, 3.9036e+05,
         1.3207e+00, 3.9733e+05, 1.2548e+00, 1.3749e+00, 3.9212e+05, 0.0000e+00,
         1.8903e+00, 3.9229e+05, 1.2478e+00],
        [2.1705e+00, 2.2802e+00, 3.9781e+05, 1.6687e+00, 2.1022e+00, 3.9034e+05,
         1.9432e+00, 3.9734e+05, 2.3211e+00, 2.0534e+00, 3.9213e+05, 1.8903e+00,
         0.0000e+00, 3.9225e+05, 2.1648e+00],
        [3.9225e+05, 3.9226e+05, 7.7936e+05, 3.9228e+05, 3.9226e+05, 7.9254e+05,
         3.9228e+05, 7.9906e+05, 3.9226e+05, 3.9227e+05, 7.6713e+05, 3.9229e+05,
         3.9225e+05, 0.0000e+00, 3.9228e+05],
        [1.2670e+00, 1.2358e+00, 3.9779e+05, 1.2811e+00, 1.3016e+00, 3.9034e+05,
         1.3295e+00, 3.9733e+05, 1.2829e+00, 1.2525e+00, 3.9212e+05, 1.2478e+00,
         2.1648e+00, 3.9228e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2021e+00, 1.2350e+00, 1.2670e+00, 1.2882e+00, 1.2930e+00,
        1.3333e+00, 1.3351e+00, 1.4359e+00, 2.1705e+00, 3.9034e+05, 3.9213e+05,
        3.9225e+05, 3.9735e+05, 3.9779e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2021e+00, 1.2169e+00, 1.2358e+00, 1.2903e+00, 1.3260e+00,
        1.3287e+00, 1.3709e+00, 1.3710e+00, 2.2802e+00, 3.9040e+05, 3.9215e+05,
        3.9226e+05, 3.9734e+05, 3.9784e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397790.8125, 397792.5625, 397794.4688, 397795.2812,
        397807.0938, 397812.8438, 397825.0312, 397836.5938, 397838.7500,
        397854.6250, 768220.6250, 779363.5000, 780233.3125, 795476.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2020e+00, 1.2676e+00, 1.2811e+00, 1.3264e+00, 1.3351e+00,
        1.3710e+00, 1.3727e+00, 1.4210e+00, 1.6687e+00, 3.9035e+05, 3.9211e+05,
        3.9228e+05, 3.9735e+05, 3.9785e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2676e+00, 1.2818e+00, 1.3016e+00, 1.3260e+00, 1.3286e+00,
        1.3333e+00, 1.3340e+00, 1.3663e+00, 2.1022e+00, 3.9038e+05, 3.9217e+05,
        3.9226e+05, 3.9735e+05, 3.9781e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390339.1250, 390343.3125, 390344.8125, 390354.8750,
        390355.3125, 390357.0625, 390360.5000, 390369.4375, 390378.3125,
        390397.9375, 779970.1875, 789158.2500, 792539.9375, 795476.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3207e+00, 1.3264e+00, 1.3287e+00, 1.3295e+00, 1.3340e+00,
        1.3684e+00, 1.3880e+00, 1.4359e+00, 1.9432e+00, 3.9036e+05, 3.9209e+05,
        3.9228e+05, 3.9731e+05, 3.9783e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397310.2812, 397320.7812, 397326.8125, 397330.3125,
        397335.9375, 397341.5000, 397345.0625, 397345.5625, 397347.0938,
        397352.0312, 779970.1875, 780233.3125, 788971.8750, 799059.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2169e+00, 1.2548e+00, 1.2829e+00, 1.2930e+00, 1.3663e+00,
        1.3727e+00, 1.3880e+00, 1.3905e+00, 2.3211e+00, 3.9037e+05, 3.9212e+05,
        3.9226e+05, 3.9735e+05, 3.9779e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2525e+00, 1.2882e+00, 1.3286e+00, 1.3684e+00, 1.3709e+00,
        1.3749e+00, 1.3905e+00, 1.4210e+00, 2.0534e+00, 3.9036e+05, 3.9213e+05,
        3.9227e+05, 3.9732e+05, 3.9780e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 392091.9688, 392111.8750, 392117.2812, 392118.3750,
        392122.2500, 392131.3125, 392132.8750, 392133.7812, 392151.0938,
        392171.4688, 767126.5000, 768220.6250, 788971.8750, 789158.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2020e+00, 1.2350e+00, 1.2478e+00, 1.2548e+00, 1.2818e+00,
        1.2903e+00, 1.3207e+00, 1.3749e+00, 1.8903e+00, 3.9036e+05, 3.9212e+05,
        3.9229e+05, 3.9733e+05, 3.9784e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.6687e+00, 1.8903e+00, 1.9432e+00, 2.0534e+00, 2.1022e+00,
        2.1648e+00, 2.1705e+00, 2.2802e+00, 2.3211e+00, 3.9034e+05, 3.9213e+05,
        3.9225e+05, 3.9734e+05, 3.9781e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 392249.5000, 392251.2812, 392260.8125, 392262.0625,
        392264.5938, 392269.3438, 392275.4375, 392278.7500, 392279.1562,
        392288.5312, 767126.5000, 779363.5000, 792539.9375, 799059.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2358e+00, 1.2478e+00, 1.2525e+00, 1.2670e+00, 1.2811e+00,
        1.2829e+00, 1.3016e+00, 1.3295e+00, 2.1648e+00, 3.9034e+05, 3.9212e+05,
        3.9228e+05, 3.9733e+05, 3.9779e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.40', '1.40', '397814.81', '1.36', '1.40', '390360.03', '1.42', '397335.56', '1.43', '1.43', '392128.22', '1.34', '2.07', '392267.97', '1.37']
estimated f for each client, fs: [5, 5, 3, 5, 5, 3, 5, 3, 5, 5, 3, 5, 5, 3, 5]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 17, 1, 9, 20, 8, 15, 4, 3, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0193s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:05...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:05, End: 2025-07-22 15:30:05)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 19, 17, 1, 9, 18, 8, 15, 4, 3, 13, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.5375e+00, 3.9033e+05, 4.0195e+05, 1.5374e+00, 1.5522e+00,
         3.8144e+05, 1.6670e+00, 3.7729e+05, 1.4991e+00, 1.4531e+00, 3.8718e+05,
         3.8613e+05, 1.5288e+00, 1.4063e+00],
        [1.5375e+00, 0.0000e+00, 3.9034e+05, 4.0200e+05, 1.5201e+00, 1.4456e+00,
         3.8142e+05, 1.6946e+00, 3.7723e+05, 1.4483e+00, 1.3730e+00, 3.8716e+05,
         3.8609e+05, 1.4306e+00, 1.4496e+00],
        [3.9033e+05, 3.9034e+05, 0.0000e+00, 7.8793e+05, 3.9036e+05, 3.9029e+05,
         7.9013e+05, 3.9036e+05, 7.8686e+05, 3.9033e+05, 3.9035e+05, 7.8563e+05,
         7.6161e+05, 3.9032e+05, 3.9034e+05],
        [4.0195e+05, 4.0200e+05, 7.8793e+05, 0.0000e+00, 4.0199e+05, 4.0197e+05,
         7.8603e+05, 4.0200e+05, 7.7999e+05, 4.0199e+05, 4.0197e+05, 7.7496e+05,
         7.7762e+05, 4.0199e+05, 4.0197e+05],
        [1.5374e+00, 1.5201e+00, 3.9036e+05, 4.0199e+05, 0.0000e+00, 1.4481e+00,
         3.8144e+05, 1.5783e+00, 3.7724e+05, 1.5920e+00, 1.5722e+00, 3.8719e+05,
         3.8615e+05, 1.6085e+00, 1.4754e+00],
        [1.5522e+00, 1.4456e+00, 3.9029e+05, 4.0197e+05, 1.4481e+00, 0.0000e+00,
         3.8140e+05, 1.5597e+00, 3.7725e+05, 1.5017e+00, 1.4105e+00, 3.8717e+05,
         3.8610e+05, 1.4291e+00, 1.4578e+00],
        [3.8144e+05, 3.8142e+05, 7.9013e+05, 7.8603e+05, 3.8144e+05, 3.8140e+05,
         0.0000e+00, 3.8143e+05, 7.4675e+05, 3.8145e+05, 3.8142e+05, 7.6200e+05,
         7.7067e+05, 3.8142e+05, 3.8143e+05],
        [1.6670e+00, 1.6946e+00, 3.9036e+05, 4.0200e+05, 1.5783e+00, 1.5597e+00,
         3.8143e+05, 0.0000e+00, 3.7723e+05, 1.6264e+00, 1.5683e+00, 3.8716e+05,
         3.8611e+05, 1.6057e+00, 1.5115e+00],
        [3.7729e+05, 3.7723e+05, 7.8686e+05, 7.7999e+05, 3.7724e+05, 3.7725e+05,
         7.4675e+05, 3.7723e+05, 0.0000e+00, 3.7724e+05, 3.7726e+05, 7.5108e+05,
         7.6446e+05, 3.7724e+05, 3.7724e+05],
        [1.4991e+00, 1.4483e+00, 3.9033e+05, 4.0199e+05, 1.5920e+00, 1.5017e+00,
         3.8145e+05, 1.6264e+00, 3.7724e+05, 0.0000e+00, 1.5089e+00, 3.8719e+05,
         3.8614e+05, 1.4515e+00, 1.4493e+00],
        [1.4531e+00, 1.3730e+00, 3.9035e+05, 4.0197e+05, 1.5722e+00, 1.4105e+00,
         3.8142e+05, 1.5683e+00, 3.7726e+05, 1.5089e+00, 0.0000e+00, 3.8718e+05,
         3.8614e+05, 1.5169e+00, 1.3732e+00],
        [3.8718e+05, 3.8716e+05, 7.8563e+05, 7.7496e+05, 3.8719e+05, 3.8717e+05,
         7.6200e+05, 3.8716e+05, 7.5108e+05, 3.8719e+05, 3.8718e+05, 0.0000e+00,
         7.7558e+05, 3.8719e+05, 3.8720e+05],
        [3.8613e+05, 3.8609e+05, 7.6161e+05, 7.7762e+05, 3.8615e+05, 3.8610e+05,
         7.7067e+05, 3.8611e+05, 7.6446e+05, 3.8614e+05, 3.8614e+05, 7.7558e+05,
         0.0000e+00, 3.8612e+05, 3.8611e+05],
        [1.5288e+00, 1.4306e+00, 3.9032e+05, 4.0199e+05, 1.6085e+00, 1.4291e+00,
         3.8142e+05, 1.6057e+00, 3.7724e+05, 1.4515e+00, 1.5169e+00, 3.8719e+05,
         3.8612e+05, 0.0000e+00, 1.4824e+00],
        [1.4063e+00, 1.4496e+00, 3.9034e+05, 4.0197e+05, 1.4754e+00, 1.4578e+00,
         3.8143e+05, 1.5115e+00, 3.7724e+05, 1.4493e+00, 1.3732e+00, 3.8720e+05,
         3.8611e+05, 1.4824e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4063e+00, 1.4531e+00, 1.4991e+00, 1.5288e+00, 1.5374e+00,
        1.5375e+00, 1.5522e+00, 1.6670e+00, 3.7729e+05, 3.8144e+05, 3.8613e+05,
        3.8718e+05, 3.9033e+05, 4.0195e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3730e+00, 1.4306e+00, 1.4456e+00, 1.4483e+00, 1.4496e+00,
        1.5201e+00, 1.5375e+00, 1.6946e+00, 3.7723e+05, 3.8142e+05, 3.8609e+05,
        3.8716e+05, 3.9034e+05, 4.0200e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 390292.7500, 390316.0938, 390327.6250, 390334.9375,
        390335.8125, 390344.5938, 390347.1250, 390358.7500, 390364.7812,
        761610.5000, 785627.1875, 786857.0000, 787927.1875, 790131.6875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 401954.1875, 401967.4688, 401969.9375, 401972.0000,
        401985.0625, 401986.1875, 401993.0938, 401995.8750, 401996.1562,
        774958.6250, 777623.6250, 779990.9375, 786025.3750, 787927.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4481e+00, 1.4754e+00, 1.5201e+00, 1.5374e+00, 1.5722e+00,
        1.5783e+00, 1.5920e+00, 1.6085e+00, 3.7724e+05, 3.8144e+05, 3.8615e+05,
        3.8719e+05, 3.9036e+05, 4.0199e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4105e+00, 1.4291e+00, 1.4456e+00, 1.4481e+00, 1.4578e+00,
        1.5017e+00, 1.5522e+00, 1.5597e+00, 3.7725e+05, 3.8140e+05, 3.8610e+05,
        3.8717e+05, 3.9029e+05, 4.0197e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 381400.4688, 381417.6562, 381419.3750, 381424.5000,
        381425.5312, 381426.7500, 381440.5938, 381445.0000, 381450.0938,
        746753.6250, 761999.3125, 770672.3750, 786025.3750, 790131.6875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.5115e+00, 1.5597e+00, 1.5683e+00, 1.5783e+00, 1.6057e+00,
        1.6264e+00, 1.6670e+00, 1.6946e+00, 3.7723e+05, 3.8143e+05, 3.8611e+05,
        3.8716e+05, 3.9036e+05, 4.0200e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 377228.3750, 377231.1875, 377236.2812, 377236.6250,
        377239.8125, 377243.5938, 377254.5000, 377264.8438, 377290.1875,
        746753.6250, 751075.6875, 764457.3125, 779990.9375, 786857.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4483e+00, 1.4493e+00, 1.4515e+00, 1.4991e+00, 1.5017e+00,
        1.5089e+00, 1.5920e+00, 1.6264e+00, 3.7724e+05, 3.8145e+05, 3.8614e+05,
        3.8719e+05, 3.9033e+05, 4.0199e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3730e+00, 1.3732e+00, 1.4105e+00, 1.4531e+00, 1.5089e+00,
        1.5169e+00, 1.5683e+00, 1.5722e+00, 3.7726e+05, 3.8142e+05, 3.8614e+05,
        3.8718e+05, 3.9035e+05, 4.0197e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387161.1875, 387163.7812, 387169.6562, 387181.6875,
        387185.0000, 387186.5938, 387187.8125, 387189.8125, 387202.4375,
        751075.6875, 761999.3125, 774958.6250, 775576.7500, 785627.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386093.0625, 386102.1250, 386109.3750, 386111.2812,
        386118.7812, 386125.3438, 386137.3125, 386143.2500, 386152.1562,
        761610.5000, 764457.3125, 770672.3750, 775576.7500, 777623.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4291e+00, 1.4306e+00, 1.4515e+00, 1.4824e+00, 1.5169e+00,
        1.5288e+00, 1.6057e+00, 1.6085e+00, 3.7724e+05, 3.8142e+05, 3.8612e+05,
        3.8719e+05, 3.9032e+05, 4.0199e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3732e+00, 1.4063e+00, 1.4493e+00, 1.4496e+00, 1.4578e+00,
        1.4754e+00, 1.4824e+00, 1.5115e+00, 3.7724e+05, 3.8143e+05, 3.8611e+05,
        3.8720e+05, 3.9034e+05, 4.0197e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['41922.48', '41915.59', '390335.81', '401980.03', '41916.55', '41918.48', '381427.81', '41916.01', '377247.28', '41916.48', '41919.63', '387180.88', '386121.41', '41916.88', '41917.25']
estimated f for each client, fs: [6, 6, 4, 4, 6, 6, 4, 6, 4, 6, 6, 4, 4, 6, 6]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 19, 17, 1, 9, 18, 8, 15, 4, 3, 13, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0101s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:06...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:06, End: 2025-07-22 15:30:06)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.7216e+00, 3.9196e+05, 1.5510e+00, 1.6284e+00, 3.8180e+05,
         3.9744e+05, 1.7216e+00, 3.9540e+05, 1.5302e+00, 1.5341e+00, 3.9582e+05,
         3.9237e+05, 1.6353e+00, 3.8745e+05, 1.6145e+00, 1.5354e+00],
        [1.7216e+00, 0.0000e+00, 3.9194e+05, 1.5791e+00, 1.5914e+00, 3.8181e+05,
         3.9739e+05, 1.7658e+00, 3.9540e+05, 1.7130e+00, 1.6096e+00, 3.9575e+05,
         3.9240e+05, 1.6223e+00, 3.8751e+05, 1.7719e+00, 1.6870e+00],
        [3.9196e+05, 3.9194e+05, 0.0000e+00, 3.9197e+05, 3.9195e+05, 7.7971e+05,
         8.0767e+05, 3.9196e+05, 7.8602e+05, 3.9193e+05, 3.9194e+05, 7.7911e+05,
         8.0374e+05, 3.9198e+05, 7.5543e+05, 3.9194e+05, 3.9194e+05],
        [1.5510e+00, 1.5791e+00, 3.9197e+05, 0.0000e+00, 1.5215e+00, 3.8178e+05,
         3.9741e+05, 1.6166e+00, 3.9536e+05, 1.6716e+00, 1.7186e+00, 3.9581e+05,
         3.9241e+05, 1.4694e+00, 3.8749e+05, 1.6396e+00, 1.5554e+00],
        [1.6284e+00, 1.5914e+00, 3.9195e+05, 1.5215e+00, 0.0000e+00, 3.8179e+05,
         3.9743e+05, 1.6825e+00, 3.9537e+05, 1.5826e+00, 1.5600e+00, 3.9581e+05,
         3.9240e+05, 1.7607e+00, 3.8745e+05, 1.5482e+00, 1.5862e+00],
        [3.8180e+05, 3.8181e+05, 7.7971e+05, 3.8178e+05, 3.8179e+05, 0.0000e+00,
         7.9933e+05, 3.8177e+05, 7.7797e+05, 3.8179e+05, 3.8180e+05, 7.7491e+05,
         7.6188e+05, 3.8180e+05, 7.5618e+05, 3.8182e+05, 3.8181e+05],
        [3.9744e+05, 3.9739e+05, 8.0767e+05, 3.9741e+05, 3.9743e+05, 7.9933e+05,
         0.0000e+00, 3.9742e+05, 8.0855e+05, 3.9743e+05, 3.9744e+05, 7.9675e+05,
         7.7742e+05, 3.9742e+05, 8.0149e+05, 3.9744e+05, 3.9742e+05],
        [1.7216e+00, 1.7658e+00, 3.9196e+05, 1.6166e+00, 1.6825e+00, 3.8177e+05,
         3.9742e+05, 0.0000e+00, 3.9537e+05, 1.6605e+00, 1.7046e+00, 3.9581e+05,
         3.9234e+05, 1.6466e+00, 3.8744e+05, 1.7165e+00, 1.6547e+00],
        [3.9540e+05, 3.9540e+05, 7.8602e+05, 3.9536e+05, 3.9537e+05, 7.7797e+05,
         8.0855e+05, 3.9537e+05, 0.0000e+00, 3.9534e+05, 3.9539e+05, 7.9968e+05,
         7.9452e+05, 3.9535e+05, 7.9584e+05, 3.9535e+05, 3.9536e+05],
        [1.5302e+00, 1.7130e+00, 3.9193e+05, 1.6716e+00, 1.5826e+00, 3.8179e+05,
         3.9743e+05, 1.6605e+00, 3.9534e+05, 0.0000e+00, 1.5744e+00, 3.9583e+05,
         3.9238e+05, 1.8305e+00, 3.8744e+05, 1.5324e+00, 1.5243e+00],
        [1.5341e+00, 1.6096e+00, 3.9194e+05, 1.7186e+00, 1.5600e+00, 3.8180e+05,
         3.9744e+05, 1.7046e+00, 3.9539e+05, 1.5744e+00, 0.0000e+00, 3.9581e+05,
         3.9239e+05, 1.7672e+00, 3.8745e+05, 1.6888e+00, 1.4595e+00],
        [3.9582e+05, 3.9575e+05, 7.7911e+05, 3.9581e+05, 3.9581e+05, 7.7491e+05,
         7.9675e+05, 3.9581e+05, 7.9968e+05, 3.9583e+05, 3.9581e+05, 0.0000e+00,
         7.9321e+05, 3.9580e+05, 7.7385e+05, 3.9581e+05, 3.9582e+05],
        [3.9237e+05, 3.9240e+05, 8.0374e+05, 3.9241e+05, 3.9240e+05, 7.6188e+05,
         7.7742e+05, 3.9234e+05, 7.9452e+05, 3.9238e+05, 3.9239e+05, 7.9321e+05,
         0.0000e+00, 3.9238e+05, 7.6401e+05, 3.9237e+05, 3.9239e+05],
        [1.6353e+00, 1.6223e+00, 3.9198e+05, 1.4694e+00, 1.7607e+00, 3.8180e+05,
         3.9742e+05, 1.6466e+00, 3.9535e+05, 1.8305e+00, 1.7672e+00, 3.9580e+05,
         3.9238e+05, 0.0000e+00, 3.8747e+05, 1.8243e+00, 1.6708e+00],
        [3.8745e+05, 3.8751e+05, 7.5543e+05, 3.8749e+05, 3.8745e+05, 7.5618e+05,
         8.0149e+05, 3.8744e+05, 7.9584e+05, 3.8744e+05, 3.8745e+05, 7.7385e+05,
         7.6401e+05, 3.8747e+05, 0.0000e+00, 3.8750e+05, 3.8747e+05],
        [1.6145e+00, 1.7719e+00, 3.9194e+05, 1.6396e+00, 1.5482e+00, 3.8182e+05,
         3.9744e+05, 1.7165e+00, 3.9535e+05, 1.5324e+00, 1.6888e+00, 3.9581e+05,
         3.9237e+05, 1.8243e+00, 3.8750e+05, 0.0000e+00, 1.6042e+00],
        [1.5354e+00, 1.6870e+00, 3.9194e+05, 1.5554e+00, 1.5862e+00, 3.8181e+05,
         3.9742e+05, 1.6547e+00, 3.9536e+05, 1.5243e+00, 1.4595e+00, 3.9582e+05,
         3.9239e+05, 1.6708e+00, 3.8747e+05, 1.6042e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5302e+00, 1.5341e+00, 1.5354e+00, 1.5510e+00, 1.6145e+00,
        1.6284e+00, 1.6353e+00, 1.7216e+00, 1.7216e+00, 3.8180e+05, 3.8745e+05,
        3.9196e+05, 3.9237e+05, 3.9540e+05, 3.9582e+05, 3.9744e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5791e+00, 1.5914e+00, 1.6096e+00, 1.6223e+00, 1.6870e+00,
        1.7130e+00, 1.7216e+00, 1.7658e+00, 1.7719e+00, 3.8181e+05, 3.8751e+05,
        3.9194e+05, 3.9240e+05, 3.9540e+05, 3.9575e+05, 3.9739e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391928.2812, 391939.2812, 391939.8125, 391941.2500,
        391944.5000, 391950.5938, 391956.0625, 391956.3438, 391966.3438,
        391981.0625, 755427.8750, 779108.4375, 779714.6250, 786015.5000,
        803740.4375, 807670.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4694e+00, 1.5215e+00, 1.5510e+00, 1.5554e+00, 1.5791e+00,
        1.6166e+00, 1.6396e+00, 1.6716e+00, 1.7186e+00, 3.8178e+05, 3.8749e+05,
        3.9197e+05, 3.9241e+05, 3.9536e+05, 3.9581e+05, 3.9741e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5215e+00, 1.5482e+00, 1.5600e+00, 1.5826e+00, 1.5862e+00,
        1.5914e+00, 1.6284e+00, 1.6825e+00, 1.7607e+00, 3.8179e+05, 3.8745e+05,
        3.9195e+05, 3.9240e+05, 3.9537e+05, 3.9581e+05, 3.9743e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381768.2500, 381781.9375, 381791.8125, 381792.0000,
        381795.0000, 381803.0000, 381804.6250, 381805.5312, 381811.5312,
        381819.3750, 756182.1250, 761875.1875, 774914.5000, 777971.5625,
        779714.6250, 799325.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397387.2188, 397409.7500, 397421.4688, 397423.3750,
        397424.0625, 397426.4375, 397434.4375, 397436.4062, 397442.8438,
        397443.4688, 777420.5625, 796748.1250, 799325.5625, 801491.0000,
        807670.6250, 808546.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6166e+00, 1.6466e+00, 1.6547e+00, 1.6605e+00, 1.6825e+00,
        1.7046e+00, 1.7165e+00, 1.7216e+00, 1.7658e+00, 3.8177e+05, 3.8744e+05,
        3.9196e+05, 3.9234e+05, 3.9537e+05, 3.9581e+05, 3.9742e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395338.4062, 395351.4375, 395353.1562, 395356.5625,
        395357.9688, 395366.9062, 395371.3125, 395390.1250, 395395.4375,
        395399.9375, 777971.5625, 786015.5000, 794521.1875, 795838.1250,
        799680.0000, 808546.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5243e+00, 1.5302e+00, 1.5324e+00, 1.5744e+00, 1.5826e+00,
        1.6605e+00, 1.6716e+00, 1.7130e+00, 1.8305e+00, 3.8179e+05, 3.8744e+05,
        3.9193e+05, 3.9238e+05, 3.9534e+05, 3.9583e+05, 3.9743e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4595e+00, 1.5341e+00, 1.5600e+00, 1.5744e+00, 1.6096e+00,
        1.6888e+00, 1.7046e+00, 1.7186e+00, 1.7672e+00, 3.8180e+05, 3.8745e+05,
        3.9194e+05, 3.9239e+05, 3.9539e+05, 3.9581e+05, 3.9744e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395751.1875, 395795.0625, 395806.5312, 395809.8438,
        395810.0938, 395811.5312, 395814.2812, 395819.5625, 395823.2188,
        395827.7500, 773846.8750, 774914.5000, 779108.4375, 793206.4375,
        796748.1250, 799680.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392343.1250, 392368.1250, 392372.3125, 392381.0312,
        392383.4688, 392391.0000, 392391.1562, 392397.7188, 392402.4375,
        392413.2500, 761875.1875, 764011.5000, 777420.5625, 793206.4375,
        794521.1875, 803740.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4694e+00, 1.6223e+00, 1.6353e+00, 1.6466e+00, 1.6708e+00,
        1.7607e+00, 1.7672e+00, 1.8243e+00, 1.8305e+00, 3.8180e+05, 3.8747e+05,
        3.9198e+05, 3.9238e+05, 3.9535e+05, 3.9580e+05, 3.9742e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387435.5625, 387438.0312, 387451.8438, 387452.2500,
        387454.8438, 387469.3438, 387473.6250, 387486.8125, 387500.7812,
        387511.2500, 755427.8750, 756182.1250, 764011.5000, 773846.8750,
        795838.1250, 801491.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5324e+00, 1.5482e+00, 1.6042e+00, 1.6145e+00, 1.6396e+00,
        1.6888e+00, 1.7165e+00, 1.7719e+00, 1.8243e+00, 3.8182e+05, 3.8750e+05,
        3.9194e+05, 3.9237e+05, 3.9535e+05, 3.9581e+05, 3.9744e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4595e+00, 1.5243e+00, 1.5354e+00, 1.5554e+00, 1.5862e+00,
        1.6042e+00, 1.6547e+00, 1.6708e+00, 1.6870e+00, 3.8181e+05, 3.8747e+05,
        3.9194e+05, 3.9239e+05, 3.9536e+05, 3.9582e+05, 3.9742e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38181.75', '38182.66', '391950.34', '38179.63', '38180.65', '381797.31', '397424.94', '38178.34', '395368.12', '38180.64', '38181.92', '395806.91', '392384.34', '38181.02', '387467.44', '38183.43', '38181.98']
estimated f for each client, fs: [7, 7, 5, 7, 7, 5, 5, 7, 5, 7, 7, 5, 5, 7, 5, 7, 7]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0185s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:07...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:07, End: 2025-07-22 15:30:07)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [19, 17, 1, 9, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 7.5041e+05, 3.8975e+05, 3.8973e+05, 7.8310e+05, 3.8973e+05,
         8.0246e+05, 3.8972e+05, 3.8974e+05, 7.9046e+05, 8.0403e+05, 3.8977e+05,
         3.8980e+05, 7.7672e+05, 3.8970e+05],
        [7.5041e+05, 0.0000e+00, 3.7820e+05, 3.7819e+05, 7.7452e+05, 3.7819e+05,
         7.6894e+05, 3.7821e+05, 3.7819e+05, 7.7631e+05, 7.8210e+05, 3.7819e+05,
         3.7818e+05, 7.4743e+05, 3.7818e+05],
        [3.8975e+05, 3.7820e+05, 0.0000e+00, 1.3071e+00, 3.8723e+05, 1.6637e+00,
         3.8303e+05, 1.4318e+00, 1.4901e+00, 3.9868e+05, 4.0140e+05, 1.3542e+00,
         1.4545e+00, 3.8343e+05, 1.3955e+00],
        [3.8973e+05, 3.7819e+05, 1.3071e+00, 0.0000e+00, 3.8727e+05, 1.8644e+00,
         3.8304e+05, 1.4405e+00, 1.3761e+00, 3.9869e+05, 4.0141e+05, 1.5685e+00,
         1.7404e+00, 3.8342e+05, 1.4147e+00],
        [7.8310e+05, 7.7452e+05, 3.8723e+05, 3.8727e+05, 0.0000e+00, 3.8719e+05,
         7.6470e+05, 3.8722e+05, 3.8725e+05, 7.9935e+05, 7.9390e+05, 3.8725e+05,
         3.8724e+05, 7.7766e+05, 3.8724e+05],
        [3.8973e+05, 3.7819e+05, 1.6637e+00, 1.8644e+00, 3.8719e+05, 0.0000e+00,
         3.8305e+05, 1.9754e+00, 1.8613e+00, 3.9865e+05, 4.0141e+05, 1.4449e+00,
         1.3915e+00, 3.8342e+05, 1.8587e+00],
        [8.0246e+05, 7.6894e+05, 3.8303e+05, 3.8304e+05, 7.6470e+05, 3.8305e+05,
         0.0000e+00, 3.8304e+05, 3.8303e+05, 7.6985e+05, 7.6533e+05, 3.8304e+05,
         3.8305e+05, 7.6000e+05, 3.8304e+05],
        [3.8972e+05, 3.7821e+05, 1.4318e+00, 1.4405e+00, 3.8722e+05, 1.9754e+00,
         3.8304e+05, 0.0000e+00, 1.4189e+00, 3.9865e+05, 4.0141e+05, 1.6182e+00,
         1.9868e+00, 3.8342e+05, 1.4114e+00],
        [3.8974e+05, 3.7819e+05, 1.4901e+00, 1.3761e+00, 3.8725e+05, 1.8613e+00,
         3.8303e+05, 1.4189e+00, 0.0000e+00, 3.9863e+05, 4.0140e+05, 1.6335e+00,
         1.7888e+00, 3.8342e+05, 1.3499e+00],
        [7.9046e+05, 7.7631e+05, 3.9868e+05, 3.9869e+05, 7.9935e+05, 3.9865e+05,
         7.6985e+05, 3.9865e+05, 3.9863e+05, 0.0000e+00, 7.9437e+05, 3.9865e+05,
         3.9867e+05, 7.7086e+05, 3.9862e+05],
        [8.0403e+05, 7.8210e+05, 4.0140e+05, 4.0141e+05, 7.9390e+05, 4.0141e+05,
         7.6533e+05, 4.0141e+05, 4.0140e+05, 7.9437e+05, 0.0000e+00, 4.0138e+05,
         4.0141e+05, 7.8827e+05, 4.0141e+05],
        [3.8977e+05, 3.7819e+05, 1.3542e+00, 1.5685e+00, 3.8725e+05, 1.4449e+00,
         3.8304e+05, 1.6182e+00, 1.6335e+00, 3.9865e+05, 4.0138e+05, 0.0000e+00,
         1.3206e+00, 3.8342e+05, 1.5312e+00],
        [3.8980e+05, 3.7818e+05, 1.4545e+00, 1.7404e+00, 3.8724e+05, 1.3915e+00,
         3.8305e+05, 1.9868e+00, 1.7888e+00, 3.9867e+05, 4.0141e+05, 1.3206e+00,
         0.0000e+00, 3.8341e+05, 1.8228e+00],
        [7.7672e+05, 7.4743e+05, 3.8343e+05, 3.8342e+05, 7.7766e+05, 3.8342e+05,
         7.6000e+05, 3.8342e+05, 3.8342e+05, 7.7086e+05, 7.8827e+05, 3.8342e+05,
         3.8341e+05, 0.0000e+00, 3.8343e+05],
        [3.8970e+05, 3.7818e+05, 1.3955e+00, 1.4147e+00, 3.8724e+05, 1.8587e+00,
         3.8304e+05, 1.4114e+00, 1.3499e+00, 3.9862e+05, 4.0141e+05, 1.5312e+00,
         1.8228e+00, 3.8343e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 389703.1250, 389716.9688, 389731.9688, 389733.6562,
        389737.2188, 389745.2188, 389765.0938, 389795.8750, 750411.6875,
        776716.1875, 783098.1250, 790456.3125, 802455.8750, 804028.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 378180.5000, 378183.0625, 378188.4062, 378192.4688,
        378193.8438, 378194.0312, 378198.9375, 378205.5312, 747434.6250,
        750411.6875, 768945.0000, 774521.8750, 776312.3750, 782104.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3071e+00, 1.3542e+00, 1.3955e+00, 1.4318e+00, 1.4545e+00,
        1.4901e+00, 1.6637e+00, 3.7820e+05, 3.8303e+05, 3.8343e+05, 3.8723e+05,
        3.8975e+05, 3.9868e+05, 4.0140e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3071e+00, 1.3761e+00, 1.4147e+00, 1.4405e+00, 1.5685e+00,
        1.7404e+00, 1.8644e+00, 3.7819e+05, 3.8304e+05, 3.8342e+05, 3.8727e+05,
        3.8973e+05, 3.9869e+05, 4.0141e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 387193.8750, 387223.9688, 387232.3125, 387235.7500,
        387238.4062, 387251.0625, 387253.1875, 387271.7500, 764701.2500,
        774521.8750, 777659.1875, 783098.1250, 793897.3750, 799350.9375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3915e+00, 1.4449e+00, 1.6637e+00, 1.8587e+00, 1.8613e+00,
        1.8644e+00, 1.9754e+00, 3.7819e+05, 3.8305e+05, 3.8342e+05, 3.8719e+05,
        3.8973e+05, 3.9865e+05, 4.0141e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 383028.2188, 383030.9062, 383037.3750, 383039.5938,
        383040.1562, 383043.1250, 383047.6562, 383051.2500, 759998.3750,
        764701.2500, 765326.2500, 768945.0000, 769848.8750, 802455.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4114e+00, 1.4189e+00, 1.4318e+00, 1.4405e+00, 1.6182e+00,
        1.9754e+00, 1.9868e+00, 3.7821e+05, 3.8304e+05, 3.8342e+05, 3.8722e+05,
        3.8972e+05, 3.9865e+05, 4.0141e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3499e+00, 1.3761e+00, 1.4189e+00, 1.4901e+00, 1.6335e+00,
        1.7888e+00, 1.8613e+00, 3.7819e+05, 3.8303e+05, 3.8342e+05, 3.8725e+05,
        3.8974e+05, 3.9863e+05, 4.0140e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 398618.4688, 398632.2500, 398645.5625, 398652.1250,
        398654.4062, 398666.7812, 398675.3750, 398686.3750, 769848.8750,
        770856.9375, 776312.3750, 790456.3125, 794370.8750, 799350.9375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 401378.0625, 401396.9375, 401400.3438, 401407.3438,
        401409.3750, 401410.0625, 401414.1250, 401414.9688, 765326.2500,
        782104.7500, 788270.6250, 793897.3750, 794370.8750, 804028.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3206e+00, 1.3542e+00, 1.4449e+00, 1.5312e+00, 1.5685e+00,
        1.6182e+00, 1.6335e+00, 3.7819e+05, 3.8304e+05, 3.8342e+05, 3.8725e+05,
        3.8977e+05, 3.9865e+05, 4.0138e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3206e+00, 1.3915e+00, 1.4545e+00, 1.7404e+00, 1.7888e+00,
        1.8228e+00, 1.9868e+00, 3.7818e+05, 3.8305e+05, 3.8341e+05, 3.8724e+05,
        3.8980e+05, 3.9867e+05, 4.0141e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 383413.5625, 383418.9062, 383420.3750, 383421.3750,
        383421.8438, 383423.9375, 383428.9062, 383431.1250, 747434.6250,
        759998.3750, 770856.9375, 776716.1875, 777659.1875, 788270.6250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3499e+00, 1.3955e+00, 1.4114e+00, 1.4147e+00, 1.5312e+00,
        1.8228e+00, 1.8587e+00, 3.7818e+05, 3.8304e+05, 3.8343e+05, 3.8724e+05,
        3.8970e+05, 3.9862e+05, 4.0141e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['429815.66', '419219.03', '84581.92', '84582.77', '429177.94', '84583.52', '424924.06', '84583.80', '84581.74', '439897.78', '441839.72', '84582.50', '84582.19', '423868.25', '84581.88']
estimated f for each client, fs: [5, 5, 7, 7, 5, 7, 5, 7, 7, 5, 5, 7, 7, 5, 7]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [19, 17, 1, 9, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0098s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:07...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:07, End: 2025-07-22 15:30:07)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.5288e+00, 3.8137e+05, 3.9717e+05, 1.4671e+00, 1.4638e+00,
         3.9266e+05, 4.0315e+05, 3.9470e+05, 1.4284e+00, 1.8588e+00, 3.9827e+05,
         3.9545e+05, 2.0432e+00, 3.9386e+05, 1.5110e+00, 1.4407e+00],
        [1.5288e+00, 0.0000e+00, 3.8142e+05, 3.9719e+05, 1.4105e+00, 1.4534e+00,
         3.9266e+05, 4.0318e+05, 3.9473e+05, 1.4841e+00, 1.5918e+00, 3.9826e+05,
         3.9547e+05, 1.5392e+00, 3.9393e+05, 1.5726e+00, 1.5090e+00],
        [3.8137e+05, 3.8142e+05, 0.0000e+00, 7.7298e+05, 3.8139e+05, 3.8144e+05,
         7.5998e+05, 7.7821e+05, 7.8093e+05, 3.8142e+05, 3.8142e+05, 7.9313e+05,
         7.9015e+05, 3.8144e+05, 7.7290e+05, 3.8142e+05, 3.8138e+05],
        [3.9717e+05, 3.9719e+05, 7.7298e+05, 0.0000e+00, 3.9716e+05, 3.9718e+05,
         8.1127e+05, 7.8754e+05, 7.9753e+05, 3.9718e+05, 3.9718e+05, 7.9467e+05,
         8.0270e+05, 3.9717e+05, 8.0855e+05, 3.9716e+05, 3.9720e+05],
        [1.4671e+00, 1.4105e+00, 3.8139e+05, 3.9716e+05, 0.0000e+00, 1.3750e+00,
         3.9270e+05, 4.0316e+05, 3.9474e+05, 1.5168e+00, 1.6657e+00, 3.9829e+05,
         3.9544e+05, 1.5477e+00, 3.9394e+05, 1.4934e+00, 1.3908e+00],
        [1.4638e+00, 1.4534e+00, 3.8144e+05, 3.9718e+05, 1.3750e+00, 0.0000e+00,
         3.9268e+05, 4.0314e+05, 3.9471e+05, 1.5356e+00, 1.7194e+00, 3.9824e+05,
         3.9548e+05, 1.7541e+00, 3.9393e+05, 1.4551e+00, 1.4726e+00],
        [3.9266e+05, 3.9266e+05, 7.5998e+05, 8.1127e+05, 3.9270e+05, 3.9268e+05,
         0.0000e+00, 7.9936e+05, 7.7927e+05, 3.9266e+05, 3.9264e+05, 7.9038e+05,
         7.7313e+05, 3.9266e+05, 7.8266e+05, 3.9269e+05, 3.9266e+05],
        [4.0315e+05, 4.0318e+05, 7.7821e+05, 7.8754e+05, 4.0316e+05, 4.0314e+05,
         7.9936e+05, 0.0000e+00, 7.7613e+05, 4.0315e+05, 4.0313e+05, 7.7247e+05,
         7.9359e+05, 4.0312e+05, 8.0540e+05, 4.0317e+05, 4.0316e+05],
        [3.9470e+05, 3.9473e+05, 7.8093e+05, 7.9753e+05, 3.9474e+05, 3.9471e+05,
         7.7927e+05, 7.7613e+05, 0.0000e+00, 3.9471e+05, 3.9475e+05, 7.9580e+05,
         7.7538e+05, 3.9474e+05, 7.8878e+05, 3.9468e+05, 3.9470e+05],
        [1.4284e+00, 1.4841e+00, 3.8142e+05, 3.9718e+05, 1.5168e+00, 1.5356e+00,
         3.9266e+05, 4.0315e+05, 3.9471e+05, 0.0000e+00, 1.8331e+00, 3.9826e+05,
         3.9545e+05, 2.0505e+00, 3.9392e+05, 1.4665e+00, 1.4772e+00],
        [1.8588e+00, 1.5918e+00, 3.8142e+05, 3.9718e+05, 1.6657e+00, 1.7194e+00,
         3.9264e+05, 4.0313e+05, 3.9475e+05, 1.8331e+00, 0.0000e+00, 3.9829e+05,
         3.9545e+05, 1.5066e+00, 3.9388e+05, 1.9809e+00, 1.6514e+00],
        [3.9827e+05, 3.9826e+05, 7.9313e+05, 7.9467e+05, 3.9829e+05, 3.9824e+05,
         7.9038e+05, 7.7247e+05, 7.9580e+05, 3.9826e+05, 3.9829e+05, 0.0000e+00,
         8.1446e+05, 3.9822e+05, 7.9710e+05, 3.9827e+05, 3.9825e+05],
        [3.9545e+05, 3.9547e+05, 7.9015e+05, 8.0270e+05, 3.9544e+05, 3.9548e+05,
         7.7313e+05, 7.9359e+05, 7.7538e+05, 3.9545e+05, 3.9545e+05, 8.1446e+05,
         0.0000e+00, 3.9547e+05, 7.7001e+05, 3.9549e+05, 3.9544e+05],
        [2.0432e+00, 1.5392e+00, 3.8144e+05, 3.9717e+05, 1.5477e+00, 1.7541e+00,
         3.9266e+05, 4.0312e+05, 3.9474e+05, 2.0505e+00, 1.5066e+00, 3.9822e+05,
         3.9547e+05, 0.0000e+00, 3.9391e+05, 2.1012e+00, 1.8455e+00],
        [3.9386e+05, 3.9393e+05, 7.7290e+05, 8.0855e+05, 3.9394e+05, 3.9393e+05,
         7.8266e+05, 8.0540e+05, 7.8878e+05, 3.9392e+05, 3.9388e+05, 7.9710e+05,
         7.7001e+05, 3.9391e+05, 0.0000e+00, 3.9391e+05, 3.9394e+05],
        [1.5110e+00, 1.5726e+00, 3.8142e+05, 3.9716e+05, 1.4934e+00, 1.4551e+00,
         3.9269e+05, 4.0317e+05, 3.9468e+05, 1.4665e+00, 1.9809e+00, 3.9827e+05,
         3.9549e+05, 2.1012e+00, 3.9391e+05, 0.0000e+00, 1.4657e+00],
        [1.4407e+00, 1.5090e+00, 3.8138e+05, 3.9720e+05, 1.3908e+00, 1.4726e+00,
         3.9266e+05, 4.0316e+05, 3.9470e+05, 1.4772e+00, 1.6514e+00, 3.9825e+05,
         3.9544e+05, 1.8455e+00, 3.9394e+05, 1.4657e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4284e+00, 1.4407e+00, 1.4638e+00, 1.4671e+00, 1.5110e+00,
        1.5288e+00, 1.8588e+00, 2.0432e+00, 3.8137e+05, 3.9266e+05, 3.9386e+05,
        3.9470e+05, 3.9545e+05, 3.9717e+05, 3.9827e+05, 4.0315e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4105e+00, 1.4534e+00, 1.4841e+00, 1.5090e+00, 1.5288e+00,
        1.5392e+00, 1.5726e+00, 1.5918e+00, 3.8142e+05, 3.9266e+05, 3.9393e+05,
        3.9473e+05, 3.9547e+05, 3.9719e+05, 3.9826e+05, 4.0318e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381373.1875, 381382.0625, 381394.0938, 381416.1875,
        381418.5625, 381420.5000, 381424.0312, 381435.2500, 381437.8750,
        759977.1250, 772895.2500, 772977.1250, 778205.0625, 780934.5000,
        790151.5000, 793127.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397156.9375, 397164.4375, 397165.3125, 397166.0000,
        397177.5938, 397179.6562, 397181.0000, 397185.5938, 397204.4688,
        772977.1250, 787537.8125, 794665.3125, 797528.3750, 802700.0625,
        808553.7500, 811267.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3750e+00, 1.3908e+00, 1.4105e+00, 1.4671e+00, 1.4934e+00,
        1.5168e+00, 1.5477e+00, 1.6657e+00, 3.8139e+05, 3.9270e+05, 3.9394e+05,
        3.9474e+05, 3.9544e+05, 3.9716e+05, 3.9829e+05, 4.0316e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3750e+00, 1.4534e+00, 1.4551e+00, 1.4638e+00, 1.4726e+00,
        1.5356e+00, 1.7194e+00, 1.7541e+00, 3.8144e+05, 3.9268e+05, 3.9393e+05,
        3.9471e+05, 3.9548e+05, 3.9718e+05, 3.9824e+05, 4.0314e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392644.1250, 392655.9375, 392656.0000, 392656.0312,
        392656.7500, 392662.2188, 392678.3750, 392687.3125, 392699.5000,
        759977.1250, 773126.6250, 779272.7500, 782656.5000, 790377.8125,
        799359.1875, 811267.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403118.0625, 403132.9688, 403144.5000, 403149.5000,
        403152.8125, 403157.3750, 403162.1250, 403167.5000, 403180.5312,
        772468.9375, 776125.8750, 778205.0625, 787537.8125, 793588.6250,
        799359.1875, 805403.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394684.2500, 394698.7188, 394700.7500, 394705.7812,
        394710.3750, 394726.2500, 394739.5312, 394742.3438, 394746.0312,
        775377.7500, 776125.8750, 779272.7500, 780934.5000, 788784.3750,
        795805.0000, 797528.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4284e+00, 1.4665e+00, 1.4772e+00, 1.4841e+00, 1.5168e+00,
        1.5356e+00, 1.8331e+00, 2.0505e+00, 3.8142e+05, 3.9266e+05, 3.9392e+05,
        3.9471e+05, 3.9545e+05, 3.9718e+05, 3.9826e+05, 4.0315e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5066e+00, 1.5918e+00, 1.6514e+00, 1.6657e+00, 1.7194e+00,
        1.8331e+00, 1.8588e+00, 1.9809e+00, 3.8142e+05, 3.9264e+05, 3.9388e+05,
        3.9475e+05, 3.9545e+05, 3.9718e+05, 3.9829e+05, 4.0313e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398218.7500, 398244.7812, 398253.7500, 398257.7500,
        398264.0625, 398269.0938, 398274.9375, 398292.6250, 398294.3438,
        772468.9375, 790377.8125, 793127.7500, 794665.3125, 795805.0000,
        797096.5000, 814456.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395437.0625, 395437.9375, 395445.7812, 395447.6875,
        395450.6562, 395468.8125, 395474.6562, 395483.1875, 395494.5000,
        770010.3125, 773126.6250, 775377.7500, 790151.5000, 793588.6250,
        802700.0625, 814456.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5066e+00, 1.5392e+00, 1.5477e+00, 1.7541e+00, 1.8455e+00,
        2.0432e+00, 2.0505e+00, 2.1012e+00, 3.8144e+05, 3.9266e+05, 3.9391e+05,
        3.9474e+05, 3.9547e+05, 3.9717e+05, 3.9822e+05, 4.0312e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393858.1562, 393878.8438, 393905.5000, 393907.8438,
        393920.1875, 393925.5000, 393931.0000, 393935.3125, 393935.3125,
        770010.3125, 772895.2500, 782656.5000, 788784.3750, 797096.5000,
        805403.3125, 808553.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4551e+00, 1.4657e+00, 1.4665e+00, 1.4934e+00, 1.5110e+00,
        1.5726e+00, 1.9809e+00, 2.1012e+00, 3.8142e+05, 3.9269e+05, 3.9391e+05,
        3.9468e+05, 3.9549e+05, 3.9716e+05, 3.9827e+05, 4.0317e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3908e+00, 1.4407e+00, 1.4657e+00, 1.4726e+00, 1.4772e+00,
        1.5090e+00, 1.6514e+00, 1.8455e+00, 3.8138e+05, 3.9266e+05, 3.9394e+05,
        3.9470e+05, 3.9544e+05, 3.9720e+05, 3.9825e+05, 4.0316e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77404.81', '77409.28', '419267.91', '434755.84', '77410.54', '77412.58', '429397.31', '440083.41', '432783.12', '77408.49', '77407.66', '435683.91', '432915.06', '77410.83', '431520.78', '77412.09', '77405.03']
estimated f for each client, fs: [8, 8, 6, 6, 8, 8, 6, 6, 6, 8, 8, 6, 6, 8, 6, 8, 8]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0413s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:08...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:08, End: 2025-07-22 15:30:08)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 3, 13, 11, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6531e+00, 1.7572e+00, 3.9700e+05, 3.8648e+05, 1.6684e+00,
         1.7510e+00, 3.9879e+05, 3.7765e+05, 1.9327e+00, 1.7321e+00, 3.8829e+05,
         1.7249e+00, 1.9260e+00, 3.9832e+05, 1.7603e+00],
        [1.6531e+00, 0.0000e+00, 1.6083e+00, 3.9702e+05, 3.8646e+05, 1.6718e+00,
         1.6735e+00, 3.9880e+05, 3.7763e+05, 1.5943e+00, 1.6169e+00, 3.8826e+05,
         1.6769e+00, 1.7169e+00, 3.9834e+05, 1.8445e+00],
        [1.7572e+00, 1.6083e+00, 0.0000e+00, 3.9704e+05, 3.8647e+05, 1.5342e+00,
         1.5941e+00, 3.9881e+05, 3.7761e+05, 1.7589e+00, 1.5861e+00, 3.8829e+05,
         1.6920e+00, 1.6457e+00, 3.9834e+05, 1.7066e+00],
        [3.9700e+05, 3.9702e+05, 3.9704e+05, 0.0000e+00, 7.7100e+05, 3.9703e+05,
         3.9702e+05, 8.0174e+05, 7.8704e+05, 3.9699e+05, 3.9698e+05, 7.7698e+05,
         3.9701e+05, 3.9697e+05, 8.2289e+05, 3.9700e+05],
        [3.8648e+05, 3.8646e+05, 3.8647e+05, 7.7100e+05, 0.0000e+00, 3.8645e+05,
         3.8645e+05, 7.9334e+05, 7.6513e+05, 3.8644e+05, 3.8647e+05, 7.6905e+05,
         3.8645e+05, 3.8643e+05, 8.0365e+05, 3.8648e+05],
        [1.6684e+00, 1.6718e+00, 1.5342e+00, 3.9703e+05, 3.8645e+05, 0.0000e+00,
         1.4845e+00, 3.9878e+05, 3.7765e+05, 1.7370e+00, 1.7056e+00, 3.8827e+05,
         1.5964e+00, 1.6050e+00, 3.9833e+05, 1.6365e+00],
        [1.7510e+00, 1.6735e+00, 1.5941e+00, 3.9702e+05, 3.8645e+05, 1.4845e+00,
         0.0000e+00, 3.9878e+05, 3.7765e+05, 1.9028e+00, 1.7326e+00, 3.8829e+05,
         1.8325e+00, 1.8342e+00, 3.9835e+05, 1.6848e+00],
        [3.9879e+05, 3.9880e+05, 3.9881e+05, 8.0174e+05, 7.9334e+05, 3.9878e+05,
         3.9878e+05, 0.0000e+00, 7.7502e+05, 3.9880e+05, 3.9880e+05, 7.8109e+05,
         3.9880e+05, 3.9876e+05, 7.9467e+05, 3.9881e+05],
        [3.7765e+05, 3.7763e+05, 3.7761e+05, 7.8704e+05, 7.6513e+05, 3.7765e+05,
         3.7765e+05, 7.7502e+05, 0.0000e+00, 3.7769e+05, 3.7766e+05, 7.6202e+05,
         3.7764e+05, 3.7768e+05, 7.7670e+05, 3.7765e+05],
        [1.9327e+00, 1.5943e+00, 1.7589e+00, 3.9699e+05, 3.8644e+05, 1.7370e+00,
         1.9028e+00, 3.9880e+05, 3.7769e+05, 0.0000e+00, 1.6208e+00, 3.8831e+05,
         1.5722e+00, 1.4923e+00, 3.9835e+05, 2.0577e+00],
        [1.7321e+00, 1.6169e+00, 1.5861e+00, 3.9698e+05, 3.8647e+05, 1.7056e+00,
         1.7326e+00, 3.9880e+05, 3.7766e+05, 1.6208e+00, 0.0000e+00, 3.8828e+05,
         1.6161e+00, 1.5433e+00, 3.9833e+05, 1.9678e+00],
        [3.8829e+05, 3.8826e+05, 3.8829e+05, 7.7698e+05, 7.6905e+05, 3.8827e+05,
         3.8829e+05, 7.8109e+05, 7.6202e+05, 3.8831e+05, 3.8828e+05, 0.0000e+00,
         3.8831e+05, 3.8830e+05, 7.9706e+05, 3.8829e+05],
        [1.7249e+00, 1.6769e+00, 1.6920e+00, 3.9701e+05, 3.8645e+05, 1.5964e+00,
         1.8325e+00, 3.9880e+05, 3.7764e+05, 1.5722e+00, 1.6161e+00, 3.8831e+05,
         0.0000e+00, 1.4898e+00, 3.9833e+05, 1.9679e+00],
        [1.9260e+00, 1.7169e+00, 1.6457e+00, 3.9697e+05, 3.8643e+05, 1.6050e+00,
         1.8342e+00, 3.9876e+05, 3.7768e+05, 1.4923e+00, 1.5433e+00, 3.8830e+05,
         1.4898e+00, 0.0000e+00, 3.9835e+05, 2.0923e+00],
        [3.9832e+05, 3.9834e+05, 3.9834e+05, 8.2289e+05, 8.0365e+05, 3.9833e+05,
         3.9835e+05, 7.9467e+05, 7.7670e+05, 3.9835e+05, 3.9833e+05, 7.9706e+05,
         3.9833e+05, 3.9835e+05, 0.0000e+00, 3.9831e+05],
        [1.7603e+00, 1.8445e+00, 1.7066e+00, 3.9700e+05, 3.8648e+05, 1.6365e+00,
         1.6848e+00, 3.9881e+05, 3.7765e+05, 2.0577e+00, 1.9678e+00, 3.8829e+05,
         1.9679e+00, 2.0923e+00, 3.9831e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6531e+00, 1.6684e+00, 1.7249e+00, 1.7321e+00, 1.7510e+00,
        1.7572e+00, 1.7603e+00, 1.9260e+00, 1.9327e+00, 3.7765e+05, 3.8648e+05,
        3.8829e+05, 3.9700e+05, 3.9832e+05, 3.9879e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5943e+00, 1.6083e+00, 1.6169e+00, 1.6531e+00, 1.6718e+00,
        1.6735e+00, 1.6769e+00, 1.7169e+00, 1.8445e+00, 3.7763e+05, 3.8646e+05,
        3.8826e+05, 3.9702e+05, 3.9834e+05, 3.9880e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5342e+00, 1.5861e+00, 1.5941e+00, 1.6083e+00, 1.6457e+00,
        1.6920e+00, 1.7066e+00, 1.7572e+00, 1.7589e+00, 3.7761e+05, 3.8647e+05,
        3.8829e+05, 3.9704e+05, 3.9834e+05, 3.9881e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396967.3750, 396975.8750, 396990.2812, 396998.0938,
        396998.8750, 397007.7188, 397016.4375, 397021.5000, 397030.0312,
        397041.8125, 770995.6875, 776975.3750, 787041.8125, 801737.1250,
        822891.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386426.9375, 386438.4375, 386445.5312, 386452.2500,
        386453.3750, 386461.5938, 386466.2188, 386469.9375, 386478.3438,
        386479.4062, 765130.5000, 769049.5000, 770995.6875, 793343.3125,
        803645.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4845e+00, 1.5342e+00, 1.5964e+00, 1.6050e+00, 1.6365e+00,
        1.6684e+00, 1.6718e+00, 1.7056e+00, 1.7370e+00, 3.7765e+05, 3.8645e+05,
        3.8827e+05, 3.9703e+05, 3.9833e+05, 3.9878e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4845e+00, 1.5941e+00, 1.6735e+00, 1.6848e+00, 1.7326e+00,
        1.7510e+00, 1.8325e+00, 1.8342e+00, 1.9028e+00, 3.7765e+05, 3.8645e+05,
        3.8829e+05, 3.9702e+05, 3.9835e+05, 3.9878e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398760.4062, 398779.0625, 398784.0312, 398792.0000,
        398795.2500, 398796.4062, 398797.7188, 398800.7500, 398806.5938,
        398808.0938, 775023.4375, 781092.2500, 793343.3125, 794666.2500,
        801737.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377610.9375, 377634.6875, 377643.0312, 377646.6250,
        377650.8125, 377651.4688, 377652.1875, 377659.7812, 377675.2500,
        377691.7500, 762024.3750, 765130.5000, 775023.4375, 776696.6250,
        787041.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4923e+00, 1.5722e+00, 1.5943e+00, 1.6208e+00, 1.7370e+00,
        1.7589e+00, 1.9028e+00, 1.9327e+00, 2.0577e+00, 3.7769e+05, 3.8644e+05,
        3.8831e+05, 3.9699e+05, 3.9835e+05, 3.9880e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5433e+00, 1.5861e+00, 1.6161e+00, 1.6169e+00, 1.6208e+00,
        1.7056e+00, 1.7321e+00, 1.7326e+00, 1.9678e+00, 3.7766e+05, 3.8647e+05,
        3.8828e+05, 3.9698e+05, 3.9833e+05, 3.9880e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388263.8750, 388267.2500, 388282.9688, 388285.0938,
        388291.5625, 388294.1875, 388294.5000, 388300.6875, 388305.2500,
        388309.5000, 762024.3750, 769049.5000, 776975.3750, 781092.2500,
        797063.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4898e+00, 1.5722e+00, 1.5964e+00, 1.6161e+00, 1.6769e+00,
        1.6920e+00, 1.7249e+00, 1.8325e+00, 1.9679e+00, 3.7764e+05, 3.8645e+05,
        3.8831e+05, 3.9701e+05, 3.9833e+05, 3.9880e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4898e+00, 1.4923e+00, 1.5433e+00, 1.6050e+00, 1.6457e+00,
        1.7169e+00, 1.8342e+00, 1.9260e+00, 2.0923e+00, 3.7768e+05, 3.8643e+05,
        3.8830e+05, 3.9697e+05, 3.9835e+05, 3.9876e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398305.6250, 398323.7812, 398327.9062, 398329.1875,
        398329.5312, 398337.0938, 398344.5312, 398345.2500, 398345.8750,
        398347.9688, 776696.6250, 794666.2500, 797063.6875, 803645.1250,
        822891.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6365e+00, 1.6848e+00, 1.7066e+00, 1.7603e+00, 1.8445e+00,
        1.9678e+00, 1.9679e+00, 2.0577e+00, 2.0923e+00, 3.7765e+05, 3.8648e+05,
        3.8829e+05, 3.9700e+05, 3.9831e+05, 3.9881e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37766.80', '37764.98', '37762.58', '397004.81', '386457.22', '37766.54', '37766.21', '398792.06', '377651.69', '37770.74', '37767.49', '388289.50', '37765.82', '37769.06', '398333.66', '37766.82']
estimated f for each client, fs: [6, 6, 6, 4, 4, 6, 6, 4, 5, 6, 6, 4, 6, 6, 4, 6]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 3, 13, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0254s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:08...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:08, End: 2025-07-22 15:30:08)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 19, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.7895e+05, 1.4489e+00, 3.8853e+05, 3.9964e+05, 1.4610e+00,
         3.8348e+05, 1.4184e+00, 3.9797e+05, 3.8699e+05, 1.4338e+00, 1.5573e+00,
         3.9960e+05, 1.5771e+00, 1.4677e+00],
        [3.7895e+05, 0.0000e+00, 3.7895e+05, 7.4925e+05, 7.8457e+05, 3.7894e+05,
         7.6250e+05, 3.7897e+05, 7.6456e+05, 7.6536e+05, 3.7892e+05, 3.7897e+05,
         7.7441e+05, 3.7896e+05, 3.7896e+05],
        [1.4489e+00, 3.7895e+05, 0.0000e+00, 3.8853e+05, 3.9965e+05, 1.7045e+00,
         3.8345e+05, 1.5453e+00, 3.9797e+05, 3.8699e+05, 1.6115e+00, 1.6777e+00,
         3.9964e+05, 1.4835e+00, 1.5399e+00],
        [3.8853e+05, 7.4925e+05, 3.8853e+05, 0.0000e+00, 7.8762e+05, 3.8853e+05,
         7.8497e+05, 3.8853e+05, 7.8501e+05, 7.6964e+05, 3.8854e+05, 3.8851e+05,
         7.8896e+05, 3.8856e+05, 3.8852e+05],
        [3.9964e+05, 7.8457e+05, 3.9965e+05, 7.8762e+05, 0.0000e+00, 3.9961e+05,
         7.9076e+05, 3.9961e+05, 7.9054e+05, 7.7672e+05, 3.9962e+05, 3.9961e+05,
         8.0141e+05, 3.9964e+05, 3.9962e+05],
        [1.4610e+00, 3.7894e+05, 1.7045e+00, 3.8853e+05, 3.9961e+05, 0.0000e+00,
         3.8348e+05, 1.4340e+00, 3.9799e+05, 3.8701e+05, 1.4177e+00, 1.3380e+00,
         3.9959e+05, 1.7530e+00, 1.6813e+00],
        [3.8348e+05, 7.6250e+05, 3.8345e+05, 7.8497e+05, 7.9076e+05, 3.8348e+05,
         0.0000e+00, 3.8346e+05, 7.9349e+05, 7.6425e+05, 3.8347e+05, 3.8346e+05,
         7.9793e+05, 3.8345e+05, 3.8347e+05],
        [1.4184e+00, 3.7897e+05, 1.5453e+00, 3.8853e+05, 3.9961e+05, 1.4340e+00,
         3.8346e+05, 0.0000e+00, 3.9795e+05, 3.8700e+05, 1.4642e+00, 1.3882e+00,
         3.9960e+05, 1.6988e+00, 1.4489e+00],
        [3.9797e+05, 7.6456e+05, 3.9797e+05, 7.8501e+05, 7.9054e+05, 3.9799e+05,
         7.9349e+05, 3.9795e+05, 0.0000e+00, 7.8575e+05, 3.9796e+05, 3.9796e+05,
         8.1211e+05, 3.9798e+05, 3.9798e+05],
        [3.8699e+05, 7.6536e+05, 3.8699e+05, 7.6964e+05, 7.7672e+05, 3.8701e+05,
         7.6425e+05, 3.8700e+05, 7.8575e+05, 0.0000e+00, 3.8700e+05, 3.8700e+05,
         7.6241e+05, 3.8700e+05, 3.8700e+05],
        [1.4338e+00, 3.7892e+05, 1.6115e+00, 3.8854e+05, 3.9962e+05, 1.4177e+00,
         3.8347e+05, 1.4642e+00, 3.9796e+05, 3.8700e+05, 0.0000e+00, 1.3697e+00,
         3.9961e+05, 1.7082e+00, 1.5584e+00],
        [1.5573e+00, 3.7897e+05, 1.6777e+00, 3.8851e+05, 3.9961e+05, 1.3380e+00,
         3.8346e+05, 1.3882e+00, 3.9796e+05, 3.8700e+05, 1.3697e+00, 0.0000e+00,
         3.9960e+05, 1.9018e+00, 1.7648e+00],
        [3.9960e+05, 7.7441e+05, 3.9964e+05, 7.8896e+05, 8.0141e+05, 3.9959e+05,
         7.9793e+05, 3.9960e+05, 8.1211e+05, 7.6241e+05, 3.9961e+05, 3.9960e+05,
         0.0000e+00, 3.9961e+05, 3.9958e+05],
        [1.5771e+00, 3.7896e+05, 1.4835e+00, 3.8856e+05, 3.9964e+05, 1.7530e+00,
         3.8345e+05, 1.6988e+00, 3.9798e+05, 3.8700e+05, 1.7082e+00, 1.9018e+00,
         3.9961e+05, 0.0000e+00, 1.5296e+00],
        [1.4677e+00, 3.7896e+05, 1.5399e+00, 3.8852e+05, 3.9962e+05, 1.6813e+00,
         3.8347e+05, 1.4489e+00, 3.9798e+05, 3.8700e+05, 1.5584e+00, 1.7648e+00,
         3.9958e+05, 1.5296e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4184e+00, 1.4338e+00, 1.4489e+00, 1.4610e+00, 1.4677e+00,
        1.5573e+00, 1.5771e+00, 3.7895e+05, 3.8348e+05, 3.8699e+05, 3.8853e+05,
        3.9797e+05, 3.9960e+05, 3.9964e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 378915.7188, 378941.0312, 378949.3750, 378952.7812,
        378959.5625, 378960.8438, 378965.4375, 378968.1875, 749254.5000,
        762500.7500, 764557.4375, 765364.1250, 774408.5000, 784565.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4489e+00, 1.4835e+00, 1.5399e+00, 1.5453e+00, 1.6115e+00,
        1.6777e+00, 1.7045e+00, 3.7895e+05, 3.8345e+05, 3.8699e+05, 3.8853e+05,
        3.9797e+05, 3.9964e+05, 3.9965e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388511.0625, 388519.0938, 388528.3125, 388529.6250,
        388532.1562, 388533.7188, 388541.1562, 388557.7188, 749254.5000,
        769640.1250, 784970.6875, 785012.0625, 787619.0000, 788961.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 399605.7188, 399611.0938, 399611.2188, 399616.9062,
        399622.0312, 399637.1562, 399640.5625, 399651.3750, 776715.4375,
        784565.5000, 787619.0000, 790538.6250, 790762.4375, 801414.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3380e+00, 1.4177e+00, 1.4340e+00, 1.4610e+00, 1.6813e+00,
        1.7045e+00, 1.7530e+00, 3.7894e+05, 3.8348e+05, 3.8701e+05, 3.8853e+05,
        3.9799e+05, 3.9959e+05, 3.9961e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 383448.0312, 383451.7812, 383459.6875, 383464.1250,
        383467.1875, 383470.9375, 383478.0312, 383481.1562, 762500.7500,
        764253.2500, 784970.6875, 790762.4375, 793494.3750, 797933.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3882e+00, 1.4184e+00, 1.4340e+00, 1.4489e+00, 1.4642e+00,
        1.5453e+00, 1.6988e+00, 3.7897e+05, 3.8346e+05, 3.8700e+05, 3.8853e+05,
        3.9795e+05, 3.9960e+05, 3.9961e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397951.3750, 397955.4062, 397960.8125, 397968.2188,
        397970.7812, 397975.6250, 397975.7188, 397991.9375, 764557.4375,
        785012.0625, 785752.1250, 790538.6250, 793494.3750, 812107.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 386986.4688, 386994.2500, 386995.6250, 386998.9688,
        387000.8750, 387001.0312, 387001.6562, 387007.1250, 762413.5625,
        764253.2500, 765364.1250, 769640.1250, 776715.4375, 785752.1250])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3697e+00, 1.4177e+00, 1.4338e+00, 1.4642e+00, 1.5584e+00,
        1.6115e+00, 1.7082e+00, 3.7892e+05, 3.8347e+05, 3.8700e+05, 3.8854e+05,
        3.9796e+05, 3.9961e+05, 3.9962e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3380e+00, 1.3697e+00, 1.3882e+00, 1.5573e+00, 1.6777e+00,
        1.7648e+00, 1.9018e+00, 3.7897e+05, 3.8346e+05, 3.8700e+05, 3.8851e+05,
        3.9796e+05, 3.9960e+05, 3.9961e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 399576.0625, 399590.7188, 399598.1562, 399603.8750,
        399604.6562, 399608.0312, 399608.3438, 399636.9688, 762413.5625,
        774408.5000, 788961.7500, 797933.7500, 801414.7500, 812107.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4835e+00, 1.5296e+00, 1.5771e+00, 1.6988e+00, 1.7082e+00,
        1.7530e+00, 1.9018e+00, 3.7896e+05, 3.8345e+05, 3.8700e+05, 3.8856e+05,
        3.9798e+05, 3.9961e+05, 3.9964e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.4489e+00, 1.4677e+00, 1.5296e+00, 1.5399e+00, 1.5584e+00,
        1.6813e+00, 1.7648e+00, 3.7896e+05, 3.8347e+05, 3.8700e+05, 3.8852e+05,
        3.9798e+05, 3.9958e+05, 3.9962e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['84716.03', '420096.38', '84712.46', '428611.94', '441523.53', '84714.42', '425580.22', '84715.55', '438700.81', '428711.06', '84710.39', '84715.43', '439915.59', '84713.40', '84715.72']
estimated f for each client, fs: [7, 5, 7, 5, 5, 7, 5, 7, 5, 5, 7, 7, 5, 7, 7]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [7, 19, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0174s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:09...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:30:09, End: 2025-07-22 15:30:09)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.2779e+00, 1.5321e+00, 3.9913e+05, 1.3069e+00, 3.9598e+05,
         3.7986e+05, 1.5409e+00, 3.8697e+05, 1.3318e+00, 1.3231e+00, 3.9202e+05,
         3.7546e+05, 1.7262e+00, 1.6113e+00, 3.9623e+05, 1.3217e+00],
        [1.2779e+00, 0.0000e+00, 1.3048e+00, 3.9910e+05, 1.3185e+00, 3.9600e+05,
         3.7987e+05, 1.3070e+00, 3.8696e+05, 1.2981e+00, 1.3020e+00, 3.9204e+05,
         3.7546e+05, 1.5652e+00, 1.4605e+00, 3.9624e+05, 1.3313e+00],
        [1.5321e+00, 1.3048e+00, 0.0000e+00, 3.9910e+05, 1.3384e+00, 3.9598e+05,
         3.7982e+05, 1.3547e+00, 3.8693e+05, 1.5071e+00, 1.2430e+00, 3.9206e+05,
         3.7545e+05, 1.3737e+00, 1.2076e+00, 3.9624e+05, 1.5403e+00],
        [3.9913e+05, 3.9910e+05, 3.9910e+05, 0.0000e+00, 3.9910e+05, 7.8355e+05,
         7.6245e+05, 3.9909e+05, 7.8794e+05, 3.9908e+05, 3.9908e+05, 7.9368e+05,
         7.7823e+05, 3.9908e+05, 3.9909e+05, 7.9773e+05, 3.9910e+05],
        [1.3069e+00, 1.3185e+00, 1.3384e+00, 3.9910e+05, 0.0000e+00, 3.9602e+05,
         3.7984e+05, 1.4705e+00, 3.8698e+05, 1.3426e+00, 1.3846e+00, 3.9203e+05,
         3.7546e+05, 1.6009e+00, 1.3587e+00, 3.9623e+05, 1.3051e+00],
        [3.9598e+05, 3.9600e+05, 3.9598e+05, 7.8355e+05, 3.9602e+05, 0.0000e+00,
         7.8652e+05, 3.9605e+05, 7.6141e+05, 3.9600e+05, 3.9602e+05, 7.5139e+05,
         7.8637e+05, 3.9603e+05, 3.9604e+05, 7.7719e+05, 3.9601e+05],
        [3.7986e+05, 3.7987e+05, 3.7982e+05, 7.6245e+05, 3.7984e+05, 7.8652e+05,
         0.0000e+00, 3.7986e+05, 7.5570e+05, 3.7987e+05, 3.7987e+05, 7.6754e+05,
         7.4157e+05, 3.7986e+05, 3.7986e+05, 7.8932e+05, 3.7985e+05],
        [1.5409e+00, 1.3070e+00, 1.3547e+00, 3.9909e+05, 1.4705e+00, 3.9605e+05,
         3.7986e+05, 0.0000e+00, 3.8697e+05, 1.5220e+00, 1.3347e+00, 3.9206e+05,
         3.7546e+05, 1.3754e+00, 1.2708e+00, 3.9622e+05, 1.5248e+00],
        [3.8697e+05, 3.8696e+05, 3.8693e+05, 7.8794e+05, 3.8698e+05, 7.6141e+05,
         7.5570e+05, 3.8697e+05, 0.0000e+00, 3.8696e+05, 3.8699e+05, 7.8981e+05,
         7.7182e+05, 3.8697e+05, 3.8695e+05, 7.9416e+05, 3.8698e+05],
        [1.3318e+00, 1.2981e+00, 1.5071e+00, 3.9908e+05, 1.3426e+00, 3.9600e+05,
         3.7987e+05, 1.5220e+00, 3.8696e+05, 0.0000e+00, 1.4194e+00, 3.9206e+05,
         3.7547e+05, 1.9200e+00, 1.6988e+00, 3.9627e+05, 1.3541e+00],
        [1.3231e+00, 1.3020e+00, 1.2430e+00, 3.9908e+05, 1.3846e+00, 3.9602e+05,
         3.7987e+05, 1.3347e+00, 3.8699e+05, 1.4194e+00, 0.0000e+00, 3.9205e+05,
         3.7542e+05, 1.4889e+00, 1.3204e+00, 3.9622e+05, 1.3603e+00],
        [3.9202e+05, 3.9204e+05, 3.9206e+05, 7.9368e+05, 3.9203e+05, 7.5139e+05,
         7.6754e+05, 3.9206e+05, 7.8981e+05, 3.9206e+05, 3.9205e+05, 0.0000e+00,
         7.6443e+05, 3.9206e+05, 3.9203e+05, 7.6833e+05, 3.9202e+05],
        [3.7546e+05, 3.7546e+05, 3.7545e+05, 7.7823e+05, 3.7546e+05, 7.8637e+05,
         7.4157e+05, 3.7546e+05, 7.7182e+05, 3.7547e+05, 3.7542e+05, 7.6443e+05,
         0.0000e+00, 3.7538e+05, 3.7543e+05, 7.8755e+05, 3.7545e+05],
        [1.7262e+00, 1.5652e+00, 1.3737e+00, 3.9908e+05, 1.6009e+00, 3.9603e+05,
         3.7986e+05, 1.3754e+00, 3.8697e+05, 1.9200e+00, 1.4889e+00, 3.9206e+05,
         3.7538e+05, 0.0000e+00, 1.2855e+00, 3.9623e+05, 1.7650e+00],
        [1.6113e+00, 1.4605e+00, 1.2076e+00, 3.9909e+05, 1.3587e+00, 3.9604e+05,
         3.7986e+05, 1.2708e+00, 3.8695e+05, 1.6988e+00, 1.3204e+00, 3.9203e+05,
         3.7543e+05, 1.2855e+00, 0.0000e+00, 3.9620e+05, 1.6421e+00],
        [3.9623e+05, 3.9624e+05, 3.9624e+05, 7.9773e+05, 3.9623e+05, 7.7719e+05,
         7.8932e+05, 3.9622e+05, 7.9416e+05, 3.9627e+05, 3.9622e+05, 7.6833e+05,
         7.8755e+05, 3.9623e+05, 3.9620e+05, 0.0000e+00, 3.9622e+05],
        [1.3217e+00, 1.3313e+00, 1.5403e+00, 3.9910e+05, 1.3051e+00, 3.9601e+05,
         3.7985e+05, 1.5248e+00, 3.8698e+05, 1.3541e+00, 1.3603e+00, 3.9202e+05,
         3.7545e+05, 1.7650e+00, 1.6421e+00, 3.9622e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2779e+00, 1.3069e+00, 1.3217e+00, 1.3231e+00, 1.3318e+00,
        1.5321e+00, 1.5409e+00, 1.6113e+00, 1.7262e+00, 3.7546e+05, 3.7986e+05,
        3.8697e+05, 3.9202e+05, 3.9598e+05, 3.9623e+05, 3.9913e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2779e+00, 1.2981e+00, 1.3020e+00, 1.3048e+00, 1.3070e+00,
        1.3185e+00, 1.3313e+00, 1.4605e+00, 1.5652e+00, 3.7546e+05, 3.7987e+05,
        3.8696e+05, 3.9204e+05, 3.9600e+05, 3.9624e+05, 3.9910e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2076e+00, 1.2430e+00, 1.3048e+00, 1.3384e+00, 1.3547e+00,
        1.3737e+00, 1.5071e+00, 1.5321e+00, 1.5403e+00, 3.7545e+05, 3.7982e+05,
        3.8693e+05, 3.9206e+05, 3.9598e+05, 3.9624e+05, 3.9910e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399082.6250, 399084.5000, 399084.5625, 399085.6250,
        399094.9688, 399095.1875, 399097.9062, 399098.5625, 399102.2500,
        399125.7500, 762447.7500, 778229.6250, 783554.0625, 787939.0000,
        793678.4375, 797734.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3051e+00, 1.3069e+00, 1.3185e+00, 1.3384e+00, 1.3426e+00,
        1.3587e+00, 1.3846e+00, 1.4705e+00, 1.6009e+00, 3.7546e+05, 3.7984e+05,
        3.8698e+05, 3.9203e+05, 3.9602e+05, 3.9623e+05, 3.9910e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395979.3750, 395981.5625, 395995.8438, 395995.9688,
        396005.0625, 396015.9062, 396024.8438, 396034.1875, 396038.3750,
        396048.2188, 751390.8750, 761406.1250, 777187.7500, 783554.0625,
        786370.5625, 786518.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379824.6562, 379841.2188, 379850.4375, 379857.4688,
        379858.5938, 379859.3750, 379863.9375, 379866.2812, 379869.8125,
        379871.2500, 741569.1250, 755699.6875, 762447.7500, 767540.3750,
        786518.2500, 789324.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2708e+00, 1.3070e+00, 1.3347e+00, 1.3547e+00, 1.3754e+00,
        1.4705e+00, 1.5220e+00, 1.5248e+00, 1.5409e+00, 3.7546e+05, 3.7986e+05,
        3.8697e+05, 3.9206e+05, 3.9605e+05, 3.9622e+05, 3.9909e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386926.8125, 386949.9688, 386962.1875, 386964.6562,
        386967.3125, 386967.7500, 386968.7188, 386976.6875, 386981.9688,
        386986.4688, 755699.6875, 761406.1250, 771817.3125, 787939.0000,
        789810.4375, 794156.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2981e+00, 1.3318e+00, 1.3426e+00, 1.3541e+00, 1.4194e+00,
        1.5071e+00, 1.5220e+00, 1.6988e+00, 1.9200e+00, 3.7547e+05, 3.7987e+05,
        3.8696e+05, 3.9206e+05, 3.9600e+05, 3.9627e+05, 3.9908e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2430e+00, 1.3020e+00, 1.3204e+00, 1.3231e+00, 1.3347e+00,
        1.3603e+00, 1.3846e+00, 1.4194e+00, 1.4889e+00, 3.7542e+05, 3.7987e+05,
        3.8699e+05, 3.9205e+05, 3.9602e+05, 3.9622e+05, 3.9908e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392016.8750, 392017.1250, 392026.4062, 392028.6562,
        392040.5000, 392054.8750, 392055.4375, 392058.0312, 392059.4062,
        392062.6250, 751390.8750, 764428.6875, 767540.3750, 768326.7500,
        789810.4375, 793678.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 375383.6875, 375422.6875, 375428.0312, 375451.9688,
        375452.6562, 375458.5000, 375462.5625, 375463.0312, 375464.7500,
        375472.1250, 741569.1250, 764428.6875, 771817.3125, 778229.6250,
        786370.5625, 787551.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2855e+00, 1.3737e+00, 1.3754e+00, 1.4889e+00, 1.5652e+00,
        1.6009e+00, 1.7262e+00, 1.7650e+00, 1.9200e+00, 3.7538e+05, 3.7986e+05,
        3.8697e+05, 3.9206e+05, 3.9603e+05, 3.9623e+05, 3.9908e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2076e+00, 1.2708e+00, 1.2855e+00, 1.3204e+00, 1.3587e+00,
        1.4605e+00, 1.6113e+00, 1.6421e+00, 1.6988e+00, 3.7543e+05, 3.7986e+05,
        3.8695e+05, 3.9203e+05, 3.9604e+05, 3.9620e+05, 3.9909e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396195.1875, 396216.7500, 396222.2812, 396224.7500,
        396230.1250, 396232.2188, 396232.6250, 396240.0000, 396244.9375,
        396268.0625, 768326.7500, 777187.7500, 787551.0625, 789324.4375,
        794156.9375, 797734.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3051e+00, 1.3217e+00, 1.3313e+00, 1.3541e+00, 1.3603e+00,
        1.5248e+00, 1.5403e+00, 1.6421e+00, 1.7650e+00, 3.7545e+05, 3.7985e+05,
        3.8698e+05, 3.9202e+05, 3.9601e+05, 3.9622e+05, 3.9910e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37547.77', '37547.06', '37546.50', '399095.16', '37547.49', '396011.91', '379856.31', '37547.57', '386965.22', '37548.55', '37543.48', '392041.94', '375446.00', '37539.77', '37544.09', '396230.69', '37546.51']
estimated f for each client, fs: [7, 7, 7, 5, 7, 5, 5, 7, 5, 7, 7, 5, 5, 7, 7, 5, 7]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0290s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:09...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:09, End: 2025-07-22 15:30:09)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0831e+00, 4.0108e+05, 3.9796e+05, 1.1499e+00, 3.7700e+05,
         3.9965e+05, 1.2956e+00, 3.8981e+05, 1.2054e+00, 1.1529e+00, 3.9464e+05,
         1.2943e+00, 3.9805e+05, 1.2289e+00, 1.0923e+00],
        [1.0831e+00, 0.0000e+00, 4.0108e+05, 3.9796e+05, 1.1314e+00, 3.7699e+05,
         3.9965e+05, 1.1159e+00, 3.8980e+05, 1.1429e+00, 1.1296e+00, 3.9465e+05,
         1.2126e+00, 3.9805e+05, 1.2545e+00, 1.0993e+00],
        [4.0108e+05, 4.0108e+05, 0.0000e+00, 7.9668e+05, 4.0111e+05, 7.8816e+05,
         7.9834e+05, 4.0108e+05, 8.0378e+05, 4.0107e+05, 4.0108e+05, 7.9916e+05,
         4.0106e+05, 7.9601e+05, 4.0111e+05, 4.0109e+05],
        [3.9796e+05, 3.9796e+05, 7.9668e+05, 0.0000e+00, 3.9797e+05, 7.8693e+05,
         8.1586e+05, 3.9798e+05, 7.9035e+05, 3.9799e+05, 3.9799e+05, 7.7537e+05,
         3.9797e+05, 8.0555e+05, 3.9798e+05, 3.9799e+05],
        [1.1499e+00, 1.1314e+00, 4.0111e+05, 3.9797e+05, 0.0000e+00, 3.7699e+05,
         3.9965e+05, 1.2617e+00, 3.8982e+05, 1.1471e+00, 1.1738e+00, 3.9466e+05,
         1.2148e+00, 3.9802e+05, 1.1765e+00, 1.1221e+00],
        [3.7700e+05, 3.7699e+05, 7.8816e+05, 7.8693e+05, 3.7699e+05, 0.0000e+00,
         7.7380e+05, 3.7701e+05, 7.4909e+05, 3.7697e+05, 3.7696e+05, 7.5935e+05,
         3.7699e+05, 7.8821e+05, 3.7698e+05, 3.7698e+05],
        [3.9965e+05, 3.9965e+05, 7.9834e+05, 8.1586e+05, 3.9965e+05, 7.7380e+05,
         0.0000e+00, 3.9963e+05, 7.7927e+05, 3.9963e+05, 3.9964e+05, 7.8415e+05,
         3.9967e+05, 8.1813e+05, 3.9964e+05, 3.9966e+05],
        [1.2956e+00, 1.1159e+00, 4.0108e+05, 3.9798e+05, 1.2617e+00, 3.7701e+05,
         3.9963e+05, 0.0000e+00, 3.8979e+05, 1.3042e+00, 1.1469e+00, 3.9466e+05,
         1.0384e+00, 3.9801e+05, 1.3810e+00, 1.2251e+00],
        [3.8981e+05, 3.8980e+05, 8.0378e+05, 7.9035e+05, 3.8982e+05, 7.4909e+05,
         7.7927e+05, 3.8979e+05, 0.0000e+00, 3.8979e+05, 3.8981e+05, 7.7209e+05,
         3.8981e+05, 7.7725e+05, 3.8980e+05, 3.8979e+05],
        [1.2054e+00, 1.1429e+00, 4.0107e+05, 3.9799e+05, 1.1471e+00, 3.7697e+05,
         3.9963e+05, 1.3042e+00, 3.8979e+05, 0.0000e+00, 1.2365e+00, 3.9470e+05,
         1.3734e+00, 3.9802e+05, 1.1622e+00, 1.1678e+00],
        [1.1529e+00, 1.1296e+00, 4.0108e+05, 3.9799e+05, 1.1738e+00, 3.7696e+05,
         3.9964e+05, 1.1469e+00, 3.8981e+05, 1.2365e+00, 0.0000e+00, 3.9467e+05,
         1.0830e+00, 3.9803e+05, 1.3683e+00, 1.1440e+00],
        [3.9464e+05, 3.9465e+05, 7.9916e+05, 7.7537e+05, 3.9466e+05, 7.5935e+05,
         7.8415e+05, 3.9466e+05, 7.7209e+05, 3.9470e+05, 3.9467e+05, 0.0000e+00,
         3.9467e+05, 7.7135e+05, 3.9466e+05, 3.9467e+05],
        [1.2943e+00, 1.2126e+00, 4.0106e+05, 3.9797e+05, 1.2148e+00, 3.7699e+05,
         3.9967e+05, 1.0384e+00, 3.8981e+05, 1.3734e+00, 1.0830e+00, 3.9467e+05,
         0.0000e+00, 3.9801e+05, 1.4564e+00, 1.2496e+00],
        [3.9805e+05, 3.9805e+05, 7.9601e+05, 8.0555e+05, 3.9802e+05, 7.8821e+05,
         8.1813e+05, 3.9801e+05, 7.7725e+05, 3.9802e+05, 3.9803e+05, 7.7135e+05,
         3.9801e+05, 0.0000e+00, 3.9802e+05, 3.9801e+05],
        [1.2289e+00, 1.2545e+00, 4.0111e+05, 3.9798e+05, 1.1765e+00, 3.7698e+05,
         3.9964e+05, 1.3810e+00, 3.8980e+05, 1.1622e+00, 1.3683e+00, 3.9466e+05,
         1.4564e+00, 3.9802e+05, 0.0000e+00, 1.1736e+00],
        [1.0923e+00, 1.0993e+00, 4.0109e+05, 3.9799e+05, 1.1221e+00, 3.7698e+05,
         3.9966e+05, 1.2251e+00, 3.8979e+05, 1.1678e+00, 1.1440e+00, 3.9467e+05,
         1.2496e+00, 3.9801e+05, 1.1736e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0831e+00, 1.0923e+00, 1.1499e+00, 1.1529e+00, 1.2054e+00,
        1.2289e+00, 1.2943e+00, 1.2956e+00, 3.7700e+05, 3.8981e+05, 3.9464e+05,
        3.9796e+05, 3.9805e+05, 3.9965e+05, 4.0108e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0831e+00, 1.0993e+00, 1.1159e+00, 1.1296e+00, 1.1314e+00,
        1.1429e+00, 1.2126e+00, 1.2545e+00, 3.7699e+05, 3.8980e+05, 3.9465e+05,
        3.9796e+05, 3.9805e+05, 3.9965e+05, 4.0108e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401063.0938, 401070.3125, 401079.0000, 401081.8750,
        401083.0000, 401083.8125, 401086.4375, 401106.7500, 401112.5625,
        788163.3750, 796009.0625, 796681.0000, 798340.0000, 799160.3125,
        803781.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397957.4062, 397957.8750, 397967.1250, 397968.0625,
        397978.7500, 397983.1562, 397987.6250, 397994.1250, 397994.1562,
        775369.0000, 786930.2500, 790348.0000, 796681.0000, 805545.1250,
        815860.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1221e+00, 1.1314e+00, 1.1471e+00, 1.1499e+00, 1.1738e+00,
        1.1765e+00, 1.2148e+00, 1.2617e+00, 3.7699e+05, 3.8982e+05, 3.9466e+05,
        3.9797e+05, 3.9802e+05, 3.9965e+05, 4.0111e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376964.8438, 376965.2812, 376980.2500, 376981.3438,
        376988.2812, 376993.2500, 376994.7500, 377003.4062, 377007.5312,
        749094.0000, 759348.3750, 773800.5000, 786930.2500, 788163.3750,
        788210.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399627.4375, 399630.9375, 399641.7188, 399643.5312,
        399648.8750, 399649.6562, 399653.6250, 399664.6250, 399669.5000,
        773800.5000, 779274.5000, 784154.0625, 798340.0000, 815860.5000,
        818134.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0384e+00, 1.1159e+00, 1.1469e+00, 1.2251e+00, 1.2617e+00,
        1.2956e+00, 1.3042e+00, 1.3810e+00, 3.7701e+05, 3.8979e+05, 3.9466e+05,
        3.9798e+05, 3.9801e+05, 3.9963e+05, 4.0108e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389785.9062, 389786.5000, 389788.9062, 389795.2812,
        389802.1562, 389806.7188, 389807.6875, 389809.7500, 389815.5938,
        749094.0000, 772090.0000, 777246.5000, 779274.5000, 790348.0000,
        803781.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1429e+00, 1.1471e+00, 1.1622e+00, 1.1678e+00, 1.2054e+00,
        1.2365e+00, 1.3042e+00, 1.3734e+00, 3.7697e+05, 3.8979e+05, 3.9470e+05,
        3.9799e+05, 3.9802e+05, 3.9963e+05, 4.0107e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0830e+00, 1.1296e+00, 1.1440e+00, 1.1469e+00, 1.1529e+00,
        1.1738e+00, 1.2365e+00, 1.3683e+00, 3.7696e+05, 3.8981e+05, 3.9467e+05,
        3.9799e+05, 3.9803e+05, 3.9964e+05, 4.0108e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394639.3750, 394645.7188, 394657.5000, 394661.7500,
        394664.6562, 394666.0938, 394667.5938, 394671.7812, 394695.5312,
        759348.3750, 771350.0625, 772090.0000, 775369.0000, 784154.0625,
        799160.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0384e+00, 1.0830e+00, 1.2126e+00, 1.2148e+00, 1.2496e+00,
        1.2943e+00, 1.3734e+00, 1.4564e+00, 3.7699e+05, 3.8981e+05, 3.9467e+05,
        3.9797e+05, 3.9801e+05, 3.9967e+05, 4.0106e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398007.7188, 398009.0312, 398010.7188, 398016.9375,
        398018.0625, 398024.1250, 398027.4688, 398047.8125, 398054.0625,
        771350.0625, 777246.5000, 788210.3750, 796009.0625, 805545.1250,
        818134.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1622e+00, 1.1736e+00, 1.1765e+00, 1.2289e+00, 1.2545e+00,
        1.3683e+00, 1.3810e+00, 1.4564e+00, 3.7698e+05, 3.8980e+05, 3.9466e+05,
        3.9798e+05, 3.9802e+05, 3.9964e+05, 4.0111e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0923e+00, 1.0993e+00, 1.1221e+00, 1.1440e+00, 1.1678e+00,
        1.1736e+00, 1.2251e+00, 1.2496e+00, 3.7698e+05, 3.8979e+05, 3.9467e+05,
        3.9799e+05, 3.9801e+05, 3.9966e+05, 4.0109e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76682.26', '76679.95', '439793.06', '435715.69', '76681.82', '414197.31', '437063.06', '76680.33', '425729.31', '76676.39', '76678.19', '431131.84', '76681.14', '435356.59', '76678.69', '76677.61']
estimated f for each client, fs: [7, 7, 5, 5, 7, 5, 5, 7, 5, 7, 7, 5, 7, 5, 7, 7]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0257s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:10...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:10, End: 2025-07-22 15:30:10)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.4141e+00, 3.8870e+05, 1.2479e+00, 1.3162e+00, 3.8348e+05,
         1.5011e+00, 3.9580e+05, 1.4473e+00, 1.3660e+00, 4.0153e+05, 1.7546e+00,
         1.4962e+00, 1.3732e+00, 1.2973e+00],
        [1.4141e+00, 0.0000e+00, 3.8871e+05, 1.1971e+00, 1.3127e+00, 3.8350e+05,
         1.3023e+00, 3.9578e+05, 1.2077e+00, 1.2436e+00, 4.0156e+05, 1.2516e+00,
         1.1638e+00, 1.4989e+00, 1.4853e+00],
        [3.8870e+05, 3.8871e+05, 0.0000e+00, 3.8873e+05, 3.8872e+05, 7.7372e+05,
         3.8872e+05, 7.8360e+05, 3.8873e+05, 3.8870e+05, 7.9943e+05, 3.8875e+05,
         3.8871e+05, 3.8870e+05, 3.8877e+05],
        [1.2479e+00, 1.1971e+00, 3.8873e+05, 0.0000e+00, 1.1968e+00, 3.8346e+05,
         1.3773e+00, 3.9581e+05, 1.3210e+00, 1.3345e+00, 4.0153e+05, 1.5713e+00,
         1.2768e+00, 1.3188e+00, 1.2983e+00],
        [1.3162e+00, 1.3127e+00, 3.8872e+05, 1.1968e+00, 0.0000e+00, 3.8348e+05,
         1.4942e+00, 3.9580e+05, 1.4606e+00, 1.3900e+00, 4.0153e+05, 1.8513e+00,
         1.4736e+00, 1.2904e+00, 1.3580e+00],
        [3.8348e+05, 3.8350e+05, 7.7372e+05, 3.8346e+05, 3.8348e+05, 0.0000e+00,
         3.8349e+05, 8.1176e+05, 3.8345e+05, 3.8348e+05, 7.8491e+05, 3.8348e+05,
         3.8347e+05, 3.8347e+05, 3.8349e+05],
        [1.5011e+00, 1.3023e+00, 3.8872e+05, 1.3773e+00, 1.4942e+00, 3.8349e+05,
         0.0000e+00, 3.9580e+05, 1.3934e+00, 1.2997e+00, 4.0156e+05, 1.3191e+00,
         1.2594e+00, 1.5883e+00, 1.4913e+00],
        [3.9580e+05, 3.9578e+05, 7.8360e+05, 3.9581e+05, 3.9580e+05, 8.1176e+05,
         3.9580e+05, 0.0000e+00, 3.9578e+05, 3.9580e+05, 7.9535e+05, 3.9579e+05,
         3.9578e+05, 3.9579e+05, 3.9577e+05],
        [1.4473e+00, 1.2077e+00, 3.8873e+05, 1.3210e+00, 1.4606e+00, 3.8345e+05,
         1.3934e+00, 3.9578e+05, 0.0000e+00, 1.3971e+00, 4.0151e+05, 1.3374e+00,
         1.3092e+00, 1.5540e+00, 1.5243e+00],
        [1.3660e+00, 1.2436e+00, 3.8870e+05, 1.3345e+00, 1.3900e+00, 3.8348e+05,
         1.2997e+00, 3.9580e+05, 1.3971e+00, 0.0000e+00, 4.0153e+05, 1.5002e+00,
         1.3003e+00, 1.5677e+00, 1.3922e+00],
        [4.0153e+05, 4.0156e+05, 7.9943e+05, 4.0153e+05, 4.0153e+05, 7.8491e+05,
         4.0156e+05, 7.9535e+05, 4.0151e+05, 4.0153e+05, 0.0000e+00, 4.0154e+05,
         4.0154e+05, 4.0153e+05, 4.0152e+05],
        [1.7546e+00, 1.2516e+00, 3.8875e+05, 1.5713e+00, 1.8513e+00, 3.8348e+05,
         1.3191e+00, 3.9579e+05, 1.3374e+00, 1.5002e+00, 4.0154e+05, 0.0000e+00,
         1.1879e+00, 2.0705e+00, 1.8266e+00],
        [1.4962e+00, 1.1638e+00, 3.8871e+05, 1.2768e+00, 1.4736e+00, 3.8347e+05,
         1.2594e+00, 3.9578e+05, 1.3092e+00, 1.3003e+00, 4.0154e+05, 1.1879e+00,
         0.0000e+00, 1.6762e+00, 1.5104e+00],
        [1.3732e+00, 1.4989e+00, 3.8870e+05, 1.3188e+00, 1.2904e+00, 3.8347e+05,
         1.5883e+00, 3.9579e+05, 1.5540e+00, 1.5677e+00, 4.0153e+05, 2.0705e+00,
         1.6762e+00, 0.0000e+00, 1.3833e+00],
        [1.2973e+00, 1.4853e+00, 3.8877e+05, 1.2983e+00, 1.3580e+00, 3.8349e+05,
         1.4913e+00, 3.9577e+05, 1.5243e+00, 1.3922e+00, 4.0152e+05, 1.8266e+00,
         1.5104e+00, 1.3833e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2479e+00, 1.2973e+00, 1.3162e+00, 1.3660e+00, 1.3732e+00,
        1.4141e+00, 1.4473e+00, 1.4962e+00, 1.5011e+00, 1.7546e+00, 3.8348e+05,
        3.8870e+05, 3.9580e+05, 4.0153e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1638e+00, 1.1971e+00, 1.2077e+00, 1.2436e+00, 1.2516e+00,
        1.3023e+00, 1.3127e+00, 1.4141e+00, 1.4853e+00, 1.4989e+00, 3.8350e+05,
        3.8871e+05, 3.9578e+05, 4.0156e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388698.6875, 388700.0625, 388703.8125, 388708.9375,
        388711.5625, 388715.8750, 388717.4688, 388727.5625, 388731.9062,
        388749.6250, 388767.1875, 773716.8125, 783602.9375, 799427.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1968e+00, 1.1971e+00, 1.2479e+00, 1.2768e+00, 1.2983e+00,
        1.3188e+00, 1.3210e+00, 1.3345e+00, 1.3773e+00, 1.5713e+00, 3.8346e+05,
        3.8873e+05, 3.9581e+05, 4.0153e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1968e+00, 1.2904e+00, 1.3127e+00, 1.3162e+00, 1.3580e+00,
        1.3900e+00, 1.4606e+00, 1.4736e+00, 1.4942e+00, 1.8513e+00, 3.8348e+05,
        3.8872e+05, 3.9580e+05, 4.0153e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 383454.1250, 383456.1875, 383471.1875, 383471.5312,
        383476.7188, 383478.0625, 383480.6875, 383484.5625, 383486.7812,
        383488.2812, 383503.5000, 773716.8125, 784909.1250, 811759.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2594e+00, 1.2997e+00, 1.3023e+00, 1.3191e+00, 1.3773e+00,
        1.3934e+00, 1.4913e+00, 1.4942e+00, 1.5011e+00, 1.5883e+00, 3.8349e+05,
        3.8872e+05, 3.9580e+05, 4.0156e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 395774.5938, 395780.1875, 395782.0938, 395784.3750,
        395786.3125, 395792.5625, 395795.7188, 395798.9062, 395801.0938,
        395802.5938, 395810.3125, 783602.9375, 795354.3750, 811759.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2077e+00, 1.3092e+00, 1.3210e+00, 1.3374e+00, 1.3934e+00,
        1.3971e+00, 1.4473e+00, 1.4606e+00, 1.5243e+00, 1.5540e+00, 3.8345e+05,
        3.8873e+05, 3.9578e+05, 4.0151e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2436e+00, 1.2997e+00, 1.3003e+00, 1.3345e+00, 1.3660e+00,
        1.3900e+00, 1.3922e+00, 1.3971e+00, 1.5002e+00, 1.5677e+00, 3.8348e+05,
        3.8870e+05, 3.9580e+05, 4.0153e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 401509.4375, 401515.6250, 401525.9375, 401526.6250,
        401528.4688, 401529.2188, 401530.1250, 401535.0938, 401539.1250,
        401556.8125, 401557.3750, 784909.1250, 795354.3750, 799427.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1879e+00, 1.2516e+00, 1.3191e+00, 1.3374e+00, 1.5002e+00,
        1.5713e+00, 1.7546e+00, 1.8266e+00, 1.8513e+00, 2.0705e+00, 3.8348e+05,
        3.8875e+05, 3.9579e+05, 4.0154e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1638e+00, 1.1879e+00, 1.2594e+00, 1.2768e+00, 1.3003e+00,
        1.3092e+00, 1.4736e+00, 1.4962e+00, 1.5104e+00, 1.6762e+00, 3.8347e+05,
        3.8871e+05, 3.9578e+05, 4.0154e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2904e+00, 1.3188e+00, 1.3732e+00, 1.3833e+00, 1.4989e+00,
        1.5540e+00, 1.5677e+00, 1.5883e+00, 1.6762e+00, 2.0705e+00, 3.8347e+05,
        3.8870e+05, 3.9579e+05, 4.0153e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2973e+00, 1.2983e+00, 1.3580e+00, 1.3833e+00, 1.3922e+00,
        1.4853e+00, 1.4913e+00, 1.5104e+00, 1.5243e+00, 1.8266e+00, 3.8349e+05,
        3.8877e+05, 3.9577e+05, 4.0152e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.38', '1.29', '388721.16', '1.29', '1.37', '383473.31', '1.38', '395791.69', '1.38', '1.36', '401532.12', '1.51', '1.33', '1.47', '1.42']
estimated f for each client, fs: [5, 5, 2, 5, 5, 5, 5, 2, 5, 5, 2, 5, 5, 5, 5]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0112s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:11...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:11, End: 2025-07-22 15:30:11)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 17, 1, 9, 20, 18, 8, 4, 3, 11, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.4076e+00, 3.9399e+05, 1.5161e+00, 1.2862e+00, 3.7690e+05,
         3.9375e+05, 1.4752e+00, 1.3330e+00, 1.2867e+00, 1.6763e+00, 3.9812e+05,
         1.3329e+00, 1.2435e+00],
        [1.4076e+00, 0.0000e+00, 3.9395e+05, 1.2281e+00, 1.3126e+00, 3.7692e+05,
         3.9377e+05, 1.2881e+00, 1.2220e+00, 1.2322e+00, 1.2411e+00, 3.9813e+05,
         1.5226e+00, 1.4377e+00],
        [3.9399e+05, 3.9395e+05, 0.0000e+00, 3.9396e+05, 3.9397e+05, 7.5626e+05,
         7.9034e+05, 3.9401e+05, 3.9397e+05, 3.9399e+05, 3.9398e+05, 8.0632e+05,
         3.9395e+05, 3.9399e+05],
        [1.5161e+00, 1.2281e+00, 3.9396e+05, 0.0000e+00, 1.5301e+00, 3.7689e+05,
         3.9375e+05, 1.3912e+00, 1.2947e+00, 1.4060e+00, 1.1118e+00, 3.9816e+05,
         1.6810e+00, 1.5584e+00],
        [1.2862e+00, 1.3126e+00, 3.9397e+05, 1.5301e+00, 0.0000e+00, 3.7688e+05,
         3.9376e+05, 1.4328e+00, 1.3407e+00, 1.3113e+00, 1.7713e+00, 3.9813e+05,
         1.2900e+00, 1.3120e+00],
        [3.7690e+05, 3.7692e+05, 7.5626e+05, 3.7689e+05, 3.7688e+05, 0.0000e+00,
         7.7912e+05, 3.7692e+05, 3.7691e+05, 3.7691e+05, 3.7694e+05, 7.7845e+05,
         3.7692e+05, 3.7689e+05],
        [3.9375e+05, 3.9377e+05, 7.9034e+05, 3.9375e+05, 3.9376e+05, 7.7912e+05,
         0.0000e+00, 3.9376e+05, 3.9377e+05, 3.9380e+05, 3.9374e+05, 7.8393e+05,
         3.9378e+05, 3.9375e+05],
        [1.4752e+00, 1.2881e+00, 3.9401e+05, 1.3912e+00, 1.4328e+00, 3.7692e+05,
         3.9376e+05, 0.0000e+00, 1.3065e+00, 1.3089e+00, 1.3208e+00, 3.9816e+05,
         1.5332e+00, 1.4145e+00],
        [1.3330e+00, 1.2220e+00, 3.9397e+05, 1.2947e+00, 1.3407e+00, 3.7691e+05,
         3.9377e+05, 1.3065e+00, 0.0000e+00, 1.2926e+00, 1.3092e+00, 3.9815e+05,
         1.4221e+00, 1.3935e+00],
        [1.2867e+00, 1.2322e+00, 3.9399e+05, 1.4060e+00, 1.3113e+00, 3.7691e+05,
         3.9380e+05, 1.3089e+00, 1.2926e+00, 0.0000e+00, 1.4453e+00, 3.9817e+05,
         1.5044e+00, 1.3253e+00],
        [1.6763e+00, 1.2411e+00, 3.9398e+05, 1.1118e+00, 1.7713e+00, 3.7694e+05,
         3.9374e+05, 1.3208e+00, 1.3092e+00, 1.4453e+00, 0.0000e+00, 3.9815e+05,
         1.9893e+00, 1.7386e+00],
        [3.9812e+05, 3.9813e+05, 8.0632e+05, 3.9816e+05, 3.9813e+05, 7.7845e+05,
         7.8393e+05, 3.9816e+05, 3.9815e+05, 3.9817e+05, 3.9815e+05, 0.0000e+00,
         3.9815e+05, 3.9812e+05],
        [1.3329e+00, 1.5226e+00, 3.9395e+05, 1.6810e+00, 1.2900e+00, 3.7692e+05,
         3.9378e+05, 1.5332e+00, 1.4221e+00, 1.5044e+00, 1.9893e+00, 3.9815e+05,
         0.0000e+00, 1.3464e+00],
        [1.2435e+00, 1.4377e+00, 3.9399e+05, 1.5584e+00, 1.3120e+00, 3.7689e+05,
         3.9375e+05, 1.4145e+00, 1.3935e+00, 1.3253e+00, 1.7386e+00, 3.9812e+05,
         1.3464e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2435e+00, 1.2862e+00, 1.2867e+00, 1.3329e+00, 1.3330e+00,
        1.4076e+00, 1.4752e+00, 1.5161e+00, 1.6763e+00, 3.7690e+05, 3.9375e+05,
        3.9399e+05, 3.9812e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2220e+00, 1.2281e+00, 1.2322e+00, 1.2411e+00, 1.2881e+00,
        1.3126e+00, 1.4076e+00, 1.4377e+00, 1.5226e+00, 3.7692e+05, 3.9377e+05,
        3.9395e+05, 3.9813e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393948.5000, 393952.5938, 393964.5312, 393968.7188,
        393969.3125, 393980.6250, 393985.8438, 393988.7500, 393994.2500,
        394014.0000, 756264.1875, 790343.3750, 806322.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1118e+00, 1.2281e+00, 1.2947e+00, 1.3912e+00, 1.4060e+00,
        1.5161e+00, 1.5301e+00, 1.5584e+00, 1.6810e+00, 3.7689e+05, 3.9375e+05,
        3.9396e+05, 3.9816e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2862e+00, 1.2900e+00, 1.3113e+00, 1.3120e+00, 1.3126e+00,
        1.3407e+00, 1.4328e+00, 1.5301e+00, 1.7713e+00, 3.7688e+05, 3.9376e+05,
        3.9397e+05, 3.9813e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 376883.6250, 376888.1875, 376893.6562, 376903.6250,
        376909.8438, 376913.6562, 376918.1875, 376923.1250, 376924.2812,
        376935.5000, 756264.1875, 778448.5000, 779121.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393737.6875, 393747.8125, 393753.4062, 393754.1250,
        393756.2500, 393761.6562, 393766.5625, 393769.1562, 393782.3438,
        393795.6875, 779121.8750, 783926.1250, 790343.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2881e+00, 1.3065e+00, 1.3089e+00, 1.3208e+00, 1.3912e+00,
        1.4145e+00, 1.4328e+00, 1.4752e+00, 1.5332e+00, 3.7692e+05, 3.9376e+05,
        3.9401e+05, 3.9816e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2220e+00, 1.2926e+00, 1.2947e+00, 1.3065e+00, 1.3092e+00,
        1.3330e+00, 1.3407e+00, 1.3935e+00, 1.4221e+00, 3.7691e+05, 3.9377e+05,
        3.9397e+05, 3.9815e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2322e+00, 1.2867e+00, 1.2926e+00, 1.3089e+00, 1.3113e+00,
        1.3253e+00, 1.4060e+00, 1.4453e+00, 1.5044e+00, 3.7691e+05, 3.9380e+05,
        3.9399e+05, 3.9817e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1118e+00, 1.2411e+00, 1.3092e+00, 1.3208e+00, 1.4453e+00,
        1.6763e+00, 1.7386e+00, 1.7713e+00, 1.9893e+00, 3.7694e+05, 3.9374e+05,
        3.9398e+05, 3.9815e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 398121.5625, 398124.8125, 398131.5938, 398132.0312,
        398145.9062, 398149.8750, 398151.6875, 398155.4375, 398158.0625,
        398171.6875, 778448.5000, 783926.1250, 806322.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2900e+00, 1.3329e+00, 1.3464e+00, 1.4221e+00, 1.5044e+00,
        1.5226e+00, 1.5332e+00, 1.6810e+00, 1.9893e+00, 3.7692e+05, 3.9378e+05,
        3.9395e+05, 3.9815e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2435e+00, 1.3120e+00, 1.3253e+00, 1.3464e+00, 1.3935e+00,
        1.4145e+00, 1.4377e+00, 1.5584e+00, 1.7386e+00, 3.7689e+05, 3.9375e+05,
        3.9399e+05, 3.9812e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.40', '1.32', '393976.66', '1.41', '1.40', '376906.47', '393762.47', '1.39', '1.32', '1.35', '1.51', '398144.25', '1.51', '1.42']
estimated f for each client, fs: [4, 4, 2, 4, 4, 4, 2, 4, 4, 4, 4, 2, 4, 4]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 17, 1, 9, 20, 18, 8, 4, 3, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0096s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:11...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:11, End: 2025-07-22 15:30:11)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [7, 2, 19, 17, 1, 20, 18, 8, 4, 13, 14, 11, 10, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.5780e+00, 3.9560e+05, 4.0250e+05, 1.2230e+00, 3.9697e+05,
         3.8904e+05, 1.2265e+00, 1.1784e+00, 3.9315e+05, 3.9695e+05, 1.4054e+00,
         1.3676e+00, 1.2541e+00],
        [1.5780e+00, 0.0000e+00, 3.9556e+05, 4.0250e+05, 1.1748e+00, 3.9701e+05,
         3.8900e+05, 1.4301e+00, 1.4370e+00, 3.9316e+05, 3.9692e+05, 1.0738e+00,
         1.2619e+00, 1.8396e+00],
        [3.9560e+05, 3.9556e+05, 0.0000e+00, 7.8748e+05, 3.9556e+05, 8.0897e+05,
         7.9867e+05, 3.9559e+05, 3.9558e+05, 8.2091e+05, 7.8847e+05, 3.9559e+05,
         3.9559e+05, 3.9557e+05],
        [4.0250e+05, 4.0250e+05, 7.8748e+05, 0.0000e+00, 4.0253e+05, 7.9993e+05,
         7.6584e+05, 4.0257e+05, 4.0253e+05, 7.9499e+05, 7.8213e+05, 4.0253e+05,
         4.0255e+05, 4.0251e+05],
        [1.2230e+00, 1.1748e+00, 3.9556e+05, 4.0253e+05, 0.0000e+00, 3.9697e+05,
         3.8903e+05, 1.1950e+00, 1.1184e+00, 3.9315e+05, 3.9695e+05, 1.0038e+00,
         1.0875e+00, 1.3449e+00],
        [3.9697e+05, 3.9701e+05, 8.0897e+05, 7.9993e+05, 3.9697e+05, 0.0000e+00,
         7.6555e+05, 3.9696e+05, 3.9697e+05, 7.8006e+05, 7.8222e+05, 3.9698e+05,
         3.9699e+05, 3.9696e+05],
        [3.8904e+05, 3.8900e+05, 7.9867e+05, 7.6584e+05, 3.8903e+05, 7.6555e+05,
         0.0000e+00, 3.8904e+05, 3.8900e+05, 7.7710e+05, 7.9532e+05, 3.8902e+05,
         3.8905e+05, 3.8903e+05],
        [1.2265e+00, 1.4301e+00, 3.9559e+05, 4.0257e+05, 1.1950e+00, 3.9696e+05,
         3.8904e+05, 0.0000e+00, 1.1496e+00, 3.9317e+05, 3.9694e+05, 1.1976e+00,
         1.1692e+00, 1.3236e+00],
        [1.1784e+00, 1.4370e+00, 3.9558e+05, 4.0253e+05, 1.1184e+00, 3.9697e+05,
         3.8900e+05, 1.1496e+00, 0.0000e+00, 3.9315e+05, 3.9695e+05, 1.2230e+00,
         1.2175e+00, 1.2603e+00],
        [3.9315e+05, 3.9316e+05, 8.2091e+05, 7.9499e+05, 3.9315e+05, 7.8006e+05,
         7.7710e+05, 3.9317e+05, 3.9315e+05, 0.0000e+00, 7.8259e+05, 3.9316e+05,
         3.9316e+05, 3.9316e+05],
        [3.9695e+05, 3.9692e+05, 7.8847e+05, 7.8213e+05, 3.9695e+05, 7.8222e+05,
         7.9532e+05, 3.9694e+05, 3.9695e+05, 7.8259e+05, 0.0000e+00, 3.9694e+05,
         3.9695e+05, 3.9696e+05],
        [1.4054e+00, 1.0738e+00, 3.9559e+05, 4.0253e+05, 1.0038e+00, 3.9698e+05,
         3.8902e+05, 1.1976e+00, 1.2230e+00, 3.9316e+05, 3.9694e+05, 0.0000e+00,
         1.1182e+00, 1.6119e+00],
        [1.3676e+00, 1.2619e+00, 3.9559e+05, 4.0255e+05, 1.0875e+00, 3.9699e+05,
         3.8905e+05, 1.1692e+00, 1.2175e+00, 3.9316e+05, 3.9695e+05, 1.1182e+00,
         0.0000e+00, 1.3987e+00],
        [1.2541e+00, 1.8396e+00, 3.9557e+05, 4.0251e+05, 1.3449e+00, 3.9696e+05,
         3.8903e+05, 1.3236e+00, 1.2603e+00, 3.9316e+05, 3.9696e+05, 1.6119e+00,
         1.3987e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1784e+00, 1.2230e+00, 1.2265e+00, 1.2541e+00, 1.3676e+00,
        1.4054e+00, 1.5780e+00, 3.8904e+05, 3.9315e+05, 3.9560e+05, 3.9695e+05,
        3.9697e+05, 4.0250e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0738e+00, 1.1748e+00, 1.2619e+00, 1.4301e+00, 1.4370e+00,
        1.5780e+00, 1.8396e+00, 3.8900e+05, 3.9316e+05, 3.9556e+05, 3.9692e+05,
        3.9701e+05, 4.0250e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 395557.8125, 395558.1250, 395569.9062, 395580.1875,
        395588.6875, 395591.3750, 395591.8438, 395601.5000, 787475.6875,
        788471.8750, 798670.2500, 808969.1875, 820905.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 402500.6562, 402502.7500, 402514.9688, 402529.1250,
        402532.5312, 402534.8125, 402547.1875, 402567.9062, 765839.2500,
        782127.1250, 787475.6875, 794990.2500, 799930.3125])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0038e+00, 1.0875e+00, 1.1184e+00, 1.1748e+00, 1.1950e+00,
        1.2230e+00, 1.3449e+00, 3.8903e+05, 3.9315e+05, 3.9556e+05, 3.9695e+05,
        3.9697e+05, 4.0253e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396962.5000, 396962.7188, 396966.5625, 396968.0625,
        396969.7188, 396980.9062, 396993.3438, 397014.2500, 765553.6250,
        780063.8125, 782220.8125, 799930.3125, 808969.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 388997.1875, 389003.8750, 389016.5312, 389025.2500,
        389026.2500, 389035.3438, 389035.7812, 389050.1875, 765553.6250,
        765839.2500, 777100.4375, 795320.2500, 798670.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1496e+00, 1.1692e+00, 1.1950e+00, 1.1976e+00, 1.2265e+00,
        1.3236e+00, 1.4301e+00, 3.8904e+05, 3.9317e+05, 3.9559e+05, 3.9694e+05,
        3.9696e+05, 4.0257e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1184e+00, 1.1496e+00, 1.1784e+00, 1.2175e+00, 1.2230e+00,
        1.2603e+00, 1.4370e+00, 3.8900e+05, 3.9315e+05, 3.9558e+05, 3.9695e+05,
        3.9697e+05, 4.0253e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393146.2500, 393148.0625, 393150.1875, 393157.5625,
        393161.0000, 393162.1875, 393164.8438, 393171.6562, 777100.4375,
        780063.8125, 782589.8750, 794990.2500, 820905.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396920.0625, 396935.6875, 396941.2500, 396947.1875,
        396952.5938, 396954.2500, 396954.3750, 396962.5000, 782127.1250,
        782220.8125, 782589.8750, 788471.8750, 795320.2500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0038e+00, 1.0738e+00, 1.1182e+00, 1.1976e+00, 1.2230e+00,
        1.4054e+00, 1.6119e+00, 3.8902e+05, 3.9316e+05, 3.9559e+05, 3.9694e+05,
        3.9698e+05, 4.0253e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0875e+00, 1.1182e+00, 1.1692e+00, 1.2175e+00, 1.2619e+00,
        1.3676e+00, 1.3987e+00, 3.8905e+05, 3.9316e+05, 3.9559e+05, 3.9695e+05,
        3.9699e+05, 4.0255e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2541e+00, 1.2603e+00, 1.3236e+00, 1.3449e+00, 1.3987e+00,
        1.6119e+00, 1.8396e+00, 3.8903e+05, 3.9316e+05, 3.9557e+05, 3.9696e+05,
        3.9696e+05, 4.0251e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['86910.34', '86907.55', '439123.91', '442896.56', '86909.40', '437930.19', '430860.41', '86912.86', '86906.52', '435818.03', '439743.84', '86910.00', '86912.93', '86910.83']
estimated f for each client, fs: [6, 6, 4, 4, 6, 4, 4, 6, 6, 4, 4, 6, 6, 6]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [7, 2, 19, 17, 1, 20, 18, 8, 4, 13, 14, 11, 10, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0208s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:12...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:12, End: 2025-07-22 15:30:12)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (10): [5, 7, 2, 20, 18, 8, 10, 16, 6, 12], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 1.2185e+00, 1.5112e+00, 3.8495e+05, 3.9728e+05, 1.3307e+00,
         1.3380e+00, 3.9825e+05, 1.3027e+00, 1.2110e+00],
        [1.2185e+00, 0.0000e+00, 1.3523e+00, 3.8496e+05, 3.9729e+05, 1.2375e+00,
         1.3406e+00, 3.9825e+05, 1.3462e+00, 1.3020e+00],
        [1.5112e+00, 1.3523e+00, 0.0000e+00, 3.8496e+05, 3.9729e+05, 1.2079e+00,
         1.0665e+00, 3.9825e+05, 1.6101e+00, 1.5606e+00],
        [3.8495e+05, 3.8496e+05, 3.8496e+05, 0.0000e+00, 7.6547e+05, 3.8499e+05,
         3.8497e+05, 7.8664e+05, 3.8500e+05, 3.8495e+05],
        [3.9728e+05, 3.9729e+05, 3.9729e+05, 7.6547e+05, 0.0000e+00, 3.9731e+05,
         3.9726e+05, 8.2880e+05, 3.9729e+05, 3.9729e+05],
        [1.3307e+00, 1.2375e+00, 1.2079e+00, 3.8499e+05, 3.9731e+05, 0.0000e+00,
         1.1677e+00, 3.9825e+05, 1.3550e+00, 1.3616e+00],
        [1.3380e+00, 1.3406e+00, 1.0665e+00, 3.8497e+05, 3.9726e+05, 1.1677e+00,
         0.0000e+00, 3.9826e+05, 1.4761e+00, 1.3759e+00],
        [3.9825e+05, 3.9825e+05, 3.9825e+05, 7.8664e+05, 8.2880e+05, 3.9825e+05,
         3.9826e+05, 0.0000e+00, 3.9831e+05, 3.9827e+05],
        [1.3027e+00, 1.3462e+00, 1.6101e+00, 3.8500e+05, 3.9729e+05, 1.3550e+00,
         1.4761e+00, 3.9831e+05, 0.0000e+00, 1.3060e+00],
        [1.2110e+00, 1.3020e+00, 1.5606e+00, 3.8495e+05, 3.9729e+05, 1.3616e+00,
         1.3759e+00, 3.9827e+05, 1.3060e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2110e+00, 1.2185e+00, 1.3027e+00, 1.3307e+00, 1.3380e+00,
        1.5112e+00, 3.8495e+05, 3.9728e+05, 3.9825e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.2185e+00, 1.2375e+00, 1.3020e+00, 1.3406e+00, 1.3462e+00,
        1.3523e+00, 3.8496e+05, 3.9729e+05, 3.9825e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.0665e+00, 1.2079e+00, 1.3523e+00, 1.5112e+00, 1.5606e+00,
        1.6101e+00, 3.8496e+05, 3.9729e+05, 3.9825e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 384947.2812, 384952.2500, 384956.2812, 384964.8438,
        384973.4375, 384987.8438, 384999.4062, 765474.3125, 786641.1250])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 397260.5000, 397284.1562, 397285.8125, 397285.8750,
        397289.5625, 397293.3125, 397314.0625, 765474.3125, 828795.7500])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.1677e+00, 1.2079e+00, 1.2375e+00, 1.3307e+00, 1.3550e+00,
        1.3616e+00, 3.8499e+05, 3.9731e+05, 3.9825e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.0665e+00, 1.1677e+00, 1.3380e+00, 1.3406e+00, 1.3759e+00,
        1.4761e+00, 3.8497e+05, 3.9726e+05, 3.9826e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([     0.0000, 398246.0000, 398247.5938, 398250.3438, 398253.0625,
        398261.9062, 398265.4375, 398314.8750, 786641.1250, 828795.7500])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.3027e+00, 1.3060e+00, 1.3462e+00, 1.3550e+00, 1.4761e+00,
        1.6101e+00, 3.8500e+05, 3.9729e+05, 3.9831e+05])
Index of maximum distance difference after half of values: 7
sorted_distances: tensor([0.0000e+00, 1.2110e+00, 1.3020e+00, 1.3060e+00, 1.3616e+00, 1.3759e+00,
        1.5606e+00, 3.8495e+05, 3.9729e+05, 3.9827e+05])
Index of maximum distance difference after half of values: 7
adaptive_Krum scores:  ['54993.59', '54994.86', '54996.16', '384968.72', '397287.59', '54999.36', '54997.30', '398262.75', '55001.11', '54994.33']
estimated f for each client, fs: [3, 3, 3, 1, 1, 3, 3, 1, 3, 3]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [5, 7, 2, 20, 18, 8, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0063s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:12...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:30:12, End: 2025-07-22 15:30:12)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [7, 2, 19, 9, 20, 8, 15, 4, 3, 13, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.4432e+00, 3.7152e+05, 1.3768e+00, 3.9464e+05, 1.3444e+00,
         3.9385e+05, 1.4248e+00, 1.4117e+00, 3.9171e+05, 1.4330e+00, 3.8904e+05,
         1.4891e+00, 1.4074e+00],
        [1.4432e+00, 0.0000e+00, 3.7153e+05, 1.4664e+00, 3.9461e+05, 1.3102e+00,
         3.9382e+05, 1.1140e+00, 1.3037e+00, 3.9170e+05, 1.1400e+00, 3.8907e+05,
         1.7037e+00, 1.6248e+00],
        [3.7152e+05, 3.7153e+05, 0.0000e+00, 3.7153e+05, 7.6356e+05, 3.7154e+05,
         7.6629e+05, 3.7152e+05, 3.7154e+05, 7.6669e+05, 3.7155e+05, 7.6392e+05,
         3.7154e+05, 3.7155e+05],
        [1.3768e+00, 1.4664e+00, 3.7153e+05, 0.0000e+00, 3.9459e+05, 1.4658e+00,
         3.9385e+05, 1.5309e+00, 1.3702e+00, 3.9170e+05, 1.3834e+00, 3.8908e+05,
         1.2937e+00, 1.4326e+00],
        [3.9464e+05, 3.9461e+05, 7.6356e+05, 3.9459e+05, 0.0000e+00, 3.9462e+05,
         8.0153e+05, 3.9461e+05, 3.9461e+05, 7.7624e+05, 3.9460e+05, 7.9575e+05,
         3.9459e+05, 3.9459e+05],
        [1.3444e+00, 1.3102e+00, 3.7154e+05, 1.4658e+00, 3.9462e+05, 0.0000e+00,
         3.9383e+05, 1.3026e+00, 1.3291e+00, 3.9169e+05, 1.2672e+00, 3.8904e+05,
         1.5247e+00, 1.4430e+00],
        [3.9385e+05, 3.9382e+05, 7.6629e+05, 3.9385e+05, 8.0153e+05, 3.9383e+05,
         0.0000e+00, 3.9380e+05, 3.9380e+05, 8.1050e+05, 3.9382e+05, 7.8724e+05,
         3.9384e+05, 3.9381e+05],
        [1.4248e+00, 1.1140e+00, 3.7152e+05, 1.5309e+00, 3.9461e+05, 1.3026e+00,
         3.9380e+05, 0.0000e+00, 1.3411e+00, 3.9170e+05, 1.2205e+00, 3.8905e+05,
         1.6441e+00, 1.5512e+00],
        [1.4117e+00, 1.3037e+00, 3.7154e+05, 1.3702e+00, 3.9461e+05, 1.3291e+00,
         3.9380e+05, 1.3411e+00, 0.0000e+00, 3.9169e+05, 1.2788e+00, 3.8905e+05,
         1.5502e+00, 1.3664e+00],
        [3.9171e+05, 3.9170e+05, 7.6669e+05, 3.9170e+05, 7.7624e+05, 3.9169e+05,
         8.1050e+05, 3.9170e+05, 3.9169e+05, 0.0000e+00, 3.9172e+05, 7.5168e+05,
         3.9168e+05, 3.9169e+05],
        [1.4330e+00, 1.1400e+00, 3.7155e+05, 1.3834e+00, 3.9460e+05, 1.2672e+00,
         3.9382e+05, 1.2205e+00, 1.2788e+00, 3.9172e+05, 0.0000e+00, 3.8907e+05,
         1.5987e+00, 1.4854e+00],
        [3.8904e+05, 3.8907e+05, 7.6392e+05, 3.8908e+05, 7.9575e+05, 3.8904e+05,
         7.8724e+05, 3.8905e+05, 3.8905e+05, 7.5168e+05, 3.8907e+05, 0.0000e+00,
         3.8904e+05, 3.8906e+05],
        [1.4891e+00, 1.7037e+00, 3.7154e+05, 1.2937e+00, 3.9459e+05, 1.5247e+00,
         3.9384e+05, 1.6441e+00, 1.5502e+00, 3.9168e+05, 1.5987e+00, 3.8904e+05,
         0.0000e+00, 1.4217e+00],
        [1.4074e+00, 1.6248e+00, 3.7155e+05, 1.4326e+00, 3.9459e+05, 1.4430e+00,
         3.9381e+05, 1.5512e+00, 1.3664e+00, 3.9169e+05, 1.4854e+00, 3.8906e+05,
         1.4217e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3444e+00, 1.3768e+00, 1.4074e+00, 1.4117e+00, 1.4248e+00,
        1.4330e+00, 1.4432e+00, 1.4891e+00, 3.7152e+05, 3.8904e+05, 3.9171e+05,
        3.9385e+05, 3.9464e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1140e+00, 1.1400e+00, 1.3037e+00, 1.3102e+00, 1.4432e+00,
        1.4664e+00, 1.6248e+00, 1.7037e+00, 3.7153e+05, 3.8907e+05, 3.9170e+05,
        3.9382e+05, 3.9461e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 371522.0312, 371524.6562, 371533.1875, 371534.0938,
        371540.4375, 371540.6250, 371541.2812, 371549.8438, 371553.7500,
        763560.2500, 763916.0625, 766290.9375, 766689.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2937e+00, 1.3702e+00, 1.3768e+00, 1.3834e+00, 1.4326e+00,
        1.4658e+00, 1.4664e+00, 1.5309e+00, 3.7153e+05, 3.8908e+05, 3.9170e+05,
        3.9385e+05, 3.9459e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394585.1250, 394591.4375, 394594.3125, 394602.9375,
        394605.8750, 394608.1562, 394614.8125, 394620.4375, 394636.7812,
        763560.2500, 776239.2500, 795748.5000, 801532.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2672e+00, 1.3026e+00, 1.3102e+00, 1.3291e+00, 1.3444e+00,
        1.4430e+00, 1.4658e+00, 1.5247e+00, 3.7154e+05, 3.8904e+05, 3.9169e+05,
        3.9383e+05, 3.9462e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393799.5000, 393804.3125, 393809.7500, 393817.2812,
        393818.3438, 393832.6250, 393839.0312, 393852.6250, 393854.9688,
        766290.9375, 787237.2500, 801532.8750, 810498.4375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1140e+00, 1.2205e+00, 1.3026e+00, 1.3411e+00, 1.4248e+00,
        1.5309e+00, 1.5512e+00, 1.6441e+00, 3.7152e+05, 3.8905e+05, 3.9170e+05,
        3.9380e+05, 3.9461e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2788e+00, 1.3037e+00, 1.3291e+00, 1.3411e+00, 1.3664e+00,
        1.3702e+00, 1.4117e+00, 1.5502e+00, 3.7154e+05, 3.8905e+05, 3.9169e+05,
        3.9380e+05, 3.9461e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391681.8750, 391688.8125, 391691.8125, 391694.8125,
        391695.0312, 391696.5000, 391702.5625, 391706.5312, 391720.6250,
        751681.0625, 766689.0625, 776239.2500, 810498.4375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1400e+00, 1.2205e+00, 1.2672e+00, 1.2788e+00, 1.3834e+00,
        1.4330e+00, 1.4854e+00, 1.5987e+00, 3.7155e+05, 3.8907e+05, 3.9172e+05,
        3.9382e+05, 3.9460e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 389039.3438, 389043.3750, 389044.0000, 389050.1875,
        389051.3125, 389064.0312, 389065.6875, 389068.3125, 389081.1875,
        751681.0625, 763916.0625, 787237.2500, 795748.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2937e+00, 1.4217e+00, 1.4891e+00, 1.5247e+00, 1.5502e+00,
        1.5987e+00, 1.6441e+00, 1.7037e+00, 3.7154e+05, 3.8904e+05, 3.9168e+05,
        3.9384e+05, 3.9459e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3664e+00, 1.4074e+00, 1.4217e+00, 1.4326e+00, 1.4430e+00,
        1.4854e+00, 1.5512e+00, 1.6248e+00, 3.7155e+05, 3.8906e+05, 3.9169e+05,
        3.9381e+05, 3.9459e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['41281.48', '41282.70', '371537.75', '41282.82', '394606.62', '41283.52', '393825.38', '41281.75', '41283.59', '391697.59', '41284.52', '389056.38', '41283.62', '41285.05']
estimated f for each client, fs: [5, 5, 4, 5, 3, 5, 3, 5, 5, 3, 5, 3, 5, 5]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [7, 2, 19, 9, 20, 8, 15, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0203s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:13...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[188  49]
 [ 72 191]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:13, End: 2025-07-22 15:30:13)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 17, 1, 9, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.2696e+00, 3.9770e+05, 1.1962e+00, 1.4930e+00, 1.3200e+00,
         3.9334e+05, 1.2645e+00, 1.3486e+00, 3.9743e+05, 1.2653e+00, 1.2822e+00,
         4.0748e+05, 1.6038e+00, 1.4099e+00],
        [1.2696e+00, 0.0000e+00, 3.9769e+05, 1.0605e+00, 1.3994e+00, 1.2804e+00,
         3.9327e+05, 1.1306e+00, 1.2937e+00, 3.9742e+05, 1.1014e+00, 1.2088e+00,
         4.0745e+05, 1.6920e+00, 1.6034e+00],
        [3.9770e+05, 3.9769e+05, 0.0000e+00, 3.9773e+05, 3.9769e+05, 3.9771e+05,
         8.1272e+05, 3.9770e+05, 3.9771e+05, 8.1868e+05, 3.9771e+05, 3.9770e+05,
         8.3080e+05, 3.9770e+05, 3.9774e+05],
        [1.1962e+00, 1.0605e+00, 3.9773e+05, 0.0000e+00, 1.2809e+00, 1.2255e+00,
         3.9331e+05, 1.0779e+00, 1.2740e+00, 3.9741e+05, 1.1711e+00, 1.1568e+00,
         4.0748e+05, 1.4774e+00, 1.3710e+00],
        [1.4930e+00, 1.3994e+00, 3.9769e+05, 1.2809e+00, 0.0000e+00, 1.3941e+00,
         3.9330e+05, 1.4370e+00, 1.3330e+00, 3.9744e+05, 1.6679e+00, 1.4044e+00,
         4.0749e+05, 1.2920e+00, 1.3600e+00],
        [1.3200e+00, 1.2804e+00, 3.9771e+05, 1.2255e+00, 1.3941e+00, 0.0000e+00,
         3.9332e+05, 1.3177e+00, 1.3143e+00, 3.9742e+05, 1.3059e+00, 1.2840e+00,
         4.0748e+05, 1.5108e+00, 1.4422e+00],
        [3.9334e+05, 3.9327e+05, 8.1272e+05, 3.9331e+05, 3.9330e+05, 3.9332e+05,
         0.0000e+00, 3.9332e+05, 3.9330e+05, 7.7331e+05, 3.9332e+05, 3.9331e+05,
         7.9971e+05, 3.9334e+05, 3.9333e+05],
        [1.2645e+00, 1.1306e+00, 3.9770e+05, 1.0779e+00, 1.4370e+00, 1.3177e+00,
         3.9332e+05, 0.0000e+00, 1.3340e+00, 3.9742e+05, 1.1291e+00, 1.2559e+00,
         4.0749e+05, 1.6136e+00, 1.5262e+00],
        [1.3486e+00, 1.2937e+00, 3.9771e+05, 1.2740e+00, 1.3330e+00, 1.3143e+00,
         3.9330e+05, 1.3340e+00, 0.0000e+00, 3.9742e+05, 1.4624e+00, 1.3526e+00,
         4.0749e+05, 1.5228e+00, 1.3330e+00],
        [3.9743e+05, 3.9742e+05, 8.1868e+05, 3.9741e+05, 3.9744e+05, 3.9742e+05,
         7.7331e+05, 3.9742e+05, 3.9742e+05, 0.0000e+00, 3.9742e+05, 3.9743e+05,
         8.0535e+05, 3.9745e+05, 3.9743e+05],
        [1.2653e+00, 1.1014e+00, 3.9771e+05, 1.1711e+00, 1.6679e+00, 1.3059e+00,
         3.9332e+05, 1.1291e+00, 1.4624e+00, 3.9742e+05, 0.0000e+00, 1.2728e+00,
         4.0744e+05, 1.9059e+00, 1.7104e+00],
        [1.2822e+00, 1.2088e+00, 3.9770e+05, 1.1568e+00, 1.4044e+00, 1.2840e+00,
         3.9331e+05, 1.2559e+00, 1.3526e+00, 3.9743e+05, 1.2728e+00, 0.0000e+00,
         4.0746e+05, 1.6321e+00, 1.5410e+00],
        [4.0748e+05, 4.0745e+05, 8.3080e+05, 4.0748e+05, 4.0749e+05, 4.0748e+05,
         7.9971e+05, 4.0749e+05, 4.0749e+05, 8.0535e+05, 4.0744e+05, 4.0746e+05,
         0.0000e+00, 4.0753e+05, 4.0750e+05],
        [1.6038e+00, 1.6920e+00, 3.9770e+05, 1.4774e+00, 1.2920e+00, 1.5108e+00,
         3.9334e+05, 1.6136e+00, 1.5228e+00, 3.9745e+05, 1.9059e+00, 1.6321e+00,
         4.0753e+05, 0.0000e+00, 1.3901e+00],
        [1.4099e+00, 1.6034e+00, 3.9774e+05, 1.3710e+00, 1.3600e+00, 1.4422e+00,
         3.9333e+05, 1.5262e+00, 1.3330e+00, 3.9743e+05, 1.7104e+00, 1.5410e+00,
         4.0750e+05, 1.3901e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1962e+00, 1.2645e+00, 1.2653e+00, 1.2696e+00, 1.2822e+00,
        1.3200e+00, 1.3486e+00, 1.4099e+00, 1.4930e+00, 1.6038e+00, 3.9334e+05,
        3.9743e+05, 3.9770e+05, 4.0748e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0605e+00, 1.1014e+00, 1.1306e+00, 1.2088e+00, 1.2696e+00,
        1.2804e+00, 1.2937e+00, 1.3994e+00, 1.6034e+00, 1.6920e+00, 3.9327e+05,
        3.9742e+05, 3.9769e+05, 4.0745e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397690.2500, 397694.7500, 397696.0938, 397699.5312,
        397703.0938, 397704.3438, 397709.0000, 397710.4375, 397711.7188,
        397732.3750, 397741.5625, 812716.0000, 818675.5000, 830796.9375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0605e+00, 1.0779e+00, 1.1568e+00, 1.1711e+00, 1.1962e+00,
        1.2255e+00, 1.2740e+00, 1.2809e+00, 1.3710e+00, 1.4774e+00, 3.9331e+05,
        3.9741e+05, 3.9773e+05, 4.0748e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2809e+00, 1.2920e+00, 1.3330e+00, 1.3600e+00, 1.3941e+00,
        1.3994e+00, 1.4044e+00, 1.4370e+00, 1.4930e+00, 1.6679e+00, 3.9330e+05,
        3.9744e+05, 3.9769e+05, 4.0749e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2255e+00, 1.2804e+00, 1.2840e+00, 1.3059e+00, 1.3143e+00,
        1.3177e+00, 1.3200e+00, 1.3941e+00, 1.4422e+00, 1.5108e+00, 3.9332e+05,
        3.9742e+05, 3.9771e+05, 4.0748e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 393271.7188, 393303.7500, 393304.4375, 393306.5625,
        393307.0938, 393318.9375, 393319.6875, 393321.2812, 393325.9375,
        393336.3750, 393337.9688, 773309.0625, 799707.5000, 812716.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0779e+00, 1.1291e+00, 1.1306e+00, 1.2559e+00, 1.2645e+00,
        1.3177e+00, 1.3340e+00, 1.4370e+00, 1.5262e+00, 1.6136e+00, 3.9332e+05,
        3.9742e+05, 3.9770e+05, 4.0749e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2740e+00, 1.2937e+00, 1.3143e+00, 1.3330e+00, 1.3330e+00,
        1.3340e+00, 1.3486e+00, 1.3526e+00, 1.4624e+00, 1.5228e+00, 3.9330e+05,
        3.9742e+05, 3.9771e+05, 4.0749e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 397411.8750, 397419.6875, 397421.4375, 397421.8125,
        397424.4688, 397424.5000, 397429.2812, 397429.5312, 397433.3438,
        397442.0312, 397449.9062, 773309.0625, 805348.6250, 818675.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1014e+00, 1.1291e+00, 1.1711e+00, 1.2653e+00, 1.2728e+00,
        1.3059e+00, 1.4624e+00, 1.6679e+00, 1.7104e+00, 1.9059e+00, 3.9332e+05,
        3.9742e+05, 3.9771e+05, 4.0744e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1568e+00, 1.2088e+00, 1.2559e+00, 1.2728e+00, 1.2822e+00,
        1.2840e+00, 1.3526e+00, 1.4044e+00, 1.5410e+00, 1.6321e+00, 3.9331e+05,
        3.9743e+05, 3.9770e+05, 4.0746e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 407441.7500, 407452.0000, 407458.8125, 407482.8125,
        407483.8438, 407484.8750, 407485.0625, 407490.2188, 407491.3750,
        407498.0312, 407526.7188, 799707.5000, 805348.6250, 830796.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2920e+00, 1.3901e+00, 1.4774e+00, 1.5108e+00, 1.5228e+00,
        1.6038e+00, 1.6136e+00, 1.6321e+00, 1.6920e+00, 1.9059e+00, 3.9334e+05,
        3.9745e+05, 3.9770e+05, 4.0753e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.3330e+00, 1.3600e+00, 1.3710e+00, 1.3901e+00, 1.4099e+00,
        1.4422e+00, 1.5262e+00, 1.5410e+00, 1.6034e+00, 1.7104e+00, 3.9333e+05,
        3.9743e+05, 3.9774e+05, 4.0750e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['1.32', '1.26', '397702.16', '1.20', '1.38', '1.32', '393313.97', '1.27', '1.34', '397428.03', '1.34', '1.31', '407481.38', '1.53', '1.44']
estimated f for each client, fs: [5, 5, 5, 5, 5, 5, 2, 5, 5, 2, 5, 5, 2, 5, 5]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 17, 1, 9, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0149s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:13...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:13, End: 2025-07-22 15:30:13)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 19, 17, 1, 9, 20, 15, 4, 3, 14, 16, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.1267e+00, 1.1951e+00, 3.9468e+05, 4.0044e+05, 1.3613e+00,
         1.2884e+00, 3.9607e+05, 3.7989e+05, 1.1693e+00, 1.1991e+00, 3.9406e+05,
         3.9664e+05, 1.2239e+00],
        [1.1267e+00, 0.0000e+00, 1.0848e+00, 3.9469e+05, 4.0048e+05, 1.2529e+00,
         1.2998e+00, 3.9605e+05, 3.7991e+05, 1.0610e+00, 1.2696e+00, 3.9407e+05,
         3.9663e+05, 1.3428e+00],
        [1.1951e+00, 1.0848e+00, 0.0000e+00, 3.9470e+05, 4.0048e+05, 1.0999e+00,
         1.2973e+00, 3.9604e+05, 3.7992e+05, 1.0908e+00, 1.2047e+00, 3.9404e+05,
         3.9665e+05, 1.4701e+00],
        [3.9468e+05, 3.9469e+05, 3.9470e+05, 0.0000e+00, 8.0707e+05, 3.9466e+05,
         3.9469e+05, 7.8262e+05, 7.9224e+05, 3.9466e+05, 3.9472e+05, 8.0645e+05,
         7.7490e+05, 3.9469e+05],
        [4.0044e+05, 4.0048e+05, 4.0048e+05, 8.0707e+05, 0.0000e+00, 4.0048e+05,
         4.0045e+05, 8.0921e+05, 7.6559e+05, 4.0047e+05, 4.0045e+05, 7.8806e+05,
         7.7737e+05, 4.0046e+05],
        [1.3613e+00, 1.2529e+00, 1.0999e+00, 3.9466e+05, 4.0048e+05, 0.0000e+00,
         1.6572e+00, 3.9604e+05, 3.7988e+05, 1.1808e+00, 1.4909e+00, 3.9407e+05,
         3.9662e+05, 1.7339e+00],
        [1.2884e+00, 1.2998e+00, 1.2973e+00, 3.9469e+05, 4.0045e+05, 1.6572e+00,
         0.0000e+00, 3.9605e+05, 3.7993e+05, 1.3274e+00, 1.2374e+00, 3.9407e+05,
         3.9666e+05, 1.2618e+00],
        [3.9607e+05, 3.9605e+05, 3.9604e+05, 7.8262e+05, 8.0921e+05, 3.9604e+05,
         3.9605e+05, 0.0000e+00, 7.7240e+05, 3.9604e+05, 3.9604e+05, 8.0844e+05,
         8.0486e+05, 3.9606e+05],
        [3.7989e+05, 3.7991e+05, 3.7992e+05, 7.9224e+05, 7.6559e+05, 3.7988e+05,
         3.7993e+05, 7.7240e+05, 0.0000e+00, 3.7993e+05, 3.7991e+05, 7.5349e+05,
         7.8035e+05, 3.7992e+05],
        [1.1693e+00, 1.0610e+00, 1.0908e+00, 3.9466e+05, 4.0047e+05, 1.1808e+00,
         1.3274e+00, 3.9604e+05, 3.7993e+05, 0.0000e+00, 1.2493e+00, 3.9406e+05,
         3.9664e+05, 1.3980e+00],
        [1.1991e+00, 1.2696e+00, 1.2047e+00, 3.9472e+05, 4.0045e+05, 1.4909e+00,
         1.2374e+00, 3.9604e+05, 3.7991e+05, 1.2493e+00, 0.0000e+00, 3.9405e+05,
         3.9665e+05, 1.2492e+00],
        [3.9406e+05, 3.9407e+05, 3.9404e+05, 8.0645e+05, 7.8806e+05, 3.9407e+05,
         3.9407e+05, 8.0844e+05, 7.5349e+05, 3.9406e+05, 3.9405e+05, 0.0000e+00,
         7.9706e+05, 3.9405e+05],
        [3.9664e+05, 3.9663e+05, 3.9665e+05, 7.7490e+05, 7.7737e+05, 3.9662e+05,
         3.9666e+05, 8.0486e+05, 7.8035e+05, 3.9664e+05, 3.9665e+05, 7.9706e+05,
         0.0000e+00, 3.9667e+05],
        [1.2239e+00, 1.3428e+00, 1.4701e+00, 3.9469e+05, 4.0046e+05, 1.7339e+00,
         1.2618e+00, 3.9606e+05, 3.7992e+05, 1.3980e+00, 1.2492e+00, 3.9405e+05,
         3.9667e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1267e+00, 1.1693e+00, 1.1951e+00, 1.1991e+00, 1.2239e+00,
        1.2884e+00, 1.3613e+00, 3.7989e+05, 3.9406e+05, 3.9468e+05, 3.9607e+05,
        3.9664e+05, 4.0044e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0610e+00, 1.0848e+00, 1.1267e+00, 1.2529e+00, 1.2696e+00,
        1.2998e+00, 1.3428e+00, 3.7991e+05, 3.9407e+05, 3.9469e+05, 3.9605e+05,
        3.9663e+05, 4.0048e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0848e+00, 1.0908e+00, 1.0999e+00, 1.1951e+00, 1.2047e+00,
        1.2973e+00, 1.4701e+00, 3.7992e+05, 3.9404e+05, 3.9470e+05, 3.9604e+05,
        3.9665e+05, 4.0048e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394657.8125, 394663.4688, 394679.5938, 394685.8125,
        394688.0000, 394692.7500, 394704.0625, 394716.7500, 774902.5000,
        782623.8750, 792241.5000, 806450.0000, 807065.1875])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 400439.3750, 400448.6875, 400452.8438, 400459.3125,
        400472.4375, 400475.2500, 400482.9375, 400483.1250, 765585.8750,
        777365.3125, 788060.8750, 807065.1875, 809206.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0999e+00, 1.1808e+00, 1.2529e+00, 1.3613e+00, 1.4909e+00,
        1.6572e+00, 1.7339e+00, 3.7988e+05, 3.9407e+05, 3.9466e+05, 3.9604e+05,
        3.9662e+05, 4.0048e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2374e+00, 1.2618e+00, 1.2884e+00, 1.2973e+00, 1.2998e+00,
        1.3274e+00, 1.6572e+00, 3.7993e+05, 3.9407e+05, 3.9469e+05, 3.9605e+05,
        3.9666e+05, 4.0045e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396035.5312, 396039.7500, 396041.5625, 396044.6250,
        396051.1250, 396053.2500, 396061.4062, 396070.8125, 772401.9375,
        782623.8750, 804862.7500, 808442.0000, 809206.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 379879.0938, 379894.0000, 379907.0625, 379908.3750,
        379916.0625, 379920.0625, 379925.0625, 379931.3438, 753494.4375,
        765585.8750, 772401.9375, 780350.7500, 792241.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0610e+00, 1.0908e+00, 1.1693e+00, 1.1808e+00, 1.2493e+00,
        1.3274e+00, 1.3980e+00, 3.7993e+05, 3.9406e+05, 3.9466e+05, 3.9604e+05,
        3.9664e+05, 4.0047e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.1991e+00, 1.2047e+00, 1.2374e+00, 1.2492e+00, 1.2493e+00,
        1.2696e+00, 1.4909e+00, 3.7991e+05, 3.9405e+05, 3.9472e+05, 3.9604e+05,
        3.9665e+05, 4.0045e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394037.3438, 394049.2812, 394053.3438, 394055.8750,
        394059.7500, 394066.9375, 394067.3750, 394067.4062, 753494.4375,
        788060.8750, 797062.9375, 806450.0000, 808442.0000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 396624.2500, 396633.7500, 396638.6875, 396640.0312,
        396652.8125, 396653.2812, 396655.8750, 396667.8125, 774902.5000,
        777365.3125, 780350.7500, 797062.9375, 804862.7500])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.2239e+00, 1.2492e+00, 1.2618e+00, 1.3428e+00, 1.3980e+00,
        1.4701e+00, 1.7339e+00, 3.7992e+05, 3.9405e+05, 3.9469e+05, 3.9606e+05,
        3.9667e+05, 4.0046e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['85995.81', '85998.10', '85995.76', '436932.28', '441033.31', '85995.14', '86000.85', '437866.69', '421419.50', '85998.82', '85996.73', '433994.62', '438674.31', '85997.66']
estimated f for each client, fs: [6, 6, 6, 4, 4, 6, 6, 4, 4, 6, 6, 4, 4, 6]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 15, 4, 3, 14, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0092s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:14...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:14, End: 2025-07-22 15:30:14)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 19, 9, 20, 18, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.9405e+05, 1.0917e+00, 3.8524e+05, 3.9828e+05, 3.9187e+05,
         1.0402e+00, 3.9261e+05, 3.9965e+05, 1.0565e+00, 1.0558e+00, 4.0414e+05,
         1.1170e+00, 1.0343e+00],
        [3.9405e+05, 0.0000e+00, 3.9406e+05, 7.6824e+05, 8.1617e+05, 7.6780e+05,
         3.9408e+05, 7.9693e+05, 7.8960e+05, 3.9407e+05, 3.9406e+05, 7.8681e+05,
         3.9406e+05, 3.9408e+05],
        [1.0917e+00, 3.9406e+05, 0.0000e+00, 3.8524e+05, 3.9830e+05, 3.9188e+05,
         1.0770e+00, 3.9259e+05, 3.9963e+05, 1.2050e+00, 1.0663e+00, 4.0410e+05,
         1.0671e+00, 1.0955e+00],
        [3.8524e+05, 7.6824e+05, 3.8524e+05, 0.0000e+00, 7.8759e+05, 8.0695e+05,
         3.8523e+05, 7.5713e+05, 7.8035e+05, 3.8524e+05, 3.8525e+05, 7.8087e+05,
         3.8525e+05, 3.8525e+05],
        [3.9828e+05, 8.1617e+05, 3.9830e+05, 7.8759e+05, 0.0000e+00, 8.0589e+05,
         3.9829e+05, 8.0278e+05, 8.1761e+05, 3.9828e+05, 3.9828e+05, 8.0369e+05,
         3.9828e+05, 3.9829e+05],
        [3.9187e+05, 7.6780e+05, 3.9188e+05, 8.0695e+05, 8.0589e+05, 0.0000e+00,
         3.9185e+05, 7.8881e+05, 7.8228e+05, 3.9185e+05, 3.9188e+05, 7.9923e+05,
         3.9188e+05, 3.9188e+05],
        [1.0402e+00, 3.9408e+05, 1.0770e+00, 3.8523e+05, 3.9829e+05, 3.9185e+05,
         0.0000e+00, 3.9260e+05, 3.9965e+05, 1.1429e+00, 1.0427e+00, 4.0414e+05,
         1.1852e+00, 1.0535e+00],
        [3.9261e+05, 7.9693e+05, 3.9259e+05, 7.5713e+05, 8.0278e+05, 7.8881e+05,
         3.9260e+05, 0.0000e+00, 7.6304e+05, 3.9261e+05, 3.9259e+05, 8.1112e+05,
         3.9258e+05, 3.9261e+05],
        [3.9965e+05, 7.8960e+05, 3.9963e+05, 7.8035e+05, 8.1761e+05, 7.8228e+05,
         3.9965e+05, 7.6304e+05, 0.0000e+00, 3.9964e+05, 3.9966e+05, 8.1595e+05,
         3.9966e+05, 3.9964e+05],
        [1.0565e+00, 3.9407e+05, 1.2050e+00, 3.8524e+05, 3.9828e+05, 3.9185e+05,
         1.1429e+00, 3.9261e+05, 3.9964e+05, 0.0000e+00, 1.0112e+00, 4.0413e+05,
         1.3445e+00, 1.2799e+00],
        [1.0558e+00, 3.9406e+05, 1.0663e+00, 3.8525e+05, 3.9828e+05, 3.9188e+05,
         1.0427e+00, 3.9259e+05, 3.9966e+05, 1.0112e+00, 0.0000e+00, 4.0413e+05,
         1.2328e+00, 1.1189e+00],
        [4.0414e+05, 7.8681e+05, 4.0410e+05, 7.8087e+05, 8.0369e+05, 7.9923e+05,
         4.0414e+05, 8.1112e+05, 8.1595e+05, 4.0413e+05, 4.0413e+05, 0.0000e+00,
         4.0417e+05, 4.0415e+05],
        [1.1170e+00, 3.9406e+05, 1.0671e+00, 3.8525e+05, 3.9828e+05, 3.9188e+05,
         1.1852e+00, 3.9258e+05, 3.9966e+05, 1.3445e+00, 1.2328e+00, 4.0417e+05,
         0.0000e+00, 1.0840e+00],
        [1.0343e+00, 3.9408e+05, 1.0955e+00, 3.8525e+05, 3.9829e+05, 3.9188e+05,
         1.0535e+00, 3.9261e+05, 3.9964e+05, 1.2799e+00, 1.1189e+00, 4.0415e+05,
         1.0840e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0343e+00, 1.0402e+00, 1.0558e+00, 1.0565e+00, 1.0917e+00,
        1.1170e+00, 3.8524e+05, 3.9187e+05, 3.9261e+05, 3.9405e+05, 3.9828e+05,
        3.9965e+05, 4.0414e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 394050.0000, 394058.4062, 394062.5312, 394063.5938,
        394065.0625, 394077.8438, 394078.9688, 767802.9375, 768238.5000,
        786810.1875, 789604.6875, 796925.1875, 816171.0625])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0663e+00, 1.0671e+00, 1.0770e+00, 1.0917e+00, 1.0955e+00,
        1.2050e+00, 3.8524e+05, 3.9188e+05, 3.9259e+05, 3.9406e+05, 3.9830e+05,
        3.9963e+05, 4.0410e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 385233.3438, 385239.2188, 385241.6562, 385242.5938,
        385245.5312, 385246.1562, 385247.2188, 757132.7500, 768238.5000,
        780349.8125, 780867.5625, 787594.2500, 806951.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 398277.5938, 398278.5000, 398278.9688, 398282.1250,
        398285.5312, 398292.5000, 398295.1562, 787594.2500, 802782.0000,
        803688.7500, 805890.3750, 816171.0625, 817608.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 391850.1250, 391852.0625, 391872.2500, 391877.5625,
        391878.9062, 391881.7188, 391881.8125, 767802.9375, 782284.5000,
        788811.8750, 799228.2500, 805890.3750, 806951.8750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0402e+00, 1.0427e+00, 1.0535e+00, 1.0770e+00, 1.1429e+00,
        1.1852e+00, 3.8523e+05, 3.9185e+05, 3.9260e+05, 3.9408e+05, 3.9829e+05,
        3.9965e+05, 4.0414e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 392582.0625, 392586.2188, 392587.6250, 392599.0625,
        392606.4375, 392608.0938, 392614.6875, 757132.7500, 763038.9375,
        788811.8750, 796925.1875, 802782.0000, 811117.4375])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 399632.4688, 399637.5000, 399637.7500, 399647.1250,
        399648.0000, 399655.6875, 399659.2188, 763038.9375, 780349.8125,
        782284.5000, 789604.6875, 815945.3750, 817608.5000])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0112e+00, 1.0565e+00, 1.1429e+00, 1.2050e+00, 1.2799e+00,
        1.3445e+00, 3.8524e+05, 3.9185e+05, 3.9261e+05, 3.9407e+05, 3.9828e+05,
        3.9964e+05, 4.0413e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0112e+00, 1.0427e+00, 1.0558e+00, 1.0663e+00, 1.1189e+00,
        1.2328e+00, 3.8525e+05, 3.9188e+05, 3.9259e+05, 3.9406e+05, 3.9828e+05,
        3.9966e+05, 4.0413e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([     0.0000, 404095.8125, 404127.7812, 404131.5625, 404140.8125,
        404142.4375, 404145.2188, 404169.1562, 780867.5625, 786810.1875,
        799228.2500, 803688.7500, 811117.4375, 815945.3750])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0671e+00, 1.0840e+00, 1.1170e+00, 1.1852e+00, 1.2328e+00,
        1.3445e+00, 3.8525e+05, 3.9188e+05, 3.9258e+05, 3.9406e+05, 3.9828e+05,
        3.9966e+05, 4.0417e+05])
Index of maximum distance difference after half of values: 9
sorted_distances: tensor([0.0000e+00, 1.0343e+00, 1.0535e+00, 1.0840e+00, 1.0955e+00, 1.1189e+00,
        1.2799e+00, 3.8525e+05, 3.9188e+05, 3.9261e+05, 3.9408e+05, 3.9829e+05,
        3.9964e+05, 4.0415e+05])
Index of maximum distance difference after half of values: 9
adaptive_Krum scores:  ['129969.92', '477166.44', '129967.88', '469118.53', '486485.19', '477020.16', '129965.66', '474261.72', '482322.91', '129967.25', '129969.23', '488514.47', '129968.02', '129972.15']
estimated f for each client, fs: [7, 4, 7, 4, 5, 4, 7, 4, 4, 7, 7, 4, 7, 7]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 19, 9, 20, 18, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0088s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:14...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:14, End: 2025-07-22 15:30:14)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 1, 9, 18, 8, 15, 4, 3, 13, 11, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0466e+00, 1.1284e+00, 3.7472e+05, 1.2546e+00, 1.2237e+00,
         3.9865e+05, 1.1507e+00, 3.8535e+05, 1.1074e+00, 1.2873e+00, 4.1047e+05,
         1.1369e+00, 3.7424e+05, 1.2044e+00, 1.1064e+00],
        [1.0466e+00, 0.0000e+00, 9.9965e-01, 3.7477e+05, 1.1282e+00, 1.2160e+00,
         3.9866e+05, 1.0928e+00, 3.8536e+05, 1.0066e+00, 1.1864e+00, 4.1048e+05,
         9.8799e-01, 3.7421e+05, 1.2764e+00, 1.2050e+00],
        [1.1284e+00, 9.9965e-01, 0.0000e+00, 3.7476e+05, 9.1234e-01, 1.1974e+00,
         3.9864e+05, 1.1113e+00, 3.8534e+05, 1.0055e+00, 1.0709e+00, 4.1048e+05,
         9.5013e-01, 3.7423e+05, 1.3289e+00, 1.3151e+00],
        [3.7472e+05, 3.7477e+05, 3.7476e+05, 0.0000e+00, 3.7478e+05, 3.7473e+05,
         7.9843e+05, 3.7474e+05, 7.6222e+05, 3.7475e+05, 3.7479e+05, 7.7935e+05,
         3.7477e+05, 7.3996e+05, 3.7474e+05, 3.7477e+05],
        [1.2546e+00, 1.1282e+00, 9.1234e-01, 3.7478e+05, 0.0000e+00, 1.5351e+00,
         3.9864e+05, 1.3324e+00, 3.8534e+05, 1.0390e+00, 9.8963e-01, 4.1048e+05,
         8.0938e-01, 3.7419e+05, 1.6756e+00, 1.6202e+00],
        [1.2237e+00, 1.2160e+00, 1.1974e+00, 3.7473e+05, 1.5351e+00, 0.0000e+00,
         3.9865e+05, 1.2216e+00, 3.8534e+05, 1.2383e+00, 1.5326e+00, 4.1049e+05,
         1.3895e+00, 3.7423e+05, 1.1281e+00, 1.1855e+00],
        [3.9865e+05, 3.9866e+05, 3.9864e+05, 7.9843e+05, 3.9864e+05, 3.9865e+05,
         0.0000e+00, 3.9867e+05, 8.0159e+05, 3.9864e+05, 3.9866e+05, 7.8415e+05,
         3.9864e+05, 7.5311e+05, 3.9864e+05, 3.9867e+05],
        [1.1507e+00, 1.0928e+00, 1.1113e+00, 3.7474e+05, 1.3324e+00, 1.2216e+00,
         3.9867e+05, 0.0000e+00, 3.8540e+05, 1.1567e+00, 1.2874e+00, 4.1048e+05,
         1.1863e+00, 3.7422e+05, 1.1711e+00, 1.1876e+00],
        [3.8535e+05, 3.8536e+05, 3.8534e+05, 7.6222e+05, 3.8534e+05, 3.8534e+05,
         8.0159e+05, 3.8540e+05, 0.0000e+00, 3.8536e+05, 3.8534e+05, 8.0639e+05,
         3.8535e+05, 7.5990e+05, 3.8533e+05, 3.8535e+05],
        [1.1074e+00, 1.0066e+00, 1.0055e+00, 3.7475e+05, 1.0390e+00, 1.2383e+00,
         3.9864e+05, 1.1567e+00, 3.8536e+05, 0.0000e+00, 1.1695e+00, 4.1048e+05,
         9.7191e-01, 3.7423e+05, 1.2344e+00, 1.2265e+00],
        [1.2873e+00, 1.1864e+00, 1.0709e+00, 3.7479e+05, 9.8963e-01, 1.5326e+00,
         3.9866e+05, 1.2874e+00, 3.8534e+05, 1.1695e+00, 0.0000e+00, 4.1046e+05,
         1.0609e+00, 3.7421e+05, 1.6220e+00, 1.4520e+00],
        [4.1047e+05, 4.1048e+05, 4.1048e+05, 7.7935e+05, 4.1048e+05, 4.1049e+05,
         7.8415e+05, 4.1048e+05, 8.0639e+05, 4.1048e+05, 4.1046e+05, 0.0000e+00,
         4.1048e+05, 7.9836e+05, 4.1048e+05, 4.1046e+05],
        [1.1369e+00, 9.8799e-01, 9.5013e-01, 3.7477e+05, 8.0938e-01, 1.3895e+00,
         3.9864e+05, 1.1863e+00, 3.8535e+05, 9.7191e-01, 1.0609e+00, 4.1048e+05,
         0.0000e+00, 3.7419e+05, 1.5034e+00, 1.4222e+00],
        [3.7424e+05, 3.7421e+05, 3.7423e+05, 7.3996e+05, 3.7419e+05, 3.7423e+05,
         7.5311e+05, 3.7422e+05, 7.5990e+05, 3.7423e+05, 3.7421e+05, 7.9836e+05,
         3.7419e+05, 0.0000e+00, 3.7422e+05, 3.7423e+05],
        [1.2044e+00, 1.2764e+00, 1.3289e+00, 3.7474e+05, 1.6756e+00, 1.1281e+00,
         3.9864e+05, 1.1711e+00, 3.8533e+05, 1.2344e+00, 1.6220e+00, 4.1048e+05,
         1.5034e+00, 3.7422e+05, 0.0000e+00, 1.1121e+00],
        [1.1064e+00, 1.2050e+00, 1.3151e+00, 3.7477e+05, 1.6202e+00, 1.1855e+00,
         3.9867e+05, 1.1876e+00, 3.8535e+05, 1.2265e+00, 1.4520e+00, 4.1046e+05,
         1.4222e+00, 3.7423e+05, 1.1121e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0466e+00, 1.1064e+00, 1.1074e+00, 1.1284e+00, 1.1369e+00,
        1.1507e+00, 1.2044e+00, 1.2237e+00, 1.2546e+00, 1.2873e+00, 3.7424e+05,
        3.7472e+05, 3.8535e+05, 3.9865e+05, 4.1047e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8799e-01, 9.9965e-01, 1.0066e+00, 1.0466e+00, 1.0928e+00,
        1.1282e+00, 1.1864e+00, 1.2050e+00, 1.2160e+00, 1.2764e+00, 3.7421e+05,
        3.7477e+05, 3.8536e+05, 3.9866e+05, 4.1048e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1234e-01, 9.5013e-01, 9.9965e-01, 1.0055e+00, 1.0709e+00,
        1.1113e+00, 1.1284e+00, 1.1974e+00, 1.3151e+00, 1.3289e+00, 3.7423e+05,
        3.7476e+05, 3.8534e+05, 3.9864e+05, 4.1048e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374720.5312, 374731.1250, 374735.5000, 374736.1250,
        374754.7188, 374757.1875, 374767.1250, 374770.4688, 374770.7500,
        374777.6562, 374788.5312, 739955.5625, 762220.3125, 779345.3750,
        798433.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.0938e-01, 9.1234e-01, 9.8963e-01, 1.0390e+00, 1.1282e+00,
        1.2546e+00, 1.3324e+00, 1.5351e+00, 1.6202e+00, 1.6756e+00, 3.7419e+05,
        3.7478e+05, 3.8534e+05, 3.9864e+05, 4.1048e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1281e+00, 1.1855e+00, 1.1974e+00, 1.2160e+00, 1.2216e+00,
        1.2237e+00, 1.2383e+00, 1.3895e+00, 1.5326e+00, 1.5351e+00, 3.7423e+05,
        3.7473e+05, 3.8534e+05, 3.9865e+05, 4.1049e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398637.8750, 398639.0000, 398639.2500, 398640.2500,
        398644.1875, 398649.4062, 398652.7188, 398656.5625, 398659.5312,
        398667.5625, 398671.6875, 753109.2500, 784146.8750, 798433.7500,
        801594.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0928e+00, 1.1113e+00, 1.1507e+00, 1.1567e+00, 1.1711e+00,
        1.1863e+00, 1.1876e+00, 1.2216e+00, 1.2874e+00, 1.3324e+00, 3.7422e+05,
        3.7474e+05, 3.8540e+05, 3.9867e+05, 4.1048e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385333.7500, 385336.9375, 385339.5625, 385340.7500,
        385344.3750, 385346.0000, 385352.1250, 385352.1875, 385360.7812,
        385362.4688, 385395.3125, 759895.9375, 762220.3125, 801594.8750,
        806390.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.7191e-01, 1.0055e+00, 1.0066e+00, 1.0390e+00, 1.1074e+00,
        1.1567e+00, 1.1695e+00, 1.2265e+00, 1.2344e+00, 1.2383e+00, 3.7423e+05,
        3.7475e+05, 3.8536e+05, 3.9864e+05, 4.1048e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8963e-01, 1.0609e+00, 1.0709e+00, 1.1695e+00, 1.1864e+00,
        1.2873e+00, 1.2874e+00, 1.4520e+00, 1.5326e+00, 1.6220e+00, 3.7421e+05,
        3.7479e+05, 3.8534e+05, 3.9866e+05, 4.1046e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 410455.8750, 410462.1875, 410466.1562, 410477.5312,
        410479.6250, 410480.0000, 410480.5000, 410482.9375, 410484.4375,
        410484.7812, 410493.9375, 779345.3750, 784146.8750, 798358.0000,
        806390.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.0938e-01, 9.5013e-01, 9.7191e-01, 9.8799e-01, 1.0609e+00,
        1.1369e+00, 1.1863e+00, 1.3895e+00, 1.4222e+00, 1.5034e+00, 3.7419e+05,
        3.7477e+05, 3.8535e+05, 3.9864e+05, 4.1048e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374188.2188, 374189.9375, 374210.7812, 374213.1250,
        374218.1875, 374222.0000, 374226.9062, 374227.6250, 374230.0625,
        374231.2812, 374239.0938, 739955.5625, 753109.2500, 759895.9375,
        798358.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1121e+00, 1.1281e+00, 1.1711e+00, 1.2044e+00, 1.2344e+00,
        1.2764e+00, 1.3289e+00, 1.5034e+00, 1.6220e+00, 1.6756e+00, 3.7422e+05,
        3.7474e+05, 3.8533e+05, 3.9864e+05, 4.1048e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1064e+00, 1.1121e+00, 1.1855e+00, 1.1876e+00, 1.2050e+00,
        1.2265e+00, 1.3151e+00, 1.4222e+00, 1.4520e+00, 1.6202e+00, 3.7423e+05,
        3.7477e+05, 3.8535e+05, 3.9867e+05, 4.1046e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.16', '1.11', '1.10', '374755.41', '1.23', '1.29', '398650.78', '1.19', '385351.28', '1.12', '1.27', '410477.09', '1.14', '374217.97', '1.33', '1.28']
estimated f for each client, fs: [5, 5, 5, 3, 5, 5, 3, 5, 3, 5, 5, 3, 5, 3, 5, 5]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 1, 9, 18, 8, 15, 4, 3, 13, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0351s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:15...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:15, End: 2025-07-22 15:30:15)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 7, 17, 1, 9, 20, 15, 3, 13, 14, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 1.0415e+00, 3.9429e+05, 1.1543e+00, 1.1807e+00, 3.9052e+05,
         3.9204e+05, 1.1208e+00, 3.8998e+05, 3.8543e+05, 1.1106e+00, 3.9270e+05,
         1.2000e+00],
        [1.0415e+00, 0.0000e+00, 3.9430e+05, 1.0383e+00, 1.1382e+00, 3.9051e+05,
         3.9206e+05, 1.0845e+00, 3.9001e+05, 3.8545e+05, 1.1176e+00, 3.9270e+05,
         1.3009e+00],
        [3.9429e+05, 3.9430e+05, 0.0000e+00, 3.9431e+05, 3.9429e+05, 7.9157e+05,
         7.6902e+05, 3.9431e+05, 7.5427e+05, 7.9548e+05, 3.9430e+05, 7.9296e+05,
         3.9426e+05],
        [1.1543e+00, 1.0383e+00, 3.9431e+05, 0.0000e+00, 1.3492e+00, 3.9050e+05,
         3.9209e+05, 8.9111e-01, 3.8998e+05, 3.8543e+05, 1.0437e+00, 3.9270e+05,
         1.5105e+00],
        [1.1807e+00, 1.1382e+00, 3.9429e+05, 1.3492e+00, 0.0000e+00, 3.9050e+05,
         3.9208e+05, 1.2829e+00, 3.8999e+05, 3.8543e+05, 1.1182e+00, 3.9270e+05,
         1.1207e+00],
        [3.9052e+05, 3.9051e+05, 7.9157e+05, 3.9050e+05, 3.9050e+05, 0.0000e+00,
         7.7071e+05, 3.9050e+05, 7.8157e+05, 7.5598e+05, 3.9051e+05, 7.6710e+05,
         3.9050e+05],
        [3.9204e+05, 3.9206e+05, 7.6902e+05, 3.9209e+05, 3.9208e+05, 7.7071e+05,
         0.0000e+00, 3.9205e+05, 7.9636e+05, 8.0506e+05, 3.9209e+05, 7.9234e+05,
         3.9206e+05],
        [1.1208e+00, 1.0845e+00, 3.9431e+05, 8.9111e-01, 1.2829e+00, 3.9050e+05,
         3.9205e+05, 0.0000e+00, 3.8999e+05, 3.8545e+05, 1.0413e+00, 3.9265e+05,
         1.4168e+00],
        [3.8998e+05, 3.9001e+05, 7.5427e+05, 3.8998e+05, 3.8999e+05, 7.8157e+05,
         7.9636e+05, 3.8999e+05, 0.0000e+00, 7.6707e+05, 3.8999e+05, 7.6407e+05,
         3.8999e+05],
        [3.8543e+05, 3.8545e+05, 7.9548e+05, 3.8543e+05, 3.8543e+05, 7.5598e+05,
         8.0506e+05, 3.8545e+05, 7.6707e+05, 0.0000e+00, 3.8541e+05, 7.7125e+05,
         3.8544e+05],
        [1.1106e+00, 1.1176e+00, 3.9430e+05, 1.0437e+00, 1.1182e+00, 3.9051e+05,
         3.9209e+05, 1.0413e+00, 3.8999e+05, 3.8541e+05, 0.0000e+00, 3.9270e+05,
         1.2214e+00],
        [3.9270e+05, 3.9270e+05, 7.9296e+05, 3.9270e+05, 3.9270e+05, 7.6710e+05,
         7.9234e+05, 3.9265e+05, 7.6407e+05, 7.7125e+05, 3.9270e+05, 0.0000e+00,
         3.9272e+05],
        [1.2000e+00, 1.3009e+00, 3.9426e+05, 1.5105e+00, 1.1207e+00, 3.9050e+05,
         3.9206e+05, 1.4168e+00, 3.8999e+05, 3.8544e+05, 1.2214e+00, 3.9272e+05,
         0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0415e+00, 1.1106e+00, 1.1208e+00, 1.1543e+00, 1.1807e+00,
        1.2000e+00, 3.8543e+05, 3.8998e+05, 3.9052e+05, 3.9204e+05, 3.9270e+05,
        3.9429e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.0383e+00, 1.0415e+00, 1.0845e+00, 1.1176e+00, 1.1382e+00,
        1.3009e+00, 3.8545e+05, 3.9001e+05, 3.9051e+05, 3.9206e+05, 3.9270e+05,
        3.9430e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 394262.8750, 394290.9375, 394292.1875, 394297.8125,
        394298.5938, 394305.4688, 394314.0312, 754271.7500, 769023.7500,
        791571.2500, 792962.8750, 795479.3750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 8.9111e-01, 1.0383e+00, 1.0437e+00, 1.1543e+00, 1.3492e+00,
        1.5105e+00, 3.8543e+05, 3.8998e+05, 3.9050e+05, 3.9209e+05, 3.9270e+05,
        3.9431e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1182e+00, 1.1207e+00, 1.1382e+00, 1.1807e+00, 1.2829e+00,
        1.3492e+00, 3.8543e+05, 3.8999e+05, 3.9050e+05, 3.9208e+05, 3.9270e+05,
        3.9429e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 390495.0312, 390499.5000, 390500.8438, 390501.6562,
        390507.7188, 390508.1562, 390515.6562, 755975.1250, 767100.8125,
        770705.9375, 781568.1250, 791571.2500])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 392038.2812, 392052.0312, 392060.8438, 392062.0312,
        392083.8125, 392086.4375, 392087.3750, 769023.7500, 770705.9375,
        792340.5625, 796360.3750, 805061.8125])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 8.9111e-01, 1.0413e+00, 1.0845e+00, 1.1208e+00, 1.2829e+00,
        1.4168e+00, 3.8545e+05, 3.8999e+05, 3.9050e+05, 3.9205e+05, 3.9265e+05,
        3.9431e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 389978.9062, 389983.0312, 389985.7812, 389987.1875,
        389988.4062, 389990.9062, 390005.0938, 754271.7500, 764070.2500,
        767074.1250, 781568.1250, 796360.3750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 385413.3125, 385426.0625, 385428.7812, 385434.9688,
        385443.6562, 385446.6562, 385448.7500, 755975.1250, 767074.1250,
        771249.3125, 795479.3750, 805061.8125])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.0413e+00, 1.0437e+00, 1.1106e+00, 1.1176e+00, 1.1182e+00,
        1.2214e+00, 3.8541e+05, 3.8999e+05, 3.9051e+05, 3.9209e+05, 3.9270e+05,
        3.9430e+05])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([     0.0000, 392654.5938, 392696.0938, 392699.2812, 392700.7188,
        392701.7812, 392704.7500, 392717.1250, 764070.2500, 767100.8125,
        771249.3125, 792340.5625, 792962.8750])
Index of maximum distance difference after half of values: 8
sorted_distances: tensor([0.0000e+00, 1.1207e+00, 1.2000e+00, 1.2214e+00, 1.3009e+00, 1.4168e+00,
        1.5105e+00, 3.8544e+05, 3.8999e+05, 3.9050e+05, 3.9206e+05, 3.9272e+05,
        3.9426e+05])
Index of maximum distance difference after half of values: 8
adaptive_Krum scores:  ['96927.32', '96932.57', '439291.72', '96927.61', '96927.70', '436187.97', '439186.81', '96930.55', '435523.84', '431752.19', '96925.90', '439118.09', '96929.66']
estimated f for each client, fs: [6, 6, 4, 6, 6, 4, 4, 6, 4, 4, 6, 4, 6]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 7, 17, 1, 9, 20, 15, 3, 13, 14, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0090s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:15...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[164  73]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:15, End: 2025-07-22 15:30:15)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 17, 9, 20, 18, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0601e+00, 1.1870e+00, 4.0294e+05, 3.9679e+05, 1.1662e+00,
         3.8277e+05, 3.8261e+05, 1.1109e+00, 1.1257e+00, 3.8947e+05, 3.9838e+05,
         1.4234e+00, 3.9759e+05, 1.1514e+00, 1.1024e+00],
        [1.0601e+00, 0.0000e+00, 1.0592e+00, 4.0294e+05, 3.9675e+05, 1.1585e+00,
         3.8275e+05, 3.8261e+05, 1.0045e+00, 1.0862e+00, 3.8946e+05, 3.9837e+05,
         1.3375e+00, 3.9759e+05, 1.2521e+00, 1.1985e+00],
        [1.1870e+00, 1.0592e+00, 0.0000e+00, 4.0292e+05, 3.9678e+05, 1.2843e+00,
         3.8274e+05, 3.8262e+05, 1.0150e+00, 9.0085e-01, 3.8949e+05, 3.9837e+05,
         8.9338e-01, 3.9760e+05, 1.4179e+00, 1.4197e+00],
        [4.0294e+05, 4.0294e+05, 4.0292e+05, 0.0000e+00, 7.9503e+05, 4.0290e+05,
         7.7108e+05, 7.8590e+05, 4.0291e+05, 4.0294e+05, 8.2118e+05, 8.0069e+05,
         4.0293e+05, 8.0768e+05, 4.0292e+05, 4.0296e+05],
        [3.9679e+05, 3.9675e+05, 3.9678e+05, 7.9503e+05, 0.0000e+00, 3.9678e+05,
         8.0096e+05, 7.9387e+05, 3.9678e+05, 3.9676e+05, 7.8638e+05, 7.8660e+05,
         3.9675e+05, 8.0470e+05, 3.9679e+05, 3.9678e+05],
        [1.1662e+00, 1.1585e+00, 1.2843e+00, 4.0290e+05, 3.9678e+05, 0.0000e+00,
         3.8275e+05, 3.8263e+05, 1.1582e+00, 1.2406e+00, 3.8946e+05, 3.9835e+05,
         1.5271e+00, 3.9759e+05, 1.0865e+00, 1.1989e+00],
        [3.8277e+05, 3.8275e+05, 3.8274e+05, 7.7108e+05, 8.0096e+05, 3.8275e+05,
         0.0000e+00, 7.6319e+05, 3.8275e+05, 3.8276e+05, 7.6255e+05, 7.6906e+05,
         3.8276e+05, 7.8477e+05, 3.8275e+05, 3.8274e+05],
        [3.8261e+05, 3.8261e+05, 3.8262e+05, 7.8590e+05, 7.9387e+05, 3.8263e+05,
         7.6319e+05, 0.0000e+00, 3.8259e+05, 3.8262e+05, 7.7262e+05, 7.8833e+05,
         3.8264e+05, 7.7387e+05, 3.8261e+05, 3.8257e+05],
        [1.1109e+00, 1.0045e+00, 1.0150e+00, 4.0291e+05, 3.9678e+05, 1.1582e+00,
         3.8275e+05, 3.8259e+05, 0.0000e+00, 1.0546e+00, 3.8947e+05, 3.9837e+05,
         1.2288e+00, 3.9758e+05, 1.1787e+00, 1.2238e+00],
        [1.1257e+00, 1.0862e+00, 9.0085e-01, 4.0294e+05, 3.9676e+05, 1.2406e+00,
         3.8276e+05, 3.8262e+05, 1.0546e+00, 0.0000e+00, 3.8948e+05, 3.9838e+05,
         1.0883e+00, 3.9759e+05, 1.3627e+00, 1.2472e+00],
        [3.8947e+05, 3.8946e+05, 3.8949e+05, 8.2118e+05, 7.8638e+05, 3.8946e+05,
         7.6255e+05, 7.7262e+05, 3.8947e+05, 3.8948e+05, 0.0000e+00, 7.7871e+05,
         3.8947e+05, 7.8592e+05, 3.8947e+05, 3.8944e+05],
        [3.9838e+05, 3.9837e+05, 3.9837e+05, 8.0069e+05, 7.8660e+05, 3.9835e+05,
         7.6906e+05, 7.8833e+05, 3.9837e+05, 3.9838e+05, 7.7871e+05, 0.0000e+00,
         3.9837e+05, 7.9421e+05, 3.9839e+05, 3.9837e+05],
        [1.4234e+00, 1.3375e+00, 8.9338e-01, 4.0293e+05, 3.9675e+05, 1.5271e+00,
         3.8276e+05, 3.8264e+05, 1.2288e+00, 1.0883e+00, 3.8947e+05, 3.9837e+05,
         0.0000e+00, 3.9760e+05, 1.6702e+00, 1.6187e+00],
        [3.9759e+05, 3.9759e+05, 3.9760e+05, 8.0768e+05, 8.0470e+05, 3.9759e+05,
         7.8477e+05, 7.7387e+05, 3.9758e+05, 3.9759e+05, 7.8592e+05, 7.9421e+05,
         3.9760e+05, 0.0000e+00, 3.9761e+05, 3.9757e+05],
        [1.1514e+00, 1.2521e+00, 1.4179e+00, 4.0292e+05, 3.9679e+05, 1.0865e+00,
         3.8275e+05, 3.8261e+05, 1.1787e+00, 1.3627e+00, 3.8947e+05, 3.9839e+05,
         1.6702e+00, 3.9761e+05, 0.0000e+00, 1.0896e+00],
        [1.1024e+00, 1.1985e+00, 1.4197e+00, 4.0296e+05, 3.9678e+05, 1.1989e+00,
         3.8274e+05, 3.8257e+05, 1.2238e+00, 1.2472e+00, 3.8944e+05, 3.9837e+05,
         1.6187e+00, 3.9757e+05, 1.0896e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0601e+00, 1.1024e+00, 1.1109e+00, 1.1257e+00, 1.1514e+00,
        1.1662e+00, 1.1870e+00, 1.4234e+00, 3.8261e+05, 3.8277e+05, 3.8947e+05,
        3.9679e+05, 3.9759e+05, 3.9838e+05, 4.0294e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0045e+00, 1.0592e+00, 1.0601e+00, 1.0862e+00, 1.1585e+00,
        1.1985e+00, 1.2521e+00, 1.3375e+00, 3.8261e+05, 3.8275e+05, 3.8946e+05,
        3.9675e+05, 3.9759e+05, 3.9837e+05, 4.0294e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9338e-01, 9.0085e-01, 1.0150e+00, 1.0592e+00, 1.1870e+00,
        1.2843e+00, 1.4179e+00, 1.4197e+00, 3.8262e+05, 3.8274e+05, 3.8949e+05,
        3.9678e+05, 3.9760e+05, 3.9837e+05, 4.0292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402898.2500, 402908.2500, 402920.4062, 402923.2812,
        402932.0312, 402942.6250, 402943.3438, 402944.2500, 402961.9062,
        771079.1875, 785900.6875, 795028.1250, 800690.3750, 807681.4375,
        821181.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396746.4062, 396747.9375, 396757.7500, 396777.9375,
        396779.7188, 396781.4062, 396784.5625, 396788.7188, 396793.0938,
        786379.8750, 786600.2500, 793870.6250, 795028.1250, 800956.1250,
        804703.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0865e+00, 1.1582e+00, 1.1585e+00, 1.1662e+00, 1.1989e+00,
        1.2406e+00, 1.2843e+00, 1.5271e+00, 3.8263e+05, 3.8275e+05, 3.8946e+05,
        3.9678e+05, 3.9759e+05, 3.9835e+05, 4.0290e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382735.7500, 382742.1562, 382745.5312, 382746.1250,
        382750.8750, 382753.5000, 382758.2500, 382759.8750, 382770.5625,
        762553.4375, 763186.0000, 769055.6250, 771079.1875, 784772.3125,
        800956.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382568.5625, 382588.2500, 382606.3750, 382611.7812,
        382612.6875, 382615.9375, 382624.8750, 382628.3438, 382639.1250,
        763186.0000, 772615.5000, 773870.5000, 785900.6875, 788332.3750,
        793870.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0045e+00, 1.0150e+00, 1.0546e+00, 1.1109e+00, 1.1582e+00,
        1.1787e+00, 1.2238e+00, 1.2288e+00, 3.8259e+05, 3.8275e+05, 3.8947e+05,
        3.9678e+05, 3.9758e+05, 3.9837e+05, 4.0291e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.0085e-01, 1.0546e+00, 1.0862e+00, 1.0883e+00, 1.1257e+00,
        1.2406e+00, 1.2472e+00, 1.3627e+00, 3.8262e+05, 3.8276e+05, 3.8948e+05,
        3.9676e+05, 3.9759e+05, 3.9838e+05, 4.0294e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389439.0312, 389455.4688, 389456.7500, 389466.4375,
        389471.8750, 389472.3750, 389474.8438, 389482.7188, 389493.7500,
        762553.4375, 772615.5000, 778710.3125, 785924.0625, 786379.8750,
        821181.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398352.8750, 398368.3750, 398369.5938, 398370.5938,
        398370.7812, 398372.4375, 398381.1250, 398382.4688, 398392.5938,
        769055.6250, 778710.3125, 786600.2500, 788332.3750, 794213.7500,
        800690.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9338e-01, 1.0883e+00, 1.2288e+00, 1.3375e+00, 1.4234e+00,
        1.5271e+00, 1.6187e+00, 1.6702e+00, 3.8264e+05, 3.8276e+05, 3.8947e+05,
        3.9675e+05, 3.9760e+05, 3.9837e+05, 4.0293e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397565.2500, 397579.4375, 397585.3438, 397585.7500,
        397586.7812, 397589.1250, 397602.8438, 397604.2500, 397607.7188,
        773870.5000, 784772.3125, 785924.0625, 794213.7500, 804703.9375,
        807681.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0865e+00, 1.0896e+00, 1.1514e+00, 1.1787e+00, 1.2521e+00,
        1.3627e+00, 1.4179e+00, 1.6702e+00, 3.8261e+05, 3.8275e+05, 3.8947e+05,
        3.9679e+05, 3.9761e+05, 3.9839e+05, 4.0292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0896e+00, 1.1024e+00, 1.1985e+00, 1.1989e+00, 1.2238e+00,
        1.2472e+00, 1.4197e+00, 1.6187e+00, 3.8257e+05, 3.8274e+05, 3.8944e+05,
        3.9678e+05, 3.9757e+05, 3.9837e+05, 4.0296e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76539.27', '76536.16', '76536.98', '439745.34', '435733.75', '76538.91', '420731.59', '420668.25', '76535.08', '76538.33', '426776.69', '435441.66', '76540.98', '435217.69', '76536.75', '76532.09']
estimated f for each client, fs: [7, 7, 7, 5, 5, 7, 5, 5, 7, 7, 5, 5, 7, 5, 7, 7]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 19, 17, 9, 20, 18, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0106s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:16...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[187  50]
 [ 78 185]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:16, End: 2025-07-22 15:30:16)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.2019e+00, 3.8203e+05, 3.9327e+05, 1.1580e+00, 1.2854e+00,
         4.1568e+05, 4.0209e+05, 1.1951e+00, 4.0195e+05, 1.1320e+00, 1.1815e+00,
         4.0880e+05, 3.8300e+05, 1.2624e+00, 3.8296e+05, 1.3735e+00, 1.2693e+00],
        [1.2019e+00, 0.0000e+00, 3.8202e+05, 3.9329e+05, 8.1068e-01, 1.5104e+00,
         4.1569e+05, 4.0212e+05, 1.3218e+00, 4.0197e+05, 1.1562e+00, 1.0479e+00,
         4.0879e+05, 3.8301e+05, 9.2112e-01, 3.8296e+05, 1.6536e+00, 1.2777e+00],
        [3.8203e+05, 3.8202e+05, 0.0000e+00, 7.9560e+05, 3.8202e+05, 3.8208e+05,
         7.9616e+05, 7.9471e+05, 3.8206e+05, 7.7856e+05, 3.8203e+05, 3.8201e+05,
         8.0112e+05, 7.3993e+05, 3.8204e+05, 7.9214e+05, 3.8206e+05, 3.8203e+05],
        [3.9327e+05, 3.9329e+05, 7.9560e+05, 0.0000e+00, 3.9329e+05, 3.9329e+05,
         8.1564e+05, 7.6343e+05, 3.9329e+05, 8.0505e+05, 3.9327e+05, 3.9326e+05,
         8.0230e+05, 7.5381e+05, 3.9327e+05, 7.7387e+05, 3.9330e+05, 3.9330e+05],
        [1.1580e+00, 8.1068e-01, 3.8202e+05, 3.9329e+05, 0.0000e+00, 1.4933e+00,
         4.1569e+05, 4.0212e+05, 1.2814e+00, 4.0197e+05, 1.1046e+00, 1.0289e+00,
         4.0881e+05, 3.8299e+05, 8.2762e-01, 3.8297e+05, 1.6144e+00, 1.1425e+00],
        [1.2854e+00, 1.5104e+00, 3.8208e+05, 3.9329e+05, 1.4933e+00, 0.0000e+00,
         4.1572e+05, 4.0212e+05, 1.3302e+00, 4.0196e+05, 1.2573e+00, 1.3605e+00,
         4.0882e+05, 3.8300e+05, 1.4628e+00, 3.8296e+05, 1.2430e+00, 1.4588e+00],
        [4.1568e+05, 4.1569e+05, 7.9616e+05, 8.1564e+05, 4.1569e+05, 4.1572e+05,
         0.0000e+00, 8.2514e+05, 4.1570e+05, 8.1664e+05, 4.1571e+05, 4.1567e+05,
         8.3015e+05, 7.9222e+05, 4.1569e+05, 7.6381e+05, 4.1570e+05, 4.1570e+05],
        [4.0209e+05, 4.0212e+05, 7.9471e+05, 7.6343e+05, 4.0212e+05, 4.0212e+05,
         8.2514e+05, 0.0000e+00, 4.0210e+05, 7.8740e+05, 4.0210e+05, 4.0214e+05,
         8.0533e+05, 7.7502e+05, 4.0214e+05, 7.8541e+05, 4.0211e+05, 4.0210e+05],
        [1.1951e+00, 1.3218e+00, 3.8206e+05, 3.9329e+05, 1.2814e+00, 1.3302e+00,
         4.1570e+05, 4.0210e+05, 0.0000e+00, 4.0197e+05, 1.2205e+00, 1.2337e+00,
         4.0882e+05, 3.8300e+05, 1.3102e+00, 3.8297e+05, 1.3538e+00, 1.3245e+00],
        [4.0195e+05, 4.0197e+05, 7.7856e+05, 8.0505e+05, 4.0197e+05, 4.0196e+05,
         8.1664e+05, 7.8740e+05, 4.0197e+05, 0.0000e+00, 4.0196e+05, 4.0197e+05,
         7.9621e+05, 7.9823e+05, 4.0199e+05, 8.0198e+05, 4.0198e+05, 4.0196e+05],
        [1.1320e+00, 1.1562e+00, 3.8203e+05, 3.9327e+05, 1.1046e+00, 1.2573e+00,
         4.1571e+05, 4.0210e+05, 1.2205e+00, 4.0196e+05, 0.0000e+00, 1.1200e+00,
         4.0884e+05, 3.8301e+05, 1.1724e+00, 3.8297e+05, 1.3034e+00, 1.2354e+00],
        [1.1815e+00, 1.0479e+00, 3.8201e+05, 3.9326e+05, 1.0289e+00, 1.3605e+00,
         4.1567e+05, 4.0214e+05, 1.2337e+00, 4.0197e+05, 1.1200e+00, 0.0000e+00,
         4.0883e+05, 3.8301e+05, 1.0813e+00, 3.8295e+05, 1.4994e+00, 1.1990e+00],
        [4.0880e+05, 4.0879e+05, 8.0112e+05, 8.0230e+05, 4.0881e+05, 4.0882e+05,
         8.3015e+05, 8.0533e+05, 4.0882e+05, 7.9621e+05, 4.0884e+05, 4.0883e+05,
         0.0000e+00, 7.8714e+05, 4.0882e+05, 8.2066e+05, 4.0878e+05, 4.0882e+05],
        [3.8300e+05, 3.8301e+05, 7.3993e+05, 7.5381e+05, 3.8299e+05, 3.8300e+05,
         7.9222e+05, 7.7502e+05, 3.8300e+05, 7.9823e+05, 3.8301e+05, 3.8301e+05,
         7.8714e+05, 0.0000e+00, 3.8299e+05, 7.8170e+05, 3.8300e+05, 3.8296e+05],
        [1.2624e+00, 9.2112e-01, 3.8204e+05, 3.9327e+05, 8.2762e-01, 1.4628e+00,
         4.1569e+05, 4.0214e+05, 1.3102e+00, 4.0199e+05, 1.1724e+00, 1.0813e+00,
         4.0882e+05, 3.8299e+05, 0.0000e+00, 3.8296e+05, 1.7034e+00, 1.2346e+00],
        [3.8296e+05, 3.8296e+05, 7.9214e+05, 7.7387e+05, 3.8297e+05, 3.8296e+05,
         7.6381e+05, 7.8541e+05, 3.8297e+05, 8.0198e+05, 3.8297e+05, 3.8295e+05,
         8.2066e+05, 7.8170e+05, 3.8296e+05, 0.0000e+00, 3.8295e+05, 3.8297e+05],
        [1.3735e+00, 1.6536e+00, 3.8206e+05, 3.9330e+05, 1.6144e+00, 1.2430e+00,
         4.1570e+05, 4.0211e+05, 1.3538e+00, 4.0198e+05, 1.3034e+00, 1.4994e+00,
         4.0878e+05, 3.8300e+05, 1.7034e+00, 3.8295e+05, 0.0000e+00, 1.5210e+00],
        [1.2693e+00, 1.2777e+00, 3.8203e+05, 3.9330e+05, 1.1425e+00, 1.4588e+00,
         4.1570e+05, 4.0210e+05, 1.3245e+00, 4.0196e+05, 1.2354e+00, 1.1990e+00,
         4.0882e+05, 3.8296e+05, 1.2346e+00, 3.8297e+05, 1.5210e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1320e+00, 1.1580e+00, 1.1815e+00, 1.1951e+00, 1.2019e+00,
        1.2624e+00, 1.2693e+00, 1.2854e+00, 1.3735e+00, 3.8203e+05, 3.8296e+05,
        3.8300e+05, 3.9327e+05, 4.0195e+05, 4.0209e+05, 4.0880e+05, 4.1568e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.1068e-01, 9.2112e-01, 1.0479e+00, 1.1562e+00, 1.2019e+00,
        1.2777e+00, 1.3218e+00, 1.5104e+00, 1.6536e+00, 3.8202e+05, 3.8296e+05,
        3.8301e+05, 3.9329e+05, 4.0197e+05, 4.0212e+05, 4.0879e+05, 4.1569e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382007.5312, 382017.1875, 382018.1250, 382026.1875,
        382026.3438, 382033.3750, 382043.0625, 382057.9062, 382059.4688,
        382076.5000, 739927.5000, 778558.2500, 792137.8750, 794713.7500,
        795598.3125, 796159.8750, 801117.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393260.6250, 393268.5938, 393272.0625, 393273.4062,
        393285.8750, 393289.4688, 393290.5938, 393293.8750, 393297.9375,
        393302.8750, 753808.4375, 763432.6875, 773870.1250, 795598.3125,
        802302.7500, 805049.1250, 815638.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.1068e-01, 8.2762e-01, 1.0289e+00, 1.1046e+00, 1.1425e+00,
        1.1580e+00, 1.2814e+00, 1.4933e+00, 1.6144e+00, 3.8202e+05, 3.8297e+05,
        3.8299e+05, 3.9329e+05, 4.0197e+05, 4.0212e+05, 4.0881e+05, 4.1569e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2430e+00, 1.2573e+00, 1.2854e+00, 1.3302e+00, 1.3605e+00,
        1.4588e+00, 1.4628e+00, 1.4933e+00, 1.5104e+00, 3.8208e+05, 3.8296e+05,
        3.8300e+05, 3.9329e+05, 4.0196e+05, 4.0212e+05, 4.0882e+05, 4.1572e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 415672.9688, 415683.8438, 415688.0000, 415688.8438,
        415689.8750, 415697.1250, 415698.7188, 415702.9688, 415710.0000,
        415723.6562, 763808.3125, 792219.5000, 796159.8750, 815638.0000,
        816638.1250, 825136.1250, 830150.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 402086.4062, 402098.6875, 402100.3438, 402103.3438,
        402111.6875, 402119.8438, 402120.7812, 402121.2188, 402136.6562,
        402143.1875, 763432.6875, 775017.8125, 785406.9375, 787399.5000,
        794713.7500, 805331.3125, 825136.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1951e+00, 1.2205e+00, 1.2337e+00, 1.2814e+00, 1.3102e+00,
        1.3218e+00, 1.3245e+00, 1.3302e+00, 1.3538e+00, 3.8206e+05, 3.8297e+05,
        3.8300e+05, 3.9329e+05, 4.0197e+05, 4.0210e+05, 4.0882e+05, 4.1570e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 401949.1562, 401956.5000, 401960.3750, 401963.6875,
        401969.3125, 401972.2500, 401973.8125, 401974.4375, 401980.8438,
        401990.1875, 778558.2500, 787399.5000, 796206.3750, 798226.8750,
        801982.3125, 805049.1250, 816638.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1046e+00, 1.1200e+00, 1.1320e+00, 1.1562e+00, 1.1724e+00,
        1.2205e+00, 1.2354e+00, 1.2573e+00, 1.3034e+00, 3.8203e+05, 3.8297e+05,
        3.8301e+05, 3.9327e+05, 4.0196e+05, 4.0210e+05, 4.0884e+05, 4.1571e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0289e+00, 1.0479e+00, 1.0813e+00, 1.1200e+00, 1.1815e+00,
        1.1990e+00, 1.2337e+00, 1.3605e+00, 1.4994e+00, 3.8201e+05, 3.8295e+05,
        3.8301e+05, 3.9326e+05, 4.0197e+05, 4.0214e+05, 4.0883e+05, 4.1567e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 408784.3125, 408789.7188, 408804.8750, 408807.9062,
        408815.0938, 408819.8438, 408821.5312, 408823.5938, 408826.4375,
        408840.2188, 787139.8750, 796206.3750, 801117.8750, 802302.7500,
        805331.3125, 820658.9375, 830150.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382958.3750, 382987.8438, 382991.2500, 382995.5938,
        382998.2500, 383000.5312, 383004.9688, 383005.7188, 383005.8750,
        383013.3125, 739927.5000, 753808.4375, 775017.8125, 781702.8125,
        787139.8750, 792219.5000, 798226.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.2762e-01, 9.2112e-01, 1.0813e+00, 1.1724e+00, 1.2346e+00,
        1.2624e+00, 1.3102e+00, 1.4628e+00, 1.7034e+00, 3.8204e+05, 3.8296e+05,
        3.8299e+05, 3.9327e+05, 4.0199e+05, 4.0214e+05, 4.0882e+05, 4.1569e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382948.5000, 382954.1562, 382955.9375, 382960.9375,
        382962.5312, 382963.9375, 382965.1875, 382971.8125, 382971.9688,
        382974.0625, 763808.3125, 773870.1250, 781702.8125, 785406.9375,
        792137.8750, 801982.3125, 820658.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2430e+00, 1.3034e+00, 1.3538e+00, 1.3735e+00, 1.4994e+00,
        1.5210e+00, 1.6144e+00, 1.6536e+00, 1.7034e+00, 3.8206e+05, 3.8295e+05,
        3.8300e+05, 3.9330e+05, 4.0198e+05, 4.0211e+05, 4.0878e+05, 4.1570e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1425e+00, 1.1990e+00, 1.2346e+00, 1.2354e+00, 1.2693e+00,
        1.2777e+00, 1.3245e+00, 1.4588e+00, 1.5210e+00, 3.8203e+05, 3.8296e+05,
        3.8297e+05, 3.9330e+05, 4.0196e+05, 4.0210e+05, 4.0882e+05, 4.1570e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['69546.21', '69544.45', '414572.06', '426058.53', '69544.88', '69550.12', '447342.19', '434961.38', '69549.55', '436204.41', '69546.26', '69542.43', '443206.69', '415444.47', '69546.36', '417585.22', '69547.77', '69545.12']
estimated f for each client, fs: [8, 8, 6, 6, 8, 8, 6, 6, 8, 6, 8, 8, 6, 6, 8, 6, 8, 8]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0163s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:17...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:17, End: 2025-07-22 15:30:17)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.0558e+00, 1.2435e+00, 3.9139e+05, 3.7962e+05, 1.1926e+00,
         1.2278e+00, 3.9425e+05, 3.8736e+05, 1.1800e+00, 3.8370e+05, 1.1435e+00,
         1.5103e+00, 4.1214e+05, 1.1745e+00, 1.2380e+00, 3.9917e+05, 1.2686e+00],
        [1.0558e+00, 0.0000e+00, 1.0616e+00, 3.9140e+05, 3.7966e+05, 1.0702e+00,
         1.1917e+00, 3.9425e+05, 3.8737e+05, 1.0826e+00, 3.8373e+05, 1.0478e+00,
         1.3555e+00, 4.1214e+05, 1.0373e+00, 1.1417e+00, 3.9917e+05, 1.2796e+00],
        [1.2435e+00, 1.0616e+00, 0.0000e+00, 3.9140e+05, 3.7968e+05, 7.5256e-01,
         1.3315e+00, 3.9426e+05, 3.8738e+05, 1.1827e+00, 3.8375e+05, 1.0611e+00,
         9.6890e-01, 4.1215e+05, 9.2447e-01, 8.2190e-01, 3.9916e+05, 1.4735e+00],
        [3.9139e+05, 3.9140e+05, 3.9140e+05, 0.0000e+00, 7.8537e+05, 3.9141e+05,
         3.9140e+05, 7.5745e+05, 7.7683e+05, 3.9138e+05, 7.8821e+05, 3.9138e+05,
         3.9142e+05, 7.9875e+05, 3.9140e+05, 3.9142e+05, 8.1792e+05, 3.9139e+05],
        [3.7962e+05, 3.7966e+05, 3.7968e+05, 7.8537e+05, 0.0000e+00, 3.7967e+05,
         3.7966e+05, 7.7650e+05, 7.5495e+05, 3.7966e+05, 7.5700e+05, 3.7967e+05,
         3.7970e+05, 7.8549e+05, 3.7967e+05, 3.7966e+05, 7.9592e+05, 3.7966e+05],
        [1.1926e+00, 1.0702e+00, 7.5256e-01, 3.9141e+05, 3.7967e+05, 0.0000e+00,
         1.3263e+00, 3.9425e+05, 3.8740e+05, 1.1897e+00, 3.8372e+05, 1.0170e+00,
         9.3299e-01, 4.1214e+05, 8.2017e-01, 7.8317e-01, 3.9917e+05, 1.4580e+00],
        [1.2278e+00, 1.1917e+00, 1.3315e+00, 3.9140e+05, 3.7966e+05, 1.3263e+00,
         0.0000e+00, 3.9426e+05, 3.8739e+05, 1.2181e+00, 3.8373e+05, 1.1907e+00,
         1.7555e+00, 4.1215e+05, 1.3508e+00, 1.3249e+00, 3.9918e+05, 1.1563e+00],
        [3.9425e+05, 3.9425e+05, 3.9426e+05, 7.5745e+05, 7.7650e+05, 3.9425e+05,
         3.9426e+05, 0.0000e+00, 7.9381e+05, 3.9423e+05, 7.7305e+05, 3.9424e+05,
         3.9427e+05, 8.0794e+05, 3.9426e+05, 3.9423e+05, 7.8960e+05, 3.9424e+05],
        [3.8736e+05, 3.8737e+05, 3.8738e+05, 7.7683e+05, 7.5495e+05, 3.8740e+05,
         3.8739e+05, 7.9381e+05, 0.0000e+00, 3.8740e+05, 7.6114e+05, 3.8741e+05,
         3.8740e+05, 7.9683e+05, 3.8739e+05, 3.8738e+05, 7.8564e+05, 3.8739e+05],
        [1.1800e+00, 1.0826e+00, 1.1827e+00, 3.9138e+05, 3.7966e+05, 1.1897e+00,
         1.2181e+00, 3.9423e+05, 3.8740e+05, 0.0000e+00, 3.8372e+05, 1.1324e+00,
         1.4633e+00, 4.1211e+05, 1.1892e+00, 1.2009e+00, 3.9918e+05, 1.1952e+00],
        [3.8370e+05, 3.8373e+05, 3.8375e+05, 7.8821e+05, 7.5700e+05, 3.8372e+05,
         3.8373e+05, 7.7305e+05, 7.6114e+05, 3.8372e+05, 0.0000e+00, 3.8372e+05,
         3.8376e+05, 7.6760e+05, 3.8374e+05, 3.8375e+05, 7.8759e+05, 3.8370e+05],
        [1.1435e+00, 1.0478e+00, 1.0611e+00, 3.9138e+05, 3.7967e+05, 1.0170e+00,
         1.1907e+00, 3.9424e+05, 3.8741e+05, 1.1324e+00, 3.8372e+05, 0.0000e+00,
         1.3036e+00, 4.1215e+05, 1.0108e+00, 1.1083e+00, 3.9918e+05, 1.2176e+00],
        [1.5103e+00, 1.3555e+00, 9.6890e-01, 3.9142e+05, 3.7970e+05, 9.3299e-01,
         1.7555e+00, 3.9427e+05, 3.8740e+05, 1.4633e+00, 3.8376e+05, 1.3036e+00,
         0.0000e+00, 4.1214e+05, 1.1309e+00, 1.0154e+00, 3.9915e+05, 1.9755e+00],
        [4.1214e+05, 4.1214e+05, 4.1215e+05, 7.9875e+05, 7.8549e+05, 4.1214e+05,
         4.1215e+05, 8.0794e+05, 7.9683e+05, 4.1211e+05, 7.6760e+05, 4.1215e+05,
         4.1214e+05, 0.0000e+00, 4.1212e+05, 4.1217e+05, 8.1972e+05, 4.1212e+05],
        [1.1745e+00, 1.0373e+00, 9.2447e-01, 3.9140e+05, 3.7967e+05, 8.2017e-01,
         1.3508e+00, 3.9426e+05, 3.8739e+05, 1.1892e+00, 3.8374e+05, 1.0108e+00,
         1.1309e+00, 4.1212e+05, 0.0000e+00, 9.5841e-01, 3.9918e+05, 1.4609e+00],
        [1.2380e+00, 1.1417e+00, 8.2190e-01, 3.9142e+05, 3.7966e+05, 7.8317e-01,
         1.3249e+00, 3.9423e+05, 3.8738e+05, 1.2009e+00, 3.8375e+05, 1.1083e+00,
         1.0154e+00, 4.1217e+05, 9.5841e-01, 0.0000e+00, 3.9918e+05, 1.5385e+00],
        [3.9917e+05, 3.9917e+05, 3.9916e+05, 8.1792e+05, 7.9592e+05, 3.9917e+05,
         3.9918e+05, 7.8960e+05, 7.8564e+05, 3.9918e+05, 7.8759e+05, 3.9918e+05,
         3.9915e+05, 8.1972e+05, 3.9918e+05, 3.9918e+05, 0.0000e+00, 3.9916e+05],
        [1.2686e+00, 1.2796e+00, 1.4735e+00, 3.9139e+05, 3.7966e+05, 1.4580e+00,
         1.1563e+00, 3.9424e+05, 3.8739e+05, 1.1952e+00, 3.8370e+05, 1.2176e+00,
         1.9755e+00, 4.1212e+05, 1.4609e+00, 1.5385e+00, 3.9916e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0558e+00, 1.1435e+00, 1.1745e+00, 1.1800e+00, 1.1926e+00,
        1.2278e+00, 1.2380e+00, 1.2435e+00, 1.2686e+00, 1.5103e+00, 3.7962e+05,
        3.8370e+05, 3.8736e+05, 3.9139e+05, 3.9425e+05, 3.9917e+05, 4.1214e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0373e+00, 1.0478e+00, 1.0558e+00, 1.0616e+00, 1.0702e+00,
        1.0826e+00, 1.1417e+00, 1.1917e+00, 1.2796e+00, 1.3555e+00, 3.7966e+05,
        3.8373e+05, 3.8737e+05, 3.9140e+05, 3.9425e+05, 3.9917e+05, 4.1214e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 7.5256e-01, 8.2190e-01, 9.2447e-01, 9.6890e-01, 1.0611e+00,
        1.0616e+00, 1.1827e+00, 1.2435e+00, 1.3315e+00, 1.4735e+00, 3.7968e+05,
        3.8375e+05, 3.8738e+05, 3.9140e+05, 3.9426e+05, 3.9916e+05, 4.1215e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 391382.6250, 391383.7812, 391388.5000, 391391.0625,
        391395.3125, 391397.7500, 391399.4688, 391401.8438, 391414.6875,
        391415.0938, 391416.4375, 757445.5000, 776828.5625, 785370.9375,
        788207.3750, 798748.7500, 817916.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 379619.8438, 379657.3125, 379657.8125, 379659.9688,
        379660.5000, 379661.7812, 379665.3750, 379665.8125, 379673.3125,
        379682.4062, 379697.3125, 754952.3750, 756996.2500, 776498.0625,
        785370.9375, 785493.8750, 795917.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 7.5256e-01, 7.8317e-01, 8.2017e-01, 9.3299e-01, 1.0170e+00,
        1.0702e+00, 1.1897e+00, 1.1926e+00, 1.3263e+00, 1.4580e+00, 3.7967e+05,
        3.8372e+05, 3.8740e+05, 3.9141e+05, 3.9425e+05, 3.9917e+05, 4.1214e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1563e+00, 1.1907e+00, 1.1917e+00, 1.2181e+00, 1.2278e+00,
        1.3249e+00, 1.3263e+00, 1.3315e+00, 1.3508e+00, 1.7555e+00, 3.7966e+05,
        3.8373e+05, 3.8739e+05, 3.9140e+05, 3.9426e+05, 3.9918e+05, 4.1215e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 394226.5000, 394234.2500, 394239.4375, 394240.8438,
        394245.5938, 394246.6250, 394254.7812, 394255.5625, 394262.5625,
        394262.5938, 394271.4375, 757445.5000, 773053.7500, 776498.0625,
        789599.0625, 793807.0000, 807942.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 387362.4375, 387370.8125, 387384.1875, 387384.2812,
        387385.9062, 387386.3125, 387392.3438, 387395.0625, 387396.8125,
        387402.7812, 387408.0312, 754952.3750, 761144.6875, 776828.5625,
        785640.1875, 793807.0000, 796826.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0826e+00, 1.1324e+00, 1.1800e+00, 1.1827e+00, 1.1892e+00,
        1.1897e+00, 1.1952e+00, 1.2009e+00, 1.2181e+00, 1.4633e+00, 3.7966e+05,
        3.8372e+05, 3.8740e+05, 3.9138e+05, 3.9423e+05, 3.9918e+05, 4.1211e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 383702.1250, 383703.9062, 383715.4375, 383716.8750,
        383722.5000, 383725.7500, 383731.1875, 383743.5312, 383752.0625,
        383754.6250, 383760.0000, 756996.2500, 761144.6875, 767602.5625,
        773053.7500, 787593.5625, 788207.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0108e+00, 1.0170e+00, 1.0478e+00, 1.0611e+00, 1.1083e+00,
        1.1324e+00, 1.1435e+00, 1.1907e+00, 1.2176e+00, 1.3036e+00, 3.7967e+05,
        3.8372e+05, 3.8741e+05, 3.9138e+05, 3.9424e+05, 3.9918e+05, 4.1215e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.3299e-01, 9.6890e-01, 1.0154e+00, 1.1309e+00, 1.3036e+00,
        1.3555e+00, 1.4633e+00, 1.5103e+00, 1.7555e+00, 1.9755e+00, 3.7970e+05,
        3.8376e+05, 3.8740e+05, 3.9142e+05, 3.9427e+05, 3.9915e+05, 4.1214e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 412113.8438, 412117.8125, 412119.6250, 412136.1250,
        412140.6562, 412142.5000, 412142.8125, 412150.8750, 412153.4375,
        412154.6250, 412168.5312, 767602.5625, 785493.8750, 796826.2500,
        798748.7500, 807942.5000, 819721.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.2017e-01, 9.2447e-01, 9.5841e-01, 1.0108e+00, 1.0373e+00,
        1.1309e+00, 1.1745e+00, 1.1892e+00, 1.3508e+00, 1.4609e+00, 3.7967e+05,
        3.8374e+05, 3.8739e+05, 3.9140e+05, 3.9426e+05, 3.9918e+05, 4.1212e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 7.8317e-01, 8.2190e-01, 9.5841e-01, 1.0154e+00, 1.1083e+00,
        1.1417e+00, 1.2009e+00, 1.2380e+00, 1.3249e+00, 1.5385e+00, 3.7966e+05,
        3.8375e+05, 3.8738e+05, 3.9142e+05, 3.9423e+05, 3.9918e+05, 4.1217e+05])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 399152.8125, 399156.9062, 399159.1562, 399165.0625,
        399173.0312, 399174.7812, 399175.1875, 399175.6875, 399178.7500,
        399182.5625, 399183.4062, 785640.1875, 787593.5625, 789599.0625,
        795917.7500, 817916.8750, 819721.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1563e+00, 1.1952e+00, 1.2176e+00, 1.2686e+00, 1.2796e+00,
        1.4580e+00, 1.4609e+00, 1.4735e+00, 1.5385e+00, 1.9755e+00, 3.7966e+05,
        3.8370e+05, 3.8739e+05, 3.9139e+05, 3.9424e+05, 3.9916e+05, 4.1212e+05])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['34512.00', '34515.73', '34517.56', '391398.78', '379663.75', '34516.03', '34515.49', '394249.09', '387388.06', '34515.44', '383729.78', '34516.78', '34519.16', '412140.03', '34516.04', '34515.59', '399170.66', '34515.82']
estimated f for each client, fs: [7, 7, 7, 5, 5, 7, 7, 5, 5, 7, 5, 7, 7, 5, 7, 7, 5, 7]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0133s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:17...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:30:17, End: 2025-07-22 15:30:17)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [7, 2, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0684e+00, 3.8708e+05, 1.1718e+00, 1.2447e+00, 3.7326e+05,
         3.8383e+05, 1.1272e+00, 3.9431e+05, 1.1023e+00, 3.9890e+05, 3.9216e+05,
         1.1258e+00, 1.1438e+00, 3.9096e+05, 1.1083e+00],
        [1.0684e+00, 0.0000e+00, 3.8713e+05, 8.3010e-01, 1.3294e+00, 3.7327e+05,
         3.8380e+05, 1.1735e+00, 3.9430e+05, 1.0334e+00, 3.9892e+05, 3.9215e+05,
         9.6167e-01, 8.6009e-01, 3.9100e+05, 1.0926e+00],
        [3.8708e+05, 3.8713e+05, 0.0000e+00, 3.8712e+05, 3.8710e+05, 7.4425e+05,
         7.8558e+05, 3.8712e+05, 7.6988e+05, 3.8710e+05, 8.0536e+05, 7.9530e+05,
         3.8711e+05, 3.8710e+05, 7.6974e+05, 3.8712e+05],
        [1.1718e+00, 8.3010e-01, 3.8712e+05, 0.0000e+00, 1.4495e+00, 3.7329e+05,
         3.8379e+05, 1.2784e+00, 3.9429e+05, 1.0855e+00, 3.9891e+05, 3.9215e+05,
         9.3692e-01, 9.0114e-01, 3.9099e+05, 1.1212e+00],
        [1.2447e+00, 1.3294e+00, 3.8710e+05, 1.4495e+00, 0.0000e+00, 3.7325e+05,
         3.8381e+05, 1.2273e+00, 3.9431e+05, 1.2596e+00, 3.9886e+05, 3.9214e+05,
         1.4320e+00, 1.2831e+00, 3.9097e+05, 1.2516e+00],
        [3.7326e+05, 3.7327e+05, 7.4425e+05, 3.7329e+05, 3.7325e+05, 0.0000e+00,
         7.5630e+05, 3.7326e+05, 7.7143e+05, 3.7328e+05, 8.0433e+05, 7.7926e+05,
         3.7324e+05, 3.7326e+05, 7.6919e+05, 3.7327e+05],
        [3.8383e+05, 3.8380e+05, 7.8558e+05, 3.8379e+05, 3.8381e+05, 7.5630e+05,
         0.0000e+00, 3.8382e+05, 7.5797e+05, 3.8382e+05, 7.6491e+05, 7.8938e+05,
         3.8379e+05, 3.8381e+05, 7.8596e+05, 3.8377e+05],
        [1.1272e+00, 1.1735e+00, 3.8712e+05, 1.2784e+00, 1.2273e+00, 3.7326e+05,
         3.8382e+05, 0.0000e+00, 3.9429e+05, 1.1660e+00, 3.9891e+05, 3.9214e+05,
         1.2389e+00, 1.1610e+00, 3.9097e+05, 1.1035e+00],
        [3.9431e+05, 3.9430e+05, 7.6988e+05, 3.9429e+05, 3.9431e+05, 7.7143e+05,
         7.5797e+05, 3.9429e+05, 0.0000e+00, 3.9431e+05, 8.0630e+05, 8.1437e+05,
         3.9431e+05, 3.9431e+05, 7.8322e+05, 3.9431e+05],
        [1.1023e+00, 1.0334e+00, 3.8710e+05, 1.0855e+00, 1.2596e+00, 3.7328e+05,
         3.8382e+05, 1.1660e+00, 3.9431e+05, 0.0000e+00, 3.9893e+05, 3.9214e+05,
         1.0957e+00, 1.1099e+00, 3.9096e+05, 1.0937e+00],
        [3.9890e+05, 3.9892e+05, 8.0536e+05, 3.9891e+05, 3.9886e+05, 8.0433e+05,
         7.6491e+05, 3.9891e+05, 8.0630e+05, 3.9893e+05, 0.0000e+00, 7.9225e+05,
         3.9890e+05, 3.9891e+05, 7.8049e+05, 3.9890e+05],
        [3.9216e+05, 3.9215e+05, 7.9530e+05, 3.9215e+05, 3.9214e+05, 7.7926e+05,
         7.8938e+05, 3.9214e+05, 8.1437e+05, 3.9214e+05, 7.9225e+05, 0.0000e+00,
         3.9215e+05, 3.9213e+05, 7.6043e+05, 3.9212e+05],
        [1.1258e+00, 9.6167e-01, 3.8711e+05, 9.3692e-01, 1.4320e+00, 3.7324e+05,
         3.8379e+05, 1.2389e+00, 3.9431e+05, 1.0957e+00, 3.9890e+05, 3.9215e+05,
         0.0000e+00, 1.0030e+00, 3.9097e+05, 1.1537e+00],
        [1.1438e+00, 8.6009e-01, 3.8710e+05, 9.0114e-01, 1.2831e+00, 3.7326e+05,
         3.8381e+05, 1.1610e+00, 3.9431e+05, 1.1099e+00, 3.9891e+05, 3.9213e+05,
         1.0030e+00, 0.0000e+00, 3.9098e+05, 1.0842e+00],
        [3.9096e+05, 3.9100e+05, 7.6974e+05, 3.9099e+05, 3.9097e+05, 7.6919e+05,
         7.8596e+05, 3.9097e+05, 7.8322e+05, 3.9096e+05, 7.8049e+05, 7.6043e+05,
         3.9097e+05, 3.9098e+05, 0.0000e+00, 3.9097e+05],
        [1.1083e+00, 1.0926e+00, 3.8712e+05, 1.1212e+00, 1.2516e+00, 3.7327e+05,
         3.8377e+05, 1.1035e+00, 3.9431e+05, 1.0937e+00, 3.9890e+05, 3.9212e+05,
         1.1537e+00, 1.0842e+00, 3.9097e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0684e+00, 1.1023e+00, 1.1083e+00, 1.1258e+00, 1.1272e+00,
        1.1438e+00, 1.1718e+00, 1.2447e+00, 3.7326e+05, 3.8383e+05, 3.8708e+05,
        3.9096e+05, 3.9216e+05, 3.9431e+05, 3.9890e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3010e-01, 8.6009e-01, 9.6167e-01, 1.0334e+00, 1.0684e+00,
        1.0926e+00, 1.1735e+00, 1.3294e+00, 3.7327e+05, 3.8380e+05, 3.8713e+05,
        3.9100e+05, 3.9215e+05, 3.9430e+05, 3.9892e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387081.0312, 387097.3438, 387101.8125, 387105.0000,
        387109.2188, 387115.2188, 387119.5625, 387123.9688, 387131.0000,
        744249.9375, 769742.4375, 769882.4375, 785576.3125, 795296.7500,
        805360.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3010e-01, 9.0114e-01, 9.3692e-01, 1.0855e+00, 1.1212e+00,
        1.1718e+00, 1.2784e+00, 1.4495e+00, 3.7329e+05, 3.8379e+05, 3.8712e+05,
        3.9099e+05, 3.9215e+05, 3.9429e+05, 3.9891e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2273e+00, 1.2447e+00, 1.2516e+00, 1.2596e+00, 1.2831e+00,
        1.3294e+00, 1.4320e+00, 1.4495e+00, 3.7325e+05, 3.8381e+05, 3.8710e+05,
        3.9097e+05, 3.9214e+05, 3.9431e+05, 3.9886e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 373240.1875, 373251.9062, 373256.8438, 373257.3125,
        373263.8438, 373268.6875, 373272.8750, 373284.4375, 373285.8750,
        744249.9375, 756295.0000, 769188.6250, 771433.5000, 779263.0000,
        804326.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383766.0000, 383790.5000, 383793.7188, 383796.0000,
        383806.6875, 383814.1875, 383821.8125, 383824.9375, 383828.5000,
        756295.0000, 757972.3750, 764905.0625, 785576.3125, 785964.7500,
        789383.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1035e+00, 1.1272e+00, 1.1610e+00, 1.1660e+00, 1.1735e+00,
        1.2273e+00, 1.2389e+00, 1.2784e+00, 3.7326e+05, 3.8382e+05, 3.8712e+05,
        3.9097e+05, 3.9214e+05, 3.9429e+05, 3.9891e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394287.6250, 394289.2188, 394304.5625, 394305.6250,
        394306.5000, 394308.0000, 394310.3438, 394311.0938, 394311.6250,
        757972.3750, 769882.4375, 771433.5000, 783218.0000, 806301.3125,
        814372.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0334e+00, 1.0855e+00, 1.0937e+00, 1.0957e+00, 1.1023e+00,
        1.1099e+00, 1.1660e+00, 1.2596e+00, 3.7328e+05, 3.8382e+05, 3.8710e+05,
        3.9096e+05, 3.9214e+05, 3.9431e+05, 3.9893e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398860.9375, 398896.0938, 398898.8125, 398903.5625,
        398907.4062, 398907.5625, 398914.3438, 398917.5000, 398926.6875,
        764905.0625, 780488.5625, 792248.3750, 804326.4375, 805360.9375,
        806301.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392118.5000, 392128.1250, 392139.8750, 392140.1562,
        392143.9375, 392145.1250, 392145.7500, 392152.3750, 392158.1562,
        760426.1250, 779263.0000, 789383.0625, 792248.3750, 795296.7500,
        814372.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.3692e-01, 9.6167e-01, 1.0030e+00, 1.0957e+00, 1.1258e+00,
        1.1537e+00, 1.2389e+00, 1.4320e+00, 3.7324e+05, 3.8379e+05, 3.8711e+05,
        3.9097e+05, 3.9215e+05, 3.9431e+05, 3.9890e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6009e-01, 9.0114e-01, 1.0030e+00, 1.0842e+00, 1.1099e+00,
        1.1438e+00, 1.1610e+00, 1.2831e+00, 3.7326e+05, 3.8381e+05, 3.8710e+05,
        3.9098e+05, 3.9213e+05, 3.9431e+05, 3.9891e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390956.6250, 390959.1562, 390968.1875, 390972.1875,
        390973.1562, 390974.0938, 390978.9688, 390994.1562, 390999.0625,
        760426.1250, 769188.6250, 769742.4375, 780488.5625, 783218.0000,
        785964.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0842e+00, 1.0926e+00, 1.0937e+00, 1.1035e+00, 1.1083e+00,
        1.1212e+00, 1.1537e+00, 1.2516e+00, 3.7327e+05, 3.8377e+05, 3.8712e+05,
        3.9097e+05, 3.9212e+05, 3.9431e+05, 3.9890e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75710.15', '75707.72', '422823.41', '75708.51', '75707.66', '410363.19', '421053.75', '75709.13', '430670.69', '75711.52', '435503.81', '428969.81', '75704.28', '75707.26', '427920.19', '75704.36']
estimated f for each client, fs: [7, 7, 5, 7, 7, 5, 5, 7, 5, 7, 5, 5, 7, 7, 5, 7]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 2, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0280s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:18...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:18, End: 2025-07-22 15:30:18)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 9, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 9.8926e-01, 9.1535e-01, 4.0317e+05, 3.8222e+05, 1.3005e+00,
         1.1316e+00, 3.8705e+05, 1.0600e+00, 8.7838e-01, 3.9671e+05, 3.7689e+05,
         1.0565e+00, 9.5564e-01, 4.0216e+05, 1.4331e+00, 9.9496e-01],
        [9.8926e-01, 0.0000e+00, 1.0223e+00, 4.0319e+05, 3.8221e+05, 1.2080e+00,
         1.1050e+00, 3.8709e+05, 1.0360e+00, 1.0580e+00, 3.9672e+05, 3.7692e+05,
         1.2797e+00, 1.0927e+00, 4.0216e+05, 1.3574e+00, 1.0542e+00],
        [9.1535e-01, 1.0223e+00, 0.0000e+00, 4.0317e+05, 3.8223e+05, 1.2386e+00,
         1.1033e+00, 3.8704e+05, 9.4833e-01, 7.7871e-01, 3.9674e+05, 3.7689e+05,
         1.0222e+00, 8.3557e-01, 4.0215e+05, 1.3936e+00, 1.0422e+00],
        [4.0317e+05, 4.0319e+05, 4.0317e+05, 0.0000e+00, 8.0310e+05, 4.0321e+05,
         4.0317e+05, 8.0868e+05, 4.0318e+05, 4.0318e+05, 7.9560e+05, 7.7784e+05,
         4.0316e+05, 4.0317e+05, 8.1197e+05, 4.0320e+05, 4.0319e+05],
        [3.8222e+05, 3.8221e+05, 3.8223e+05, 8.0310e+05, 0.0000e+00, 3.8221e+05,
         3.8220e+05, 7.6249e+05, 3.8220e+05, 3.8221e+05, 7.9494e+05, 7.8560e+05,
         3.8221e+05, 3.8220e+05, 7.8106e+05, 3.8222e+05, 3.8222e+05],
        [1.3005e+00, 1.2080e+00, 1.2386e+00, 4.0321e+05, 3.8221e+05, 0.0000e+00,
         1.1756e+00, 3.8708e+05, 1.1451e+00, 1.2985e+00, 3.9672e+05, 3.7693e+05,
         1.7660e+00, 1.2384e+00, 4.0215e+05, 1.1762e+00, 1.1246e+00],
        [1.1316e+00, 1.1050e+00, 1.1033e+00, 4.0317e+05, 3.8220e+05, 1.1756e+00,
         0.0000e+00, 3.8708e+05, 1.1064e+00, 1.1249e+00, 3.9668e+05, 3.7689e+05,
         1.4715e+00, 1.0928e+00, 4.0215e+05, 1.2490e+00, 1.0652e+00],
        [3.8705e+05, 3.8709e+05, 3.8704e+05, 8.0868e+05, 7.6249e+05, 3.8708e+05,
         3.8708e+05, 0.0000e+00, 3.8709e+05, 3.8705e+05, 7.8698e+05, 7.6230e+05,
         3.8710e+05, 3.8710e+05, 7.9889e+05, 3.8707e+05, 3.8707e+05],
        [1.0600e+00, 1.0360e+00, 9.4833e-01, 4.0318e+05, 3.8220e+05, 1.1451e+00,
         1.1064e+00, 3.8709e+05, 0.0000e+00, 9.7170e-01, 3.9670e+05, 3.7689e+05,
         1.2407e+00, 1.0274e+00, 4.0217e+05, 1.2291e+00, 9.9857e-01],
        [8.7838e-01, 1.0580e+00, 7.7871e-01, 4.0318e+05, 3.8221e+05, 1.2985e+00,
         1.1249e+00, 3.8705e+05, 9.7170e-01, 0.0000e+00, 3.9670e+05, 3.7688e+05,
         9.6677e-01, 8.5535e-01, 4.0216e+05, 1.5318e+00, 9.9887e-01],
        [3.9671e+05, 3.9672e+05, 3.9674e+05, 7.9560e+05, 7.9494e+05, 3.9672e+05,
         3.9668e+05, 7.8698e+05, 3.9670e+05, 3.9670e+05, 0.0000e+00, 7.6644e+05,
         3.9670e+05, 3.9672e+05, 7.8058e+05, 3.9668e+05, 3.9672e+05],
        [3.7689e+05, 3.7692e+05, 3.7689e+05, 7.7784e+05, 7.8560e+05, 3.7693e+05,
         3.7689e+05, 7.6230e+05, 3.7689e+05, 3.7688e+05, 7.6644e+05, 0.0000e+00,
         3.7686e+05, 3.7690e+05, 8.1450e+05, 3.7690e+05, 3.7692e+05],
        [1.0565e+00, 1.2797e+00, 1.0222e+00, 4.0316e+05, 3.8221e+05, 1.7660e+00,
         1.4715e+00, 3.8710e+05, 1.2407e+00, 9.6677e-01, 3.9670e+05, 3.7686e+05,
         0.0000e+00, 1.0521e+00, 4.0216e+05, 2.0073e+00, 1.3947e+00],
        [9.5564e-01, 1.0927e+00, 8.3557e-01, 4.0317e+05, 3.8220e+05, 1.2384e+00,
         1.0928e+00, 3.8710e+05, 1.0274e+00, 8.5535e-01, 3.9672e+05, 3.7690e+05,
         1.0521e+00, 0.0000e+00, 4.0216e+05, 1.4121e+00, 1.0464e+00],
        [4.0216e+05, 4.0216e+05, 4.0215e+05, 8.1197e+05, 7.8106e+05, 4.0215e+05,
         4.0215e+05, 7.9889e+05, 4.0217e+05, 4.0216e+05, 7.8058e+05, 8.1450e+05,
         4.0216e+05, 4.0216e+05, 0.0000e+00, 4.0214e+05, 4.0215e+05],
        [1.4331e+00, 1.3574e+00, 1.3936e+00, 4.0320e+05, 3.8222e+05, 1.1762e+00,
         1.2490e+00, 3.8707e+05, 1.2291e+00, 1.5318e+00, 3.9668e+05, 3.7690e+05,
         2.0073e+00, 1.4121e+00, 4.0214e+05, 0.0000e+00, 1.1924e+00],
        [9.9496e-01, 1.0542e+00, 1.0422e+00, 4.0319e+05, 3.8222e+05, 1.1246e+00,
         1.0652e+00, 3.8707e+05, 9.9857e-01, 9.9887e-01, 3.9672e+05, 3.7692e+05,
         1.3947e+00, 1.0464e+00, 4.0215e+05, 1.1924e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.7838e-01, 9.1535e-01, 9.5564e-01, 9.8926e-01, 9.9496e-01,
        1.0565e+00, 1.0600e+00, 1.1316e+00, 1.3005e+00, 1.4331e+00, 3.7689e+05,
        3.8222e+05, 3.8705e+05, 3.9671e+05, 4.0216e+05, 4.0317e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8926e-01, 1.0223e+00, 1.0360e+00, 1.0542e+00, 1.0580e+00,
        1.0927e+00, 1.1050e+00, 1.2080e+00, 1.2797e+00, 1.3574e+00, 3.7692e+05,
        3.8221e+05, 3.8709e+05, 3.9672e+05, 4.0216e+05, 4.0319e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.7871e-01, 8.3557e-01, 9.1535e-01, 9.4833e-01, 1.0222e+00,
        1.0223e+00, 1.0422e+00, 1.1033e+00, 1.2386e+00, 1.3936e+00, 3.7689e+05,
        3.8223e+05, 3.8704e+05, 3.9674e+05, 4.0215e+05, 4.0317e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403161.3750, 403165.7500, 403166.3125, 403168.6875,
        403173.8750, 403176.9375, 403179.9375, 403186.0312, 403188.1250,
        403195.0625, 403209.4062, 777835.8125, 795604.5000, 803104.0625,
        808675.8750, 811968.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382195.7500, 382196.6250, 382200.8750, 382207.2188,
        382208.3750, 382208.3750, 382210.5312, 382216.5000, 382220.0000,
        382220.4062, 382232.8438, 762493.7500, 781060.6875, 785596.5625,
        794937.5000, 803104.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1246e+00, 1.1451e+00, 1.1756e+00, 1.1762e+00, 1.2080e+00,
        1.2384e+00, 1.2386e+00, 1.2985e+00, 1.3005e+00, 1.7660e+00, 3.7693e+05,
        3.8221e+05, 3.8708e+05, 3.9672e+05, 4.0215e+05, 4.0321e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0652e+00, 1.0928e+00, 1.1033e+00, 1.1050e+00, 1.1064e+00,
        1.1249e+00, 1.1316e+00, 1.1756e+00, 1.2490e+00, 1.4715e+00, 3.7689e+05,
        3.8220e+05, 3.8708e+05, 3.9668e+05, 4.0215e+05, 4.0317e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387044.3750, 387048.1875, 387049.6250, 387069.3125,
        387073.5625, 387077.1562, 387081.9375, 387087.0938, 387090.6562,
        387096.7188, 387097.4375, 762299.7500, 762493.7500, 786977.3125,
        798886.3750, 808675.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.4833e-01, 9.7170e-01, 9.9857e-01, 1.0274e+00, 1.0360e+00,
        1.0600e+00, 1.1064e+00, 1.1451e+00, 1.2291e+00, 1.2407e+00, 3.7689e+05,
        3.8220e+05, 3.8709e+05, 3.9670e+05, 4.0217e+05, 4.0318e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.7871e-01, 8.5535e-01, 8.7838e-01, 9.6677e-01, 9.7170e-01,
        9.9887e-01, 1.0580e+00, 1.1249e+00, 1.2985e+00, 1.5318e+00, 3.7688e+05,
        3.8221e+05, 3.8705e+05, 3.9670e+05, 4.0216e+05, 4.0318e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396683.6875, 396684.9062, 396700.7812, 396702.0625,
        396702.2500, 396709.8750, 396716.3438, 396717.4375, 396721.8750,
        396723.6562, 396739.2188, 766442.2500, 780584.1875, 786977.3125,
        794937.5000, 795604.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 376855.6250, 376881.2500, 376887.5000, 376890.3125,
        376891.4062, 376893.0312, 376899.2812, 376903.4688, 376923.8750,
        376924.9062, 376929.1562, 762299.7500, 766442.2500, 777835.8125,
        785596.5625, 814496.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.6677e-01, 1.0222e+00, 1.0521e+00, 1.0565e+00, 1.2407e+00,
        1.2797e+00, 1.3947e+00, 1.4715e+00, 1.7660e+00, 2.0073e+00, 3.7686e+05,
        3.8221e+05, 3.8710e+05, 3.9670e+05, 4.0216e+05, 4.0316e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3557e-01, 8.5535e-01, 9.5564e-01, 1.0274e+00, 1.0464e+00,
        1.0521e+00, 1.0927e+00, 1.0928e+00, 1.2384e+00, 1.4121e+00, 3.7690e+05,
        3.8220e+05, 3.8710e+05, 3.9672e+05, 4.0216e+05, 4.0317e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402145.0000, 402146.7500, 402150.4375, 402153.9688,
        402154.7188, 402156.0000, 402159.0000, 402161.6250, 402163.3125,
        402164.6875, 402166.4062, 780584.1875, 781060.6875, 798886.3750,
        811968.3750, 814496.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1762e+00, 1.1924e+00, 1.2291e+00, 1.2490e+00, 1.3574e+00,
        1.3936e+00, 1.4121e+00, 1.4331e+00, 1.5318e+00, 2.0073e+00, 3.7690e+05,
        3.8222e+05, 3.8707e+05, 3.9668e+05, 4.0214e+05, 4.0320e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.9496e-01, 9.9857e-01, 9.9887e-01, 1.0422e+00, 1.0464e+00,
        1.0542e+00, 1.0652e+00, 1.1246e+00, 1.1924e+00, 1.3947e+00, 3.7692e+05,
        3.8222e+05, 3.8707e+05, 3.9672e+05, 4.0215e+05, 4.0319e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.07', '1.12', '1.03', '403179.25', '382210.69', '1.27', '1.16', '387074.16', '1.08', '1.05', '396709.28', '376895.03', '1.33', '1.06', '402156.50', '1.40', '1.09']
estimated f for each client, fs: [6, 6, 6, 4, 4, 6, 6, 4, 6, 6, 4, 6, 6, 6, 4, 6, 6]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 9, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0129s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:19...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:19, End: 2025-07-22 15:30:19)
start time is: 97183784220169, end time is: 97200861024477
The total time is: 17076804308ns.

 ------- aggregate method: krum, random_seed: 0 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 4.9551e+00, 3.8629e+05, 3.8920e+05, 4.7912e+00, 5.7519e+00,
         3.8983e+05, 3.9224e+05, 5.2551e+00, 4.9415e+00, 4.9672e+00, 3.8845e+05,
         3.9025e+05, 4.8957e+00],
        [4.9551e+00, 0.0000e+00, 3.8636e+05, 3.8920e+05, 4.7944e+00, 4.2292e+00,
         3.8981e+05, 3.9217e+05, 5.4314e+00, 4.2924e+00, 5.1676e+00, 3.8849e+05,
         3.9023e+05, 4.1046e+00],
        [3.8629e+05, 3.8636e+05, 0.0000e+00, 7.9140e+05, 3.8640e+05, 3.8633e+05,
         7.5563e+05, 7.7453e+05, 3.8638e+05, 3.8630e+05, 3.8640e+05, 7.7465e+05,
         7.7685e+05, 3.8635e+05],
        [3.8920e+05, 3.8920e+05, 7.9140e+05, 0.0000e+00, 3.8926e+05, 3.8928e+05,
         7.7835e+05, 7.8914e+05, 3.8924e+05, 3.8922e+05, 3.8921e+05, 7.8284e+05,
         7.7196e+05, 3.8924e+05],
        [4.7912e+00, 4.7944e+00, 3.8640e+05, 3.8926e+05, 0.0000e+00, 4.5555e+00,
         3.8985e+05, 3.9214e+05, 4.4633e+00, 4.5130e+00, 4.4420e+00, 3.8845e+05,
         3.9021e+05, 5.2108e+00],
        [5.7519e+00, 4.2292e+00, 3.8633e+05, 3.8928e+05, 4.5555e+00, 0.0000e+00,
         3.8994e+05, 3.9219e+05, 5.6915e+00, 4.3339e+00, 5.3880e+00, 3.8851e+05,
         3.9018e+05, 4.7331e+00],
        [3.8983e+05, 3.8981e+05, 7.5563e+05, 7.7835e+05, 3.8985e+05, 3.8994e+05,
         0.0000e+00, 7.9007e+05, 3.8985e+05, 3.8985e+05, 3.8985e+05, 7.8903e+05,
         7.9395e+05, 3.8985e+05],
        [3.9224e+05, 3.9217e+05, 7.7453e+05, 7.8914e+05, 3.9214e+05, 3.9219e+05,
         7.9007e+05, 0.0000e+00, 3.9212e+05, 3.9216e+05, 3.9216e+05, 7.9764e+05,
         7.8486e+05, 3.9221e+05],
        [5.2551e+00, 5.4314e+00, 3.8638e+05, 3.8924e+05, 4.4633e+00, 5.6915e+00,
         3.8985e+05, 3.9212e+05, 0.0000e+00, 5.0721e+00, 4.5551e+00, 3.8849e+05,
         3.9021e+05, 5.3428e+00],
        [4.9415e+00, 4.2924e+00, 3.8630e+05, 3.8922e+05, 4.5130e+00, 4.3339e+00,
         3.8985e+05, 3.9216e+05, 5.0721e+00, 0.0000e+00, 4.4869e+00, 3.8849e+05,
         3.9023e+05, 4.2227e+00],
        [4.9672e+00, 5.1676e+00, 3.8640e+05, 3.8921e+05, 4.4420e+00, 5.3880e+00,
         3.8985e+05, 3.9216e+05, 4.5551e+00, 4.4869e+00, 0.0000e+00, 3.8851e+05,
         3.9014e+05, 5.3356e+00],
        [3.8845e+05, 3.8849e+05, 7.7465e+05, 7.8284e+05, 3.8845e+05, 3.8851e+05,
         7.8903e+05, 7.9764e+05, 3.8849e+05, 3.8849e+05, 3.8851e+05, 0.0000e+00,
         7.8040e+05, 3.8850e+05],
        [3.9025e+05, 3.9023e+05, 7.7685e+05, 7.7196e+05, 3.9021e+05, 3.9018e+05,
         7.9395e+05, 7.8486e+05, 3.9021e+05, 3.9023e+05, 3.9014e+05, 7.8040e+05,
         0.0000e+00, 3.9024e+05],
        [4.8957e+00, 4.1046e+00, 3.8635e+05, 3.8924e+05, 5.2108e+00, 4.7331e+00,
         3.8985e+05, 3.9221e+05, 5.3428e+00, 4.2227e+00, 5.3356e+00, 3.8850e+05,
         3.9024e+05, 0.0000e+00]])
Krum scores: ['4.97', '4.59', '386334.91', '389218.12', '4.59', '4.82', '389839.41', '392157.66', '5.02', '4.47', '4.83', '388476.66', '390200.41', '4.75']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:19...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:19, End: 2025-07-22 15:30:19)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 19, 17, 1, 9, 20, 15, 3, 14, 11, 10, 16, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.9099e+00, 3.9005e+05, 3.8322e+05, 1.9695e+00, 1.9925e+00,
         3.9289e+05, 4.0265e+05, 1.9003e+00, 3.9414e+05, 1.7854e+00, 1.8809e+00,
         3.7721e+05, 1.9708e+00],
        [1.9099e+00, 0.0000e+00, 3.9006e+05, 3.8326e+05, 1.8574e+00, 1.9655e+00,
         3.9291e+05, 4.0270e+05, 2.0807e+00, 3.9411e+05, 1.8397e+00, 1.8809e+00,
         3.7721e+05, 1.9386e+00],
        [3.9005e+05, 3.9006e+05, 0.0000e+00, 7.3696e+05, 3.9006e+05, 3.9007e+05,
         7.7911e+05, 7.9975e+05, 3.9007e+05, 7.7887e+05, 3.9003e+05, 3.9007e+05,
         7.5967e+05, 3.9003e+05],
        [3.8322e+05, 3.8326e+05, 7.3696e+05, 0.0000e+00, 3.8326e+05, 3.8322e+05,
         7.6325e+05, 7.8211e+05, 3.8324e+05, 7.8920e+05, 3.8325e+05, 3.8326e+05,
         7.3872e+05, 3.8325e+05],
        [1.9695e+00, 1.8574e+00, 3.9006e+05, 3.8326e+05, 0.0000e+00, 1.7899e+00,
         3.9288e+05, 4.0268e+05, 2.0800e+00, 3.9415e+05, 1.8538e+00, 1.9203e+00,
         3.7720e+05, 1.9793e+00],
        [1.9925e+00, 1.9655e+00, 3.9007e+05, 3.8322e+05, 1.7899e+00, 0.0000e+00,
         3.9286e+05, 4.0267e+05, 1.9937e+00, 3.9419e+05, 1.8492e+00, 1.7443e+00,
         3.7722e+05, 1.9596e+00],
        [3.9289e+05, 3.9291e+05, 7.7911e+05, 7.6325e+05, 3.9288e+05, 3.9286e+05,
         0.0000e+00, 8.1851e+05, 3.9290e+05, 8.1239e+05, 3.9289e+05, 3.9288e+05,
         7.8534e+05, 3.9295e+05],
        [4.0265e+05, 4.0270e+05, 7.9975e+05, 7.8211e+05, 4.0268e+05, 4.0267e+05,
         8.1851e+05, 0.0000e+00, 4.0268e+05, 7.9520e+05, 4.0269e+05, 4.0266e+05,
         7.7468e+05, 4.0267e+05],
        [1.9003e+00, 2.0807e+00, 3.9007e+05, 3.8324e+05, 2.0800e+00, 1.9937e+00,
         3.9290e+05, 4.0268e+05, 0.0000e+00, 3.9413e+05, 2.0283e+00, 1.7906e+00,
         3.7719e+05, 1.8669e+00],
        [3.9414e+05, 3.9411e+05, 7.7887e+05, 7.8920e+05, 3.9415e+05, 3.9419e+05,
         8.1239e+05, 7.9520e+05, 3.9413e+05, 0.0000e+00, 3.9410e+05, 3.9413e+05,
         7.8476e+05, 3.9411e+05],
        [1.7854e+00, 1.8397e+00, 3.9003e+05, 3.8325e+05, 1.8538e+00, 1.8492e+00,
         3.9289e+05, 4.0269e+05, 2.0283e+00, 3.9410e+05, 0.0000e+00, 1.7785e+00,
         3.7719e+05, 1.9155e+00],
        [1.8809e+00, 1.8809e+00, 3.9007e+05, 3.8326e+05, 1.9203e+00, 1.7443e+00,
         3.9288e+05, 4.0266e+05, 1.7906e+00, 3.9413e+05, 1.7785e+00, 0.0000e+00,
         3.7723e+05, 1.8083e+00],
        [3.7721e+05, 3.7721e+05, 7.5967e+05, 7.3872e+05, 3.7720e+05, 3.7722e+05,
         7.8534e+05, 7.7468e+05, 3.7719e+05, 7.8476e+05, 3.7719e+05, 3.7723e+05,
         0.0000e+00, 3.7720e+05],
        [1.9708e+00, 1.9386e+00, 3.9003e+05, 3.8325e+05, 1.9793e+00, 1.9596e+00,
         3.9295e+05, 4.0267e+05, 1.8669e+00, 3.9411e+05, 1.9155e+00, 1.8083e+00,
         3.7720e+05, 0.0000e+00]])
Krum scores: ['1.90', '1.90', '390049.06', '383240.47', '1.90', '1.88', '392883.31', '402671.16', '1.94', '394119.62', '1.84', '1.81', '377201.16', '1.91']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 15, 3, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:20...
global Accuracy on shared test data: 77.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 46 217]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:20, End: 2025-07-22 15:30:20)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 19, 17, 9, 20, 18, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.7208e+00, 3.9981e+05, 3.9551e+05, 1.8755e+00, 3.8330e+05,
         3.8901e+05, 1.7569e+00, 1.7305e+00, 3.9674e+05, 3.8217e+05, 1.8442e+00,
         3.9130e+05, 1.9485e+00, 1.7700e+00],
        [1.7208e+00, 0.0000e+00, 3.9986e+05, 3.9553e+05, 1.9602e+00, 3.8329e+05,
         3.8898e+05, 1.8173e+00, 1.9331e+00, 3.9668e+05, 3.8217e+05, 1.8683e+00,
         3.9131e+05, 1.9923e+00, 1.8314e+00],
        [3.9981e+05, 3.9986e+05, 0.0000e+00, 8.0061e+05, 3.9981e+05, 7.8733e+05,
         7.9251e+05, 3.9983e+05, 3.9982e+05, 7.9765e+05, 7.7227e+05, 3.9983e+05,
         7.7677e+05, 3.9982e+05, 3.9988e+05],
        [3.9551e+05, 3.9553e+05, 8.0061e+05, 0.0000e+00, 3.9550e+05, 7.6243e+05,
         7.7495e+05, 3.9553e+05, 3.9553e+05, 7.8493e+05, 7.7448e+05, 3.9545e+05,
         7.8577e+05, 3.9551e+05, 3.9551e+05],
        [1.8755e+00, 1.9602e+00, 3.9981e+05, 3.9550e+05, 0.0000e+00, 3.8333e+05,
         3.8899e+05, 1.8462e+00, 1.8144e+00, 3.9669e+05, 3.8216e+05, 1.7377e+00,
         3.9133e+05, 1.8547e+00, 1.8589e+00],
        [3.8330e+05, 3.8329e+05, 7.8733e+05, 7.6243e+05, 3.8333e+05, 0.0000e+00,
         7.7284e+05, 3.8329e+05, 3.8331e+05, 7.7777e+05, 7.7873e+05, 3.8330e+05,
         7.7576e+05, 3.8330e+05, 3.8328e+05],
        [3.8901e+05, 3.8898e+05, 7.9251e+05, 7.7495e+05, 3.8899e+05, 7.7284e+05,
         0.0000e+00, 3.8901e+05, 3.8898e+05, 8.0905e+05, 7.6158e+05, 3.8897e+05,
         7.8005e+05, 3.8900e+05, 3.8900e+05],
        [1.7569e+00, 1.8173e+00, 3.9983e+05, 3.9553e+05, 1.8462e+00, 3.8329e+05,
         3.8901e+05, 0.0000e+00, 1.8716e+00, 3.9671e+05, 3.8217e+05, 1.8766e+00,
         3.9134e+05, 1.8204e+00, 1.8080e+00],
        [1.7305e+00, 1.9331e+00, 3.9982e+05, 3.9553e+05, 1.8144e+00, 3.8331e+05,
         3.8898e+05, 1.8716e+00, 0.0000e+00, 3.9670e+05, 3.8219e+05, 1.7408e+00,
         3.9133e+05, 2.0777e+00, 1.7586e+00],
        [3.9674e+05, 3.9668e+05, 7.9765e+05, 7.8493e+05, 3.9669e+05, 7.7777e+05,
         8.0905e+05, 3.9671e+05, 3.9670e+05, 0.0000e+00, 7.7048e+05, 3.9671e+05,
         7.8298e+05, 3.9669e+05, 3.9669e+05],
        [3.8217e+05, 3.8217e+05, 7.7227e+05, 7.7448e+05, 3.8216e+05, 7.7873e+05,
         7.6158e+05, 3.8217e+05, 3.8219e+05, 7.7048e+05, 0.0000e+00, 3.8215e+05,
         7.8590e+05, 3.8215e+05, 3.8216e+05],
        [1.8442e+00, 1.8683e+00, 3.9983e+05, 3.9545e+05, 1.7377e+00, 3.8330e+05,
         3.8897e+05, 1.8766e+00, 1.7408e+00, 3.9671e+05, 3.8215e+05, 0.0000e+00,
         3.9132e+05, 1.9511e+00, 1.8698e+00],
        [3.9130e+05, 3.9131e+05, 7.7677e+05, 7.8577e+05, 3.9133e+05, 7.7576e+05,
         7.8005e+05, 3.9134e+05, 3.9133e+05, 7.8298e+05, 7.8590e+05, 3.9132e+05,
         0.0000e+00, 3.9133e+05, 3.9133e+05],
        [1.9485e+00, 1.9923e+00, 3.9982e+05, 3.9551e+05, 1.8547e+00, 3.8330e+05,
         3.8900e+05, 1.8204e+00, 2.0777e+00, 3.9669e+05, 3.8215e+05, 1.9511e+00,
         3.9133e+05, 0.0000e+00, 1.8520e+00],
        [1.7700e+00, 1.8314e+00, 3.9988e+05, 3.9551e+05, 1.8589e+00, 3.8328e+05,
         3.8900e+05, 1.8080e+00, 1.7586e+00, 3.9669e+05, 3.8216e+05, 1.8698e+00,
         3.9133e+05, 1.8520e+00, 0.0000e+00]])
Krum scores: ['1.78', '1.86', '399818.59', '395502.78', '1.83', '383294.44', '388989.53', '1.82', '1.81', '396693.50', '382157.88', '1.82', '391317.53', '1.90', '1.81']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0038s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:20...
global Accuracy on shared test data: 78.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:20, End: 2025-07-22 15:30:20)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.9111e+05, 4.1274e+05, 1.5756e+00, 1.6942e+00, 3.9478e+05,
         3.8934e+05, 1.8146e+00, 3.8532e+05, 1.6823e+00, 1.7600e+00, 3.8831e+05,
         3.9240e+05, 1.5804e+00, 1.6385e+00],
        [3.9111e+05, 0.0000e+00, 7.7824e+05, 3.9114e+05, 3.9113e+05, 8.1939e+05,
         7.7632e+05, 3.9113e+05, 7.7429e+05, 3.9112e+05, 3.9113e+05, 7.8230e+05,
         7.8039e+05, 3.9110e+05, 3.9113e+05],
        [4.1274e+05, 7.7824e+05, 0.0000e+00, 4.1274e+05, 4.1277e+05, 7.8948e+05,
         7.9532e+05, 4.1274e+05, 8.1041e+05, 4.1272e+05, 4.1274e+05, 8.0805e+05,
         7.9797e+05, 4.1276e+05, 4.1278e+05],
        [1.5756e+00, 3.9114e+05, 4.1274e+05, 0.0000e+00, 1.5184e+00, 3.9476e+05,
         3.8934e+05, 1.7426e+00, 3.8530e+05, 1.6557e+00, 1.7410e+00, 3.8835e+05,
         3.9240e+05, 1.6121e+00, 1.7108e+00],
        [1.6942e+00, 3.9113e+05, 4.1277e+05, 1.5184e+00, 0.0000e+00, 3.9478e+05,
         3.8936e+05, 1.7375e+00, 3.8527e+05, 1.6419e+00, 1.5812e+00, 3.8831e+05,
         3.9243e+05, 1.5638e+00, 1.4576e+00],
        [3.9478e+05, 8.1939e+05, 7.8948e+05, 3.9476e+05, 3.9478e+05, 0.0000e+00,
         7.8671e+05, 3.9478e+05, 7.6650e+05, 3.9479e+05, 3.9476e+05, 7.5644e+05,
         7.7921e+05, 3.9477e+05, 3.9477e+05],
        [3.8934e+05, 7.7632e+05, 7.9532e+05, 3.8934e+05, 3.8936e+05, 7.8671e+05,
         0.0000e+00, 3.8936e+05, 7.5440e+05, 3.8934e+05, 3.8930e+05, 7.7205e+05,
         7.6326e+05, 3.8935e+05, 3.8934e+05],
        [1.8146e+00, 3.9113e+05, 4.1274e+05, 1.7426e+00, 1.7375e+00, 3.9478e+05,
         3.8936e+05, 0.0000e+00, 3.8531e+05, 1.6936e+00, 1.6837e+00, 3.8833e+05,
         3.9241e+05, 1.6755e+00, 1.7590e+00],
        [3.8532e+05, 7.7429e+05, 8.1041e+05, 3.8530e+05, 3.8527e+05, 7.6650e+05,
         7.5440e+05, 3.8531e+05, 0.0000e+00, 3.8527e+05, 3.8530e+05, 7.6334e+05,
         7.6956e+05, 3.8528e+05, 3.8528e+05],
        [1.6823e+00, 3.9112e+05, 4.1272e+05, 1.6557e+00, 1.6419e+00, 3.9479e+05,
         3.8934e+05, 1.6936e+00, 3.8527e+05, 0.0000e+00, 1.7192e+00, 3.8831e+05,
         3.9237e+05, 1.6230e+00, 1.6663e+00],
        [1.7600e+00, 3.9113e+05, 4.1274e+05, 1.7410e+00, 1.5812e+00, 3.9476e+05,
         3.8930e+05, 1.6837e+00, 3.8530e+05, 1.7192e+00, 0.0000e+00, 3.8828e+05,
         3.9240e+05, 1.7856e+00, 1.5792e+00],
        [3.8831e+05, 7.8230e+05, 8.0805e+05, 3.8835e+05, 3.8831e+05, 7.5644e+05,
         7.7205e+05, 3.8833e+05, 7.6334e+05, 3.8831e+05, 3.8828e+05, 0.0000e+00,
         7.8667e+05, 3.8831e+05, 3.8829e+05],
        [3.9240e+05, 7.8039e+05, 7.9797e+05, 3.9240e+05, 3.9243e+05, 7.7921e+05,
         7.6326e+05, 3.9241e+05, 7.6956e+05, 3.9237e+05, 3.9240e+05, 7.8667e+05,
         0.0000e+00, 3.9239e+05, 3.9241e+05],
        [1.5804e+00, 3.9110e+05, 4.1276e+05, 1.6121e+00, 1.5638e+00, 3.9477e+05,
         3.8935e+05, 1.6755e+00, 3.8528e+05, 1.6230e+00, 1.7856e+00, 3.8831e+05,
         3.9239e+05, 0.0000e+00, 1.6994e+00],
        [1.6385e+00, 3.9113e+05, 4.1278e+05, 1.7108e+00, 1.4576e+00, 3.9477e+05,
         3.8934e+05, 1.7590e+00, 3.8528e+05, 1.6663e+00, 1.5792e+00, 3.8829e+05,
         3.9241e+05, 1.6994e+00, 0.0000e+00]])
Krum scores: ['1.66', '391119.84', '412742.94', '1.64', '1.58', '394770.16', '389334.25', '1.72', '385282.00', '1.66', '1.68', '388302.94', '392395.31', '1.63', '1.63']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0119s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:21...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:21, End: 2025-07-22 15:30:21)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [2, 19, 17, 1, 8, 4, 3, 13, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 3.9639e+05, 3.8714e+05, 1.5456e+00, 1.6605e+00, 1.6099e+00,
         1.6234e+00, 3.8730e+05, 1.5812e+00, 4.0363e+05, 1.5691e+00, 1.5271e+00],
        [3.9639e+05, 0.0000e+00, 7.8195e+05, 3.9638e+05, 3.9641e+05, 3.9637e+05,
         3.9636e+05, 7.7488e+05, 3.9634e+05, 7.8921e+05, 3.9641e+05, 3.9637e+05],
        [3.8714e+05, 7.8195e+05, 0.0000e+00, 3.8715e+05, 3.8717e+05, 3.8717e+05,
         3.8715e+05, 7.8400e+05, 3.8715e+05, 7.9903e+05, 3.8719e+05, 3.8719e+05],
        [1.5456e+00, 3.9638e+05, 3.8715e+05, 0.0000e+00, 1.7555e+00, 1.7114e+00,
         1.7233e+00, 3.8729e+05, 1.6729e+00, 4.0364e+05, 1.6101e+00, 1.6248e+00],
        [1.6605e+00, 3.9641e+05, 3.8717e+05, 1.7555e+00, 0.0000e+00, 1.6066e+00,
         1.6495e+00, 3.8731e+05, 1.6792e+00, 4.0366e+05, 1.6274e+00, 1.6404e+00],
        [1.6099e+00, 3.9637e+05, 3.8717e+05, 1.7114e+00, 1.6066e+00, 0.0000e+00,
         1.6596e+00, 3.8728e+05, 1.6232e+00, 4.0362e+05, 1.6722e+00, 1.6086e+00],
        [1.6234e+00, 3.9636e+05, 3.8715e+05, 1.7233e+00, 1.6495e+00, 1.6596e+00,
         0.0000e+00, 3.8728e+05, 1.5804e+00, 4.0363e+05, 1.8850e+00, 1.6166e+00],
        [3.8730e+05, 7.7488e+05, 7.8400e+05, 3.8729e+05, 3.8731e+05, 3.8728e+05,
         3.8728e+05, 0.0000e+00, 3.8726e+05, 8.0658e+05, 3.8726e+05, 3.8725e+05],
        [1.5812e+00, 3.9634e+05, 3.8715e+05, 1.6729e+00, 1.6792e+00, 1.6232e+00,
         1.5804e+00, 3.8726e+05, 0.0000e+00, 4.0367e+05, 1.8382e+00, 1.6386e+00],
        [4.0363e+05, 7.8921e+05, 7.9903e+05, 4.0364e+05, 4.0366e+05, 4.0362e+05,
         4.0363e+05, 8.0658e+05, 4.0367e+05, 0.0000e+00, 4.0362e+05, 4.0362e+05],
        [1.5691e+00, 3.9641e+05, 3.8719e+05, 1.6101e+00, 1.6274e+00, 1.6722e+00,
         1.8850e+00, 3.8726e+05, 1.8382e+00, 4.0362e+05, 0.0000e+00, 1.6352e+00],
        [1.5271e+00, 3.9637e+05, 3.8719e+05, 1.6248e+00, 1.6404e+00, 1.6086e+00,
         1.6166e+00, 3.8725e+05, 1.6386e+00, 4.0362e+05, 1.6352e+00, 0.0000e+00]])
Krum scores: ['1.58', '396367.50', '387151.06', '1.65', '1.64', '1.63', '1.64', '387268.38', '1.63', '403625.44', '1.66', '1.61']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [2, 19, 17, 1, 8, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0025s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:21...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:21, End: 2025-07-22 15:30:21)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 2, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.8062e+00, 3.7998e+05, 3.9427e+05, 1.7515e+00, 1.6965e+00,
         3.8920e+05, 1.8772e+00, 3.9561e+05, 1.6573e+00, 1.7176e+00, 4.0225e+05,
         1.6855e+00, 1.6968e+00, 3.9052e+05, 1.9894e+00, 1.7288e+00],
        [1.8062e+00, 0.0000e+00, 3.7998e+05, 3.9426e+05, 1.6784e+00, 1.6141e+00,
         3.8918e+05, 1.7622e+00, 3.9565e+05, 1.7148e+00, 1.7377e+00, 4.0226e+05,
         1.7597e+00, 1.7076e+00, 3.9051e+05, 1.7570e+00, 1.7026e+00],
        [3.7998e+05, 3.7998e+05, 0.0000e+00, 7.5125e+05, 3.8000e+05, 3.8000e+05,
         7.8688e+05, 3.8003e+05, 7.8594e+05, 3.7998e+05, 3.8002e+05, 7.7857e+05,
         3.7999e+05, 3.8002e+05, 7.6244e+05, 3.8001e+05, 3.8001e+05],
        [3.9427e+05, 3.9426e+05, 7.5125e+05, 0.0000e+00, 3.9425e+05, 3.9428e+05,
         8.0290e+05, 3.9428e+05, 7.8564e+05, 3.9427e+05, 3.9429e+05, 8.0864e+05,
         3.9424e+05, 3.9426e+05, 7.7208e+05, 3.9428e+05, 3.9425e+05],
        [1.7515e+00, 1.6784e+00, 3.8000e+05, 3.9425e+05, 0.0000e+00, 1.6786e+00,
         3.8917e+05, 1.7602e+00, 3.9563e+05, 1.8229e+00, 1.8303e+00, 4.0229e+05,
         1.6799e+00, 1.7849e+00, 3.9052e+05, 1.7260e+00, 1.6833e+00],
        [1.6965e+00, 1.6141e+00, 3.8000e+05, 3.9428e+05, 1.6786e+00, 0.0000e+00,
         3.8917e+05, 1.8371e+00, 3.9564e+05, 1.7101e+00, 1.7167e+00, 4.0222e+05,
         1.7318e+00, 1.6251e+00, 3.9051e+05, 1.8713e+00, 1.7743e+00],
        [3.8920e+05, 3.8918e+05, 7.8688e+05, 8.0290e+05, 3.8917e+05, 3.8917e+05,
         0.0000e+00, 3.8919e+05, 7.8311e+05, 3.8915e+05, 3.8918e+05, 7.8772e+05,
         3.8919e+05, 3.8917e+05, 7.8685e+05, 3.8915e+05, 3.8917e+05],
        [1.8772e+00, 1.7622e+00, 3.8003e+05, 3.9428e+05, 1.7602e+00, 1.8371e+00,
         3.8919e+05, 0.0000e+00, 3.9562e+05, 1.6736e+00, 1.6968e+00, 4.0223e+05,
         1.6718e+00, 1.7536e+00, 3.9050e+05, 1.7544e+00, 1.7194e+00],
        [3.9561e+05, 3.9565e+05, 7.8594e+05, 7.8564e+05, 3.9563e+05, 3.9564e+05,
         7.8311e+05, 3.9562e+05, 0.0000e+00, 3.9564e+05, 3.9563e+05, 8.0794e+05,
         3.9566e+05, 3.9564e+05, 7.7457e+05, 3.9565e+05, 3.9564e+05],
        [1.6573e+00, 1.7148e+00, 3.7998e+05, 3.9427e+05, 1.8229e+00, 1.7101e+00,
         3.8915e+05, 1.6736e+00, 3.9564e+05, 0.0000e+00, 1.6873e+00, 4.0224e+05,
         1.6625e+00, 1.7557e+00, 3.9051e+05, 1.7720e+00, 1.6440e+00],
        [1.7176e+00, 1.7377e+00, 3.8002e+05, 3.9429e+05, 1.8303e+00, 1.7167e+00,
         3.8918e+05, 1.6968e+00, 3.9563e+05, 1.6873e+00, 0.0000e+00, 4.0224e+05,
         1.7921e+00, 1.6527e+00, 3.9047e+05, 1.9695e+00, 1.5911e+00],
        [4.0225e+05, 4.0226e+05, 7.7857e+05, 8.0864e+05, 4.0229e+05, 4.0222e+05,
         7.8772e+05, 4.0223e+05, 8.0794e+05, 4.0224e+05, 4.0224e+05, 0.0000e+00,
         4.0228e+05, 4.0225e+05, 7.8200e+05, 4.0226e+05, 4.0228e+05],
        [1.6855e+00, 1.7597e+00, 3.7999e+05, 3.9424e+05, 1.6799e+00, 1.7318e+00,
         3.8919e+05, 1.6718e+00, 3.9566e+05, 1.6625e+00, 1.7921e+00, 4.0228e+05,
         0.0000e+00, 1.8171e+00, 3.9048e+05, 1.7143e+00, 1.6338e+00],
        [1.6968e+00, 1.7076e+00, 3.8002e+05, 3.9426e+05, 1.7849e+00, 1.6251e+00,
         3.8917e+05, 1.7536e+00, 3.9564e+05, 1.7557e+00, 1.6527e+00, 4.0225e+05,
         1.8171e+00, 0.0000e+00, 3.9053e+05, 1.8799e+00, 1.7017e+00],
        [3.9052e+05, 3.9051e+05, 7.6244e+05, 7.7208e+05, 3.9052e+05, 3.9051e+05,
         7.8685e+05, 3.9050e+05, 7.7457e+05, 3.9051e+05, 3.9047e+05, 7.8200e+05,
         3.9048e+05, 3.9053e+05, 0.0000e+00, 3.9051e+05, 3.9049e+05],
        [1.9894e+00, 1.7570e+00, 3.8001e+05, 3.9428e+05, 1.7260e+00, 1.8713e+00,
         3.8915e+05, 1.7544e+00, 3.9565e+05, 1.7720e+00, 1.9695e+00, 4.0226e+05,
         1.7143e+00, 1.8799e+00, 3.9051e+05, 0.0000e+00, 1.6801e+00],
        [1.7288e+00, 1.7026e+00, 3.8001e+05, 3.9425e+05, 1.6833e+00, 1.7743e+00,
         3.8917e+05, 1.7194e+00, 3.9564e+05, 1.6440e+00, 1.5911e+00, 4.0228e+05,
         1.6338e+00, 1.7017e+00, 3.9049e+05, 1.6801e+00, 0.0000e+00]])
Krum scores: ['1.74', '1.71', '379997.72', '394262.41', '1.73', '1.71', '389170.88', '1.74', '395633.50', '1.70', '1.71', '402248.84', '1.70', '1.72', '390499.72', '1.79', '1.68']
Selected index: 16
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:22...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[188  49]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:22, End: 2025-07-22 15:30:22)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 17, 1, 20, 18, 8, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.7954e+00, 1.7926e+00, 4.0046e+05, 1.7869e+00, 3.8803e+05,
         3.8153e+05, 1.9597e+00, 1.8050e+00, 3.8665e+05, 3.9601e+05, 1.7000e+00,
         1.8099e+00, 3.8872e+05, 1.9846e+00, 1.7090e+00],
        [1.7954e+00, 0.0000e+00, 1.6709e+00, 4.0047e+05, 1.7029e+00, 3.8801e+05,
         3.8156e+05, 1.8509e+00, 1.8533e+00, 3.8666e+05, 3.9601e+05, 1.6967e+00,
         1.8238e+00, 3.8869e+05, 1.9521e+00, 1.8076e+00],
        [1.7926e+00, 1.6709e+00, 0.0000e+00, 4.0047e+05, 1.6450e+00, 3.8801e+05,
         3.8156e+05, 1.8494e+00, 1.6664e+00, 3.8661e+05, 3.9601e+05, 1.7689e+00,
         1.6644e+00, 3.8871e+05, 1.7497e+00, 1.6742e+00],
        [4.0046e+05, 4.0047e+05, 4.0047e+05, 0.0000e+00, 4.0045e+05, 8.1084e+05,
         8.0666e+05, 4.0046e+05, 4.0048e+05, 8.0113e+05, 8.0086e+05, 4.0045e+05,
         4.0051e+05, 7.9074e+05, 4.0050e+05, 4.0050e+05],
        [1.7869e+00, 1.7029e+00, 1.6450e+00, 4.0045e+05, 0.0000e+00, 3.8800e+05,
         3.8155e+05, 1.8052e+00, 1.8309e+00, 3.8660e+05, 3.9600e+05, 1.6484e+00,
         1.7834e+00, 3.8874e+05, 1.6852e+00, 1.7654e+00],
        [3.8803e+05, 3.8801e+05, 3.8801e+05, 8.1084e+05, 3.8800e+05, 0.0000e+00,
         7.6660e+05, 3.8801e+05, 3.8801e+05, 7.9299e+05, 7.9067e+05, 3.8800e+05,
         3.8801e+05, 7.8363e+05, 3.8805e+05, 3.8801e+05],
        [3.8153e+05, 3.8156e+05, 3.8156e+05, 8.0666e+05, 3.8155e+05, 7.6660e+05,
         0.0000e+00, 3.8157e+05, 3.8155e+05, 7.7679e+05, 7.7981e+05, 3.8156e+05,
         3.8153e+05, 7.7517e+05, 3.8152e+05, 3.8153e+05],
        [1.9597e+00, 1.8509e+00, 1.8494e+00, 4.0046e+05, 1.8052e+00, 3.8801e+05,
         3.8157e+05, 0.0000e+00, 1.7707e+00, 3.8666e+05, 3.9597e+05, 1.7841e+00,
         1.8389e+00, 3.8869e+05, 1.8031e+00, 1.8546e+00],
        [1.8050e+00, 1.8533e+00, 1.6664e+00, 4.0048e+05, 1.8309e+00, 3.8801e+05,
         3.8155e+05, 1.7707e+00, 0.0000e+00, 3.8665e+05, 3.9596e+05, 1.8413e+00,
         1.6902e+00, 3.8872e+05, 1.9564e+00, 1.7202e+00],
        [3.8665e+05, 3.8666e+05, 3.8661e+05, 8.0113e+05, 3.8660e+05, 7.9299e+05,
         7.7679e+05, 3.8666e+05, 3.8665e+05, 0.0000e+00, 7.6872e+05, 3.8661e+05,
         3.8661e+05, 7.9994e+05, 3.8662e+05, 3.8662e+05],
        [3.9601e+05, 3.9601e+05, 3.9601e+05, 8.0086e+05, 3.9600e+05, 7.9067e+05,
         7.7981e+05, 3.9597e+05, 3.9596e+05, 7.6872e+05, 0.0000e+00, 3.9600e+05,
         3.9600e+05, 7.8403e+05, 3.9602e+05, 3.9600e+05],
        [1.7000e+00, 1.6967e+00, 1.7689e+00, 4.0045e+05, 1.6484e+00, 3.8800e+05,
         3.8156e+05, 1.7841e+00, 1.8413e+00, 3.8661e+05, 3.9600e+05, 0.0000e+00,
         1.7828e+00, 3.8871e+05, 1.7367e+00, 1.8281e+00],
        [1.8099e+00, 1.8238e+00, 1.6644e+00, 4.0051e+05, 1.7834e+00, 3.8801e+05,
         3.8153e+05, 1.8389e+00, 1.6902e+00, 3.8661e+05, 3.9600e+05, 1.7828e+00,
         0.0000e+00, 3.8872e+05, 1.9189e+00, 1.7563e+00],
        [3.8872e+05, 3.8869e+05, 3.8871e+05, 7.9074e+05, 3.8874e+05, 7.8363e+05,
         7.7517e+05, 3.8869e+05, 3.8872e+05, 7.9994e+05, 7.8403e+05, 3.8871e+05,
         3.8872e+05, 0.0000e+00, 3.8871e+05, 3.8869e+05],
        [1.9846e+00, 1.9521e+00, 1.7497e+00, 4.0050e+05, 1.6852e+00, 3.8805e+05,
         3.8152e+05, 1.8031e+00, 1.9564e+00, 3.8662e+05, 3.9602e+05, 1.7367e+00,
         1.9189e+00, 3.8871e+05, 0.0000e+00, 1.9173e+00],
        [1.7090e+00, 1.8076e+00, 1.6742e+00, 4.0050e+05, 1.7654e+00, 3.8801e+05,
         3.8153e+05, 1.8546e+00, 1.7202e+00, 3.8662e+05, 3.9600e+05, 1.8281e+00,
         1.7563e+00, 3.8869e+05, 1.9173e+00, 0.0000e+00]])
Krum scores: ['1.79', '1.78', '1.70', '400465.56', '1.73', '388008.84', '381540.19', '1.82', '1.77', '386621.47', '395993.38', '1.74', '1.77', '388706.44', '1.84', '1.76']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 17, 1, 20, 18, 8, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:22...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:22, End: 2025-07-22 15:30:22)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 17, 1, 9, 8, 15, 3, 13, 11, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.5735e+00, 1.7297e+00, 4.0666e+05, 1.5257e+00, 1.5846e+00,
         1.7273e+00, 3.9533e+05, 1.5484e+00, 3.8272e+05, 1.4844e+00, 1.5864e+00,
         3.9367e+05, 1.7766e+00, 1.4796e+00],
        [1.5735e+00, 0.0000e+00, 1.7729e+00, 4.0664e+05, 1.5170e+00, 1.6893e+00,
         1.6687e+00, 3.9534e+05, 1.6579e+00, 3.8277e+05, 1.5354e+00, 1.6285e+00,
         3.9365e+05, 1.7288e+00, 1.5936e+00],
        [1.7297e+00, 1.7729e+00, 0.0000e+00, 4.0663e+05, 1.7021e+00, 1.5346e+00,
         1.8605e+00, 3.9534e+05, 1.6753e+00, 3.8271e+05, 1.7986e+00, 1.6936e+00,
         3.9365e+05, 1.8243e+00, 1.5641e+00],
        [4.0666e+05, 4.0664e+05, 4.0663e+05, 0.0000e+00, 4.0662e+05, 4.0661e+05,
         4.0661e+05, 8.0532e+05, 4.0663e+05, 7.9102e+05, 4.0663e+05, 4.0658e+05,
         8.0660e+05, 4.0662e+05, 4.0662e+05],
        [1.5257e+00, 1.5170e+00, 1.7021e+00, 4.0662e+05, 0.0000e+00, 1.5288e+00,
         1.5877e+00, 3.9532e+05, 1.6075e+00, 3.8276e+05, 1.4649e+00, 1.5997e+00,
         3.9362e+05, 1.4844e+00, 1.4968e+00],
        [1.5846e+00, 1.6893e+00, 1.5346e+00, 4.0661e+05, 1.5288e+00, 0.0000e+00,
         1.7306e+00, 3.9532e+05, 1.5769e+00, 3.8274e+05, 1.5875e+00, 1.5575e+00,
         3.9366e+05, 1.7260e+00, 1.5153e+00],
        [1.7273e+00, 1.6687e+00, 1.8605e+00, 4.0661e+05, 1.5877e+00, 1.7306e+00,
         0.0000e+00, 3.9532e+05, 1.5234e+00, 3.8278e+05, 1.5850e+00, 1.6180e+00,
         3.9365e+05, 1.5738e+00, 1.6099e+00],
        [3.9533e+05, 3.9534e+05, 3.9534e+05, 8.0532e+05, 3.9532e+05, 3.9532e+05,
         3.9532e+05, 0.0000e+00, 3.9530e+05, 8.0100e+05, 3.9536e+05, 3.9531e+05,
         7.8035e+05, 3.9532e+05, 3.9531e+05],
        [1.5484e+00, 1.6579e+00, 1.6753e+00, 4.0663e+05, 1.6075e+00, 1.5769e+00,
         1.5234e+00, 3.9530e+05, 0.0000e+00, 3.8272e+05, 1.5964e+00, 1.5211e+00,
         3.9367e+05, 1.7675e+00, 1.4260e+00],
        [3.8272e+05, 3.8277e+05, 3.8271e+05, 7.9102e+05, 3.8276e+05, 3.8274e+05,
         3.8278e+05, 8.0100e+05, 3.8272e+05, 0.0000e+00, 3.8274e+05, 3.8274e+05,
         8.0498e+05, 3.8274e+05, 3.8272e+05],
        [1.4844e+00, 1.5354e+00, 1.7986e+00, 4.0663e+05, 1.4649e+00, 1.5875e+00,
         1.5850e+00, 3.9536e+05, 1.5964e+00, 3.8274e+05, 0.0000e+00, 1.6840e+00,
         3.9364e+05, 1.5719e+00, 1.5353e+00],
        [1.5864e+00, 1.6285e+00, 1.6936e+00, 4.0658e+05, 1.5997e+00, 1.5575e+00,
         1.6180e+00, 3.9531e+05, 1.5211e+00, 3.8274e+05, 1.6840e+00, 0.0000e+00,
         3.9368e+05, 1.7112e+00, 1.4649e+00],
        [3.9367e+05, 3.9365e+05, 3.9365e+05, 8.0660e+05, 3.9362e+05, 3.9366e+05,
         3.9365e+05, 7.8035e+05, 3.9367e+05, 8.0498e+05, 3.9364e+05, 3.9368e+05,
         0.0000e+00, 3.9365e+05, 3.9364e+05],
        [1.7766e+00, 1.7288e+00, 1.8243e+00, 4.0662e+05, 1.4844e+00, 1.7260e+00,
         1.5738e+00, 3.9532e+05, 1.7675e+00, 3.8274e+05, 1.5719e+00, 1.7112e+00,
         3.9365e+05, 0.0000e+00, 1.6049e+00],
        [1.4796e+00, 1.5936e+00, 1.5641e+00, 4.0662e+05, 1.4968e+00, 1.5153e+00,
         1.6099e+00, 3.9531e+05, 1.4260e+00, 3.8272e+05, 1.5353e+00, 1.4649e+00,
         3.9364e+05, 1.6049e+00, 0.0000e+00]])
Krum scores: ['1.58', '1.62', '1.70', '406617.78', '1.53', '1.59', '1.62', '395319.88', '1.57', '382731.47', '1.56', '1.59', '393647.59', '1.66', '1.52']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 17, 1, 9, 8, 15, 3, 13, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:23...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:23, End: 2025-07-22 15:30:23)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.5847e+00, 1.5407e+00, 3.9148e+05, 3.8419e+05, 1.4903e+00,
         4.0737e+05, 3.8953e+05, 1.6380e+00, 3.9752e+05, 1.4797e+00, 1.5139e+00,
         3.8993e+05, 3.8428e+05, 1.5444e+00, 4.0922e+05, 1.6710e+00],
        [1.5847e+00, 0.0000e+00, 1.5385e+00, 3.9147e+05, 3.8420e+05, 1.4458e+00,
         4.0736e+05, 3.8953e+05, 1.5654e+00, 3.9756e+05, 1.5274e+00, 1.5721e+00,
         3.8997e+05, 3.8426e+05, 1.4862e+00, 4.0918e+05, 1.5786e+00],
        [1.5407e+00, 1.5385e+00, 0.0000e+00, 3.9151e+05, 3.8421e+05, 1.5118e+00,
         4.0737e+05, 3.8951e+05, 1.6690e+00, 3.9755e+05, 1.4775e+00, 1.5402e+00,
         3.8996e+05, 3.8424e+05, 1.4419e+00, 4.0921e+05, 1.5777e+00],
        [3.9148e+05, 3.9147e+05, 3.9151e+05, 0.0000e+00, 7.6377e+05, 3.9151e+05,
         7.6090e+05, 7.9219e+05, 3.9149e+05, 7.7144e+05, 3.9146e+05, 3.9150e+05,
         7.7884e+05, 7.7965e+05, 3.9152e+05, 8.0997e+05, 3.9148e+05],
        [3.8419e+05, 3.8420e+05, 3.8421e+05, 7.6377e+05, 0.0000e+00, 3.8421e+05,
         7.9156e+05, 7.7078e+05, 3.8419e+05, 7.8481e+05, 3.8419e+05, 3.8417e+05,
         7.8801e+05, 7.8193e+05, 3.8420e+05, 7.9762e+05, 3.8421e+05],
        [1.4903e+00, 1.4458e+00, 1.5118e+00, 3.9151e+05, 3.8421e+05, 0.0000e+00,
         4.0740e+05, 3.8956e+05, 1.5299e+00, 3.9753e+05, 1.5483e+00, 1.4940e+00,
         3.8996e+05, 3.8428e+05, 1.5058e+00, 4.0921e+05, 1.3950e+00],
        [4.0737e+05, 4.0736e+05, 4.0737e+05, 7.6090e+05, 7.9156e+05, 4.0740e+05,
         0.0000e+00, 8.0576e+05, 4.0737e+05, 8.0008e+05, 4.0735e+05, 4.0737e+05,
         8.3227e+05, 7.9162e+05, 4.0735e+05, 8.4086e+05, 4.0734e+05],
        [3.8953e+05, 3.8953e+05, 3.8951e+05, 7.9219e+05, 7.7078e+05, 3.8956e+05,
         8.0576e+05, 0.0000e+00, 3.8952e+05, 8.0471e+05, 3.8954e+05, 3.8954e+05,
         7.6709e+05, 7.6888e+05, 3.8955e+05, 7.8305e+05, 3.8954e+05],
        [1.6380e+00, 1.5654e+00, 1.6690e+00, 3.9149e+05, 3.8419e+05, 1.5299e+00,
         4.0737e+05, 3.8952e+05, 0.0000e+00, 3.9753e+05, 1.5148e+00, 1.5099e+00,
         3.8995e+05, 3.8428e+05, 1.5075e+00, 4.0921e+05, 1.4412e+00],
        [3.9752e+05, 3.9756e+05, 3.9755e+05, 7.7144e+05, 7.8481e+05, 3.9753e+05,
         8.0008e+05, 8.0471e+05, 3.9753e+05, 0.0000e+00, 3.9754e+05, 3.9753e+05,
         7.8875e+05, 7.8811e+05, 3.9754e+05, 8.1043e+05, 3.9755e+05],
        [1.4797e+00, 1.5274e+00, 1.4775e+00, 3.9146e+05, 3.8419e+05, 1.5483e+00,
         4.0735e+05, 3.8954e+05, 1.5148e+00, 3.9754e+05, 0.0000e+00, 1.5085e+00,
         3.8996e+05, 3.8425e+05, 1.6449e+00, 4.0922e+05, 1.4967e+00],
        [1.5139e+00, 1.5721e+00, 1.5402e+00, 3.9150e+05, 3.8417e+05, 1.4940e+00,
         4.0737e+05, 3.8954e+05, 1.5099e+00, 3.9753e+05, 1.5085e+00, 0.0000e+00,
         3.8998e+05, 3.8426e+05, 1.4670e+00, 4.0922e+05, 1.6310e+00],
        [3.8993e+05, 3.8997e+05, 3.8996e+05, 7.7884e+05, 7.8801e+05, 3.8996e+05,
         8.3227e+05, 7.6709e+05, 3.8995e+05, 7.8875e+05, 3.8996e+05, 3.8998e+05,
         0.0000e+00, 7.7921e+05, 3.8994e+05, 7.8789e+05, 3.8994e+05],
        [3.8428e+05, 3.8426e+05, 3.8424e+05, 7.7965e+05, 7.8193e+05, 3.8428e+05,
         7.9162e+05, 7.6888e+05, 3.8428e+05, 7.8811e+05, 3.8425e+05, 3.8426e+05,
         7.7921e+05, 0.0000e+00, 3.8427e+05, 7.9400e+05, 3.8423e+05],
        [1.5444e+00, 1.4862e+00, 1.4419e+00, 3.9152e+05, 3.8420e+05, 1.5058e+00,
         4.0735e+05, 3.8955e+05, 1.5075e+00, 3.9754e+05, 1.6449e+00, 1.4670e+00,
         3.8994e+05, 3.8427e+05, 0.0000e+00, 4.0923e+05, 1.5459e+00],
        [4.0922e+05, 4.0918e+05, 4.0921e+05, 8.0997e+05, 7.9762e+05, 4.0921e+05,
         8.4086e+05, 7.8305e+05, 4.0921e+05, 8.1043e+05, 4.0922e+05, 4.0922e+05,
         7.8789e+05, 7.9400e+05, 4.0923e+05, 0.0000e+00, 4.0919e+05],
        [1.6710e+00, 1.5786e+00, 1.5777e+00, 3.9148e+05, 3.8421e+05, 1.3950e+00,
         4.0734e+05, 3.8954e+05, 1.4412e+00, 3.9755e+05, 1.4967e+00, 1.6310e+00,
         3.8994e+05, 3.8423e+05, 1.5459e+00, 4.0919e+05, 0.0000e+00]])
Krum scores: ['1.54', '1.53', '1.52', '391485.25', '384192.03', '1.48', '407357.22', '389529.03', '1.53', '397532.62', '1.51', '1.52', '389946.69', '384254.16', '1.50', '409204.94', '1.52']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0179s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:24...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:30:24, End: 2025-07-22 15:30:24)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.7579e+00, 1.6535e+00, 3.8844e+05, 3.8265e+05, 1.6682e+00,
         1.5912e+00, 3.9590e+05, 3.9480e+05, 1.8422e+00, 3.8254e+05, 1.6476e+00,
         4.0798e+05, 3.7579e+05, 1.5497e+00, 1.5805e+00, 3.9664e+05, 1.8335e+00,
         1.6272e+00],
        [1.7579e+00, 0.0000e+00, 1.6275e+00, 3.8845e+05, 3.8264e+05, 1.8443e+00,
         1.6571e+00, 3.9593e+05, 3.9478e+05, 1.7108e+00, 3.8254e+05, 1.6422e+00,
         4.0800e+05, 3.7576e+05, 1.5993e+00, 1.6377e+00, 3.9660e+05, 1.8094e+00,
         1.8081e+00],
        [1.6535e+00, 1.6275e+00, 0.0000e+00, 3.8846e+05, 3.8263e+05, 1.5811e+00,
         1.4404e+00, 3.9590e+05, 3.9478e+05, 1.7758e+00, 3.8255e+05, 1.5478e+00,
         4.0798e+05, 3.7580e+05, 1.7073e+00, 1.5432e+00, 3.9662e+05, 1.6279e+00,
         1.4049e+00],
        [3.8844e+05, 3.8845e+05, 3.8846e+05, 0.0000e+00, 7.8408e+05, 3.8846e+05,
         3.8845e+05, 8.0001e+05, 7.7622e+05, 3.8844e+05, 7.8611e+05, 3.8844e+05,
         7.9917e+05, 7.6887e+05, 3.8844e+05, 3.8846e+05, 7.8490e+05, 3.8842e+05,
         3.8843e+05],
        [3.8265e+05, 3.8264e+05, 3.8263e+05, 7.8408e+05, 0.0000e+00, 3.8265e+05,
         3.8262e+05, 7.8037e+05, 7.7216e+05, 3.8267e+05, 7.7125e+05, 3.8265e+05,
         7.8089e+05, 7.3892e+05, 3.8261e+05, 3.8263e+05, 7.7162e+05, 3.8267e+05,
         3.8265e+05],
        [1.6682e+00, 1.8443e+00, 1.5811e+00, 3.8846e+05, 3.8265e+05, 0.0000e+00,
         1.5352e+00, 3.9590e+05, 3.9480e+05, 1.8876e+00, 3.8256e+05, 1.8210e+00,
         4.0800e+05, 3.7579e+05, 1.7722e+00, 1.6980e+00, 3.9664e+05, 1.7819e+00,
         1.6377e+00],
        [1.5912e+00, 1.6571e+00, 1.4404e+00, 3.8845e+05, 3.8262e+05, 1.5352e+00,
         0.0000e+00, 3.9589e+05, 3.9477e+05, 1.7438e+00, 3.8257e+05, 1.6422e+00,
         4.0795e+05, 3.7578e+05, 1.5600e+00, 1.5268e+00, 3.9663e+05, 1.6773e+00,
         1.5399e+00],
        [3.9590e+05, 3.9593e+05, 3.9590e+05, 8.0001e+05, 7.8037e+05, 3.9590e+05,
         3.9589e+05, 0.0000e+00, 7.9374e+05, 3.9585e+05, 7.7530e+05, 3.9591e+05,
         8.0823e+05, 7.5369e+05, 3.9589e+05, 3.9590e+05, 7.9764e+05, 3.9592e+05,
         3.9592e+05],
        [3.9480e+05, 3.9478e+05, 3.9478e+05, 7.7622e+05, 7.7216e+05, 3.9480e+05,
         3.9477e+05, 7.9374e+05, 0.0000e+00, 3.9479e+05, 7.6851e+05, 3.9481e+05,
         8.0714e+05, 7.7112e+05, 3.9478e+05, 3.9483e+05, 7.6487e+05, 3.9478e+05,
         3.9480e+05],
        [1.8422e+00, 1.7108e+00, 1.7758e+00, 3.8844e+05, 3.8267e+05, 1.8876e+00,
         1.7438e+00, 3.9585e+05, 3.9479e+05, 0.0000e+00, 3.8254e+05, 1.6480e+00,
         4.0799e+05, 3.7575e+05, 1.6841e+00, 1.6839e+00, 3.9659e+05, 1.6417e+00,
         1.8184e+00],
        [3.8254e+05, 3.8254e+05, 3.8255e+05, 7.8611e+05, 7.7125e+05, 3.8256e+05,
         3.8257e+05, 7.7530e+05, 7.6851e+05, 3.8254e+05, 0.0000e+00, 3.8254e+05,
         7.6325e+05, 7.5433e+05, 3.8252e+05, 3.8259e+05, 7.7451e+05, 3.8254e+05,
         3.8254e+05],
        [1.6476e+00, 1.6422e+00, 1.5478e+00, 3.8844e+05, 3.8265e+05, 1.8210e+00,
         1.6422e+00, 3.9591e+05, 3.9481e+05, 1.6480e+00, 3.8254e+05, 0.0000e+00,
         4.0800e+05, 3.7576e+05, 1.5751e+00, 1.7536e+00, 3.9663e+05, 1.7034e+00,
         1.6646e+00],
        [4.0798e+05, 4.0800e+05, 4.0798e+05, 7.9917e+05, 7.8089e+05, 4.0800e+05,
         4.0795e+05, 8.0823e+05, 8.0714e+05, 4.0799e+05, 7.6325e+05, 4.0800e+05,
         0.0000e+00, 7.9998e+05, 4.0800e+05, 4.0799e+05, 7.9120e+05, 4.0797e+05,
         4.0798e+05],
        [3.7579e+05, 3.7576e+05, 3.7580e+05, 7.6887e+05, 7.3892e+05, 3.7579e+05,
         3.7578e+05, 7.5369e+05, 7.7112e+05, 3.7575e+05, 7.5433e+05, 3.7576e+05,
         7.9998e+05, 0.0000e+00, 3.7578e+05, 3.7579e+05, 7.8319e+05, 3.7580e+05,
         3.7578e+05],
        [1.5497e+00, 1.5993e+00, 1.7073e+00, 3.8844e+05, 3.8261e+05, 1.7722e+00,
         1.5600e+00, 3.9589e+05, 3.9478e+05, 1.6841e+00, 3.8252e+05, 1.5751e+00,
         4.0800e+05, 3.7578e+05, 0.0000e+00, 1.6818e+00, 3.9661e+05, 1.5727e+00,
         1.7559e+00],
        [1.5805e+00, 1.6377e+00, 1.5432e+00, 3.8846e+05, 3.8263e+05, 1.6980e+00,
         1.5268e+00, 3.9590e+05, 3.9483e+05, 1.6839e+00, 3.8259e+05, 1.7536e+00,
         4.0799e+05, 3.7579e+05, 1.6818e+00, 0.0000e+00, 3.9664e+05, 1.7320e+00,
         1.5482e+00],
        [3.9664e+05, 3.9660e+05, 3.9662e+05, 7.8490e+05, 7.7162e+05, 3.9664e+05,
         3.9663e+05, 7.9764e+05, 7.6487e+05, 3.9659e+05, 7.7451e+05, 3.9663e+05,
         7.9120e+05, 7.8319e+05, 3.9661e+05, 3.9664e+05, 0.0000e+00, 3.9663e+05,
         3.9662e+05],
        [1.8335e+00, 1.8094e+00, 1.6279e+00, 3.8842e+05, 3.8267e+05, 1.7819e+00,
         1.6773e+00, 3.9592e+05, 3.9478e+05, 1.6417e+00, 3.8254e+05, 1.7034e+00,
         4.0797e+05, 3.7580e+05, 1.5727e+00, 1.7320e+00, 3.9663e+05, 0.0000e+00,
         1.7886e+00],
        [1.6272e+00, 1.8081e+00, 1.4049e+00, 3.8843e+05, 3.8265e+05, 1.6377e+00,
         1.5399e+00, 3.9592e+05, 3.9480e+05, 1.8184e+00, 3.8254e+05, 1.6646e+00,
         4.0798e+05, 3.7578e+05, 1.7559e+00, 1.5482e+00, 3.9662e+05, 1.7886e+00,
         0.0000e+00]])
Krum scores: ['1.66', '1.69', '1.57', '388440.12', '382636.09', '1.70', '1.57', '395895.66', '394788.78', '1.73', '382541.38', '1.65', '407984.00', '375775.19', '1.63', '1.63', '396620.12', '1.70', '1.64']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0249s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:24...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:24, End: 2025-07-22 15:30:24)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 19, 17, 1, 9, 18, 8, 15, 14, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.3938e+00, 1.7105e+00, 3.9414e+05, 3.8905e+05, 1.3057e+00,
         1.3881e+00, 4.0119e+05, 1.4344e+00, 4.0080e+05, 3.9511e+05, 1.3198e+00,
         3.8548e+05, 1.5051e+00],
        [1.3938e+00, 0.0000e+00, 1.8172e+00, 3.9416e+05, 3.8909e+05, 1.4567e+00,
         1.4136e+00, 4.0122e+05, 1.4012e+00, 4.0077e+05, 3.9511e+05, 1.3423e+00,
         3.8547e+05, 1.4737e+00],
        [1.7105e+00, 1.8172e+00, 0.0000e+00, 3.9415e+05, 3.8905e+05, 1.4996e+00,
         1.5138e+00, 4.0121e+05, 1.9235e+00, 4.0079e+05, 3.9511e+05, 1.6524e+00,
         3.8549e+05, 1.8194e+00],
        [3.9414e+05, 3.9416e+05, 3.9415e+05, 0.0000e+00, 7.7035e+05, 3.9414e+05,
         3.9413e+05, 7.9800e+05, 3.9416e+05, 8.1348e+05, 7.9563e+05, 3.9417e+05,
         7.7556e+05, 3.9415e+05],
        [3.8905e+05, 3.8909e+05, 3.8905e+05, 7.7035e+05, 0.0000e+00, 3.8908e+05,
         3.8905e+05, 7.9374e+05, 3.8910e+05, 7.9990e+05, 7.7750e+05, 3.8909e+05,
         7.8963e+05, 3.8907e+05],
        [1.3057e+00, 1.4567e+00, 1.4996e+00, 3.9414e+05, 3.8908e+05, 0.0000e+00,
         1.2462e+00, 4.0124e+05, 1.4554e+00, 4.0078e+05, 3.9511e+05, 1.3703e+00,
         3.8549e+05, 1.3956e+00],
        [1.3881e+00, 1.4136e+00, 1.5138e+00, 3.9413e+05, 3.8905e+05, 1.2462e+00,
         0.0000e+00, 4.0124e+05, 1.4955e+00, 4.0078e+05, 3.9514e+05, 1.3064e+00,
         3.8548e+05, 1.5024e+00],
        [4.0119e+05, 4.0122e+05, 4.0121e+05, 7.9800e+05, 7.9374e+05, 4.0124e+05,
         4.0124e+05, 0.0000e+00, 4.0122e+05, 8.1174e+05, 7.8983e+05, 4.0121e+05,
         7.7233e+05, 4.0121e+05],
        [1.4344e+00, 1.4012e+00, 1.9235e+00, 3.9416e+05, 3.8910e+05, 1.4554e+00,
         1.4955e+00, 4.0122e+05, 0.0000e+00, 4.0077e+05, 3.9515e+05, 1.3551e+00,
         3.8548e+05, 1.3740e+00],
        [4.0080e+05, 4.0077e+05, 4.0079e+05, 8.1348e+05, 7.9990e+05, 4.0078e+05,
         4.0078e+05, 8.1174e+05, 4.0077e+05, 0.0000e+00, 7.8713e+05, 4.0081e+05,
         7.9773e+05, 4.0077e+05],
        [3.9511e+05, 3.9511e+05, 3.9511e+05, 7.9563e+05, 7.7750e+05, 3.9511e+05,
         3.9514e+05, 7.8983e+05, 3.9515e+05, 7.8713e+05, 0.0000e+00, 3.9513e+05,
         7.7869e+05, 3.9510e+05],
        [1.3198e+00, 1.3423e+00, 1.6524e+00, 3.9417e+05, 3.8909e+05, 1.3703e+00,
         1.3064e+00, 4.0121e+05, 1.3551e+00, 4.0081e+05, 3.9513e+05, 0.0000e+00,
         3.8546e+05, 1.4557e+00],
        [3.8548e+05, 3.8547e+05, 3.8549e+05, 7.7556e+05, 7.8963e+05, 3.8549e+05,
         3.8548e+05, 7.7233e+05, 3.8548e+05, 7.9773e+05, 7.7869e+05, 3.8546e+05,
         0.0000e+00, 3.8549e+05],
        [1.5051e+00, 1.4737e+00, 1.8194e+00, 3.9415e+05, 3.8907e+05, 1.3956e+00,
         1.5024e+00, 4.0121e+05, 1.3740e+00, 4.0077e+05, 3.9510e+05, 1.4557e+00,
         3.8549e+05, 0.0000e+00]])
Krum scores: ['1.39', '1.41', '1.67', '394143.72', '389066.06', '1.37', '1.39', '401209.44', '1.42', '400775.69', '395110.66', '1.36', '385476.22', '1.45']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 18, 8, 15, 14, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0217s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:25...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:25, End: 2025-07-22 15:30:25)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5337e+00, 1.5453e+00, 3.8493e+05, 3.8272e+05, 1.4263e+00,
         3.9520e+05, 3.9020e+05, 1.5758e+00, 3.8645e+05, 1.4218e+00, 3.8174e+05,
         1.5975e+00, 3.9642e+05, 1.6384e+00, 1.4340e+00],
        [1.5337e+00, 0.0000e+00, 1.5933e+00, 3.8494e+05, 3.8277e+05, 1.5247e+00,
         3.9517e+05, 3.9020e+05, 1.4697e+00, 3.8643e+05, 1.4898e+00, 3.8174e+05,
         1.7621e+00, 3.9639e+05, 1.5006e+00, 1.5930e+00],
        [1.5453e+00, 1.5933e+00, 0.0000e+00, 3.8493e+05, 3.8275e+05, 1.3711e+00,
         3.9521e+05, 3.9025e+05, 1.6997e+00, 3.8642e+05, 1.4943e+00, 3.8176e+05,
         1.4027e+00, 3.9638e+05, 1.6084e+00, 1.2663e+00],
        [3.8493e+05, 3.8494e+05, 3.8493e+05, 0.0000e+00, 7.7021e+05, 3.8491e+05,
         7.7418e+05, 7.7662e+05, 3.8490e+05, 7.5447e+05, 3.8493e+05, 7.7652e+05,
         3.8493e+05, 7.6900e+05, 3.8495e+05, 3.8492e+05],
        [3.8272e+05, 3.8277e+05, 3.8275e+05, 7.7021e+05, 0.0000e+00, 3.8277e+05,
         7.7803e+05, 7.6386e+05, 3.8275e+05, 7.7621e+05, 3.8278e+05, 7.7257e+05,
         3.8277e+05, 7.6109e+05, 3.8277e+05, 3.8277e+05],
        [1.4263e+00, 1.5247e+00, 1.3711e+00, 3.8491e+05, 3.8277e+05, 0.0000e+00,
         3.9519e+05, 3.9026e+05, 1.5617e+00, 3.8644e+05, 1.4778e+00, 3.8174e+05,
         1.6144e+00, 3.9638e+05, 1.4748e+00, 1.3945e+00],
        [3.9520e+05, 3.9517e+05, 3.9521e+05, 7.7418e+05, 7.7803e+05, 3.9519e+05,
         0.0000e+00, 7.9485e+05, 3.9519e+05, 7.8072e+05, 3.9520e+05, 8.0202e+05,
         3.9518e+05, 8.0080e+05, 3.9518e+05, 3.9519e+05],
        [3.9020e+05, 3.9020e+05, 3.9025e+05, 7.7662e+05, 7.6386e+05, 3.9026e+05,
         7.9485e+05, 0.0000e+00, 3.9021e+05, 7.6748e+05, 3.9020e+05, 7.7121e+05,
         3.9020e+05, 7.8678e+05, 3.9021e+05, 3.9022e+05],
        [1.5758e+00, 1.4697e+00, 1.6997e+00, 3.8490e+05, 3.8275e+05, 1.5617e+00,
         3.9519e+05, 3.9021e+05, 0.0000e+00, 3.8642e+05, 1.4126e+00, 3.8171e+05,
         1.8557e+00, 3.9641e+05, 1.3744e+00, 1.6147e+00],
        [3.8645e+05, 3.8643e+05, 3.8642e+05, 7.5447e+05, 7.7621e+05, 3.8644e+05,
         7.8072e+05, 7.6748e+05, 3.8642e+05, 0.0000e+00, 3.8643e+05, 7.9296e+05,
         3.8642e+05, 7.8858e+05, 3.8645e+05, 3.8644e+05],
        [1.4218e+00, 1.4898e+00, 1.4943e+00, 3.8493e+05, 3.8278e+05, 1.4778e+00,
         3.9520e+05, 3.9020e+05, 1.4126e+00, 3.8643e+05, 0.0000e+00, 3.8175e+05,
         1.5745e+00, 3.9641e+05, 1.5415e+00, 1.4445e+00],
        [3.8174e+05, 3.8174e+05, 3.8176e+05, 7.7652e+05, 7.7257e+05, 3.8174e+05,
         8.0202e+05, 7.7121e+05, 3.8171e+05, 7.9296e+05, 3.8175e+05, 0.0000e+00,
         3.8174e+05, 7.7592e+05, 3.8172e+05, 3.8174e+05],
        [1.5975e+00, 1.7621e+00, 1.4027e+00, 3.8493e+05, 3.8277e+05, 1.6144e+00,
         3.9518e+05, 3.9020e+05, 1.8557e+00, 3.8642e+05, 1.5745e+00, 3.8174e+05,
         0.0000e+00, 3.9638e+05, 1.8044e+00, 1.3920e+00],
        [3.9642e+05, 3.9639e+05, 3.9638e+05, 7.6900e+05, 7.6109e+05, 3.9638e+05,
         8.0080e+05, 7.8678e+05, 3.9641e+05, 7.8858e+05, 3.9641e+05, 7.7592e+05,
         3.9638e+05, 0.0000e+00, 3.9638e+05, 3.9640e+05],
        [1.6384e+00, 1.5006e+00, 1.6084e+00, 3.8495e+05, 3.8277e+05, 1.4748e+00,
         3.9518e+05, 3.9021e+05, 1.3744e+00, 3.8645e+05, 1.5415e+00, 3.8172e+05,
         1.8044e+00, 3.9638e+05, 0.0000e+00, 1.5684e+00],
        [1.4340e+00, 1.5930e+00, 1.2663e+00, 3.8492e+05, 3.8277e+05, 1.3945e+00,
         3.9519e+05, 3.9022e+05, 1.6147e+00, 3.8644e+05, 1.4445e+00, 3.8174e+05,
         1.3920e+00, 3.9640e+05, 1.5684e+00, 0.0000e+00]])
Krum scores: ['1.50', '1.53', '1.47', '384921.91', '382758.22', '1.46', '395184.47', '390206.50', '1.53', '386429.19', '1.47', '381732.19', '1.59', '396390.44', '1.53', '1.44']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0268s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:25...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:25, End: 2025-07-22 15:30:25)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 19, 17, 1, 20, 18, 8, 15, 4, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.3714e+00, 3.8084e+05, 3.9132e+05, 1.1855e+00, 3.9268e+05,
         3.8924e+05, 1.3405e+00, 4.0905e+05, 1.2420e+00, 1.1965e+00, 1.2447e+00,
         3.8270e+05, 1.3602e+00, 1.5742e+00],
        [1.3714e+00, 0.0000e+00, 3.8083e+05, 3.9130e+05, 1.2142e+00, 3.9269e+05,
         3.8925e+05, 1.5337e+00, 4.0906e+05, 1.3032e+00, 1.5157e+00, 1.1366e+00,
         3.8271e+05, 1.4473e+00, 1.2282e+00],
        [3.8084e+05, 3.8083e+05, 0.0000e+00, 7.7705e+05, 3.8082e+05, 7.5848e+05,
         7.7868e+05, 3.8082e+05, 7.8282e+05, 3.8079e+05, 3.8081e+05, 3.8084e+05,
         7.5973e+05, 3.8084e+05, 3.8083e+05],
        [3.9132e+05, 3.9130e+05, 7.7705e+05, 0.0000e+00, 3.9130e+05, 7.9443e+05,
         7.8060e+05, 3.9134e+05, 7.8878e+05, 3.9132e+05, 3.9130e+05, 3.9132e+05,
         7.5182e+05, 3.9129e+05, 3.9126e+05],
        [1.1855e+00, 1.2142e+00, 3.8082e+05, 3.9130e+05, 0.0000e+00, 3.9267e+05,
         3.8922e+05, 1.3297e+00, 4.0908e+05, 1.3068e+00, 1.2589e+00, 1.2558e+00,
         3.8271e+05, 1.2459e+00, 1.4986e+00],
        [3.9268e+05, 3.9269e+05, 7.5848e+05, 7.9443e+05, 3.9267e+05, 0.0000e+00,
         7.8449e+05, 3.9269e+05, 8.1483e+05, 3.9269e+05, 3.9265e+05, 3.9269e+05,
         7.7865e+05, 3.9270e+05, 3.9268e+05],
        [3.8924e+05, 3.8925e+05, 7.7868e+05, 7.8060e+05, 3.8922e+05, 7.8449e+05,
         0.0000e+00, 3.8925e+05, 7.8018e+05, 3.8923e+05, 3.8921e+05, 3.8922e+05,
         7.9555e+05, 3.8925e+05, 3.8923e+05],
        [1.3405e+00, 1.5337e+00, 3.8082e+05, 3.9134e+05, 1.3297e+00, 3.9269e+05,
         3.8925e+05, 0.0000e+00, 4.0908e+05, 1.2721e+00, 1.2604e+00, 1.4489e+00,
         3.8268e+05, 1.1831e+00, 1.9464e+00],
        [4.0905e+05, 4.0906e+05, 7.8282e+05, 7.8878e+05, 4.0908e+05, 8.1483e+05,
         7.8018e+05, 4.0908e+05, 0.0000e+00, 4.0908e+05, 4.0909e+05, 4.0907e+05,
         8.0470e+05, 4.0907e+05, 4.0910e+05],
        [1.2420e+00, 1.3032e+00, 3.8079e+05, 3.9132e+05, 1.3068e+00, 3.9269e+05,
         3.8923e+05, 1.2721e+00, 4.0908e+05, 0.0000e+00, 1.2779e+00, 1.4268e+00,
         3.8269e+05, 1.2579e+00, 1.6781e+00],
        [1.1965e+00, 1.5157e+00, 3.8081e+05, 3.9130e+05, 1.2589e+00, 3.9265e+05,
         3.8921e+05, 1.2604e+00, 4.0909e+05, 1.2779e+00, 0.0000e+00, 1.4244e+00,
         3.8271e+05, 1.2431e+00, 1.8503e+00],
        [1.2447e+00, 1.1366e+00, 3.8084e+05, 3.9132e+05, 1.2558e+00, 3.9269e+05,
         3.8922e+05, 1.4489e+00, 4.0907e+05, 1.4268e+00, 1.4244e+00, 0.0000e+00,
         3.8269e+05, 1.4345e+00, 1.3075e+00],
        [3.8270e+05, 3.8271e+05, 7.5973e+05, 7.5182e+05, 3.8271e+05, 7.7865e+05,
         7.9555e+05, 3.8268e+05, 8.0470e+05, 3.8269e+05, 3.8271e+05, 3.8269e+05,
         0.0000e+00, 3.8270e+05, 3.8271e+05],
        [1.3602e+00, 1.4473e+00, 3.8084e+05, 3.9129e+05, 1.2459e+00, 3.9270e+05,
         3.8925e+05, 1.1831e+00, 4.0907e+05, 1.2579e+00, 1.2431e+00, 1.4345e+00,
         3.8270e+05, 0.0000e+00, 1.8921e+00],
        [1.5742e+00, 1.2282e+00, 3.8083e+05, 3.9126e+05, 1.4986e+00, 3.9268e+05,
         3.8923e+05, 1.9464e+00, 4.0910e+05, 1.6781e+00, 1.8503e+00, 1.3075e+00,
         3.8271e+05, 1.8921e+00, 0.0000e+00]])
Krum scores: ['1.28', '1.32', '380821.97', '391297.97', '1.26', '392679.25', '389227.50', '1.34', '409070.19', '1.30', '1.31', '1.32', '382697.75', '1.31', '1.58']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 19, 17, 1, 20, 18, 8, 15, 4, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0071s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:26...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:26, End: 2025-07-22 15:30:26)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.5038e+00, 4.0385e+05, 3.9232e+05, 1.7585e+00, 1.4051e+00,
         3.9371e+05, 3.8229e+05, 1.3269e+00, 3.8853e+05, 1.3311e+00, 1.3952e+00,
         3.8326e+05, 3.7062e+05, 1.4745e+00, 3.9513e+05, 1.3577e+00, 1.7363e+00],
        [1.5038e+00, 0.0000e+00, 4.0386e+05, 3.9232e+05, 1.2189e+00, 1.2992e+00,
         3.9369e+05, 3.8232e+05, 1.5145e+00, 3.8856e+05, 1.3435e+00, 1.3924e+00,
         3.8321e+05, 3.7066e+05, 1.1506e+00, 3.9508e+05, 1.4328e+00, 1.0940e+00],
        [4.0385e+05, 4.0386e+05, 0.0000e+00, 7.6259e+05, 4.0385e+05, 4.0390e+05,
         7.7632e+05, 8.1051e+05, 4.0384e+05, 7.8428e+05, 4.0388e+05, 4.0387e+05,
         7.9536e+05, 7.7193e+05, 4.0385e+05, 8.1215e+05, 4.0386e+05, 4.0385e+05],
        [3.9232e+05, 3.9232e+05, 7.6259e+05, 0.0000e+00, 3.9233e+05, 3.9231e+05,
         7.8304e+05, 7.8742e+05, 3.9232e+05, 7.9468e+05, 3.9231e+05, 3.9234e+05,
         7.5976e+05, 7.5784e+05, 3.9230e+05, 8.0846e+05, 3.9234e+05, 3.9229e+05],
        [1.7585e+00, 1.2189e+00, 4.0385e+05, 3.9233e+05, 0.0000e+00, 1.4070e+00,
         3.9368e+05, 3.8229e+05, 1.6784e+00, 3.8855e+05, 1.5749e+00, 1.5557e+00,
         3.8325e+05, 3.7065e+05, 1.3525e+00, 3.9510e+05, 1.6193e+00, 1.2199e+00],
        [1.4051e+00, 1.2992e+00, 4.0390e+05, 3.9231e+05, 1.4070e+00, 0.0000e+00,
         3.9369e+05, 3.8228e+05, 1.4170e+00, 3.8853e+05, 1.3325e+00, 1.2811e+00,
         3.8324e+05, 3.7067e+05, 1.2735e+00, 3.9510e+05, 1.3520e+00, 1.3871e+00],
        [3.9371e+05, 3.9369e+05, 7.7632e+05, 7.8304e+05, 3.9368e+05, 3.9369e+05,
         0.0000e+00, 7.7216e+05, 3.9368e+05, 7.7599e+05, 3.9370e+05, 3.9370e+05,
         7.7915e+05, 7.8928e+05, 3.9372e+05, 7.6928e+05, 3.9369e+05, 3.9369e+05],
        [3.8229e+05, 3.8232e+05, 8.1051e+05, 7.8742e+05, 3.8229e+05, 3.8228e+05,
         7.7216e+05, 0.0000e+00, 3.8229e+05, 7.5592e+05, 3.8227e+05, 3.8228e+05,
         7.6453e+05, 7.5730e+05, 3.8230e+05, 7.6770e+05, 3.8230e+05, 3.8230e+05],
        [1.3269e+00, 1.5145e+00, 4.0384e+05, 3.9232e+05, 1.6784e+00, 1.4170e+00,
         3.9368e+05, 3.8229e+05, 0.0000e+00, 3.8852e+05, 1.2887e+00, 1.2695e+00,
         3.8325e+05, 3.7062e+05, 1.4947e+00, 3.9513e+05, 1.2555e+00, 1.7506e+00],
        [3.8853e+05, 3.8856e+05, 7.8428e+05, 7.9468e+05, 3.8855e+05, 3.8853e+05,
         7.7599e+05, 7.5592e+05, 3.8852e+05, 0.0000e+00, 3.8849e+05, 3.8853e+05,
         7.9015e+05, 7.5519e+05, 3.8855e+05, 7.7483e+05, 3.8853e+05, 3.8854e+05],
        [1.3311e+00, 1.3435e+00, 4.0388e+05, 3.9231e+05, 1.5749e+00, 1.3325e+00,
         3.9370e+05, 3.8227e+05, 1.2887e+00, 3.8849e+05, 0.0000e+00, 1.3141e+00,
         3.8324e+05, 3.7067e+05, 1.4957e+00, 3.9510e+05, 1.3217e+00, 1.5527e+00],
        [1.3952e+00, 1.3924e+00, 4.0387e+05, 3.9234e+05, 1.5557e+00, 1.2811e+00,
         3.9370e+05, 3.8228e+05, 1.2695e+00, 3.8853e+05, 1.3141e+00, 0.0000e+00,
         3.8326e+05, 3.7067e+05, 1.3355e+00, 3.9512e+05, 1.3929e+00, 1.5840e+00],
        [3.8326e+05, 3.8321e+05, 7.9536e+05, 7.5976e+05, 3.8325e+05, 3.8324e+05,
         7.7915e+05, 7.6453e+05, 3.8325e+05, 7.9015e+05, 3.8324e+05, 3.8326e+05,
         0.0000e+00, 7.5254e+05, 3.8325e+05, 7.8327e+05, 3.8324e+05, 3.8322e+05],
        [3.7062e+05, 3.7066e+05, 7.7193e+05, 7.5784e+05, 3.7065e+05, 3.7067e+05,
         7.8928e+05, 7.5730e+05, 3.7062e+05, 7.5519e+05, 3.7067e+05, 3.7067e+05,
         7.5254e+05, 0.0000e+00, 3.7064e+05, 7.8247e+05, 3.7065e+05, 3.7065e+05],
        [1.4745e+00, 1.1506e+00, 4.0385e+05, 3.9230e+05, 1.3525e+00, 1.2735e+00,
         3.9372e+05, 3.8230e+05, 1.4947e+00, 3.8855e+05, 1.4957e+00, 1.3355e+00,
         3.8325e+05, 3.7064e+05, 0.0000e+00, 3.9513e+05, 1.4886e+00, 1.1703e+00],
        [3.9513e+05, 3.9508e+05, 8.1215e+05, 8.0846e+05, 3.9510e+05, 3.9510e+05,
         7.6928e+05, 7.6770e+05, 3.9513e+05, 7.7483e+05, 3.9510e+05, 3.9512e+05,
         7.8327e+05, 7.8247e+05, 3.9513e+05, 0.0000e+00, 3.9511e+05, 3.9510e+05],
        [1.3577e+00, 1.4328e+00, 4.0386e+05, 3.9234e+05, 1.6193e+00, 1.3520e+00,
         3.9369e+05, 3.8230e+05, 1.2555e+00, 3.8853e+05, 1.3217e+00, 1.3929e+00,
         3.8324e+05, 3.7065e+05, 1.4886e+00, 3.9511e+05, 0.0000e+00, 1.6786e+00],
        [1.7363e+00, 1.0940e+00, 4.0385e+05, 3.9229e+05, 1.2199e+00, 1.3871e+00,
         3.9369e+05, 3.8230e+05, 1.7506e+00, 3.8854e+05, 1.5527e+00, 1.5840e+00,
         3.8322e+05, 3.7065e+05, 1.1703e+00, 3.9510e+05, 1.6786e+00, 0.0000e+00]])
Krum scores: ['1.44', '1.30', '403852.50', '392313.19', '1.45', '1.34', '393688.12', '382286.72', '1.41', '388528.44', '1.37', '1.37', '383238.88', '370646.38', '1.34', '395105.19', '1.40', '1.43']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0263s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:26...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:26, End: 2025-07-22 15:30:26)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.2217e+00, 1.6749e+00, 3.8822e+05, 3.9960e+05, 1.1901e+00,
         1.1547e+00, 3.8986e+05, 3.8932e+05, 1.1799e+00, 1.1341e+00, 3.7340e+05,
         1.0634e+00, 1.1730e+00, 3.8670e+05, 1.2337e+00, 1.2397e+00],
        [1.2217e+00, 0.0000e+00, 1.8370e+00, 3.8824e+05, 3.9962e+05, 1.3888e+00,
         1.1874e+00, 3.8987e+05, 3.8930e+05, 1.1681e+00, 1.1917e+00, 3.7340e+05,
         1.1177e+00, 1.2136e+00, 3.8670e+05, 1.1606e+00, 1.4341e+00],
        [1.6749e+00, 1.8370e+00, 0.0000e+00, 3.8826e+05, 3.9959e+05, 1.1423e+00,
         1.4663e+00, 3.8986e+05, 3.8930e+05, 1.8307e+00, 1.5648e+00, 3.7339e+05,
         1.8642e+00, 1.3053e+00, 3.8669e+05, 1.7492e+00, 1.0806e+00],
        [3.8822e+05, 3.8824e+05, 3.8826e+05, 0.0000e+00, 7.9262e+05, 3.8824e+05,
         3.8823e+05, 7.7462e+05, 7.9973e+05, 3.8823e+05, 3.8826e+05, 7.7907e+05,
         3.8823e+05, 3.8823e+05, 7.6116e+05, 3.8820e+05, 3.8825e+05],
        [3.9960e+05, 3.9962e+05, 3.9959e+05, 7.9262e+05, 0.0000e+00, 3.9962e+05,
         3.9961e+05, 7.9735e+05, 7.9751e+05, 3.9964e+05, 3.9959e+05, 7.8565e+05,
         3.9960e+05, 3.9961e+05, 7.7361e+05, 3.9961e+05, 3.9960e+05],
        [1.1901e+00, 1.3888e+00, 1.1423e+00, 3.8824e+05, 3.9962e+05, 0.0000e+00,
         1.1413e+00, 3.8987e+05, 3.8929e+05, 1.3451e+00, 1.2751e+00, 3.7339e+05,
         1.3068e+00, 1.1169e+00, 3.8669e+05, 1.2960e+00, 9.8684e-01],
        [1.1547e+00, 1.1874e+00, 1.4663e+00, 3.8823e+05, 3.9961e+05, 1.1413e+00,
         0.0000e+00, 3.8985e+05, 3.8930e+05, 1.2112e+00, 1.1707e+00, 3.7342e+05,
         1.1289e+00, 1.1187e+00, 3.8669e+05, 1.1817e+00, 1.1795e+00],
        [3.8986e+05, 3.8987e+05, 3.8986e+05, 7.7462e+05, 7.9735e+05, 3.8987e+05,
         3.8985e+05, 0.0000e+00, 7.8864e+05, 3.8983e+05, 3.8988e+05, 7.5901e+05,
         3.8986e+05, 3.8985e+05, 7.8064e+05, 3.8988e+05, 3.8986e+05],
        [3.8932e+05, 3.8930e+05, 3.8930e+05, 7.9973e+05, 7.9751e+05, 3.8929e+05,
         3.8930e+05, 7.8864e+05, 0.0000e+00, 3.8928e+05, 3.8929e+05, 7.7348e+05,
         3.8932e+05, 3.8929e+05, 7.6859e+05, 3.8929e+05, 3.8928e+05],
        [1.1799e+00, 1.1681e+00, 1.8307e+00, 3.8823e+05, 3.9964e+05, 1.3451e+00,
         1.2112e+00, 3.8983e+05, 3.8928e+05, 0.0000e+00, 1.1441e+00, 3.7339e+05,
         1.1533e+00, 1.2493e+00, 3.8672e+05, 1.1235e+00, 1.4667e+00],
        [1.1341e+00, 1.1917e+00, 1.5648e+00, 3.8826e+05, 3.9959e+05, 1.2751e+00,
         1.1707e+00, 3.8988e+05, 3.8929e+05, 1.1441e+00, 0.0000e+00, 3.7336e+05,
         1.1926e+00, 1.2928e+00, 3.8671e+05, 1.2008e+00, 1.2887e+00],
        [3.7340e+05, 3.7340e+05, 3.7339e+05, 7.7907e+05, 7.8565e+05, 3.7339e+05,
         3.7342e+05, 7.5901e+05, 7.7348e+05, 3.7339e+05, 3.7336e+05, 0.0000e+00,
         3.7339e+05, 3.7341e+05, 7.5995e+05, 3.7341e+05, 3.7340e+05],
        [1.0634e+00, 1.1177e+00, 1.8642e+00, 3.8823e+05, 3.9960e+05, 1.3068e+00,
         1.1289e+00, 3.8986e+05, 3.8932e+05, 1.1533e+00, 1.1926e+00, 3.7339e+05,
         0.0000e+00, 1.2813e+00, 3.8670e+05, 1.1375e+00, 1.4243e+00],
        [1.1730e+00, 1.2136e+00, 1.3053e+00, 3.8823e+05, 3.9961e+05, 1.1169e+00,
         1.1187e+00, 3.8985e+05, 3.8929e+05, 1.2493e+00, 1.2928e+00, 3.7341e+05,
         1.2813e+00, 0.0000e+00, 3.8670e+05, 1.2853e+00, 9.9120e-01],
        [3.8670e+05, 3.8670e+05, 3.8669e+05, 7.6116e+05, 7.7361e+05, 3.8669e+05,
         3.8669e+05, 7.8064e+05, 7.6859e+05, 3.8672e+05, 3.8671e+05, 7.5995e+05,
         3.8670e+05, 3.8670e+05, 0.0000e+00, 3.8668e+05, 3.8670e+05],
        [1.2337e+00, 1.1606e+00, 1.7492e+00, 3.8820e+05, 3.9961e+05, 1.2960e+00,
         1.1817e+00, 3.8988e+05, 3.8929e+05, 1.1235e+00, 1.2008e+00, 3.7341e+05,
         1.1375e+00, 1.2853e+00, 3.8668e+05, 0.0000e+00, 1.4194e+00],
        [1.2397e+00, 1.4341e+00, 1.0806e+00, 3.8825e+05, 3.9960e+05, 9.8684e-01,
         1.1795e+00, 3.8986e+05, 3.8928e+05, 1.4667e+00, 1.2887e+00, 3.7340e+05,
         1.4243e+00, 9.9120e-01, 3.8670e+05, 1.4194e+00, 0.0000e+00]])
Krum scores: ['1.18', '1.23', '1.52', '388228.75', '399604.00', '1.20', '1.16', '389856.03', '389290.97', '1.23', '1.21', '373392.97', '1.20', '1.19', '386693.25', '1.23', '1.23']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0115s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:27...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:27, End: 2025-07-22 15:30:27)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9568e+05, 1.1146e+00, 1.1444e+00, 3.9409e+05, 3.8999e+05,
         1.6855e+00, 3.8001e+05, 1.4588e+00, 1.5050e+00, 3.9091e+05, 4.0349e+05,
         1.6941e+00, 1.2188e+00, 3.8842e+05, 1.6092e+00],
        [3.9568e+05, 0.0000e+00, 3.9572e+05, 3.9571e+05, 7.8350e+05, 7.7957e+05,
         3.9571e+05, 7.5695e+05, 3.9569e+05, 3.9571e+05, 7.9392e+05, 8.0747e+05,
         3.9569e+05, 3.9571e+05, 7.9355e+05, 3.9571e+05],
        [1.1146e+00, 3.9572e+05, 0.0000e+00, 1.2363e+00, 3.9411e+05, 3.9001e+05,
         1.4756e+00, 3.7999e+05, 1.3813e+00, 1.3362e+00, 3.9089e+05, 4.0348e+05,
         1.4005e+00, 1.2402e+00, 3.8839e+05, 1.3728e+00],
        [1.1444e+00, 3.9571e+05, 1.2363e+00, 0.0000e+00, 3.9413e+05, 3.8998e+05,
         1.6594e+00, 3.8001e+05, 1.5261e+00, 1.4486e+00, 3.9092e+05, 4.0350e+05,
         1.5798e+00, 1.2829e+00, 3.8841e+05, 1.6335e+00],
        [3.9409e+05, 7.8350e+05, 3.9411e+05, 3.9413e+05, 0.0000e+00, 7.9928e+05,
         3.9407e+05, 7.8403e+05, 3.9411e+05, 3.9410e+05, 8.1462e+05, 7.8276e+05,
         3.9410e+05, 3.9409e+05, 7.9490e+05, 3.9413e+05],
        [3.8999e+05, 7.7957e+05, 3.9001e+05, 3.8998e+05, 7.9928e+05, 0.0000e+00,
         3.8998e+05, 7.8014e+05, 3.9000e+05, 3.8996e+05, 7.6614e+05, 7.8524e+05,
         3.8997e+05, 3.9000e+05, 7.7098e+05, 3.8999e+05],
        [1.6855e+00, 3.9571e+05, 1.4756e+00, 1.6594e+00, 3.9407e+05, 3.8998e+05,
         0.0000e+00, 3.8003e+05, 1.2563e+00, 1.2149e+00, 3.9092e+05, 4.0350e+05,
         1.2450e+00, 1.3890e+00, 3.8840e+05, 1.1764e+00],
        [3.8001e+05, 7.5695e+05, 3.7999e+05, 3.8001e+05, 7.8403e+05, 7.8014e+05,
         3.8003e+05, 0.0000e+00, 3.8000e+05, 3.8002e+05, 7.7319e+05, 7.8310e+05,
         3.8004e+05, 3.7999e+05, 7.8252e+05, 3.7999e+05],
        [1.4588e+00, 3.9569e+05, 1.3813e+00, 1.5261e+00, 3.9411e+05, 3.9000e+05,
         1.2563e+00, 3.8000e+05, 0.0000e+00, 1.2279e+00, 3.9092e+05, 4.0349e+05,
         1.2532e+00, 1.4300e+00, 3.8843e+05, 1.2579e+00],
        [1.5050e+00, 3.9571e+05, 1.3362e+00, 1.4486e+00, 3.9410e+05, 3.8996e+05,
         1.2149e+00, 3.8002e+05, 1.2279e+00, 0.0000e+00, 3.9090e+05, 4.0347e+05,
         1.2462e+00, 1.2441e+00, 3.8841e+05, 1.3197e+00],
        [3.9091e+05, 7.9392e+05, 3.9089e+05, 3.9092e+05, 8.1462e+05, 7.6614e+05,
         3.9092e+05, 7.7319e+05, 3.9092e+05, 3.9090e+05, 0.0000e+00, 8.1170e+05,
         3.9093e+05, 3.9092e+05, 7.8208e+05, 3.9089e+05],
        [4.0349e+05, 8.0747e+05, 4.0348e+05, 4.0350e+05, 7.8276e+05, 7.8524e+05,
         4.0350e+05, 7.8310e+05, 4.0349e+05, 4.0347e+05, 8.1170e+05, 0.0000e+00,
         4.0349e+05, 4.0348e+05, 8.0581e+05, 4.0348e+05],
        [1.6941e+00, 3.9569e+05, 1.4005e+00, 1.5798e+00, 3.9410e+05, 3.8997e+05,
         1.2450e+00, 3.8004e+05, 1.2532e+00, 1.2462e+00, 3.9093e+05, 4.0349e+05,
         0.0000e+00, 1.3926e+00, 3.8840e+05, 1.2214e+00],
        [1.2188e+00, 3.9571e+05, 1.2402e+00, 1.2829e+00, 3.9409e+05, 3.9000e+05,
         1.3890e+00, 3.7999e+05, 1.4300e+00, 1.2441e+00, 3.9092e+05, 4.0348e+05,
         1.3926e+00, 0.0000e+00, 3.8841e+05, 1.3758e+00],
        [3.8842e+05, 7.9355e+05, 3.8839e+05, 3.8841e+05, 7.9490e+05, 7.7098e+05,
         3.8840e+05, 7.8252e+05, 3.8843e+05, 3.8841e+05, 7.8208e+05, 8.0581e+05,
         3.8840e+05, 3.8841e+05, 0.0000e+00, 3.8841e+05],
        [1.6092e+00, 3.9571e+05, 1.3728e+00, 1.6335e+00, 3.9413e+05, 3.8999e+05,
         1.1764e+00, 3.7999e+05, 1.2579e+00, 1.3197e+00, 3.9089e+05, 4.0348e+05,
         1.2214e+00, 1.3758e+00, 3.8841e+05, 0.0000e+00]])
Krum scores: ['1.39', '395700.28', '1.30', '1.41', '394095.78', '389979.44', '1.35', '380002.03', '1.32', '1.29', '390907.28', '403483.03', '1.33', '1.31', '388405.03', '1.33']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0107s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:28...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:28, End: 2025-07-22 15:30:28)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 9, 18, 8, 15, 4, 3, 13, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.4796e+00, 1.5777e+00, 3.9057e+05, 3.9914e+05, 1.4467e+00,
         3.8976e+05, 1.4957e+00, 3.9362e+05, 1.3916e+00, 1.4358e+00, 3.8970e+05,
         1.3793e+00, 1.3679e+00, 3.9582e+05, 1.4971e+00, 1.4575e+00],
        [1.4796e+00, 0.0000e+00, 1.7530e+00, 3.9056e+05, 3.9910e+05, 1.5679e+00,
         3.8971e+05, 1.3704e+00, 3.9359e+05, 1.3970e+00, 1.7317e+00, 3.8973e+05,
         1.2977e+00, 1.4235e+00, 3.9582e+05, 1.3727e+00, 1.6707e+00],
        [1.5777e+00, 1.7530e+00, 0.0000e+00, 3.9061e+05, 3.9914e+05, 1.0672e+00,
         3.8978e+05, 1.6823e+00, 3.9359e+05, 1.4640e+00, 1.2954e+00, 3.8968e+05,
         1.7138e+00, 1.1867e+00, 3.9586e+05, 1.6646e+00, 1.0481e+00],
        [3.9057e+05, 3.9056e+05, 3.9061e+05, 0.0000e+00, 8.0861e+05, 3.9057e+05,
         7.8366e+05, 3.9053e+05, 7.8999e+05, 3.9058e+05, 3.9060e+05, 7.7929e+05,
         3.9059e+05, 3.9053e+05, 7.8897e+05, 3.9055e+05, 3.9057e+05],
        [3.9914e+05, 3.9910e+05, 3.9914e+05, 8.0861e+05, 0.0000e+00, 3.9911e+05,
         8.0626e+05, 3.9911e+05, 7.8977e+05, 3.9909e+05, 3.9908e+05, 7.7822e+05,
         3.9913e+05, 3.9912e+05, 7.8378e+05, 3.9914e+05, 3.9912e+05],
        [1.4467e+00, 1.5679e+00, 1.0672e+00, 3.9057e+05, 3.9911e+05, 0.0000e+00,
         3.8980e+05, 1.5659e+00, 3.9361e+05, 1.4310e+00, 1.2688e+00, 3.8973e+05,
         1.4744e+00, 1.1578e+00, 3.9581e+05, 1.5658e+00, 1.1822e+00],
        [3.8976e+05, 3.8971e+05, 3.8978e+05, 7.8366e+05, 8.0626e+05, 3.8980e+05,
         0.0000e+00, 3.8979e+05, 7.5892e+05, 3.8979e+05, 3.8978e+05, 7.8496e+05,
         3.8978e+05, 3.8977e+05, 7.8918e+05, 3.8978e+05, 3.8979e+05],
        [1.4957e+00, 1.3704e+00, 1.6823e+00, 3.9053e+05, 3.9911e+05, 1.5659e+00,
         3.8979e+05, 0.0000e+00, 3.9358e+05, 1.3456e+00, 1.6167e+00, 3.8970e+05,
         1.3678e+00, 1.4241e+00, 3.9581e+05, 1.2947e+00, 1.6361e+00],
        [3.9362e+05, 3.9359e+05, 3.9359e+05, 7.8999e+05, 7.8977e+05, 3.9361e+05,
         7.5892e+05, 3.9358e+05, 0.0000e+00, 3.9356e+05, 3.9360e+05, 7.8767e+05,
         3.9358e+05, 3.9361e+05, 8.0617e+05, 3.9361e+05, 3.9363e+05],
        [1.3916e+00, 1.3970e+00, 1.4640e+00, 3.9058e+05, 3.9909e+05, 1.4310e+00,
         3.8979e+05, 1.3456e+00, 3.9356e+05, 0.0000e+00, 1.4292e+00, 3.8970e+05,
         1.3138e+00, 1.4804e+00, 3.9585e+05, 1.3840e+00, 1.4754e+00],
        [1.4358e+00, 1.7317e+00, 1.2954e+00, 3.9060e+05, 3.9908e+05, 1.2688e+00,
         3.8978e+05, 1.6167e+00, 3.9360e+05, 1.4292e+00, 0.0000e+00, 3.8971e+05,
         1.6306e+00, 1.3286e+00, 3.9583e+05, 1.7589e+00, 1.3026e+00],
        [3.8970e+05, 3.8973e+05, 3.8968e+05, 7.7929e+05, 7.7822e+05, 3.8973e+05,
         7.8496e+05, 3.8970e+05, 7.8767e+05, 3.8970e+05, 3.8971e+05, 0.0000e+00,
         3.8974e+05, 3.8971e+05, 7.7498e+05, 3.8971e+05, 3.8970e+05],
        [1.3793e+00, 1.2977e+00, 1.7138e+00, 3.9059e+05, 3.9913e+05, 1.4744e+00,
         3.8978e+05, 1.3678e+00, 3.9358e+05, 1.3138e+00, 1.6306e+00, 3.8974e+05,
         0.0000e+00, 1.4202e+00, 3.9581e+05, 1.3531e+00, 1.5747e+00],
        [1.3679e+00, 1.4235e+00, 1.1867e+00, 3.9053e+05, 3.9912e+05, 1.1578e+00,
         3.8977e+05, 1.4241e+00, 3.9361e+05, 1.4804e+00, 1.3286e+00, 3.8971e+05,
         1.4202e+00, 0.0000e+00, 3.9582e+05, 1.4687e+00, 1.1399e+00],
        [3.9582e+05, 3.9582e+05, 3.9586e+05, 7.8897e+05, 7.8378e+05, 3.9581e+05,
         7.8918e+05, 3.9581e+05, 8.0617e+05, 3.9585e+05, 3.9583e+05, 7.7498e+05,
         3.9581e+05, 3.9582e+05, 0.0000e+00, 3.9583e+05, 3.9585e+05],
        [1.4971e+00, 1.3727e+00, 1.6646e+00, 3.9055e+05, 3.9914e+05, 1.5658e+00,
         3.8978e+05, 1.2947e+00, 3.9361e+05, 1.3840e+00, 1.7589e+00, 3.8971e+05,
         1.3531e+00, 1.4687e+00, 3.9583e+05, 0.0000e+00, 1.5847e+00],
        [1.4575e+00, 1.6707e+00, 1.0481e+00, 3.9057e+05, 3.9912e+05, 1.1822e+00,
         3.8979e+05, 1.6361e+00, 3.9363e+05, 1.4754e+00, 1.3026e+00, 3.8970e+05,
         1.5747e+00, 1.1399e+00, 3.9585e+05, 1.5847e+00, 0.0000e+00]])
Krum scores: ['1.44', '1.48', '1.41', '390562.97', '399110.75', '1.35', '389770.28', '1.46', '393591.53', '1.40', '1.45', '389706.25', '1.42', '1.32', '395821.62', '1.47', '1.38']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 9, 18, 8, 15, 4, 3, 13, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0132s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:28...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 46 217]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:28, End: 2025-07-22 15:30:28)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.8770e+05, 3.8566e+05, 1.2027e+00, 3.7220e+05, 1.3640e+00,
         4.0016e+05, 1.2388e+00, 1.2294e+00, 3.8115e+05, 3.9702e+05, 1.2382e+00,
         1.5796e+00],
        [3.8770e+05, 0.0000e+00, 8.0028e+05, 3.8773e+05, 7.5921e+05, 3.8770e+05,
         7.8444e+05, 3.8772e+05, 3.8771e+05, 7.6647e+05, 7.9101e+05, 3.8768e+05,
         3.8774e+05],
        [3.8566e+05, 8.0028e+05, 0.0000e+00, 3.8565e+05, 7.4997e+05, 3.8566e+05,
         7.9093e+05, 3.8568e+05, 3.8568e+05, 7.7173e+05, 7.6537e+05, 3.8565e+05,
         3.8569e+05],
        [1.2027e+00, 3.8773e+05, 3.8565e+05, 0.0000e+00, 3.7221e+05, 1.3079e+00,
         4.0019e+05, 1.2305e+00, 1.1194e+00, 3.8114e+05, 3.9704e+05, 1.2970e+00,
         1.2861e+00],
        [3.7220e+05, 7.5921e+05, 7.4997e+05, 3.7221e+05, 0.0000e+00, 3.7224e+05,
         7.5900e+05, 3.7223e+05, 3.7223e+05, 7.6260e+05, 7.7410e+05, 3.7220e+05,
         3.7224e+05],
        [1.3640e+00, 3.8770e+05, 3.8566e+05, 1.3079e+00, 3.7224e+05, 0.0000e+00,
         4.0018e+05, 1.1642e+00, 1.3259e+00, 3.8110e+05, 3.9703e+05, 1.2345e+00,
         1.8051e+00],
        [4.0016e+05, 7.8444e+05, 7.9093e+05, 4.0019e+05, 7.5900e+05, 4.0018e+05,
         0.0000e+00, 4.0019e+05, 4.0016e+05, 7.6998e+05, 7.9773e+05, 4.0018e+05,
         4.0018e+05],
        [1.2388e+00, 3.8772e+05, 3.8568e+05, 1.2305e+00, 3.7223e+05, 1.1642e+00,
         4.0019e+05, 0.0000e+00, 1.1647e+00, 3.8111e+05, 3.9703e+05, 1.1412e+00,
         1.6686e+00],
        [1.2294e+00, 3.8771e+05, 3.8568e+05, 1.1194e+00, 3.7223e+05, 1.3259e+00,
         4.0016e+05, 1.1647e+00, 0.0000e+00, 3.8115e+05, 3.9707e+05, 1.3378e+00,
         1.2857e+00],
        [3.8115e+05, 7.6647e+05, 7.7173e+05, 3.8114e+05, 7.6260e+05, 3.8110e+05,
         7.6998e+05, 3.8111e+05, 3.8115e+05, 0.0000e+00, 7.6775e+05, 3.8112e+05,
         3.8117e+05],
        [3.9702e+05, 7.9101e+05, 7.6537e+05, 3.9704e+05, 7.7410e+05, 3.9703e+05,
         7.9773e+05, 3.9703e+05, 3.9707e+05, 7.6775e+05, 0.0000e+00, 3.9705e+05,
         3.9709e+05],
        [1.2382e+00, 3.8768e+05, 3.8565e+05, 1.2970e+00, 3.7220e+05, 1.2345e+00,
         4.0018e+05, 1.1412e+00, 1.3378e+00, 3.8112e+05, 3.9705e+05, 0.0000e+00,
         1.8104e+00],
        [1.5796e+00, 3.8774e+05, 3.8569e+05, 1.2861e+00, 3.7224e+05, 1.8051e+00,
         4.0018e+05, 1.6686e+00, 1.2857e+00, 3.8117e+05, 3.9709e+05, 1.8104e+00,
         0.0000e+00]])
Krum scores: ['1.25', '387700.22', '385660.91', '1.23', '372213.69', '1.28', '400171.34', '1.19', '1.22', '381123.72', '397035.50', '1.25', '1.53']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0027s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:29...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:29, End: 2025-07-22 15:30:29)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 1, 9, 18, 8, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5209e+00, 1.5144e+00, 3.9792e+05, 1.3558e+00, 1.3569e+00,
         3.8633e+05, 1.4813e+00, 1.4621e+00, 1.2815e+00, 3.8798e+05, 3.9055e+05,
         1.4656e+00, 3.9544e+05, 1.4821e+00, 1.4284e+00],
        [1.5209e+00, 0.0000e+00, 1.7341e+00, 3.9796e+05, 1.4979e+00, 1.4497e+00,
         3.8636e+05, 1.3498e+00, 1.6023e+00, 1.5067e+00, 3.8795e+05, 3.9054e+05,
         1.6509e+00, 3.9547e+05, 1.3262e+00, 1.6081e+00],
        [1.5144e+00, 1.7341e+00, 0.0000e+00, 3.9794e+05, 1.1840e+00, 1.1211e+00,
         3.8636e+05, 1.6906e+00, 1.2129e+00, 1.2447e+00, 3.8797e+05, 3.9058e+05,
         1.0268e+00, 3.9545e+05, 1.6624e+00, 1.0698e+00],
        [3.9792e+05, 3.9796e+05, 3.9794e+05, 0.0000e+00, 3.9794e+05, 3.9793e+05,
         7.8909e+05, 3.9796e+05, 3.9793e+05, 3.9794e+05, 8.0494e+05, 7.9144e+05,
         3.9796e+05, 7.7809e+05, 3.9792e+05, 3.9792e+05],
        [1.3558e+00, 1.4979e+00, 1.1840e+00, 3.9794e+05, 0.0000e+00, 1.1299e+00,
         3.8635e+05, 1.4363e+00, 1.3167e+00, 1.2054e+00, 3.8794e+05, 3.9057e+05,
         1.2502e+00, 3.9545e+05, 1.4044e+00, 1.2212e+00],
        [1.3569e+00, 1.4497e+00, 1.1211e+00, 3.9793e+05, 1.1299e+00, 0.0000e+00,
         3.8632e+05, 1.4462e+00, 1.2458e+00, 1.1296e+00, 3.8796e+05, 3.9055e+05,
         1.1365e+00, 3.9546e+05, 1.4360e+00, 1.2220e+00],
        [3.8633e+05, 3.8636e+05, 3.8636e+05, 7.8909e+05, 3.8635e+05, 3.8632e+05,
         0.0000e+00, 3.8633e+05, 3.8637e+05, 3.8635e+05, 7.8788e+05, 7.8864e+05,
         3.8632e+05, 7.7871e+05, 3.8631e+05, 3.8635e+05],
        [1.4813e+00, 1.3498e+00, 1.6906e+00, 3.9796e+05, 1.4363e+00, 1.4462e+00,
         3.8633e+05, 0.0000e+00, 1.5322e+00, 1.4453e+00, 3.8798e+05, 3.9057e+05,
         1.6701e+00, 3.9547e+05, 1.1948e+00, 1.6040e+00],
        [1.4621e+00, 1.6023e+00, 1.2129e+00, 3.9793e+05, 1.3167e+00, 1.2458e+00,
         3.8637e+05, 1.5322e+00, 0.0000e+00, 1.2496e+00, 3.8797e+05, 3.9056e+05,
         1.3741e+00, 3.9547e+05, 1.6112e+00, 1.2769e+00],
        [1.2815e+00, 1.5067e+00, 1.2447e+00, 3.9794e+05, 1.2054e+00, 1.1296e+00,
         3.8635e+05, 1.4453e+00, 1.2496e+00, 0.0000e+00, 3.8798e+05, 3.9055e+05,
         1.2008e+00, 3.9547e+05, 1.5043e+00, 1.2199e+00],
        [3.8798e+05, 3.8795e+05, 3.8797e+05, 8.0494e+05, 3.8794e+05, 3.8796e+05,
         7.8788e+05, 3.8798e+05, 3.8797e+05, 3.8798e+05, 0.0000e+00, 7.9780e+05,
         3.8796e+05, 7.8342e+05, 3.8796e+05, 3.8796e+05],
        [3.9055e+05, 3.9054e+05, 3.9058e+05, 7.9144e+05, 3.9057e+05, 3.9055e+05,
         7.8864e+05, 3.9057e+05, 3.9056e+05, 3.9055e+05, 7.9780e+05, 0.0000e+00,
         3.9055e+05, 7.8180e+05, 3.9055e+05, 3.9056e+05],
        [1.4656e+00, 1.6509e+00, 1.0268e+00, 3.9796e+05, 1.2502e+00, 1.1365e+00,
         3.8632e+05, 1.6701e+00, 1.3741e+00, 1.2008e+00, 3.8796e+05, 3.9055e+05,
         0.0000e+00, 3.9548e+05, 1.6660e+00, 1.0588e+00],
        [3.9544e+05, 3.9547e+05, 3.9545e+05, 7.7809e+05, 3.9545e+05, 3.9546e+05,
         7.7871e+05, 3.9547e+05, 3.9547e+05, 3.9547e+05, 7.8342e+05, 7.8180e+05,
         3.9548e+05, 0.0000e+00, 3.9546e+05, 3.9548e+05],
        [1.4821e+00, 1.3262e+00, 1.6624e+00, 3.9792e+05, 1.4044e+00, 1.4360e+00,
         3.8631e+05, 1.1948e+00, 1.6112e+00, 1.5043e+00, 3.8796e+05, 3.9055e+05,
         1.6660e+00, 3.9546e+05, 0.0000e+00, 1.5398e+00],
        [1.4284e+00, 1.6081e+00, 1.0698e+00, 3.9792e+05, 1.2212e+00, 1.2220e+00,
         3.8635e+05, 1.6040e+00, 1.2769e+00, 1.2199e+00, 3.8796e+05, 3.9056e+05,
         1.0588e+00, 3.9548e+05, 1.5398e+00, 0.0000e+00]])
Krum scores: ['1.43', '1.50', '1.30', '397932.72', '1.28', '1.25', '386334.38', '1.46', '1.36', '1.28', '387961.12', '390552.38', '1.31', '395459.94', '1.46', '1.29']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 1, 9, 18, 8, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:29...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:29, End: 2025-07-22 15:30:29)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [7, 19, 17, 1, 20, 8, 4, 3, 13, 11, 10, 16, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 3.9572e+05, 3.8554e+05, 1.2903e+00, 3.9431e+05, 1.1626e+00,
         1.2463e+00, 1.2528e+00, 3.9749e+05, 1.0924e+00, 1.4217e+00, 4.0094e+05,
         1.1892e+00],
        [3.9572e+05, 0.0000e+00, 7.6772e+05, 3.9574e+05, 8.1446e+05, 3.9573e+05,
         3.9573e+05, 3.9574e+05, 7.8794e+05, 3.9574e+05, 3.9575e+05, 8.1124e+05,
         3.9571e+05],
        [3.8554e+05, 7.6772e+05, 0.0000e+00, 3.8550e+05, 7.8398e+05, 3.8552e+05,
         3.8551e+05, 3.8552e+05, 7.9508e+05, 3.8553e+05, 3.8554e+05, 7.9756e+05,
         3.8552e+05],
        [1.2903e+00, 3.9574e+05, 3.8550e+05, 0.0000e+00, 3.9427e+05, 1.2949e+00,
         1.1045e+00, 1.0735e+00, 3.9751e+05, 1.2664e+00, 1.1388e+00, 4.0096e+05,
         1.2602e+00],
        [3.9431e+05, 8.1446e+05, 7.8398e+05, 3.9427e+05, 0.0000e+00, 3.9425e+05,
         3.9427e+05, 3.9427e+05, 7.9643e+05, 3.9429e+05, 3.9426e+05, 7.8861e+05,
         3.9428e+05],
        [1.1626e+00, 3.9573e+05, 3.8552e+05, 1.2949e+00, 3.9425e+05, 0.0000e+00,
         1.2338e+00, 1.2117e+00, 3.9750e+05, 1.2095e+00, 1.4614e+00, 4.0095e+05,
         1.1014e+00],
        [1.2463e+00, 3.9573e+05, 3.8551e+05, 1.1045e+00, 3.9427e+05, 1.2338e+00,
         0.0000e+00, 1.0314e+00, 3.9749e+05, 1.1937e+00, 1.1837e+00, 4.0093e+05,
         1.2414e+00],
        [1.2528e+00, 3.9574e+05, 3.8552e+05, 1.0735e+00, 3.9427e+05, 1.2117e+00,
         1.0314e+00, 0.0000e+00, 3.9751e+05, 1.2463e+00, 1.1017e+00, 4.0095e+05,
         1.3481e+00],
        [3.9749e+05, 7.8794e+05, 7.9508e+05, 3.9751e+05, 7.9643e+05, 3.9750e+05,
         3.9749e+05, 3.9751e+05, 0.0000e+00, 3.9748e+05, 3.9752e+05, 8.0908e+05,
         3.9747e+05],
        [1.0924e+00, 3.9574e+05, 3.8553e+05, 1.2664e+00, 3.9429e+05, 1.2095e+00,
         1.1937e+00, 1.2463e+00, 3.9748e+05, 0.0000e+00, 1.4868e+00, 4.0096e+05,
         1.1814e+00],
        [1.4217e+00, 3.9575e+05, 3.8554e+05, 1.1388e+00, 3.9426e+05, 1.4614e+00,
         1.1837e+00, 1.1017e+00, 3.9752e+05, 1.4868e+00, 0.0000e+00, 4.0096e+05,
         1.4834e+00],
        [4.0094e+05, 8.1124e+05, 7.9756e+05, 4.0096e+05, 7.8861e+05, 4.0095e+05,
         4.0093e+05, 4.0095e+05, 8.0908e+05, 4.0096e+05, 4.0096e+05, 0.0000e+00,
         4.0095e+05],
        [1.1892e+00, 3.9571e+05, 3.8552e+05, 1.2602e+00, 3.9428e+05, 1.1014e+00,
         1.2414e+00, 1.3481e+00, 3.9747e+05, 1.1814e+00, 1.4834e+00, 4.0095e+05,
         0.0000e+00]])
Krum scores: ['1.21', '395729.94', '385515.47', '1.19', '394266.09', '1.20', '1.16', '1.15', '397487.59', '1.20', '1.30', '400946.50', '1.22']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [7, 19, 17, 1, 20, 8, 4, 3, 13, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0027s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:30...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:30, End: 2025-07-22 15:30:30)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 17, 1, 9, 8, 15, 3, 13, 14, 11, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2785e+00, 1.3782e+00, 3.8362e+05, 3.9422e+05, 1.1834e+00,
         1.4149e+00, 1.2982e+00, 3.9361e+05, 1.3932e+00, 3.9070e+05, 3.7492e+05,
         1.2008e+00, 3.9392e+05, 1.3425e+00, 1.2219e+00],
        [1.2785e+00, 0.0000e+00, 1.5616e+00, 3.8363e+05, 3.9425e+05, 1.2864e+00,
         1.6434e+00, 1.2046e+00, 3.9365e+05, 1.7350e+00, 3.9070e+05, 3.7496e+05,
         1.0703e+00, 3.9391e+05, 1.2503e+00, 1.3928e+00],
        [1.3782e+00, 1.5616e+00, 0.0000e+00, 3.8360e+05, 3.9420e+05, 1.1064e+00,
         9.5909e-01, 1.4635e+00, 3.9360e+05, 1.1281e+00, 3.9069e+05, 3.7498e+05,
         1.4762e+00, 3.9389e+05, 1.5118e+00, 1.0058e+00],
        [3.8362e+05, 3.8363e+05, 3.8360e+05, 0.0000e+00, 7.6415e+05, 3.8363e+05,
         3.8361e+05, 3.8364e+05, 7.7455e+05, 3.8358e+05, 7.6794e+05, 7.6736e+05,
         3.8363e+05, 7.8270e+05, 3.8362e+05, 3.8363e+05],
        [3.9422e+05, 3.9425e+05, 3.9420e+05, 7.6415e+05, 0.0000e+00, 3.9426e+05,
         3.9422e+05, 3.9425e+05, 8.0174e+05, 3.9421e+05, 8.0303e+05, 7.7458e+05,
         3.9426e+05, 7.8080e+05, 3.9425e+05, 3.9425e+05],
        [1.1834e+00, 1.2864e+00, 1.1064e+00, 3.8363e+05, 3.9426e+05, 0.0000e+00,
         1.1454e+00, 1.2234e+00, 3.9362e+05, 1.2556e+00, 3.9071e+05, 3.7497e+05,
         1.2015e+00, 3.9391e+05, 1.2216e+00, 1.0541e+00],
        [1.4149e+00, 1.6434e+00, 9.5909e-01, 3.8361e+05, 3.9422e+05, 1.1454e+00,
         0.0000e+00, 1.5333e+00, 3.9361e+05, 1.0807e+00, 3.9072e+05, 3.7495e+05,
         1.5035e+00, 3.9390e+05, 1.6844e+00, 1.0962e+00],
        [1.2982e+00, 1.2046e+00, 1.4635e+00, 3.8364e+05, 3.9425e+05, 1.2234e+00,
         1.5333e+00, 0.0000e+00, 3.9358e+05, 1.6178e+00, 3.9071e+05, 3.7497e+05,
         1.2128e+00, 3.9389e+05, 1.1478e+00, 1.3434e+00],
        [3.9361e+05, 3.9365e+05, 3.9360e+05, 7.7455e+05, 8.0174e+05, 3.9362e+05,
         3.9361e+05, 3.9358e+05, 0.0000e+00, 3.9365e+05, 7.9809e+05, 7.5810e+05,
         3.9364e+05, 8.0778e+05, 3.9363e+05, 3.9363e+05],
        [1.3932e+00, 1.7350e+00, 1.1281e+00, 3.8358e+05, 3.9421e+05, 1.2556e+00,
         1.0807e+00, 1.6178e+00, 3.9365e+05, 0.0000e+00, 3.9072e+05, 3.7497e+05,
         1.6491e+00, 3.9386e+05, 1.8167e+00, 1.2589e+00],
        [3.9070e+05, 3.9070e+05, 3.9069e+05, 7.6794e+05, 8.0303e+05, 3.9071e+05,
         3.9072e+05, 3.9071e+05, 7.9809e+05, 3.9072e+05, 0.0000e+00, 7.7766e+05,
         3.9070e+05, 7.7242e+05, 3.9070e+05, 3.9071e+05],
        [3.7492e+05, 3.7496e+05, 3.7498e+05, 7.6736e+05, 7.7458e+05, 3.7497e+05,
         3.7495e+05, 3.7497e+05, 7.5810e+05, 3.7497e+05, 7.7766e+05, 0.0000e+00,
         3.7494e+05, 7.7106e+05, 3.7494e+05, 3.7496e+05],
        [1.2008e+00, 1.0703e+00, 1.4762e+00, 3.8363e+05, 3.9426e+05, 1.2015e+00,
         1.5035e+00, 1.2128e+00, 3.9364e+05, 1.6491e+00, 3.9070e+05, 3.7494e+05,
         0.0000e+00, 3.9389e+05, 1.2006e+00, 1.3414e+00],
        [3.9392e+05, 3.9391e+05, 3.9389e+05, 7.8270e+05, 7.8080e+05, 3.9391e+05,
         3.9390e+05, 3.9389e+05, 8.0778e+05, 3.9386e+05, 7.7242e+05, 7.7106e+05,
         3.9389e+05, 0.0000e+00, 3.9390e+05, 3.9387e+05],
        [1.3425e+00, 1.2503e+00, 1.5118e+00, 3.8362e+05, 3.9425e+05, 1.2216e+00,
         1.6844e+00, 1.1478e+00, 3.9363e+05, 1.8167e+00, 3.9070e+05, 3.7494e+05,
         1.2006e+00, 3.9390e+05, 0.0000e+00, 1.3425e+00],
        [1.2219e+00, 1.3928e+00, 1.0058e+00, 3.8363e+05, 3.9425e+05, 1.0541e+00,
         1.0962e+00, 1.3434e+00, 3.9363e+05, 1.2589e+00, 3.9071e+05, 3.7496e+05,
         1.3414e+00, 3.9387e+05, 1.3425e+00, 0.0000e+00]])
Krum scores: ['1.29', '1.34', '1.25', '383614.34', '394231.97', '1.17', '1.30', '1.30', '393616.31', '1.39', '390703.09', '374951.16', '1.28', '393890.12', '1.34', '1.21']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 8, 15, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:31...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:31, End: 2025-07-22 15:30:31)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.3343e+00, 4.0175e+05, 4.0032e+05, 1.3112e+00, 3.9507e+05,
         4.0169e+05, 1.2453e+00, 3.9264e+05, 1.1776e+00, 1.1711e+00, 4.0306e+05,
         3.8811e+05, 1.1432e+00, 1.2230e+00, 3.8179e+05, 1.2537e+00, 1.2220e+00],
        [1.3343e+00, 0.0000e+00, 4.0177e+05, 4.0032e+05, 9.2913e-01, 3.9505e+05,
         4.0171e+05, 1.5033e+00, 3.9270e+05, 1.0873e+00, 9.9152e-01, 4.0305e+05,
         3.8810e+05, 1.4624e+00, 9.7187e-01, 3.8178e+05, 1.4351e+00, 1.0043e+00],
        [4.0175e+05, 4.0177e+05, 0.0000e+00, 7.9253e+05, 4.0175e+05, 7.8605e+05,
         7.9865e+05, 4.0174e+05, 7.9717e+05, 4.0177e+05, 4.0174e+05, 7.9547e+05,
         7.9023e+05, 4.0172e+05, 4.0174e+05, 7.8832e+05, 4.0174e+05, 4.0175e+05],
        [4.0032e+05, 4.0032e+05, 7.9253e+05, 0.0000e+00, 4.0031e+05, 7.8435e+05,
         8.0954e+05, 4.0028e+05, 7.9508e+05, 4.0031e+05, 4.0031e+05, 8.0867e+05,
         7.7065e+05, 4.0031e+05, 4.0031e+05, 7.7282e+05, 4.0033e+05, 4.0030e+05],
        [1.3112e+00, 9.2913e-01, 4.0175e+05, 4.0031e+05, 0.0000e+00, 3.9509e+05,
         4.0172e+05, 1.4544e+00, 3.9267e+05, 1.1187e+00, 9.0321e-01, 4.0307e+05,
         3.8812e+05, 1.4065e+00, 9.5382e-01, 3.8175e+05, 1.4996e+00, 1.0232e+00],
        [3.9507e+05, 3.9505e+05, 7.8605e+05, 7.8435e+05, 3.9509e+05, 0.0000e+00,
         7.9897e+05, 3.9505e+05, 8.0367e+05, 3.9504e+05, 3.9505e+05, 8.0392e+05,
         7.7778e+05, 3.9507e+05, 3.9508e+05, 7.6723e+05, 3.9505e+05, 3.9507e+05],
        [4.0169e+05, 4.0171e+05, 7.9865e+05, 8.0954e+05, 4.0172e+05, 7.9897e+05,
         0.0000e+00, 4.0175e+05, 7.7742e+05, 4.0171e+05, 4.0168e+05, 7.7363e+05,
         7.9193e+05, 4.0173e+05, 4.0171e+05, 7.8660e+05, 4.0172e+05, 4.0172e+05],
        [1.2453e+00, 1.5033e+00, 4.0174e+05, 4.0028e+05, 1.4544e+00, 3.9505e+05,
         4.0175e+05, 0.0000e+00, 3.9265e+05, 1.2149e+00, 1.3655e+00, 4.0309e+05,
         3.8811e+05, 1.2829e+00, 1.3491e+00, 3.8177e+05, 1.1378e+00, 1.3949e+00],
        [3.9264e+05, 3.9270e+05, 7.9717e+05, 7.9508e+05, 3.9267e+05, 8.0367e+05,
         7.7742e+05, 3.9265e+05, 0.0000e+00, 3.9265e+05, 3.9266e+05, 8.1416e+05,
         7.6078e+05, 3.9268e+05, 3.9266e+05, 7.8691e+05, 3.9265e+05, 3.9267e+05],
        [1.1776e+00, 1.0873e+00, 4.0177e+05, 4.0031e+05, 1.1187e+00, 3.9504e+05,
         4.0171e+05, 1.2149e+00, 3.9265e+05, 0.0000e+00, 1.0180e+00, 4.0306e+05,
         3.8810e+05, 1.2206e+00, 1.1328e+00, 3.8179e+05, 1.2383e+00, 1.1443e+00],
        [1.1711e+00, 9.9152e-01, 4.0174e+05, 4.0031e+05, 9.0321e-01, 3.9505e+05,
         4.0168e+05, 1.3655e+00, 3.9266e+05, 1.0180e+00, 0.0000e+00, 4.0303e+05,
         3.8813e+05, 1.3990e+00, 9.3894e-01, 3.8178e+05, 1.4763e+00, 1.0501e+00],
        [4.0306e+05, 4.0305e+05, 7.9547e+05, 8.0867e+05, 4.0307e+05, 8.0392e+05,
         7.7363e+05, 4.0309e+05, 8.1416e+05, 4.0306e+05, 4.0303e+05, 0.0000e+00,
         7.8388e+05, 4.0305e+05, 4.0304e+05, 7.9735e+05, 4.0306e+05, 4.0304e+05],
        [3.8811e+05, 3.8810e+05, 7.9023e+05, 7.7065e+05, 3.8812e+05, 7.7778e+05,
         7.9193e+05, 3.8811e+05, 7.6078e+05, 3.8810e+05, 3.8813e+05, 7.8388e+05,
         0.0000e+00, 3.8815e+05, 3.8813e+05, 7.5148e+05, 3.8811e+05, 3.8812e+05],
        [1.1432e+00, 1.4624e+00, 4.0172e+05, 4.0031e+05, 1.4065e+00, 3.9507e+05,
         4.0173e+05, 1.2829e+00, 3.9268e+05, 1.2206e+00, 1.3990e+00, 4.0305e+05,
         3.8815e+05, 0.0000e+00, 1.3788e+00, 3.8177e+05, 1.1961e+00, 1.3556e+00],
        [1.2230e+00, 9.7187e-01, 4.0174e+05, 4.0031e+05, 9.5382e-01, 3.9508e+05,
         4.0171e+05, 1.3491e+00, 3.9266e+05, 1.1328e+00, 9.3894e-01, 4.0304e+05,
         3.8813e+05, 1.3788e+00, 0.0000e+00, 3.8178e+05, 1.3822e+00, 9.3273e-01],
        [3.8179e+05, 3.8178e+05, 7.8832e+05, 7.7282e+05, 3.8175e+05, 7.6723e+05,
         7.8660e+05, 3.8177e+05, 7.8691e+05, 3.8179e+05, 3.8178e+05, 7.9735e+05,
         7.5148e+05, 3.8177e+05, 3.8178e+05, 0.0000e+00, 3.8177e+05, 3.8176e+05],
        [1.2537e+00, 1.4351e+00, 4.0174e+05, 4.0033e+05, 1.4996e+00, 3.9505e+05,
         4.0172e+05, 1.1378e+00, 3.9265e+05, 1.2383e+00, 1.4763e+00, 4.0306e+05,
         3.8811e+05, 1.1961e+00, 1.3822e+00, 3.8177e+05, 0.0000e+00, 1.3439e+00],
        [1.2220e+00, 1.0043e+00, 4.0175e+05, 4.0030e+05, 1.0232e+00, 3.9507e+05,
         4.0172e+05, 1.3949e+00, 3.9267e+05, 1.1443e+00, 1.0501e+00, 4.0304e+05,
         3.8812e+05, 1.3556e+00, 9.3273e-01, 3.8176e+05, 1.3439e+00, 0.0000e+00]])
Krum scores: ['1.22', '1.15', '401743.34', '400306.53', '1.14', '395055.41', '401705.00', '1.31', '392656.41', '1.14', '1.10', '403049.66', '388115.44', '1.30', '1.11', '381770.84', '1.31', '1.13']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:31...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:30:31, End: 2025-07-22 15:30:31)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 3, 11, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.1654e+00, 3.9242e+05, 3.7438e+05, 1.1290e+00, 1.1717e+00,
         3.7091e+05, 4.0143e+05, 1.1276e+00, 3.9100e+05, 1.4944e+00, 1.1392e+00,
         3.8462e+05, 1.2241e+00, 1.0730e+00],
        [1.1654e+00, 0.0000e+00, 3.9240e+05, 3.7439e+05, 8.5657e-01, 8.2909e-01,
         3.7091e+05, 4.0143e+05, 1.2011e+00, 3.9100e+05, 1.1018e+00, 1.2632e+00,
         3.8463e+05, 1.2718e+00, 8.8720e-01],
        [3.9242e+05, 3.9240e+05, 0.0000e+00, 7.8272e+05, 3.9239e+05, 3.9240e+05,
         7.5515e+05, 7.9231e+05, 3.9240e+05, 7.7740e+05, 3.9240e+05, 3.9242e+05,
         7.7025e+05, 3.9242e+05, 3.9241e+05],
        [3.7438e+05, 3.7439e+05, 7.8272e+05, 0.0000e+00, 3.7438e+05, 3.7440e+05,
         7.5947e+05, 7.6774e+05, 3.7438e+05, 7.6431e+05, 3.7441e+05, 3.7438e+05,
         7.6679e+05, 3.7437e+05, 3.7439e+05],
        [1.1290e+00, 8.5657e-01, 3.9239e+05, 3.7438e+05, 0.0000e+00, 8.1115e-01,
         3.7092e+05, 4.0139e+05, 1.1769e+00, 3.9098e+05, 1.0339e+00, 1.2628e+00,
         3.8464e+05, 1.2550e+00, 9.0810e-01],
        [1.1717e+00, 8.2909e-01, 3.9240e+05, 3.7440e+05, 8.1115e-01, 0.0000e+00,
         3.7092e+05, 4.0140e+05, 1.2084e+00, 3.9100e+05, 1.0067e+00, 1.2600e+00,
         3.8461e+05, 1.3506e+00, 9.3076e-01],
        [3.7091e+05, 3.7091e+05, 7.5515e+05, 7.5947e+05, 3.7092e+05, 3.7092e+05,
         0.0000e+00, 7.6931e+05, 3.7089e+05, 7.6270e+05, 3.7092e+05, 3.7088e+05,
         7.6973e+05, 3.7089e+05, 3.7090e+05],
        [4.0143e+05, 4.0143e+05, 7.9231e+05, 7.6774e+05, 4.0139e+05, 4.0140e+05,
         7.6931e+05, 0.0000e+00, 4.0142e+05, 7.7947e+05, 4.0144e+05, 4.0142e+05,
         7.8346e+05, 4.0141e+05, 4.0143e+05],
        [1.1276e+00, 1.2011e+00, 3.9240e+05, 3.7438e+05, 1.1769e+00, 1.2084e+00,
         3.7089e+05, 4.0142e+05, 0.0000e+00, 3.9103e+05, 1.6517e+00, 1.1214e+00,
         3.8462e+05, 1.1150e+00, 1.1647e+00],
        [3.9100e+05, 3.9100e+05, 7.7740e+05, 7.6431e+05, 3.9098e+05, 3.9100e+05,
         7.6270e+05, 7.7947e+05, 3.9103e+05, 0.0000e+00, 3.9100e+05, 3.9102e+05,
         7.7413e+05, 3.9098e+05, 3.9098e+05],
        [1.4944e+00, 1.1018e+00, 3.9240e+05, 3.7441e+05, 1.0339e+00, 1.0067e+00,
         3.7092e+05, 4.0144e+05, 1.6517e+00, 3.9100e+05, 0.0000e+00, 1.8320e+00,
         3.8460e+05, 1.9139e+00, 1.2578e+00],
        [1.1392e+00, 1.2632e+00, 3.9242e+05, 3.7438e+05, 1.2628e+00, 1.2600e+00,
         3.7088e+05, 4.0142e+05, 1.1214e+00, 3.9102e+05, 1.8320e+00, 0.0000e+00,
         3.8462e+05, 1.1441e+00, 1.2391e+00],
        [3.8462e+05, 3.8463e+05, 7.7025e+05, 7.6679e+05, 3.8464e+05, 3.8461e+05,
         7.6973e+05, 7.8346e+05, 3.8462e+05, 7.7413e+05, 3.8460e+05, 3.8462e+05,
         0.0000e+00, 3.8461e+05, 3.8463e+05],
        [1.2241e+00, 1.2718e+00, 3.9242e+05, 3.7437e+05, 1.2550e+00, 1.3506e+00,
         3.7089e+05, 4.0141e+05, 1.1150e+00, 3.9098e+05, 1.9139e+00, 1.1441e+00,
         3.8461e+05, 0.0000e+00, 1.2022e+00],
        [1.0730e+00, 8.8720e-01, 3.9241e+05, 3.7439e+05, 9.0810e-01, 9.3076e-01,
         3.7090e+05, 4.0143e+05, 1.1647e+00, 3.9098e+05, 1.2578e+00, 1.2391e+00,
         3.8463e+05, 1.2022e+00, 0.0000e+00]])
Krum scores: ['1.15', '1.04', '392401.12', '374381.41', '1.02', '1.03', '370900.66', '401413.47', '1.16', '390991.12', '1.34', '1.20', '384615.06', '1.22', '1.06']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 3, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0032s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:32...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:32, End: 2025-07-22 15:30:32)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 17, 1, 9, 18, 4, 3, 13, 14, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.1065e+00, 1.1547e+00, 3.9793e+05, 3.8863e+05, 1.4627e+00,
         1.0844e+00, 4.0067e+05, 1.0272e+00, 1.1646e+00, 3.9067e+05, 4.0056e+05,
         3.8069e+05, 1.1102e+00, 1.0592e+00],
        [1.1065e+00, 0.0000e+00, 1.2989e+00, 3.9791e+05, 3.8865e+05, 1.8129e+00,
         1.2331e+00, 4.0066e+05, 1.1003e+00, 1.4754e+00, 3.9063e+05, 4.0058e+05,
         3.8067e+05, 1.0672e+00, 1.2311e+00],
        [1.1547e+00, 1.2989e+00, 0.0000e+00, 3.9795e+05, 3.8865e+05, 1.0872e+00,
         8.0374e-01, 4.0067e+05, 9.6324e-01, 8.6665e-01, 3.9067e+05, 4.0056e+05,
         3.8071e+05, 1.2151e+00, 8.9751e-01],
        [3.9793e+05, 3.9791e+05, 3.9795e+05, 0.0000e+00, 7.7049e+05, 3.9793e+05,
         3.9792e+05, 8.0016e+05, 3.9792e+05, 3.9794e+05, 7.8511e+05, 7.9733e+05,
         7.9433e+05, 3.9795e+05, 3.9794e+05],
        [3.8863e+05, 3.8865e+05, 3.8865e+05, 7.7049e+05, 0.0000e+00, 3.8866e+05,
         3.8864e+05, 7.9645e+05, 3.8863e+05, 3.8866e+05, 7.6993e+05, 7.9126e+05,
         7.5611e+05, 3.8862e+05, 3.8862e+05],
        [1.4627e+00, 1.8129e+00, 1.0872e+00, 3.9793e+05, 3.8866e+05, 0.0000e+00,
         9.7361e-01, 4.0065e+05, 1.2766e+00, 7.9780e-01, 3.9065e+05, 4.0053e+05,
         3.8068e+05, 1.7066e+00, 1.1555e+00],
        [1.0844e+00, 1.2331e+00, 8.0374e-01, 3.9792e+05, 3.8864e+05, 9.7361e-01,
         0.0000e+00, 4.0065e+05, 9.5426e-01, 7.8170e-01, 3.9062e+05, 4.0057e+05,
         3.8070e+05, 1.2246e+00, 8.9167e-01],
        [4.0067e+05, 4.0066e+05, 4.0067e+05, 8.0016e+05, 7.9645e+05, 4.0065e+05,
         4.0065e+05, 0.0000e+00, 4.0068e+05, 4.0066e+05, 8.0057e+05, 7.9398e+05,
         7.7472e+05, 4.0066e+05, 4.0066e+05],
        [1.0272e+00, 1.1003e+00, 9.6324e-01, 3.9792e+05, 3.8863e+05, 1.2766e+00,
         9.5426e-01, 4.0068e+05, 0.0000e+00, 9.6191e-01, 3.9065e+05, 4.0060e+05,
         3.8070e+05, 1.0977e+00, 1.0014e+00],
        [1.1646e+00, 1.4754e+00, 8.6665e-01, 3.9794e+05, 3.8866e+05, 7.9780e-01,
         7.8170e-01, 4.0066e+05, 9.6191e-01, 0.0000e+00, 3.9066e+05, 4.0055e+05,
         3.8068e+05, 1.4757e+00, 9.5980e-01],
        [3.9067e+05, 3.9063e+05, 3.9067e+05, 7.8511e+05, 7.6993e+05, 3.9065e+05,
         3.9062e+05, 8.0057e+05, 3.9065e+05, 3.9066e+05, 0.0000e+00, 7.7423e+05,
         7.7231e+05, 3.9064e+05, 3.9066e+05],
        [4.0056e+05, 4.0058e+05, 4.0056e+05, 7.9733e+05, 7.9126e+05, 4.0053e+05,
         4.0057e+05, 7.9398e+05, 4.0060e+05, 4.0055e+05, 7.7423e+05, 0.0000e+00,
         7.6690e+05, 4.0054e+05, 4.0055e+05],
        [3.8069e+05, 3.8067e+05, 3.8071e+05, 7.9433e+05, 7.5611e+05, 3.8068e+05,
         3.8070e+05, 7.7472e+05, 3.8070e+05, 3.8068e+05, 7.7231e+05, 7.6690e+05,
         0.0000e+00, 3.8069e+05, 3.8069e+05],
        [1.1102e+00, 1.0672e+00, 1.2151e+00, 3.9795e+05, 3.8862e+05, 1.7066e+00,
         1.2246e+00, 4.0066e+05, 1.0977e+00, 1.4757e+00, 3.9064e+05, 4.0054e+05,
         3.8069e+05, 0.0000e+00, 1.1520e+00],
        [1.0592e+00, 1.2311e+00, 8.9751e-01, 3.9794e+05, 3.8862e+05, 1.1555e+00,
         8.9167e-01, 4.0066e+05, 1.0014e+00, 9.5980e-01, 3.9066e+05, 4.0055e+05,
         3.8069e+05, 1.1520e+00, 0.0000e+00]])
Krum scores: ['1.10', '1.22', '1.00', '397926.12', '388634.75', '1.21', '0.96', '400658.25', '1.02', '1.00', '390645.31', '400549.97', '380685.56', '1.19', '1.02']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 18, 4, 3, 13, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0032s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:32...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[167  70]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:30:32, End: 2025-07-22 15:30:32)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 9, 20, 18, 8, 15, 4, 3, 13, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0850e+00, 1.1602e+00, 3.8979e+05, 1.3988e+00, 3.9553e+05,
         3.8616e+05, 1.0720e+00, 3.8191e+05, 1.0226e+00, 1.1160e+00, 3.8976e+05,
         1.1068e+00, 3.8649e+05, 1.1231e+00, 1.0612e+00],
        [1.0850e+00, 0.0000e+00, 1.2786e+00, 3.8980e+05, 1.5838e+00, 3.9553e+05,
         3.8614e+05, 1.0195e+00, 3.8191e+05, 1.0625e+00, 1.3387e+00, 3.8978e+05,
         1.1568e+00, 3.8650e+05, 1.0556e+00, 1.1616e+00],
        [1.1602e+00, 1.2786e+00, 0.0000e+00, 3.8981e+05, 9.0506e-01, 3.9550e+05,
         3.8614e+05, 1.2000e+00, 3.8191e+05, 9.6903e-01, 7.7569e-01, 3.8976e+05,
         8.7040e-01, 3.8648e+05, 1.2397e+00, 8.7977e-01],
        [3.8979e+05, 3.8980e+05, 3.8981e+05, 0.0000e+00, 3.8980e+05, 8.0960e+05,
         7.8237e+05, 3.8980e+05, 7.7935e+05, 3.8975e+05, 3.8979e+05, 7.8631e+05,
         3.8982e+05, 7.8120e+05, 3.8978e+05, 3.8980e+05],
        [1.3988e+00, 1.5838e+00, 9.0506e-01, 3.8980e+05, 0.0000e+00, 3.9549e+05,
         3.8615e+05, 1.4559e+00, 3.8195e+05, 1.1727e+00, 7.2128e-01, 3.8974e+05,
         1.0255e+00, 3.8647e+05, 1.5821e+00, 1.0510e+00],
        [3.9553e+05, 3.9553e+05, 3.9550e+05, 8.0960e+05, 3.9549e+05, 0.0000e+00,
         7.8605e+05, 3.9552e+05, 7.7734e+05, 3.9553e+05, 3.9550e+05, 7.8747e+05,
         3.9549e+05, 7.7116e+05, 3.9552e+05, 3.9548e+05],
        [3.8616e+05, 3.8614e+05, 3.8614e+05, 7.8237e+05, 3.8615e+05, 7.8605e+05,
         0.0000e+00, 3.8615e+05, 7.8826e+05, 3.8617e+05, 3.8615e+05, 7.5735e+05,
         3.8615e+05, 7.7133e+05, 3.8614e+05, 3.8614e+05],
        [1.0720e+00, 1.0195e+00, 1.2000e+00, 3.8980e+05, 1.4559e+00, 3.9552e+05,
         3.8615e+05, 0.0000e+00, 3.8190e+05, 1.0003e+00, 1.1838e+00, 3.8976e+05,
         1.1170e+00, 3.8652e+05, 1.0327e+00, 1.1138e+00],
        [3.8191e+05, 3.8191e+05, 3.8191e+05, 7.7935e+05, 3.8195e+05, 7.7734e+05,
         7.8826e+05, 3.8190e+05, 0.0000e+00, 3.8192e+05, 3.8193e+05, 7.7161e+05,
         3.8190e+05, 7.8089e+05, 3.8190e+05, 3.8191e+05],
        [1.0226e+00, 1.0625e+00, 9.6903e-01, 3.8975e+05, 1.1727e+00, 3.9553e+05,
         3.8617e+05, 1.0003e+00, 3.8192e+05, 0.0000e+00, 9.2595e-01, 3.8977e+05,
         1.0242e+00, 3.8647e+05, 1.0644e+00, 9.9518e-01],
        [1.1160e+00, 1.3387e+00, 7.7569e-01, 3.8979e+05, 7.2128e-01, 3.9550e+05,
         3.8615e+05, 1.1838e+00, 3.8193e+05, 9.2595e-01, 0.0000e+00, 3.8975e+05,
         8.3581e-01, 3.8648e+05, 1.3635e+00, 8.8416e-01],
        [3.8976e+05, 3.8978e+05, 3.8976e+05, 7.8631e+05, 3.8974e+05, 7.8747e+05,
         7.5735e+05, 3.8976e+05, 7.7161e+05, 3.8977e+05, 3.8975e+05, 0.0000e+00,
         3.8977e+05, 7.9282e+05, 3.8979e+05, 3.8977e+05],
        [1.1068e+00, 1.1568e+00, 8.7040e-01, 3.8982e+05, 1.0255e+00, 3.9549e+05,
         3.8615e+05, 1.1170e+00, 3.8190e+05, 1.0242e+00, 8.3581e-01, 3.8977e+05,
         0.0000e+00, 3.8647e+05, 1.2158e+00, 8.6758e-01],
        [3.8649e+05, 3.8650e+05, 3.8648e+05, 7.8120e+05, 3.8647e+05, 7.7116e+05,
         7.7133e+05, 3.8652e+05, 7.8089e+05, 3.8647e+05, 3.8648e+05, 7.9282e+05,
         3.8647e+05, 0.0000e+00, 3.8650e+05, 3.8648e+05],
        [1.1231e+00, 1.0556e+00, 1.2397e+00, 3.8978e+05, 1.5821e+00, 3.9552e+05,
         3.8614e+05, 1.0327e+00, 3.8190e+05, 1.0644e+00, 1.3635e+00, 3.8979e+05,
         1.2158e+00, 3.8650e+05, 0.0000e+00, 1.1203e+00],
        [1.0612e+00, 1.1616e+00, 8.7977e-01, 3.8980e+05, 1.0510e+00, 3.9548e+05,
         3.8614e+05, 1.1138e+00, 3.8191e+05, 9.9518e-01, 8.8416e-01, 3.8977e+05,
         8.6758e-01, 3.8648e+05, 1.1203e+00, 0.0000e+00]])
Krum scores: ['1.09', '1.14', '1.00', '389789.25', '1.16', '395503.88', '386144.66', '1.09', '381907.22', '1.01', '0.97', '389758.56', '1.00', '386478.69', '1.15', '1.00']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 9, 20, 18, 8, 15, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:33...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:33, End: 2025-07-22 15:30:33)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 1, 20, 18, 8, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.0551e+00, 1.0662e+00, 9.8544e-01, 3.8212e+05, 3.9975e+05,
         1.0344e+00, 9.7204e-01, 1.5118e+00, 3.8102e+05, 3.9322e+05, 1.0259e+00,
         3.8389e+05, 1.0882e+00, 9.6100e-01],
        [1.0551e+00, 0.0000e+00, 1.2064e+00, 1.1891e+00, 3.8213e+05, 3.9973e+05,
         1.0274e+00, 1.0133e+00, 1.8505e+00, 3.8100e+05, 3.9319e+05, 9.4541e-01,
         3.8388e+05, 1.0301e+00, 1.0915e+00],
        [1.0662e+00, 1.2064e+00, 0.0000e+00, 7.3327e-01, 3.8214e+05, 3.9973e+05,
         1.1063e+00, 9.1231e-01, 1.0479e+00, 3.8100e+05, 3.9321e+05, 1.1756e+00,
         3.8391e+05, 1.1641e+00, 8.6303e-01],
        [9.8544e-01, 1.1891e+00, 7.3327e-01, 0.0000e+00, 3.8213e+05, 3.9973e+05,
         1.0445e+00, 8.5815e-01, 7.9792e-01, 3.8101e+05, 3.9323e+05, 1.1527e+00,
         3.8390e+05, 1.1378e+00, 7.8512e-01],
        [3.8212e+05, 3.8213e+05, 3.8214e+05, 3.8213e+05, 0.0000e+00, 7.8203e+05,
         3.8212e+05, 3.8213e+05, 3.8214e+05, 7.7060e+05, 7.7165e+05, 3.8213e+05,
         7.5478e+05, 3.8213e+05, 3.8215e+05],
        [3.9975e+05, 3.9973e+05, 3.9973e+05, 3.9973e+05, 7.8203e+05, 0.0000e+00,
         3.9974e+05, 3.9976e+05, 3.9975e+05, 7.7598e+05, 7.8437e+05, 3.9976e+05,
         7.8893e+05, 3.9973e+05, 3.9975e+05],
        [1.0344e+00, 1.0274e+00, 1.1063e+00, 1.0445e+00, 3.8212e+05, 3.9974e+05,
         0.0000e+00, 9.4757e-01, 1.6016e+00, 3.8101e+05, 3.9320e+05, 1.0485e+00,
         3.8387e+05, 1.0182e+00, 1.0152e+00],
        [9.7204e-01, 1.0133e+00, 9.1231e-01, 8.5815e-01, 3.8213e+05, 3.9976e+05,
         9.4757e-01, 0.0000e+00, 1.3159e+00, 3.8100e+05, 3.9321e+05, 9.9346e-01,
         3.8389e+05, 1.0189e+00, 9.3430e-01],
        [1.5118e+00, 1.8505e+00, 1.0479e+00, 7.9792e-01, 3.8214e+05, 3.9975e+05,
         1.6016e+00, 1.3159e+00, 0.0000e+00, 3.8102e+05, 3.9322e+05, 1.8040e+00,
         3.8391e+05, 1.8520e+00, 1.1866e+00],
        [3.8102e+05, 3.8100e+05, 3.8100e+05, 3.8101e+05, 7.7060e+05, 7.7598e+05,
         3.8101e+05, 3.8100e+05, 3.8102e+05, 0.0000e+00, 7.5771e+05, 3.8101e+05,
         7.7123e+05, 3.8099e+05, 3.8101e+05],
        [3.9322e+05, 3.9319e+05, 3.9321e+05, 3.9323e+05, 7.7165e+05, 7.8437e+05,
         3.9320e+05, 3.9321e+05, 3.9322e+05, 7.5771e+05, 0.0000e+00, 3.9321e+05,
         7.7377e+05, 3.9321e+05, 3.9322e+05],
        [1.0259e+00, 9.4541e-01, 1.1756e+00, 1.1527e+00, 3.8213e+05, 3.9976e+05,
         1.0485e+00, 9.9346e-01, 1.8040e+00, 3.8101e+05, 3.9321e+05, 0.0000e+00,
         3.8390e+05, 1.0378e+00, 1.1008e+00],
        [3.8389e+05, 3.8388e+05, 3.8391e+05, 3.8390e+05, 7.5478e+05, 7.8893e+05,
         3.8387e+05, 3.8389e+05, 3.8391e+05, 7.7123e+05, 7.7377e+05, 3.8390e+05,
         0.0000e+00, 3.8387e+05, 3.8387e+05],
        [1.0882e+00, 1.0301e+00, 1.1641e+00, 1.1378e+00, 3.8213e+05, 3.9973e+05,
         1.0182e+00, 1.0189e+00, 1.8520e+00, 3.8099e+05, 3.9321e+05, 1.0378e+00,
         3.8387e+05, 0.0000e+00, 1.0676e+00],
        [9.6100e-01, 1.0915e+00, 8.6303e-01, 7.8512e-01, 3.8215e+05, 3.9975e+05,
         1.0152e+00, 9.3430e-01, 1.1866e+00, 3.8101e+05, 3.9322e+05, 1.1008e+00,
         3.8387e+05, 1.0676e+00, 0.0000e+00]])
Krum scores: ['1.02', '1.07', '1.01', '0.94', '382128.47', '399739.34', '1.03', '0.96', '1.39', '381003.28', '393208.53', '1.06', '383884.38', '1.07', '0.98']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 1, 20, 18, 8, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0031s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:33...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:33, End: 2025-07-22 15:30:33)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [7, 19, 17, 1, 18, 8, 4, 3, 13, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 3.9472e+05, 4.0209e+05, 1.6097e+00, 3.9988e+05, 1.0226e+00,
         9.8715e-01, 1.3428e+00, 3.9342e+05, 3.8611e+05, 1.0237e+00, 1.0746e+00],
        [3.9472e+05, 0.0000e+00, 7.9630e+05, 3.9473e+05, 7.9428e+05, 3.9471e+05,
         3.9471e+05, 3.9473e+05, 7.8621e+05, 7.7651e+05, 3.9470e+05, 3.9472e+05],
        [4.0209e+05, 7.9630e+05, 0.0000e+00, 4.0206e+05, 8.0129e+05, 4.0206e+05,
         4.0205e+05, 4.0203e+05, 7.8629e+05, 7.7405e+05, 4.0209e+05, 4.0206e+05],
        [1.6097e+00, 3.9473e+05, 4.0206e+05, 0.0000e+00, 3.9989e+05, 1.4688e+00,
         1.1960e+00, 5.9340e-01, 3.9341e+05, 3.8608e+05, 1.5017e+00, 1.0240e+00],
        [3.9988e+05, 7.9428e+05, 8.0129e+05, 3.9989e+05, 0.0000e+00, 3.9988e+05,
         3.9990e+05, 3.9991e+05, 7.8522e+05, 7.7614e+05, 3.9987e+05, 3.9990e+05],
        [1.0226e+00, 3.9471e+05, 4.0206e+05, 1.4688e+00, 3.9988e+05, 0.0000e+00,
         9.6072e-01, 1.1992e+00, 3.9344e+05, 3.8611e+05, 1.0175e+00, 1.0420e+00],
        [9.8715e-01, 3.9471e+05, 4.0205e+05, 1.1960e+00, 3.9990e+05, 9.6072e-01,
         0.0000e+00, 9.1813e-01, 3.9345e+05, 3.8611e+05, 1.0235e+00, 9.3170e-01],
        [1.3428e+00, 3.9473e+05, 4.0203e+05, 5.9340e-01, 3.9991e+05, 1.1992e+00,
         9.1813e-01, 0.0000e+00, 3.9343e+05, 3.8609e+05, 1.3137e+00, 8.4916e-01],
        [3.9342e+05, 7.8621e+05, 7.8629e+05, 3.9341e+05, 7.8522e+05, 3.9344e+05,
         3.9345e+05, 3.9343e+05, 0.0000e+00, 7.8112e+05, 3.9342e+05, 3.9342e+05],
        [3.8611e+05, 7.7651e+05, 7.7405e+05, 3.8608e+05, 7.7614e+05, 3.8611e+05,
         3.8611e+05, 3.8609e+05, 7.8112e+05, 0.0000e+00, 3.8611e+05, 3.8608e+05],
        [1.0237e+00, 3.9470e+05, 4.0209e+05, 1.5017e+00, 3.9987e+05, 1.0175e+00,
         1.0235e+00, 1.3137e+00, 3.9342e+05, 3.8611e+05, 0.0000e+00, 1.0383e+00],
        [1.0746e+00, 3.9472e+05, 4.0206e+05, 1.0240e+00, 3.9990e+05, 1.0420e+00,
         9.3170e-01, 8.4916e-01, 3.9342e+05, 3.8608e+05, 1.0383e+00, 0.0000e+00]])
Krum scores: ['1.09', '394713.34', '402052.81', '1.16', '399885.91', '1.05', '0.96', '0.97', '393420.81', '386093.72', '1.08', '0.98']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [7, 19, 17, 1, 18, 8, 4, 3, 13, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0214s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:34...
global Accuracy on shared test data: 72.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 77 186]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:34, End: 2025-07-22 15:30:34)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.0528e+00, 1.0337e+00, 3.8504e+05, 3.9146e+05, 1.1677e+00,
         1.0898e+00, 3.9844e+05, 3.8174e+05, 1.0290e+00, 3.9228e+05, 1.2054e+00,
         1.1534e+00, 3.9377e+05, 3.9257e+05, 9.8760e-01, 3.7736e+05, 1.0877e+00,
         9.6075e-01],
        [1.0528e+00, 0.0000e+00, 1.1891e+00, 3.8506e+05, 3.9144e+05, 1.4470e+00,
         1.2749e+00, 3.9844e+05, 3.8176e+05, 1.0244e+00, 3.9225e+05, 1.4085e+00,
         1.4613e+00, 3.9382e+05, 3.9258e+05, 9.4540e-01, 3.7736e+05, 1.0598e+00,
         1.1240e+00],
        [1.0337e+00, 1.1891e+00, 0.0000e+00, 3.8506e+05, 3.9144e+05, 7.6690e-01,
         6.9732e-01, 3.9844e+05, 3.8175e+05, 1.1481e+00, 3.9227e+05, 8.7009e-01,
         7.7047e-01, 3.9379e+05, 3.9258e+05, 1.1398e+00, 3.7735e+05, 1.2000e+00,
         8.4895e-01],
        [3.8504e+05, 3.8506e+05, 3.8506e+05, 0.0000e+00, 7.7398e+05, 3.8506e+05,
         3.8504e+05, 7.8386e+05, 7.7880e+05, 3.8507e+05, 7.7129e+05, 3.8505e+05,
         3.8504e+05, 7.6199e+05, 7.8021e+05, 3.8506e+05, 7.5363e+05, 3.8506e+05,
         3.8504e+05],
        [3.9146e+05, 3.9144e+05, 3.9144e+05, 7.7398e+05, 0.0000e+00, 3.9144e+05,
         3.9144e+05, 7.9603e+05, 7.8110e+05, 3.9143e+05, 7.9389e+05, 3.9145e+05,
         3.9146e+05, 7.7834e+05, 7.6140e+05, 3.9144e+05, 7.7111e+05, 3.9147e+05,
         3.9145e+05],
        [1.1677e+00, 1.4470e+00, 7.6690e-01, 3.8506e+05, 3.9144e+05, 0.0000e+00,
         5.4545e-01, 3.9844e+05, 3.8177e+05, 1.3478e+00, 3.9230e+05, 7.2756e-01,
         4.8779e-01, 3.9375e+05, 3.9258e+05, 1.3451e+00, 3.7737e+05, 1.4243e+00,
         8.9433e-01],
        [1.0898e+00, 1.2749e+00, 6.9732e-01, 3.8504e+05, 3.9144e+05, 5.4545e-01,
         0.0000e+00, 3.9846e+05, 3.8177e+05, 1.2199e+00, 3.9228e+05, 7.7834e-01,
         5.3370e-01, 3.9378e+05, 3.9260e+05, 1.2038e+00, 3.7738e+05, 1.3245e+00,
         8.5689e-01],
        [3.9844e+05, 3.9844e+05, 3.9844e+05, 7.8386e+05, 7.9603e+05, 3.9844e+05,
         3.9846e+05, 0.0000e+00, 7.6523e+05, 3.9846e+05, 7.9445e+05, 3.9847e+05,
         3.9845e+05, 7.7133e+05, 7.8805e+05, 3.9845e+05, 7.6105e+05, 3.9843e+05,
         3.9846e+05],
        [3.8174e+05, 3.8176e+05, 3.8175e+05, 7.7880e+05, 7.8110e+05, 3.8177e+05,
         3.8177e+05, 7.6523e+05, 0.0000e+00, 3.8176e+05, 7.7202e+05, 3.8176e+05,
         3.8177e+05, 7.6936e+05, 7.5176e+05, 3.8176e+05, 7.4887e+05, 3.8175e+05,
         3.8175e+05],
        [1.0290e+00, 1.0244e+00, 1.1481e+00, 3.8507e+05, 3.9143e+05, 1.3478e+00,
         1.2199e+00, 3.9846e+05, 3.8176e+05, 0.0000e+00, 3.9227e+05, 1.3241e+00,
         1.3441e+00, 3.9383e+05, 3.9259e+05, 9.8743e-01, 3.7734e+05, 1.0444e+00,
         1.0898e+00],
        [3.9228e+05, 3.9225e+05, 3.9227e+05, 7.7129e+05, 7.9389e+05, 3.9230e+05,
         3.9228e+05, 7.9445e+05, 7.7202e+05, 3.9227e+05, 0.0000e+00, 3.9229e+05,
         3.9230e+05, 7.6257e+05, 7.8000e+05, 3.9227e+05, 7.8226e+05, 3.9225e+05,
         3.9228e+05],
        [1.2054e+00, 1.4085e+00, 8.7009e-01, 3.8505e+05, 3.9145e+05, 7.2756e-01,
         7.7834e-01, 3.9847e+05, 3.8176e+05, 1.3241e+00, 3.9229e+05, 0.0000e+00,
         7.2151e-01, 3.9377e+05, 3.9259e+05, 1.3583e+00, 3.7735e+05, 1.4227e+00,
         1.0307e+00],
        [1.1534e+00, 1.4613e+00, 7.7047e-01, 3.8504e+05, 3.9146e+05, 4.8779e-01,
         5.3370e-01, 3.9845e+05, 3.8177e+05, 1.3441e+00, 3.9230e+05, 7.2151e-01,
         0.0000e+00, 3.9378e+05, 3.9259e+05, 1.4111e+00, 3.7739e+05, 1.5058e+00,
         9.1413e-01],
        [3.9377e+05, 3.9382e+05, 3.9379e+05, 7.6199e+05, 7.7834e+05, 3.9375e+05,
         3.9378e+05, 7.7133e+05, 7.6936e+05, 3.9383e+05, 7.6257e+05, 3.9377e+05,
         3.9378e+05, 0.0000e+00, 7.7781e+05, 3.9380e+05, 7.5775e+05, 3.9379e+05,
         3.9378e+05],
        [3.9257e+05, 3.9258e+05, 3.9258e+05, 7.8021e+05, 7.6140e+05, 3.9258e+05,
         3.9260e+05, 7.8805e+05, 7.5176e+05, 3.9259e+05, 7.8000e+05, 3.9259e+05,
         3.9259e+05, 7.7781e+05, 0.0000e+00, 3.9259e+05, 7.8191e+05, 3.9261e+05,
         3.9258e+05],
        [9.8760e-01, 9.4540e-01, 1.1398e+00, 3.8506e+05, 3.9144e+05, 1.3451e+00,
         1.2038e+00, 3.9845e+05, 3.8176e+05, 9.8743e-01, 3.9227e+05, 1.3583e+00,
         1.4111e+00, 3.9380e+05, 3.9259e+05, 0.0000e+00, 3.7734e+05, 1.0050e+00,
         1.0819e+00],
        [3.7736e+05, 3.7736e+05, 3.7735e+05, 7.5363e+05, 7.7111e+05, 3.7737e+05,
         3.7738e+05, 7.6105e+05, 7.4887e+05, 3.7734e+05, 7.8226e+05, 3.7735e+05,
         3.7739e+05, 7.5775e+05, 7.8191e+05, 3.7734e+05, 0.0000e+00, 3.7736e+05,
         3.7736e+05],
        [1.0877e+00, 1.0598e+00, 1.2000e+00, 3.8506e+05, 3.9147e+05, 1.4243e+00,
         1.3245e+00, 3.9843e+05, 3.8175e+05, 1.0444e+00, 3.9225e+05, 1.4227e+00,
         1.5058e+00, 3.9379e+05, 3.9261e+05, 1.0050e+00, 3.7736e+05, 0.0000e+00,
         1.1156e+00],
        [9.6075e-01, 1.1240e+00, 8.4895e-01, 3.8504e+05, 3.9145e+05, 8.9433e-01,
         8.5689e-01, 3.9846e+05, 3.8175e+05, 1.0898e+00, 3.9228e+05, 1.0307e+00,
         9.1413e-01, 3.9378e+05, 3.9258e+05, 1.0819e+00, 3.7736e+05, 1.1156e+00,
         0.0000e+00]])
Krum scores: ['1.06', '1.17', '0.94', '385048.81', '391443.88', '0.97', '0.91', '398443.75', '381755.06', '1.13', '392270.22', '1.05', '0.98', '393778.94', '392583.97', '1.12', '377354.91', '1.19', '0.98']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0069s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:35...
global Accuracy on shared test data: 72.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:30:35, End: 2025-07-22 15:30:35)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.0088e+00, 1.0649e+00, 3.8832e+05, 3.9379e+05, 1.4714e+00,
         3.9414e+05, 4.0447e+05, 1.0238e+00, 3.9124e+05, 1.0096e+00, 1.1262e+00,
         3.9167e+05, 3.9252e+05, 9.8712e-01, 1.0140e+00, 1.0532e+00, 9.5925e-01],
        [1.0088e+00, 0.0000e+00, 1.1516e+00, 3.8831e+05, 3.9377e+05, 1.6849e+00,
         3.9414e+05, 4.0449e+05, 1.0294e+00, 3.9123e+05, 1.1138e+00, 1.3509e+00,
         3.9165e+05, 3.9250e+05, 9.3324e-01, 1.0513e+00, 1.0146e+00, 1.0729e+00],
        [1.0649e+00, 1.1516e+00, 0.0000e+00, 3.8835e+05, 3.9378e+05, 9.4900e-01,
         3.9414e+05, 4.0450e+05, 1.1248e+00, 3.9125e+05, 7.4994e-01, 7.3891e-01,
         3.9166e+05, 3.9251e+05, 1.1369e+00, 8.0520e-01, 1.0898e+00, 8.3511e-01],
        [3.8832e+05, 3.8831e+05, 3.8835e+05, 0.0000e+00, 7.7779e+05, 3.8832e+05,
         7.5229e+05, 7.9657e+05, 3.8832e+05, 7.7700e+05, 3.8831e+05, 3.8832e+05,
         7.8058e+05, 7.7709e+05, 3.8833e+05, 3.8832e+05, 3.8833e+05, 3.8832e+05],
        [3.9379e+05, 3.9377e+05, 3.9378e+05, 7.7779e+05, 0.0000e+00, 3.9381e+05,
         7.9642e+05, 7.8805e+05, 3.9376e+05, 7.9483e+05, 3.9380e+05, 3.9381e+05,
         7.7914e+05, 7.7528e+05, 3.9376e+05, 3.9379e+05, 3.9379e+05, 3.9379e+05],
        [1.4714e+00, 1.6849e+00, 9.4900e-01, 3.8832e+05, 3.9381e+05, 0.0000e+00,
         3.9415e+05, 4.0450e+05, 1.6061e+00, 3.9122e+05, 8.7806e-01, 6.2466e-01,
         3.9165e+05, 3.9249e+05, 1.6187e+00, 1.1250e+00, 1.6423e+00, 1.1219e+00],
        [3.9414e+05, 3.9414e+05, 3.9414e+05, 7.5229e+05, 7.9642e+05, 3.9415e+05,
         0.0000e+00, 7.8860e+05, 3.9414e+05, 8.1100e+05, 3.9415e+05, 3.9416e+05,
         7.7039e+05, 7.8155e+05, 3.9415e+05, 3.9414e+05, 3.9414e+05, 3.9417e+05],
        [4.0447e+05, 4.0449e+05, 4.0450e+05, 7.9657e+05, 7.8805e+05, 4.0450e+05,
         7.8860e+05, 0.0000e+00, 4.0448e+05, 7.9948e+05, 4.0450e+05, 4.0450e+05,
         7.9425e+05, 7.9585e+05, 4.0450e+05, 4.0449e+05, 4.0451e+05, 4.0451e+05],
        [1.0238e+00, 1.0294e+00, 1.1248e+00, 3.8832e+05, 3.9376e+05, 1.6061e+00,
         3.9414e+05, 4.0448e+05, 0.0000e+00, 3.9124e+05, 1.0724e+00, 1.2606e+00,
         3.9167e+05, 3.9248e+05, 9.9555e-01, 1.0328e+00, 9.8872e-01, 1.0490e+00],
        [3.9124e+05, 3.9123e+05, 3.9125e+05, 7.7700e+05, 7.9483e+05, 3.9122e+05,
         8.1100e+05, 7.9948e+05, 3.9124e+05, 0.0000e+00, 3.9126e+05, 3.9124e+05,
         7.6899e+05, 8.0285e+05, 3.9124e+05, 3.9124e+05, 3.9125e+05, 3.9122e+05],
        [1.0096e+00, 1.1138e+00, 7.4994e-01, 3.8831e+05, 3.9380e+05, 8.7806e-01,
         3.9415e+05, 4.0450e+05, 1.0724e+00, 3.9126e+05, 0.0000e+00, 6.6282e-01,
         3.9166e+05, 3.9251e+05, 1.1009e+00, 8.7139e-01, 1.0863e+00, 8.5327e-01],
        [1.1262e+00, 1.3509e+00, 7.3891e-01, 3.8832e+05, 3.9381e+05, 6.2466e-01,
         3.9416e+05, 4.0450e+05, 1.2606e+00, 3.9124e+05, 6.6282e-01, 0.0000e+00,
         3.9163e+05, 3.9251e+05, 1.3338e+00, 8.4306e-01, 1.3400e+00, 8.8272e-01],
        [3.9167e+05, 3.9165e+05, 3.9166e+05, 7.8058e+05, 7.7914e+05, 3.9165e+05,
         7.7039e+05, 7.9425e+05, 3.9167e+05, 7.6899e+05, 3.9166e+05, 3.9163e+05,
         0.0000e+00, 7.9348e+05, 3.9168e+05, 3.9167e+05, 3.9166e+05, 3.9163e+05],
        [3.9252e+05, 3.9250e+05, 3.9251e+05, 7.7709e+05, 7.7528e+05, 3.9249e+05,
         7.8155e+05, 7.9585e+05, 3.9248e+05, 8.0285e+05, 3.9251e+05, 3.9251e+05,
         7.9348e+05, 0.0000e+00, 3.9251e+05, 3.9249e+05, 3.9249e+05, 3.9253e+05],
        [9.8712e-01, 9.3324e-01, 1.1369e+00, 3.8833e+05, 3.9376e+05, 1.6187e+00,
         3.9415e+05, 4.0450e+05, 9.9555e-01, 3.9124e+05, 1.1009e+00, 1.3338e+00,
         3.9168e+05, 3.9251e+05, 0.0000e+00, 1.0671e+00, 9.6732e-01, 1.0284e+00],
        [1.0140e+00, 1.0513e+00, 8.0520e-01, 3.8832e+05, 3.9379e+05, 1.1250e+00,
         3.9414e+05, 4.0449e+05, 1.0328e+00, 3.9124e+05, 8.7139e-01, 8.4306e-01,
         3.9167e+05, 3.9249e+05, 1.0671e+00, 0.0000e+00, 1.0841e+00, 8.1374e-01],
        [1.0532e+00, 1.0146e+00, 1.0898e+00, 3.8833e+05, 3.9379e+05, 1.6423e+00,
         3.9414e+05, 4.0451e+05, 9.8872e-01, 3.9125e+05, 1.0863e+00, 1.3400e+00,
         3.9166e+05, 3.9249e+05, 9.6732e-01, 1.0841e+00, 0.0000e+00, 1.0020e+00],
        [9.5925e-01, 1.0729e+00, 8.3511e-01, 3.8832e+05, 3.9379e+05, 1.1219e+00,
         3.9417e+05, 4.0451e+05, 1.0490e+00, 3.9122e+05, 8.5327e-01, 8.8272e-01,
         3.9163e+05, 3.9253e+05, 1.0284e+00, 8.1374e-01, 1.0020e+00, 0.0000e+00]])
Krum scores: ['1.03', '1.08', '0.94', '388318.47', '393780.03', '1.23', '394144.47', '404493.91', '1.06', '391235.78', '0.92', '0.98', '391651.00', '392498.91', '1.06', '0.95', '1.07', '0.94']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0071s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:35...
global Accuracy on shared test data: 71.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 75 188]]
Function 'evaluate_global_model' executed in 0.0025 seconds (Start: 2025-07-22 15:30:35, End: 2025-07-22 15:30:35)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 9.9659e-01, 9.6406e-01, 3.9876e+05, 3.9338e+05, 9.9855e-01,
         1.0970e+00, 4.0464e+05, 4.0062e+05, 9.6384e-01, 3.9885e+05, 1.3842e+00,
         1.0041e+00, 3.8472e+05, 3.9527e+05, 9.6071e-01, 9.3042e-01, 3.9584e+05,
         1.0134e+00],
        [9.9659e-01, 0.0000e+00, 1.1261e+00, 3.9877e+05, 3.9339e+05, 1.2308e+00,
         1.3305e+00, 4.0464e+05, 4.0063e+05, 9.9931e-01, 3.9885e+05, 1.6469e+00,
         1.2803e+00, 3.8474e+05, 3.9527e+05, 9.4947e-01, 1.0132e+00, 3.9582e+05,
         9.8793e-01],
        [9.6406e-01, 1.1261e+00, 0.0000e+00, 3.9877e+05, 3.9335e+05, 7.0202e-01,
         7.0580e-01, 4.0463e+05, 4.0065e+05, 1.0315e+00, 3.9888e+05, 9.7653e-01,
         6.8127e-01, 3.8474e+05, 3.9527e+05, 1.0495e+00, 7.7227e-01, 3.9584e+05,
         1.0201e+00],
        [3.9876e+05, 3.9877e+05, 3.9877e+05, 0.0000e+00, 7.9926e+05, 3.9877e+05,
         3.9875e+05, 7.9697e+05, 7.7821e+05, 3.9875e+05, 7.9516e+05, 3.9876e+05,
         3.9876e+05, 7.8818e+05, 7.9242e+05, 3.9875e+05, 3.9877e+05, 7.7917e+05,
         3.9876e+05],
        [3.9338e+05, 3.9339e+05, 3.9335e+05, 7.9926e+05, 0.0000e+00, 3.9335e+05,
         3.9335e+05, 8.1321e+05, 7.7899e+05, 3.9335e+05, 7.8947e+05, 3.9335e+05,
         3.9336e+05, 7.8570e+05, 8.0411e+05, 3.9338e+05, 3.9336e+05, 7.8476e+05,
         3.9337e+05],
        [9.9855e-01, 1.2308e+00, 7.0202e-01, 3.9877e+05, 3.9335e+05, 0.0000e+00,
         4.9447e-01, 4.0466e+05, 4.0064e+05, 1.1389e+00, 3.9884e+05, 7.1118e-01,
         4.6415e-01, 3.8473e+05, 3.9529e+05, 1.1401e+00, 8.2865e-01, 3.9584e+05,
         1.1763e+00],
        [1.0970e+00, 1.3305e+00, 7.0580e-01, 3.9875e+05, 3.9335e+05, 4.9447e-01,
         0.0000e+00, 4.0466e+05, 4.0063e+05, 1.2323e+00, 3.9885e+05, 6.8667e-01,
         4.6857e-01, 3.8473e+05, 3.9528e+05, 1.2270e+00, 8.7583e-01, 3.9583e+05,
         1.2698e+00],
        [4.0464e+05, 4.0464e+05, 4.0463e+05, 7.9697e+05, 8.1321e+05, 4.0466e+05,
         4.0466e+05, 0.0000e+00, 8.1149e+05, 4.0466e+05, 7.9348e+05, 4.0468e+05,
         4.0466e+05, 7.9173e+05, 8.0576e+05, 4.0463e+05, 4.0465e+05, 7.8791e+05,
         4.0461e+05],
        [4.0062e+05, 4.0063e+05, 4.0065e+05, 7.7821e+05, 7.7899e+05, 4.0064e+05,
         4.0063e+05, 8.1149e+05, 0.0000e+00, 4.0061e+05, 8.1154e+05, 4.0062e+05,
         4.0065e+05, 7.9471e+05, 7.9236e+05, 4.0061e+05, 4.0065e+05, 7.8374e+05,
         4.0062e+05],
        [9.6384e-01, 9.9931e-01, 1.0315e+00, 3.9875e+05, 3.9335e+05, 1.1389e+00,
         1.2323e+00, 4.0466e+05, 4.0061e+05, 0.0000e+00, 3.9885e+05, 1.5459e+00,
         1.1548e+00, 3.8476e+05, 3.9527e+05, 9.4675e-01, 9.7260e-01, 3.9585e+05,
         9.3613e-01],
        [3.9885e+05, 3.9885e+05, 3.9888e+05, 7.9516e+05, 7.8947e+05, 3.9884e+05,
         3.9885e+05, 7.9348e+05, 8.1154e+05, 3.9885e+05, 0.0000e+00, 3.9887e+05,
         3.9885e+05, 7.9587e+05, 7.9407e+05, 3.9885e+05, 3.9885e+05, 7.8730e+05,
         3.9884e+05],
        [1.3842e+00, 1.6469e+00, 9.7653e-01, 3.9876e+05, 3.9335e+05, 7.1118e-01,
         6.8667e-01, 4.0468e+05, 4.0062e+05, 1.5459e+00, 3.9887e+05, 0.0000e+00,
         6.8466e-01, 3.8476e+05, 3.9529e+05, 1.5943e+00, 1.1824e+00, 3.9582e+05,
         1.5446e+00],
        [1.0041e+00, 1.2803e+00, 6.8127e-01, 3.9876e+05, 3.9336e+05, 4.6415e-01,
         4.6857e-01, 4.0466e+05, 4.0065e+05, 1.1548e+00, 3.9885e+05, 6.8466e-01,
         0.0000e+00, 3.8472e+05, 3.9527e+05, 1.2170e+00, 8.1165e-01, 3.9584e+05,
         1.2226e+00],
        [3.8472e+05, 3.8474e+05, 3.8474e+05, 7.8818e+05, 7.8570e+05, 3.8473e+05,
         3.8473e+05, 7.9173e+05, 7.9471e+05, 3.8476e+05, 7.9587e+05, 3.8476e+05,
         3.8472e+05, 0.0000e+00, 7.7854e+05, 3.8472e+05, 3.8472e+05, 7.8913e+05,
         3.8476e+05],
        [3.9527e+05, 3.9527e+05, 3.9527e+05, 7.9242e+05, 8.0411e+05, 3.9529e+05,
         3.9528e+05, 8.0576e+05, 7.9236e+05, 3.9527e+05, 7.9407e+05, 3.9529e+05,
         3.9527e+05, 7.7854e+05, 0.0000e+00, 3.9526e+05, 3.9527e+05, 8.0533e+05,
         3.9530e+05],
        [9.6071e-01, 9.4947e-01, 1.0495e+00, 3.9875e+05, 3.9338e+05, 1.1401e+00,
         1.2270e+00, 4.0463e+05, 4.0061e+05, 9.4675e-01, 3.9885e+05, 1.5943e+00,
         1.2170e+00, 3.8472e+05, 3.9526e+05, 0.0000e+00, 1.0117e+00, 3.9586e+05,
         9.5016e-01],
        [9.3042e-01, 1.0132e+00, 7.7227e-01, 3.9877e+05, 3.9336e+05, 8.2865e-01,
         8.7583e-01, 4.0465e+05, 4.0065e+05, 9.7260e-01, 3.9885e+05, 1.1824e+00,
         8.1165e-01, 3.8472e+05, 3.9527e+05, 1.0117e+00, 0.0000e+00, 3.9584e+05,
         1.0360e+00],
        [3.9584e+05, 3.9582e+05, 3.9584e+05, 7.7917e+05, 7.8476e+05, 3.9584e+05,
         3.9583e+05, 7.8791e+05, 7.8374e+05, 3.9585e+05, 7.8730e+05, 3.9582e+05,
         3.9584e+05, 7.8913e+05, 8.0533e+05, 3.9586e+05, 3.9584e+05, 0.0000e+00,
         3.9586e+05],
        [1.0134e+00, 9.8793e-01, 1.0201e+00, 3.9876e+05, 3.9337e+05, 1.1763e+00,
         1.2698e+00, 4.0461e+05, 4.0062e+05, 9.3613e-01, 3.9884e+05, 1.5446e+00,
         1.2226e+00, 3.8476e+05, 3.9530e+05, 9.5016e-01, 1.0360e+00, 3.9586e+05,
         0.0000e+00]])
Krum scores: ['0.99', '1.10', '0.88', '398759.41', '393357.53', '0.85', '0.90', '404642.62', '400626.41', '1.04', '398848.28', '1.15', '0.86', '384731.78', '395272.94', '1.05', '0.92', '395835.34', '1.07']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0096s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:36...
global Accuracy on shared test data: 73.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 76 187]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:30:36, End: 2025-07-22 15:30:36)
start time is: 97200861029888, end time is: 97218225829824
The total time is: 17364799936ns.

 ------- aggregate method: krum, random_seed: 100 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 4.3719e+00, 4.9602e+00, 3.9844e+05, 3.9625e+05, 5.8677e+00,
         3.8131e+05, 3.8355e+05, 4.6266e+00, 3.9289e+05, 3.8691e+05, 3.8472e+05,
         4.0173e+00, 4.8407e+00, 3.7675e+05, 4.7873e+00, 4.2941e+00],
        [4.3719e+00, 0.0000e+00, 4.3332e+00, 3.9844e+05, 3.9625e+05, 5.7784e+00,
         3.8131e+05, 3.8344e+05, 4.8194e+00, 3.9281e+05, 3.8694e+05, 3.8478e+05,
         4.4531e+00, 3.8843e+00, 3.7680e+05, 4.4524e+00, 4.4013e+00],
        [4.9602e+00, 4.3332e+00, 0.0000e+00, 3.9838e+05, 3.9626e+05, 5.6624e+00,
         3.8127e+05, 3.8350e+05, 5.6728e+00, 3.9287e+05, 3.8694e+05, 3.8472e+05,
         4.5883e+00, 4.1285e+00, 3.7688e+05, 4.7054e+00, 5.1378e+00],
        [3.9844e+05, 3.9844e+05, 3.9838e+05, 0.0000e+00, 7.8860e+05, 3.9834e+05,
         7.6809e+05, 7.9114e+05, 3.9838e+05, 7.8568e+05, 7.8307e+05, 7.8386e+05,
         3.9843e+05, 3.9836e+05, 7.8052e+05, 3.9842e+05, 3.9844e+05],
        [3.9625e+05, 3.9625e+05, 3.9626e+05, 7.8860e+05, 0.0000e+00, 3.9626e+05,
         7.7853e+05, 7.9154e+05, 3.9621e+05, 8.1097e+05, 7.8060e+05, 7.7915e+05,
         3.9626e+05, 3.9626e+05, 7.5335e+05, 3.9625e+05, 3.9625e+05],
        [5.8677e+00, 5.7784e+00, 5.6624e+00, 3.9834e+05, 3.9626e+05, 0.0000e+00,
         3.8131e+05, 3.8353e+05, 6.0426e+00, 3.9284e+05, 3.8700e+05, 3.8468e+05,
         5.5733e+00, 5.4652e+00, 3.7679e+05, 5.5813e+00, 6.3016e+00],
        [3.8131e+05, 3.8131e+05, 3.8127e+05, 7.6809e+05, 7.7853e+05, 3.8131e+05,
         0.0000e+00, 7.6152e+05, 3.8130e+05, 7.7527e+05, 7.7262e+05, 7.5670e+05,
         3.8127e+05, 3.8132e+05, 7.4073e+05, 3.8128e+05, 3.8130e+05],
        [3.8355e+05, 3.8344e+05, 3.8350e+05, 7.9114e+05, 7.9154e+05, 3.8353e+05,
         7.6152e+05, 0.0000e+00, 3.8357e+05, 7.6794e+05, 7.6767e+05, 7.7542e+05,
         3.8348e+05, 3.8355e+05, 7.7851e+05, 3.8351e+05, 3.8350e+05],
        [4.6266e+00, 4.8194e+00, 5.6728e+00, 3.9838e+05, 3.9621e+05, 6.0426e+00,
         3.8130e+05, 3.8357e+05, 0.0000e+00, 3.9289e+05, 3.8693e+05, 3.8473e+05,
         5.1848e+00, 4.6973e+00, 3.7674e+05, 5.0180e+00, 4.3619e+00],
        [3.9289e+05, 3.9281e+05, 3.9287e+05, 7.8568e+05, 8.1097e+05, 3.9284e+05,
         7.7527e+05, 7.6794e+05, 3.9289e+05, 0.0000e+00, 7.5296e+05, 7.7337e+05,
         3.9283e+05, 3.9284e+05, 7.6786e+05, 3.9287e+05, 3.9279e+05],
        [3.8691e+05, 3.8694e+05, 3.8694e+05, 7.8307e+05, 7.8060e+05, 3.8700e+05,
         7.7262e+05, 7.6767e+05, 3.8693e+05, 7.5296e+05, 0.0000e+00, 7.5867e+05,
         3.8696e+05, 3.8692e+05, 7.5216e+05, 3.8694e+05, 3.8696e+05],
        [3.8472e+05, 3.8478e+05, 3.8472e+05, 7.8386e+05, 7.7915e+05, 3.8468e+05,
         7.5670e+05, 7.7542e+05, 3.8473e+05, 7.7337e+05, 7.5867e+05, 0.0000e+00,
         3.8473e+05, 3.8470e+05, 7.5943e+05, 3.8471e+05, 3.8471e+05],
        [4.0173e+00, 4.4531e+00, 4.5883e+00, 3.9843e+05, 3.9626e+05, 5.5733e+00,
         3.8127e+05, 3.8348e+05, 5.1848e+00, 3.9283e+05, 3.8696e+05, 3.8473e+05,
         0.0000e+00, 4.7626e+00, 3.7679e+05, 4.3993e+00, 4.6043e+00],
        [4.8407e+00, 3.8843e+00, 4.1285e+00, 3.9836e+05, 3.9626e+05, 5.4652e+00,
         3.8132e+05, 3.8355e+05, 4.6973e+00, 3.9284e+05, 3.8692e+05, 3.8470e+05,
         4.7626e+00, 0.0000e+00, 3.7681e+05, 4.6371e+00, 4.8125e+00],
        [3.7675e+05, 3.7680e+05, 3.7688e+05, 7.8052e+05, 7.5335e+05, 3.7679e+05,
         7.4073e+05, 7.7851e+05, 3.7674e+05, 7.6786e+05, 7.5216e+05, 7.5943e+05,
         3.7679e+05, 3.7681e+05, 0.0000e+00, 3.7685e+05, 3.7676e+05],
        [4.7873e+00, 4.4524e+00, 4.7054e+00, 3.9842e+05, 3.9625e+05, 5.5813e+00,
         3.8128e+05, 3.8351e+05, 5.0180e+00, 3.9287e+05, 3.8694e+05, 3.8471e+05,
         4.3993e+00, 4.6371e+00, 3.7685e+05, 0.0000e+00, 5.1532e+00],
        [4.2941e+00, 4.4013e+00, 5.1378e+00, 3.9844e+05, 3.9625e+05, 6.3016e+00,
         3.8130e+05, 3.8350e+05, 4.3619e+00, 3.9279e+05, 3.8696e+05, 3.8471e+05,
         4.6043e+00, 4.8125e+00, 3.7676e+05, 5.1532e+00, 0.0000e+00]])
Krum scores: ['4.56', '4.39', '4.79', '398391.97', '396246.25', '5.71', '381291.25', '383502.47', '4.91', '392836.09', '386935.06', '384711.31', '4.57', '4.54', '376777.28', '4.74', '4.68']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0046s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:37...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0024 seconds (Start: 2025-07-22 15:30:37, End: 2025-07-22 15:30:37)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 17, 20, 18, 8, 15, 4, 3, 13, 14, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 2.3350e+00, 3.9982e+05, 3.8350e+05, 3.9242e+05, 2.4173e+00,
         3.6717e+05, 2.1616e+00, 2.1339e+00, 3.8586e+05, 3.9810e+05, 3.8426e+05,
         2.3067e+00, 2.1495e+00],
        [2.3350e+00, 0.0000e+00, 3.9982e+05, 3.8350e+05, 3.9244e+05, 2.3353e+00,
         3.6718e+05, 2.2784e+00, 2.0766e+00, 3.8588e+05, 3.9815e+05, 3.8428e+05,
         2.0974e+00, 2.1079e+00],
        [3.9982e+05, 3.9982e+05, 0.0000e+00, 7.8143e+05, 8.0185e+05, 3.9986e+05,
         7.5878e+05, 3.9979e+05, 3.9982e+05, 7.7983e+05, 8.0333e+05, 7.7398e+05,
         3.9982e+05, 3.9983e+05],
        [3.8350e+05, 3.8350e+05, 7.8143e+05, 0.0000e+00, 7.7799e+05, 3.8352e+05,
         7.7435e+05, 3.8351e+05, 3.8353e+05, 7.7838e+05, 7.7277e+05, 7.4419e+05,
         3.8349e+05, 3.8349e+05],
        [3.9242e+05, 3.9244e+05, 8.0185e+05, 7.7799e+05, 0.0000e+00, 3.9247e+05,
         7.6490e+05, 3.9243e+05, 3.9245e+05, 7.7998e+05, 7.7637e+05, 7.5733e+05,
         3.9247e+05, 3.9244e+05],
        [2.4173e+00, 2.3353e+00, 3.9986e+05, 3.8352e+05, 3.9247e+05, 0.0000e+00,
         3.6717e+05, 2.1961e+00, 2.1924e+00, 3.8588e+05, 3.9814e+05, 3.8430e+05,
         2.2699e+00, 2.1743e+00],
        [3.6717e+05, 3.6718e+05, 7.5878e+05, 7.7435e+05, 7.6490e+05, 3.6717e+05,
         0.0000e+00, 3.6715e+05, 3.6721e+05, 7.5389e+05, 7.6413e+05, 7.5131e+05,
         3.6718e+05, 3.6714e+05],
        [2.1616e+00, 2.2784e+00, 3.9979e+05, 3.8351e+05, 3.9243e+05, 2.1961e+00,
         3.6715e+05, 0.0000e+00, 2.1625e+00, 3.8585e+05, 3.9812e+05, 3.8427e+05,
         2.1505e+00, 2.1080e+00],
        [2.1339e+00, 2.0766e+00, 3.9982e+05, 3.8353e+05, 3.9245e+05, 2.1924e+00,
         3.6721e+05, 2.1625e+00, 0.0000e+00, 3.8588e+05, 3.9815e+05, 3.8429e+05,
         2.2445e+00, 1.9377e+00],
        [3.8586e+05, 3.8588e+05, 7.7983e+05, 7.7838e+05, 7.7998e+05, 3.8588e+05,
         7.5389e+05, 3.8585e+05, 3.8588e+05, 0.0000e+00, 7.9546e+05, 7.6976e+05,
         3.8589e+05, 3.8589e+05],
        [3.9810e+05, 3.9815e+05, 8.0333e+05, 7.7277e+05, 7.7637e+05, 3.9814e+05,
         7.6413e+05, 3.9812e+05, 3.9815e+05, 7.9546e+05, 0.0000e+00, 7.7144e+05,
         3.9810e+05, 3.9814e+05],
        [3.8426e+05, 3.8428e+05, 7.7398e+05, 7.4419e+05, 7.5733e+05, 3.8430e+05,
         7.5131e+05, 3.8427e+05, 3.8429e+05, 7.6976e+05, 7.7144e+05, 0.0000e+00,
         3.8426e+05, 3.8431e+05],
        [2.3067e+00, 2.0974e+00, 3.9982e+05, 3.8349e+05, 3.9247e+05, 2.2699e+00,
         3.6718e+05, 2.1505e+00, 2.2445e+00, 3.8589e+05, 3.9810e+05, 3.8426e+05,
         0.0000e+00, 2.1489e+00],
        [2.1495e+00, 2.1079e+00, 3.9983e+05, 3.8349e+05, 3.9244e+05, 2.1743e+00,
         3.6714e+05, 2.1080e+00, 1.9377e+00, 3.8589e+05, 3.9814e+05, 3.8431e+05,
         2.1489e+00, 0.0000e+00]])
Krum scores: ['2.22', '2.18', '399815.22', '383499.81', '392435.84', '2.23', '367160.16', '2.16', '2.10', '385868.34', '398119.03', '384272.75', '2.18', '2.09']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']], selected_client_indices: [5, 2, 17, 20, 18, 8, 15, 4, 3, 13, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0054s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:37...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:30:37, End: 2025-07-22 15:30:37)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 2, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.8147e+00, 3.9254e+05, 1.8796e+00, 1.8128e+00, 3.9989e+05,
         4.0079e+05, 1.9880e+00, 3.9373e+05, 1.6744e+00, 3.8445e+05, 3.9618e+05,
         1.7856e+00, 1.9588e+00, 1.8560e+00],
        [1.8147e+00, 0.0000e+00, 3.9253e+05, 1.7227e+00, 1.8263e+00, 3.9990e+05,
         4.0075e+05, 1.9771e+00, 3.9373e+05, 1.8359e+00, 3.8441e+05, 3.9618e+05,
         1.8002e+00, 1.7369e+00, 1.9316e+00],
        [3.9254e+05, 3.9253e+05, 0.0000e+00, 3.9253e+05, 3.9254e+05, 7.8222e+05,
         7.8970e+05, 3.9253e+05, 7.9095e+05, 3.9255e+05, 7.7472e+05, 7.6835e+05,
         3.9249e+05, 3.9253e+05, 3.9252e+05],
        [1.8796e+00, 1.7227e+00, 3.9253e+05, 0.0000e+00, 1.7310e+00, 3.9992e+05,
         4.0076e+05, 1.9613e+00, 3.9376e+05, 1.7818e+00, 3.8439e+05, 3.9618e+05,
         1.7002e+00, 1.7862e+00, 1.9538e+00],
        [1.8128e+00, 1.8263e+00, 3.9254e+05, 1.7310e+00, 0.0000e+00, 3.9989e+05,
         4.0076e+05, 1.8297e+00, 3.9374e+05, 1.8280e+00, 3.8442e+05, 3.9611e+05,
         1.6206e+00, 1.7298e+00, 1.9382e+00],
        [3.9989e+05, 3.9990e+05, 7.8222e+05, 3.9992e+05, 3.9989e+05, 0.0000e+00,
         8.1986e+05, 3.9993e+05, 8.0896e+05, 3.9990e+05, 7.7685e+05, 7.8682e+05,
         3.9990e+05, 3.9988e+05, 3.9991e+05],
        [4.0079e+05, 4.0075e+05, 7.8970e+05, 4.0076e+05, 4.0076e+05, 8.1986e+05,
         0.0000e+00, 4.0076e+05, 7.8372e+05, 4.0081e+05, 7.6667e+05, 7.8823e+05,
         4.0078e+05, 4.0077e+05, 4.0076e+05],
        [1.9880e+00, 1.9771e+00, 3.9253e+05, 1.9613e+00, 1.8297e+00, 3.9993e+05,
         4.0076e+05, 0.0000e+00, 3.9377e+05, 1.8178e+00, 3.8442e+05, 3.9618e+05,
         1.8795e+00, 1.8064e+00, 1.9226e+00],
        [3.9373e+05, 3.9373e+05, 7.9095e+05, 3.9376e+05, 3.9374e+05, 8.0896e+05,
         7.8372e+05, 3.9377e+05, 0.0000e+00, 3.9371e+05, 8.1427e+05, 7.9437e+05,
         3.9376e+05, 3.9376e+05, 3.9376e+05],
        [1.6744e+00, 1.8359e+00, 3.9255e+05, 1.7818e+00, 1.8280e+00, 3.9990e+05,
         4.0081e+05, 1.8178e+00, 3.9371e+05, 0.0000e+00, 3.8439e+05, 3.9618e+05,
         1.7232e+00, 1.7792e+00, 1.8866e+00],
        [3.8445e+05, 3.8441e+05, 7.7472e+05, 3.8439e+05, 3.8442e+05, 7.7685e+05,
         7.6667e+05, 3.8442e+05, 8.1427e+05, 3.8439e+05, 0.0000e+00, 7.9503e+05,
         3.8444e+05, 3.8438e+05, 3.8441e+05],
        [3.9618e+05, 3.9618e+05, 7.6835e+05, 3.9618e+05, 3.9611e+05, 7.8682e+05,
         7.8823e+05, 3.9618e+05, 7.9437e+05, 3.9618e+05, 7.9503e+05, 0.0000e+00,
         3.9616e+05, 3.9615e+05, 3.9619e+05],
        [1.7856e+00, 1.8002e+00, 3.9249e+05, 1.7002e+00, 1.6206e+00, 3.9990e+05,
         4.0078e+05, 1.8795e+00, 3.9376e+05, 1.7232e+00, 3.8444e+05, 3.9616e+05,
         0.0000e+00, 1.7830e+00, 1.9037e+00],
        [1.9588e+00, 1.7369e+00, 3.9253e+05, 1.7862e+00, 1.7298e+00, 3.9988e+05,
         4.0077e+05, 1.8064e+00, 3.9376e+05, 1.7792e+00, 3.8438e+05, 3.9615e+05,
         1.7830e+00, 0.0000e+00, 2.0209e+00],
        [1.8560e+00, 1.9316e+00, 3.9252e+05, 1.9538e+00, 1.9382e+00, 3.9991e+05,
         4.0076e+05, 1.9226e+00, 3.9376e+05, 1.8866e+00, 3.8441e+05, 3.9619e+05,
         1.9037e+00, 2.0209e+00, 0.0000e+00]])
Krum scores: ['1.83', '1.81', '392526.78', '1.79', '1.77', '399896.91', '400762.50', '1.88', '393741.66', '1.78', '384403.16', '396163.56', '1.76', '1.80', '1.91']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']], selected_client_indices: [7, 2, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0155s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:38...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:38, End: 2025-07-22 15:30:38)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 3.7778e+05, 4.0374e+05, 1.8526e+00, 1.8914e+00, 3.9611e+05,
         3.9568e+05, 3.8671e+05, 1.9185e+00, 1.8737e+00, 3.9801e+05, 3.8694e+05,
         2.0488e+00, 1.8082e+00, 3.8309e+05, 1.7997e+00, 1.9818e+00],
        [3.7778e+05, 0.0000e+00, 7.6470e+05, 3.7779e+05, 3.7781e+05, 7.8564e+05,
         7.5974e+05, 7.7653e+05, 3.7779e+05, 3.7781e+05, 7.6227e+05, 7.6573e+05,
         3.7779e+05, 3.7783e+05, 7.5227e+05, 3.7779e+05, 3.7777e+05],
        [4.0374e+05, 7.6470e+05, 0.0000e+00, 4.0375e+05, 4.0375e+05, 7.9715e+05,
         8.0397e+05, 7.8016e+05, 4.0377e+05, 4.0373e+05, 7.8298e+05, 7.8830e+05,
         4.0375e+05, 4.0377e+05, 7.8155e+05, 4.0372e+05, 4.0376e+05],
        [1.8526e+00, 3.7779e+05, 4.0375e+05, 0.0000e+00, 1.8094e+00, 3.9610e+05,
         3.9566e+05, 3.8671e+05, 1.8626e+00, 2.0589e+00, 3.9805e+05, 3.8697e+05,
         1.8855e+00, 1.9353e+00, 3.8306e+05, 1.8828e+00, 1.9213e+00],
        [1.8914e+00, 3.7781e+05, 4.0375e+05, 1.8094e+00, 0.0000e+00, 3.9611e+05,
         3.9571e+05, 3.8674e+05, 1.7863e+00, 1.7801e+00, 3.9806e+05, 3.8696e+05,
         1.7996e+00, 1.8886e+00, 3.8304e+05, 1.7079e+00, 1.8922e+00],
        [3.9611e+05, 7.8564e+05, 7.9715e+05, 3.9610e+05, 3.9611e+05, 0.0000e+00,
         7.6768e+05, 7.6930e+05, 3.9612e+05, 3.9612e+05, 7.7679e+05, 7.8587e+05,
         3.9612e+05, 3.9616e+05, 8.0156e+05, 3.9613e+05, 3.9610e+05],
        [3.9568e+05, 7.5974e+05, 8.0397e+05, 3.9566e+05, 3.9571e+05, 7.6768e+05,
         0.0000e+00, 7.9120e+05, 3.9566e+05, 3.9567e+05, 7.8969e+05, 7.9594e+05,
         3.9569e+05, 3.9568e+05, 7.7919e+05, 3.9567e+05, 3.9569e+05],
        [3.8671e+05, 7.7653e+05, 7.8016e+05, 3.8671e+05, 3.8674e+05, 7.6930e+05,
         7.9120e+05, 0.0000e+00, 3.8670e+05, 3.8670e+05, 7.8854e+05, 7.6729e+05,
         3.8673e+05, 3.8672e+05, 7.7802e+05, 3.8676e+05, 3.8669e+05],
        [1.9185e+00, 3.7779e+05, 4.0377e+05, 1.8626e+00, 1.7863e+00, 3.9612e+05,
         3.9566e+05, 3.8670e+05, 0.0000e+00, 1.7974e+00, 3.9802e+05, 3.8696e+05,
         1.8671e+00, 1.9274e+00, 3.8308e+05, 1.8056e+00, 1.8064e+00],
        [1.8737e+00, 3.7781e+05, 4.0373e+05, 2.0589e+00, 1.7801e+00, 3.9612e+05,
         3.9567e+05, 3.8670e+05, 1.7974e+00, 0.0000e+00, 3.9807e+05, 3.8692e+05,
         2.1005e+00, 1.8695e+00, 3.8307e+05, 1.9792e+00, 1.8023e+00],
        [3.9801e+05, 7.6227e+05, 7.8298e+05, 3.9805e+05, 3.9806e+05, 7.7679e+05,
         7.8969e+05, 7.8854e+05, 3.9802e+05, 3.9807e+05, 0.0000e+00, 7.8088e+05,
         3.9802e+05, 3.9806e+05, 7.9233e+05, 3.9807e+05, 3.9807e+05],
        [3.8694e+05, 7.6573e+05, 7.8830e+05, 3.8697e+05, 3.8696e+05, 7.8587e+05,
         7.9594e+05, 7.6729e+05, 3.8696e+05, 3.8692e+05, 7.8088e+05, 0.0000e+00,
         3.8693e+05, 3.8693e+05, 7.7099e+05, 3.8697e+05, 3.8696e+05],
        [2.0488e+00, 3.7779e+05, 4.0375e+05, 1.8855e+00, 1.7996e+00, 3.9612e+05,
         3.9569e+05, 3.8673e+05, 1.8671e+00, 2.1005e+00, 3.9802e+05, 3.8693e+05,
         0.0000e+00, 1.8927e+00, 3.8306e+05, 1.8532e+00, 1.8424e+00],
        [1.8082e+00, 3.7783e+05, 4.0377e+05, 1.9353e+00, 1.8886e+00, 3.9616e+05,
         3.9568e+05, 3.8672e+05, 1.9274e+00, 1.8695e+00, 3.9806e+05, 3.8693e+05,
         1.8927e+00, 0.0000e+00, 3.8301e+05, 1.8946e+00, 1.9528e+00],
        [3.8309e+05, 7.5227e+05, 7.8155e+05, 3.8306e+05, 3.8304e+05, 8.0156e+05,
         7.7919e+05, 7.7802e+05, 3.8308e+05, 3.8307e+05, 7.9233e+05, 7.7099e+05,
         3.8306e+05, 3.8301e+05, 0.0000e+00, 3.8308e+05, 3.8308e+05],
        [1.7997e+00, 3.7779e+05, 4.0372e+05, 1.8828e+00, 1.7079e+00, 3.9613e+05,
         3.9567e+05, 3.8676e+05, 1.8056e+00, 1.9792e+00, 3.9807e+05, 3.8697e+05,
         1.8532e+00, 1.8946e+00, 3.8308e+05, 0.0000e+00, 2.0143e+00],
        [1.9818e+00, 3.7777e+05, 4.0376e+05, 1.9213e+00, 1.8922e+00, 3.9610e+05,
         3.9569e+05, 3.8669e+05, 1.8064e+00, 1.8023e+00, 3.9807e+05, 3.8696e+05,
         1.8424e+00, 1.9528e+00, 3.8308e+05, 2.0143e+00, 0.0000e+00]])
Krum scores: ['1.88', '377788.56', '403741.56', '1.88', '1.81', '396108.12', '395672.03', '386708.94', '1.83', '1.88', '398042.75', '386943.81', '1.88', '1.89', '383057.97', '1.85', '1.89']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0061s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:38...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 49 214]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:38, End: 2025-07-22 15:30:38)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.7573e+00, 1.8091e+00, 3.8588e+05, 3.9255e+05, 1.8015e+00,
         2.0147e+00, 3.9009e+05, 3.9856e+05, 1.8581e+00, 1.5954e+00, 1.6961e+00,
         4.0076e+05, 3.9198e+05, 1.6694e+00, 1.7404e+00, 3.9090e+05, 1.7198e+00,
         1.7726e+00],
        [1.7573e+00, 0.0000e+00, 1.6716e+00, 3.8591e+05, 3.9258e+05, 1.8555e+00,
         1.8399e+00, 3.9006e+05, 3.9855e+05, 1.8647e+00, 1.6429e+00, 1.8032e+00,
         4.0073e+05, 3.9197e+05, 1.7311e+00, 1.8352e+00, 3.9090e+05, 1.9086e+00,
         1.7393e+00],
        [1.8091e+00, 1.6716e+00, 0.0000e+00, 3.8590e+05, 3.9257e+05, 1.6972e+00,
         1.9067e+00, 3.9010e+05, 3.9858e+05, 1.8486e+00, 1.6824e+00, 1.6903e+00,
         4.0072e+05, 3.9198e+05, 1.7706e+00, 1.5912e+00, 3.9091e+05, 1.6324e+00,
         1.7938e+00],
        [3.8588e+05, 3.8591e+05, 3.8590e+05, 0.0000e+00, 7.4400e+05, 3.8592e+05,
         3.8590e+05, 7.7267e+05, 7.9562e+05, 3.8589e+05, 3.8588e+05, 3.8588e+05,
         7.6912e+05, 7.7595e+05, 3.8590e+05, 3.8588e+05, 7.8023e+05, 3.8590e+05,
         3.8590e+05],
        [3.9255e+05, 3.9258e+05, 3.9257e+05, 7.4400e+05, 0.0000e+00, 3.9258e+05,
         3.9254e+05, 7.8688e+05, 7.7568e+05, 3.9259e+05, 3.9257e+05, 3.9254e+05,
         8.2387e+05, 7.5126e+05, 3.9256e+05, 3.9255e+05, 7.8863e+05, 3.9254e+05,
         3.9253e+05],
        [1.8015e+00, 1.8555e+00, 1.6972e+00, 3.8592e+05, 3.9258e+05, 0.0000e+00,
         1.8638e+00, 3.9008e+05, 3.9855e+05, 2.0477e+00, 1.7557e+00, 1.9675e+00,
         4.0069e+05, 3.9199e+05, 1.7342e+00, 1.8554e+00, 3.9092e+05, 1.8064e+00,
         1.8819e+00],
        [2.0147e+00, 1.8399e+00, 1.9067e+00, 3.8590e+05, 3.9254e+05, 1.8638e+00,
         0.0000e+00, 3.9011e+05, 3.9856e+05, 1.8064e+00, 1.7895e+00, 1.8096e+00,
         4.0073e+05, 3.9194e+05, 1.6819e+00, 1.8661e+00, 3.9092e+05, 1.7520e+00,
         1.7940e+00],
        [3.9009e+05, 3.9006e+05, 3.9010e+05, 7.7267e+05, 7.8688e+05, 3.9008e+05,
         3.9011e+05, 0.0000e+00, 8.0543e+05, 3.9010e+05, 3.9014e+05, 3.9005e+05,
         7.8100e+05, 8.0580e+05, 3.9012e+05, 3.9008e+05, 7.6948e+05, 3.9011e+05,
         3.9009e+05],
        [3.9856e+05, 3.9855e+05, 3.9858e+05, 7.9562e+05, 7.7568e+05, 3.9855e+05,
         3.9856e+05, 8.0543e+05, 0.0000e+00, 3.9853e+05, 3.9854e+05, 3.9858e+05,
         7.7547e+05, 7.9392e+05, 3.9855e+05, 3.9858e+05, 7.8914e+05, 3.9862e+05,
         3.9855e+05],
        [1.8581e+00, 1.8647e+00, 1.8486e+00, 3.8589e+05, 3.9259e+05, 2.0477e+00,
         1.8064e+00, 3.9010e+05, 3.9853e+05, 0.0000e+00, 1.6488e+00, 1.8255e+00,
         4.0070e+05, 3.9195e+05, 1.8978e+00, 1.7451e+00, 3.9087e+05, 1.7501e+00,
         1.8060e+00],
        [1.5954e+00, 1.6429e+00, 1.6824e+00, 3.8588e+05, 3.9257e+05, 1.7557e+00,
         1.7895e+00, 3.9014e+05, 3.9854e+05, 1.6488e+00, 0.0000e+00, 1.6944e+00,
         4.0074e+05, 3.9198e+05, 1.6900e+00, 1.8030e+00, 3.9089e+05, 1.6593e+00,
         1.6521e+00],
        [1.6961e+00, 1.8032e+00, 1.6903e+00, 3.8588e+05, 3.9254e+05, 1.9675e+00,
         1.8096e+00, 3.9005e+05, 3.9858e+05, 1.8255e+00, 1.6944e+00, 0.0000e+00,
         4.0074e+05, 3.9197e+05, 1.9607e+00, 1.6971e+00, 3.9093e+05, 1.8801e+00,
         1.6705e+00],
        [4.0076e+05, 4.0073e+05, 4.0072e+05, 7.6912e+05, 8.2387e+05, 4.0069e+05,
         4.0073e+05, 7.8100e+05, 7.7547e+05, 4.0070e+05, 4.0074e+05, 4.0074e+05,
         0.0000e+00, 7.8749e+05, 4.0074e+05, 4.0071e+05, 7.6455e+05, 4.0071e+05,
         4.0071e+05],
        [3.9198e+05, 3.9197e+05, 3.9198e+05, 7.7595e+05, 7.5126e+05, 3.9199e+05,
         3.9194e+05, 8.0580e+05, 7.9392e+05, 3.9195e+05, 3.9198e+05, 3.9197e+05,
         7.8749e+05, 0.0000e+00, 3.9201e+05, 3.9194e+05, 7.6572e+05, 3.9196e+05,
         3.9196e+05],
        [1.6694e+00, 1.7311e+00, 1.7706e+00, 3.8590e+05, 3.9256e+05, 1.7342e+00,
         1.6819e+00, 3.9012e+05, 3.9855e+05, 1.8978e+00, 1.6900e+00, 1.9607e+00,
         4.0074e+05, 3.9201e+05, 0.0000e+00, 1.7385e+00, 3.9090e+05, 1.7482e+00,
         1.6819e+00],
        [1.7404e+00, 1.8352e+00, 1.5912e+00, 3.8588e+05, 3.9255e+05, 1.8554e+00,
         1.8661e+00, 3.9008e+05, 3.9858e+05, 1.7451e+00, 1.8030e+00, 1.6971e+00,
         4.0071e+05, 3.9194e+05, 1.7385e+00, 0.0000e+00, 3.9093e+05, 1.7942e+00,
         1.8259e+00],
        [3.9090e+05, 3.9090e+05, 3.9091e+05, 7.8023e+05, 7.8863e+05, 3.9092e+05,
         3.9092e+05, 7.6948e+05, 7.8914e+05, 3.9087e+05, 3.9089e+05, 3.9093e+05,
         7.6455e+05, 7.6572e+05, 3.9090e+05, 3.9093e+05, 0.0000e+00, 3.9089e+05,
         3.9091e+05],
        [1.7198e+00, 1.9086e+00, 1.6324e+00, 3.8590e+05, 3.9254e+05, 1.8064e+00,
         1.7520e+00, 3.9011e+05, 3.9862e+05, 1.7501e+00, 1.6593e+00, 1.8801e+00,
         4.0071e+05, 3.9196e+05, 1.7482e+00, 1.7942e+00, 3.9089e+05, 0.0000e+00,
         1.9314e+00],
        [1.7726e+00, 1.7393e+00, 1.7938e+00, 3.8590e+05, 3.9253e+05, 1.8819e+00,
         1.7940e+00, 3.9009e+05, 3.9855e+05, 1.8060e+00, 1.6521e+00, 1.6705e+00,
         4.0071e+05, 3.9196e+05, 1.6819e+00, 1.8259e+00, 3.9091e+05, 1.9314e+00,
         0.0000e+00]])
Krum scores: ['1.74', '1.77', '1.72', '385890.59', '392552.56', '1.82', '1.81', '390086.78', '398555.84', '1.81', '1.68', '1.77', '400718.47', '391964.75', '1.73', '1.76', '390901.34', '1.77', '1.76']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:39...
global Accuracy on shared test data: 78.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:39, End: 2025-07-22 15:30:39)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.8209e+00, 4.0441e+05, 4.0201e+05, 1.9615e+00, 1.9052e+00,
         3.9386e+05, 3.9027e+05, 3.7939e+05, 1.7248e+00, 1.9600e+00, 3.8146e+05,
         4.0605e+05, 1.8188e+00, 1.9360e+00, 4.0299e+05, 2.0532e+00, 1.9280e+00],
        [1.8209e+00, 0.0000e+00, 4.0442e+05, 4.0200e+05, 1.9566e+00, 1.9424e+00,
         3.9391e+05, 3.9025e+05, 3.7938e+05, 1.9098e+00, 1.8188e+00, 3.8146e+05,
         4.0605e+05, 1.9195e+00, 1.7731e+00, 4.0298e+05, 1.8091e+00, 1.9913e+00],
        [4.0441e+05, 4.0442e+05, 0.0000e+00, 8.0690e+05, 4.0442e+05, 4.0442e+05,
         8.0142e+05, 7.9097e+05, 8.0404e+05, 4.0442e+05, 4.0444e+05, 7.6974e+05,
         8.0998e+05, 4.0439e+05, 4.0442e+05, 7.9104e+05, 4.0438e+05, 4.0443e+05],
        [4.0201e+05, 4.0200e+05, 8.0690e+05, 0.0000e+00, 4.0197e+05, 4.0199e+05,
         7.8304e+05, 7.8300e+05, 7.8245e+05, 4.0195e+05, 4.0193e+05, 7.7731e+05,
         7.8634e+05, 4.0199e+05, 4.0198e+05, 8.0645e+05, 4.0199e+05, 4.0197e+05],
        [1.9615e+00, 1.9566e+00, 4.0442e+05, 4.0197e+05, 0.0000e+00, 1.9290e+00,
         3.9390e+05, 3.9028e+05, 3.7936e+05, 1.9208e+00, 2.1343e+00, 3.8144e+05,
         4.0605e+05, 1.8148e+00, 1.9754e+00, 4.0298e+05, 1.9440e+00, 1.9985e+00],
        [1.9052e+00, 1.9424e+00, 4.0442e+05, 4.0199e+05, 1.9290e+00, 0.0000e+00,
         3.9389e+05, 3.9020e+05, 3.7939e+05, 1.8212e+00, 1.9076e+00, 3.8149e+05,
         4.0605e+05, 1.7135e+00, 1.9013e+00, 4.0296e+05, 1.7803e+00, 1.9223e+00],
        [3.9386e+05, 3.9391e+05, 8.0142e+05, 7.8304e+05, 3.9390e+05, 3.9389e+05,
         0.0000e+00, 8.0290e+05, 7.7321e+05, 3.9389e+05, 3.9386e+05, 7.5527e+05,
         8.0987e+05, 3.9385e+05, 3.9389e+05, 7.8619e+05, 3.9390e+05, 3.9388e+05],
        [3.9027e+05, 3.9025e+05, 7.9097e+05, 7.8300e+05, 3.9028e+05, 3.9020e+05,
         8.0290e+05, 0.0000e+00, 7.7020e+05, 3.9023e+05, 3.9023e+05, 7.6162e+05,
         7.9372e+05, 3.9024e+05, 3.9021e+05, 7.7241e+05, 3.9024e+05, 3.9027e+05],
        [3.7939e+05, 3.7938e+05, 8.0404e+05, 7.8245e+05, 3.7936e+05, 3.7939e+05,
         7.7321e+05, 7.7020e+05, 0.0000e+00, 3.7936e+05, 3.7937e+05, 7.5587e+05,
         8.1361e+05, 3.7939e+05, 3.7936e+05, 8.0279e+05, 3.7938e+05, 3.7934e+05],
        [1.7248e+00, 1.9098e+00, 4.0442e+05, 4.0195e+05, 1.9208e+00, 1.8212e+00,
         3.9389e+05, 3.9023e+05, 3.7936e+05, 0.0000e+00, 1.9448e+00, 3.8147e+05,
         4.0606e+05, 1.8616e+00, 2.0082e+00, 4.0296e+05, 2.0093e+00, 1.8349e+00],
        [1.9600e+00, 1.8188e+00, 4.0444e+05, 4.0193e+05, 2.1343e+00, 1.9076e+00,
         3.9386e+05, 3.9023e+05, 3.7937e+05, 1.9448e+00, 0.0000e+00, 3.8147e+05,
         4.0606e+05, 1.9768e+00, 1.7979e+00, 4.0296e+05, 2.0791e+00, 1.8176e+00],
        [3.8146e+05, 3.8146e+05, 7.6974e+05, 7.7731e+05, 3.8144e+05, 3.8149e+05,
         7.5527e+05, 7.6162e+05, 7.5587e+05, 3.8147e+05, 3.8147e+05, 0.0000e+00,
         7.8791e+05, 3.8144e+05, 3.8147e+05, 7.7869e+05, 3.8145e+05, 3.8147e+05],
        [4.0605e+05, 4.0605e+05, 8.0998e+05, 7.8634e+05, 4.0605e+05, 4.0605e+05,
         8.0987e+05, 7.9372e+05, 8.1361e+05, 4.0606e+05, 4.0606e+05, 7.8791e+05,
         0.0000e+00, 4.0607e+05, 4.0602e+05, 7.9384e+05, 4.0604e+05, 4.0604e+05],
        [1.8188e+00, 1.9195e+00, 4.0439e+05, 4.0199e+05, 1.8148e+00, 1.7135e+00,
         3.9385e+05, 3.9024e+05, 3.7939e+05, 1.8616e+00, 1.9768e+00, 3.8144e+05,
         4.0607e+05, 0.0000e+00, 1.7874e+00, 4.0298e+05, 1.8540e+00, 1.7791e+00],
        [1.9360e+00, 1.7731e+00, 4.0442e+05, 4.0198e+05, 1.9754e+00, 1.9013e+00,
         3.9389e+05, 3.9021e+05, 3.7936e+05, 2.0082e+00, 1.7979e+00, 3.8147e+05,
         4.0602e+05, 1.7874e+00, 0.0000e+00, 4.0296e+05, 1.9032e+00, 1.9158e+00],
        [4.0299e+05, 4.0298e+05, 7.9104e+05, 8.0645e+05, 4.0298e+05, 4.0296e+05,
         7.8619e+05, 7.7241e+05, 8.0279e+05, 4.0296e+05, 4.0296e+05, 7.7869e+05,
         7.9384e+05, 4.0298e+05, 4.0296e+05, 0.0000e+00, 4.0294e+05, 4.0292e+05],
        [2.0532e+00, 1.8091e+00, 4.0438e+05, 4.0199e+05, 1.9440e+00, 1.7803e+00,
         3.9390e+05, 3.9024e+05, 3.7938e+05, 2.0093e+00, 2.0791e+00, 3.8145e+05,
         4.0604e+05, 1.8540e+00, 1.9032e+00, 4.0294e+05, 0.0000e+00, 2.1207e+00],
        [1.9280e+00, 1.9913e+00, 4.0443e+05, 4.0197e+05, 1.9985e+00, 1.9223e+00,
         3.9388e+05, 3.9027e+05, 3.7934e+05, 1.8349e+00, 1.8176e+00, 3.8147e+05,
         4.0604e+05, 1.7791e+00, 1.9158e+00, 4.0292e+05, 2.1207e+00, 0.0000e+00]])
Krum scores: ['1.88', '1.87', '404409.19', '401972.56', '1.94', '1.86', '393878.34', '390234.62', '379367.62', '1.88', '1.91', '381457.34', '406045.94', '1.82', '1.87', '402957.84', '1.93', '1.90']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0227s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:40...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 46 217]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:40, End: 2025-07-22 15:30:40)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 11, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.8054e+00, 3.9627e+05, 1.7368e+00, 1.8668e+00, 3.9897e+05,
         1.7860e+00, 3.8854e+05, 1.5798e+00, 1.6217e+00, 1.8422e+00, 1.7080e+00,
         4.0628e+05, 1.7222e+00, 1.6799e+00],
        [1.8054e+00, 0.0000e+00, 3.9624e+05, 1.6479e+00, 1.7552e+00, 3.9896e+05,
         1.7332e+00, 3.8856e+05, 1.6472e+00, 1.6027e+00, 1.9665e+00, 1.5739e+00,
         4.0627e+05, 1.5892e+00, 1.6580e+00],
        [3.9627e+05, 3.9624e+05, 0.0000e+00, 3.9627e+05, 3.9628e+05, 8.0736e+05,
         3.9624e+05, 7.8320e+05, 3.9624e+05, 3.9629e+05, 3.9626e+05, 3.9624e+05,
         8.1071e+05, 3.9625e+05, 3.9627e+05],
        [1.7368e+00, 1.6479e+00, 3.9627e+05, 0.0000e+00, 1.7156e+00, 3.9901e+05,
         1.8511e+00, 3.8852e+05, 1.6345e+00, 1.8309e+00, 1.8051e+00, 1.7339e+00,
         4.0630e+05, 1.6789e+00, 1.7443e+00],
        [1.8668e+00, 1.7552e+00, 3.9628e+05, 1.7156e+00, 0.0000e+00, 3.9896e+05,
         1.6821e+00, 3.8853e+05, 1.5460e+00, 1.6186e+00, 1.6152e+00, 1.7593e+00,
         4.0627e+05, 1.5284e+00, 1.6184e+00],
        [3.9897e+05, 3.9896e+05, 8.0736e+05, 3.9901e+05, 3.9896e+05, 0.0000e+00,
         3.9894e+05, 7.8858e+05, 3.9898e+05, 3.9895e+05, 3.9897e+05, 3.9896e+05,
         8.1215e+05, 3.9897e+05, 3.9900e+05],
        [1.7860e+00, 1.7332e+00, 3.9624e+05, 1.8511e+00, 1.6821e+00, 3.9894e+05,
         0.0000e+00, 3.8850e+05, 1.5492e+00, 1.6878e+00, 1.9380e+00, 1.5674e+00,
         4.0627e+05, 1.6239e+00, 1.6874e+00],
        [3.8854e+05, 3.8856e+05, 7.8320e+05, 3.8852e+05, 3.8853e+05, 7.8858e+05,
         3.8850e+05, 0.0000e+00, 3.8850e+05, 3.8849e+05, 3.8851e+05, 3.8850e+05,
         8.0498e+05, 3.8849e+05, 3.8851e+05],
        [1.5798e+00, 1.6472e+00, 3.9624e+05, 1.6345e+00, 1.5460e+00, 3.9898e+05,
         1.5492e+00, 3.8850e+05, 0.0000e+00, 1.5545e+00, 1.6937e+00, 1.6650e+00,
         4.0625e+05, 1.6104e+00, 1.4625e+00],
        [1.6217e+00, 1.6027e+00, 3.9629e+05, 1.8309e+00, 1.6186e+00, 3.9895e+05,
         1.6878e+00, 3.8849e+05, 1.5545e+00, 0.0000e+00, 1.9185e+00, 1.6165e+00,
         4.0634e+05, 1.7208e+00, 1.5380e+00],
        [1.8422e+00, 1.9665e+00, 3.9626e+05, 1.8051e+00, 1.6152e+00, 3.9897e+05,
         1.9380e+00, 3.8851e+05, 1.6937e+00, 1.9185e+00, 0.0000e+00, 1.8149e+00,
         4.0626e+05, 1.7661e+00, 1.6679e+00],
        [1.7080e+00, 1.5739e+00, 3.9624e+05, 1.7339e+00, 1.7593e+00, 3.9896e+05,
         1.5674e+00, 3.8850e+05, 1.6650e+00, 1.6165e+00, 1.8149e+00, 0.0000e+00,
         4.0631e+05, 1.6119e+00, 1.6468e+00],
        [4.0628e+05, 4.0627e+05, 8.1071e+05, 4.0630e+05, 4.0627e+05, 8.1215e+05,
         4.0627e+05, 8.0498e+05, 4.0625e+05, 4.0634e+05, 4.0626e+05, 4.0631e+05,
         0.0000e+00, 4.0629e+05, 4.0628e+05],
        [1.7222e+00, 1.5892e+00, 3.9625e+05, 1.6789e+00, 1.5284e+00, 3.9897e+05,
         1.6239e+00, 3.8849e+05, 1.6104e+00, 1.7208e+00, 1.7661e+00, 1.6119e+00,
         4.0629e+05, 0.0000e+00, 1.6865e+00],
        [1.6799e+00, 1.6580e+00, 3.9627e+05, 1.7443e+00, 1.6184e+00, 3.9900e+05,
         1.6874e+00, 3.8851e+05, 1.4625e+00, 1.5380e+00, 1.6679e+00, 1.6468e+00,
         4.0628e+05, 1.6865e+00, 0.0000e+00]])
Krum scores: ['1.72', '1.67', '396253.59', '1.73', '1.65', '398963.75', '1.69', '388504.62', '1.58', '1.64', '1.78', '1.65', '406273.62', '1.64', '1.63']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0148s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:40...
global Accuracy on shared test data: 78.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:30:40, End: 2025-07-22 15:30:40)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 17, 1, 9, 20, 18, 15, 4, 3, 14, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.6719e+00, 4.0798e+05, 1.7175e+00, 1.7901e+00, 3.9161e+05,
         3.8334e+05, 3.9983e+05, 1.7880e+00, 1.6827e+00, 3.8985e+05, 1.6791e+00,
         3.9622e+05, 1.7596e+00, 1.6862e+00],
        [1.6719e+00, 0.0000e+00, 4.0795e+05, 1.6434e+00, 1.6215e+00, 3.9160e+05,
         3.8331e+05, 3.9983e+05, 1.5706e+00, 1.6483e+00, 3.8983e+05, 1.7098e+00,
         3.9623e+05, 1.7724e+00, 1.6048e+00],
        [4.0798e+05, 4.0795e+05, 0.0000e+00, 4.0800e+05, 4.0799e+05, 7.6845e+05,
         8.0501e+05, 8.2936e+05, 4.0800e+05, 4.0799e+05, 8.1541e+05, 4.0799e+05,
         8.2505e+05, 4.0799e+05, 4.0796e+05],
        [1.7175e+00, 1.6434e+00, 4.0800e+05, 0.0000e+00, 1.6628e+00, 3.9164e+05,
         3.8331e+05, 3.9983e+05, 1.6994e+00, 1.7925e+00, 3.8985e+05, 1.6594e+00,
         3.9623e+05, 1.6435e+00, 1.7004e+00],
        [1.7901e+00, 1.6215e+00, 4.0799e+05, 1.6628e+00, 0.0000e+00, 3.9159e+05,
         3.8331e+05, 3.9982e+05, 1.5938e+00, 1.5943e+00, 3.8985e+05, 1.6780e+00,
         3.9627e+05, 1.5328e+00, 1.6082e+00],
        [3.9161e+05, 3.9160e+05, 7.6845e+05, 3.9164e+05, 3.9159e+05, 0.0000e+00,
         7.6605e+05, 8.0232e+05, 3.9165e+05, 3.9164e+05, 7.8696e+05, 3.9163e+05,
         7.8820e+05, 3.9162e+05, 3.9159e+05],
        [3.8334e+05, 3.8331e+05, 8.0501e+05, 3.8331e+05, 3.8331e+05, 7.6605e+05,
         0.0000e+00, 7.9482e+05, 3.8336e+05, 3.8337e+05, 7.7095e+05, 3.8330e+05,
         7.6576e+05, 3.8331e+05, 3.8334e+05],
        [3.9983e+05, 3.9983e+05, 8.2936e+05, 3.9983e+05, 3.9982e+05, 8.0232e+05,
         7.9482e+05, 0.0000e+00, 3.9983e+05, 3.9985e+05, 7.8573e+05, 3.9983e+05,
         7.9651e+05, 3.9986e+05, 3.9983e+05],
        [1.7880e+00, 1.5706e+00, 4.0800e+05, 1.6994e+00, 1.5938e+00, 3.9165e+05,
         3.8336e+05, 3.9983e+05, 0.0000e+00, 1.8110e+00, 3.8983e+05, 1.7680e+00,
         3.9624e+05, 1.8798e+00, 1.5569e+00],
        [1.6827e+00, 1.6483e+00, 4.0799e+05, 1.7925e+00, 1.5943e+00, 3.9164e+05,
         3.8337e+05, 3.9985e+05, 1.8110e+00, 0.0000e+00, 3.8982e+05, 1.5707e+00,
         3.9625e+05, 1.7293e+00, 1.5591e+00],
        [3.8985e+05, 3.8983e+05, 8.1541e+05, 3.8985e+05, 3.8985e+05, 7.8696e+05,
         7.7095e+05, 7.8573e+05, 3.8983e+05, 3.8982e+05, 0.0000e+00, 3.8985e+05,
         8.1223e+05, 3.8983e+05, 3.8983e+05],
        [1.6791e+00, 1.7098e+00, 4.0799e+05, 1.6594e+00, 1.6780e+00, 3.9163e+05,
         3.8330e+05, 3.9983e+05, 1.7680e+00, 1.5707e+00, 3.8985e+05, 0.0000e+00,
         3.9621e+05, 1.6267e+00, 1.6526e+00],
        [3.9622e+05, 3.9623e+05, 8.2505e+05, 3.9623e+05, 3.9627e+05, 7.8820e+05,
         7.6576e+05, 7.9651e+05, 3.9624e+05, 3.9625e+05, 8.1223e+05, 3.9621e+05,
         0.0000e+00, 3.9626e+05, 3.9620e+05],
        [1.7596e+00, 1.7724e+00, 4.0799e+05, 1.6435e+00, 1.5328e+00, 3.9162e+05,
         3.8331e+05, 3.9986e+05, 1.8798e+00, 1.7293e+00, 3.8983e+05, 1.6267e+00,
         3.9626e+05, 0.0000e+00, 1.7524e+00],
        [1.6862e+00, 1.6048e+00, 4.0796e+05, 1.7004e+00, 1.6082e+00, 3.9159e+05,
         3.8334e+05, 3.9983e+05, 1.5569e+00, 1.5591e+00, 3.8983e+05, 1.6526e+00,
         3.9620e+05, 1.7524e+00, 0.0000e+00]])
Krum scores: ['1.71', '1.64', '407979.94', '1.68', '1.61', '391613.59', '383318.03', '399827.69', '1.68', '1.65', '389833.78', '1.65', '396225.59', '1.69', '1.62']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 17, 1, 9, 20, 18, 15, 4, 3, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0281s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:41...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:41, End: 2025-07-22 15:30:41)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.3777e+00, 1.4847e+00, 3.9176e+05, 3.9833e+05, 1.8349e+00,
         3.8994e+05, 3.8515e+05, 1.5560e+00, 3.9619e+05, 1.4068e+00, 1.3755e+00,
         4.0521e+05, 3.7824e+05, 1.4334e+00, 3.8716e+05, 1.4317e+00, 1.4036e+00],
        [1.3777e+00, 0.0000e+00, 1.3245e+00, 3.9172e+05, 3.9834e+05, 1.6265e+00,
         3.8991e+05, 3.8517e+05, 1.4613e+00, 3.9621e+05, 1.2780e+00, 1.4086e+00,
         4.0522e+05, 3.7823e+05, 1.4450e+00, 3.8714e+05, 1.4866e+00, 1.3343e+00],
        [1.4847e+00, 1.3245e+00, 0.0000e+00, 3.9171e+05, 3.9837e+05, 1.7009e+00,
         3.8991e+05, 3.8515e+05, 1.4367e+00, 3.9622e+05, 1.4060e+00, 1.2770e+00,
         4.0522e+05, 3.7823e+05, 1.3163e+00, 3.8716e+05, 1.3195e+00, 1.3963e+00],
        [3.9176e+05, 3.9172e+05, 3.9171e+05, 0.0000e+00, 7.8593e+05, 3.9176e+05,
         7.5945e+05, 7.6820e+05, 3.9175e+05, 7.8759e+05, 3.9174e+05, 3.9175e+05,
         7.9988e+05, 7.3772e+05, 3.9175e+05, 7.6872e+05, 3.9177e+05, 3.9175e+05],
        [3.9833e+05, 3.9834e+05, 3.9837e+05, 7.8593e+05, 0.0000e+00, 3.9836e+05,
         7.9217e+05, 7.7720e+05, 3.9831e+05, 8.0957e+05, 3.9832e+05, 3.9832e+05,
         7.9902e+05, 7.7278e+05, 3.9835e+05, 7.7715e+05, 3.9831e+05, 3.9833e+05],
        [1.8349e+00, 1.6265e+00, 1.7009e+00, 3.9176e+05, 3.9836e+05, 0.0000e+00,
         3.8993e+05, 3.8517e+05, 1.7436e+00, 3.9619e+05, 1.4050e+00, 1.6304e+00,
         4.0522e+05, 3.7824e+05, 1.7732e+00, 3.8716e+05, 1.6769e+00, 1.5807e+00],
        [3.8994e+05, 3.8991e+05, 3.8991e+05, 7.5945e+05, 7.9217e+05, 3.8993e+05,
         0.0000e+00, 7.9139e+05, 3.8995e+05, 7.9685e+05, 3.8992e+05, 3.8994e+05,
         8.1687e+05, 7.7669e+05, 3.8994e+05, 7.6795e+05, 3.8996e+05, 3.8991e+05],
        [3.8515e+05, 3.8517e+05, 3.8515e+05, 7.6820e+05, 7.7720e+05, 3.8517e+05,
         7.9139e+05, 0.0000e+00, 3.8516e+05, 7.9203e+05, 3.8515e+05, 3.8515e+05,
         7.7703e+05, 7.8568e+05, 3.8518e+05, 7.6334e+05, 3.8514e+05, 3.8518e+05],
        [1.5560e+00, 1.4613e+00, 1.4367e+00, 3.9175e+05, 3.9831e+05, 1.7436e+00,
         3.8995e+05, 3.8516e+05, 0.0000e+00, 3.9617e+05, 1.4797e+00, 1.4661e+00,
         4.0518e+05, 3.7823e+05, 1.3697e+00, 3.8716e+05, 1.4236e+00, 1.4486e+00],
        [3.9619e+05, 3.9621e+05, 3.9622e+05, 7.8759e+05, 8.0957e+05, 3.9619e+05,
         7.9685e+05, 7.9203e+05, 3.9617e+05, 0.0000e+00, 3.9618e+05, 3.9617e+05,
         7.9274e+05, 7.8555e+05, 3.9617e+05, 7.9299e+05, 3.9616e+05, 3.9617e+05],
        [1.4068e+00, 1.2780e+00, 1.4060e+00, 3.9174e+05, 3.9832e+05, 1.4050e+00,
         3.8992e+05, 3.8515e+05, 1.4797e+00, 3.9618e+05, 0.0000e+00, 1.4624e+00,
         4.0523e+05, 3.7822e+05, 1.5490e+00, 3.8715e+05, 1.5432e+00, 1.2481e+00],
        [1.3755e+00, 1.4086e+00, 1.2770e+00, 3.9175e+05, 3.9832e+05, 1.6304e+00,
         3.8994e+05, 3.8515e+05, 1.4661e+00, 3.9617e+05, 1.4624e+00, 0.0000e+00,
         4.0521e+05, 3.7822e+05, 1.3327e+00, 3.8719e+05, 1.5091e+00, 1.3512e+00],
        [4.0521e+05, 4.0522e+05, 4.0522e+05, 7.9988e+05, 7.9902e+05, 4.0522e+05,
         8.1687e+05, 7.7703e+05, 4.0518e+05, 7.9274e+05, 4.0523e+05, 4.0521e+05,
         0.0000e+00, 8.0347e+05, 4.0522e+05, 7.8353e+05, 4.0520e+05, 4.0524e+05],
        [3.7824e+05, 3.7823e+05, 3.7823e+05, 7.3772e+05, 7.7278e+05, 3.7824e+05,
         7.7669e+05, 7.8568e+05, 3.7823e+05, 7.8555e+05, 3.7822e+05, 3.7822e+05,
         8.0347e+05, 0.0000e+00, 3.7823e+05, 7.7371e+05, 3.7821e+05, 3.7826e+05],
        [1.4334e+00, 1.4450e+00, 1.3163e+00, 3.9175e+05, 3.9835e+05, 1.7732e+00,
         3.8994e+05, 3.8518e+05, 1.3697e+00, 3.9617e+05, 1.5490e+00, 1.3327e+00,
         4.0522e+05, 3.7823e+05, 0.0000e+00, 3.8714e+05, 1.4427e+00, 1.4467e+00],
        [3.8716e+05, 3.8714e+05, 3.8716e+05, 7.6872e+05, 7.7715e+05, 3.8716e+05,
         7.6795e+05, 7.6334e+05, 3.8716e+05, 7.9299e+05, 3.8715e+05, 3.8719e+05,
         7.8353e+05, 7.7371e+05, 3.8714e+05, 0.0000e+00, 3.8714e+05, 3.8715e+05],
        [1.4317e+00, 1.4866e+00, 1.3195e+00, 3.9177e+05, 3.9831e+05, 1.6769e+00,
         3.8996e+05, 3.8514e+05, 1.4236e+00, 3.9616e+05, 1.5432e+00, 1.5091e+00,
         4.0520e+05, 3.7821e+05, 1.4427e+00, 3.8714e+05, 0.0000e+00, 1.4919e+00],
        [1.4036e+00, 1.3343e+00, 1.3963e+00, 3.9175e+05, 3.9833e+05, 1.5807e+00,
         3.8991e+05, 3.8518e+05, 1.4486e+00, 3.9617e+05, 1.2481e+00, 1.3512e+00,
         4.0524e+05, 3.7826e+05, 1.4467e+00, 3.8715e+05, 1.4919e+00, 0.0000e+00]])
Krum scores: ['1.43', '1.39', '1.37', '391740.28', '398327.72', '1.64', '389923.91', '385156.22', '1.46', '396174.47', '1.40', '1.40', '405211.03', '378225.62', '1.42', '387149.12', '1.46', '1.39']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0101s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:41...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:41, End: 2025-07-22 15:30:41)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.7669e+00, 3.8858e+05, 3.9861e+05, 1.5848e+00, 1.8780e+00,
         3.9156e+05, 3.7763e+05, 1.7242e+00, 3.8556e+05, 1.6293e+00, 3.8844e+05,
         3.9304e+05, 1.6128e+00, 1.6230e+00, 1.6584e+00, 1.6076e+00],
        [1.7669e+00, 0.0000e+00, 3.8856e+05, 3.9860e+05, 1.6429e+00, 1.6429e+00,
         3.9154e+05, 3.7764e+05, 1.6779e+00, 3.8559e+05, 1.5493e+00, 3.8846e+05,
         3.9303e+05, 1.6114e+00, 1.6583e+00, 1.6444e+00, 1.5581e+00],
        [3.8858e+05, 3.8856e+05, 0.0000e+00, 8.0275e+05, 3.8855e+05, 3.8854e+05,
         8.0001e+05, 7.6360e+05, 3.8854e+05, 7.7869e+05, 3.8856e+05, 7.8381e+05,
         7.9648e+05, 3.8851e+05, 3.8853e+05, 3.8855e+05, 3.8857e+05],
        [3.9861e+05, 3.9860e+05, 8.0275e+05, 0.0000e+00, 3.9862e+05, 3.9860e+05,
         8.0535e+05, 7.7222e+05, 3.9861e+05, 7.6880e+05, 3.9861e+05, 7.9409e+05,
         7.9716e+05, 3.9861e+05, 3.9861e+05, 3.9865e+05, 3.9860e+05],
        [1.5848e+00, 1.6429e+00, 3.8855e+05, 3.9862e+05, 0.0000e+00, 1.7033e+00,
         3.9158e+05, 3.7765e+05, 1.7364e+00, 3.8555e+05, 1.6288e+00, 3.8847e+05,
         3.9299e+05, 1.6150e+00, 1.6392e+00, 1.6091e+00, 1.6588e+00],
        [1.8780e+00, 1.6429e+00, 3.8854e+05, 3.9860e+05, 1.7033e+00, 0.0000e+00,
         3.9155e+05, 3.7768e+05, 1.7550e+00, 3.8555e+05, 1.4801e+00, 3.8846e+05,
         3.9304e+05, 1.3643e+00, 1.8237e+00, 1.7428e+00, 1.6334e+00],
        [3.9156e+05, 3.9154e+05, 8.0001e+05, 8.0535e+05, 3.9158e+05, 3.9155e+05,
         0.0000e+00, 7.6897e+05, 3.9154e+05, 7.7344e+05, 3.9157e+05, 8.0152e+05,
         7.8726e+05, 3.9157e+05, 3.9155e+05, 3.9157e+05, 3.9157e+05],
        [3.7763e+05, 3.7764e+05, 7.6360e+05, 7.7222e+05, 3.7765e+05, 3.7768e+05,
         7.6897e+05, 0.0000e+00, 3.7765e+05, 7.7214e+05, 3.7762e+05, 7.8828e+05,
         7.5840e+05, 3.7764e+05, 3.7765e+05, 3.7764e+05, 3.7765e+05],
        [1.7242e+00, 1.6779e+00, 3.8854e+05, 3.9861e+05, 1.7364e+00, 1.7550e+00,
         3.9154e+05, 3.7765e+05, 0.0000e+00, 3.8556e+05, 1.6410e+00, 3.8845e+05,
         3.9305e+05, 1.7835e+00, 1.4953e+00, 1.6076e+00, 1.6104e+00],
        [3.8556e+05, 3.8559e+05, 7.7869e+05, 7.6880e+05, 3.8555e+05, 3.8555e+05,
         7.7344e+05, 7.7214e+05, 3.8556e+05, 0.0000e+00, 3.8554e+05, 7.6721e+05,
         7.8500e+05, 3.8554e+05, 3.8555e+05, 3.8556e+05, 3.8555e+05],
        [1.6293e+00, 1.5493e+00, 3.8856e+05, 3.9861e+05, 1.6288e+00, 1.4801e+00,
         3.9157e+05, 3.7762e+05, 1.6410e+00, 3.8554e+05, 0.0000e+00, 3.8847e+05,
         3.9302e+05, 1.4074e+00, 1.7040e+00, 1.7348e+00, 1.4180e+00],
        [3.8844e+05, 3.8846e+05, 7.8381e+05, 7.9409e+05, 3.8847e+05, 3.8846e+05,
         8.0152e+05, 7.8828e+05, 3.8845e+05, 7.6721e+05, 3.8847e+05, 0.0000e+00,
         7.7321e+05, 3.8846e+05, 3.8846e+05, 3.8844e+05, 3.8848e+05],
        [3.9304e+05, 3.9303e+05, 7.9648e+05, 7.9716e+05, 3.9299e+05, 3.9304e+05,
         7.8726e+05, 7.5840e+05, 3.9305e+05, 7.8500e+05, 3.9302e+05, 7.7321e+05,
         0.0000e+00, 3.9302e+05, 3.9301e+05, 3.9302e+05, 3.9303e+05],
        [1.6128e+00, 1.6114e+00, 3.8851e+05, 3.9861e+05, 1.6150e+00, 1.3643e+00,
         3.9157e+05, 3.7764e+05, 1.7835e+00, 3.8554e+05, 1.4074e+00, 3.8846e+05,
         3.9302e+05, 0.0000e+00, 1.7146e+00, 1.6728e+00, 1.4440e+00],
        [1.6230e+00, 1.6583e+00, 3.8853e+05, 3.9861e+05, 1.6392e+00, 1.8237e+00,
         3.9155e+05, 3.7765e+05, 1.4953e+00, 3.8555e+05, 1.7040e+00, 3.8846e+05,
         3.9301e+05, 1.7146e+00, 0.0000e+00, 1.6289e+00, 1.5776e+00],
        [1.6584e+00, 1.6444e+00, 3.8855e+05, 3.9865e+05, 1.6091e+00, 1.7428e+00,
         3.9157e+05, 3.7764e+05, 1.6076e+00, 3.8556e+05, 1.7348e+00, 3.8844e+05,
         3.9302e+05, 1.6728e+00, 1.6289e+00, 0.0000e+00, 1.6342e+00],
        [1.6076e+00, 1.5581e+00, 3.8857e+05, 3.9860e+05, 1.6588e+00, 1.6334e+00,
         3.9157e+05, 3.7765e+05, 1.6104e+00, 3.8555e+05, 1.4180e+00, 3.8848e+05,
         3.9303e+05, 1.4440e+00, 1.5776e+00, 1.6342e+00, 0.0000e+00]])
Krum scores: ['1.65', '1.62', '388545.22', '398605.88', '1.64', '1.64', '391556.59', '377640.59', '1.66', '385550.09', '1.56', '388455.53', '393019.72', '1.56', '1.63', '1.65', '1.56']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0054s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:42...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:42, End: 2025-07-22 15:30:42)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 17, 9, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 4.0421e+05, 1.4524e+00, 4.0624e+05, 1.3904e+00, 3.8991e+05,
         1.2161e+00, 1.2933e+00, 4.0035e+05, 4.0693e+05, 1.6613e+00, 1.4213e+00,
         3.8777e+05, 1.4796e+00, 1.3047e+00],
        [4.0421e+05, 0.0000e+00, 4.0419e+05, 8.1132e+05, 4.0418e+05, 7.8890e+05,
         4.0418e+05, 4.0415e+05, 8.1183e+05, 8.2250e+05, 4.0421e+05, 4.0419e+05,
         7.6560e+05, 4.0417e+05, 4.0420e+05],
        [1.4524e+00, 4.0419e+05, 0.0000e+00, 4.0627e+05, 1.5306e+00, 3.8993e+05,
         1.2187e+00, 1.3864e+00, 4.0034e+05, 4.0693e+05, 1.2659e+00, 1.6576e+00,
         3.8777e+05, 1.4996e+00, 1.3777e+00],
        [4.0624e+05, 8.1132e+05, 4.0627e+05, 0.0000e+00, 4.0626e+05, 7.9614e+05,
         4.0626e+05, 4.0627e+05, 8.1544e+05, 8.1663e+05, 4.0626e+05, 4.0623e+05,
         8.0632e+05, 4.0627e+05, 4.0625e+05],
        [1.3904e+00, 4.0418e+05, 1.5306e+00, 4.0626e+05, 0.0000e+00, 3.8993e+05,
         1.3432e+00, 1.3349e+00, 4.0035e+05, 4.0693e+05, 1.9109e+00, 1.2814e+00,
         3.8775e+05, 1.3093e+00, 1.3767e+00],
        [3.8991e+05, 7.8890e+05, 3.8993e+05, 7.9614e+05, 3.8993e+05, 0.0000e+00,
         3.8993e+05, 3.8992e+05, 7.9254e+05, 8.1778e+05, 3.8990e+05, 3.8990e+05,
         7.9401e+05, 3.8993e+05, 3.8992e+05],
        [1.2161e+00, 4.0418e+05, 1.2187e+00, 4.0626e+05, 1.3432e+00, 3.8993e+05,
         0.0000e+00, 1.2775e+00, 4.0036e+05, 4.0695e+05, 1.3773e+00, 1.4046e+00,
         3.8777e+05, 1.3948e+00, 1.1629e+00],
        [1.2933e+00, 4.0415e+05, 1.3864e+00, 4.0627e+05, 1.3349e+00, 3.8992e+05,
         1.2775e+00, 0.0000e+00, 4.0035e+05, 4.0695e+05, 1.7465e+00, 1.2821e+00,
         3.8781e+05, 1.3347e+00, 1.2511e+00],
        [4.0035e+05, 8.1183e+05, 4.0034e+05, 8.1544e+05, 4.0035e+05, 7.9254e+05,
         4.0036e+05, 4.0035e+05, 0.0000e+00, 8.3954e+05, 4.0039e+05, 4.0033e+05,
         7.9747e+05, 4.0036e+05, 4.0035e+05],
        [4.0693e+05, 8.2250e+05, 4.0693e+05, 8.1663e+05, 4.0693e+05, 8.1778e+05,
         4.0695e+05, 4.0695e+05, 8.3954e+05, 0.0000e+00, 4.0694e+05, 4.0692e+05,
         7.9152e+05, 4.0693e+05, 4.0694e+05],
        [1.6613e+00, 4.0421e+05, 1.2659e+00, 4.0626e+05, 1.9109e+00, 3.8990e+05,
         1.3773e+00, 1.7465e+00, 4.0039e+05, 4.0694e+05, 0.0000e+00, 1.8637e+00,
         3.8781e+05, 1.8303e+00, 1.5283e+00],
        [1.4213e+00, 4.0419e+05, 1.6576e+00, 4.0623e+05, 1.2814e+00, 3.8990e+05,
         1.4046e+00, 1.2821e+00, 4.0033e+05, 4.0692e+05, 1.8637e+00, 0.0000e+00,
         3.8781e+05, 1.3499e+00, 1.3664e+00],
        [3.8777e+05, 7.6560e+05, 3.8777e+05, 8.0632e+05, 3.8775e+05, 7.9401e+05,
         3.8777e+05, 3.8781e+05, 7.9747e+05, 7.9152e+05, 3.8781e+05, 3.8781e+05,
         0.0000e+00, 3.8778e+05, 3.8779e+05],
        [1.4796e+00, 4.0417e+05, 1.4996e+00, 4.0627e+05, 1.3093e+00, 3.8993e+05,
         1.3948e+00, 1.3347e+00, 4.0036e+05, 4.0693e+05, 1.8303e+00, 1.3499e+00,
         3.8778e+05, 0.0000e+00, 1.3972e+00],
        [1.3047e+00, 4.0420e+05, 1.3777e+00, 4.0625e+05, 1.3767e+00, 3.8992e+05,
         1.1629e+00, 1.2511e+00, 4.0035e+05, 4.0694e+05, 1.5283e+00, 1.3664e+00,
         3.8779e+05, 1.3972e+00, 0.0000e+00]])
Krum scores: ['1.37', '404179.69', '1.39', '406253.56', '1.37', '389916.50', '1.28', '1.31', '400347.94', '406932.41', '1.61', '1.39', '387778.47', '1.40', '1.32']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [7, 17, 9, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0255s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:42...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:42, End: 2025-07-22 15:30:42)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 6, 12], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.2911e+00, 1.4166e+00, 1.2654e+00, 1.5307e+00, 3.8887e+05,
         1.3929e+00, 3.8634e+05, 1.6205e+00, 1.2711e+00, 3.8759e+05, 1.5534e+00,
         1.3423e+00, 1.3615e+00, 1.3157e+00],
        [1.2911e+00, 0.0000e+00, 1.2237e+00, 1.3120e+00, 1.3666e+00, 3.8883e+05,
         1.3415e+00, 3.8634e+05, 1.4106e+00, 1.2089e+00, 3.8756e+05, 1.4125e+00,
         1.3311e+00, 1.3569e+00, 1.2314e+00],
        [1.4166e+00, 1.2237e+00, 0.0000e+00, 1.2298e+00, 1.2701e+00, 3.8884e+05,
         1.2966e+00, 3.8635e+05, 1.3754e+00, 1.1465e+00, 3.8756e+05, 1.3619e+00,
         1.2686e+00, 1.2741e+00, 1.2292e+00],
        [1.2654e+00, 1.3120e+00, 1.2298e+00, 0.0000e+00, 1.4215e+00, 3.8888e+05,
         1.3452e+00, 3.8633e+05, 1.5276e+00, 1.2755e+00, 3.8759e+05, 1.5071e+00,
         1.2927e+00, 1.3175e+00, 1.3354e+00],
        [1.5307e+00, 1.3666e+00, 1.2701e+00, 1.4215e+00, 0.0000e+00, 3.8883e+05,
         1.5302e+00, 3.8636e+05, 1.2058e+00, 1.3067e+00, 3.8761e+05, 1.0798e+00,
         1.5221e+00, 1.4683e+00, 1.2961e+00],
        [3.8887e+05, 3.8883e+05, 3.8884e+05, 3.8888e+05, 3.8883e+05, 0.0000e+00,
         3.8884e+05, 7.8018e+05, 3.8884e+05, 3.8887e+05, 7.6543e+05, 3.8885e+05,
         3.8882e+05, 3.8885e+05, 3.8885e+05],
        [1.3929e+00, 1.3415e+00, 1.2966e+00, 1.3452e+00, 1.5302e+00, 3.8884e+05,
         0.0000e+00, 3.8637e+05, 1.6812e+00, 1.2728e+00, 3.8760e+05, 1.7354e+00,
         1.2225e+00, 1.2733e+00, 1.3462e+00],
        [3.8634e+05, 3.8634e+05, 3.8635e+05, 3.8633e+05, 3.8636e+05, 7.8018e+05,
         3.8637e+05, 0.0000e+00, 3.8635e+05, 3.8636e+05, 7.7263e+05, 3.8640e+05,
         3.8634e+05, 3.8632e+05, 3.8634e+05],
        [1.6205e+00, 1.4106e+00, 1.3754e+00, 1.5276e+00, 1.2058e+00, 3.8884e+05,
         1.6812e+00, 3.8635e+05, 0.0000e+00, 1.5557e+00, 3.8758e+05, 1.1652e+00,
         1.6394e+00, 1.7601e+00, 1.2973e+00],
        [1.2711e+00, 1.2089e+00, 1.1465e+00, 1.2755e+00, 1.3067e+00, 3.8887e+05,
         1.2728e+00, 3.8636e+05, 1.5557e+00, 0.0000e+00, 3.8758e+05, 1.4990e+00,
         1.1828e+00, 1.2750e+00, 1.1839e+00],
        [3.8759e+05, 3.8756e+05, 3.8756e+05, 3.8759e+05, 3.8761e+05, 7.6543e+05,
         3.8760e+05, 7.7263e+05, 3.8758e+05, 3.8758e+05, 0.0000e+00, 3.8754e+05,
         3.8759e+05, 3.8755e+05, 3.8757e+05],
        [1.5534e+00, 1.4125e+00, 1.3619e+00, 1.5071e+00, 1.0798e+00, 3.8885e+05,
         1.7354e+00, 3.8640e+05, 1.1652e+00, 1.4990e+00, 3.8754e+05, 0.0000e+00,
         1.5749e+00, 1.6395e+00, 1.2774e+00],
        [1.3423e+00, 1.3311e+00, 1.2686e+00, 1.2927e+00, 1.5221e+00, 3.8882e+05,
         1.2225e+00, 3.8634e+05, 1.6394e+00, 1.1828e+00, 3.8759e+05, 1.5749e+00,
         0.0000e+00, 1.2702e+00, 1.2771e+00],
        [1.3615e+00, 1.3569e+00, 1.2741e+00, 1.3175e+00, 1.4683e+00, 3.8885e+05,
         1.2733e+00, 3.8632e+05, 1.7601e+00, 1.2750e+00, 3.8755e+05, 1.6395e+00,
         1.2702e+00, 0.0000e+00, 1.3694e+00],
        [1.3157e+00, 1.2314e+00, 1.2292e+00, 1.3354e+00, 1.2961e+00, 3.8885e+05,
         1.3462e+00, 3.8634e+05, 1.2973e+00, 1.1839e+00, 3.8757e+05, 1.2774e+00,
         1.2771e+00, 1.3694e+00, 0.0000e+00]])
Krum scores: ['1.37', '1.31', '1.27', '1.33', '1.35', '388842.94', '1.37', '386342.59', '1.45', '1.26', '387572.66', '1.41', '1.33', '1.36', '1.28']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0187s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:43...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 47 216]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:43, End: 2025-07-22 15:30:43)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4512e+00, 3.9406e+05, 1.2681e+00, 1.5564e+00, 3.9522e+05,
         3.9342e+05, 3.8920e+05, 1.4795e+00, 1.4438e+00, 4.0360e+05, 3.9311e+05,
         1.5162e+00, 1.3472e+00, 4.0808e+05, 1.3701e+00],
        [1.4512e+00, 0.0000e+00, 3.9408e+05, 1.2992e+00, 1.3131e+00, 3.9517e+05,
         3.9342e+05, 3.8920e+05, 1.3136e+00, 1.3084e+00, 4.0363e+05, 3.9310e+05,
         1.3831e+00, 1.3019e+00, 4.0807e+05, 1.3381e+00],
        [3.9406e+05, 3.9408e+05, 0.0000e+00, 3.9405e+05, 3.9405e+05, 7.8648e+05,
         7.7563e+05, 7.8352e+05, 3.9403e+05, 3.9402e+05, 7.8856e+05, 8.0950e+05,
         3.9406e+05, 3.9404e+05, 7.9639e+05, 3.9403e+05],
        [1.2681e+00, 1.2992e+00, 3.9405e+05, 0.0000e+00, 1.4142e+00, 3.9520e+05,
         3.9343e+05, 3.8920e+05, 1.3998e+00, 1.4880e+00, 4.0363e+05, 3.9313e+05,
         1.4962e+00, 1.3023e+00, 4.0809e+05, 1.3284e+00],
        [1.5564e+00, 1.3131e+00, 3.9405e+05, 1.4142e+00, 0.0000e+00, 3.9521e+05,
         3.9345e+05, 3.8918e+05, 1.1325e+00, 1.2200e+00, 4.0361e+05, 3.9311e+05,
         1.1048e+00, 1.4265e+00, 4.0811e+05, 1.4593e+00],
        [3.9522e+05, 3.9517e+05, 7.8648e+05, 3.9520e+05, 3.9521e+05, 0.0000e+00,
         7.8658e+05, 7.7455e+05, 3.9519e+05, 3.9520e+05, 7.9133e+05, 7.7788e+05,
         3.9519e+05, 3.9520e+05, 8.0464e+05, 3.9520e+05],
        [3.9342e+05, 3.9342e+05, 7.7563e+05, 3.9343e+05, 3.9345e+05, 7.8658e+05,
         0.0000e+00, 7.8226e+05, 3.9345e+05, 3.9346e+05, 8.1790e+05, 7.9206e+05,
         3.9344e+05, 3.9344e+05, 7.8901e+05, 3.9341e+05],
        [3.8920e+05, 3.8920e+05, 7.8352e+05, 3.8920e+05, 3.8918e+05, 7.7455e+05,
         7.8226e+05, 0.0000e+00, 3.8918e+05, 3.8916e+05, 8.1183e+05, 7.7600e+05,
         3.8919e+05, 3.8918e+05, 7.9527e+05, 3.8921e+05],
        [1.4795e+00, 1.3136e+00, 3.9403e+05, 1.3998e+00, 1.1325e+00, 3.9519e+05,
         3.9345e+05, 3.8918e+05, 0.0000e+00, 1.2040e+00, 4.0360e+05, 3.9312e+05,
         1.0451e+00, 1.4400e+00, 4.0808e+05, 1.6071e+00],
        [1.4438e+00, 1.3084e+00, 3.9402e+05, 1.4880e+00, 1.2200e+00, 3.9520e+05,
         3.9346e+05, 3.8916e+05, 1.2040e+00, 0.0000e+00, 4.0362e+05, 3.9315e+05,
         1.2453e+00, 1.3736e+00, 4.0811e+05, 1.5496e+00],
        [4.0360e+05, 4.0363e+05, 7.8856e+05, 4.0363e+05, 4.0361e+05, 7.9133e+05,
         8.1790e+05, 8.1183e+05, 4.0360e+05, 4.0362e+05, 0.0000e+00, 7.7960e+05,
         4.0363e+05, 4.0361e+05, 7.9107e+05, 4.0364e+05],
        [3.9311e+05, 3.9310e+05, 8.0950e+05, 3.9313e+05, 3.9311e+05, 7.7788e+05,
         7.9206e+05, 7.7600e+05, 3.9312e+05, 3.9315e+05, 7.7960e+05, 0.0000e+00,
         3.9314e+05, 3.9312e+05, 7.9067e+05, 3.9314e+05],
        [1.5162e+00, 1.3831e+00, 3.9406e+05, 1.4962e+00, 1.1048e+00, 3.9519e+05,
         3.9344e+05, 3.8919e+05, 1.0451e+00, 1.2453e+00, 4.0363e+05, 3.9314e+05,
         0.0000e+00, 1.4671e+00, 4.0811e+05, 1.5974e+00],
        [1.3472e+00, 1.3019e+00, 3.9404e+05, 1.3023e+00, 1.4265e+00, 3.9520e+05,
         3.9344e+05, 3.8918e+05, 1.4400e+00, 1.3736e+00, 4.0361e+05, 3.9312e+05,
         1.4671e+00, 0.0000e+00, 4.0811e+05, 1.2738e+00],
        [4.0808e+05, 4.0807e+05, 7.9639e+05, 4.0809e+05, 4.0811e+05, 8.0464e+05,
         7.8901e+05, 7.9527e+05, 4.0808e+05, 4.0811e+05, 7.9107e+05, 7.9067e+05,
         4.0811e+05, 4.0811e+05, 0.0000e+00, 4.0809e+05],
        [1.3701e+00, 1.3381e+00, 3.9403e+05, 1.3284e+00, 1.4593e+00, 3.9520e+05,
         3.9341e+05, 3.8921e+05, 1.6071e+00, 1.5496e+00, 4.0364e+05, 3.9314e+05,
         1.5974e+00, 1.2738e+00, 4.0809e+05, 0.0000e+00]])
Krum scores: ['1.41', '1.32', '394039.59', '1.36', '1.30', '395191.66', '393430.56', '389185.22', '1.29', '1.33', '403614.44', '393118.03', '1.32', '1.35', '408088.47', '1.42']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 2, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0033s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:44...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:44, End: 2025-07-22 15:30:44)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1249e+00, 3.8152e+05, 3.9295e+05, 1.3123e+00, 3.9947e+05,
         3.8679e+05, 1.1883e+00, 3.7471e+05, 1.7667e+00, 1.1882e+00, 3.8649e+05,
         3.8021e+05, 3.8815e+05, 1.1641e+00, 1.1679e+00],
        [1.1249e+00, 0.0000e+00, 3.8151e+05, 3.9294e+05, 1.1291e+00, 3.9944e+05,
         3.8676e+05, 1.1445e+00, 3.7471e+05, 1.5239e+00, 1.0710e+00, 3.8649e+05,
         3.8022e+05, 3.8814e+05, 1.1654e+00, 1.0800e+00],
        [3.8152e+05, 3.8151e+05, 0.0000e+00, 7.8829e+05, 3.8151e+05, 7.7413e+05,
         7.7151e+05, 3.8149e+05, 7.5212e+05, 3.8153e+05, 3.8151e+05, 7.7535e+05,
         7.5043e+05, 7.6356e+05, 3.8149e+05, 3.8151e+05],
        [3.9295e+05, 3.9294e+05, 7.8829e+05, 0.0000e+00, 3.9299e+05, 7.6855e+05,
         7.9611e+05, 3.9295e+05, 7.4676e+05, 3.9298e+05, 3.9297e+05, 7.7247e+05,
         7.7172e+05, 7.7809e+05, 3.9295e+05, 3.9295e+05],
        [1.3123e+00, 1.1291e+00, 3.8151e+05, 3.9299e+05, 0.0000e+00, 3.9942e+05,
         3.8679e+05, 1.2720e+00, 3.7472e+05, 1.1707e+00, 9.8610e-01, 3.8650e+05,
         3.8023e+05, 3.8814e+05, 1.2542e+00, 1.0890e+00],
        [3.9947e+05, 3.9944e+05, 7.7413e+05, 7.6855e+05, 3.9942e+05, 0.0000e+00,
         8.0789e+05, 3.9940e+05, 7.7942e+05, 3.9943e+05, 3.9944e+05, 7.6315e+05,
         7.8615e+05, 7.6671e+05, 3.9945e+05, 3.9941e+05],
        [3.8679e+05, 3.8676e+05, 7.7151e+05, 7.9611e+05, 3.8679e+05, 8.0789e+05,
         0.0000e+00, 3.8680e+05, 7.6163e+05, 3.8677e+05, 3.8680e+05, 7.7817e+05,
         7.7817e+05, 7.5660e+05, 3.8680e+05, 3.8679e+05],
        [1.1883e+00, 1.1445e+00, 3.8149e+05, 3.9295e+05, 1.2720e+00, 3.9940e+05,
         3.8680e+05, 0.0000e+00, 3.7473e+05, 1.8420e+00, 1.1947e+00, 3.8648e+05,
         3.8020e+05, 3.8815e+05, 1.0723e+00, 1.2191e+00],
        [3.7471e+05, 3.7471e+05, 7.5212e+05, 7.4676e+05, 3.7472e+05, 7.7942e+05,
         7.6163e+05, 3.7473e+05, 0.0000e+00, 3.7475e+05, 3.7471e+05, 7.6529e+05,
         7.7011e+05, 7.5888e+05, 3.7472e+05, 3.7476e+05],
        [1.7667e+00, 1.5239e+00, 3.8153e+05, 3.9298e+05, 1.1707e+00, 3.9943e+05,
         3.8677e+05, 1.8420e+00, 3.7475e+05, 0.0000e+00, 1.2854e+00, 3.8648e+05,
         3.8022e+05, 3.8811e+05, 1.9225e+00, 1.3516e+00],
        [1.1882e+00, 1.0710e+00, 3.8151e+05, 3.9297e+05, 9.8610e-01, 3.9944e+05,
         3.8680e+05, 1.1947e+00, 3.7471e+05, 1.2854e+00, 0.0000e+00, 3.8648e+05,
         3.8020e+05, 3.8815e+05, 1.2072e+00, 1.0075e+00],
        [3.8649e+05, 3.8649e+05, 7.7535e+05, 7.7247e+05, 3.8650e+05, 7.6315e+05,
         7.7817e+05, 3.8648e+05, 7.6529e+05, 3.8648e+05, 3.8648e+05, 0.0000e+00,
         7.9223e+05, 7.8120e+05, 3.8646e+05, 3.8647e+05],
        [3.8021e+05, 3.8022e+05, 7.5043e+05, 7.7172e+05, 3.8023e+05, 7.8615e+05,
         7.7817e+05, 3.8020e+05, 7.7011e+05, 3.8022e+05, 3.8020e+05, 7.9223e+05,
         0.0000e+00, 7.5738e+05, 3.8021e+05, 3.8024e+05],
        [3.8815e+05, 3.8814e+05, 7.6356e+05, 7.7809e+05, 3.8814e+05, 7.6671e+05,
         7.5660e+05, 3.8815e+05, 7.5888e+05, 3.8811e+05, 3.8815e+05, 7.8120e+05,
         7.5738e+05, 0.0000e+00, 3.8815e+05, 3.8815e+05],
        [1.1641e+00, 1.1654e+00, 3.8149e+05, 3.9295e+05, 1.2542e+00, 3.9945e+05,
         3.8680e+05, 1.0723e+00, 3.7472e+05, 1.9225e+00, 1.2072e+00, 3.8646e+05,
         3.8021e+05, 3.8815e+05, 0.0000e+00, 1.2178e+00],
        [1.1679e+00, 1.0800e+00, 3.8151e+05, 3.9295e+05, 1.0890e+00, 3.9941e+05,
         3.8679e+05, 1.2191e+00, 3.7476e+05, 1.3516e+00, 1.0075e+00, 3.8647e+05,
         3.8024e+05, 3.8815e+05, 1.2178e+00, 0.0000e+00]])
Krum scores: ['1.19', '1.12', '381504.03', '392952.28', '1.15', '399422.62', '386783.75', '1.18', '374715.88', '1.49', '1.11', '386475.78', '380209.91', '388138.72', '1.18', '1.13']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0050s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:44...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 47 216]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:44, End: 2025-07-22 15:30:44)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 10, 16, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1212e+00, 3.9270e+05, 3.8554e+05, 1.1217e+00, 1.1064e+00,
         3.9428e+05, 3.8792e+05, 1.1611e+00, 3.9254e+05, 1.3035e+00, 3.9882e+05,
         4.0166e+05, 1.1369e+00, 3.6958e+05, 1.0761e+00],
        [1.1212e+00, 0.0000e+00, 3.9270e+05, 3.8556e+05, 1.0622e+00, 1.0792e+00,
         3.9428e+05, 3.8791e+05, 1.0948e+00, 3.9254e+05, 1.2468e+00, 3.9884e+05,
         4.0167e+05, 1.0745e+00, 3.6962e+05, 1.0809e+00],
        [3.9270e+05, 3.9270e+05, 0.0000e+00, 7.6983e+05, 3.9270e+05, 3.9270e+05,
         8.0086e+05, 7.7115e+05, 3.9271e+05, 8.0163e+05, 3.9269e+05, 8.1141e+05,
         7.9395e+05, 3.9270e+05, 7.4973e+05, 3.9270e+05],
        [3.8554e+05, 3.8556e+05, 7.6983e+05, 0.0000e+00, 3.8555e+05, 3.8558e+05,
         7.8496e+05, 7.9205e+05, 3.8556e+05, 7.9726e+05, 3.8558e+05, 7.8753e+05,
         7.6723e+05, 3.8558e+05, 7.7151e+05, 3.8557e+05],
        [1.1217e+00, 1.0622e+00, 3.9270e+05, 3.8555e+05, 0.0000e+00, 1.1266e+00,
         3.9425e+05, 3.8794e+05, 1.1318e+00, 3.9256e+05, 1.3579e+00, 3.9884e+05,
         4.0166e+05, 1.0803e+00, 3.6961e+05, 1.1746e+00],
        [1.1064e+00, 1.0792e+00, 3.9270e+05, 3.8558e+05, 1.1266e+00, 0.0000e+00,
         3.9428e+05, 3.8793e+05, 1.1961e+00, 3.9254e+05, 9.8326e-01, 3.9883e+05,
         4.0166e+05, 1.1241e+00, 3.6961e+05, 1.0454e+00],
        [3.9428e+05, 3.9428e+05, 8.0086e+05, 7.8496e+05, 3.9425e+05, 3.9428e+05,
         0.0000e+00, 7.3712e+05, 3.9425e+05, 7.9486e+05, 3.9428e+05, 7.8466e+05,
         8.0765e+05, 3.9426e+05, 7.5654e+05, 3.9428e+05],
        [3.8792e+05, 3.8791e+05, 7.7115e+05, 7.9205e+05, 3.8794e+05, 3.8793e+05,
         7.3712e+05, 0.0000e+00, 3.8792e+05, 7.8550e+05, 3.8791e+05, 7.7645e+05,
         7.8515e+05, 3.8790e+05, 7.6737e+05, 3.8793e+05],
        [1.1611e+00, 1.0948e+00, 3.9271e+05, 3.8556e+05, 1.1318e+00, 1.1961e+00,
         3.9425e+05, 3.8792e+05, 0.0000e+00, 3.9256e+05, 1.4926e+00, 3.9884e+05,
         4.0166e+05, 1.0585e+00, 3.6960e+05, 1.1569e+00],
        [3.9254e+05, 3.9254e+05, 8.0163e+05, 7.9726e+05, 3.9256e+05, 3.9254e+05,
         7.9486e+05, 7.8550e+05, 3.9256e+05, 0.0000e+00, 3.9254e+05, 8.1998e+05,
         7.9334e+05, 3.9254e+05, 7.5504e+05, 3.9256e+05],
        [1.3035e+00, 1.2468e+00, 3.9269e+05, 3.8558e+05, 1.3579e+00, 9.8326e-01,
         3.9428e+05, 3.8791e+05, 1.4926e+00, 3.9254e+05, 0.0000e+00, 3.9885e+05,
         4.0169e+05, 1.4027e+00, 3.6959e+05, 1.1269e+00],
        [3.9882e+05, 3.9884e+05, 8.1141e+05, 7.8753e+05, 3.9884e+05, 3.9883e+05,
         7.8466e+05, 7.7645e+05, 3.9884e+05, 8.1998e+05, 3.9885e+05, 0.0000e+00,
         8.1020e+05, 3.9883e+05, 7.5524e+05, 3.9884e+05],
        [4.0166e+05, 4.0167e+05, 7.9395e+05, 7.6723e+05, 4.0166e+05, 4.0166e+05,
         8.0765e+05, 7.8515e+05, 4.0166e+05, 7.9334e+05, 4.0169e+05, 8.1020e+05,
         0.0000e+00, 4.0166e+05, 7.7721e+05, 4.0167e+05],
        [1.1369e+00, 1.0745e+00, 3.9270e+05, 3.8558e+05, 1.0803e+00, 1.1241e+00,
         3.9426e+05, 3.8790e+05, 1.0585e+00, 3.9254e+05, 1.4027e+00, 3.9883e+05,
         4.0166e+05, 0.0000e+00, 3.6962e+05, 1.0523e+00],
        [3.6958e+05, 3.6962e+05, 7.4973e+05, 7.7151e+05, 3.6961e+05, 3.6961e+05,
         7.5654e+05, 7.6737e+05, 3.6960e+05, 7.5504e+05, 3.6959e+05, 7.5524e+05,
         7.7721e+05, 3.6962e+05, 0.0000e+00, 3.6959e+05],
        [1.0761e+00, 1.0809e+00, 3.9270e+05, 3.8557e+05, 1.1746e+00, 1.0454e+00,
         3.9428e+05, 3.8793e+05, 1.1569e+00, 3.9256e+05, 1.1269e+00, 3.9884e+05,
         4.0167e+05, 1.0523e+00, 3.6959e+05, 0.0000e+00]])
Krum scores: ['1.12', '1.09', '392698.25', '385561.34', '1.12', '1.08', '394266.16', '387913.50', '1.13', '392543.47', '1.24', '398833.47', '401660.47', '1.09', '369597.62', '1.09']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0189s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:45...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:45, End: 2025-07-22 15:30:45)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.0776e+00, 1.1708e+00, 3.8699e+05, 3.7395e+05, 1.0499e+00,
         3.9466e+05, 3.8929e+05, 1.1259e+00, 3.7933e+05, 1.4052e+00, 1.1991e+00,
         3.7949e+05, 3.9181e+05, 1.2559e+00, 1.0848e+00, 3.8617e+05],
        [1.0776e+00, 0.0000e+00, 1.0596e+00, 3.8702e+05, 3.7394e+05, 1.1097e+00,
         3.9464e+05, 3.8934e+05, 1.1383e+00, 3.7934e+05, 1.2026e+00, 1.0740e+00,
         3.7951e+05, 3.9181e+05, 1.1312e+00, 1.0900e+00, 3.8615e+05],
        [1.1708e+00, 1.0596e+00, 0.0000e+00, 3.8697e+05, 3.7395e+05, 1.0941e+00,
         3.9464e+05, 3.8930e+05, 1.1032e+00, 3.7934e+05, 1.2089e+00, 1.0443e+00,
         3.7949e+05, 3.9181e+05, 1.1410e+00, 1.0682e+00, 3.8614e+05],
        [3.8699e+05, 3.8702e+05, 3.8697e+05, 0.0000e+00, 7.7786e+05, 3.8698e+05,
         8.0951e+05, 7.6238e+05, 3.8698e+05, 7.6579e+05, 3.8699e+05, 3.8699e+05,
         7.7298e+05, 7.9083e+05, 3.8699e+05, 3.8698e+05, 8.0353e+05],
        [3.7395e+05, 3.7394e+05, 3.7395e+05, 7.7786e+05, 0.0000e+00, 3.7397e+05,
         7.6555e+05, 7.8743e+05, 3.7395e+05, 7.3801e+05, 3.7395e+05, 3.7397e+05,
         7.6209e+05, 7.7102e+05, 3.7398e+05, 3.7397e+05, 7.5466e+05],
        [1.0499e+00, 1.1097e+00, 1.0941e+00, 3.8698e+05, 3.7397e+05, 0.0000e+00,
         3.9463e+05, 3.8930e+05, 1.1610e+00, 3.7932e+05, 1.3367e+00, 1.2399e+00,
         3.7950e+05, 3.9183e+05, 1.2682e+00, 1.0638e+00, 3.8619e+05],
        [3.9466e+05, 3.9464e+05, 3.9464e+05, 8.0951e+05, 7.6555e+05, 3.9463e+05,
         0.0000e+00, 7.9388e+05, 3.9466e+05, 7.6062e+05, 3.9465e+05, 3.9464e+05,
         7.6196e+05, 7.9224e+05, 3.9464e+05, 3.9468e+05, 7.6546e+05],
        [3.8929e+05, 3.8934e+05, 3.8930e+05, 7.6238e+05, 7.8743e+05, 3.8930e+05,
         7.9388e+05, 0.0000e+00, 3.8932e+05, 7.8270e+05, 3.8934e+05, 3.8933e+05,
         7.7624e+05, 7.8146e+05, 3.8933e+05, 3.8933e+05, 7.7474e+05],
        [1.1259e+00, 1.1383e+00, 1.1032e+00, 3.8698e+05, 3.7395e+05, 1.1610e+00,
         3.9466e+05, 3.8932e+05, 0.0000e+00, 3.7934e+05, 1.4827e+00, 1.3659e+00,
         3.7950e+05, 3.9181e+05, 1.4090e+00, 1.0460e+00, 3.8616e+05],
        [3.7933e+05, 3.7934e+05, 3.7934e+05, 7.6579e+05, 7.3801e+05, 3.7932e+05,
         7.6062e+05, 7.8270e+05, 3.7934e+05, 0.0000e+00, 3.7934e+05, 3.7934e+05,
         7.6354e+05, 7.5631e+05, 3.7935e+05, 3.7934e+05, 7.6635e+05],
        [1.4052e+00, 1.2026e+00, 1.2089e+00, 3.8699e+05, 3.7395e+05, 1.3367e+00,
         3.9465e+05, 3.8934e+05, 1.4827e+00, 3.7934e+05, 0.0000e+00, 7.9521e-01,
         3.7950e+05, 3.9180e+05, 8.5648e-01, 1.3589e+00, 3.8612e+05],
        [1.1991e+00, 1.0740e+00, 1.0443e+00, 3.8699e+05, 3.7397e+05, 1.2399e+00,
         3.9464e+05, 3.8933e+05, 1.3659e+00, 3.7934e+05, 7.9521e-01, 0.0000e+00,
         3.7950e+05, 3.9182e+05, 8.7565e-01, 1.1671e+00, 3.8613e+05],
        [3.7949e+05, 3.7951e+05, 3.7949e+05, 7.7298e+05, 7.6209e+05, 3.7950e+05,
         7.6196e+05, 7.7624e+05, 3.7950e+05, 7.6354e+05, 3.7950e+05, 3.7950e+05,
         0.0000e+00, 7.8303e+05, 3.7949e+05, 3.7949e+05, 7.7784e+05],
        [3.9181e+05, 3.9181e+05, 3.9181e+05, 7.9083e+05, 7.7102e+05, 3.9183e+05,
         7.9224e+05, 7.8146e+05, 3.9181e+05, 7.5631e+05, 3.9180e+05, 3.9182e+05,
         7.8303e+05, 0.0000e+00, 3.9181e+05, 3.9183e+05, 7.7336e+05],
        [1.2559e+00, 1.1312e+00, 1.1410e+00, 3.8699e+05, 3.7398e+05, 1.2682e+00,
         3.9464e+05, 3.8933e+05, 1.4090e+00, 3.7935e+05, 8.5648e-01, 8.7565e-01,
         3.7949e+05, 3.9181e+05, 0.0000e+00, 1.2675e+00, 3.8613e+05],
        [1.0848e+00, 1.0900e+00, 1.0682e+00, 3.8698e+05, 3.7397e+05, 1.0638e+00,
         3.9468e+05, 3.8933e+05, 1.0460e+00, 3.7934e+05, 1.3589e+00, 1.1671e+00,
         3.7949e+05, 3.9183e+05, 1.2675e+00, 0.0000e+00, 3.8615e+05],
        [3.8617e+05, 3.8615e+05, 3.8614e+05, 8.0353e+05, 7.5466e+05, 3.8619e+05,
         7.6546e+05, 7.7474e+05, 3.8616e+05, 7.6635e+05, 3.8612e+05, 3.8613e+05,
         7.7784e+05, 7.7336e+05, 3.8613e+05, 3.8615e+05, 0.0000e+00]])
Krum scores: ['1.14', '1.10', '1.10', '386984.66', '373954.03', '1.14', '394643.16', '389313.66', '1.19', '379336.03', '1.17', '1.06', '379493.72', '391808.91', '1.11', '1.11', '386140.75']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0039s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:45...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:45, End: 2025-07-22 15:30:45)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 19, 17, 1, 9, 18, 8, 4, 3, 14, 11, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.0889e+00, 4.0440e+05, 3.9205e+05, 9.6807e-01, 1.2868e+00,
         3.9275e+05, 1.0181e+00, 1.3381e+00, 1.5700e+00, 4.0277e+05, 1.2170e+00,
         9.8129e-01, 1.0327e+00],
        [1.0889e+00, 0.0000e+00, 4.0438e+05, 3.9202e+05, 9.9149e-01, 1.0406e+00,
         3.9275e+05, 9.8847e-01, 1.0762e+00, 1.3302e+00, 4.0276e+05, 1.0503e+00,
         9.5035e-01, 9.6962e-01],
        [4.0440e+05, 4.0438e+05, 0.0000e+00, 8.0366e+05, 4.0437e+05, 4.0441e+05,
         7.9610e+05, 4.0439e+05, 4.0440e+05, 4.0440e+05, 8.0940e+05, 4.0440e+05,
         4.0440e+05, 4.0438e+05],
        [3.9205e+05, 3.9202e+05, 8.0366e+05, 0.0000e+00, 3.9204e+05, 3.9205e+05,
         7.8570e+05, 3.9206e+05, 3.9202e+05, 3.9205e+05, 8.0181e+05, 3.9205e+05,
         3.9205e+05, 3.9203e+05],
        [9.6807e-01, 9.9149e-01, 4.0437e+05, 3.9204e+05, 0.0000e+00, 1.1764e+00,
         3.9276e+05, 1.0257e+00, 1.1921e+00, 1.5351e+00, 4.0279e+05, 1.2126e+00,
         9.4816e-01, 1.0730e+00],
        [1.2868e+00, 1.0406e+00, 4.0441e+05, 3.9205e+05, 1.1764e+00, 0.0000e+00,
         3.9276e+05, 1.2930e+00, 7.1751e-01, 7.9800e-01, 4.0280e+05, 7.3880e-01,
         1.2620e+00, 9.9909e-01],
        [3.9275e+05, 3.9275e+05, 7.9610e+05, 7.8570e+05, 3.9276e+05, 3.9276e+05,
         0.0000e+00, 3.9275e+05, 3.9274e+05, 3.9272e+05, 7.9124e+05, 3.9273e+05,
         3.9276e+05, 3.9276e+05],
        [1.0181e+00, 9.8847e-01, 4.0439e+05, 3.9206e+05, 1.0257e+00, 1.2930e+00,
         3.9275e+05, 0.0000e+00, 1.3473e+00, 1.7290e+00, 4.0280e+05, 1.3097e+00,
         9.3549e-01, 1.0566e+00],
        [1.3381e+00, 1.0762e+00, 4.0440e+05, 3.9202e+05, 1.1921e+00, 7.1751e-01,
         3.9274e+05, 1.3473e+00, 0.0000e+00, 7.9511e-01, 4.0280e+05, 7.6601e-01,
         1.3491e+00, 1.0052e+00],
        [1.5700e+00, 1.3302e+00, 4.0440e+05, 3.9205e+05, 1.5351e+00, 7.9800e-01,
         3.9272e+05, 1.7290e+00, 7.9511e-01, 0.0000e+00, 4.0280e+05, 8.9424e-01,
         1.6792e+00, 1.2459e+00],
        [4.0277e+05, 4.0276e+05, 8.0940e+05, 8.0181e+05, 4.0279e+05, 4.0280e+05,
         7.9124e+05, 4.0280e+05, 4.0280e+05, 4.0280e+05, 0.0000e+00, 4.0280e+05,
         4.0277e+05, 4.0280e+05],
        [1.2170e+00, 1.0503e+00, 4.0440e+05, 3.9205e+05, 1.2126e+00, 7.3880e-01,
         3.9273e+05, 1.3097e+00, 7.6601e-01, 8.9424e-01, 4.0280e+05, 0.0000e+00,
         1.2371e+00, 9.9291e-01],
        [9.8129e-01, 9.5035e-01, 4.0440e+05, 3.9205e+05, 9.4816e-01, 1.2620e+00,
         3.9276e+05, 9.3549e-01, 1.3491e+00, 1.6792e+00, 4.0277e+05, 1.2371e+00,
         0.0000e+00, 9.9992e-01],
        [1.0327e+00, 9.6962e-01, 4.0438e+05, 3.9203e+05, 1.0730e+00, 9.9909e-01,
         3.9276e+05, 1.0566e+00, 1.0052e+00, 1.2459e+00, 4.0280e+05, 9.9291e-01,
         9.9992e-01, 0.0000e+00]])
Krum scores: ['1.12', '1.02', '404391.03', '392039.34', '1.07', '1.00', '392745.03', '1.12', '1.03', '1.23', '402786.03', '1.01', '1.08', '1.02']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 19, 17, 1, 9, 18, 8, 4, 3, 14, 11, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:46...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:30:46, End: 2025-07-22 15:30:46)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 9, 20, 18, 15, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 8.9804e-01, 9.8429e-01, 4.0356e+05, 8.9190e-01, 1.5374e+00,
         3.9156e+05, 4.0747e+05, 3.9610e+05, 1.0991e+00, 3.8984e+05, 3.7202e+05,
         1.0621e+00, 9.4990e-01, 3.9921e+05, 9.1899e-01, 9.1130e-01],
        [8.9804e-01, 0.0000e+00, 9.2647e-01, 4.0357e+05, 9.6094e-01, 1.3338e+00,
         3.9155e+05, 4.0750e+05, 3.9613e+05, 9.4091e-01, 3.8983e+05, 3.7203e+05,
         9.5759e-01, 9.7659e-01, 3.9918e+05, 9.4882e-01, 8.7205e-01],
        [9.8429e-01, 9.2647e-01, 0.0000e+00, 4.0353e+05, 9.5294e-01, 1.3174e+00,
         3.9158e+05, 4.0744e+05, 3.9614e+05, 9.5824e-01, 3.8984e+05, 3.7203e+05,
         9.7311e-01, 9.6169e-01, 3.9921e+05, 9.3155e-01, 9.1709e-01],
        [4.0356e+05, 4.0357e+05, 4.0353e+05, 0.0000e+00, 4.0358e+05, 4.0354e+05,
         7.9818e+05, 7.9050e+05, 7.8249e+05, 4.0354e+05, 8.0984e+05, 7.7566e+05,
         4.0353e+05, 4.0355e+05, 7.9660e+05, 4.0355e+05, 4.0353e+05],
        [8.9190e-01, 9.6094e-01, 9.5294e-01, 4.0358e+05, 0.0000e+00, 1.5329e+00,
         3.9158e+05, 4.0748e+05, 3.9614e+05, 1.0511e+00, 3.8984e+05, 3.7204e+05,
         1.0971e+00, 9.3121e-01, 3.9924e+05, 9.1345e-01, 1.0024e+00],
        [1.5374e+00, 1.3338e+00, 1.3174e+00, 4.0354e+05, 1.5329e+00, 0.0000e+00,
         3.9158e+05, 4.0747e+05, 3.9613e+05, 8.1286e-01, 3.8981e+05, 3.7205e+05,
         8.5119e-01, 1.5085e+00, 3.9920e+05, 1.6531e+00, 1.2585e+00],
        [3.9156e+05, 3.9155e+05, 3.9158e+05, 7.9818e+05, 3.9158e+05, 3.9158e+05,
         0.0000e+00, 8.1411e+05, 7.8120e+05, 3.9158e+05, 7.8511e+05, 7.7051e+05,
         3.9158e+05, 3.9156e+05, 7.7599e+05, 3.9157e+05, 3.9158e+05],
        [4.0747e+05, 4.0750e+05, 4.0744e+05, 7.9050e+05, 4.0748e+05, 4.0747e+05,
         8.1411e+05, 0.0000e+00, 8.0926e+05, 4.0745e+05, 8.2037e+05, 7.9763e+05,
         4.0747e+05, 4.0748e+05, 8.1757e+05, 4.0747e+05, 4.0744e+05],
        [3.9610e+05, 3.9613e+05, 3.9614e+05, 7.8249e+05, 3.9614e+05, 3.9613e+05,
         7.8120e+05, 8.0926e+05, 0.0000e+00, 3.9614e+05, 7.8116e+05, 7.5442e+05,
         3.9613e+05, 3.9614e+05, 7.8434e+05, 3.9614e+05, 3.9614e+05],
        [1.0991e+00, 9.4091e-01, 9.5824e-01, 4.0354e+05, 1.0511e+00, 8.1286e-01,
         3.9158e+05, 4.0745e+05, 3.9614e+05, 0.0000e+00, 3.8981e+05, 3.7205e+05,
         7.2197e-01, 1.0944e+00, 3.9920e+05, 1.2050e+00, 8.7947e-01],
        [3.8984e+05, 3.8983e+05, 3.8984e+05, 8.0984e+05, 3.8984e+05, 3.8981e+05,
         7.8511e+05, 8.2037e+05, 7.8116e+05, 3.8981e+05, 0.0000e+00, 7.5858e+05,
         3.8983e+05, 3.8984e+05, 7.9618e+05, 3.8984e+05, 3.8987e+05],
        [3.7202e+05, 3.7203e+05, 3.7203e+05, 7.7566e+05, 3.7204e+05, 3.7205e+05,
         7.7051e+05, 7.9763e+05, 7.5442e+05, 3.7205e+05, 7.5858e+05, 0.0000e+00,
         3.7205e+05, 3.7201e+05, 7.7225e+05, 3.7202e+05, 3.7203e+05],
        [1.0621e+00, 9.5759e-01, 9.7311e-01, 4.0353e+05, 1.0971e+00, 8.5119e-01,
         3.9158e+05, 4.0747e+05, 3.9613e+05, 7.2197e-01, 3.8983e+05, 3.7205e+05,
         0.0000e+00, 1.1128e+00, 3.9920e+05, 1.1534e+00, 8.8556e-01],
        [9.4990e-01, 9.7659e-01, 9.6169e-01, 4.0355e+05, 9.3121e-01, 1.5085e+00,
         3.9156e+05, 4.0748e+05, 3.9614e+05, 1.0944e+00, 3.8984e+05, 3.7201e+05,
         1.1128e+00, 0.0000e+00, 3.9920e+05, 9.0534e-01, 9.3108e-01],
        [3.9921e+05, 3.9918e+05, 3.9921e+05, 7.9660e+05, 3.9924e+05, 3.9920e+05,
         7.7599e+05, 8.1757e+05, 7.8434e+05, 3.9920e+05, 7.9618e+05, 7.7225e+05,
         3.9920e+05, 3.9920e+05, 0.0000e+00, 3.9925e+05, 3.9920e+05],
        [9.1899e-01, 9.4882e-01, 9.3155e-01, 4.0355e+05, 9.1345e-01, 1.6531e+00,
         3.9157e+05, 4.0747e+05, 3.9614e+05, 1.2050e+00, 3.8984e+05, 3.7202e+05,
         1.1534e+00, 9.0534e-01, 3.9925e+05, 0.0000e+00, 9.5809e-01],
        [9.1130e-01, 8.7205e-01, 9.1709e-01, 4.0353e+05, 1.0024e+00, 1.2585e+00,
         3.9158e+05, 4.0744e+05, 3.9614e+05, 8.7947e-01, 3.8987e+05, 3.7203e+05,
         8.8556e-01, 9.3108e-01, 3.9920e+05, 9.5809e-01, 0.0000e+00]])
Krum scores: ['0.96', '0.94', '0.95', '403543.50', '0.98', '1.27', '391570.69', '407461.38', '396129.28', '0.94', '389829.91', '372029.03', '0.96', '0.98', '399200.41', '0.99', '0.92']
Selected index: 16
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 15, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:47...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:47, End: 2025-07-22 15:30:47)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 19, 1, 9, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0356e+00, 3.8377e+05, 9.2473e-01, 1.3834e+00, 4.0838e+05,
         9.9096e-01, 3.8943e+05, 1.2936e+00, 3.8571e+05, 3.9884e+05, 1.1497e+00,
         9.7832e-01, 4.0603e+05, 9.8208e-01, 1.2798e+00],
        [1.0356e+00, 0.0000e+00, 3.8380e+05, 9.7403e-01, 1.1105e+00, 4.0838e+05,
         1.0006e+00, 3.8946e+05, 1.0612e+00, 3.8572e+05, 3.9882e+05, 1.0045e+00,
         9.7605e-01, 4.0603e+05, 9.8294e-01, 1.1622e+00],
        [3.8377e+05, 3.8380e+05, 0.0000e+00, 3.8379e+05, 3.8381e+05, 7.9377e+05,
         3.8381e+05, 7.7832e+05, 3.8381e+05, 7.9361e+05, 7.8828e+05, 3.8381e+05,
         3.8377e+05, 7.9832e+05, 3.8376e+05, 3.8379e+05],
        [9.2473e-01, 9.7403e-01, 3.8379e+05, 0.0000e+00, 1.3218e+00, 4.0837e+05,
         1.0449e+00, 3.8944e+05, 1.2057e+00, 3.8568e+05, 3.9881e+05, 1.1438e+00,
         9.5998e-01, 4.0603e+05, 9.6375e-01, 1.2953e+00],
        [1.3834e+00, 1.1105e+00, 3.8381e+05, 1.3218e+00, 0.0000e+00, 4.0840e+05,
         1.4458e+00, 3.8947e+05, 6.7324e-01, 3.8570e+05, 3.9881e+05, 6.8808e-01,
         1.2812e+00, 4.0605e+05, 1.4396e+00, 7.8023e-01],
        [4.0838e+05, 4.0838e+05, 7.9377e+05, 4.0837e+05, 4.0840e+05, 0.0000e+00,
         4.0836e+05, 8.0191e+05, 4.0838e+05, 7.9110e+05, 8.0173e+05, 4.0838e+05,
         4.0838e+05, 8.3031e+05, 4.0838e+05, 4.0839e+05],
        [9.9096e-01, 1.0006e+00, 3.8381e+05, 1.0449e+00, 1.4458e+00, 4.0836e+05,
         0.0000e+00, 3.8947e+05, 1.3561e+00, 3.8570e+05, 3.9881e+05, 1.2690e+00,
         9.7891e-01, 4.0602e+05, 9.6917e-01, 1.3691e+00],
        [3.8943e+05, 3.8946e+05, 7.7832e+05, 3.8944e+05, 3.8947e+05, 8.0191e+05,
         3.8947e+05, 0.0000e+00, 3.8945e+05, 7.6585e+05, 8.0594e+05, 3.8947e+05,
         3.8945e+05, 8.0319e+05, 3.8946e+05, 3.8946e+05],
        [1.2936e+00, 1.0612e+00, 3.8381e+05, 1.2057e+00, 6.7324e-01, 4.0838e+05,
         1.3561e+00, 3.8945e+05, 0.0000e+00, 3.8571e+05, 3.9881e+05, 7.5829e-01,
         1.2286e+00, 4.0602e+05, 1.3635e+00, 8.2696e-01],
        [3.8571e+05, 3.8572e+05, 7.9361e+05, 3.8568e+05, 3.8570e+05, 7.9110e+05,
         3.8570e+05, 7.6585e+05, 3.8571e+05, 0.0000e+00, 7.7612e+05, 3.8572e+05,
         3.8573e+05, 7.8812e+05, 3.8571e+05, 3.8573e+05],
        [3.9884e+05, 3.9882e+05, 7.8828e+05, 3.9881e+05, 3.9881e+05, 8.0173e+05,
         3.9881e+05, 8.0594e+05, 3.9881e+05, 7.7612e+05, 0.0000e+00, 3.9881e+05,
         3.9879e+05, 8.2153e+05, 3.9879e+05, 3.9882e+05],
        [1.1497e+00, 1.0045e+00, 3.8381e+05, 1.1438e+00, 6.8808e-01, 4.0838e+05,
         1.2690e+00, 3.8947e+05, 7.5829e-01, 3.8572e+05, 3.9881e+05, 0.0000e+00,
         1.1430e+00, 4.0605e+05, 1.2107e+00, 8.3516e-01],
        [9.7832e-01, 9.7605e-01, 3.8377e+05, 9.5998e-01, 1.2812e+00, 4.0838e+05,
         9.7891e-01, 3.8945e+05, 1.2286e+00, 3.8573e+05, 3.9879e+05, 1.1430e+00,
         0.0000e+00, 4.0604e+05, 9.7736e-01, 1.2189e+00],
        [4.0603e+05, 4.0603e+05, 7.9832e+05, 4.0603e+05, 4.0605e+05, 8.3031e+05,
         4.0602e+05, 8.0319e+05, 4.0602e+05, 7.8812e+05, 8.2153e+05, 4.0605e+05,
         4.0604e+05, 0.0000e+00, 4.0604e+05, 4.0605e+05],
        [9.8208e-01, 9.8294e-01, 3.8376e+05, 9.6375e-01, 1.4396e+00, 4.0838e+05,
         9.6917e-01, 3.8946e+05, 1.3635e+00, 3.8571e+05, 3.9879e+05, 1.2107e+00,
         9.7736e-01, 4.0604e+05, 0.0000e+00, 1.3520e+00],
        [1.2798e+00, 1.1622e+00, 3.8379e+05, 1.2953e+00, 7.8023e-01, 4.0839e+05,
         1.3691e+00, 3.8946e+05, 8.2696e-01, 3.8573e+05, 3.9882e+05, 8.3516e-01,
         1.2189e+00, 4.0605e+05, 1.3520e+00, 0.0000e+00]])
Krum scores: ['1.08', '1.02', '383788.00', '1.06', '1.08', '408375.00', '1.12', '389451.78', '1.05', '385705.62', '398806.75', '0.99', '1.06', '406031.38', '1.10', '1.09']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 2, 19, 1, 9, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0075s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:47...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[167  70]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:47, End: 2025-07-22 15:30:47)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.4923e-01, 4.0799e+05, 3.8929e+05, 8.7513e-01, 1.2970e+00,
         4.0525e+05, 3.7988e+05, 9.5335e-01, 3.8532e+05, 1.1268e+00, 3.9466e+05,
         9.4456e-01, 3.8011e+05, 9.4416e-01, 1.0244e+00],
        [9.4923e-01, 0.0000e+00, 4.0797e+05, 3.8925e+05, 9.7835e-01, 1.1119e+00,
         4.0525e+05, 3.7988e+05, 1.0095e+00, 3.8533e+05, 9.9962e-01, 3.9466e+05,
         9.7915e-01, 3.8014e+05, 1.0035e+00, 9.1562e-01],
        [4.0799e+05, 4.0797e+05, 0.0000e+00, 7.8770e+05, 4.0797e+05, 4.0798e+05,
         7.8622e+05, 7.8580e+05, 4.0796e+05, 7.9359e+05, 4.0798e+05, 8.0856e+05,
         4.0794e+05, 7.4994e+05, 4.0796e+05, 4.0798e+05],
        [3.8929e+05, 3.8925e+05, 7.8770e+05, 0.0000e+00, 3.8927e+05, 3.8925e+05,
         7.9150e+05, 7.7165e+05, 3.8927e+05, 7.6900e+05, 3.8924e+05, 7.7529e+05,
         3.8927e+05, 7.6315e+05, 3.8927e+05, 3.8927e+05],
        [8.7513e-01, 9.7835e-01, 4.0797e+05, 3.8927e+05, 0.0000e+00, 1.2879e+00,
         4.0525e+05, 3.7987e+05, 9.5155e-01, 3.8532e+05, 1.1654e+00, 3.9466e+05,
         8.8518e-01, 3.8012e+05, 9.2866e-01, 1.0434e+00],
        [1.2970e+00, 1.1119e+00, 4.0798e+05, 3.8925e+05, 1.2879e+00, 0.0000e+00,
         4.0524e+05, 3.7989e+05, 1.4464e+00, 3.8534e+05, 5.7288e-01, 3.9465e+05,
         1.2825e+00, 3.8015e+05, 1.4183e+00, 7.5084e-01],
        [4.0525e+05, 4.0525e+05, 7.8622e+05, 7.9150e+05, 4.0525e+05, 4.0524e+05,
         0.0000e+00, 7.9104e+05, 4.0523e+05, 7.9582e+05, 4.0523e+05, 8.0066e+05,
         4.0523e+05, 7.7429e+05, 4.0525e+05, 4.0522e+05],
        [3.7988e+05, 3.7988e+05, 7.8580e+05, 7.7165e+05, 3.7987e+05, 3.7989e+05,
         7.9104e+05, 0.0000e+00, 3.7991e+05, 7.6296e+05, 3.7988e+05, 7.6890e+05,
         3.7988e+05, 7.7267e+05, 3.7986e+05, 3.7987e+05],
        [9.5335e-01, 1.0095e+00, 4.0796e+05, 3.8927e+05, 9.5155e-01, 1.4464e+00,
         4.0523e+05, 3.7991e+05, 0.0000e+00, 3.8533e+05, 1.3167e+00, 3.9467e+05,
         8.9116e-01, 3.8010e+05, 9.0426e-01, 1.1331e+00],
        [3.8532e+05, 3.8533e+05, 7.9359e+05, 7.6900e+05, 3.8532e+05, 3.8534e+05,
         7.9582e+05, 7.6296e+05, 3.8533e+05, 0.0000e+00, 3.8533e+05, 7.8064e+05,
         3.8533e+05, 7.6392e+05, 3.8533e+05, 3.8535e+05],
        [1.1268e+00, 9.9962e-01, 4.0798e+05, 3.8924e+05, 1.1654e+00, 5.7288e-01,
         4.0523e+05, 3.7988e+05, 1.3167e+00, 3.8533e+05, 0.0000e+00, 3.9464e+05,
         1.1170e+00, 3.8014e+05, 1.2934e+00, 7.0273e-01],
        [3.9466e+05, 3.9466e+05, 8.0856e+05, 7.7529e+05, 3.9466e+05, 3.9465e+05,
         8.0066e+05, 7.6890e+05, 3.9467e+05, 7.8064e+05, 3.9464e+05, 0.0000e+00,
         3.9467e+05, 7.7781e+05, 3.9468e+05, 3.9469e+05],
        [9.4456e-01, 9.7915e-01, 4.0794e+05, 3.8927e+05, 8.8518e-01, 1.2825e+00,
         4.0523e+05, 3.7988e+05, 8.9116e-01, 3.8533e+05, 1.1170e+00, 3.9467e+05,
         0.0000e+00, 3.8012e+05, 9.0886e-01, 1.0057e+00],
        [3.8011e+05, 3.8014e+05, 7.4994e+05, 7.6315e+05, 3.8012e+05, 3.8015e+05,
         7.7429e+05, 7.7267e+05, 3.8010e+05, 7.6392e+05, 3.8014e+05, 7.7781e+05,
         3.8012e+05, 0.0000e+00, 3.8013e+05, 3.8012e+05],
        [9.4416e-01, 1.0035e+00, 4.0796e+05, 3.8927e+05, 9.2866e-01, 1.4183e+00,
         4.0525e+05, 3.7986e+05, 9.0426e-01, 3.8533e+05, 1.2934e+00, 3.9468e+05,
         9.0886e-01, 3.8013e+05, 0.0000e+00, 1.1012e+00],
        [1.0244e+00, 9.1562e-01, 4.0798e+05, 3.8927e+05, 1.0434e+00, 7.5084e-01,
         4.0522e+05, 3.7987e+05, 1.1331e+00, 3.8535e+05, 7.0273e-01, 3.9469e+05,
         1.0057e+00, 3.8012e+05, 1.1012e+00, 0.0000e+00]])
Krum scores: ['0.97', '0.98', '407965.56', '389261.06', '0.98', '1.10', '405235.22', '379875.22', '1.02', '385327.69', '1.00', '394660.16', '0.96', '380119.03', '1.01', '0.93']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0059s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:48...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:48, End: 2025-07-22 15:30:48)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 9.3606e-01, 9.6201e-01, 3.8791e+05, 3.6609e+05, 8.3207e-01,
         1.1639e+00, 3.9845e+05, 3.8832e+05, 9.1342e-01, 3.8650e+05, 1.0979e+00,
         1.0971e+00, 3.9706e+05, 3.9560e+05, 1.1910e+00, 9.0624e-01, 3.8540e+05,
         8.7104e-01, 1.3142e+00],
        [9.3606e-01, 0.0000e+00, 9.2884e-01, 3.8794e+05, 3.6610e+05, 9.4180e-01,
         1.0316e+00, 3.9842e+05, 3.8832e+05, 9.6199e-01, 3.8651e+05, 1.0416e+00,
         1.0159e+00, 3.9707e+05, 3.9558e+05, 1.1079e+00, 9.7224e-01, 3.8539e+05,
         9.5538e-01, 1.2047e+00],
        [9.6201e-01, 9.2884e-01, 0.0000e+00, 3.8791e+05, 3.6609e+05, 8.8015e-01,
         9.5478e-01, 3.9846e+05, 3.8827e+05, 9.2721e-01, 3.8651e+05, 9.4100e-01,
         9.3030e-01, 3.9707e+05, 3.9561e+05, 1.0075e+00, 8.9066e-01, 3.8541e+05,
         8.9938e-01, 1.1509e+00],
        [3.8791e+05, 3.8794e+05, 3.8791e+05, 0.0000e+00, 7.5859e+05, 3.8789e+05,
         3.8792e+05, 7.9961e+05, 7.8314e+05, 3.8793e+05, 7.5781e+05, 3.8792e+05,
         3.8792e+05, 7.8960e+05, 8.0107e+05, 3.8794e+05, 3.8789e+05, 7.6881e+05,
         3.8792e+05, 3.8792e+05],
        [3.6609e+05, 3.6610e+05, 3.6609e+05, 7.5859e+05, 0.0000e+00, 3.6610e+05,
         3.6609e+05, 7.6131e+05, 7.6301e+05, 3.6608e+05, 7.6109e+05, 3.6607e+05,
         3.6605e+05, 7.6131e+05, 7.5200e+05, 3.6607e+05, 3.6608e+05, 7.3860e+05,
         3.6611e+05, 3.6609e+05],
        [8.3207e-01, 9.4180e-01, 8.8015e-01, 3.8789e+05, 3.6610e+05, 0.0000e+00,
         1.1928e+00, 3.9844e+05, 3.8832e+05, 9.2942e-01, 3.8648e+05, 1.1126e+00,
         1.1830e+00, 3.9707e+05, 3.9558e+05, 1.2719e+00, 8.7201e-01, 3.8540e+05,
         8.8405e-01, 1.4260e+00],
        [1.1639e+00, 1.0316e+00, 9.5478e-01, 3.8792e+05, 3.6609e+05, 1.1928e+00,
         0.0000e+00, 3.9845e+05, 3.8828e+05, 1.2950e+00, 3.8654e+05, 6.4213e-01,
         5.6076e-01, 3.9708e+05, 3.9561e+05, 5.0567e-01, 1.1052e+00, 3.8540e+05,
         1.2150e+00, 6.4279e-01],
        [3.9845e+05, 3.9842e+05, 3.9846e+05, 7.9961e+05, 7.6131e+05, 3.9844e+05,
         3.9845e+05, 0.0000e+00, 8.0198e+05, 3.9845e+05, 7.8594e+05, 3.9847e+05,
         3.9843e+05, 8.0618e+05, 7.7552e+05, 3.9846e+05, 3.9845e+05, 8.0807e+05,
         3.9845e+05, 3.9846e+05],
        [3.8832e+05, 3.8832e+05, 3.8827e+05, 7.8314e+05, 7.6301e+05, 3.8832e+05,
         3.8828e+05, 8.0198e+05, 0.0000e+00, 3.8829e+05, 8.0021e+05, 3.8829e+05,
         3.8830e+05, 7.8630e+05, 7.9645e+05, 3.8830e+05, 3.8830e+05, 7.6386e+05,
         3.8830e+05, 3.8829e+05],
        [9.1342e-01, 9.6199e-01, 9.2721e-01, 3.8793e+05, 3.6608e+05, 9.2942e-01,
         1.2950e+00, 3.9845e+05, 3.8829e+05, 0.0000e+00, 3.8650e+05, 1.2506e+00,
         1.2753e+00, 3.9709e+05, 3.9557e+05, 1.3983e+00, 9.1472e-01, 3.8540e+05,
         8.9333e-01, 1.5044e+00],
        [3.8650e+05, 3.8651e+05, 3.8651e+05, 7.5781e+05, 7.6109e+05, 3.8648e+05,
         3.8654e+05, 7.8594e+05, 8.0021e+05, 3.8650e+05, 0.0000e+00, 3.8653e+05,
         3.8652e+05, 7.6429e+05, 7.6116e+05, 3.8653e+05, 3.8648e+05, 7.8059e+05,
         3.8651e+05, 3.8651e+05],
        [1.0979e+00, 1.0416e+00, 9.4100e-01, 3.8792e+05, 3.6607e+05, 1.1126e+00,
         6.4213e-01, 3.9847e+05, 3.8829e+05, 1.2506e+00, 3.8653e+05, 0.0000e+00,
         6.6605e-01, 3.9707e+05, 3.9559e+05, 6.6176e-01, 1.1004e+00, 3.8538e+05,
         1.1844e+00, 7.4493e-01],
        [1.0971e+00, 1.0159e+00, 9.3030e-01, 3.8792e+05, 3.6605e+05, 1.1830e+00,
         5.6076e-01, 3.9843e+05, 3.8830e+05, 1.2753e+00, 3.8652e+05, 6.6605e-01,
         0.0000e+00, 3.9708e+05, 3.9561e+05, 6.2121e-01, 1.0720e+00, 3.8541e+05,
         1.1950e+00, 6.9513e-01],
        [3.9706e+05, 3.9707e+05, 3.9707e+05, 7.8960e+05, 7.6131e+05, 3.9707e+05,
         3.9708e+05, 8.0618e+05, 7.8630e+05, 3.9709e+05, 7.6429e+05, 3.9707e+05,
         3.9708e+05, 0.0000e+00, 8.0766e+05, 3.9708e+05, 3.9705e+05, 7.8672e+05,
         3.9706e+05, 3.9708e+05],
        [3.9560e+05, 3.9558e+05, 3.9561e+05, 8.0107e+05, 7.5200e+05, 3.9558e+05,
         3.9561e+05, 7.7552e+05, 7.9645e+05, 3.9557e+05, 7.6116e+05, 3.9559e+05,
         3.9561e+05, 8.0766e+05, 0.0000e+00, 3.9560e+05, 3.9558e+05, 7.8313e+05,
         3.9557e+05, 3.9560e+05],
        [1.1910e+00, 1.1079e+00, 1.0075e+00, 3.8794e+05, 3.6607e+05, 1.2719e+00,
         5.0567e-01, 3.9846e+05, 3.8830e+05, 1.3983e+00, 3.8653e+05, 6.6176e-01,
         6.2121e-01, 3.9708e+05, 3.9560e+05, 0.0000e+00, 1.1965e+00, 3.8542e+05,
         1.2933e+00, 5.9454e-01],
        [9.0624e-01, 9.7224e-01, 8.9066e-01, 3.8789e+05, 3.6608e+05, 8.7201e-01,
         1.1052e+00, 3.9845e+05, 3.8830e+05, 9.1472e-01, 3.8648e+05, 1.1004e+00,
         1.0720e+00, 3.9705e+05, 3.9558e+05, 1.1965e+00, 0.0000e+00, 3.8542e+05,
         8.9913e-01, 1.2876e+00],
        [3.8540e+05, 3.8539e+05, 3.8541e+05, 7.6881e+05, 7.3860e+05, 3.8540e+05,
         3.8540e+05, 8.0807e+05, 7.6386e+05, 3.8540e+05, 7.8059e+05, 3.8538e+05,
         3.8541e+05, 7.8672e+05, 7.8313e+05, 3.8542e+05, 3.8542e+05, 0.0000e+00,
         3.8542e+05, 3.8541e+05],
        [8.7104e-01, 9.5538e-01, 8.9938e-01, 3.8792e+05, 3.6611e+05, 8.8405e-01,
         1.2150e+00, 3.9845e+05, 3.8830e+05, 8.9333e-01, 3.8651e+05, 1.1844e+00,
         1.1950e+00, 3.9706e+05, 3.9557e+05, 1.2933e+00, 8.9913e-01, 3.8542e+05,
         0.0000e+00, 1.4194e+00],
        [1.3142e+00, 1.2047e+00, 1.1509e+00, 3.8792e+05, 3.6609e+05, 1.4260e+00,
         6.4279e-01, 3.9846e+05, 3.8829e+05, 1.5044e+00, 3.8651e+05, 7.4493e-01,
         6.9513e-01, 3.9708e+05, 3.9560e+05, 5.9454e-01, 1.2876e+00, 3.8541e+05,
         1.4194e+00, 0.0000e+00]])
Krum scores: ['1.00', '0.99', '0.93', '387912.66', '366080.56', '1.01', '0.90', '398444.38', '388294.62', '1.08', '386504.75', '0.92', '0.90', '397068.00', '395588.66', '0.95', '0.99', '385402.00', '1.03', '1.05']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0067s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:48...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:48, End: 2025-07-22 15:30:48)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 19, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.2133e-01, 3.9288e+05, 7.9764e-01, 1.6105e+00, 3.8843e+05,
         8.8829e-01, 3.8015e+05, 9.9799e-01, 1.0395e+00, 3.9075e+05, 3.9947e+05,
         1.0988e+00, 8.9965e-01, 4.0106e+05, 1.0468e+00],
        [9.2133e-01, 0.0000e+00, 3.9291e+05, 8.1698e-01, 1.3128e+00, 3.8844e+05,
         8.7483e-01, 3.8012e+05, 8.3770e-01, 8.8290e-01, 3.9073e+05, 3.9947e+05,
         9.0010e-01, 8.5949e-01, 4.0107e+05, 8.9875e-01],
        [3.9288e+05, 3.9291e+05, 0.0000e+00, 3.9288e+05, 3.9292e+05, 7.8874e+05,
         3.9288e+05, 7.7630e+05, 3.9287e+05, 3.9289e+05, 7.9985e+05, 8.0142e+05,
         3.9290e+05, 3.9290e+05, 8.0200e+05, 3.9290e+05],
        [7.9764e-01, 8.1698e-01, 3.9288e+05, 0.0000e+00, 1.5365e+00, 3.8845e+05,
         9.1126e-01, 3.8013e+05, 9.2535e-01, 1.0441e+00, 3.9075e+05, 3.9949e+05,
         1.0716e+00, 8.5327e-01, 4.0106e+05, 1.0228e+00],
        [1.6105e+00, 1.3128e+00, 3.9292e+05, 1.5365e+00, 0.0000e+00, 3.8844e+05,
         1.7881e+00, 3.8013e+05, 8.2047e-01, 7.3947e-01, 3.9078e+05, 3.9949e+05,
         5.7403e-01, 1.5931e+00, 4.0106e+05, 6.4787e-01],
        [3.8843e+05, 3.8844e+05, 7.8874e+05, 3.8845e+05, 3.8844e+05, 0.0000e+00,
         3.8846e+05, 7.5786e+05, 3.8843e+05, 3.8843e+05, 7.9050e+05, 7.9376e+05,
         3.8845e+05, 3.8844e+05, 7.8196e+05, 3.8844e+05],
        [8.8829e-01, 8.7483e-01, 3.9288e+05, 9.1126e-01, 1.7881e+00, 3.8846e+05,
         0.0000e+00, 3.8013e+05, 1.1207e+00, 1.2118e+00, 3.9075e+05, 3.9949e+05,
         1.2750e+00, 8.6781e-01, 4.0106e+05, 1.1901e+00],
        [3.8015e+05, 3.8012e+05, 7.7630e+05, 3.8013e+05, 3.8013e+05, 7.5786e+05,
         3.8013e+05, 0.0000e+00, 3.8014e+05, 3.8013e+05, 7.6961e+05, 7.8583e+05,
         3.8013e+05, 3.8015e+05, 7.8856e+05, 3.8013e+05],
        [9.9799e-01, 8.3770e-01, 3.9287e+05, 9.2535e-01, 8.2047e-01, 3.8843e+05,
         1.1207e+00, 3.8014e+05, 0.0000e+00, 6.2217e-01, 3.9076e+05, 3.9946e+05,
         5.9106e-01, 1.0266e+00, 4.0107e+05, 5.7588e-01],
        [1.0395e+00, 8.8290e-01, 3.9289e+05, 1.0441e+00, 7.3947e-01, 3.8843e+05,
         1.2118e+00, 3.8013e+05, 6.2217e-01, 0.0000e+00, 3.9077e+05, 3.9949e+05,
         5.9754e-01, 1.0463e+00, 4.0108e+05, 5.4800e-01],
        [3.9075e+05, 3.9073e+05, 7.9985e+05, 3.9075e+05, 3.9078e+05, 7.9050e+05,
         3.9075e+05, 7.6961e+05, 3.9076e+05, 3.9077e+05, 0.0000e+00, 7.9490e+05,
         3.9076e+05, 3.9074e+05, 8.0699e+05, 3.9078e+05],
        [3.9947e+05, 3.9947e+05, 8.0142e+05, 3.9949e+05, 3.9949e+05, 7.9376e+05,
         3.9949e+05, 7.8583e+05, 3.9946e+05, 3.9949e+05, 7.9490e+05, 0.0000e+00,
         3.9949e+05, 3.9946e+05, 7.9102e+05, 3.9946e+05],
        [1.0988e+00, 9.0010e-01, 3.9290e+05, 1.0716e+00, 5.7403e-01, 3.8845e+05,
         1.2750e+00, 3.8013e+05, 5.9106e-01, 5.9754e-01, 3.9076e+05, 3.9949e+05,
         0.0000e+00, 1.1396e+00, 4.0105e+05, 4.7167e-01],
        [8.9965e-01, 8.5949e-01, 3.9290e+05, 8.5327e-01, 1.5931e+00, 3.8844e+05,
         8.6781e-01, 3.8015e+05, 1.0266e+00, 1.0463e+00, 3.9074e+05, 3.9946e+05,
         1.1396e+00, 0.0000e+00, 4.0106e+05, 1.0407e+00],
        [4.0106e+05, 4.0107e+05, 8.0200e+05, 4.0106e+05, 4.0106e+05, 7.8196e+05,
         4.0106e+05, 7.8856e+05, 4.0107e+05, 4.0108e+05, 8.0699e+05, 7.9102e+05,
         4.0105e+05, 4.0106e+05, 0.0000e+00, 4.0107e+05],
        [1.0468e+00, 8.9875e-01, 3.9290e+05, 1.0228e+00, 6.4787e-01, 3.8844e+05,
         1.1901e+00, 3.8013e+05, 5.7588e-01, 5.4800e-01, 3.9078e+05, 3.9946e+05,
         4.7167e-01, 1.0407e+00, 4.0107e+05, 0.0000e+00]])
Krum scores: ['0.96', '0.87', '392888.38', '0.93', '1.10', '388438.53', '1.04', '380130.31', '0.80', '0.82', '390751.28', '399473.38', '0.81', '0.97', '401060.16', '0.78']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [5, 2, 19, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0311s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:49...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 72 191]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:49, End: 2025-07-22 15:30:49)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 13, 14, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 8.5262e-01, 8.9981e-01, 3.9416e+05, 3.9494e+05, 7.7647e-01,
         1.1342e+00, 4.0558e+05, 3.9442e+05, 8.8043e-01, 3.9438e+05, 4.0750e+05,
         4.0455e+05, 1.3024e+00],
        [8.5262e-01, 0.0000e+00, 8.5517e-01, 3.9415e+05, 3.9493e+05, 8.7684e-01,
         1.0214e+00, 4.0560e+05, 3.9439e+05, 9.1358e-01, 3.9439e+05, 4.0748e+05,
         4.0452e+05, 1.1956e+00],
        [8.9981e-01, 8.5517e-01, 0.0000e+00, 3.9415e+05, 3.9492e+05, 8.0785e-01,
         9.3694e-01, 4.0559e+05, 3.9438e+05, 8.7254e-01, 3.9441e+05, 4.0750e+05,
         4.0452e+05, 1.1373e+00],
        [3.9416e+05, 3.9415e+05, 3.9415e+05, 0.0000e+00, 7.8366e+05, 3.9418e+05,
         3.9414e+05, 7.9980e+05, 7.8680e+05, 3.9418e+05, 7.9994e+05, 8.1032e+05,
         8.0954e+05, 3.9414e+05],
        [3.9494e+05, 3.9493e+05, 3.9492e+05, 7.8366e+05, 0.0000e+00, 3.9493e+05,
         3.9492e+05, 8.0585e+05, 8.0337e+05, 3.9493e+05, 7.8880e+05, 7.9879e+05,
         7.9686e+05, 3.9494e+05],
        [7.7647e-01, 8.7684e-01, 8.0785e-01, 3.9418e+05, 3.9493e+05, 0.0000e+00,
         1.1097e+00, 4.0560e+05, 3.9439e+05, 9.0265e-01, 3.9441e+05, 4.0748e+05,
         4.0454e+05, 1.3142e+00],
        [1.1342e+00, 1.0214e+00, 9.3694e-01, 3.9414e+05, 3.9492e+05, 1.1097e+00,
         0.0000e+00, 4.0558e+05, 3.9438e+05, 1.3160e+00, 3.9443e+05, 4.0750e+05,
         4.0452e+05, 4.0283e-01],
        [4.0558e+05, 4.0560e+05, 4.0559e+05, 7.9980e+05, 8.0585e+05, 4.0560e+05,
         4.0558e+05, 0.0000e+00, 8.0685e+05, 4.0561e+05, 8.1071e+05, 8.0008e+05,
         8.1676e+05, 4.0557e+05],
        [3.9442e+05, 3.9439e+05, 3.9438e+05, 7.8680e+05, 8.0337e+05, 3.9439e+05,
         3.9438e+05, 8.0685e+05, 0.0000e+00, 3.9438e+05, 7.5968e+05, 8.0388e+05,
         7.9023e+05, 3.9439e+05],
        [8.8043e-01, 9.1358e-01, 8.7254e-01, 3.9418e+05, 3.9493e+05, 9.0265e-01,
         1.3160e+00, 4.0561e+05, 3.9438e+05, 0.0000e+00, 3.9441e+05, 4.0749e+05,
         4.0451e+05, 1.5378e+00],
        [3.9438e+05, 3.9439e+05, 3.9441e+05, 7.9994e+05, 7.8880e+05, 3.9441e+05,
         3.9443e+05, 8.1071e+05, 7.5968e+05, 3.9441e+05, 0.0000e+00, 7.8895e+05,
         7.8715e+05, 3.9445e+05],
        [4.0750e+05, 4.0748e+05, 4.0750e+05, 8.1032e+05, 7.9879e+05, 4.0748e+05,
         4.0750e+05, 8.0008e+05, 8.0388e+05, 4.0749e+05, 7.8895e+05, 0.0000e+00,
         8.2653e+05, 4.0750e+05],
        [4.0455e+05, 4.0452e+05, 4.0452e+05, 8.0954e+05, 7.9686e+05, 4.0454e+05,
         4.0452e+05, 8.1676e+05, 7.9023e+05, 4.0451e+05, 7.8715e+05, 8.2653e+05,
         0.0000e+00, 4.0453e+05],
        [1.3024e+00, 1.1956e+00, 1.1373e+00, 3.9414e+05, 3.9494e+05, 1.3142e+00,
         4.0283e-01, 4.0557e+05, 3.9439e+05, 1.5378e+00, 3.9445e+05, 4.0750e+05,
         4.0453e+05, 0.0000e+00]])
Krum scores: ['0.91', '0.90', '0.87', '394147.19', '394927.78', '0.89', '0.92', '405585.75', '394383.34', '0.98', '394402.75', '407490.38', '404520.41', '1.07']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 13, 14, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0036s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:49...
global Accuracy on shared test data: 72.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:49, End: 2025-07-22 15:30:49)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.9002e+05, 3.9001e+05, 7.9674e+05, 3.9004e+05, 3.9003e+05,
         3.9003e+05, 7.7324e+05, 7.8974e+05, 3.9002e+05, 3.9004e+05, 7.8126e+05,
         3.9003e+05, 3.9003e+05],
        [3.9002e+05, 0.0000e+00, 1.2547e+00, 3.9304e+05, 9.3695e-01, 1.0173e+00,
         1.1088e+00, 3.8552e+05, 3.9706e+05, 1.1918e+00, 8.6875e-01, 3.9328e+05,
         8.8182e-01, 1.2178e+00],
        [3.9001e+05, 1.2547e+00, 0.0000e+00, 3.9305e+05, 1.4135e+00, 6.6420e-01,
         5.9931e-01, 3.8551e+05, 3.9707e+05, 4.9852e-01, 1.2728e+00, 3.9328e+05,
         1.3712e+00, 4.3550e-01],
        [7.9674e+05, 3.9304e+05, 3.9305e+05, 0.0000e+00, 3.9304e+05, 3.9304e+05,
         3.9302e+05, 7.8026e+05, 8.2028e+05, 3.9303e+05, 3.9303e+05, 7.7922e+05,
         3.9304e+05, 3.9303e+05],
        [3.9004e+05, 9.3695e-01, 1.4135e+00, 3.9304e+05, 0.0000e+00, 1.1679e+00,
         1.2293e+00, 3.8550e+05, 3.9703e+05, 1.3792e+00, 8.8086e-01, 3.9327e+05,
         8.5877e-01, 1.3552e+00],
        [3.9003e+05, 1.0173e+00, 6.6420e-01, 3.9304e+05, 1.1679e+00, 0.0000e+00,
         6.9565e-01, 3.8549e+05, 3.9705e+05, 6.9861e-01, 1.0900e+00, 3.9328e+05,
         1.1479e+00, 6.4030e-01],
        [3.9003e+05, 1.1088e+00, 5.9931e-01, 3.9302e+05, 1.2293e+00, 6.9565e-01,
         0.0000e+00, 3.8550e+05, 3.9708e+05, 6.8423e-01, 1.0800e+00, 3.9327e+05,
         1.1799e+00, 5.8953e-01],
        [7.7324e+05, 3.8552e+05, 3.8551e+05, 7.8026e+05, 3.8550e+05, 3.8549e+05,
         3.8550e+05, 0.0000e+00, 7.7087e+05, 3.8549e+05, 3.8554e+05, 7.8633e+05,
         3.8551e+05, 3.8550e+05],
        [7.8974e+05, 3.9706e+05, 3.9707e+05, 8.2028e+05, 3.9703e+05, 3.9705e+05,
         3.9708e+05, 7.7087e+05, 0.0000e+00, 3.9708e+05, 3.9704e+05, 7.8324e+05,
         3.9705e+05, 3.9708e+05],
        [3.9002e+05, 1.1918e+00, 4.9852e-01, 3.9303e+05, 1.3792e+00, 6.9861e-01,
         6.8423e-01, 3.8549e+05, 3.9708e+05, 0.0000e+00, 1.2530e+00, 3.9327e+05,
         1.2940e+00, 5.1946e-01],
        [3.9004e+05, 8.6875e-01, 1.2728e+00, 3.9303e+05, 8.8086e-01, 1.0900e+00,
         1.0800e+00, 3.8554e+05, 3.9704e+05, 1.2530e+00, 0.0000e+00, 3.9326e+05,
         8.8503e-01, 1.2059e+00],
        [7.8126e+05, 3.9328e+05, 3.9328e+05, 7.7922e+05, 3.9327e+05, 3.9328e+05,
         3.9327e+05, 7.8633e+05, 7.8324e+05, 3.9327e+05, 3.9326e+05, 0.0000e+00,
         3.9327e+05, 3.9327e+05],
        [3.9003e+05, 8.8182e-01, 1.3712e+00, 3.9304e+05, 8.5877e-01, 1.1479e+00,
         1.1799e+00, 3.8551e+05, 3.9705e+05, 1.2940e+00, 8.8503e-01, 3.9327e+05,
         0.0000e+00, 1.3281e+00],
        [3.9003e+05, 1.2178e+00, 4.3550e-01, 3.9303e+05, 1.3552e+00, 6.4030e-01,
         5.8953e-01, 3.8550e+05, 3.9708e+05, 5.1946e-01, 1.2059e+00, 3.9327e+05,
         1.3281e+00, 0.0000e+00]])
Krum scores: ['390023.75', '1.03', '0.87', '393032.22', '1.12', '0.85', '0.85', '385501.16', '397053.66', '0.88', '1.04', '393269.69', '1.08', '0.85']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']], selected_client_indices: [17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0064s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:50...
global Accuracy on shared test data: 73.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 76 187]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:50, End: 2025-07-22 15:30:50)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 8.8795e-01, 9.6483e-01, 3.8895e+05, 3.8706e+05, 8.0042e-01,
         4.0385e+05, 8.5288e-01, 3.6747e+05, 9.9596e-01, 9.9826e-01, 3.8767e+05,
         3.8091e+05, 1.0583e+00, 8.5503e-01, 3.9967e+05, 8.2683e-01, 1.4630e+00],
        [8.8795e-01, 0.0000e+00, 9.1408e-01, 3.8894e+05, 3.8703e+05, 8.9536e-01,
         4.0384e+05, 9.3162e-01, 3.6745e+05, 9.3680e-01, 9.4248e-01, 3.8764e+05,
         3.8095e+05, 9.5352e-01, 9.2265e-01, 3.9970e+05, 9.0874e-01, 1.3090e+00],
        [9.6483e-01, 9.1408e-01, 0.0000e+00, 3.8894e+05, 3.8705e+05, 8.6437e-01,
         4.0382e+05, 9.2470e-01, 3.6746e+05, 6.5954e-01, 6.7039e-01, 3.8764e+05,
         3.8091e+05, 6.5685e-01, 8.7945e-01, 3.9968e+05, 9.1241e-01, 8.6196e-01],
        [3.8895e+05, 3.8894e+05, 3.8894e+05, 0.0000e+00, 7.8198e+05, 3.8893e+05,
         7.7747e+05, 3.8895e+05, 7.6175e+05, 3.8891e+05, 3.8891e+05, 7.6107e+05,
         7.5482e+05, 3.8892e+05, 3.8894e+05, 7.7596e+05, 3.8892e+05, 3.8894e+05],
        [3.8706e+05, 3.8703e+05, 3.8705e+05, 7.8198e+05, 0.0000e+00, 3.8706e+05,
         7.9085e+05, 3.8702e+05, 7.7116e+05, 3.8705e+05, 3.8703e+05, 7.7078e+05,
         7.7187e+05, 3.8707e+05, 3.8701e+05, 7.8407e+05, 3.8706e+05, 3.8705e+05],
        [8.0042e-01, 8.9536e-01, 8.6437e-01, 3.8893e+05, 3.8706e+05, 0.0000e+00,
         4.0384e+05, 8.8766e-01, 3.6744e+05, 8.9570e-01, 9.8913e-01, 3.8765e+05,
         3.8093e+05, 1.0261e+00, 8.3887e-01, 3.9969e+05, 8.3785e-01, 1.4327e+00],
        [4.0385e+05, 4.0384e+05, 4.0382e+05, 7.7747e+05, 7.9085e+05, 4.0384e+05,
         0.0000e+00, 4.0384e+05, 7.5848e+05, 4.0381e+05, 4.0382e+05, 7.8757e+05,
         7.9844e+05, 4.0382e+05, 4.0384e+05, 7.8406e+05, 4.0387e+05, 4.0384e+05],
        [8.5288e-01, 9.3162e-01, 9.2470e-01, 3.8895e+05, 3.8702e+05, 8.8766e-01,
         4.0384e+05, 0.0000e+00, 3.6747e+05, 1.0273e+00, 1.0934e+00, 3.8765e+05,
         3.8092e+05, 1.1398e+00, 8.7608e-01, 3.9969e+05, 8.4585e-01, 1.5581e+00],
        [3.6747e+05, 3.6745e+05, 3.6746e+05, 7.6175e+05, 7.7116e+05, 3.6744e+05,
         7.5848e+05, 3.6747e+05, 0.0000e+00, 3.6744e+05, 3.6744e+05, 7.6596e+05,
         7.6590e+05, 3.6743e+05, 3.6747e+05, 7.8294e+05, 3.6746e+05, 3.6744e+05],
        [9.9596e-01, 9.3680e-01, 6.5954e-01, 3.8891e+05, 3.8705e+05, 8.9570e-01,
         4.0381e+05, 1.0273e+00, 3.6744e+05, 0.0000e+00, 6.3821e-01, 3.8764e+05,
         3.8091e+05, 6.0966e-01, 9.5355e-01, 3.9969e+05, 1.0360e+00, 7.4713e-01],
        [9.9826e-01, 9.4248e-01, 6.7039e-01, 3.8891e+05, 3.8703e+05, 9.8913e-01,
         4.0382e+05, 1.0934e+00, 3.6744e+05, 6.3821e-01, 0.0000e+00, 3.8763e+05,
         3.8096e+05, 6.2094e-01, 9.3765e-01, 3.9968e+05, 1.0309e+00, 6.9819e-01],
        [3.8767e+05, 3.8764e+05, 3.8764e+05, 7.6107e+05, 7.7078e+05, 3.8765e+05,
         7.8757e+05, 3.8765e+05, 7.6596e+05, 3.8764e+05, 3.8763e+05, 0.0000e+00,
         7.8959e+05, 3.8765e+05, 3.8764e+05, 7.8192e+05, 3.8766e+05, 3.8764e+05],
        [3.8091e+05, 3.8095e+05, 3.8091e+05, 7.5482e+05, 7.7187e+05, 3.8093e+05,
         7.9844e+05, 3.8092e+05, 7.6590e+05, 3.8091e+05, 3.8096e+05, 7.8959e+05,
         0.0000e+00, 3.8093e+05, 3.8094e+05, 7.9946e+05, 3.8091e+05, 3.8092e+05],
        [1.0583e+00, 9.5352e-01, 6.5685e-01, 3.8892e+05, 3.8707e+05, 1.0261e+00,
         4.0382e+05, 1.1398e+00, 3.6743e+05, 6.0966e-01, 6.2094e-01, 3.8765e+05,
         3.8093e+05, 0.0000e+00, 1.0281e+00, 3.9967e+05, 1.1070e+00, 5.4090e-01],
        [8.5503e-01, 9.2265e-01, 8.7945e-01, 3.8894e+05, 3.8701e+05, 8.3887e-01,
         4.0384e+05, 8.7608e-01, 3.6747e+05, 9.5355e-01, 9.3765e-01, 3.8764e+05,
         3.8094e+05, 1.0281e+00, 0.0000e+00, 3.9967e+05, 8.5032e-01, 1.3524e+00],
        [3.9967e+05, 3.9970e+05, 3.9968e+05, 7.7596e+05, 7.8407e+05, 3.9969e+05,
         7.8406e+05, 3.9969e+05, 7.8294e+05, 3.9969e+05, 3.9968e+05, 7.8192e+05,
         7.9946e+05, 3.9967e+05, 3.9967e+05, 0.0000e+00, 3.9968e+05, 3.9968e+05],
        [8.2683e-01, 9.0874e-01, 9.1241e-01, 3.8892e+05, 3.8706e+05, 8.3785e-01,
         4.0387e+05, 8.4585e-01, 3.6746e+05, 1.0360e+00, 1.0309e+00, 3.8766e+05,
         3.8091e+05, 1.1070e+00, 8.5032e-01, 3.9968e+05, 0.0000e+00, 1.5408e+00],
        [1.4630e+00, 1.3090e+00, 8.6196e-01, 3.8894e+05, 3.8705e+05, 1.4327e+00,
         4.0384e+05, 1.5581e+00, 3.6744e+05, 7.4713e-01, 6.9819e-01, 3.8764e+05,
         3.8092e+05, 5.4090e-01, 1.3524e+00, 3.9968e+05, 1.5408e+00, 0.0000e+00]])
Krum scores: ['0.92', '0.92', '0.82', '388928.91', '387040.06', '0.89', '403831.66', '0.95', '367447.03', '0.83', '0.84', '387641.81', '380920.25', '0.84', '0.90', '399678.81', '0.93', '1.11']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0051s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:51...
global Accuracy on shared test data: 71.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:51, End: 2025-07-22 15:30:51)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 8.5470e-01, 3.8370e+05, 8.4497e-01, 1.2082e+00, 3.8495e+05,
         8.2972e-01, 9.8072e-01, 1.0357e+00, 3.9473e+05, 3.9780e+05, 1.0845e+00,
         8.7211e-01, 3.9632e+05, 8.6732e-01, 1.1931e+00],
        [8.5470e-01, 0.0000e+00, 3.8368e+05, 9.0897e-01, 1.0632e+00, 3.8494e+05,
         8.8694e-01, 9.2486e-01, 9.5426e-01, 3.9472e+05, 3.9780e+05, 9.6078e-01,
         8.8694e-01, 3.9635e+05, 9.0006e-01, 1.0452e+00],
        [3.8370e+05, 3.8368e+05, 0.0000e+00, 3.8370e+05, 3.8367e+05, 7.6585e+05,
         3.8368e+05, 3.8370e+05, 3.8369e+05, 7.9938e+05, 7.6753e+05, 3.8367e+05,
         3.8368e+05, 7.8454e+05, 3.8371e+05, 3.8367e+05],
        [8.4497e-01, 9.0897e-01, 3.8370e+05, 0.0000e+00, 1.1613e+00, 3.8496e+05,
         8.9694e-01, 9.2432e-01, 1.0287e+00, 3.9474e+05, 3.9781e+05, 1.0685e+00,
         8.4252e-01, 3.9632e+05, 8.6762e-01, 1.1562e+00],
        [1.2082e+00, 1.0632e+00, 3.8367e+05, 1.1613e+00, 0.0000e+00, 3.8491e+05,
         1.2758e+00, 6.4890e-01, 6.2657e-01, 3.9474e+05, 3.9782e+05, 4.8268e-01,
         1.1346e+00, 3.9634e+05, 1.2248e+00, 3.8466e-01],
        [3.8495e+05, 3.8494e+05, 7.6585e+05, 3.8496e+05, 3.8491e+05, 0.0000e+00,
         3.8496e+05, 3.8494e+05, 3.8494e+05, 7.6115e+05, 7.7727e+05, 3.8493e+05,
         3.8494e+05, 7.9731e+05, 3.8496e+05, 3.8494e+05],
        [8.2972e-01, 8.8694e-01, 3.8368e+05, 8.9694e-01, 1.2758e+00, 3.8496e+05,
         0.0000e+00, 1.0223e+00, 1.1312e+00, 3.9475e+05, 3.9779e+05, 1.1913e+00,
         8.5073e-01, 3.9633e+05, 8.3810e-01, 1.2764e+00],
        [9.8072e-01, 9.2486e-01, 3.8370e+05, 9.2432e-01, 6.4890e-01, 3.8494e+05,
         1.0223e+00, 0.0000e+00, 6.7740e-01, 3.9474e+05, 3.9781e+05, 6.3700e-01,
         9.6885e-01, 3.9633e+05, 1.0297e+00, 5.9211e-01],
        [1.0357e+00, 9.5426e-01, 3.8369e+05, 1.0287e+00, 6.2657e-01, 3.8494e+05,
         1.1312e+00, 6.7740e-01, 0.0000e+00, 3.9475e+05, 3.9781e+05, 6.6175e-01,
         9.9004e-01, 3.9635e+05, 1.0809e+00, 5.5447e-01],
        [3.9473e+05, 3.9472e+05, 7.9938e+05, 3.9474e+05, 3.9474e+05, 7.6115e+05,
         3.9475e+05, 3.9474e+05, 3.9475e+05, 0.0000e+00, 7.9211e+05, 3.9472e+05,
         3.9475e+05, 7.9576e+05, 3.9475e+05, 3.9473e+05],
        [3.9780e+05, 3.9780e+05, 7.6753e+05, 3.9781e+05, 3.9782e+05, 7.7727e+05,
         3.9779e+05, 3.9781e+05, 3.9781e+05, 7.9211e+05, 0.0000e+00, 3.9781e+05,
         3.9780e+05, 8.0085e+05, 3.9782e+05, 3.9782e+05],
        [1.0845e+00, 9.6078e-01, 3.8367e+05, 1.0685e+00, 4.8268e-01, 3.8493e+05,
         1.1913e+00, 6.3700e-01, 6.6175e-01, 3.9472e+05, 3.9781e+05, 0.0000e+00,
         1.0756e+00, 3.9635e+05, 1.1291e+00, 4.5990e-01],
        [8.7211e-01, 8.8694e-01, 3.8368e+05, 8.4252e-01, 1.1346e+00, 3.8494e+05,
         8.5073e-01, 9.6885e-01, 9.9004e-01, 3.9475e+05, 3.9780e+05, 1.0756e+00,
         0.0000e+00, 3.9633e+05, 8.6875e-01, 1.1108e+00],
        [3.9632e+05, 3.9635e+05, 7.8454e+05, 3.9632e+05, 3.9634e+05, 7.9731e+05,
         3.9633e+05, 3.9633e+05, 3.9635e+05, 7.9576e+05, 8.0085e+05, 3.9635e+05,
         3.9633e+05, 0.0000e+00, 3.9633e+05, 3.9635e+05],
        [8.6732e-01, 9.0006e-01, 3.8371e+05, 8.6762e-01, 1.2248e+00, 3.8496e+05,
         8.3810e-01, 1.0297e+00, 1.0809e+00, 3.9475e+05, 3.9782e+05, 1.1291e+00,
         8.6875e-01, 3.9633e+05, 0.0000e+00, 1.2308e+00],
        [1.1931e+00, 1.0452e+00, 3.8367e+05, 1.1562e+00, 3.8466e-01, 3.8494e+05,
         1.2764e+00, 5.9211e-01, 5.5447e-01, 3.9473e+05, 3.9782e+05, 4.5990e-01,
         1.1108e+00, 3.9635e+05, 1.2308e+00, 0.0000e+00]])
Krum scores: ['0.95', '0.92', '383682.66', '0.95', '0.88', '384938.84', '0.99', '0.82', '0.85', '394733.97', '397804.31', '0.84', '0.94', '396333.81', '0.98', '0.86']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:51...
global Accuracy on shared test data: 73.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:51, End: 2025-07-22 15:30:51)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 8.7837e-01, 1.1586e+00, 3.9035e+05, 3.8490e+05, 8.5634e-01,
         1.2399e+00, 3.9330e+05, 3.8713e+05, 8.5317e-01, 1.5575e+00, 1.0652e+00,
         4.0556e+05, 3.9227e+05, 1.1335e+00, 8.8302e-01, 3.9519e+05, 9.1112e-01,
         1.2834e+00],
        [8.7837e-01, 0.0000e+00, 1.0262e+00, 3.9036e+05, 3.8490e+05, 9.1836e-01,
         1.0810e+00, 3.9331e+05, 3.8713e+05, 9.0968e-01, 1.3906e+00, 9.7789e-01,
         4.0556e+05, 3.9229e+05, 9.9472e-01, 8.9266e-01, 3.9519e+05, 9.3623e-01,
         1.1206e+00],
        [1.1586e+00, 1.0262e+00, 0.0000e+00, 3.9035e+05, 3.8491e+05, 1.0456e+00,
         5.4780e-01, 3.9330e+05, 3.8712e+05, 1.0829e+00, 6.7204e-01, 6.0521e-01,
         4.0555e+05, 3.9228e+05, 5.8921e-01, 1.0707e+00, 3.9521e+05, 1.1762e+00,
         4.9793e-01],
        [3.9035e+05, 3.9036e+05, 3.9035e+05, 0.0000e+00, 7.6874e+05, 3.9036e+05,
         3.9036e+05, 7.9965e+05, 7.7687e+05, 3.9034e+05, 3.9036e+05, 3.9038e+05,
         7.8261e+05, 7.7538e+05, 3.9037e+05, 3.9037e+05, 7.9491e+05, 3.9036e+05,
         3.9037e+05],
        [3.8490e+05, 3.8490e+05, 3.8491e+05, 7.6874e+05, 0.0000e+00, 3.8491e+05,
         3.8492e+05, 7.8302e+05, 7.7683e+05, 3.8489e+05, 3.8490e+05, 3.8491e+05,
         7.6742e+05, 7.7139e+05, 3.8492e+05, 3.8490e+05, 7.7011e+05, 3.8490e+05,
         3.8491e+05],
        [8.5634e-01, 9.1836e-01, 1.0456e+00, 3.9036e+05, 3.8491e+05, 0.0000e+00,
         1.1441e+00, 3.9328e+05, 3.8716e+05, 9.1199e-01, 1.3948e+00, 1.0253e+00,
         4.0556e+05, 3.9227e+05, 1.0591e+00, 8.4515e-01, 3.9521e+05, 8.9799e-01,
         1.1841e+00],
        [1.2399e+00, 1.0810e+00, 5.4780e-01, 3.9036e+05, 3.8492e+05, 1.1441e+00,
         0.0000e+00, 3.9329e+05, 3.8713e+05, 1.2194e+00, 6.2141e-01, 5.9228e-01,
         4.0557e+05, 3.9226e+05, 4.9006e-01, 1.1607e+00, 3.9520e+05, 1.3272e+00,
         4.0643e-01],
        [3.9330e+05, 3.9331e+05, 3.9330e+05, 7.9965e+05, 7.8302e+05, 3.9328e+05,
         3.9329e+05, 0.0000e+00, 7.7724e+05, 3.9333e+05, 3.9329e+05, 3.9330e+05,
         8.0851e+05, 7.9706e+05, 3.9329e+05, 3.9330e+05, 7.7961e+05, 3.9329e+05,
         3.9330e+05],
        [3.8713e+05, 3.8713e+05, 3.8712e+05, 7.7687e+05, 7.7683e+05, 3.8716e+05,
         3.8713e+05, 7.7724e+05, 0.0000e+00, 3.8714e+05, 3.8715e+05, 3.8713e+05,
         7.9114e+05, 7.8175e+05, 3.8712e+05, 3.8712e+05, 7.7732e+05, 3.8711e+05,
         3.8711e+05],
        [8.5317e-01, 9.0968e-01, 1.0829e+00, 3.9034e+05, 3.8489e+05, 9.1199e-01,
         1.2194e+00, 3.9333e+05, 3.8714e+05, 0.0000e+00, 1.5158e+00, 1.0843e+00,
         4.0555e+05, 3.9226e+05, 1.1457e+00, 8.4122e-01, 3.9521e+05, 8.7880e-01,
         1.2756e+00],
        [1.5575e+00, 1.3906e+00, 6.7204e-01, 3.9036e+05, 3.8490e+05, 1.3948e+00,
         6.2141e-01, 3.9329e+05, 3.8715e+05, 1.5158e+00, 0.0000e+00, 7.6957e-01,
         4.0559e+05, 3.9225e+05, 6.8622e-01, 1.4515e+00, 3.9519e+05, 1.6809e+00,
         5.1776e-01],
        [1.0652e+00, 9.7789e-01, 6.0521e-01, 3.9038e+05, 3.8491e+05, 1.0253e+00,
         5.9228e-01, 3.9330e+05, 3.8713e+05, 1.0843e+00, 7.6957e-01, 0.0000e+00,
         4.0558e+05, 3.9227e+05, 6.4161e-01, 1.0086e+00, 3.9522e+05, 1.1876e+00,
         5.6682e-01],
        [4.0556e+05, 4.0556e+05, 4.0555e+05, 7.8261e+05, 7.6742e+05, 4.0556e+05,
         4.0557e+05, 8.0851e+05, 7.9114e+05, 4.0555e+05, 4.0559e+05, 4.0558e+05,
         0.0000e+00, 8.0605e+05, 4.0558e+05, 4.0557e+05, 8.2200e+05, 4.0553e+05,
         4.0556e+05],
        [3.9227e+05, 3.9229e+05, 3.9228e+05, 7.7538e+05, 7.7139e+05, 3.9227e+05,
         3.9226e+05, 7.9706e+05, 7.8175e+05, 3.9226e+05, 3.9225e+05, 3.9227e+05,
         8.0605e+05, 0.0000e+00, 3.9229e+05, 3.9226e+05, 7.7702e+05, 3.9228e+05,
         3.9226e+05],
        [1.1335e+00, 9.9472e-01, 5.8921e-01, 3.9037e+05, 3.8492e+05, 1.0591e+00,
         4.9006e-01, 3.9329e+05, 3.8712e+05, 1.1457e+00, 6.8622e-01, 6.4161e-01,
         4.0558e+05, 3.9229e+05, 0.0000e+00, 1.1083e+00, 3.9520e+05, 1.2289e+00,
         4.9061e-01],
        [8.8302e-01, 8.9266e-01, 1.0707e+00, 3.9037e+05, 3.8490e+05, 8.4515e-01,
         1.1607e+00, 3.9330e+05, 3.8712e+05, 8.4122e-01, 1.4515e+00, 1.0086e+00,
         4.0557e+05, 3.9226e+05, 1.1083e+00, 0.0000e+00, 3.9519e+05, 9.2190e-01,
         1.1872e+00],
        [3.9519e+05, 3.9519e+05, 3.9521e+05, 7.9491e+05, 7.7011e+05, 3.9521e+05,
         3.9520e+05, 7.7961e+05, 7.7732e+05, 3.9521e+05, 3.9519e+05, 3.9522e+05,
         8.2200e+05, 7.7702e+05, 3.9520e+05, 3.9519e+05, 0.0000e+00, 3.9521e+05,
         3.9521e+05],
        [9.1112e-01, 9.3623e-01, 1.1762e+00, 3.9036e+05, 3.8490e+05, 8.9799e-01,
         1.3272e+00, 3.9329e+05, 3.8711e+05, 8.7880e-01, 1.6809e+00, 1.1876e+00,
         4.0553e+05, 3.9228e+05, 1.2289e+00, 9.2190e-01, 3.9521e+05, 0.0000e+00,
         1.3969e+00],
        [1.2834e+00, 1.1206e+00, 4.9793e-01, 3.9037e+05, 3.8491e+05, 1.1841e+00,
         4.0643e-01, 3.9330e+05, 3.8711e+05, 1.2756e+00, 5.1776e-01, 5.6682e-01,
         4.0556e+05, 3.9226e+05, 4.9061e-01, 1.1872e+00, 3.9521e+05, 1.3969e+00,
         0.0000e+00]])
Krum scores: ['1.03', '0.97', '0.83', '390357.22', '384903.34', '0.99', '0.85', '393294.25', '387123.84', '1.02', '1.06', '0.83', '405558.97', '392266.09', '0.83', '0.99', '395201.97', '1.09', '0.85']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:52...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:52, End: 2025-07-22 15:30:52)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 8.2238e-01, 3.8069e+05, 3.8801e+05, 1.1709e+00, 3.9536e+05,
         3.8255e+05, 8.1110e-01, 4.0960e+05, 1.1985e+00, 1.0023e+00, 3.8097e+05,
         3.9411e+05, 8.2903e-01, 4.0509e+05, 8.7635e-01, 1.1714e+00],
        [8.2238e-01, 0.0000e+00, 3.8068e+05, 3.8800e+05, 9.9215e-01, 3.9536e+05,
         3.8254e+05, 8.7323e-01, 4.0962e+05, 1.0422e+00, 8.9477e-01, 3.8099e+05,
         3.9412e+05, 8.5189e-01, 4.0507e+05, 8.9409e-01, 1.0032e+00],
        [3.8069e+05, 3.8068e+05, 0.0000e+00, 7.7914e+05, 3.8067e+05, 7.7531e+05,
         7.5537e+05, 3.8069e+05, 7.8603e+05, 3.8067e+05, 3.8066e+05, 7.8162e+05,
         7.5310e+05, 3.8068e+05, 7.9670e+05, 3.8067e+05, 3.8066e+05],
        [3.8801e+05, 3.8800e+05, 7.7914e+05, 0.0000e+00, 3.8801e+05, 7.8474e+05,
         7.6592e+05, 3.8803e+05, 8.0778e+05, 3.8800e+05, 3.8800e+05, 7.5824e+05,
         7.7970e+05, 3.8800e+05, 7.8142e+05, 3.8803e+05, 3.8801e+05],
        [1.1709e+00, 9.9215e-01, 3.8067e+05, 3.8801e+05, 0.0000e+00, 3.9537e+05,
         3.8254e+05, 1.1645e+00, 4.0960e+05, 4.9269e-01, 5.9237e-01, 3.8100e+05,
         3.9411e+05, 1.0412e+00, 4.0507e+05, 1.2204e+00, 4.0644e-01],
        [3.9536e+05, 3.9536e+05, 7.7531e+05, 7.8474e+05, 3.9537e+05, 0.0000e+00,
         7.6252e+05, 3.9539e+05, 7.9863e+05, 3.9535e+05, 3.9537e+05, 7.6612e+05,
         7.9958e+05, 3.9538e+05, 7.7639e+05, 3.9536e+05, 3.9536e+05],
        [3.8255e+05, 3.8254e+05, 7.5537e+05, 7.6592e+05, 3.8254e+05, 7.6252e+05,
         0.0000e+00, 3.8253e+05, 7.8731e+05, 3.8254e+05, 3.8256e+05, 7.7508e+05,
         7.9442e+05, 3.8253e+05, 7.8033e+05, 3.8251e+05, 3.8255e+05],
        [8.1110e-01, 8.7323e-01, 3.8069e+05, 3.8803e+05, 1.1645e+00, 3.9539e+05,
         3.8253e+05, 0.0000e+00, 4.0957e+05, 1.1875e+00, 1.0241e+00, 3.8097e+05,
         3.9413e+05, 8.1524e-01, 4.0510e+05, 8.4750e-01, 1.1774e+00],
        [4.0960e+05, 4.0962e+05, 7.8603e+05, 8.0778e+05, 4.0960e+05, 7.9863e+05,
         7.8731e+05, 4.0957e+05, 0.0000e+00, 4.0962e+05, 4.0962e+05, 8.1111e+05,
         8.1841e+05, 4.0960e+05, 7.9989e+05, 4.0960e+05, 4.0962e+05],
        [1.1985e+00, 1.0422e+00, 3.8067e+05, 3.8800e+05, 4.9269e-01, 3.9535e+05,
         3.8254e+05, 1.1875e+00, 4.0962e+05, 0.0000e+00, 6.0296e-01, 3.8100e+05,
         3.9414e+05, 1.0594e+00, 4.0511e+05, 1.2709e+00, 4.0767e-01],
        [1.0023e+00, 8.9477e-01, 3.8066e+05, 3.8800e+05, 5.9237e-01, 3.9537e+05,
         3.8256e+05, 1.0241e+00, 4.0962e+05, 6.0296e-01, 0.0000e+00, 3.8100e+05,
         3.9411e+05, 9.0539e-01, 4.0510e+05, 1.0815e+00, 5.2475e-01],
        [3.8097e+05, 3.8099e+05, 7.8162e+05, 7.5824e+05, 3.8100e+05, 7.6612e+05,
         7.7508e+05, 3.8097e+05, 8.1111e+05, 3.8100e+05, 3.8100e+05, 0.0000e+00,
         7.9105e+05, 3.8098e+05, 7.9606e+05, 3.8098e+05, 3.8099e+05],
        [3.9411e+05, 3.9412e+05, 7.5310e+05, 7.7970e+05, 3.9411e+05, 7.9958e+05,
         7.9442e+05, 3.9413e+05, 8.1841e+05, 3.9414e+05, 3.9411e+05, 7.9105e+05,
         0.0000e+00, 3.9412e+05, 7.8740e+05, 3.9411e+05, 3.9413e+05],
        [8.2903e-01, 8.5189e-01, 3.8068e+05, 3.8800e+05, 1.0412e+00, 3.9538e+05,
         3.8253e+05, 8.1524e-01, 4.0960e+05, 1.0594e+00, 9.0539e-01, 3.8098e+05,
         3.9412e+05, 0.0000e+00, 4.0510e+05, 8.8837e-01, 1.0202e+00],
        [4.0509e+05, 4.0507e+05, 7.9670e+05, 7.8142e+05, 4.0507e+05, 7.7639e+05,
         7.8033e+05, 4.0510e+05, 7.9989e+05, 4.0511e+05, 4.0510e+05, 7.9606e+05,
         7.8740e+05, 4.0510e+05, 0.0000e+00, 4.0509e+05, 4.0511e+05],
        [8.7635e-01, 8.9409e-01, 3.8067e+05, 3.8803e+05, 1.2204e+00, 3.9536e+05,
         3.8251e+05, 8.4750e-01, 4.0960e+05, 1.2709e+00, 1.0815e+00, 3.8098e+05,
         3.9411e+05, 8.8837e-01, 4.0509e+05, 0.0000e+00, 1.2517e+00],
        [1.1714e+00, 1.0032e+00, 3.8066e+05, 3.8801e+05, 4.0644e-01, 3.9536e+05,
         3.8255e+05, 1.1774e+00, 4.0962e+05, 4.0767e-01, 5.2475e-01, 3.8099e+05,
         3.9413e+05, 1.0202e+00, 4.0511e+05, 1.2517e+00, 0.0000e+00]])
Krum scores: ['0.95', '0.90', '380670.91', '388004.72', '0.84', '395361.88', '382536.28', '0.96', '409601.34', '0.86', '0.79', '380983.16', '394114.59', '0.91', '405087.88', '1.01', '0.82']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:53...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:53, End: 2025-07-22 15:30:53)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 8.2442e-01, 4.0382e+05, 3.7948e+05, 8.3549e-01, 1.1378e+00,
         4.0622e+05, 3.9123e+05, 8.5180e-01, 3.8361e+05, 1.0992e+00, 1.3399e+00,
         3.8301e+05, 4.0759e+05, 8.5210e-01, 8.7257e-01, 1.1086e+00],
        [8.2442e-01, 0.0000e+00, 4.0384e+05, 3.7952e+05, 8.2794e-01, 1.0094e+00,
         4.0620e+05, 3.9122e+05, 8.5923e-01, 3.8363e+05, 9.9099e-01, 1.2455e+00,
         3.8306e+05, 4.0757e+05, 8.4041e-01, 8.8542e-01, 9.7419e-01],
        [4.0382e+05, 4.0384e+05, 0.0000e+00, 7.9213e+05, 4.0379e+05, 4.0382e+05,
         8.2705e+05, 7.8743e+05, 4.0383e+05, 7.8457e+05, 4.0381e+05, 4.0381e+05,
         8.0646e+05, 8.3778e+05, 4.0383e+05, 4.0382e+05, 4.0381e+05],
        [3.7948e+05, 3.7952e+05, 7.9213e+05, 0.0000e+00, 3.7950e+05, 3.7950e+05,
         7.7796e+05, 7.6705e+05, 3.7951e+05, 7.5476e+05, 3.7948e+05, 3.7947e+05,
         7.5935e+05, 7.7492e+05, 3.7951e+05, 3.7951e+05, 3.7949e+05],
        [8.3549e-01, 8.2794e-01, 4.0379e+05, 3.7950e+05, 0.0000e+00, 1.0671e+00,
         4.0621e+05, 3.9121e+05, 8.9021e-01, 3.8362e+05, 1.0094e+00, 1.3120e+00,
         3.8303e+05, 4.0758e+05, 8.0698e-01, 8.5533e-01, 1.0463e+00],
        [1.1378e+00, 1.0094e+00, 4.0382e+05, 3.7950e+05, 1.0671e+00, 0.0000e+00,
         4.0621e+05, 3.9124e+05, 1.2080e+00, 3.8363e+05, 5.1251e-01, 5.4711e-01,
         3.8305e+05, 4.0759e+05, 1.0306e+00, 1.2212e+00, 4.4786e-01],
        [4.0622e+05, 4.0620e+05, 8.2705e+05, 7.7796e+05, 4.0621e+05, 4.0621e+05,
         0.0000e+00, 8.0155e+05, 4.0622e+05, 7.8605e+05, 4.0621e+05, 4.0621e+05,
         7.7778e+05, 8.1063e+05, 4.0619e+05, 4.0623e+05, 4.0622e+05],
        [3.9123e+05, 3.9122e+05, 7.8743e+05, 7.6705e+05, 3.9121e+05, 3.9124e+05,
         8.0155e+05, 0.0000e+00, 3.9121e+05, 7.5224e+05, 3.9125e+05, 3.9127e+05,
         7.8214e+05, 8.1070e+05, 3.9120e+05, 3.9124e+05, 3.9126e+05],
        [8.5180e-01, 8.5923e-01, 4.0383e+05, 3.7951e+05, 8.9021e-01, 1.2080e+00,
         4.0622e+05, 3.9121e+05, 0.0000e+00, 3.8362e+05, 1.1654e+00, 1.4973e+00,
         3.8303e+05, 4.0759e+05, 8.2610e-01, 8.6212e-01, 1.1887e+00],
        [3.8361e+05, 3.8363e+05, 7.8457e+05, 7.5476e+05, 3.8362e+05, 3.8363e+05,
         7.8605e+05, 7.5224e+05, 3.8362e+05, 0.0000e+00, 3.8363e+05, 3.8361e+05,
         7.7035e+05, 7.7397e+05, 3.8363e+05, 3.8362e+05, 3.8361e+05],
        [1.0992e+00, 9.9099e-01, 4.0381e+05, 3.7948e+05, 1.0094e+00, 5.1251e-01,
         4.0621e+05, 3.9125e+05, 1.1654e+00, 3.8363e+05, 0.0000e+00, 5.6164e-01,
         3.8304e+05, 4.0757e+05, 1.0073e+00, 1.2024e+00, 4.4706e-01],
        [1.3399e+00, 1.2455e+00, 4.0381e+05, 3.7947e+05, 1.3120e+00, 5.4711e-01,
         4.0621e+05, 3.9127e+05, 1.4973e+00, 3.8361e+05, 5.6164e-01, 0.0000e+00,
         3.8305e+05, 4.0759e+05, 1.2480e+00, 1.4903e+00, 4.8532e-01],
        [3.8301e+05, 3.8306e+05, 8.0646e+05, 7.5935e+05, 3.8303e+05, 3.8305e+05,
         7.7778e+05, 7.8214e+05, 3.8303e+05, 7.7035e+05, 3.8304e+05, 3.8305e+05,
         0.0000e+00, 7.8264e+05, 3.8304e+05, 3.8303e+05, 3.8304e+05],
        [4.0759e+05, 4.0757e+05, 8.3778e+05, 7.7492e+05, 4.0758e+05, 4.0759e+05,
         8.1063e+05, 8.1070e+05, 4.0759e+05, 7.7397e+05, 4.0757e+05, 4.0759e+05,
         7.8264e+05, 0.0000e+00, 4.0757e+05, 4.0758e+05, 4.0757e+05],
        [8.5210e-01, 8.4041e-01, 4.0383e+05, 3.7951e+05, 8.0698e-01, 1.0306e+00,
         4.0619e+05, 3.9120e+05, 8.2610e-01, 3.8363e+05, 1.0073e+00, 1.2480e+00,
         3.8304e+05, 4.0757e+05, 0.0000e+00, 8.6628e-01, 9.9278e-01],
        [8.7257e-01, 8.8542e-01, 4.0382e+05, 3.7951e+05, 8.5533e-01, 1.2212e+00,
         4.0623e+05, 3.9124e+05, 8.6212e-01, 3.8362e+05, 1.2024e+00, 1.4903e+00,
         3.8303e+05, 4.0758e+05, 8.6628e-01, 0.0000e+00, 1.2020e+00],
        [1.1086e+00, 9.7419e-01, 4.0381e+05, 3.7949e+05, 1.0463e+00, 4.4786e-01,
         4.0622e+05, 3.9126e+05, 1.1887e+00, 3.8361e+05, 4.4706e-01, 4.8532e-01,
         3.8304e+05, 4.0757e+05, 9.9278e-01, 1.2020e+00, 0.0000e+00]])
Krum scores: ['0.95', '0.90', '403813.38', '379492.09', '0.92', '0.87', '406208.50', '391223.81', '0.98', '383617.94', '0.85', '1.03', '383035.53', '407577.22', '0.90', '1.00', '0.84']
Selected index: 16
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0058s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:53...
global Accuracy on shared test data: 73.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:53, End: 2025-07-22 15:30:53)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 9, 20, 18, 8, 4, 14, 11, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 8.4448e-01, 1.0965e+00, 3.8746e+05, 1.1229e+00, 3.9876e+05,
         4.0096e+05, 8.4564e-01, 1.0700e+00, 3.8455e+05, 9.8788e-01, 8.4717e-01,
         3.9107e+05, 8.3319e-01, 1.3577e+00],
        [8.4448e-01, 0.0000e+00, 9.3871e-01, 3.8746e+05, 9.4580e-01, 3.9874e+05,
         4.0099e+05, 8.5764e-01, 9.0564e-01, 3.8455e+05, 8.3535e-01, 8.4323e-01,
         3.9110e+05, 8.6646e-01, 1.1405e+00],
        [1.0965e+00, 9.3871e-01, 0.0000e+00, 3.8748e+05, 4.8758e-01, 3.9877e+05,
         4.0095e+05, 1.0716e+00, 4.2283e-01, 3.8456e+05, 4.9899e-01, 9.5906e-01,
         3.9108e+05, 1.0741e+00, 4.4017e-01],
        [3.8746e+05, 3.8746e+05, 3.8748e+05, 0.0000e+00, 3.8744e+05, 7.5988e+05,
         7.8820e+05, 3.8747e+05, 3.8746e+05, 7.6687e+05, 3.8744e+05, 3.8746e+05,
         7.7780e+05, 3.8746e+05, 3.8745e+05],
        [1.1229e+00, 9.4580e-01, 4.8758e-01, 3.8744e+05, 0.0000e+00, 3.9878e+05,
         4.0096e+05, 1.1352e+00, 5.0065e-01, 3.8456e+05, 4.8083e-01, 9.9122e-01,
         3.9108e+05, 1.1234e+00, 4.7414e-01],
        [3.9876e+05, 3.9874e+05, 3.9877e+05, 7.5988e+05, 3.9878e+05, 0.0000e+00,
         8.2831e+05, 3.9877e+05, 3.9877e+05, 7.6814e+05, 3.9875e+05, 3.9877e+05,
         8.0388e+05, 3.9875e+05, 3.9876e+05],
        [4.0096e+05, 4.0099e+05, 4.0095e+05, 7.8820e+05, 4.0096e+05, 8.2831e+05,
         0.0000e+00, 4.0095e+05, 4.0095e+05, 7.6782e+05, 4.0095e+05, 4.0097e+05,
         7.9632e+05, 4.0096e+05, 4.0094e+05],
        [8.4564e-01, 8.5764e-01, 1.0716e+00, 3.8747e+05, 1.1352e+00, 3.9877e+05,
         4.0095e+05, 0.0000e+00, 1.0663e+00, 3.8455e+05, 1.0436e+00, 8.2709e-01,
         3.9107e+05, 8.1763e-01, 1.3896e+00],
        [1.0700e+00, 9.0564e-01, 4.2283e-01, 3.8746e+05, 5.0065e-01, 3.9877e+05,
         4.0095e+05, 1.0663e+00, 0.0000e+00, 3.8457e+05, 5.0158e-01, 9.4785e-01,
         3.9107e+05, 1.0837e+00, 4.8447e-01],
        [3.8455e+05, 3.8455e+05, 3.8456e+05, 7.6687e+05, 3.8456e+05, 7.6814e+05,
         7.6782e+05, 3.8455e+05, 3.8457e+05, 0.0000e+00, 3.8456e+05, 3.8456e+05,
         8.0647e+05, 3.8453e+05, 3.8454e+05],
        [9.8788e-01, 8.3535e-01, 4.9899e-01, 3.8744e+05, 4.8083e-01, 3.9875e+05,
         4.0095e+05, 1.0436e+00, 5.0158e-01, 3.8456e+05, 0.0000e+00, 9.1443e-01,
         3.9110e+05, 1.0270e+00, 5.4074e-01],
        [8.4717e-01, 8.4323e-01, 9.5906e-01, 3.8746e+05, 9.9122e-01, 3.9877e+05,
         4.0097e+05, 8.2709e-01, 9.4785e-01, 3.8456e+05, 9.1443e-01, 0.0000e+00,
         3.9106e+05, 8.4088e-01, 1.1990e+00],
        [3.9107e+05, 3.9110e+05, 3.9108e+05, 7.7780e+05, 3.9108e+05, 8.0388e+05,
         7.9632e+05, 3.9107e+05, 3.9107e+05, 8.0647e+05, 3.9110e+05, 3.9106e+05,
         0.0000e+00, 3.9108e+05, 3.9109e+05],
        [8.3319e-01, 8.6646e-01, 1.0741e+00, 3.8746e+05, 1.1234e+00, 3.9875e+05,
         4.0096e+05, 8.1763e-01, 1.0837e+00, 3.8453e+05, 1.0270e+00, 8.4088e-01,
         3.9108e+05, 0.0000e+00, 1.3902e+00],
        [1.3577e+00, 1.1405e+00, 4.4017e-01, 3.8745e+05, 4.7414e-01, 3.9876e+05,
         4.0094e+05, 1.3896e+00, 4.8447e-01, 3.8454e+05, 5.4074e-01, 1.1990e+00,
         3.9109e+05, 1.3902e+00, 0.0000e+00]])
Krum scores: ['0.96', '0.88', '0.74', '387453.53', '0.77', '398760.09', '400951.31', '0.96', '0.74', '384550.03', '0.72', '0.90', '391075.69', '0.96', '0.88']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 9, 20, 18, 8, 4, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0301s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:54...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:54, End: 2025-07-22 15:30:54)
start time is: 97218225833271, end time is: 97236187465035
The total time is: 17961631764ns.

 ------- aggregate method: krum, random_seed: 200 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 4.8350e+00, 5.5213e+00, 3.8543e+05, 5.8566e+00, 6.0526e+00,
         3.8648e+05, 3.9336e+05, 5.1431e+00, 3.7887e+05, 5.0891e+00, 5.0257e+00,
         3.7867e+05, 4.3087e+00, 4.9228e+00, 3.9702e+05, 4.3431e+00, 5.5853e+00],
        [4.8350e+00, 0.0000e+00, 5.0445e+00, 3.8542e+05, 5.5423e+00, 5.6605e+00,
         3.8645e+05, 3.9335e+05, 5.3389e+00, 3.7882e+05, 4.8460e+00, 4.6265e+00,
         3.7861e+05, 5.3125e+00, 5.2071e+00, 3.9709e+05, 4.6171e+00, 4.3086e+00],
        [5.5213e+00, 5.0445e+00, 0.0000e+00, 3.8546e+05, 4.8625e+00, 5.5117e+00,
         3.8649e+05, 3.9342e+05, 5.3747e+00, 3.7887e+05, 4.6882e+00, 4.1104e+00,
         3.7859e+05, 4.8594e+00, 4.5079e+00, 3.9707e+05, 4.3771e+00, 4.6103e+00],
        [3.8543e+05, 3.8542e+05, 3.8546e+05, 0.0000e+00, 3.8539e+05, 3.8543e+05,
         7.5714e+05, 7.6644e+05, 3.8539e+05, 7.4885e+05, 3.8548e+05, 3.8546e+05,
         7.6894e+05, 3.8540e+05, 3.8550e+05, 7.9654e+05, 3.8542e+05, 3.8540e+05],
        [5.8566e+00, 5.5423e+00, 4.8625e+00, 3.8539e+05, 0.0000e+00, 5.3885e+00,
         3.8652e+05, 3.9337e+05, 4.7340e+00, 3.7888e+05, 5.3366e+00, 5.0469e+00,
         3.7858e+05, 5.2131e+00, 5.3336e+00, 3.9706e+05, 4.9587e+00, 4.6532e+00],
        [6.0526e+00, 5.6605e+00, 5.5117e+00, 3.8543e+05, 5.3885e+00, 0.0000e+00,
         3.8649e+05, 3.9336e+05, 4.4977e+00, 3.7893e+05, 6.4433e+00, 5.4486e+00,
         3.7864e+05, 5.2892e+00, 5.1413e+00, 3.9704e+05, 5.5208e+00, 5.7287e+00],
        [3.8648e+05, 3.8645e+05, 3.8649e+05, 7.5714e+05, 3.8652e+05, 3.8649e+05,
         0.0000e+00, 7.8948e+05, 3.8644e+05, 7.4111e+05, 3.8647e+05, 3.8649e+05,
         7.7628e+05, 3.8647e+05, 3.8646e+05, 7.9072e+05, 3.8650e+05, 3.8653e+05],
        [3.9336e+05, 3.9335e+05, 3.9342e+05, 7.6644e+05, 3.9337e+05, 3.9336e+05,
         7.8948e+05, 0.0000e+00, 3.9334e+05, 7.6826e+05, 3.9340e+05, 3.9333e+05,
         7.6699e+05, 3.9338e+05, 3.9337e+05, 7.7537e+05, 3.9339e+05, 3.9336e+05],
        [5.1431e+00, 5.3389e+00, 5.3747e+00, 3.8539e+05, 4.7340e+00, 4.4977e+00,
         3.8644e+05, 3.9334e+05, 0.0000e+00, 3.7889e+05, 5.7700e+00, 5.1231e+00,
         3.7862e+05, 4.7730e+00, 4.7622e+00, 3.9703e+05, 4.8885e+00, 5.0928e+00],
        [3.7887e+05, 3.7882e+05, 3.7887e+05, 7.4885e+05, 3.7888e+05, 3.7893e+05,
         7.4111e+05, 7.6826e+05, 3.7889e+05, 0.0000e+00, 3.7880e+05, 3.7887e+05,
         7.5425e+05, 3.7892e+05, 3.7894e+05, 7.4283e+05, 3.7884e+05, 3.7890e+05],
        [5.0891e+00, 4.8460e+00, 4.6882e+00, 3.8548e+05, 5.3366e+00, 6.4433e+00,
         3.8647e+05, 3.9340e+05, 5.7700e+00, 3.7880e+05, 0.0000e+00, 4.3895e+00,
         3.7859e+05, 4.9153e+00, 5.7235e+00, 3.9705e+05, 4.2093e+00, 5.1569e+00],
        [5.0257e+00, 4.6265e+00, 4.1104e+00, 3.8546e+05, 5.0469e+00, 5.4486e+00,
         3.8649e+05, 3.9333e+05, 5.1231e+00, 3.7887e+05, 4.3895e+00, 0.0000e+00,
         3.7858e+05, 5.2284e+00, 4.9545e+00, 3.9701e+05, 4.4594e+00, 4.3885e+00],
        [3.7867e+05, 3.7861e+05, 3.7859e+05, 7.6894e+05, 3.7858e+05, 3.7864e+05,
         7.7628e+05, 7.6699e+05, 3.7862e+05, 7.5425e+05, 3.7859e+05, 3.7858e+05,
         0.0000e+00, 3.7863e+05, 3.7864e+05, 7.7454e+05, 3.7865e+05, 3.7864e+05],
        [4.3087e+00, 5.3125e+00, 4.8594e+00, 3.8540e+05, 5.2131e+00, 5.2892e+00,
         3.8647e+05, 3.9338e+05, 4.7730e+00, 3.7892e+05, 4.9153e+00, 5.2284e+00,
         3.7863e+05, 0.0000e+00, 4.6467e+00, 3.9704e+05, 4.1980e+00, 5.1228e+00],
        [4.9228e+00, 5.2071e+00, 4.5079e+00, 3.8550e+05, 5.3336e+00, 5.1413e+00,
         3.8646e+05, 3.9337e+05, 4.7622e+00, 3.7894e+05, 5.7235e+00, 4.9545e+00,
         3.7864e+05, 4.6467e+00, 0.0000e+00, 3.9706e+05, 4.8987e+00, 5.2006e+00],
        [3.9702e+05, 3.9709e+05, 3.9707e+05, 7.9654e+05, 3.9706e+05, 3.9704e+05,
         7.9072e+05, 7.7537e+05, 3.9703e+05, 7.4283e+05, 3.9705e+05, 3.9701e+05,
         7.7454e+05, 3.9704e+05, 3.9706e+05, 0.0000e+00, 3.9703e+05, 3.9703e+05],
        [4.3431e+00, 4.6171e+00, 4.3771e+00, 3.8542e+05, 4.9587e+00, 5.5208e+00,
         3.8650e+05, 3.9339e+05, 4.8885e+00, 3.7884e+05, 4.2093e+00, 4.4594e+00,
         3.7865e+05, 4.1980e+00, 4.8987e+00, 3.9703e+05, 0.0000e+00, 4.8882e+00],
        [5.5853e+00, 4.3086e+00, 4.6103e+00, 3.8540e+05, 4.6532e+00, 5.7287e+00,
         3.8653e+05, 3.9336e+05, 5.0928e+00, 3.7890e+05, 5.1569e+00, 4.3885e+00,
         3.7864e+05, 5.1228e+00, 5.2006e+00, 3.9703e+05, 4.8882e+00, 0.0000e+00]])
Krum scores: ['5.06', '4.97', '4.79', '385419.69', '5.11', '5.42', '386473.97', '393360.94', '4.97', '378865.09', '5.01', '4.74', '378612.72', '4.86', '4.96', '397037.12', '4.58', '4.90']
Selected index: 16
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0080s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:55...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 72 191]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:55, End: 2025-07-22 15:30:55)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 2.1381e+00, 2.2642e+00, 3.9205e+05, 4.0404e+05, 2.1797e+00,
         3.8261e+05, 2.3741e+00, 3.8201e+05, 2.2372e+00, 2.2173e+00, 3.9051e+05,
         4.0695e+05, 2.0432e+00, 2.3413e+00, 3.8758e+05, 2.3061e+00, 2.2081e+00],
        [2.1381e+00, 0.0000e+00, 2.1420e+00, 3.9206e+05, 4.0404e+05, 2.1863e+00,
         3.8261e+05, 2.3886e+00, 3.8203e+05, 1.9579e+00, 2.3004e+00, 3.9046e+05,
         4.0696e+05, 2.1713e+00, 2.2491e+00, 3.8756e+05, 2.3965e+00, 2.1888e+00],
        [2.2642e+00, 2.1420e+00, 0.0000e+00, 3.9206e+05, 4.0407e+05, 2.0203e+00,
         3.8257e+05, 2.2946e+00, 3.8203e+05, 2.0357e+00, 2.0799e+00, 3.9052e+05,
         4.0698e+05, 2.1132e+00, 2.0271e+00, 3.8756e+05, 2.0881e+00, 2.1947e+00],
        [3.9205e+05, 3.9206e+05, 3.9206e+05, 0.0000e+00, 7.9245e+05, 3.9207e+05,
         7.7691e+05, 3.9207e+05, 7.7494e+05, 3.9208e+05, 3.9207e+05, 7.6570e+05,
         8.2036e+05, 3.9202e+05, 3.9209e+05, 7.8047e+05, 3.9205e+05, 3.9209e+05],
        [4.0404e+05, 4.0404e+05, 4.0407e+05, 7.9245e+05, 0.0000e+00, 4.0405e+05,
         7.6864e+05, 4.0398e+05, 7.7598e+05, 4.0403e+05, 4.0404e+05, 7.7287e+05,
         7.9778e+05, 4.0407e+05, 4.0402e+05, 7.8898e+05, 4.0403e+05, 4.0405e+05],
        [2.1797e+00, 2.1863e+00, 2.0203e+00, 3.9207e+05, 4.0405e+05, 0.0000e+00,
         3.8257e+05, 2.2371e+00, 3.8203e+05, 2.0343e+00, 2.2882e+00, 3.9050e+05,
         4.0696e+05, 1.9939e+00, 2.1221e+00, 3.8757e+05, 2.2010e+00, 2.0620e+00],
        [3.8261e+05, 3.8261e+05, 3.8257e+05, 7.7691e+05, 7.6864e+05, 3.8257e+05,
         0.0000e+00, 3.8256e+05, 7.7423e+05, 3.8259e+05, 3.8259e+05, 7.8863e+05,
         7.8613e+05, 3.8258e+05, 3.8256e+05, 7.5195e+05, 3.8262e+05, 3.8261e+05],
        [2.3741e+00, 2.3886e+00, 2.2946e+00, 3.9207e+05, 4.0398e+05, 2.2371e+00,
         3.8256e+05, 0.0000e+00, 3.8206e+05, 2.0138e+00, 2.2273e+00, 3.9047e+05,
         4.0697e+05, 2.2854e+00, 2.1616e+00, 3.8763e+05, 2.2354e+00, 2.2672e+00],
        [3.8201e+05, 3.8203e+05, 3.8203e+05, 7.7494e+05, 7.7598e+05, 3.8203e+05,
         7.7423e+05, 3.8206e+05, 0.0000e+00, 3.8201e+05, 3.8202e+05, 7.7637e+05,
         7.8241e+05, 3.8201e+05, 3.8200e+05, 7.6199e+05, 3.8205e+05, 3.8203e+05],
        [2.2372e+00, 1.9579e+00, 2.0357e+00, 3.9208e+05, 4.0403e+05, 2.0343e+00,
         3.8259e+05, 2.0138e+00, 3.8201e+05, 0.0000e+00, 2.2090e+00, 3.9047e+05,
         4.0696e+05, 2.0483e+00, 2.1301e+00, 3.8757e+05, 2.1074e+00, 2.0728e+00],
        [2.2173e+00, 2.3004e+00, 2.0799e+00, 3.9207e+05, 4.0404e+05, 2.2882e+00,
         3.8259e+05, 2.2273e+00, 3.8202e+05, 2.2090e+00, 0.0000e+00, 3.9048e+05,
         4.0699e+05, 2.2060e+00, 2.0490e+00, 3.8758e+05, 2.4667e+00, 1.9965e+00],
        [3.9051e+05, 3.9046e+05, 3.9052e+05, 7.6570e+05, 7.7287e+05, 3.9050e+05,
         7.8863e+05, 3.9047e+05, 7.7637e+05, 3.9047e+05, 3.9048e+05, 0.0000e+00,
         7.9709e+05, 3.9051e+05, 3.9051e+05, 7.9308e+05, 3.9050e+05, 3.9050e+05],
        [4.0695e+05, 4.0696e+05, 4.0698e+05, 8.2036e+05, 7.9778e+05, 4.0696e+05,
         7.8613e+05, 4.0697e+05, 7.8241e+05, 4.0696e+05, 4.0699e+05, 7.9709e+05,
         0.0000e+00, 4.0697e+05, 4.0693e+05, 8.0461e+05, 4.0696e+05, 4.0699e+05],
        [2.0432e+00, 2.1713e+00, 2.1132e+00, 3.9202e+05, 4.0407e+05, 1.9939e+00,
         3.8258e+05, 2.2854e+00, 3.8201e+05, 2.0483e+00, 2.2060e+00, 3.9051e+05,
         4.0697e+05, 0.0000e+00, 2.0746e+00, 3.8756e+05, 2.2283e+00, 2.1860e+00],
        [2.3413e+00, 2.2491e+00, 2.0271e+00, 3.9209e+05, 4.0402e+05, 2.1221e+00,
         3.8256e+05, 2.1616e+00, 3.8200e+05, 2.1301e+00, 2.0490e+00, 3.9051e+05,
         4.0693e+05, 2.0746e+00, 0.0000e+00, 3.8759e+05, 2.2794e+00, 2.0896e+00],
        [3.8758e+05, 3.8756e+05, 3.8756e+05, 7.8047e+05, 7.8898e+05, 3.8757e+05,
         7.5195e+05, 3.8763e+05, 7.6199e+05, 3.8757e+05, 3.8758e+05, 7.9308e+05,
         8.0461e+05, 3.8756e+05, 3.8759e+05, 0.0000e+00, 3.8758e+05, 3.8759e+05],
        [2.3061e+00, 2.3965e+00, 2.0881e+00, 3.9205e+05, 4.0403e+05, 2.2010e+00,
         3.8262e+05, 2.2354e+00, 3.8205e+05, 2.1074e+00, 2.4667e+00, 3.9050e+05,
         4.0696e+05, 2.2283e+00, 2.2794e+00, 3.8758e+05, 0.0000e+00, 2.2132e+00],
        [2.2081e+00, 2.1888e+00, 2.1947e+00, 3.9209e+05, 4.0405e+05, 2.0620e+00,
         3.8261e+05, 2.2672e+00, 3.8203e+05, 2.0728e+00, 1.9965e+00, 3.9050e+05,
         4.0699e+05, 2.1860e+00, 2.0896e+00, 3.8759e+05, 2.2132e+00, 0.0000e+00]])
Krum scores: ['2.22', '2.19', '2.11', '392060.44', '404030.97', '2.12', '382582.56', '2.23', '382019.09', '2.07', '2.17', '390490.41', '406960.75', '2.12', '2.13', '387572.16', '2.23', '2.13']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:55...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 46 217]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:55, End: 2025-07-22 15:30:55)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 17, 9, 20, 8, 15, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 2.0681e+00, 3.8941e+05, 1.9299e+00, 3.8240e+05, 2.2094e+00,
         4.1543e+05, 3.9486e+05, 3.7202e+05, 1.8431e+00, 2.0294e+00, 3.9791e+05,
         2.0838e+00, 1.9097e+00],
        [2.0681e+00, 0.0000e+00, 3.8943e+05, 1.7482e+00, 3.8244e+05, 1.9911e+00,
         4.1542e+05, 3.9481e+05, 3.7204e+05, 1.8829e+00, 1.7801e+00, 3.9788e+05,
         1.8369e+00, 1.8845e+00],
        [3.8941e+05, 3.8943e+05, 0.0000e+00, 3.8947e+05, 7.9711e+05, 3.8943e+05,
         8.1880e+05, 8.0043e+05, 7.7668e+05, 3.8943e+05, 3.8945e+05, 7.9277e+05,
         3.8942e+05, 3.8944e+05],
        [1.9299e+00, 1.7482e+00, 3.8947e+05, 0.0000e+00, 3.8242e+05, 1.8974e+00,
         4.1541e+05, 3.9482e+05, 3.7201e+05, 1.6841e+00, 1.8430e+00, 3.9792e+05,
         1.7809e+00, 1.7980e+00],
        [3.8240e+05, 3.8244e+05, 7.9711e+05, 3.8242e+05, 0.0000e+00, 3.8242e+05,
         7.9313e+05, 7.8257e+05, 7.4070e+05, 3.8244e+05, 3.8246e+05, 7.7200e+05,
         3.8243e+05, 3.8242e+05],
        [2.2094e+00, 1.9911e+00, 3.8943e+05, 1.8974e+00, 3.8242e+05, 0.0000e+00,
         4.1542e+05, 3.9481e+05, 3.7202e+05, 1.9598e+00, 1.8467e+00, 3.9793e+05,
         1.9145e+00, 2.0230e+00],
        [4.1543e+05, 4.1542e+05, 8.1880e+05, 4.1541e+05, 7.9313e+05, 4.1542e+05,
         0.0000e+00, 7.9596e+05, 7.7986e+05, 4.1540e+05, 4.1546e+05, 8.2229e+05,
         4.1542e+05, 4.1543e+05],
        [3.9486e+05, 3.9481e+05, 8.0043e+05, 3.9482e+05, 7.8257e+05, 3.9481e+05,
         7.9596e+05, 0.0000e+00, 7.6854e+05, 3.9483e+05, 3.9484e+05, 7.9196e+05,
         3.9479e+05, 3.9484e+05],
        [3.7202e+05, 3.7204e+05, 7.7668e+05, 3.7201e+05, 7.4070e+05, 3.7202e+05,
         7.7986e+05, 7.6854e+05, 0.0000e+00, 3.7203e+05, 3.7201e+05, 7.7563e+05,
         3.7200e+05, 3.7203e+05],
        [1.8431e+00, 1.8829e+00, 3.8943e+05, 1.6841e+00, 3.8244e+05, 1.9598e+00,
         4.1540e+05, 3.9483e+05, 3.7203e+05, 0.0000e+00, 1.7942e+00, 3.9792e+05,
         1.9477e+00, 1.9578e+00],
        [2.0294e+00, 1.7801e+00, 3.8945e+05, 1.8430e+00, 3.8246e+05, 1.8467e+00,
         4.1546e+05, 3.9484e+05, 3.7201e+05, 1.7942e+00, 0.0000e+00, 3.9793e+05,
         2.0331e+00, 1.8499e+00],
        [3.9791e+05, 3.9788e+05, 7.9277e+05, 3.9792e+05, 7.7200e+05, 3.9793e+05,
         8.2229e+05, 7.9196e+05, 7.7563e+05, 3.9792e+05, 3.9793e+05, 0.0000e+00,
         3.9793e+05, 3.9789e+05],
        [2.0838e+00, 1.8369e+00, 3.8942e+05, 1.7809e+00, 3.8243e+05, 1.9145e+00,
         4.1542e+05, 3.9479e+05, 3.7200e+05, 1.9477e+00, 2.0331e+00, 3.9793e+05,
         0.0000e+00, 1.9575e+00],
        [1.9097e+00, 1.8845e+00, 3.8944e+05, 1.7980e+00, 3.8242e+05, 2.0230e+00,
         4.1543e+05, 3.9484e+05, 3.7203e+05, 1.9578e+00, 1.8499e+00, 3.9789e+05,
         1.9575e+00, 0.0000e+00]])
Krum scores: ['1.98', '1.85', '389425.31', '1.79', '382423.44', '1.94', '415415.22', '394816.72', '372014.59', '1.85', '1.86', '397906.53', '1.91', '1.89']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 17, 9, 20, 8, 15, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:56...
global Accuracy on shared test data: 78.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 43 220]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:56, End: 2025-07-22 15:30:56)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 3, 13, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.7659e+00, 1.8048e+00, 4.0458e+05, 1.7780e+00, 1.9032e+00,
         3.8523e+05, 4.0620e+05, 1.9257e+00, 3.9456e+05, 1.6898e+00, 4.0131e+05,
         1.7216e+00, 1.7414e+00, 3.9897e+05, 1.8043e+00, 1.7624e+00],
        [1.7659e+00, 0.0000e+00, 1.6413e+00, 4.0454e+05, 1.7126e+00, 1.9064e+00,
         3.8525e+05, 4.0615e+05, 1.8616e+00, 3.9455e+05, 1.9059e+00, 4.0132e+05,
         1.8009e+00, 1.7833e+00, 3.9898e+05, 1.9585e+00, 1.7054e+00],
        [1.8048e+00, 1.6413e+00, 0.0000e+00, 4.0460e+05, 1.6392e+00, 1.7469e+00,
         3.8525e+05, 4.0616e+05, 1.7916e+00, 3.9454e+05, 1.6994e+00, 4.0134e+05,
         1.7566e+00, 1.5785e+00, 3.9896e+05, 1.6340e+00, 1.6728e+00],
        [4.0458e+05, 4.0454e+05, 4.0460e+05, 0.0000e+00, 4.0458e+05, 4.0459e+05,
         8.0321e+05, 8.1032e+05, 4.0462e+05, 8.1786e+05, 4.0465e+05, 7.8230e+05,
         4.0460e+05, 4.0460e+05, 7.7586e+05, 4.0459e+05, 4.0461e+05],
        [1.7780e+00, 1.7126e+00, 1.6392e+00, 4.0458e+05, 0.0000e+00, 1.7353e+00,
         3.8528e+05, 4.0619e+05, 1.8267e+00, 3.9452e+05, 1.8628e+00, 4.0130e+05,
         1.6436e+00, 1.7074e+00, 3.9901e+05, 1.6424e+00, 1.6740e+00],
        [1.9032e+00, 1.9064e+00, 1.7469e+00, 4.0459e+05, 1.7353e+00, 0.0000e+00,
         3.8527e+05, 4.0618e+05, 1.8509e+00, 3.9453e+05, 1.8228e+00, 4.0137e+05,
         1.8288e+00, 1.7804e+00, 3.9898e+05, 1.6682e+00, 1.7250e+00],
        [3.8523e+05, 3.8525e+05, 3.8525e+05, 8.0321e+05, 3.8528e+05, 3.8527e+05,
         0.0000e+00, 8.0490e+05, 3.8524e+05, 7.6885e+05, 3.8524e+05, 7.8428e+05,
         3.8524e+05, 3.8526e+05, 7.8871e+05, 3.8527e+05, 3.8527e+05],
        [4.0620e+05, 4.0615e+05, 4.0616e+05, 8.1032e+05, 4.0619e+05, 4.0618e+05,
         8.0490e+05, 0.0000e+00, 4.0616e+05, 7.8594e+05, 4.0618e+05, 8.0770e+05,
         4.0614e+05, 4.0618e+05, 7.9276e+05, 4.0618e+05, 4.0618e+05],
        [1.9257e+00, 1.8616e+00, 1.7916e+00, 4.0462e+05, 1.8267e+00, 1.8509e+00,
         3.8524e+05, 4.0616e+05, 0.0000e+00, 3.9454e+05, 1.7276e+00, 4.0135e+05,
         1.8235e+00, 1.6563e+00, 3.9898e+05, 1.7104e+00, 1.7120e+00],
        [3.9456e+05, 3.9455e+05, 3.9454e+05, 8.1786e+05, 3.9452e+05, 3.9453e+05,
         7.6885e+05, 7.8594e+05, 3.9454e+05, 0.0000e+00, 3.9452e+05, 7.7995e+05,
         3.9454e+05, 3.9453e+05, 8.0831e+05, 3.9455e+05, 3.9451e+05],
        [1.6898e+00, 1.9059e+00, 1.6994e+00, 4.0465e+05, 1.8628e+00, 1.8228e+00,
         3.8524e+05, 4.0618e+05, 1.7276e+00, 3.9452e+05, 0.0000e+00, 4.0131e+05,
         1.8585e+00, 1.5957e+00, 3.9897e+05, 1.9468e+00, 1.5904e+00],
        [4.0131e+05, 4.0132e+05, 4.0134e+05, 7.8230e+05, 4.0130e+05, 4.0137e+05,
         7.8428e+05, 8.0770e+05, 4.0135e+05, 7.7995e+05, 4.0131e+05, 0.0000e+00,
         4.0129e+05, 4.0133e+05, 7.9993e+05, 4.0132e+05, 4.0132e+05],
        [1.7216e+00, 1.8009e+00, 1.7566e+00, 4.0460e+05, 1.6436e+00, 1.8288e+00,
         3.8524e+05, 4.0614e+05, 1.8235e+00, 3.9454e+05, 1.8585e+00, 4.0129e+05,
         0.0000e+00, 1.7716e+00, 3.9893e+05, 1.8245e+00, 1.7937e+00],
        [1.7414e+00, 1.7833e+00, 1.5785e+00, 4.0460e+05, 1.7074e+00, 1.7804e+00,
         3.8526e+05, 4.0618e+05, 1.6563e+00, 3.9453e+05, 1.5957e+00, 4.0133e+05,
         1.7716e+00, 0.0000e+00, 3.9898e+05, 1.8478e+00, 1.6127e+00],
        [3.9897e+05, 3.9898e+05, 3.9896e+05, 7.7586e+05, 3.9901e+05, 3.9898e+05,
         7.8871e+05, 7.9276e+05, 3.9898e+05, 8.0831e+05, 3.9897e+05, 7.9993e+05,
         3.9893e+05, 3.9898e+05, 0.0000e+00, 3.9896e+05, 3.9897e+05],
        [1.8043e+00, 1.9585e+00, 1.6340e+00, 4.0459e+05, 1.6424e+00, 1.6682e+00,
         3.8527e+05, 4.0618e+05, 1.7104e+00, 3.9455e+05, 1.9468e+00, 4.0132e+05,
         1.8245e+00, 1.8478e+00, 3.9896e+05, 0.0000e+00, 1.8109e+00],
        [1.7624e+00, 1.7054e+00, 1.6728e+00, 4.0461e+05, 1.6740e+00, 1.7250e+00,
         3.8527e+05, 4.0618e+05, 1.7120e+00, 3.9451e+05, 1.5904e+00, 4.0132e+05,
         1.7937e+00, 1.6127e+00, 3.9897e+05, 1.8109e+00, 0.0000e+00]])
Krum scores: ['1.77', '1.79', '1.68', '404588.25', '1.71', '1.78', '385250.19', '406168.38', '1.77', '394530.22', '1.75', '401315.91', '1.77', '1.69', '398966.88', '1.77', '1.69']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 3, 13, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0068s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:56...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:56, End: 2025-07-22 15:30:56)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [7, 2, 19, 17, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.7852e+00, 3.9754e+05, 3.8389e+05, 3.7177e+05, 3.9375e+05,
         1.9870e+00, 3.7777e+05, 1.8247e+00, 1.9942e+00, 3.8842e+05, 4.0871e+05,
         1.8513e+00, 1.9169e+00, 3.6417e+05, 2.0104e+00, 1.8085e+00],
        [1.7852e+00, 0.0000e+00, 3.9754e+05, 3.8385e+05, 3.7174e+05, 3.9379e+05,
         1.9184e+00, 3.7776e+05, 1.7812e+00, 1.8167e+00, 3.8840e+05, 4.0870e+05,
         1.8937e+00, 1.8160e+00, 3.6418e+05, 1.8054e+00, 1.8343e+00],
        [3.9754e+05, 3.9754e+05, 0.0000e+00, 7.8273e+05, 7.7519e+05, 7.9179e+05,
         3.9754e+05, 7.7829e+05, 3.9753e+05, 3.9755e+05, 7.9678e+05, 8.0731e+05,
         3.9756e+05, 3.9757e+05, 7.5281e+05, 3.9755e+05, 3.9754e+05],
        [3.8389e+05, 3.8385e+05, 7.8273e+05, 0.0000e+00, 7.3307e+05, 7.6224e+05,
         3.8386e+05, 7.2779e+05, 3.8391e+05, 3.8385e+05, 7.7511e+05, 7.9189e+05,
         3.8383e+05, 3.8386e+05, 7.6209e+05, 3.8388e+05, 3.8384e+05],
        [3.7177e+05, 3.7174e+05, 7.7519e+05, 7.3307e+05, 0.0000e+00, 7.7885e+05,
         3.7179e+05, 7.6104e+05, 3.7178e+05, 3.7175e+05, 7.4623e+05, 7.7089e+05,
         3.7177e+05, 3.7177e+05, 7.4353e+05, 3.7178e+05, 3.7177e+05],
        [3.9375e+05, 3.9379e+05, 7.9179e+05, 7.6224e+05, 7.7885e+05, 0.0000e+00,
         3.9377e+05, 7.7067e+05, 3.9373e+05, 3.9376e+05, 7.9503e+05, 8.0575e+05,
         3.9377e+05, 3.9379e+05, 7.5168e+05, 3.9377e+05, 3.9376e+05],
        [1.9870e+00, 1.9184e+00, 3.9754e+05, 3.8386e+05, 3.7179e+05, 3.9377e+05,
         0.0000e+00, 3.7773e+05, 1.7224e+00, 1.8172e+00, 3.8842e+05, 4.0871e+05,
         1.8342e+00, 1.7792e+00, 3.6415e+05, 1.8487e+00, 1.8562e+00],
        [3.7777e+05, 3.7776e+05, 7.7829e+05, 7.2779e+05, 7.6104e+05, 7.7067e+05,
         3.7773e+05, 0.0000e+00, 3.7778e+05, 3.7777e+05, 7.4090e+05, 8.0071e+05,
         3.7777e+05, 3.7775e+05, 7.5189e+05, 3.7775e+05, 3.7778e+05],
        [1.8247e+00, 1.7812e+00, 3.9753e+05, 3.8391e+05, 3.7178e+05, 3.9373e+05,
         1.7224e+00, 3.7778e+05, 0.0000e+00, 1.9499e+00, 3.8840e+05, 4.0869e+05,
         1.7850e+00, 1.9531e+00, 3.6415e+05, 1.8155e+00, 1.8012e+00],
        [1.9942e+00, 1.8167e+00, 3.9755e+05, 3.8385e+05, 3.7175e+05, 3.9376e+05,
         1.8172e+00, 3.7777e+05, 1.9499e+00, 0.0000e+00, 3.8838e+05, 4.0871e+05,
         1.9275e+00, 1.6956e+00, 3.6416e+05, 2.0671e+00, 1.6064e+00],
        [3.8842e+05, 3.8840e+05, 7.9678e+05, 7.7511e+05, 7.4623e+05, 7.9503e+05,
         3.8842e+05, 7.4090e+05, 3.8840e+05, 3.8838e+05, 0.0000e+00, 7.9530e+05,
         3.8840e+05, 3.8844e+05, 7.5343e+05, 3.8839e+05, 3.8838e+05],
        [4.0871e+05, 4.0870e+05, 8.0731e+05, 7.9189e+05, 7.7089e+05, 8.0575e+05,
         4.0871e+05, 8.0071e+05, 4.0869e+05, 4.0871e+05, 7.9530e+05, 0.0000e+00,
         4.0869e+05, 4.0871e+05, 7.7944e+05, 4.0871e+05, 4.0870e+05],
        [1.8513e+00, 1.8937e+00, 3.9756e+05, 3.8383e+05, 3.7177e+05, 3.9377e+05,
         1.8342e+00, 3.7777e+05, 1.7850e+00, 1.9275e+00, 3.8840e+05, 4.0869e+05,
         0.0000e+00, 1.8723e+00, 3.6415e+05, 1.9425e+00, 1.8400e+00],
        [1.9169e+00, 1.8160e+00, 3.9757e+05, 3.8386e+05, 3.7177e+05, 3.9379e+05,
         1.7792e+00, 3.7775e+05, 1.9531e+00, 1.6956e+00, 3.8844e+05, 4.0871e+05,
         1.8723e+00, 0.0000e+00, 3.6419e+05, 2.0150e+00, 1.7573e+00],
        [3.6417e+05, 3.6418e+05, 7.5281e+05, 7.6209e+05, 7.4353e+05, 7.5168e+05,
         3.6415e+05, 7.5189e+05, 3.6415e+05, 3.6416e+05, 7.5343e+05, 7.7944e+05,
         3.6415e+05, 3.6419e+05, 0.0000e+00, 3.6417e+05, 3.6417e+05],
        [2.0104e+00, 1.8054e+00, 3.9755e+05, 3.8388e+05, 3.7178e+05, 3.9377e+05,
         1.8487e+00, 3.7775e+05, 1.8155e+00, 2.0671e+00, 3.8839e+05, 4.0871e+05,
         1.9425e+00, 2.0150e+00, 3.6417e+05, 0.0000e+00, 1.9008e+00],
        [1.8085e+00, 1.8343e+00, 3.9754e+05, 3.8384e+05, 3.7177e+05, 3.9376e+05,
         1.8562e+00, 3.7778e+05, 1.8012e+00, 1.6064e+00, 3.8838e+05, 4.0870e+05,
         1.8400e+00, 1.7573e+00, 3.6417e+05, 1.9008e+00, 0.0000e+00]])
Krum scores: ['1.88', '1.82', '397541.69', '383852.56', '371765.41', '393760.44', '1.83', '377757.97', '1.81', '1.83', '388393.91', '408702.16', '1.86', '1.83', '364158.66', '1.91', '1.79']
Selected index: 16
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']], selected_client_indices: [7, 2, 19, 17, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:57...
global Accuracy on shared test data: 79.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:57, End: 2025-07-22 15:30:57)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 13, 14, 11, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.7041e+00, 1.8222e+00, 3.8866e+05, 3.8525e+05, 1.8251e+00,
         3.9487e+05, 3.9865e+05, 1.9454e+00, 3.8906e+05, 1.7255e+00, 3.9265e+05,
         3.9270e+05, 1.6602e+00, 3.9460e+05, 1.7910e+00, 1.7061e+00],
        [1.7041e+00, 0.0000e+00, 1.6357e+00, 3.8866e+05, 3.8525e+05, 1.7481e+00,
         3.9489e+05, 3.9869e+05, 1.9172e+00, 3.8908e+05, 1.8126e+00, 3.9267e+05,
         3.9267e+05, 1.6520e+00, 3.9460e+05, 1.9071e+00, 1.8285e+00],
        [1.8222e+00, 1.6357e+00, 0.0000e+00, 3.8868e+05, 3.8520e+05, 1.7093e+00,
         3.9491e+05, 3.9868e+05, 1.9214e+00, 3.8905e+05, 1.7378e+00, 3.9266e+05,
         3.9269e+05, 1.7956e+00, 3.9461e+05, 1.6642e+00, 1.7150e+00],
        [3.8866e+05, 3.8866e+05, 3.8868e+05, 0.0000e+00, 7.7589e+05, 3.8866e+05,
         7.5052e+05, 7.8810e+05, 3.8869e+05, 7.9322e+05, 3.8864e+05, 7.7232e+05,
         7.8281e+05, 3.8866e+05, 7.9149e+05, 3.8867e+05, 3.8870e+05],
        [3.8525e+05, 3.8525e+05, 3.8520e+05, 7.7589e+05, 0.0000e+00, 3.8525e+05,
         8.0815e+05, 7.7965e+05, 3.8522e+05, 7.7600e+05, 3.8525e+05, 7.8231e+05,
         7.8164e+05, 3.8522e+05, 7.7559e+05, 3.8521e+05, 3.8525e+05],
        [1.8251e+00, 1.7481e+00, 1.7093e+00, 3.8866e+05, 3.8525e+05, 0.0000e+00,
         3.9491e+05, 3.9869e+05, 1.7791e+00, 3.8908e+05, 1.8770e+00, 3.9262e+05,
         3.9267e+05, 1.6422e+00, 3.9457e+05, 1.7746e+00, 1.7957e+00],
        [3.9487e+05, 3.9489e+05, 3.9491e+05, 7.5052e+05, 8.0815e+05, 3.9491e+05,
         0.0000e+00, 7.8645e+05, 3.9493e+05, 7.8872e+05, 3.9487e+05, 7.9387e+05,
         7.7846e+05, 3.9490e+05, 7.7775e+05, 3.9490e+05, 3.9489e+05],
        [3.9865e+05, 3.9869e+05, 3.9868e+05, 7.8810e+05, 7.7965e+05, 3.9869e+05,
         7.8645e+05, 0.0000e+00, 3.9867e+05, 7.6391e+05, 3.9864e+05, 7.9029e+05,
         8.0250e+05, 3.9868e+05, 7.9237e+05, 3.9868e+05, 3.9867e+05],
        [1.9454e+00, 1.9172e+00, 1.9214e+00, 3.8869e+05, 3.8522e+05, 1.7791e+00,
         3.9493e+05, 3.9867e+05, 0.0000e+00, 3.8909e+05, 1.7471e+00, 3.9266e+05,
         3.9270e+05, 1.7285e+00, 3.9459e+05, 1.7582e+00, 1.8500e+00],
        [3.8906e+05, 3.8908e+05, 3.8905e+05, 7.9322e+05, 7.7600e+05, 3.8908e+05,
         7.8872e+05, 7.6391e+05, 3.8909e+05, 0.0000e+00, 3.8908e+05, 7.8564e+05,
         7.7826e+05, 3.8907e+05, 7.6285e+05, 3.8906e+05, 3.8906e+05],
        [1.7255e+00, 1.8126e+00, 1.7378e+00, 3.8864e+05, 3.8525e+05, 1.8770e+00,
         3.9487e+05, 3.9864e+05, 1.7471e+00, 3.8908e+05, 0.0000e+00, 3.9265e+05,
         3.9265e+05, 1.7783e+00, 3.9460e+05, 1.8876e+00, 1.6445e+00],
        [3.9265e+05, 3.9267e+05, 3.9266e+05, 7.7232e+05, 7.8231e+05, 3.9262e+05,
         7.9387e+05, 7.9029e+05, 3.9266e+05, 7.8564e+05, 3.9265e+05, 0.0000e+00,
         7.8933e+05, 3.9266e+05, 7.8598e+05, 3.9266e+05, 3.9264e+05],
        [3.9270e+05, 3.9267e+05, 3.9269e+05, 7.8281e+05, 7.8164e+05, 3.9267e+05,
         7.7846e+05, 8.0250e+05, 3.9270e+05, 7.7826e+05, 3.9265e+05, 7.8933e+05,
         0.0000e+00, 3.9269e+05, 7.8882e+05, 3.9269e+05, 3.9268e+05],
        [1.6602e+00, 1.6520e+00, 1.7956e+00, 3.8866e+05, 3.8522e+05, 1.6422e+00,
         3.9490e+05, 3.9868e+05, 1.7285e+00, 3.8907e+05, 1.7783e+00, 3.9266e+05,
         3.9269e+05, 0.0000e+00, 3.9460e+05, 1.7924e+00, 1.8879e+00],
        [3.9460e+05, 3.9460e+05, 3.9461e+05, 7.9149e+05, 7.7559e+05, 3.9457e+05,
         7.7775e+05, 7.9237e+05, 3.9459e+05, 7.6285e+05, 3.9460e+05, 7.8598e+05,
         7.8882e+05, 3.9460e+05, 0.0000e+00, 3.9460e+05, 3.9461e+05],
        [1.7910e+00, 1.9071e+00, 1.6642e+00, 3.8867e+05, 3.8521e+05, 1.7746e+00,
         3.9490e+05, 3.9868e+05, 1.7582e+00, 3.8906e+05, 1.8876e+00, 3.9266e+05,
         3.9269e+05, 1.7924e+00, 3.9460e+05, 0.0000e+00, 1.8415e+00],
        [1.7061e+00, 1.8285e+00, 1.7150e+00, 3.8870e+05, 3.8525e+05, 1.7957e+00,
         3.9489e+05, 3.9867e+05, 1.8500e+00, 3.8906e+05, 1.6445e+00, 3.9264e+05,
         3.9268e+05, 1.8879e+00, 3.9461e+05, 1.8415e+00, 0.0000e+00]])
Krum scores: ['1.75', '1.76', '1.73', '388662.56', '385225.69', '1.75', '394889.81', '398668.69', '1.81', '389066.09', '1.76', '392648.72', '392676.09', '1.72', '394593.59', '1.79', '1.77']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0071s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:58...
global Accuracy on shared test data: 77.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 43 220]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:58, End: 2025-07-22 15:30:58)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.8679e+00, 1.9987e+00, 4.1400e+05, 4.0445e+05, 1.9951e+00,
         1.9509e+00, 4.1292e+05, 3.9201e+05, 3.9375e+05, 1.9601e+00, 1.8367e+00,
         3.8441e+05, 3.9442e+05, 1.9414e+00, 1.9731e+00, 3.9499e+05, 1.9079e+00,
         1.8573e+00],
        [1.8679e+00, 0.0000e+00, 1.8093e+00, 4.1396e+05, 4.0448e+05, 1.9649e+00,
         1.9973e+00, 4.1292e+05, 3.9200e+05, 3.9373e+05, 1.8937e+00, 1.9375e+00,
         3.8442e+05, 3.9444e+05, 1.9742e+00, 1.9395e+00, 3.9500e+05, 2.0711e+00,
         1.9473e+00],
        [1.9987e+00, 1.8093e+00, 0.0000e+00, 4.1397e+05, 4.0446e+05, 1.8091e+00,
         1.6752e+00, 4.1293e+05, 3.9200e+05, 3.9372e+05, 1.7404e+00, 1.7916e+00,
         3.8444e+05, 3.9443e+05, 1.8921e+00, 1.7483e+00, 3.9499e+05, 1.6844e+00,
         1.7961e+00],
        [4.1400e+05, 4.1396e+05, 4.1397e+05, 0.0000e+00, 7.8921e+05, 4.1396e+05,
         4.1399e+05, 8.2314e+05, 7.9057e+05, 8.2293e+05, 4.1400e+05, 4.1400e+05,
         8.0848e+05, 8.1041e+05, 4.1400e+05, 4.1401e+05, 8.1275e+05, 4.1397e+05,
         4.1402e+05],
        [4.0445e+05, 4.0448e+05, 4.0446e+05, 7.8921e+05, 0.0000e+00, 4.0444e+05,
         4.0443e+05, 8.2609e+05, 8.1197e+05, 8.2016e+05, 4.0446e+05, 4.0443e+05,
         7.7299e+05, 7.8457e+05, 4.0443e+05, 4.0447e+05, 7.9376e+05, 4.0444e+05,
         4.0447e+05],
        [1.9951e+00, 1.9649e+00, 1.8091e+00, 4.1396e+05, 4.0444e+05, 0.0000e+00,
         1.8999e+00, 4.1294e+05, 3.9204e+05, 3.9373e+05, 1.8842e+00, 2.0296e+00,
         3.8445e+05, 3.9444e+05, 1.7831e+00, 1.9060e+00, 3.9500e+05, 1.8090e+00,
         1.8896e+00],
        [1.9509e+00, 1.9973e+00, 1.6752e+00, 4.1399e+05, 4.0443e+05, 1.8999e+00,
         0.0000e+00, 4.1293e+05, 3.9202e+05, 3.9376e+05, 1.7821e+00, 1.8025e+00,
         3.8440e+05, 3.9441e+05, 1.8242e+00, 1.8385e+00, 3.9498e+05, 1.7236e+00,
         1.6929e+00],
        [4.1292e+05, 4.1292e+05, 4.1293e+05, 8.2314e+05, 8.2609e+05, 4.1294e+05,
         4.1293e+05, 0.0000e+00, 7.9326e+05, 7.7720e+05, 4.1290e+05, 4.1295e+05,
         8.0974e+05, 8.1581e+05, 4.1291e+05, 4.1290e+05, 7.9229e+05, 4.1295e+05,
         4.1294e+05],
        [3.9201e+05, 3.9200e+05, 3.9200e+05, 7.9057e+05, 8.1197e+05, 3.9204e+05,
         3.9202e+05, 7.9326e+05, 0.0000e+00, 8.0233e+05, 3.9205e+05, 3.9199e+05,
         7.8717e+05, 7.7419e+05, 3.9202e+05, 3.9203e+05, 7.7465e+05, 3.9204e+05,
         3.9202e+05],
        [3.9375e+05, 3.9373e+05, 3.9372e+05, 8.2293e+05, 8.2016e+05, 3.9373e+05,
         3.9376e+05, 7.7720e+05, 8.0233e+05, 0.0000e+00, 3.9372e+05, 3.9371e+05,
         7.7148e+05, 8.0227e+05, 3.9376e+05, 3.9377e+05, 7.7907e+05, 3.9373e+05,
         3.9371e+05],
        [1.9601e+00, 1.8937e+00, 1.7404e+00, 4.1400e+05, 4.0446e+05, 1.8842e+00,
         1.7821e+00, 4.1290e+05, 3.9205e+05, 3.9372e+05, 0.0000e+00, 1.9477e+00,
         3.8444e+05, 3.9440e+05, 1.8009e+00, 1.9570e+00, 3.9499e+05, 1.7006e+00,
         1.7837e+00],
        [1.8367e+00, 1.9375e+00, 1.7916e+00, 4.1400e+05, 4.0443e+05, 2.0296e+00,
         1.8025e+00, 4.1295e+05, 3.9199e+05, 3.9371e+05, 1.9477e+00, 0.0000e+00,
         3.8439e+05, 3.9439e+05, 1.9785e+00, 1.8096e+00, 3.9499e+05, 2.0281e+00,
         1.7103e+00],
        [3.8441e+05, 3.8442e+05, 3.8444e+05, 8.0848e+05, 7.7299e+05, 3.8445e+05,
         3.8440e+05, 8.0974e+05, 7.8717e+05, 7.7148e+05, 3.8444e+05, 3.8439e+05,
         0.0000e+00, 7.7784e+05, 3.8444e+05, 3.8444e+05, 7.8893e+05, 3.8440e+05,
         3.8442e+05],
        [3.9442e+05, 3.9444e+05, 3.9443e+05, 8.1041e+05, 7.8457e+05, 3.9444e+05,
         3.9441e+05, 8.1581e+05, 7.7419e+05, 8.0227e+05, 3.9440e+05, 3.9439e+05,
         7.7784e+05, 0.0000e+00, 3.9444e+05, 3.9443e+05, 7.7473e+05, 3.9443e+05,
         3.9440e+05],
        [1.9414e+00, 1.9742e+00, 1.8921e+00, 4.1400e+05, 4.0443e+05, 1.7831e+00,
         1.8242e+00, 4.1291e+05, 3.9202e+05, 3.9376e+05, 1.8009e+00, 1.9785e+00,
         3.8444e+05, 3.9444e+05, 0.0000e+00, 1.9230e+00, 3.9499e+05, 1.9500e+00,
         1.8603e+00],
        [1.9731e+00, 1.9395e+00, 1.7483e+00, 4.1401e+05, 4.0447e+05, 1.9060e+00,
         1.8385e+00, 4.1290e+05, 3.9203e+05, 3.9377e+05, 1.9570e+00, 1.8096e+00,
         3.8444e+05, 3.9443e+05, 1.9230e+00, 0.0000e+00, 3.9499e+05, 1.9449e+00,
         1.8685e+00],
        [3.9499e+05, 3.9500e+05, 3.9499e+05, 8.1275e+05, 7.9376e+05, 3.9500e+05,
         3.9498e+05, 7.9229e+05, 7.7465e+05, 7.7907e+05, 3.9499e+05, 3.9499e+05,
         7.8893e+05, 7.7473e+05, 3.9499e+05, 3.9499e+05, 0.0000e+00, 3.9497e+05,
         3.9496e+05],
        [1.9079e+00, 2.0711e+00, 1.6844e+00, 4.1397e+05, 4.0444e+05, 1.8090e+00,
         1.7236e+00, 4.1295e+05, 3.9204e+05, 3.9373e+05, 1.7006e+00, 2.0281e+00,
         3.8440e+05, 3.9443e+05, 1.9500e+00, 1.9449e+00, 3.9497e+05, 0.0000e+00,
         1.9033e+00],
        [1.8573e+00, 1.9473e+00, 1.7961e+00, 4.1402e+05, 4.0447e+05, 1.8896e+00,
         1.6929e+00, 4.1294e+05, 3.9202e+05, 3.9371e+05, 1.7837e+00, 1.7103e+00,
         3.8442e+05, 3.9440e+05, 1.8603e+00, 1.8685e+00, 3.9496e+05, 1.9033e+00,
         0.0000e+00]])
Krum scores: ['1.92', '1.93', '1.77', '413983.84', '404446.09', '1.88', '1.80', '412919.72', '392014.69', '393729.66', '1.83', '1.87', '384417.59', '394417.53', '1.88', '1.88', '394983.88', '1.85', '1.82']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0202s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:58...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:58, End: 2025-07-22 15:30:58)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 19, 1, 9, 20, 18, 8, 15, 4, 14, 11, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.7034e+00, 3.7329e+05, 1.7675e+00, 1.7410e+00, 3.7898e+05,
         3.7066e+05, 1.8321e+00, 3.8817e+05, 1.6845e+00, 4.0087e+05, 1.7320e+00,
         3.9272e+05, 1.8102e+00, 1.6260e+00],
        [1.7034e+00, 0.0000e+00, 3.7326e+05, 1.6676e+00, 1.7712e+00, 3.7892e+05,
         3.7070e+05, 1.8021e+00, 3.8818e+05, 1.5705e+00, 4.0086e+05, 1.7572e+00,
         3.9269e+05, 1.8622e+00, 1.6895e+00],
        [3.7329e+05, 3.7326e+05, 0.0000e+00, 3.7325e+05, 3.7328e+05, 7.4527e+05,
         7.4689e+05, 3.7326e+05, 7.5654e+05, 3.7325e+05, 7.4078e+05, 3.7326e+05,
         7.7937e+05, 3.7324e+05, 3.7326e+05],
        [1.7675e+00, 1.6676e+00, 3.7325e+05, 0.0000e+00, 1.6853e+00, 3.7893e+05,
         3.7069e+05, 1.7524e+00, 3.8818e+05, 1.6246e+00, 4.0083e+05, 1.6021e+00,
         3.9268e+05, 1.7115e+00, 1.6399e+00],
        [1.7410e+00, 1.7712e+00, 3.7328e+05, 1.6853e+00, 0.0000e+00, 3.7894e+05,
         3.7069e+05, 1.6643e+00, 3.8816e+05, 1.5979e+00, 4.0085e+05, 1.6418e+00,
         3.9268e+05, 1.6141e+00, 1.5304e+00],
        [3.7898e+05, 3.7892e+05, 7.4527e+05, 3.7893e+05, 3.7894e+05, 0.0000e+00,
         7.4258e+05, 3.7893e+05, 7.6756e+05, 3.7894e+05, 7.8974e+05, 3.7897e+05,
         7.6655e+05, 3.7894e+05, 3.7893e+05],
        [3.7066e+05, 3.7070e+05, 7.4689e+05, 3.7069e+05, 3.7069e+05, 7.4258e+05,
         0.0000e+00, 3.7069e+05, 7.5121e+05, 3.7069e+05, 7.6858e+05, 3.7067e+05,
         7.6213e+05, 3.7070e+05, 3.7067e+05],
        [1.8321e+00, 1.8021e+00, 3.7326e+05, 1.7524e+00, 1.6643e+00, 3.7893e+05,
         3.7069e+05, 0.0000e+00, 3.8816e+05, 1.5411e+00, 4.0085e+05, 1.7537e+00,
         3.9270e+05, 1.6634e+00, 1.7044e+00],
        [3.8817e+05, 3.8818e+05, 7.5654e+05, 3.8818e+05, 3.8816e+05, 7.6756e+05,
         7.5121e+05, 3.8816e+05, 0.0000e+00, 3.8820e+05, 7.8609e+05, 3.8821e+05,
         7.7399e+05, 3.8818e+05, 3.8818e+05],
        [1.6845e+00, 1.5705e+00, 3.7325e+05, 1.6246e+00, 1.5979e+00, 3.7894e+05,
         3.7069e+05, 1.5411e+00, 3.8820e+05, 0.0000e+00, 4.0088e+05, 1.6110e+00,
         3.9267e+05, 1.5828e+00, 1.5234e+00],
        [4.0087e+05, 4.0086e+05, 7.4078e+05, 4.0083e+05, 4.0085e+05, 7.8974e+05,
         7.6858e+05, 4.0085e+05, 7.8609e+05, 4.0088e+05, 0.0000e+00, 4.0084e+05,
         7.8087e+05, 4.0083e+05, 4.0088e+05],
        [1.7320e+00, 1.7572e+00, 3.7326e+05, 1.6021e+00, 1.6418e+00, 3.7897e+05,
         3.7067e+05, 1.7537e+00, 3.8821e+05, 1.6110e+00, 4.0084e+05, 0.0000e+00,
         3.9269e+05, 1.8087e+00, 1.6485e+00],
        [3.9272e+05, 3.9269e+05, 7.7937e+05, 3.9268e+05, 3.9268e+05, 7.6655e+05,
         7.6213e+05, 3.9270e+05, 7.7399e+05, 3.9267e+05, 7.8087e+05, 3.9269e+05,
         0.0000e+00, 3.9266e+05, 3.9273e+05],
        [1.8102e+00, 1.8622e+00, 3.7324e+05, 1.7115e+00, 1.6141e+00, 3.7894e+05,
         3.7070e+05, 1.6634e+00, 3.8818e+05, 1.5828e+00, 4.0083e+05, 1.8087e+00,
         3.9266e+05, 0.0000e+00, 1.7022e+00],
        [1.6260e+00, 1.6895e+00, 3.7326e+05, 1.6399e+00, 1.5304e+00, 3.7893e+05,
         3.7067e+05, 1.7044e+00, 3.8818e+05, 1.5234e+00, 4.0088e+05, 1.6485e+00,
         3.9273e+05, 1.7022e+00, 0.0000e+00]])
Krum scores: ['1.72', '1.71', '373255.91', '1.67', '1.64', '378932.53', '370678.34', '1.70', '388171.88', '1.58', '400848.22', '1.68', '392681.88', '1.70', '1.62']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 19, 1, 9, 20, 18, 8, 15, 4, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0071s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:59...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:59, End: 2025-07-22 15:30:59)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.7842e+00, 1.9134e+00, 3.9033e+05, 4.0675e+05, 1.8221e+00,
         3.9174e+05, 3.7940e+05, 1.9608e+00, 3.9015e+05, 1.8602e+00, 1.6509e+00,
         4.0148e+05, 3.9054e+05, 1.7796e+00, 1.7562e+00, 4.0644e+05, 1.6745e+00],
        [1.7842e+00, 0.0000e+00, 1.8164e+00, 3.9031e+05, 4.0680e+05, 1.7276e+00,
         3.9176e+05, 3.7937e+05, 1.8847e+00, 3.9018e+05, 1.7910e+00, 1.8008e+00,
         4.0145e+05, 3.9053e+05, 1.8341e+00, 1.7229e+00, 4.0640e+05, 1.7988e+00],
        [1.9134e+00, 1.8164e+00, 0.0000e+00, 3.9032e+05, 4.0676e+05, 1.8292e+00,
         3.9172e+05, 3.7938e+05, 1.9168e+00, 3.9018e+05, 1.5677e+00, 1.7875e+00,
         4.0144e+05, 3.9054e+05, 1.7266e+00, 1.7291e+00, 4.0643e+05, 1.6795e+00],
        [3.9033e+05, 3.9031e+05, 3.9032e+05, 0.0000e+00, 7.9679e+05, 3.9032e+05,
         7.6668e+05, 7.8331e+05, 3.9033e+05, 7.9282e+05, 3.9037e+05, 3.9035e+05,
         7.6793e+05, 7.7292e+05, 3.9036e+05, 3.9034e+05, 8.0922e+05, 3.9032e+05],
        [4.0675e+05, 4.0680e+05, 4.0676e+05, 7.9679e+05, 0.0000e+00, 4.0676e+05,
         7.9326e+05, 7.8305e+05, 4.0676e+05, 7.9944e+05, 4.0674e+05, 4.0678e+05,
         8.1438e+05, 8.0199e+05, 4.0676e+05, 4.0678e+05, 7.9842e+05, 4.0674e+05],
        [1.8221e+00, 1.7276e+00, 1.8292e+00, 3.9032e+05, 4.0676e+05, 0.0000e+00,
         3.9176e+05, 3.7937e+05, 1.8111e+00, 3.9016e+05, 1.8783e+00, 1.8537e+00,
         4.0147e+05, 3.9054e+05, 1.6113e+00, 1.7142e+00, 4.0643e+05, 1.7377e+00],
        [3.9174e+05, 3.9176e+05, 3.9172e+05, 7.6668e+05, 7.9326e+05, 3.9176e+05,
         0.0000e+00, 7.8630e+05, 3.9176e+05, 7.5753e+05, 3.9173e+05, 3.9174e+05,
         7.8598e+05, 7.9836e+05, 3.9177e+05, 3.9176e+05, 7.9594e+05, 3.9178e+05],
        [3.7940e+05, 3.7937e+05, 3.7938e+05, 7.8331e+05, 7.8305e+05, 3.7937e+05,
         7.8630e+05, 0.0000e+00, 3.7934e+05, 7.8095e+05, 3.7937e+05, 3.7935e+05,
         7.8570e+05, 7.3510e+05, 3.7938e+05, 3.7936e+05, 7.7504e+05, 3.7937e+05],
        [1.9608e+00, 1.8847e+00, 1.9168e+00, 3.9033e+05, 4.0676e+05, 1.8111e+00,
         3.9176e+05, 3.7934e+05, 0.0000e+00, 3.9013e+05, 1.8168e+00, 1.7275e+00,
         4.0141e+05, 3.9051e+05, 1.7758e+00, 1.6501e+00, 4.0642e+05, 1.8346e+00],
        [3.9015e+05, 3.9018e+05, 3.9018e+05, 7.9282e+05, 7.9944e+05, 3.9016e+05,
         7.5753e+05, 7.8095e+05, 3.9013e+05, 0.0000e+00, 3.9016e+05, 3.9012e+05,
         7.6860e+05, 7.8794e+05, 3.9018e+05, 3.9017e+05, 8.0017e+05, 3.9014e+05],
        [1.8602e+00, 1.7910e+00, 1.5677e+00, 3.9037e+05, 4.0674e+05, 1.8783e+00,
         3.9173e+05, 3.7937e+05, 1.8168e+00, 3.9016e+05, 0.0000e+00, 1.8846e+00,
         4.0144e+05, 3.9054e+05, 1.7059e+00, 1.9152e+00, 4.0646e+05, 1.7424e+00],
        [1.6509e+00, 1.8008e+00, 1.7875e+00, 3.9035e+05, 4.0678e+05, 1.8537e+00,
         3.9174e+05, 3.7935e+05, 1.7275e+00, 3.9012e+05, 1.8846e+00, 0.0000e+00,
         4.0145e+05, 3.9049e+05, 1.7875e+00, 1.5519e+00, 4.0645e+05, 1.6090e+00],
        [4.0148e+05, 4.0145e+05, 4.0144e+05, 7.6793e+05, 8.1438e+05, 4.0147e+05,
         7.8598e+05, 7.8570e+05, 4.0141e+05, 7.6860e+05, 4.0144e+05, 4.0145e+05,
         0.0000e+00, 7.7252e+05, 4.0150e+05, 4.0144e+05, 7.9868e+05, 4.0143e+05],
        [3.9054e+05, 3.9053e+05, 3.9054e+05, 7.7292e+05, 8.0199e+05, 3.9054e+05,
         7.9836e+05, 7.3510e+05, 3.9051e+05, 7.8794e+05, 3.9054e+05, 3.9049e+05,
         7.7252e+05, 0.0000e+00, 3.9053e+05, 3.9053e+05, 7.8346e+05, 3.9053e+05],
        [1.7796e+00, 1.8341e+00, 1.7266e+00, 3.9036e+05, 4.0676e+05, 1.6113e+00,
         3.9177e+05, 3.7938e+05, 1.7758e+00, 3.9018e+05, 1.7059e+00, 1.7875e+00,
         4.0150e+05, 3.9053e+05, 0.0000e+00, 1.7292e+00, 4.0641e+05, 1.7343e+00],
        [1.7562e+00, 1.7229e+00, 1.7291e+00, 3.9034e+05, 4.0678e+05, 1.7142e+00,
         3.9176e+05, 3.7936e+05, 1.6501e+00, 3.9017e+05, 1.9152e+00, 1.5519e+00,
         4.0144e+05, 3.9053e+05, 1.7292e+00, 0.0000e+00, 4.0643e+05, 1.6300e+00],
        [4.0644e+05, 4.0640e+05, 4.0643e+05, 8.0922e+05, 7.9842e+05, 4.0643e+05,
         7.9594e+05, 7.7504e+05, 4.0642e+05, 8.0017e+05, 4.0646e+05, 4.0645e+05,
         7.9868e+05, 7.8346e+05, 4.0641e+05, 4.0643e+05, 0.0000e+00, 4.0643e+05],
        [1.6745e+00, 1.7988e+00, 1.6795e+00, 3.9032e+05, 4.0674e+05, 1.7377e+00,
         3.9178e+05, 3.7937e+05, 1.8346e+00, 3.9014e+05, 1.7424e+00, 1.6090e+00,
         4.0143e+05, 3.9053e+05, 1.7343e+00, 1.6300e+00, 4.0643e+05, 0.0000e+00]])
Krum scores: ['1.78', '1.78', '1.76', '390327.75', '406757.06', '1.76', '391745.44', '379362.50', '1.80', '390150.59', '1.78', '1.72', '401444.94', '390525.56', '1.73', '1.69', '406423.78', '1.70']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0070s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:30:59...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 49 214]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:30:59, End: 2025-07-22 15:30:59)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (11): [5, 19, 17, 20, 18, 15, 13, 14, 11, 16, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
tensor([[0.0000e+00, 3.7705e+05, 3.9018e+05, 3.7040e+05, 3.9678e+05, 3.8996e+05,
         4.0711e+05, 3.8535e+05, 1.7463e+00, 3.9961e+05, 1.7003e+00],
        [3.7705e+05, 0.0000e+00, 7.5925e+05, 7.5019e+05, 7.7590e+05, 7.7665e+05,
         7.7760e+05, 7.5977e+05, 3.7709e+05, 7.8615e+05, 3.7705e+05],
        [3.9018e+05, 7.5925e+05, 0.0000e+00, 7.5286e+05, 7.6774e+05, 7.8415e+05,
         7.9599e+05, 7.6771e+05, 3.9022e+05, 7.8903e+05, 3.9021e+05],
        [3.7040e+05, 7.5019e+05, 7.5286e+05, 0.0000e+00, 7.5597e+05, 7.4804e+05,
         7.8372e+05, 7.3883e+05, 3.7041e+05, 7.7279e+05, 3.7035e+05],
        [3.9678e+05, 7.7590e+05, 7.6774e+05, 7.5597e+05, 0.0000e+00, 7.7890e+05,
         7.9675e+05, 7.8936e+05, 3.9677e+05, 7.8553e+05, 3.9678e+05],
        [3.8996e+05, 7.7665e+05, 7.8415e+05, 7.4804e+05, 7.7890e+05, 0.0000e+00,
         7.9255e+05, 7.8005e+05, 3.8994e+05, 8.0370e+05, 3.8997e+05],
        [4.0711e+05, 7.7760e+05, 7.9599e+05, 7.8372e+05, 7.9675e+05, 7.9255e+05,
         0.0000e+00, 7.9208e+05, 4.0709e+05, 7.9909e+05, 4.0708e+05],
        [3.8535e+05, 7.5977e+05, 7.6771e+05, 7.3883e+05, 7.8936e+05, 7.8005e+05,
         7.9208e+05, 0.0000e+00, 3.8536e+05, 7.9903e+05, 3.8534e+05],
        [1.7463e+00, 3.7709e+05, 3.9022e+05, 3.7041e+05, 3.9677e+05, 3.8994e+05,
         4.0709e+05, 3.8536e+05, 0.0000e+00, 3.9958e+05, 1.7081e+00],
        [3.9961e+05, 7.8615e+05, 7.8903e+05, 7.7279e+05, 7.8553e+05, 8.0370e+05,
         7.9909e+05, 7.9903e+05, 3.9958e+05, 0.0000e+00, 3.9963e+05],
        [1.7003e+00, 3.7705e+05, 3.9021e+05, 3.7035e+05, 3.9678e+05, 3.8997e+05,
         4.0708e+05, 3.8534e+05, 1.7081e+00, 3.9963e+05, 0.0000e+00]])
Krum scores: ['1.70', '377047.94', '390179.66', '370350.88', '396769.16', '389937.53', '407077.19', '385341.91', '1.71', '399584.53', '1.70']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [5, 19, 17, 20, 18, 15, 13, 14, 11, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:00...
global Accuracy on shared test data: 78.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:31:00, End: 2025-07-22 15:31:00)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 17, 20, 18, 8, 15, 4, 3, 14, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.9096e+00, 1.8647e+00, 3.9142e+05, 3.7822e+05, 4.0114e+05,
         3.8973e+05, 2.0536e+00, 3.9631e+05, 1.7338e+00, 1.7733e+00, 4.0301e+05,
         1.7280e+00, 4.0897e+05, 1.7353e+00],
        [1.9096e+00, 0.0000e+00, 1.7403e+00, 3.9140e+05, 3.7816e+05, 4.0118e+05,
         3.8976e+05, 1.6786e+00, 3.9635e+05, 1.6205e+00, 1.6911e+00, 4.0302e+05,
         1.7046e+00, 4.0894e+05, 1.7398e+00],
        [1.8647e+00, 1.7403e+00, 0.0000e+00, 3.9135e+05, 3.7818e+05, 4.0116e+05,
         3.8977e+05, 1.7820e+00, 3.9637e+05, 1.4513e+00, 1.6475e+00, 4.0301e+05,
         1.4573e+00, 4.0894e+05, 1.6293e+00],
        [3.9142e+05, 3.9140e+05, 3.9135e+05, 0.0000e+00, 7.8708e+05, 8.1986e+05,
         7.7822e+05, 3.9140e+05, 8.0192e+05, 3.9136e+05, 3.9139e+05, 7.7621e+05,
         3.9135e+05, 7.8510e+05, 3.9137e+05],
        [3.7822e+05, 3.7816e+05, 3.7818e+05, 7.8708e+05, 0.0000e+00, 7.8105e+05,
         7.7446e+05, 3.7819e+05, 7.8151e+05, 3.7816e+05, 3.7817e+05, 7.7449e+05,
         3.7818e+05, 7.7282e+05, 3.7818e+05],
        [4.0114e+05, 4.0118e+05, 4.0116e+05, 8.1986e+05, 7.8105e+05, 0.0000e+00,
         7.9147e+05, 4.0120e+05, 8.0426e+05, 4.0119e+05, 4.0117e+05, 7.8403e+05,
         4.0120e+05, 7.8687e+05, 4.0121e+05],
        [3.8973e+05, 3.8976e+05, 3.8977e+05, 7.7822e+05, 7.7446e+05, 7.9147e+05,
         0.0000e+00, 3.8977e+05, 7.8980e+05, 3.8976e+05, 3.8977e+05, 7.8968e+05,
         3.8977e+05, 7.9552e+05, 3.8975e+05],
        [2.0536e+00, 1.6786e+00, 1.7820e+00, 3.9140e+05, 3.7819e+05, 4.0120e+05,
         3.8977e+05, 0.0000e+00, 3.9633e+05, 1.5924e+00, 1.6288e+00, 4.0300e+05,
         1.6128e+00, 4.0893e+05, 1.7937e+00],
        [3.9631e+05, 3.9635e+05, 3.9637e+05, 8.0192e+05, 7.8151e+05, 8.0426e+05,
         7.8980e+05, 3.9633e+05, 0.0000e+00, 3.9634e+05, 3.9634e+05, 7.9635e+05,
         3.9635e+05, 8.0284e+05, 3.9636e+05],
        [1.7338e+00, 1.6205e+00, 1.4513e+00, 3.9136e+05, 3.7816e+05, 4.0119e+05,
         3.8976e+05, 1.5924e+00, 3.9634e+05, 0.0000e+00, 1.6842e+00, 4.0302e+05,
         1.5721e+00, 4.0894e+05, 1.5980e+00],
        [1.7733e+00, 1.6911e+00, 1.6475e+00, 3.9139e+05, 3.7817e+05, 4.0117e+05,
         3.8977e+05, 1.6288e+00, 3.9634e+05, 1.6842e+00, 0.0000e+00, 4.0299e+05,
         1.5437e+00, 4.0894e+05, 1.5832e+00],
        [4.0301e+05, 4.0302e+05, 4.0301e+05, 7.7621e+05, 7.7449e+05, 7.8403e+05,
         7.8968e+05, 4.0300e+05, 7.9635e+05, 4.0302e+05, 4.0299e+05, 0.0000e+00,
         4.0298e+05, 8.1280e+05, 4.0301e+05],
        [1.7280e+00, 1.7046e+00, 1.4573e+00, 3.9135e+05, 3.7818e+05, 4.0120e+05,
         3.8977e+05, 1.6128e+00, 3.9635e+05, 1.5721e+00, 1.5437e+00, 4.0298e+05,
         0.0000e+00, 4.0893e+05, 1.5824e+00],
        [4.0897e+05, 4.0894e+05, 4.0894e+05, 7.8510e+05, 7.7282e+05, 7.8687e+05,
         7.9552e+05, 4.0893e+05, 8.0284e+05, 4.0894e+05, 4.0894e+05, 8.1280e+05,
         4.0893e+05, 0.0000e+00, 4.0895e+05],
        [1.7353e+00, 1.7398e+00, 1.6293e+00, 3.9137e+05, 3.7818e+05, 4.0121e+05,
         3.8975e+05, 1.7937e+00, 3.9636e+05, 1.5980e+00, 1.5832e+00, 4.0301e+05,
         1.5824e+00, 4.0895e+05, 0.0000e+00]])
Krum scores: ['1.79', '1.70', '1.62', '391369.28', '378170.66', '401173.56', '389756.69', '1.68', '396335.78', '1.59', '1.63', '403000.06', '1.58', '408935.38', '1.64']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 17, 20, 18, 8, 15, 4, 3, 14, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0270s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:00...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[167  70]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:00, End: 2025-07-22 15:31:00)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 17, 1, 9, 20, 18, 15, 4, 13, 14, 11, 10, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6047e+00, 1.5885e+00, 3.9769e+05, 1.6016e+00, 1.5808e+00,
         3.8610e+05, 3.7534e+05, 3.9538e+05, 1.4905e+00, 3.8957e+05, 3.7974e+05,
         1.5106e+00, 1.5399e+00, 1.6414e+00, 1.4803e+00],
        [1.6047e+00, 0.0000e+00, 1.5351e+00, 3.9768e+05, 1.4409e+00, 1.6626e+00,
         3.8610e+05, 3.7534e+05, 3.9544e+05, 1.4762e+00, 3.8958e+05, 3.7979e+05,
         1.5081e+00, 1.9517e+00, 1.5057e+00, 1.5640e+00],
        [1.5885e+00, 1.5351e+00, 0.0000e+00, 3.9769e+05, 1.5022e+00, 1.3817e+00,
         3.8613e+05, 3.7533e+05, 3.9541e+05, 1.3462e+00, 3.8957e+05, 3.7977e+05,
         1.5478e+00, 1.5216e+00, 1.4367e+00, 1.4440e+00],
        [3.9769e+05, 3.9768e+05, 3.9769e+05, 0.0000e+00, 3.9767e+05, 3.9767e+05,
         7.8171e+05, 7.4562e+05, 7.9316e+05, 3.9766e+05, 7.6803e+05, 7.7758e+05,
         3.9769e+05, 3.9766e+05, 3.9766e+05, 3.9767e+05],
        [1.6016e+00, 1.4409e+00, 1.5022e+00, 3.9767e+05, 0.0000e+00, 1.4673e+00,
         3.8611e+05, 3.7535e+05, 3.9541e+05, 1.4707e+00, 3.8958e+05, 3.7978e+05,
         1.4246e+00, 1.8486e+00, 1.3899e+00, 1.4879e+00],
        [1.5808e+00, 1.6626e+00, 1.3817e+00, 3.9767e+05, 1.4673e+00, 0.0000e+00,
         3.8611e+05, 3.7532e+05, 3.9539e+05, 1.4347e+00, 3.8957e+05, 3.7975e+05,
         1.5023e+00, 1.6114e+00, 1.4764e+00, 1.4493e+00],
        [3.8610e+05, 3.8610e+05, 3.8613e+05, 7.8171e+05, 3.8611e+05, 3.8611e+05,
         0.0000e+00, 7.5340e+05, 7.7745e+05, 3.8607e+05, 7.6561e+05, 7.6259e+05,
         3.8610e+05, 3.8612e+05, 3.8612e+05, 3.8610e+05],
        [3.7534e+05, 3.7534e+05, 3.7533e+05, 7.4562e+05, 3.7535e+05, 3.7532e+05,
         7.5340e+05, 0.0000e+00, 7.6465e+05, 3.7530e+05, 7.5953e+05, 7.5363e+05,
         3.7534e+05, 3.7531e+05, 3.7533e+05, 3.7532e+05],
        [3.9538e+05, 3.9544e+05, 3.9541e+05, 7.9316e+05, 3.9541e+05, 3.9539e+05,
         7.7745e+05, 7.6465e+05, 0.0000e+00, 3.9545e+05, 8.0193e+05, 7.6281e+05,
         3.9541e+05, 3.9544e+05, 3.9540e+05, 3.9542e+05],
        [1.4905e+00, 1.4762e+00, 1.3462e+00, 3.9766e+05, 1.4707e+00, 1.4347e+00,
         3.8607e+05, 3.7530e+05, 3.9545e+05, 0.0000e+00, 3.8956e+05, 3.7978e+05,
         1.4039e+00, 1.6911e+00, 1.3845e+00, 1.4704e+00],
        [3.8957e+05, 3.8958e+05, 3.8957e+05, 7.6803e+05, 3.8958e+05, 3.8957e+05,
         7.6561e+05, 7.5953e+05, 8.0193e+05, 3.8956e+05, 0.0000e+00, 7.5982e+05,
         3.8959e+05, 3.8957e+05, 3.8957e+05, 3.8959e+05],
        [3.7974e+05, 3.7979e+05, 3.7977e+05, 7.7758e+05, 3.7978e+05, 3.7975e+05,
         7.6259e+05, 7.5363e+05, 7.6281e+05, 3.7978e+05, 7.5982e+05, 0.0000e+00,
         3.7978e+05, 3.7977e+05, 3.7977e+05, 3.7976e+05],
        [1.5106e+00, 1.5081e+00, 1.5478e+00, 3.9769e+05, 1.4246e+00, 1.5023e+00,
         3.8610e+05, 3.7534e+05, 3.9541e+05, 1.4039e+00, 3.8959e+05, 3.7978e+05,
         0.0000e+00, 1.7927e+00, 1.5694e+00, 1.5011e+00],
        [1.5399e+00, 1.9517e+00, 1.5216e+00, 3.9766e+05, 1.8486e+00, 1.6114e+00,
         3.8612e+05, 3.7531e+05, 3.9544e+05, 1.6911e+00, 3.8957e+05, 3.7977e+05,
         1.7927e+00, 0.0000e+00, 1.8563e+00, 1.6509e+00],
        [1.6414e+00, 1.5057e+00, 1.4367e+00, 3.9766e+05, 1.3899e+00, 1.4764e+00,
         3.8612e+05, 3.7533e+05, 3.9540e+05, 1.3845e+00, 3.8957e+05, 3.7977e+05,
         1.5694e+00, 1.8563e+00, 0.0000e+00, 1.5397e+00],
        [1.4803e+00, 1.5640e+00, 1.4440e+00, 3.9767e+05, 1.4879e+00, 1.4493e+00,
         3.8610e+05, 3.7532e+05, 3.9542e+05, 1.4704e+00, 3.8959e+05, 3.7976e+05,
         1.5011e+00, 1.6509e+00, 1.5397e+00, 0.0000e+00]])
Krum scores: ['1.55', '1.54', '1.46', '397669.72', '1.47', '1.49', '386101.81', '375324.56', '395407.34', '1.43', '389569.31', '379764.97', '1.50', '1.69', '1.49', '1.49']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 17, 1, 9, 20, 18, 15, 4, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0088s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:01...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:01, End: 2025-07-22 15:31:01)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.5845e+00, 1.4897e+00, 3.7955e+05, 3.8580e+05, 1.5171e+00,
         1.5434e+00, 4.0561e+05, 3.8468e+05, 1.7377e+00, 3.9768e+05, 1.5541e+00,
         1.4854e+00, 3.8759e+05, 3.9141e+05, 1.4750e+00, 3.8170e+05, 1.5592e+00,
         1.3572e+00],
        [1.5845e+00, 0.0000e+00, 1.5280e+00, 3.7957e+05, 3.8578e+05, 1.4253e+00,
         1.5926e+00, 4.0561e+05, 3.8475e+05, 1.5257e+00, 3.9766e+05, 1.8710e+00,
         1.5132e+00, 3.8761e+05, 3.9141e+05, 1.4854e+00, 3.8171e+05, 1.4726e+00,
         1.4658e+00],
        [1.4897e+00, 1.5280e+00, 0.0000e+00, 3.7955e+05, 3.8582e+05, 1.4724e+00,
         1.3617e+00, 4.0560e+05, 3.8467e+05, 1.6598e+00, 3.9767e+05, 1.4687e+00,
         1.5090e+00, 3.8760e+05, 3.9143e+05, 1.4592e+00, 3.8172e+05, 1.4591e+00,
         1.3840e+00],
        [3.7955e+05, 3.7957e+05, 3.7955e+05, 0.0000e+00, 7.6871e+05, 3.7954e+05,
         3.7956e+05, 7.5899e+05, 7.6533e+05, 3.7957e+05, 7.9667e+05, 3.7955e+05,
         3.7956e+05, 7.6227e+05, 7.7513e+05, 3.7957e+05, 7.5930e+05, 3.7956e+05,
         3.7958e+05],
        [3.8580e+05, 3.8578e+05, 3.8582e+05, 7.6871e+05, 0.0000e+00, 3.8582e+05,
         3.8582e+05, 7.7542e+05, 7.6647e+05, 3.8579e+05, 7.7136e+05, 3.8586e+05,
         3.8581e+05, 7.7365e+05, 7.7512e+05, 3.8583e+05, 7.7025e+05, 3.8580e+05,
         3.8581e+05],
        [1.5171e+00, 1.4253e+00, 1.4724e+00, 3.7954e+05, 3.8582e+05, 0.0000e+00,
         1.4680e+00, 4.0562e+05, 3.8469e+05, 1.5754e+00, 3.9761e+05, 1.8531e+00,
         1.5271e+00, 3.8760e+05, 3.9141e+05, 1.3575e+00, 3.8170e+05, 1.4320e+00,
         1.4093e+00],
        [1.5434e+00, 1.5926e+00, 1.3617e+00, 3.7956e+05, 3.8582e+05, 1.4680e+00,
         0.0000e+00, 4.0559e+05, 3.8472e+05, 1.5257e+00, 3.9768e+05, 1.5855e+00,
         1.5332e+00, 3.8757e+05, 3.9142e+05, 1.4194e+00, 3.8171e+05, 1.4673e+00,
         1.3947e+00],
        [4.0561e+05, 4.0561e+05, 4.0560e+05, 7.5899e+05, 7.7542e+05, 4.0562e+05,
         4.0559e+05, 0.0000e+00, 8.0771e+05, 4.0560e+05, 8.3100e+05, 4.0558e+05,
         4.0560e+05, 7.9637e+05, 7.9945e+05, 4.0558e+05, 8.1222e+05, 4.0561e+05,
         4.0560e+05],
        [3.8468e+05, 3.8475e+05, 3.8467e+05, 7.6533e+05, 7.6647e+05, 3.8469e+05,
         3.8472e+05, 8.0771e+05, 0.0000e+00, 3.8471e+05, 8.1279e+05, 3.8472e+05,
         3.8473e+05, 7.6564e+05, 7.9185e+05, 3.8467e+05, 7.7544e+05, 3.8469e+05,
         3.8472e+05],
        [1.7377e+00, 1.5257e+00, 1.6598e+00, 3.7957e+05, 3.8579e+05, 1.5754e+00,
         1.5257e+00, 4.0560e+05, 3.8471e+05, 0.0000e+00, 3.9764e+05, 1.8782e+00,
         1.5504e+00, 3.8761e+05, 3.9144e+05, 1.5303e+00, 3.8175e+05, 1.5023e+00,
         1.5680e+00],
        [3.9768e+05, 3.9766e+05, 3.9767e+05, 7.9667e+05, 7.7136e+05, 3.9761e+05,
         3.9768e+05, 8.3100e+05, 8.1279e+05, 3.9764e+05, 0.0000e+00, 3.9770e+05,
         3.9769e+05, 7.7604e+05, 8.0133e+05, 3.9767e+05, 7.4867e+05, 3.9765e+05,
         3.9765e+05],
        [1.5541e+00, 1.8710e+00, 1.4687e+00, 3.7955e+05, 3.8586e+05, 1.8531e+00,
         1.5855e+00, 4.0558e+05, 3.8472e+05, 1.8782e+00, 3.9770e+05, 0.0000e+00,
         1.8533e+00, 3.8758e+05, 3.9140e+05, 1.6330e+00, 3.8169e+05, 1.7622e+00,
         1.6602e+00],
        [1.4854e+00, 1.5132e+00, 1.5090e+00, 3.7956e+05, 3.8581e+05, 1.5271e+00,
         1.5332e+00, 4.0560e+05, 3.8473e+05, 1.5504e+00, 3.9769e+05, 1.8533e+00,
         0.0000e+00, 3.8756e+05, 3.9144e+05, 1.4660e+00, 3.8173e+05, 1.5555e+00,
         1.3671e+00],
        [3.8759e+05, 3.8761e+05, 3.8760e+05, 7.6227e+05, 7.7365e+05, 3.8760e+05,
         3.8757e+05, 7.9637e+05, 7.6564e+05, 3.8761e+05, 7.7604e+05, 3.8758e+05,
         3.8756e+05, 0.0000e+00, 7.7113e+05, 3.8760e+05, 7.6129e+05, 3.8760e+05,
         3.8761e+05],
        [3.9141e+05, 3.9141e+05, 3.9143e+05, 7.7513e+05, 7.7512e+05, 3.9141e+05,
         3.9142e+05, 7.9945e+05, 7.9185e+05, 3.9144e+05, 8.0133e+05, 3.9140e+05,
         3.9144e+05, 7.7113e+05, 0.0000e+00, 3.9141e+05, 7.6541e+05, 3.9142e+05,
         3.9143e+05],
        [1.4750e+00, 1.4854e+00, 1.4592e+00, 3.7957e+05, 3.8583e+05, 1.3575e+00,
         1.4194e+00, 4.0558e+05, 3.8467e+05, 1.5303e+00, 3.9767e+05, 1.6330e+00,
         1.4660e+00, 3.8760e+05, 3.9141e+05, 0.0000e+00, 3.8170e+05, 1.5295e+00,
         1.4623e+00],
        [3.8170e+05, 3.8171e+05, 3.8172e+05, 7.5930e+05, 7.7025e+05, 3.8170e+05,
         3.8171e+05, 8.1222e+05, 7.7544e+05, 3.8175e+05, 7.4867e+05, 3.8169e+05,
         3.8173e+05, 7.6129e+05, 7.6541e+05, 3.8170e+05, 0.0000e+00, 3.8168e+05,
         3.8170e+05],
        [1.5592e+00, 1.4726e+00, 1.4591e+00, 3.7956e+05, 3.8580e+05, 1.4320e+00,
         1.4673e+00, 4.0561e+05, 3.8469e+05, 1.5023e+00, 3.9765e+05, 1.7622e+00,
         1.5555e+00, 3.8760e+05, 3.9142e+05, 1.5295e+00, 3.8168e+05, 0.0000e+00,
         1.4245e+00],
        [1.3572e+00, 1.4658e+00, 1.3840e+00, 3.7958e+05, 3.8581e+05, 1.4093e+00,
         1.3947e+00, 4.0560e+05, 3.8472e+05, 1.5680e+00, 3.9765e+05, 1.6602e+00,
         1.3671e+00, 3.8761e+05, 3.9143e+05, 1.4623e+00, 3.8170e+05, 1.4245e+00,
         0.0000e+00]])
Krum scores: ['1.51', '1.51', '1.46', '379555.16', '385805.09', '1.46', '1.48', '405597.31', '384695.19', '1.58', '397656.31', '1.69', '1.50', '387590.84', '391415.00', '1.46', '381700.66', '1.49', '1.43']
Selected index: 18
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0163s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:02...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:02, End: 2025-07-22 15:31:02)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.4608e+00, 1.4885e+00, 4.0617e+05, 3.8744e+05, 1.4993e+00,
         1.4487e+00, 3.8362e+05, 3.9472e+05, 1.5993e+00, 3.9994e+05, 1.3925e+00,
         1.4365e+00, 3.9606e+05, 1.4186e+00, 1.3105e+00, 4.0062e+05, 1.4789e+00],
        [1.4608e+00, 0.0000e+00, 1.4781e+00, 4.0619e+05, 3.8744e+05, 1.3675e+00,
         1.4778e+00, 3.8363e+05, 3.9466e+05, 1.4139e+00, 3.9995e+05, 1.5925e+00,
         1.4418e+00, 3.9605e+05, 1.3989e+00, 1.5887e+00, 4.0064e+05, 1.4090e+00],
        [1.4885e+00, 1.4781e+00, 0.0000e+00, 4.0618e+05, 3.8747e+05, 1.4528e+00,
         1.2809e+00, 3.8364e+05, 3.9468e+05, 1.5577e+00, 3.9994e+05, 1.2375e+00,
         1.4583e+00, 3.9607e+05, 1.4139e+00, 1.2631e+00, 4.0059e+05, 1.4027e+00],
        [4.0617e+05, 4.0619e+05, 4.0618e+05, 0.0000e+00, 7.7614e+05, 4.0620e+05,
         4.0618e+05, 7.8642e+05, 8.0146e+05, 4.0619e+05, 8.0127e+05, 4.0616e+05,
         4.0619e+05, 7.9972e+05, 4.0618e+05, 4.0616e+05, 8.0638e+05, 4.0619e+05],
        [3.8744e+05, 3.8744e+05, 3.8747e+05, 7.7614e+05, 0.0000e+00, 3.8751e+05,
         3.8745e+05, 7.7091e+05, 7.8398e+05, 3.8746e+05, 8.1358e+05, 3.8748e+05,
         3.8747e+05, 7.7851e+05, 3.8749e+05, 3.8748e+05, 7.7112e+05, 3.8745e+05],
        [1.4993e+00, 1.3675e+00, 1.4528e+00, 4.0620e+05, 3.8751e+05, 0.0000e+00,
         1.3923e+00, 3.8364e+05, 3.9467e+05, 1.4026e+00, 3.9996e+05, 1.6183e+00,
         1.4920e+00, 3.9608e+05, 1.3516e+00, 1.5104e+00, 4.0059e+05, 1.3512e+00],
        [1.4487e+00, 1.4778e+00, 1.2809e+00, 4.0618e+05, 3.8745e+05, 1.3923e+00,
         0.0000e+00, 3.8365e+05, 3.9469e+05, 1.4117e+00, 3.9993e+05, 1.3490e+00,
         1.4411e+00, 3.9609e+05, 1.3471e+00, 1.3154e+00, 4.0062e+05, 1.4077e+00],
        [3.8362e+05, 3.8363e+05, 3.8364e+05, 7.8642e+05, 7.7091e+05, 3.8364e+05,
         3.8365e+05, 0.0000e+00, 7.7341e+05, 3.8360e+05, 7.7988e+05, 3.8364e+05,
         3.8364e+05, 7.7273e+05, 3.8364e+05, 3.8361e+05, 7.9172e+05, 3.8361e+05],
        [3.9472e+05, 3.9466e+05, 3.9468e+05, 8.0146e+05, 7.8398e+05, 3.9467e+05,
         3.9469e+05, 7.7341e+05, 0.0000e+00, 3.9468e+05, 7.8287e+05, 3.9469e+05,
         3.9470e+05, 7.8440e+05, 3.9472e+05, 3.9470e+05, 7.9372e+05, 3.9470e+05],
        [1.5993e+00, 1.4139e+00, 1.5577e+00, 4.0619e+05, 3.8746e+05, 1.4026e+00,
         1.4117e+00, 3.8360e+05, 3.9468e+05, 0.0000e+00, 3.9994e+05, 1.5471e+00,
         1.4322e+00, 3.9607e+05, 1.4245e+00, 1.5602e+00, 4.0061e+05, 1.3540e+00],
        [3.9994e+05, 3.9995e+05, 3.9994e+05, 8.0127e+05, 8.1358e+05, 3.9996e+05,
         3.9993e+05, 7.7988e+05, 7.8287e+05, 3.9994e+05, 0.0000e+00, 3.9994e+05,
         3.9993e+05, 8.0036e+05, 3.9994e+05, 3.9993e+05, 8.1382e+05, 3.9994e+05],
        [1.3925e+00, 1.5925e+00, 1.2375e+00, 4.0616e+05, 3.8748e+05, 1.6183e+00,
         1.3490e+00, 3.8364e+05, 3.9469e+05, 1.5471e+00, 3.9994e+05, 0.0000e+00,
         1.5750e+00, 3.9607e+05, 1.4867e+00, 1.2368e+00, 4.0060e+05, 1.4937e+00],
        [1.4365e+00, 1.4418e+00, 1.4583e+00, 4.0619e+05, 3.8747e+05, 1.4920e+00,
         1.4411e+00, 3.8364e+05, 3.9470e+05, 1.4322e+00, 3.9993e+05, 1.5750e+00,
         0.0000e+00, 3.9606e+05, 1.4417e+00, 1.4260e+00, 4.0061e+05, 1.5008e+00],
        [3.9606e+05, 3.9605e+05, 3.9607e+05, 7.9972e+05, 7.7851e+05, 3.9608e+05,
         3.9609e+05, 7.7273e+05, 7.8440e+05, 3.9607e+05, 8.0036e+05, 3.9607e+05,
         3.9606e+05, 0.0000e+00, 3.9603e+05, 3.9603e+05, 7.8546e+05, 3.9606e+05],
        [1.4186e+00, 1.3989e+00, 1.4139e+00, 4.0618e+05, 3.8749e+05, 1.3516e+00,
         1.3471e+00, 3.8364e+05, 3.9472e+05, 1.4245e+00, 3.9994e+05, 1.4867e+00,
         1.4417e+00, 3.9603e+05, 0.0000e+00, 1.4566e+00, 4.0062e+05, 1.4664e+00],
        [1.3105e+00, 1.5887e+00, 1.2631e+00, 4.0616e+05, 3.8748e+05, 1.5104e+00,
         1.3154e+00, 3.8361e+05, 3.9470e+05, 1.5602e+00, 3.9993e+05, 1.2368e+00,
         1.4260e+00, 3.9603e+05, 1.4566e+00, 0.0000e+00, 4.0062e+05, 1.5171e+00],
        [4.0062e+05, 4.0064e+05, 4.0059e+05, 8.0638e+05, 7.7112e+05, 4.0059e+05,
         4.0062e+05, 7.9172e+05, 7.9372e+05, 4.0061e+05, 8.1382e+05, 4.0060e+05,
         4.0061e+05, 7.8546e+05, 4.0062e+05, 4.0062e+05, 0.0000e+00, 4.0061e+05],
        [1.4789e+00, 1.4090e+00, 1.4027e+00, 4.0619e+05, 3.8745e+05, 1.3512e+00,
         1.4077e+00, 3.8361e+05, 3.9470e+05, 1.3540e+00, 3.9994e+05, 1.4937e+00,
         1.5008e+00, 3.9606e+05, 1.4664e+00, 1.5171e+00, 4.0061e+05, 0.0000e+00]])
Krum scores: ['1.44', '1.45', '1.39', '406175.91', '387460.50', '1.42', '1.38', '383625.69', '394685.66', '1.46', '399936.31', '1.43', '1.45', '396055.00', '1.41', '1.40', '400608.31', '1.43']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0212s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:02...
global Accuracy on shared test data: 77.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:02, End: 2025-07-22 15:31:02)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 19, 17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.9605e+05, 3.9030e+05, 1.4459e+00, 1.5541e+00, 3.9516e+05,
         1.5792e+00, 1.3813e+00, 1.3510e+00, 3.9641e+05, 3.9651e+05, 1.3281e+00,
         1.2792e+00, 3.9206e+05, 1.2996e+00],
        [3.9605e+05, 0.0000e+00, 7.8007e+05, 3.9605e+05, 3.9607e+05, 7.8270e+05,
         3.9607e+05, 3.9607e+05, 3.9605e+05, 7.9810e+05, 7.9763e+05, 3.9603e+05,
         3.9607e+05, 7.9907e+05, 3.9605e+05],
        [3.9030e+05, 7.8007e+05, 0.0000e+00, 3.9035e+05, 3.9031e+05, 7.8676e+05,
         3.9032e+05, 3.9031e+05, 3.9031e+05, 8.0151e+05, 7.7186e+05, 3.9031e+05,
         3.9030e+05, 7.6737e+05, 3.9034e+05],
        [1.4459e+00, 3.9605e+05, 3.9035e+05, 0.0000e+00, 1.7555e+00, 3.9516e+05,
         1.4673e+00, 1.6350e+00, 1.4551e+00, 3.9641e+05, 3.9649e+05, 1.3076e+00,
         1.5034e+00, 3.9206e+05, 1.5620e+00],
        [1.5541e+00, 3.9607e+05, 3.9031e+05, 1.7555e+00, 0.0000e+00, 3.9515e+05,
         1.7955e+00, 1.3435e+00, 1.6719e+00, 3.9642e+05, 3.9654e+05, 1.6059e+00,
         1.3117e+00, 3.9208e+05, 1.2892e+00],
        [3.9516e+05, 7.8270e+05, 7.8676e+05, 3.9516e+05, 3.9515e+05, 0.0000e+00,
         3.9515e+05, 3.9515e+05, 3.9517e+05, 7.8138e+05, 8.1345e+05, 3.9519e+05,
         3.9519e+05, 7.9345e+05, 3.9516e+05],
        [1.5792e+00, 3.9607e+05, 3.9032e+05, 1.4673e+00, 1.7955e+00, 3.9515e+05,
         0.0000e+00, 1.5590e+00, 1.3779e+00, 3.9640e+05, 3.9650e+05, 1.3959e+00,
         1.5613e+00, 3.9209e+05, 1.5868e+00],
        [1.3813e+00, 3.9607e+05, 3.9031e+05, 1.6350e+00, 1.3435e+00, 3.9515e+05,
         1.5590e+00, 0.0000e+00, 1.5506e+00, 3.9639e+05, 3.9648e+05, 1.4000e+00,
         1.2505e+00, 3.9209e+05, 1.2139e+00],
        [1.3510e+00, 3.9605e+05, 3.9031e+05, 1.4551e+00, 1.6719e+00, 3.9517e+05,
         1.3779e+00, 1.5506e+00, 0.0000e+00, 3.9639e+05, 3.9652e+05, 1.3320e+00,
         1.3613e+00, 3.9205e+05, 1.4257e+00],
        [3.9641e+05, 7.9810e+05, 8.0151e+05, 3.9641e+05, 3.9642e+05, 7.8138e+05,
         3.9640e+05, 3.9639e+05, 3.9639e+05, 0.0000e+00, 7.6141e+05, 3.9639e+05,
         3.9642e+05, 8.0136e+05, 3.9640e+05],
        [3.9651e+05, 7.9763e+05, 7.7186e+05, 3.9649e+05, 3.9654e+05, 8.1345e+05,
         3.9650e+05, 3.9648e+05, 3.9652e+05, 7.6141e+05, 0.0000e+00, 3.9649e+05,
         3.9650e+05, 7.8130e+05, 3.9651e+05],
        [1.3281e+00, 3.9603e+05, 3.9031e+05, 1.3076e+00, 1.6059e+00, 3.9519e+05,
         1.3959e+00, 1.4000e+00, 1.3320e+00, 3.9639e+05, 3.9649e+05, 0.0000e+00,
         1.3991e+00, 3.9207e+05, 1.3883e+00],
        [1.2792e+00, 3.9607e+05, 3.9030e+05, 1.5034e+00, 1.3117e+00, 3.9519e+05,
         1.5613e+00, 1.2505e+00, 1.3613e+00, 3.9642e+05, 3.9650e+05, 1.3991e+00,
         0.0000e+00, 3.9208e+05, 1.1995e+00],
        [3.9206e+05, 7.9907e+05, 7.6737e+05, 3.9206e+05, 3.9208e+05, 7.9345e+05,
         3.9209e+05, 3.9209e+05, 3.9205e+05, 8.0136e+05, 7.8130e+05, 3.9207e+05,
         3.9208e+05, 0.0000e+00, 3.9208e+05],
        [1.2996e+00, 3.9605e+05, 3.9034e+05, 1.5620e+00, 1.2892e+00, 3.9516e+05,
         1.5868e+00, 1.2139e+00, 1.4257e+00, 3.9640e+05, 3.9651e+05, 1.3883e+00,
         1.1995e+00, 3.9208e+05, 0.0000e+00]])
Krum scores: ['1.38', '396051.88', '390307.78', '1.48', '1.50', '395156.34', '1.50', '1.39', '1.41', '396400.59', '396497.31', '1.36', '1.33', '392069.53', '1.34']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 19, 17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0312s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:03...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:03, End: 2025-07-22 15:31:03)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 19, 17, 1, 20, 18, 15, 4, 3, 13, 11, 10, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.2603e+00, 3.9191e+05, 4.0567e+05, 1.2897e+00, 4.0090e+05,
         3.9557e+05, 3.8766e+05, 1.2217e+00, 1.2186e+00, 3.9509e+05, 1.2623e+00,
         1.4854e+00, 3.9010e+05],
        [1.2603e+00, 0.0000e+00, 3.9189e+05, 4.0566e+05, 1.2370e+00, 4.0091e+05,
         3.9556e+05, 3.8765e+05, 1.1461e+00, 1.2237e+00, 3.9506e+05, 1.2409e+00,
         1.4223e+00, 3.9010e+05],
        [3.9191e+05, 3.9189e+05, 0.0000e+00, 8.1037e+05, 3.9191e+05, 7.8360e+05,
         7.8625e+05, 7.8863e+05, 3.9188e+05, 3.9189e+05, 7.6012e+05, 3.9191e+05,
         3.9190e+05, 7.8498e+05],
        [4.0567e+05, 4.0566e+05, 8.1037e+05, 0.0000e+00, 4.0568e+05, 7.9166e+05,
         7.9778e+05, 7.8801e+05, 4.0567e+05, 4.0567e+05, 8.0461e+05, 4.0567e+05,
         4.0567e+05, 7.9265e+05],
        [1.2897e+00, 1.2370e+00, 3.9191e+05, 4.0568e+05, 0.0000e+00, 4.0094e+05,
         3.9557e+05, 3.8767e+05, 1.4342e+00, 1.3024e+00, 3.9508e+05, 1.1699e+00,
         1.8663e+00, 3.9010e+05],
        [4.0090e+05, 4.0091e+05, 7.8360e+05, 7.9166e+05, 4.0094e+05, 0.0000e+00,
         7.9936e+05, 8.1178e+05, 4.0091e+05, 4.0094e+05, 8.0764e+05, 4.0091e+05,
         4.0093e+05, 7.8675e+05],
        [3.9557e+05, 3.9556e+05, 7.8625e+05, 7.9778e+05, 3.9557e+05, 7.9936e+05,
         0.0000e+00, 7.8310e+05, 3.9557e+05, 3.9556e+05, 8.0896e+05, 3.9559e+05,
         3.9557e+05, 7.7335e+05],
        [3.8766e+05, 3.8765e+05, 7.8863e+05, 7.8801e+05, 3.8767e+05, 8.1178e+05,
         7.8310e+05, 0.0000e+00, 3.8766e+05, 3.8766e+05, 7.9443e+05, 3.8765e+05,
         3.8763e+05, 7.5941e+05],
        [1.2217e+00, 1.1461e+00, 3.9188e+05, 4.0567e+05, 1.4342e+00, 4.0091e+05,
         3.9557e+05, 3.8766e+05, 0.0000e+00, 1.3458e+00, 3.9507e+05, 1.3015e+00,
         1.3161e+00, 3.9009e+05],
        [1.2186e+00, 1.2237e+00, 3.9189e+05, 4.0567e+05, 1.3024e+00, 4.0094e+05,
         3.9556e+05, 3.8766e+05, 1.3458e+00, 0.0000e+00, 3.9510e+05, 1.2175e+00,
         1.6893e+00, 3.9011e+05],
        [3.9509e+05, 3.9506e+05, 7.6012e+05, 8.0461e+05, 3.9508e+05, 8.0764e+05,
         8.0896e+05, 7.9443e+05, 3.9507e+05, 3.9510e+05, 0.0000e+00, 3.9508e+05,
         3.9509e+05, 7.8917e+05],
        [1.2623e+00, 1.2409e+00, 3.9191e+05, 4.0567e+05, 1.1699e+00, 4.0091e+05,
         3.9559e+05, 3.8765e+05, 1.3015e+00, 1.2175e+00, 3.9508e+05, 0.0000e+00,
         1.7338e+00, 3.9012e+05],
        [1.4854e+00, 1.4223e+00, 3.9190e+05, 4.0567e+05, 1.8663e+00, 4.0093e+05,
         3.9557e+05, 3.8763e+05, 1.3161e+00, 1.6893e+00, 3.9509e+05, 1.7338e+00,
         0.0000e+00, 3.9010e+05],
        [3.9010e+05, 3.9010e+05, 7.8498e+05, 7.9265e+05, 3.9010e+05, 7.8675e+05,
         7.7335e+05, 7.5941e+05, 3.9009e+05, 3.9011e+05, 7.8917e+05, 3.9012e+05,
         3.9010e+05, 0.0000e+00]])
Krum scores: ['1.25', '1.22', '391893.91', '405665.12', '1.29', '400911.44', '395566.00', '387648.97', '1.27', '1.26', '395076.78', '1.24', '1.53', '390098.09']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 19, 17, 1, 20, 18, 15, 4, 3, 13, 11, 10, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0033s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:03...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:03, End: 2025-07-22 15:31:03)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3180e+00, 3.8205e+05, 3.8501e+05, 1.3164e+00, 1.3000e+00,
         3.8368e+05, 1.4398e+00, 3.9586e+05, 1.2231e+00, 1.2306e+00, 3.8201e+05,
         3.9148e+05, 1.2442e+00, 1.3285e+00, 1.2038e+00],
        [1.3180e+00, 0.0000e+00, 3.8204e+05, 3.8505e+05, 1.2406e+00, 1.5720e+00,
         3.8366e+05, 1.3102e+00, 3.9588e+05, 1.4516e+00, 1.2827e+00, 3.8200e+05,
         3.9149e+05, 1.2718e+00, 1.2996e+00, 1.4635e+00],
        [3.8205e+05, 3.8204e+05, 0.0000e+00, 7.6408e+05, 3.8204e+05, 3.8205e+05,
         7.5762e+05, 3.8202e+05, 7.8814e+05, 3.8202e+05, 3.8204e+05, 7.4870e+05,
         7.7595e+05, 3.8202e+05, 3.8204e+05, 3.8201e+05],
        [3.8501e+05, 3.8505e+05, 7.6408e+05, 0.0000e+00, 3.8501e+05, 3.8499e+05,
         7.5929e+05, 3.8502e+05, 7.8123e+05, 3.8501e+05, 3.8501e+05, 7.6193e+05,
         7.9093e+05, 3.8499e+05, 3.8501e+05, 3.8501e+05],
        [1.3164e+00, 1.2406e+00, 3.8204e+05, 3.8501e+05, 0.0000e+00, 1.5052e+00,
         3.8366e+05, 1.3354e+00, 3.9586e+05, 1.4485e+00, 1.3370e+00, 3.8203e+05,
         3.9148e+05, 1.2554e+00, 1.2680e+00, 1.4022e+00],
        [1.3000e+00, 1.5720e+00, 3.8205e+05, 3.8499e+05, 1.5052e+00, 0.0000e+00,
         3.8369e+05, 1.5058e+00, 3.9590e+05, 1.1429e+00, 1.4508e+00, 3.8202e+05,
         3.9153e+05, 1.3942e+00, 1.4709e+00, 1.1733e+00],
        [3.8368e+05, 3.8366e+05, 7.5762e+05, 7.5929e+05, 3.8366e+05, 3.8369e+05,
         0.0000e+00, 3.8364e+05, 7.9012e+05, 3.8365e+05, 3.8366e+05, 7.5661e+05,
         7.6690e+05, 3.8365e+05, 3.8366e+05, 3.8367e+05],
        [1.4398e+00, 1.3102e+00, 3.8202e+05, 3.8502e+05, 1.3354e+00, 1.5058e+00,
         3.8364e+05, 0.0000e+00, 3.9589e+05, 1.3630e+00, 1.3137e+00, 3.8204e+05,
         3.9150e+05, 1.3068e+00, 1.2601e+00, 1.4994e+00],
        [3.9586e+05, 3.9588e+05, 7.8814e+05, 7.8123e+05, 3.9586e+05, 3.9590e+05,
         7.9012e+05, 3.9589e+05, 0.0000e+00, 3.9587e+05, 3.9590e+05, 7.8639e+05,
         7.9138e+05, 3.9585e+05, 3.9585e+05, 3.9589e+05],
        [1.2231e+00, 1.4516e+00, 3.8202e+05, 3.8501e+05, 1.4485e+00, 1.1429e+00,
         3.8365e+05, 1.3630e+00, 3.9587e+05, 0.0000e+00, 1.3738e+00, 3.8200e+05,
         3.9149e+05, 1.2720e+00, 1.3314e+00, 1.1259e+00],
        [1.2306e+00, 1.2827e+00, 3.8204e+05, 3.8501e+05, 1.3370e+00, 1.4508e+00,
         3.8366e+05, 1.3137e+00, 3.9590e+05, 1.3738e+00, 0.0000e+00, 3.8200e+05,
         3.9149e+05, 1.2402e+00, 1.3092e+00, 1.3040e+00],
        [3.8201e+05, 3.8200e+05, 7.4870e+05, 7.6193e+05, 3.8203e+05, 3.8202e+05,
         7.5661e+05, 3.8204e+05, 7.8639e+05, 3.8200e+05, 3.8200e+05, 0.0000e+00,
         7.7921e+05, 3.8202e+05, 3.8201e+05, 3.8204e+05],
        [3.9148e+05, 3.9149e+05, 7.7595e+05, 7.9093e+05, 3.9148e+05, 3.9153e+05,
         7.6690e+05, 3.9150e+05, 7.9138e+05, 3.9149e+05, 3.9149e+05, 7.7921e+05,
         0.0000e+00, 3.9147e+05, 3.9146e+05, 3.9149e+05],
        [1.2442e+00, 1.2718e+00, 3.8202e+05, 3.8499e+05, 1.2554e+00, 1.3942e+00,
         3.8365e+05, 1.3068e+00, 3.9585e+05, 1.2720e+00, 1.2402e+00, 3.8202e+05,
         3.9147e+05, 0.0000e+00, 1.3010e+00, 1.3154e+00],
        [1.3285e+00, 1.2996e+00, 3.8204e+05, 3.8501e+05, 1.2680e+00, 1.4709e+00,
         3.8366e+05, 1.2601e+00, 3.9585e+05, 1.3314e+00, 1.3092e+00, 3.8201e+05,
         3.9146e+05, 1.3010e+00, 0.0000e+00, 1.3482e+00],
        [1.2038e+00, 1.4635e+00, 3.8201e+05, 3.8501e+05, 1.4022e+00, 1.1733e+00,
         3.8367e+05, 1.4994e+00, 3.9589e+05, 1.1259e+00, 1.3040e+00, 3.8204e+05,
         3.9149e+05, 1.3154e+00, 1.3482e+00, 0.0000e+00]])
Krum scores: ['1.27', '1.33', '382029.84', '385004.53', '1.33', '1.37', '383657.25', '1.35', '395867.59', '1.29', '1.30', '382010.88', '391482.66', '1.28', '1.31', '1.29']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:04...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[187  50]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:04, End: 2025-07-22 15:31:04)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 19, 17, 1, 9, 18, 4, 3, 11, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.7602e+00, 3.7811e+05, 3.8948e+05, 1.6734e+00, 1.2592e+00,
         3.8789e+05, 1.2783e+00, 1.6290e+00, 1.5635e+00, 1.1398e+00, 3.7782e+05,
         1.6752e+00, 1.2396e+00],
        [1.7602e+00, 0.0000e+00, 3.7807e+05, 3.8946e+05, 1.1807e+00, 1.4911e+00,
         3.8794e+05, 1.4003e+00, 1.2390e+00, 1.2204e+00, 1.5709e+00, 3.7776e+05,
         1.2652e+00, 1.3595e+00],
        [3.7811e+05, 3.7807e+05, 0.0000e+00, 7.6138e+05, 3.7809e+05, 3.7807e+05,
         7.6811e+05, 3.7803e+05, 3.7807e+05, 3.7807e+05, 3.7808e+05, 7.7845e+05,
         3.7806e+05, 3.7805e+05],
        [3.8948e+05, 3.8946e+05, 7.6138e+05, 0.0000e+00, 3.8947e+05, 3.8947e+05,
         7.7131e+05, 3.8948e+05, 3.8948e+05, 3.8945e+05, 3.8948e+05, 7.5236e+05,
         3.8946e+05, 3.8948e+05],
        [1.6734e+00, 1.1807e+00, 3.7809e+05, 3.8947e+05, 0.0000e+00, 1.4016e+00,
         3.8791e+05, 1.3432e+00, 1.2448e+00, 1.2182e+00, 1.5291e+00, 3.7777e+05,
         1.1641e+00, 1.2814e+00],
        [1.2592e+00, 1.4911e+00, 3.7807e+05, 3.8947e+05, 1.4016e+00, 0.0000e+00,
         3.8789e+05, 1.0895e+00, 1.3765e+00, 1.3256e+00, 1.0070e+00, 3.7781e+05,
         1.3311e+00, 1.0454e+00],
        [3.8789e+05, 3.8794e+05, 7.6811e+05, 7.7131e+05, 3.8791e+05, 3.8789e+05,
         0.0000e+00, 3.8793e+05, 3.8793e+05, 3.8792e+05, 3.8788e+05, 7.5770e+05,
         3.8792e+05, 3.8791e+05],
        [1.2783e+00, 1.4003e+00, 3.7803e+05, 3.8948e+05, 1.3432e+00, 1.0895e+00,
         3.8793e+05, 0.0000e+00, 1.3233e+00, 1.2659e+00, 1.1029e+00, 3.7780e+05,
         1.2290e+00, 1.0637e+00],
        [1.6290e+00, 1.2390e+00, 3.7807e+05, 3.8948e+05, 1.2448e+00, 1.3765e+00,
         3.8793e+05, 1.3233e+00, 0.0000e+00, 1.2210e+00, 1.4247e+00, 3.7777e+05,
         1.2221e+00, 1.2232e+00],
        [1.5635e+00, 1.2204e+00, 3.7807e+05, 3.8945e+05, 1.2182e+00, 1.3256e+00,
         3.8792e+05, 1.2659e+00, 1.2210e+00, 0.0000e+00, 1.4153e+00, 3.7775e+05,
         1.2560e+00, 1.2599e+00],
        [1.1398e+00, 1.5709e+00, 3.7808e+05, 3.8948e+05, 1.5291e+00, 1.0070e+00,
         3.8788e+05, 1.1029e+00, 1.4247e+00, 1.4153e+00, 0.0000e+00, 3.7777e+05,
         1.4112e+00, 1.0638e+00],
        [3.7782e+05, 3.7776e+05, 7.7845e+05, 7.5236e+05, 3.7777e+05, 3.7781e+05,
         7.5770e+05, 3.7780e+05, 3.7777e+05, 3.7775e+05, 3.7777e+05, 0.0000e+00,
         3.7776e+05, 3.7780e+05],
        [1.6752e+00, 1.2652e+00, 3.7806e+05, 3.8946e+05, 1.1641e+00, 1.3311e+00,
         3.8792e+05, 1.2290e+00, 1.2221e+00, 1.2560e+00, 1.4112e+00, 3.7776e+05,
         0.0000e+00, 1.1902e+00],
        [1.2396e+00, 1.3595e+00, 3.7805e+05, 3.8948e+05, 1.2814e+00, 1.0454e+00,
         3.8791e+05, 1.0637e+00, 1.2232e+00, 1.2599e+00, 1.0638e+00, 3.7780e+05,
         1.1902e+00, 0.0000e+00]])
Krum scores: ['1.43', '1.34', '378063.94', '389468.69', '1.30', '1.23', '387906.44', '1.21', '1.28', '1.27', '1.26', '377772.56', '1.26', '1.17']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']], selected_client_indices: [5, 7, 19, 17, 1, 9, 18, 4, 3, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:04...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:04, End: 2025-07-22 15:31:04)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 19, 17, 9, 20, 18, 8, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0994e+00, 3.8881e+05, 3.8461e+05, 1.1008e+00, 3.9829e+05,
         3.9555e+05, 1.6190e+00, 1.1289e+00, 3.9311e+05, 3.8658e+05, 1.3752e+00,
         9.9310e-01, 3.8284e+05, 1.4769e+00, 1.0994e+00],
        [1.0994e+00, 0.0000e+00, 3.8879e+05, 3.8460e+05, 9.7139e-01, 3.9828e+05,
         3.9554e+05, 1.4075e+00, 9.9197e-01, 3.9313e+05, 3.8656e+05, 1.2708e+00,
         9.5336e-01, 3.8284e+05, 1.2553e+00, 1.1861e+00],
        [3.8881e+05, 3.8879e+05, 0.0000e+00, 7.6732e+05, 3.8880e+05, 7.8598e+05,
         7.9337e+05, 3.8881e+05, 3.8877e+05, 7.5980e+05, 7.8596e+05, 3.8880e+05,
         3.8881e+05, 7.6555e+05, 3.8881e+05, 3.8880e+05],
        [3.8461e+05, 3.8460e+05, 7.6732e+05, 0.0000e+00, 3.8461e+05, 7.8397e+05,
         7.8846e+05, 3.8462e+05, 3.8462e+05, 7.7457e+05, 7.5826e+05, 3.8464e+05,
         3.8460e+05, 7.8034e+05, 3.8460e+05, 3.8458e+05],
        [1.1008e+00, 9.7139e-01, 3.8880e+05, 3.8461e+05, 0.0000e+00, 3.9832e+05,
         3.9552e+05, 1.3514e+00, 1.0250e+00, 3.9311e+05, 3.8662e+05, 1.2053e+00,
         9.7776e-01, 3.8283e+05, 1.2785e+00, 1.1535e+00],
        [3.9829e+05, 3.9828e+05, 7.8598e+05, 7.8397e+05, 3.9832e+05, 0.0000e+00,
         8.1605e+05, 3.9828e+05, 3.9831e+05, 8.0034e+05, 7.8813e+05, 3.9831e+05,
         3.9830e+05, 7.9119e+05, 3.9833e+05, 3.9828e+05],
        [3.9555e+05, 3.9554e+05, 7.9337e+05, 7.8846e+05, 3.9552e+05, 8.1605e+05,
         0.0000e+00, 3.9553e+05, 3.9554e+05, 8.0579e+05, 7.8101e+05, 3.9555e+05,
         3.9553e+05, 7.8937e+05, 3.9555e+05, 3.9553e+05],
        [1.6190e+00, 1.4075e+00, 3.8881e+05, 3.8462e+05, 1.3514e+00, 3.9828e+05,
         3.9553e+05, 0.0000e+00, 1.2623e+00, 3.9315e+05, 3.8659e+05, 1.2009e+00,
         1.5081e+00, 3.8282e+05, 1.1587e+00, 1.8481e+00],
        [1.1289e+00, 9.9197e-01, 3.8877e+05, 3.8462e+05, 1.0250e+00, 3.9831e+05,
         3.9554e+05, 1.2623e+00, 0.0000e+00, 3.9316e+05, 3.8659e+05, 1.2049e+00,
         1.0555e+00, 3.8281e+05, 1.1699e+00, 1.2290e+00],
        [3.9311e+05, 3.9313e+05, 7.5980e+05, 7.7457e+05, 3.9311e+05, 8.0034e+05,
         8.0579e+05, 3.9315e+05, 3.9316e+05, 0.0000e+00, 7.8797e+05, 3.9312e+05,
         3.9315e+05, 7.8184e+05, 3.9315e+05, 3.9312e+05],
        [3.8658e+05, 3.8656e+05, 7.8596e+05, 7.5826e+05, 3.8662e+05, 7.8813e+05,
         7.8101e+05, 3.8659e+05, 3.8659e+05, 7.8797e+05, 0.0000e+00, 3.8660e+05,
         3.8657e+05, 7.6934e+05, 3.8660e+05, 3.8659e+05],
        [1.3752e+00, 1.2708e+00, 3.8880e+05, 3.8464e+05, 1.2053e+00, 3.9831e+05,
         3.9555e+05, 1.2009e+00, 1.2049e+00, 3.9312e+05, 3.8660e+05, 0.0000e+00,
         1.3325e+00, 3.8284e+05, 1.2064e+00, 1.6295e+00],
        [9.9310e-01, 9.5336e-01, 3.8881e+05, 3.8460e+05, 9.7776e-01, 3.9830e+05,
         3.9553e+05, 1.5081e+00, 1.0555e+00, 3.9315e+05, 3.8657e+05, 1.3325e+00,
         0.0000e+00, 3.8284e+05, 1.3750e+00, 1.0637e+00],
        [3.8284e+05, 3.8284e+05, 7.6555e+05, 7.8034e+05, 3.8283e+05, 7.9119e+05,
         7.8937e+05, 3.8282e+05, 3.8281e+05, 7.8184e+05, 7.6934e+05, 3.8284e+05,
         3.8284e+05, 0.0000e+00, 3.8283e+05, 3.8285e+05],
        [1.4769e+00, 1.2553e+00, 3.8881e+05, 3.8460e+05, 1.2785e+00, 3.9833e+05,
         3.9555e+05, 1.1587e+00, 1.1699e+00, 3.9315e+05, 3.8660e+05, 1.2064e+00,
         1.3750e+00, 3.8283e+05, 0.0000e+00, 1.6433e+00],
        [1.0994e+00, 1.1861e+00, 3.8880e+05, 3.8458e+05, 1.1535e+00, 3.9828e+05,
         3.9553e+05, 1.8481e+00, 1.2290e+00, 3.9312e+05, 3.8659e+05, 1.6295e+00,
         1.0637e+00, 3.8285e+05, 1.6433e+00, 0.0000e+00]])
Krum scores: ['1.18', '1.10', '388796.47', '384603.78', '1.10', '398293.31', '395534.78', '1.36', '1.12', '393127.03', '386583.56', '1.26', '1.11', '382828.16', '1.27', '1.29']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 2, 19, 17, 9, 20, 18, 8, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:05...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:05, End: 2025-07-22 15:31:05)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 1, 9, 20, 18, 8, 15, 4, 3, 10, 16, 6], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.4103e+00, 1.0153e+00, 1.3142e+00, 1.1164e+00, 3.8799e+05,
         3.9498e+05, 1.4428e+00, 4.0282e+05, 1.0092e+00, 1.2320e+00, 9.4965e-01,
         3.9363e+05, 1.2735e+00],
        [1.4103e+00, 0.0000e+00, 1.2723e+00, 1.1103e+00, 1.9269e+00, 3.8799e+05,
         3.9494e+05, 1.1873e+00, 4.0289e+05, 1.3146e+00, 1.1517e+00, 1.3966e+00,
         3.9361e+05, 1.1080e+00],
        [1.0153e+00, 1.2723e+00, 0.0000e+00, 1.2528e+00, 1.0942e+00, 3.8800e+05,
         3.9498e+05, 1.3348e+00, 4.0288e+05, 9.7916e-01, 1.2129e+00, 8.9879e-01,
         3.9363e+05, 1.1561e+00],
        [1.3142e+00, 1.1103e+00, 1.2528e+00, 0.0000e+00, 1.7830e+00, 3.8801e+05,
         3.9497e+05, 1.1790e+00, 4.0282e+05, 1.2810e+00, 1.1682e+00, 1.3092e+00,
         3.9360e+05, 1.0768e+00],
        [1.1164e+00, 1.9269e+00, 1.0942e+00, 1.7830e+00, 0.0000e+00, 3.8800e+05,
         3.9501e+05, 1.8709e+00, 4.0284e+05, 1.2865e+00, 1.6816e+00, 1.0304e+00,
         3.9363e+05, 1.7165e+00],
        [3.8799e+05, 3.8799e+05, 3.8800e+05, 3.8801e+05, 3.8800e+05, 0.0000e+00,
         7.7741e+05, 3.8798e+05, 7.8148e+05, 3.8798e+05, 3.8801e+05, 3.8799e+05,
         7.7276e+05, 3.8799e+05],
        [3.9498e+05, 3.9494e+05, 3.9498e+05, 3.9497e+05, 3.9501e+05, 7.7741e+05,
         0.0000e+00, 3.9495e+05, 7.9377e+05, 3.9497e+05, 3.9496e+05, 3.9498e+05,
         7.6670e+05, 3.9495e+05],
        [1.4428e+00, 1.1873e+00, 1.3348e+00, 1.1790e+00, 1.8709e+00, 3.8798e+05,
         3.9495e+05, 0.0000e+00, 4.0285e+05, 1.2325e+00, 1.1443e+00, 1.3866e+00,
         3.9362e+05, 1.0996e+00],
        [4.0282e+05, 4.0289e+05, 4.0288e+05, 4.0282e+05, 4.0284e+05, 7.8148e+05,
         7.9377e+05, 4.0285e+05, 0.0000e+00, 4.0281e+05, 4.0287e+05, 4.0284e+05,
         8.2906e+05, 4.0285e+05],
        [1.0092e+00, 1.3146e+00, 9.7916e-01, 1.2810e+00, 1.2865e+00, 3.8798e+05,
         3.9497e+05, 1.2325e+00, 4.0281e+05, 0.0000e+00, 1.1961e+00, 1.0239e+00,
         3.9361e+05, 1.1120e+00],
        [1.2320e+00, 1.1517e+00, 1.2129e+00, 1.1682e+00, 1.6816e+00, 3.8801e+05,
         3.9496e+05, 1.1443e+00, 4.0287e+05, 1.1961e+00, 0.0000e+00, 1.1817e+00,
         3.9362e+05, 1.0957e+00],
        [9.4965e-01, 1.3966e+00, 8.9879e-01, 1.3092e+00, 1.0304e+00, 3.8799e+05,
         3.9498e+05, 1.3866e+00, 4.0284e+05, 1.0239e+00, 1.1817e+00, 0.0000e+00,
         3.9361e+05, 1.2394e+00],
        [3.9363e+05, 3.9361e+05, 3.9363e+05, 3.9360e+05, 3.9363e+05, 7.7276e+05,
         7.6670e+05, 3.9362e+05, 8.2906e+05, 3.9361e+05, 3.9362e+05, 3.9361e+05,
         0.0000e+00, 3.9362e+05],
        [1.2735e+00, 1.1080e+00, 1.1561e+00, 1.0768e+00, 1.7165e+00, 3.8799e+05,
         3.9495e+05, 1.0996e+00, 4.0285e+05, 1.1120e+00, 1.0957e+00, 1.2394e+00,
         3.9362e+05, 0.0000e+00]])
Krum scores: ['1.17', '1.24', '1.11', '1.21', '1.45', '387991.53', '394963.22', '1.25', '402838.19', '1.14', '1.17', '1.13', '393615.72', '1.15']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 1, 9, 20, 18, 8, 15, 4, 3, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0222s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:06...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:06, End: 2025-07-22 15:31:06)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.3345e+00, 1.1430e+00, 3.8247e+05, 1.2671e+00, 4.0477e+05,
         4.0221e+05, 1.3204e+00, 4.0113e+05, 9.7282e-01, 1.1939e+00, 3.9002e+05,
         3.9451e+05, 1.1510e+00, 8.8528e-01, 4.0673e+05, 1.1986e+00, 8.6090e-01],
        [1.3345e+00, 0.0000e+00, 1.7787e+00, 3.8251e+05, 1.1038e+00, 4.0478e+05,
         4.0221e+05, 1.1096e+00, 4.0112e+05, 1.2752e+00, 1.1225e+00, 3.9003e+05,
         3.9455e+05, 1.1055e+00, 1.2979e+00, 4.0678e+05, 1.1296e+00, 1.4032e+00],
        [1.1430e+00, 1.7787e+00, 0.0000e+00, 3.8245e+05, 1.7521e+00, 4.0479e+05,
         4.0220e+05, 1.7342e+00, 4.0114e+05, 1.1372e+00, 1.6954e+00, 3.9006e+05,
         3.9453e+05, 1.5822e+00, 1.0043e+00, 4.0678e+05, 1.5569e+00, 1.0788e+00],
        [3.8247e+05, 3.8251e+05, 3.8245e+05, 0.0000e+00, 3.8249e+05, 7.9706e+05,
         7.7090e+05, 3.8249e+05, 7.5502e+05, 3.8247e+05, 3.8249e+05, 7.9066e+05,
         7.4431e+05, 3.8249e+05, 3.8247e+05, 8.0529e+05, 3.8248e+05, 3.8248e+05],
        [1.2671e+00, 1.1038e+00, 1.7521e+00, 3.8249e+05, 0.0000e+00, 4.0475e+05,
         4.0223e+05, 1.0967e+00, 4.0112e+05, 1.2525e+00, 1.1386e+00, 3.9003e+05,
         3.9453e+05, 1.0591e+00, 1.2429e+00, 4.0678e+05, 1.0784e+00, 1.3289e+00],
        [4.0477e+05, 4.0478e+05, 4.0479e+05, 7.9706e+05, 4.0475e+05, 0.0000e+00,
         8.2481e+05, 4.0479e+05, 8.0299e+05, 4.0477e+05, 4.0479e+05, 7.7593e+05,
         8.2598e+05, 4.0477e+05, 4.0478e+05, 8.0684e+05, 4.0478e+05, 4.0478e+05],
        [4.0221e+05, 4.0221e+05, 4.0220e+05, 7.7090e+05, 4.0223e+05, 8.2481e+05,
         0.0000e+00, 4.0224e+05, 8.1022e+05, 4.0221e+05, 4.0221e+05, 7.9323e+05,
         8.1326e+05, 4.0221e+05, 4.0222e+05, 7.9109e+05, 4.0224e+05, 4.0221e+05],
        [1.3204e+00, 1.1096e+00, 1.7342e+00, 3.8249e+05, 1.0967e+00, 4.0479e+05,
         4.0224e+05, 0.0000e+00, 4.0112e+05, 1.1470e+00, 1.0813e+00, 3.9005e+05,
         3.9451e+05, 1.0651e+00, 1.2360e+00, 4.0681e+05, 1.0360e+00, 1.3674e+00],
        [4.0113e+05, 4.0112e+05, 4.0114e+05, 7.5502e+05, 4.0112e+05, 8.0299e+05,
         8.1022e+05, 4.0112e+05, 0.0000e+00, 4.0110e+05, 4.0111e+05, 8.0301e+05,
         7.9049e+05, 4.0112e+05, 4.0113e+05, 8.0037e+05, 4.0112e+05, 4.0113e+05],
        [9.7282e-01, 1.2752e+00, 1.1372e+00, 3.8247e+05, 1.2525e+00, 4.0477e+05,
         4.0221e+05, 1.1470e+00, 4.0110e+05, 0.0000e+00, 1.1908e+00, 3.9006e+05,
         3.9451e+05, 1.0879e+00, 9.4010e-01, 4.0678e+05, 1.0702e+00, 9.3991e-01],
        [1.1939e+00, 1.1225e+00, 1.6954e+00, 3.8249e+05, 1.1386e+00, 4.0479e+05,
         4.0221e+05, 1.0813e+00, 4.0111e+05, 1.1908e+00, 0.0000e+00, 3.9001e+05,
         3.9453e+05, 1.0546e+00, 1.1472e+00, 4.0677e+05, 1.0844e+00, 1.2358e+00],
        [3.9002e+05, 3.9003e+05, 3.9006e+05, 7.9066e+05, 3.9003e+05, 7.7593e+05,
         7.9323e+05, 3.9005e+05, 8.0301e+05, 3.9006e+05, 3.9001e+05, 0.0000e+00,
         7.7463e+05, 3.9004e+05, 3.9007e+05, 8.0708e+05, 3.9004e+05, 3.9005e+05],
        [3.9451e+05, 3.9455e+05, 3.9453e+05, 7.4431e+05, 3.9453e+05, 8.2598e+05,
         8.1326e+05, 3.9451e+05, 7.9049e+05, 3.9451e+05, 3.9453e+05, 7.7463e+05,
         0.0000e+00, 3.9450e+05, 3.9451e+05, 8.0406e+05, 3.9455e+05, 3.9453e+05],
        [1.1510e+00, 1.1055e+00, 1.5822e+00, 3.8249e+05, 1.0591e+00, 4.0477e+05,
         4.0221e+05, 1.0651e+00, 4.0112e+05, 1.0879e+00, 1.0546e+00, 3.9004e+05,
         3.9450e+05, 0.0000e+00, 1.1268e+00, 4.0675e+05, 1.0721e+00, 1.1761e+00],
        [8.8528e-01, 1.2979e+00, 1.0043e+00, 3.8247e+05, 1.2429e+00, 4.0478e+05,
         4.0222e+05, 1.2360e+00, 4.0113e+05, 9.4010e-01, 1.1472e+00, 3.9007e+05,
         3.9451e+05, 1.1268e+00, 0.0000e+00, 4.0676e+05, 1.1242e+00, 8.2025e-01],
        [4.0673e+05, 4.0678e+05, 4.0678e+05, 8.0529e+05, 4.0678e+05, 8.0684e+05,
         7.9109e+05, 4.0681e+05, 8.0037e+05, 4.0678e+05, 4.0677e+05, 8.0708e+05,
         8.0406e+05, 4.0675e+05, 4.0676e+05, 0.0000e+00, 4.0677e+05, 4.0676e+05],
        [1.1986e+00, 1.1296e+00, 1.5569e+00, 3.8248e+05, 1.0784e+00, 4.0478e+05,
         4.0224e+05, 1.0360e+00, 4.0112e+05, 1.0702e+00, 1.0844e+00, 3.9004e+05,
         3.9455e+05, 1.0721e+00, 1.1242e+00, 4.0677e+05, 0.0000e+00, 1.1821e+00],
        [8.6090e-01, 1.4032e+00, 1.0788e+00, 3.8248e+05, 1.3289e+00, 4.0478e+05,
         4.0221e+05, 1.3674e+00, 4.0113e+05, 9.3991e-01, 1.2358e+00, 3.9005e+05,
         3.9453e+05, 1.1761e+00, 8.2025e-01, 4.0676e+05, 1.1821e+00, 0.0000e+00]])
Krum scores: ['1.11', '1.21', '1.41', '382475.66', '1.17', '404775.44', '402210.97', '1.16', '401118.75', '1.08', '1.14', '390036.53', '394517.16', '1.10', '1.06', '406765.81', '1.11', '1.11']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:06...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:06, End: 2025-07-22 15:31:06)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2800e+00, 1.0119e+00, 3.8737e+05, 1.2289e+00, 9.1150e-01,
         3.9535e+05, 4.0314e+05, 1.3081e+00, 3.9201e+05, 9.8697e-01, 1.1373e+00,
         3.8501e+05, 3.8658e+05, 1.1724e+00, 8.4992e-01],
        [1.2800e+00, 0.0000e+00, 1.4365e+00, 3.8737e+05, 1.0262e+00, 1.4503e+00,
         3.9538e+05, 4.0318e+05, 1.0884e+00, 3.9202e+05, 1.2089e+00, 1.0626e+00,
         3.8503e+05, 3.8655e+05, 1.0648e+00, 1.2963e+00],
        [1.0119e+00, 1.4365e+00, 0.0000e+00, 3.8738e+05, 1.4402e+00, 7.4577e-01,
         3.9535e+05, 4.0314e+05, 1.4693e+00, 3.9199e+05, 9.7732e-01, 1.3848e+00,
         3.8499e+05, 3.8657e+05, 1.2828e+00, 8.9477e-01],
        [3.8737e+05, 3.8737e+05, 3.8738e+05, 0.0000e+00, 3.8739e+05, 3.8738e+05,
         8.0690e+05, 7.7734e+05, 3.8739e+05, 7.5939e+05, 3.8739e+05, 3.8738e+05,
         7.7712e+05, 7.6245e+05, 3.8740e+05, 3.8736e+05],
        [1.2289e+00, 1.0262e+00, 1.4402e+00, 3.8739e+05, 0.0000e+00, 1.3909e+00,
         3.9538e+05, 4.0317e+05, 1.0800e+00, 3.9201e+05, 1.1746e+00, 1.0920e+00,
         3.8499e+05, 3.8655e+05, 1.0349e+00, 1.2445e+00],
        [9.1150e-01, 1.4503e+00, 7.4577e-01, 3.8738e+05, 1.3909e+00, 0.0000e+00,
         3.9539e+05, 4.0316e+05, 1.4139e+00, 3.9204e+05, 9.9084e-01, 1.3098e+00,
         3.8501e+05, 3.8657e+05, 1.2916e+00, 7.8981e-01],
        [3.9535e+05, 3.9538e+05, 3.9535e+05, 8.0690e+05, 3.9538e+05, 3.9539e+05,
         0.0000e+00, 8.0719e+05, 3.9537e+05, 7.8195e+05, 3.9534e+05, 3.9535e+05,
         7.6129e+05, 7.9695e+05, 3.9537e+05, 3.9535e+05],
        [4.0314e+05, 4.0318e+05, 4.0314e+05, 7.7734e+05, 4.0317e+05, 4.0316e+05,
         8.0719e+05, 0.0000e+00, 4.0321e+05, 7.8995e+05, 4.0314e+05, 4.0318e+05,
         7.5505e+05, 7.9373e+05, 4.0318e+05, 4.0316e+05],
        [1.3081e+00, 1.0884e+00, 1.4693e+00, 3.8739e+05, 1.0800e+00, 1.4139e+00,
         3.9537e+05, 4.0321e+05, 0.0000e+00, 3.9201e+05, 1.1270e+00, 1.0746e+00,
         3.8504e+05, 3.8656e+05, 1.0200e+00, 1.3105e+00],
        [3.9201e+05, 3.9202e+05, 3.9199e+05, 7.5939e+05, 3.9201e+05, 3.9204e+05,
         7.8195e+05, 7.8995e+05, 3.9201e+05, 0.0000e+00, 3.9202e+05, 3.9200e+05,
         7.7802e+05, 7.8253e+05, 3.9199e+05, 3.9199e+05],
        [9.8697e-01, 1.2089e+00, 9.7732e-01, 3.8739e+05, 1.1746e+00, 9.9084e-01,
         3.9534e+05, 4.0314e+05, 1.1270e+00, 3.9202e+05, 0.0000e+00, 1.1298e+00,
         3.8504e+05, 3.8657e+05, 1.0429e+00, 9.3202e-01],
        [1.1373e+00, 1.0626e+00, 1.3848e+00, 3.8738e+05, 1.0920e+00, 1.3098e+00,
         3.9535e+05, 4.0318e+05, 1.0746e+00, 3.9200e+05, 1.1298e+00, 0.0000e+00,
         3.8501e+05, 3.8656e+05, 1.0534e+00, 1.1423e+00],
        [3.8501e+05, 3.8503e+05, 3.8499e+05, 7.7712e+05, 3.8499e+05, 3.8501e+05,
         7.6129e+05, 7.5505e+05, 3.8504e+05, 7.7802e+05, 3.8504e+05, 3.8501e+05,
         0.0000e+00, 8.0532e+05, 3.8500e+05, 3.8502e+05],
        [3.8658e+05, 3.8655e+05, 3.8657e+05, 7.6245e+05, 3.8655e+05, 3.8657e+05,
         7.9695e+05, 7.9373e+05, 3.8656e+05, 7.8253e+05, 3.8657e+05, 3.8656e+05,
         8.0532e+05, 0.0000e+00, 3.8657e+05, 3.8656e+05],
        [1.1724e+00, 1.0648e+00, 1.2828e+00, 3.8740e+05, 1.0349e+00, 1.2916e+00,
         3.9537e+05, 4.0318e+05, 1.0200e+00, 3.9199e+05, 1.0429e+00, 1.0534e+00,
         3.8500e+05, 3.8657e+05, 0.0000e+00, 1.1334e+00],
        [8.4992e-01, 1.2963e+00, 8.9477e-01, 3.8736e+05, 1.2445e+00, 7.8981e-01,
         3.9535e+05, 4.0316e+05, 1.3105e+00, 3.9199e+05, 9.3202e-01, 1.1423e+00,
         3.8502e+05, 3.8656e+05, 1.1334e+00, 0.0000e+00]])
Krum scores: ['1.07', '1.18', '1.15', '387377.38', '1.16', '1.11', '395356.09', '403158.34', '1.18', '392001.22', '1.05', '1.13', '385007.31', '386560.38', '1.10', '1.04']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:07...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 72 191]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:07, End: 2025-07-22 15:31:07)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.2655e+00, 9.1187e-01, 3.8986e+05, 4.0311e+05, 1.1748e+00,
         8.7412e-01, 4.0091e+05, 4.0335e+05, 1.2269e+00, 3.9914e+05, 9.1905e-01,
         3.9075e+05, 3.9683e+05, 1.0755e+00, 3.8633e+05, 1.0886e+00, 1.0117e+00],
        [1.2655e+00, 0.0000e+00, 1.3185e+00, 3.8990e+05, 4.0309e+05, 1.0416e+00,
         1.4291e+00, 4.0091e+05, 4.0337e+05, 1.0638e+00, 3.9913e+05, 1.1472e+00,
         3.9075e+05, 3.9685e+05, 1.0549e+00, 3.8634e+05, 1.0232e+00, 1.8219e+00],
        [9.1187e-01, 1.3185e+00, 0.0000e+00, 3.8985e+05, 4.0309e+05, 1.2735e+00,
         6.9290e-01, 4.0090e+05, 4.0333e+05, 1.2752e+00, 3.9912e+05, 8.6553e-01,
         3.9074e+05, 3.9681e+05, 1.1450e+00, 3.8636e+05, 1.0931e+00, 9.1034e-01],
        [3.8986e+05, 3.8990e+05, 3.8985e+05, 0.0000e+00, 7.9937e+05, 3.8987e+05,
         3.8987e+05, 7.8301e+05, 7.9397e+05, 3.8986e+05, 7.7202e+05, 3.8985e+05,
         7.9185e+05, 7.9481e+05, 3.8987e+05, 7.7405e+05, 3.8986e+05, 3.8986e+05],
        [4.0311e+05, 4.0309e+05, 4.0309e+05, 7.9937e+05, 0.0000e+00, 4.0310e+05,
         4.0312e+05, 8.2016e+05, 8.2521e+05, 4.0312e+05, 7.9399e+05, 4.0309e+05,
         7.6824e+05, 7.7661e+05, 4.0310e+05, 7.8809e+05, 4.0313e+05, 4.0310e+05],
        [1.1748e+00, 1.0416e+00, 1.2735e+00, 3.8987e+05, 4.0310e+05, 0.0000e+00,
         1.3089e+00, 4.0091e+05, 4.0332e+05, 1.0088e+00, 3.9913e+05, 1.1205e+00,
         3.9076e+05, 3.9681e+05, 1.0117e+00, 3.8632e+05, 9.7115e-01, 1.6928e+00],
        [8.7412e-01, 1.4291e+00, 6.9290e-01, 3.8987e+05, 4.0312e+05, 1.3089e+00,
         0.0000e+00, 4.0089e+05, 4.0334e+05, 1.3145e+00, 3.9915e+05, 9.4012e-01,
         3.9074e+05, 3.9682e+05, 1.1950e+00, 3.8632e+05, 1.1835e+00, 8.1907e-01],
        [4.0091e+05, 4.0091e+05, 4.0090e+05, 7.8301e+05, 8.2016e+05, 4.0091e+05,
         4.0089e+05, 0.0000e+00, 8.0442e+05, 4.0090e+05, 7.8924e+05, 4.0090e+05,
         7.8534e+05, 7.8847e+05, 4.0089e+05, 7.9282e+05, 4.0091e+05, 4.0090e+05],
        [4.0335e+05, 4.0337e+05, 4.0333e+05, 7.9397e+05, 8.2521e+05, 4.0332e+05,
         4.0334e+05, 8.0442e+05, 0.0000e+00, 4.0333e+05, 7.8995e+05, 4.0335e+05,
         8.0730e+05, 8.0598e+05, 4.0334e+05, 8.0262e+05, 4.0336e+05, 4.0334e+05],
        [1.2269e+00, 1.0638e+00, 1.2752e+00, 3.8986e+05, 4.0312e+05, 1.0088e+00,
         1.3145e+00, 4.0090e+05, 4.0333e+05, 0.0000e+00, 3.9912e+05, 1.0220e+00,
         3.9075e+05, 3.9684e+05, 1.0229e+00, 3.8634e+05, 9.0919e-01, 1.7330e+00],
        [3.9914e+05, 3.9913e+05, 3.9912e+05, 7.7202e+05, 7.9399e+05, 3.9913e+05,
         3.9915e+05, 7.8924e+05, 7.8995e+05, 3.9912e+05, 0.0000e+00, 3.9915e+05,
         7.9881e+05, 7.9130e+05, 3.9911e+05, 7.6652e+05, 3.9910e+05, 3.9915e+05],
        [9.1905e-01, 1.1472e+00, 8.6553e-01, 3.8985e+05, 4.0309e+05, 1.1205e+00,
         9.4012e-01, 4.0090e+05, 4.0335e+05, 1.0220e+00, 3.9915e+05, 0.0000e+00,
         3.9074e+05, 3.9682e+05, 1.0042e+00, 3.8635e+05, 9.3395e-01, 1.1438e+00],
        [3.9075e+05, 3.9075e+05, 3.9074e+05, 7.9185e+05, 7.6824e+05, 3.9076e+05,
         3.9074e+05, 7.8534e+05, 8.0730e+05, 3.9075e+05, 7.9881e+05, 3.9074e+05,
         0.0000e+00, 7.9451e+05, 3.9074e+05, 7.8590e+05, 3.9076e+05, 3.9073e+05],
        [3.9683e+05, 3.9685e+05, 3.9681e+05, 7.9481e+05, 7.7661e+05, 3.9681e+05,
         3.9682e+05, 7.8847e+05, 8.0598e+05, 3.9684e+05, 7.9130e+05, 3.9682e+05,
         7.9451e+05, 0.0000e+00, 3.9680e+05, 7.8207e+05, 3.9682e+05, 3.9682e+05],
        [1.0755e+00, 1.0549e+00, 1.1450e+00, 3.8987e+05, 4.0310e+05, 1.0117e+00,
         1.1950e+00, 4.0089e+05, 4.0334e+05, 1.0229e+00, 3.9911e+05, 1.0042e+00,
         3.9074e+05, 3.9680e+05, 0.0000e+00, 3.8632e+05, 9.6534e-01, 1.5241e+00],
        [3.8633e+05, 3.8634e+05, 3.8636e+05, 7.7405e+05, 7.8809e+05, 3.8632e+05,
         3.8632e+05, 7.9282e+05, 8.0262e+05, 3.8634e+05, 7.6652e+05, 3.8635e+05,
         7.8590e+05, 7.8207e+05, 3.8632e+05, 0.0000e+00, 3.8633e+05, 3.8635e+05],
        [1.0886e+00, 1.0232e+00, 1.0931e+00, 3.8986e+05, 4.0313e+05, 9.7115e-01,
         1.1835e+00, 4.0091e+05, 4.0336e+05, 9.0919e-01, 3.9910e+05, 9.3395e-01,
         3.9076e+05, 3.9682e+05, 9.6534e-01, 3.8633e+05, 0.0000e+00, 1.5001e+00],
        [1.0117e+00, 1.8219e+00, 9.1034e-01, 3.8986e+05, 4.0310e+05, 1.6928e+00,
         8.1907e-01, 4.0090e+05, 4.0334e+05, 1.7330e+00, 3.9915e+05, 1.1438e+00,
         3.9073e+05, 3.9682e+05, 1.5241e+00, 3.8635e+05, 1.5001e+00, 0.0000e+00]])
Krum scores: ['1.04', '1.17', '1.02', '389859.59', '403100.12', '1.11', '1.04', '400899.28', '403338.78', '1.11', '399123.62', '0.99', '390741.03', '396816.00', '1.06', '386331.31', '1.02', '1.29']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0039s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:07...
global Accuracy on shared test data: 73.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:07, End: 2025-07-22 15:31:07)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.2232e+00, 9.0812e-01, 3.7549e+05, 3.7851e+05, 1.1861e+00,
         8.7690e-01, 3.9052e+05, 3.9899e+05, 3.9228e+05, 1.1210e+00, 1.1049e+00,
         3.9379e+05, 4.0780e+05, 8.7304e-01, 3.8581e+05, 1.1025e+00, 8.7322e-01],
        [1.2232e+00, 0.0000e+00, 1.3357e+00, 3.7551e+05, 3.7848e+05, 1.0380e+00,
         1.4185e+00, 3.9052e+05, 3.9901e+05, 3.9228e+05, 1.7611e+00, 1.0054e+00,
         3.9380e+05, 4.0780e+05, 1.4457e+00, 3.8581e+05, 1.0441e+00, 1.5766e+00],
        [9.0812e-01, 1.3357e+00, 0.0000e+00, 3.7549e+05, 3.7848e+05, 1.3280e+00,
         7.2302e-01, 3.9052e+05, 3.9899e+05, 3.9230e+05, 9.1457e-01, 1.2578e+00,
         3.9381e+05, 4.0780e+05, 6.9528e-01, 3.8582e+05, 1.1249e+00, 7.6860e-01],
        [3.7549e+05, 3.7551e+05, 3.7549e+05, 0.0000e+00, 7.4975e+05, 3.7554e+05,
         3.7552e+05, 7.8653e+05, 7.9260e+05, 7.6721e+05, 3.7550e+05, 3.7551e+05,
         7.6259e+05, 7.8128e+05, 3.7551e+05, 7.4752e+05, 3.7550e+05, 3.7551e+05],
        [3.7851e+05, 3.7848e+05, 3.7848e+05, 7.4975e+05, 0.0000e+00, 3.7849e+05,
         3.7850e+05, 7.6873e+05, 7.8391e+05, 7.6284e+05, 3.7851e+05, 3.7851e+05,
         7.7658e+05, 7.8419e+05, 3.7848e+05, 7.7988e+05, 3.7851e+05, 3.7849e+05],
        [1.1861e+00, 1.0380e+00, 1.3280e+00, 3.7554e+05, 3.7849e+05, 0.0000e+00,
         1.3729e+00, 3.9049e+05, 3.9899e+05, 3.9226e+05, 1.7760e+00, 1.0672e+00,
         3.9380e+05, 4.0780e+05, 1.4463e+00, 3.8579e+05, 1.0223e+00, 1.5180e+00],
        [8.7690e-01, 1.4185e+00, 7.2302e-01, 3.7552e+05, 3.7850e+05, 1.3729e+00,
         0.0000e+00, 3.9053e+05, 3.9900e+05, 3.9229e+05, 9.8887e-01, 1.2752e+00,
         3.9380e+05, 4.0779e+05, 7.1515e-01, 3.8580e+05, 1.1930e+00, 7.0165e-01],
        [3.9052e+05, 3.9052e+05, 3.9052e+05, 7.8653e+05, 7.6873e+05, 3.9049e+05,
         3.9053e+05, 0.0000e+00, 7.9014e+05, 7.8559e+05, 3.9053e+05, 3.9052e+05,
         8.0288e+05, 8.2421e+05, 3.9051e+05, 7.6767e+05, 3.9053e+05, 3.9051e+05],
        [3.9899e+05, 3.9901e+05, 3.9899e+05, 7.9260e+05, 7.8391e+05, 3.9899e+05,
         3.9900e+05, 7.9014e+05, 0.0000e+00, 8.0551e+05, 3.9899e+05, 3.9903e+05,
         8.0582e+05, 8.1915e+05, 3.9898e+05, 7.8233e+05, 3.9900e+05, 3.9899e+05],
        [3.9228e+05, 3.9228e+05, 3.9230e+05, 7.6721e+05, 7.6284e+05, 3.9226e+05,
         3.9229e+05, 7.8559e+05, 8.0551e+05, 0.0000e+00, 3.9228e+05, 3.9228e+05,
         7.8401e+05, 8.0195e+05, 3.9230e+05, 7.8815e+05, 3.9230e+05, 3.9230e+05],
        [1.1210e+00, 1.7611e+00, 9.1457e-01, 3.7550e+05, 3.7851e+05, 1.7760e+00,
         9.8887e-01, 3.9053e+05, 3.9899e+05, 3.9228e+05, 0.0000e+00, 1.6438e+00,
         3.9380e+05, 4.0777e+05, 9.4095e-01, 3.8582e+05, 1.5097e+00, 8.4287e-01],
        [1.1049e+00, 1.0054e+00, 1.2578e+00, 3.7551e+05, 3.7851e+05, 1.0672e+00,
         1.2752e+00, 3.9052e+05, 3.9903e+05, 3.9228e+05, 1.6438e+00, 0.0000e+00,
         3.9379e+05, 4.0780e+05, 1.3022e+00, 3.8579e+05, 1.0142e+00, 1.4196e+00],
        [3.9379e+05, 3.9380e+05, 3.9381e+05, 7.6259e+05, 7.7658e+05, 3.9380e+05,
         3.9380e+05, 8.0288e+05, 8.0582e+05, 7.8401e+05, 3.9380e+05, 3.9379e+05,
         0.0000e+00, 8.2120e+05, 3.9378e+05, 7.7303e+05, 3.9379e+05, 3.9379e+05],
        [4.0780e+05, 4.0780e+05, 4.0780e+05, 7.8128e+05, 7.8419e+05, 4.0780e+05,
         4.0779e+05, 8.2421e+05, 8.1915e+05, 8.0195e+05, 4.0777e+05, 4.0780e+05,
         8.2120e+05, 0.0000e+00, 4.0780e+05, 8.1757e+05, 4.0779e+05, 4.0778e+05],
        [8.7304e-01, 1.4457e+00, 6.9528e-01, 3.7551e+05, 3.7848e+05, 1.4463e+00,
         7.1515e-01, 3.9051e+05, 3.9898e+05, 3.9230e+05, 9.4095e-01, 1.3022e+00,
         3.9378e+05, 4.0780e+05, 0.0000e+00, 3.8580e+05, 1.2252e+00, 6.4296e-01],
        [3.8581e+05, 3.8581e+05, 3.8582e+05, 7.4752e+05, 7.7988e+05, 3.8579e+05,
         3.8580e+05, 7.6767e+05, 7.8233e+05, 7.8815e+05, 3.8582e+05, 3.8579e+05,
         7.7303e+05, 8.1757e+05, 3.8580e+05, 0.0000e+00, 3.8582e+05, 3.8580e+05],
        [1.1025e+00, 1.0441e+00, 1.1249e+00, 3.7550e+05, 3.7851e+05, 1.0223e+00,
         1.1930e+00, 3.9053e+05, 3.9900e+05, 3.9230e+05, 1.5097e+00, 1.0142e+00,
         3.9379e+05, 4.0779e+05, 1.2252e+00, 3.8582e+05, 0.0000e+00, 1.3055e+00],
        [8.7322e-01, 1.5766e+00, 7.6860e-01, 3.7551e+05, 3.7849e+05, 1.5180e+00,
         7.0165e-01, 3.9051e+05, 3.9899e+05, 3.9230e+05, 8.4287e-01, 1.4196e+00,
         3.9379e+05, 4.0778e+05, 6.4296e-01, 3.8580e+05, 1.3055e+00, 0.0000e+00]])
Krum scores: ['1.01', '1.26', '0.97', '375502.72', '378493.22', '1.25', '0.98', '390516.12', '398990.72', '392283.00', '1.22', '1.18', '393792.19', '407790.66', '0.98', '385801.84', '1.13', '1.01']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0077s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:08...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 75 188]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:08, End: 2025-07-22 15:31:08)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 17, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.1123e+00, 3.9101e+05, 3.8982e+05, 1.1516e+00, 3.8149e+05,
         8.5211e-01, 1.0122e+00, 3.7634e+05, 3.7851e+05, 8.3060e-01, 3.9325e+05,
         1.0395e+00, 7.9658e-01],
        [1.1123e+00, 0.0000e+00, 3.9101e+05, 3.8982e+05, 1.0405e+00, 3.8150e+05,
         1.3023e+00, 1.0198e+00, 3.7638e+05, 3.7851e+05, 1.2994e+00, 3.9324e+05,
         1.0032e+00, 1.3382e+00],
        [3.9101e+05, 3.9101e+05, 0.0000e+00, 7.9434e+05, 3.9103e+05, 7.7669e+05,
         3.9100e+05, 3.9102e+05, 7.7869e+05, 7.6796e+05, 3.9101e+05, 7.7362e+05,
         3.9102e+05, 3.9100e+05],
        [3.8982e+05, 3.8982e+05, 7.9434e+05, 0.0000e+00, 3.8982e+05, 7.6060e+05,
         3.8982e+05, 3.8983e+05, 7.6597e+05, 7.7306e+05, 3.8980e+05, 7.6944e+05,
         3.8985e+05, 3.8982e+05],
        [1.1516e+00, 1.0405e+00, 3.9103e+05, 3.8982e+05, 0.0000e+00, 3.8152e+05,
         1.2645e+00, 9.8846e-01, 3.7636e+05, 3.7850e+05, 1.3274e+00, 3.9326e+05,
         9.5595e-01, 1.3541e+00],
        [3.8149e+05, 3.8150e+05, 7.7669e+05, 7.6060e+05, 3.8152e+05, 0.0000e+00,
         3.8151e+05, 3.8147e+05, 7.5210e+05, 7.8636e+05, 3.8148e+05, 7.7239e+05,
         3.8152e+05, 3.8151e+05],
        [8.5211e-01, 1.3023e+00, 3.9100e+05, 3.8982e+05, 1.2645e+00, 3.8151e+05,
         0.0000e+00, 1.1981e+00, 3.7636e+05, 3.7850e+05, 7.3366e-01, 3.9323e+05,
         1.0987e+00, 6.8361e-01],
        [1.0122e+00, 1.0198e+00, 3.9102e+05, 3.8983e+05, 9.8846e-01, 3.8147e+05,
         1.1981e+00, 0.0000e+00, 3.7637e+05, 3.7850e+05, 1.1712e+00, 3.9325e+05,
         1.0006e+00, 1.1893e+00],
        [3.7634e+05, 3.7638e+05, 7.7869e+05, 7.6597e+05, 3.7636e+05, 7.5210e+05,
         3.7636e+05, 3.7637e+05, 0.0000e+00, 7.4868e+05, 3.7636e+05, 7.6738e+05,
         3.7637e+05, 3.7637e+05],
        [3.7851e+05, 3.7851e+05, 7.6796e+05, 7.7306e+05, 3.7850e+05, 7.8636e+05,
         3.7850e+05, 3.7850e+05, 7.4868e+05, 0.0000e+00, 3.7848e+05, 7.6992e+05,
         3.7850e+05, 3.7849e+05],
        [8.3060e-01, 1.2994e+00, 3.9101e+05, 3.8980e+05, 1.3274e+00, 3.8148e+05,
         7.3366e-01, 1.1712e+00, 3.7636e+05, 3.7848e+05, 0.0000e+00, 3.9327e+05,
         1.1309e+00, 6.0778e-01],
        [3.9325e+05, 3.9324e+05, 7.7362e+05, 7.6944e+05, 3.9326e+05, 7.7239e+05,
         3.9323e+05, 3.9325e+05, 7.6738e+05, 7.6992e+05, 3.9327e+05, 0.0000e+00,
         3.9326e+05, 3.9325e+05],
        [1.0395e+00, 1.0032e+00, 3.9102e+05, 3.8985e+05, 9.5595e-01, 3.8152e+05,
         1.0987e+00, 1.0006e+00, 3.7637e+05, 3.7850e+05, 1.1309e+00, 3.9326e+05,
         0.0000e+00, 1.1399e+00],
        [7.9658e-01, 1.3382e+00, 3.9100e+05, 3.8982e+05, 1.3541e+00, 3.8151e+05,
         6.8361e-01, 1.1893e+00, 3.7637e+05, 3.7849e+05, 6.0778e-01, 3.9325e+05,
         1.1399e+00, 0.0000e+00]])
Krum scores: ['0.94', '1.13', '391008.59', '389815.09', '1.12', '381493.38', '0.97', '1.06', '376359.81', '378493.31', '0.96', '393246.97', '1.04', '0.96']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 17, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0149s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:09...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:09, End: 2025-07-22 15:31:09)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.6909e+00, 7.0972e-01, 3.9308e+05, 3.9652e+05, 1.6320e+00,
         3.8705e+05, 3.9643e+05, 1.6656e+00, 4.0978e+05, 1.4778e+00, 4.0526e+05,
         3.9205e+05, 1.4209e+00, 7.7861e-01, 3.9316e+05, 1.4535e+00, 7.3489e-01],
        [1.6909e+00, 0.0000e+00, 1.4043e+00, 3.9310e+05, 3.9654e+05, 1.0036e+00,
         3.8709e+05, 3.9639e+05, 1.0356e+00, 4.0981e+05, 9.8621e-01, 4.0524e+05,
         3.9202e+05, 1.0193e+00, 1.3083e+00, 3.9313e+05, 1.0071e+00, 1.3439e+00],
        [7.0972e-01, 1.4043e+00, 0.0000e+00, 3.9308e+05, 3.9652e+05, 1.3525e+00,
         3.8706e+05, 3.9642e+05, 1.3478e+00, 4.0977e+05, 1.2586e+00, 4.0525e+05,
         3.9204e+05, 1.1894e+00, 5.7659e-01, 3.9317e+05, 1.1136e+00, 5.9191e-01],
        [3.9308e+05, 3.9310e+05, 3.9308e+05, 0.0000e+00, 8.1764e+05, 3.9309e+05,
         7.6322e+05, 8.0049e+05, 3.9308e+05, 7.9231e+05, 3.9312e+05, 7.8530e+05,
         7.7000e+05, 3.9309e+05, 3.9309e+05, 7.9604e+05, 3.9313e+05, 3.9309e+05],
        [3.9652e+05, 3.9654e+05, 3.9652e+05, 8.1764e+05, 0.0000e+00, 3.9652e+05,
         7.9694e+05, 7.7269e+05, 3.9654e+05, 7.9426e+05, 3.9652e+05, 7.9394e+05,
         7.6251e+05, 3.9654e+05, 3.9651e+05, 7.9982e+05, 3.9655e+05, 3.9650e+05],
        [1.6320e+00, 1.0036e+00, 1.3525e+00, 3.9309e+05, 3.9652e+05, 0.0000e+00,
         3.8709e+05, 3.9642e+05, 1.0246e+00, 4.0979e+05, 1.0233e+00, 4.0524e+05,
         3.9200e+05, 1.0095e+00, 1.2761e+00, 3.9318e+05, 9.8663e-01, 1.2975e+00],
        [3.8705e+05, 3.8709e+05, 3.8706e+05, 7.6322e+05, 7.9694e+05, 3.8709e+05,
         0.0000e+00, 7.9800e+05, 3.8708e+05, 7.9889e+05, 3.8707e+05, 7.9564e+05,
         7.6718e+05, 3.8708e+05, 3.8706e+05, 7.6562e+05, 3.8708e+05, 3.8705e+05],
        [3.9643e+05, 3.9639e+05, 3.9642e+05, 8.0049e+05, 7.7269e+05, 3.9642e+05,
         7.9800e+05, 0.0000e+00, 3.9640e+05, 8.0468e+05, 3.9640e+05, 8.0176e+05,
         7.6101e+05, 3.9638e+05, 3.9642e+05, 7.8996e+05, 3.9637e+05, 3.9644e+05],
        [1.6656e+00, 1.0356e+00, 1.3478e+00, 3.9308e+05, 3.9654e+05, 1.0246e+00,
         3.8708e+05, 3.9640e+05, 0.0000e+00, 4.0977e+05, 9.9051e-01, 4.0525e+05,
         3.9204e+05, 1.0058e+00, 1.2540e+00, 3.9317e+05, 9.4795e-01, 1.3010e+00],
        [4.0978e+05, 4.0981e+05, 4.0977e+05, 7.9231e+05, 7.9426e+05, 4.0979e+05,
         7.9889e+05, 8.0468e+05, 4.0977e+05, 0.0000e+00, 4.0979e+05, 8.0789e+05,
         7.9451e+05, 4.0977e+05, 4.0977e+05, 8.1497e+05, 4.0976e+05, 4.0976e+05],
        [1.4778e+00, 9.8621e-01, 1.2586e+00, 3.9312e+05, 3.9652e+05, 1.0233e+00,
         3.8707e+05, 3.9640e+05, 9.9051e-01, 4.0979e+05, 0.0000e+00, 4.0522e+05,
         3.9202e+05, 9.6071e-01, 1.1364e+00, 3.9317e+05, 9.9108e-01, 1.1584e+00],
        [4.0526e+05, 4.0524e+05, 4.0525e+05, 7.8530e+05, 7.9394e+05, 4.0524e+05,
         7.9564e+05, 8.0176e+05, 4.0525e+05, 8.0789e+05, 4.0522e+05, 0.0000e+00,
         8.1359e+05, 4.0524e+05, 4.0526e+05, 8.1007e+05, 4.0525e+05, 4.0526e+05],
        [3.9205e+05, 3.9202e+05, 3.9204e+05, 7.7000e+05, 7.6251e+05, 3.9200e+05,
         7.6718e+05, 7.6101e+05, 3.9204e+05, 7.9451e+05, 3.9202e+05, 8.1359e+05,
         0.0000e+00, 3.9202e+05, 3.9204e+05, 7.9889e+05, 3.9203e+05, 3.9206e+05],
        [1.4209e+00, 1.0193e+00, 1.1894e+00, 3.9309e+05, 3.9654e+05, 1.0095e+00,
         3.8708e+05, 3.9638e+05, 1.0058e+00, 4.0977e+05, 9.6071e-01, 4.0524e+05,
         3.9202e+05, 0.0000e+00, 1.1071e+00, 3.9317e+05, 9.6793e-01, 1.1381e+00],
        [7.7861e-01, 1.3083e+00, 5.7659e-01, 3.9309e+05, 3.9651e+05, 1.2761e+00,
         3.8706e+05, 3.9642e+05, 1.2540e+00, 4.0977e+05, 1.1364e+00, 4.0526e+05,
         3.9204e+05, 1.1071e+00, 0.0000e+00, 3.9316e+05, 1.0702e+00, 6.0569e-01],
        [3.9316e+05, 3.9313e+05, 3.9317e+05, 7.9604e+05, 7.9982e+05, 3.9318e+05,
         7.6562e+05, 7.8996e+05, 3.9317e+05, 8.1497e+05, 3.9317e+05, 8.1007e+05,
         7.9889e+05, 3.9317e+05, 3.9316e+05, 0.0000e+00, 3.9317e+05, 3.9317e+05],
        [1.4535e+00, 1.0071e+00, 1.1136e+00, 3.9313e+05, 3.9655e+05, 9.8663e-01,
         3.8708e+05, 3.9637e+05, 9.4795e-01, 4.0976e+05, 9.9108e-01, 4.0525e+05,
         3.9203e+05, 9.6793e-01, 1.0702e+00, 3.9317e+05, 0.0000e+00, 1.0895e+00],
        [7.3489e-01, 1.3439e+00, 5.9191e-01, 3.9309e+05, 3.9650e+05, 1.2975e+00,
         3.8705e+05, 3.9644e+05, 1.3010e+00, 4.0976e+05, 1.1584e+00, 4.0526e+05,
         3.9206e+05, 1.1381e+00, 6.0569e-01, 3.9317e+05, 1.0895e+00, 0.0000e+00]])
Krum scores: ['1.23', '1.14', '1.02', '393089.56', '396520.28', '1.12', '387065.19', '396400.84', '1.11', '409771.25', '1.06', '405243.38', '392025.56', '1.05', '0.98', '393163.16', '1.02', '0.99']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0057s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:09...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:09, End: 2025-07-22 15:31:09)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.2445e+00, 6.4110e-01, 3.8009e+05, 3.7914e+05, 1.3187e+00,
         7.2633e-01, 3.7435e+05, 1.3128e+00, 7.1188e-01, 1.1693e+00, 3.8974e+05,
         3.8298e+05, 1.1031e+00, 6.5006e-01, 4.0482e+05, 1.1644e+00, 6.0496e-01],
        [1.2445e+00, 0.0000e+00, 1.2363e+00, 3.8007e+05, 3.7911e+05, 9.4617e-01,
         1.1443e+00, 3.7436e+05, 9.7193e-01, 1.0885e+00, 9.1198e-01, 3.8974e+05,
         3.8299e+05, 9.6505e-01, 1.5815e+00, 4.0483e+05, 9.5396e-01, 1.1815e+00],
        [6.4110e-01, 1.2363e+00, 0.0000e+00, 3.8010e+05, 3.7914e+05, 1.3195e+00,
         6.7290e-01, 3.7437e+05, 1.3128e+00, 6.6131e-01, 1.2428e+00, 3.8972e+05,
         3.8299e+05, 1.1347e+00, 6.0273e-01, 4.0481e+05, 1.1023e+00, 6.0233e-01],
        [3.8009e+05, 3.8007e+05, 3.8010e+05, 0.0000e+00, 7.6314e+05, 3.8007e+05,
         3.8007e+05, 7.6363e+05, 3.8007e+05, 3.8008e+05, 3.8007e+05, 7.7636e+05,
         7.8762e+05, 3.8007e+05, 3.8009e+05, 7.8172e+05, 3.8006e+05, 3.8008e+05],
        [3.7914e+05, 3.7911e+05, 3.7914e+05, 7.6314e+05, 0.0000e+00, 3.7913e+05,
         3.7915e+05, 7.2756e+05, 3.7911e+05, 3.7915e+05, 3.7910e+05, 7.5499e+05,
         7.5835e+05, 3.7913e+05, 3.7912e+05, 7.9345e+05, 3.7912e+05, 3.7913e+05],
        [1.3187e+00, 9.4617e-01, 1.3195e+00, 3.8007e+05, 3.7913e+05, 0.0000e+00,
         1.2154e+00, 3.7436e+05, 9.7569e-01, 1.1814e+00, 9.7742e-01, 3.8975e+05,
         3.8296e+05, 9.8319e-01, 1.6860e+00, 4.0482e+05, 9.6338e-01, 1.2373e+00],
        [7.2633e-01, 1.1443e+00, 6.7290e-01, 3.8007e+05, 3.7915e+05, 1.2154e+00,
         0.0000e+00, 3.7438e+05, 1.2060e+00, 7.8902e-01, 1.1092e+00, 3.8975e+05,
         3.8300e+05, 1.0637e+00, 7.9857e-01, 4.0482e+05, 1.0732e+00, 6.7145e-01],
        [3.7435e+05, 3.7436e+05, 3.7437e+05, 7.6363e+05, 7.2756e+05, 3.7436e+05,
         3.7438e+05, 0.0000e+00, 3.7438e+05, 3.7438e+05, 3.7436e+05, 7.6911e+05,
         7.5227e+05, 3.7438e+05, 3.7436e+05, 7.7512e+05, 3.7439e+05, 3.7438e+05],
        [1.3128e+00, 9.7193e-01, 1.3128e+00, 3.8007e+05, 3.7911e+05, 9.7569e-01,
         1.2060e+00, 3.7438e+05, 0.0000e+00, 1.0963e+00, 9.5598e-01, 3.8975e+05,
         3.8300e+05, 9.8312e-01, 1.6697e+00, 4.0484e+05, 9.1335e-01, 1.2329e+00],
        [7.1188e-01, 1.0885e+00, 6.6131e-01, 3.8008e+05, 3.7915e+05, 1.1814e+00,
         7.8902e-01, 3.7438e+05, 1.0963e+00, 0.0000e+00, 1.0876e+00, 3.8974e+05,
         3.8299e+05, 1.0132e+00, 8.4490e-01, 4.0482e+05, 9.8056e-01, 6.7469e-01],
        [1.1693e+00, 9.1198e-01, 1.2428e+00, 3.8007e+05, 3.7910e+05, 9.7742e-01,
         1.1092e+00, 3.7436e+05, 9.5598e-01, 1.0876e+00, 0.0000e+00, 3.8974e+05,
         3.8300e+05, 9.2604e-01, 1.5282e+00, 4.0483e+05, 9.7876e-01, 1.1118e+00],
        [3.8974e+05, 3.8974e+05, 3.8972e+05, 7.7636e+05, 7.5499e+05, 3.8975e+05,
         3.8975e+05, 7.6911e+05, 3.8975e+05, 3.8974e+05, 3.8974e+05, 0.0000e+00,
         7.4478e+05, 3.8974e+05, 3.8974e+05, 8.0642e+05, 3.8974e+05, 3.8974e+05],
        [3.8298e+05, 3.8299e+05, 3.8299e+05, 7.8762e+05, 7.5835e+05, 3.8296e+05,
         3.8300e+05, 7.5227e+05, 3.8300e+05, 3.8299e+05, 3.8300e+05, 7.4478e+05,
         0.0000e+00, 3.8299e+05, 3.8299e+05, 7.9614e+05, 3.8298e+05, 3.8299e+05],
        [1.1031e+00, 9.6505e-01, 1.1347e+00, 3.8007e+05, 3.7913e+05, 9.8319e-01,
         1.0637e+00, 3.7438e+05, 9.8312e-01, 1.0132e+00, 9.2604e-01, 3.8974e+05,
         3.8299e+05, 0.0000e+00, 1.4246e+00, 4.0482e+05, 9.5357e-01, 1.0546e+00],
        [6.5006e-01, 1.5815e+00, 6.0273e-01, 3.8009e+05, 3.7912e+05, 1.6860e+00,
         7.9857e-01, 3.7436e+05, 1.6697e+00, 8.4490e-01, 1.5282e+00, 3.8974e+05,
         3.8299e+05, 1.4246e+00, 0.0000e+00, 4.0479e+05, 1.4554e+00, 6.4021e-01],
        [4.0482e+05, 4.0483e+05, 4.0481e+05, 7.8172e+05, 7.9345e+05, 4.0482e+05,
         4.0482e+05, 7.7512e+05, 4.0484e+05, 4.0482e+05, 4.0483e+05, 8.0642e+05,
         7.9614e+05, 4.0482e+05, 4.0479e+05, 0.0000e+00, 4.0484e+05, 4.0480e+05],
        [1.1644e+00, 9.5396e-01, 1.1023e+00, 3.8006e+05, 3.7912e+05, 9.6338e-01,
         1.0732e+00, 3.7439e+05, 9.1335e-01, 9.8056e-01, 9.7876e-01, 3.8974e+05,
         3.8298e+05, 9.5357e-01, 1.4554e+00, 4.0484e+05, 0.0000e+00, 1.0496e+00],
        [6.0496e-01, 1.1815e+00, 6.0233e-01, 3.8008e+05, 3.7913e+05, 1.2373e+00,
         6.7145e-01, 3.7438e+05, 1.2329e+00, 6.7469e-01, 1.1118e+00, 3.8974e+05,
         3.8299e+05, 1.0546e+00, 6.4021e-01, 4.0480e+05, 1.0496e+00, 0.0000e+00]])
Krum scores: ['0.93', '1.06', '0.92', '380070.78', '379122.78', '1.11', '0.93', '374368.47', '1.10', '0.89', '1.05', '389739.19', '382987.66', '1.02', '1.12', '404814.94', '1.01', '0.88']
Selected index: 17
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0130s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:10...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:10, End: 2025-07-22 15:31:10)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.2106e+00, 5.7495e-01, 3.9555e+05, 1.1398e+00, 6.6056e-01,
         3.9211e+05, 3.8470e+05, 4.0891e+05, 6.1472e-01, 1.0585e+00, 3.9650e+05,
         4.0091e+05, 9.9263e-01, 5.2289e-01, 4.0456e+05, 1.0152e+00],
        [1.2106e+00, 0.0000e+00, 1.2002e+00, 3.9553e+05, 9.5316e-01, 1.1817e+00,
         3.9211e+05, 3.8466e+05, 4.0891e+05, 1.0666e+00, 9.5592e-01, 3.9647e+05,
         4.0091e+05, 9.2415e-01, 1.3213e+00, 4.0453e+05, 9.4212e-01],
        [5.7495e-01, 1.2002e+00, 0.0000e+00, 3.9554e+05, 1.1577e+00, 5.9919e-01,
         3.9210e+05, 3.8468e+05, 4.0891e+05, 5.5080e-01, 1.1096e+00, 3.9649e+05,
         4.0091e+05, 1.0155e+00, 4.5672e-01, 4.0455e+05, 9.6236e-01],
        [3.9555e+05, 3.9553e+05, 3.9554e+05, 0.0000e+00, 3.9552e+05, 3.9555e+05,
         7.9039e+05, 7.7391e+05, 8.0267e+05, 3.9556e+05, 3.9554e+05, 7.8437e+05,
         8.1652e+05, 3.9553e+05, 3.9555e+05, 7.7563e+05, 3.9555e+05],
        [1.1398e+00, 9.5316e-01, 1.1577e+00, 3.9552e+05, 0.0000e+00, 1.1125e+00,
         3.9212e+05, 3.8469e+05, 4.0889e+05, 1.0533e+00, 1.0030e+00, 3.9647e+05,
         4.0091e+05, 8.9701e-01, 1.3007e+00, 4.0455e+05, 9.4122e-01],
        [6.6056e-01, 1.1817e+00, 5.9919e-01, 3.9555e+05, 1.1125e+00, 0.0000e+00,
         3.9211e+05, 3.8467e+05, 4.0888e+05, 6.8373e-01, 1.0540e+00, 3.9647e+05,
         4.0091e+05, 9.9610e-01, 6.2549e-01, 4.0459e+05, 9.8842e-01],
        [3.9211e+05, 3.9211e+05, 3.9210e+05, 7.9039e+05, 3.9212e+05, 3.9211e+05,
         0.0000e+00, 7.6688e+05, 8.0571e+05, 3.9213e+05, 3.9213e+05, 7.9570e+05,
         7.9114e+05, 3.9213e+05, 3.9209e+05, 7.9803e+05, 3.9212e+05],
        [3.8470e+05, 3.8466e+05, 3.8468e+05, 7.7391e+05, 3.8469e+05, 3.8467e+05,
         7.6688e+05, 0.0000e+00, 8.0765e+05, 3.8469e+05, 3.8471e+05, 7.7363e+05,
         8.0339e+05, 3.8470e+05, 3.8468e+05, 7.6947e+05, 3.8469e+05],
        [4.0891e+05, 4.0891e+05, 4.0891e+05, 8.0267e+05, 4.0889e+05, 4.0888e+05,
         8.0571e+05, 8.0765e+05, 0.0000e+00, 4.0890e+05, 4.0890e+05, 8.1338e+05,
         8.1472e+05, 4.0890e+05, 4.0888e+05, 8.3617e+05, 4.0887e+05],
        [6.1472e-01, 1.0666e+00, 5.5080e-01, 3.9556e+05, 1.0533e+00, 6.8373e-01,
         3.9213e+05, 3.8469e+05, 4.0890e+05, 0.0000e+00, 9.7682e-01, 3.9650e+05,
         4.0090e+05, 9.1594e-01, 6.2917e-01, 4.0455e+05, 8.5632e-01],
        [1.0585e+00, 9.5592e-01, 1.1096e+00, 3.9554e+05, 1.0030e+00, 1.0540e+00,
         3.9213e+05, 3.8471e+05, 4.0890e+05, 9.7682e-01, 0.0000e+00, 3.9648e+05,
         4.0089e+05, 8.8886e-01, 1.1963e+00, 4.0456e+05, 9.3658e-01],
        [3.9650e+05, 3.9647e+05, 3.9649e+05, 7.8437e+05, 3.9647e+05, 3.9647e+05,
         7.9570e+05, 7.7363e+05, 8.1338e+05, 3.9650e+05, 3.9648e+05, 0.0000e+00,
         8.0129e+05, 3.9646e+05, 3.9649e+05, 7.8090e+05, 3.9650e+05],
        [4.0091e+05, 4.0091e+05, 4.0091e+05, 8.1652e+05, 4.0091e+05, 4.0091e+05,
         7.9114e+05, 8.0339e+05, 8.1472e+05, 4.0090e+05, 4.0089e+05, 8.0129e+05,
         0.0000e+00, 4.0089e+05, 4.0091e+05, 7.7705e+05, 4.0090e+05],
        [9.9263e-01, 9.2415e-01, 1.0155e+00, 3.9553e+05, 8.9701e-01, 9.9610e-01,
         3.9213e+05, 3.8470e+05, 4.0890e+05, 9.1594e-01, 8.8886e-01, 3.9646e+05,
         4.0089e+05, 0.0000e+00, 1.1322e+00, 4.0452e+05, 8.7686e-01],
        [5.2289e-01, 1.3213e+00, 4.5672e-01, 3.9555e+05, 1.3007e+00, 6.2549e-01,
         3.9209e+05, 3.8468e+05, 4.0888e+05, 6.2917e-01, 1.1963e+00, 3.9649e+05,
         4.0091e+05, 1.1322e+00, 0.0000e+00, 4.0456e+05, 1.0968e+00],
        [4.0456e+05, 4.0453e+05, 4.0455e+05, 7.7563e+05, 4.0455e+05, 4.0459e+05,
         7.9803e+05, 7.6947e+05, 8.3617e+05, 4.0455e+05, 4.0456e+05, 7.8090e+05,
         7.7705e+05, 4.0452e+05, 4.0456e+05, 0.0000e+00, 4.0453e+05],
        [1.0152e+00, 9.4212e-01, 9.6236e-01, 3.9555e+05, 9.4122e-01, 9.8842e-01,
         3.9212e+05, 3.8469e+05, 4.0887e+05, 8.5632e-01, 9.3658e-01, 3.9650e+05,
         4.0090e+05, 8.7686e-01, 1.0968e+00, 4.0453e+05, 0.0000e+00]])
Krum scores: ['0.82', '1.05', '0.80', '395537.28', '1.03', '0.84', '392112.00', '384681.72', '408889.78', '0.79', '1.00', '396477.53', '400900.97', '0.94', '0.87', '404545.06', '0.94']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:11...
global Accuracy on shared test data: 71.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 76 187]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:11, End: 2025-07-22 15:31:11)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.1327e+00, 5.7903e-01, 3.9820e+05, 3.9215e+05, 1.1753e+00,
         6.4915e-01, 3.9307e+05, 3.8131e+05, 1.1671e+00, 3.8560e+05, 7.2333e-01,
         1.0684e+00, 3.7900e+05, 1.0027e+00, 5.1436e-01, 4.0620e+05, 1.0502e+00,
         5.1032e-01],
        [1.1327e+00, 0.0000e+00, 1.2011e+00, 3.9819e+05, 3.9216e+05, 9.4012e-01,
         1.1093e+00, 3.9308e+05, 3.8126e+05, 9.3869e-01, 3.8557e+05, 1.5739e+00,
         9.2127e-01, 3.7898e+05, 9.4754e-01, 1.2281e+00, 4.0624e+05, 9.3379e-01,
         1.3073e+00],
        [5.7903e-01, 1.2011e+00, 0.0000e+00, 3.9820e+05, 3.9217e+05, 1.2347e+00,
         6.2648e-01, 3.9308e+05, 3.8128e+05, 1.2355e+00, 3.8558e+05, 6.3351e-01,
         1.1647e+00, 3.7899e+05, 1.0825e+00, 4.5178e-01, 4.0620e+05, 1.0367e+00,
         4.7711e-01],
        [3.9820e+05, 3.9819e+05, 3.9820e+05, 0.0000e+00, 7.8806e+05, 3.9820e+05,
         3.9819e+05, 8.0373e+05, 7.6136e+05, 3.9822e+05, 8.1540e+05, 3.9822e+05,
         3.9820e+05, 7.7540e+05, 3.9822e+05, 3.9819e+05, 7.8627e+05, 3.9819e+05,
         3.9820e+05],
        [3.9215e+05, 3.9216e+05, 3.9217e+05, 7.8806e+05, 0.0000e+00, 3.9216e+05,
         3.9215e+05, 8.0586e+05, 7.8029e+05, 3.9214e+05, 7.7641e+05, 3.9216e+05,
         3.9213e+05, 7.7310e+05, 3.9216e+05, 3.9214e+05, 8.0320e+05, 3.9218e+05,
         3.9214e+05],
        [1.1753e+00, 9.4012e-01, 1.2347e+00, 3.9820e+05, 3.9216e+05, 0.0000e+00,
         1.1124e+00, 3.9308e+05, 3.8127e+05, 9.3916e-01, 3.8560e+05, 1.6491e+00,
         9.6990e-01, 3.7898e+05, 9.2985e-01, 1.3095e+00, 4.0623e+05, 9.3389e-01,
         1.3400e+00],
        [6.4915e-01, 1.1093e+00, 6.2648e-01, 3.9819e+05, 3.9215e+05, 1.1124e+00,
         0.0000e+00, 3.9308e+05, 3.8130e+05, 1.1151e+00, 3.8557e+05, 8.9068e-01,
         1.0189e+00, 3.7901e+05, 9.8795e-01, 6.0707e-01, 4.0621e+05, 9.7842e-01,
         6.1163e-01],
        [3.9307e+05, 3.9308e+05, 3.9308e+05, 8.0373e+05, 8.0586e+05, 3.9308e+05,
         3.9308e+05, 0.0000e+00, 7.8061e+05, 3.9306e+05, 7.7863e+05, 3.9306e+05,
         3.9307e+05, 7.6667e+05, 3.9305e+05, 3.9306e+05, 8.2105e+05, 3.9308e+05,
         3.9308e+05],
        [3.8131e+05, 3.8126e+05, 3.8128e+05, 7.6136e+05, 7.8029e+05, 3.8127e+05,
         3.8130e+05, 7.8061e+05, 0.0000e+00, 3.8125e+05, 7.8186e+05, 3.8128e+05,
         3.8128e+05, 7.7151e+05, 3.8127e+05, 3.8127e+05, 7.9548e+05, 3.8129e+05,
         3.8129e+05],
        [1.1671e+00, 9.3869e-01, 1.2355e+00, 3.9822e+05, 3.9214e+05, 9.3916e-01,
         1.1151e+00, 3.9306e+05, 3.8125e+05, 0.0000e+00, 3.8558e+05, 1.5817e+00,
         9.3475e-01, 3.7901e+05, 9.3613e-01, 1.2891e+00, 4.0621e+05, 8.8670e-01,
         1.3366e+00],
        [3.8560e+05, 3.8557e+05, 3.8558e+05, 8.1540e+05, 7.7641e+05, 3.8560e+05,
         3.8557e+05, 7.7863e+05, 7.8186e+05, 3.8558e+05, 0.0000e+00, 3.8558e+05,
         3.8558e+05, 7.6035e+05, 3.8558e+05, 3.8559e+05, 7.7207e+05, 3.8559e+05,
         3.8558e+05],
        [7.2333e-01, 1.5739e+00, 6.3351e-01, 3.9822e+05, 3.9216e+05, 1.6491e+00,
         8.9068e-01, 3.9306e+05, 3.8128e+05, 1.5817e+00, 3.8558e+05, 0.0000e+00,
         1.5057e+00, 3.7898e+05, 1.4175e+00, 6.2726e-01, 4.0621e+05, 1.4196e+00,
         5.6483e-01],
        [1.0684e+00, 9.2127e-01, 1.1647e+00, 3.9820e+05, 3.9213e+05, 9.6990e-01,
         1.0189e+00, 3.9307e+05, 3.8128e+05, 9.3475e-01, 3.8558e+05, 1.5057e+00,
         0.0000e+00, 3.7898e+05, 9.0803e-01, 1.1568e+00, 4.0624e+05, 9.3670e-01,
         1.2296e+00],
        [3.7900e+05, 3.7898e+05, 3.7899e+05, 7.7540e+05, 7.7310e+05, 3.7898e+05,
         3.7901e+05, 7.6667e+05, 7.7151e+05, 3.7901e+05, 7.6035e+05, 3.7898e+05,
         3.7898e+05, 0.0000e+00, 3.7900e+05, 3.7899e+05, 7.8580e+05, 3.7900e+05,
         3.7898e+05],
        [1.0027e+00, 9.4754e-01, 1.0825e+00, 3.9822e+05, 3.9216e+05, 9.2985e-01,
         9.8795e-01, 3.9305e+05, 3.8127e+05, 9.3613e-01, 3.8558e+05, 1.4175e+00,
         9.0803e-01, 3.7900e+05, 0.0000e+00, 1.0935e+00, 4.0623e+05, 9.1936e-01,
         1.1756e+00],
        [5.1436e-01, 1.2281e+00, 4.5178e-01, 3.9819e+05, 3.9214e+05, 1.3095e+00,
         6.0707e-01, 3.9306e+05, 3.8127e+05, 1.2891e+00, 3.8559e+05, 6.2726e-01,
         1.1568e+00, 3.7899e+05, 1.0935e+00, 0.0000e+00, 4.0620e+05, 1.1034e+00,
         3.8809e-01],
        [4.0620e+05, 4.0624e+05, 4.0620e+05, 7.8627e+05, 8.0320e+05, 4.0623e+05,
         4.0621e+05, 8.2105e+05, 7.9548e+05, 4.0621e+05, 7.7207e+05, 4.0621e+05,
         4.0624e+05, 7.8580e+05, 4.0623e+05, 4.0620e+05, 0.0000e+00, 4.0622e+05,
         4.0620e+05],
        [1.0502e+00, 9.3379e-01, 1.0367e+00, 3.9819e+05, 3.9218e+05, 9.3389e-01,
         9.7842e-01, 3.9308e+05, 3.8129e+05, 8.8670e-01, 3.8559e+05, 1.4196e+00,
         9.3670e-01, 3.7900e+05, 9.1936e-01, 1.1034e+00, 4.0622e+05, 0.0000e+00,
         1.1509e+00],
        [5.1032e-01, 1.3073e+00, 4.7711e-01, 3.9820e+05, 3.9214e+05, 1.3400e+00,
         6.1163e-01, 3.9308e+05, 3.8129e+05, 1.3366e+00, 3.8558e+05, 5.6483e-01,
         1.2296e+00, 3.7898e+05, 1.1756e+00, 3.8809e-01, 4.0620e+05, 1.1509e+00,
         0.0000e+00]])
Krum scores: ['0.84', '1.07', '0.85', '398199.22', '392148.91', '1.09', '0.86', '393068.03', '381275.94', '1.08', '385579.84', '1.09', '1.03', '378989.28', '1.00', '0.85', '406210.97', '0.99', '0.88']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0067s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:11...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:11, End: 2025-07-22 15:31:11)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [7, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 11], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 3.8606e+05, 9.1244e-01, 1.0519e+00, 4.0026e+05, 4.0292e+05,
         9.2445e-01, 4.0260e+05, 1.2147e+00, 8.8003e-01, 4.0094e+05, 8.9533e-01],
        [3.8606e+05, 0.0000e+00, 3.8606e+05, 3.8605e+05, 7.7979e+05, 7.6860e+05,
         3.8605e+05, 8.1322e+05, 3.8605e+05, 3.8603e+05, 7.9058e+05, 3.8606e+05],
        [9.1244e-01, 3.8606e+05, 0.0000e+00, 1.0719e+00, 4.0024e+05, 4.0292e+05,
         9.3111e-01, 4.0262e+05, 1.2923e+00, 9.6846e-01, 4.0095e+05, 9.1419e-01],
        [1.0519e+00, 3.8605e+05, 1.0719e+00, 0.0000e+00, 4.0028e+05, 4.0293e+05,
         1.0630e+00, 4.0260e+05, 6.9034e-01, 9.7117e-01, 4.0094e+05, 9.6555e-01],
        [4.0026e+05, 7.7979e+05, 4.0024e+05, 4.0028e+05, 0.0000e+00, 7.8611e+05,
         4.0026e+05, 7.8776e+05, 4.0028e+05, 4.0025e+05, 7.9530e+05, 4.0024e+05],
        [4.0292e+05, 7.6860e+05, 4.0292e+05, 4.0293e+05, 7.8611e+05, 0.0000e+00,
         4.0291e+05, 7.9852e+05, 4.0292e+05, 4.0291e+05, 8.0003e+05, 4.0291e+05],
        [9.2445e-01, 3.8605e+05, 9.3111e-01, 1.0630e+00, 4.0026e+05, 4.0291e+05,
         0.0000e+00, 4.0261e+05, 1.2059e+00, 8.9115e-01, 4.0095e+05, 8.9739e-01],
        [4.0260e+05, 8.1322e+05, 4.0262e+05, 4.0260e+05, 7.8776e+05, 7.9852e+05,
         4.0261e+05, 0.0000e+00, 4.0260e+05, 4.0262e+05, 7.8953e+05, 4.0262e+05],
        [1.2147e+00, 3.8605e+05, 1.2923e+00, 6.9034e-01, 4.0028e+05, 4.0292e+05,
         1.2059e+00, 4.0260e+05, 0.0000e+00, 1.1643e+00, 4.0093e+05, 1.1178e+00],
        [8.8003e-01, 3.8603e+05, 9.6846e-01, 9.7117e-01, 4.0025e+05, 4.0291e+05,
         8.9115e-01, 4.0262e+05, 1.1643e+00, 0.0000e+00, 4.0096e+05, 8.9231e-01],
        [4.0094e+05, 7.9058e+05, 4.0095e+05, 4.0094e+05, 7.9530e+05, 8.0003e+05,
         4.0095e+05, 7.8953e+05, 4.0093e+05, 4.0096e+05, 0.0000e+00, 4.0094e+05],
        [8.9533e-01, 3.8606e+05, 9.1419e-01, 9.6555e-01, 4.0024e+05, 4.0291e+05,
         8.9739e-01, 4.0262e+05, 1.1178e+00, 8.9231e-01, 4.0094e+05, 0.0000e+00]])
Krum scores: ['0.93', '386048.12', '0.96', '0.95', '400249.91', '402915.66', '0.94', '402606.66', '1.08', '0.92', '400940.69', '0.91']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']], selected_client_indices: [7, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0025s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:12...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:12, End: 2025-07-22 15:31:12)
start time is: 97236187468462, end time is: 97254022229556
The total time is: 17834761094ns.

 ------- aggregate method: krum, random_seed: 300 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 6.8351e+00, 6.2381e+00, 3.7846e+05, 5.1984e+00, 7.5877e+00,
         4.0148e+05, 3.8055e+05, 6.4926e+00, 4.0068e+05, 4.1971e+00, 6.1020e+00,
         3.9707e+05, 5.9044e+00, 6.4609e+00, 3.8347e+05, 5.1789e+00],
        [6.8351e+00, 0.0000e+00, 4.9477e+00, 3.7841e+05, 6.9189e+00, 5.7956e+00,
         4.0152e+05, 3.8055e+05, 8.0130e+00, 4.0060e+05, 6.8887e+00, 6.9399e+00,
         3.9703e+05, 5.0717e+00, 4.7354e+00, 3.8350e+05, 5.6022e+00],
        [6.2381e+00, 4.9477e+00, 0.0000e+00, 3.7843e+05, 6.0269e+00, 4.5239e+00,
         4.0152e+05, 3.8054e+05, 7.0995e+00, 4.0057e+05, 5.9348e+00, 6.4690e+00,
         3.9705e+05, 5.1352e+00, 4.2691e+00, 3.8348e+05, 6.0010e+00],
        [3.7846e+05, 3.7841e+05, 3.7843e+05, 0.0000e+00, 3.7847e+05, 3.7843e+05,
         7.8882e+05, 7.5845e+05, 3.7840e+05, 7.8495e+05, 3.7843e+05, 3.7842e+05,
         7.7212e+05, 3.7841e+05, 3.7842e+05, 7.4786e+05, 3.7843e+05],
        [5.1984e+00, 6.9189e+00, 6.0269e+00, 3.7847e+05, 0.0000e+00, 6.1993e+00,
         4.0153e+05, 3.8051e+05, 5.7527e+00, 4.0059e+05, 5.3321e+00, 5.5257e+00,
         3.9700e+05, 5.4303e+00, 5.6177e+00, 3.8346e+05, 6.2686e+00],
        [7.5877e+00, 5.7956e+00, 4.5239e+00, 3.7843e+05, 6.1993e+00, 0.0000e+00,
         4.0153e+05, 3.8048e+05, 6.4339e+00, 4.0060e+05, 6.6810e+00, 5.8686e+00,
         3.9700e+05, 5.6114e+00, 4.6320e+00, 3.8348e+05, 6.7845e+00],
        [4.0148e+05, 4.0152e+05, 4.0152e+05, 7.8882e+05, 4.0153e+05, 4.0153e+05,
         0.0000e+00, 7.6529e+05, 4.0157e+05, 8.0598e+05, 4.0153e+05, 4.0152e+05,
         7.7289e+05, 4.0151e+05, 4.0155e+05, 8.0167e+05, 4.0152e+05],
        [3.8055e+05, 3.8055e+05, 3.8054e+05, 7.5845e+05, 3.8051e+05, 3.8048e+05,
         7.6529e+05, 0.0000e+00, 3.8048e+05, 7.8630e+05, 3.8052e+05, 3.8055e+05,
         7.8313e+05, 3.8054e+05, 3.8048e+05, 7.7151e+05, 3.8052e+05],
        [6.4926e+00, 8.0130e+00, 7.0995e+00, 3.7840e+05, 5.7527e+00, 6.4339e+00,
         4.0157e+05, 3.8048e+05, 0.0000e+00, 4.0059e+05, 4.8452e+00, 4.8776e+00,
         3.9698e+05, 6.9178e+00, 6.1902e+00, 3.8345e+05, 5.9058e+00],
        [4.0068e+05, 4.0060e+05, 4.0057e+05, 7.8495e+05, 4.0059e+05, 4.0060e+05,
         8.0598e+05, 7.8630e+05, 4.0059e+05, 0.0000e+00, 4.0062e+05, 4.0061e+05,
         8.0783e+05, 4.0063e+05, 4.0061e+05, 8.0930e+05, 4.0059e+05],
        [4.1971e+00, 6.8887e+00, 5.9348e+00, 3.7843e+05, 5.3321e+00, 6.6810e+00,
         4.0153e+05, 3.8052e+05, 4.8452e+00, 4.0062e+05, 0.0000e+00, 4.9020e+00,
         3.9698e+05, 5.9918e+00, 6.1047e+00, 3.8345e+05, 4.5849e+00],
        [6.1020e+00, 6.9399e+00, 6.4690e+00, 3.7842e+05, 5.5257e+00, 5.8686e+00,
         4.0152e+05, 3.8055e+05, 4.8776e+00, 4.0061e+05, 4.9020e+00, 0.0000e+00,
         3.9702e+05, 6.8576e+00, 6.1209e+00, 3.8343e+05, 5.2909e+00],
        [3.9707e+05, 3.9703e+05, 3.9705e+05, 7.7212e+05, 3.9700e+05, 3.9700e+05,
         7.7289e+05, 7.8313e+05, 3.9698e+05, 8.0783e+05, 3.9698e+05, 3.9702e+05,
         0.0000e+00, 3.9697e+05, 3.9700e+05, 7.7619e+05, 3.9701e+05],
        [5.9044e+00, 5.0717e+00, 5.1352e+00, 3.7841e+05, 5.4303e+00, 5.6114e+00,
         4.0151e+05, 3.8054e+05, 6.9178e+00, 4.0063e+05, 5.9918e+00, 6.8576e+00,
         3.9697e+05, 0.0000e+00, 4.4213e+00, 3.8347e+05, 5.7464e+00],
        [6.4609e+00, 4.7354e+00, 4.2691e+00, 3.7842e+05, 5.6177e+00, 4.6320e+00,
         4.0155e+05, 3.8048e+05, 6.1902e+00, 4.0061e+05, 6.1047e+00, 6.1209e+00,
         3.9700e+05, 4.4213e+00, 0.0000e+00, 3.8352e+05, 6.0753e+00],
        [3.8347e+05, 3.8350e+05, 3.8348e+05, 7.4786e+05, 3.8346e+05, 3.8348e+05,
         8.0167e+05, 7.7151e+05, 3.8345e+05, 8.0930e+05, 3.8345e+05, 3.8343e+05,
         7.7619e+05, 3.8347e+05, 3.8352e+05, 0.0000e+00, 3.8343e+05],
        [5.1789e+00, 5.6022e+00, 6.0010e+00, 3.7843e+05, 6.2686e+00, 6.7845e+00,
         4.0152e+05, 3.8052e+05, 5.9058e+00, 4.0059e+05, 4.5849e+00, 5.2909e+00,
         3.9701e+05, 5.7464e+00, 6.0753e+00, 3.8343e+05, 0.0000e+00]])
Krum scores: ['5.85', '5.97', '5.51', '378419.72', '5.71', '5.84', '401517.44', '380514.41', '6.06', '400598.69', '5.40', '5.78', '396998.03', '5.57', '5.35', '383458.28', '5.63']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:12...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:31:12, End: 2025-07-22 15:31:12)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 2, 19, 17, 9, 18, 15, 3, 11, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 2.1726e+00, 3.8828e+05, 3.9141e+05, 2.2758e+00, 4.0282e+05,
         4.0936e+05, 1.8923e+00, 2.0677e+00, 2.2933e+00, 3.9837e+05, 2.2107e+00,
         2.0275e+00],
        [2.1726e+00, 0.0000e+00, 3.8825e+05, 3.9142e+05, 2.0422e+00, 4.0287e+05,
         4.0934e+05, 1.9510e+00, 2.0613e+00, 2.0291e+00, 3.9841e+05, 1.9708e+00,
         1.9611e+00],
        [3.8828e+05, 3.8825e+05, 0.0000e+00, 7.8618e+05, 3.8822e+05, 8.0299e+05,
         7.6780e+05, 3.8827e+05, 3.8821e+05, 3.8827e+05, 7.8199e+05, 3.8827e+05,
         3.8826e+05],
        [3.9141e+05, 3.9142e+05, 7.8618e+05, 0.0000e+00, 3.9139e+05, 7.9507e+05,
         7.9661e+05, 3.9140e+05, 3.9137e+05, 3.9141e+05, 7.8651e+05, 3.9139e+05,
         3.9144e+05],
        [2.2758e+00, 2.0422e+00, 3.8822e+05, 3.9139e+05, 0.0000e+00, 4.0281e+05,
         4.0933e+05, 1.9455e+00, 1.9966e+00, 2.0366e+00, 3.9844e+05, 2.0761e+00,
         2.0740e+00],
        [4.0282e+05, 4.0287e+05, 8.0299e+05, 7.9507e+05, 4.0281e+05, 0.0000e+00,
         8.2246e+05, 4.0282e+05, 4.0285e+05, 4.0282e+05, 8.1588e+05, 4.0286e+05,
         4.0284e+05],
        [4.0936e+05, 4.0934e+05, 7.6780e+05, 7.9661e+05, 4.0933e+05, 8.2246e+05,
         0.0000e+00, 4.0930e+05, 4.0933e+05, 4.0930e+05, 8.1291e+05, 4.0934e+05,
         4.0934e+05],
        [1.8923e+00, 1.9510e+00, 3.8827e+05, 3.9140e+05, 1.9455e+00, 4.0282e+05,
         4.0930e+05, 0.0000e+00, 2.1681e+00, 2.0993e+00, 3.9840e+05, 2.1766e+00,
         1.8487e+00],
        [2.0677e+00, 2.0613e+00, 3.8821e+05, 3.9137e+05, 1.9966e+00, 4.0285e+05,
         4.0933e+05, 2.1681e+00, 0.0000e+00, 2.2356e+00, 3.9841e+05, 2.1545e+00,
         2.0843e+00],
        [2.2933e+00, 2.0291e+00, 3.8827e+05, 3.9141e+05, 2.0366e+00, 4.0282e+05,
         4.0930e+05, 2.0993e+00, 2.2356e+00, 0.0000e+00, 3.9838e+05, 2.3007e+00,
         2.1793e+00],
        [3.9837e+05, 3.9841e+05, 7.8199e+05, 7.8651e+05, 3.9844e+05, 8.1588e+05,
         8.1291e+05, 3.9840e+05, 3.9841e+05, 3.9838e+05, 0.0000e+00, 3.9840e+05,
         3.9838e+05],
        [2.2107e+00, 1.9708e+00, 3.8827e+05, 3.9139e+05, 2.0761e+00, 4.0286e+05,
         4.0934e+05, 2.1766e+00, 2.1545e+00, 2.3007e+00, 3.9840e+05, 0.0000e+00,
         2.0766e+00],
        [2.0275e+00, 1.9611e+00, 3.8826e+05, 3.9144e+05, 2.0740e+00, 4.0284e+05,
         4.0934e+05, 1.8487e+00, 2.0843e+00, 2.1793e+00, 3.9838e+05, 2.0766e+00,
         0.0000e+00]])
Krum scores: ['2.11', '2.00', '388246.91', '391395.59', '2.03', '402827.59', '409322.22', '1.98', '2.09', '2.15', '398389.47', '2.11', '2.01']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 2, 19, 17, 9, 18, 15, 3, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0272s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:13...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 49 214]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:31:13, End: 2025-07-22 15:31:13)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 11, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.8026e+05, 3.8656e+05, 1.6799e+00, 4.0515e+05, 3.9851e+05,
         1.6988e+00, 3.8509e+05, 1.5967e+00, 1.9856e+00, 3.9261e+05, 1.6005e+00,
         3.8469e+05, 1.6581e+00, 1.6271e+00],
        [3.8026e+05, 0.0000e+00, 7.5967e+05, 3.8025e+05, 7.5986e+05, 7.8962e+05,
         3.8024e+05, 7.6527e+05, 3.8028e+05, 3.8022e+05, 7.7406e+05, 3.8023e+05,
         7.6600e+05, 3.8027e+05, 3.8023e+05],
        [3.8656e+05, 7.5967e+05, 0.0000e+00, 3.8657e+05, 7.8626e+05, 7.8766e+05,
         3.8655e+05, 7.6490e+05, 3.8655e+05, 3.8655e+05, 7.8776e+05, 3.8658e+05,
         7.8802e+05, 3.8655e+05, 3.8654e+05],
        [1.6799e+00, 3.8025e+05, 3.8657e+05, 0.0000e+00, 4.0510e+05, 3.9854e+05,
         1.6294e+00, 3.8508e+05, 1.6589e+00, 1.7980e+00, 3.9258e+05, 1.5437e+00,
         3.8474e+05, 1.6412e+00, 1.6559e+00],
        [4.0515e+05, 7.5986e+05, 7.8626e+05, 4.0510e+05, 0.0000e+00, 8.2764e+05,
         4.0513e+05, 7.8149e+05, 4.0512e+05, 4.0509e+05, 7.9129e+05, 4.0515e+05,
         7.9792e+05, 4.0512e+05, 4.0512e+05],
        [3.9851e+05, 7.8962e+05, 7.8766e+05, 3.9854e+05, 8.2764e+05, 0.0000e+00,
         3.9851e+05, 7.7037e+05, 3.9853e+05, 3.9855e+05, 7.9699e+05, 3.9852e+05,
         7.7812e+05, 3.9850e+05, 3.9855e+05],
        [1.6988e+00, 3.8024e+05, 3.8655e+05, 1.6294e+00, 4.0513e+05, 3.9851e+05,
         0.0000e+00, 3.8507e+05, 1.6569e+00, 1.8782e+00, 3.9258e+05, 1.6000e+00,
         3.8471e+05, 1.6876e+00, 1.6132e+00],
        [3.8509e+05, 7.6527e+05, 7.6490e+05, 3.8508e+05, 7.8149e+05, 7.7037e+05,
         3.8507e+05, 0.0000e+00, 3.8512e+05, 3.8504e+05, 7.8090e+05, 3.8508e+05,
         7.7197e+05, 3.8511e+05, 3.8509e+05],
        [1.5967e+00, 3.8028e+05, 3.8655e+05, 1.6589e+00, 4.0512e+05, 3.9853e+05,
         1.6569e+00, 3.8512e+05, 0.0000e+00, 1.8679e+00, 3.9259e+05, 1.5573e+00,
         3.8468e+05, 1.6217e+00, 1.6111e+00],
        [1.9856e+00, 3.8022e+05, 3.8655e+05, 1.7980e+00, 4.0509e+05, 3.9855e+05,
         1.8782e+00, 3.8504e+05, 1.8679e+00, 0.0000e+00, 3.9256e+05, 1.9790e+00,
         3.8472e+05, 2.1164e+00, 1.7077e+00],
        [3.9261e+05, 7.7406e+05, 7.8776e+05, 3.9258e+05, 7.9129e+05, 7.9699e+05,
         3.9258e+05, 7.8090e+05, 3.9259e+05, 3.9256e+05, 0.0000e+00, 3.9258e+05,
         7.5876e+05, 3.9264e+05, 3.9262e+05],
        [1.6005e+00, 3.8023e+05, 3.8658e+05, 1.5437e+00, 4.0515e+05, 3.9852e+05,
         1.6000e+00, 3.8508e+05, 1.5573e+00, 1.9790e+00, 3.9258e+05, 0.0000e+00,
         3.8468e+05, 1.7062e+00, 1.6319e+00],
        [3.8469e+05, 7.6600e+05, 7.8802e+05, 3.8474e+05, 7.9792e+05, 7.7812e+05,
         3.8471e+05, 7.7197e+05, 3.8468e+05, 3.8472e+05, 7.5876e+05, 3.8468e+05,
         0.0000e+00, 3.8473e+05, 3.8470e+05],
        [1.6581e+00, 3.8027e+05, 3.8655e+05, 1.6412e+00, 4.0512e+05, 3.9850e+05,
         1.6876e+00, 3.8511e+05, 1.6217e+00, 2.1164e+00, 3.9264e+05, 1.7062e+00,
         3.8473e+05, 0.0000e+00, 1.6809e+00],
        [1.6271e+00, 3.8023e+05, 3.8654e+05, 1.6559e+00, 4.0512e+05, 3.9855e+05,
         1.6132e+00, 3.8509e+05, 1.6111e+00, 1.7077e+00, 3.9262e+05, 1.6319e+00,
         3.8470e+05, 1.6809e+00, 0.0000e+00]])
Krum scores: ['1.64', '380239.06', '386551.56', '1.63', '405114.75', '398521.00', '1.65', '385074.59', '1.62', '1.87', '392583.62', '1.61', '384696.88', '1.67', '1.64']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0032s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:13...
global Accuracy on shared test data: 77.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 48 215]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:13, End: 2025-07-22 15:31:13)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 9, 20, 8, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.7495e+00, 1.8558e+00, 3.9016e+05, 1.8873e+00, 3.8726e+05,
         2.0479e+00, 1.7587e+00, 1.6731e+00, 3.9563e+05, 3.8571e+05, 1.8016e+00,
         1.7671e+00, 3.8990e+05, 1.7851e+00],
        [1.7495e+00, 0.0000e+00, 1.7301e+00, 3.9021e+05, 1.8391e+00, 3.8724e+05,
         1.9197e+00, 1.8324e+00, 1.9962e+00, 3.9567e+05, 3.8569e+05, 1.8958e+00,
         1.8388e+00, 3.8989e+05, 1.7844e+00],
        [1.8558e+00, 1.7301e+00, 0.0000e+00, 3.9019e+05, 1.7195e+00, 3.8722e+05,
         1.8618e+00, 1.7824e+00, 1.8023e+00, 3.9566e+05, 3.8566e+05, 1.9090e+00,
         1.6870e+00, 3.8989e+05, 1.7020e+00],
        [3.9016e+05, 3.9021e+05, 3.9019e+05, 0.0000e+00, 3.9018e+05, 7.8844e+05,
         3.9014e+05, 3.9018e+05, 3.9019e+05, 7.8650e+05, 7.7472e+05, 3.9022e+05,
         3.9018e+05, 7.6206e+05, 3.9017e+05],
        [1.8873e+00, 1.8391e+00, 1.7195e+00, 3.9018e+05, 0.0000e+00, 3.8725e+05,
         1.7887e+00, 1.7362e+00, 1.7485e+00, 3.9568e+05, 3.8569e+05, 1.7755e+00,
         1.6826e+00, 3.8986e+05, 1.7242e+00],
        [3.8726e+05, 3.8724e+05, 3.8722e+05, 7.8844e+05, 3.8725e+05, 0.0000e+00,
         3.8722e+05, 3.8727e+05, 3.8724e+05, 7.8994e+05, 7.7201e+05, 3.8724e+05,
         3.8725e+05, 7.9002e+05, 3.8722e+05],
        [2.0479e+00, 1.9197e+00, 1.8618e+00, 3.9014e+05, 1.7887e+00, 3.8722e+05,
         0.0000e+00, 1.7214e+00, 1.9188e+00, 3.9565e+05, 3.8573e+05, 1.9372e+00,
         1.7531e+00, 3.8993e+05, 1.6868e+00],
        [1.7587e+00, 1.8324e+00, 1.7824e+00, 3.9018e+05, 1.7362e+00, 3.8727e+05,
         1.7214e+00, 0.0000e+00, 1.8250e+00, 3.9568e+05, 3.8570e+05, 1.8263e+00,
         1.8018e+00, 3.8990e+05, 1.6661e+00],
        [1.6731e+00, 1.9962e+00, 1.8023e+00, 3.9019e+05, 1.7485e+00, 3.8724e+05,
         1.9188e+00, 1.8250e+00, 0.0000e+00, 3.9565e+05, 3.8571e+05, 1.9051e+00,
         1.6559e+00, 3.8991e+05, 1.6543e+00],
        [3.9563e+05, 3.9567e+05, 3.9566e+05, 7.8650e+05, 3.9568e+05, 7.8994e+05,
         3.9565e+05, 3.9568e+05, 3.9565e+05, 0.0000e+00, 7.8233e+05, 3.9571e+05,
         3.9570e+05, 7.7808e+05, 3.9565e+05],
        [3.8571e+05, 3.8569e+05, 3.8566e+05, 7.7472e+05, 3.8569e+05, 7.7201e+05,
         3.8573e+05, 3.8570e+05, 3.8571e+05, 7.8233e+05, 0.0000e+00, 3.8572e+05,
         3.8569e+05, 7.6075e+05, 3.8573e+05],
        [1.8016e+00, 1.8958e+00, 1.9090e+00, 3.9022e+05, 1.7755e+00, 3.8724e+05,
         1.9372e+00, 1.8263e+00, 1.9051e+00, 3.9571e+05, 3.8572e+05, 0.0000e+00,
         1.7758e+00, 3.8994e+05, 1.8181e+00],
        [1.7671e+00, 1.8388e+00, 1.6870e+00, 3.9018e+05, 1.6826e+00, 3.8725e+05,
         1.7531e+00, 1.8018e+00, 1.6559e+00, 3.9570e+05, 3.8569e+05, 1.7758e+00,
         0.0000e+00, 3.8992e+05, 1.6981e+00],
        [3.8990e+05, 3.8989e+05, 3.8989e+05, 7.6206e+05, 3.8986e+05, 7.9002e+05,
         3.8993e+05, 3.8990e+05, 3.8991e+05, 7.7808e+05, 7.6075e+05, 3.8994e+05,
         3.8992e+05, 0.0000e+00, 3.8991e+05],
        [1.7851e+00, 1.7844e+00, 1.7020e+00, 3.9017e+05, 1.7242e+00, 3.8722e+05,
         1.6868e+00, 1.6661e+00, 1.6543e+00, 3.9565e+05, 3.8573e+05, 1.8181e+00,
         1.6981e+00, 3.8991e+05, 0.0000e+00]])
Krum scores: ['1.78', '1.82', '1.77', '390174.66', '1.75', '387236.22', '1.82', '1.76', '1.77', '395660.25', '385697.38', '1.84', '1.73', '389898.66', '1.71']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 19, 9, 20, 8, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0031s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:14...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:14, End: 2025-07-22 15:31:14)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 1.6955e+00, 1.8742e+00, 3.8802e+05, 3.9427e+05, 1.8652e+00,
         1.8603e+00, 3.9856e+05, 3.8638e+05, 2.0235e+00, 3.8979e+05, 1.7027e+00,
         1.6756e+00, 3.8725e+05, 3.8553e+05, 1.7080e+00, 1.7403e+00, 3.9082e+05,
         1.8456e+00, 1.6364e+00],
        [1.6955e+00, 0.0000e+00, 1.6227e+00, 3.8798e+05, 3.9428e+05, 1.7444e+00,
         1.7005e+00, 3.9856e+05, 3.8633e+05, 1.9266e+00, 3.8977e+05, 1.6849e+00,
         1.9098e+00, 3.8725e+05, 3.8551e+05, 1.7394e+00, 1.7196e+00, 3.9082e+05,
         1.8346e+00, 1.7998e+00],
        [1.8742e+00, 1.6227e+00, 0.0000e+00, 3.8802e+05, 3.9427e+05, 1.6526e+00,
         1.6182e+00, 3.9859e+05, 3.8638e+05, 1.8512e+00, 3.8978e+05, 1.7236e+00,
         1.7648e+00, 3.8726e+05, 3.8549e+05, 1.7511e+00, 1.6163e+00, 3.9080e+05,
         1.6260e+00, 1.7351e+00],
        [3.8802e+05, 3.8798e+05, 3.8802e+05, 0.0000e+00, 7.8828e+05, 3.8800e+05,
         3.8800e+05, 7.6901e+05, 7.8689e+05, 3.8802e+05, 7.9648e+05, 3.8800e+05,
         3.8805e+05, 7.8328e+05, 7.7297e+05, 3.8803e+05, 3.8802e+05, 7.9126e+05,
         3.8802e+05, 3.8800e+05],
        [3.9427e+05, 3.9428e+05, 3.9427e+05, 7.8828e+05, 0.0000e+00, 3.9428e+05,
         3.9428e+05, 7.9969e+05, 7.8876e+05, 3.9428e+05, 7.8628e+05, 3.9430e+05,
         3.9427e+05, 7.8496e+05, 7.7469e+05, 3.9425e+05, 3.9429e+05, 7.7644e+05,
         3.9430e+05, 3.9427e+05],
        [1.8652e+00, 1.7444e+00, 1.6526e+00, 3.8800e+05, 3.9428e+05, 0.0000e+00,
         1.6240e+00, 3.9860e+05, 3.8640e+05, 1.8718e+00, 3.8973e+05, 1.7934e+00,
         1.9928e+00, 3.8726e+05, 3.8550e+05, 1.7119e+00, 1.7739e+00, 3.9080e+05,
         1.7242e+00, 1.8898e+00],
        [1.8603e+00, 1.7005e+00, 1.6182e+00, 3.8800e+05, 3.9428e+05, 1.6240e+00,
         0.0000e+00, 3.9856e+05, 3.8636e+05, 1.7575e+00, 3.8974e+05, 1.6508e+00,
         1.7620e+00, 3.8722e+05, 3.8551e+05, 1.6014e+00, 1.5782e+00, 3.9081e+05,
         1.6531e+00, 1.7349e+00],
        [3.9856e+05, 3.9856e+05, 3.9859e+05, 7.6901e+05, 7.9969e+05, 3.9860e+05,
         3.9856e+05, 0.0000e+00, 8.0588e+05, 3.9858e+05, 7.9491e+05, 3.9859e+05,
         3.9860e+05, 7.8200e+05, 7.7289e+05, 3.9858e+05, 3.9860e+05, 7.7893e+05,
         3.9858e+05, 3.9858e+05],
        [3.8638e+05, 3.8633e+05, 3.8638e+05, 7.8689e+05, 7.8876e+05, 3.8640e+05,
         3.8636e+05, 8.0588e+05, 0.0000e+00, 3.8635e+05, 7.7145e+05, 3.8636e+05,
         3.8639e+05, 7.6685e+05, 7.7108e+05, 3.8638e+05, 3.8639e+05, 7.6512e+05,
         3.8635e+05, 3.8637e+05],
        [2.0235e+00, 1.9266e+00, 1.8512e+00, 3.8802e+05, 3.9428e+05, 1.8718e+00,
         1.7575e+00, 3.9858e+05, 3.8635e+05, 0.0000e+00, 3.8980e+05, 1.7474e+00,
         1.9623e+00, 3.8727e+05, 3.8550e+05, 1.8081e+00, 1.7570e+00, 3.9081e+05,
         1.7703e+00, 1.8039e+00],
        [3.8979e+05, 3.8977e+05, 3.8978e+05, 7.9648e+05, 7.8628e+05, 3.8973e+05,
         3.8974e+05, 7.9491e+05, 7.7145e+05, 3.8980e+05, 0.0000e+00, 3.8979e+05,
         3.8977e+05, 7.6753e+05, 7.6643e+05, 3.8978e+05, 3.8979e+05, 7.8059e+05,
         3.8981e+05, 3.8977e+05],
        [1.7027e+00, 1.6849e+00, 1.7236e+00, 3.8800e+05, 3.9430e+05, 1.7934e+00,
         1.6508e+00, 3.9859e+05, 3.8636e+05, 1.7474e+00, 3.8979e+05, 0.0000e+00,
         1.8355e+00, 3.8724e+05, 3.8552e+05, 1.6859e+00, 1.7223e+00, 3.9080e+05,
         1.6760e+00, 1.7160e+00],
        [1.6756e+00, 1.9098e+00, 1.7648e+00, 3.8805e+05, 3.9427e+05, 1.9928e+00,
         1.7620e+00, 3.9860e+05, 3.8639e+05, 1.9623e+00, 3.8977e+05, 1.8355e+00,
         0.0000e+00, 3.8726e+05, 3.8553e+05, 1.8795e+00, 1.6526e+00, 3.9082e+05,
         2.0662e+00, 1.5083e+00],
        [3.8725e+05, 3.8725e+05, 3.8726e+05, 7.8328e+05, 7.8496e+05, 3.8726e+05,
         3.8722e+05, 7.8200e+05, 7.6685e+05, 3.8727e+05, 7.6753e+05, 3.8724e+05,
         3.8726e+05, 0.0000e+00, 7.4416e+05, 3.8726e+05, 3.8724e+05, 7.7551e+05,
         3.8724e+05, 3.8727e+05],
        [3.8553e+05, 3.8551e+05, 3.8549e+05, 7.7297e+05, 7.7469e+05, 3.8550e+05,
         3.8551e+05, 7.7289e+05, 7.7108e+05, 3.8550e+05, 7.6643e+05, 3.8552e+05,
         3.8553e+05, 7.4416e+05, 0.0000e+00, 3.8551e+05, 3.8549e+05, 7.7612e+05,
         3.8551e+05, 3.8550e+05],
        [1.7080e+00, 1.7394e+00, 1.7511e+00, 3.8803e+05, 3.9425e+05, 1.7119e+00,
         1.6014e+00, 3.9858e+05, 3.8638e+05, 1.8081e+00, 3.8978e+05, 1.6859e+00,
         1.8795e+00, 3.8726e+05, 3.8551e+05, 0.0000e+00, 1.6281e+00, 3.9083e+05,
         1.8438e+00, 1.7149e+00],
        [1.7403e+00, 1.7196e+00, 1.6163e+00, 3.8802e+05, 3.9429e+05, 1.7739e+00,
         1.5782e+00, 3.9860e+05, 3.8639e+05, 1.7570e+00, 3.8979e+05, 1.7223e+00,
         1.6526e+00, 3.8724e+05, 3.8549e+05, 1.6281e+00, 0.0000e+00, 3.9081e+05,
         1.8202e+00, 1.6596e+00],
        [3.9082e+05, 3.9082e+05, 3.9080e+05, 7.9126e+05, 7.7644e+05, 3.9080e+05,
         3.9081e+05, 7.7893e+05, 7.6512e+05, 3.9081e+05, 7.8059e+05, 3.9080e+05,
         3.9082e+05, 7.7551e+05, 7.7612e+05, 3.9083e+05, 3.9081e+05, 0.0000e+00,
         3.9081e+05, 3.9084e+05],
        [1.8456e+00, 1.8346e+00, 1.6260e+00, 3.8802e+05, 3.9430e+05, 1.7242e+00,
         1.6531e+00, 3.9858e+05, 3.8635e+05, 1.7703e+00, 3.8981e+05, 1.6760e+00,
         2.0662e+00, 3.8724e+05, 3.8551e+05, 1.8438e+00, 1.8202e+00, 3.9081e+05,
         0.0000e+00, 1.8422e+00],
        [1.6364e+00, 1.7998e+00, 1.7351e+00, 3.8800e+05, 3.9427e+05, 1.8898e+00,
         1.7349e+00, 3.9858e+05, 3.8637e+05, 1.8039e+00, 3.8977e+05, 1.7160e+00,
         1.5083e+00, 3.8727e+05, 3.8550e+05, 1.7149e+00, 1.6596e+00, 3.9084e+05,
         1.8422e+00, 0.0000e+00]])
Krum scores: ['1.76', '1.75', '1.70', '388008.22', '394273.31', '1.77', '1.67', '398576.88', '386364.22', '1.83', '389770.62', '1.71', '1.79', '387247.78', '385502.81', '1.72', '1.68', '390811.22', '1.76', '1.72']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0052s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:15...
global Accuracy on shared test data: 78.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 48 215]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:15, End: 2025-07-22 15:31:15)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.7127e+00, 1.8070e+00, 3.9544e+05, 3.9300e+05, 1.7842e+00,
         1.7976e+00, 3.8233e+05, 3.9678e+05, 3.8230e+05, 3.9805e+05, 3.9031e+05,
         1.6396e+00, 1.6828e+00, 3.8520e+05, 1.8207e+00, 1.6397e+00],
        [1.7127e+00, 0.0000e+00, 1.6018e+00, 3.9548e+05, 3.9300e+05, 1.7318e+00,
         1.8445e+00, 3.8236e+05, 3.9675e+05, 3.8229e+05, 3.9807e+05, 3.9032e+05,
         1.7629e+00, 1.8059e+00, 3.8517e+05, 1.8087e+00, 1.7429e+00],
        [1.8070e+00, 1.6018e+00, 0.0000e+00, 3.9547e+05, 3.9302e+05, 1.6380e+00,
         1.7476e+00, 3.8236e+05, 3.9677e+05, 3.8228e+05, 3.9806e+05, 3.9029e+05,
         1.7505e+00, 1.6580e+00, 3.8517e+05, 1.6028e+00, 1.6632e+00],
        [3.9544e+05, 3.9548e+05, 3.9547e+05, 0.0000e+00, 7.7767e+05, 3.9545e+05,
         3.9544e+05, 7.5564e+05, 7.9715e+05, 7.7943e+05, 7.9214e+05, 7.6902e+05,
         3.9549e+05, 3.9545e+05, 7.7905e+05, 3.9547e+05, 3.9545e+05],
        [3.9300e+05, 3.9300e+05, 3.9302e+05, 7.7767e+05, 0.0000e+00, 3.9301e+05,
         3.9303e+05, 7.8134e+05, 7.8661e+05, 8.0210e+05, 8.0440e+05, 7.7952e+05,
         3.9298e+05, 3.9302e+05, 7.8278e+05, 3.9304e+05, 3.9302e+05],
        [1.7842e+00, 1.7318e+00, 1.6380e+00, 3.9545e+05, 3.9301e+05, 0.0000e+00,
         1.6711e+00, 3.8238e+05, 3.9675e+05, 3.8226e+05, 3.9807e+05, 3.9030e+05,
         1.6240e+00, 1.7015e+00, 3.8518e+05, 1.6753e+00, 1.8196e+00],
        [1.7976e+00, 1.8445e+00, 1.7476e+00, 3.9544e+05, 3.9303e+05, 1.6711e+00,
         0.0000e+00, 3.8234e+05, 3.9677e+05, 3.8229e+05, 3.9810e+05, 3.9029e+05,
         1.6447e+00, 1.5498e+00, 3.8518e+05, 1.9090e+00, 1.5833e+00],
        [3.8233e+05, 3.8236e+05, 3.8236e+05, 7.5564e+05, 7.8134e+05, 3.8238e+05,
         3.8234e+05, 0.0000e+00, 7.6626e+05, 7.7379e+05, 7.6753e+05, 7.7769e+05,
         3.8233e+05, 3.8233e+05, 7.5426e+05, 3.8237e+05, 3.8232e+05],
        [3.9678e+05, 3.9675e+05, 3.9677e+05, 7.9715e+05, 7.8661e+05, 3.9675e+05,
         3.9677e+05, 7.6626e+05, 0.0000e+00, 7.6546e+05, 7.9422e+05, 7.9739e+05,
         3.9676e+05, 3.9676e+05, 7.6559e+05, 3.9678e+05, 3.9677e+05],
        [3.8230e+05, 3.8229e+05, 3.8228e+05, 7.7943e+05, 8.0210e+05, 3.8226e+05,
         3.8229e+05, 7.7379e+05, 7.6546e+05, 0.0000e+00, 7.8197e+05, 7.5219e+05,
         3.8226e+05, 3.8230e+05, 7.5881e+05, 3.8225e+05, 3.8230e+05],
        [3.9805e+05, 3.9807e+05, 3.9806e+05, 7.9214e+05, 8.0440e+05, 3.9807e+05,
         3.9810e+05, 7.6753e+05, 7.9422e+05, 7.8197e+05, 0.0000e+00, 7.9928e+05,
         3.9804e+05, 3.9809e+05, 7.6616e+05, 3.9806e+05, 3.9807e+05],
        [3.9031e+05, 3.9032e+05, 3.9029e+05, 7.6902e+05, 7.7952e+05, 3.9030e+05,
         3.9029e+05, 7.7769e+05, 7.9739e+05, 7.5219e+05, 7.9928e+05, 0.0000e+00,
         3.9032e+05, 3.9031e+05, 7.6277e+05, 3.9036e+05, 3.9034e+05],
        [1.6396e+00, 1.7629e+00, 1.7505e+00, 3.9549e+05, 3.9298e+05, 1.6240e+00,
         1.6447e+00, 3.8233e+05, 3.9676e+05, 3.8226e+05, 3.9804e+05, 3.9032e+05,
         0.0000e+00, 1.6143e+00, 3.8520e+05, 1.7990e+00, 1.5796e+00],
        [1.6828e+00, 1.8059e+00, 1.6580e+00, 3.9545e+05, 3.9302e+05, 1.7015e+00,
         1.5498e+00, 3.8233e+05, 3.9676e+05, 3.8230e+05, 3.9809e+05, 3.9031e+05,
         1.6143e+00, 0.0000e+00, 3.8522e+05, 1.8082e+00, 1.5806e+00],
        [3.8520e+05, 3.8517e+05, 3.8517e+05, 7.7905e+05, 7.8278e+05, 3.8518e+05,
         3.8518e+05, 7.5426e+05, 7.6559e+05, 7.5881e+05, 7.6616e+05, 7.6277e+05,
         3.8520e+05, 3.8522e+05, 0.0000e+00, 3.8520e+05, 3.8523e+05],
        [1.8207e+00, 1.8087e+00, 1.6028e+00, 3.9547e+05, 3.9304e+05, 1.6753e+00,
         1.9090e+00, 3.8237e+05, 3.9678e+05, 3.8225e+05, 3.9806e+05, 3.9036e+05,
         1.7990e+00, 1.8082e+00, 3.8520e+05, 0.0000e+00, 1.8283e+00],
        [1.6397e+00, 1.7429e+00, 1.6632e+00, 3.9545e+05, 3.9302e+05, 1.8196e+00,
         1.5833e+00, 3.8232e+05, 3.9677e+05, 3.8230e+05, 3.9807e+05, 3.9034e+05,
         1.5796e+00, 1.5806e+00, 3.8523e+05, 1.8283e+00, 0.0000e+00]])
Krum scores: ['1.72', '1.74', '1.67', '395454.06', '393007.03', '1.69', '1.69', '382338.41', '396763.50', '382276.34', '398061.16', '390306.56', '1.66', '1.66', '385185.28', '1.76', '1.66']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:15...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:15, End: 2025-07-22 15:31:15)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.7167e+00, 3.9798e+05, 3.9443e+05, 1.7031e+00, 1.6660e+00,
         3.8913e+05, 3.9084e+05, 1.7785e+00, 3.9324e+05, 1.5368e+00, 3.8771e+05,
         4.0198e+05, 1.5929e+00, 1.8414e+00, 3.9513e+05, 1.7463e+00, 1.5975e+00],
        [1.7167e+00, 0.0000e+00, 3.9798e+05, 3.9444e+05, 1.5898e+00, 1.7037e+00,
         3.8908e+05, 3.9083e+05, 1.7004e+00, 3.9324e+05, 1.6313e+00, 3.8769e+05,
         4.0201e+05, 1.7014e+00, 1.8903e+00, 3.9515e+05, 1.5592e+00, 1.6349e+00],
        [3.9798e+05, 3.9798e+05, 0.0000e+00, 7.9211e+05, 3.9795e+05, 3.9799e+05,
         7.9061e+05, 7.9803e+05, 3.9795e+05, 7.7277e+05, 3.9794e+05, 7.9884e+05,
         8.0310e+05, 3.9801e+05, 3.9799e+05, 8.0460e+05, 3.9795e+05, 3.9800e+05],
        [3.9443e+05, 3.9444e+05, 7.9211e+05, 0.0000e+00, 3.9445e+05, 3.9444e+05,
         7.6186e+05, 7.7146e+05, 3.9447e+05, 7.9364e+05, 3.9442e+05, 7.6241e+05,
         8.0761e+05, 3.9444e+05, 3.9443e+05, 7.9358e+05, 3.9449e+05, 3.9445e+05],
        [1.7031e+00, 1.5898e+00, 3.9795e+05, 3.9445e+05, 0.0000e+00, 1.6118e+00,
         3.8912e+05, 3.9082e+05, 1.7494e+00, 3.9323e+05, 1.7889e+00, 3.8771e+05,
         4.0200e+05, 1.6185e+00, 1.8971e+00, 3.9511e+05, 1.6139e+00, 1.7716e+00],
        [1.6660e+00, 1.7037e+00, 3.9799e+05, 3.9444e+05, 1.6118e+00, 0.0000e+00,
         3.8909e+05, 3.9080e+05, 1.7458e+00, 3.9326e+05, 1.5354e+00, 3.8771e+05,
         4.0201e+05, 1.5898e+00, 1.5667e+00, 3.9515e+05, 1.7823e+00, 1.5700e+00],
        [3.8913e+05, 3.8908e+05, 7.9061e+05, 7.6186e+05, 3.8912e+05, 3.8909e+05,
         0.0000e+00, 7.7901e+05, 3.8908e+05, 7.8535e+05, 3.8912e+05, 7.6547e+05,
         7.8543e+05, 3.8912e+05, 3.8909e+05, 7.6714e+05, 3.8910e+05, 3.8913e+05],
        [3.9084e+05, 3.9083e+05, 7.9803e+05, 7.7146e+05, 3.9082e+05, 3.9080e+05,
         7.7901e+05, 0.0000e+00, 3.9082e+05, 7.7590e+05, 3.9080e+05, 7.7028e+05,
         7.8401e+05, 3.9084e+05, 3.9083e+05, 7.7968e+05, 3.9082e+05, 3.9083e+05],
        [1.7785e+00, 1.7004e+00, 3.9795e+05, 3.9447e+05, 1.7494e+00, 1.7458e+00,
         3.8908e+05, 3.9082e+05, 0.0000e+00, 3.9324e+05, 1.6821e+00, 3.8768e+05,
         4.0200e+05, 1.6672e+00, 2.0056e+00, 3.9511e+05, 1.6556e+00, 1.6689e+00],
        [3.9324e+05, 3.9324e+05, 7.7277e+05, 7.9364e+05, 3.9323e+05, 3.9326e+05,
         7.8535e+05, 7.7590e+05, 3.9324e+05, 0.0000e+00, 3.9327e+05, 7.9497e+05,
         7.8450e+05, 3.9327e+05, 3.9324e+05, 7.6861e+05, 3.9322e+05, 3.9324e+05],
        [1.5368e+00, 1.6313e+00, 3.9794e+05, 3.9442e+05, 1.7889e+00, 1.5354e+00,
         3.8912e+05, 3.9080e+05, 1.6821e+00, 3.9327e+05, 0.0000e+00, 3.8770e+05,
         4.0198e+05, 1.7213e+00, 1.6506e+00, 3.9510e+05, 1.9465e+00, 1.4526e+00],
        [3.8771e+05, 3.8769e+05, 7.9884e+05, 7.6241e+05, 3.8771e+05, 3.8771e+05,
         7.6547e+05, 7.7028e+05, 3.8768e+05, 7.9497e+05, 3.8770e+05, 0.0000e+00,
         7.9415e+05, 3.8771e+05, 3.8771e+05, 7.9796e+05, 3.8773e+05, 3.8772e+05],
        [4.0198e+05, 4.0201e+05, 8.0310e+05, 8.0761e+05, 4.0200e+05, 4.0201e+05,
         7.8543e+05, 7.8401e+05, 4.0200e+05, 7.8450e+05, 4.0198e+05, 7.9415e+05,
         0.0000e+00, 4.0200e+05, 4.0200e+05, 7.9455e+05, 4.0200e+05, 4.0200e+05],
        [1.5929e+00, 1.7014e+00, 3.9801e+05, 3.9444e+05, 1.6185e+00, 1.5898e+00,
         3.8912e+05, 3.9084e+05, 1.6672e+00, 3.9327e+05, 1.7213e+00, 3.8771e+05,
         4.0200e+05, 0.0000e+00, 1.7868e+00, 3.9510e+05, 1.7590e+00, 1.5540e+00],
        [1.8414e+00, 1.8903e+00, 3.9799e+05, 3.9443e+05, 1.8971e+00, 1.5667e+00,
         3.8909e+05, 3.9083e+05, 2.0056e+00, 3.9324e+05, 1.6506e+00, 3.8771e+05,
         4.0200e+05, 1.7868e+00, 0.0000e+00, 3.9516e+05, 2.1647e+00, 1.7067e+00],
        [3.9513e+05, 3.9515e+05, 8.0460e+05, 7.9358e+05, 3.9511e+05, 3.9515e+05,
         7.6714e+05, 7.7968e+05, 3.9511e+05, 7.6861e+05, 3.9510e+05, 7.9796e+05,
         7.9455e+05, 3.9510e+05, 3.9516e+05, 0.0000e+00, 3.9514e+05, 3.9512e+05],
        [1.7463e+00, 1.5592e+00, 3.9795e+05, 3.9449e+05, 1.6139e+00, 1.7823e+00,
         3.8910e+05, 3.9082e+05, 1.6556e+00, 3.9322e+05, 1.9465e+00, 3.8773e+05,
         4.0200e+05, 1.7590e+00, 2.1647e+00, 3.9514e+05, 0.0000e+00, 1.8341e+00],
        [1.5975e+00, 1.6349e+00, 3.9800e+05, 3.9445e+05, 1.7716e+00, 1.5700e+00,
         3.8913e+05, 3.9083e+05, 1.6689e+00, 3.9324e+05, 1.4526e+00, 3.8772e+05,
         4.0200e+05, 1.5540e+00, 1.7067e+00, 3.9512e+05, 1.8341e+00, 0.0000e+00]])
Krum scores: ['1.67', '1.65', '397966.06', '394438.00', '1.68', '1.62', '389099.03', '390820.44', '1.71', '393237.12', '1.62', '387701.47', '401993.56', '1.65', '1.79', '395120.38', '1.74', '1.62']
Selected index: 17
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Chosen Update']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0209s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:16...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0023 seconds (Start: 2025-07-22 15:31:16, End: 2025-07-22 15:31:16)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 1.4963e+00, 1.6768e+00, 4.0244e+05, 3.8814e+05, 1.5677e+00,
         1.5619e+00, 3.9097e+05, 3.9118e+05, 1.7109e+00, 3.8675e+05, 1.5568e+00,
         1.5050e+00, 3.9449e+05, 3.8060e+05, 1.4222e+00, 1.6517e+00, 1.6043e+00,
         1.6778e+00],
        [1.4963e+00, 0.0000e+00, 1.4619e+00, 4.0248e+05, 3.8814e+05, 1.5215e+00,
         1.6018e+00, 3.9092e+05, 3.9118e+05, 1.6000e+00, 3.8674e+05, 1.5340e+00,
         1.6613e+00, 3.9450e+05, 3.8056e+05, 1.4622e+00, 1.7416e+00, 1.5599e+00,
         1.8759e+00],
        [1.6768e+00, 1.4619e+00, 0.0000e+00, 4.0249e+05, 3.8817e+05, 1.4799e+00,
         1.5092e+00, 3.9091e+05, 3.9119e+05, 1.6309e+00, 3.8673e+05, 1.6399e+00,
         1.5656e+00, 3.9450e+05, 3.8056e+05, 1.5332e+00, 1.6803e+00, 1.4956e+00,
         1.8396e+00],
        [4.0244e+05, 4.0248e+05, 4.0249e+05, 0.0000e+00, 8.0042e+05, 4.0246e+05,
         4.0249e+05, 7.8890e+05, 7.8597e+05, 4.0246e+05, 7.7960e+05, 4.0248e+05,
         4.0249e+05, 7.9401e+05, 7.7433e+05, 4.0249e+05, 4.0246e+05, 4.0246e+05,
         4.0250e+05],
        [3.8814e+05, 3.8814e+05, 3.8817e+05, 8.0042e+05, 0.0000e+00, 3.8815e+05,
         3.8818e+05, 7.8570e+05, 7.6527e+05, 3.8811e+05, 7.5568e+05, 3.8812e+05,
         3.8814e+05, 7.7200e+05, 7.9031e+05, 3.8815e+05, 3.8815e+05, 3.8812e+05,
         3.8812e+05],
        [1.5677e+00, 1.5215e+00, 1.4799e+00, 4.0246e+05, 3.8815e+05, 0.0000e+00,
         1.4503e+00, 3.9094e+05, 3.9119e+05, 1.6195e+00, 3.8671e+05, 1.6000e+00,
         1.6627e+00, 3.9456e+05, 3.8056e+05, 1.4499e+00, 1.6863e+00, 1.5193e+00,
         1.8493e+00],
        [1.5619e+00, 1.6018e+00, 1.5092e+00, 4.0249e+05, 3.8818e+05, 1.4503e+00,
         0.0000e+00, 3.9096e+05, 3.9119e+05, 1.5783e+00, 3.8676e+05, 1.5493e+00,
         1.4252e+00, 3.9452e+05, 3.8057e+05, 1.3541e+00, 1.3436e+00, 1.6048e+00,
         1.5364e+00],
        [3.9097e+05, 3.9092e+05, 3.9091e+05, 7.8890e+05, 7.8570e+05, 3.9094e+05,
         3.9096e+05, 0.0000e+00, 7.9880e+05, 3.9092e+05, 7.7614e+05, 3.9096e+05,
         3.9097e+05, 7.8868e+05, 7.4529e+05, 3.9093e+05, 3.9092e+05, 3.9092e+05,
         3.9098e+05],
        [3.9118e+05, 3.9118e+05, 3.9119e+05, 7.8597e+05, 7.6527e+05, 3.9119e+05,
         3.9119e+05, 7.9880e+05, 0.0000e+00, 3.9117e+05, 7.7395e+05, 3.9118e+05,
         3.9119e+05, 7.8078e+05, 7.6698e+05, 3.9118e+05, 3.9120e+05, 3.9118e+05,
         3.9119e+05],
        [1.7109e+00, 1.6000e+00, 1.6309e+00, 4.0246e+05, 3.8811e+05, 1.6195e+00,
         1.5783e+00, 3.9092e+05, 3.9117e+05, 0.0000e+00, 3.8672e+05, 1.5470e+00,
         1.6065e+00, 3.9449e+05, 3.8057e+05, 1.5278e+00, 1.7462e+00, 1.5550e+00,
         1.8064e+00],
        [3.8675e+05, 3.8674e+05, 3.8673e+05, 7.7960e+05, 7.5568e+05, 3.8671e+05,
         3.8676e+05, 7.7614e+05, 7.7395e+05, 3.8672e+05, 0.0000e+00, 3.8673e+05,
         3.8675e+05, 7.7565e+05, 7.7303e+05, 3.8674e+05, 3.8671e+05, 3.8672e+05,
         3.8675e+05],
        [1.5568e+00, 1.5340e+00, 1.6399e+00, 4.0248e+05, 3.8812e+05, 1.6000e+00,
         1.5493e+00, 3.9096e+05, 3.9118e+05, 1.5470e+00, 3.8673e+05, 0.0000e+00,
         1.6238e+00, 3.9450e+05, 3.8060e+05, 1.4548e+00, 1.7917e+00, 1.5550e+00,
         1.8118e+00],
        [1.5050e+00, 1.6613e+00, 1.5656e+00, 4.0249e+05, 3.8814e+05, 1.6627e+00,
         1.4252e+00, 3.9097e+05, 3.9119e+05, 1.6065e+00, 3.8675e+05, 1.6238e+00,
         0.0000e+00, 3.9451e+05, 3.8057e+05, 1.5549e+00, 1.4580e+00, 1.7842e+00,
         1.4099e+00],
        [3.9449e+05, 3.9450e+05, 3.9450e+05, 7.9401e+05, 7.7200e+05, 3.9456e+05,
         3.9452e+05, 7.8868e+05, 7.8078e+05, 3.9449e+05, 7.7565e+05, 3.9450e+05,
         3.9451e+05, 0.0000e+00, 7.6478e+05, 3.9454e+05, 3.9450e+05, 3.9451e+05,
         3.9451e+05],
        [3.8060e+05, 3.8056e+05, 3.8056e+05, 7.7433e+05, 7.9031e+05, 3.8056e+05,
         3.8057e+05, 7.4529e+05, 7.6698e+05, 3.8057e+05, 7.7303e+05, 3.8060e+05,
         3.8057e+05, 7.6478e+05, 0.0000e+00, 3.8056e+05, 3.8055e+05, 3.8058e+05,
         3.8057e+05],
        [1.4222e+00, 1.4622e+00, 1.5332e+00, 4.0249e+05, 3.8815e+05, 1.4499e+00,
         1.3541e+00, 3.9093e+05, 3.9118e+05, 1.5278e+00, 3.8674e+05, 1.4548e+00,
         1.5549e+00, 3.9454e+05, 3.8056e+05, 0.0000e+00, 1.5217e+00, 1.5429e+00,
         1.5926e+00],
        [1.6517e+00, 1.7416e+00, 1.6803e+00, 4.0246e+05, 3.8815e+05, 1.6863e+00,
         1.3436e+00, 3.9092e+05, 3.9120e+05, 1.7462e+00, 3.8671e+05, 1.7917e+00,
         1.4580e+00, 3.9450e+05, 3.8055e+05, 1.5217e+00, 0.0000e+00, 1.8846e+00,
         1.4910e+00],
        [1.6043e+00, 1.5599e+00, 1.4956e+00, 4.0246e+05, 3.8812e+05, 1.5193e+00,
         1.6048e+00, 3.9092e+05, 3.9118e+05, 1.5550e+00, 3.8672e+05, 1.5550e+00,
         1.7842e+00, 3.9451e+05, 3.8058e+05, 1.5429e+00, 1.8846e+00, 0.0000e+00,
         2.0325e+00],
        [1.6778e+00, 1.8759e+00, 1.8396e+00, 4.0250e+05, 3.8812e+05, 1.8493e+00,
         1.5364e+00, 3.9098e+05, 3.9119e+05, 1.8064e+00, 3.8675e+05, 1.8118e+00,
         1.4099e+00, 3.9451e+05, 3.8057e+05, 1.5926e+00, 1.4910e+00, 2.0325e+00,
         0.0000e+00]])
Krum scores: ['1.57', '1.56', '1.57', '402471.00', '388134.03', '1.56', '1.49', '390935.38', '391182.72', '1.61', '386730.34', '1.59', '1.55', '394503.38', '380565.00', '1.48', '1.61', '1.61', '1.69']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0056s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:17...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:17, End: 2025-07-22 15:31:17)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6360e+00, 3.7851e+05, 1.5362e+00, 1.5986e+00, 3.9750e+05,
         1.6883e+00, 3.8674e+05, 1.5536e+00, 1.4447e+00, 3.9736e+05, 3.9089e+05,
         1.5753e+00, 3.8996e+05, 1.6329e+00, 1.6304e+00],
        [1.6360e+00, 0.0000e+00, 3.7852e+05, 1.4641e+00, 1.5423e+00, 3.9748e+05,
         1.6680e+00, 3.8674e+05, 1.5853e+00, 1.5296e+00, 3.9737e+05, 3.9089e+05,
         1.6557e+00, 3.9002e+05, 1.4976e+00, 1.7785e+00],
        [3.7851e+05, 3.7852e+05, 0.0000e+00, 3.7851e+05, 3.7850e+05, 7.7989e+05,
         3.7853e+05, 7.7455e+05, 3.7851e+05, 3.7852e+05, 7.8514e+05, 7.7013e+05,
         3.7849e+05, 7.5037e+05, 3.7851e+05, 3.7851e+05],
        [1.5362e+00, 1.4641e+00, 3.7851e+05, 0.0000e+00, 1.4471e+00, 3.9748e+05,
         1.6445e+00, 3.8672e+05, 1.5713e+00, 1.5997e+00, 3.9734e+05, 3.9092e+05,
         1.5982e+00, 3.8996e+05, 1.4873e+00, 1.7806e+00],
        [1.5986e+00, 1.5423e+00, 3.7850e+05, 1.4471e+00, 0.0000e+00, 3.9747e+05,
         1.5781e+00, 3.8671e+05, 1.5157e+00, 1.3897e+00, 3.9735e+05, 3.9089e+05,
         1.3518e+00, 3.8997e+05, 1.6092e+00, 1.4960e+00],
        [3.9750e+05, 3.9748e+05, 7.7989e+05, 3.9748e+05, 3.9747e+05, 0.0000e+00,
         3.9747e+05, 7.6615e+05, 3.9748e+05, 3.9746e+05, 8.1627e+05, 7.8700e+05,
         3.9748e+05, 7.8688e+05, 3.9750e+05, 3.9748e+05],
        [1.6883e+00, 1.6680e+00, 3.7853e+05, 1.6445e+00, 1.5781e+00, 3.9747e+05,
         0.0000e+00, 3.8676e+05, 1.5371e+00, 1.6015e+00, 3.9735e+05, 3.9090e+05,
         1.6782e+00, 3.9002e+05, 1.5962e+00, 1.7447e+00],
        [3.8674e+05, 3.8674e+05, 7.7455e+05, 3.8672e+05, 3.8671e+05, 7.6615e+05,
         3.8676e+05, 0.0000e+00, 3.8672e+05, 3.8674e+05, 7.7186e+05, 7.9075e+05,
         3.8672e+05, 7.8253e+05, 3.8676e+05, 3.8674e+05],
        [1.5536e+00, 1.5853e+00, 3.7851e+05, 1.5713e+00, 1.5157e+00, 3.9748e+05,
         1.5371e+00, 3.8672e+05, 0.0000e+00, 1.5567e+00, 3.9735e+05, 3.9091e+05,
         1.6953e+00, 3.9000e+05, 1.5609e+00, 1.7559e+00],
        [1.4447e+00, 1.5296e+00, 3.7852e+05, 1.5997e+00, 1.3897e+00, 3.9746e+05,
         1.6015e+00, 3.8674e+05, 1.5567e+00, 0.0000e+00, 3.9738e+05, 3.9092e+05,
         1.4064e+00, 3.8997e+05, 1.7872e+00, 1.3791e+00],
        [3.9736e+05, 3.9737e+05, 7.8514e+05, 3.9734e+05, 3.9735e+05, 8.1627e+05,
         3.9735e+05, 7.7186e+05, 3.9735e+05, 3.9738e+05, 0.0000e+00, 7.8632e+05,
         3.9736e+05, 7.7666e+05, 3.9735e+05, 3.9736e+05],
        [3.9089e+05, 3.9089e+05, 7.7013e+05, 3.9092e+05, 3.9089e+05, 7.8700e+05,
         3.9090e+05, 7.9075e+05, 3.9091e+05, 3.9092e+05, 7.8632e+05, 0.0000e+00,
         3.9088e+05, 7.9432e+05, 3.9090e+05, 3.9087e+05],
        [1.5753e+00, 1.6557e+00, 3.7849e+05, 1.5982e+00, 1.3518e+00, 3.9748e+05,
         1.6782e+00, 3.8672e+05, 1.6953e+00, 1.4064e+00, 3.9736e+05, 3.9088e+05,
         0.0000e+00, 3.8998e+05, 1.7954e+00, 1.3920e+00],
        [3.8996e+05, 3.9002e+05, 7.5037e+05, 3.8996e+05, 3.8997e+05, 7.8688e+05,
         3.9002e+05, 7.8253e+05, 3.9000e+05, 3.8997e+05, 7.7666e+05, 7.9432e+05,
         3.8998e+05, 0.0000e+00, 3.9002e+05, 3.8999e+05],
        [1.6329e+00, 1.4976e+00, 3.7851e+05, 1.4873e+00, 1.6092e+00, 3.9750e+05,
         1.5962e+00, 3.8676e+05, 1.5609e+00, 1.7872e+00, 3.9735e+05, 3.9090e+05,
         1.7954e+00, 3.9002e+05, 0.0000e+00, 2.0072e+00],
        [1.6304e+00, 1.7785e+00, 3.7851e+05, 1.7806e+00, 1.4960e+00, 3.9748e+05,
         1.7447e+00, 3.8674e+05, 1.7559e+00, 1.3791e+00, 3.9736e+05, 3.9087e+05,
         1.3920e+00, 3.8999e+05, 2.0072e+00, 0.0000e+00]])
Krum scores: ['1.58', '1.57', '378505.22', '1.54', '1.49', '397475.97', '1.62', '386729.22', '1.57', '1.49', '397352.41', '390893.00', '1.54', '389981.31', '1.62', '1.62']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:17...
global Accuracy on shared test data: 78.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:17, End: 2025-07-22 15:31:17)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [5, 7, 19, 17, 9, 20, 18, 8, 3, 14, 11, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 1.4101e+00, 3.9037e+05, 4.0289e+05, 1.4400e+00, 3.8089e+05,
         3.8545e+05, 1.5471e+00, 1.6663e+00, 3.9005e+05, 1.4168e+00, 1.4707e+00],
        [1.4101e+00, 0.0000e+00, 3.9037e+05, 4.0287e+05, 1.4709e+00, 3.8090e+05,
         3.8545e+05, 1.4399e+00, 2.0191e+00, 3.9001e+05, 1.5471e+00, 1.6056e+00],
        [3.9037e+05, 3.9037e+05, 0.0000e+00, 7.9115e+05, 3.9036e+05, 7.7333e+05,
         7.7630e+05, 3.9038e+05, 3.9036e+05, 7.7656e+05, 3.9037e+05, 3.9035e+05],
        [4.0289e+05, 4.0287e+05, 7.9115e+05, 0.0000e+00, 4.0286e+05, 8.1580e+05,
         8.1391e+05, 4.0287e+05, 4.0285e+05, 7.9272e+05, 4.0286e+05, 4.0287e+05],
        [1.4400e+00, 1.4709e+00, 3.9036e+05, 4.0286e+05, 0.0000e+00, 3.8091e+05,
         3.8546e+05, 1.3846e+00, 1.5278e+00, 3.9004e+05, 1.2433e+00, 1.3161e+00],
        [3.8089e+05, 3.8090e+05, 7.7333e+05, 8.1580e+05, 3.8091e+05, 0.0000e+00,
         7.7342e+05, 3.8087e+05, 3.8091e+05, 7.7155e+05, 3.8089e+05, 3.8091e+05],
        [3.8545e+05, 3.8545e+05, 7.7630e+05, 8.1391e+05, 3.8546e+05, 7.7342e+05,
         0.0000e+00, 3.8543e+05, 3.8543e+05, 7.9845e+05, 3.8546e+05, 3.8545e+05],
        [1.5471e+00, 1.4399e+00, 3.9038e+05, 4.0287e+05, 1.3846e+00, 3.8087e+05,
         3.8543e+05, 0.0000e+00, 1.8528e+00, 3.9002e+05, 1.5462e+00, 1.5066e+00],
        [1.6663e+00, 2.0191e+00, 3.9036e+05, 4.0285e+05, 1.5278e+00, 3.8091e+05,
         3.8543e+05, 1.8528e+00, 0.0000e+00, 3.9006e+05, 1.4343e+00, 1.3080e+00],
        [3.9005e+05, 3.9001e+05, 7.7656e+05, 7.9272e+05, 3.9004e+05, 7.7155e+05,
         7.9845e+05, 3.9002e+05, 3.9006e+05, 0.0000e+00, 3.9003e+05, 3.9006e+05],
        [1.4168e+00, 1.5471e+00, 3.9037e+05, 4.0286e+05, 1.2433e+00, 3.8089e+05,
         3.8546e+05, 1.5462e+00, 1.4343e+00, 3.9003e+05, 0.0000e+00, 1.2509e+00],
        [1.4707e+00, 1.6056e+00, 3.9035e+05, 4.0287e+05, 1.3161e+00, 3.8091e+05,
         3.8545e+05, 1.5066e+00, 1.3080e+00, 3.9006e+05, 1.2509e+00, 0.0000e+00]])
Krum scores: ['1.46', '1.49', '390362.38', '402860.38', '1.37', '380892.66', '385442.22', '1.48', '1.56', '390028.34', '1.38', '1.37']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 8, 3, 14, 11, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0024s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:18...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:18, End: 2025-07-22 15:31:18)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 1, 9, 20, 18, 8, 15, 4, 14, 10, 16, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.2797e+00, 1.3651e+00, 1.2612e+00, 1.2811e+00, 3.9259e+05,
         3.9114e+05, 1.3805e+00, 3.8316e+05, 1.2972e+00, 3.7697e+05, 1.3245e+00,
         3.8469e+05, 1.3608e+00],
        [1.2797e+00, 0.0000e+00, 1.2282e+00, 1.2768e+00, 1.3370e+00, 3.9260e+05,
         3.9113e+05, 1.3423e+00, 3.8315e+05, 1.3092e+00, 3.7693e+05, 1.3725e+00,
         3.8468e+05, 1.3261e+00],
        [1.3651e+00, 1.2282e+00, 0.0000e+00, 1.2354e+00, 1.2254e+00, 3.9261e+05,
         3.9115e+05, 1.3354e+00, 3.8313e+05, 1.3422e+00, 3.7694e+05, 1.3522e+00,
         3.8469e+05, 1.2831e+00],
        [1.2612e+00, 1.2768e+00, 1.2354e+00, 0.0000e+00, 1.1935e+00, 3.9262e+05,
         3.9113e+05, 1.3308e+00, 3.8313e+05, 1.3284e+00, 3.7691e+05, 1.3309e+00,
         3.8468e+05, 1.2282e+00],
        [1.2811e+00, 1.3370e+00, 1.2254e+00, 1.1935e+00, 0.0000e+00, 3.9261e+05,
         3.9116e+05, 1.2794e+00, 3.8313e+05, 1.2655e+00, 3.7692e+05, 1.1125e+00,
         3.8470e+05, 1.3188e+00],
        [3.9259e+05, 3.9260e+05, 3.9261e+05, 3.9262e+05, 3.9261e+05, 0.0000e+00,
         7.7985e+05, 3.9260e+05, 7.7892e+05, 3.9259e+05, 7.6827e+05, 3.9259e+05,
         7.8133e+05, 3.9261e+05],
        [3.9114e+05, 3.9113e+05, 3.9115e+05, 3.9113e+05, 3.9116e+05, 7.7985e+05,
         0.0000e+00, 3.9111e+05, 7.6197e+05, 3.9112e+05, 7.8384e+05, 3.9111e+05,
         7.5199e+05, 3.9114e+05],
        [1.3805e+00, 1.3423e+00, 1.3354e+00, 1.3308e+00, 1.2794e+00, 3.9260e+05,
         3.9111e+05, 0.0000e+00, 3.8313e+05, 1.2894e+00, 3.7692e+05, 1.3818e+00,
         3.8466e+05, 1.2778e+00],
        [3.8316e+05, 3.8315e+05, 3.8313e+05, 3.8313e+05, 3.8313e+05, 7.7892e+05,
         7.6197e+05, 3.8313e+05, 0.0000e+00, 3.8313e+05, 7.3987e+05, 3.8314e+05,
         7.7555e+05, 3.8312e+05],
        [1.2972e+00, 1.3092e+00, 1.3422e+00, 1.3284e+00, 1.2655e+00, 3.9259e+05,
         3.9112e+05, 1.2894e+00, 3.8313e+05, 0.0000e+00, 3.7693e+05, 1.4362e+00,
         3.8469e+05, 1.2933e+00],
        [3.7697e+05, 3.7693e+05, 3.7694e+05, 3.7691e+05, 3.7692e+05, 7.6827e+05,
         7.8384e+05, 3.7692e+05, 7.3987e+05, 3.7693e+05, 0.0000e+00, 3.7693e+05,
         7.3868e+05, 3.7695e+05],
        [1.3245e+00, 1.3725e+00, 1.3522e+00, 1.3309e+00, 1.1125e+00, 3.9259e+05,
         3.9111e+05, 1.3818e+00, 3.8314e+05, 1.4362e+00, 3.7693e+05, 0.0000e+00,
         3.8468e+05, 1.5030e+00],
        [3.8469e+05, 3.8468e+05, 3.8469e+05, 3.8468e+05, 3.8470e+05, 7.8133e+05,
         7.5199e+05, 3.8466e+05, 7.7555e+05, 3.8469e+05, 7.3868e+05, 3.8468e+05,
         0.0000e+00, 3.8468e+05],
        [1.3608e+00, 1.3261e+00, 1.2831e+00, 1.2282e+00, 1.3188e+00, 3.9261e+05,
         3.9114e+05, 1.2778e+00, 3.8312e+05, 1.2933e+00, 3.7695e+05, 1.5030e+00,
         3.8468e+05, 0.0000e+00]])
Krum scores: ['1.31', '1.30', '1.29', '1.26', '1.24', '392598.53', '391126.03', '1.32', '383130.47', '1.30', '376926.09', '1.33', '384678.62', '1.30']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 1, 9, 20, 18, 8, 15, 4, 14, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0030s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:18...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:18, End: 2025-07-22 15:31:18)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 13, 11, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.3669e+00, 1.3918e+00, 3.8288e+05, 3.8547e+05, 1.2879e+00,
         1.5992e+00, 3.8484e+05, 3.8826e+05, 1.4275e+00, 1.3195e+00, 3.8683e+05,
         1.3466e+00, 1.3852e+00, 1.5602e+00],
        [1.3669e+00, 0.0000e+00, 1.2379e+00, 3.8289e+05, 3.8549e+05, 1.3211e+00,
         1.8022e+00, 3.8484e+05, 3.8822e+05, 1.3868e+00, 1.3431e+00, 3.8684e+05,
         1.5040e+00, 1.3493e+00, 1.8107e+00],
        [1.3918e+00, 1.2379e+00, 0.0000e+00, 3.8289e+05, 3.8545e+05, 1.2372e+00,
         1.6160e+00, 3.8482e+05, 3.8826e+05, 1.3469e+00, 1.3397e+00, 3.8683e+05,
         1.3993e+00, 1.2745e+00, 1.6223e+00],
        [3.8288e+05, 3.8289e+05, 3.8289e+05, 0.0000e+00, 7.4812e+05, 3.8291e+05,
         3.8288e+05, 7.8611e+05, 7.8460e+05, 3.8290e+05, 3.8288e+05, 7.3610e+05,
         3.8291e+05, 3.8289e+05, 3.8293e+05],
        [3.8547e+05, 3.8549e+05, 3.8545e+05, 7.4812e+05, 0.0000e+00, 3.8545e+05,
         3.8550e+05, 7.7270e+05, 7.7209e+05, 3.8548e+05, 3.8550e+05, 7.6587e+05,
         3.8551e+05, 3.8547e+05, 3.8549e+05],
        [1.2879e+00, 1.3211e+00, 1.2372e+00, 3.8291e+05, 3.8545e+05, 0.0000e+00,
         1.6260e+00, 3.8485e+05, 3.8824e+05, 1.3565e+00, 1.2957e+00, 3.8681e+05,
         1.3770e+00, 1.2317e+00, 1.6920e+00],
        [1.5992e+00, 1.8022e+00, 1.6160e+00, 3.8288e+05, 3.8550e+05, 1.6260e+00,
         0.0000e+00, 3.8487e+05, 3.8823e+05, 1.6199e+00, 1.6329e+00, 3.8683e+05,
         1.2410e+00, 1.8239e+00, 1.1446e+00],
        [3.8484e+05, 3.8484e+05, 3.8482e+05, 7.8611e+05, 7.7270e+05, 3.8485e+05,
         3.8487e+05, 0.0000e+00, 7.7482e+05, 3.8483e+05, 3.8485e+05, 7.8386e+05,
         3.8488e+05, 3.8483e+05, 3.8484e+05],
        [3.8826e+05, 3.8822e+05, 3.8826e+05, 7.8460e+05, 7.7209e+05, 3.8824e+05,
         3.8823e+05, 7.7482e+05, 0.0000e+00, 3.8823e+05, 3.8824e+05, 8.0042e+05,
         3.8829e+05, 3.8824e+05, 3.8829e+05],
        [1.4275e+00, 1.3868e+00, 1.3469e+00, 3.8290e+05, 3.8548e+05, 1.3565e+00,
         1.6199e+00, 3.8483e+05, 3.8823e+05, 0.0000e+00, 1.2830e+00, 3.8684e+05,
         1.4360e+00, 1.3218e+00, 1.6456e+00],
        [1.3195e+00, 1.3431e+00, 1.3397e+00, 3.8288e+05, 3.8550e+05, 1.2957e+00,
         1.6329e+00, 3.8485e+05, 3.8824e+05, 1.2830e+00, 0.0000e+00, 3.8681e+05,
         1.3725e+00, 1.2850e+00, 1.6415e+00],
        [3.8683e+05, 3.8684e+05, 3.8683e+05, 7.3610e+05, 7.6587e+05, 3.8681e+05,
         3.8683e+05, 7.8386e+05, 8.0042e+05, 3.8684e+05, 3.8681e+05, 0.0000e+00,
         3.8681e+05, 3.8680e+05, 3.8679e+05],
        [1.3466e+00, 1.5040e+00, 1.3993e+00, 3.8291e+05, 3.8551e+05, 1.3770e+00,
         1.2410e+00, 3.8488e+05, 3.8829e+05, 1.4360e+00, 1.3725e+00, 3.8681e+05,
         0.0000e+00, 1.5083e+00, 1.1805e+00],
        [1.3852e+00, 1.3493e+00, 1.2745e+00, 3.8289e+05, 3.8547e+05, 1.2317e+00,
         1.8239e+00, 3.8483e+05, 3.8824e+05, 1.3218e+00, 1.2850e+00, 3.8680e+05,
         1.5083e+00, 0.0000e+00, 1.9037e+00],
        [1.5602e+00, 1.8107e+00, 1.6223e+00, 3.8293e+05, 3.8549e+05, 1.6920e+00,
         1.1446e+00, 3.8484e+05, 3.8829e+05, 1.6456e+00, 1.6415e+00, 3.8679e+05,
         1.1805e+00, 1.9037e+00, 0.0000e+00]])
Krum scores: ['1.39', '1.41', '1.36', '382890.69', '385475.03', '1.34', '1.54', '384836.53', '388239.69', '1.40', '1.36', '386814.19', '1.36', '1.40', '1.54']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 13, 11, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0032s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:19...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:19, End: 2025-07-22 15:31:19)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.4898e+00, 1.5104e+00, 3.8297e+05, 1.5573e+00, 3.9161e+05,
         3.9493e+05, 1.5744e+00, 1.4566e+00, 1.5043e+00, 3.9065e+05, 3.9796e+05,
         1.4589e+00, 1.5027e+00, 3.8071e+05, 1.5439e+00, 1.6161e+00],
        [1.4898e+00, 0.0000e+00, 1.3961e+00, 3.8296e+05, 1.8071e+00, 3.9163e+05,
         3.9490e+05, 1.5113e+00, 1.4940e+00, 1.8407e+00, 3.9065e+05, 3.9800e+05,
         1.6117e+00, 1.6615e+00, 3.8073e+05, 1.5545e+00, 1.9163e+00],
        [1.5104e+00, 1.3961e+00, 0.0000e+00, 3.8300e+05, 1.6096e+00, 3.9165e+05,
         3.9491e+05, 1.4979e+00, 1.5657e+00, 1.6801e+00, 3.9062e+05, 3.9798e+05,
         1.5064e+00, 1.5356e+00, 3.8073e+05, 1.4637e+00, 1.7252e+00],
        [3.8297e+05, 3.8296e+05, 3.8300e+05, 0.0000e+00, 3.8296e+05, 7.8147e+05,
         7.7142e+05, 3.8299e+05, 3.8296e+05, 3.8297e+05, 7.7237e+05, 7.8846e+05,
         3.8296e+05, 3.8298e+05, 7.5950e+05, 3.8293e+05, 3.8298e+05],
        [1.5573e+00, 1.8071e+00, 1.6096e+00, 3.8296e+05, 0.0000e+00, 3.9160e+05,
         3.9492e+05, 1.7318e+00, 1.6955e+00, 1.4352e+00, 3.9063e+05, 3.9799e+05,
         1.3702e+00, 1.3360e+00, 3.8071e+05, 1.7514e+00, 1.4604e+00],
        [3.9161e+05, 3.9163e+05, 3.9165e+05, 7.8147e+05, 3.9160e+05, 0.0000e+00,
         7.7536e+05, 3.9160e+05, 3.9162e+05, 3.9160e+05, 7.8734e+05, 7.7770e+05,
         3.9160e+05, 3.9162e+05, 7.6948e+05, 3.9162e+05, 3.9162e+05],
        [3.9493e+05, 3.9490e+05, 3.9491e+05, 7.7142e+05, 3.9492e+05, 7.7536e+05,
         0.0000e+00, 3.9488e+05, 3.9488e+05, 3.9492e+05, 7.7900e+05, 7.8620e+05,
         3.9490e+05, 3.9492e+05, 7.7881e+05, 3.9491e+05, 3.9492e+05],
        [1.5744e+00, 1.5113e+00, 1.4979e+00, 3.8299e+05, 1.7318e+00, 3.9160e+05,
         3.9488e+05, 0.0000e+00, 1.4243e+00, 1.6459e+00, 3.9063e+05, 3.9799e+05,
         1.5323e+00, 1.5657e+00, 3.8071e+05, 1.4764e+00, 1.7164e+00],
        [1.4566e+00, 1.4940e+00, 1.5657e+00, 3.8296e+05, 1.6955e+00, 3.9162e+05,
         3.9488e+05, 1.4243e+00, 0.0000e+00, 1.6675e+00, 3.9063e+05, 3.9801e+05,
         1.5104e+00, 1.6518e+00, 3.8077e+05, 1.5196e+00, 1.7321e+00],
        [1.5043e+00, 1.8407e+00, 1.6801e+00, 3.8297e+05, 1.4352e+00, 3.9160e+05,
         3.9492e+05, 1.6459e+00, 1.6675e+00, 0.0000e+00, 3.9062e+05, 3.9803e+05,
         1.3087e+00, 1.3079e+00, 3.8069e+05, 1.9701e+00, 1.0765e+00],
        [3.9065e+05, 3.9065e+05, 3.9062e+05, 7.7237e+05, 3.9063e+05, 7.8734e+05,
         7.7900e+05, 3.9063e+05, 3.9063e+05, 3.9062e+05, 0.0000e+00, 7.9772e+05,
         3.9062e+05, 3.9061e+05, 7.8663e+05, 3.9063e+05, 3.9062e+05],
        [3.9796e+05, 3.9800e+05, 3.9798e+05, 7.8846e+05, 3.9799e+05, 7.7770e+05,
         7.8620e+05, 3.9799e+05, 3.9801e+05, 3.9803e+05, 7.9772e+05, 0.0000e+00,
         3.9800e+05, 3.9800e+05, 7.7693e+05, 3.9798e+05, 3.9800e+05],
        [1.4589e+00, 1.6117e+00, 1.5064e+00, 3.8296e+05, 1.3702e+00, 3.9160e+05,
         3.9490e+05, 1.5323e+00, 1.5104e+00, 1.3087e+00, 3.9062e+05, 3.9800e+05,
         0.0000e+00, 1.3135e+00, 3.8071e+05, 1.6203e+00, 1.2736e+00],
        [1.5027e+00, 1.6615e+00, 1.5356e+00, 3.8298e+05, 1.3360e+00, 3.9162e+05,
         3.9492e+05, 1.5657e+00, 1.6518e+00, 1.3079e+00, 3.9061e+05, 3.9800e+05,
         1.3135e+00, 0.0000e+00, 3.8069e+05, 1.7206e+00, 1.2710e+00],
        [3.8071e+05, 3.8073e+05, 3.8073e+05, 7.5950e+05, 3.8071e+05, 7.6948e+05,
         7.7881e+05, 3.8071e+05, 3.8077e+05, 3.8069e+05, 7.8663e+05, 7.7693e+05,
         3.8071e+05, 3.8069e+05, 0.0000e+00, 3.8072e+05, 3.8074e+05],
        [1.5439e+00, 1.5545e+00, 1.4637e+00, 3.8293e+05, 1.7514e+00, 3.9162e+05,
         3.9491e+05, 1.4764e+00, 1.5196e+00, 1.9701e+00, 3.9063e+05, 3.9798e+05,
         1.6203e+00, 1.7206e+00, 3.8072e+05, 0.0000e+00, 2.0006e+00],
        [1.6161e+00, 1.9163e+00, 1.7252e+00, 3.8298e+05, 1.4604e+00, 3.9162e+05,
         3.9492e+05, 1.7164e+00, 1.7321e+00, 1.0765e+00, 3.9062e+05, 3.9800e+05,
         1.2736e+00, 1.2710e+00, 3.8074e+05, 2.0006e+00, 0.0000e+00]])
Krum scores: ['1.51', '1.60', '1.53', '382962.47', '1.55', '391611.12', '394904.16', '1.55', '1.55', '1.50', '390622.00', '397988.41', '1.43', '1.46', '380710.56', '1.62', '1.53']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:19...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:19, End: 2025-07-22 15:31:19)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.3098e+00, 3.9508e+05, 3.8615e+05, 1.3372e+00, 1.4371e+00,
         3.9390e+05, 1.3915e+00, 3.8697e+05, 1.3245e+00, 1.4015e+00, 3.8648e+05,
         3.8584e+05, 1.6800e+00, 3.9566e+05, 1.3392e+00, 1.4491e+00],
        [1.3098e+00, 0.0000e+00, 3.9509e+05, 3.8613e+05, 1.4690e+00, 1.5210e+00,
         3.9389e+05, 1.3473e+00, 3.8696e+05, 1.3270e+00, 1.5930e+00, 3.8650e+05,
         3.8585e+05, 1.9034e+00, 3.9570e+05, 1.3658e+00, 1.6365e+00],
        [3.9508e+05, 3.9509e+05, 0.0000e+00, 7.8281e+05, 3.9506e+05, 3.9507e+05,
         7.8301e+05, 3.9504e+05, 8.0329e+05, 3.9506e+05, 3.9506e+05, 7.6843e+05,
         7.7613e+05, 3.9506e+05, 8.0630e+05, 3.9505e+05, 3.9507e+05],
        [3.8615e+05, 3.8613e+05, 7.8281e+05, 0.0000e+00, 3.8614e+05, 3.8615e+05,
         7.7708e+05, 3.8615e+05, 7.5178e+05, 3.8613e+05, 3.8615e+05, 7.8765e+05,
         7.6704e+05, 3.8612e+05, 8.0488e+05, 3.8614e+05, 3.8614e+05],
        [1.3372e+00, 1.4690e+00, 3.9506e+05, 3.8614e+05, 0.0000e+00, 1.1549e+00,
         3.9388e+05, 1.4242e+00, 3.8695e+05, 1.4061e+00, 1.2859e+00, 3.8650e+05,
         3.8583e+05, 1.3477e+00, 3.9563e+05, 1.4186e+00, 1.2671e+00],
        [1.4371e+00, 1.5210e+00, 3.9507e+05, 3.8615e+05, 1.1549e+00, 0.0000e+00,
         3.9389e+05, 1.3940e+00, 3.8695e+05, 1.4506e+00, 1.1212e+00, 3.8650e+05,
         3.8584e+05, 1.1908e+00, 3.9568e+05, 1.5430e+00, 1.0616e+00],
        [3.9390e+05, 3.9389e+05, 7.8301e+05, 7.7708e+05, 3.9388e+05, 3.9389e+05,
         0.0000e+00, 3.9391e+05, 7.5582e+05, 3.9388e+05, 3.9392e+05, 8.0486e+05,
         7.8648e+05, 3.9388e+05, 7.9809e+05, 3.9387e+05, 3.9392e+05],
        [1.3915e+00, 1.3473e+00, 3.9504e+05, 3.8615e+05, 1.4242e+00, 1.3940e+00,
         3.9391e+05, 0.0000e+00, 3.8696e+05, 1.2534e+00, 1.4662e+00, 3.8652e+05,
         3.8585e+05, 1.7736e+00, 3.9570e+05, 1.2963e+00, 1.5118e+00],
        [3.8697e+05, 3.8696e+05, 8.0329e+05, 7.5178e+05, 3.8695e+05, 3.8695e+05,
         7.5582e+05, 3.8696e+05, 0.0000e+00, 3.8692e+05, 3.8697e+05, 7.6580e+05,
         7.7767e+05, 3.8695e+05, 7.4498e+05, 3.8695e+05, 3.8696e+05],
        [1.3245e+00, 1.3270e+00, 3.9506e+05, 3.8613e+05, 1.4061e+00, 1.4506e+00,
         3.9388e+05, 1.2534e+00, 3.8692e+05, 0.0000e+00, 1.4961e+00, 3.8650e+05,
         3.8584e+05, 1.7570e+00, 3.9566e+05, 1.3186e+00, 1.5507e+00],
        [1.4015e+00, 1.5930e+00, 3.9506e+05, 3.8615e+05, 1.2859e+00, 1.1212e+00,
         3.9392e+05, 1.4662e+00, 3.8697e+05, 1.4961e+00, 0.0000e+00, 3.8652e+05,
         3.8584e+05, 1.2593e+00, 3.9569e+05, 1.7166e+00, 1.0259e+00],
        [3.8648e+05, 3.8650e+05, 7.6843e+05, 7.8765e+05, 3.8650e+05, 3.8650e+05,
         8.0486e+05, 3.8652e+05, 7.6580e+05, 3.8650e+05, 3.8652e+05, 0.0000e+00,
         7.8130e+05, 3.8651e+05, 7.8691e+05, 3.8649e+05, 3.8649e+05],
        [3.8584e+05, 3.8585e+05, 7.7613e+05, 7.6704e+05, 3.8583e+05, 3.8584e+05,
         7.8648e+05, 3.8585e+05, 7.7767e+05, 3.8584e+05, 3.8584e+05, 7.8130e+05,
         0.0000e+00, 3.8582e+05, 7.7956e+05, 3.8585e+05, 3.8584e+05],
        [1.6800e+00, 1.9034e+00, 3.9506e+05, 3.8612e+05, 1.3477e+00, 1.1908e+00,
         3.9388e+05, 1.7736e+00, 3.8695e+05, 1.7570e+00, 1.2593e+00, 3.8651e+05,
         3.8582e+05, 0.0000e+00, 3.9566e+05, 1.9257e+00, 1.1543e+00],
        [3.9566e+05, 3.9570e+05, 8.0630e+05, 8.0488e+05, 3.9563e+05, 3.9568e+05,
         7.9809e+05, 3.9570e+05, 7.4498e+05, 3.9566e+05, 3.9569e+05, 7.8691e+05,
         7.7956e+05, 3.9566e+05, 0.0000e+00, 3.9568e+05, 3.9566e+05],
        [1.3392e+00, 1.3658e+00, 3.9505e+05, 3.8614e+05, 1.4186e+00, 1.5430e+00,
         3.9387e+05, 1.2963e+00, 3.8695e+05, 1.3186e+00, 1.7166e+00, 3.8649e+05,
         3.8585e+05, 1.9257e+00, 3.9568e+05, 0.0000e+00, 1.7152e+00],
        [1.4491e+00, 1.6365e+00, 3.9507e+05, 3.8614e+05, 1.2671e+00, 1.0616e+00,
         3.9392e+05, 1.5118e+00, 3.8696e+05, 1.5507e+00, 1.0259e+00, 3.8649e+05,
         3.8584e+05, 1.1543e+00, 3.9566e+05, 1.7152e+00, 0.0000e+00]])
Krum scores: ['1.37', '1.45', '395057.91', '386136.91', '1.33', '1.29', '393886.47', '1.39', '386949.75', '1.39', '1.33', '386498.22', '385837.88', '1.51', '395666.03', '1.46', '1.33']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:20...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:20, End: 2025-07-22 15:31:20)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.1546e+00, 4.0671e+05, 4.0358e+05, 1.1497e+00, 1.7030e+00,
         3.8720e+05, 3.9478e+05, 1.2064e+00, 3.8474e+05, 1.2412e+00, 4.0878e+05,
         3.8313e+05, 1.3601e+00, 1.1531e+00, 4.0248e+05, 1.1252e+00, 1.2460e+00],
        [1.1546e+00, 0.0000e+00, 4.0668e+05, 4.0359e+05, 1.2856e+00, 1.8904e+00,
         3.8723e+05, 3.9479e+05, 1.2125e+00, 3.8474e+05, 1.4282e+00, 4.0877e+05,
         3.8315e+05, 1.5409e+00, 1.2757e+00, 4.0248e+05, 1.1856e+00, 1.4604e+00],
        [4.0671e+05, 4.0668e+05, 0.0000e+00, 8.1185e+05, 4.0673e+05, 4.0674e+05,
         7.8889e+05, 8.1489e+05, 4.0671e+05, 7.9970e+05, 4.0675e+05, 8.0900e+05,
         7.9229e+05, 4.0672e+05, 4.0674e+05, 8.0889e+05, 4.0671e+05, 4.0674e+05],
        [4.0358e+05, 4.0359e+05, 8.1185e+05, 0.0000e+00, 4.0358e+05, 4.0357e+05,
         7.9598e+05, 7.8335e+05, 4.0359e+05, 7.9054e+05, 4.0358e+05, 8.2873e+05,
         7.7263e+05, 4.0358e+05, 4.0357e+05, 8.0524e+05, 4.0358e+05, 4.0356e+05],
        [1.1497e+00, 1.2856e+00, 4.0673e+05, 4.0358e+05, 0.0000e+00, 1.3363e+00,
         3.8720e+05, 3.9481e+05, 1.2541e+00, 3.8474e+05, 1.1307e+00, 4.0882e+05,
         3.8313e+05, 1.1054e+00, 1.0219e+00, 4.0248e+05, 1.1887e+00, 1.1066e+00],
        [1.7030e+00, 1.8904e+00, 4.0674e+05, 4.0357e+05, 1.3363e+00, 0.0000e+00,
         3.8716e+05, 3.9482e+05, 1.7401e+00, 3.8473e+05, 1.1820e+00, 4.0882e+05,
         3.8311e+05, 1.0144e+00, 1.2671e+00, 4.0250e+05, 1.8626e+00, 1.0965e+00],
        [3.8720e+05, 3.8723e+05, 7.8889e+05, 7.9598e+05, 3.8720e+05, 3.8716e+05,
         0.0000e+00, 7.8331e+05, 3.8720e+05, 7.6334e+05, 3.8721e+05, 8.1123e+05,
         7.5264e+05, 3.8717e+05, 3.8719e+05, 7.8991e+05, 3.8717e+05, 3.8715e+05],
        [3.9478e+05, 3.9479e+05, 8.1489e+05, 7.8335e+05, 3.9481e+05, 3.9482e+05,
         7.8331e+05, 0.0000e+00, 3.9479e+05, 7.5870e+05, 3.9480e+05, 8.1250e+05,
         7.5920e+05, 3.9482e+05, 3.9480e+05, 7.9127e+05, 3.9477e+05, 3.9480e+05],
        [1.2064e+00, 1.2125e+00, 4.0671e+05, 4.0359e+05, 1.2541e+00, 1.7401e+00,
         3.8720e+05, 3.9479e+05, 0.0000e+00, 3.8475e+05, 1.2711e+00, 4.0880e+05,
         3.8317e+05, 1.4336e+00, 1.2090e+00, 4.0251e+05, 1.1312e+00, 1.3396e+00],
        [3.8474e+05, 3.8474e+05, 7.9970e+05, 7.9054e+05, 3.8474e+05, 3.8473e+05,
         7.6334e+05, 7.5870e+05, 3.8475e+05, 0.0000e+00, 3.8472e+05, 7.9887e+05,
         7.5879e+05, 3.8471e+05, 3.8476e+05, 7.7861e+05, 3.8476e+05, 3.8476e+05],
        [1.2412e+00, 1.4282e+00, 4.0675e+05, 4.0358e+05, 1.1307e+00, 1.1820e+00,
         3.8721e+05, 3.9480e+05, 1.2711e+00, 3.8472e+05, 0.0000e+00, 4.0884e+05,
         3.8311e+05, 1.0549e+00, 1.0385e+00, 4.0248e+05, 1.4894e+00, 9.1604e-01],
        [4.0878e+05, 4.0877e+05, 8.0900e+05, 8.2873e+05, 4.0882e+05, 4.0882e+05,
         8.1123e+05, 8.1250e+05, 4.0880e+05, 7.9887e+05, 4.0884e+05, 0.0000e+00,
         7.9280e+05, 4.0883e+05, 4.0882e+05, 8.0232e+05, 4.0880e+05, 4.0881e+05],
        [3.8313e+05, 3.8315e+05, 7.9229e+05, 7.7263e+05, 3.8313e+05, 3.8311e+05,
         7.5264e+05, 7.5920e+05, 3.8317e+05, 7.5879e+05, 3.8311e+05, 7.9280e+05,
         0.0000e+00, 3.8310e+05, 3.8314e+05, 7.7720e+05, 3.8312e+05, 3.8313e+05],
        [1.3601e+00, 1.5409e+00, 4.0672e+05, 4.0358e+05, 1.1054e+00, 1.0144e+00,
         3.8717e+05, 3.9482e+05, 1.4336e+00, 3.8471e+05, 1.0549e+00, 4.0883e+05,
         3.8310e+05, 0.0000e+00, 1.0931e+00, 4.0248e+05, 1.4992e+00, 9.2930e-01],
        [1.1531e+00, 1.2757e+00, 4.0674e+05, 4.0357e+05, 1.0219e+00, 1.2671e+00,
         3.8719e+05, 3.9480e+05, 1.2090e+00, 3.8476e+05, 1.0385e+00, 4.0882e+05,
         3.8314e+05, 1.0931e+00, 0.0000e+00, 4.0247e+05, 1.2362e+00, 9.9982e-01],
        [4.0248e+05, 4.0248e+05, 8.0889e+05, 8.0524e+05, 4.0248e+05, 4.0250e+05,
         7.8991e+05, 7.9127e+05, 4.0251e+05, 7.7861e+05, 4.0248e+05, 8.0232e+05,
         7.7720e+05, 4.0248e+05, 4.0247e+05, 0.0000e+00, 4.0249e+05, 4.0247e+05],
        [1.1252e+00, 1.1856e+00, 4.0671e+05, 4.0358e+05, 1.1887e+00, 1.8626e+00,
         3.8717e+05, 3.9477e+05, 1.1312e+00, 3.8476e+05, 1.4894e+00, 4.0880e+05,
         3.8312e+05, 1.4992e+00, 1.2362e+00, 4.0249e+05, 0.0000e+00, 1.4660e+00],
        [1.2460e+00, 1.4604e+00, 4.0674e+05, 4.0356e+05, 1.1066e+00, 1.0965e+00,
         3.8715e+05, 3.9480e+05, 1.3396e+00, 3.8476e+05, 9.1604e-01, 4.0881e+05,
         3.8313e+05, 9.2930e-01, 9.9982e-01, 4.0247e+05, 1.4660e+00, 0.0000e+00]])
Krum scores: ['1.20', '1.32', '406717.56', '403574.38', '1.16', '1.40', '387180.56', '394792.44', '1.26', '384735.00', '1.16', '408802.41', '383119.81', '1.19', '1.13', '402478.34', '1.29', '1.14']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:21...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:21, End: 2025-07-22 15:31:21)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.1939e+00, 1.1598e+00, 3.8694e+05, 3.9441e+05, 1.4316e+00,
         3.8055e+05, 3.9150e+05, 1.1828e+00, 3.9513e+05, 1.1100e+00, 1.2209e+00,
         3.8463e+05, 3.9088e+05, 1.2382e+00, 1.5295e+00, 1.1727e+00, 1.2630e+00],
        [1.1939e+00, 0.0000e+00, 1.1512e+00, 3.8692e+05, 3.9445e+05, 1.6824e+00,
         3.8053e+05, 3.9151e+05, 1.2261e+00, 3.9514e+05, 1.2069e+00, 1.4798e+00,
         3.8461e+05, 3.9087e+05, 1.4741e+00, 1.8136e+00, 1.2205e+00, 1.5424e+00],
        [1.1598e+00, 1.1512e+00, 0.0000e+00, 3.8696e+05, 3.9446e+05, 1.5245e+00,
         3.8054e+05, 3.9151e+05, 1.1236e+00, 3.9514e+05, 1.1893e+00, 1.3004e+00,
         3.8461e+05, 3.9086e+05, 1.3263e+00, 1.6218e+00, 1.1478e+00, 1.3126e+00],
        [3.8694e+05, 3.8692e+05, 3.8696e+05, 0.0000e+00, 7.8148e+05, 3.8696e+05,
         7.6421e+05, 7.8845e+05, 3.8694e+05, 7.7919e+05, 3.8694e+05, 3.8695e+05,
         7.5500e+05, 7.8638e+05, 3.8693e+05, 3.8697e+05, 3.8694e+05, 3.8693e+05],
        [3.9441e+05, 3.9445e+05, 3.9446e+05, 7.8148e+05, 0.0000e+00, 3.9439e+05,
         7.7586e+05, 7.7453e+05, 3.9443e+05, 7.7099e+05, 3.9446e+05, 3.9439e+05,
         7.7237e+05, 7.6890e+05, 3.9439e+05, 3.9441e+05, 3.9441e+05, 3.9440e+05],
        [1.4316e+00, 1.6824e+00, 1.5245e+00, 3.8696e+05, 3.9439e+05, 0.0000e+00,
         3.8051e+05, 3.9152e+05, 1.4679e+00, 3.9514e+05, 1.5930e+00, 1.0337e+00,
         3.8462e+05, 3.9086e+05, 8.6103e-01, 9.5481e-01, 1.7307e+00, 9.5991e-01],
        [3.8055e+05, 3.8053e+05, 3.8054e+05, 7.6421e+05, 7.7586e+05, 3.8051e+05,
         0.0000e+00, 7.8669e+05, 3.8053e+05, 7.8343e+05, 3.8054e+05, 3.8054e+05,
         7.6060e+05, 7.5998e+05, 3.8053e+05, 3.8053e+05, 3.8051e+05, 3.8052e+05],
        [3.9150e+05, 3.9151e+05, 3.9151e+05, 7.8845e+05, 7.7453e+05, 3.9152e+05,
         7.8669e+05, 0.0000e+00, 3.9150e+05, 7.7273e+05, 3.9152e+05, 3.9152e+05,
         7.7514e+05, 7.9389e+05, 3.9152e+05, 3.9149e+05, 3.9148e+05, 3.9151e+05],
        [1.1828e+00, 1.2261e+00, 1.1236e+00, 3.8694e+05, 3.9443e+05, 1.4679e+00,
         3.8053e+05, 3.9150e+05, 0.0000e+00, 3.9510e+05, 1.1220e+00, 1.2556e+00,
         3.8459e+05, 3.9086e+05, 1.3222e+00, 1.6470e+00, 1.1512e+00, 1.3688e+00],
        [3.9513e+05, 3.9514e+05, 3.9514e+05, 7.7919e+05, 7.7099e+05, 3.9514e+05,
         7.8343e+05, 7.7273e+05, 3.9510e+05, 0.0000e+00, 3.9511e+05, 3.9512e+05,
         7.8547e+05, 7.8065e+05, 3.9515e+05, 3.9511e+05, 3.9512e+05, 3.9512e+05],
        [1.1100e+00, 1.2069e+00, 1.1893e+00, 3.8694e+05, 3.9446e+05, 1.5930e+00,
         3.8054e+05, 3.9152e+05, 1.1220e+00, 3.9511e+05, 0.0000e+00, 1.3493e+00,
         3.8461e+05, 3.9086e+05, 1.3423e+00, 1.7673e+00, 1.1488e+00, 1.4015e+00],
        [1.2209e+00, 1.4798e+00, 1.3004e+00, 3.8695e+05, 3.9439e+05, 1.0337e+00,
         3.8054e+05, 3.9152e+05, 1.2556e+00, 3.9512e+05, 1.3493e+00, 0.0000e+00,
         3.8464e+05, 3.9088e+05, 9.8953e-01, 1.1678e+00, 1.5371e+00, 9.2291e-01],
        [3.8463e+05, 3.8461e+05, 3.8461e+05, 7.5500e+05, 7.7237e+05, 3.8462e+05,
         7.6060e+05, 7.7514e+05, 3.8459e+05, 7.8547e+05, 3.8461e+05, 3.8464e+05,
         0.0000e+00, 7.6574e+05, 3.8462e+05, 3.8460e+05, 3.8460e+05, 3.8462e+05],
        [3.9088e+05, 3.9087e+05, 3.9086e+05, 7.8638e+05, 7.6890e+05, 3.9086e+05,
         7.5998e+05, 7.9389e+05, 3.9086e+05, 7.8065e+05, 3.9086e+05, 3.9088e+05,
         7.6574e+05, 0.0000e+00, 3.9086e+05, 3.9086e+05, 3.9083e+05, 3.9086e+05],
        [1.2382e+00, 1.4741e+00, 1.3263e+00, 3.8693e+05, 3.9439e+05, 8.6103e-01,
         3.8053e+05, 3.9152e+05, 1.3222e+00, 3.9515e+05, 1.3423e+00, 9.8953e-01,
         3.8462e+05, 3.9086e+05, 0.0000e+00, 1.0431e+00, 1.4801e+00, 8.8831e-01],
        [1.5295e+00, 1.8136e+00, 1.6218e+00, 3.8697e+05, 3.9441e+05, 9.5481e-01,
         3.8053e+05, 3.9149e+05, 1.6470e+00, 3.9511e+05, 1.7673e+00, 1.1678e+00,
         3.8460e+05, 3.9086e+05, 1.0431e+00, 0.0000e+00, 1.8539e+00, 1.0222e+00],
        [1.1727e+00, 1.2205e+00, 1.1478e+00, 3.8694e+05, 3.9441e+05, 1.7307e+00,
         3.8051e+05, 3.9148e+05, 1.1512e+00, 3.9512e+05, 1.1488e+00, 1.5371e+00,
         3.8460e+05, 3.9083e+05, 1.4801e+00, 1.8539e+00, 0.0000e+00, 1.5467e+00],
        [1.2630e+00, 1.5424e+00, 1.3126e+00, 3.8693e+05, 3.9440e+05, 9.5991e-01,
         3.8052e+05, 3.9151e+05, 1.3688e+00, 3.9512e+05, 1.4015e+00, 9.2291e-01,
         3.8462e+05, 3.9086e+05, 8.8831e-01, 1.0222e+00, 1.5467e+00, 0.0000e+00]])
Krum scores: ['1.22', '1.35', '1.25', '386938.69', '394409.44', '1.28', '380525.72', '391503.44', '1.25', '395121.00', '1.27', '1.19', '384608.81', '390859.28', '1.17', '1.40', '1.35', '1.19']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:21...
global Accuracy on shared test data: 73.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:21, End: 2025-07-22 15:31:21)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 11, 10, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0883e+00, 3.8678e+05, 3.9070e+05, 1.0656e+00, 1.2814e+00,
         3.8631e+05, 3.8714e+05, 1.1174e+00, 3.9421e+05, 1.0569e+00, 3.9806e+05,
         1.6676e+00, 1.1562e+00, 1.1176e+00, 1.1323e+00],
        [1.0883e+00, 0.0000e+00, 3.8678e+05, 3.9070e+05, 1.1709e+00, 1.4236e+00,
         3.8631e+05, 3.8717e+05, 1.1324e+00, 3.9421e+05, 1.0946e+00, 3.9807e+05,
         1.9050e+00, 1.3323e+00, 1.1459e+00, 1.3112e+00],
        [3.8678e+05, 3.8678e+05, 0.0000e+00, 7.8311e+05, 3.8681e+05, 3.8681e+05,
         7.7400e+05, 7.6019e+05, 3.8682e+05, 7.7818e+05, 3.8679e+05, 8.0253e+05,
         3.8681e+05, 3.8680e+05, 3.8678e+05, 3.8679e+05],
        [3.9070e+05, 3.9070e+05, 7.8311e+05, 0.0000e+00, 3.9066e+05, 3.9068e+05,
         7.6977e+05, 7.5836e+05, 3.9071e+05, 7.6746e+05, 3.9069e+05, 7.9240e+05,
         3.9069e+05, 3.9070e+05, 3.9067e+05, 3.9068e+05],
        [1.0656e+00, 1.1709e+00, 3.8681e+05, 3.9066e+05, 0.0000e+00, 9.9137e-01,
         3.8630e+05, 3.8712e+05, 1.0861e+00, 3.9419e+05, 1.1137e+00, 3.9809e+05,
         1.3021e+00, 9.3711e-01, 1.1024e+00, 9.7866e-01],
        [1.2814e+00, 1.4236e+00, 3.8681e+05, 3.9068e+05, 9.9137e-01, 0.0000e+00,
         3.8628e+05, 3.8717e+05, 1.2567e+00, 3.9421e+05, 1.3180e+00, 3.9806e+05,
         8.4593e-01, 7.5559e-01, 1.4155e+00, 8.3018e-01],
        [3.8631e+05, 3.8631e+05, 7.7400e+05, 7.6977e+05, 3.8630e+05, 3.8628e+05,
         0.0000e+00, 7.5364e+05, 3.8633e+05, 7.7920e+05, 3.8631e+05, 7.8981e+05,
         3.8630e+05, 3.8631e+05, 3.8631e+05, 3.8628e+05],
        [3.8714e+05, 3.8717e+05, 7.6019e+05, 7.5836e+05, 3.8712e+05, 3.8717e+05,
         7.5364e+05, 0.0000e+00, 3.8714e+05, 7.7705e+05, 3.8712e+05, 7.9280e+05,
         3.8714e+05, 3.8713e+05, 3.8715e+05, 3.8715e+05],
        [1.1174e+00, 1.1324e+00, 3.8682e+05, 3.9071e+05, 1.0861e+00, 1.2567e+00,
         3.8633e+05, 3.8714e+05, 0.0000e+00, 3.9421e+05, 1.0275e+00, 3.9806e+05,
         1.7081e+00, 1.2327e+00, 1.0598e+00, 1.2002e+00],
        [3.9421e+05, 3.9421e+05, 7.7818e+05, 7.6746e+05, 3.9419e+05, 3.9421e+05,
         7.7920e+05, 7.7705e+05, 3.9421e+05, 0.0000e+00, 3.9422e+05, 8.0055e+05,
         3.9420e+05, 3.9422e+05, 3.9423e+05, 3.9418e+05],
        [1.0569e+00, 1.0946e+00, 3.8679e+05, 3.9069e+05, 1.1137e+00, 1.3180e+00,
         3.8631e+05, 3.8712e+05, 1.0275e+00, 3.9422e+05, 0.0000e+00, 3.9808e+05,
         1.7386e+00, 1.2791e+00, 1.0771e+00, 1.2121e+00],
        [3.9806e+05, 3.9807e+05, 8.0253e+05, 7.9240e+05, 3.9809e+05, 3.9806e+05,
         7.8981e+05, 7.9280e+05, 3.9806e+05, 8.0055e+05, 3.9808e+05, 0.0000e+00,
         3.9805e+05, 3.9804e+05, 3.9808e+05, 3.9807e+05],
        [1.6676e+00, 1.9050e+00, 3.8681e+05, 3.9069e+05, 1.3021e+00, 8.4593e-01,
         3.8630e+05, 3.8714e+05, 1.7081e+00, 3.9420e+05, 1.7386e+00, 3.9805e+05,
         0.0000e+00, 9.4487e-01, 1.8710e+00, 1.0352e+00],
        [1.1562e+00, 1.3323e+00, 3.8680e+05, 3.9070e+05, 9.3711e-01, 7.5559e-01,
         3.8631e+05, 3.8713e+05, 1.2327e+00, 3.9422e+05, 1.2791e+00, 3.9804e+05,
         9.4487e-01, 0.0000e+00, 1.3451e+00, 8.0724e-01],
        [1.1176e+00, 1.1459e+00, 3.8678e+05, 3.9067e+05, 1.1024e+00, 1.4155e+00,
         3.8631e+05, 3.8715e+05, 1.0598e+00, 3.9423e+05, 1.0771e+00, 3.9808e+05,
         1.8710e+00, 1.3451e+00, 0.0000e+00, 1.3168e+00],
        [1.1323e+00, 1.3112e+00, 3.8679e+05, 3.9068e+05, 9.7866e-01, 8.3018e-01,
         3.8628e+05, 3.8715e+05, 1.2002e+00, 3.9418e+05, 1.2121e+00, 3.9807e+05,
         1.0352e+00, 8.0724e-01, 1.3168e+00, 0.0000e+00]])
Krum scores: ['1.13', '1.21', '386793.72', '390683.69', '1.06', '1.09', '386299.28', '387136.53', '1.14', '394204.53', '1.15', '398062.50', '1.39', '1.06', '1.20', '1.06']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0035s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:22...
global Accuracy on shared test data: 71.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:22, End: 2025-07-22 15:31:22)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [2, 19, 17, 1, 9, 20, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.9144e+05, 3.7421e+05, 1.0358e+00, 1.1926e+00, 4.1461e+05,
         3.8929e+05, 1.0393e+00, 1.0936e+00, 3.9130e+05, 3.9452e+05, 1.8098e+00,
         3.9724e+05, 1.0097e+00, 1.1030e+00],
        [3.9144e+05, 0.0000e+00, 7.4536e+05, 3.9145e+05, 3.9141e+05, 8.1076e+05,
         7.5838e+05, 3.9144e+05, 3.9141e+05, 7.7357e+05, 7.7477e+05, 3.9141e+05,
         7.9976e+05, 3.9145e+05, 3.9143e+05],
        [3.7421e+05, 7.4536e+05, 0.0000e+00, 3.7421e+05, 3.7422e+05, 7.8180e+05,
         7.7205e+05, 3.7420e+05, 3.7420e+05, 7.6785e+05, 7.6478e+05, 3.7422e+05,
         7.7012e+05, 3.7419e+05, 3.7419e+05],
        [1.0358e+00, 3.9145e+05, 3.7421e+05, 0.0000e+00, 9.1093e-01, 4.1460e+05,
         3.8932e+05, 1.0831e+00, 9.5581e-01, 3.9134e+05, 3.9452e+05, 1.3571e+00,
         3.9728e+05, 1.0370e+00, 9.2358e-01],
        [1.1926e+00, 3.9141e+05, 3.7422e+05, 9.1093e-01, 0.0000e+00, 4.1456e+05,
         3.8932e+05, 1.2332e+00, 8.4268e-01, 3.9131e+05, 3.9452e+05, 8.8497e-01,
         3.9726e+05, 1.2909e+00, 7.7300e-01],
        [4.1461e+05, 8.1076e+05, 7.8180e+05, 4.1460e+05, 4.1456e+05, 0.0000e+00,
         7.9095e+05, 4.1459e+05, 4.1459e+05, 7.8160e+05, 8.0024e+05, 4.1458e+05,
         7.8410e+05, 4.1463e+05, 4.1457e+05],
        [3.8929e+05, 7.5838e+05, 7.7205e+05, 3.8932e+05, 3.8932e+05, 7.9095e+05,
         0.0000e+00, 3.8930e+05, 3.8928e+05, 7.8526e+05, 7.8250e+05, 3.8932e+05,
         7.8807e+05, 3.8930e+05, 3.8932e+05],
        [1.0393e+00, 3.9144e+05, 3.7420e+05, 1.0831e+00, 1.2332e+00, 4.1459e+05,
         3.8930e+05, 0.0000e+00, 1.1217e+00, 3.9133e+05, 3.9454e+05, 1.8737e+00,
         3.9725e+05, 1.0076e+00, 1.1371e+00],
        [1.0936e+00, 3.9141e+05, 3.7420e+05, 9.5581e-01, 8.4268e-01, 4.1459e+05,
         3.8928e+05, 1.1217e+00, 0.0000e+00, 3.9130e+05, 3.9456e+05, 1.1642e+00,
         3.9727e+05, 1.2072e+00, 7.8695e-01],
        [3.9130e+05, 7.7357e+05, 7.6785e+05, 3.9134e+05, 3.9131e+05, 7.8160e+05,
         7.8526e+05, 3.9133e+05, 3.9130e+05, 0.0000e+00, 7.8168e+05, 3.9130e+05,
         7.8119e+05, 3.9127e+05, 3.9132e+05],
        [3.9452e+05, 7.7477e+05, 7.6478e+05, 3.9452e+05, 3.9452e+05, 8.0024e+05,
         7.8250e+05, 3.9454e+05, 3.9456e+05, 7.8168e+05, 0.0000e+00, 3.9454e+05,
         8.0738e+05, 3.9454e+05, 3.9453e+05],
        [1.8098e+00, 3.9141e+05, 3.7422e+05, 1.3571e+00, 8.8497e-01, 4.1458e+05,
         3.8932e+05, 1.8737e+00, 1.1642e+00, 3.9130e+05, 3.9454e+05, 0.0000e+00,
         3.9722e+05, 1.9069e+00, 1.0447e+00],
        [3.9724e+05, 7.9976e+05, 7.7012e+05, 3.9728e+05, 3.9726e+05, 7.8410e+05,
         7.8807e+05, 3.9725e+05, 3.9727e+05, 7.8119e+05, 8.0738e+05, 3.9722e+05,
         0.0000e+00, 3.9727e+05, 3.9723e+05],
        [1.0097e+00, 3.9145e+05, 3.7419e+05, 1.0370e+00, 1.2909e+00, 4.1463e+05,
         3.8930e+05, 1.0076e+00, 1.2072e+00, 3.9127e+05, 3.9454e+05, 1.9069e+00,
         3.9727e+05, 0.0000e+00, 1.1922e+00],
        [1.1030e+00, 3.9143e+05, 3.7419e+05, 9.2358e-01, 7.7300e-01, 4.1457e+05,
         3.8932e+05, 1.1371e+00, 7.8695e-01, 3.9132e+05, 3.9453e+05, 1.0447e+00,
         3.9723e+05, 1.1922e+00, 0.0000e+00]])
Krum scores: ['1.08', '391422.41', '374199.97', '0.99', '0.97', '414582.06', '389300.91', '1.10', '0.99', '391302.06', '394527.72', '1.36', '397246.75', '1.12', '0.96']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']], selected_client_indices: [2, 19, 17, 1, 9, 20, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0219s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:23...
global Accuracy on shared test data: 70.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 84 179]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:23, End: 2025-07-22 15:31:23)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 1.0028e+00, 3.8957e+05, 3.8021e+05, 9.6066e-01, 1.1176e+00,
         3.8962e+05, 3.8419e+05, 1.0122e+00, 9.6046e-01, 1.0550e+00, 3.9629e+05,
         3.8926e+05, 1.1713e+00, 1.2745e+00, 3.8406e+05, 1.0055e+00, 1.4655e+00],
        [1.0028e+00, 0.0000e+00, 3.8955e+05, 3.8022e+05, 1.0743e+00, 1.2284e+00,
         3.8963e+05, 3.8419e+05, 1.0446e+00, 1.0191e+00, 1.2211e+00, 3.9630e+05,
         3.8927e+05, 1.3778e+00, 1.4890e+00, 3.8409e+05, 1.0448e+00, 1.7494e+00],
        [3.8957e+05, 3.8955e+05, 0.0000e+00, 7.7527e+05, 3.8956e+05, 3.8957e+05,
         7.6436e+05, 7.5084e+05, 3.8956e+05, 3.8959e+05, 3.8954e+05, 7.7470e+05,
         7.8717e+05, 3.8954e+05, 3.8955e+05, 7.5678e+05, 3.8957e+05, 3.8956e+05],
        [3.8021e+05, 3.8022e+05, 7.7527e+05, 0.0000e+00, 3.8021e+05, 3.8022e+05,
         7.5933e+05, 7.7768e+05, 3.8021e+05, 3.8022e+05, 3.8022e+05, 7.8870e+05,
         7.5158e+05, 3.8021e+05, 3.8024e+05, 7.7099e+05, 3.8021e+05, 3.8022e+05],
        [9.6066e-01, 1.0743e+00, 3.8956e+05, 3.8021e+05, 0.0000e+00, 8.7973e-01,
         3.8966e+05, 3.8419e+05, 1.0575e+00, 1.0160e+00, 9.5454e-01, 3.9628e+05,
         3.8924e+05, 9.4511e-01, 1.0029e+00, 3.8408e+05, 1.0360e+00, 1.2168e+00],
        [1.1176e+00, 1.2284e+00, 3.8957e+05, 3.8022e+05, 8.7973e-01, 0.0000e+00,
         3.8966e+05, 3.8418e+05, 1.1542e+00, 1.1443e+00, 8.1305e-01, 3.9627e+05,
         3.8922e+05, 6.1587e-01, 6.4588e-01, 3.8406e+05, 1.2576e+00, 8.4805e-01],
        [3.8962e+05, 3.8963e+05, 7.6436e+05, 7.5933e+05, 3.8966e+05, 3.8966e+05,
         0.0000e+00, 7.9708e+05, 3.8963e+05, 3.8964e+05, 3.8964e+05, 7.8416e+05,
         7.6652e+05, 3.8967e+05, 3.8966e+05, 7.7247e+05, 3.8965e+05, 3.8968e+05],
        [3.8419e+05, 3.8419e+05, 7.5084e+05, 7.7768e+05, 3.8419e+05, 3.8418e+05,
         7.9708e+05, 0.0000e+00, 3.8417e+05, 3.8418e+05, 3.8417e+05, 7.8770e+05,
         7.7251e+05, 3.8417e+05, 3.8420e+05, 7.6191e+05, 3.8421e+05, 3.8418e+05],
        [1.0122e+00, 1.0446e+00, 3.8956e+05, 3.8021e+05, 1.0575e+00, 1.1542e+00,
         3.8963e+05, 3.8417e+05, 0.0000e+00, 9.9033e-01, 1.1022e+00, 3.9629e+05,
         3.8923e+05, 1.2950e+00, 1.4302e+00, 3.8408e+05, 9.7205e-01, 1.6372e+00],
        [9.6046e-01, 1.0191e+00, 3.8959e+05, 3.8022e+05, 1.0160e+00, 1.1443e+00,
         3.8964e+05, 3.8418e+05, 9.9033e-01, 0.0000e+00, 1.0919e+00, 3.9628e+05,
         3.8922e+05, 1.2378e+00, 1.4221e+00, 3.8407e+05, 1.0022e+00, 1.5682e+00],
        [1.0550e+00, 1.2211e+00, 3.8954e+05, 3.8022e+05, 9.5454e-01, 8.1305e-01,
         3.8964e+05, 3.8417e+05, 1.1022e+00, 1.0919e+00, 0.0000e+00, 3.9629e+05,
         3.8924e+05, 8.5059e-01, 8.8220e-01, 3.8406e+05, 1.2613e+00, 9.9051e-01],
        [3.9629e+05, 3.9630e+05, 7.7470e+05, 7.8870e+05, 3.9628e+05, 3.9627e+05,
         7.8416e+05, 7.8770e+05, 3.9629e+05, 3.9628e+05, 3.9629e+05, 0.0000e+00,
         7.7605e+05, 3.9627e+05, 3.9628e+05, 7.7870e+05, 3.9632e+05, 3.9628e+05],
        [3.8926e+05, 3.8927e+05, 7.8717e+05, 7.5158e+05, 3.8924e+05, 3.8922e+05,
         7.6652e+05, 7.7251e+05, 3.8923e+05, 3.8922e+05, 3.8924e+05, 7.7605e+05,
         0.0000e+00, 3.8923e+05, 3.8922e+05, 7.5619e+05, 3.8924e+05, 3.8922e+05],
        [1.1713e+00, 1.3778e+00, 3.8954e+05, 3.8021e+05, 9.4511e-01, 6.1587e-01,
         3.8967e+05, 3.8417e+05, 1.2950e+00, 1.2378e+00, 8.5059e-01, 3.9627e+05,
         3.8923e+05, 0.0000e+00, 6.0384e-01, 3.8406e+05, 1.3618e+00, 7.8552e-01],
        [1.2745e+00, 1.4890e+00, 3.8955e+05, 3.8024e+05, 1.0029e+00, 6.4588e-01,
         3.8966e+05, 3.8420e+05, 1.4302e+00, 1.4221e+00, 8.8220e-01, 3.9628e+05,
         3.8922e+05, 6.0384e-01, 0.0000e+00, 3.8405e+05, 1.5192e+00, 7.3016e-01],
        [3.8406e+05, 3.8409e+05, 7.5678e+05, 7.7099e+05, 3.8408e+05, 3.8406e+05,
         7.7247e+05, 7.6191e+05, 3.8408e+05, 3.8407e+05, 3.8406e+05, 7.7870e+05,
         7.5619e+05, 3.8406e+05, 3.8405e+05, 0.0000e+00, 3.8408e+05, 3.8407e+05],
        [1.0055e+00, 1.0448e+00, 3.8957e+05, 3.8021e+05, 1.0360e+00, 1.2576e+00,
         3.8965e+05, 3.8421e+05, 9.7205e-01, 1.0022e+00, 1.2613e+00, 3.9632e+05,
         3.8924e+05, 1.3618e+00, 1.5192e+00, 3.8408e+05, 0.0000e+00, 1.7112e+00],
        [1.4655e+00, 1.7494e+00, 3.8956e+05, 3.8022e+05, 1.2168e+00, 8.4805e-01,
         3.8968e+05, 3.8418e+05, 1.6372e+00, 1.5682e+00, 9.9051e-01, 3.9628e+05,
         3.8922e+05, 7.8552e-01, 7.3016e-01, 3.8407e+05, 1.7112e+00, 0.0000e+00]])
Krum scores: ['1.06', '1.17', '389556.22', '380214.59', '0.99', '0.94', '389643.94', '384180.31', '1.12', '1.10', '1.00', '396280.31', '389230.00', '0.99', '1.05', '384064.69', '1.16', '1.22']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0325s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:23...
global Accuracy on shared test data: 73.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:23, End: 2025-07-22 15:31:23)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 2, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.0181e+00, 3.8862e+05, 3.9357e+05, 9.3822e-01, 1.4854e+00,
         4.0375e+05, 9.9677e-01, 3.9317e+05, 9.4490e-01, 1.0013e+00, 3.7801e+05,
         4.1377e+05, 1.1318e+00, 1.1643e+00, 3.9933e+05, 1.0916e+00],
        [1.0181e+00, 0.0000e+00, 3.8867e+05, 3.9354e+05, 9.5793e-01, 1.5484e+00,
         4.0373e+05, 9.6623e-01, 3.9319e+05, 1.0256e+00, 1.0379e+00, 3.7798e+05,
         4.1375e+05, 1.2172e+00, 1.2490e+00, 3.9932e+05, 1.1517e+00],
        [3.8862e+05, 3.8867e+05, 0.0000e+00, 7.7844e+05, 3.8863e+05, 3.8865e+05,
         7.8827e+05, 3.8864e+05, 7.8950e+05, 3.8864e+05, 3.8864e+05, 7.7963e+05,
         7.8809e+05, 3.8864e+05, 3.8865e+05, 7.4825e+05, 3.8864e+05],
        [3.9357e+05, 3.9354e+05, 7.7844e+05, 0.0000e+00, 3.9353e+05, 3.9353e+05,
         7.9039e+05, 3.9354e+05, 7.9673e+05, 3.9354e+05, 3.9353e+05, 7.7220e+05,
         8.3005e+05, 3.9351e+05, 3.9355e+05, 8.0364e+05, 3.9353e+05],
        [9.3822e-01, 9.5793e-01, 3.8863e+05, 3.9353e+05, 0.0000e+00, 1.2016e+00,
         4.0376e+05, 9.9761e-01, 3.9319e+05, 9.5913e-01, 9.1156e-01, 3.7799e+05,
         4.1375e+05, 9.1193e-01, 9.2244e-01, 3.9931e+05, 8.8920e-01],
        [1.4854e+00, 1.5484e+00, 3.8865e+05, 3.9353e+05, 1.2016e+00, 0.0000e+00,
         4.0372e+05, 1.5303e+00, 3.9320e+05, 1.5624e+00, 1.0412e+00, 3.7801e+05,
         4.1377e+05, 6.7872e-01, 6.6279e-01, 3.9936e+05, 6.8672e-01],
        [4.0375e+05, 4.0373e+05, 7.8827e+05, 7.9039e+05, 4.0376e+05, 4.0372e+05,
         0.0000e+00, 4.0378e+05, 8.0985e+05, 4.0373e+05, 4.0373e+05, 7.6618e+05,
         7.8222e+05, 4.0372e+05, 4.0373e+05, 8.1672e+05, 4.0373e+05],
        [9.9677e-01, 9.6623e-01, 3.8864e+05, 3.9354e+05, 9.9761e-01, 1.5303e+00,
         4.0378e+05, 0.0000e+00, 3.9319e+05, 9.4283e-01, 9.9428e-01, 3.7798e+05,
         4.1376e+05, 1.1827e+00, 1.2335e+00, 3.9935e+05, 1.1512e+00],
        [3.9317e+05, 3.9319e+05, 7.8950e+05, 7.9673e+05, 3.9319e+05, 3.9320e+05,
         8.0985e+05, 3.9319e+05, 0.0000e+00, 3.9320e+05, 3.9319e+05, 7.7621e+05,
         7.9675e+05, 3.9318e+05, 3.9321e+05, 7.9575e+05, 3.9319e+05],
        [9.4490e-01, 1.0256e+00, 3.8864e+05, 3.9354e+05, 9.5913e-01, 1.5624e+00,
         4.0373e+05, 9.4283e-01, 3.9320e+05, 0.0000e+00, 1.0259e+00, 3.7801e+05,
         4.1376e+05, 1.1729e+00, 1.2863e+00, 3.9931e+05, 1.1614e+00],
        [1.0013e+00, 1.0379e+00, 3.8864e+05, 3.9353e+05, 9.1156e-01, 1.0412e+00,
         4.0373e+05, 9.9428e-01, 3.9319e+05, 1.0259e+00, 0.0000e+00, 3.7800e+05,
         4.1378e+05, 8.6160e-01, 8.2715e-01, 3.9934e+05, 7.4473e-01],
        [3.7801e+05, 3.7798e+05, 7.7963e+05, 7.7220e+05, 3.7799e+05, 3.7801e+05,
         7.6618e+05, 3.7798e+05, 7.7621e+05, 3.7801e+05, 3.7800e+05, 0.0000e+00,
         7.7438e+05, 3.7799e+05, 3.7800e+05, 8.0036e+05, 3.7801e+05],
        [4.1377e+05, 4.1375e+05, 7.8809e+05, 8.3005e+05, 4.1375e+05, 4.1377e+05,
         7.8222e+05, 4.1376e+05, 7.9675e+05, 4.1376e+05, 4.1378e+05, 7.7438e+05,
         0.0000e+00, 4.1378e+05, 4.1378e+05, 8.1317e+05, 4.1377e+05],
        [1.1318e+00, 1.2172e+00, 3.8864e+05, 3.9351e+05, 9.1193e-01, 6.7872e-01,
         4.0372e+05, 1.1827e+00, 3.9318e+05, 1.1729e+00, 8.6160e-01, 3.7799e+05,
         4.1378e+05, 0.0000e+00, 5.8008e-01, 3.9934e+05, 5.7937e-01],
        [1.1643e+00, 1.2490e+00, 3.8865e+05, 3.9355e+05, 9.2244e-01, 6.6279e-01,
         4.0373e+05, 1.2335e+00, 3.9321e+05, 1.2863e+00, 8.2715e-01, 3.7800e+05,
         4.1378e+05, 5.8008e-01, 0.0000e+00, 3.9933e+05, 5.3324e-01],
        [3.9933e+05, 3.9932e+05, 7.4825e+05, 8.0364e+05, 3.9931e+05, 3.9936e+05,
         8.1672e+05, 3.9935e+05, 7.9575e+05, 3.9931e+05, 3.9934e+05, 8.0036e+05,
         8.1317e+05, 3.9934e+05, 3.9933e+05, 0.0000e+00, 3.9935e+05],
        [1.0916e+00, 1.1517e+00, 3.8864e+05, 3.9353e+05, 8.8920e-01, 6.8672e-01,
         4.0373e+05, 1.1512e+00, 3.9319e+05, 1.1614e+00, 7.4473e-01, 3.7801e+05,
         4.1377e+05, 5.7937e-01, 5.3324e-01, 3.9935e+05, 0.0000e+00]])
Krum scores: ['1.04', '1.08', '388637.53', '393530.41', '0.94', '1.10', '403729.75', '1.06', '393188.41', '1.06', '0.93', '377995.25', '413764.72', '0.89', '0.90', '399328.47', '0.85']
Selected index: 16
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Chosen Update']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0111s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:24...
global Accuracy on shared test data: 70.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 82 181]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:24, End: 2025-07-22 15:31:24)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
tensor([[0.0000e+00, 9.2666e-01, 9.7399e-01, 3.7964e+05, 3.9768e+05, 9.0444e-01,
         1.2031e+00, 3.8764e+05, 3.8408e+05, 9.6509e-01, 3.8513e+05, 9.1795e-01,
         3.9050e+05, 3.8667e+05, 1.0789e+00, 1.0854e+00, 3.9240e+05, 9.1700e-01,
         1.5052e+00],
        [9.2666e-01, 0.0000e+00, 9.0191e-01, 3.7967e+05, 3.9768e+05, 9.7278e-01,
         1.2496e+00, 3.8763e+05, 3.8410e+05, 9.7770e-01, 3.8512e+05, 9.4779e-01,
         3.9048e+05, 3.8667e+05, 1.1524e+00, 1.1608e+00, 3.9243e+05, 9.5525e-01,
         1.6421e+00],
        [9.7399e-01, 9.0191e-01, 0.0000e+00, 3.7964e+05, 3.9767e+05, 8.8547e-01,
         1.1559e+00, 3.8761e+05, 3.8409e+05, 9.3139e-01, 3.8513e+05, 9.5886e-01,
         3.9047e+05, 3.8668e+05, 1.0878e+00, 1.1068e+00, 3.9242e+05, 9.0626e-01,
         1.5145e+00],
        [3.7964e+05, 3.7967e+05, 3.7964e+05, 0.0000e+00, 7.8394e+05, 3.7965e+05,
         3.7965e+05, 7.4565e+05, 7.6008e+05, 3.7966e+05, 7.5106e+05, 3.7967e+05,
         7.5287e+05, 7.5928e+05, 3.7966e+05, 3.7965e+05, 7.7081e+05, 3.7966e+05,
         3.7966e+05],
        [3.9768e+05, 3.9768e+05, 3.9767e+05, 7.8394e+05, 0.0000e+00, 3.9768e+05,
         3.9765e+05, 7.8405e+05, 7.8499e+05, 3.9765e+05, 7.8694e+05, 3.9766e+05,
         8.0586e+05, 7.9178e+05, 3.9767e+05, 3.9765e+05, 7.8806e+05, 3.9766e+05,
         3.9767e+05],
        [9.0444e-01, 9.7278e-01, 8.8547e-01, 3.7965e+05, 3.9768e+05, 0.0000e+00,
         8.6345e-01, 3.8762e+05, 3.8409e+05, 9.9034e-01, 3.8510e+05, 9.1437e-01,
         3.9047e+05, 3.8665e+05, 8.1438e-01, 7.9355e-01, 3.9242e+05, 9.4217e-01,
         1.1908e+00],
        [1.2031e+00, 1.2496e+00, 1.1559e+00, 3.7965e+05, 3.9765e+05, 8.6345e-01,
         0.0000e+00, 3.8759e+05, 3.8408e+05, 1.2457e+00, 3.8509e+05, 1.1880e+00,
         3.9049e+05, 3.8665e+05, 5.0084e-01, 4.7461e-01, 3.9241e+05, 1.2905e+00,
         6.0813e-01],
        [3.8764e+05, 3.8763e+05, 3.8761e+05, 7.4565e+05, 7.8405e+05, 3.8762e+05,
         3.8759e+05, 0.0000e+00, 7.6441e+05, 3.8764e+05, 7.5974e+05, 3.8763e+05,
         7.7051e+05, 7.7808e+05, 3.8761e+05, 3.8759e+05, 7.8363e+05, 3.8762e+05,
         3.8759e+05],
        [3.8408e+05, 3.8410e+05, 3.8409e+05, 7.6008e+05, 7.8499e+05, 3.8409e+05,
         3.8408e+05, 7.6441e+05, 0.0000e+00, 3.8409e+05, 7.3251e+05, 3.8410e+05,
         7.6221e+05, 7.4748e+05, 3.8410e+05, 3.8409e+05, 7.6879e+05, 3.8411e+05,
         3.8411e+05],
        [9.6509e-01, 9.7770e-01, 9.3139e-01, 3.7966e+05, 3.9765e+05, 9.9034e-01,
         1.2457e+00, 3.8764e+05, 3.8409e+05, 0.0000e+00, 3.8512e+05, 9.2158e-01,
         3.9049e+05, 3.8668e+05, 1.1417e+00, 1.2001e+00, 3.9242e+05, 9.0210e-01,
         1.6428e+00],
        [3.8513e+05, 3.8512e+05, 3.8513e+05, 7.5106e+05, 7.8694e+05, 3.8510e+05,
         3.8509e+05, 7.5974e+05, 7.3251e+05, 3.8512e+05, 0.0000e+00, 3.8510e+05,
         7.5302e+05, 7.5801e+05, 3.8511e+05, 3.8509e+05, 7.6246e+05, 3.8514e+05,
         3.8511e+05],
        [9.1795e-01, 9.4779e-01, 9.5886e-01, 3.7967e+05, 3.9766e+05, 9.1437e-01,
         1.1880e+00, 3.8763e+05, 3.8410e+05, 9.2158e-01, 3.8510e+05, 0.0000e+00,
         3.9048e+05, 3.8668e+05, 1.0936e+00, 1.1687e+00, 3.9243e+05, 9.0980e-01,
         1.5604e+00],
        [3.9050e+05, 3.9048e+05, 3.9047e+05, 7.5287e+05, 8.0586e+05, 3.9047e+05,
         3.9049e+05, 7.7051e+05, 7.6221e+05, 3.9049e+05, 7.5302e+05, 3.9048e+05,
         0.0000e+00, 7.8861e+05, 3.9049e+05, 3.9047e+05, 7.7974e+05, 3.9049e+05,
         3.9047e+05],
        [3.8667e+05, 3.8667e+05, 3.8668e+05, 7.5928e+05, 7.9178e+05, 3.8665e+05,
         3.8665e+05, 7.7808e+05, 7.4748e+05, 3.8668e+05, 7.5801e+05, 3.8668e+05,
         7.8861e+05, 0.0000e+00, 3.8664e+05, 3.8665e+05, 7.9632e+05, 3.8666e+05,
         3.8666e+05],
        [1.0789e+00, 1.1524e+00, 1.0878e+00, 3.7966e+05, 3.9767e+05, 8.1438e-01,
         5.0084e-01, 3.8761e+05, 3.8410e+05, 1.1417e+00, 3.8511e+05, 1.0936e+00,
         3.9049e+05, 3.8664e+05, 0.0000e+00, 5.3866e-01, 3.9242e+05, 1.1541e+00,
         7.3375e-01],
        [1.0854e+00, 1.1608e+00, 1.1068e+00, 3.7965e+05, 3.9765e+05, 7.9355e-01,
         4.7461e-01, 3.8759e+05, 3.8409e+05, 1.2001e+00, 3.8509e+05, 1.1687e+00,
         3.9047e+05, 3.8665e+05, 5.3866e-01, 0.0000e+00, 3.9242e+05, 1.2242e+00,
         6.8044e-01],
        [3.9240e+05, 3.9243e+05, 3.9242e+05, 7.7081e+05, 7.8806e+05, 3.9242e+05,
         3.9241e+05, 7.8363e+05, 7.6879e+05, 3.9242e+05, 7.6246e+05, 3.9243e+05,
         7.7974e+05, 7.9632e+05, 3.9242e+05, 3.9242e+05, 0.0000e+00, 3.9243e+05,
         3.9238e+05],
        [9.1700e-01, 9.5525e-01, 9.0626e-01, 3.7966e+05, 3.9766e+05, 9.4217e-01,
         1.2905e+00, 3.8762e+05, 3.8411e+05, 9.0210e-01, 3.8514e+05, 9.0980e-01,
         3.9049e+05, 3.8666e+05, 1.1541e+00, 1.2242e+00, 3.9243e+05, 0.0000e+00,
         1.6996e+00],
        [1.5052e+00, 1.6421e+00, 1.5145e+00, 3.7966e+05, 3.9767e+05, 1.1908e+00,
         6.0813e-01, 3.8759e+05, 3.8411e+05, 1.6428e+00, 3.8511e+05, 1.5604e+00,
         3.9047e+05, 3.8666e+05, 7.3375e-01, 6.8044e-01, 3.9238e+05, 1.6996e+00,
         0.0000e+00]])
Krum scores: ['1.00', '1.03', '0.99', '379652.00', '397661.66', '0.90', '0.94', '387610.66', '384091.09', '1.03', '385108.31', '1.00', '390477.81', '386660.28', '0.90', '0.91', '392412.84', '1.02', '1.23']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0063s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:24...
global Accuracy on shared test data: 72.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 74 189]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:31:24, End: 2025-07-22 15:31:24)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [2, 19, 17, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.7747e+05, 3.8365e+05, 3.9167e+05, 3.9504e+05, 1.0275e+00,
         1.0887e+00, 4.0024e+05, 3.8968e+05, 1.2389e+00, 1.3640e+00, 3.8149e+05,
         1.0281e+00, 1.4148e+00],
        [3.7747e+05, 0.0000e+00, 7.4386e+05, 7.7450e+05, 7.5442e+05, 3.7749e+05,
         3.7748e+05, 7.7460e+05, 7.3666e+05, 3.7747e+05, 3.7747e+05, 7.5673e+05,
         3.7748e+05, 3.7746e+05],
        [3.8365e+05, 7.4386e+05, 0.0000e+00, 7.8263e+05, 7.8057e+05, 3.8367e+05,
         3.8366e+05, 7.9976e+05, 7.6531e+05, 3.8367e+05, 3.8368e+05, 7.5105e+05,
         3.8366e+05, 3.8366e+05],
        [3.9167e+05, 7.7450e+05, 7.8263e+05, 0.0000e+00, 7.7627e+05, 3.9167e+05,
         3.9167e+05, 8.0232e+05, 7.9360e+05, 3.9168e+05, 3.9165e+05, 7.7869e+05,
         3.9167e+05, 3.9167e+05],
        [3.9504e+05, 7.5442e+05, 7.8057e+05, 7.7627e+05, 0.0000e+00, 3.9506e+05,
         3.9505e+05, 7.8579e+05, 7.6520e+05, 3.9507e+05, 3.9508e+05, 7.6837e+05,
         3.9506e+05, 3.9507e+05],
        [1.0275e+00, 3.7749e+05, 3.8367e+05, 3.9167e+05, 3.9506e+05, 0.0000e+00,
         1.0222e+00, 4.0024e+05, 3.8968e+05, 1.1446e+00, 1.3441e+00, 3.8149e+05,
         9.9205e-01, 1.3594e+00],
        [1.0887e+00, 3.7748e+05, 3.8366e+05, 3.9167e+05, 3.9505e+05, 1.0222e+00,
         0.0000e+00, 4.0022e+05, 3.8970e+05, 8.8263e-01, 9.3290e-01, 3.8147e+05,
         1.2305e+00, 9.0850e-01],
        [4.0024e+05, 7.7460e+05, 7.9976e+05, 8.0232e+05, 7.8579e+05, 4.0024e+05,
         4.0022e+05, 0.0000e+00, 7.7612e+05, 4.0024e+05, 4.0023e+05, 7.5181e+05,
         4.0021e+05, 4.0023e+05],
        [3.8968e+05, 7.3666e+05, 7.6531e+05, 7.9360e+05, 7.6520e+05, 3.8968e+05,
         3.8970e+05, 7.7612e+05, 0.0000e+00, 3.8968e+05, 3.8970e+05, 7.7966e+05,
         3.8967e+05, 3.8969e+05],
        [1.2389e+00, 3.7747e+05, 3.8367e+05, 3.9168e+05, 3.9507e+05, 1.1446e+00,
         8.8263e-01, 4.0024e+05, 3.8968e+05, 0.0000e+00, 6.4776e-01, 3.8149e+05,
         1.3376e+00, 5.9372e-01],
        [1.3640e+00, 3.7747e+05, 3.8368e+05, 3.9165e+05, 3.9508e+05, 1.3441e+00,
         9.3290e-01, 4.0023e+05, 3.8970e+05, 6.4776e-01, 0.0000e+00, 3.8148e+05,
         1.5070e+00, 5.7285e-01],
        [3.8149e+05, 7.5673e+05, 7.5105e+05, 7.7869e+05, 7.6837e+05, 3.8149e+05,
         3.8147e+05, 7.5181e+05, 7.7966e+05, 3.8149e+05, 3.8148e+05, 0.0000e+00,
         3.8145e+05, 3.8147e+05],
        [1.0281e+00, 3.7748e+05, 3.8366e+05, 3.9167e+05, 3.9506e+05, 9.9205e-01,
         1.2305e+00, 4.0021e+05, 3.8967e+05, 1.3376e+00, 1.5070e+00, 3.8145e+05,
         0.0000e+00, 1.5893e+00],
        [1.4148e+00, 3.7746e+05, 3.8366e+05, 3.9167e+05, 3.9507e+05, 1.3594e+00,
         9.0850e-01, 4.0023e+05, 3.8969e+05, 5.9372e-01, 5.7285e-01, 3.8147e+05,
         1.5893e+00, 0.0000e+00]])
Krum scores: ['1.15', '377470.53', '383663.16', '391665.78', '395055.09', '1.11', '0.97', '400227.62', '389682.28', '0.90', '0.97', '381472.44', '1.22', '0.97']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [2, 19, 17, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0204s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:25...
global Accuracy on shared test data: 72.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 74 189]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:25, End: 2025-07-22 15:31:25)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 9.5211e-01, 9.7385e-01, 4.1077e+05, 1.0330e+00, 1.1888e+00,
         3.8524e+05, 3.7290e+05, 9.6998e-01, 9.1531e-01, 9.7403e-01, 4.0504e+05,
         4.0765e+05, 1.4603e+00, 1.1005e+00, 9.5489e-01, 1.1716e+00],
        [9.5211e-01, 0.0000e+00, 9.6413e-01, 4.1081e+05, 1.2039e+00, 1.3339e+00,
         3.8524e+05, 3.7291e+05, 1.0208e+00, 9.8837e-01, 1.1031e+00, 4.0505e+05,
         4.0762e+05, 1.7055e+00, 1.2959e+00, 1.0063e+00, 1.4172e+00],
        [9.7385e-01, 9.6413e-01, 0.0000e+00, 4.1080e+05, 1.0928e+00, 1.2379e+00,
         3.8524e+05, 3.7291e+05, 9.4499e-01, 9.9522e-01, 1.0082e+00, 4.0504e+05,
         4.0764e+05, 1.6105e+00, 1.2006e+00, 9.8148e-01, 1.2831e+00],
        [4.1077e+05, 4.1081e+05, 4.1080e+05, 0.0000e+00, 4.1079e+05, 4.1079e+05,
         7.9281e+05, 7.6456e+05, 4.1080e+05, 4.1079e+05, 4.1080e+05, 8.0974e+05,
         8.3131e+05, 4.1078e+05, 4.1077e+05, 4.1080e+05, 4.1078e+05],
        [1.0330e+00, 1.2039e+00, 1.0928e+00, 4.1079e+05, 0.0000e+00, 6.7628e-01,
         3.8521e+05, 3.7290e+05, 1.1306e+00, 1.0809e+00, 8.4451e-01, 4.0502e+05,
         4.0762e+05, 8.3032e-01, 6.6605e-01, 1.1718e+00, 6.7086e-01],
        [1.1888e+00, 1.3339e+00, 1.2379e+00, 4.1079e+05, 6.7628e-01, 0.0000e+00,
         3.8523e+05, 3.7294e+05, 1.2637e+00, 1.2117e+00, 8.6547e-01, 4.0501e+05,
         4.0762e+05, 5.8875e-01, 5.6154e-01, 1.3592e+00, 5.1157e-01],
        [3.8524e+05, 3.8524e+05, 3.8524e+05, 7.9281e+05, 3.8521e+05, 3.8523e+05,
         0.0000e+00, 7.5628e+05, 3.8525e+05, 3.8524e+05, 3.8526e+05, 7.8283e+05,
         7.8507e+05, 3.8520e+05, 3.8521e+05, 3.8524e+05, 3.8521e+05],
        [3.7290e+05, 3.7291e+05, 3.7291e+05, 7.6456e+05, 3.7290e+05, 3.7294e+05,
         7.5628e+05, 0.0000e+00, 3.7291e+05, 3.7291e+05, 3.7292e+05, 7.8780e+05,
         8.1394e+05, 3.7291e+05, 3.7292e+05, 3.7290e+05, 3.7291e+05],
        [9.6998e-01, 1.0208e+00, 9.4499e-01, 4.1080e+05, 1.1306e+00, 1.2637e+00,
         3.8525e+05, 3.7291e+05, 0.0000e+00, 9.4331e-01, 1.0191e+00, 4.0507e+05,
         4.0764e+05, 1.5964e+00, 1.2192e+00, 9.3971e-01, 1.3283e+00],
        [9.1531e-01, 9.8837e-01, 9.9522e-01, 4.1079e+05, 1.0809e+00, 1.2117e+00,
         3.8524e+05, 3.7291e+05, 9.4331e-01, 0.0000e+00, 9.7406e-01, 4.0505e+05,
         4.0764e+05, 1.5248e+00, 1.1983e+00, 9.4603e-01, 1.2392e+00],
        [9.7403e-01, 1.1031e+00, 1.0082e+00, 4.1080e+05, 8.4451e-01, 8.6547e-01,
         3.8526e+05, 3.7292e+05, 1.0191e+00, 9.7406e-01, 0.0000e+00, 4.0504e+05,
         4.0764e+05, 1.1156e+00, 8.2210e-01, 1.1187e+00, 8.2178e-01],
        [4.0504e+05, 4.0505e+05, 4.0504e+05, 8.0974e+05, 4.0502e+05, 4.0501e+05,
         7.8283e+05, 7.8780e+05, 4.0507e+05, 4.0505e+05, 4.0504e+05, 0.0000e+00,
         8.1894e+05, 4.0501e+05, 4.0502e+05, 4.0507e+05, 4.0503e+05],
        [4.0765e+05, 4.0762e+05, 4.0764e+05, 8.3131e+05, 4.0762e+05, 4.0762e+05,
         7.8507e+05, 8.1394e+05, 4.0764e+05, 4.0764e+05, 4.0764e+05, 8.1894e+05,
         0.0000e+00, 4.0762e+05, 4.0764e+05, 4.0763e+05, 4.0763e+05],
        [1.4603e+00, 1.7055e+00, 1.6105e+00, 4.1078e+05, 8.3032e-01, 5.8875e-01,
         3.8520e+05, 3.7291e+05, 1.5964e+00, 1.5248e+00, 1.1156e+00, 4.0501e+05,
         4.0762e+05, 0.0000e+00, 6.7418e-01, 1.6749e+00, 5.5661e-01],
        [1.1005e+00, 1.2959e+00, 1.2006e+00, 4.1077e+05, 6.6605e-01, 5.6154e-01,
         3.8521e+05, 3.7292e+05, 1.2192e+00, 1.1983e+00, 8.2210e-01, 4.0502e+05,
         4.0764e+05, 6.7418e-01, 0.0000e+00, 1.2861e+00, 5.3058e-01],
        [9.5489e-01, 1.0063e+00, 9.8148e-01, 4.1080e+05, 1.1718e+00, 1.3592e+00,
         3.8524e+05, 3.7290e+05, 9.3971e-01, 9.4603e-01, 1.1187e+00, 4.0507e+05,
         4.0763e+05, 1.6749e+00, 1.2861e+00, 0.0000e+00, 1.4034e+00],
        [1.1716e+00, 1.4172e+00, 1.2831e+00, 4.1078e+05, 6.7086e-01, 5.1157e-01,
         3.8521e+05, 3.7291e+05, 1.3283e+00, 1.2392e+00, 8.2178e-01, 4.0503e+05,
         4.0763e+05, 5.5661e-01, 5.3058e-01, 1.4034e+00, 0.0000e+00]])
Krum scores: ['1.02', '1.13', '1.07', '410786.34', '0.92', '0.94', '385226.69', '372908.00', '1.08', '1.05', '0.95', '405032.41', '407629.12', '1.16', '0.93', '1.12', '0.95']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:26...
global Accuracy on shared test data: 72.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 75 188]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:26, End: 2025-07-22 15:31:26)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 17, 1, 8, 15, 4, 3, 13, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 9.3564e-01, 9.7627e-01, 3.8961e+05, 3.8116e+05, 1.3985e+00,
         9.8453e-01, 3.9723e+05, 9.1775e-01, 9.6571e-01, 3.8739e+05, 1.1000e+00,
         3.8916e+05, 9.9199e-01, 1.1268e+00],
        [9.3564e-01, 0.0000e+00, 9.6153e-01, 3.8963e+05, 3.8117e+05, 1.6266e+00,
         9.8022e-01, 3.9725e+05, 9.6065e-01, 1.0787e+00, 3.8740e+05, 1.2771e+00,
         3.8913e+05, 9.9663e-01, 1.3318e+00],
        [9.7627e-01, 9.6153e-01, 0.0000e+00, 3.8962e+05, 3.8118e+05, 1.5015e+00,
         9.4003e-01, 3.9726e+05, 9.8610e-01, 9.9176e-01, 3.8739e+05, 1.1771e+00,
         3.8918e+05, 9.6592e-01, 1.1975e+00],
        [3.8961e+05, 3.8963e+05, 3.8962e+05, 0.0000e+00, 7.7740e+05, 3.8960e+05,
         3.8964e+05, 7.7309e+05, 3.8961e+05, 3.8961e+05, 7.8085e+05, 3.8961e+05,
         7.9337e+05, 3.8964e+05, 3.8961e+05],
        [3.8116e+05, 3.8117e+05, 3.8118e+05, 7.7740e+05, 0.0000e+00, 3.8117e+05,
         3.8118e+05, 7.9349e+05, 3.8117e+05, 3.8118e+05, 7.9140e+05, 3.8118e+05,
         7.6582e+05, 3.8119e+05, 3.8118e+05],
        [1.3985e+00, 1.6266e+00, 1.5015e+00, 3.8960e+05, 3.8117e+05, 0.0000e+00,
         1.5207e+00, 3.9726e+05, 1.4690e+00, 1.0705e+00, 3.8737e+05, 6.6477e-01,
         3.8918e+05, 1.5916e+00, 6.3373e-01],
        [9.8453e-01, 9.8022e-01, 9.4003e-01, 3.8964e+05, 3.8118e+05, 1.5207e+00,
         0.0000e+00, 3.9725e+05, 9.1882e-01, 1.0066e+00, 3.8739e+05, 1.1842e+00,
         3.8917e+05, 9.3833e-01, 1.2298e+00],
        [3.9723e+05, 3.9725e+05, 3.9726e+05, 7.7309e+05, 7.9349e+05, 3.9726e+05,
         3.9725e+05, 0.0000e+00, 3.9725e+05, 3.9725e+05, 7.7308e+05, 3.9727e+05,
         7.8432e+05, 3.9727e+05, 3.9726e+05],
        [9.1775e-01, 9.6065e-01, 9.8610e-01, 3.8961e+05, 3.8117e+05, 1.4690e+00,
         9.1882e-01, 3.9725e+05, 0.0000e+00, 9.6491e-01, 3.8737e+05, 1.1660e+00,
         3.8915e+05, 9.5152e-01, 1.1491e+00],
        [9.6571e-01, 1.0787e+00, 9.9176e-01, 3.8961e+05, 3.8118e+05, 1.0705e+00,
         1.0066e+00, 3.9725e+05, 9.6491e-01, 0.0000e+00, 3.8739e+05, 8.3054e-01,
         3.8916e+05, 1.1044e+00, 7.9106e-01],
        [3.8739e+05, 3.8740e+05, 3.8739e+05, 7.8085e+05, 7.9140e+05, 3.8737e+05,
         3.8739e+05, 7.7308e+05, 3.8737e+05, 3.8739e+05, 0.0000e+00, 3.8736e+05,
         7.6257e+05, 3.8740e+05, 3.8736e+05],
        [1.1000e+00, 1.2771e+00, 1.1771e+00, 3.8961e+05, 3.8118e+05, 6.6477e-01,
         1.1842e+00, 3.9727e+05, 1.1660e+00, 8.3054e-01, 3.8736e+05, 0.0000e+00,
         3.8920e+05, 1.2887e+00, 5.3046e-01],
        [3.8916e+05, 3.8913e+05, 3.8918e+05, 7.9337e+05, 7.6582e+05, 3.8918e+05,
         3.8917e+05, 7.8432e+05, 3.8915e+05, 3.8916e+05, 7.6257e+05, 3.8920e+05,
         0.0000e+00, 3.8917e+05, 3.8918e+05],
        [9.9199e-01, 9.9663e-01, 9.6592e-01, 3.8964e+05, 3.8119e+05, 1.5916e+00,
         9.3833e-01, 3.9727e+05, 9.5152e-01, 1.1044e+00, 3.8740e+05, 1.2887e+00,
         3.8917e+05, 0.0000e+00, 1.3235e+00],
        [1.1268e+00, 1.3318e+00, 1.1975e+00, 3.8961e+05, 3.8118e+05, 6.3373e-01,
         1.2298e+00, 3.9726e+05, 1.1491e+00, 7.9106e-01, 3.8736e+05, 5.3046e-01,
         3.8918e+05, 1.3235e+00, 0.0000e+00]])
Krum scores: ['1.00', '1.07', '1.02', '389611.38', '381175.12', '1.23', '1.02', '397251.12', '1.00', '0.96', '387378.78', '0.99', '389163.50', '1.07', '1.00']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 17, 1, 8, 15, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0194s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:26...
global Accuracy on shared test data: 73.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:26, End: 2025-07-22 15:31:26)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 9.5394e-01, 1.0222e+00, 3.9120e+05, 3.9836e+05, 1.2621e+00,
         1.1634e+00, 3.8028e+05, 4.0309e+05, 1.0011e+00, 3.8895e+05, 9.4874e-01,
         1.3902e+00, 3.9383e+05, 1.1891e+00, 1.1141e+00, 3.8768e+05, 1.0086e+00],
        [9.5394e-01, 0.0000e+00, 9.3671e-01, 3.9119e+05, 3.9836e+05, 1.4198e+00,
         1.2529e+00, 3.8032e+05, 4.0308e+05, 9.7577e-01, 3.8893e+05, 9.6715e-01,
         1.5494e+00, 3.9383e+05, 1.3420e+00, 1.2443e+00, 3.8768e+05, 9.6509e-01],
        [1.0222e+00, 9.3671e-01, 0.0000e+00, 3.9117e+05, 3.9838e+05, 1.3501e+00,
         1.1811e+00, 3.8029e+05, 4.0306e+05, 9.3384e-01, 3.8895e+05, 9.7743e-01,
         1.4877e+00, 3.9383e+05, 1.2940e+00, 1.1762e+00, 3.8768e+05, 9.6239e-01],
        [3.9120e+05, 3.9119e+05, 3.9117e+05, 0.0000e+00, 7.8837e+05, 3.9121e+05,
         3.9118e+05, 7.6409e+05, 7.8126e+05, 3.9119e+05, 7.7477e+05, 3.9119e+05,
         3.9120e+05, 8.0000e+05, 3.9120e+05, 3.9120e+05, 7.9240e+05, 3.9117e+05],
        [3.9836e+05, 3.9836e+05, 3.9838e+05, 7.8837e+05, 0.0000e+00, 3.9838e+05,
         3.9838e+05, 7.7669e+05, 7.9584e+05, 3.9839e+05, 7.7265e+05, 3.9837e+05,
         3.9838e+05, 7.9782e+05, 3.9837e+05, 3.9838e+05, 7.8283e+05, 3.9837e+05],
        [1.2621e+00, 1.4198e+00, 1.3501e+00, 3.9121e+05, 3.9838e+05, 0.0000e+00,
         5.9715e-01, 3.8031e+05, 4.0306e+05, 1.3692e+00, 3.8894e+05, 1.3328e+00,
         6.8529e-01, 3.9379e+05, 5.0917e-01, 6.0324e-01, 3.8765e+05, 1.4627e+00],
        [1.1634e+00, 1.2529e+00, 1.1811e+00, 3.9118e+05, 3.9838e+05, 5.9715e-01,
         0.0000e+00, 3.8031e+05, 4.0308e+05, 1.2092e+00, 3.8895e+05, 1.1729e+00,
         7.0271e-01, 3.9381e+05, 5.2362e-01, 5.8875e-01, 3.8768e+05, 1.3296e+00],
        [3.8028e+05, 3.8032e+05, 3.8029e+05, 7.6409e+05, 7.7669e+05, 3.8031e+05,
         3.8031e+05, 0.0000e+00, 7.6432e+05, 3.8031e+05, 7.8579e+05, 3.8029e+05,
         3.8031e+05, 7.6926e+05, 3.8030e+05, 3.8032e+05, 7.7714e+05, 3.8030e+05],
        [4.0309e+05, 4.0308e+05, 4.0306e+05, 7.8126e+05, 7.9584e+05, 4.0306e+05,
         4.0308e+05, 7.6432e+05, 0.0000e+00, 4.0310e+05, 8.0182e+05, 4.0304e+05,
         4.0303e+05, 7.9563e+05, 4.0306e+05, 4.0306e+05, 7.7288e+05, 4.0308e+05],
        [1.0011e+00, 9.7577e-01, 9.3384e-01, 3.9119e+05, 3.9839e+05, 1.3692e+00,
         1.2092e+00, 3.8031e+05, 4.0310e+05, 0.0000e+00, 3.8894e+05, 9.3804e-01,
         1.4815e+00, 3.9381e+05, 1.3082e+00, 1.1731e+00, 3.8765e+05, 9.3386e-01],
        [3.8895e+05, 3.8893e+05, 3.8895e+05, 7.7477e+05, 7.7265e+05, 3.8894e+05,
         3.8895e+05, 7.8579e+05, 8.0182e+05, 3.8894e+05, 0.0000e+00, 3.8895e+05,
         3.8896e+05, 7.6341e+05, 3.8895e+05, 3.8895e+05, 7.7634e+05, 3.8892e+05],
        [9.4874e-01, 9.6715e-01, 9.7743e-01, 3.9119e+05, 3.9837e+05, 1.3328e+00,
         1.1729e+00, 3.8029e+05, 4.0304e+05, 9.3804e-01, 3.8895e+05, 0.0000e+00,
         1.4146e+00, 3.9382e+05, 1.2064e+00, 1.1753e+00, 3.8764e+05, 9.6294e-01],
        [1.3902e+00, 1.5494e+00, 1.4877e+00, 3.9120e+05, 3.9838e+05, 6.8529e-01,
         7.0271e-01, 3.8031e+05, 4.0303e+05, 1.4815e+00, 3.8896e+05, 1.4146e+00,
         0.0000e+00, 3.9377e+05, 6.5280e-01, 7.2903e-01, 3.8766e+05, 1.6539e+00],
        [3.9383e+05, 3.9383e+05, 3.9383e+05, 8.0000e+05, 7.9782e+05, 3.9379e+05,
         3.9381e+05, 7.6926e+05, 7.9563e+05, 3.9381e+05, 7.6341e+05, 3.9382e+05,
         3.9377e+05, 0.0000e+00, 3.9378e+05, 3.9378e+05, 7.8480e+05, 3.9384e+05],
        [1.1891e+00, 1.3420e+00, 1.2940e+00, 3.9120e+05, 3.9837e+05, 5.0917e-01,
         5.2362e-01, 3.8030e+05, 4.0306e+05, 1.3082e+00, 3.8895e+05, 1.2064e+00,
         6.5280e-01, 3.9378e+05, 0.0000e+00, 5.5799e-01, 3.8767e+05, 1.4097e+00],
        [1.1141e+00, 1.2443e+00, 1.1762e+00, 3.9120e+05, 3.9838e+05, 6.0324e-01,
         5.8875e-01, 3.8032e+05, 4.0306e+05, 1.1731e+00, 3.8895e+05, 1.1753e+00,
         7.2903e-01, 3.9378e+05, 5.5799e-01, 0.0000e+00, 3.8766e+05, 1.3068e+00],
        [3.8768e+05, 3.8768e+05, 3.8768e+05, 7.9240e+05, 7.8283e+05, 3.8765e+05,
         3.8768e+05, 7.7714e+05, 7.7288e+05, 3.8765e+05, 7.7634e+05, 3.8764e+05,
         3.8766e+05, 7.8480e+05, 3.8767e+05, 3.8766e+05, 0.0000e+00, 3.8765e+05],
        [1.0086e+00, 9.6509e-01, 9.6239e-01, 3.9117e+05, 3.9837e+05, 1.4627e+00,
         1.3296e+00, 3.8030e+05, 4.0308e+05, 9.3386e-01, 3.8892e+05, 9.6294e-01,
         1.6539e+00, 3.9384e+05, 1.4097e+00, 1.3068e+00, 3.8765e+05, 0.0000e+00]])
Krum scores: ['1.07', '1.12', '1.09', '391186.69', '398371.31', '1.01', '0.93', '380299.88', '403061.84', '1.09', '388941.22', '1.08', '1.12', '393801.91', '0.95', '0.93', '387660.69', '1.15']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0059s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:27...
global Accuracy on shared test data: 71.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[164  73]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:27, End: 2025-07-22 15:31:27)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 19, 17, 9, 20, 8, 15, 4, 3, 13, 11, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 9.9488e-01, 3.9117e+05, 3.7304e+05, 1.0952e+00, 3.9891e+05,
         9.7194e-01, 3.8450e+05, 9.0344e-01, 1.1410e+00, 3.9510e+05, 1.1639e+00,
         3.8693e+05, 9.8966e-01],
        [9.9488e-01, 0.0000e+00, 3.9120e+05, 3.7304e+05, 1.1412e+00, 3.9889e+05,
         9.2322e-01, 3.8448e+05, 9.7316e-01, 1.2432e+00, 3.9511e+05, 1.2814e+00,
         3.8693e+05, 9.5019e-01],
        [3.9117e+05, 3.9120e+05, 0.0000e+00, 7.4337e+05, 3.9118e+05, 7.9849e+05,
         3.9120e+05, 7.8304e+05, 3.9119e+05, 3.9118e+05, 7.9842e+05, 3.9118e+05,
         7.7962e+05, 3.9119e+05],
        [3.7304e+05, 3.7304e+05, 7.4337e+05, 0.0000e+00, 3.7302e+05, 7.5393e+05,
         3.7304e+05, 7.9050e+05, 3.7303e+05, 3.7303e+05, 7.7189e+05, 3.7304e+05,
         7.6767e+05, 3.7303e+05],
        [1.0952e+00, 1.1412e+00, 3.9118e+05, 3.7302e+05, 0.0000e+00, 3.9890e+05,
         1.1292e+00, 3.8449e+05, 1.1124e+00, 6.2746e-01, 3.9508e+05, 5.1921e-01,
         3.8690e+05, 1.2849e+00],
        [3.9891e+05, 3.9889e+05, 7.9849e+05, 7.5393e+05, 3.9890e+05, 0.0000e+00,
         3.9891e+05, 7.7924e+05, 3.9890e+05, 3.9889e+05, 7.9407e+05, 3.9890e+05,
         7.7407e+05, 3.9891e+05],
        [9.7194e-01, 9.2322e-01, 3.9120e+05, 3.7304e+05, 1.1292e+00, 3.9891e+05,
         0.0000e+00, 3.8447e+05, 9.1088e-01, 1.2307e+00, 3.9512e+05, 1.2774e+00,
         3.8692e+05, 9.2906e-01],
        [3.8450e+05, 3.8448e+05, 7.8304e+05, 7.9050e+05, 3.8449e+05, 7.7924e+05,
         3.8447e+05, 0.0000e+00, 3.8446e+05, 3.8447e+05, 7.5996e+05, 3.8446e+05,
         7.8942e+05, 3.8449e+05],
        [9.0344e-01, 9.7316e-01, 3.9119e+05, 3.7303e+05, 1.1124e+00, 3.9890e+05,
         9.1088e-01, 3.8446e+05, 0.0000e+00, 1.2074e+00, 3.9511e+05, 1.2155e+00,
         3.8692e+05, 9.4152e-01],
        [1.1410e+00, 1.2432e+00, 3.9118e+05, 3.7303e+05, 6.2746e-01, 3.9889e+05,
         1.2307e+00, 3.8447e+05, 1.2074e+00, 0.0000e+00, 3.9509e+05, 6.1696e-01,
         3.8691e+05, 1.4205e+00],
        [3.9510e+05, 3.9511e+05, 7.9842e+05, 7.7189e+05, 3.9508e+05, 7.9407e+05,
         3.9512e+05, 7.5996e+05, 3.9511e+05, 3.9509e+05, 0.0000e+00, 3.9509e+05,
         7.6836e+05, 3.9511e+05],
        [1.1639e+00, 1.2814e+00, 3.9118e+05, 3.7304e+05, 5.1921e-01, 3.9890e+05,
         1.2774e+00, 3.8446e+05, 1.2155e+00, 6.1696e-01, 3.9509e+05, 0.0000e+00,
         3.8692e+05, 1.3974e+00],
        [3.8693e+05, 3.8693e+05, 7.7962e+05, 7.6767e+05, 3.8690e+05, 7.7407e+05,
         3.8692e+05, 7.8942e+05, 3.8692e+05, 3.8691e+05, 7.6836e+05, 3.8692e+05,
         0.0000e+00, 3.8688e+05],
        [9.8966e-01, 9.5019e-01, 3.9119e+05, 3.7303e+05, 1.2849e+00, 3.9891e+05,
         9.2906e-01, 3.8449e+05, 9.4152e-01, 1.4205e+00, 3.9511e+05, 1.3974e+00,
         3.8688e+05, 0.0000e+00]])
Krum scores: ['1.02', '1.04', '391183.41', '373030.44', '0.94', '398896.78', '1.02', '384470.69', '1.01', '1.01', '395095.84', '1.01', '386907.44', '1.08']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 19, 17, 9, 20, 8, 15, 4, 3, 13, 11, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0076s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:27...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:27, End: 2025-07-22 15:31:27)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.1200e-01, 9.5734e-01, 3.8248e+05, 1.0299e+00, 1.2767e+00,
         3.9694e+05, 3.9556e+05, 9.1753e-01, 8.7955e-01, 1.0123e+00, 3.9783e+05,
         3.9734e+05, 3.8802e+05, 9.6104e-01, 9.4649e-01],
        [9.1200e-01, 0.0000e+00, 9.1922e-01, 3.8249e+05, 1.2451e+00, 1.5256e+00,
         3.9694e+05, 3.9557e+05, 9.4606e-01, 9.6118e-01, 1.2539e+00, 3.9783e+05,
         3.9735e+05, 3.8801e+05, 9.5200e-01, 1.1667e+00],
        [9.5734e-01, 9.1922e-01, 0.0000e+00, 3.8252e+05, 1.1875e+00, 1.4926e+00,
         3.9692e+05, 3.9557e+05, 9.0079e-01, 9.6994e-01, 1.1839e+00, 3.9786e+05,
         3.9732e+05, 3.8802e+05, 9.3250e-01, 1.1147e+00],
        [3.8248e+05, 3.8249e+05, 3.8252e+05, 0.0000e+00, 3.8249e+05, 3.8250e+05,
         7.8750e+05, 7.7210e+05, 3.8250e+05, 3.8250e+05, 3.8250e+05, 8.0285e+05,
         7.4995e+05, 7.6029e+05, 3.8252e+05, 3.8249e+05],
        [1.0299e+00, 1.2451e+00, 1.1875e+00, 3.8249e+05, 0.0000e+00, 6.0901e-01,
         3.9695e+05, 3.9559e+05, 1.1454e+00, 1.1673e+00, 6.2224e-01, 3.9784e+05,
         3.9733e+05, 3.8806e+05, 1.2175e+00, 5.4860e-01],
        [1.2767e+00, 1.5256e+00, 1.4926e+00, 3.8250e+05, 6.0901e-01, 0.0000e+00,
         3.9696e+05, 3.9559e+05, 1.4247e+00, 1.4292e+00, 6.7015e-01, 3.9783e+05,
         3.9734e+05, 3.8805e+05, 1.5714e+00, 5.7788e-01],
        [3.9694e+05, 3.9694e+05, 3.9692e+05, 7.8750e+05, 3.9695e+05, 3.9696e+05,
         0.0000e+00, 8.0386e+05, 3.9697e+05, 3.9696e+05, 3.9694e+05, 8.0372e+05,
         8.0089e+05, 7.7222e+05, 3.9695e+05, 3.9694e+05],
        [3.9556e+05, 3.9557e+05, 3.9557e+05, 7.7210e+05, 3.9559e+05, 3.9559e+05,
         8.0386e+05, 0.0000e+00, 3.9557e+05, 3.9555e+05, 3.9558e+05, 8.0846e+05,
         7.9080e+05, 8.1011e+05, 3.9557e+05, 3.9558e+05],
        [9.1753e-01, 9.4606e-01, 9.0079e-01, 3.8250e+05, 1.1454e+00, 1.4247e+00,
         3.9697e+05, 3.9557e+05, 0.0000e+00, 8.9233e-01, 1.0986e+00, 3.9782e+05,
         3.9735e+05, 3.8804e+05, 8.8505e-01, 1.0697e+00],
        [8.7955e-01, 9.6118e-01, 9.6994e-01, 3.8250e+05, 1.1673e+00, 1.4292e+00,
         3.9696e+05, 3.9555e+05, 8.9233e-01, 0.0000e+00, 1.1255e+00, 3.9784e+05,
         3.9731e+05, 3.8801e+05, 9.5195e-01, 1.0749e+00],
        [1.0123e+00, 1.2539e+00, 1.1839e+00, 3.8250e+05, 6.2224e-01, 6.7015e-01,
         3.9694e+05, 3.9558e+05, 1.0986e+00, 1.1255e+00, 0.0000e+00, 3.9783e+05,
         3.9735e+05, 3.8804e+05, 1.2694e+00, 5.4233e-01],
        [3.9783e+05, 3.9783e+05, 3.9786e+05, 8.0285e+05, 3.9784e+05, 3.9783e+05,
         8.0372e+05, 8.0846e+05, 3.9782e+05, 3.9784e+05, 3.9783e+05, 0.0000e+00,
         7.8731e+05, 7.7520e+05, 3.9783e+05, 3.9783e+05],
        [3.9734e+05, 3.9735e+05, 3.9732e+05, 7.4995e+05, 3.9733e+05, 3.9734e+05,
         8.0089e+05, 7.9080e+05, 3.9735e+05, 3.9731e+05, 3.9735e+05, 7.8731e+05,
         0.0000e+00, 7.9912e+05, 3.9732e+05, 3.9736e+05],
        [3.8802e+05, 3.8801e+05, 3.8802e+05, 7.6029e+05, 3.8806e+05, 3.8805e+05,
         7.7222e+05, 8.1011e+05, 3.8804e+05, 3.8801e+05, 3.8804e+05, 7.7520e+05,
         7.9912e+05, 0.0000e+00, 3.8805e+05, 3.8807e+05],
        [9.6104e-01, 9.5200e-01, 9.3250e-01, 3.8252e+05, 1.2175e+00, 1.5714e+00,
         3.9695e+05, 3.9557e+05, 8.8505e-01, 9.5195e-01, 1.2694e+00, 3.9783e+05,
         3.9732e+05, 3.8805e+05, 0.0000e+00, 1.1705e+00],
        [9.4649e-01, 1.1667e+00, 1.1147e+00, 3.8249e+05, 5.4860e-01, 5.7788e-01,
         3.9694e+05, 3.9558e+05, 1.0697e+00, 1.0749e+00, 5.4233e-01, 3.9783e+05,
         3.9736e+05, 3.8807e+05, 1.1705e+00, 0.0000e+00]])
Krum scores: ['0.95', '1.04', '1.02', '382496.28', '0.94', '1.13', '396941.62', '395569.28', '0.98', '1.00', '0.94', '397828.31', '397333.62', '388030.50', '1.04', '0.88']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [5, 7, 2, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:28...
global Accuracy on shared test data: 71.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 83 180]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:28, End: 2025-07-22 15:31:28)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 16, 6], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 8.7435e-01, 3.7010e+05, 3.9281e+05, 1.0453e+00, 1.1317e+00,
         3.9321e+05, 3.8377e+05, 9.6657e-01, 3.9037e+05, 1.0296e+00, 3.8417e+05,
         3.9110e+05, 3.7960e+05, 9.1768e-01],
        [8.7435e-01, 0.0000e+00, 3.7010e+05, 3.9281e+05, 1.1606e+00, 1.2370e+00,
         3.9320e+05, 3.8377e+05, 9.5378e-01, 3.9038e+05, 1.1469e+00, 3.8411e+05,
         3.9110e+05, 3.7961e+05, 9.1697e-01],
        [3.7010e+05, 3.7010e+05, 0.0000e+00, 7.7498e+05, 3.7012e+05, 3.7011e+05,
         7.8157e+05, 7.4773e+05, 3.7010e+05, 7.6309e+05, 3.7010e+05, 7.4756e+05,
         7.6513e+05, 7.4597e+05, 3.7010e+05],
        [3.9281e+05, 3.9281e+05, 7.7498e+05, 0.0000e+00, 3.9281e+05, 3.9282e+05,
         7.7718e+05, 7.7183e+05, 3.9285e+05, 7.7654e+05, 3.9284e+05, 7.8362e+05,
         7.8587e+05, 7.6066e+05, 3.9283e+05],
        [1.0453e+00, 1.1606e+00, 3.7012e+05, 3.9281e+05, 0.0000e+00, 4.7853e-01,
         3.9322e+05, 3.8377e+05, 1.1455e+00, 3.9037e+05, 5.8697e-01, 3.8417e+05,
         3.9111e+05, 3.7959e+05, 1.1721e+00],
        [1.1317e+00, 1.2370e+00, 3.7011e+05, 3.9282e+05, 4.7853e-01, 0.0000e+00,
         3.9323e+05, 3.8376e+05, 1.2336e+00, 3.9036e+05, 5.2739e-01, 3.8417e+05,
         3.9111e+05, 3.7958e+05, 1.3309e+00],
        [3.9321e+05, 3.9320e+05, 7.8157e+05, 7.7718e+05, 3.9322e+05, 3.9323e+05,
         0.0000e+00, 7.7918e+05, 3.9319e+05, 7.6372e+05, 3.9324e+05, 7.7863e+05,
         7.7148e+05, 7.7317e+05, 3.9322e+05],
        [3.8377e+05, 3.8377e+05, 7.4773e+05, 7.7183e+05, 3.8377e+05, 3.8376e+05,
         7.7918e+05, 0.0000e+00, 3.8378e+05, 7.7441e+05, 3.8378e+05, 7.6727e+05,
         7.6617e+05, 7.3905e+05, 3.8377e+05],
        [9.6657e-01, 9.5378e-01, 3.7010e+05, 3.9285e+05, 1.1455e+00, 1.2336e+00,
         3.9319e+05, 3.8378e+05, 0.0000e+00, 3.9038e+05, 1.1119e+00, 3.8415e+05,
         3.9109e+05, 3.7957e+05, 8.9788e-01],
        [3.9037e+05, 3.9038e+05, 7.6309e+05, 7.7654e+05, 3.9037e+05, 3.9036e+05,
         7.6372e+05, 7.7441e+05, 3.9038e+05, 0.0000e+00, 3.9039e+05, 7.5687e+05,
         7.7701e+05, 7.7675e+05, 3.9039e+05],
        [1.0296e+00, 1.1469e+00, 3.7010e+05, 3.9284e+05, 5.8697e-01, 5.2739e-01,
         3.9324e+05, 3.8378e+05, 1.1119e+00, 3.9039e+05, 0.0000e+00, 3.8417e+05,
         3.9111e+05, 3.7959e+05, 1.2448e+00],
        [3.8417e+05, 3.8411e+05, 7.4756e+05, 7.8362e+05, 3.8417e+05, 3.8417e+05,
         7.7863e+05, 7.6727e+05, 3.8415e+05, 7.5687e+05, 3.8417e+05, 0.0000e+00,
         7.7242e+05, 7.7389e+05, 3.8415e+05],
        [3.9110e+05, 3.9110e+05, 7.6513e+05, 7.8587e+05, 3.9111e+05, 3.9111e+05,
         7.7148e+05, 7.6617e+05, 3.9109e+05, 7.7701e+05, 3.9111e+05, 7.7242e+05,
         0.0000e+00, 7.7132e+05, 3.9112e+05],
        [3.7960e+05, 3.7961e+05, 7.4597e+05, 7.6066e+05, 3.7959e+05, 3.7958e+05,
         7.7317e+05, 7.3905e+05, 3.7957e+05, 7.7675e+05, 3.7959e+05, 7.7389e+05,
         7.7132e+05, 0.0000e+00, 3.7958e+05],
        [9.1768e-01, 9.1697e-01, 3.7010e+05, 3.9283e+05, 1.1721e+00, 1.3309e+00,
         3.9322e+05, 3.8377e+05, 8.9788e-01, 3.9039e+05, 1.2448e+00, 3.8415e+05,
         3.9112e+05, 3.7958e+05, 0.0000e+00]])
Krum scores: ['0.97', '1.01', '370097.97', '392817.69', '0.88', '0.92', '393209.06', '383767.19', '1.02', '390375.03', '0.88', '384149.09', '391102.31', '379582.62', '1.03']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0032s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:28...
global Accuracy on shared test data: 72.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:28, End: 2025-07-22 15:31:29)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 7, 19, 17, 20, 18, 4, 3, 14, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 8.5991e-01, 4.0229e+05, 3.9657e+05, 3.8586e+05, 3.9969e+05,
         8.3218e-01, 1.2979e+00, 3.9596e+05, 1.0406e+00, 4.0251e+05, 9.0886e-01,
         1.1003e+00],
        [8.5991e-01, 0.0000e+00, 4.0229e+05, 3.9653e+05, 3.8587e+05, 3.9968e+05,
         9.0309e-01, 1.5455e+00, 3.9595e+05, 1.2294e+00, 4.0249e+05, 8.9979e-01,
         1.3369e+00],
        [4.0229e+05, 4.0229e+05, 0.0000e+00, 7.8898e+05, 8.1353e+05, 8.2853e+05,
         4.0230e+05, 4.0230e+05, 7.9782e+05, 4.0231e+05, 8.2655e+05, 4.0228e+05,
         4.0229e+05],
        [3.9657e+05, 3.9653e+05, 7.8898e+05, 0.0000e+00, 7.6667e+05, 8.0062e+05,
         3.9654e+05, 3.9654e+05, 8.0123e+05, 3.9654e+05, 7.8214e+05, 3.9655e+05,
         3.9653e+05],
        [3.8586e+05, 3.8587e+05, 8.1353e+05, 7.6667e+05, 0.0000e+00, 7.7130e+05,
         3.8586e+05, 3.8586e+05, 8.1670e+05, 3.8588e+05, 7.8602e+05, 3.8583e+05,
         3.8589e+05],
        [3.9969e+05, 3.9968e+05, 8.2853e+05, 8.0062e+05, 7.7130e+05, 0.0000e+00,
         3.9968e+05, 3.9970e+05, 8.0290e+05, 3.9969e+05, 8.1779e+05, 3.9967e+05,
         3.9969e+05],
        [8.3218e-01, 9.0309e-01, 4.0230e+05, 3.9654e+05, 3.8586e+05, 3.9968e+05,
         0.0000e+00, 1.4069e+00, 3.9596e+05, 1.1612e+00, 4.0250e+05, 9.0286e-01,
         1.2259e+00],
        [1.2979e+00, 1.5455e+00, 4.0230e+05, 3.9654e+05, 3.8586e+05, 3.9970e+05,
         1.4069e+00, 0.0000e+00, 3.9594e+05, 5.0164e-01, 4.0250e+05, 1.6444e+00,
         4.1663e-01],
        [3.9596e+05, 3.9595e+05, 7.9782e+05, 8.0123e+05, 8.1670e+05, 8.0290e+05,
         3.9596e+05, 3.9594e+05, 0.0000e+00, 3.9595e+05, 8.0030e+05, 3.9593e+05,
         3.9595e+05],
        [1.0406e+00, 1.2294e+00, 4.0231e+05, 3.9654e+05, 3.8588e+05, 3.9969e+05,
         1.1612e+00, 5.0164e-01, 3.9595e+05, 0.0000e+00, 4.0253e+05, 1.3125e+00,
         3.9586e-01],
        [4.0251e+05, 4.0249e+05, 8.2655e+05, 7.8214e+05, 7.8602e+05, 8.1779e+05,
         4.0250e+05, 4.0250e+05, 8.0030e+05, 4.0253e+05, 0.0000e+00, 4.0248e+05,
         4.0253e+05],
        [9.0886e-01, 8.9979e-01, 4.0228e+05, 3.9655e+05, 3.8583e+05, 3.9967e+05,
         9.0286e-01, 1.6444e+00, 3.9593e+05, 1.3125e+00, 4.0248e+05, 0.0000e+00,
         1.3960e+00],
        [1.1003e+00, 1.3369e+00, 4.0229e+05, 3.9653e+05, 3.8589e+05, 3.9969e+05,
         1.2259e+00, 4.1663e-01, 3.9595e+05, 3.9586e-01, 4.0253e+05, 1.3960e+00,
         0.0000e+00]])
Krum scores: ['0.95', '1.05', '402292.72', '396536.22', '385856.72', '399682.72', '1.01', '1.03', '395943.09', '0.87', '402495.69', '1.08', '0.90']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 7, 19, 17, 20, 18, 4, 3, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0050s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:29...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:29, End: 2025-07-22 15:31:29)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 7, 2, 19, 17, 1, 9, 15, 4, 3, 14, 11, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 8.8116e-01, 9.1830e-01, 3.8050e+05, 3.8141e+05, 9.4924e-01,
         1.0231e+00, 3.8722e+05, 8.7424e-01, 1.0849e+00, 3.9605e+05, 9.6812e-01,
         1.0346e+00],
        [8.8116e-01, 0.0000e+00, 9.0706e-01, 3.8052e+05, 3.8141e+05, 1.1192e+00,
         1.2135e+00, 3.8724e+05, 9.2166e-01, 1.3204e+00, 3.9604e+05, 1.1532e+00,
         1.2706e+00],
        [9.1830e-01, 9.0706e-01, 0.0000e+00, 3.8055e+05, 3.8142e+05, 1.0096e+00,
         1.0928e+00, 3.8723e+05, 9.2521e-01, 1.1912e+00, 3.9604e+05, 1.0499e+00,
         1.1264e+00],
        [3.8050e+05, 3.8052e+05, 3.8055e+05, 0.0000e+00, 7.5323e+05, 3.8050e+05,
         3.8050e+05, 7.8000e+05, 3.8051e+05, 3.8050e+05, 7.7472e+05, 3.8051e+05,
         3.8050e+05],
        [3.8141e+05, 3.8141e+05, 3.8142e+05, 7.5323e+05, 0.0000e+00, 3.8140e+05,
         3.8139e+05, 7.8615e+05, 3.8139e+05, 3.8141e+05, 7.5845e+05, 3.8142e+05,
         3.8141e+05],
        [9.4924e-01, 1.1192e+00, 1.0096e+00, 3.8050e+05, 3.8140e+05, 0.0000e+00,
         5.0237e-01, 3.8721e+05, 1.0541e+00, 5.3942e-01, 3.9607e+05, 5.0098e-01,
         5.2991e-01],
        [1.0231e+00, 1.2135e+00, 1.0928e+00, 3.8050e+05, 3.8139e+05, 5.0237e-01,
         0.0000e+00, 3.8722e+05, 1.1219e+00, 4.1223e-01, 3.9604e+05, 4.2816e-01,
         3.9007e-01],
        [3.8722e+05, 3.8724e+05, 3.8723e+05, 7.8000e+05, 7.8615e+05, 3.8721e+05,
         3.8722e+05, 0.0000e+00, 3.8724e+05, 3.8720e+05, 7.7512e+05, 3.8724e+05,
         3.8722e+05],
        [8.7424e-01, 9.2166e-01, 9.2521e-01, 3.8051e+05, 3.8139e+05, 1.0541e+00,
         1.1219e+00, 3.8724e+05, 0.0000e+00, 1.2080e+00, 3.9606e+05, 1.0560e+00,
         1.1641e+00],
        [1.0849e+00, 1.3204e+00, 1.1912e+00, 3.8050e+05, 3.8141e+05, 5.3942e-01,
         4.1223e-01, 3.8720e+05, 1.2080e+00, 0.0000e+00, 3.9605e+05, 4.7743e-01,
         3.7488e-01],
        [3.9605e+05, 3.9604e+05, 3.9604e+05, 7.7472e+05, 7.5845e+05, 3.9607e+05,
         3.9604e+05, 7.7512e+05, 3.9606e+05, 3.9605e+05, 0.0000e+00, 3.9605e+05,
         3.9605e+05],
        [9.6812e-01, 1.1532e+00, 1.0499e+00, 3.8051e+05, 3.8142e+05, 5.0098e-01,
         4.2816e-01, 3.8724e+05, 1.0560e+00, 4.7743e-01, 3.9605e+05, 0.0000e+00,
         4.3581e-01],
        [1.0346e+00, 1.2706e+00, 1.1264e+00, 3.8050e+05, 3.8141e+05, 5.2991e-01,
         3.9007e-01, 3.8722e+05, 1.1641e+00, 3.7488e-01, 3.9605e+05, 4.3581e-01,
         0.0000e+00]])
Krum scores: ['0.95', '1.07', '1.00', '380504.06', '381404.25', '0.73', '0.71', '387221.56', '1.02', '0.76', '396046.16', '0.70', '0.72']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 15, 4, 3, 14, 11, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0027s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:29...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:29, End: 2025-07-22 15:31:29)
start time is: 97254022232822, end time is: 97271811381867
The total time is: 17789149045ns.

 ------- aggregate method: krum, random_seed: 400 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 19, 17, 1, 18, 15, 4, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 4.2084e+00, 3.8165e+05, 3.9928e+05, 4.0172e+00, 3.8974e+05,
         3.9067e+05, 5.3929e+00, 3.8784e+05, 4.3999e+00, 4.4414e+00, 3.8580e+05,
         5.6703e+00, 4.1042e+00],
        [4.2084e+00, 0.0000e+00, 3.8167e+05, 3.9931e+05, 4.5244e+00, 3.8975e+05,
         3.9064e+05, 6.1963e+00, 3.8782e+05, 4.5629e+00, 4.8512e+00, 3.8580e+05,
         6.0870e+00, 4.9837e+00],
        [3.8165e+05, 3.8167e+05, 0.0000e+00, 7.6824e+05, 3.8170e+05, 7.8681e+05,
         7.7261e+05, 3.8165e+05, 7.4438e+05, 3.8166e+05, 3.8164e+05, 7.6596e+05,
         3.8159e+05, 3.8164e+05],
        [3.9928e+05, 3.9931e+05, 7.6824e+05, 0.0000e+00, 3.9933e+05, 7.7382e+05,
         7.8708e+05, 3.9932e+05, 7.9868e+05, 3.9926e+05, 3.9937e+05, 7.9324e+05,
         3.9937e+05, 3.9929e+05],
        [4.0172e+00, 4.5244e+00, 3.8170e+05, 3.9933e+05, 0.0000e+00, 3.8975e+05,
         3.9067e+05, 5.3424e+00, 3.8785e+05, 4.4534e+00, 4.2167e+00, 3.8583e+05,
         5.1970e+00, 4.0277e+00],
        [3.8974e+05, 3.8975e+05, 7.8681e+05, 7.7382e+05, 3.8975e+05, 0.0000e+00,
         7.9280e+05, 3.8977e+05, 7.8537e+05, 3.8971e+05, 3.8972e+05, 7.6540e+05,
         3.8971e+05, 3.8980e+05],
        [3.9067e+05, 3.9064e+05, 7.7261e+05, 7.8708e+05, 3.9067e+05, 7.9280e+05,
         0.0000e+00, 3.9065e+05, 7.7677e+05, 3.9063e+05, 3.9068e+05, 7.5775e+05,
         3.9070e+05, 3.9067e+05],
        [5.3929e+00, 6.1963e+00, 3.8165e+05, 3.9932e+05, 5.3424e+00, 3.8977e+05,
         3.9065e+05, 0.0000e+00, 3.8789e+05, 5.2043e+00, 4.7348e+00, 3.8580e+05,
         4.4295e+00, 5.8084e+00],
        [3.8784e+05, 3.8782e+05, 7.4438e+05, 7.9868e+05, 3.8785e+05, 7.8537e+05,
         7.7677e+05, 3.8789e+05, 0.0000e+00, 3.8784e+05, 3.8789e+05, 7.9088e+05,
         3.8789e+05, 3.8790e+05],
        [4.3999e+00, 4.5629e+00, 3.8166e+05, 3.9926e+05, 4.4534e+00, 3.8971e+05,
         3.9063e+05, 5.2043e+00, 3.8784e+05, 0.0000e+00, 3.8765e+00, 3.8582e+05,
         5.0789e+00, 5.0723e+00],
        [4.4414e+00, 4.8512e+00, 3.8164e+05, 3.9937e+05, 4.2167e+00, 3.8972e+05,
         3.9068e+05, 4.7348e+00, 3.8789e+05, 3.8765e+00, 0.0000e+00, 3.8585e+05,
         5.0326e+00, 5.0429e+00],
        [3.8580e+05, 3.8580e+05, 7.6596e+05, 7.9324e+05, 3.8583e+05, 7.6540e+05,
         7.5775e+05, 3.8580e+05, 7.9088e+05, 3.8582e+05, 3.8585e+05, 0.0000e+00,
         3.8579e+05, 3.8583e+05],
        [5.6703e+00, 6.0870e+00, 3.8159e+05, 3.9937e+05, 5.1970e+00, 3.8971e+05,
         3.9070e+05, 4.4295e+00, 3.8789e+05, 5.0789e+00, 5.0326e+00, 3.8579e+05,
         0.0000e+00, 5.7263e+00],
        [4.1042e+00, 4.9837e+00, 3.8164e+05, 3.9929e+05, 4.0277e+00, 3.8980e+05,
         3.9067e+05, 5.8084e+00, 3.8790e+05, 5.0723e+00, 5.0429e+00, 3.8583e+05,
         5.7263e+00, 0.0000e+00]])
Krum scores: ['4.43', '4.87', '381639.66', '399297.66', '4.41', '389729.19', '390653.78', '5.15', '387854.09', '4.57', '4.53', '385804.78', '5.19', '4.83']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 19, 17, 1, 18, 15, 4, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0217s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:30...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:30, End: 2025-07-22 15:31:30)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [5, 7, 19, 17, 1, 20, 8, 3, 13, 14, 10, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
tensor([[0.0000e+00, 1.9512e+00, 3.9329e+05, 3.9042e+05, 2.0545e+00, 3.8672e+05,
         2.2979e+00, 1.9009e+00, 3.9300e+05, 3.9549e+05, 1.9690e+00, 2.0567e+00],
        [1.9512e+00, 0.0000e+00, 3.9332e+05, 3.9041e+05, 2.2293e+00, 3.8673e+05,
         2.3126e+00, 2.1552e+00, 3.9296e+05, 3.9549e+05, 1.9798e+00, 2.1090e+00],
        [3.9329e+05, 3.9332e+05, 0.0000e+00, 7.7737e+05, 3.9333e+05, 8.0562e+05,
         3.9332e+05, 3.9330e+05, 7.8793e+05, 7.8881e+05, 3.9329e+05, 3.9332e+05],
        [3.9042e+05, 3.9041e+05, 7.7737e+05, 0.0000e+00, 3.9045e+05, 7.9462e+05,
         3.9042e+05, 3.9042e+05, 7.9539e+05, 7.7824e+05, 3.9041e+05, 3.9043e+05],
        [2.0545e+00, 2.2293e+00, 3.9333e+05, 3.9045e+05, 0.0000e+00, 3.8677e+05,
         2.3987e+00, 2.1331e+00, 3.9299e+05, 3.9550e+05, 2.0487e+00, 2.1454e+00],
        [3.8672e+05, 3.8673e+05, 8.0562e+05, 7.9462e+05, 3.8677e+05, 0.0000e+00,
         3.8670e+05, 3.8673e+05, 7.8282e+05, 7.7880e+05, 3.8676e+05, 3.8671e+05],
        [2.2979e+00, 2.3126e+00, 3.9332e+05, 3.9042e+05, 2.3987e+00, 3.8670e+05,
         0.0000e+00, 2.1986e+00, 3.9298e+05, 3.9546e+05, 1.9536e+00, 2.1775e+00],
        [1.9009e+00, 2.1552e+00, 3.9330e+05, 3.9042e+05, 2.1331e+00, 3.8673e+05,
         2.1986e+00, 0.0000e+00, 3.9297e+05, 3.9549e+05, 1.9713e+00, 2.1724e+00],
        [3.9300e+05, 3.9296e+05, 7.8793e+05, 7.9539e+05, 3.9299e+05, 7.8282e+05,
         3.9298e+05, 3.9297e+05, 0.0000e+00, 7.6260e+05, 3.9298e+05, 3.9297e+05],
        [3.9549e+05, 3.9549e+05, 7.8881e+05, 7.7824e+05, 3.9550e+05, 7.7880e+05,
         3.9546e+05, 3.9549e+05, 7.6260e+05, 0.0000e+00, 3.9550e+05, 3.9551e+05],
        [1.9690e+00, 1.9798e+00, 3.9329e+05, 3.9041e+05, 2.0487e+00, 3.8676e+05,
         1.9536e+00, 1.9713e+00, 3.9298e+05, 3.9550e+05, 0.0000e+00, 2.0648e+00],
        [2.0567e+00, 2.1090e+00, 3.9332e+05, 3.9043e+05, 2.1454e+00, 3.8671e+05,
         2.1775e+00, 2.1724e+00, 3.9297e+05, 3.9551e+05, 2.0648e+00, 0.0000e+00]])
Krum scores: ['1.99', '2.08', '393303.88', '390416.38', '2.12', '386715.72', '2.19', '2.07', '392971.47', '395486.31', '1.98', '2.11']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']], selected_client_indices: [5, 7, 19, 17, 1, 20, 8, 3, 13, 14, 10, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0024s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:30...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:30, End: 2025-07-22 15:31:30)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 17, 1, 9, 20, 18, 8, 3, 13, 14, 11, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.8923e+05, 1.7268e+00, 1.7977e+00, 4.0321e+05, 3.8645e+05,
         1.8805e+00, 1.6358e+00, 3.9282e+05, 3.9747e+05, 1.6346e+00, 1.8298e+00,
         3.9462e+05, 1.8121e+00],
        [3.8923e+05, 0.0000e+00, 3.8924e+05, 3.8927e+05, 8.0606e+05, 7.8959e+05,
         3.8925e+05, 3.8926e+05, 7.9339e+05, 7.7362e+05, 3.8922e+05, 3.8920e+05,
         7.6853e+05, 3.8925e+05],
        [1.7268e+00, 3.8924e+05, 0.0000e+00, 1.7872e+00, 4.0321e+05, 3.8643e+05,
         1.9941e+00, 1.9309e+00, 3.9277e+05, 3.9753e+05, 1.7997e+00, 1.6901e+00,
         3.9461e+05, 1.8889e+00],
        [1.7977e+00, 3.8927e+05, 1.7872e+00, 0.0000e+00, 4.0322e+05, 3.8644e+05,
         1.7793e+00, 1.7026e+00, 3.9278e+05, 3.9748e+05, 1.6396e+00, 1.8344e+00,
         3.9463e+05, 1.6598e+00],
        [4.0321e+05, 8.0606e+05, 4.0321e+05, 4.0322e+05, 0.0000e+00, 8.1175e+05,
         4.0325e+05, 4.0324e+05, 7.9131e+05, 7.8733e+05, 4.0323e+05, 4.0321e+05,
         8.1936e+05, 4.0323e+05],
        [3.8645e+05, 7.8959e+05, 3.8643e+05, 3.8644e+05, 8.1175e+05, 0.0000e+00,
         3.8644e+05, 3.8644e+05, 7.8272e+05, 7.9065e+05, 3.8639e+05, 3.8639e+05,
         7.8728e+05, 3.8642e+05],
        [1.8805e+00, 3.8925e+05, 1.9941e+00, 1.7793e+00, 4.0325e+05, 3.8644e+05,
         0.0000e+00, 1.8801e+00, 3.9277e+05, 3.9751e+05, 1.7643e+00, 1.9115e+00,
         3.9463e+05, 1.8411e+00],
        [1.6358e+00, 3.8926e+05, 1.9309e+00, 1.7026e+00, 4.0324e+05, 3.8644e+05,
         1.8801e+00, 0.0000e+00, 3.9282e+05, 3.9753e+05, 1.8328e+00, 1.8341e+00,
         3.9464e+05, 1.9127e+00],
        [3.9282e+05, 7.9339e+05, 3.9277e+05, 3.9278e+05, 7.9131e+05, 7.8272e+05,
         3.9277e+05, 3.9282e+05, 0.0000e+00, 7.9256e+05, 3.9278e+05, 3.9280e+05,
         7.7235e+05, 3.9279e+05],
        [3.9747e+05, 7.7362e+05, 3.9753e+05, 3.9748e+05, 7.8733e+05, 7.9065e+05,
         3.9751e+05, 3.9753e+05, 7.9256e+05, 0.0000e+00, 3.9746e+05, 3.9752e+05,
         8.0111e+05, 3.9749e+05],
        [1.6346e+00, 3.8922e+05, 1.7997e+00, 1.6396e+00, 4.0323e+05, 3.8639e+05,
         1.7643e+00, 1.8328e+00, 3.9278e+05, 3.9746e+05, 0.0000e+00, 1.8670e+00,
         3.9460e+05, 1.7090e+00],
        [1.8298e+00, 3.8920e+05, 1.6901e+00, 1.8344e+00, 4.0321e+05, 3.8639e+05,
         1.9115e+00, 1.8341e+00, 3.9280e+05, 3.9752e+05, 1.8670e+00, 0.0000e+00,
         3.9466e+05, 1.9642e+00],
        [3.9462e+05, 7.6853e+05, 3.9461e+05, 3.9463e+05, 8.1936e+05, 7.8728e+05,
         3.9463e+05, 3.9464e+05, 7.7235e+05, 8.0111e+05, 3.9460e+05, 3.9466e+05,
         0.0000e+00, 3.9460e+05],
        [1.8121e+00, 3.8925e+05, 1.8889e+00, 1.6598e+00, 4.0323e+05, 3.8642e+05,
         1.8411e+00, 1.9127e+00, 3.9279e+05, 3.9749e+05, 1.7090e+00, 1.9642e+00,
         3.9460e+05, 0.0000e+00]])
Krum scores: ['1.74', '389230.56', '1.80', '1.73', '403220.16', '386419.00', '1.84', '1.80', '392782.19', '397487.94', '1.73', '1.83', '394616.06', '1.80']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 17, 1, 9, 20, 18, 8, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:31...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 49 214]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:31, End: 2025-07-22 15:31:31)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6792e+00, 1.7282e+00, 3.8573e+05, 1.6612e+00, 1.8809e+00,
         3.9255e+05, 3.8590e+05, 1.8584e+00, 3.8996e+05, 1.6215e+00, 3.9452e+05,
         3.9751e+05, 1.6159e+00, 1.7378e+00, 3.7867e+05],
        [1.6792e+00, 0.0000e+00, 1.6048e+00, 3.8574e+05, 1.8100e+00, 1.9437e+00,
         3.9252e+05, 3.8587e+05, 1.8614e+00, 3.8998e+05, 1.8741e+00, 3.9452e+05,
         3.9752e+05, 1.6718e+00, 1.8733e+00, 3.7865e+05],
        [1.7282e+00, 1.6048e+00, 0.0000e+00, 3.8575e+05, 1.6755e+00, 1.7362e+00,
         3.9256e+05, 3.8593e+05, 1.8372e+00, 3.8996e+05, 1.7691e+00, 3.9451e+05,
         3.9753e+05, 1.7235e+00, 1.7205e+00, 3.7866e+05],
        [3.8573e+05, 3.8574e+05, 3.8575e+05, 0.0000e+00, 3.8575e+05, 3.8572e+05,
         7.6770e+05, 7.7056e+05, 3.8573e+05, 7.6043e+05, 3.8571e+05, 7.8250e+05,
         7.8994e+05, 3.8574e+05, 3.8573e+05, 7.6142e+05],
        [1.6612e+00, 1.8100e+00, 1.6755e+00, 3.8575e+05, 0.0000e+00, 1.6185e+00,
         3.9257e+05, 3.8589e+05, 1.9283e+00, 3.8996e+05, 1.8115e+00, 3.9457e+05,
         3.9749e+05, 1.6759e+00, 1.5533e+00, 3.7869e+05],
        [1.8809e+00, 1.9437e+00, 1.7362e+00, 3.8572e+05, 1.6185e+00, 0.0000e+00,
         3.9254e+05, 3.8587e+05, 1.8857e+00, 3.9000e+05, 1.8108e+00, 3.9456e+05,
         3.9752e+05, 1.8330e+00, 1.6097e+00, 3.7868e+05],
        [3.9255e+05, 3.9252e+05, 3.9256e+05, 7.6770e+05, 3.9257e+05, 3.9254e+05,
         0.0000e+00, 7.7440e+05, 3.9253e+05, 7.7348e+05, 3.9257e+05, 7.7211e+05,
         8.1456e+05, 3.9253e+05, 3.9260e+05, 7.6677e+05],
        [3.8590e+05, 3.8587e+05, 3.8593e+05, 7.7056e+05, 3.8589e+05, 3.8587e+05,
         7.7440e+05, 0.0000e+00, 3.8585e+05, 7.6314e+05, 3.8589e+05, 7.7504e+05,
         7.8568e+05, 3.8585e+05, 3.8584e+05, 7.5441e+05],
        [1.8584e+00, 1.8614e+00, 1.8372e+00, 3.8573e+05, 1.9283e+00, 1.8857e+00,
         3.9253e+05, 3.8585e+05, 0.0000e+00, 3.8998e+05, 1.8455e+00, 3.9454e+05,
         3.9752e+05, 1.7109e+00, 1.7619e+00, 3.7867e+05],
        [3.8996e+05, 3.8998e+05, 3.8996e+05, 7.6043e+05, 3.8996e+05, 3.9000e+05,
         7.7348e+05, 7.6314e+05, 3.8998e+05, 0.0000e+00, 3.8997e+05, 7.9197e+05,
         7.7860e+05, 3.8996e+05, 3.8999e+05, 7.6278e+05],
        [1.6215e+00, 1.8741e+00, 1.7691e+00, 3.8571e+05, 1.8115e+00, 1.8108e+00,
         3.9257e+05, 3.8589e+05, 1.8455e+00, 3.8997e+05, 0.0000e+00, 3.9453e+05,
         3.9749e+05, 1.8365e+00, 1.7350e+00, 3.7870e+05],
        [3.9452e+05, 3.9452e+05, 3.9451e+05, 7.8250e+05, 3.9457e+05, 3.9456e+05,
         7.7211e+05, 7.7504e+05, 3.9454e+05, 7.9197e+05, 3.9453e+05, 0.0000e+00,
         8.0918e+05, 3.9453e+05, 3.9456e+05, 7.7930e+05],
        [3.9751e+05, 3.9752e+05, 3.9753e+05, 7.8994e+05, 3.9749e+05, 3.9752e+05,
         8.1456e+05, 7.8568e+05, 3.9752e+05, 7.7860e+05, 3.9749e+05, 8.0918e+05,
         0.0000e+00, 3.9750e+05, 3.9748e+05, 7.7476e+05],
        [1.6159e+00, 1.6718e+00, 1.7235e+00, 3.8574e+05, 1.6759e+00, 1.8330e+00,
         3.9253e+05, 3.8585e+05, 1.7109e+00, 3.8996e+05, 1.8365e+00, 3.9453e+05,
         3.9750e+05, 0.0000e+00, 1.7524e+00, 3.7869e+05],
        [1.7378e+00, 1.8733e+00, 1.7205e+00, 3.8573e+05, 1.5533e+00, 1.6097e+00,
         3.9260e+05, 3.8584e+05, 1.7619e+00, 3.8999e+05, 1.7350e+00, 3.9456e+05,
         3.9748e+05, 1.7524e+00, 0.0000e+00, 3.7866e+05],
        [3.7867e+05, 3.7865e+05, 3.7866e+05, 7.6142e+05, 3.7869e+05, 3.7868e+05,
         7.6677e+05, 7.5441e+05, 3.7867e+05, 7.6278e+05, 3.7870e+05, 7.7930e+05,
         7.7476e+05, 3.7869e+05, 3.7866e+05, 0.0000e+00]])
Krum scores: ['1.70', '1.77', '1.71', '385729.75', '1.69', '1.77', '392541.06', '385866.03', '1.82', '389970.50', '1.78', '394531.56', '397500.75', '1.71', '1.70', '378667.91']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0038s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:32...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:32, End: 2025-07-22 15:31:32)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
tensor([[0.0000e+00, 1.5316e+00, 1.6744e+00, 3.9772e+05, 4.0791e+05, 1.9134e+00,
         1.6817e+00, 3.9264e+05, 3.8732e+05, 1.7009e+00, 3.9199e+05, 1.5581e+00,
         1.4932e+00, 3.9486e+05, 3.8833e+05, 1.4719e+00, 1.5649e+00, 3.8521e+05,
         1.6593e+00, 1.5928e+00],
        [1.5316e+00, 0.0000e+00, 1.4830e+00, 3.9771e+05, 4.0791e+05, 2.1782e+00,
         1.7077e+00, 3.9264e+05, 3.8731e+05, 1.6961e+00, 3.9196e+05, 1.5092e+00,
         1.6634e+00, 3.9484e+05, 3.8833e+05, 1.5653e+00, 1.6514e+00, 3.8522e+05,
         1.6615e+00, 1.6922e+00],
        [1.6744e+00, 1.4830e+00, 0.0000e+00, 3.9771e+05, 4.0793e+05, 2.0192e+00,
         1.5380e+00, 3.9266e+05, 3.8728e+05, 1.6466e+00, 3.9198e+05, 1.5935e+00,
         1.5753e+00, 3.9485e+05, 3.8831e+05, 1.5856e+00, 1.6000e+00, 3.8519e+05,
         1.4969e+00, 1.6411e+00],
        [3.9772e+05, 3.9771e+05, 3.9771e+05, 0.0000e+00, 8.0377e+05, 3.9771e+05,
         3.9769e+05, 8.0433e+05, 7.9199e+05, 3.9774e+05, 7.8710e+05, 3.9771e+05,
         3.9772e+05, 7.9939e+05, 7.8528e+05, 3.9770e+05, 3.9772e+05, 7.8536e+05,
         3.9771e+05, 3.9772e+05],
        [4.0791e+05, 4.0791e+05, 4.0793e+05, 8.0377e+05, 0.0000e+00, 4.0793e+05,
         4.0794e+05, 8.0349e+05, 7.9508e+05, 4.0794e+05, 7.8691e+05, 4.0792e+05,
         4.0796e+05, 8.1740e+05, 8.0841e+05, 4.0790e+05, 4.0793e+05, 7.8501e+05,
         4.0792e+05, 4.0792e+05],
        [1.9134e+00, 2.1782e+00, 2.0192e+00, 3.9771e+05, 4.0793e+05, 0.0000e+00,
         1.6785e+00, 3.9265e+05, 3.8729e+05, 2.2312e+00, 3.9196e+05, 2.1588e+00,
         2.0488e+00, 3.9491e+05, 3.8831e+05, 1.9740e+00, 1.6675e+00, 3.8525e+05,
         2.1486e+00, 2.0480e+00],
        [1.6817e+00, 1.7077e+00, 1.5380e+00, 3.9769e+05, 4.0794e+05, 1.6785e+00,
         0.0000e+00, 3.9266e+05, 3.8730e+05, 1.6765e+00, 3.9194e+05, 1.6183e+00,
         1.5488e+00, 3.9486e+05, 3.8829e+05, 1.5807e+00, 1.4244e+00, 3.8520e+05,
         1.6338e+00, 1.6398e+00],
        [3.9264e+05, 3.9264e+05, 3.9266e+05, 8.0433e+05, 8.0349e+05, 3.9265e+05,
         3.9266e+05, 0.0000e+00, 7.8280e+05, 3.9267e+05, 7.7880e+05, 3.9266e+05,
         3.9267e+05, 8.0114e+05, 7.7703e+05, 3.9267e+05, 3.9266e+05, 7.9168e+05,
         3.9262e+05, 3.9263e+05],
        [3.8732e+05, 3.8731e+05, 3.8728e+05, 7.9199e+05, 7.9508e+05, 3.8729e+05,
         3.8730e+05, 7.8280e+05, 0.0000e+00, 3.8730e+05, 7.6713e+05, 3.8731e+05,
         3.8730e+05, 8.0434e+05, 7.6234e+05, 3.8731e+05, 3.8730e+05, 7.9058e+05,
         3.8734e+05, 3.8732e+05],
        [1.7009e+00, 1.6961e+00, 1.6466e+00, 3.9774e+05, 4.0794e+05, 2.2312e+00,
         1.6765e+00, 3.9267e+05, 3.8730e+05, 0.0000e+00, 3.9195e+05, 1.5584e+00,
         1.6782e+00, 3.9485e+05, 3.8829e+05, 1.6338e+00, 1.5814e+00, 3.8523e+05,
         1.6490e+00, 1.5901e+00],
        [3.9199e+05, 3.9196e+05, 3.9198e+05, 7.8710e+05, 7.8691e+05, 3.9196e+05,
         3.9194e+05, 7.7880e+05, 7.6713e+05, 3.9195e+05, 0.0000e+00, 3.9198e+05,
         3.9195e+05, 7.7273e+05, 7.6618e+05, 3.9197e+05, 3.9201e+05, 7.5077e+05,
         3.9198e+05, 3.9197e+05],
        [1.5581e+00, 1.5092e+00, 1.5935e+00, 3.9771e+05, 4.0792e+05, 2.1588e+00,
         1.6183e+00, 3.9266e+05, 3.8731e+05, 1.5584e+00, 3.9198e+05, 0.0000e+00,
         1.6160e+00, 3.9485e+05, 3.8834e+05, 1.5288e+00, 1.7282e+00, 3.8521e+05,
         1.5449e+00, 1.6198e+00],
        [1.4932e+00, 1.6634e+00, 1.5753e+00, 3.9772e+05, 4.0796e+05, 2.0488e+00,
         1.5488e+00, 3.9267e+05, 3.8730e+05, 1.6782e+00, 3.9195e+05, 1.6160e+00,
         0.0000e+00, 3.9487e+05, 3.8830e+05, 1.6638e+00, 1.5887e+00, 3.8519e+05,
         1.7126e+00, 1.4884e+00],
        [3.9486e+05, 3.9484e+05, 3.9485e+05, 7.9939e+05, 8.1740e+05, 3.9491e+05,
         3.9486e+05, 8.0114e+05, 8.0434e+05, 3.9485e+05, 7.7273e+05, 3.9485e+05,
         3.9487e+05, 0.0000e+00, 7.9729e+05, 3.9484e+05, 3.9485e+05, 7.7260e+05,
         3.9487e+05, 3.9486e+05],
        [3.8833e+05, 3.8833e+05, 3.8831e+05, 7.8528e+05, 8.0841e+05, 3.8831e+05,
         3.8829e+05, 7.7703e+05, 7.6234e+05, 3.8829e+05, 7.6618e+05, 3.8834e+05,
         3.8830e+05, 7.9729e+05, 0.0000e+00, 3.8831e+05, 3.8832e+05, 7.6943e+05,
         3.8829e+05, 3.8831e+05],
        [1.4719e+00, 1.5653e+00, 1.5856e+00, 3.9770e+05, 4.0790e+05, 1.9740e+00,
         1.5807e+00, 3.9267e+05, 3.8731e+05, 1.6338e+00, 3.9197e+05, 1.5288e+00,
         1.6638e+00, 3.9484e+05, 3.8831e+05, 0.0000e+00, 1.5758e+00, 3.8521e+05,
         1.5626e+00, 1.6435e+00],
        [1.5649e+00, 1.6514e+00, 1.6000e+00, 3.9772e+05, 4.0793e+05, 1.6675e+00,
         1.4244e+00, 3.9266e+05, 3.8730e+05, 1.5814e+00, 3.9201e+05, 1.7282e+00,
         1.5887e+00, 3.9485e+05, 3.8832e+05, 1.5758e+00, 0.0000e+00, 3.8523e+05,
         1.6969e+00, 1.6248e+00],
        [3.8521e+05, 3.8522e+05, 3.8519e+05, 7.8536e+05, 7.8501e+05, 3.8525e+05,
         3.8520e+05, 7.9168e+05, 7.9058e+05, 3.8523e+05, 7.5077e+05, 3.8521e+05,
         3.8519e+05, 7.7260e+05, 7.6943e+05, 3.8521e+05, 3.8523e+05, 0.0000e+00,
         3.8520e+05, 3.8520e+05],
        [1.6593e+00, 1.6615e+00, 1.4969e+00, 3.9771e+05, 4.0792e+05, 2.1486e+00,
         1.6338e+00, 3.9262e+05, 3.8734e+05, 1.6490e+00, 3.9198e+05, 1.5449e+00,
         1.7126e+00, 3.9487e+05, 3.8829e+05, 1.5626e+00, 1.6969e+00, 3.8520e+05,
         0.0000e+00, 1.6470e+00],
        [1.5928e+00, 1.6922e+00, 1.6411e+00, 3.9772e+05, 4.0792e+05, 2.0480e+00,
         1.6398e+00, 3.9263e+05, 3.8732e+05, 1.5901e+00, 3.9197e+05, 1.6198e+00,
         1.4884e+00, 3.9486e+05, 3.8831e+05, 1.6435e+00, 1.6248e+00, 3.8520e+05,
         1.6470e+00, 0.0000e+00]])
Krum scores: ['1.59', '1.62', '1.58', '397709.44', '407921.06', '1.98', '1.60', '392648.53', '387302.16', '1.64', '391962.66', '1.59', '1.60', '394852.56', '388307.59', '1.58', '1.60', '385206.62', '1.63', '1.62']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0344s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:32...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:32, End: 2025-07-22 15:31:32)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.6817e+00, 4.0729e+05, 3.9056e+05, 1.8229e+00, 3.9035e+05,
         3.7392e+05, 1.8251e+00, 4.0278e+05, 1.6514e+00, 1.8298e+00, 4.0699e+05,
         3.9342e+05, 1.8804e+00, 1.7936e+00, 1.7591e+00, 1.8021e+00],
        [1.6817e+00, 0.0000e+00, 4.0732e+05, 3.9054e+05, 1.6836e+00, 3.9039e+05,
         3.7390e+05, 1.8684e+00, 4.0281e+05, 1.7295e+00, 1.8407e+00, 4.0698e+05,
         3.9348e+05, 1.9018e+00, 1.6968e+00, 1.5624e+00, 1.7814e+00],
        [4.0729e+05, 4.0732e+05, 0.0000e+00, 8.0293e+05, 4.0733e+05, 7.9575e+05,
         7.7774e+05, 4.0731e+05, 8.3167e+05, 4.0732e+05, 4.0729e+05, 8.1925e+05,
         7.7970e+05, 4.0728e+05, 4.0736e+05, 4.0733e+05, 4.0734e+05],
        [3.9056e+05, 3.9054e+05, 8.0293e+05, 0.0000e+00, 3.9056e+05, 7.7647e+05,
         7.6008e+05, 3.9056e+05, 7.9426e+05, 3.9053e+05, 3.9053e+05, 7.9027e+05,
         7.7708e+05, 3.9058e+05, 3.9057e+05, 3.9053e+05, 3.9059e+05],
        [1.8229e+00, 1.6836e+00, 4.0733e+05, 3.9056e+05, 0.0000e+00, 3.9034e+05,
         3.7388e+05, 1.7325e+00, 4.0281e+05, 1.6663e+00, 1.6628e+00, 4.0700e+05,
         3.9346e+05, 1.7498e+00, 1.5558e+00, 1.6293e+00, 1.7990e+00],
        [3.9035e+05, 3.9039e+05, 7.9575e+05, 7.7647e+05, 3.9034e+05, 0.0000e+00,
         7.6228e+05, 3.9035e+05, 7.9469e+05, 3.9037e+05, 3.9034e+05, 7.9265e+05,
         7.8781e+05, 3.9035e+05, 3.9035e+05, 3.9035e+05, 3.9036e+05],
        [3.7392e+05, 3.7390e+05, 7.7774e+05, 7.6008e+05, 3.7388e+05, 7.6228e+05,
         0.0000e+00, 3.7391e+05, 7.8977e+05, 3.7390e+05, 3.7391e+05, 7.6779e+05,
         7.8324e+05, 3.7394e+05, 3.7394e+05, 3.7390e+05, 3.7392e+05],
        [1.8251e+00, 1.8684e+00, 4.0731e+05, 3.9056e+05, 1.7325e+00, 3.9035e+05,
         3.7391e+05, 0.0000e+00, 4.0281e+05, 1.6406e+00, 1.8766e+00, 4.0701e+05,
         3.9346e+05, 1.9077e+00, 1.6465e+00, 1.7433e+00, 1.7643e+00],
        [4.0278e+05, 4.0281e+05, 8.3167e+05, 7.9426e+05, 4.0281e+05, 7.9469e+05,
         7.8977e+05, 4.0281e+05, 0.0000e+00, 4.0279e+05, 4.0283e+05, 8.1726e+05,
         7.8556e+05, 4.0284e+05, 4.0279e+05, 4.0283e+05, 4.0283e+05],
        [1.6514e+00, 1.7295e+00, 4.0732e+05, 3.9053e+05, 1.6663e+00, 3.9037e+05,
         3.7390e+05, 1.6406e+00, 4.0279e+05, 0.0000e+00, 1.8017e+00, 4.0701e+05,
         3.9342e+05, 1.8158e+00, 1.7441e+00, 1.5968e+00, 1.6987e+00],
        [1.8298e+00, 1.8407e+00, 4.0729e+05, 3.9053e+05, 1.6628e+00, 3.9034e+05,
         3.7391e+05, 1.8766e+00, 4.0283e+05, 1.8017e+00, 0.0000e+00, 4.0700e+05,
         3.9343e+05, 2.0061e+00, 1.7399e+00, 1.8284e+00, 1.6652e+00],
        [4.0699e+05, 4.0698e+05, 8.1925e+05, 7.9027e+05, 4.0700e+05, 7.9265e+05,
         7.6779e+05, 4.0701e+05, 8.1726e+05, 4.0701e+05, 4.0700e+05, 0.0000e+00,
         8.1135e+05, 4.0697e+05, 4.0702e+05, 4.0700e+05, 4.0698e+05],
        [3.9342e+05, 3.9348e+05, 7.7970e+05, 7.7708e+05, 3.9346e+05, 7.8781e+05,
         7.8324e+05, 3.9346e+05, 7.8556e+05, 3.9342e+05, 3.9343e+05, 8.1135e+05,
         0.0000e+00, 3.9345e+05, 3.9344e+05, 3.9343e+05, 3.9343e+05],
        [1.8804e+00, 1.9018e+00, 4.0728e+05, 3.9058e+05, 1.7498e+00, 3.9035e+05,
         3.7394e+05, 1.9077e+00, 4.0284e+05, 1.8158e+00, 2.0061e+00, 4.0697e+05,
         3.9345e+05, 0.0000e+00, 1.7267e+00, 1.8301e+00, 1.9010e+00],
        [1.7936e+00, 1.6968e+00, 4.0736e+05, 3.9057e+05, 1.5558e+00, 3.9035e+05,
         3.7394e+05, 1.6465e+00, 4.0279e+05, 1.7441e+00, 1.7399e+00, 4.0702e+05,
         3.9344e+05, 1.7267e+00, 0.0000e+00, 1.7494e+00, 1.7549e+00],
        [1.7591e+00, 1.5624e+00, 4.0733e+05, 3.9053e+05, 1.6293e+00, 3.9035e+05,
         3.7390e+05, 1.7433e+00, 4.0283e+05, 1.5968e+00, 1.8284e+00, 4.0700e+05,
         3.9343e+05, 1.8301e+00, 1.7494e+00, 0.0000e+00, 1.7161e+00],
        [1.8021e+00, 1.7814e+00, 4.0734e+05, 3.9059e+05, 1.7990e+00, 3.9036e+05,
         3.7392e+05, 1.7643e+00, 4.0283e+05, 1.6987e+00, 1.6652e+00, 4.0698e+05,
         3.9343e+05, 1.9010e+00, 1.7549e+00, 1.7161e+00, 0.0000e+00]])
Krum scores: ['1.77', '1.73', '407308.53', '390547.69', '1.68', '390349.31', '373904.91', '1.76', '402806.62', '1.69', '1.78', '406991.22', '393435.25', '1.84', '1.70', '1.70', '1.75']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:33...
global Accuracy on shared test data: 78.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 49 214]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:33, End: 2025-07-22 15:31:33)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 17, 1, 9, 20, 8, 15, 4, 3, 14, 11, 10, 16, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.4906e+00, 3.9264e+05, 1.7543e+00, 1.9547e+00, 3.9985e+05,
         1.6039e+00, 3.8799e+05, 1.4812e+00, 1.5051e+00, 4.0883e+05, 1.5006e+00,
         1.5298e+00, 3.9261e+05, 1.5692e+00],
        [1.4906e+00, 0.0000e+00, 3.9263e+05, 1.9127e+00, 2.0099e+00, 3.9987e+05,
         1.6340e+00, 3.8804e+05, 1.5047e+00, 1.6904e+00, 4.0886e+05, 1.6223e+00,
         1.6482e+00, 3.9263e+05, 1.6556e+00],
        [3.9264e+05, 3.9263e+05, 0.0000e+00, 3.9261e+05, 3.9258e+05, 7.7759e+05,
         3.9264e+05, 7.8760e+05, 3.9261e+05, 3.9262e+05, 7.8446e+05, 3.9263e+05,
         3.9262e+05, 7.8472e+05, 3.9264e+05],
        [1.7543e+00, 1.9127e+00, 3.9261e+05, 0.0000e+00, 1.4850e+00, 3.9988e+05,
         1.9698e+00, 3.8800e+05, 1.8726e+00, 1.8756e+00, 4.0882e+05, 1.4362e+00,
         1.5004e+00, 3.9266e+05, 1.8064e+00],
        [1.9547e+00, 2.0099e+00, 3.9258e+05, 1.4850e+00, 0.0000e+00, 3.9985e+05,
         1.9971e+00, 3.8801e+05, 1.9701e+00, 1.8994e+00, 4.0881e+05, 1.6357e+00,
         1.6238e+00, 3.9264e+05, 1.9470e+00],
        [3.9985e+05, 3.9987e+05, 7.7759e+05, 3.9988e+05, 3.9985e+05, 0.0000e+00,
         3.9985e+05, 7.6511e+05, 3.9988e+05, 3.9986e+05, 8.1024e+05, 3.9984e+05,
         3.9988e+05, 7.8668e+05, 3.9988e+05],
        [1.6039e+00, 1.6340e+00, 3.9264e+05, 1.9698e+00, 1.9971e+00, 3.9985e+05,
         0.0000e+00, 3.8802e+05, 1.5134e+00, 1.7058e+00, 4.0885e+05, 1.6049e+00,
         1.5068e+00, 3.9263e+05, 1.5393e+00],
        [3.8799e+05, 3.8804e+05, 7.8760e+05, 3.8800e+05, 3.8801e+05, 7.6511e+05,
         3.8802e+05, 0.0000e+00, 3.8803e+05, 3.8803e+05, 7.9389e+05, 3.8803e+05,
         3.8802e+05, 7.8385e+05, 3.8804e+05],
        [1.4812e+00, 1.5047e+00, 3.9261e+05, 1.8726e+00, 1.9701e+00, 3.9988e+05,
         1.5134e+00, 3.8803e+05, 0.0000e+00, 1.6789e+00, 4.0886e+05, 1.5922e+00,
         1.6703e+00, 3.9265e+05, 1.5709e+00],
        [1.5051e+00, 1.6904e+00, 3.9262e+05, 1.8756e+00, 1.8994e+00, 3.9986e+05,
         1.7058e+00, 3.8803e+05, 1.6789e+00, 0.0000e+00, 4.0885e+05, 1.7272e+00,
         1.6239e+00, 3.9263e+05, 1.4847e+00],
        [4.0883e+05, 4.0886e+05, 7.8446e+05, 4.0882e+05, 4.0881e+05, 8.1024e+05,
         4.0885e+05, 7.9389e+05, 4.0886e+05, 4.0885e+05, 0.0000e+00, 4.0880e+05,
         4.0885e+05, 8.1581e+05, 4.0884e+05],
        [1.5006e+00, 1.6223e+00, 3.9263e+05, 1.4362e+00, 1.6357e+00, 3.9984e+05,
         1.6049e+00, 3.8803e+05, 1.5922e+00, 1.7272e+00, 4.0880e+05, 0.0000e+00,
         1.4974e+00, 3.9263e+05, 1.6289e+00],
        [1.5298e+00, 1.6482e+00, 3.9262e+05, 1.5004e+00, 1.6238e+00, 3.9988e+05,
         1.5068e+00, 3.8802e+05, 1.6703e+00, 1.6239e+00, 4.0885e+05, 1.4974e+00,
         0.0000e+00, 3.9264e+05, 1.5868e+00],
        [3.9261e+05, 3.9263e+05, 7.8472e+05, 3.9266e+05, 3.9264e+05, 7.8668e+05,
         3.9263e+05, 7.8385e+05, 3.9265e+05, 3.9263e+05, 8.1581e+05, 3.9263e+05,
         3.9264e+05, 0.0000e+00, 3.9262e+05],
        [1.5692e+00, 1.6556e+00, 3.9264e+05, 1.8064e+00, 1.9470e+00, 3.9988e+05,
         1.5393e+00, 3.8804e+05, 1.5709e+00, 1.4847e+00, 4.0884e+05, 1.6289e+00,
         1.5868e+00, 3.9262e+05, 0.0000e+00]])
Krum scores: ['1.55', '1.64', '392619.38', '1.71', '1.81', '399859.16', '1.63', '388016.59', '1.61', '1.66', '408834.25', '1.56', '1.56', '392628.47', '1.61']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 17, 1, 9, 20, 8, 15, 4, 3, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0032s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:33...
global Accuracy on shared test data: 78.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[190  47]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:33, End: 2025-07-22 15:31:33)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 19, 17, 1, 9, 18, 8, 15, 4, 3, 13, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.9524e+00, 4.0090e+05, 3.9231e+05, 1.6375e+00, 1.6842e+00,
         3.9646e+05, 1.9855e+00, 3.9526e+05, 1.7703e+00, 1.8289e+00, 3.8920e+05,
         4.0335e+05, 1.9434e+00, 1.9556e+00],
        [1.9524e+00, 0.0000e+00, 4.0094e+05, 3.9234e+05, 1.8582e+00, 1.7008e+00,
         3.9644e+05, 1.7333e+00, 3.9529e+05, 1.6661e+00, 1.7234e+00, 3.8916e+05,
         4.0343e+05, 1.5765e+00, 1.8047e+00],
        [4.0090e+05, 4.0094e+05, 0.0000e+00, 7.8348e+05, 4.0087e+05, 4.0091e+05,
         8.0428e+05, 4.0090e+05, 7.9263e+05, 4.0091e+05, 4.0093e+05, 7.8019e+05,
         8.0909e+05, 4.0092e+05, 4.0092e+05],
        [3.9231e+05, 3.9234e+05, 7.8348e+05, 0.0000e+00, 3.9232e+05, 3.9231e+05,
         7.9464e+05, 3.9237e+05, 7.7963e+05, 3.9235e+05, 3.9234e+05, 8.1005e+05,
         7.6894e+05, 3.9237e+05, 3.9235e+05],
        [1.6375e+00, 1.8582e+00, 4.0087e+05, 3.9232e+05, 0.0000e+00, 1.4520e+00,
         3.9643e+05, 1.9826e+00, 3.9525e+05, 1.9028e+00, 1.8910e+00, 3.8919e+05,
         4.0338e+05, 1.9358e+00, 1.9612e+00],
        [1.6842e+00, 1.7008e+00, 4.0091e+05, 3.9231e+05, 1.4520e+00, 0.0000e+00,
         3.9643e+05, 1.8662e+00, 3.9529e+05, 1.7887e+00, 1.7254e+00, 3.8917e+05,
         4.0340e+05, 1.7903e+00, 1.9143e+00],
        [3.9646e+05, 3.9644e+05, 8.0428e+05, 7.9464e+05, 3.9643e+05, 3.9643e+05,
         0.0000e+00, 3.9645e+05, 7.9651e+05, 3.9645e+05, 3.9644e+05, 7.8178e+05,
         7.9172e+05, 3.9645e+05, 3.9643e+05],
        [1.9855e+00, 1.7333e+00, 4.0090e+05, 3.9237e+05, 1.9826e+00, 1.8662e+00,
         3.9645e+05, 0.0000e+00, 3.9526e+05, 1.5725e+00, 1.7484e+00, 3.8918e+05,
         4.0342e+05, 1.6148e+00, 1.7159e+00],
        [3.9526e+05, 3.9529e+05, 7.9263e+05, 7.7963e+05, 3.9525e+05, 3.9529e+05,
         7.9651e+05, 3.9526e+05, 0.0000e+00, 3.9531e+05, 3.9530e+05, 7.6541e+05,
         7.9834e+05, 3.9527e+05, 3.9527e+05],
        [1.7703e+00, 1.6661e+00, 4.0091e+05, 3.9235e+05, 1.9028e+00, 1.7887e+00,
         3.9645e+05, 1.5725e+00, 3.9531e+05, 0.0000e+00, 1.7495e+00, 3.8918e+05,
         4.0341e+05, 1.6100e+00, 1.7440e+00],
        [1.8289e+00, 1.7234e+00, 4.0093e+05, 3.9234e+05, 1.8910e+00, 1.7254e+00,
         3.9644e+05, 1.7484e+00, 3.9530e+05, 1.7495e+00, 0.0000e+00, 3.8918e+05,
         4.0337e+05, 1.7996e+00, 1.6481e+00],
        [3.8920e+05, 3.8916e+05, 7.8019e+05, 8.1005e+05, 3.8919e+05, 3.8917e+05,
         7.8178e+05, 3.8918e+05, 7.6541e+05, 3.8918e+05, 3.8918e+05, 0.0000e+00,
         7.8749e+05, 3.8917e+05, 3.8920e+05],
        [4.0335e+05, 4.0343e+05, 8.0909e+05, 7.6894e+05, 4.0338e+05, 4.0340e+05,
         7.9172e+05, 4.0342e+05, 7.9834e+05, 4.0341e+05, 4.0337e+05, 7.8749e+05,
         0.0000e+00, 4.0340e+05, 4.0340e+05],
        [1.9434e+00, 1.5765e+00, 4.0092e+05, 3.9237e+05, 1.9358e+00, 1.7903e+00,
         3.9645e+05, 1.6148e+00, 3.9527e+05, 1.6100e+00, 1.7996e+00, 3.8917e+05,
         4.0340e+05, 0.0000e+00, 1.7676e+00],
        [1.9556e+00, 1.8047e+00, 4.0092e+05, 3.9235e+05, 1.9612e+00, 1.9143e+00,
         3.9643e+05, 1.7159e+00, 3.9527e+05, 1.7440e+00, 1.6481e+00, 3.8920e+05,
         4.0340e+05, 1.7676e+00, 0.0000e+00]])
Krum scores: ['1.82', '1.72', '400902.59', '392331.91', '1.81', '1.72', '396436.03', '1.75', '395269.03', '1.70', '1.75', '389177.94', '403387.34', '1.73', '1.79']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 19, 17, 1, 9, 18, 8, 15, 4, 3, 13, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0031s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:34...
global Accuracy on shared test data: 78.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[187  50]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:34, End: 2025-07-22 15:31:34)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.8726e+00, 3.8928e+05, 1.5688e+00, 1.6686e+00, 3.9970e+05,
         3.9320e+05, 1.9388e+00, 3.8637e+05, 1.6556e+00, 1.7499e+00, 3.9140e+05,
         3.9267e+05, 1.6176e+00, 4.0420e+05, 1.9529e+00, 1.8508e+00],
        [1.8726e+00, 0.0000e+00, 3.8936e+05, 1.8875e+00, 1.8001e+00, 3.9969e+05,
         3.9318e+05, 1.8402e+00, 3.8639e+05, 1.8755e+00, 1.7634e+00, 3.9140e+05,
         3.9266e+05, 1.7803e+00, 4.0419e+05, 1.5872e+00, 1.7872e+00],
        [3.8928e+05, 3.8936e+05, 0.0000e+00, 3.8933e+05, 3.8931e+05, 8.1279e+05,
         8.1349e+05, 3.8933e+05, 7.8469e+05, 3.8932e+05, 3.8935e+05, 7.8159e+05,
         7.8983e+05, 3.8933e+05, 7.8332e+05, 3.8935e+05, 3.8935e+05],
        [1.5688e+00, 1.8875e+00, 3.8933e+05, 0.0000e+00, 1.4703e+00, 3.9971e+05,
         3.9319e+05, 2.0121e+00, 3.8637e+05, 1.7075e+00, 1.9151e+00, 3.9137e+05,
         3.9267e+05, 1.5833e+00, 4.0415e+05, 1.9390e+00, 1.9006e+00],
        [1.6686e+00, 1.8001e+00, 3.8931e+05, 1.4703e+00, 0.0000e+00, 3.9971e+05,
         3.9317e+05, 1.9499e+00, 3.8642e+05, 1.6669e+00, 1.8345e+00, 3.9139e+05,
         3.9269e+05, 1.6067e+00, 4.0417e+05, 1.8416e+00, 1.9284e+00],
        [3.9970e+05, 3.9969e+05, 8.1279e+05, 3.9971e+05, 3.9971e+05, 0.0000e+00,
         8.0569e+05, 3.9970e+05, 7.8571e+05, 3.9971e+05, 3.9968e+05, 7.9367e+05,
         7.8428e+05, 3.9970e+05, 8.1365e+05, 3.9970e+05, 3.9973e+05],
        [3.9320e+05, 3.9318e+05, 8.1349e+05, 3.9319e+05, 3.9317e+05, 8.0569e+05,
         0.0000e+00, 3.9317e+05, 7.7484e+05, 3.9319e+05, 3.9315e+05, 7.9995e+05,
         7.8110e+05, 3.9318e+05, 8.0471e+05, 3.9320e+05, 3.9318e+05],
        [1.9388e+00, 1.8402e+00, 3.8933e+05, 2.0121e+00, 1.9499e+00, 3.9970e+05,
         3.9317e+05, 0.0000e+00, 3.8639e+05, 1.8563e+00, 1.8225e+00, 3.9142e+05,
         3.9269e+05, 1.7395e+00, 4.0413e+05, 1.7164e+00, 1.7672e+00],
        [3.8637e+05, 3.8639e+05, 7.8469e+05, 3.8637e+05, 3.8642e+05, 7.8571e+05,
         7.7484e+05, 3.8639e+05, 0.0000e+00, 3.8638e+05, 3.8639e+05, 7.8684e+05,
         7.5301e+05, 3.8637e+05, 7.8061e+05, 3.8639e+05, 3.8641e+05],
        [1.6556e+00, 1.8755e+00, 3.8932e+05, 1.7075e+00, 1.6669e+00, 3.9971e+05,
         3.9319e+05, 1.8563e+00, 3.8638e+05, 0.0000e+00, 1.9929e+00, 3.9135e+05,
         3.9266e+05, 1.7463e+00, 4.0418e+05, 1.9531e+00, 1.9447e+00],
        [1.7499e+00, 1.7634e+00, 3.8935e+05, 1.9151e+00, 1.8345e+00, 3.9968e+05,
         3.9315e+05, 1.8225e+00, 3.8639e+05, 1.9929e+00, 0.0000e+00, 3.9141e+05,
         3.9269e+05, 1.8291e+00, 4.0416e+05, 1.8049e+00, 1.6213e+00],
        [3.9140e+05, 3.9140e+05, 7.8159e+05, 3.9137e+05, 3.9139e+05, 7.9367e+05,
         7.9995e+05, 3.9142e+05, 7.8684e+05, 3.9135e+05, 3.9141e+05, 0.0000e+00,
         7.7729e+05, 3.9139e+05, 7.8319e+05, 3.9143e+05, 3.9141e+05],
        [3.9267e+05, 3.9266e+05, 7.8983e+05, 3.9267e+05, 3.9269e+05, 7.8428e+05,
         7.8110e+05, 3.9269e+05, 7.5301e+05, 3.9266e+05, 3.9269e+05, 7.7729e+05,
         0.0000e+00, 3.9264e+05, 7.9617e+05, 3.9268e+05, 3.9269e+05],
        [1.6176e+00, 1.7803e+00, 3.8933e+05, 1.5833e+00, 1.6067e+00, 3.9970e+05,
         3.9318e+05, 1.7395e+00, 3.8637e+05, 1.7463e+00, 1.8291e+00, 3.9139e+05,
         3.9264e+05, 0.0000e+00, 4.0416e+05, 1.7719e+00, 1.7771e+00],
        [4.0420e+05, 4.0419e+05, 7.8332e+05, 4.0415e+05, 4.0417e+05, 8.1365e+05,
         8.0471e+05, 4.0413e+05, 7.8061e+05, 4.0418e+05, 4.0416e+05, 7.8319e+05,
         7.9617e+05, 4.0416e+05, 0.0000e+00, 4.0414e+05, 4.0417e+05],
        [1.9529e+00, 1.5872e+00, 3.8935e+05, 1.9390e+00, 1.8416e+00, 3.9970e+05,
         3.9320e+05, 1.7164e+00, 3.8639e+05, 1.9531e+00, 1.8049e+00, 3.9143e+05,
         3.9268e+05, 1.7719e+00, 4.0414e+05, 0.0000e+00, 1.7577e+00],
        [1.8508e+00, 1.7872e+00, 3.8935e+05, 1.9006e+00, 1.9284e+00, 3.9973e+05,
         3.9318e+05, 1.7672e+00, 3.8641e+05, 1.9447e+00, 1.6213e+00, 3.9141e+05,
         3.9269e+05, 1.7771e+00, 4.0417e+05, 1.7577e+00, 0.0000e+00]])
Krum scores: ['1.74', '1.79', '389325.69', '1.75', '1.73', '399699.09', '393175.19', '1.83', '386381.78', '1.80', '1.79', '391389.50', '392671.56', '1.70', '404157.44', '1.80', '1.80']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0036s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:35...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:35, End: 2025-07-22 15:31:35)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [19, 17, 1, 9, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 7.6458e+05, 3.9923e+05, 3.9922e+05, 7.8236e+05, 3.9922e+05,
         7.9133e+05, 3.9919e+05, 3.9923e+05, 7.8531e+05, 7.9119e+05, 3.9922e+05,
         3.9921e+05, 7.8923e+05, 3.9921e+05],
        [7.6458e+05, 0.0000e+00, 3.8307e+05, 3.8309e+05, 7.5846e+05, 3.8306e+05,
         7.9259e+05, 3.8305e+05, 3.8309e+05, 7.5588e+05, 7.8675e+05, 3.8307e+05,
         3.8306e+05, 7.8186e+05, 3.8308e+05],
        [3.9923e+05, 3.8307e+05, 0.0000e+00, 1.2886e+00, 3.9022e+05, 1.6971e+00,
         3.9192e+05, 1.3619e+00, 1.6483e+00, 3.7821e+05, 3.9818e+05, 1.3878e+00,
         1.4109e+00, 3.8437e+05, 1.6336e+00],
        [3.9922e+05, 3.8309e+05, 1.2886e+00, 0.0000e+00, 3.9021e+05, 1.7166e+00,
         3.9189e+05, 1.4219e+00, 1.6144e+00, 3.7822e+05, 3.9819e+05, 1.4454e+00,
         1.4818e+00, 3.8437e+05, 1.7208e+00],
        [7.8236e+05, 7.5846e+05, 3.9022e+05, 3.9021e+05, 0.0000e+00, 3.9023e+05,
         7.7956e+05, 3.9021e+05, 3.9020e+05, 7.3820e+05, 7.8610e+05, 3.9022e+05,
         3.9019e+05, 7.6810e+05, 3.9021e+05],
        [3.9922e+05, 3.8306e+05, 1.6971e+00, 1.7166e+00, 3.9023e+05, 0.0000e+00,
         3.9188e+05, 1.4443e+00, 1.5889e+00, 3.7821e+05, 3.9817e+05, 1.8075e+00,
         1.4070e+00, 3.8437e+05, 1.5031e+00],
        [7.9133e+05, 7.9259e+05, 3.9192e+05, 3.9189e+05, 7.7956e+05, 3.9188e+05,
         0.0000e+00, 3.9190e+05, 3.9190e+05, 7.7725e+05, 8.0970e+05, 3.9190e+05,
         3.9192e+05, 7.6802e+05, 3.9190e+05],
        [3.9919e+05, 3.8305e+05, 1.3619e+00, 1.4219e+00, 3.9021e+05, 1.4443e+00,
         3.9190e+05, 0.0000e+00, 1.5612e+00, 3.7819e+05, 3.9817e+05, 1.5234e+00,
         1.4751e+00, 3.8439e+05, 1.5017e+00],
        [3.9923e+05, 3.8309e+05, 1.6483e+00, 1.6144e+00, 3.9020e+05, 1.5889e+00,
         3.9190e+05, 1.5612e+00, 0.0000e+00, 3.7819e+05, 3.9818e+05, 1.8825e+00,
         1.4377e+00, 3.8436e+05, 1.4148e+00],
        [7.8531e+05, 7.5588e+05, 3.7821e+05, 3.7822e+05, 7.3820e+05, 3.7821e+05,
         7.7725e+05, 3.7819e+05, 3.7819e+05, 0.0000e+00, 7.9989e+05, 3.7821e+05,
         3.7820e+05, 7.8382e+05, 3.7818e+05],
        [7.9119e+05, 7.8675e+05, 3.9818e+05, 3.9819e+05, 7.8610e+05, 3.9817e+05,
         8.0970e+05, 3.9817e+05, 3.9818e+05, 7.9989e+05, 0.0000e+00, 3.9822e+05,
         3.9819e+05, 7.8834e+05, 3.9819e+05],
        [3.9922e+05, 3.8307e+05, 1.3878e+00, 1.4454e+00, 3.9022e+05, 1.8075e+00,
         3.9190e+05, 1.5234e+00, 1.8825e+00, 3.7821e+05, 3.9822e+05, 0.0000e+00,
         1.6772e+00, 3.8441e+05, 1.7965e+00],
        [3.9921e+05, 3.8306e+05, 1.4109e+00, 1.4818e+00, 3.9019e+05, 1.4070e+00,
         3.9192e+05, 1.4751e+00, 1.4377e+00, 3.7820e+05, 3.9819e+05, 1.6772e+00,
         0.0000e+00, 3.8438e+05, 1.5238e+00],
        [7.8923e+05, 7.8186e+05, 3.8437e+05, 3.8437e+05, 7.6810e+05, 3.8437e+05,
         7.6802e+05, 3.8439e+05, 3.8436e+05, 7.8382e+05, 7.8834e+05, 3.8441e+05,
         3.8438e+05, 0.0000e+00, 3.8440e+05],
        [3.9921e+05, 3.8308e+05, 1.6336e+00, 1.7208e+00, 3.9021e+05, 1.5031e+00,
         3.9190e+05, 1.5017e+00, 1.4148e+00, 3.7818e+05, 3.9819e+05, 1.7965e+00,
         1.5238e+00, 3.8440e+05, 0.0000e+00]])
Krum scores: ['399213.00', '383065.16', '1.46', '1.49', '390208.12', '1.56', '391896.38', '1.45', '1.54', '378196.62', '398179.56', '1.61', '1.46', '384372.66', '1.55']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [19, 17, 1, 9, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0141s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:35...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:35, End: 2025-07-22 15:31:35)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.3422e+00, 3.8208e+05, 3.6419e+05, 1.6302e+00, 1.5329e+00,
         3.8664e+05, 4.0890e+05, 3.9278e+05, 1.8133e+00, 1.4674e+00, 3.9173e+05,
         3.9500e+05, 1.4036e+00, 3.9825e+05, 1.4853e+00, 1.4658e+00],
        [1.3422e+00, 0.0000e+00, 3.8209e+05, 3.6417e+05, 1.4985e+00, 1.4146e+00,
         3.8663e+05, 4.0887e+05, 3.9279e+05, 1.7589e+00, 1.4172e+00, 3.9175e+05,
         3.9501e+05, 1.3403e+00, 3.9819e+05, 1.3461e+00, 1.4448e+00],
        [3.8208e+05, 3.8209e+05, 0.0000e+00, 7.4211e+05, 3.8205e+05, 3.8211e+05,
         7.8864e+05, 7.5592e+05, 7.7828e+05, 3.8204e+05, 3.8208e+05, 7.8361e+05,
         7.6308e+05, 3.8207e+05, 7.7862e+05, 3.8210e+05, 3.8209e+05],
        [3.6419e+05, 3.6417e+05, 7.4211e+05, 0.0000e+00, 3.6417e+05, 3.6416e+05,
         7.3112e+05, 7.6499e+05, 7.5879e+05, 3.6416e+05, 3.6414e+05, 7.4352e+05,
         7.8713e+05, 3.6415e+05, 7.5790e+05, 3.6420e+05, 3.6416e+05],
        [1.6302e+00, 1.4985e+00, 3.8205e+05, 3.6417e+05, 0.0000e+00, 1.1697e+00,
         3.8666e+05, 4.0893e+05, 3.9281e+05, 1.3643e+00, 1.5327e+00, 3.9169e+05,
         3.9504e+05, 1.3172e+00, 3.9820e+05, 1.5739e+00, 1.5071e+00],
        [1.5329e+00, 1.4146e+00, 3.8211e+05, 3.6416e+05, 1.1697e+00, 0.0000e+00,
         3.8665e+05, 4.0891e+05, 3.9281e+05, 1.3933e+00, 1.4551e+00, 3.9172e+05,
         3.9504e+05, 1.3044e+00, 3.9819e+05, 1.4845e+00, 1.5259e+00],
        [3.8664e+05, 3.8663e+05, 7.8864e+05, 7.3112e+05, 3.8666e+05, 3.8665e+05,
         0.0000e+00, 7.8240e+05, 7.7605e+05, 3.8662e+05, 3.8667e+05, 7.6845e+05,
         7.6296e+05, 3.8666e+05, 7.8100e+05, 3.8666e+05, 3.8660e+05],
        [4.0890e+05, 4.0887e+05, 7.5592e+05, 7.6499e+05, 4.0893e+05, 4.0891e+05,
         7.8240e+05, 0.0000e+00, 8.1836e+05, 4.0890e+05, 4.0889e+05, 8.0370e+05,
         8.0625e+05, 4.0891e+05, 8.0537e+05, 4.0890e+05, 4.0895e+05],
        [3.9278e+05, 3.9279e+05, 7.7828e+05, 7.5879e+05, 3.9281e+05, 3.9281e+05,
         7.7605e+05, 8.1836e+05, 0.0000e+00, 3.9278e+05, 3.9279e+05, 8.0803e+05,
         7.8939e+05, 3.9276e+05, 7.8167e+05, 3.9278e+05, 3.9277e+05],
        [1.8133e+00, 1.7589e+00, 3.8204e+05, 3.6416e+05, 1.3643e+00, 1.3933e+00,
         3.8662e+05, 4.0890e+05, 3.9278e+05, 0.0000e+00, 1.8421e+00, 3.9173e+05,
         3.9505e+05, 1.6721e+00, 3.9822e+05, 1.9943e+00, 1.8005e+00],
        [1.4674e+00, 1.4172e+00, 3.8208e+05, 3.6414e+05, 1.5327e+00, 1.4551e+00,
         3.8667e+05, 4.0889e+05, 3.9279e+05, 1.8421e+00, 0.0000e+00, 3.9170e+05,
         3.9501e+05, 1.3090e+00, 3.9820e+05, 1.4719e+00, 1.3407e+00],
        [3.9173e+05, 3.9175e+05, 7.8361e+05, 7.4352e+05, 3.9169e+05, 3.9172e+05,
         7.6845e+05, 8.0370e+05, 8.0803e+05, 3.9173e+05, 3.9170e+05, 0.0000e+00,
         7.7349e+05, 3.9174e+05, 7.9782e+05, 3.9171e+05, 3.9175e+05],
        [3.9500e+05, 3.9501e+05, 7.6308e+05, 7.8713e+05, 3.9504e+05, 3.9504e+05,
         7.6296e+05, 8.0625e+05, 7.8939e+05, 3.9505e+05, 3.9501e+05, 7.7349e+05,
         0.0000e+00, 3.9502e+05, 7.8987e+05, 3.9500e+05, 3.9503e+05],
        [1.4036e+00, 1.3403e+00, 3.8207e+05, 3.6415e+05, 1.3172e+00, 1.3044e+00,
         3.8666e+05, 4.0891e+05, 3.9276e+05, 1.6721e+00, 1.3090e+00, 3.9174e+05,
         3.9502e+05, 0.0000e+00, 3.9820e+05, 1.4331e+00, 1.3712e+00],
        [3.9825e+05, 3.9819e+05, 7.7862e+05, 7.5790e+05, 3.9820e+05, 3.9819e+05,
         7.8100e+05, 8.0537e+05, 7.8167e+05, 3.9822e+05, 3.9820e+05, 7.9782e+05,
         7.8987e+05, 3.9820e+05, 0.0000e+00, 3.9818e+05, 3.9820e+05],
        [1.4853e+00, 1.3461e+00, 3.8210e+05, 3.6420e+05, 1.5739e+00, 1.4845e+00,
         3.8666e+05, 4.0890e+05, 3.9278e+05, 1.9943e+00, 1.4719e+00, 3.9171e+05,
         3.9500e+05, 1.4331e+00, 3.9818e+05, 0.0000e+00, 1.4353e+00],
        [1.4658e+00, 1.4448e+00, 3.8209e+05, 3.6416e+05, 1.5071e+00, 1.5259e+00,
         3.8660e+05, 4.0895e+05, 3.9277e+05, 1.8005e+00, 1.3407e+00, 3.9175e+05,
         3.9503e+05, 1.3712e+00, 3.9820e+05, 1.4353e+00, 0.0000e+00]])
Krum scores: ['1.48', '1.40', '382069.72', '364158.06', '1.42', '1.39', '386637.25', '408897.00', '392779.66', '1.66', '1.43', '391717.19', '395015.72', '1.35', '398192.75', '1.46', '1.44']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0075s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:36...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:36, End: 2025-07-22 15:31:36)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 3, 13, 11, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4399e+00, 1.4384e+00, 4.0667e+05, 3.7476e+05, 1.2682e+00,
         1.3709e+00, 3.7698e+05, 3.8014e+05, 1.4375e+00, 1.3768e+00, 3.7765e+05,
         1.2628e+00, 1.3708e+00, 4.1009e+05, 1.5316e+00],
        [1.4399e+00, 0.0000e+00, 1.3399e+00, 4.0668e+05, 3.7474e+05, 1.6642e+00,
         1.5490e+00, 3.7696e+05, 3.8011e+05, 1.3904e+00, 1.4473e+00, 3.7765e+05,
         1.5137e+00, 1.6521e+00, 4.1011e+05, 1.4231e+00],
        [1.4384e+00, 1.3399e+00, 0.0000e+00, 4.0670e+05, 3.7478e+05, 1.4919e+00,
         1.4701e+00, 3.7699e+05, 3.8012e+05, 1.3876e+00, 1.4085e+00, 3.7765e+05,
         1.5038e+00, 1.5804e+00, 4.1008e+05, 1.3462e+00],
        [4.0667e+05, 4.0668e+05, 4.0670e+05, 0.0000e+00, 7.9763e+05, 4.0667e+05,
         4.0667e+05, 7.7245e+05, 8.1164e+05, 4.0668e+05, 4.0669e+05, 7.7319e+05,
         4.0668e+05, 4.0664e+05, 7.8872e+05, 4.0670e+05],
        [3.7476e+05, 3.7474e+05, 3.7478e+05, 7.9763e+05, 0.0000e+00, 3.7477e+05,
         3.7479e+05, 7.6264e+05, 7.4881e+05, 3.7476e+05, 3.7477e+05, 7.5829e+05,
         3.7476e+05, 3.7475e+05, 7.8768e+05, 3.7477e+05],
        [1.2682e+00, 1.6642e+00, 1.4919e+00, 4.0667e+05, 3.7477e+05, 0.0000e+00,
         1.2146e+00, 3.7699e+05, 3.8012e+05, 1.5491e+00, 1.5145e+00, 3.7762e+05,
         1.1827e+00, 1.2291e+00, 4.1009e+05, 1.6301e+00],
        [1.3709e+00, 1.5490e+00, 1.4701e+00, 4.0667e+05, 3.7479e+05, 1.2146e+00,
         0.0000e+00, 3.7703e+05, 3.8014e+05, 1.4756e+00, 1.4409e+00, 3.7764e+05,
         1.2445e+00, 1.2959e+00, 4.1010e+05, 1.5247e+00],
        [3.7698e+05, 3.7696e+05, 3.7699e+05, 7.7245e+05, 7.6264e+05, 3.7699e+05,
         3.7703e+05, 0.0000e+00, 7.4820e+05, 3.7695e+05, 3.7698e+05, 7.5017e+05,
         3.7701e+05, 3.7697e+05, 7.9522e+05, 3.7697e+05],
        [3.8014e+05, 3.8011e+05, 3.8012e+05, 8.1164e+05, 7.4881e+05, 3.8012e+05,
         3.8014e+05, 7.4820e+05, 0.0000e+00, 3.8014e+05, 3.8009e+05, 7.5274e+05,
         3.8015e+05, 3.8013e+05, 7.9683e+05, 3.8012e+05],
        [1.4375e+00, 1.3904e+00, 1.3876e+00, 4.0668e+05, 3.7476e+05, 1.5491e+00,
         1.4756e+00, 3.7695e+05, 3.8014e+05, 0.0000e+00, 1.4505e+00, 3.7765e+05,
         1.4259e+00, 1.5208e+00, 4.1013e+05, 1.4169e+00],
        [1.3768e+00, 1.4473e+00, 1.4085e+00, 4.0669e+05, 3.7477e+05, 1.5145e+00,
         1.4409e+00, 3.7698e+05, 3.8009e+05, 1.4505e+00, 0.0000e+00, 3.7761e+05,
         1.5027e+00, 1.5475e+00, 4.1008e+05, 1.4275e+00],
        [3.7765e+05, 3.7765e+05, 3.7765e+05, 7.7319e+05, 7.5829e+05, 3.7762e+05,
         3.7764e+05, 7.5017e+05, 7.5274e+05, 3.7765e+05, 3.7761e+05, 0.0000e+00,
         3.7765e+05, 3.7765e+05, 7.8926e+05, 3.7765e+05],
        [1.2628e+00, 1.5137e+00, 1.5038e+00, 4.0668e+05, 3.7476e+05, 1.1827e+00,
         1.2445e+00, 3.7701e+05, 3.8015e+05, 1.4259e+00, 1.5027e+00, 3.7765e+05,
         0.0000e+00, 1.3215e+00, 4.1010e+05, 1.5985e+00],
        [1.3708e+00, 1.6521e+00, 1.5804e+00, 4.0664e+05, 3.7475e+05, 1.2291e+00,
         1.2959e+00, 3.7697e+05, 3.8013e+05, 1.5208e+00, 1.5475e+00, 3.7765e+05,
         1.3215e+00, 0.0000e+00, 4.1010e+05, 1.7975e+00],
        [4.1009e+05, 4.1011e+05, 4.1008e+05, 7.8872e+05, 7.8768e+05, 4.1009e+05,
         4.1010e+05, 7.9522e+05, 7.9683e+05, 4.1013e+05, 4.1008e+05, 7.8926e+05,
         4.1010e+05, 4.1010e+05, 0.0000e+00, 4.1012e+05],
        [1.5316e+00, 1.4231e+00, 1.3462e+00, 4.0670e+05, 3.7477e+05, 1.6301e+00,
         1.5247e+00, 3.7697e+05, 3.8012e+05, 1.4169e+00, 1.4275e+00, 3.7765e+05,
         1.5985e+00, 1.7975e+00, 4.1012e+05, 0.0000e+00]])
Krum scores: ['1.37', '1.47', '1.42', '406672.38', '374761.50', '1.39', '1.38', '376974.00', '380120.50', '1.44', '1.45', '377638.34', '1.37', '1.44', '410094.22', '1.49']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 3, 13, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:36...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:36, End: 2025-07-22 15:31:36)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 19, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 3.8821e+05, 1.3626e+00, 3.9705e+05, 3.8116e+05, 1.2885e+00,
         3.8248e+05, 1.2336e+00, 3.8714e+05, 3.9832e+05, 1.9280e+00, 1.3494e+00,
         3.6781e+05, 1.2832e+00, 1.2615e+00],
        [3.8821e+05, 0.0000e+00, 3.8823e+05, 8.0240e+05, 7.7973e+05, 3.8819e+05,
         7.7933e+05, 3.8822e+05, 7.7922e+05, 7.9802e+05, 3.8823e+05, 3.8819e+05,
         7.4833e+05, 3.8818e+05, 3.8819e+05],
        [1.3626e+00, 3.8823e+05, 0.0000e+00, 3.9710e+05, 3.8118e+05, 1.3027e+00,
         3.8249e+05, 1.2025e+00, 3.8713e+05, 3.9836e+05, 1.3481e+00, 1.0428e+00,
         3.6783e+05, 1.2947e+00, 1.3108e+00],
        [3.9705e+05, 8.0240e+05, 3.9710e+05, 0.0000e+00, 8.0690e+05, 3.9706e+05,
         7.7420e+05, 3.9707e+05, 7.7073e+05, 7.8274e+05, 3.9709e+05, 3.9707e+05,
         7.6882e+05, 3.9707e+05, 3.9707e+05],
        [3.8116e+05, 7.7973e+05, 3.8118e+05, 8.0690e+05, 0.0000e+00, 3.8118e+05,
         7.3907e+05, 3.8119e+05, 7.7692e+05, 7.7237e+05, 3.8119e+05, 3.8116e+05,
         7.5006e+05, 3.8119e+05, 3.8117e+05],
        [1.2885e+00, 3.8819e+05, 1.3027e+00, 3.9706e+05, 3.8118e+05, 0.0000e+00,
         3.8247e+05, 1.2401e+00, 3.8716e+05, 3.9838e+05, 1.7743e+00, 1.1978e+00,
         3.6784e+05, 1.2702e+00, 1.2206e+00],
        [3.8248e+05, 7.7933e+05, 3.8249e+05, 7.7420e+05, 7.3907e+05, 3.8247e+05,
         0.0000e+00, 3.8246e+05, 7.7186e+05, 7.8420e+05, 3.8253e+05, 3.8249e+05,
         7.3859e+05, 3.8249e+05, 3.8249e+05],
        [1.2336e+00, 3.8822e+05, 1.2025e+00, 3.9707e+05, 3.8119e+05, 1.2401e+00,
         3.8246e+05, 0.0000e+00, 3.8713e+05, 3.9835e+05, 1.7417e+00, 1.1634e+00,
         3.6783e+05, 1.2366e+00, 1.1232e+00],
        [3.8714e+05, 7.7922e+05, 3.8713e+05, 7.7073e+05, 7.7692e+05, 3.8716e+05,
         7.7186e+05, 3.8713e+05, 0.0000e+00, 7.7027e+05, 3.8710e+05, 3.8714e+05,
         7.6090e+05, 3.8713e+05, 3.8715e+05],
        [3.9832e+05, 7.9802e+05, 3.9836e+05, 7.8274e+05, 7.7237e+05, 3.9838e+05,
         7.8420e+05, 3.9835e+05, 7.7027e+05, 0.0000e+00, 3.9832e+05, 3.9832e+05,
         7.6353e+05, 3.9836e+05, 3.9834e+05],
        [1.9280e+00, 3.8823e+05, 1.3481e+00, 3.9709e+05, 3.8119e+05, 1.7743e+00,
         3.8253e+05, 1.7417e+00, 3.8710e+05, 3.9832e+05, 0.0000e+00, 1.2713e+00,
         3.6782e+05, 2.0120e+00, 1.7568e+00],
        [1.3494e+00, 3.8819e+05, 1.0428e+00, 3.9707e+05, 3.8116e+05, 1.1978e+00,
         3.8249e+05, 1.1634e+00, 3.8714e+05, 3.9832e+05, 1.2713e+00, 0.0000e+00,
         3.6782e+05, 1.4082e+00, 1.2715e+00],
        [3.6781e+05, 7.4833e+05, 3.6783e+05, 7.6882e+05, 7.5006e+05, 3.6784e+05,
         7.3859e+05, 3.6783e+05, 7.6090e+05, 7.6353e+05, 3.6782e+05, 3.6782e+05,
         0.0000e+00, 3.6782e+05, 3.6784e+05],
        [1.2832e+00, 3.8818e+05, 1.2947e+00, 3.9707e+05, 3.8119e+05, 1.2702e+00,
         3.8249e+05, 1.2366e+00, 3.8713e+05, 3.9836e+05, 2.0120e+00, 1.4082e+00,
         3.6782e+05, 0.0000e+00, 1.2890e+00],
        [1.2615e+00, 3.8819e+05, 1.3108e+00, 3.9707e+05, 3.8117e+05, 1.2206e+00,
         3.8249e+05, 1.1232e+00, 3.8715e+05, 3.9834e+05, 1.7568e+00, 1.2715e+00,
         3.6784e+05, 1.2890e+00, 0.0000e+00]])
Krum scores: ['1.30', '388198.12', '1.25', '397064.25', '381173.47', '1.25', '382479.28', '1.20', '387127.88', '398334.44', '1.64', '1.22', '367823.31', '1.30', '1.25']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [7, 19, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0071s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:37...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:37, End: 2025-07-22 15:31:37)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 1.2648e+00, 1.3743e+00, 3.9198e+05, 1.2117e+00, 3.9813e+05,
         3.8194e+05, 1.3616e+00, 3.9985e+05, 1.2198e+00, 1.3110e+00, 3.8669e+05,
         3.8410e+05, 1.3132e+00, 1.1955e+00, 3.8644e+05, 1.3876e+00],
        [1.2648e+00, 0.0000e+00, 1.2671e+00, 3.9196e+05, 1.4825e+00, 3.9812e+05,
         3.8190e+05, 1.3760e+00, 3.9986e+05, 1.4861e+00, 1.5514e+00, 3.8666e+05,
         3.8408e+05, 1.6529e+00, 1.3941e+00, 3.8642e+05, 1.3656e+00],
        [1.3743e+00, 1.2671e+00, 0.0000e+00, 3.9197e+05, 1.4023e+00, 3.9816e+05,
         3.8192e+05, 1.3250e+00, 3.9987e+05, 1.4816e+00, 1.5221e+00, 3.8668e+05,
         3.8408e+05, 1.6560e+00, 1.3545e+00, 3.8641e+05, 1.3415e+00],
        [3.9198e+05, 3.9196e+05, 3.9197e+05, 0.0000e+00, 3.9197e+05, 7.7780e+05,
         7.6687e+05, 3.9200e+05, 7.9176e+05, 3.9199e+05, 3.9201e+05, 8.0442e+05,
         7.8581e+05, 3.9197e+05, 3.9196e+05, 7.8596e+05, 3.9200e+05],
        [1.2117e+00, 1.4825e+00, 1.4023e+00, 3.9197e+05, 0.0000e+00, 3.9813e+05,
         3.8190e+05, 1.4449e+00, 3.9986e+05, 1.1986e+00, 1.2717e+00, 3.8665e+05,
         3.8406e+05, 1.1303e+00, 1.0993e+00, 3.8644e+05, 1.3929e+00],
        [3.9813e+05, 3.9812e+05, 3.9816e+05, 7.7780e+05, 3.9813e+05, 0.0000e+00,
         7.8561e+05, 3.9815e+05, 8.0380e+05, 3.9812e+05, 3.9815e+05, 7.9286e+05,
         7.7996e+05, 3.9815e+05, 3.9816e+05, 8.0185e+05, 3.9816e+05],
        [3.8194e+05, 3.8190e+05, 3.8192e+05, 7.6687e+05, 3.8190e+05, 7.8561e+05,
         0.0000e+00, 3.8191e+05, 7.8317e+05, 3.8189e+05, 3.8190e+05, 7.6060e+05,
         7.5469e+05, 3.8189e+05, 3.8190e+05, 7.5660e+05, 3.8192e+05],
        [1.3616e+00, 1.3760e+00, 1.3250e+00, 3.9200e+05, 1.4449e+00, 3.9815e+05,
         3.8191e+05, 0.0000e+00, 3.9985e+05, 1.4035e+00, 1.5337e+00, 3.8669e+05,
         3.8405e+05, 1.6014e+00, 1.2968e+00, 3.8644e+05, 1.3831e+00],
        [3.9985e+05, 3.9986e+05, 3.9987e+05, 7.9176e+05, 3.9986e+05, 8.0380e+05,
         7.8317e+05, 3.9985e+05, 0.0000e+00, 3.9986e+05, 3.9986e+05, 7.7553e+05,
         7.7147e+05, 3.9992e+05, 3.9988e+05, 7.7878e+05, 3.9983e+05],
        [1.2198e+00, 1.4861e+00, 1.4816e+00, 3.9199e+05, 1.1986e+00, 3.9812e+05,
         3.8189e+05, 1.4035e+00, 3.9986e+05, 0.0000e+00, 1.2900e+00, 3.8667e+05,
         3.8406e+05, 1.0490e+00, 1.1587e+00, 3.8643e+05, 1.4521e+00],
        [1.3110e+00, 1.5514e+00, 1.5221e+00, 3.9201e+05, 1.2717e+00, 3.9815e+05,
         3.8190e+05, 1.5337e+00, 3.9986e+05, 1.2900e+00, 0.0000e+00, 3.8667e+05,
         3.8407e+05, 1.2328e+00, 1.2048e+00, 3.8642e+05, 1.4283e+00],
        [3.8669e+05, 3.8666e+05, 3.8668e+05, 8.0442e+05, 3.8665e+05, 7.9286e+05,
         7.6060e+05, 3.8669e+05, 7.7553e+05, 3.8667e+05, 3.8667e+05, 0.0000e+00,
         7.6813e+05, 3.8666e+05, 3.8665e+05, 7.3720e+05, 3.8667e+05],
        [3.8410e+05, 3.8408e+05, 3.8408e+05, 7.8581e+05, 3.8406e+05, 7.7996e+05,
         7.5469e+05, 3.8405e+05, 7.7147e+05, 3.8406e+05, 3.8407e+05, 7.6813e+05,
         0.0000e+00, 3.8406e+05, 3.8406e+05, 7.5224e+05, 3.8410e+05],
        [1.3132e+00, 1.6529e+00, 1.6560e+00, 3.9197e+05, 1.1303e+00, 3.9815e+05,
         3.8189e+05, 1.6014e+00, 3.9992e+05, 1.0490e+00, 1.2328e+00, 3.8666e+05,
         3.8406e+05, 0.0000e+00, 1.1324e+00, 3.8643e+05, 1.6070e+00],
        [1.1955e+00, 1.3941e+00, 1.3545e+00, 3.9196e+05, 1.0993e+00, 3.9816e+05,
         3.8190e+05, 1.2968e+00, 3.9988e+05, 1.1587e+00, 1.2048e+00, 3.8665e+05,
         3.8406e+05, 1.1324e+00, 0.0000e+00, 3.8644e+05, 1.3952e+00],
        [3.8644e+05, 3.8642e+05, 3.8641e+05, 7.8596e+05, 3.8644e+05, 8.0185e+05,
         7.5660e+05, 3.8644e+05, 7.7878e+05, 3.8643e+05, 3.8642e+05, 7.3720e+05,
         7.5224e+05, 3.8643e+05, 3.8644e+05, 0.0000e+00, 3.8642e+05],
        [1.3876e+00, 1.3656e+00, 1.3415e+00, 3.9200e+05, 1.3929e+00, 3.9816e+05,
         3.8192e+05, 1.3831e+00, 3.9983e+05, 1.4521e+00, 1.4283e+00, 3.8667e+05,
         3.8410e+05, 1.6070e+00, 1.3952e+00, 3.8642e+05, 0.0000e+00]])
Krum scores: ['1.28', '1.40', '1.38', '391976.91', '1.27', '398140.12', '381900.56', '1.39', '399855.62', '1.28', '1.35', '386663.06', '384065.25', '1.34', '1.23', '386424.00', '1.39']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0128s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:38...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0023 seconds (Start: 2025-07-22 15:31:38, End: 2025-07-22 15:31:38)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1703e+00, 3.8727e+05, 3.7362e+05, 1.1634e+00, 3.8957e+05,
         3.8639e+05, 1.1618e+00, 3.8901e+05, 1.0730e+00, 1.0861e+00, 3.8996e+05,
         1.3410e+00, 3.9780e+05, 1.2510e+00, 1.1940e+00],
        [1.1703e+00, 0.0000e+00, 3.8726e+05, 3.7365e+05, 1.3224e+00, 3.8953e+05,
         3.8640e+05, 1.1897e+00, 3.8903e+05, 1.2961e+00, 1.3005e+00, 3.8994e+05,
         1.7085e+00, 3.9778e+05, 1.2115e+00, 1.2015e+00],
        [3.8727e+05, 3.8726e+05, 0.0000e+00, 7.7760e+05, 3.8727e+05, 7.8792e+05,
         7.7603e+05, 3.8727e+05, 7.8387e+05, 3.8728e+05, 3.8725e+05, 7.8206e+05,
         3.8727e+05, 7.5861e+05, 3.8726e+05, 3.8726e+05],
        [3.7362e+05, 3.7365e+05, 7.7760e+05, 0.0000e+00, 3.7363e+05, 7.6900e+05,
         7.6844e+05, 3.7362e+05, 7.5199e+05, 3.7360e+05, 3.7361e+05, 7.7076e+05,
         3.7361e+05, 7.5515e+05, 3.7362e+05, 3.7362e+05],
        [1.1634e+00, 1.3224e+00, 3.8727e+05, 3.7363e+05, 0.0000e+00, 3.8956e+05,
         3.8639e+05, 1.2277e+00, 3.8901e+05, 1.1087e+00, 1.0756e+00, 3.8994e+05,
         1.2046e+00, 3.9781e+05, 1.2645e+00, 1.2945e+00],
        [3.8957e+05, 3.8953e+05, 7.8792e+05, 7.6900e+05, 3.8956e+05, 0.0000e+00,
         7.8454e+05, 3.8955e+05, 7.9107e+05, 3.8956e+05, 3.8957e+05, 7.6654e+05,
         3.8957e+05, 7.8959e+05, 3.8956e+05, 3.8954e+05],
        [3.8639e+05, 3.8640e+05, 7.7603e+05, 7.6844e+05, 3.8639e+05, 7.8454e+05,
         0.0000e+00, 3.8643e+05, 7.8084e+05, 3.8640e+05, 3.8637e+05, 7.6694e+05,
         3.8640e+05, 7.9875e+05, 3.8640e+05, 3.8641e+05],
        [1.1618e+00, 1.1897e+00, 3.8727e+05, 3.7362e+05, 1.2277e+00, 3.8955e+05,
         3.8643e+05, 0.0000e+00, 3.8901e+05, 1.1856e+00, 1.2126e+00, 3.8996e+05,
         1.5659e+00, 3.9777e+05, 1.1951e+00, 1.1723e+00],
        [3.8901e+05, 3.8903e+05, 7.8387e+05, 7.5199e+05, 3.8901e+05, 7.9107e+05,
         7.8084e+05, 3.8901e+05, 0.0000e+00, 3.8902e+05, 3.8902e+05, 7.8965e+05,
         3.8901e+05, 7.8753e+05, 3.8904e+05, 3.8901e+05],
        [1.0730e+00, 1.2961e+00, 3.8728e+05, 3.7360e+05, 1.1087e+00, 3.8956e+05,
         3.8640e+05, 1.1856e+00, 3.8902e+05, 0.0000e+00, 1.0495e+00, 3.8999e+05,
         1.1546e+00, 3.9780e+05, 1.3729e+00, 1.2243e+00],
        [1.0861e+00, 1.3005e+00, 3.8725e+05, 3.7361e+05, 1.0756e+00, 3.8957e+05,
         3.8637e+05, 1.2126e+00, 3.8902e+05, 1.0495e+00, 0.0000e+00, 3.8995e+05,
         1.1515e+00, 3.9779e+05, 1.2906e+00, 1.1556e+00],
        [3.8996e+05, 3.8994e+05, 7.8206e+05, 7.7076e+05, 3.8994e+05, 7.6654e+05,
         7.6694e+05, 3.8996e+05, 7.8965e+05, 3.8999e+05, 3.8995e+05, 0.0000e+00,
         3.8996e+05, 8.0044e+05, 3.8996e+05, 3.9000e+05],
        [1.3410e+00, 1.7085e+00, 3.8727e+05, 3.7361e+05, 1.2046e+00, 3.8957e+05,
         3.8640e+05, 1.5659e+00, 3.8901e+05, 1.1546e+00, 1.1515e+00, 3.8996e+05,
         0.0000e+00, 3.9783e+05, 1.8136e+00, 1.6112e+00],
        [3.9780e+05, 3.9778e+05, 7.5861e+05, 7.5515e+05, 3.9781e+05, 7.8959e+05,
         7.9875e+05, 3.9777e+05, 7.8753e+05, 3.9780e+05, 3.9779e+05, 8.0044e+05,
         3.9783e+05, 0.0000e+00, 3.9777e+05, 3.9779e+05],
        [1.2510e+00, 1.2115e+00, 3.8726e+05, 3.7362e+05, 1.2645e+00, 3.8956e+05,
         3.8640e+05, 1.1951e+00, 3.8904e+05, 1.3729e+00, 1.2906e+00, 3.8996e+05,
         1.8136e+00, 3.9777e+05, 0.0000e+00, 1.2032e+00],
        [1.1940e+00, 1.2015e+00, 3.8726e+05, 3.7362e+05, 1.2945e+00, 3.8954e+05,
         3.8641e+05, 1.1723e+00, 3.8901e+05, 1.2243e+00, 1.1556e+00, 3.9000e+05,
         1.6112e+00, 3.9779e+05, 1.2032e+00, 0.0000e+00]])
Krum scores: ['1.16', '1.24', '387263.66', '373614.16', '1.19', '389551.03', '386392.97', '1.19', '389012.47', '1.16', '1.15', '389951.75', '1.39', '397786.84', '1.26', '1.21']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:38...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:38, End: 2025-07-22 15:31:38)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.2088e+00, 4.0430e+05, 1.0513e+00, 1.0917e+00, 4.0495e+05,
         1.1870e+00, 3.9033e+05, 1.0677e+00, 1.3522e+00, 3.8429e+05, 1.1191e+00,
         1.1468e+00, 1.1836e+00, 1.2104e+00],
        [1.2088e+00, 0.0000e+00, 4.0429e+05, 1.2341e+00, 1.1376e+00, 4.0500e+05,
         1.1692e+00, 3.9034e+05, 1.2566e+00, 1.6105e+00, 3.8428e+05, 1.3498e+00,
         1.4217e+00, 1.1745e+00, 1.1754e+00],
        [4.0430e+05, 4.0429e+05, 0.0000e+00, 4.0430e+05, 4.0429e+05, 8.1355e+05,
         4.0424e+05, 7.8056e+05, 4.0429e+05, 4.0433e+05, 7.9775e+05, 4.0427e+05,
         4.0430e+05, 4.0429e+05, 4.0428e+05],
        [1.0513e+00, 1.2341e+00, 4.0430e+05, 0.0000e+00, 9.9254e-01, 4.0494e+05,
         1.2355e+00, 3.9033e+05, 1.0015e+00, 1.1505e+00, 3.8427e+05, 9.4610e-01,
         9.7480e-01, 1.2893e+00, 1.1856e+00],
        [1.0917e+00, 1.1376e+00, 4.0429e+05, 9.9254e-01, 0.0000e+00, 4.0495e+05,
         1.1855e+00, 3.9031e+05, 1.0356e+00, 1.2142e+00, 3.8428e+05, 1.0239e+00,
         1.0127e+00, 1.1957e+00, 1.2565e+00],
        [4.0495e+05, 4.0500e+05, 8.1355e+05, 4.0494e+05, 4.0495e+05, 0.0000e+00,
         4.0498e+05, 7.8722e+05, 4.0499e+05, 4.0495e+05, 7.9166e+05, 4.0496e+05,
         4.0497e+05, 4.0498e+05, 4.0495e+05],
        [1.1870e+00, 1.1692e+00, 4.0424e+05, 1.2355e+00, 1.1855e+00, 4.0498e+05,
         0.0000e+00, 3.9033e+05, 1.1821e+00, 1.6099e+00, 3.8432e+05, 1.2958e+00,
         1.3529e+00, 1.2169e+00, 1.2045e+00],
        [3.9033e+05, 3.9034e+05, 7.8056e+05, 3.9033e+05, 3.9031e+05, 7.8722e+05,
         3.9033e+05, 0.0000e+00, 3.9031e+05, 3.9036e+05, 7.5494e+05, 3.9033e+05,
         3.9033e+05, 3.9033e+05, 3.9031e+05],
        [1.0677e+00, 1.2566e+00, 4.0429e+05, 1.0015e+00, 1.0356e+00, 4.0499e+05,
         1.1821e+00, 3.9031e+05, 0.0000e+00, 1.1438e+00, 3.8427e+05, 9.1676e-01,
         1.0287e+00, 1.3449e+00, 1.2005e+00],
        [1.3522e+00, 1.6105e+00, 4.0433e+05, 1.1505e+00, 1.2142e+00, 4.0495e+05,
         1.6099e+00, 3.9036e+05, 1.1438e+00, 0.0000e+00, 3.8426e+05, 1.0090e+00,
         9.4047e-01, 1.7309e+00, 1.5296e+00],
        [3.8429e+05, 3.8428e+05, 7.9775e+05, 3.8427e+05, 3.8428e+05, 7.9166e+05,
         3.8432e+05, 7.5494e+05, 3.8427e+05, 3.8426e+05, 0.0000e+00, 3.8428e+05,
         3.8429e+05, 3.8431e+05, 3.8429e+05],
        [1.1191e+00, 1.3498e+00, 4.0427e+05, 9.4610e-01, 1.0239e+00, 4.0496e+05,
         1.2958e+00, 3.9033e+05, 9.1676e-01, 1.0090e+00, 3.8428e+05, 0.0000e+00,
         8.6648e-01, 1.4638e+00, 1.3249e+00],
        [1.1468e+00, 1.4217e+00, 4.0430e+05, 9.7480e-01, 1.0127e+00, 4.0497e+05,
         1.3529e+00, 3.9033e+05, 1.0287e+00, 9.4047e-01, 3.8429e+05, 8.6648e-01,
         0.0000e+00, 1.5412e+00, 1.3802e+00],
        [1.1836e+00, 1.1745e+00, 4.0429e+05, 1.2893e+00, 1.1957e+00, 4.0498e+05,
         1.2169e+00, 3.9033e+05, 1.3449e+00, 1.7309e+00, 3.8431e+05, 1.4638e+00,
         1.5412e+00, 0.0000e+00, 1.2100e+00],
        [1.2104e+00, 1.1754e+00, 4.0428e+05, 1.1856e+00, 1.2565e+00, 4.0495e+05,
         1.2045e+00, 3.9031e+05, 1.2005e+00, 1.5296e+00, 3.8429e+05, 1.3249e+00,
         1.3802e+00, 1.2100e+00, 0.0000e+00]])
Krum scores: ['1.14', '1.24', '404283.00', '1.09', '1.10', '404959.19', '1.23', '390324.38', '1.09', '1.28', '384279.56', '1.09', '1.12', '1.29', '1.24']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0228s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:39...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:39, End: 2025-07-22 15:31:39)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 17, 1, 9, 20, 18, 8, 4, 3, 11, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.1796e+00, 3.9790e+05, 1.2868e+00, 1.0614e+00, 3.9117e+05,
         3.8648e+05, 1.1616e+00, 1.0278e+00, 1.0912e+00, 1.0864e+00, 4.0896e+05,
         1.1839e+00, 1.1659e+00],
        [1.1796e+00, 0.0000e+00, 3.9791e+05, 1.6628e+00, 1.1278e+00, 3.9116e+05,
         3.8647e+05, 1.1253e+00, 1.2142e+00, 1.3502e+00, 1.3270e+00, 4.0895e+05,
         1.1337e+00, 1.1628e+00],
        [3.9790e+05, 3.9791e+05, 0.0000e+00, 3.9794e+05, 3.9792e+05, 8.1594e+05,
         8.0624e+05, 3.9791e+05, 3.9793e+05, 3.9793e+05, 3.9793e+05, 8.0059e+05,
         3.9794e+05, 3.9791e+05],
        [1.2868e+00, 1.6628e+00, 3.9794e+05, 0.0000e+00, 1.1898e+00, 3.9117e+05,
         3.8644e+05, 1.6055e+00, 1.1662e+00, 9.1853e-01, 9.3060e-01, 4.0899e+05,
         1.6944e+00, 1.5984e+00],
        [1.0614e+00, 1.1278e+00, 3.9792e+05, 1.1898e+00, 0.0000e+00, 3.9119e+05,
         3.8646e+05, 1.1643e+00, 1.0243e+00, 1.0232e+00, 1.0390e+00, 4.0898e+05,
         1.1902e+00, 1.2109e+00],
        [3.9117e+05, 3.9116e+05, 8.1594e+05, 3.9117e+05, 3.9119e+05, 0.0000e+00,
         7.5983e+05, 3.9122e+05, 3.9118e+05, 3.9119e+05, 3.9117e+05, 7.9442e+05,
         3.9116e+05, 3.9116e+05],
        [3.8648e+05, 3.8647e+05, 8.0624e+05, 3.8644e+05, 3.8646e+05, 7.5983e+05,
         0.0000e+00, 3.8652e+05, 3.8649e+05, 3.8648e+05, 3.8647e+05, 8.1111e+05,
         3.8649e+05, 3.8646e+05],
        [1.1616e+00, 1.1253e+00, 3.9791e+05, 1.6055e+00, 1.1643e+00, 3.9122e+05,
         3.8652e+05, 0.0000e+00, 1.1450e+00, 1.3252e+00, 1.2844e+00, 4.0900e+05,
         1.1832e+00, 1.1391e+00],
        [1.0278e+00, 1.2142e+00, 3.9793e+05, 1.1662e+00, 1.0243e+00, 3.9118e+05,
         3.8649e+05, 1.1450e+00, 0.0000e+00, 9.9050e-01, 9.4420e-01, 4.0899e+05,
         1.2829e+00, 1.1963e+00],
        [1.0912e+00, 1.3502e+00, 3.9793e+05, 9.1853e-01, 1.0232e+00, 3.9119e+05,
         3.8648e+05, 1.3252e+00, 9.9050e-01, 0.0000e+00, 9.1396e-01, 4.0898e+05,
         1.4161e+00, 1.2800e+00],
        [1.0864e+00, 1.3270e+00, 3.9793e+05, 9.3060e-01, 1.0390e+00, 3.9117e+05,
         3.8647e+05, 1.2844e+00, 9.4420e-01, 9.1396e-01, 0.0000e+00, 4.0898e+05,
         1.4390e+00, 1.3070e+00],
        [4.0896e+05, 4.0895e+05, 8.0059e+05, 4.0899e+05, 4.0898e+05, 7.9442e+05,
         8.1111e+05, 4.0900e+05, 4.0899e+05, 4.0898e+05, 4.0898e+05, 0.0000e+00,
         4.0898e+05, 4.0897e+05],
        [1.1839e+00, 1.1337e+00, 3.9794e+05, 1.6944e+00, 1.1902e+00, 3.9116e+05,
         3.8649e+05, 1.1832e+00, 1.2829e+00, 1.4161e+00, 1.4390e+00, 4.0898e+05,
         0.0000e+00, 1.1617e+00],
        [1.1659e+00, 1.1628e+00, 3.9791e+05, 1.5984e+00, 1.2109e+00, 3.9116e+05,
         3.8646e+05, 1.1391e+00, 1.1963e+00, 1.2800e+00, 1.3070e+00, 4.0897e+05,
         1.1617e+00, 0.0000e+00]])
Krum scores: ['1.12', '1.20', '397918.19', '1.29', '1.10', '391170.69', '386467.09', '1.19', '1.09', '1.11', '1.10', '408972.81', '1.25', '1.20']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 17, 1, 9, 20, 18, 8, 4, 3, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:39...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:39, End: 2025-07-22 15:31:39)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [7, 2, 19, 17, 1, 20, 18, 8, 4, 13, 14, 11, 10, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.1287e+00, 3.8727e+05, 3.8911e+05, 1.5272e+00, 3.8931e+05,
         4.0269e+05, 1.2061e+00, 1.7232e+00, 3.8203e+05, 3.8392e+05, 1.3347e+00,
         1.3360e+00, 1.1694e+00],
        [1.1287e+00, 0.0000e+00, 3.8727e+05, 3.8912e+05, 1.4309e+00, 3.8929e+05,
         4.0269e+05, 1.1315e+00, 1.6423e+00, 3.8207e+05, 3.8390e+05, 1.3063e+00,
         1.2906e+00, 1.1320e+00],
        [3.8727e+05, 3.8727e+05, 0.0000e+00, 7.6468e+05, 3.8728e+05, 7.7784e+05,
         7.9329e+05, 3.8730e+05, 3.8729e+05, 7.9001e+05, 7.7227e+05, 3.8726e+05,
         3.8729e+05, 3.8727e+05],
        [3.8911e+05, 3.8912e+05, 7.6468e+05, 0.0000e+00, 3.8913e+05, 8.0175e+05,
         7.9820e+05, 3.8912e+05, 3.8915e+05, 7.8457e+05, 7.7451e+05, 3.8912e+05,
         3.8909e+05, 3.8911e+05],
        [1.5272e+00, 1.4309e+00, 3.8728e+05, 3.8913e+05, 0.0000e+00, 3.8929e+05,
         4.0267e+05, 1.3803e+00, 8.6530e-01, 3.8203e+05, 3.8393e+05, 8.1306e-01,
         7.8642e-01, 1.3673e+00],
        [3.8931e+05, 3.8929e+05, 7.7784e+05, 8.0175e+05, 3.8929e+05, 0.0000e+00,
         8.0248e+05, 3.8928e+05, 3.8931e+05, 7.9258e+05, 7.8746e+05, 3.8929e+05,
         3.8932e+05, 3.8930e+05],
        [4.0269e+05, 4.0269e+05, 7.9329e+05, 7.9820e+05, 4.0267e+05, 8.0248e+05,
         0.0000e+00, 4.0272e+05, 4.0269e+05, 7.9442e+05, 7.7998e+05, 4.0271e+05,
         4.0268e+05, 4.0266e+05],
        [1.2061e+00, 1.1315e+00, 3.8730e+05, 3.8912e+05, 1.3803e+00, 3.8928e+05,
         4.0272e+05, 0.0000e+00, 1.5241e+00, 3.8204e+05, 3.8387e+05, 1.2062e+00,
         1.2203e+00, 1.1436e+00],
        [1.7232e+00, 1.6423e+00, 3.8729e+05, 3.8915e+05, 8.6530e-01, 3.8931e+05,
         4.0269e+05, 1.5241e+00, 0.0000e+00, 3.8204e+05, 3.8394e+05, 9.5619e-01,
         9.6201e-01, 1.6106e+00],
        [3.8203e+05, 3.8207e+05, 7.9001e+05, 7.8457e+05, 3.8203e+05, 7.9258e+05,
         7.9442e+05, 3.8204e+05, 3.8204e+05, 0.0000e+00, 7.6003e+05, 3.8206e+05,
         3.8206e+05, 3.8204e+05],
        [3.8392e+05, 3.8390e+05, 7.7227e+05, 7.7451e+05, 3.8393e+05, 7.8746e+05,
         7.7998e+05, 3.8387e+05, 3.8394e+05, 7.6003e+05, 0.0000e+00, 3.8392e+05,
         3.8390e+05, 3.8388e+05],
        [1.3347e+00, 1.3063e+00, 3.8726e+05, 3.8912e+05, 8.1306e-01, 3.8929e+05,
         4.0271e+05, 1.2062e+00, 9.5619e-01, 3.8206e+05, 3.8392e+05, 0.0000e+00,
         8.6172e-01, 1.2623e+00],
        [1.3360e+00, 1.2906e+00, 3.8729e+05, 3.8909e+05, 7.8642e-01, 3.8932e+05,
         4.0268e+05, 1.2203e+00, 9.6201e-01, 3.8206e+05, 3.8390e+05, 8.6172e-01,
         0.0000e+00, 1.2611e+00],
        [1.1694e+00, 1.1320e+00, 3.8727e+05, 3.8911e+05, 1.3673e+00, 3.8930e+05,
         4.0266e+05, 1.1436e+00, 1.6106e+00, 3.8204e+05, 3.8388e+05, 1.2623e+00,
         1.2611e+00, 0.0000e+00]])
Krum scores: ['1.28', '1.24', '387276.31', '389110.09', '1.11', '389293.00', '402679.44', '1.21', '1.26', '382040.38', '383897.78', '1.07', '1.06', '1.22']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']], selected_client_indices: [7, 2, 19, 17, 1, 20, 18, 8, 4, 13, 14, 11, 10, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0052s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:40...
global Accuracy on shared test data: 73.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:40, End: 2025-07-22 15:31:40)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (10): [5, 7, 2, 20, 18, 8, 10, 16, 6, 12], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
tensor([[0.0000e+00, 1.0052e+00, 1.0633e+00, 4.0442e+05, 3.7961e+05, 1.0094e+00,
         1.2168e+00, 4.0550e+05, 1.0746e+00, 1.0415e+00],
        [1.0052e+00, 0.0000e+00, 1.0868e+00, 4.0443e+05, 3.7958e+05, 1.0801e+00,
         1.6469e+00, 4.0546e+05, 1.1291e+00, 1.0973e+00],
        [1.0633e+00, 1.0868e+00, 0.0000e+00, 4.0442e+05, 3.7959e+05, 1.0293e+00,
         1.5632e+00, 4.0549e+05, 1.0698e+00, 1.0741e+00],
        [4.0442e+05, 4.0443e+05, 4.0442e+05, 0.0000e+00, 7.6699e+05, 4.0440e+05,
         4.0442e+05, 8.2112e+05, 4.0439e+05, 4.0443e+05],
        [3.7961e+05, 3.7958e+05, 3.7959e+05, 7.6699e+05, 0.0000e+00, 3.7958e+05,
         3.7960e+05, 7.8783e+05, 3.7958e+05, 3.7956e+05],
        [1.0094e+00, 1.0801e+00, 1.0293e+00, 4.0440e+05, 3.7958e+05, 0.0000e+00,
         1.5193e+00, 4.0548e+05, 1.1009e+00, 1.0352e+00],
        [1.2168e+00, 1.6469e+00, 1.5632e+00, 4.0442e+05, 3.7960e+05, 1.5193e+00,
         0.0000e+00, 4.0548e+05, 1.7602e+00, 1.5853e+00],
        [4.0550e+05, 4.0546e+05, 4.0549e+05, 8.2112e+05, 7.8783e+05, 4.0548e+05,
         4.0548e+05, 0.0000e+00, 4.0550e+05, 4.0548e+05],
        [1.0746e+00, 1.1291e+00, 1.0698e+00, 4.0439e+05, 3.7958e+05, 1.1009e+00,
         1.7602e+00, 4.0550e+05, 0.0000e+00, 1.0769e+00],
        [1.0415e+00, 1.0973e+00, 1.0741e+00, 4.0443e+05, 3.7956e+05, 1.0352e+00,
         1.5853e+00, 4.0548e+05, 1.0769e+00, 0.0000e+00]])
Krum scores: ['1.04', '1.08', '1.06', '404408.72', '379579.19', '1.05', '1.51', '405479.41', '1.09', '1.06']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [5, 7, 2, 20, 18, 8, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0058s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:40...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:40, End: 2025-07-22 15:31:40)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [7, 2, 19, 9, 20, 8, 15, 4, 3, 13, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.1054e+00, 3.9139e+05, 1.1499e+00, 3.8665e+05, 1.1371e+00,
         3.8525e+05, 1.4357e+00, 1.2738e+00, 3.8540e+05, 1.5079e+00, 3.7264e+05,
         1.1403e+00, 1.1561e+00],
        [1.1054e+00, 0.0000e+00, 3.9143e+05, 1.0416e+00, 3.8666e+05, 1.0436e+00,
         3.8522e+05, 1.3704e+00, 1.1930e+00, 3.8539e+05, 1.3918e+00, 3.7265e+05,
         1.0740e+00, 1.1010e+00],
        [3.9139e+05, 3.9143e+05, 0.0000e+00, 3.9141e+05, 7.7668e+05, 3.9144e+05,
         8.0061e+05, 3.9145e+05, 3.9143e+05, 7.8287e+05, 3.9142e+05, 7.6779e+05,
         3.9142e+05, 3.9140e+05],
        [1.1499e+00, 1.0416e+00, 3.9141e+05, 0.0000e+00, 3.8665e+05, 1.0743e+00,
         3.8524e+05, 1.0407e+00, 9.1514e-01, 3.8539e+05, 1.0202e+00, 3.7264e+05,
         1.1472e+00, 1.1066e+00],
        [3.8665e+05, 3.8666e+05, 7.7668e+05, 3.8665e+05, 0.0000e+00, 3.8666e+05,
         7.7638e+05, 3.8662e+05, 3.8665e+05, 7.5592e+05, 3.8663e+05, 7.4589e+05,
         3.8664e+05, 3.8663e+05],
        [1.1371e+00, 1.0436e+00, 3.9144e+05, 1.0743e+00, 3.8666e+05, 0.0000e+00,
         3.8527e+05, 1.2859e+00, 1.1563e+00, 3.8538e+05, 1.3736e+00, 3.7262e+05,
         1.1215e+00, 1.1097e+00],
        [3.8525e+05, 3.8522e+05, 8.0061e+05, 3.8524e+05, 7.7638e+05, 3.8527e+05,
         0.0000e+00, 3.8526e+05, 3.8525e+05, 7.5326e+05, 3.8526e+05, 7.4711e+05,
         3.8522e+05, 3.8526e+05],
        [1.4357e+00, 1.3704e+00, 3.9145e+05, 1.0407e+00, 3.8662e+05, 1.2859e+00,
         3.8526e+05, 0.0000e+00, 8.6322e-01, 3.8540e+05, 6.9232e-01, 3.7264e+05,
         1.4472e+00, 1.3208e+00],
        [1.2738e+00, 1.1930e+00, 3.9143e+05, 9.1514e-01, 3.8665e+05, 1.1563e+00,
         3.8525e+05, 8.6322e-01, 0.0000e+00, 3.8540e+05, 7.5373e-01, 3.7265e+05,
         1.2627e+00, 1.1170e+00],
        [3.8540e+05, 3.8539e+05, 7.8287e+05, 3.8539e+05, 7.5592e+05, 3.8538e+05,
         7.5326e+05, 3.8540e+05, 3.8540e+05, 0.0000e+00, 3.8538e+05, 7.5338e+05,
         3.8540e+05, 3.8543e+05],
        [1.5079e+00, 1.3918e+00, 3.9142e+05, 1.0202e+00, 3.8663e+05, 1.3736e+00,
         3.8526e+05, 6.9232e-01, 7.5373e-01, 3.8538e+05, 0.0000e+00, 3.7265e+05,
         1.5496e+00, 1.4059e+00],
        [3.7264e+05, 3.7265e+05, 7.6779e+05, 3.7264e+05, 7.4589e+05, 3.7262e+05,
         7.4711e+05, 3.7264e+05, 3.7265e+05, 7.5338e+05, 3.7265e+05, 0.0000e+00,
         3.7264e+05, 3.7265e+05],
        [1.1403e+00, 1.0740e+00, 3.9142e+05, 1.1472e+00, 3.8664e+05, 1.1215e+00,
         3.8522e+05, 1.4472e+00, 1.2627e+00, 3.8540e+05, 1.5496e+00, 3.7264e+05,
         0.0000e+00, 1.1085e+00],
        [1.1561e+00, 1.1010e+00, 3.9140e+05, 1.1066e+00, 3.8663e+05, 1.1097e+00,
         3.8526e+05, 1.3208e+00, 1.1170e+00, 3.8543e+05, 1.4059e+00, 3.7265e+05,
         1.1085e+00, 0.0000e+00]])
Krum scores: ['1.20', '1.13', '391413.81', '1.05', '386637.84', '1.13', '385241.78', '1.14', '1.04', '385390.91', '1.16', '372639.72', '1.19', '1.15']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [7, 2, 19, 9, 20, 8, 15, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:41...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:41, End: 2025-07-22 15:31:41)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 17, 1, 9, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
tensor([[0.0000e+00, 1.1975e+00, 3.8701e+05, 7.4882e-01, 9.9724e-01, 1.1751e+00,
         3.9842e+05, 8.0191e-01, 9.3271e-01, 3.9868e+05, 8.3015e-01, 7.8156e-01,
         3.6072e+05, 1.2460e+00, 1.1852e+00],
        [1.1975e+00, 0.0000e+00, 3.8702e+05, 1.1814e+00, 1.0786e+00, 1.0485e+00,
         3.9842e+05, 1.2828e+00, 1.6262e+00, 3.9866e+05, 1.1966e+00, 1.3826e+00,
         3.6068e+05, 1.0818e+00, 1.0854e+00],
        [3.8701e+05, 3.8702e+05, 0.0000e+00, 3.8700e+05, 3.8700e+05, 3.8700e+05,
         7.8152e+05, 3.8701e+05, 3.8703e+05, 8.0669e+05, 3.8701e+05, 3.8700e+05,
         7.7596e+05, 3.8700e+05, 3.8701e+05],
        [7.4882e-01, 1.1814e+00, 3.8700e+05, 0.0000e+00, 9.2421e-01, 1.1758e+00,
         3.9841e+05, 7.5794e-01, 8.4788e-01, 3.9865e+05, 7.6517e-01, 6.7554e-01,
         3.6070e+05, 1.2556e+00, 1.1352e+00],
        [9.9724e-01, 1.0786e+00, 3.8700e+05, 9.2421e-01, 0.0000e+00, 1.0928e+00,
         3.9840e+05, 1.0349e+00, 1.2318e+00, 3.9868e+05, 9.6124e-01, 9.9950e-01,
         3.6070e+05, 1.1549e+00, 1.1454e+00],
        [1.1751e+00, 1.0485e+00, 3.8700e+05, 1.1758e+00, 1.0928e+00, 0.0000e+00,
         3.9839e+05, 1.2230e+00, 1.5920e+00, 3.9868e+05, 1.1531e+00, 1.3480e+00,
         3.6073e+05, 1.1305e+00, 1.1333e+00],
        [3.9842e+05, 3.9842e+05, 7.8152e+05, 3.9841e+05, 3.9840e+05, 3.9839e+05,
         0.0000e+00, 3.9843e+05, 3.9841e+05, 8.2481e+05, 3.9842e+05, 3.9841e+05,
         7.4745e+05, 3.9841e+05, 3.9837e+05],
        [8.0191e-01, 1.2828e+00, 3.8701e+05, 7.5794e-01, 1.0349e+00, 1.2230e+00,
         3.9843e+05, 0.0000e+00, 8.7774e-01, 3.9868e+05, 7.9140e-01, 7.4007e-01,
         3.6071e+05, 1.3960e+00, 1.2768e+00],
        [9.3271e-01, 1.6262e+00, 3.8703e+05, 8.4788e-01, 1.2318e+00, 1.5920e+00,
         3.9841e+05, 8.7774e-01, 0.0000e+00, 3.9866e+05, 9.9879e-01, 6.9589e-01,
         3.6072e+05, 1.7341e+00, 1.5500e+00],
        [3.9868e+05, 3.9866e+05, 8.0669e+05, 3.9865e+05, 3.9868e+05, 3.9868e+05,
         8.2481e+05, 3.9868e+05, 3.9866e+05, 0.0000e+00, 3.9866e+05, 3.9868e+05,
         7.4953e+05, 3.9867e+05, 3.9868e+05],
        [8.3015e-01, 1.1966e+00, 3.8701e+05, 7.6517e-01, 9.6124e-01, 1.1531e+00,
         3.9842e+05, 7.9140e-01, 9.9879e-01, 3.9866e+05, 0.0000e+00, 8.1311e-01,
         3.6072e+05, 1.3121e+00, 1.1849e+00],
        [7.8156e-01, 1.3826e+00, 3.8700e+05, 6.7554e-01, 9.9950e-01, 1.3480e+00,
         3.9841e+05, 7.4007e-01, 6.9589e-01, 3.9868e+05, 8.1311e-01, 0.0000e+00,
         3.6072e+05, 1.5279e+00, 1.3940e+00],
        [3.6072e+05, 3.6068e+05, 7.7596e+05, 3.6070e+05, 3.6070e+05, 3.6073e+05,
         7.4745e+05, 3.6071e+05, 3.6072e+05, 7.4953e+05, 3.6072e+05, 3.6072e+05,
         0.0000e+00, 3.6070e+05, 3.6069e+05],
        [1.2460e+00, 1.0818e+00, 3.8700e+05, 1.2556e+00, 1.1549e+00, 1.1305e+00,
         3.9841e+05, 1.3960e+00, 1.7341e+00, 3.9867e+05, 1.3121e+00, 1.5279e+00,
         3.6070e+05, 0.0000e+00, 1.0808e+00],
        [1.1852e+00, 1.0854e+00, 3.8701e+05, 1.1352e+00, 1.1454e+00, 1.1333e+00,
         3.9837e+05, 1.2768e+00, 1.5500e+00, 3.9868e+05, 1.1849e+00, 1.3940e+00,
         3.6069e+05, 1.0808e+00, 0.0000e+00]])
Krum scores: ['0.96', '1.17', '387004.72', '0.91', '1.04', '1.16', '398402.12', '0.98', '1.15', '398667.91', '0.97', '0.98', '360703.66', '1.24', '1.18']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 17, 1, 9, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0032s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:41...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:41, End: 2025-07-22 15:31:41)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 19, 17, 1, 9, 20, 15, 4, 3, 14, 16, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 1.1569e+00, 1.1134e+00, 3.9808e+05, 4.1632e+05, 8.5987e-01,
         9.3515e-01, 4.0277e+05, 3.9063e+05, 7.5300e-01, 7.2711e-01, 3.9383e+05,
         3.7313e+05, 1.1412e+00],
        [1.1569e+00, 0.0000e+00, 1.0537e+00, 3.9811e+05, 4.1630e+05, 1.6961e+00,
         1.1284e+00, 4.0276e+05, 3.9061e+05, 1.2852e+00, 1.3959e+00, 3.9386e+05,
         3.7310e+05, 1.1230e+00],
        [1.1134e+00, 1.0537e+00, 0.0000e+00, 3.9811e+05, 4.1630e+05, 1.5332e+00,
         1.0086e+00, 4.0277e+05, 3.9066e+05, 1.1640e+00, 1.2783e+00, 3.9388e+05,
         3.7311e+05, 1.0314e+00],
        [3.9808e+05, 3.9811e+05, 3.9811e+05, 0.0000e+00, 8.1982e+05, 3.9809e+05,
         3.9811e+05, 8.0754e+05, 7.9427e+05, 3.9806e+05, 3.9807e+05, 7.8070e+05,
         7.6251e+05, 3.9812e+05],
        [4.1632e+05, 4.1630e+05, 4.1630e+05, 8.1982e+05, 0.0000e+00, 4.1633e+05,
         4.1632e+05, 8.0575e+05, 8.0786e+05, 4.1633e+05, 4.1632e+05, 7.9980e+05,
         7.9036e+05, 4.1629e+05],
        [8.5987e-01, 1.6961e+00, 1.5332e+00, 3.9809e+05, 4.1633e+05, 0.0000e+00,
         1.1461e+00, 4.0275e+05, 3.9063e+05, 8.4107e-01, 6.3407e-01, 3.9384e+05,
         3.7312e+05, 1.4660e+00],
        [9.3515e-01, 1.1284e+00, 1.0086e+00, 3.9811e+05, 4.1632e+05, 1.1461e+00,
         0.0000e+00, 4.0276e+05, 3.9064e+05, 9.5605e-01, 9.4162e-01, 3.9389e+05,
         3.7309e+05, 1.0672e+00],
        [4.0277e+05, 4.0276e+05, 4.0277e+05, 8.0754e+05, 8.0575e+05, 4.0275e+05,
         4.0276e+05, 0.0000e+00, 7.7303e+05, 4.0274e+05, 4.0278e+05, 7.9747e+05,
         7.9507e+05, 4.0278e+05],
        [3.9063e+05, 3.9061e+05, 3.9066e+05, 7.9427e+05, 8.0786e+05, 3.9063e+05,
         3.9064e+05, 7.7303e+05, 0.0000e+00, 3.9064e+05, 3.9061e+05, 7.7451e+05,
         7.8469e+05, 3.9063e+05],
        [7.5300e-01, 1.2852e+00, 1.1640e+00, 3.9806e+05, 4.1633e+05, 8.4107e-01,
         9.5605e-01, 4.0274e+05, 3.9064e+05, 0.0000e+00, 7.1201e-01, 3.9384e+05,
         3.7311e+05, 1.1519e+00],
        [7.2711e-01, 1.3959e+00, 1.2783e+00, 3.9807e+05, 4.1632e+05, 6.3407e-01,
         9.4162e-01, 4.0278e+05, 3.9061e+05, 7.1201e-01, 0.0000e+00, 3.9385e+05,
         3.7312e+05, 1.2150e+00],
        [3.9383e+05, 3.9386e+05, 3.9388e+05, 7.8070e+05, 7.9980e+05, 3.9384e+05,
         3.9389e+05, 7.9747e+05, 7.7451e+05, 3.9384e+05, 3.9385e+05, 0.0000e+00,
         7.5209e+05, 3.9386e+05],
        [3.7313e+05, 3.7310e+05, 3.7311e+05, 7.6251e+05, 7.9036e+05, 3.7312e+05,
         3.7309e+05, 7.9507e+05, 7.8469e+05, 3.7311e+05, 3.7312e+05, 7.5209e+05,
         0.0000e+00, 3.7312e+05],
        [1.1412e+00, 1.1230e+00, 1.0314e+00, 3.9812e+05, 4.1629e+05, 1.4660e+00,
         1.0672e+00, 4.0278e+05, 3.9063e+05, 1.1519e+00, 1.2150e+00, 3.9386e+05,
         3.7312e+05, 0.0000e+00]])
Krum scores: ['0.92', '1.19', '1.11', '398087.22', '416306.62', '1.08', '1.01', '402759.03', '390625.22', '0.93', '0.92', '393846.94', '373106.09', '1.12']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 15, 4, 3, 14, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0278s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:42...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[187  50]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0024 seconds (Start: 2025-07-22 15:31:42, End: 2025-07-22 15:31:42)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 19, 9, 20, 18, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
tensor([[0.0000e+00, 3.8072e+05, 8.7293e-01, 3.9128e+05, 4.0806e+05, 3.9955e+05,
         8.7977e-01, 3.8556e+05, 3.8888e+05, 7.3127e-01, 7.2179e-01, 4.0410e+05,
         1.0720e+00, 1.0787e+00],
        [3.8072e+05, 0.0000e+00, 3.8071e+05, 7.5612e+05, 7.8814e+05, 7.8337e+05,
         3.8072e+05, 7.6426e+05, 7.5922e+05, 3.8072e+05, 3.8073e+05, 7.8611e+05,
         3.8072e+05, 3.8070e+05],
        [8.7293e-01, 3.8071e+05, 0.0000e+00, 3.9128e+05, 4.0806e+05, 3.9959e+05,
         1.1144e+00, 3.8558e+05, 3.8885e+05, 7.9841e-01, 8.3977e-01, 4.0410e+05,
         1.0323e+00, 1.0543e+00],
        [3.9128e+05, 7.5612e+05, 3.9128e+05, 0.0000e+00, 8.1039e+05, 7.7711e+05,
         3.9128e+05, 7.7382e+05, 7.6636e+05, 3.9126e+05, 3.9127e+05, 7.6338e+05,
         3.9129e+05, 3.9128e+05],
        [4.0806e+05, 7.8814e+05, 4.0806e+05, 8.1039e+05, 0.0000e+00, 8.2178e+05,
         4.0807e+05, 7.9119e+05, 7.7919e+05, 4.0807e+05, 4.0806e+05, 8.1745e+05,
         4.0804e+05, 4.0808e+05],
        [3.9955e+05, 7.8337e+05, 3.9959e+05, 7.7711e+05, 8.2178e+05, 0.0000e+00,
         3.9955e+05, 7.8130e+05, 7.9596e+05, 3.9955e+05, 3.9955e+05, 8.2146e+05,
         3.9957e+05, 3.9958e+05],
        [8.7977e-01, 3.8072e+05, 1.1144e+00, 3.9128e+05, 4.0807e+05, 3.9955e+05,
         0.0000e+00, 3.8556e+05, 3.8887e+05, 9.0275e-01, 5.9611e-01, 4.0410e+05,
         1.5589e+00, 1.4782e+00],
        [3.8556e+05, 7.6426e+05, 3.8558e+05, 7.7382e+05, 7.9119e+05, 7.8130e+05,
         3.8556e+05, 0.0000e+00, 7.9035e+05, 3.8554e+05, 3.8555e+05, 7.7271e+05,
         3.8558e+05, 3.8557e+05],
        [3.8888e+05, 7.5922e+05, 3.8885e+05, 7.6636e+05, 7.7919e+05, 7.9596e+05,
         3.8887e+05, 7.9035e+05, 0.0000e+00, 3.8887e+05, 3.8888e+05, 7.8901e+05,
         3.8889e+05, 3.8889e+05],
        [7.3127e-01, 3.8072e+05, 7.9841e-01, 3.9126e+05, 4.0807e+05, 3.9955e+05,
         9.0275e-01, 3.8554e+05, 3.8887e+05, 0.0000e+00, 6.9679e-01, 4.0409e+05,
         1.0462e+00, 9.9231e-01],
        [7.2179e-01, 3.8073e+05, 8.3977e-01, 3.9127e+05, 4.0806e+05, 3.9955e+05,
         5.9611e-01, 3.8555e+05, 3.8888e+05, 6.9679e-01, 0.0000e+00, 4.0409e+05,
         1.2349e+00, 1.1989e+00],
        [4.0410e+05, 7.8611e+05, 4.0410e+05, 7.6338e+05, 8.1745e+05, 8.2146e+05,
         4.0410e+05, 7.7271e+05, 7.8901e+05, 4.0409e+05, 4.0409e+05, 0.0000e+00,
         4.0409e+05, 4.0412e+05],
        [1.0720e+00, 3.8072e+05, 1.0323e+00, 3.9129e+05, 4.0804e+05, 3.9957e+05,
         1.5589e+00, 3.8558e+05, 3.8889e+05, 1.0462e+00, 1.2349e+00, 4.0409e+05,
         0.0000e+00, 9.9842e-01],
        [1.0787e+00, 3.8070e+05, 1.0543e+00, 3.9128e+05, 4.0808e+05, 3.9958e+05,
         1.4782e+00, 3.8557e+05, 3.8889e+05, 9.9231e-01, 1.1989e+00, 4.0412e+05,
         9.9842e-01, 0.0000e+00]])
Krum scores: ['0.86', '380712.41', '0.92', '391274.72', '408057.34', '399553.50', '0.99', '385556.22', '388870.12', '0.82', '0.81', '404094.69', '1.08', '1.06']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 19, 9, 20, 18, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:42...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:42, End: 2025-07-22 15:31:42)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 1, 9, 18, 8, 15, 4, 3, 13, 11, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.9176e-01, 9.9408e-01, 4.0203e+05, 5.9005e-01, 8.1460e-01,
         4.0932e+05, 9.8646e-01, 3.9435e+05, 6.8280e-01, 6.4812e-01, 3.8312e+05,
         7.2984e-01, 4.0299e+05, 1.0151e+00, 1.0264e+00],
        [9.9176e-01, 0.0000e+00, 1.0106e+00, 4.0206e+05, 1.1067e+00, 1.0187e+00,
         4.0930e+05, 1.0354e+00, 3.9434e+05, 1.0364e+00, 1.1969e+00, 3.8313e+05,
         1.0334e+00, 4.0296e+05, 1.0230e+00, 1.0817e+00],
        [9.9408e-01, 1.0106e+00, 0.0000e+00, 4.0204e+05, 1.0051e+00, 9.6960e-01,
         4.0927e+05, 9.4936e-01, 3.9436e+05, 9.8364e-01, 1.1392e+00, 3.8313e+05,
         9.8864e-01, 4.0294e+05, 9.7562e-01, 1.0165e+00],
        [4.0203e+05, 4.0206e+05, 4.0204e+05, 0.0000e+00, 4.0203e+05, 4.0205e+05,
         7.9729e+05, 4.0201e+05, 7.8550e+05, 4.0204e+05, 4.0203e+05, 7.7739e+05,
         4.0205e+05, 8.1980e+05, 4.0203e+05, 4.0206e+05],
        [5.9005e-01, 1.1067e+00, 1.0051e+00, 4.0203e+05, 0.0000e+00, 7.4809e-01,
         4.0930e+05, 1.0233e+00, 3.9435e+05, 5.6883e-01, 3.8102e-01, 3.8312e+05,
         5.9035e-01, 4.0293e+05, 1.0669e+00, 1.0122e+00],
        [8.1460e-01, 1.0187e+00, 9.6960e-01, 4.0205e+05, 7.4809e-01, 0.0000e+00,
         4.0932e+05, 9.5206e-01, 3.9437e+05, 8.0307e-01, 8.2445e-01, 3.8314e+05,
         7.9377e-01, 4.0297e+05, 1.0040e+00, 1.0053e+00],
        [4.0932e+05, 4.0930e+05, 4.0927e+05, 7.9729e+05, 4.0930e+05, 4.0932e+05,
         0.0000e+00, 4.0927e+05, 7.9060e+05, 4.0931e+05, 4.0931e+05, 8.0151e+05,
         4.0932e+05, 8.1031e+05, 4.0928e+05, 4.0929e+05],
        [9.8646e-01, 1.0354e+00, 9.4936e-01, 4.0201e+05, 1.0233e+00, 9.5206e-01,
         4.0927e+05, 0.0000e+00, 3.9434e+05, 9.4622e-01, 1.1430e+00, 3.8313e+05,
         9.4756e-01, 4.0293e+05, 9.9596e-01, 9.9533e-01],
        [3.9435e+05, 3.9434e+05, 3.9436e+05, 7.8550e+05, 3.9435e+05, 3.9437e+05,
         7.9060e+05, 3.9434e+05, 0.0000e+00, 3.9432e+05, 3.9432e+05, 7.6050e+05,
         3.9435e+05, 7.9937e+05, 3.9436e+05, 3.9433e+05],
        [6.8280e-01, 1.0364e+00, 9.8364e-01, 4.0204e+05, 5.6883e-01, 8.0307e-01,
         4.0931e+05, 9.4622e-01, 3.9432e+05, 0.0000e+00, 6.0361e-01, 3.8314e+05,
         6.7053e-01, 4.0297e+05, 1.0525e+00, 1.0374e+00],
        [6.4812e-01, 1.1969e+00, 1.1392e+00, 4.0203e+05, 3.8102e-01, 8.2445e-01,
         4.0931e+05, 1.1430e+00, 3.9432e+05, 6.0361e-01, 0.0000e+00, 3.8312e+05,
         6.9203e-01, 4.0295e+05, 1.2041e+00, 1.1613e+00],
        [3.8312e+05, 3.8313e+05, 3.8313e+05, 7.7739e+05, 3.8312e+05, 3.8314e+05,
         8.0151e+05, 3.8313e+05, 7.6050e+05, 3.8314e+05, 3.8312e+05, 0.0000e+00,
         3.8314e+05, 7.8335e+05, 3.8311e+05, 3.8313e+05],
        [7.2984e-01, 1.0334e+00, 9.8864e-01, 4.0205e+05, 5.9035e-01, 7.9377e-01,
         4.0932e+05, 9.4756e-01, 3.9435e+05, 6.7053e-01, 6.9203e-01, 3.8314e+05,
         0.0000e+00, 4.0295e+05, 1.0514e+00, 1.0043e+00],
        [4.0299e+05, 4.0296e+05, 4.0294e+05, 8.1980e+05, 4.0293e+05, 4.0297e+05,
         8.1031e+05, 4.0293e+05, 7.9937e+05, 4.0297e+05, 4.0295e+05, 7.8335e+05,
         4.0295e+05, 0.0000e+00, 4.0297e+05, 4.0295e+05],
        [1.0151e+00, 1.0230e+00, 9.7562e-01, 4.0203e+05, 1.0669e+00, 1.0040e+00,
         4.0928e+05, 9.9596e-01, 3.9436e+05, 1.0525e+00, 1.2041e+00, 3.8311e+05,
         1.0514e+00, 4.0297e+05, 0.0000e+00, 9.8985e-01],
        [1.0264e+00, 1.0817e+00, 1.0165e+00, 4.0206e+05, 1.0122e+00, 1.0053e+00,
         4.0929e+05, 9.9533e-01, 3.9433e+05, 1.0374e+00, 1.1613e+00, 3.8313e+05,
         1.0043e+00, 4.0295e+05, 9.8985e-01, 0.0000e+00]])
Krum scores: ['0.83', '1.04', '0.99', '402035.16', '0.78', '0.88', '409295.84', '0.98', '394340.28', '0.81', '0.87', '383126.09', '0.83', '402950.38', '1.02', '1.02']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 1, 9, 18, 8, 15, 4, 3, 13, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0038s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:43...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:43, End: 2025-07-22 15:31:43)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 7, 17, 1, 9, 20, 15, 3, 13, 14, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
tensor([[0.0000e+00, 9.7370e-01, 3.9471e+05, 7.4771e-01, 8.1120e-01, 3.9785e+05,
         3.9798e+05, 5.9464e-01, 3.7039e+05, 3.8989e+05, 6.0874e-01, 3.9321e+05,
         9.5010e-01],
        [9.7370e-01, 0.0000e+00, 3.9469e+05, 1.4441e+00, 1.0169e+00, 3.9783e+05,
         3.9797e+05, 1.1866e+00, 3.7040e+05, 3.8989e+05, 1.2422e+00, 3.9320e+05,
         9.8313e-01],
        [3.9471e+05, 3.9469e+05, 0.0000e+00, 3.9470e+05, 3.9468e+05, 7.7248e+05,
         8.0481e+05, 3.9468e+05, 7.5352e+05, 7.8311e+05, 3.9469e+05, 7.8612e+05,
         3.9471e+05],
        [7.4771e-01, 1.4441e+00, 3.9470e+05, 0.0000e+00, 9.8206e-01, 3.9783e+05,
         3.9798e+05, 4.1605e-01, 3.7041e+05, 3.8991e+05, 3.7422e-01, 3.9320e+05,
         1.2850e+00],
        [8.1120e-01, 1.0169e+00, 3.9468e+05, 9.8206e-01, 0.0000e+00, 3.9783e+05,
         3.9797e+05, 8.0053e-01, 3.7044e+05, 3.8988e+05, 8.3845e-01, 3.9319e+05,
         9.4789e-01],
        [3.9785e+05, 3.9783e+05, 7.7248e+05, 3.9783e+05, 3.9783e+05, 0.0000e+00,
         7.9050e+05, 3.9783e+05, 7.5981e+05, 7.8412e+05, 3.9784e+05, 7.9555e+05,
         3.9786e+05],
        [3.9798e+05, 3.9797e+05, 8.0481e+05, 3.9798e+05, 3.9797e+05, 7.9050e+05,
         0.0000e+00, 3.9798e+05, 7.5263e+05, 7.9706e+05, 3.9799e+05, 8.1041e+05,
         3.9797e+05],
        [5.9464e-01, 1.1866e+00, 3.9468e+05, 4.1605e-01, 8.0053e-01, 3.9783e+05,
         3.9798e+05, 0.0000e+00, 3.7040e+05, 3.8992e+05, 3.0009e-01, 3.9320e+05,
         1.0810e+00],
        [3.7039e+05, 3.7040e+05, 7.5352e+05, 3.7041e+05, 3.7044e+05, 7.5981e+05,
         7.5263e+05, 3.7040e+05, 0.0000e+00, 7.5303e+05, 3.7042e+05, 7.6222e+05,
         3.7038e+05],
        [3.8989e+05, 3.8989e+05, 7.8311e+05, 3.8991e+05, 3.8988e+05, 7.8412e+05,
         7.9706e+05, 3.8992e+05, 7.5303e+05, 0.0000e+00, 3.8992e+05, 7.6082e+05,
         3.8989e+05],
        [6.0874e-01, 1.2422e+00, 3.9469e+05, 3.7422e-01, 8.3845e-01, 3.9784e+05,
         3.9799e+05, 3.0009e-01, 3.7042e+05, 3.8992e+05, 0.0000e+00, 3.9319e+05,
         1.1666e+00],
        [3.9321e+05, 3.9320e+05, 7.8612e+05, 3.9320e+05, 3.9319e+05, 7.9555e+05,
         8.1041e+05, 3.9320e+05, 7.6222e+05, 7.6082e+05, 3.9319e+05, 0.0000e+00,
         3.9323e+05],
        [9.5010e-01, 9.8313e-01, 3.9471e+05, 1.2850e+00, 9.4789e-01, 3.9786e+05,
         3.9797e+05, 1.0810e+00, 3.7038e+05, 3.8989e+05, 1.1666e+00, 3.9323e+05,
         0.0000e+00]])
Krum scores: ['0.74', '1.08', '394691.38', '0.76', '0.88', '397831.22', '397973.06', '0.64', '370398.97', '389891.53', '0.66', '393195.97', '1.03']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 7, 17, 1, 9, 20, 15, 3, 13, 14, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0027s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:43...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0023 seconds (Start: 2025-07-22 15:31:43, End: 2025-07-22 15:31:43)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 17, 9, 20, 18, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.4460e-01, 9.0005e-01, 3.8450e+05, 3.8544e+05, 8.2342e-01,
         3.9372e+05, 3.8357e+05, 6.5978e-01, 7.7203e-01, 3.8368e+05, 3.9273e+05,
         5.9359e-01, 3.9617e+05, 9.5598e-01, 9.4339e-01],
        [9.4460e-01, 0.0000e+00, 9.5514e-01, 3.8450e+05, 3.8542e+05, 1.0187e+00,
         3.9374e+05, 3.8356e+05, 1.0232e+00, 1.3906e+00, 3.8369e+05, 3.9272e+05,
         1.1281e+00, 3.9615e+05, 9.8448e-01, 1.0211e+00],
        [9.0005e-01, 9.5514e-01, 0.0000e+00, 3.8448e+05, 3.8544e+05, 9.0827e-01,
         3.9372e+05, 3.8355e+05, 8.9900e-01, 1.2570e+00, 3.8370e+05, 3.9273e+05,
         9.8641e-01, 3.9613e+05, 8.9371e-01, 9.4638e-01],
        [3.8450e+05, 3.8450e+05, 3.8448e+05, 0.0000e+00, 7.8158e+05, 3.8450e+05,
         7.8089e+05, 7.7523e+05, 3.8450e+05, 3.8451e+05, 7.6160e+05, 7.9263e+05,
         3.8449e+05, 7.9084e+05, 3.8449e+05, 3.8449e+05],
        [3.8544e+05, 3.8542e+05, 3.8544e+05, 7.8158e+05, 0.0000e+00, 3.8543e+05,
         7.6376e+05, 7.4672e+05, 3.8543e+05, 3.8545e+05, 7.7655e+05, 7.7471e+05,
         3.8544e+05, 7.7740e+05, 3.8543e+05, 3.8543e+05],
        [8.2342e-01, 1.0187e+00, 9.0827e-01, 3.8450e+05, 3.8543e+05, 0.0000e+00,
         3.9372e+05, 3.8355e+05, 8.2392e-01, 1.0098e+00, 3.8369e+05, 3.9273e+05,
         7.9283e-01, 3.9618e+05, 9.6981e-01, 9.7546e-01],
        [3.9372e+05, 3.9374e+05, 3.9372e+05, 7.8089e+05, 7.6376e+05, 3.9372e+05,
         0.0000e+00, 7.7326e+05, 3.9373e+05, 3.9375e+05, 7.9451e+05, 7.8530e+05,
         3.9373e+05, 7.9366e+05, 3.9372e+05, 3.9371e+05],
        [3.8357e+05, 3.8356e+05, 3.8355e+05, 7.7523e+05, 7.4672e+05, 3.8355e+05,
         7.7326e+05, 0.0000e+00, 3.8354e+05, 3.8355e+05, 7.6151e+05, 7.9561e+05,
         3.8354e+05, 7.6435e+05, 3.8356e+05, 3.8355e+05],
        [6.5978e-01, 1.0232e+00, 8.9900e-01, 3.8450e+05, 3.8543e+05, 8.2392e-01,
         3.9373e+05, 3.8354e+05, 0.0000e+00, 7.4551e-01, 3.8369e+05, 3.9271e+05,
         5.8854e-01, 3.9614e+05, 9.9716e-01, 9.6932e-01],
        [7.7203e-01, 1.3906e+00, 1.2570e+00, 3.8451e+05, 3.8545e+05, 1.0098e+00,
         3.9375e+05, 3.8355e+05, 7.4551e-01, 0.0000e+00, 3.8369e+05, 3.9271e+05,
         3.2890e-01, 3.9614e+05, 1.3534e+00, 1.2664e+00],
        [3.8368e+05, 3.8369e+05, 3.8370e+05, 7.6160e+05, 7.7655e+05, 3.8369e+05,
         7.9451e+05, 7.6151e+05, 3.8369e+05, 3.8369e+05, 0.0000e+00, 7.7912e+05,
         3.8369e+05, 7.8739e+05, 3.8369e+05, 3.8368e+05],
        [3.9273e+05, 3.9272e+05, 3.9273e+05, 7.9263e+05, 7.7471e+05, 3.9273e+05,
         7.8530e+05, 7.9561e+05, 3.9271e+05, 3.9271e+05, 7.7912e+05, 0.0000e+00,
         3.9271e+05, 7.8014e+05, 3.9271e+05, 3.9274e+05],
        [5.9359e-01, 1.1281e+00, 9.8641e-01, 3.8449e+05, 3.8544e+05, 7.9283e-01,
         3.9373e+05, 3.8354e+05, 5.8854e-01, 3.2890e-01, 3.8369e+05, 3.9271e+05,
         0.0000e+00, 3.9615e+05, 1.1149e+00, 1.0652e+00],
        [3.9617e+05, 3.9615e+05, 3.9613e+05, 7.9084e+05, 7.7740e+05, 3.9618e+05,
         7.9366e+05, 7.6435e+05, 3.9614e+05, 3.9614e+05, 7.8739e+05, 7.8014e+05,
         3.9615e+05, 0.0000e+00, 3.9614e+05, 3.9613e+05],
        [9.5598e-01, 9.8448e-01, 8.9371e-01, 3.8449e+05, 3.8543e+05, 9.6981e-01,
         3.9372e+05, 3.8356e+05, 9.9716e-01, 1.3534e+00, 3.8369e+05, 3.9271e+05,
         1.1149e+00, 3.9614e+05, 0.0000e+00, 9.4018e-01],
        [9.4339e-01, 1.0211e+00, 9.4638e-01, 3.8449e+05, 3.8543e+05, 9.7546e-01,
         3.9371e+05, 3.8355e+05, 9.6932e-01, 1.2664e+00, 3.8368e+05, 3.9274e+05,
         1.0652e+00, 3.9613e+05, 9.4018e-01, 0.0000e+00]])
Krum scores: ['0.81', '1.01', '0.93', '384492.06', '385431.06', '0.90', '393722.00', '383549.34', '0.81', '0.96', '383685.94', '392717.53', '0.78', '396141.66', '0.98', '0.98']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 17, 9, 20, 18, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0155s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:44...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:44, End: 2025-07-22 15:31:44)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 9.4288e-01, 3.8499e+05, 3.8502e+05, 9.9368e-01, 9.5761e-01,
         4.0593e+05, 3.9420e+05, 9.8899e-01, 3.9653e+05, 9.4477e-01, 1.0856e+00,
         3.8449e+05, 3.9896e+05, 1.2254e+00, 3.7983e+05, 9.8361e-01, 1.0226e+00],
        [9.4288e-01, 0.0000e+00, 3.8498e+05, 3.8502e+05, 8.9452e-01, 8.9746e-01,
         4.0589e+05, 3.9420e+05, 9.1672e-01, 3.9653e+05, 9.0233e-01, 1.0145e+00,
         3.8451e+05, 3.9895e+05, 1.1410e+00, 3.7981e+05, 9.2448e-01, 9.7073e-01],
        [3.8499e+05, 3.8498e+05, 0.0000e+00, 7.7214e+05, 3.8501e+05, 3.8500e+05,
         7.8875e+05, 7.7545e+05, 3.8499e+05, 7.6120e+05, 3.8501e+05, 3.8501e+05,
         7.6937e+05, 7.7232e+05, 3.8502e+05, 7.5779e+05, 3.8498e+05, 3.8499e+05],
        [3.8502e+05, 3.8502e+05, 7.7214e+05, 0.0000e+00, 3.8498e+05, 3.8499e+05,
         8.1193e+05, 7.8940e+05, 3.8501e+05, 8.1818e+05, 3.8500e+05, 3.8497e+05,
         7.5906e+05, 7.8210e+05, 3.8498e+05, 7.8449e+05, 3.8502e+05, 3.8502e+05],
        [9.9368e-01, 8.9452e-01, 3.8501e+05, 3.8498e+05, 0.0000e+00, 7.2510e-01,
         4.0588e+05, 3.9419e+05, 9.0229e-01, 3.9654e+05, 4.9941e-01, 2.3002e-01,
         3.8451e+05, 3.9894e+05, 3.0087e-01, 3.7983e+05, 1.0003e+00, 9.2669e-01],
        [9.5761e-01, 8.9746e-01, 3.8500e+05, 3.8499e+05, 7.2510e-01, 0.0000e+00,
         4.0592e+05, 3.9420e+05, 9.0245e-01, 3.9654e+05, 7.9374e-01, 8.1913e-01,
         3.8452e+05, 3.9893e+05, 9.2812e-01, 3.7982e+05, 9.6090e-01, 9.7249e-01],
        [4.0593e+05, 4.0589e+05, 7.8875e+05, 8.1193e+05, 4.0588e+05, 4.0592e+05,
         0.0000e+00, 7.9924e+05, 4.0590e+05, 8.0845e+05, 4.0587e+05, 4.0590e+05,
         7.9724e+05, 8.1928e+05, 4.0590e+05, 8.0697e+05, 4.0592e+05, 4.0591e+05],
        [3.9420e+05, 3.9420e+05, 7.7545e+05, 7.8940e+05, 3.9419e+05, 3.9420e+05,
         7.9924e+05, 0.0000e+00, 3.9418e+05, 7.7862e+05, 3.9420e+05, 3.9419e+05,
         7.9497e+05, 7.8157e+05, 3.9416e+05, 7.6893e+05, 3.9417e+05, 3.9418e+05],
        [9.8899e-01, 9.1672e-01, 3.8499e+05, 3.8501e+05, 9.0229e-01, 9.0245e-01,
         4.0590e+05, 3.9418e+05, 0.0000e+00, 3.9653e+05, 8.6637e-01, 1.0026e+00,
         3.8452e+05, 3.9894e+05, 1.1358e+00, 3.7979e+05, 9.6501e-01, 9.6684e-01],
        [3.9653e+05, 3.9653e+05, 7.6120e+05, 8.1818e+05, 3.9654e+05, 3.9654e+05,
         8.0845e+05, 7.7862e+05, 3.9653e+05, 0.0000e+00, 3.9651e+05, 3.9653e+05,
         7.7107e+05, 7.9187e+05, 3.9652e+05, 7.8342e+05, 3.9654e+05, 3.9656e+05],
        [9.4477e-01, 9.0233e-01, 3.8501e+05, 3.8500e+05, 4.9941e-01, 7.9374e-01,
         4.0587e+05, 3.9420e+05, 8.6637e-01, 3.9651e+05, 0.0000e+00, 5.4245e-01,
         3.8450e+05, 3.9894e+05, 6.6014e-01, 3.7982e+05, 9.8793e-01, 9.7305e-01],
        [1.0856e+00, 1.0145e+00, 3.8501e+05, 3.8497e+05, 2.3002e-01, 8.1913e-01,
         4.0590e+05, 3.9419e+05, 1.0026e+00, 3.9653e+05, 5.4245e-01, 0.0000e+00,
         3.8452e+05, 3.9893e+05, 2.6927e-01, 3.7982e+05, 1.1375e+00, 1.0602e+00],
        [3.8449e+05, 3.8451e+05, 7.6937e+05, 7.5906e+05, 3.8451e+05, 3.8452e+05,
         7.9724e+05, 7.9497e+05, 3.8452e+05, 7.7107e+05, 3.8450e+05, 3.8452e+05,
         0.0000e+00, 7.8985e+05, 3.8452e+05, 7.6145e+05, 3.8450e+05, 3.8451e+05],
        [3.9896e+05, 3.9895e+05, 7.7232e+05, 7.8210e+05, 3.9894e+05, 3.9893e+05,
         8.1928e+05, 7.8157e+05, 3.9894e+05, 7.9187e+05, 3.9894e+05, 3.9893e+05,
         7.8985e+05, 0.0000e+00, 3.9893e+05, 7.8848e+05, 3.9897e+05, 3.9893e+05],
        [1.2254e+00, 1.1410e+00, 3.8502e+05, 3.8498e+05, 3.0087e-01, 9.2812e-01,
         4.0590e+05, 3.9416e+05, 1.1358e+00, 3.9652e+05, 6.6014e-01, 2.6927e-01,
         3.8452e+05, 3.9893e+05, 0.0000e+00, 3.7983e+05, 1.3049e+00, 1.2588e+00],
        [3.7983e+05, 3.7981e+05, 7.5779e+05, 7.8449e+05, 3.7983e+05, 3.7982e+05,
         8.0697e+05, 7.6893e+05, 3.7979e+05, 7.8342e+05, 3.7982e+05, 3.7982e+05,
         7.6145e+05, 7.8848e+05, 3.7983e+05, 0.0000e+00, 3.7984e+05, 3.7982e+05],
        [9.8361e-01, 9.2448e-01, 3.8498e+05, 3.8502e+05, 1.0003e+00, 9.6090e-01,
         4.0592e+05, 3.9417e+05, 9.6501e-01, 3.9654e+05, 9.8793e-01, 1.1375e+00,
         3.8450e+05, 3.9897e+05, 1.3049e+00, 3.7984e+05, 0.0000e+00, 9.4315e-01],
        [1.0226e+00, 9.7073e-01, 3.8499e+05, 3.8502e+05, 9.2669e-01, 9.7249e-01,
         4.0591e+05, 3.9418e+05, 9.6684e-01, 3.9656e+05, 9.7305e-01, 1.0602e+00,
         3.8451e+05, 3.9893e+05, 1.2588e+00, 3.7982e+05, 9.4315e-01, 0.0000e+00]])
Krum scores: ['0.99', '0.93', '384992.69', '384996.56', '0.68', '0.87', '405896.34', '394181.84', '0.94', '396529.81', '0.77', '0.75', '384506.44', '398935.91', '0.86', '379816.72', '0.99', '0.98']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:45...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:45, End: 2025-07-22 15:31:45)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
tensor([[0.0000e+00, 9.2368e-01, 9.3800e-01, 3.9676e+05, 3.9523e+05, 7.6808e-01,
         7.6674e-01, 3.8453e+05, 3.9197e+05, 8.9614e-01, 3.9531e+05, 6.4542e-01,
         5.7606e-01, 3.8643e+05, 6.7045e-01, 5.6821e-01, 3.9022e+05, 9.3752e-01],
        [9.2368e-01, 0.0000e+00, 9.5774e-01, 3.9673e+05, 3.9524e+05, 1.3244e+00,
         9.8535e-01, 3.8454e+05, 3.9198e+05, 1.0129e+00, 3.9530e+05, 9.6509e-01,
         1.1300e+00, 3.8640e+05, 9.7844e-01, 1.1447e+00, 3.9021e+05, 9.8015e-01],
        [9.3800e-01, 9.5774e-01, 0.0000e+00, 3.9674e+05, 3.9524e+05, 1.2603e+00,
         9.2112e-01, 3.8453e+05, 3.9198e+05, 9.4917e-01, 3.9532e+05, 9.3067e-01,
         1.0753e+00, 3.8643e+05, 9.2362e-01, 1.0463e+00, 3.9021e+05, 9.2834e-01],
        [3.9676e+05, 3.9673e+05, 3.9674e+05, 0.0000e+00, 7.8000e+05, 3.9673e+05,
         3.9674e+05, 7.8035e+05, 8.2080e+05, 3.9676e+05, 7.9425e+05, 3.9675e+05,
         3.9675e+05, 7.8351e+05, 3.9675e+05, 3.9675e+05, 8.1162e+05, 3.9677e+05],
        [3.9523e+05, 3.9524e+05, 3.9524e+05, 7.8000e+05, 0.0000e+00, 3.9523e+05,
         3.9522e+05, 7.8716e+05, 7.6879e+05, 3.9523e+05, 8.0015e+05, 3.9521e+05,
         3.9523e+05, 7.7049e+05, 3.9522e+05, 3.9522e+05, 7.9027e+05, 3.9522e+05],
        [7.6808e-01, 1.3244e+00, 1.2603e+00, 3.9673e+05, 3.9523e+05, 0.0000e+00,
         9.2170e-01, 3.8454e+05, 3.9200e+05, 1.2153e+00, 3.9531e+05, 7.5148e-01,
         3.8123e-01, 3.8643e+05, 7.6486e-01, 3.3663e-01, 3.9024e+05, 1.2213e+00],
        [7.6674e-01, 9.8535e-01, 9.2112e-01, 3.9674e+05, 3.9522e+05, 9.2170e-01,
         0.0000e+00, 3.8455e+05, 3.9201e+05, 9.1784e-01, 3.9533e+05, 7.7166e-01,
         7.4246e-01, 3.8643e+05, 7.5388e-01, 7.2983e-01, 3.9025e+05, 9.5523e-01],
        [3.8453e+05, 3.8454e+05, 3.8453e+05, 7.8035e+05, 7.8716e+05, 3.8454e+05,
         3.8455e+05, 0.0000e+00, 7.6597e+05, 3.8454e+05, 7.8350e+05, 3.8454e+05,
         3.8454e+05, 7.8262e+05, 3.8455e+05, 3.8456e+05, 7.5472e+05, 3.8453e+05],
        [3.9197e+05, 3.9198e+05, 3.9198e+05, 8.2080e+05, 7.6879e+05, 3.9200e+05,
         3.9201e+05, 7.6597e+05, 0.0000e+00, 3.9200e+05, 7.7795e+05, 3.9199e+05,
         3.9199e+05, 7.7814e+05, 3.9200e+05, 3.9200e+05, 8.0020e+05, 3.9200e+05],
        [8.9614e-01, 1.0129e+00, 9.4917e-01, 3.9676e+05, 3.9523e+05, 1.2153e+00,
         9.1784e-01, 3.8454e+05, 3.9200e+05, 0.0000e+00, 3.9536e+05, 8.8390e-01,
         1.0238e+00, 3.8640e+05, 8.7031e-01, 1.0169e+00, 3.9021e+05, 9.4963e-01],
        [3.9531e+05, 3.9530e+05, 3.9532e+05, 7.9425e+05, 8.0015e+05, 3.9531e+05,
         3.9533e+05, 7.8350e+05, 7.7795e+05, 3.9536e+05, 0.0000e+00, 3.9530e+05,
         3.9529e+05, 7.6637e+05, 3.9531e+05, 3.9530e+05, 8.2057e+05, 3.9532e+05],
        [6.4542e-01, 9.6509e-01, 9.3067e-01, 3.9675e+05, 3.9521e+05, 7.5148e-01,
         7.7166e-01, 3.8454e+05, 3.9199e+05, 8.8390e-01, 3.9530e+05, 0.0000e+00,
         5.7654e-01, 3.8645e+05, 6.4162e-01, 5.7089e-01, 3.9023e+05, 9.4481e-01],
        [5.7606e-01, 1.1300e+00, 1.0753e+00, 3.9675e+05, 3.9523e+05, 3.8123e-01,
         7.4246e-01, 3.8454e+05, 3.9199e+05, 1.0238e+00, 3.9529e+05, 5.7654e-01,
         0.0000e+00, 3.8643e+05, 6.1709e-01, 1.8550e-01, 3.9024e+05, 1.0779e+00],
        [3.8643e+05, 3.8640e+05, 3.8643e+05, 7.8351e+05, 7.7049e+05, 3.8643e+05,
         3.8643e+05, 7.8262e+05, 7.7814e+05, 3.8640e+05, 7.6637e+05, 3.8645e+05,
         3.8643e+05, 0.0000e+00, 3.8643e+05, 3.8642e+05, 7.6606e+05, 3.8641e+05],
        [6.7045e-01, 9.7844e-01, 9.2362e-01, 3.9675e+05, 3.9522e+05, 7.6486e-01,
         7.5388e-01, 3.8455e+05, 3.9200e+05, 8.7031e-01, 3.9531e+05, 6.4162e-01,
         6.1709e-01, 3.8643e+05, 0.0000e+00, 5.9173e-01, 3.9023e+05, 9.5331e-01],
        [5.6821e-01, 1.1447e+00, 1.0463e+00, 3.9675e+05, 3.9522e+05, 3.3663e-01,
         7.2983e-01, 3.8456e+05, 3.9200e+05, 1.0169e+00, 3.9530e+05, 5.7089e-01,
         1.8550e-01, 3.8642e+05, 5.9173e-01, 0.0000e+00, 3.9022e+05, 1.0880e+00],
        [3.9022e+05, 3.9021e+05, 3.9021e+05, 8.1162e+05, 7.9027e+05, 3.9024e+05,
         3.9025e+05, 7.5472e+05, 8.0020e+05, 3.9021e+05, 8.2057e+05, 3.9023e+05,
         3.9024e+05, 7.6606e+05, 3.9023e+05, 3.9022e+05, 0.0000e+00, 3.9020e+05],
        [9.3752e-01, 9.8015e-01, 9.2834e-01, 3.9677e+05, 3.9522e+05, 1.2213e+00,
         9.5523e-01, 3.8453e+05, 3.9200e+05, 9.4963e-01, 3.9532e+05, 9.4481e-01,
         1.0779e+00, 3.8641e+05, 9.5331e-01, 1.0880e+00, 3.9020e+05, 0.0000e+00]])
Krum scores: ['0.75', '1.01', '0.96', '396743.41', '395222.91', '0.85', '0.83', '384539.16', '391989.59', '0.95', '395308.38', '0.75', '0.70', '386419.09', '0.75', '0.68', '390219.31', '0.98']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:45...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:45, End: 2025-07-22 15:31:45)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [7, 2, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.3491e-01, 3.7920e+05, 1.0847e+00, 9.5103e-01, 3.8435e+05,
         3.9582e+05, 9.8983e-01, 3.9453e+05, 9.1694e-01, 4.0348e+05, 3.8146e+05,
         9.7234e-01, 1.1699e+00, 3.8676e+05, 9.9497e-01],
        [9.3491e-01, 0.0000e+00, 3.7919e+05, 9.8589e-01, 8.9377e-01, 3.8436e+05,
         3.9583e+05, 9.2438e-01, 3.9454e+05, 8.8138e-01, 4.0348e+05, 3.8143e+05,
         9.0316e-01, 1.0824e+00, 3.8675e+05, 9.4566e-01],
        [3.7920e+05, 3.7919e+05, 0.0000e+00, 3.7917e+05, 3.7920e+05, 7.5745e+05,
         7.9585e+05, 3.7919e+05, 7.8362e+05, 3.7918e+05, 7.6057e+05, 7.5726e+05,
         3.7919e+05, 3.7918e+05, 7.4611e+05, 3.7922e+05],
        [1.0847e+00, 9.8589e-01, 3.7917e+05, 0.0000e+00, 7.8572e-01, 3.8438e+05,
         3.9585e+05, 1.0217e+00, 3.9452e+05, 5.4210e-01, 4.0348e+05, 3.8142e+05,
         5.7379e-01, 3.0727e-01, 3.8675e+05, 9.9587e-01],
        [9.5103e-01, 8.9377e-01, 3.7920e+05, 7.8572e-01, 0.0000e+00, 3.8438e+05,
         3.9584e+05, 9.1426e-01, 3.9453e+05, 7.7854e-01, 4.0348e+05, 3.8143e+05,
         7.8081e-01, 8.9255e-01, 3.8677e+05, 9.3596e-01],
        [3.8435e+05, 3.8436e+05, 7.5745e+05, 3.8438e+05, 3.8438e+05, 0.0000e+00,
         7.7230e+05, 3.8438e+05, 7.6725e+05, 3.8435e+05, 8.0158e+05, 7.5129e+05,
         3.8439e+05, 3.8436e+05, 7.7957e+05, 3.8438e+05],
        [3.9582e+05, 3.9583e+05, 7.9585e+05, 3.9585e+05, 3.9584e+05, 7.7230e+05,
         0.0000e+00, 3.9585e+05, 7.6865e+05, 3.9584e+05, 8.0283e+05, 7.6790e+05,
         3.9584e+05, 3.9584e+05, 7.9104e+05, 3.9582e+05],
        [9.8983e-01, 9.2438e-01, 3.7919e+05, 1.0217e+00, 9.1426e-01, 3.8438e+05,
         3.9585e+05, 0.0000e+00, 3.9454e+05, 8.6417e-01, 4.0348e+05, 3.8143e+05,
         8.9724e-01, 1.1010e+00, 3.8675e+05, 9.4034e-01],
        [3.9453e+05, 3.9454e+05, 7.8362e+05, 3.9452e+05, 3.9453e+05, 7.6725e+05,
         7.6865e+05, 3.9454e+05, 0.0000e+00, 3.9450e+05, 8.0163e+05, 7.9997e+05,
         3.9454e+05, 3.9452e+05, 7.9585e+05, 3.9453e+05],
        [9.1694e-01, 8.8138e-01, 3.7918e+05, 5.4210e-01, 7.7854e-01, 3.8435e+05,
         3.9584e+05, 8.6417e-01, 3.9450e+05, 0.0000e+00, 4.0348e+05, 3.8143e+05,
         6.1860e-01, 6.2771e-01, 3.8676e+05, 9.1097e-01],
        [4.0348e+05, 4.0348e+05, 7.6057e+05, 4.0348e+05, 4.0348e+05, 8.0158e+05,
         8.0283e+05, 4.0348e+05, 8.0163e+05, 4.0348e+05, 0.0000e+00, 8.0305e+05,
         4.0347e+05, 4.0347e+05, 7.9163e+05, 4.0347e+05],
        [3.8146e+05, 3.8143e+05, 7.5726e+05, 3.8142e+05, 3.8143e+05, 7.5129e+05,
         7.6790e+05, 3.8143e+05, 7.9997e+05, 3.8143e+05, 8.0305e+05, 0.0000e+00,
         3.8144e+05, 3.8142e+05, 7.5874e+05, 3.8144e+05],
        [9.7234e-01, 9.0316e-01, 3.7919e+05, 5.7379e-01, 7.8081e-01, 3.8439e+05,
         3.9584e+05, 8.9724e-01, 3.9454e+05, 6.1860e-01, 4.0347e+05, 3.8144e+05,
         0.0000e+00, 6.9644e-01, 3.8678e+05, 9.2373e-01],
        [1.1699e+00, 1.0824e+00, 3.7918e+05, 3.0727e-01, 8.9255e-01, 3.8436e+05,
         3.9584e+05, 1.1010e+00, 3.9452e+05, 6.2771e-01, 4.0347e+05, 3.8142e+05,
         6.9644e-01, 0.0000e+00, 3.8676e+05, 1.1615e+00],
        [3.8676e+05, 3.8675e+05, 7.4611e+05, 3.8675e+05, 3.8677e+05, 7.7957e+05,
         7.9104e+05, 3.8675e+05, 7.9585e+05, 3.8676e+05, 7.9163e+05, 7.5874e+05,
         3.8678e+05, 3.8676e+05, 0.0000e+00, 3.8677e+05],
        [9.9497e-01, 9.4566e-01, 3.7922e+05, 9.9587e-01, 9.3596e-01, 3.8438e+05,
         3.9582e+05, 9.4034e-01, 3.9453e+05, 9.1097e-01, 4.0347e+05, 3.8144e+05,
         9.2373e-01, 1.1615e+00, 3.8677e+05, 0.0000e+00]])
Krum scores: ['0.98', '0.92', '379185.22', '0.74', '0.85', '384364.56', '395832.91', '0.94', '394523.94', '0.75', '403472.84', '381429.78', '0.77', '0.84', '386757.34', '0.95']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 2, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:46...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:46, End: 2025-07-22 15:31:46)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 9, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
tensor([[0.0000e+00, 8.5762e-01, 9.0535e-01, 3.9543e+05, 3.8590e+05, 7.2345e-01,
         8.4514e-01, 3.8790e+05, 6.1420e-01, 5.0089e-01, 3.9654e+05, 3.9024e+05,
         6.2760e-01, 5.1980e-01, 3.9571e+05, 9.0384e-01, 9.0341e-01],
        [8.5762e-01, 0.0000e+00, 9.3227e-01, 3.9545e+05, 3.8593e+05, 9.4591e-01,
         9.7942e-01, 3.8788e+05, 9.1885e-01, 9.9395e-01, 3.9655e+05, 3.9025e+05,
         9.4623e-01, 1.0454e+00, 3.9571e+05, 9.8401e-01, 9.8815e-01],
        [9.0535e-01, 9.3227e-01, 0.0000e+00, 3.9544e+05, 3.8595e+05, 8.9420e-01,
         9.0348e-01, 3.8791e+05, 9.1613e-01, 9.5337e-01, 3.9656e+05, 3.9025e+05,
         9.0522e-01, 9.8474e-01, 3.9572e+05, 9.1925e-01, 9.1354e-01],
        [3.9543e+05, 3.9545e+05, 3.9544e+05, 0.0000e+00, 7.5631e+05, 3.9543e+05,
         3.9544e+05, 7.9553e+05, 3.9544e+05, 3.9542e+05, 7.9077e+05, 7.9022e+05,
         3.9543e+05, 3.9543e+05, 7.8838e+05, 3.9546e+05, 3.9546e+05],
        [3.8590e+05, 3.8593e+05, 3.8595e+05, 7.5631e+05, 0.0000e+00, 3.8591e+05,
         3.8594e+05, 7.5846e+05, 3.8594e+05, 3.8590e+05, 8.0247e+05, 7.9170e+05,
         3.8591e+05, 3.8590e+05, 7.9684e+05, 3.8594e+05, 3.8595e+05],
        [7.2345e-01, 9.4591e-01, 8.9420e-01, 3.9543e+05, 3.8591e+05, 0.0000e+00,
         8.8676e-01, 3.8790e+05, 7.5706e-01, 6.8410e-01, 3.9656e+05, 3.9023e+05,
         7.2404e-01, 7.1255e-01, 3.9572e+05, 9.3995e-01, 9.0913e-01],
        [8.4514e-01, 9.7942e-01, 9.0348e-01, 3.9544e+05, 3.8594e+05, 8.8676e-01,
         0.0000e+00, 3.8789e+05, 8.4880e-01, 9.2103e-01, 3.9653e+05, 3.9027e+05,
         8.4209e-01, 9.7278e-01, 3.9572e+05, 9.4444e-01, 9.0755e-01],
        [3.8790e+05, 3.8788e+05, 3.8791e+05, 7.9553e+05, 7.5846e+05, 3.8790e+05,
         3.8789e+05, 0.0000e+00, 3.8793e+05, 3.8792e+05, 8.0543e+05, 7.6216e+05,
         3.8789e+05, 3.8792e+05, 7.7250e+05, 3.8789e+05, 3.8791e+05],
        [6.1420e-01, 9.1885e-01, 9.1613e-01, 3.9544e+05, 3.8594e+05, 7.5706e-01,
         8.4880e-01, 3.8793e+05, 0.0000e+00, 5.1311e-01, 3.9654e+05, 3.9025e+05,
         6.0572e-01, 5.2850e-01, 3.9573e+05, 9.1964e-01, 8.8372e-01],
        [5.0089e-01, 9.9395e-01, 9.5337e-01, 3.9542e+05, 3.8590e+05, 6.8410e-01,
         9.2103e-01, 3.8792e+05, 5.1311e-01, 0.0000e+00, 3.9656e+05, 3.9023e+05,
         5.2973e-01, 1.8238e-01, 3.9573e+05, 9.8113e-01, 9.1632e-01],
        [3.9654e+05, 3.9655e+05, 3.9656e+05, 7.9077e+05, 8.0247e+05, 3.9656e+05,
         3.9653e+05, 8.0543e+05, 3.9654e+05, 3.9656e+05, 0.0000e+00, 7.9102e+05,
         3.9655e+05, 3.9656e+05, 7.9704e+05, 3.9656e+05, 3.9653e+05],
        [3.9024e+05, 3.9025e+05, 3.9025e+05, 7.9022e+05, 7.9170e+05, 3.9023e+05,
         3.9027e+05, 7.6216e+05, 3.9025e+05, 3.9023e+05, 7.9102e+05, 0.0000e+00,
         3.9024e+05, 3.9023e+05, 7.9916e+05, 3.9024e+05, 3.9024e+05],
        [6.2760e-01, 9.4623e-01, 9.0522e-01, 3.9543e+05, 3.8591e+05, 7.2404e-01,
         8.4209e-01, 3.8789e+05, 6.0572e-01, 5.2973e-01, 3.9655e+05, 3.9024e+05,
         0.0000e+00, 5.1936e-01, 3.9571e+05, 9.4342e-01, 8.7955e-01],
        [5.1980e-01, 1.0454e+00, 9.8474e-01, 3.9543e+05, 3.8590e+05, 7.1255e-01,
         9.7278e-01, 3.8792e+05, 5.2850e-01, 1.8238e-01, 3.9656e+05, 3.9023e+05,
         5.1936e-01, 0.0000e+00, 3.9571e+05, 1.0300e+00, 9.7760e-01],
        [3.9571e+05, 3.9571e+05, 3.9572e+05, 7.8838e+05, 7.9684e+05, 3.9572e+05,
         3.9572e+05, 7.7250e+05, 3.9573e+05, 3.9573e+05, 7.9704e+05, 7.9916e+05,
         3.9571e+05, 3.9571e+05, 0.0000e+00, 3.9572e+05, 3.9572e+05],
        [9.0384e-01, 9.8401e-01, 9.1925e-01, 3.9546e+05, 3.8594e+05, 9.3995e-01,
         9.4444e-01, 3.8789e+05, 9.1964e-01, 9.8113e-01, 3.9656e+05, 3.9024e+05,
         9.4342e-01, 1.0300e+00, 3.9572e+05, 0.0000e+00, 9.2259e-01],
        [9.0341e-01, 9.8815e-01, 9.1354e-01, 3.9546e+05, 3.8595e+05, 9.0913e-01,
         9.0755e-01, 3.8791e+05, 8.8372e-01, 9.1632e-01, 3.9653e+05, 3.9024e+05,
         8.7955e-01, 9.7760e-01, 3.9572e+05, 9.2259e-01, 0.0000e+00]])
Krum scores: ['0.72', '0.95', '0.92', '395435.38', '385918.94', '0.80', '0.90', '387898.59', '0.73', '0.69', '396547.06', '390238.84', '0.73', '0.71', '395713.88', '0.94', '0.91']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 9, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:47...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:47, End: 2025-07-22 15:31:47)
start time is: 97271811384823, end time is: 97288885785432
The total time is: 17074400609ns.

 ------- aggregate method: mean, random_seed: 0 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0009s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:47...
global Accuracy on shared test data: 51.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[159  78]
 [166  97]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:47, End: 2025-07-22 15:31:47)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 19, 17, 1, 9, 20, 15, 3, 14, 11, 10, 16, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 15, 3, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0082s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:48...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[212  25]
 [235  28]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:48, End: 2025-07-22 15:31:48)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 19, 17, 9, 20, 18, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0028s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:48...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[115 122]
 [118 145]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:48, End: 2025-07-22 15:31:48)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0035s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:49...
global Accuracy on shared test data: 54.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 84 153]
 [ 74 189]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:49, End: 2025-07-22 15:31:49)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [2, 19, 17, 1, 8, 4, 3, 13, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [2, 19, 17, 1, 8, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0036s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:49...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[123 114]
 [132 131]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:49, End: 2025-07-22 15:31:49)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 2, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0034s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:50...
global Accuracy on shared test data: 44.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[151  86]
 [190  73]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:50, End: 2025-07-22 15:31:50)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 17, 1, 20, 18, 8, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 17, 1, 20, 18, 8, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0184s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:50...
global Accuracy on shared test data: 47.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[106 131]
 [134 129]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:50, End: 2025-07-22 15:31:50)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 17, 1, 9, 8, 15, 3, 13, 11, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 17, 1, 9, 8, 15, 3, 13, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:51...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[107 130]
 [116 147]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:51, End: 2025-07-22 15:31:51)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:52...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[200  37]
 [222  41]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:52, End: 2025-07-22 15:31:52)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:52...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[220  17]
 [241  22]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:52, End: 2025-07-22 15:31:52)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 19, 17, 1, 9, 18, 8, 15, 14, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 18, 8, 15, 14, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0239s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:53...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [195  68]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:53, End: 2025-07-22 15:31:53)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0188s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:53...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [179  84]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:53, End: 2025-07-22 15:31:53)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 19, 17, 1, 20, 18, 8, 15, 4, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 19, 17, 1, 20, 18, 8, 15, 4, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:54...
global Accuracy on shared test data: 56.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[159  78]
 [139 124]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:54, End: 2025-07-22 15:31:54)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0024s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:55...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[213  24]
 [230  33]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:55, End: 2025-07-22 15:31:55)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:55...
global Accuracy on shared test data: 47.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[226  11]
 [253  10]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:55, End: 2025-07-22 15:31:55)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:56...
global Accuracy on shared test data: 45.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[219  18]
 [254   9]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:56, End: 2025-07-22 15:31:56)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 9, 18, 8, 15, 4, 3, 13, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 9, 18, 8, 15, 4, 3, 13, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0150s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:56...
global Accuracy on shared test data: 47.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[233   4]
 [259   4]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:56, End: 2025-07-22 15:31:56)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:57...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[237   0]
 [261   2]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:57, End: 2025-07-22 15:31:57)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 1, 9, 18, 8, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 1, 9, 18, 8, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0032s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:57...
global Accuracy on shared test data: 47.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[234   3]
 [259   4]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:57, End: 2025-07-22 15:31:57)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [7, 19, 17, 1, 20, 8, 4, 3, 13, 11, 10, 16, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [7, 19, 17, 1, 20, 8, 4, 3, 13, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:58...
global Accuracy on shared test data: 47.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [212  51]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:31:58, End: 2025-07-22 15:31:58)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 17, 1, 9, 8, 15, 3, 13, 14, 11, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 8, 15, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0027s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:59...
global Accuracy on shared test data: 44.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[187  50]
 [230  33]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:31:59, End: 2025-07-22 15:31:59)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:31:59...
global Accuracy on shared test data: 45.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [201  62]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:31:59, End: 2025-07-22 15:31:59)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 3, 11, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 3, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0240s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:00...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 99 138]
 [120 143]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:00, End: 2025-07-22 15:32:00)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 17, 1, 9, 18, 4, 3, 13, 14, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 18, 4, 3, 13, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0030s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:00...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 89 148]
 [ 98 165]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:00, End: 2025-07-22 15:32:00)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 9, 20, 18, 8, 15, 4, 3, 13, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 9, 20, 18, 8, 15, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0106s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:01...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[129 108]
 [147 116]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:01, End: 2025-07-22 15:32:01)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 1, 20, 18, 8, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 1, 20, 18, 8, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0030s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:02...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[120 117]
 [135 128]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:02, End: 2025-07-22 15:32:02)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [7, 19, 17, 1, 18, 8, 4, 3, 13, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [7, 19, 17, 1, 18, 8, 4, 3, 13, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0022s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:02...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 74 163]
 [ 79 184]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:02, End: 2025-07-22 15:32:02)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0029s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:03...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 64 173]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:03, End: 2025-07-22 15:32:03)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:03...
global Accuracy on shared test data: 53.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 97 140]
 [ 94 169]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:03, End: 2025-07-22 15:32:03)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0186s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:04...
global Accuracy on shared test data: 54.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[119 118]
 [108 155]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:04, End: 2025-07-22 15:32:04)
start time is: 97288885790762, end time is: 97306370222052
The total time is: 17484431290ns.

 ------- aggregate method: mean, random_seed: 100 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0027s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:05...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[233   4]
 [257   6]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:05, End: 2025-07-22 15:32:05)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 17, 20, 18, 8, 15, 4, 3, 13, 14, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 17, 20, 18, 8, 15, 4, 3, 13, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0239s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:05...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[144  93]
 [165  98]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:05, End: 2025-07-22 15:32:05)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 2, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [7, 2, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0196s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:06...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[228   9]
 [250  13]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:06, End: 2025-07-22 15:32:06)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:06...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [180  83]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:06, End: 2025-07-22 15:32:06)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0009s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:07...
global Accuracy on shared test data: 50.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[203  34]
 [213  50]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:07, End: 2025-07-22 15:32:07)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0144s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:08...
global Accuracy on shared test data: 45.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [217  46]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:08, End: 2025-07-22 15:32:08)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 11, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:08...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[103 134]
 [107 156]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:08, End: 2025-07-22 15:32:08)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 17, 1, 9, 20, 18, 15, 4, 3, 14, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 17, 1, 9, 20, 18, 15, 4, 3, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:09...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 73 164]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:09, End: 2025-07-22 15:32:09)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0063s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:09...
global Accuracy on shared test data: 53.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 86 151]
 [ 81 182]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:09, End: 2025-07-22 15:32:09)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0024s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:10...
global Accuracy on shared test data: 51.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 28 209]
 [ 34 229]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:10, End: 2025-07-22 15:32:10)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 17, 9, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [7, 17, 9, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0030s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:10...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 77 160]
 [ 93 170]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:10, End: 2025-07-22 15:32:10)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 6, 12], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:11...
global Accuracy on shared test data: 47.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[112 125]
 [138 125]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:11, End: 2025-07-22 15:32:11)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 2, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0035s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:12...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[139  98]
 [159 104]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:12, End: 2025-07-22 15:32:12)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:12...
global Accuracy on shared test data: 45.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[146  91]
 [182  81]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:12, End: 2025-07-22 15:32:12)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 10, 16, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:13...
global Accuracy on shared test data: 47.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[137 100]
 [162 101]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:13, End: 2025-07-22 15:32:13)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:13...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[117 120]
 [133 130]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:13, End: 2025-07-22 15:32:13)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 19, 17, 1, 9, 18, 8, 4, 3, 14, 11, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 19, 17, 1, 9, 18, 8, 4, 3, 14, 11, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:14...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[141  96]
 [159 104]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:14, End: 2025-07-22 15:32:14)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 9, 20, 18, 15, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 15, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0127s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:15...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[155  82]
 [164  99]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:15, End: 2025-07-22 15:32:15)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 19, 1, 9, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 2, 19, 1, 9, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:15...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[155  82]
 [179  84]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:15, End: 2025-07-22 15:32:15)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0133s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:16...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[138  99]
 [151 112]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:16, End: 2025-07-22 15:32:16)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0036s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:16...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[140  97]
 [161 102]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:16, End: 2025-07-22 15:32:16)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 19, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 2, 19, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0168s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:17...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[140  97]
 [158 105]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:17, End: 2025-07-22 15:32:17)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 13, 14, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 13, 14, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0009s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:17...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [192  71]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:17, End: 2025-07-22 15:32:17)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0050s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:18...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [176  87]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:18, End: 2025-07-22 15:32:18)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0055s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:19...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[143  94]
 [145 118]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:19, End: 2025-07-22 15:32:19)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0063s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:19...
global Accuracy on shared test data: 54.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[142  95]
 [134 129]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:19, End: 2025-07-22 15:32:19)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0033s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:20...
global Accuracy on shared test data: 55.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[144  93]
 [130 133]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:20, End: 2025-07-22 15:32:20)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0049s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:21...
global Accuracy on shared test data: 54.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[104 133]
 [ 93 170]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:21, End: 2025-07-22 15:32:21)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0012s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:21...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[109 128]
 [118 145]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:21, End: 2025-07-22 15:32:21)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 9, 20, 18, 8, 4, 14, 11, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 9, 20, 18, 8, 4, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0145s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:22...
global Accuracy on shared test data: 54.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[121 116]
 [113 150]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:22, End: 2025-07-22 15:32:22)
start time is: 97306370225349, end time is: 97324205711192
The total time is: 17835485843ns.

 ------- aggregate method: mean, random_seed: 200 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0122s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:23...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 12 225]
 [ 31 232]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:23, End: 2025-07-22 15:32:23)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0087s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:23...
global Accuracy on shared test data: 51.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[137 100]
 [143 120]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:23, End: 2025-07-22 15:32:23)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 17, 9, 20, 8, 15, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 17, 9, 20, 8, 15, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:24...
global Accuracy on shared test data: 46.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[124 113]
 [155 108]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:24, End: 2025-07-22 15:32:24)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 3, 13, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 3, 13, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0101s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:24...
global Accuracy on shared test data: 46.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[123 114]
 [156 107]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:24, End: 2025-07-22 15:32:24)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [7, 2, 19, 17, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [7, 2, 19, 17, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:25...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[198  39]
 [212  51]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:25, End: 2025-07-22 15:32:25)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 13, 14, 11, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0115s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:26...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[203  34]
 [216  47]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:26, End: 2025-07-22 15:32:26)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0028s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:26...
global Accuracy on shared test data: 50.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[104 133]
 [116 147]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:26, End: 2025-07-22 15:32:26)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 19, 1, 9, 20, 18, 8, 15, 4, 14, 11, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 19, 1, 9, 20, 18, 8, 15, 4, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:27...
global Accuracy on shared test data: 51.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[154  83]
 [161 102]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:27, End: 2025-07-22 15:32:27)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0058s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:27...
global Accuracy on shared test data: 55.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [155 108]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:27, End: 2025-07-22 15:32:27)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (11): [5, 19, 17, 20, 18, 15, 13, 14, 11, 16, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 11
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([11])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']], selected_client_indices: [5, 19, 17, 20, 18, 15, 13, 14, 11, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0013s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:28...
global Accuracy on shared test data: 53.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[134 103]
 [130 133]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:28, End: 2025-07-22 15:32:28)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 17, 20, 18, 8, 15, 4, 3, 14, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 17, 20, 18, 8, 15, 4, 3, 14, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:28...
global Accuracy on shared test data: 55.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[125 112]
 [112 151]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:28, End: 2025-07-22 15:32:28)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 17, 1, 9, 20, 18, 15, 4, 13, 14, 11, 10, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 17, 1, 9, 20, 18, 15, 4, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0198s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:29...
global Accuracy on shared test data: 54.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 96 141]
 [ 88 175]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:29, End: 2025-07-22 15:32:29)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0020s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:30...
global Accuracy on shared test data: 54.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[140  97]
 [130 133]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:30, End: 2025-07-22 15:32:30)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:30...
global Accuracy on shared test data: 54.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 99 138]
 [ 91 172]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:30, End: 2025-07-22 15:32:30)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 19, 17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 19, 17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0210s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:31...
global Accuracy on shared test data: 55.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 73 164]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:31, End: 2025-07-22 15:32:31)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 19, 17, 1, 20, 18, 15, 4, 3, 13, 11, 10, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 19, 17, 1, 20, 18, 15, 4, 3, 13, 11, 10, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0035s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:31...
global Accuracy on shared test data: 58.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[118 119]
 [ 90 173]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:31, End: 2025-07-22 15:32:31)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0155s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:32...
global Accuracy on shared test data: 57.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 89 148]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:32, End: 2025-07-22 15:32:32)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 19, 17, 1, 9, 18, 4, 3, 11, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 19, 17, 1, 9, 18, 4, 3, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0139s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:33...
global Accuracy on shared test data: 57.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 46 191]
 [ 23 240]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:33, End: 2025-07-22 15:32:33)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 19, 17, 9, 20, 18, 8, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 2, 19, 17, 9, 20, 18, 8, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:33...
global Accuracy on shared test data: 57.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 74 163]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:33, End: 2025-07-22 15:32:33)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 1, 9, 20, 18, 8, 15, 4, 3, 10, 16, 6], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 1, 9, 20, 18, 8, 15, 4, 3, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:34...
global Accuracy on shared test data: 57.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 98 139]
 [ 72 191]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:34, End: 2025-07-22 15:32:34)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0124s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:34...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[195  42]
 [195  68]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:34, End: 2025-07-22 15:32:34)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0121s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:35...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[189  48]
 [190  73]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:35, End: 2025-07-22 15:32:35)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0142s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:36...
global Accuracy on shared test data: 53.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [160 103]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:36, End: 2025-07-22 15:32:36)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:36...
global Accuracy on shared test data: 54.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[149  88]
 [141 122]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:36, End: 2025-07-22 15:32:36)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 17, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 17, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0020s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:37...
global Accuracy on shared test data: 54.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[109 128]
 [101 162]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:37, End: 2025-07-22 15:32:37)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:37...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[113 124]
 [112 151]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:37, End: 2025-07-22 15:32:37)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0084s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:38...
global Accuracy on shared test data: 54.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[127 110]
 [117 146]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:38, End: 2025-07-22 15:32:38)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0159s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:39...
global Accuracy on shared test data: 54.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[101 136]
 [ 90 173]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:39, End: 2025-07-22 15:32:39)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:39...
global Accuracy on shared test data: 55.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[108 129]
 [ 93 170]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:39, End: 2025-07-22 15:32:39)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [7, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 11], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [7, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0144s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:40...
global Accuracy on shared test data: 59.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 94 143]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:40, End: 2025-07-22 15:32:40)
start time is: 97324205714188, end time is: 97342120849785
The total time is: 17915135597ns.

 ------- aggregate method: mean, random_seed: 300 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0172s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:40...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 26 211]
 [ 37 226]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:40, End: 2025-07-22 15:32:40)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 2, 19, 17, 9, 18, 15, 3, 11, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 2, 19, 17, 9, 18, 15, 3, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:41...
global Accuracy on shared test data: 56.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 48 189]
 [ 29 234]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:41, End: 2025-07-22 15:32:41)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 11, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0032s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:42...
global Accuracy on shared test data: 54.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[134 103]
 [127 136]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:42, End: 2025-07-22 15:32:42)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 9, 20, 8, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 9, 20, 8, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:42...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[101 136]
 [116 147]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:42, End: 2025-07-22 15:32:42)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:43...
global Accuracy on shared test data: 54.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 52 185]
 [ 45 218]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:43, End: 2025-07-22 15:32:43)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 15, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0031s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:43...
global Accuracy on shared test data: 54.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 70 167]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:43, End: 2025-07-22 15:32:43)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0012s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:44...
global Accuracy on shared test data: 54.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 80 157]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:44, End: 2025-07-22 15:32:44)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:45...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[151  86]
 [145 118]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:45, End: 2025-07-22 15:32:45)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0144s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:45...
global Accuracy on shared test data: 55.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[117 120]
 [102 161]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:45, End: 2025-07-22 15:32:45)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [5, 7, 19, 17, 9, 20, 18, 8, 3, 14, 11, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 8, 3, 14, 11, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:46...
global Accuracy on shared test data: 53.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[127 110]
 [125 138]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:46, End: 2025-07-22 15:32:46)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 1, 9, 20, 18, 8, 15, 4, 14, 10, 16, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 1, 9, 20, 18, 8, 15, 4, 14, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0089s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:46...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [173  90]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:46, End: 2025-07-22 15:32:46)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 13, 11, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 4, 13, 11, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:47...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [179  84]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:47, End: 2025-07-22 15:32:47)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0234s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:48...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[191  46]
 [204  59]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:48, End: 2025-07-22 15:32:48)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0024s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:48...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [210  53]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:48, End: 2025-07-22 15:32:48)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:49...
global Accuracy on shared test data: 53.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 58 179]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:49, End: 2025-07-22 15:32:49)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0088s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:50...
global Accuracy on shared test data: 56.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 95 142]
 [ 78 185]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:50, End: 2025-07-22 15:32:50)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 11, 10, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:50...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[122 115]
 [121 142]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:50, End: 2025-07-22 15:32:50)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [2, 19, 17, 1, 9, 20, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [2, 19, 17, 1, 9, 20, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0008s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:51...
global Accuracy on shared test data: 46.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [202  61]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:51, End: 2025-07-22 15:32:51)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:51...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[156  81]
 [176  87]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:51, End: 2025-07-22 15:32:51)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 2, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 2, 19, 17, 1, 9, 20, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:52...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[155  82]
 [175  88]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:52, End: 2025-07-22 15:32:52)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (19): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 19
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([19])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:53...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[149  88]
 [160 103]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:53, End: 2025-07-22 15:32:53)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [2, 19, 17, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [2, 19, 17, 18, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0239s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:53...
global Accuracy on shared test data: 45.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[154  83]
 [188  75]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:53, End: 2025-07-22 15:32:53)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:54...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[142  95]
 [160 103]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:54, End: 2025-07-22 15:32:54)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 2, 19, 17, 1, 8, 15, 4, 3, 13, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 2, 19, 17, 1, 8, 15, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0010s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:54...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[105 132]
 [ 99 164]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:54, End: 2025-07-22 15:32:54)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0039s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:55...
global Accuracy on shared test data: 51.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[127 110]
 [134 129]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:55, End: 2025-07-22 15:32:55)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 19, 17, 9, 20, 8, 15, 4, 3, 13, 11, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 19, 17, 9, 20, 8, 15, 4, 3, 13, 11, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0150s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:55...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[191  46]
 [204  59]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:55, End: 2025-07-22 15:32:55)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 17, 1, 9, 20, 18, 8, 4, 3, 13, 14, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0017s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:56...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [178  85]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:56, End: 2025-07-22 15:32:56)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 16, 6], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 19, 17, 1, 9, 20, 18, 8, 15, 3, 13, 14, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:57...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[160  77]
 [161 102]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:57, End: 2025-07-22 15:32:57)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 7, 19, 17, 20, 18, 4, 3, 14, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 7, 19, 17, 20, 18, 4, 3, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:57...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[150  87]
 [155 108]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:32:57, End: 2025-07-22 15:32:57)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 7, 2, 19, 17, 1, 9, 15, 4, 3, 14, 11, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 15, 4, 3, 14, 11, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0087s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:58...
global Accuracy on shared test data: 53.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [158 105]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:58, End: 2025-07-22 15:32:58)
start time is: 97342120852831, end time is: 97359892096902
The total time is: 17771244071ns.

 ------- aggregate method: mean, random_seed: 400 --------

[Server] Epoch 0...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 19, 17, 1, 18, 15, 4, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 19, 17, 1, 18, 15, 4, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:58...
global Accuracy on shared test data: 53.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[134 103]
 [132 131]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:58, End: 2025-07-22 15:32:58)

[Server] Epoch 1...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (12): [5, 7, 19, 17, 1, 20, 8, 3, 13, 14, 10, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 12
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([12])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']], selected_client_indices: [5, 7, 19, 17, 1, 20, 8, 3, 13, 14, 10, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0056s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:59...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 39 198]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:59, End: 2025-07-22 15:32:59)

[Server] Epoch 2...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 17, 1, 9, 20, 18, 8, 3, 13, 14, 11, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 17, 1, 9, 20, 18, 8, 3, 13, 14, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:32:59...
global Accuracy on shared test data: 53.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 47 190]
 [ 45 218]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:32:59, End: 2025-07-22 15:32:59)

[Server] Epoch 3...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 1, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0200s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:00...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 91 146]
 [ 85 178]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:00, End: 2025-07-22 15:33:00)

[Server] Epoch 4...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 20
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([20])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']
 ['Update 18']
 ['Update 19']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:00...
global Accuracy on shared test data: 54.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 69 168]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:00, End: 2025-07-22 15:33:00)

[Server] Epoch 5...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [7, 2, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:01...
global Accuracy on shared test data: 53.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 33 204]
 [ 31 232]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:01, End: 2025-07-22 15:33:01)

[Server] Epoch 6...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 7, 17, 1, 9, 20, 8, 15, 4, 3, 14, 11, 10, 16, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 7, 17, 1, 9, 20, 8, 15, 4, 3, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0051s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:02...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 40 197]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:33:02, End: 2025-07-22 15:33:02)

[Server] Epoch 7...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 19, 17, 1, 9, 18, 8, 15, 4, 3, 13, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 19, 17, 1, 9, 18, 8, 15, 4, 3, 13, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:02...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[107 130]
 [112 151]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:33:02, End: 2025-07-22 15:33:02)

[Server] Epoch 8...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 2, 19, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0236s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:03...
global Accuracy on shared test data: 53.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[139  98]
 [135 128]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:33:03, End: 2025-07-22 15:33:03)

[Server] Epoch 9...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [19, 17, 1, 9, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [19, 17, 1, 9, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0089s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:03...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 72 165]
 [ 76 187]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:33:03, End: 2025-07-22 15:33:03)

[Server] Epoch 10...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0052s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:04...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 73 164]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0025 seconds (Start: 2025-07-22 15:33:04, End: 2025-07-22 15:33:04)

[Server] Epoch 11...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 3, 13, 11, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 3, 13, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:04...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[140  97]
 [155 108]]
Function 'evaluate_global_model' executed in 0.0023 seconds (Start: 2025-07-22 15:33:04, End: 2025-07-22 15:33:04)

[Server] Epoch 12...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [7, 19, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [7, 19, 9, 20, 18, 8, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0207s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:05...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 93 144]
 [ 96 167]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:05, End: 2025-07-22 15:33:05)

[Server] Epoch 13...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 1, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0026s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:06...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[123 114]
 [132 131]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:06, End: 2025-07-22 15:33:06)

[Server] Epoch 14...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 19, 17, 9, 20, 18, 8, 15, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:06...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 85 152]
 [100 163]]
Function 'evaluate_global_model' executed in 0.0023 seconds (Start: 2025-07-22 15:33:06, End: 2025-07-22 15:33:06)

[Server] Epoch 15...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 17, 1, 9, 20, 8, 15, 4, 3, 13, 11, 10, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0166s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:07...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 83 154]
 [106 157]]
Function 'evaluate_global_model' executed in 0.0024 seconds (Start: 2025-07-22 15:33:07, End: 2025-07-22 15:33:07)

[Server] Epoch 16...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 2, 17, 1, 9, 20, 18, 8, 4, 3, 11, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 2, 17, 1, 9, 20, 18, 8, 4, 3, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:07...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 90 147]
 [109 154]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:07, End: 2025-07-22 15:33:07)

[Server] Epoch 17...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [7, 2, 19, 17, 1, 20, 18, 8, 4, 13, 14, 11, 10, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [7, 2, 19, 17, 1, 20, 18, 8, 4, 13, 14, 11, 10, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0143s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:08...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 83 154]
 [102 161]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:08, End: 2025-07-22 15:33:08)

[Server] Epoch 18...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (10): [5, 7, 2, 20, 18, 8, 10, 16, 6, 12], updated_f: 3
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 10
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([10])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], selected_client_indices: [5, 7, 2, 20, 18, 8, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0071s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:08...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 68 169]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:33:08, End: 2025-07-22 15:33:08)

[Server] Epoch 19...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [7, 2, 19, 9, 20, 8, 15, 4, 3, 13, 10, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [7, 2, 19, 9, 20, 8, 15, 4, 3, 13, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0006s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:09...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 41 196]
 [ 43 220]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:33:09, End: 2025-07-22 15:33:09)

[Server] Epoch 20...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (15): [5, 2, 17, 1, 9, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 15
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([15])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']], selected_client_indices: [5, 2, 17, 1, 9, 8, 15, 4, 3, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:10...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 31 206]
 [ 30 233]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 15:33:10, End: 2025-07-22 15:33:10)

[Server] Epoch 21...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 7, 2, 19, 17, 1, 9, 20, 15, 4, 3, 14, 16, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 15, 4, 3, 14, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0016s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:10...
global Accuracy on shared test data: 51.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 26 211]
 [ 33 230]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:10, End: 2025-07-22 15:33:10)

[Server] Epoch 22...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (14): [5, 19, 9, 20, 18, 15, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 14
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([14])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']], selected_client_indices: [5, 19, 9, 20, 18, 15, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0152s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:10...
global Accuracy on shared test data: 50.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 26 211]
 [ 38 225]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:10, End: 2025-07-22 15:33:10)

[Server] Epoch 23...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 1, 9, 18, 8, 15, 4, 3, 13, 11, 16, 6, 12], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 1, 9, 18, 8, 15, 4, 3, 13, 11, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:11...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 21 216]
 [ 43 220]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:11, End: 2025-07-22 15:33:11)

[Server] Epoch 24...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (13): [5, 7, 17, 1, 9, 20, 15, 3, 13, 14, 10, 16, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 13
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([13])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']], selected_client_indices: [5, 7, 17, 1, 9, 20, 15, 3, 13, 14, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0019s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:12...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 25 212]
 [ 29 234]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:12, End: 2025-07-22 15:33:12)

[Server] Epoch 25...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [5, 7, 2, 19, 17, 9, 20, 18, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 7, 2, 19, 17, 9, 20, 18, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:12...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 22 215]
 [ 25 238]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:12, End: 2025-07-22 15:33:12)

[Server] Epoch 26...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0008s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:13...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 28 209]
 [ 45 218]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:33:13, End: 2025-07-22 15:33:13)

[Server] Epoch 27...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (18): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 11, 10, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 18
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([18])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']
 ['Update 17']], selected_client_indices: [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 11, 10, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0024s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:13...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 26 211]
 [ 45 218]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:13, End: 2025-07-22 15:33:13)

[Server] Epoch 28...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (16): [7, 2, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 2, 17, 1, 9, 20, 18, 8, 15, 4, 13, 14, 11, 10, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0033s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:14...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 30 207]
 [ 41 222]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 15:33:14, End: 2025-07-22 15:33:14)

[Server] Epoch 29...
client_indices (20): [5, 7, 2, 19, 17, 1, 9, 20, 18, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], f:8
select_clients (17): [5, 7, 2, 19, 17, 9, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 17
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([17])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']
 ['Update 16']], selected_client_indices: [5, 7, 2, 19, 17, 9, 8, 15, 4, 3, 13, 14, 11, 10, 16, 6, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0065s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 15:33:15...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 32 205]
 [ 43 220]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 15:33:15, End: 2025-07-22 15:33:15)
start time is: 97359892100088, end time is: 97376985036953
The total time is: 17092936865ns.
-----------------------------------------------------------------------------------
[Server] Training complete. Connections closed.



***random_seed:0
rkrum =  [0.734, 0.748, 0.746, 0.742, 0.742, 0.758, 0.75, 0.76, 0.728, 0.712, 0.74, 0.73, 0.75, 0.762, 0.762, 0.756, 0.76, 0.75, 0.76, 0.754, 0.732, 0.744, 0.744, 0.776, 0.736, 0.752, 0.756, 0.728, 0.752, 0.738]
krum =  [0.764, 0.778, 0.786, 0.774, 0.766, 0.772, 0.762, 0.754, 0.764, 0.764, 0.754, 0.76, 0.756, 0.766, 0.77, 0.774, 0.766, 0.768, 0.756, 0.76, 0.762, 0.768, 0.752, 0.746, 0.762, 0.746, 0.726, 0.722, 0.716, 0.738]
mean =  [0.512, 0.48, 0.52, 0.546, 0.508, 0.448, 0.47, 0.508, 0.482, 0.484, 0.5, 0.52, 0.566, 0.492, 0.472, 0.456, 0.474, 0.478, 0.476, 0.472, 0.44, 0.454, 0.484, 0.508, 0.49, 0.496, 0.516, 0.518, 0.532, 0.548]
rkrum =  37002338702
krum =  17364799936
mean =  17484431290

***random_seed:100
rkrum =  [0.75, 0.786, 0.758, 0.776, 0.774, 0.762, 0.772, 0.752, 0.766, 0.768, 0.76, 0.77, 0.748, 0.74, 0.752, 0.736, 0.75, 0.754, 0.742, 0.764, 0.718, 0.698, 0.716, 0.73, 0.716, 0.73, 0.728, 0.736, 0.734, 0.742]
krum =  [0.75, 0.76, 0.764, 0.78, 0.786, 0.774, 0.782, 0.774, 0.772, 0.76, 0.776, 0.78, 0.774, 0.77, 0.774, 0.762, 0.764, 0.742, 0.746, 0.744, 0.766, 0.73, 0.726, 0.738, 0.716, 0.734, 0.728, 0.754, 0.738, 0.754]
mean =  [0.478, 0.484, 0.482, 0.49, 0.506, 0.454, 0.518, 0.526, 0.536, 0.514, 0.494, 0.474, 0.486, 0.454, 0.476, 0.494, 0.49, 0.508, 0.478, 0.5, 0.484, 0.49, 0.492, 0.498, 0.522, 0.542, 0.554, 0.548, 0.508, 0.542]
rkrum =  18074010611
krum =  17961631764
mean =  17835485843

***random_seed:200
rkrum =  [0.744, 0.78, 0.76, 0.778, 0.778, 0.764, 0.768, 0.76, 0.798, 0.772, 0.76, 0.758, 0.78, 0.77, 0.776, 0.758, 0.782, 0.746, 0.784, 0.752, 0.73, 0.762, 0.762, 0.748, 0.752, 0.756, 0.744, 0.754, 0.74, 0.752]
krum =  [0.744, 0.772, 0.782, 0.768, 0.79, 0.778, 0.76, 0.78, 0.764, 0.784, 0.76, 0.77, 0.772, 0.778, 0.752, 0.77, 0.772, 0.766, 0.754, 0.744, 0.742, 0.744, 0.734, 0.728, 0.744, 0.75, 0.75, 0.716, 0.736, 0.748]
mean =  [0.488, 0.514, 0.464, 0.46, 0.498, 0.5, 0.502, 0.512, 0.558, 0.534, 0.552, 0.542, 0.546, 0.542, 0.558, 0.582, 0.578, 0.572, 0.572, 0.578, 0.526, 0.524, 0.536, 0.542, 0.542, 0.528, 0.546, 0.548, 0.556, 0.59]
rkrum =  17978956096
krum =  17834761094
mean =  17915135597

***random_seed:300
rkrum =  [0.75, 0.754, 0.758, 0.802, 0.772, 0.75, 0.75, 0.786, 0.786, 0.762, 0.782, 0.792, 0.756, 0.742, 0.748, 0.762, 0.768, 0.756, 0.768, 0.756, 0.77, 0.744, 0.756, 0.748, 0.754, 0.74, 0.756, 0.754, 0.752, 0.746]
krum =  [0.75, 0.776, 0.778, 0.77, 0.784, 0.768, 0.768, 0.766, 0.782, 0.756, 0.772, 0.754, 0.764, 0.77, 0.756, 0.734, 0.718, 0.708, 0.732, 0.706, 0.722, 0.72, 0.72, 0.734, 0.718, 0.742, 0.71, 0.72, 0.73, 0.728]
mean =  [0.504, 0.564, 0.54, 0.496, 0.54, 0.548, 0.548, 0.538, 0.556, 0.53, 0.504, 0.492, 0.5, 0.478, 0.532, 0.56, 0.528, 0.462, 0.486, 0.486, 0.504, 0.458, 0.49, 0.538, 0.512, 0.5, 0.522, 0.524, 0.516, 0.534]
rkrum =  17830625628
krum =  17789149045
mean =  17771244071

***random_seed:400
rkrum =  [0.746, 0.75, 0.772, 0.768, 0.758, 0.758, 0.736, 0.752, 0.75, 0.768, 0.764, 0.762, 0.748, 0.742, 0.74, 0.75, 0.75, 0.748, 0.77, 0.758, 0.758, 0.746, 0.748, 0.762, 0.748, 0.744, 0.746, 0.76, 0.758, 0.756]
krum =  [0.756, 0.76, 0.768, 0.764, 0.75, 0.782, 0.782, 0.784, 0.764, 0.78, 0.766, 0.762, 0.768, 0.754, 0.776, 0.768, 0.74, 0.738, 0.744, 0.78, 0.772, 0.774, 0.748, 0.756, 0.762, 0.736, 0.756, 0.744, 0.748, 0.756]
mean =  [0.53, 0.5, 0.53, 0.538, 0.546, 0.53, 0.494, 0.516, 0.534, 0.518, 0.538, 0.496, 0.52, 0.508, 0.496, 0.48, 0.488, 0.488, 0.524, 0.522, 0.528, 0.512, 0.502, 0.482, 0.518, 0.52, 0.492, 0.488, 0.504, 0.504]
rkrum =  17076804308
krum =  17074400609
mean =  17092936865


start time is: 97080465972643, end time is: 97377088646044
The total time is: 296622673401ns.
