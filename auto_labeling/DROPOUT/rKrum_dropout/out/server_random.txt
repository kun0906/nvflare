Namespace(server_ip='127.0.0.1', workspace_dir='out/ws_20_30_1_1', num_clients=20, num_rounds=30)
Number of clients:  20
NUM_BYZANTINE_CLIENTS:  8
NUM_HONEST_CLIENTS:  12
[Server] Starting...
[Server] Waiting for 20 clients to connect...
[Server] Connected to client 11 at ('127.0.0.1', 58074)
[Server] Connected to client 1 at ('127.0.0.1', 58080)
[Server] Connected to client 16 at ('127.0.0.1', 58088)
[Server] Connected to client 19 at ('127.0.0.1', 58094)
[Server] Connected to client 12 at ('127.0.0.1', 58098)
[Server] Connected to client 5 at ('127.0.0.1', 58106)
[Server] Connected to client 14 at ('127.0.0.1', 58118)
[Server] Connected to client 17 at ('127.0.0.1', 58122)
[Server] Connected to client 13 at ('127.0.0.1', 58128)
[Server] Connected to client 4 at ('127.0.0.1', 58134)
[Server] Connected to client 18 at ('127.0.0.1', 58138)
[Server] Connected to client 10 at ('127.0.0.1', 58142)
[Server] Connected to client 15 at ('127.0.0.1', 58146)
[Server] Connected to client 3 at ('127.0.0.1', 58152)
[Server] Connected to client 9 at ('127.0.0.1', 58164)
[Server] Connected to client 7 at ('127.0.0.1', 58178)
[Server] Connected to client 2 at ('127.0.0.1', 58194)
[Server] Connected to client 6 at ('127.0.0.1', 58204)
[Server] Connected to client 8 at ('127.0.0.1', 58206)
[Server] Connected to client 20 at ('127.0.0.1', 58218)
[Server] All clients connected.
-----------------------------------------------------------------------------------

 ------- aggregate method: rkrum, random_seed: 0 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 3, 1, 13, 7, 14, 20, 12, 17, 5, 4, 19, 16, 10, 6, 11], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8979e+05, 3.8982e+05, 7.3839e+05, 3.8984e+05, 7.8794e+05,
         7.7248e+05, 3.8986e+05, 7.8057e+05, 3.8982e+05, 3.8978e+05, 7.6434e+05,
         7.8024e+05, 3.8979e+05, 3.8979e+05, 3.8985e+05],
        [3.8979e+05, 0.0000e+00, 4.8607e+00, 3.7604e+05, 4.6567e+00, 3.9026e+05,
         3.9080e+05, 3.9787e+00, 3.9442e+05, 4.1414e+00, 4.6935e+00, 3.9109e+05,
         3.7539e+05, 4.4777e+00, 4.3403e+00, 5.1257e+00],
        [3.8982e+05, 4.8607e+00, 0.0000e+00, 3.7605e+05, 4.6840e+00, 3.9022e+05,
         3.9085e+05, 4.6858e+00, 3.9435e+05, 5.0981e+00, 4.1036e+00, 3.9114e+05,
         3.7540e+05, 3.9813e+00, 4.9819e+00, 3.9152e+00],
        [7.3839e+05, 3.7604e+05, 3.7605e+05, 0.0000e+00, 3.7603e+05, 7.6241e+05,
         7.8068e+05, 3.7603e+05, 7.8753e+05, 3.7601e+05, 3.7606e+05, 7.7156e+05,
         7.4269e+05, 3.7606e+05, 3.7609e+05, 3.7603e+05],
        [3.8984e+05, 4.6567e+00, 4.6840e+00, 3.7603e+05, 0.0000e+00, 3.9026e+05,
         3.9083e+05, 4.3590e+00, 3.9439e+05, 4.2336e+00, 4.1314e+00, 3.9106e+05,
         3.7543e+05, 4.1454e+00, 4.7417e+00, 4.8535e+00],
        [7.8794e+05, 3.9026e+05, 3.9022e+05, 7.6241e+05, 3.9026e+05, 0.0000e+00,
         7.8186e+05, 3.9025e+05, 7.8977e+05, 3.9025e+05, 3.9020e+05, 7.7227e+05,
         7.6008e+05, 3.9023e+05, 3.9030e+05, 3.9030e+05],
        [7.7248e+05, 3.9080e+05, 3.9085e+05, 7.8068e+05, 3.9083e+05, 7.8186e+05,
         0.0000e+00, 3.9080e+05, 7.8572e+05, 3.9078e+05, 3.9080e+05, 7.6860e+05,
         7.8425e+05, 3.9079e+05, 3.9076e+05, 3.9084e+05],
        [3.8986e+05, 3.9787e+00, 4.6858e+00, 3.7603e+05, 4.3590e+00, 3.9025e+05,
         3.9080e+05, 0.0000e+00, 3.9438e+05, 3.8044e+00, 3.9495e+00, 3.9112e+05,
         3.7546e+05, 3.8860e+00, 3.8907e+00, 4.8419e+00],
        [7.8057e+05, 3.9442e+05, 3.9435e+05, 7.8753e+05, 3.9439e+05, 7.8977e+05,
         7.8572e+05, 3.9438e+05, 0.0000e+00, 3.9437e+05, 3.9437e+05, 7.9403e+05,
         7.5313e+05, 3.9435e+05, 3.9437e+05, 3.9438e+05],
        [3.8982e+05, 4.1414e+00, 5.0981e+00, 3.7601e+05, 4.2336e+00, 3.9025e+05,
         3.9078e+05, 3.8044e+00, 3.9437e+05, 0.0000e+00, 4.4703e+00, 3.9107e+05,
         3.7541e+05, 4.3988e+00, 4.1158e+00, 5.4212e+00],
        [3.8978e+05, 4.6935e+00, 4.1036e+00, 3.7606e+05, 4.1314e+00, 3.9020e+05,
         3.9080e+05, 3.9495e+00, 3.9437e+05, 4.4703e+00, 0.0000e+00, 3.9105e+05,
         3.7542e+05, 3.6686e+00, 4.2844e+00, 4.2961e+00],
        [7.6434e+05, 3.9109e+05, 3.9114e+05, 7.7156e+05, 3.9106e+05, 7.7227e+05,
         7.6860e+05, 3.9112e+05, 7.9403e+05, 3.9107e+05, 3.9105e+05, 0.0000e+00,
         7.6932e+05, 3.9110e+05, 3.9106e+05, 3.9112e+05],
        [7.8024e+05, 3.7539e+05, 3.7540e+05, 7.4269e+05, 3.7543e+05, 7.6008e+05,
         7.8425e+05, 3.7546e+05, 7.5313e+05, 3.7541e+05, 3.7542e+05, 7.6932e+05,
         0.0000e+00, 3.7546e+05, 3.7547e+05, 3.7542e+05],
        [3.8979e+05, 4.4777e+00, 3.9813e+00, 3.7606e+05, 4.1454e+00, 3.9023e+05,
         3.9079e+05, 3.8860e+00, 3.9435e+05, 4.3988e+00, 3.6686e+00, 3.9110e+05,
         3.7546e+05, 0.0000e+00, 4.6221e+00, 4.2128e+00],
        [3.8979e+05, 4.3403e+00, 4.9819e+00, 3.7609e+05, 4.7417e+00, 3.9030e+05,
         3.9076e+05, 3.8907e+00, 3.9437e+05, 4.1158e+00, 4.2844e+00, 3.9106e+05,
         3.7547e+05, 4.6221e+00, 0.0000e+00, 5.3964e+00],
        [3.8985e+05, 5.1257e+00, 3.9152e+00, 3.7603e+05, 4.8535e+00, 3.9030e+05,
         3.9084e+05, 4.8419e+00, 3.9438e+05, 5.4212e+00, 4.2961e+00, 3.9112e+05,
         3.7542e+05, 4.2128e+00, 5.3964e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 389783.5625, 389791.2500, 389791.7812, 389792.2500,
        389824.2188, 389824.5625, 389841.8438, 389849.6875, 389860.7500,
        738385.5000, 764339.1250, 772483.3125, 780244.6250, 780565.2500,
        787943.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.9787e+00, 4.1414e+00, 4.3403e+00, 4.4777e+00, 4.6567e+00,
        4.6935e+00, 4.8607e+00, 5.1257e+00, 3.7539e+05, 3.7604e+05, 3.8979e+05,
        3.9026e+05, 3.9080e+05, 3.9109e+05, 3.9442e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.9152e+00, 3.9813e+00, 4.1036e+00, 4.6840e+00, 4.6858e+00,
        4.8607e+00, 4.9819e+00, 5.0981e+00, 3.7540e+05, 3.7605e+05, 3.8982e+05,
        3.9022e+05, 3.9085e+05, 3.9114e+05, 3.9435e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376008.4062, 376025.7188, 376033.1875, 376033.6875,
        376043.6875, 376053.2188, 376056.3438, 376056.7812, 376085.0938,
        738385.5000, 742685.3750, 762414.3750, 771563.4375, 780679.2500,
        787529.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.1314e+00, 4.1454e+00, 4.2336e+00, 4.3590e+00, 4.6567e+00,
        4.6840e+00, 4.7417e+00, 4.8535e+00, 3.7543e+05, 3.7603e+05, 3.8984e+05,
        3.9026e+05, 3.9083e+05, 3.9106e+05, 3.9439e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390197.0625, 390223.1250, 390229.8750, 390246.3438,
        390254.0938, 390256.0000, 390257.2812, 390300.1250, 390300.4062,
        760078.5625, 762414.3750, 772270.1250, 781859.1250, 787943.8750,
        789765.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390759.8438, 390777.6250, 390793.0625, 390795.0625,
        390801.8750, 390803.3438, 390830.8125, 390839.0625, 390848.6250,
        768599.7500, 772483.3125, 780679.2500, 781859.1250, 784245.9375,
        785724.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.8044e+00, 3.8860e+00, 3.8907e+00, 3.9495e+00, 3.9787e+00,
        4.3590e+00, 4.6858e+00, 4.8419e+00, 3.7546e+05, 3.7603e+05, 3.8986e+05,
        3.9025e+05, 3.9080e+05, 3.9112e+05, 3.9438e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394347.0625, 394347.3750, 394368.4375, 394370.8438,
        394374.0312, 394379.0938, 394384.5000, 394390.6250, 394420.8750,
        753134.1250, 780565.2500, 785724.4375, 787529.9375, 789765.6875,
        794031.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.8044e+00, 4.1158e+00, 4.1414e+00, 4.2336e+00, 4.3988e+00,
        4.4703e+00, 5.0981e+00, 5.4212e+00, 3.7541e+05, 3.7601e+05, 3.8982e+05,
        3.9025e+05, 3.9078e+05, 3.9107e+05, 3.9437e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6686e+00, 3.9495e+00, 4.1036e+00, 4.1314e+00, 4.2844e+00,
        4.2961e+00, 4.4703e+00, 4.6935e+00, 3.7542e+05, 3.7606e+05, 3.8978e+05,
        3.9020e+05, 3.9080e+05, 3.9105e+05, 3.9437e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391045.2500, 391055.3125, 391059.1250, 391065.8750,
        391094.3438, 391101.5938, 391119.2500, 391120.7500, 391141.3750,
        764339.1250, 768599.7500, 769319.5000, 771563.4375, 772270.1250,
        794031.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 375388.2188, 375398.7188, 375412.9375, 375415.5625,
        375419.0625, 375427.1875, 375456.5938, 375464.5938, 375466.5625,
        742685.3750, 753134.1250, 760078.5625, 769319.5000, 780244.6250,
        784245.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6686e+00, 3.8860e+00, 3.9813e+00, 4.1454e+00, 4.2128e+00,
        4.3988e+00, 4.4777e+00, 4.6221e+00, 3.7546e+05, 3.7606e+05, 3.8979e+05,
        3.9023e+05, 3.9079e+05, 3.9110e+05, 3.9435e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.8907e+00, 4.1158e+00, 4.2844e+00, 4.3403e+00, 4.6221e+00,
        4.7417e+00, 4.9819e+00, 5.3964e+00, 3.7547e+05, 3.7609e+05, 3.8979e+05,
        3.9030e+05, 3.9076e+05, 3.9106e+05, 3.9437e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.9152e+00, 4.2128e+00, 4.2961e+00, 4.8419e+00, 4.8535e+00,
        5.1257e+00, 5.3964e+00, 5.4212e+00, 3.7542e+05, 3.7603e+05, 3.8985e+05,
        3.9030e+05, 3.9084e+05, 3.9112e+05, 3.9438e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['424674.50', '75146.82', '75148.84', '412278.19', '75148.88', '427234.25', '428584.91', '75152.31', '430251.66', '75145.71', '75150.91', '428414.19', '412153.47', '75155.48', '75158.80', '75148.73']
estimated f for each client, fs: [5, 7, 7, 5, 7, 5, 5, 7, 5, 7, 7, 5, 5, 7, 7, 7]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 3, 1, 13, 7, 14, 20, 12, 17, 5, 4, 19, 16, 10, 6, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0141s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:01...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.7574 seconds (Start: 2025-07-22 16:00:01, End: 2025-07-22 16:00:01)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 13, 6, 12, 4, 1, 10, 9, 18, 5, 17, 8, 15, 16, 19, 14], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 8.1810e+05, 4.0352e+05, 4.0353e+05, 4.0346e+05, 4.0349e+05,
         4.0349e+05, 4.0347e+05, 7.9807e+05, 4.0345e+05, 8.0006e+05, 4.0352e+05,
         7.9703e+05, 8.1250e+05, 8.2303e+05, 7.8445e+05],
        [8.1810e+05, 0.0000e+00, 4.1258e+05, 4.1257e+05, 4.1258e+05, 4.1255e+05,
         4.1256e+05, 4.1257e+05, 7.8728e+05, 4.1257e+05, 7.8941e+05, 4.1258e+05,
         8.0522e+05, 8.2276e+05, 7.8346e+05, 8.0685e+05],
        [4.0352e+05, 4.1258e+05, 0.0000e+00, 2.0187e+00, 1.9159e+00, 1.9513e+00,
         1.9450e+00, 1.9026e+00, 3.8550e+05, 2.4119e+00, 3.9414e+05, 2.1780e+00,
         3.9633e+05, 3.9302e+05, 4.0084e+05, 3.9030e+05],
        [4.0353e+05, 4.1257e+05, 2.0187e+00, 0.0000e+00, 1.8490e+00, 1.9401e+00,
         1.7856e+00, 2.0387e+00, 3.8552e+05, 2.1639e+00, 3.9416e+05, 2.0848e+00,
         3.9631e+05, 3.9299e+05, 4.0086e+05, 3.9029e+05],
        [4.0346e+05, 4.1258e+05, 1.9159e+00, 1.8490e+00, 0.0000e+00, 1.9179e+00,
         1.8700e+00, 1.9212e+00, 3.8552e+05, 2.1086e+00, 3.9410e+05, 1.8752e+00,
         3.9642e+05, 3.9299e+05, 4.0085e+05, 3.9030e+05],
        [4.0349e+05, 4.1255e+05, 1.9513e+00, 1.9401e+00, 1.9179e+00, 0.0000e+00,
         1.9005e+00, 1.7822e+00, 3.8546e+05, 2.1804e+00, 3.9412e+05, 2.1355e+00,
         3.9635e+05, 3.9303e+05, 4.0083e+05, 3.9031e+05],
        [4.0349e+05, 4.1256e+05, 1.9450e+00, 1.7856e+00, 1.8700e+00, 1.9005e+00,
         0.0000e+00, 1.7286e+00, 3.8550e+05, 2.1617e+00, 3.9415e+05, 1.9655e+00,
         3.9634e+05, 3.9297e+05, 4.0085e+05, 3.9031e+05],
        [4.0347e+05, 4.1257e+05, 1.9026e+00, 2.0387e+00, 1.9212e+00, 1.7822e+00,
         1.7286e+00, 0.0000e+00, 3.8550e+05, 2.2490e+00, 3.9412e+05, 1.9954e+00,
         3.9640e+05, 3.9301e+05, 4.0083e+05, 3.9031e+05],
        [7.9807e+05, 7.8728e+05, 3.8550e+05, 3.8552e+05, 3.8552e+05, 3.8546e+05,
         3.8550e+05, 3.8550e+05, 0.0000e+00, 3.8547e+05, 7.7079e+05, 3.8549e+05,
         7.9110e+05, 7.8479e+05, 7.7432e+05, 7.7530e+05],
        [4.0345e+05, 4.1257e+05, 2.4119e+00, 2.1639e+00, 2.1086e+00, 2.1804e+00,
         2.1617e+00, 2.2490e+00, 3.8547e+05, 0.0000e+00, 3.9415e+05, 2.3415e+00,
         3.9636e+05, 3.9299e+05, 4.0084e+05, 3.9031e+05],
        [8.0006e+05, 7.8941e+05, 3.9414e+05, 3.9416e+05, 3.9410e+05, 3.9412e+05,
         3.9415e+05, 3.9412e+05, 7.7079e+05, 3.9415e+05, 0.0000e+00, 3.9412e+05,
         8.0177e+05, 8.1146e+05, 7.8413e+05, 7.9761e+05],
        [4.0352e+05, 4.1258e+05, 2.1780e+00, 2.0848e+00, 1.8752e+00, 2.1355e+00,
         1.9655e+00, 1.9954e+00, 3.8549e+05, 2.3415e+00, 3.9412e+05, 0.0000e+00,
         3.9638e+05, 3.9297e+05, 4.0085e+05, 3.9035e+05],
        [7.9703e+05, 8.0522e+05, 3.9633e+05, 3.9631e+05, 3.9642e+05, 3.9635e+05,
         3.9634e+05, 3.9640e+05, 7.9110e+05, 3.9636e+05, 8.0177e+05, 3.9638e+05,
         0.0000e+00, 7.9491e+05, 8.1807e+05, 7.8967e+05],
        [8.1250e+05, 8.2276e+05, 3.9302e+05, 3.9299e+05, 3.9299e+05, 3.9303e+05,
         3.9297e+05, 3.9301e+05, 7.8479e+05, 3.9299e+05, 8.1146e+05, 3.9297e+05,
         7.9491e+05, 0.0000e+00, 8.0260e+05, 7.8753e+05],
        [8.2303e+05, 7.8346e+05, 4.0084e+05, 4.0086e+05, 4.0085e+05, 4.0083e+05,
         4.0085e+05, 4.0083e+05, 7.7432e+05, 4.0084e+05, 7.8413e+05, 4.0085e+05,
         8.1807e+05, 8.0260e+05, 0.0000e+00, 7.9425e+05],
        [7.8445e+05, 8.0685e+05, 3.9030e+05, 3.9029e+05, 3.9030e+05, 3.9031e+05,
         3.9031e+05, 3.9031e+05, 7.7530e+05, 3.9031e+05, 7.9761e+05, 3.9035e+05,
         7.8967e+05, 7.8753e+05, 7.9425e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 403448.0625, 403462.0938, 403473.2812, 403488.0625,
        403493.8750, 403516.7500, 403518.2188, 403531.1875, 784450.7500,
        797034.1250, 798068.2500, 800055.8750, 812502.9375, 818102.0625,
        823029.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 412550.0000, 412558.4688, 412567.0938, 412569.0312,
        412571.9375, 412579.9688, 412580.1875, 412581.4375, 783462.8125,
        787279.3750, 789414.3125, 805219.1250, 806849.3750, 818102.0625,
        822761.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.9026e+00, 1.9159e+00, 1.9450e+00, 1.9513e+00, 2.0187e+00,
        2.1780e+00, 2.4119e+00, 3.8550e+05, 3.9030e+05, 3.9302e+05, 3.9414e+05,
        3.9633e+05, 4.0084e+05, 4.0352e+05, 4.1258e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7856e+00, 1.8490e+00, 1.9401e+00, 2.0187e+00, 2.0387e+00,
        2.0848e+00, 2.1639e+00, 3.8552e+05, 3.9029e+05, 3.9299e+05, 3.9416e+05,
        3.9631e+05, 4.0086e+05, 4.0353e+05, 4.1257e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8490e+00, 1.8700e+00, 1.8752e+00, 1.9159e+00, 1.9179e+00,
        1.9212e+00, 2.1086e+00, 3.8552e+05, 3.9030e+05, 3.9299e+05, 3.9410e+05,
        3.9642e+05, 4.0085e+05, 4.0346e+05, 4.1258e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7822e+00, 1.9005e+00, 1.9179e+00, 1.9401e+00, 1.9513e+00,
        2.1355e+00, 2.1804e+00, 3.8546e+05, 3.9031e+05, 3.9303e+05, 3.9412e+05,
        3.9635e+05, 4.0083e+05, 4.0349e+05, 4.1255e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7286e+00, 1.7856e+00, 1.8700e+00, 1.9005e+00, 1.9450e+00,
        1.9655e+00, 2.1617e+00, 3.8550e+05, 3.9031e+05, 3.9297e+05, 3.9415e+05,
        3.9634e+05, 4.0085e+05, 4.0349e+05, 4.1256e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7286e+00, 1.7822e+00, 1.9026e+00, 1.9212e+00, 1.9954e+00,
        2.0387e+00, 2.2490e+00, 3.8550e+05, 3.9031e+05, 3.9301e+05, 3.9412e+05,
        3.9640e+05, 4.0083e+05, 4.0347e+05, 4.1257e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385462.8438, 385470.5625, 385494.0000, 385498.4688,
        385502.5000, 385504.3750, 385515.6875, 385517.0938, 770787.8750,
        774316.0000, 775302.0000, 784785.5000, 787279.3750, 791102.0000,
        798068.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 2.1086e+00, 2.1617e+00, 2.1639e+00, 2.1804e+00, 2.2490e+00,
        2.3415e+00, 2.4119e+00, 3.8547e+05, 3.9031e+05, 3.9299e+05, 3.9415e+05,
        3.9636e+05, 4.0084e+05, 4.0345e+05, 4.1257e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394095.4375, 394119.1250, 394122.8125, 394123.0312,
        394139.5000, 394148.9375, 394154.4375, 394156.4375, 770787.8750,
        784132.4375, 789414.3125, 797605.2500, 800055.8750, 801771.5625,
        811457.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8752e+00, 1.9655e+00, 1.9954e+00, 2.0848e+00, 2.1355e+00,
        2.1780e+00, 2.3415e+00, 3.8549e+05, 3.9035e+05, 3.9297e+05, 3.9412e+05,
        3.9638e+05, 4.0085e+05, 4.0352e+05, 4.1258e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396306.4375, 396332.9375, 396338.5312, 396348.4062,
        396362.2188, 396379.2500, 396399.4062, 396415.8125, 789672.3750,
        791102.0000, 794914.4375, 797034.1250, 801771.5625, 805219.1250,
        818068.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392966.2812, 392968.8125, 392986.8750, 392990.3438,
        392994.8438, 393014.3125, 393023.5938, 393027.7188, 784785.5000,
        787530.1875, 794914.4375, 802601.8750, 811457.8125, 812502.9375,
        822761.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400827.2188, 400833.6562, 400836.1250, 400836.7812,
        400847.3125, 400848.8125, 400852.8750, 400857.4375, 774316.0000,
        783462.8125, 784132.4375, 794253.6250, 802601.8750, 818068.5625,
        823029.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390288.0938, 390296.5312, 390303.5938, 390305.0938,
        390305.5625, 390313.3750, 390314.0000, 390351.8750, 775302.0000,
        784450.7500, 787530.1875, 789672.3750, 794253.6250, 797605.2500,
        806849.3750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['480941.59', '487130.06', '116884.00', '116880.46', '116881.75', '116880.95', '116879.21', '116884.39', '462906.91', '116879.52', '470798.00', '116882.66', '475165.75', '471628.81', '476451.91', '468223.09']
estimated f for each client, fs: [5, 5, 8, 8, 8, 8, 8, 8, 6, 8, 5, 8, 5, 6, 5, 6]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 13, 6, 12, 4, 1, 10, 9, 18, 5, 17, 8, 15, 16, 19, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0140s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:06...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0031 seconds (Start: 2025-07-22 16:00:06, End: 2025-07-22 16:00:06)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 14, 6, 7, 9, 3, 13, 12, 11, 2, 10, 1, 8, 5, 17, 4], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.5100e+05, 3.7720e+05, 3.7723e+05, 3.7716e+05, 3.7717e+05,
         7.7307e+05, 3.7718e+05, 3.7720e+05, 3.7720e+05, 3.7721e+05, 3.7721e+05,
         3.7720e+05, 3.7721e+05, 7.6065e+05, 3.7723e+05],
        [7.5100e+05, 0.0000e+00, 3.7896e+05, 3.7893e+05, 3.7895e+05, 3.7894e+05,
         7.6448e+05, 3.7894e+05, 3.7895e+05, 3.7894e+05, 3.7898e+05, 3.7894e+05,
         3.7897e+05, 3.7893e+05, 7.6308e+05, 3.7898e+05],
        [3.7720e+05, 3.7896e+05, 0.0000e+00, 2.0215e+00, 1.7925e+00, 2.0830e+00,
         3.9285e+05, 1.8882e+00, 1.8239e+00, 1.8013e+00, 2.0706e+00, 1.9011e+00,
         2.0089e+00, 2.2688e+00, 3.7996e+05, 1.8039e+00],
        [3.7723e+05, 3.7893e+05, 2.0215e+00, 0.0000e+00, 1.9333e+00, 1.9825e+00,
         3.9281e+05, 1.9511e+00, 1.8653e+00, 1.8191e+00, 1.9528e+00, 1.8799e+00,
         1.9863e+00, 1.9947e+00, 3.7993e+05, 1.7782e+00],
        [3.7716e+05, 3.7895e+05, 1.7925e+00, 1.9333e+00, 0.0000e+00, 1.7921e+00,
         3.9283e+05, 1.8626e+00, 1.7274e+00, 1.8416e+00, 1.8459e+00, 1.6874e+00,
         1.8937e+00, 2.1934e+00, 3.7992e+05, 1.9324e+00],
        [3.7717e+05, 3.7894e+05, 2.0830e+00, 1.9825e+00, 1.7921e+00, 0.0000e+00,
         3.9284e+05, 1.7642e+00, 1.9099e+00, 1.8052e+00, 1.8344e+00, 1.9689e+00,
         1.8959e+00, 1.9300e+00, 3.7995e+05, 2.0006e+00],
        [7.7307e+05, 7.6448e+05, 3.9285e+05, 3.9281e+05, 3.9283e+05, 3.9284e+05,
         0.0000e+00, 3.9283e+05, 3.9284e+05, 3.9281e+05, 3.9284e+05, 3.9285e+05,
         3.9279e+05, 3.9283e+05, 7.7493e+05, 3.9284e+05],
        [3.7718e+05, 3.7894e+05, 1.8882e+00, 1.9511e+00, 1.8626e+00, 1.7642e+00,
         3.9283e+05, 0.0000e+00, 1.7789e+00, 1.7890e+00, 1.9165e+00, 1.8680e+00,
         1.9257e+00, 2.0382e+00, 3.7994e+05, 1.8046e+00],
        [3.7720e+05, 3.7895e+05, 1.8239e+00, 1.8653e+00, 1.7274e+00, 1.9099e+00,
         3.9284e+05, 1.7789e+00, 0.0000e+00, 1.8209e+00, 2.0069e+00, 1.8319e+00,
         1.7840e+00, 2.0574e+00, 3.7995e+05, 1.7017e+00],
        [3.7720e+05, 3.7894e+05, 1.8013e+00, 1.8191e+00, 1.8416e+00, 1.8052e+00,
         3.9281e+05, 1.7890e+00, 1.8209e+00, 0.0000e+00, 1.8278e+00, 1.8277e+00,
         2.0050e+00, 2.1595e+00, 3.7992e+05, 1.8679e+00],
        [3.7721e+05, 3.7898e+05, 2.0706e+00, 1.9528e+00, 1.8459e+00, 1.8344e+00,
         3.9284e+05, 1.9165e+00, 2.0069e+00, 1.8278e+00, 0.0000e+00, 1.9444e+00,
         2.0870e+00, 1.9590e+00, 3.7995e+05, 2.0333e+00],
        [3.7721e+05, 3.7894e+05, 1.9011e+00, 1.8799e+00, 1.6874e+00, 1.9689e+00,
         3.9285e+05, 1.8680e+00, 1.8319e+00, 1.8277e+00, 1.9444e+00, 0.0000e+00,
         2.0161e+00, 2.1047e+00, 3.7994e+05, 1.9035e+00],
        [3.7720e+05, 3.7897e+05, 2.0089e+00, 1.9863e+00, 1.8937e+00, 1.8959e+00,
         3.9279e+05, 1.9257e+00, 1.7840e+00, 2.0050e+00, 2.0870e+00, 2.0161e+00,
         0.0000e+00, 2.2529e+00, 3.7994e+05, 1.7782e+00],
        [3.7721e+05, 3.7893e+05, 2.2688e+00, 1.9947e+00, 2.1934e+00, 1.9300e+00,
         3.9283e+05, 2.0382e+00, 2.0574e+00, 2.1595e+00, 1.9590e+00, 2.1047e+00,
         2.2529e+00, 0.0000e+00, 3.7995e+05, 2.0328e+00],
        [7.6065e+05, 7.6308e+05, 3.7996e+05, 3.7993e+05, 3.7992e+05, 3.7995e+05,
         7.7493e+05, 3.7994e+05, 3.7995e+05, 3.7992e+05, 3.7995e+05, 3.7994e+05,
         3.7994e+05, 3.7995e+05, 0.0000e+00, 3.7997e+05],
        [3.7723e+05, 3.7898e+05, 1.8039e+00, 1.7782e+00, 1.9324e+00, 2.0006e+00,
         3.9284e+05, 1.8046e+00, 1.7017e+00, 1.8679e+00, 2.0333e+00, 1.9035e+00,
         1.7782e+00, 2.0328e+00, 3.7997e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 377158.5312, 377172.1875, 377178.0625, 377196.9375,
        377198.6875, 377202.6250, 377203.3125, 377209.1562, 377210.5938,
        377212.0000, 377228.5938, 377228.8750, 750998.5625, 760648.3125,
        773067.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 378925.5625, 378927.2500, 378939.0000, 378940.7500,
        378941.8125, 378944.2812, 378947.6562, 378952.6875, 378956.1250,
        378967.5938, 378979.0000, 378980.4688, 750998.5625, 763079.8125,
        764481.5000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.7925e+00, 1.8013e+00, 1.8039e+00, 1.8239e+00, 1.8882e+00,
        1.9011e+00, 2.0089e+00, 2.0215e+00, 2.0706e+00, 2.0830e+00, 2.2688e+00,
        3.7720e+05, 3.7896e+05, 3.7996e+05, 3.9285e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7782e+00, 1.8191e+00, 1.8653e+00, 1.8799e+00, 1.9333e+00,
        1.9511e+00, 1.9528e+00, 1.9825e+00, 1.9863e+00, 1.9947e+00, 2.0215e+00,
        3.7723e+05, 3.7893e+05, 3.7993e+05, 3.9281e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6874e+00, 1.7274e+00, 1.7921e+00, 1.7925e+00, 1.8416e+00,
        1.8459e+00, 1.8626e+00, 1.8937e+00, 1.9324e+00, 1.9333e+00, 2.1934e+00,
        3.7716e+05, 3.7895e+05, 3.7992e+05, 3.9283e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7642e+00, 1.7921e+00, 1.8052e+00, 1.8344e+00, 1.8959e+00,
        1.9099e+00, 1.9300e+00, 1.9689e+00, 1.9825e+00, 2.0006e+00, 2.0830e+00,
        3.7717e+05, 3.7894e+05, 3.7995e+05, 3.9284e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392793.6250, 392809.1562, 392814.3750, 392827.5000,
        392830.1875, 392834.7500, 392838.0938, 392838.8750, 392839.2500,
        392842.7500, 392846.9375, 392852.7188, 764481.5000, 773067.8750,
        774927.8125])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.7642e+00, 1.7789e+00, 1.7890e+00, 1.8046e+00, 1.8626e+00,
        1.8680e+00, 1.8882e+00, 1.9165e+00, 1.9257e+00, 1.9511e+00, 2.0382e+00,
        3.7718e+05, 3.7894e+05, 3.7994e+05, 3.9283e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7017e+00, 1.7274e+00, 1.7789e+00, 1.7840e+00, 1.8209e+00,
        1.8239e+00, 1.8319e+00, 1.8653e+00, 1.9099e+00, 2.0069e+00, 2.0574e+00,
        3.7720e+05, 3.7895e+05, 3.7995e+05, 3.9284e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7890e+00, 1.8013e+00, 1.8052e+00, 1.8191e+00, 1.8209e+00,
        1.8277e+00, 1.8278e+00, 1.8416e+00, 1.8679e+00, 2.0050e+00, 2.1595e+00,
        3.7720e+05, 3.7894e+05, 3.7992e+05, 3.9281e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8278e+00, 1.8344e+00, 1.8459e+00, 1.9165e+00, 1.9444e+00,
        1.9528e+00, 1.9590e+00, 2.0069e+00, 2.0333e+00, 2.0706e+00, 2.0870e+00,
        3.7721e+05, 3.7898e+05, 3.7995e+05, 3.9284e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6874e+00, 1.8277e+00, 1.8319e+00, 1.8680e+00, 1.8799e+00,
        1.9011e+00, 1.9035e+00, 1.9444e+00, 1.9689e+00, 2.0161e+00, 2.1047e+00,
        3.7721e+05, 3.7894e+05, 3.7994e+05, 3.9285e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7782e+00, 1.7840e+00, 1.8937e+00, 1.8959e+00, 1.9257e+00,
        1.9863e+00, 2.0050e+00, 2.0089e+00, 2.0161e+00, 2.0870e+00, 2.2529e+00,
        3.7720e+05, 3.7897e+05, 3.7994e+05, 3.9279e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.9300e+00, 1.9590e+00, 1.9947e+00, 2.0328e+00, 2.0382e+00,
        2.0574e+00, 2.1047e+00, 2.1595e+00, 2.1934e+00, 2.2529e+00, 2.2688e+00,
        3.7721e+05, 3.7893e+05, 3.7995e+05, 3.9283e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379918.1562, 379919.1562, 379933.4062, 379940.2812,
        379940.7500, 379942.5625, 379947.3750, 379951.0938, 379952.7188,
        379952.7188, 379960.4375, 379971.9688, 760648.3125, 763079.8125,
        774927.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7017e+00, 1.7782e+00, 1.7782e+00, 1.8039e+00, 1.8046e+00,
        1.8679e+00, 1.9035e+00, 1.9324e+00, 2.0006e+00, 2.0328e+00, 2.0333e+00,
        3.7723e+05, 3.7898e+05, 3.7997e+05, 3.9284e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['377199.97', '378950.16', '1.92', '1.91', '1.83', '1.89', '392830.72', '1.85', '1.83', '1.84', '1.94', '1.88', '1.94', '2.07', '379939.81', '1.86']
estimated f for each client, fs: [2, 2, 5, 5, 5, 5, 2, 5, 5, 5, 5, 5, 5, 5, 5, 5]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 14, 6, 7, 9, 3, 13, 12, 11, 2, 10, 1, 8, 5, 17, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0146s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:10...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:10, End: 2025-07-22 16:00:10)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 7, 18, 17, 6, 10, 3, 1, 19, 4, 9, 8, 16, 14, 12, 13], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0253e+05, 8.0323e+05, 8.3400e+05, 4.0257e+05, 4.0253e+05,
         4.0253e+05, 4.0255e+05, 8.3816e+05, 4.0254e+05, 4.0257e+05, 4.0258e+05,
         7.9320e+05, 7.9783e+05, 4.0255e+05, 7.6545e+05],
        [4.0253e+05, 0.0000e+00, 3.9599e+05, 4.0039e+05, 2.0964e+00, 2.0125e+00,
         1.9674e+00, 1.9778e+00, 4.1263e+05, 1.7817e+00, 1.9130e+00, 2.0055e+00,
         3.9075e+05, 3.9488e+05, 1.9492e+00, 3.7969e+05],
        [8.0323e+05, 3.9599e+05, 0.0000e+00, 8.0599e+05, 3.9599e+05, 3.9599e+05,
         3.9597e+05, 3.9600e+05, 8.0750e+05, 3.9600e+05, 3.9602e+05, 3.9598e+05,
         7.9570e+05, 8.0881e+05, 3.9599e+05, 7.7505e+05],
        [8.3400e+05, 4.0039e+05, 8.0599e+05, 0.0000e+00, 4.0034e+05, 4.0036e+05,
         4.0039e+05, 4.0037e+05, 8.2883e+05, 4.0038e+05, 4.0038e+05, 4.0042e+05,
         7.8549e+05, 7.7551e+05, 4.0037e+05, 7.9786e+05],
        [4.0257e+05, 2.0964e+00, 3.9599e+05, 4.0034e+05, 0.0000e+00, 1.9533e+00,
         2.0447e+00, 1.9001e+00, 4.1265e+05, 1.7864e+00, 1.8048e+00, 2.0308e+00,
         3.9075e+05, 3.9490e+05, 1.9169e+00, 3.7967e+05],
        [4.0253e+05, 2.0125e+00, 3.9599e+05, 4.0036e+05, 1.9533e+00, 0.0000e+00,
         1.9038e+00, 1.9236e+00, 4.1262e+05, 1.9096e+00, 1.8399e+00, 2.0425e+00,
         3.9075e+05, 3.9491e+05, 1.8609e+00, 3.7971e+05],
        [4.0253e+05, 1.9674e+00, 3.9597e+05, 4.0039e+05, 2.0447e+00, 1.9038e+00,
         0.0000e+00, 2.0426e+00, 4.1263e+05, 1.9601e+00, 1.8190e+00, 1.9869e+00,
         3.9076e+05, 3.9492e+05, 1.7954e+00, 3.7974e+05],
        [4.0255e+05, 1.9778e+00, 3.9600e+05, 4.0037e+05, 1.9001e+00, 1.9236e+00,
         2.0426e+00, 0.0000e+00, 4.1263e+05, 1.9196e+00, 1.7582e+00, 2.1443e+00,
         3.9073e+05, 3.9490e+05, 1.9318e+00, 3.7969e+05],
        [8.3816e+05, 4.1263e+05, 8.0750e+05, 8.2883e+05, 4.1265e+05, 4.1262e+05,
         4.1263e+05, 4.1263e+05, 0.0000e+00, 4.1263e+05, 4.1261e+05, 4.1261e+05,
         8.3140e+05, 7.8821e+05, 4.1262e+05, 7.9779e+05],
        [4.0254e+05, 1.7817e+00, 3.9600e+05, 4.0038e+05, 1.7864e+00, 1.9096e+00,
         1.9601e+00, 1.9196e+00, 4.1263e+05, 0.0000e+00, 1.8587e+00, 1.8284e+00,
         3.9077e+05, 3.9493e+05, 1.7660e+00, 3.7968e+05],
        [4.0257e+05, 1.9130e+00, 3.9602e+05, 4.0038e+05, 1.8048e+00, 1.8399e+00,
         1.8190e+00, 1.7582e+00, 4.1261e+05, 1.8587e+00, 0.0000e+00, 1.9648e+00,
         3.9078e+05, 3.9489e+05, 1.8754e+00, 3.7968e+05],
        [4.0258e+05, 2.0055e+00, 3.9598e+05, 4.0042e+05, 2.0308e+00, 2.0425e+00,
         1.9869e+00, 2.1443e+00, 4.1261e+05, 1.8284e+00, 1.9648e+00, 0.0000e+00,
         3.9079e+05, 3.9490e+05, 1.9443e+00, 3.7971e+05],
        [7.9320e+05, 3.9075e+05, 7.9570e+05, 7.8549e+05, 3.9075e+05, 3.9075e+05,
         3.9076e+05, 3.9073e+05, 8.3140e+05, 3.9077e+05, 3.9078e+05, 3.9079e+05,
         0.0000e+00, 7.8663e+05, 3.9076e+05, 7.7969e+05],
        [7.9783e+05, 3.9488e+05, 8.0881e+05, 7.7551e+05, 3.9490e+05, 3.9491e+05,
         3.9492e+05, 3.9490e+05, 7.8821e+05, 3.9493e+05, 3.9489e+05, 3.9490e+05,
         7.8663e+05, 0.0000e+00, 3.9489e+05, 7.6093e+05],
        [4.0255e+05, 1.9492e+00, 3.9599e+05, 4.0037e+05, 1.9169e+00, 1.8609e+00,
         1.7954e+00, 1.9318e+00, 4.1262e+05, 1.7660e+00, 1.8754e+00, 1.9443e+00,
         3.9076e+05, 3.9489e+05, 0.0000e+00, 3.7967e+05],
        [7.6545e+05, 3.7969e+05, 7.7505e+05, 7.9786e+05, 3.7967e+05, 3.7971e+05,
         3.7974e+05, 3.7969e+05, 7.9779e+05, 3.7968e+05, 3.7968e+05, 3.7971e+05,
         7.7969e+05, 7.6093e+05, 3.7967e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 402532.8125, 402534.2500, 402534.6875, 402540.5938,
        402547.6250, 402552.7500, 402569.4375, 402569.5000, 402579.2188,
        765446.8750, 793196.8750, 797833.8750, 803234.9375, 834003.7500,
        838164.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7817e+00, 1.9130e+00, 1.9492e+00, 1.9674e+00, 1.9778e+00,
        2.0055e+00, 2.0125e+00, 2.0964e+00, 3.7969e+05, 3.9075e+05, 3.9488e+05,
        3.9599e+05, 4.0039e+05, 4.0253e+05, 4.1263e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395966.5938, 395977.0625, 395985.8750, 395993.4375,
        395993.6875, 395994.3750, 396003.1875, 396004.0312, 396016.7812,
        775047.7500, 795704.7500, 803234.9375, 805987.1250, 807496.7500,
        808805.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400344.3125, 400358.0938, 400368.7812, 400373.5312,
        400375.5625, 400383.6875, 400386.8750, 400390.0625, 400417.1562,
        775507.6250, 785493.5000, 797857.7500, 805987.1250, 828827.0625,
        834003.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7864e+00, 1.8048e+00, 1.9001e+00, 1.9169e+00, 1.9533e+00,
        2.0308e+00, 2.0447e+00, 2.0964e+00, 3.7967e+05, 3.9075e+05, 3.9490e+05,
        3.9599e+05, 4.0034e+05, 4.0257e+05, 4.1265e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8399e+00, 1.8609e+00, 1.9038e+00, 1.9096e+00, 1.9236e+00,
        1.9533e+00, 2.0125e+00, 2.0425e+00, 3.7971e+05, 3.9075e+05, 3.9491e+05,
        3.9599e+05, 4.0036e+05, 4.0253e+05, 4.1262e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7954e+00, 1.8190e+00, 1.9038e+00, 1.9601e+00, 1.9674e+00,
        1.9869e+00, 2.0426e+00, 2.0447e+00, 3.7974e+05, 3.9076e+05, 3.9492e+05,
        3.9597e+05, 4.0039e+05, 4.0253e+05, 4.1263e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7582e+00, 1.9001e+00, 1.9196e+00, 1.9236e+00, 1.9318e+00,
        1.9778e+00, 2.0426e+00, 2.1443e+00, 3.7969e+05, 3.9073e+05, 3.9490e+05,
        3.9600e+05, 4.0037e+05, 4.0255e+05, 4.1263e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 412609.6250, 412611.3125, 412616.2500, 412624.0312,
        412625.0938, 412628.3125, 412632.0625, 412634.9688, 412646.1875,
        788214.0000, 797788.8125, 807496.7500, 828827.0625, 831402.2500,
        838164.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7660e+00, 1.7817e+00, 1.7864e+00, 1.8284e+00, 1.8587e+00,
        1.9096e+00, 1.9196e+00, 1.9601e+00, 3.7968e+05, 3.9077e+05, 3.9493e+05,
        3.9600e+05, 4.0038e+05, 4.0254e+05, 4.1263e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7582e+00, 1.8048e+00, 1.8190e+00, 1.8399e+00, 1.8587e+00,
        1.8754e+00, 1.9130e+00, 1.9648e+00, 3.7968e+05, 3.9078e+05, 3.9489e+05,
        3.9602e+05, 4.0038e+05, 4.0257e+05, 4.1261e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8284e+00, 1.9443e+00, 1.9648e+00, 1.9869e+00, 2.0055e+00,
        2.0308e+00, 2.0425e+00, 2.1443e+00, 3.7971e+05, 3.9079e+05, 3.9490e+05,
        3.9598e+05, 4.0042e+05, 4.0258e+05, 4.1261e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390727.0938, 390745.9375, 390749.4062, 390752.3750,
        390758.4688, 390764.2188, 390766.8438, 390775.7500, 390785.0312,
        779694.9375, 785493.5000, 786626.1875, 793196.8750, 795704.7500,
        831402.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394875.5000, 394888.7500, 394893.4688, 394902.2500,
        394902.7500, 394903.0000, 394905.7812, 394921.9062, 394934.0625,
        760932.7500, 775507.6250, 786626.1875, 788214.0000, 797833.8750,
        808805.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7660e+00, 1.7954e+00, 1.8609e+00, 1.8754e+00, 1.9169e+00,
        1.9318e+00, 1.9443e+00, 1.9492e+00, 3.7967e+05, 3.9076e+05, 3.9489e+05,
        3.9599e+05, 4.0037e+05, 4.0255e+05, 4.1262e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379668.4062, 379670.7812, 379675.5000, 379680.3438,
        379687.9375, 379690.5938, 379711.3750, 379712.7812, 379737.0625,
        760932.7500, 765446.8750, 775047.7500, 779694.9375, 797788.8125,
        797857.7500])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['438840.81', '77045.58', '433898.31', '437890.56', '77042.99', '77047.92', '77051.67', '77043.06', '450184.16', '77046.20', '77046.61', '77051.37', '429652.00', '431506.00', '77044.43', '417816.72']
estimated f for each client, fs: [5, 7, 5, 5, 7, 7, 7, 7, 5, 7, 7, 7, 5, 5, 7, 6]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 7, 18, 17, 6, 10, 3, 1, 19, 4, 9, 8, 16, 14, 12, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0305s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:11...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:11, End: 2025-07-22 16:00:11)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 20, 18, 2, 7, 1, 12, 13, 3, 9, 15, 5, 19, 14, 10, 4], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.9588e+05, 7.5716e+05, 3.9227e+05, 3.9228e+05, 3.9226e+05,
         3.9226e+05, 7.6216e+05, 3.9226e+05, 3.9232e+05, 7.7371e+05, 3.9226e+05,
         7.9265e+05, 7.7915e+05, 3.9227e+05, 3.9225e+05],
        [7.9588e+05, 0.0000e+00, 7.8009e+05, 3.9752e+05, 3.9760e+05, 3.9751e+05,
         3.9748e+05, 7.8060e+05, 3.9749e+05, 3.9755e+05, 8.0346e+05, 3.9750e+05,
         8.1189e+05, 7.7385e+05, 3.9750e+05, 3.9752e+05],
        [7.5716e+05, 7.8009e+05, 0.0000e+00, 3.8315e+05, 3.8317e+05, 3.8315e+05,
         3.8314e+05, 7.7297e+05, 3.8319e+05, 3.8313e+05, 7.6145e+05, 3.8311e+05,
         7.9398e+05, 7.6745e+05, 3.8315e+05, 3.8311e+05],
        [3.9227e+05, 3.9752e+05, 3.8315e+05, 0.0000e+00, 1.7128e+00, 1.8685e+00,
         1.7941e+00, 3.8267e+05, 1.8732e+00, 1.7836e+00, 3.8023e+05, 2.1766e+00,
         4.0725e+05, 3.9090e+05, 1.7777e+00, 1.7839e+00],
        [3.9228e+05, 3.9760e+05, 3.8317e+05, 1.7128e+00, 0.0000e+00, 1.9456e+00,
         1.9019e+00, 3.8260e+05, 1.9559e+00, 1.8794e+00, 3.8024e+05, 2.0110e+00,
         4.0727e+05, 3.9092e+05, 1.8802e+00, 1.8069e+00],
        [3.9226e+05, 3.9751e+05, 3.8315e+05, 1.8685e+00, 1.9456e+00, 0.0000e+00,
         1.9299e+00, 3.8263e+05, 1.9855e+00, 1.7241e+00, 3.8023e+05, 2.1184e+00,
         4.0724e+05, 3.9090e+05, 1.9280e+00, 1.8806e+00],
        [3.9226e+05, 3.9748e+05, 3.8314e+05, 1.7941e+00, 1.9019e+00, 1.9299e+00,
         0.0000e+00, 3.8262e+05, 1.8043e+00, 1.9742e+00, 3.8024e+05, 2.0905e+00,
         4.0724e+05, 3.9090e+05, 1.8630e+00, 1.7365e+00],
        [7.6216e+05, 7.8060e+05, 7.7297e+05, 3.8267e+05, 3.8260e+05, 3.8263e+05,
         3.8262e+05, 0.0000e+00, 3.8266e+05, 3.8265e+05, 7.4676e+05, 3.8266e+05,
         7.9380e+05, 7.7806e+05, 3.8268e+05, 3.8263e+05],
        [3.9226e+05, 3.9749e+05, 3.8319e+05, 1.8732e+00, 1.9559e+00, 1.9855e+00,
         1.8043e+00, 3.8266e+05, 0.0000e+00, 1.8155e+00, 3.8028e+05, 1.9950e+00,
         4.0722e+05, 3.9086e+05, 1.8741e+00, 1.9655e+00],
        [3.9232e+05, 3.9755e+05, 3.8313e+05, 1.7836e+00, 1.8794e+00, 1.7241e+00,
         1.9742e+00, 3.8265e+05, 1.8155e+00, 0.0000e+00, 3.8024e+05, 2.1852e+00,
         4.0723e+05, 3.9086e+05, 1.8109e+00, 1.8337e+00],
        [7.7371e+05, 8.0346e+05, 7.6145e+05, 3.8023e+05, 3.8024e+05, 3.8023e+05,
         3.8024e+05, 7.4676e+05, 3.8028e+05, 3.8024e+05, 0.0000e+00, 3.8024e+05,
         8.0000e+05, 7.7666e+05, 3.8023e+05, 3.8022e+05],
        [3.9226e+05, 3.9750e+05, 3.8311e+05, 2.1766e+00, 2.0110e+00, 2.1184e+00,
         2.0905e+00, 3.8266e+05, 1.9950e+00, 2.1852e+00, 3.8024e+05, 0.0000e+00,
         4.0728e+05, 3.9087e+05, 1.9299e+00, 2.0833e+00],
        [7.9265e+05, 8.1189e+05, 7.9398e+05, 4.0725e+05, 4.0727e+05, 4.0724e+05,
         4.0724e+05, 7.9380e+05, 4.0722e+05, 4.0723e+05, 8.0000e+05, 4.0728e+05,
         0.0000e+00, 7.7433e+05, 4.0724e+05, 4.0725e+05],
        [7.7915e+05, 7.7385e+05, 7.6745e+05, 3.9090e+05, 3.9092e+05, 3.9090e+05,
         3.9090e+05, 7.7806e+05, 3.9086e+05, 3.9086e+05, 7.7666e+05, 3.9087e+05,
         7.7433e+05, 0.0000e+00, 3.9085e+05, 3.9090e+05],
        [3.9227e+05, 3.9750e+05, 3.8315e+05, 1.7777e+00, 1.8802e+00, 1.9280e+00,
         1.8630e+00, 3.8268e+05, 1.8741e+00, 1.8109e+00, 3.8023e+05, 1.9299e+00,
         4.0724e+05, 3.9085e+05, 0.0000e+00, 1.9059e+00],
        [3.9225e+05, 3.9752e+05, 3.8311e+05, 1.7839e+00, 1.8069e+00, 1.8806e+00,
         1.7365e+00, 3.8263e+05, 1.9655e+00, 1.8337e+00, 3.8022e+05, 2.0833e+00,
         4.0725e+05, 3.9090e+05, 1.9059e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 392254.9062, 392255.4688, 392256.0312, 392256.4375,
        392260.3125, 392268.4062, 392271.5000, 392280.2500, 392319.7500,
        757158.8750, 762155.0625, 773706.4375, 779150.5625, 792646.0625,
        795875.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397479.3125, 397485.3750, 397503.4375, 397503.8750,
        397508.2188, 397520.5625, 397520.9688, 397545.8125, 397595.2500,
        773854.8750, 780091.8750, 780599.6250, 795875.5625, 803459.3750,
        811886.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383107.6250, 383114.3750, 383134.0625, 383144.2812,
        383147.2188, 383149.7500, 383152.6562, 383165.1875, 383188.4375,
        757158.8750, 761454.2500, 767447.8750, 772967.5000, 780091.8750,
        793983.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7128e+00, 1.7777e+00, 1.7836e+00, 1.7839e+00, 1.7941e+00,
        1.8685e+00, 1.8732e+00, 2.1766e+00, 3.8023e+05, 3.8267e+05, 3.8315e+05,
        3.9090e+05, 3.9227e+05, 3.9752e+05, 4.0725e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7128e+00, 1.8069e+00, 1.8794e+00, 1.8802e+00, 1.9019e+00,
        1.9456e+00, 1.9559e+00, 2.0110e+00, 3.8024e+05, 3.8260e+05, 3.8317e+05,
        3.9092e+05, 3.9228e+05, 3.9760e+05, 4.0727e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7241e+00, 1.8685e+00, 1.8806e+00, 1.9280e+00, 1.9299e+00,
        1.9456e+00, 1.9855e+00, 2.1184e+00, 3.8023e+05, 3.8263e+05, 3.8315e+05,
        3.9090e+05, 3.9226e+05, 3.9751e+05, 4.0724e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7365e+00, 1.7941e+00, 1.8043e+00, 1.8630e+00, 1.9019e+00,
        1.9299e+00, 1.9742e+00, 2.0905e+00, 3.8024e+05, 3.8262e+05, 3.8314e+05,
        3.9090e+05, 3.9226e+05, 3.9748e+05, 4.0724e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382598.9375, 382621.5000, 382628.8750, 382628.8750,
        382646.5312, 382655.9062, 382656.7188, 382673.5000, 382680.3438,
        746761.1250, 762155.0625, 772967.5000, 778057.1250, 780599.6250,
        793802.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8043e+00, 1.8155e+00, 1.8732e+00, 1.8741e+00, 1.9559e+00,
        1.9655e+00, 1.9855e+00, 1.9950e+00, 3.8028e+05, 3.8266e+05, 3.8319e+05,
        3.9086e+05, 3.9226e+05, 3.9749e+05, 4.0722e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7241e+00, 1.7836e+00, 1.8109e+00, 1.8155e+00, 1.8337e+00,
        1.8794e+00, 1.9742e+00, 2.1852e+00, 3.8024e+05, 3.8265e+05, 3.8313e+05,
        3.9086e+05, 3.9232e+05, 3.9755e+05, 4.0723e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380217.7812, 380225.0938, 380225.1562, 380227.2500,
        380238.5312, 380239.5000, 380243.9375, 380244.6562, 380275.8750,
        746761.1250, 761454.2500, 773706.4375, 776661.6250, 799995.0625,
        803459.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.9299e+00, 1.9950e+00, 2.0110e+00, 2.0833e+00, 2.0905e+00,
        2.1184e+00, 2.1766e+00, 2.1852e+00, 3.8024e+05, 3.8266e+05, 3.8311e+05,
        3.9087e+05, 3.9226e+05, 3.9750e+05, 4.0728e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 407216.6250, 407232.5000, 407236.9062, 407239.5625,
        407244.5000, 407246.4688, 407247.6875, 407265.0625, 407275.6562,
        774333.6875, 792646.0625, 793802.7500, 793983.0000, 799995.0625,
        811886.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390845.7188, 390857.7188, 390861.4062, 390865.9688,
        390895.4375, 390895.6875, 390899.1562, 390903.7500, 390922.9688,
        767447.8750, 773854.8750, 774333.6875, 776661.6250, 778057.1250,
        779150.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7777e+00, 1.8109e+00, 1.8630e+00, 1.8741e+00, 1.8802e+00,
        1.9059e+00, 1.9280e+00, 1.9299e+00, 3.8023e+05, 3.8268e+05, 3.8315e+05,
        3.9085e+05, 3.9227e+05, 3.9750e+05, 4.0724e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7365e+00, 1.7839e+00, 1.8069e+00, 1.8337e+00, 1.8806e+00,
        1.9059e+00, 1.9655e+00, 2.0833e+00, 3.8022e+05, 3.8263e+05, 3.8311e+05,
        3.9090e+05, 3.9225e+05, 3.9752e+05, 4.0725e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['428758.19', '435151.75', '420546.25', '76291.34', '76285.25', '76287.16', '76287.61', '419055.28', '76294.79', '76290.62', '416889.91', '76291.64', '443953.91', '428539.59', '76292.05', '76286.16']
estimated f for each client, fs: [5, 5, 5, 7, 7, 7, 7, 5, 7, 7, 5, 7, 5, 5, 7, 7]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 20, 18, 2, 7, 1, 12, 13, 3, 9, 15, 5, 19, 14, 10, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0122s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:11...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:11, End: 2025-07-22 16:00:11)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 4, 9, 16, 15, 5, 20, 19, 12, 2, 7, 18, 11, 10, 6, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.7430e+00, 1.9691e+00, 3.8583e+05, 3.8632e+05, 2.2680e+00,
         3.7783e+05, 3.8313e+05, 1.9655e+00, 2.0316e+00, 2.1971e+00, 3.7703e+05,
         2.0366e+00, 1.9126e+00, 2.0013e+00, 3.9039e+05],
        [1.7430e+00, 0.0000e+00, 1.8655e+00, 3.8578e+05, 3.8629e+05, 2.0012e+00,
         3.7782e+05, 3.8317e+05, 1.7876e+00, 1.8201e+00, 1.8933e+00, 3.7708e+05,
         1.8590e+00, 1.8748e+00, 1.8062e+00, 3.9037e+05],
        [1.9691e+00, 1.8655e+00, 0.0000e+00, 3.8581e+05, 3.8629e+05, 2.2109e+00,
         3.7784e+05, 3.8314e+05, 1.9259e+00, 1.8745e+00, 1.9824e+00, 3.7705e+05,
         1.8195e+00, 1.8451e+00, 1.7348e+00, 3.9035e+05],
        [3.8583e+05, 3.8578e+05, 3.8581e+05, 0.0000e+00, 7.8387e+05, 3.8577e+05,
         7.6286e+05, 7.7354e+05, 3.8580e+05, 3.8579e+05, 3.8578e+05, 7.7264e+05,
         3.8579e+05, 3.8578e+05, 3.8583e+05, 7.8916e+05],
        [3.8632e+05, 3.8629e+05, 3.8629e+05, 7.8387e+05, 0.0000e+00, 3.8628e+05,
         7.6262e+05, 7.7430e+05, 3.8629e+05, 3.8624e+05, 3.8627e+05, 7.6014e+05,
         3.8631e+05, 3.8627e+05, 3.8629e+05, 7.7281e+05],
        [2.2680e+00, 2.0012e+00, 2.2109e+00, 3.8577e+05, 3.8628e+05, 0.0000e+00,
         3.7778e+05, 3.8315e+05, 2.0259e+00, 2.1475e+00, 2.0209e+00, 3.7708e+05,
         1.8539e+00, 1.9020e+00, 2.0341e+00, 3.9037e+05],
        [3.7783e+05, 3.7782e+05, 3.7784e+05, 7.6286e+05, 7.6262e+05, 3.7778e+05,
         0.0000e+00, 7.4130e+05, 3.7783e+05, 3.7784e+05, 3.7781e+05, 7.5879e+05,
         3.7783e+05, 3.7778e+05, 3.7782e+05, 7.7188e+05],
        [3.8313e+05, 3.8317e+05, 3.8314e+05, 7.7354e+05, 7.7430e+05, 3.8315e+05,
         7.4130e+05, 0.0000e+00, 3.8314e+05, 3.8318e+05, 3.8316e+05, 7.5857e+05,
         3.8317e+05, 3.8318e+05, 3.8312e+05, 7.7020e+05],
        [1.9655e+00, 1.7876e+00, 1.9259e+00, 3.8580e+05, 3.8629e+05, 2.0259e+00,
         3.7783e+05, 3.8314e+05, 0.0000e+00, 1.8141e+00, 2.0900e+00, 3.7704e+05,
         1.8845e+00, 1.8225e+00, 1.8685e+00, 3.9040e+05],
        [2.0316e+00, 1.8201e+00, 1.8745e+00, 3.8579e+05, 3.8624e+05, 2.1475e+00,
         3.7784e+05, 3.8318e+05, 1.8141e+00, 0.0000e+00, 1.9105e+00, 3.7705e+05,
         1.9895e+00, 1.7711e+00, 1.7521e+00, 3.9040e+05],
        [2.1971e+00, 1.8933e+00, 1.9824e+00, 3.8578e+05, 3.8627e+05, 2.0209e+00,
         3.7781e+05, 3.8316e+05, 2.0900e+00, 1.9105e+00, 0.0000e+00, 3.7706e+05,
         2.0914e+00, 1.8600e+00, 2.0715e+00, 3.9041e+05],
        [3.7703e+05, 3.7708e+05, 3.7705e+05, 7.7264e+05, 7.6014e+05, 3.7708e+05,
         7.5879e+05, 7.5857e+05, 3.7704e+05, 3.7705e+05, 3.7706e+05, 0.0000e+00,
         3.7706e+05, 3.7708e+05, 3.7703e+05, 7.6930e+05],
        [2.0366e+00, 1.8590e+00, 1.8195e+00, 3.8579e+05, 3.8631e+05, 1.8539e+00,
         3.7783e+05, 3.8317e+05, 1.8845e+00, 1.9895e+00, 2.0914e+00, 3.7706e+05,
         0.0000e+00, 1.8578e+00, 1.8683e+00, 3.9041e+05],
        [1.9126e+00, 1.8748e+00, 1.8451e+00, 3.8578e+05, 3.8627e+05, 1.9020e+00,
         3.7778e+05, 3.8318e+05, 1.8225e+00, 1.7711e+00, 1.8600e+00, 3.7708e+05,
         1.8578e+00, 0.0000e+00, 1.8274e+00, 3.9038e+05],
        [2.0013e+00, 1.8062e+00, 1.7348e+00, 3.8583e+05, 3.8629e+05, 2.0341e+00,
         3.7782e+05, 3.8312e+05, 1.8685e+00, 1.7521e+00, 2.0715e+00, 3.7703e+05,
         1.8683e+00, 1.8274e+00, 0.0000e+00, 3.9040e+05],
        [3.9039e+05, 3.9037e+05, 3.9035e+05, 7.8916e+05, 7.7281e+05, 3.9037e+05,
         7.7188e+05, 7.7020e+05, 3.9040e+05, 3.9040e+05, 3.9041e+05, 7.6930e+05,
         3.9041e+05, 3.9038e+05, 3.9040e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7430e+00, 1.9126e+00, 1.9655e+00, 1.9691e+00, 2.0013e+00,
        2.0316e+00, 2.0366e+00, 2.1971e+00, 2.2680e+00, 3.7703e+05, 3.7783e+05,
        3.8313e+05, 3.8583e+05, 3.8632e+05, 3.9039e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7430e+00, 1.7876e+00, 1.8062e+00, 1.8201e+00, 1.8590e+00,
        1.8655e+00, 1.8748e+00, 1.8933e+00, 2.0012e+00, 3.7708e+05, 3.7782e+05,
        3.8317e+05, 3.8578e+05, 3.8629e+05, 3.9037e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7348e+00, 1.8195e+00, 1.8451e+00, 1.8655e+00, 1.8745e+00,
        1.9259e+00, 1.9691e+00, 1.9824e+00, 2.2109e+00, 3.7705e+05, 3.7784e+05,
        3.8314e+05, 3.8581e+05, 3.8629e+05, 3.9035e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385766.9688, 385781.2812, 385782.1875, 385784.9062,
        385785.6250, 385785.6875, 385795.3750, 385812.2812, 385825.3750,
        385834.8750, 762863.3750, 772636.5000, 773543.5625, 783871.0625,
        789157.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386235.7188, 386267.0000, 386273.3125, 386276.7500,
        386286.4688, 386290.0938, 386292.0625, 386293.2500, 386307.9688,
        386319.1562, 760140.5000, 762622.6250, 772812.2500, 774295.0625,
        783871.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8539e+00, 1.9020e+00, 2.0012e+00, 2.0209e+00, 2.0259e+00,
        2.0341e+00, 2.1475e+00, 2.2109e+00, 2.2680e+00, 3.7708e+05, 3.7778e+05,
        3.8315e+05, 3.8577e+05, 3.8628e+05, 3.9037e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377783.3438, 377784.0000, 377805.6875, 377818.6875,
        377823.4688, 377827.3438, 377827.5000, 377832.4688, 377836.1250,
        377838.6875, 741301.6875, 758790.1250, 762622.6250, 762863.3750,
        771877.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383123.3125, 383133.0312, 383137.2500, 383144.2500,
        383153.5000, 383159.2188, 383169.4062, 383173.9062, 383176.0625,
        383183.2812, 741301.6875, 758569.6875, 770195.0625, 773543.5625,
        774295.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7876e+00, 1.8141e+00, 1.8225e+00, 1.8685e+00, 1.8845e+00,
        1.9259e+00, 1.9655e+00, 2.0259e+00, 2.0900e+00, 3.7704e+05, 3.7783e+05,
        3.8314e+05, 3.8580e+05, 3.8629e+05, 3.9040e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7521e+00, 1.7711e+00, 1.8141e+00, 1.8201e+00, 1.8745e+00,
        1.9105e+00, 1.9895e+00, 2.0316e+00, 2.1475e+00, 3.7705e+05, 3.7784e+05,
        3.8318e+05, 3.8579e+05, 3.8624e+05, 3.9040e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8600e+00, 1.8933e+00, 1.9105e+00, 1.9824e+00, 2.0209e+00,
        2.0715e+00, 2.0900e+00, 2.0914e+00, 2.1971e+00, 3.7706e+05, 3.7781e+05,
        3.8316e+05, 3.8578e+05, 3.8627e+05, 3.9041e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377031.7500, 377032.0625, 377040.6250, 377051.7188,
        377054.5312, 377055.9062, 377064.0000, 377077.4375, 377079.8125,
        377082.9062, 758569.6875, 758790.1250, 760140.5000, 769304.9375,
        772636.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8195e+00, 1.8539e+00, 1.8578e+00, 1.8590e+00, 1.8683e+00,
        1.8845e+00, 1.9895e+00, 2.0366e+00, 2.0914e+00, 3.7706e+05, 3.7783e+05,
        3.8317e+05, 3.8579e+05, 3.8631e+05, 3.9041e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7711e+00, 1.8225e+00, 1.8274e+00, 1.8451e+00, 1.8578e+00,
        1.8600e+00, 1.8748e+00, 1.9020e+00, 1.9126e+00, 3.7708e+05, 3.7778e+05,
        3.8318e+05, 3.8578e+05, 3.8627e+05, 3.9038e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7348e+00, 1.7521e+00, 1.8062e+00, 1.8274e+00, 1.8683e+00,
        1.8685e+00, 2.0013e+00, 2.0341e+00, 2.0715e+00, 3.7703e+05, 3.7782e+05,
        3.8312e+05, 3.8583e+05, 3.8629e+05, 3.9040e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390353.5000, 390367.3438, 390373.1250, 390384.1250,
        390386.7812, 390395.7188, 390396.7812, 390399.1250, 390406.6562,
        390407.7812, 769304.9375, 770195.0625, 771877.1250, 772812.2500,
        789157.6250])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37705.02', '37709.96', '37707.18', '385795.47', '386284.19', '37709.59', '377817.72', '383155.34', '37705.78', '37706.88', '37708.21', '377057.06', '37707.31', '37709.65', '37704.87', '390387.09']
estimated f for each client, fs: [6, 6, 6, 4, 4, 6, 4, 4, 6, 6, 6, 5, 6, 6, 6, 4]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [8, 4, 9, 16, 15, 5, 20, 19, 12, 2, 7, 18, 11, 10, 6, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0109s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:12...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:12, End: 2025-07-22 16:00:12)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 16, 8, 12, 2, 9, 11, 1, 10, 13, 14, 18, 20, 17, 15, 5], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8379e+05, 1.8546e+00, 1.7186e+00, 1.6353e+00, 1.7142e+00,
         1.7443e+00, 1.8209e+00, 1.6440e+00, 3.9024e+05, 3.8553e+05, 3.9182e+05,
         3.9364e+05, 3.9127e+05, 3.9479e+05, 1.7617e+00],
        [3.8379e+05, 0.0000e+00, 3.8383e+05, 3.8384e+05, 3.8385e+05, 3.8383e+05,
         3.8382e+05, 3.8382e+05, 3.8383e+05, 7.8617e+05, 7.5157e+05, 7.4599e+05,
         7.8311e+05, 7.5813e+05, 7.7559e+05, 3.8381e+05],
        [1.8546e+00, 3.8383e+05, 0.0000e+00, 1.7716e+00, 1.8011e+00, 1.7093e+00,
         1.8194e+00, 1.8845e+00, 1.7585e+00, 3.9020e+05, 3.8550e+05, 3.9185e+05,
         3.9365e+05, 3.9127e+05, 3.9478e+05, 2.0389e+00],
        [1.7186e+00, 3.8384e+05, 1.7716e+00, 0.0000e+00, 1.6198e+00, 1.7036e+00,
         1.6415e+00, 1.7197e+00, 1.6385e+00, 3.9023e+05, 3.8549e+05, 3.9182e+05,
         3.9364e+05, 3.9130e+05, 3.9476e+05, 1.8452e+00],
        [1.6353e+00, 3.8385e+05, 1.8011e+00, 1.6198e+00, 0.0000e+00, 1.5885e+00,
         1.7640e+00, 1.7097e+00, 1.6704e+00, 3.9023e+05, 3.8550e+05, 3.9185e+05,
         3.9364e+05, 3.9129e+05, 3.9477e+05, 1.9814e+00],
        [1.7142e+00, 3.8383e+05, 1.7093e+00, 1.7036e+00, 1.5885e+00, 0.0000e+00,
         1.5841e+00, 1.5371e+00, 1.6148e+00, 3.9024e+05, 3.8549e+05, 3.9185e+05,
         3.9364e+05, 3.9128e+05, 3.9479e+05, 1.9370e+00],
        [1.7443e+00, 3.8382e+05, 1.8194e+00, 1.6415e+00, 1.7640e+00, 1.5841e+00,
         0.0000e+00, 1.7181e+00, 1.6381e+00, 3.9023e+05, 3.8549e+05, 3.9184e+05,
         3.9363e+05, 3.9128e+05, 3.9478e+05, 1.7337e+00],
        [1.8209e+00, 3.8382e+05, 1.8845e+00, 1.7197e+00, 1.7097e+00, 1.5371e+00,
         1.7181e+00, 0.0000e+00, 1.7705e+00, 3.9026e+05, 3.8550e+05, 3.9181e+05,
         3.9363e+05, 3.9127e+05, 3.9479e+05, 1.8662e+00],
        [1.6440e+00, 3.8383e+05, 1.7585e+00, 1.6385e+00, 1.6704e+00, 1.6148e+00,
         1.6381e+00, 1.7705e+00, 0.0000e+00, 3.9022e+05, 3.8551e+05, 3.9183e+05,
         3.9365e+05, 3.9128e+05, 3.9478e+05, 1.7671e+00],
        [3.9024e+05, 7.8617e+05, 3.9020e+05, 3.9023e+05, 3.9023e+05, 3.9024e+05,
         3.9023e+05, 3.9026e+05, 3.9022e+05, 0.0000e+00, 7.7650e+05, 7.7428e+05,
         7.6880e+05, 7.8523e+05, 7.9342e+05, 3.9021e+05],
        [3.8553e+05, 7.5157e+05, 3.8550e+05, 3.8549e+05, 3.8550e+05, 3.8549e+05,
         3.8549e+05, 3.8550e+05, 3.8551e+05, 7.7650e+05, 0.0000e+00, 7.8437e+05,
         7.8080e+05, 7.7574e+05, 7.7829e+05, 3.8552e+05],
        [3.9182e+05, 7.4599e+05, 3.9185e+05, 3.9182e+05, 3.9185e+05, 3.9185e+05,
         3.9184e+05, 3.9181e+05, 3.9183e+05, 7.7428e+05, 7.8437e+05, 0.0000e+00,
         7.8445e+05, 7.6669e+05, 7.9975e+05, 3.9181e+05],
        [3.9364e+05, 7.8311e+05, 3.9365e+05, 3.9364e+05, 3.9364e+05, 3.9364e+05,
         3.9363e+05, 3.9363e+05, 3.9365e+05, 7.6880e+05, 7.8080e+05, 7.8445e+05,
         0.0000e+00, 7.9163e+05, 7.8959e+05, 3.9365e+05],
        [3.9127e+05, 7.5813e+05, 3.9127e+05, 3.9130e+05, 3.9129e+05, 3.9128e+05,
         3.9128e+05, 3.9127e+05, 3.9128e+05, 7.8523e+05, 7.7574e+05, 7.6669e+05,
         7.9163e+05, 0.0000e+00, 7.9777e+05, 3.9124e+05],
        [3.9479e+05, 7.7559e+05, 3.9478e+05, 3.9476e+05, 3.9477e+05, 3.9479e+05,
         3.9478e+05, 3.9479e+05, 3.9478e+05, 7.9342e+05, 7.7829e+05, 7.9975e+05,
         7.8959e+05, 7.9777e+05, 0.0000e+00, 3.9475e+05],
        [1.7617e+00, 3.8381e+05, 2.0389e+00, 1.8452e+00, 1.9814e+00, 1.9370e+00,
         1.7337e+00, 1.8662e+00, 1.7671e+00, 3.9021e+05, 3.8552e+05, 3.9181e+05,
         3.9365e+05, 3.9124e+05, 3.9475e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6353e+00, 1.6440e+00, 1.7142e+00, 1.7186e+00, 1.7443e+00,
        1.7617e+00, 1.8209e+00, 1.8546e+00, 3.8379e+05, 3.8553e+05, 3.9024e+05,
        3.9127e+05, 3.9182e+05, 3.9364e+05, 3.9479e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383792.6250, 383812.5625, 383815.1875, 383815.6875,
        383827.5938, 383829.6562, 383830.7812, 383836.9062, 383848.3438,
        745989.5000, 751574.7500, 758134.0625, 775587.7500, 783106.6875,
        786169.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7093e+00, 1.7585e+00, 1.7716e+00, 1.8011e+00, 1.8194e+00,
        1.8546e+00, 1.8845e+00, 2.0389e+00, 3.8383e+05, 3.8550e+05, 3.9020e+05,
        3.9127e+05, 3.9185e+05, 3.9365e+05, 3.9478e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6198e+00, 1.6385e+00, 1.6415e+00, 1.7036e+00, 1.7186e+00,
        1.7197e+00, 1.7716e+00, 1.8452e+00, 3.8384e+05, 3.8549e+05, 3.9023e+05,
        3.9130e+05, 3.9182e+05, 3.9364e+05, 3.9476e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5885e+00, 1.6198e+00, 1.6353e+00, 1.6704e+00, 1.7097e+00,
        1.7640e+00, 1.8011e+00, 1.9814e+00, 3.8385e+05, 3.8550e+05, 3.9023e+05,
        3.9129e+05, 3.9185e+05, 3.9364e+05, 3.9477e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5371e+00, 1.5841e+00, 1.5885e+00, 1.6148e+00, 1.7036e+00,
        1.7093e+00, 1.7142e+00, 1.9370e+00, 3.8383e+05, 3.8549e+05, 3.9024e+05,
        3.9128e+05, 3.9185e+05, 3.9364e+05, 3.9479e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5841e+00, 1.6381e+00, 1.6415e+00, 1.7181e+00, 1.7337e+00,
        1.7443e+00, 1.7640e+00, 1.8194e+00, 3.8382e+05, 3.8549e+05, 3.9023e+05,
        3.9128e+05, 3.9184e+05, 3.9363e+05, 3.9478e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5371e+00, 1.7097e+00, 1.7181e+00, 1.7197e+00, 1.7705e+00,
        1.8209e+00, 1.8662e+00, 1.8845e+00, 3.8382e+05, 3.8550e+05, 3.9026e+05,
        3.9127e+05, 3.9181e+05, 3.9363e+05, 3.9479e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6148e+00, 1.6381e+00, 1.6385e+00, 1.6440e+00, 1.6704e+00,
        1.7585e+00, 1.7671e+00, 1.7705e+00, 3.8383e+05, 3.8551e+05, 3.9022e+05,
        3.9128e+05, 3.9183e+05, 3.9365e+05, 3.9478e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390197.2812, 390213.8750, 390218.1250, 390228.5000,
        390229.9375, 390231.8750, 390239.0000, 390242.9688, 390264.5938,
        768801.3125, 774279.0625, 776501.8750, 785231.8750, 786169.1875,
        793418.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385487.4375, 385489.2500, 385489.7188, 385497.3750,
        385500.9375, 385503.3125, 385512.1875, 385520.9688, 385532.8438,
        751574.7500, 775744.6250, 776501.8750, 778288.8750, 780803.1250,
        784365.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391807.7812, 391810.2188, 391819.1250, 391821.5312,
        391833.7812, 391843.0938, 391845.1875, 391850.5312, 391852.0312,
        745989.5000, 766688.2500, 774279.0625, 784365.5000, 784449.0000,
        799748.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393627.0312, 393634.8125, 393637.9375, 393641.3125,
        393642.7188, 393643.8125, 393647.6875, 393650.0312, 393653.3750,
        768801.3125, 780803.1250, 783106.6875, 784449.0000, 789594.1250,
        791633.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391242.4062, 391269.6875, 391274.4688, 391274.5625,
        391277.8750, 391280.8125, 391281.9688, 391287.0625, 391297.9688,
        758134.0625, 766688.2500, 775744.6250, 785231.8750, 791633.0000,
        797774.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394752.1562, 394755.4375, 394774.0000, 394775.3750,
        394778.4688, 394780.4062, 394790.2812, 394792.3438, 394793.5000,
        775587.7500, 778288.8750, 789594.1250, 793418.3125, 797774.8125,
        799748.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7337e+00, 1.7617e+00, 1.7671e+00, 1.8452e+00, 1.8662e+00,
        1.9370e+00, 1.9814e+00, 2.0389e+00, 3.8381e+05, 3.8552e+05, 3.9021e+05,
        3.9124e+05, 3.9181e+05, 3.9365e+05, 3.9475e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76933.93', '420039.91', '76934.52', '76934.02', '76935.95', '76933.33', '76931.62', '76933.30', '76935.32', '428086.75', '422110.91', '427247.25', '431158.00', '427962.09', '432857.94', '76934.85']
estimated f for each client, fs: [7, 5, 7, 7, 7, 7, 7, 7, 7, 5, 5, 5, 5, 5, 5, 7]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 16, 8, 12, 2, 9, 11, 1, 10, 13, 14, 18, 20, 17, 15, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0130s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:12...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 16:00:12, End: 2025-07-22 16:00:12)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 3, 13, 9, 7, 18, 2, 10, 5, 1, 15, 20, 17, 12, 4, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5912e+00, 3.8741e+05, 1.6571e+00, 1.7153e+00, 3.7470e+05,
         1.7038e+00, 1.6965e+00, 1.9447e+00, 1.8285e+00, 4.1223e+05, 3.9737e+05,
         3.9064e+05, 1.6737e+00, 1.4963e+00, 3.8701e+05],
        [1.5912e+00, 0.0000e+00, 3.8741e+05, 1.5079e+00, 1.6234e+00, 3.7473e+05,
         1.5976e+00, 1.6130e+00, 1.6631e+00, 1.7626e+00, 4.1225e+05, 3.9735e+05,
         3.9064e+05, 1.4908e+00, 1.6337e+00, 3.8698e+05],
        [3.8741e+05, 3.8741e+05, 0.0000e+00, 3.8740e+05, 3.8739e+05, 7.6994e+05,
         3.8740e+05, 3.8737e+05, 3.8740e+05, 3.8739e+05, 7.7523e+05, 7.9944e+05,
         7.7333e+05, 3.8737e+05, 3.8738e+05, 7.9482e+05],
        [1.6571e+00, 1.5079e+00, 3.8740e+05, 0.0000e+00, 1.6211e+00, 3.7476e+05,
         1.5656e+00, 1.6118e+00, 1.8650e+00, 1.4866e+00, 4.1227e+05, 3.9740e+05,
         3.9062e+05, 1.6502e+00, 1.5207e+00, 3.8695e+05],
        [1.7153e+00, 1.6234e+00, 3.8739e+05, 1.6211e+00, 0.0000e+00, 3.7473e+05,
         1.5389e+00, 1.6187e+00, 1.6336e+00, 1.7076e+00, 4.1225e+05, 3.9736e+05,
         3.9062e+05, 1.6175e+00, 1.5687e+00, 3.8699e+05],
        [3.7470e+05, 3.7473e+05, 7.6994e+05, 3.7476e+05, 3.7473e+05, 0.0000e+00,
         3.7474e+05, 3.7475e+05, 3.7472e+05, 3.7472e+05, 7.7674e+05, 7.5207e+05,
         7.5720e+05, 3.7472e+05, 3.7472e+05, 7.5926e+05],
        [1.7038e+00, 1.5976e+00, 3.8740e+05, 1.5656e+00, 1.5389e+00, 3.7474e+05,
         0.0000e+00, 1.5982e+00, 1.8980e+00, 1.6760e+00, 4.1228e+05, 3.9735e+05,
         3.9065e+05, 1.5182e+00, 1.4953e+00, 3.8699e+05],
        [1.6965e+00, 1.6130e+00, 3.8737e+05, 1.6118e+00, 1.6187e+00, 3.7475e+05,
         1.5982e+00, 0.0000e+00, 1.7207e+00, 1.7796e+00, 4.1226e+05, 3.9738e+05,
         3.9064e+05, 1.5725e+00, 1.6251e+00, 3.8700e+05],
        [1.9447e+00, 1.6631e+00, 3.8740e+05, 1.8650e+00, 1.6336e+00, 3.7472e+05,
         1.8980e+00, 1.7207e+00, 0.0000e+00, 1.8519e+00, 4.1221e+05, 3.9739e+05,
         3.9064e+05, 1.7604e+00, 1.7743e+00, 3.8700e+05],
        [1.8285e+00, 1.7626e+00, 3.8739e+05, 1.4866e+00, 1.7076e+00, 3.7472e+05,
         1.6760e+00, 1.7796e+00, 1.8519e+00, 0.0000e+00, 4.1222e+05, 3.9736e+05,
         3.9062e+05, 1.6898e+00, 1.6434e+00, 3.8693e+05],
        [4.1223e+05, 4.1225e+05, 7.7523e+05, 4.1227e+05, 4.1225e+05, 7.7674e+05,
         4.1228e+05, 4.1226e+05, 4.1221e+05, 4.1222e+05, 0.0000e+00, 8.0525e+05,
         7.9143e+05, 4.1225e+05, 4.1225e+05, 8.0699e+05],
        [3.9737e+05, 3.9735e+05, 7.9944e+05, 3.9740e+05, 3.9736e+05, 7.5207e+05,
         3.9735e+05, 3.9738e+05, 3.9739e+05, 3.9736e+05, 8.0525e+05, 0.0000e+00,
         7.9985e+05, 3.9737e+05, 3.9737e+05, 8.0710e+05],
        [3.9064e+05, 3.9064e+05, 7.7333e+05, 3.9062e+05, 3.9062e+05, 7.5720e+05,
         3.9065e+05, 3.9064e+05, 3.9064e+05, 3.9062e+05, 7.9143e+05, 7.9985e+05,
         0.0000e+00, 3.9065e+05, 3.9065e+05, 7.7044e+05],
        [1.6737e+00, 1.4908e+00, 3.8737e+05, 1.6502e+00, 1.6175e+00, 3.7472e+05,
         1.5182e+00, 1.5725e+00, 1.7604e+00, 1.6898e+00, 4.1225e+05, 3.9737e+05,
         3.9065e+05, 0.0000e+00, 1.5048e+00, 3.8702e+05],
        [1.4963e+00, 1.6337e+00, 3.8738e+05, 1.5207e+00, 1.5687e+00, 3.7472e+05,
         1.4953e+00, 1.6251e+00, 1.7743e+00, 1.6434e+00, 4.1225e+05, 3.9737e+05,
         3.9065e+05, 1.5048e+00, 0.0000e+00, 3.8696e+05],
        [3.8701e+05, 3.8698e+05, 7.9482e+05, 3.8695e+05, 3.8699e+05, 7.5926e+05,
         3.8699e+05, 3.8700e+05, 3.8700e+05, 3.8693e+05, 8.0699e+05, 8.0710e+05,
         7.7044e+05, 3.8702e+05, 3.8696e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4963e+00, 1.5912e+00, 1.6571e+00, 1.6737e+00, 1.6965e+00,
        1.7038e+00, 1.7153e+00, 1.8285e+00, 1.9447e+00, 3.7470e+05, 3.8701e+05,
        3.8741e+05, 3.9064e+05, 3.9737e+05, 4.1223e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4908e+00, 1.5079e+00, 1.5912e+00, 1.5976e+00, 1.6130e+00,
        1.6234e+00, 1.6337e+00, 1.6631e+00, 1.7626e+00, 3.7473e+05, 3.8698e+05,
        3.8741e+05, 3.9064e+05, 3.9735e+05, 4.1225e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387373.7812, 387374.2500, 387381.3125, 387385.5938,
        387388.3750, 387398.8750, 387399.3438, 387404.9375, 387406.9062,
        387413.6250, 769938.0000, 773332.4375, 775233.1250, 794818.3750,
        799440.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4866e+00, 1.5079e+00, 1.5207e+00, 1.5656e+00, 1.6118e+00,
        1.6211e+00, 1.6502e+00, 1.6571e+00, 1.8650e+00, 3.7476e+05, 3.8695e+05,
        3.8740e+05, 3.9062e+05, 3.9740e+05, 4.1227e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5389e+00, 1.5687e+00, 1.6175e+00, 1.6187e+00, 1.6211e+00,
        1.6234e+00, 1.6336e+00, 1.7076e+00, 1.7153e+00, 3.7473e+05, 3.8699e+05,
        3.8739e+05, 3.9062e+05, 3.9736e+05, 4.1225e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374703.2500, 374715.6562, 374718.8438, 374720.4688,
        374724.0000, 374726.8438, 374729.8125, 374743.1250, 374746.5000,
        374759.3750, 752072.3750, 757198.7500, 759264.6250, 769938.0000,
        776736.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4953e+00, 1.5182e+00, 1.5389e+00, 1.5656e+00, 1.5976e+00,
        1.5982e+00, 1.6760e+00, 1.7038e+00, 1.8980e+00, 3.7474e+05, 3.8699e+05,
        3.8740e+05, 3.9065e+05, 3.9735e+05, 4.1228e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5725e+00, 1.5982e+00, 1.6118e+00, 1.6130e+00, 1.6187e+00,
        1.6251e+00, 1.6965e+00, 1.7207e+00, 1.7796e+00, 3.7475e+05, 3.8700e+05,
        3.8737e+05, 3.9064e+05, 3.9738e+05, 4.1226e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6336e+00, 1.6631e+00, 1.7207e+00, 1.7604e+00, 1.7743e+00,
        1.8519e+00, 1.8650e+00, 1.8980e+00, 1.9447e+00, 3.7472e+05, 3.8700e+05,
        3.8740e+05, 3.9064e+05, 3.9739e+05, 4.1221e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4866e+00, 1.6434e+00, 1.6760e+00, 1.6898e+00, 1.7076e+00,
        1.7626e+00, 1.7796e+00, 1.8285e+00, 1.8519e+00, 3.7472e+05, 3.8693e+05,
        3.8739e+05, 3.9062e+05, 3.9736e+05, 4.1222e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 412209.4062, 412219.6562, 412231.9062, 412247.4688,
        412248.6562, 412253.0000, 412254.7500, 412261.0312, 412267.3125,
        412281.5938, 775233.1250, 776736.5625, 791429.3750, 805249.6875,
        806986.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397347.2188, 397349.5000, 397360.0000, 397362.2500,
        397369.8125, 397371.5625, 397372.2188, 397376.6562, 397387.7812,
        397396.3438, 752072.3750, 799440.6875, 799852.3750, 805249.6875,
        807097.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390615.4062, 390621.6875, 390624.0000, 390639.9688,
        390640.5625, 390642.9062, 390644.2188, 390645.6250, 390652.3438,
        390653.0625, 757198.7500, 770442.8750, 773332.4375, 791429.3750,
        799852.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4908e+00, 1.5048e+00, 1.5182e+00, 1.5725e+00, 1.6175e+00,
        1.6502e+00, 1.6737e+00, 1.6898e+00, 1.7604e+00, 3.7472e+05, 3.8702e+05,
        3.8737e+05, 3.9065e+05, 3.9737e+05, 4.1225e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4953e+00, 1.4963e+00, 1.5048e+00, 1.5207e+00, 1.5687e+00,
        1.6251e+00, 1.6337e+00, 1.6434e+00, 1.7743e+00, 3.7472e+05, 3.8696e+05,
        3.8738e+05, 3.9065e+05, 3.9737e+05, 4.1225e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386931.3125, 386954.7188, 386958.1875, 386978.1250,
        386988.1250, 386993.1250, 386998.8438, 386999.2812, 387009.9375,
        387017.3125, 759264.6250, 770442.8750, 794818.3750, 806986.8125,
        807097.1875])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37471.86', '37474.13', '387392.69', '37477.39', '37474.45', '374728.75', '37475.77', '37476.13', '37473.66', '37473.11', '412247.47', '397369.31', '390638.00', '37473.85', '37473.31', '386982.84']
estimated f for each client, fs: [6, 6, 4, 6, 6, 5, 6, 6, 6, 6, 4, 4, 4, 6, 6, 4]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 3, 13, 9, 7, 18, 2, 10, 5, 1, 15, 20, 17, 12, 4, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0297s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:13...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:13, End: 2025-07-22 16:00:13)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 17, 11, 13, 19, 10, 7, 5, 16, 15, 20, 6, 1, 4, 8, 18], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.8835e+05, 3.8481e+05, 7.6173e+05, 7.7478e+05, 3.8484e+05,
         3.8482e+05, 3.8478e+05, 7.8999e+05, 8.0245e+05, 7.7220e+05, 3.8483e+05,
         3.8480e+05, 3.8479e+05, 3.8484e+05, 7.5927e+05],
        [7.8835e+05, 0.0000e+00, 3.8658e+05, 7.7024e+05, 7.7361e+05, 3.8661e+05,
         3.8662e+05, 3.8658e+05, 7.9599e+05, 7.6299e+05, 7.8682e+05, 3.8659e+05,
         3.8659e+05, 3.8660e+05, 3.8656e+05, 7.7429e+05],
        [3.8481e+05, 3.8658e+05, 0.0000e+00, 3.8618e+05, 3.9476e+05, 1.7182e+00,
         1.7770e+00, 1.5649e+00, 4.0619e+05, 3.9945e+05, 3.9028e+05, 1.5083e+00,
         1.8379e+00, 1.6204e+00, 1.6969e+00, 3.9093e+05],
        [7.6173e+05, 7.7024e+05, 3.8618e+05, 0.0000e+00, 7.5570e+05, 3.8618e+05,
         3.8613e+05, 3.8617e+05, 8.0962e+05, 7.6955e+05, 7.4623e+05, 3.8616e+05,
         3.8615e+05, 3.8613e+05, 3.8618e+05, 7.8276e+05],
        [7.7478e+05, 7.7361e+05, 3.9476e+05, 7.5570e+05, 0.0000e+00, 3.9478e+05,
         3.9478e+05, 3.9482e+05, 7.9180e+05, 7.7745e+05, 7.7198e+05, 3.9481e+05,
         3.9480e+05, 3.9480e+05, 3.9475e+05, 7.8127e+05],
        [3.8484e+05, 3.8661e+05, 1.7182e+00, 3.8618e+05, 3.9478e+05, 0.0000e+00,
         1.7337e+00, 1.7065e+00, 4.0612e+05, 3.9944e+05, 3.9030e+05, 1.6272e+00,
         1.8180e+00, 1.7060e+00, 1.7858e+00, 3.9090e+05],
        [3.8482e+05, 3.8662e+05, 1.7770e+00, 3.8613e+05, 3.9478e+05, 1.7337e+00,
         0.0000e+00, 1.6222e+00, 4.0615e+05, 3.9945e+05, 3.9030e+05, 1.7457e+00,
         1.8213e+00, 1.5905e+00, 1.8473e+00, 3.9093e+05],
        [3.8478e+05, 3.8658e+05, 1.5649e+00, 3.8617e+05, 3.9482e+05, 1.7065e+00,
         1.6222e+00, 0.0000e+00, 4.0614e+05, 3.9942e+05, 3.9032e+05, 1.6599e+00,
         1.7489e+00, 1.6833e+00, 1.8991e+00, 3.9091e+05],
        [7.8999e+05, 7.9599e+05, 4.0619e+05, 8.0962e+05, 7.9180e+05, 4.0612e+05,
         4.0615e+05, 4.0614e+05, 0.0000e+00, 7.8782e+05, 7.8965e+05, 4.0614e+05,
         4.0615e+05, 4.0615e+05, 4.0618e+05, 8.1594e+05],
        [8.0245e+05, 7.6299e+05, 3.9945e+05, 7.6955e+05, 7.7745e+05, 3.9944e+05,
         3.9945e+05, 3.9942e+05, 7.8782e+05, 0.0000e+00, 7.8960e+05, 3.9946e+05,
         3.9945e+05, 3.9946e+05, 3.9945e+05, 7.8262e+05],
        [7.7220e+05, 7.8682e+05, 3.9028e+05, 7.4623e+05, 7.7198e+05, 3.9030e+05,
         3.9030e+05, 3.9032e+05, 7.8965e+05, 7.8960e+05, 0.0000e+00, 3.9026e+05,
         3.9029e+05, 3.9028e+05, 3.9029e+05, 7.7522e+05],
        [3.8483e+05, 3.8659e+05, 1.5083e+00, 3.8616e+05, 3.9481e+05, 1.6272e+00,
         1.7457e+00, 1.6599e+00, 4.0614e+05, 3.9946e+05, 3.9026e+05, 0.0000e+00,
         1.6806e+00, 1.5933e+00, 1.7774e+00, 3.9090e+05],
        [3.8480e+05, 3.8659e+05, 1.8379e+00, 3.8615e+05, 3.9480e+05, 1.8180e+00,
         1.8213e+00, 1.7489e+00, 4.0615e+05, 3.9945e+05, 3.9029e+05, 1.6806e+00,
         0.0000e+00, 1.6792e+00, 1.9318e+00, 3.9092e+05],
        [3.8479e+05, 3.8660e+05, 1.6204e+00, 3.8613e+05, 3.9480e+05, 1.7060e+00,
         1.5905e+00, 1.6833e+00, 4.0615e+05, 3.9946e+05, 3.9028e+05, 1.5933e+00,
         1.6792e+00, 0.0000e+00, 1.6287e+00, 3.9093e+05],
        [3.8484e+05, 3.8656e+05, 1.6969e+00, 3.8618e+05, 3.9475e+05, 1.7858e+00,
         1.8473e+00, 1.8991e+00, 4.0618e+05, 3.9945e+05, 3.9029e+05, 1.7774e+00,
         1.9318e+00, 1.6287e+00, 0.0000e+00, 3.9088e+05],
        [7.5927e+05, 7.7429e+05, 3.9093e+05, 7.8276e+05, 7.8127e+05, 3.9090e+05,
         3.9093e+05, 3.9091e+05, 8.1594e+05, 7.8262e+05, 7.7522e+05, 3.9090e+05,
         3.9092e+05, 3.9093e+05, 3.9088e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 384784.1562, 384793.5938, 384801.5938, 384806.4688,
        384815.2812, 384826.7500, 384835.1250, 384843.1875, 759273.6875,
        761729.4375, 772204.5625, 774779.0000, 788349.6250, 789993.5625,
        802454.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386562.6875, 386576.6875, 386581.5000, 386585.4375,
        386586.8438, 386596.5938, 386610.8750, 386618.3125, 762985.8750,
        770235.2500, 773610.7500, 774291.8750, 786816.5625, 788349.6250,
        795988.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5083e+00, 1.5649e+00, 1.6204e+00, 1.6969e+00, 1.7182e+00,
        1.7770e+00, 1.8379e+00, 3.8481e+05, 3.8618e+05, 3.8658e+05, 3.9028e+05,
        3.9093e+05, 3.9476e+05, 3.9945e+05, 4.0619e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386127.5938, 386132.1562, 386148.7500, 386161.4062,
        386174.0312, 386177.8125, 386181.5625, 386182.9375, 746229.3125,
        755695.4375, 761729.4375, 769546.6250, 770235.2500, 782764.7500,
        809622.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394754.5000, 394762.5000, 394781.1250, 394781.5312,
        394798.7500, 394802.0625, 394806.8125, 394822.8438, 755695.4375,
        771982.8750, 773610.7500, 774779.0000, 777450.1250, 781266.6875,
        791798.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6272e+00, 1.7060e+00, 1.7065e+00, 1.7182e+00, 1.7337e+00,
        1.7858e+00, 1.8180e+00, 3.8484e+05, 3.8618e+05, 3.8661e+05, 3.9030e+05,
        3.9090e+05, 3.9478e+05, 3.9944e+05, 4.0612e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5905e+00, 1.6222e+00, 1.7337e+00, 1.7457e+00, 1.7770e+00,
        1.8213e+00, 1.8473e+00, 3.8482e+05, 3.8613e+05, 3.8662e+05, 3.9030e+05,
        3.9093e+05, 3.9478e+05, 3.9945e+05, 4.0615e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5649e+00, 1.6222e+00, 1.6599e+00, 1.6833e+00, 1.7065e+00,
        1.7489e+00, 1.8991e+00, 3.8478e+05, 3.8617e+05, 3.8658e+05, 3.9032e+05,
        3.9091e+05, 3.9482e+05, 3.9942e+05, 4.0614e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406121.0625, 406138.4062, 406143.6250, 406147.0938,
        406152.1250, 406152.7188, 406176.8125, 406185.1875, 787821.1250,
        789645.5625, 789993.5625, 791798.5000, 795988.2500, 809622.6875,
        815935.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399419.2500, 399437.9688, 399447.7812, 399447.8750,
        399450.6250, 399451.7188, 399456.7500, 399462.6875, 762985.8750,
        769546.6250, 777450.1250, 782616.3750, 787821.1250, 789595.1875,
        802454.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390260.6562, 390279.9688, 390282.6562, 390286.5000,
        390293.8125, 390298.9375, 390302.1562, 390316.7500, 746229.3125,
        771982.8750, 772204.5625, 775218.8125, 786816.5625, 789595.1875,
        789645.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5083e+00, 1.5933e+00, 1.6272e+00, 1.6599e+00, 1.6806e+00,
        1.7457e+00, 1.7774e+00, 3.8483e+05, 3.8616e+05, 3.8659e+05, 3.9026e+05,
        3.9090e+05, 3.9481e+05, 3.9946e+05, 4.0614e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6792e+00, 1.6806e+00, 1.7489e+00, 1.8180e+00, 1.8213e+00,
        1.8379e+00, 1.9318e+00, 3.8480e+05, 3.8615e+05, 3.8659e+05, 3.9029e+05,
        3.9092e+05, 3.9480e+05, 3.9945e+05, 4.0615e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5905e+00, 1.5933e+00, 1.6204e+00, 1.6287e+00, 1.6792e+00,
        1.6833e+00, 1.7060e+00, 3.8479e+05, 3.8613e+05, 3.8660e+05, 3.9028e+05,
        3.9093e+05, 3.9480e+05, 3.9946e+05, 4.0615e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6287e+00, 1.6969e+00, 1.7774e+00, 1.7858e+00, 1.8473e+00,
        1.8991e+00, 1.9318e+00, 3.8484e+05, 3.8618e+05, 3.8656e+05, 3.9029e+05,
        3.9088e+05, 3.9475e+05, 3.9945e+05, 4.0618e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390881.2188, 390896.1562, 390899.8750, 390907.6250,
        390918.4375, 390929.6250, 390931.3750, 390934.4062, 759273.6875,
        774291.8750, 775218.8125, 781266.6875, 782616.3750, 782764.7500,
        815935.7500])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['459950.91', '462594.00', '115758.25', '459121.09', '468598.84', '115763.59', '115757.33', '115754.67', '482668.34', '472810.69', '464053.41', '115758.52', '115754.98', '115753.38', '115760.00', '466086.44']
estimated f for each client, fs: [5, 5, 8, 5, 5, 8, 8, 8, 5, 5, 5, 8, 8, 8, 8, 5]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 17, 11, 13, 19, 10, 7, 5, 16, 15, 20, 6, 1, 4, 8, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:14...
global Accuracy on shared test data: 79.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[187  50]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:14, End: 2025-07-22 16:00:14)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 8, 6, 16, 11, 20, 18, 19, 4, 10, 9, 14, 3, 2, 7, 5], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.9067e+00, 1.7017e+00, 4.1346e+05, 1.7899e+00, 3.9000e+05,
         3.9820e+05, 3.9087e+05, 1.8098e+00, 1.7655e+00, 1.6105e+00, 4.0267e+05,
         1.8123e+00, 1.7294e+00, 1.7822e+00, 1.7880e+00],
        [1.9067e+00, 0.0000e+00, 1.8157e+00, 4.1344e+05, 1.6894e+00, 3.9003e+05,
         3.9818e+05, 3.9090e+05, 1.6415e+00, 1.7607e+00, 1.8560e+00, 4.0267e+05,
         1.7402e+00, 1.9038e+00, 1.8259e+00, 1.9715e+00],
        [1.7017e+00, 1.8157e+00, 0.0000e+00, 4.1344e+05, 1.6065e+00, 3.9004e+05,
         3.9819e+05, 3.9087e+05, 1.7403e+00, 1.6817e+00, 1.6624e+00, 4.0268e+05,
         1.7910e+00, 1.6847e+00, 1.8152e+00, 1.7933e+00],
        [4.1346e+05, 4.1344e+05, 4.1344e+05, 0.0000e+00, 4.1345e+05, 7.9673e+05,
         7.9816e+05, 7.9455e+05, 4.1342e+05, 4.1343e+05, 4.1341e+05, 8.4077e+05,
         4.1344e+05, 4.1344e+05, 4.1345e+05, 4.1345e+05],
        [1.7899e+00, 1.6894e+00, 1.6065e+00, 4.1345e+05, 0.0000e+00, 3.9000e+05,
         3.9818e+05, 3.9085e+05, 1.6472e+00, 1.6732e+00, 1.6678e+00, 4.0266e+05,
         1.7703e+00, 1.8354e+00, 1.7669e+00, 1.5977e+00],
        [3.9000e+05, 3.9003e+05, 3.9004e+05, 7.9673e+05, 3.9000e+05, 0.0000e+00,
         7.9011e+05, 7.6596e+05, 3.9002e+05, 3.9003e+05, 3.9002e+05, 7.9986e+05,
         3.9003e+05, 3.9003e+05, 3.9002e+05, 3.9003e+05],
        [3.9820e+05, 3.9818e+05, 3.9819e+05, 7.9816e+05, 3.9818e+05, 7.9011e+05,
         0.0000e+00, 8.0515e+05, 3.9816e+05, 3.9819e+05, 3.9818e+05, 7.9146e+05,
         3.9820e+05, 3.9818e+05, 3.9817e+05, 3.9821e+05],
        [3.9087e+05, 3.9090e+05, 3.9087e+05, 7.9455e+05, 3.9085e+05, 7.6596e+05,
         8.0515e+05, 0.0000e+00, 3.9085e+05, 3.9090e+05, 3.9087e+05, 8.0043e+05,
         3.9086e+05, 3.9089e+05, 3.9089e+05, 3.9090e+05],
        [1.8098e+00, 1.6415e+00, 1.7403e+00, 4.1342e+05, 1.6472e+00, 3.9002e+05,
         3.9816e+05, 3.9085e+05, 0.0000e+00, 1.7496e+00, 1.7769e+00, 4.0268e+05,
         1.8471e+00, 1.7675e+00, 1.7162e+00, 1.7851e+00],
        [1.7655e+00, 1.7607e+00, 1.6817e+00, 4.1343e+05, 1.6732e+00, 3.9003e+05,
         3.9819e+05, 3.9090e+05, 1.7496e+00, 0.0000e+00, 1.6881e+00, 4.0268e+05,
         1.6149e+00, 1.6508e+00, 1.6549e+00, 1.7445e+00],
        [1.6105e+00, 1.8560e+00, 1.6624e+00, 4.1341e+05, 1.6678e+00, 3.9002e+05,
         3.9818e+05, 3.9087e+05, 1.7769e+00, 1.6881e+00, 0.0000e+00, 4.0267e+05,
         1.7007e+00, 1.6927e+00, 1.7135e+00, 1.8867e+00],
        [4.0267e+05, 4.0267e+05, 4.0268e+05, 8.4077e+05, 4.0266e+05, 7.9986e+05,
         7.9146e+05, 8.0043e+05, 4.0268e+05, 4.0268e+05, 4.0267e+05, 0.0000e+00,
         4.0268e+05, 4.0266e+05, 4.0266e+05, 4.0267e+05],
        [1.8123e+00, 1.7402e+00, 1.7910e+00, 4.1344e+05, 1.7703e+00, 3.9003e+05,
         3.9820e+05, 3.9086e+05, 1.8471e+00, 1.6149e+00, 1.7007e+00, 4.0268e+05,
         0.0000e+00, 1.6792e+00, 1.7827e+00, 1.7530e+00],
        [1.7294e+00, 1.9038e+00, 1.6847e+00, 4.1344e+05, 1.8354e+00, 3.9003e+05,
         3.9818e+05, 3.9089e+05, 1.7675e+00, 1.6508e+00, 1.6927e+00, 4.0266e+05,
         1.6792e+00, 0.0000e+00, 1.6734e+00, 1.9268e+00],
        [1.7822e+00, 1.8259e+00, 1.8152e+00, 4.1345e+05, 1.7669e+00, 3.9002e+05,
         3.9817e+05, 3.9089e+05, 1.7162e+00, 1.6549e+00, 1.7135e+00, 4.0266e+05,
         1.7827e+00, 1.6734e+00, 0.0000e+00, 1.7036e+00],
        [1.7880e+00, 1.9715e+00, 1.7933e+00, 4.1345e+05, 1.5977e+00, 3.9003e+05,
         3.9821e+05, 3.9090e+05, 1.7851e+00, 1.7445e+00, 1.8867e+00, 4.0267e+05,
         1.7530e+00, 1.9268e+00, 1.7036e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6105e+00, 1.7017e+00, 1.7294e+00, 1.7655e+00, 1.7822e+00,
        1.7880e+00, 1.7899e+00, 1.8098e+00, 1.8123e+00, 1.9067e+00, 3.9000e+05,
        3.9087e+05, 3.9820e+05, 4.0267e+05, 4.1346e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6415e+00, 1.6894e+00, 1.7402e+00, 1.7607e+00, 1.8157e+00,
        1.8259e+00, 1.8560e+00, 1.9038e+00, 1.9067e+00, 1.9715e+00, 3.9003e+05,
        3.9090e+05, 3.9818e+05, 4.0267e+05, 4.1344e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6065e+00, 1.6624e+00, 1.6817e+00, 1.6847e+00, 1.7017e+00,
        1.7403e+00, 1.7910e+00, 1.7933e+00, 1.8152e+00, 1.8157e+00, 3.9004e+05,
        3.9087e+05, 3.9819e+05, 4.0268e+05, 4.1344e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 413413.0625, 413423.3125, 413427.3438, 413437.5312,
        413438.4375, 413442.0938, 413444.6250, 413448.1562, 413449.8750,
        413452.0000, 413459.5000, 794548.3125, 796726.8750, 798157.0000,
        840772.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5977e+00, 1.6065e+00, 1.6472e+00, 1.6678e+00, 1.6732e+00,
        1.6894e+00, 1.7669e+00, 1.7703e+00, 1.7899e+00, 1.8354e+00, 3.9000e+05,
        3.9085e+05, 3.9818e+05, 4.0266e+05, 4.1345e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389995.5625, 389996.1875, 390019.0625, 390019.2188,
        390024.5312, 390025.3750, 390029.4375, 390030.1875, 390030.3438,
        390032.7188, 390041.3438, 765955.0625, 790105.0625, 796726.8750,
        799859.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398156.3750, 398165.1250, 398179.3125, 398179.5938,
        398181.6250, 398181.8750, 398186.5312, 398189.3750, 398200.0625,
        398203.7188, 398205.5000, 790105.0625, 791458.3750, 798157.0000,
        805154.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 390850.0625, 390854.5000, 390860.5625, 390866.5312,
        390867.3750, 390868.0625, 390891.5312, 390892.8750, 390897.9375,
        390899.8750, 390903.0625, 765955.0625, 794548.3125, 800432.5000,
        805154.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6415e+00, 1.6472e+00, 1.7162e+00, 1.7403e+00, 1.7496e+00,
        1.7675e+00, 1.7769e+00, 1.7851e+00, 1.8098e+00, 1.8471e+00, 3.9002e+05,
        3.9085e+05, 3.9816e+05, 4.0268e+05, 4.1342e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6149e+00, 1.6508e+00, 1.6549e+00, 1.6732e+00, 1.6817e+00,
        1.6881e+00, 1.7445e+00, 1.7496e+00, 1.7607e+00, 1.7655e+00, 3.9003e+05,
        3.9090e+05, 3.9819e+05, 4.0268e+05, 4.1343e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6105e+00, 1.6624e+00, 1.6678e+00, 1.6881e+00, 1.6927e+00,
        1.7007e+00, 1.7135e+00, 1.7769e+00, 1.8560e+00, 1.8867e+00, 3.9002e+05,
        3.9087e+05, 3.9818e+05, 4.0267e+05, 4.1341e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402656.3750, 402660.2812, 402660.8750, 402665.9688,
        402666.9688, 402669.7188, 402670.0312, 402675.6875, 402679.2812,
        402683.0000, 402683.2500, 791458.3750, 799859.0625, 800432.5000,
        840772.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6149e+00, 1.6792e+00, 1.7007e+00, 1.7402e+00, 1.7530e+00,
        1.7703e+00, 1.7827e+00, 1.7910e+00, 1.8123e+00, 1.8471e+00, 3.9003e+05,
        3.9086e+05, 3.9820e+05, 4.0268e+05, 4.1344e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6508e+00, 1.6734e+00, 1.6792e+00, 1.6847e+00, 1.6927e+00,
        1.7294e+00, 1.7675e+00, 1.8354e+00, 1.9038e+00, 1.9268e+00, 3.9003e+05,
        3.9089e+05, 3.9818e+05, 4.0266e+05, 4.1344e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6549e+00, 1.6734e+00, 1.7036e+00, 1.7135e+00, 1.7162e+00,
        1.7669e+00, 1.7822e+00, 1.7827e+00, 1.8152e+00, 1.8259e+00, 3.9002e+05,
        3.9089e+05, 3.9817e+05, 4.0266e+05, 4.1345e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5977e+00, 1.7036e+00, 1.7445e+00, 1.7530e+00, 1.7851e+00,
        1.7880e+00, 1.7933e+00, 1.8867e+00, 1.9268e+00, 1.9715e+00, 3.9003e+05,
        3.9090e+05, 3.9821e+05, 4.0267e+05, 4.1345e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.77', '1.81', '1.73', '413439.59', '1.70', '390022.19', '398184.47', '390877.50', '1.75', '1.70', '1.73', '402670.12', '1.75', '1.75', '1.74', '1.80']
estimated f for each client, fs: [5, 5, 5, 3, 5, 3, 3, 3, 5, 5, 5, 3, 5, 5, 5, 5]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 8, 6, 16, 11, 20, 18, 19, 4, 10, 9, 14, 3, 2, 7, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0238s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:14...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 46 217]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:14, End: 2025-07-22 16:00:14)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 11, 14, 5, 19, 17, 7, 10, 8, 18, 15, 13, 6, 12, 4, 16], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7031e+05, 7.7768e+05, 3.7030e+05, 7.5685e+05, 7.7017e+05,
         3.7031e+05, 3.7031e+05, 3.7031e+05, 7.5429e+05, 7.5821e+05, 7.5876e+05,
         3.7033e+05, 3.7033e+05, 3.7030e+05, 7.6912e+05],
        [3.7031e+05, 0.0000e+00, 3.9821e+05, 1.4518e+00, 3.8671e+05, 3.8632e+05,
         1.5134e+00, 1.6669e+00, 1.5155e+00, 3.9071e+05, 3.8347e+05, 3.8872e+05,
         1.3868e+00, 1.5970e+00, 1.4359e+00, 4.1087e+05],
        [7.7768e+05, 3.9821e+05, 0.0000e+00, 3.9821e+05, 8.0673e+05, 7.6213e+05,
         3.9824e+05, 3.9823e+05, 3.9823e+05, 7.9551e+05, 7.9171e+05, 7.6973e+05,
         3.9822e+05, 3.9824e+05, 3.9822e+05, 8.0328e+05],
        [3.7030e+05, 1.4518e+00, 3.9821e+05, 0.0000e+00, 3.8671e+05, 3.8628e+05,
         1.5035e+00, 1.6424e+00, 1.7803e+00, 3.9072e+05, 3.8347e+05, 3.8872e+05,
         1.5867e+00, 1.5935e+00, 1.5625e+00, 4.1087e+05],
        [7.5685e+05, 3.8671e+05, 8.0673e+05, 3.8671e+05, 0.0000e+00, 7.6306e+05,
         3.8671e+05, 3.8674e+05, 3.8672e+05, 7.8757e+05, 7.7213e+05, 7.6669e+05,
         3.8671e+05, 3.8673e+05, 3.8672e+05, 8.0611e+05],
        [7.7017e+05, 3.8632e+05, 7.6213e+05, 3.8628e+05, 7.6306e+05, 0.0000e+00,
         3.8632e+05, 3.8628e+05, 3.8629e+05, 7.9703e+05, 7.5766e+05, 7.7642e+05,
         3.8627e+05, 3.8634e+05, 3.8628e+05, 7.9851e+05],
        [3.7031e+05, 1.5134e+00, 3.9824e+05, 1.5035e+00, 3.8671e+05, 3.8632e+05,
         0.0000e+00, 1.7017e+00, 1.6035e+00, 3.9077e+05, 3.8345e+05, 3.8869e+05,
         1.5407e+00, 1.5406e+00, 1.4699e+00, 4.1087e+05],
        [3.7031e+05, 1.6669e+00, 3.9823e+05, 1.6424e+00, 3.8674e+05, 3.8628e+05,
         1.7017e+00, 0.0000e+00, 1.7777e+00, 3.9072e+05, 3.8345e+05, 3.8873e+05,
         1.6778e+00, 1.7920e+00, 1.6901e+00, 4.1091e+05],
        [3.7031e+05, 1.5155e+00, 3.9823e+05, 1.7803e+00, 3.8672e+05, 3.8629e+05,
         1.6035e+00, 1.7777e+00, 0.0000e+00, 3.9077e+05, 3.8347e+05, 3.8873e+05,
         1.5706e+00, 1.6311e+00, 1.4250e+00, 4.1084e+05],
        [7.5429e+05, 3.9071e+05, 7.9551e+05, 3.9072e+05, 7.8757e+05, 7.9703e+05,
         3.9077e+05, 3.9072e+05, 3.9077e+05, 0.0000e+00, 7.6869e+05, 7.8536e+05,
         3.9073e+05, 3.9072e+05, 3.9079e+05, 8.1530e+05],
        [7.5821e+05, 3.8347e+05, 7.9171e+05, 3.8347e+05, 7.7213e+05, 7.5766e+05,
         3.8345e+05, 3.8345e+05, 3.8347e+05, 7.6869e+05, 0.0000e+00, 7.6603e+05,
         3.8349e+05, 3.8348e+05, 3.8346e+05, 8.0613e+05],
        [7.5876e+05, 3.8872e+05, 7.6973e+05, 3.8872e+05, 7.6669e+05, 7.7642e+05,
         3.8869e+05, 3.8873e+05, 3.8873e+05, 7.8536e+05, 7.6603e+05, 0.0000e+00,
         3.8871e+05, 3.8871e+05, 3.8872e+05, 7.8738e+05],
        [3.7033e+05, 1.3868e+00, 3.9822e+05, 1.5867e+00, 3.8671e+05, 3.8627e+05,
         1.5407e+00, 1.6778e+00, 1.5706e+00, 3.9073e+05, 3.8349e+05, 3.8871e+05,
         0.0000e+00, 1.5689e+00, 1.4751e+00, 4.1087e+05],
        [3.7033e+05, 1.5970e+00, 3.9824e+05, 1.5935e+00, 3.8673e+05, 3.8634e+05,
         1.5406e+00, 1.7920e+00, 1.6311e+00, 3.9072e+05, 3.8348e+05, 3.8871e+05,
         1.5689e+00, 0.0000e+00, 1.5655e+00, 4.1086e+05],
        [3.7030e+05, 1.4359e+00, 3.9822e+05, 1.5625e+00, 3.8672e+05, 3.8628e+05,
         1.4699e+00, 1.6901e+00, 1.4250e+00, 3.9079e+05, 3.8346e+05, 3.8872e+05,
         1.4751e+00, 1.5655e+00, 0.0000e+00, 4.1088e+05],
        [7.6912e+05, 4.1087e+05, 8.0328e+05, 4.1087e+05, 8.0611e+05, 7.9851e+05,
         4.1087e+05, 4.1091e+05, 4.1084e+05, 8.1530e+05, 8.0613e+05, 7.8738e+05,
         4.1087e+05, 4.1086e+05, 4.1088e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 370296.9688, 370303.8750, 370312.0312, 370312.7188,
        370313.5938, 370314.6250, 370325.9375, 370326.4688, 754292.6875,
        756849.5000, 758205.2500, 758755.8750, 769124.6250, 770168.6250,
        777684.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3868e+00, 1.4359e+00, 1.4518e+00, 1.5134e+00, 1.5155e+00,
        1.5970e+00, 1.6669e+00, 3.7031e+05, 3.8347e+05, 3.8632e+05, 3.8671e+05,
        3.8872e+05, 3.9071e+05, 3.9821e+05, 4.1087e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398206.6250, 398209.2500, 398218.1562, 398219.5938,
        398226.4375, 398233.3125, 398238.6562, 398243.2812, 762133.6250,
        769726.8750, 777684.0000, 791711.8750, 795508.9375, 803280.0625,
        806731.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4518e+00, 1.5035e+00, 1.5625e+00, 1.5867e+00, 1.5935e+00,
        1.6424e+00, 1.7803e+00, 3.7030e+05, 3.8347e+05, 3.8628e+05, 3.8671e+05,
        3.8872e+05, 3.9072e+05, 3.9821e+05, 4.1087e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386707.0312, 386707.5938, 386707.6875, 386709.1562,
        386719.3750, 386724.1250, 386728.0625, 386735.4062, 756849.5000,
        763064.0000, 766693.5000, 772134.1250, 787568.4375, 806111.6875,
        806731.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386267.2500, 386277.3125, 386280.2500, 386283.6250,
        386294.5625, 386315.1875, 386322.5000, 386338.0312, 757657.0625,
        762133.6250, 763064.0000, 770168.6250, 776419.5000, 797032.3750,
        798514.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4699e+00, 1.5035e+00, 1.5134e+00, 1.5406e+00, 1.5407e+00,
        1.6035e+00, 1.7017e+00, 3.7031e+05, 3.8345e+05, 3.8632e+05, 3.8671e+05,
        3.8869e+05, 3.9077e+05, 3.9824e+05, 4.1087e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6424e+00, 1.6669e+00, 1.6778e+00, 1.6901e+00, 1.7017e+00,
        1.7777e+00, 1.7920e+00, 3.7031e+05, 3.8345e+05, 3.8628e+05, 3.8674e+05,
        3.8873e+05, 3.9072e+05, 3.9823e+05, 4.1091e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4250e+00, 1.5155e+00, 1.5706e+00, 1.6035e+00, 1.6311e+00,
        1.7777e+00, 1.7803e+00, 3.7031e+05, 3.8347e+05, 3.8629e+05, 3.8672e+05,
        3.8873e+05, 3.9077e+05, 3.9823e+05, 4.1084e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390714.9062, 390717.9375, 390721.7500, 390724.6875,
        390730.2188, 390766.4375, 390767.8125, 390786.0938, 754292.6875,
        768688.1875, 785362.8125, 787568.4375, 795508.9375, 797032.3750,
        815295.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383446.9688, 383450.2188, 383460.6250, 383465.4375,
        383465.9688, 383472.6250, 383476.3750, 383485.2188, 757657.0625,
        758205.2500, 766026.2500, 768688.1875, 772134.1250, 791711.8750,
        806125.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388686.4688, 388712.5000, 388714.3438, 388721.5938,
        388722.1875, 388723.5312, 388725.5312, 388733.1250, 758755.8750,
        766026.2500, 766693.5000, 769726.8750, 776419.5000, 785362.8125,
        787379.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3868e+00, 1.4751e+00, 1.5407e+00, 1.5689e+00, 1.5706e+00,
        1.5867e+00, 1.6778e+00, 3.7033e+05, 3.8349e+05, 3.8627e+05, 3.8671e+05,
        3.8871e+05, 3.9073e+05, 3.9822e+05, 4.1087e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5406e+00, 1.5655e+00, 1.5689e+00, 1.5935e+00, 1.5970e+00,
        1.6311e+00, 1.7920e+00, 3.7033e+05, 3.8348e+05, 3.8634e+05, 3.8673e+05,
        3.8871e+05, 3.9072e+05, 3.9824e+05, 4.1086e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4250e+00, 1.4359e+00, 1.4699e+00, 1.4751e+00, 1.5625e+00,
        1.5655e+00, 1.6901e+00, 3.7030e+05, 3.8346e+05, 3.8628e+05, 3.8672e+05,
        3.8872e+05, 3.9079e+05, 3.9822e+05, 4.1088e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 410840.6250, 410863.2812, 410869.3125, 410869.5625,
        410869.6250, 410872.0312, 410881.5625, 410912.4062, 769124.6250,
        787379.6250, 798514.5000, 803280.0625, 806111.6875, 806125.6250,
        815295.0000])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['447364.84', '114010.58', '471765.59', '114005.77', '461365.19', '461016.91', '114009.64', '114005.27', '114009.05', '464891.09', '458358.56', '463452.09', '114008.92', '114015.21', '114005.25', '484348.25']
estimated f for each client, fs: [7, 8, 5, 8, 5, 5, 8, 8, 8, 5, 5, 5, 8, 8, 8, 5]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [20, 11, 14, 5, 19, 17, 7, 10, 8, 18, 15, 13, 6, 12, 4, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0292s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:15...
global Accuracy on shared test data: 80.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[190  47]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:15, End: 2025-07-22 16:00:15)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 17, 20, 4, 10, 14, 6, 11, 13, 8, 15, 1, 9, 7, 3, 5], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.6450e+05, 8.0212e+05, 3.7727e+05, 3.7727e+05, 7.6994e+05,
         3.7729e+05, 3.7727e+05, 7.6210e+05, 3.7727e+05, 7.6285e+05, 3.7725e+05,
         3.7723e+05, 3.7724e+05, 3.7726e+05, 3.7729e+05],
        [7.6450e+05, 0.0000e+00, 7.6467e+05, 3.8191e+05, 3.8190e+05, 7.5602e+05,
         3.8190e+05, 3.8189e+05, 7.9983e+05, 3.8190e+05, 7.9418e+05, 3.8189e+05,
         3.8189e+05, 3.8192e+05, 3.8186e+05, 3.8187e+05],
        [8.0212e+05, 7.6467e+05, 0.0000e+00, 3.9327e+05, 3.9324e+05, 7.7845e+05,
         3.9326e+05, 3.9325e+05, 7.7831e+05, 3.9323e+05, 7.7373e+05, 3.9326e+05,
         3.9325e+05, 3.9323e+05, 3.9324e+05, 3.9325e+05],
        [3.7727e+05, 3.8191e+05, 3.9327e+05, 0.0000e+00, 1.4572e+00, 3.8071e+05,
         1.7029e+00, 1.6174e+00, 3.9560e+05, 1.6524e+00, 3.9089e+05, 1.7392e+00,
         1.7546e+00, 1.6637e+00, 1.7909e+00, 1.6205e+00],
        [3.7727e+05, 3.8190e+05, 3.9324e+05, 1.4572e+00, 0.0000e+00, 3.8072e+05,
         1.4397e+00, 1.4424e+00, 3.9553e+05, 1.5198e+00, 3.9091e+05, 1.5543e+00,
         1.5776e+00, 1.4215e+00, 1.4213e+00, 1.4225e+00],
        [7.6994e+05, 7.5602e+05, 7.7845e+05, 3.8071e+05, 3.8072e+05, 0.0000e+00,
         3.8066e+05, 3.8069e+05, 7.7957e+05, 3.8070e+05, 7.7838e+05, 3.8070e+05,
         3.8072e+05, 3.8071e+05, 3.8071e+05, 3.8069e+05],
        [3.7729e+05, 3.8190e+05, 3.9326e+05, 1.7029e+00, 1.4397e+00, 3.8066e+05,
         0.0000e+00, 1.4229e+00, 3.9557e+05, 1.5393e+00, 3.9089e+05, 1.4927e+00,
         1.4853e+00, 1.5597e+00, 1.5185e+00, 1.5542e+00],
        [3.7727e+05, 3.8189e+05, 3.9325e+05, 1.6174e+00, 1.4424e+00, 3.8069e+05,
         1.4229e+00, 0.0000e+00, 3.9557e+05, 1.5191e+00, 3.9092e+05, 1.5553e+00,
         1.4554e+00, 1.4712e+00, 1.5052e+00, 1.3759e+00],
        [7.6210e+05, 7.9983e+05, 7.7831e+05, 3.9560e+05, 3.9553e+05, 7.7957e+05,
         3.9557e+05, 3.9557e+05, 0.0000e+00, 3.9560e+05, 7.9803e+05, 3.9559e+05,
         3.9557e+05, 3.9557e+05, 3.9560e+05, 3.9560e+05],
        [3.7727e+05, 3.8190e+05, 3.9323e+05, 1.6524e+00, 1.5198e+00, 3.8070e+05,
         1.5393e+00, 1.5191e+00, 3.9560e+05, 0.0000e+00, 3.9088e+05, 1.6313e+00,
         1.5992e+00, 1.5444e+00, 1.5251e+00, 1.7037e+00],
        [7.6285e+05, 7.9418e+05, 7.7373e+05, 3.9089e+05, 3.9091e+05, 7.7838e+05,
         3.9089e+05, 3.9092e+05, 7.9803e+05, 3.9088e+05, 0.0000e+00, 3.9089e+05,
         3.9087e+05, 3.9091e+05, 3.9088e+05, 3.9093e+05],
        [3.7725e+05, 3.8189e+05, 3.9326e+05, 1.7392e+00, 1.5543e+00, 3.8070e+05,
         1.4927e+00, 1.5553e+00, 3.9559e+05, 1.6313e+00, 3.9089e+05, 0.0000e+00,
         1.4112e+00, 1.5253e+00, 1.5478e+00, 1.5421e+00],
        [3.7723e+05, 3.8189e+05, 3.9325e+05, 1.7546e+00, 1.5776e+00, 3.8072e+05,
         1.4853e+00, 1.4554e+00, 3.9557e+05, 1.5992e+00, 3.9087e+05, 1.4112e+00,
         0.0000e+00, 1.4749e+00, 1.4558e+00, 1.6344e+00],
        [3.7724e+05, 3.8192e+05, 3.9323e+05, 1.6637e+00, 1.4215e+00, 3.8071e+05,
         1.5597e+00, 1.4712e+00, 3.9557e+05, 1.5444e+00, 3.9091e+05, 1.5253e+00,
         1.4749e+00, 0.0000e+00, 1.4935e+00, 1.4064e+00],
        [3.7726e+05, 3.8186e+05, 3.9324e+05, 1.7909e+00, 1.4213e+00, 3.8071e+05,
         1.5185e+00, 1.5052e+00, 3.9560e+05, 1.5251e+00, 3.9088e+05, 1.5478e+00,
         1.4558e+00, 1.4935e+00, 0.0000e+00, 1.4846e+00],
        [3.7729e+05, 3.8187e+05, 3.9325e+05, 1.6205e+00, 1.4225e+00, 3.8069e+05,
         1.5542e+00, 1.3759e+00, 3.9560e+05, 1.7037e+00, 3.9093e+05, 1.5421e+00,
         1.6344e+00, 1.4064e+00, 1.4846e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 377234.5938, 377243.7812, 377248.1875, 377257.5000,
        377267.4688, 377270.2500, 377272.4688, 377274.9375, 377286.7812,
        377294.7188, 762098.0000, 762846.6875, 764504.2500, 769940.4375,
        802120.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381855.3750, 381870.6562, 381885.4062, 381889.2500,
        381893.4062, 381895.9375, 381900.8438, 381901.1875, 381906.5000,
        381915.0938, 756024.3750, 764504.2500, 764668.4375, 794179.5000,
        799833.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393227.7500, 393232.7812, 393241.7500, 393243.2812,
        393247.0000, 393251.2500, 393254.5312, 393255.9688, 393263.9062,
        393267.4375, 764668.4375, 773731.1250, 778312.6875, 778447.6250,
        802120.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4572e+00, 1.6174e+00, 1.6205e+00, 1.6524e+00, 1.6637e+00,
        1.7029e+00, 1.7392e+00, 1.7546e+00, 1.7909e+00, 3.7727e+05, 3.8071e+05,
        3.8191e+05, 3.9089e+05, 3.9327e+05, 3.9560e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4213e+00, 1.4215e+00, 1.4225e+00, 1.4397e+00, 1.4424e+00,
        1.4572e+00, 1.5198e+00, 1.5543e+00, 1.5776e+00, 3.7727e+05, 3.8072e+05,
        3.8190e+05, 3.9091e+05, 3.9324e+05, 3.9553e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380658.3750, 380688.0625, 380688.1250, 380696.9688,
        380700.3750, 380707.5312, 380708.6875, 380714.9062, 380716.2188,
        380717.4062, 756024.3750, 769940.4375, 778383.6875, 778447.6250,
        779569.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4229e+00, 1.4397e+00, 1.4853e+00, 1.4927e+00, 1.5185e+00,
        1.5393e+00, 1.5542e+00, 1.5597e+00, 1.7029e+00, 3.7729e+05, 3.8066e+05,
        3.8190e+05, 3.9089e+05, 3.9326e+05, 3.9557e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3759e+00, 1.4229e+00, 1.4424e+00, 1.4554e+00, 1.4712e+00,
        1.5052e+00, 1.5191e+00, 1.5553e+00, 1.6174e+00, 3.7727e+05, 3.8069e+05,
        3.8189e+05, 3.9092e+05, 3.9325e+05, 3.9557e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395532.2188, 395571.0625, 395571.7500, 395571.7500,
        395572.9688, 395586.8438, 395598.0625, 395598.1875, 395601.2500,
        395603.9375, 762098.0000, 778312.6875, 779569.9375, 798034.6250,
        799833.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5191e+00, 1.5198e+00, 1.5251e+00, 1.5393e+00, 1.5444e+00,
        1.5992e+00, 1.6313e+00, 1.6524e+00, 1.7037e+00, 3.7727e+05, 3.8070e+05,
        3.8190e+05, 3.9088e+05, 3.9323e+05, 3.9560e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390868.9688, 390880.3125, 390881.7500, 390891.9375,
        390893.9062, 390894.0625, 390909.4375, 390913.4375, 390920.5312,
        390930.6875, 762846.6875, 773731.1250, 778383.6875, 794179.5000,
        798034.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4112e+00, 1.4927e+00, 1.5253e+00, 1.5421e+00, 1.5478e+00,
        1.5543e+00, 1.5553e+00, 1.6313e+00, 1.7392e+00, 3.7725e+05, 3.8070e+05,
        3.8189e+05, 3.9089e+05, 3.9326e+05, 3.9559e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4112e+00, 1.4554e+00, 1.4558e+00, 1.4749e+00, 1.4853e+00,
        1.5776e+00, 1.5992e+00, 1.6344e+00, 1.7546e+00, 3.7723e+05, 3.8072e+05,
        3.8189e+05, 3.9087e+05, 3.9325e+05, 3.9557e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4064e+00, 1.4215e+00, 1.4712e+00, 1.4749e+00, 1.4935e+00,
        1.5253e+00, 1.5444e+00, 1.5597e+00, 1.6637e+00, 3.7724e+05, 3.8071e+05,
        3.8192e+05, 3.9091e+05, 3.9323e+05, 3.9557e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4213e+00, 1.4558e+00, 1.4846e+00, 1.4935e+00, 1.5052e+00,
        1.5185e+00, 1.5251e+00, 1.5478e+00, 1.7909e+00, 3.7726e+05, 3.8071e+05,
        3.8186e+05, 3.9088e+05, 3.9324e+05, 3.9560e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3759e+00, 1.4064e+00, 1.4225e+00, 1.4846e+00, 1.5421e+00,
        1.5542e+00, 1.6205e+00, 1.6344e+00, 1.7037e+00, 3.7729e+05, 3.8069e+05,
        3.8187e+05, 3.9093e+05, 3.9325e+05, 3.9560e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['377265.06', '381891.38', '393248.56', '37728.52', '37728.07', '380699.69', '37730.85', '37728.84', '395580.81', '37728.67', '390898.53', '37726.22', '37724.84', '37725.73', '37727.13', '37730.05']
estimated f for each client, fs: [5, 4, 4, 6, 6, 4, 6, 6, 4, 6, 4, 6, 6, 6, 6, 6]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 17, 20, 4, 10, 14, 6, 11, 13, 8, 15, 1, 9, 7, 3, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:15...
global Accuracy on shared test data: 78.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:15, End: 2025-07-22 16:00:15)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 8, 5, 14, 1, 15, 18, 16, 9, 6, 13, 12, 20, 4, 19, 17], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5970e+00, 1.4559e+00, 3.9740e+05, 1.6771e+00, 3.9643e+05,
         3.9511e+05, 3.9958e+05, 1.7022e+00, 1.5914e+00, 3.8588e+05, 1.5444e+00,
         3.9129e+05, 1.6163e+00, 4.0674e+05, 3.9893e+05],
        [1.5970e+00, 0.0000e+00, 1.7107e+00, 3.9739e+05, 1.7198e+00, 3.9640e+05,
         3.9509e+05, 3.9956e+05, 1.7163e+00, 1.5504e+00, 3.8589e+05, 1.6101e+00,
         3.9130e+05, 1.5210e+00, 4.0673e+05, 3.9894e+05],
        [1.4559e+00, 1.7107e+00, 0.0000e+00, 3.9742e+05, 1.6565e+00, 3.9642e+05,
         3.9510e+05, 3.9955e+05, 1.7374e+00, 1.5206e+00, 3.8592e+05, 1.5642e+00,
         3.9128e+05, 1.5268e+00, 4.0673e+05, 3.9897e+05],
        [3.9740e+05, 3.9739e+05, 3.9742e+05, 0.0000e+00, 3.9746e+05, 8.0838e+05,
         7.8197e+05, 7.9591e+05, 3.9742e+05, 3.9749e+05, 7.8026e+05, 3.9743e+05,
         7.9540e+05, 3.9745e+05, 7.9568e+05, 7.9956e+05],
        [1.6771e+00, 1.7198e+00, 1.6565e+00, 3.9746e+05, 0.0000e+00, 3.9643e+05,
         3.9511e+05, 3.9955e+05, 1.6329e+00, 1.5172e+00, 3.8588e+05, 1.6267e+00,
         3.9126e+05, 1.7159e+00, 4.0676e+05, 3.9893e+05],
        [3.9643e+05, 3.9640e+05, 3.9642e+05, 8.0838e+05, 3.9643e+05, 0.0000e+00,
         7.9339e+05, 8.2390e+05, 3.9645e+05, 3.9647e+05, 7.8473e+05, 3.9644e+05,
         7.9142e+05, 3.9641e+05, 8.0793e+05, 7.9095e+05],
        [3.9511e+05, 3.9509e+05, 3.9510e+05, 7.8197e+05, 3.9511e+05, 7.9339e+05,
         0.0000e+00, 8.0122e+05, 3.9507e+05, 3.9510e+05, 7.8437e+05, 3.9512e+05,
         7.7218e+05, 3.9508e+05, 8.0369e+05, 7.8458e+05],
        [3.9958e+05, 3.9956e+05, 3.9955e+05, 7.9591e+05, 3.9955e+05, 8.2390e+05,
         8.0122e+05, 0.0000e+00, 3.9956e+05, 3.9956e+05, 8.1261e+05, 3.9957e+05,
         8.1319e+05, 3.9957e+05, 7.8991e+05, 7.7954e+05],
        [1.7022e+00, 1.7163e+00, 1.7374e+00, 3.9742e+05, 1.6329e+00, 3.9645e+05,
         3.9507e+05, 3.9956e+05, 0.0000e+00, 1.6298e+00, 3.8589e+05, 1.7983e+00,
         3.9127e+05, 1.5361e+00, 4.0676e+05, 3.9896e+05],
        [1.5914e+00, 1.5504e+00, 1.5206e+00, 3.9749e+05, 1.5172e+00, 3.9647e+05,
         3.9510e+05, 3.9956e+05, 1.6298e+00, 0.0000e+00, 3.8590e+05, 1.5160e+00,
         3.9128e+05, 1.5787e+00, 4.0673e+05, 3.9894e+05],
        [3.8588e+05, 3.8589e+05, 3.8592e+05, 7.8026e+05, 3.8588e+05, 7.8473e+05,
         7.8437e+05, 8.1261e+05, 3.8589e+05, 3.8590e+05, 0.0000e+00, 3.8589e+05,
         7.8162e+05, 3.8589e+05, 7.8972e+05, 7.8999e+05],
        [1.5444e+00, 1.6101e+00, 1.5642e+00, 3.9743e+05, 1.6267e+00, 3.9644e+05,
         3.9512e+05, 3.9957e+05, 1.7983e+00, 1.5160e+00, 3.8589e+05, 0.0000e+00,
         3.9127e+05, 1.7125e+00, 4.0671e+05, 3.9894e+05],
        [3.9129e+05, 3.9130e+05, 3.9128e+05, 7.9540e+05, 3.9126e+05, 7.9142e+05,
         7.7218e+05, 8.1319e+05, 3.9127e+05, 3.9128e+05, 7.8162e+05, 3.9127e+05,
         0.0000e+00, 3.9128e+05, 7.8369e+05, 7.8002e+05],
        [1.6163e+00, 1.5210e+00, 1.5268e+00, 3.9745e+05, 1.7159e+00, 3.9641e+05,
         3.9508e+05, 3.9957e+05, 1.5361e+00, 1.5787e+00, 3.8589e+05, 1.7125e+00,
         3.9128e+05, 0.0000e+00, 4.0674e+05, 3.9892e+05],
        [4.0674e+05, 4.0673e+05, 4.0673e+05, 7.9568e+05, 4.0676e+05, 8.0793e+05,
         8.0369e+05, 7.8991e+05, 4.0676e+05, 4.0673e+05, 7.8972e+05, 4.0671e+05,
         7.8369e+05, 4.0674e+05, 0.0000e+00, 7.9483e+05],
        [3.9893e+05, 3.9894e+05, 3.9897e+05, 7.9956e+05, 3.9893e+05, 7.9095e+05,
         7.8458e+05, 7.7954e+05, 3.9896e+05, 3.9894e+05, 7.8999e+05, 3.9894e+05,
         7.8002e+05, 3.9892e+05, 7.9483e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4559e+00, 1.5444e+00, 1.5914e+00, 1.5970e+00, 1.6163e+00,
        1.6771e+00, 1.7022e+00, 3.8588e+05, 3.9129e+05, 3.9511e+05, 3.9643e+05,
        3.9740e+05, 3.9893e+05, 3.9958e+05, 4.0674e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5210e+00, 1.5504e+00, 1.5970e+00, 1.6101e+00, 1.7107e+00,
        1.7163e+00, 1.7198e+00, 3.8589e+05, 3.9130e+05, 3.9509e+05, 3.9640e+05,
        3.9739e+05, 3.9894e+05, 3.9956e+05, 4.0673e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4559e+00, 1.5206e+00, 1.5268e+00, 1.5642e+00, 1.6565e+00,
        1.7107e+00, 1.7374e+00, 3.8592e+05, 3.9128e+05, 3.9510e+05, 3.9642e+05,
        3.9742e+05, 3.9897e+05, 3.9955e+05, 4.0673e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397391.5625, 397403.7188, 397418.4688, 397421.6250,
        397429.3125, 397450.3438, 397458.7188, 397489.5625, 780255.7500,
        781967.9375, 795398.9375, 795677.3750, 795912.1250, 799563.1250,
        808378.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5172e+00, 1.6267e+00, 1.6329e+00, 1.6565e+00, 1.6771e+00,
        1.7159e+00, 1.7198e+00, 3.8588e+05, 3.9126e+05, 3.9511e+05, 3.9643e+05,
        3.9746e+05, 3.9893e+05, 3.9955e+05, 4.0676e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396400.6562, 396406.0000, 396421.5625, 396433.1250,
        396434.8750, 396438.3750, 396446.2500, 396474.4688, 784730.5000,
        790949.4375, 791415.0000, 793394.6875, 807925.3125, 808378.8125,
        823903.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395068.7500, 395075.5625, 395093.2812, 395100.6250,
        395103.7500, 395106.1562, 395108.2812, 395119.1875, 772176.8750,
        781967.9375, 784374.2500, 784577.7500, 793394.6875, 801221.8750,
        803692.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399550.4688, 399552.7188, 399555.7812, 399560.9062,
        399563.7812, 399568.2500, 399569.8750, 399577.1562, 779536.7500,
        789909.9375, 795912.1250, 801221.8750, 812614.6250, 813191.5625,
        823903.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5361e+00, 1.6298e+00, 1.6329e+00, 1.7022e+00, 1.7163e+00,
        1.7374e+00, 1.7983e+00, 3.8589e+05, 3.9127e+05, 3.9507e+05, 3.9645e+05,
        3.9742e+05, 3.9896e+05, 3.9956e+05, 4.0676e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5160e+00, 1.5172e+00, 1.5206e+00, 1.5504e+00, 1.5787e+00,
        1.5914e+00, 1.6298e+00, 3.8590e+05, 3.9128e+05, 3.9510e+05, 3.9647e+05,
        3.9749e+05, 3.9894e+05, 3.9956e+05, 4.0673e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385877.0000, 385880.3438, 385891.0938, 385893.1875,
        385894.0938, 385894.9375, 385903.6875, 385919.3438, 780255.7500,
        781615.0625, 784374.2500, 784730.5000, 789715.2500, 789986.3750,
        812614.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5160e+00, 1.5444e+00, 1.5642e+00, 1.6101e+00, 1.6267e+00,
        1.7125e+00, 1.7983e+00, 3.8589e+05, 3.9127e+05, 3.9512e+05, 3.9644e+05,
        3.9743e+05, 3.9894e+05, 3.9957e+05, 4.0671e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391263.5312, 391265.0312, 391265.1562, 391275.0312,
        391277.4688, 391284.5312, 391292.8438, 391296.3750, 772176.8750,
        780020.6250, 781615.0625, 783688.5000, 791415.0000, 795398.9375,
        813191.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5210e+00, 1.5268e+00, 1.5361e+00, 1.5787e+00, 1.6163e+00,
        1.7125e+00, 1.7159e+00, 3.8589e+05, 3.9128e+05, 3.9508e+05, 3.9641e+05,
        3.9745e+05, 3.9892e+05, 3.9957e+05, 4.0674e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406712.5625, 406729.6250, 406730.2188, 406734.8750,
        406737.4375, 406740.7500, 406756.6250, 406762.5000, 783688.5000,
        789715.2500, 789909.9375, 794832.6875, 795677.3750, 803692.8750,
        807925.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398921.0000, 398929.3125, 398931.4688, 398935.8438,
        398937.3438, 398939.2500, 398955.7188, 398967.5938, 779536.7500,
        780020.6250, 784577.7500, 789986.3750, 790949.4375, 794832.6875,
        799563.1250])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['117229.27', '117229.21', '117230.86', '474168.66', '117225.83', '474713.56', '471492.06', '476594.56', '117223.96', '117229.33', '464902.44', '117228.90', '468241.75', '117226.62', '482730.84', '475107.44']
estimated f for each client, fs: [8, 8, 8, 5, 8, 5, 5, 5, 8, 8, 7, 8, 5, 8, 5, 5]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 8, 5, 14, 1, 15, 18, 16, 9, 6, 13, 12, 20, 4, 19, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0115s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:16...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:16, End: 2025-07-22 16:00:16)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 7, 3, 2, 4, 18, 5, 14, 9, 12, 16, 13, 20, 19, 6, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3041e+00, 1.3018e+00, 1.3092e+00, 1.2396e+00, 4.0165e+05,
         1.2319e+00, 3.8538e+05, 1.5558e+00, 1.2867e+00, 3.9851e+05, 3.8543e+05,
         3.9651e+05, 3.8561e+05, 1.2039e+00, 3.8072e+05],
        [1.3041e+00, 0.0000e+00, 1.2958e+00, 1.2824e+00, 1.3591e+00, 4.0164e+05,
         1.2502e+00, 3.8542e+05, 1.8241e+00, 1.3110e+00, 3.9852e+05, 3.8549e+05,
         3.9652e+05, 3.8561e+05, 1.3731e+00, 3.8075e+05],
        [1.3018e+00, 1.2958e+00, 0.0000e+00, 1.2495e+00, 1.4208e+00, 4.0166e+05,
         1.3413e+00, 3.8540e+05, 1.7936e+00, 1.1988e+00, 3.9851e+05, 3.8546e+05,
         3.9651e+05, 3.8561e+05, 1.3129e+00, 3.8071e+05],
        [1.3092e+00, 1.2824e+00, 1.2495e+00, 0.0000e+00, 1.4541e+00, 4.0162e+05,
         1.5154e+00, 3.8539e+05, 1.9095e+00, 1.2524e+00, 3.9850e+05, 3.8547e+05,
         3.9653e+05, 3.8558e+05, 1.2250e+00, 3.8075e+05],
        [1.2396e+00, 1.3591e+00, 1.4208e+00, 1.4541e+00, 0.0000e+00, 4.0166e+05,
         1.2718e+00, 3.8540e+05, 1.4624e+00, 1.4066e+00, 3.9851e+05, 3.8544e+05,
         3.9648e+05, 3.8563e+05, 1.3911e+00, 3.8071e+05],
        [4.0165e+05, 4.0164e+05, 4.0166e+05, 4.0162e+05, 4.0166e+05, 0.0000e+00,
         4.0163e+05, 7.9824e+05, 4.0167e+05, 4.0163e+05, 8.0339e+05, 7.8712e+05,
         8.0844e+05, 7.7598e+05, 4.0165e+05, 7.8194e+05],
        [1.2319e+00, 1.2502e+00, 1.3413e+00, 1.5154e+00, 1.2718e+00, 4.0163e+05,
         0.0000e+00, 3.8542e+05, 1.7403e+00, 1.3320e+00, 3.9850e+05, 3.8546e+05,
         3.9650e+05, 3.8560e+05, 1.3324e+00, 3.8074e+05],
        [3.8538e+05, 3.8542e+05, 3.8540e+05, 3.8539e+05, 3.8540e+05, 7.9824e+05,
         3.8542e+05, 0.0000e+00, 3.8538e+05, 3.8536e+05, 7.7794e+05, 7.6701e+05,
         7.6813e+05, 7.6354e+05, 3.8538e+05, 7.5095e+05],
        [1.5558e+00, 1.8241e+00, 1.7936e+00, 1.9095e+00, 1.4624e+00, 4.0167e+05,
         1.7403e+00, 3.8538e+05, 0.0000e+00, 1.9271e+00, 3.9852e+05, 3.8544e+05,
         3.9648e+05, 3.8562e+05, 1.7188e+00, 3.8073e+05],
        [1.2867e+00, 1.3110e+00, 1.1988e+00, 1.2524e+00, 1.4066e+00, 4.0163e+05,
         1.3320e+00, 3.8536e+05, 1.9271e+00, 0.0000e+00, 3.9852e+05, 3.8546e+05,
         3.9650e+05, 3.8562e+05, 1.2697e+00, 3.8070e+05],
        [3.9851e+05, 3.9852e+05, 3.9851e+05, 3.9850e+05, 3.9851e+05, 8.0339e+05,
         3.9850e+05, 7.7794e+05, 3.9852e+05, 3.9852e+05, 0.0000e+00, 7.7606e+05,
         7.9637e+05, 7.5577e+05, 3.9851e+05, 7.6217e+05],
        [3.8543e+05, 3.8549e+05, 3.8546e+05, 3.8547e+05, 3.8544e+05, 7.8712e+05,
         3.8546e+05, 7.6701e+05, 3.8544e+05, 3.8546e+05, 7.7606e+05, 0.0000e+00,
         7.6499e+05, 7.6836e+05, 3.8549e+05, 7.6973e+05],
        [3.9651e+05, 3.9652e+05, 3.9651e+05, 3.9653e+05, 3.9648e+05, 8.0844e+05,
         3.9650e+05, 7.6813e+05, 3.9648e+05, 3.9650e+05, 7.9637e+05, 7.6499e+05,
         0.0000e+00, 7.9832e+05, 3.9651e+05, 7.7326e+05],
        [3.8561e+05, 3.8561e+05, 3.8561e+05, 3.8558e+05, 3.8563e+05, 7.7598e+05,
         3.8560e+05, 7.6354e+05, 3.8562e+05, 3.8562e+05, 7.5577e+05, 7.6836e+05,
         7.9832e+05, 0.0000e+00, 3.8562e+05, 7.8283e+05],
        [1.2039e+00, 1.3731e+00, 1.3129e+00, 1.2250e+00, 1.3911e+00, 4.0165e+05,
         1.3324e+00, 3.8538e+05, 1.7188e+00, 1.2697e+00, 3.9851e+05, 3.8549e+05,
         3.9651e+05, 3.8562e+05, 0.0000e+00, 3.8072e+05],
        [3.8072e+05, 3.8075e+05, 3.8071e+05, 3.8075e+05, 3.8071e+05, 7.8194e+05,
         3.8074e+05, 7.5095e+05, 3.8073e+05, 3.8070e+05, 7.6217e+05, 7.6973e+05,
         7.7326e+05, 7.8283e+05, 3.8072e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2039e+00, 1.2319e+00, 1.2396e+00, 1.2867e+00, 1.3018e+00,
        1.3041e+00, 1.3092e+00, 1.5558e+00, 3.8072e+05, 3.8538e+05, 3.8543e+05,
        3.8561e+05, 3.9651e+05, 3.9851e+05, 4.0165e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2502e+00, 1.2824e+00, 1.2958e+00, 1.3041e+00, 1.3110e+00,
        1.3591e+00, 1.3731e+00, 1.8241e+00, 3.8075e+05, 3.8542e+05, 3.8549e+05,
        3.8561e+05, 3.9652e+05, 3.9852e+05, 4.0164e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1988e+00, 1.2495e+00, 1.2958e+00, 1.3018e+00, 1.3129e+00,
        1.3413e+00, 1.4208e+00, 1.7936e+00, 3.8071e+05, 3.8540e+05, 3.8546e+05,
        3.8561e+05, 3.9651e+05, 3.9851e+05, 4.0166e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2250e+00, 1.2495e+00, 1.2524e+00, 1.2824e+00, 1.3092e+00,
        1.4541e+00, 1.5154e+00, 1.9095e+00, 3.8075e+05, 3.8539e+05, 3.8547e+05,
        3.8558e+05, 3.9653e+05, 3.9850e+05, 4.0162e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2396e+00, 1.2718e+00, 1.3591e+00, 1.3911e+00, 1.4066e+00,
        1.4208e+00, 1.4541e+00, 1.4624e+00, 3.8071e+05, 3.8540e+05, 3.8544e+05,
        3.8563e+05, 3.9648e+05, 3.9851e+05, 4.0166e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401617.7500, 401627.0312, 401634.6875, 401637.9375,
        401647.6562, 401649.4688, 401659.0312, 401660.5312, 401674.8438,
        775980.3125, 781944.8750, 787118.0625, 798244.5000, 803394.3750,
        808437.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2319e+00, 1.2502e+00, 1.2718e+00, 1.3320e+00, 1.3324e+00,
        1.3413e+00, 1.5154e+00, 1.7403e+00, 3.8074e+05, 3.8542e+05, 3.8546e+05,
        3.8560e+05, 3.9650e+05, 3.9850e+05, 4.0163e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385359.6250, 385381.7188, 385382.6250, 385384.4062,
        385388.5625, 385398.3750, 385403.3750, 385416.6875, 385418.6875,
        750949.8125, 763539.7500, 767006.3750, 768130.0000, 777945.0000,
        798244.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4624e+00, 1.5558e+00, 1.7188e+00, 1.7403e+00, 1.7936e+00,
        1.8241e+00, 1.9095e+00, 1.9271e+00, 3.8073e+05, 3.8538e+05, 3.8544e+05,
        3.8562e+05, 3.9648e+05, 3.9852e+05, 4.0167e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1988e+00, 1.2524e+00, 1.2697e+00, 1.2867e+00, 1.3110e+00,
        1.3320e+00, 1.4066e+00, 1.9271e+00, 3.8070e+05, 3.8536e+05, 3.8546e+05,
        3.8562e+05, 3.9650e+05, 3.9852e+05, 4.0163e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398496.2812, 398501.5625, 398505.7188, 398509.2188,
        398511.1875, 398511.5938, 398515.6250, 398515.8438, 398516.7500,
        755768.7500, 762170.1875, 776057.6250, 777945.0000, 796367.4375,
        803394.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385426.1250, 385442.3125, 385443.3438, 385456.8750,
        385463.7812, 385464.2500, 385470.0625, 385485.2500, 385486.3750,
        764991.8750, 767006.3750, 768360.4375, 769732.6875, 776057.6250,
        787118.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396478.7812, 396479.3750, 396496.0625, 396500.1250,
        396510.9375, 396512.1875, 396514.6875, 396517.7812, 396528.5312,
        764991.8750, 768130.0000, 773256.3125, 796367.4375, 798321.4375,
        808437.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385582.2500, 385600.5312, 385605.1562, 385609.0625,
        385613.2500, 385615.6250, 385618.9062, 385621.5312, 385629.6875,
        755768.7500, 763539.7500, 768360.4375, 775980.3125, 782828.7500,
        798321.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2039e+00, 1.2250e+00, 1.2697e+00, 1.3129e+00, 1.3324e+00,
        1.3731e+00, 1.3911e+00, 1.7188e+00, 3.8072e+05, 3.8538e+05, 3.8549e+05,
        3.8562e+05, 3.9651e+05, 3.9851e+05, 4.0165e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380697.0625, 380712.5625, 380714.8750, 380721.1250,
        380724.6562, 380732.3750, 380736.5000, 380746.4688, 380748.0938,
        750949.8125, 762170.1875, 769732.6875, 773256.3125, 781944.8750,
        782828.7500])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76611.42', '76617.42', '76612.69', '76614.79', '76612.42', '439078.94', '76616.61', '421948.41', '76613.08', '76606.77', '434235.25', '423413.00', '433353.06', '422626.50', '76611.72', '417748.34']
estimated f for each client, fs: [7, 7, 7, 7, 7, 5, 7, 5, 7, 7, 5, 5, 5, 5, 7, 5]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 7, 3, 2, 4, 18, 5, 14, 9, 12, 16, 13, 20, 19, 6, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0136s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:16...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:16, End: 2025-07-22 16:00:16)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [18, 1, 6, 13, 12, 19, 15, 17, 5, 4, 7, 10, 16, 2, 3, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9263e+05, 3.9265e+05, 7.5692e+05, 3.9263e+05, 7.6814e+05,
         7.8718e+05, 7.8435e+05, 3.9263e+05, 3.9266e+05, 3.9262e+05, 3.9264e+05,
         7.9648e+05, 3.9266e+05, 3.9266e+05, 3.9266e+05],
        [3.9263e+05, 0.0000e+00, 1.4761e+00, 3.6552e+05, 1.6253e+00, 3.7614e+05,
         3.9544e+05, 4.0146e+05, 1.5954e+00, 1.5783e+00, 1.5483e+00, 1.5762e+00,
         3.9180e+05, 1.5063e+00, 1.4768e+00, 1.6771e+00],
        [3.9265e+05, 1.4761e+00, 0.0000e+00, 3.6551e+05, 1.5351e+00, 3.7613e+05,
         3.9544e+05, 4.0145e+05, 1.6054e+00, 1.5086e+00, 1.5567e+00, 1.5056e+00,
         3.9179e+05, 1.4285e+00, 1.4854e+00, 1.5823e+00],
        [7.5692e+05, 3.6552e+05, 3.6551e+05, 0.0000e+00, 3.6548e+05, 7.1671e+05,
         7.4026e+05, 7.7424e+05, 3.6549e+05, 3.6550e+05, 3.6550e+05, 3.6552e+05,
         7.4600e+05, 3.6554e+05, 3.6552e+05, 3.6551e+05],
        [3.9263e+05, 1.6253e+00, 1.5351e+00, 3.6548e+05, 0.0000e+00, 3.7617e+05,
         3.9541e+05, 4.0146e+05, 1.5559e+00, 1.4769e+00, 1.5572e+00, 1.5054e+00,
         3.9181e+05, 1.6395e+00, 1.4951e+00, 1.5832e+00],
        [7.6814e+05, 3.7614e+05, 3.7613e+05, 7.1671e+05, 3.7617e+05, 0.0000e+00,
         7.7845e+05, 7.6460e+05, 3.7613e+05, 3.7617e+05, 3.7616e+05, 3.7613e+05,
         7.5649e+05, 3.7613e+05, 3.7612e+05, 3.7617e+05],
        [7.8718e+05, 3.9544e+05, 3.9544e+05, 7.4026e+05, 3.9541e+05, 7.7845e+05,
         0.0000e+00, 7.9216e+05, 3.9542e+05, 3.9547e+05, 3.9543e+05, 3.9543e+05,
         7.7217e+05, 3.9543e+05, 3.9545e+05, 3.9543e+05],
        [7.8435e+05, 4.0146e+05, 4.0145e+05, 7.7424e+05, 4.0146e+05, 7.6460e+05,
         7.9216e+05, 0.0000e+00, 4.0144e+05, 4.0146e+05, 4.0146e+05, 4.0141e+05,
         8.0438e+05, 4.0145e+05, 4.0144e+05, 4.0147e+05],
        [3.9263e+05, 1.5954e+00, 1.6054e+00, 3.6549e+05, 1.5559e+00, 3.7613e+05,
         3.9542e+05, 4.0144e+05, 0.0000e+00, 1.4483e+00, 1.4606e+00, 1.4507e+00,
         3.9177e+05, 1.7824e+00, 1.5691e+00, 1.7123e+00],
        [3.9266e+05, 1.5783e+00, 1.5086e+00, 3.6550e+05, 1.4769e+00, 3.7617e+05,
         3.9547e+05, 4.0146e+05, 1.4483e+00, 0.0000e+00, 1.4546e+00, 1.3591e+00,
         3.9176e+05, 1.5945e+00, 1.5716e+00, 1.3795e+00],
        [3.9262e+05, 1.5483e+00, 1.5567e+00, 3.6550e+05, 1.5572e+00, 3.7616e+05,
         3.9543e+05, 4.0146e+05, 1.4606e+00, 1.4546e+00, 0.0000e+00, 1.4232e+00,
         3.9181e+05, 1.4207e+00, 1.4228e+00, 1.7023e+00],
        [3.9264e+05, 1.5762e+00, 1.5056e+00, 3.6552e+05, 1.5054e+00, 3.7613e+05,
         3.9543e+05, 4.0141e+05, 1.4507e+00, 1.3591e+00, 1.4232e+00, 0.0000e+00,
         3.9178e+05, 1.4351e+00, 1.4840e+00, 1.5200e+00],
        [7.9648e+05, 3.9180e+05, 3.9179e+05, 7.4600e+05, 3.9181e+05, 7.5649e+05,
         7.7217e+05, 8.0438e+05, 3.9177e+05, 3.9176e+05, 3.9181e+05, 3.9178e+05,
         0.0000e+00, 3.9177e+05, 3.9176e+05, 3.9177e+05],
        [3.9266e+05, 1.5063e+00, 1.4285e+00, 3.6554e+05, 1.6395e+00, 3.7613e+05,
         3.9543e+05, 4.0145e+05, 1.7824e+00, 1.5945e+00, 1.4207e+00, 1.4351e+00,
         3.9177e+05, 0.0000e+00, 1.4167e+00, 1.8177e+00],
        [3.9266e+05, 1.4768e+00, 1.4854e+00, 3.6552e+05, 1.4951e+00, 3.7612e+05,
         3.9545e+05, 4.0144e+05, 1.5691e+00, 1.5716e+00, 1.4228e+00, 1.4840e+00,
         3.9176e+05, 1.4167e+00, 0.0000e+00, 1.7289e+00],
        [3.9266e+05, 1.6771e+00, 1.5823e+00, 3.6551e+05, 1.5832e+00, 3.7617e+05,
         3.9543e+05, 4.0147e+05, 1.7123e+00, 1.3795e+00, 1.7023e+00, 1.5200e+00,
         3.9177e+05, 1.8177e+00, 1.7289e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 392623.8125, 392627.6562, 392633.4375, 392634.6562,
        392644.5938, 392651.5312, 392658.3438, 392659.0000, 392663.6250,
        392663.6875, 756919.9375, 768141.4375, 784350.3125, 787179.1875,
        796475.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4761e+00, 1.4768e+00, 1.5063e+00, 1.5483e+00, 1.5762e+00,
        1.5783e+00, 1.5954e+00, 1.6253e+00, 1.6771e+00, 3.6552e+05, 3.7614e+05,
        3.9180e+05, 3.9263e+05, 3.9544e+05, 4.0146e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4285e+00, 1.4761e+00, 1.4854e+00, 1.5056e+00, 1.5086e+00,
        1.5351e+00, 1.5567e+00, 1.5823e+00, 1.6054e+00, 3.6551e+05, 3.7613e+05,
        3.9179e+05, 3.9265e+05, 3.9544e+05, 4.0145e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 365481.6875, 365492.0625, 365501.1562, 365501.2812,
        365511.2188, 365513.3750, 365516.8125, 365521.5312, 365522.6875,
        365539.3750, 716709.3125, 740259.1875, 745998.5000, 756919.9375,
        774238.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4769e+00, 1.4951e+00, 1.5054e+00, 1.5351e+00, 1.5559e+00,
        1.5572e+00, 1.5832e+00, 1.6253e+00, 1.6395e+00, 3.6548e+05, 3.7617e+05,
        3.9181e+05, 3.9263e+05, 3.9541e+05, 4.0146e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376119.8750, 376131.7188, 376131.7500, 376131.7812,
        376132.0625, 376142.5938, 376157.1250, 376168.3750, 376170.7500,
        376172.7500, 716709.3125, 756492.9375, 764598.2500, 768141.4375,
        778452.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395413.8125, 395419.2812, 395429.4375, 395431.0625,
        395431.4375, 395433.1562, 395435.5625, 395435.8750, 395451.7500,
        395467.5000, 740259.1875, 772169.6875, 778452.8125, 787179.1875,
        792159.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401411.7188, 401435.9375, 401440.5625, 401445.3750,
        401446.5312, 401455.2500, 401456.8438, 401457.8750, 401459.1250,
        401467.4375, 764598.2500, 774238.3125, 784350.3125, 792159.1250,
        804381.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4483e+00, 1.4507e+00, 1.4606e+00, 1.5559e+00, 1.5691e+00,
        1.5954e+00, 1.6054e+00, 1.7123e+00, 1.7824e+00, 3.6549e+05, 3.7613e+05,
        3.9177e+05, 3.9263e+05, 3.9542e+05, 4.0144e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3591e+00, 1.3795e+00, 1.4483e+00, 1.4546e+00, 1.4769e+00,
        1.5086e+00, 1.5716e+00, 1.5783e+00, 1.5945e+00, 3.6550e+05, 3.7617e+05,
        3.9176e+05, 3.9266e+05, 3.9547e+05, 4.0146e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4207e+00, 1.4228e+00, 1.4232e+00, 1.4546e+00, 1.4606e+00,
        1.5483e+00, 1.5567e+00, 1.5572e+00, 1.7023e+00, 3.6550e+05, 3.7616e+05,
        3.9181e+05, 3.9262e+05, 3.9543e+05, 4.0146e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3591e+00, 1.4232e+00, 1.4351e+00, 1.4507e+00, 1.4840e+00,
        1.5054e+00, 1.5056e+00, 1.5200e+00, 1.5762e+00, 3.6552e+05, 3.7613e+05,
        3.9178e+05, 3.9264e+05, 3.9543e+05, 4.0141e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391763.1875, 391765.0000, 391769.5000, 391769.7500,
        391770.1562, 391780.1250, 391791.9375, 391799.4062, 391805.5625,
        391812.6562, 745998.5000, 756492.9375, 772169.6875, 796475.5625,
        804381.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4167e+00, 1.4207e+00, 1.4285e+00, 1.4351e+00, 1.5063e+00,
        1.5945e+00, 1.6395e+00, 1.7824e+00, 1.8177e+00, 3.6554e+05, 3.7613e+05,
        3.9177e+05, 3.9266e+05, 3.9543e+05, 4.0145e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4167e+00, 1.4228e+00, 1.4768e+00, 1.4840e+00, 1.4854e+00,
        1.4951e+00, 1.5691e+00, 1.5716e+00, 1.7289e+00, 3.6552e+05, 3.7612e+05,
        3.9176e+05, 3.9266e+05, 3.9545e+05, 4.0144e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3795e+00, 1.5200e+00, 1.5823e+00, 1.5832e+00, 1.6771e+00,
        1.7023e+00, 1.7123e+00, 1.7289e+00, 1.8177e+00, 3.6551e+05, 3.7617e+05,
        3.9177e+05, 3.9266e+05, 3.9543e+05, 4.0147e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['392646.03', '36553.09', '36552.71', '365510.12', '36549.57', '376145.91', '395434.91', '401447.66', '36550.62', '36551.46', '36551.48', '36553.59', '391782.75', '36555.34', '36553.52', '36552.59']
estimated f for each client, fs: [4, 6, 6, 4, 6, 4, 4, 4, 6, 6, 6, 6, 4, 6, 6, 6]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [18, 1, 6, 13, 12, 19, 15, 17, 5, 4, 7, 10, 16, 2, 3, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0241s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:17...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:17, End: 2025-07-22 16:00:17)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 16, 11, 14, 18, 8, 19, 20, 7, 17, 2, 4, 6, 15, 5, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9086e+05, 1.3646e+00, 4.0426e+05, 3.8402e+05, 1.3559e+00,
         3.9632e+05, 3.8974e+05, 1.2938e+00, 3.9469e+05, 1.2866e+00, 1.3996e+00,
         1.3259e+00, 4.0349e+05, 1.3798e+00, 1.6495e+00],
        [3.9086e+05, 0.0000e+00, 3.9087e+05, 7.9337e+05, 7.6624e+05, 3.9089e+05,
         7.7971e+05, 7.7966e+05, 3.9089e+05, 8.0175e+05, 3.9088e+05, 3.9088e+05,
         3.9087e+05, 8.0317e+05, 3.9089e+05, 3.9090e+05],
        [1.3646e+00, 3.9087e+05, 0.0000e+00, 4.0427e+05, 3.8405e+05, 1.3201e+00,
         3.9632e+05, 3.8972e+05, 1.3403e+00, 3.9472e+05, 1.2856e+00, 1.2413e+00,
         1.2711e+00, 4.0346e+05, 1.2841e+00, 1.5273e+00],
        [4.0426e+05, 7.9337e+05, 4.0427e+05, 0.0000e+00, 7.9170e+05, 4.0428e+05,
         7.9743e+05, 8.0531e+05, 4.0428e+05, 7.8507e+05, 4.0426e+05, 4.0431e+05,
         4.0426e+05, 8.2203e+05, 4.0429e+05, 4.0428e+05],
        [3.8402e+05, 7.6624e+05, 3.8405e+05, 7.9170e+05, 0.0000e+00, 3.8403e+05,
         7.6773e+05, 7.8266e+05, 3.8404e+05, 7.7560e+05, 3.8403e+05, 3.8404e+05,
         3.8404e+05, 7.7757e+05, 3.8403e+05, 3.8403e+05],
        [1.3559e+00, 3.9089e+05, 1.3201e+00, 4.0428e+05, 3.8403e+05, 0.0000e+00,
         3.9631e+05, 3.8973e+05, 1.3204e+00, 3.9471e+05, 1.3846e+00, 1.3013e+00,
         1.2942e+00, 4.0348e+05, 1.4755e+00, 1.6452e+00],
        [3.9632e+05, 7.7971e+05, 3.9632e+05, 7.9743e+05, 7.6773e+05, 3.9631e+05,
         0.0000e+00, 7.8429e+05, 3.9629e+05, 7.7662e+05, 3.9630e+05, 3.9631e+05,
         3.9632e+05, 8.0590e+05, 3.9630e+05, 3.9630e+05],
        [3.8974e+05, 7.7966e+05, 3.8972e+05, 8.0531e+05, 7.8266e+05, 3.8973e+05,
         7.8429e+05, 0.0000e+00, 3.8977e+05, 7.9355e+05, 3.8975e+05, 3.8971e+05,
         3.8975e+05, 7.8468e+05, 3.8974e+05, 3.8976e+05],
        [1.2938e+00, 3.9089e+05, 1.3403e+00, 4.0428e+05, 3.8404e+05, 1.3204e+00,
         3.9629e+05, 3.8977e+05, 0.0000e+00, 3.9473e+05, 1.2698e+00, 1.3573e+00,
         1.4076e+00, 4.0345e+05, 1.3588e+00, 1.6754e+00],
        [3.9469e+05, 8.0175e+05, 3.9472e+05, 7.8507e+05, 7.7560e+05, 3.9471e+05,
         7.7662e+05, 7.9355e+05, 3.9473e+05, 0.0000e+00, 3.9474e+05, 3.9471e+05,
         3.9471e+05, 7.9860e+05, 3.9470e+05, 3.9469e+05],
        [1.2866e+00, 3.9088e+05, 1.2856e+00, 4.0426e+05, 3.8403e+05, 1.3846e+00,
         3.9630e+05, 3.8975e+05, 1.2698e+00, 3.9474e+05, 0.0000e+00, 1.4057e+00,
         1.2610e+00, 4.0350e+05, 1.5840e+00, 1.7569e+00],
        [1.3996e+00, 3.9088e+05, 1.2413e+00, 4.0431e+05, 3.8404e+05, 1.3013e+00,
         3.9631e+05, 3.8971e+05, 1.3573e+00, 3.9471e+05, 1.4057e+00, 0.0000e+00,
         1.3296e+00, 4.0347e+05, 1.3368e+00, 1.3694e+00],
        [1.3259e+00, 3.9087e+05, 1.2711e+00, 4.0426e+05, 3.8404e+05, 1.2942e+00,
         3.9632e+05, 3.8975e+05, 1.4076e+00, 3.9471e+05, 1.2610e+00, 1.3296e+00,
         0.0000e+00, 4.0347e+05, 1.4283e+00, 1.6005e+00],
        [4.0349e+05, 8.0317e+05, 4.0346e+05, 8.2203e+05, 7.7757e+05, 4.0348e+05,
         8.0590e+05, 7.8468e+05, 4.0345e+05, 7.9860e+05, 4.0350e+05, 4.0347e+05,
         4.0347e+05, 0.0000e+00, 4.0349e+05, 4.0349e+05],
        [1.3798e+00, 3.9089e+05, 1.2841e+00, 4.0429e+05, 3.8403e+05, 1.4755e+00,
         3.9630e+05, 3.8974e+05, 1.3588e+00, 3.9470e+05, 1.5840e+00, 1.3368e+00,
         1.4283e+00, 4.0349e+05, 0.0000e+00, 1.4956e+00],
        [1.6495e+00, 3.9090e+05, 1.5273e+00, 4.0428e+05, 3.8403e+05, 1.6452e+00,
         3.9630e+05, 3.8976e+05, 1.6754e+00, 3.9469e+05, 1.7569e+00, 1.3694e+00,
         1.6005e+00, 4.0349e+05, 1.4956e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2866e+00, 1.2938e+00, 1.3259e+00, 1.3559e+00, 1.3646e+00,
        1.3798e+00, 1.3996e+00, 1.6495e+00, 3.8402e+05, 3.8974e+05, 3.9086e+05,
        3.9469e+05, 3.9632e+05, 4.0349e+05, 4.0426e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390863.5625, 390865.8125, 390871.1562, 390877.0938,
        390884.2812, 390886.7500, 390888.3750, 390889.8125, 390897.4688,
        766244.9375, 779655.1250, 779707.3750, 793373.1250, 801754.5000,
        803174.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2413e+00, 1.2711e+00, 1.2841e+00, 1.2856e+00, 1.3201e+00,
        1.3403e+00, 1.3646e+00, 1.5273e+00, 3.8405e+05, 3.8972e+05, 3.9087e+05,
        3.9472e+05, 3.9632e+05, 4.0346e+05, 4.0427e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404255.5625, 404256.1250, 404262.8125, 404272.3125,
        404275.3438, 404284.5000, 404284.6250, 404285.6562, 404313.6562,
        785068.8125, 791703.8750, 793373.1250, 797432.1875, 805312.5625,
        822025.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384020.4062, 384026.6562, 384026.8125, 384030.0000,
        384034.7500, 384035.5312, 384040.6250, 384043.8750, 384050.7188,
        766244.9375, 767726.3750, 775600.4375, 777572.7500, 782663.6250,
        791703.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2942e+00, 1.3013e+00, 1.3201e+00, 1.3204e+00, 1.3559e+00,
        1.3846e+00, 1.4755e+00, 1.6452e+00, 3.8403e+05, 3.8973e+05, 3.9089e+05,
        3.9471e+05, 3.9631e+05, 4.0348e+05, 4.0428e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396290.7188, 396299.0312, 396301.0312, 396304.1875,
        396309.1250, 396312.4375, 396316.5625, 396317.1562, 396317.1875,
        767726.3750, 776616.6875, 779707.3750, 784294.3750, 797432.1875,
        805895.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389708.0625, 389718.0000, 389733.0938, 389735.1875,
        389736.8438, 389750.8438, 389753.9062, 389758.1562, 389767.8438,
        779655.1250, 782663.6250, 784294.3750, 784675.0625, 793554.4375,
        805312.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2698e+00, 1.2938e+00, 1.3204e+00, 1.3403e+00, 1.3573e+00,
        1.3588e+00, 1.4076e+00, 1.6754e+00, 3.8404e+05, 3.8977e+05, 3.9089e+05,
        3.9473e+05, 3.9629e+05, 4.0345e+05, 4.0428e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394691.8750, 394693.3750, 394702.8125, 394705.1875,
        394709.7188, 394710.4688, 394721.8750, 394732.2812, 394735.4062,
        775600.4375, 776616.6875, 785068.8125, 793554.4375, 798603.2500,
        801754.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2610e+00, 1.2698e+00, 1.2856e+00, 1.2866e+00, 1.3846e+00,
        1.4057e+00, 1.5840e+00, 1.7569e+00, 3.8403e+05, 3.8975e+05, 3.9088e+05,
        3.9474e+05, 3.9630e+05, 4.0350e+05, 4.0426e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2413e+00, 1.3013e+00, 1.3296e+00, 1.3368e+00, 1.3573e+00,
        1.3694e+00, 1.3996e+00, 1.4057e+00, 3.8404e+05, 3.8971e+05, 3.9088e+05,
        3.9471e+05, 3.9631e+05, 4.0347e+05, 4.0431e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2610e+00, 1.2711e+00, 1.2942e+00, 1.3259e+00, 1.3296e+00,
        1.4076e+00, 1.4283e+00, 1.6005e+00, 3.8404e+05, 3.8975e+05, 3.9087e+05,
        3.9471e+05, 3.9632e+05, 4.0347e+05, 4.0426e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403453.7812, 403461.7188, 403471.3750, 403472.2188,
        403481.9062, 403492.2500, 403493.3125, 403494.3125, 403498.3438,
        777572.7500, 784675.0625, 798603.2500, 803174.3750, 805895.5000,
        822025.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2841e+00, 1.3368e+00, 1.3588e+00, 1.3798e+00, 1.4283e+00,
        1.4755e+00, 1.4956e+00, 1.5840e+00, 3.8403e+05, 3.8974e+05, 3.9089e+05,
        3.9470e+05, 3.9630e+05, 4.0349e+05, 4.0429e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3694e+00, 1.4956e+00, 1.5273e+00, 1.6005e+00, 1.6452e+00,
        1.6495e+00, 1.6754e+00, 1.7569e+00, 3.8403e+05, 3.8976e+05, 3.9090e+05,
        3.9469e+05, 3.9630e+05, 4.0349e+05, 4.0428e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77376.83', '428416.94', '77377.94', '442355.91', '422255.44', '77377.90', '433449.34', '428731.69', '77381.45', '432800.41', '77379.17', '77375.94', '77380.57', '440889.19', '77377.66', '77379.77']
estimated f for each client, fs: [7, 5, 7, 5, 5, 7, 5, 6, 7, 5, 7, 7, 7, 5, 7, 7]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 16, 11, 14, 18, 8, 19, 20, 7, 17, 2, 4, 6, 15, 5, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0200s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:18...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:18, End: 2025-07-22 16:00:18)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 1, 5, 9, 16, 12, 10, 7, 17, 13, 20, 18, 11, 4, 19, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2663e+00, 1.3213e+00, 1.3905e+00, 3.9936e+05, 1.3967e+00,
         1.1721e+00, 1.2536e+00, 3.7716e+05, 3.9139e+05, 3.9122e+05, 3.8041e+05,
         1.2723e+00, 1.7228e+00, 4.0865e+05, 3.8736e+05],
        [1.2663e+00, 0.0000e+00, 1.3610e+00, 1.4086e+00, 3.9934e+05, 1.4994e+00,
         1.2897e+00, 1.2919e+00, 3.7713e+05, 3.9135e+05, 3.9123e+05, 3.8040e+05,
         1.3037e+00, 1.7179e+00, 4.0863e+05, 3.8730e+05],
        [1.3213e+00, 1.3610e+00, 0.0000e+00, 1.3919e+00, 3.9938e+05, 1.3285e+00,
         1.1968e+00, 1.2560e+00, 3.7710e+05, 3.9135e+05, 3.9124e+05, 3.8039e+05,
         1.2482e+00, 1.5497e+00, 4.0860e+05, 3.8730e+05],
        [1.3905e+00, 1.4086e+00, 1.3919e+00, 0.0000e+00, 3.9935e+05, 1.1806e+00,
         1.2279e+00, 1.3999e+00, 3.7711e+05, 3.9136e+05, 3.9124e+05, 3.8040e+05,
         1.2177e+00, 1.2073e+00, 4.0864e+05, 3.8733e+05],
        [3.9936e+05, 3.9934e+05, 3.9938e+05, 3.9935e+05, 0.0000e+00, 3.9933e+05,
         3.9936e+05, 3.9933e+05, 7.7436e+05, 7.6958e+05, 7.9910e+05, 7.6372e+05,
         3.9933e+05, 3.9937e+05, 8.0523e+05, 7.6363e+05],
        [1.3967e+00, 1.4994e+00, 1.3285e+00, 1.1806e+00, 3.9933e+05, 0.0000e+00,
         1.2276e+00, 1.4556e+00, 3.7709e+05, 3.9136e+05, 3.9124e+05, 3.8042e+05,
         1.3606e+00, 1.1808e+00, 4.0864e+05, 3.8734e+05],
        [1.1721e+00, 1.2897e+00, 1.1968e+00, 1.2279e+00, 3.9936e+05, 1.2276e+00,
         0.0000e+00, 1.1531e+00, 3.7710e+05, 3.9134e+05, 3.9122e+05, 3.8041e+05,
         1.1851e+00, 1.3904e+00, 4.0864e+05, 3.8736e+05],
        [1.2536e+00, 1.2919e+00, 1.2560e+00, 1.3999e+00, 3.9933e+05, 1.4556e+00,
         1.1531e+00, 0.0000e+00, 3.7711e+05, 3.9135e+05, 3.9124e+05, 3.8039e+05,
         1.2433e+00, 1.6465e+00, 4.0865e+05, 3.8733e+05],
        [3.7716e+05, 3.7713e+05, 3.7710e+05, 3.7711e+05, 7.7436e+05, 3.7709e+05,
         3.7710e+05, 3.7711e+05, 0.0000e+00, 7.4974e+05, 7.6634e+05, 7.5085e+05,
         3.7709e+05, 3.7709e+05, 7.8185e+05, 7.5361e+05],
        [3.9139e+05, 3.9135e+05, 3.9135e+05, 3.9136e+05, 7.6958e+05, 3.9136e+05,
         3.9134e+05, 3.9135e+05, 7.4974e+05, 0.0000e+00, 7.8415e+05, 7.7864e+05,
         3.9134e+05, 3.9139e+05, 8.0151e+05, 7.8783e+05],
        [3.9122e+05, 3.9123e+05, 3.9124e+05, 3.9124e+05, 7.9910e+05, 3.9124e+05,
         3.9122e+05, 3.9124e+05, 7.6634e+05, 7.8415e+05, 0.0000e+00, 7.6606e+05,
         3.9119e+05, 3.9125e+05, 8.0954e+05, 7.6991e+05],
        [3.8041e+05, 3.8040e+05, 3.8039e+05, 3.8040e+05, 7.6372e+05, 3.8042e+05,
         3.8041e+05, 3.8039e+05, 7.5085e+05, 7.7864e+05, 7.6606e+05, 0.0000e+00,
         3.8040e+05, 3.8042e+05, 7.6405e+05, 7.8709e+05],
        [1.2723e+00, 1.3037e+00, 1.2482e+00, 1.2177e+00, 3.9933e+05, 1.3606e+00,
         1.1851e+00, 1.2433e+00, 3.7709e+05, 3.9134e+05, 3.9119e+05, 3.8040e+05,
         0.0000e+00, 1.5059e+00, 4.0861e+05, 3.8734e+05],
        [1.7228e+00, 1.7179e+00, 1.5497e+00, 1.2073e+00, 3.9937e+05, 1.1808e+00,
         1.3904e+00, 1.6465e+00, 3.7709e+05, 3.9139e+05, 3.9125e+05, 3.8042e+05,
         1.5059e+00, 0.0000e+00, 4.0862e+05, 3.8735e+05],
        [4.0865e+05, 4.0863e+05, 4.0860e+05, 4.0864e+05, 8.0523e+05, 4.0864e+05,
         4.0864e+05, 4.0865e+05, 7.8185e+05, 8.0151e+05, 8.0954e+05, 7.6405e+05,
         4.0861e+05, 4.0862e+05, 0.0000e+00, 7.9575e+05],
        [3.8736e+05, 3.8730e+05, 3.8730e+05, 3.8733e+05, 7.6363e+05, 3.8734e+05,
         3.8736e+05, 3.8733e+05, 7.5361e+05, 7.8783e+05, 7.6991e+05, 7.8709e+05,
         3.8734e+05, 3.8735e+05, 7.9575e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1721e+00, 1.2536e+00, 1.2663e+00, 1.2723e+00, 1.3213e+00,
        1.3905e+00, 1.3967e+00, 1.7228e+00, 3.7716e+05, 3.8041e+05, 3.8736e+05,
        3.9122e+05, 3.9139e+05, 3.9936e+05, 4.0865e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2663e+00, 1.2897e+00, 1.2919e+00, 1.3037e+00, 1.3610e+00,
        1.4086e+00, 1.4994e+00, 1.7179e+00, 3.7713e+05, 3.8040e+05, 3.8730e+05,
        3.9123e+05, 3.9135e+05, 3.9934e+05, 4.0863e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1968e+00, 1.2482e+00, 1.2560e+00, 1.3213e+00, 1.3285e+00,
        1.3610e+00, 1.3919e+00, 1.5497e+00, 3.7710e+05, 3.8039e+05, 3.8730e+05,
        3.9124e+05, 3.9135e+05, 3.9938e+05, 4.0860e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1806e+00, 1.2073e+00, 1.2177e+00, 1.2279e+00, 1.3905e+00,
        1.3919e+00, 1.3999e+00, 1.4086e+00, 3.7711e+05, 3.8040e+05, 3.8733e+05,
        3.9124e+05, 3.9136e+05, 3.9935e+05, 4.0864e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399327.4375, 399333.5000, 399333.9375, 399344.5625,
        399352.3750, 399356.2812, 399362.4062, 399366.1875, 399380.7188,
        763634.6250, 763720.5000, 769582.9375, 774364.3750, 799101.7500,
        805227.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1806e+00, 1.1808e+00, 1.2276e+00, 1.3285e+00, 1.3606e+00,
        1.3967e+00, 1.4556e+00, 1.4994e+00, 3.7709e+05, 3.8042e+05, 3.8734e+05,
        3.9124e+05, 3.9136e+05, 3.9933e+05, 4.0864e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1531e+00, 1.1721e+00, 1.1851e+00, 1.1968e+00, 1.2276e+00,
        1.2279e+00, 1.2897e+00, 1.3904e+00, 3.7710e+05, 3.8041e+05, 3.8736e+05,
        3.9122e+05, 3.9134e+05, 3.9936e+05, 4.0864e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1531e+00, 1.2433e+00, 1.2536e+00, 1.2560e+00, 1.2919e+00,
        1.3999e+00, 1.4556e+00, 1.6465e+00, 3.7711e+05, 3.8039e+05, 3.8733e+05,
        3.9124e+05, 3.9135e+05, 3.9933e+05, 4.0865e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377085.6875, 377089.1250, 377093.1250, 377097.5312,
        377103.7500, 377107.5938, 377111.1250, 377129.5625, 377156.2500,
        749737.0625, 750854.5000, 753613.3125, 766343.5000, 774364.3750,
        781852.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391338.5625, 391344.1875, 391349.8438, 391350.6875,
        391354.6875, 391355.4688, 391363.1562, 391385.8750, 391393.3125,
        749737.0625, 769582.9375, 778642.5625, 784154.7500, 787829.6875,
        801510.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391191.8438, 391224.3750, 391224.8125, 391230.7500,
        391235.5312, 391236.0625, 391237.4375, 391244.8125, 391252.6562,
        766062.9375, 766343.5000, 769912.8125, 784154.7500, 799101.7500,
        809544.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380385.0312, 380393.8750, 380397.6250, 380397.9688,
        380401.3125, 380406.1250, 380407.3750, 380415.2500, 380416.4375,
        750854.5000, 763720.5000, 764052.7500, 766062.9375, 778642.5625,
        787089.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1851e+00, 1.2177e+00, 1.2433e+00, 1.2482e+00, 1.2723e+00,
        1.3037e+00, 1.3606e+00, 1.5059e+00, 3.7709e+05, 3.8040e+05, 3.8734e+05,
        3.9119e+05, 3.9134e+05, 3.9933e+05, 4.0861e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1808e+00, 1.2073e+00, 1.3904e+00, 1.5059e+00, 1.5497e+00,
        1.6465e+00, 1.7179e+00, 1.7228e+00, 3.7709e+05, 3.8042e+05, 3.8735e+05,
        3.9125e+05, 3.9139e+05, 3.9937e+05, 4.0862e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 408596.2188, 408610.0625, 408623.8750, 408631.9375,
        408638.5938, 408640.7812, 408641.8125, 408647.3125, 408654.0000,
        764052.7500, 781852.7500, 795754.3750, 801510.5000, 805227.4375,
        809544.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387298.3125, 387303.0625, 387329.8750, 387333.8125,
        387335.6250, 387336.4062, 387351.4375, 387355.0000, 387358.2812,
        753613.3125, 763634.6250, 769912.8125, 787089.8750, 787829.6875,
        795754.3750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75757.44', '75753.87', '75749.94', '75751.91', '435779.19', '75751.90', '75751.35', '75751.21', '414371.06', '427197.31', '428714.16', '417447.56', '75750.08', '75751.40', '444173.75', '423961.56']
estimated f for each client, fs: [7, 7, 7, 7, 5, 7, 7, 7, 5, 5, 5, 5, 7, 7, 5, 5]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 1, 5, 9, 16, 12, 10, 7, 17, 13, 20, 18, 11, 4, 19, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:18...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:18, End: 2025-07-22 16:00:18)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 9, 1, 3, 14, 13, 18, 6, 10, 16, 11, 7, 8, 2, 20, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0350e+00, 1.4708e+00, 1.4258e+00, 3.8463e+05, 3.9356e+05,
         3.8895e+05, 1.3659e+00, 1.1691e+00, 3.9018e+05, 1.3196e+00, 1.4384e+00,
         1.3831e+00, 1.5589e+00, 4.0242e+05, 3.8616e+05],
        [1.0350e+00, 0.0000e+00, 1.2892e+00, 1.2471e+00, 3.8463e+05, 3.9357e+05,
         3.8895e+05, 1.2451e+00, 1.1124e+00, 3.9019e+05, 1.1738e+00, 1.3122e+00,
         1.2403e+00, 1.3817e+00, 4.0244e+05, 3.8619e+05],
        [1.4708e+00, 1.2892e+00, 0.0000e+00, 1.2596e+00, 3.8464e+05, 3.9353e+05,
         3.8896e+05, 1.2363e+00, 1.3044e+00, 3.9016e+05, 1.3211e+00, 1.3150e+00,
         1.3495e+00, 1.3140e+00, 4.0242e+05, 3.8617e+05],
        [1.4258e+00, 1.2471e+00, 1.2596e+00, 0.0000e+00, 3.8461e+05, 3.9357e+05,
         3.8896e+05, 1.1905e+00, 1.1566e+00, 3.9013e+05, 1.2389e+00, 1.2483e+00,
         1.2443e+00, 1.1936e+00, 4.0243e+05, 3.8618e+05],
        [3.8463e+05, 3.8463e+05, 3.8464e+05, 3.8461e+05, 0.0000e+00, 7.6521e+05,
         7.7819e+05, 3.8459e+05, 3.8464e+05, 7.7974e+05, 3.8461e+05, 3.8465e+05,
         3.8460e+05, 3.8463e+05, 7.5731e+05, 7.5580e+05],
        [3.9356e+05, 3.9357e+05, 3.9353e+05, 3.9357e+05, 7.6521e+05, 0.0000e+00,
         7.9672e+05, 3.9355e+05, 3.9355e+05, 7.6982e+05, 3.9355e+05, 3.9354e+05,
         3.9353e+05, 3.9354e+05, 7.9810e+05, 7.9372e+05],
        [3.8895e+05, 3.8895e+05, 3.8896e+05, 3.8896e+05, 7.7819e+05, 7.9672e+05,
         0.0000e+00, 3.8893e+05, 3.8896e+05, 7.6315e+05, 3.8894e+05, 3.8895e+05,
         3.8894e+05, 3.8894e+05, 7.7832e+05, 7.4826e+05],
        [1.3659e+00, 1.2451e+00, 1.2363e+00, 1.1905e+00, 3.8459e+05, 3.9355e+05,
         3.8893e+05, 0.0000e+00, 1.2113e+00, 3.9015e+05, 1.2062e+00, 1.3277e+00,
         1.2231e+00, 1.2869e+00, 4.0241e+05, 3.8615e+05],
        [1.1691e+00, 1.1124e+00, 1.3044e+00, 1.1566e+00, 3.8464e+05, 3.9355e+05,
         3.8896e+05, 1.2113e+00, 0.0000e+00, 3.9017e+05, 1.2042e+00, 1.2064e+00,
         1.2410e+00, 1.2349e+00, 4.0241e+05, 3.8616e+05],
        [3.9018e+05, 3.9019e+05, 3.9016e+05, 3.9013e+05, 7.7974e+05, 7.6982e+05,
         7.6315e+05, 3.9015e+05, 3.9017e+05, 0.0000e+00, 3.9016e+05, 3.9019e+05,
         3.9016e+05, 3.9011e+05, 7.9006e+05, 7.7638e+05],
        [1.3196e+00, 1.1738e+00, 1.3211e+00, 1.2389e+00, 3.8461e+05, 3.9355e+05,
         3.8894e+05, 1.2062e+00, 1.2042e+00, 3.9016e+05, 0.0000e+00, 1.2386e+00,
         1.2301e+00, 1.2795e+00, 4.0244e+05, 3.8617e+05],
        [1.4384e+00, 1.3122e+00, 1.3150e+00, 1.2483e+00, 3.8465e+05, 3.9354e+05,
         3.8895e+05, 1.3277e+00, 1.2064e+00, 3.9019e+05, 1.2386e+00, 0.0000e+00,
         1.2369e+00, 1.1916e+00, 4.0244e+05, 3.8619e+05],
        [1.3831e+00, 1.2403e+00, 1.3495e+00, 1.2443e+00, 3.8460e+05, 3.9353e+05,
         3.8894e+05, 1.2231e+00, 1.2410e+00, 3.9016e+05, 1.2301e+00, 1.2369e+00,
         0.0000e+00, 1.2822e+00, 4.0243e+05, 3.8617e+05],
        [1.5589e+00, 1.3817e+00, 1.3140e+00, 1.1936e+00, 3.8463e+05, 3.9354e+05,
         3.8894e+05, 1.2869e+00, 1.2349e+00, 3.9011e+05, 1.2795e+00, 1.1916e+00,
         1.2822e+00, 0.0000e+00, 4.0243e+05, 3.8611e+05],
        [4.0242e+05, 4.0244e+05, 4.0242e+05, 4.0243e+05, 7.5731e+05, 7.9810e+05,
         7.7832e+05, 4.0241e+05, 4.0241e+05, 7.9006e+05, 4.0244e+05, 4.0244e+05,
         4.0243e+05, 4.0243e+05, 0.0000e+00, 7.8536e+05],
        [3.8616e+05, 3.8619e+05, 3.8617e+05, 3.8618e+05, 7.5580e+05, 7.9372e+05,
         7.4826e+05, 3.8615e+05, 3.8616e+05, 7.7638e+05, 3.8617e+05, 3.8619e+05,
         3.8617e+05, 3.8611e+05, 7.8536e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0350e+00, 1.1691e+00, 1.3196e+00, 1.3659e+00, 1.3831e+00,
        1.4258e+00, 1.4384e+00, 1.4708e+00, 1.5589e+00, 3.8463e+05, 3.8616e+05,
        3.8895e+05, 3.9018e+05, 3.9356e+05, 4.0242e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0350e+00, 1.1124e+00, 1.1738e+00, 1.2403e+00, 1.2451e+00,
        1.2471e+00, 1.2892e+00, 1.3122e+00, 1.3817e+00, 3.8463e+05, 3.8619e+05,
        3.8895e+05, 3.9019e+05, 3.9357e+05, 4.0244e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2363e+00, 1.2596e+00, 1.2892e+00, 1.3044e+00, 1.3140e+00,
        1.3150e+00, 1.3211e+00, 1.3495e+00, 1.4708e+00, 3.8464e+05, 3.8617e+05,
        3.8896e+05, 3.9016e+05, 3.9353e+05, 4.0242e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1566e+00, 1.1905e+00, 1.1936e+00, 1.2389e+00, 1.2443e+00,
        1.2471e+00, 1.2483e+00, 1.2596e+00, 1.4258e+00, 3.8461e+05, 3.8618e+05,
        3.8896e+05, 3.9013e+05, 3.9357e+05, 4.0243e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384587.0625, 384604.7500, 384610.4688, 384612.7188,
        384627.5938, 384628.3438, 384630.6875, 384635.9375, 384637.7188,
        384647.4375, 755802.5625, 757308.5625, 765207.0000, 778188.3750,
        779739.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393531.2188, 393534.8438, 393537.6250, 393544.5000,
        393548.3750, 393550.3750, 393551.5625, 393559.5000, 393568.5625,
        393570.0312, 765207.0000, 769818.6250, 793715.1875, 796720.3750,
        798102.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388925.6250, 388940.5938, 388941.6875, 388942.2500,
        388945.9375, 388948.1875, 388953.8750, 388955.3750, 388955.6562,
        388956.8438, 748260.8125, 763150.7500, 778188.3750, 778321.7500,
        796720.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1905e+00, 1.2062e+00, 1.2113e+00, 1.2231e+00, 1.2363e+00,
        1.2451e+00, 1.2869e+00, 1.3277e+00, 1.3659e+00, 3.8459e+05, 3.8615e+05,
        3.8893e+05, 3.9015e+05, 3.9355e+05, 4.0241e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1124e+00, 1.1566e+00, 1.1691e+00, 1.2042e+00, 1.2064e+00,
        1.2113e+00, 1.2349e+00, 1.2410e+00, 1.3044e+00, 3.8464e+05, 3.8616e+05,
        3.8896e+05, 3.9017e+05, 3.9355e+05, 4.0241e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390113.5000, 390133.7500, 390148.7500, 390156.0000,
        390163.3125, 390164.9062, 390173.4375, 390176.2188, 390186.4062,
        390189.9688, 763150.7500, 769818.6250, 776384.4375, 779739.3125,
        790060.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1738e+00, 1.2042e+00, 1.2062e+00, 1.2301e+00, 1.2386e+00,
        1.2389e+00, 1.2795e+00, 1.3196e+00, 1.3211e+00, 3.8461e+05, 3.8617e+05,
        3.8894e+05, 3.9016e+05, 3.9355e+05, 4.0244e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1916e+00, 1.2064e+00, 1.2369e+00, 1.2386e+00, 1.2483e+00,
        1.3122e+00, 1.3150e+00, 1.3277e+00, 1.4384e+00, 3.8465e+05, 3.8619e+05,
        3.8895e+05, 3.9019e+05, 3.9354e+05, 4.0244e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2231e+00, 1.2301e+00, 1.2369e+00, 1.2403e+00, 1.2410e+00,
        1.2443e+00, 1.2822e+00, 1.3495e+00, 1.3831e+00, 3.8460e+05, 3.8617e+05,
        3.8894e+05, 3.9016e+05, 3.9353e+05, 4.0243e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1916e+00, 1.1936e+00, 1.2349e+00, 1.2795e+00, 1.2822e+00,
        1.2869e+00, 1.3140e+00, 1.3817e+00, 1.5589e+00, 3.8463e+05, 3.8611e+05,
        3.8894e+05, 3.9011e+05, 3.9354e+05, 4.0243e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402409.0312, 402409.5625, 402415.5625, 402423.9375,
        402425.6562, 402427.1562, 402428.8438, 402436.1875, 402436.5938,
        402443.0625, 757308.5625, 778321.7500, 785357.1250, 790060.0000,
        798102.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386113.2500, 386152.7188, 386155.2188, 386158.0312,
        386168.9375, 386172.1250, 386173.5312, 386175.5000, 386188.2188,
        386188.6562, 748260.8125, 755802.5625, 776384.4375, 785357.1250,
        793715.1875])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38464.29', '38463.94', '38464.96', '38462.39', '384622.28', '393549.69', '388946.66', '38459.84', '38464.68', '390160.66', '38462.17', '38465.90', '38461.62', '38463.93', '402425.56', '386164.66']
estimated f for each client, fs: [6, 6, 6, 6, 4, 4, 4, 6, 6, 4, 6, 6, 6, 6, 4, 4]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 9, 1, 3, 14, 13, 18, 6, 10, 16, 11, 7, 8, 2, 20, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0118s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:19...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:19, End: 2025-07-22 16:00:19)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 20, 2, 19, 14, 1, 4, 18, 6, 12, 15, 16, 9, 10, 7, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0292e+05, 1.3231e+00, 3.9561e+05, 4.0137e+05, 1.3444e+00,
         1.3583e+00, 4.0698e+05, 1.3839e+00, 1.3081e+00, 4.0475e+05, 3.7421e+05,
         1.2411e+00, 1.2509e+00, 1.2666e+00, 1.3076e+00],
        [4.0292e+05, 0.0000e+00, 4.0288e+05, 7.9758e+05, 7.9997e+05, 4.0287e+05,
         4.0293e+05, 8.0467e+05, 4.0289e+05, 4.0291e+05, 8.3204e+05, 7.8427e+05,
         4.0291e+05, 4.0292e+05, 4.0290e+05, 4.0292e+05],
        [1.3231e+00, 4.0288e+05, 0.0000e+00, 3.9561e+05, 4.0139e+05, 1.3779e+00,
         1.6821e+00, 4.0698e+05, 1.6479e+00, 1.4661e+00, 4.0474e+05, 3.7425e+05,
         1.4682e+00, 1.3018e+00, 1.2518e+00, 1.3343e+00],
        [3.9561e+05, 7.9758e+05, 3.9561e+05, 0.0000e+00, 7.9348e+05, 3.9561e+05,
         3.9566e+05, 8.0168e+05, 3.9564e+05, 3.9565e+05, 8.1012e+05, 7.7549e+05,
         3.9563e+05, 3.9564e+05, 3.9560e+05, 3.9560e+05],
        [4.0137e+05, 7.9997e+05, 4.0139e+05, 7.9348e+05, 0.0000e+00, 4.0135e+05,
         4.0135e+05, 8.2986e+05, 4.0134e+05, 4.0138e+05, 8.0151e+05, 7.7863e+05,
         4.0136e+05, 4.0136e+05, 4.0135e+05, 4.0136e+05],
        [1.3444e+00, 4.0287e+05, 1.3779e+00, 3.9561e+05, 4.0135e+05, 0.0000e+00,
         1.5703e+00, 4.0696e+05, 1.5460e+00, 1.4765e+00, 4.0471e+05, 3.7421e+05,
         1.3843e+00, 1.3546e+00, 1.3798e+00, 1.3927e+00],
        [1.3583e+00, 4.0293e+05, 1.6821e+00, 3.9566e+05, 4.0135e+05, 1.5703e+00,
         0.0000e+00, 4.0696e+05, 1.2435e+00, 1.0826e+00, 4.0476e+05, 3.7422e+05,
         1.1006e+00, 1.2340e+00, 1.4860e+00, 1.4492e+00],
        [4.0698e+05, 8.0467e+05, 4.0698e+05, 8.0168e+05, 8.2986e+05, 4.0696e+05,
         4.0696e+05, 0.0000e+00, 4.0699e+05, 4.0697e+05, 8.1705e+05, 7.8871e+05,
         4.0698e+05, 4.0697e+05, 4.0692e+05, 4.0696e+05],
        [1.3839e+00, 4.0289e+05, 1.6479e+00, 3.9564e+05, 4.0134e+05, 1.5460e+00,
         1.2435e+00, 4.0699e+05, 0.0000e+00, 1.2023e+00, 4.0475e+05, 3.7424e+05,
         1.2924e+00, 1.3773e+00, 1.5693e+00, 1.5299e+00],
        [1.3081e+00, 4.0291e+05, 1.4661e+00, 3.9565e+05, 4.0138e+05, 1.4765e+00,
         1.0826e+00, 4.0697e+05, 1.2023e+00, 0.0000e+00, 4.0479e+05, 3.7423e+05,
         1.1338e+00, 1.1662e+00, 1.3838e+00, 1.3387e+00],
        [4.0475e+05, 8.3204e+05, 4.0474e+05, 8.1012e+05, 8.0151e+05, 4.0471e+05,
         4.0476e+05, 8.1705e+05, 4.0475e+05, 4.0479e+05, 0.0000e+00, 7.8414e+05,
         4.0477e+05, 4.0475e+05, 4.0474e+05, 4.0475e+05],
        [3.7421e+05, 7.8427e+05, 3.7425e+05, 7.7549e+05, 7.7863e+05, 3.7421e+05,
         3.7422e+05, 7.8871e+05, 3.7424e+05, 3.7423e+05, 7.8414e+05, 0.0000e+00,
         3.7424e+05, 3.7421e+05, 3.7423e+05, 3.7424e+05],
        [1.2411e+00, 4.0291e+05, 1.4682e+00, 3.9563e+05, 4.0136e+05, 1.3843e+00,
         1.1006e+00, 4.0698e+05, 1.2924e+00, 1.1338e+00, 4.0477e+05, 3.7424e+05,
         0.0000e+00, 1.2240e+00, 1.3821e+00, 1.3398e+00],
        [1.2509e+00, 4.0292e+05, 1.3018e+00, 3.9564e+05, 4.0136e+05, 1.3546e+00,
         1.2340e+00, 4.0697e+05, 1.3773e+00, 1.1662e+00, 4.0475e+05, 3.7421e+05,
         1.2240e+00, 0.0000e+00, 1.2343e+00, 1.3348e+00],
        [1.2666e+00, 4.0290e+05, 1.2518e+00, 3.9560e+05, 4.0135e+05, 1.3798e+00,
         1.4860e+00, 4.0692e+05, 1.5693e+00, 1.3838e+00, 4.0474e+05, 3.7423e+05,
         1.3821e+00, 1.2343e+00, 0.0000e+00, 1.2831e+00],
        [1.3076e+00, 4.0292e+05, 1.3343e+00, 3.9560e+05, 4.0136e+05, 1.3927e+00,
         1.4492e+00, 4.0696e+05, 1.5299e+00, 1.3387e+00, 4.0475e+05, 3.7424e+05,
         1.3398e+00, 1.3348e+00, 1.2831e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2411e+00, 1.2509e+00, 1.2666e+00, 1.3076e+00, 1.3081e+00,
        1.3231e+00, 1.3444e+00, 1.3583e+00, 1.3839e+00, 3.7421e+05, 3.9561e+05,
        4.0137e+05, 4.0292e+05, 4.0475e+05, 4.0698e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402869.2188, 402882.3750, 402891.2188, 402898.2188,
        402907.3438, 402908.5312, 402916.0312, 402917.8750, 402921.9375,
        402927.3438, 784269.9375, 797578.5000, 799974.0000, 804667.6250,
        832044.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2518e+00, 1.3018e+00, 1.3231e+00, 1.3343e+00, 1.3779e+00,
        1.4661e+00, 1.4682e+00, 1.6479e+00, 1.6821e+00, 3.7425e+05, 3.9561e+05,
        4.0139e+05, 4.0288e+05, 4.0474e+05, 4.0698e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395598.7500, 395599.6250, 395606.5312, 395610.0000,
        395611.9375, 395628.3125, 395638.3438, 395641.9062, 395646.9375,
        395660.9688, 775493.8125, 793481.5000, 797578.5000, 801675.3750,
        810119.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401342.5312, 401345.1875, 401346.0625, 401349.5938,
        401355.0000, 401357.3438, 401364.3750, 401371.5938, 401376.8750,
        401387.6250, 778625.8125, 793481.5000, 799974.0000, 801510.7500,
        829859.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3444e+00, 1.3546e+00, 1.3779e+00, 1.3798e+00, 1.3843e+00,
        1.3927e+00, 1.4765e+00, 1.5460e+00, 1.5703e+00, 3.7421e+05, 3.9561e+05,
        4.0135e+05, 4.0287e+05, 4.0471e+05, 4.0696e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0826e+00, 1.1006e+00, 1.2340e+00, 1.2435e+00, 1.3583e+00,
        1.4492e+00, 1.4860e+00, 1.5703e+00, 1.6821e+00, 3.7422e+05, 3.9566e+05,
        4.0135e+05, 4.0293e+05, 4.0476e+05, 4.0696e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406924.8438, 406959.8750, 406961.7500, 406964.5625,
        406967.1875, 406968.0000, 406975.0625, 406977.7188, 406982.1875,
        406987.6250, 788712.0000, 801675.3750, 804667.6250, 817051.6250,
        829859.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2023e+00, 1.2435e+00, 1.2924e+00, 1.3773e+00, 1.3839e+00,
        1.5299e+00, 1.5460e+00, 1.5693e+00, 1.6479e+00, 3.7424e+05, 3.9564e+05,
        4.0134e+05, 4.0289e+05, 4.0475e+05, 4.0699e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0826e+00, 1.1338e+00, 1.1662e+00, 1.2023e+00, 1.3081e+00,
        1.3387e+00, 1.3838e+00, 1.4661e+00, 1.4765e+00, 3.7423e+05, 3.9565e+05,
        4.0138e+05, 4.0291e+05, 4.0479e+05, 4.0697e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404712.7500, 404737.6250, 404740.5625, 404745.1875,
        404748.0000, 404748.7812, 404754.5938, 404763.5938, 404770.3750,
        404787.8125, 784141.1875, 801510.7500, 810119.9375, 817051.6250,
        832044.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374206.2500, 374209.1875, 374214.9688, 374219.3438,
        374229.4375, 374233.6875, 374237.9375, 374237.9688, 374244.6875,
        374250.7500, 775493.8125, 778625.8125, 784141.1875, 784269.9375,
        788712.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1006e+00, 1.1338e+00, 1.2240e+00, 1.2411e+00, 1.2924e+00,
        1.3398e+00, 1.3821e+00, 1.3843e+00, 1.4682e+00, 3.7424e+05, 3.9563e+05,
        4.0136e+05, 4.0291e+05, 4.0477e+05, 4.0698e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1662e+00, 1.2240e+00, 1.2340e+00, 1.2343e+00, 1.2509e+00,
        1.3018e+00, 1.3348e+00, 1.3546e+00, 1.3773e+00, 3.7421e+05, 3.9564e+05,
        4.0136e+05, 4.0292e+05, 4.0475e+05, 4.0697e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2343e+00, 1.2518e+00, 1.2666e+00, 1.2831e+00, 1.3798e+00,
        1.3821e+00, 1.3838e+00, 1.4860e+00, 1.5693e+00, 3.7423e+05, 3.9560e+05,
        4.0135e+05, 4.0290e+05, 4.0474e+05, 4.0692e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2831e+00, 1.3076e+00, 1.3343e+00, 1.3348e+00, 1.3387e+00,
        1.3398e+00, 1.3927e+00, 1.4492e+00, 1.5299e+00, 3.7424e+05, 3.9560e+05,
        4.0136e+05, 4.0292e+05, 4.0475e+05, 4.0696e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37421.80', '402904.00', '37426.36', '395624.31', '401359.59', '37422.77', '37423.15', '406966.88', '37425.07', '37424.52', '404750.94', '374228.44', '37425.62', '37422.06', '37424.16', '37425.03']
estimated f for each client, fs: [6, 4, 6, 4, 4, 6, 6, 4, 6, 6, 4, 5, 6, 6, 6, 6]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 20, 2, 19, 14, 1, 4, 18, 6, 12, 15, 16, 9, 10, 7, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:19...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:19, End: 2025-07-22 16:00:19)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 13, 9, 19, 8, 16, 18, 7, 3, 10, 5, 1, 6, 17, 20, 4], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9031e+05, 1.2716e+00, 3.9712e+05, 1.5383e+00, 3.7709e+05,
         3.9460e+05, 1.5714e+00, 1.6298e+00, 1.3912e+00, 1.2014e+00, 1.6586e+00,
         1.2192e+00, 3.9610e+05, 3.9771e+05, 1.1803e+00],
        [3.9031e+05, 0.0000e+00, 3.9034e+05, 7.7717e+05, 3.9035e+05, 7.7526e+05,
         7.8149e+05, 3.9034e+05, 3.9034e+05, 3.9035e+05, 3.9033e+05, 3.9034e+05,
         3.9034e+05, 7.8313e+05, 7.5515e+05, 3.9031e+05],
        [1.2716e+00, 3.9034e+05, 0.0000e+00, 3.9714e+05, 1.2596e+00, 3.7709e+05,
         3.9461e+05, 1.3679e+00, 1.3238e+00, 1.1931e+00, 1.2124e+00, 1.2911e+00,
         1.1641e+00, 3.9604e+05, 3.9769e+05, 1.0577e+00],
        [3.9712e+05, 7.7717e+05, 3.9714e+05, 0.0000e+00, 3.9715e+05, 7.6162e+05,
         7.7976e+05, 3.9714e+05, 3.9715e+05, 3.9713e+05, 3.9717e+05, 3.9716e+05,
         3.9714e+05, 8.1496e+05, 7.9310e+05, 3.9715e+05],
        [1.5383e+00, 3.9035e+05, 1.2596e+00, 3.9715e+05, 0.0000e+00, 3.7707e+05,
         3.9461e+05, 1.2749e+00, 1.2637e+00, 1.2417e+00, 1.4231e+00, 1.2754e+00,
         1.3053e+00, 3.9608e+05, 3.9769e+05, 1.3135e+00],
        [3.7709e+05, 7.7526e+05, 3.7709e+05, 7.6162e+05, 3.7707e+05, 0.0000e+00,
         7.7640e+05, 3.7709e+05, 3.7709e+05, 3.7711e+05, 3.7711e+05, 3.7708e+05,
         3.7712e+05, 7.7233e+05, 7.8695e+05, 3.7707e+05],
        [3.9460e+05, 7.8149e+05, 3.9461e+05, 7.7976e+05, 3.9461e+05, 7.7640e+05,
         0.0000e+00, 3.9463e+05, 3.9461e+05, 3.9459e+05, 3.9460e+05, 3.9459e+05,
         3.9459e+05, 7.6872e+05, 7.7777e+05, 3.9461e+05],
        [1.5714e+00, 3.9034e+05, 1.3679e+00, 3.9714e+05, 1.2749e+00, 3.7709e+05,
         3.9463e+05, 0.0000e+00, 1.2892e+00, 1.2213e+00, 1.3649e+00, 1.3433e+00,
         1.3755e+00, 3.9611e+05, 3.9764e+05, 1.3651e+00],
        [1.6298e+00, 3.9034e+05, 1.3238e+00, 3.9715e+05, 1.2637e+00, 3.7709e+05,
         3.9461e+05, 1.2892e+00, 0.0000e+00, 1.2235e+00, 1.4132e+00, 1.2881e+00,
         1.3148e+00, 3.9612e+05, 3.9769e+05, 1.4055e+00],
        [1.3912e+00, 3.9035e+05, 1.1931e+00, 3.9713e+05, 1.2417e+00, 3.7711e+05,
         3.9459e+05, 1.2213e+00, 1.2235e+00, 0.0000e+00, 1.1792e+00, 1.2669e+00,
         1.1657e+00, 3.9608e+05, 3.9769e+05, 1.1411e+00],
        [1.2014e+00, 3.9033e+05, 1.2124e+00, 3.9717e+05, 1.4231e+00, 3.7711e+05,
         3.9460e+05, 1.3649e+00, 1.4132e+00, 1.1792e+00, 0.0000e+00, 1.4373e+00,
         1.1641e+00, 3.9607e+05, 3.9770e+05, 1.0682e+00],
        [1.6586e+00, 3.9034e+05, 1.2911e+00, 3.9716e+05, 1.2754e+00, 3.7708e+05,
         3.9459e+05, 1.3433e+00, 1.2881e+00, 1.2669e+00, 1.4373e+00, 0.0000e+00,
         1.3111e+00, 3.9608e+05, 3.9769e+05, 1.3923e+00],
        [1.2192e+00, 3.9034e+05, 1.1641e+00, 3.9714e+05, 1.3053e+00, 3.7712e+05,
         3.9459e+05, 1.3755e+00, 1.3148e+00, 1.1657e+00, 1.1641e+00, 1.3111e+00,
         0.0000e+00, 3.9606e+05, 3.9766e+05, 1.0958e+00],
        [3.9610e+05, 7.8313e+05, 3.9604e+05, 8.1496e+05, 3.9608e+05, 7.7233e+05,
         7.6872e+05, 3.9611e+05, 3.9612e+05, 3.9608e+05, 3.9607e+05, 3.9608e+05,
         3.9606e+05, 0.0000e+00, 7.9144e+05, 3.9607e+05],
        [3.9771e+05, 7.5515e+05, 3.9769e+05, 7.9310e+05, 3.9769e+05, 7.8695e+05,
         7.7777e+05, 3.9764e+05, 3.9769e+05, 3.9769e+05, 3.9770e+05, 3.9769e+05,
         3.9766e+05, 7.9144e+05, 0.0000e+00, 3.9770e+05],
        [1.1803e+00, 3.9031e+05, 1.0577e+00, 3.9715e+05, 1.3135e+00, 3.7707e+05,
         3.9461e+05, 1.3651e+00, 1.4055e+00, 1.1411e+00, 1.0682e+00, 1.3923e+00,
         1.0958e+00, 3.9607e+05, 3.9770e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1803e+00, 1.2014e+00, 1.2192e+00, 1.2716e+00, 1.3912e+00,
        1.5383e+00, 1.5714e+00, 1.6298e+00, 1.6586e+00, 3.7709e+05, 3.9031e+05,
        3.9460e+05, 3.9610e+05, 3.9712e+05, 3.9771e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390308.1562, 390308.9062, 390331.0625, 390336.9062,
        390339.0938, 390339.9062, 390343.0938, 390344.5625, 390348.5312,
        390353.3750, 755151.4375, 775261.2500, 777171.3750, 781490.8750,
        783133.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0577e+00, 1.1641e+00, 1.1931e+00, 1.2124e+00, 1.2596e+00,
        1.2716e+00, 1.2911e+00, 1.3238e+00, 1.3679e+00, 3.7709e+05, 3.9034e+05,
        3.9461e+05, 3.9604e+05, 3.9714e+05, 3.9769e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397120.7812, 397133.1875, 397136.9688, 397143.6875,
        397143.8750, 397145.9688, 397147.6250, 397151.9375, 397162.8438,
        397165.8750, 761621.4375, 777171.3750, 779758.2500, 793102.3750,
        814962.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2417e+00, 1.2596e+00, 1.2637e+00, 1.2749e+00, 1.2754e+00,
        1.3053e+00, 1.3135e+00, 1.4231e+00, 1.5383e+00, 3.7707e+05, 3.9035e+05,
        3.9461e+05, 3.9608e+05, 3.9715e+05, 3.9769e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377067.9375, 377073.7500, 377076.1562, 377087.8750,
        377088.7500, 377091.4375, 377092.0312, 377111.4062, 377113.4688,
        377115.7188, 761621.4375, 772332.4375, 775261.2500, 776399.3125,
        786945.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394588.1250, 394589.9062, 394590.8750, 394598.3125,
        394602.8438, 394605.8125, 394608.1875, 394608.9062, 394613.2500,
        394626.3438, 768724.0625, 776399.3125, 777766.0000, 779758.2500,
        781490.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2213e+00, 1.2749e+00, 1.2892e+00, 1.3433e+00, 1.3649e+00,
        1.3651e+00, 1.3679e+00, 1.3755e+00, 1.5714e+00, 3.7709e+05, 3.9034e+05,
        3.9463e+05, 3.9611e+05, 3.9714e+05, 3.9764e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2235e+00, 1.2637e+00, 1.2881e+00, 1.2892e+00, 1.3148e+00,
        1.3238e+00, 1.4055e+00, 1.4132e+00, 1.6298e+00, 3.7709e+05, 3.9034e+05,
        3.9461e+05, 3.9612e+05, 3.9715e+05, 3.9769e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1411e+00, 1.1657e+00, 1.1792e+00, 1.1931e+00, 1.2213e+00,
        1.2235e+00, 1.2417e+00, 1.2669e+00, 1.3912e+00, 3.7711e+05, 3.9035e+05,
        3.9459e+05, 3.9608e+05, 3.9713e+05, 3.9769e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0682e+00, 1.1641e+00, 1.1792e+00, 1.2014e+00, 1.2124e+00,
        1.3649e+00, 1.4132e+00, 1.4231e+00, 1.4373e+00, 3.7711e+05, 3.9033e+05,
        3.9460e+05, 3.9607e+05, 3.9717e+05, 3.9770e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2669e+00, 1.2754e+00, 1.2881e+00, 1.2911e+00, 1.3111e+00,
        1.3433e+00, 1.3923e+00, 1.4373e+00, 1.6586e+00, 3.7708e+05, 3.9034e+05,
        3.9459e+05, 3.9608e+05, 3.9716e+05, 3.9769e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0958e+00, 1.1641e+00, 1.1641e+00, 1.1657e+00, 1.2192e+00,
        1.3053e+00, 1.3111e+00, 1.3148e+00, 1.3755e+00, 3.7712e+05, 3.9034e+05,
        3.9459e+05, 3.9606e+05, 3.9714e+05, 3.9766e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396040.5938, 396063.6562, 396066.7500, 396074.5312,
        396076.5625, 396077.7188, 396081.5938, 396098.0625, 396107.2812,
        396115.0938, 768724.0625, 772332.4375, 783133.8125, 791439.0000,
        814962.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397640.0625, 397662.8438, 397688.2188, 397689.3125,
        397691.4062, 397691.6875, 397693.6250, 397696.0625, 397700.6562,
        397714.3750, 755151.4375, 777766.0000, 786945.1250, 791439.0000,
        793102.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0577e+00, 1.0682e+00, 1.0958e+00, 1.1411e+00, 1.1803e+00,
        1.3135e+00, 1.3651e+00, 1.3923e+00, 1.4055e+00, 3.7707e+05, 3.9031e+05,
        3.9461e+05, 3.9607e+05, 3.9715e+05, 3.9770e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37710.41', '390335.34', '37710.32', '397145.31', '37708.57', '377091.88', '394603.25', '37710.09', '37710.00', '37712.25', '37712.49', '37708.84', '37712.68', '396080.19', '397686.84', '37707.90']
estimated f for each client, fs: [6, 4, 6, 4, 6, 5, 4, 6, 6, 6, 6, 6, 6, 4, 4, 6]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [11, 13, 9, 19, 8, 16, 18, 7, 3, 10, 5, 1, 6, 17, 20, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0394s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:20...
global Accuracy on shared test data: 77.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:20, End: 2025-07-22 16:00:20)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 14, 13, 18, 10, 4, 3, 11, 7, 9, 17, 2, 8, 16, 12, 20], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9980e+05, 3.9193e+05, 4.0160e+05, 1.1338e+00, 1.6787e+00,
         1.1390e+00, 1.2320e+00, 1.1656e+00, 1.1895e+00, 3.8720e+05, 1.1594e+00,
         1.1209e+00, 3.7703e+05, 1.1858e+00, 4.0041e+05],
        [3.9980e+05, 0.0000e+00, 8.0667e+05, 7.8684e+05, 3.9978e+05, 3.9975e+05,
         3.9977e+05, 3.9979e+05, 3.9980e+05, 3.9975e+05, 7.7567e+05, 3.9980e+05,
         3.9979e+05, 7.8252e+05, 3.9976e+05, 7.7378e+05],
        [3.9193e+05, 8.0667e+05, 0.0000e+00, 7.9524e+05, 3.9191e+05, 3.9193e+05,
         3.9193e+05, 3.9192e+05, 3.9190e+05, 3.9191e+05, 7.8022e+05, 3.9192e+05,
         3.9193e+05, 7.6168e+05, 3.9191e+05, 7.6775e+05],
        [4.0160e+05, 7.8684e+05, 7.9524e+05, 0.0000e+00, 4.0160e+05, 4.0158e+05,
         4.0159e+05, 4.0161e+05, 4.0160e+05, 4.0159e+05, 7.8280e+05, 4.0161e+05,
         4.0162e+05, 7.8014e+05, 4.0158e+05, 8.1434e+05],
        [1.1338e+00, 3.9978e+05, 3.9191e+05, 4.0160e+05, 0.0000e+00, 1.3538e+00,
         1.0473e+00, 1.0714e+00, 1.0453e+00, 1.0774e+00, 3.8718e+05, 1.1131e+00,
         1.0603e+00, 3.7703e+05, 9.7879e-01, 4.0040e+05],
        [1.6787e+00, 3.9975e+05, 3.9193e+05, 4.0158e+05, 1.3538e+00, 0.0000e+00,
         1.7441e+00, 1.1278e+00, 1.6674e+00, 1.1955e+00, 3.8717e+05, 1.8334e+00,
         1.5915e+00, 3.7700e+05, 1.1476e+00, 4.0039e+05],
        [1.1390e+00, 3.9977e+05, 3.9193e+05, 4.0159e+05, 1.0473e+00, 1.7441e+00,
         0.0000e+00, 1.2430e+00, 1.1458e+00, 1.1930e+00, 3.8718e+05, 1.1028e+00,
         1.1121e+00, 3.7704e+05, 1.1349e+00, 4.0041e+05],
        [1.2320e+00, 3.9979e+05, 3.9192e+05, 4.0161e+05, 1.0714e+00, 1.1278e+00,
         1.2430e+00, 0.0000e+00, 1.1720e+00, 9.7339e-01, 3.8718e+05, 1.2441e+00,
         1.1637e+00, 3.7704e+05, 9.9701e-01, 4.0040e+05],
        [1.1656e+00, 3.9980e+05, 3.9190e+05, 4.0160e+05, 1.0453e+00, 1.6674e+00,
         1.1458e+00, 1.1720e+00, 0.0000e+00, 1.2133e+00, 3.8718e+05, 1.0759e+00,
         1.0937e+00, 3.7704e+05, 1.1741e+00, 4.0038e+05],
        [1.1895e+00, 3.9975e+05, 3.9191e+05, 4.0159e+05, 1.0774e+00, 1.1955e+00,
         1.1930e+00, 9.7339e-01, 1.2133e+00, 0.0000e+00, 3.8717e+05, 1.2497e+00,
         1.1083e+00, 3.7705e+05, 1.0079e+00, 4.0040e+05],
        [3.8720e+05, 7.7567e+05, 7.8022e+05, 7.8280e+05, 3.8718e+05, 3.8717e+05,
         3.8718e+05, 3.8718e+05, 3.8718e+05, 3.8717e+05, 0.0000e+00, 3.8720e+05,
         3.8721e+05, 7.7358e+05, 3.8717e+05, 7.7586e+05],
        [1.1594e+00, 3.9980e+05, 3.9192e+05, 4.0161e+05, 1.1131e+00, 1.8334e+00,
         1.1028e+00, 1.2441e+00, 1.0759e+00, 1.2497e+00, 3.8720e+05, 0.0000e+00,
         1.0977e+00, 3.7708e+05, 1.2245e+00, 4.0041e+05],
        [1.1209e+00, 3.9979e+05, 3.9193e+05, 4.0162e+05, 1.0603e+00, 1.5915e+00,
         1.1121e+00, 1.1637e+00, 1.0937e+00, 1.1083e+00, 3.8721e+05, 1.0977e+00,
         0.0000e+00, 3.7706e+05, 1.1211e+00, 4.0042e+05],
        [3.7703e+05, 7.8252e+05, 7.6168e+05, 7.8014e+05, 3.7703e+05, 3.7700e+05,
         3.7704e+05, 3.7704e+05, 3.7704e+05, 3.7705e+05, 7.7358e+05, 3.7708e+05,
         3.7706e+05, 0.0000e+00, 3.7704e+05, 7.6419e+05],
        [1.1858e+00, 3.9976e+05, 3.9191e+05, 4.0158e+05, 9.7879e-01, 1.1476e+00,
         1.1349e+00, 9.9701e-01, 1.1741e+00, 1.0079e+00, 3.8717e+05, 1.2245e+00,
         1.1211e+00, 3.7704e+05, 0.0000e+00, 4.0039e+05],
        [4.0041e+05, 7.7378e+05, 7.6775e+05, 8.1434e+05, 4.0040e+05, 4.0039e+05,
         4.0041e+05, 4.0040e+05, 4.0038e+05, 4.0040e+05, 7.7586e+05, 4.0041e+05,
         4.0042e+05, 7.6419e+05, 4.0039e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1209e+00, 1.1338e+00, 1.1390e+00, 1.1594e+00, 1.1656e+00,
        1.1858e+00, 1.1895e+00, 1.2320e+00, 1.6787e+00, 3.7703e+05, 3.8720e+05,
        3.9193e+05, 3.9980e+05, 4.0041e+05, 4.0160e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399750.4375, 399753.0000, 399761.1250, 399771.1875,
        399781.4688, 399788.0625, 399791.7188, 399797.8438, 399799.8438,
        399802.9375, 773776.6250, 775673.6250, 782524.0625, 786842.7500,
        806668.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391903.7500, 391906.1250, 391908.1562, 391911.4375,
        391918.0625, 391923.4062, 391926.0625, 391926.2500, 391926.7500,
        391927.9375, 761681.8750, 767751.6250, 780224.8125, 795242.3125,
        806668.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401581.2812, 401584.3438, 401587.5938, 401590.0625,
        401597.6875, 401599.5000, 401604.7188, 401609.0000, 401613.8125,
        401624.4062, 780140.4375, 782804.7500, 786842.7500, 795242.3125,
        814340.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7879e-01, 1.0453e+00, 1.0473e+00, 1.0603e+00, 1.0714e+00,
        1.0774e+00, 1.1131e+00, 1.1338e+00, 1.3538e+00, 3.7703e+05, 3.8718e+05,
        3.9191e+05, 3.9978e+05, 4.0040e+05, 4.0160e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1278e+00, 1.1476e+00, 1.1955e+00, 1.3538e+00, 1.5915e+00,
        1.6674e+00, 1.6787e+00, 1.7441e+00, 1.8334e+00, 3.7700e+05, 3.8717e+05,
        3.9193e+05, 3.9975e+05, 4.0039e+05, 4.0158e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0473e+00, 1.1028e+00, 1.1121e+00, 1.1349e+00, 1.1390e+00,
        1.1458e+00, 1.1930e+00, 1.2430e+00, 1.7441e+00, 3.7704e+05, 3.8718e+05,
        3.9193e+05, 3.9977e+05, 4.0041e+05, 4.0159e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7339e-01, 9.9701e-01, 1.0714e+00, 1.1278e+00, 1.1637e+00,
        1.1720e+00, 1.2320e+00, 1.2430e+00, 1.2441e+00, 3.7704e+05, 3.8718e+05,
        3.9192e+05, 3.9979e+05, 4.0040e+05, 4.0161e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0453e+00, 1.0759e+00, 1.0937e+00, 1.1458e+00, 1.1656e+00,
        1.1720e+00, 1.1741e+00, 1.2133e+00, 1.6674e+00, 3.7704e+05, 3.8718e+05,
        3.9190e+05, 3.9980e+05, 4.0038e+05, 4.0160e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7339e-01, 1.0079e+00, 1.0774e+00, 1.1083e+00, 1.1895e+00,
        1.1930e+00, 1.1955e+00, 1.2133e+00, 1.2497e+00, 3.7705e+05, 3.8717e+05,
        3.9191e+05, 3.9975e+05, 4.0040e+05, 4.0159e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387166.8125, 387168.8750, 387172.3750, 387182.3125,
        387182.4375, 387182.6250, 387184.1562, 387200.0312, 387204.3125,
        387205.1875, 773583.2500, 775673.6250, 775864.9375, 780224.8125,
        782804.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0759e+00, 1.0977e+00, 1.1028e+00, 1.1131e+00, 1.1594e+00,
        1.2245e+00, 1.2441e+00, 1.2497e+00, 1.8334e+00, 3.7708e+05, 3.8720e+05,
        3.9192e+05, 3.9980e+05, 4.0041e+05, 4.0161e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0603e+00, 1.0937e+00, 1.0977e+00, 1.1083e+00, 1.1121e+00,
        1.1209e+00, 1.1211e+00, 1.1637e+00, 1.5915e+00, 3.7706e+05, 3.8721e+05,
        3.9193e+05, 3.9979e+05, 4.0042e+05, 4.0162e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376999.4062, 377027.7812, 377034.4062, 377038.6875,
        377040.5000, 377042.1562, 377042.1562, 377046.8750, 377058.8438,
        377082.5312, 761681.8750, 764194.4375, 773583.2500, 780140.4375,
        782524.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7879e-01, 9.9701e-01, 1.0079e+00, 1.1211e+00, 1.1349e+00,
        1.1476e+00, 1.1741e+00, 1.1858e+00, 1.2245e+00, 3.7704e+05, 3.8717e+05,
        3.9191e+05, 3.9976e+05, 4.0039e+05, 4.0158e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400382.4688, 400385.7812, 400391.8438, 400396.6562,
        400398.5000, 400404.5312, 400405.4062, 400410.1250, 400410.9062,
        400420.6875, 764194.4375, 767751.6250, 773776.6250, 775864.9375,
        814340.8750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37704.54', '399779.75', '391917.81', '401599.25', '37703.76', '37701.27', '37705.30', '37705.07', '37705.29', '37705.70', '387184.94', '37709.36', '37706.93', '377041.34', '37704.87', '400400.69']
estimated f for each client, fs: [6, 4, 4, 4, 6, 6, 6, 6, 6, 6, 4, 6, 6, 5, 6, 4]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 14, 13, 18, 10, 4, 3, 11, 7, 9, 17, 2, 8, 16, 12, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0268s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:21...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:21, End: 2025-07-22 16:00:21)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 15, 4, 11, 12, 16, 7, 5, 8, 10, 1, 18, 2, 17, 9, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.7705e+05, 3.9452e+05, 3.9453e+05, 3.9451e+05, 7.9260e+05,
         3.9452e+05, 3.9452e+05, 3.9452e+05, 3.9452e+05, 3.9451e+05, 8.0143e+05,
         3.9453e+05, 7.9025e+05, 3.9454e+05, 3.9450e+05],
        [7.7705e+05, 0.0000e+00, 3.8133e+05, 3.8136e+05, 3.8136e+05, 7.9037e+05,
         3.8136e+05, 3.8136e+05, 3.8135e+05, 3.8134e+05, 3.8135e+05, 7.4528e+05,
         3.8137e+05, 7.7423e+05, 3.8134e+05, 3.8134e+05],
        [3.9452e+05, 3.8133e+05, 0.0000e+00, 1.2232e+00, 1.2042e+00, 3.8610e+05,
         1.7661e+00, 1.1854e+00, 1.6719e+00, 1.4517e+00, 1.7733e+00, 3.7995e+05,
         1.8593e+00, 3.8376e+05, 1.2780e+00, 1.3131e+00],
        [3.9453e+05, 3.8136e+05, 1.2232e+00, 0.0000e+00, 8.2957e-01, 3.8614e+05,
         9.2621e-01, 7.9327e-01, 9.3560e-01, 8.6317e-01, 9.8527e-01, 3.7996e+05,
         9.7204e-01, 3.8379e+05, 7.8729e-01, 7.6717e-01],
        [3.9451e+05, 3.8136e+05, 1.2042e+00, 8.2957e-01, 0.0000e+00, 3.8612e+05,
         1.0025e+00, 8.4624e-01, 9.7049e-01, 8.5598e-01, 1.0150e+00, 3.7994e+05,
         1.0392e+00, 3.8378e+05, 8.5939e-01, 8.0339e-01],
        [7.9260e+05, 7.9037e+05, 3.8610e+05, 3.8614e+05, 3.8612e+05, 0.0000e+00,
         3.8611e+05, 3.8612e+05, 3.8612e+05, 3.8614e+05, 3.8612e+05, 7.7629e+05,
         3.8612e+05, 7.6608e+05, 3.8611e+05, 3.8612e+05],
        [3.9452e+05, 3.8136e+05, 1.7661e+00, 9.2621e-01, 1.0025e+00, 3.8611e+05,
         0.0000e+00, 9.6420e-01, 9.2547e-01, 8.8771e-01, 9.9806e-01, 3.7997e+05,
         9.2457e-01, 3.8380e+05, 9.8539e-01, 9.4462e-01],
        [3.9452e+05, 3.8136e+05, 1.1854e+00, 7.9327e-01, 8.4624e-01, 3.8612e+05,
         9.6420e-01, 0.0000e+00, 1.0028e+00, 8.7632e-01, 1.0262e+00, 3.7995e+05,
         1.1353e+00, 3.8381e+05, 8.9871e-01, 8.2877e-01],
        [3.9452e+05, 3.8135e+05, 1.6719e+00, 9.3560e-01, 9.7049e-01, 3.8612e+05,
         9.2547e-01, 1.0028e+00, 0.0000e+00, 9.1039e-01, 9.6064e-01, 3.7992e+05,
         9.4768e-01, 3.8380e+05, 8.9231e-01, 9.2384e-01],
        [3.9452e+05, 3.8134e+05, 1.4517e+00, 8.6317e-01, 8.5598e-01, 3.8614e+05,
         8.8771e-01, 8.7632e-01, 9.1039e-01, 0.0000e+00, 9.5345e-01, 3.7995e+05,
         9.2322e-01, 3.8379e+05, 9.0994e-01, 8.3277e-01],
        [3.9451e+05, 3.8135e+05, 1.7733e+00, 9.8527e-01, 1.0150e+00, 3.8612e+05,
         9.9806e-01, 1.0262e+00, 9.6064e-01, 9.5345e-01, 0.0000e+00, 3.7995e+05,
         1.0037e+00, 3.8379e+05, 9.7719e-01, 9.2886e-01],
        [8.0143e+05, 7.4528e+05, 3.7995e+05, 3.7996e+05, 3.7994e+05, 7.7629e+05,
         3.7997e+05, 3.7995e+05, 3.7992e+05, 3.7995e+05, 3.7995e+05, 0.0000e+00,
         3.7995e+05, 7.6776e+05, 3.7995e+05, 3.7995e+05],
        [3.9453e+05, 3.8137e+05, 1.8593e+00, 9.7204e-01, 1.0392e+00, 3.8612e+05,
         9.2457e-01, 1.1353e+00, 9.4768e-01, 9.2322e-01, 1.0037e+00, 3.7995e+05,
         0.0000e+00, 3.8380e+05, 1.0084e+00, 9.8524e-01],
        [7.9025e+05, 7.7423e+05, 3.8376e+05, 3.8379e+05, 3.8378e+05, 7.6608e+05,
         3.8380e+05, 3.8381e+05, 3.8380e+05, 3.8379e+05, 3.8379e+05, 7.6776e+05,
         3.8380e+05, 0.0000e+00, 3.8378e+05, 3.8381e+05],
        [3.9454e+05, 3.8134e+05, 1.2780e+00, 7.8729e-01, 8.5939e-01, 3.8611e+05,
         9.8539e-01, 8.9871e-01, 8.9231e-01, 9.0994e-01, 9.7719e-01, 3.7995e+05,
         1.0084e+00, 3.8378e+05, 0.0000e+00, 8.6670e-01],
        [3.9450e+05, 3.8134e+05, 1.3131e+00, 7.6717e-01, 8.0339e-01, 3.8612e+05,
         9.4462e-01, 8.2877e-01, 9.2384e-01, 8.3277e-01, 9.2886e-01, 3.7995e+05,
         9.8524e-01, 3.8381e+05, 8.6670e-01, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 394500.5000, 394509.9688, 394514.2500, 394516.2500,
        394519.1562, 394519.7188, 394522.1875, 394524.7812, 394525.1250,
        394533.0625, 394535.8125, 777052.8750, 790251.2500, 792601.5000,
        801433.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 381327.2500, 381340.7812, 381341.0938, 381343.5312,
        381350.6250, 381353.7188, 381355.3750, 381356.6250, 381363.8125,
        381364.7500, 381372.5625, 745281.0000, 774226.6250, 777052.8750,
        790372.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.1854e+00, 1.2042e+00, 1.2232e+00, 1.2780e+00, 1.3131e+00,
        1.4517e+00, 1.6719e+00, 1.7661e+00, 1.7733e+00, 1.8593e+00, 3.7995e+05,
        3.8133e+05, 3.8376e+05, 3.8610e+05, 3.9452e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.6717e-01, 7.8729e-01, 7.9327e-01, 8.2957e-01, 8.6317e-01,
        9.2621e-01, 9.3560e-01, 9.7204e-01, 9.8527e-01, 1.2232e+00, 3.7996e+05,
        3.8136e+05, 3.8379e+05, 3.8614e+05, 3.9453e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0339e-01, 8.2957e-01, 8.4624e-01, 8.5598e-01, 8.5939e-01,
        9.7049e-01, 1.0025e+00, 1.0150e+00, 1.0392e+00, 1.2042e+00, 3.7994e+05,
        3.8136e+05, 3.8378e+05, 3.8612e+05, 3.9451e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386096.4688, 386111.2812, 386112.8750, 386116.3438,
        386117.9688, 386120.2188, 386123.4688, 386124.0000, 386124.9062,
        386142.0625, 386142.1875, 766075.0625, 776291.3125, 790372.1875,
        792601.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.8771e-01, 9.2457e-01, 9.2547e-01, 9.2621e-01, 9.4462e-01,
        9.6420e-01, 9.8539e-01, 9.9806e-01, 1.0025e+00, 1.7661e+00, 3.7997e+05,
        3.8136e+05, 3.8380e+05, 3.8611e+05, 3.9452e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.9327e-01, 8.2877e-01, 8.4624e-01, 8.7632e-01, 8.9871e-01,
        9.6420e-01, 1.0028e+00, 1.0262e+00, 1.1353e+00, 1.1854e+00, 3.7995e+05,
        3.8136e+05, 3.8381e+05, 3.8612e+05, 3.9452e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9231e-01, 9.1039e-01, 9.2384e-01, 9.2547e-01, 9.3560e-01,
        9.4768e-01, 9.6064e-01, 9.7049e-01, 1.0028e+00, 1.6719e+00, 3.7992e+05,
        3.8135e+05, 3.8380e+05, 3.8612e+05, 3.9452e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3277e-01, 8.5598e-01, 8.6317e-01, 8.7632e-01, 8.8771e-01,
        9.0994e-01, 9.1039e-01, 9.2322e-01, 9.5345e-01, 1.4517e+00, 3.7995e+05,
        3.8134e+05, 3.8379e+05, 3.8614e+05, 3.9452e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2886e-01, 9.5345e-01, 9.6064e-01, 9.7719e-01, 9.8527e-01,
        9.9806e-01, 1.0037e+00, 1.0150e+00, 1.0262e+00, 1.7733e+00, 3.7995e+05,
        3.8135e+05, 3.8379e+05, 3.8612e+05, 3.9451e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379919.9375, 379940.5938, 379947.3438, 379948.3438,
        379948.5625, 379949.9062, 379950.3438, 379950.4375, 379952.0000,
        379961.0625, 379966.8750, 745281.0000, 767757.9375, 776291.3125,
        801433.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.2322e-01, 9.2457e-01, 9.4768e-01, 9.7204e-01, 9.8524e-01,
        1.0037e+00, 1.0084e+00, 1.0392e+00, 1.1353e+00, 1.8593e+00, 3.7995e+05,
        3.8137e+05, 3.8380e+05, 3.8612e+05, 3.9453e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383761.1562, 383776.2188, 383779.7500, 383787.6875,
        383788.2188, 383788.5938, 383796.1875, 383799.1875, 383800.8438,
        383805.0625, 383807.9375, 766075.0625, 767757.9375, 774226.6250,
        790251.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 7.8729e-01, 8.5939e-01, 8.6670e-01, 8.9231e-01, 8.9871e-01,
        9.0994e-01, 9.7719e-01, 9.8539e-01, 1.0084e+00, 1.2780e+00, 3.7995e+05,
        3.8134e+05, 3.8378e+05, 3.8611e+05, 3.9454e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.6717e-01, 8.0339e-01, 8.2877e-01, 8.3277e-01, 8.6670e-01,
        9.2384e-01, 9.2886e-01, 9.4462e-01, 9.8524e-01, 1.3131e+00, 3.7995e+05,
        3.8134e+05, 3.8381e+05, 3.8612e+05, 3.9450e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['394520.09', '381351.81', '1.47', '0.91', '0.94', '386121.09', '1.03', '0.96', '1.01', '0.95', '1.06', '379948.69', '1.08', '383790.09', '0.95', '0.92']
estimated f for each client, fs: [3, 3, 5, 5, 5, 3, 5, 5, 5, 5, 5, 3, 5, 3, 5, 5]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 15, 4, 11, 12, 16, 7, 5, 8, 10, 1, 18, 2, 17, 9, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0127s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:21...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[167  70]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:21, End: 2025-07-22 16:00:21)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 8, 4, 10, 15, 13, 16, 20, 1, 17, 19, 11, 7, 2, 18, 9], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0130e+00, 8.7309e-01, 8.7086e-01, 3.9688e+05, 3.9876e+05,
         3.9659e+05, 3.8305e+05, 1.0318e+00, 3.8640e+05, 3.6378e+05, 9.7536e-01,
         9.7983e-01, 1.0420e+00, 3.8230e+05, 8.8824e-01],
        [1.0130e+00, 0.0000e+00, 1.3241e+00, 9.5968e-01, 3.9686e+05, 3.9875e+05,
         3.9661e+05, 3.8304e+05, 9.9623e-01, 3.8641e+05, 3.6381e+05, 1.3245e+00,
         9.6311e-01, 9.5731e-01, 3.8231e+05, 9.7543e-01],
        [8.7309e-01, 1.3241e+00, 0.0000e+00, 1.0935e+00, 3.9683e+05, 3.9876e+05,
         3.9656e+05, 3.8305e+05, 1.3541e+00, 3.8639e+05, 3.6380e+05, 6.2400e-01,
         1.2810e+00, 1.4374e+00, 3.8230e+05, 9.4789e-01],
        [8.7086e-01, 9.5968e-01, 1.0935e+00, 0.0000e+00, 3.9688e+05, 3.9874e+05,
         3.9659e+05, 3.8304e+05, 9.9620e-01, 3.8640e+05, 3.6379e+05, 1.1413e+00,
         9.0214e-01, 9.4426e-01, 3.8230e+05, 9.3628e-01],
        [3.9688e+05, 3.9686e+05, 3.9683e+05, 3.9688e+05, 0.0000e+00, 7.9457e+05,
         8.0322e+05, 7.7081e+05, 3.9686e+05, 7.8472e+05, 7.5347e+05, 3.9681e+05,
         3.9683e+05, 3.9684e+05, 7.7673e+05, 3.9686e+05],
        [3.9876e+05, 3.9875e+05, 3.9876e+05, 3.9874e+05, 7.9457e+05, 0.0000e+00,
         8.0812e+05, 7.9519e+05, 3.9872e+05, 7.8823e+05, 7.7933e+05, 3.9875e+05,
         3.9875e+05, 3.9877e+05, 7.8551e+05, 3.9876e+05],
        [3.9659e+05, 3.9661e+05, 3.9656e+05, 3.9659e+05, 8.0322e+05, 8.0812e+05,
         0.0000e+00, 8.0150e+05, 3.9660e+05, 7.7084e+05, 7.6585e+05, 3.9659e+05,
         3.9659e+05, 3.9658e+05, 7.8266e+05, 3.9659e+05],
        [3.8305e+05, 3.8304e+05, 3.8305e+05, 3.8304e+05, 7.7081e+05, 7.9519e+05,
         8.0150e+05, 0.0000e+00, 3.8304e+05, 7.7424e+05, 7.3682e+05, 3.8307e+05,
         3.8305e+05, 3.8302e+05, 7.7548e+05, 3.8304e+05],
        [1.0318e+00, 9.9623e-01, 1.3541e+00, 9.9620e-01, 3.9686e+05, 3.9872e+05,
         3.9660e+05, 3.8304e+05, 0.0000e+00, 3.8638e+05, 3.6378e+05, 1.3833e+00,
         1.0180e+00, 1.0309e+00, 3.8230e+05, 1.0113e+00],
        [3.8640e+05, 3.8641e+05, 3.8639e+05, 3.8640e+05, 7.8472e+05, 7.8823e+05,
         7.7084e+05, 7.7424e+05, 3.8638e+05, 0.0000e+00, 7.6728e+05, 3.8640e+05,
         3.8640e+05, 3.8641e+05, 7.7393e+05, 3.8641e+05],
        [3.6378e+05, 3.6381e+05, 3.6380e+05, 3.6379e+05, 7.5347e+05, 7.7933e+05,
         7.6585e+05, 7.3682e+05, 3.6378e+05, 7.6728e+05, 0.0000e+00, 3.6379e+05,
         3.6380e+05, 3.6379e+05, 7.6262e+05, 3.6378e+05],
        [9.7536e-01, 1.3245e+00, 6.2400e-01, 1.1413e+00, 3.9681e+05, 3.9875e+05,
         3.9659e+05, 3.8307e+05, 1.3833e+00, 3.8640e+05, 3.6379e+05, 0.0000e+00,
         1.2426e+00, 1.4062e+00, 3.8230e+05, 1.0038e+00],
        [9.7983e-01, 9.6311e-01, 1.2810e+00, 9.0214e-01, 3.9683e+05, 3.9875e+05,
         3.9659e+05, 3.8305e+05, 1.0180e+00, 3.8640e+05, 3.6380e+05, 1.2426e+00,
         0.0000e+00, 9.3182e-01, 3.8233e+05, 1.0083e+00],
        [1.0420e+00, 9.5731e-01, 1.4374e+00, 9.4426e-01, 3.9684e+05, 3.9877e+05,
         3.9658e+05, 3.8302e+05, 1.0309e+00, 3.8641e+05, 3.6379e+05, 1.4062e+00,
         9.3182e-01, 0.0000e+00, 3.8231e+05, 1.0539e+00],
        [3.8230e+05, 3.8231e+05, 3.8230e+05, 3.8230e+05, 7.7673e+05, 7.8551e+05,
         7.8266e+05, 7.7548e+05, 3.8230e+05, 7.7393e+05, 7.6262e+05, 3.8230e+05,
         3.8233e+05, 3.8231e+05, 0.0000e+00, 3.8230e+05],
        [8.8824e-01, 9.7543e-01, 9.4789e-01, 9.3628e-01, 3.9686e+05, 3.9876e+05,
         3.9659e+05, 3.8304e+05, 1.0113e+00, 3.8641e+05, 3.6378e+05, 1.0038e+00,
         1.0083e+00, 1.0539e+00, 3.8230e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.7086e-01, 8.7309e-01, 8.8824e-01, 9.7536e-01, 9.7983e-01,
        1.0130e+00, 1.0318e+00, 1.0420e+00, 3.6378e+05, 3.8230e+05, 3.8305e+05,
        3.8640e+05, 3.9659e+05, 3.9688e+05, 3.9876e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.5731e-01, 9.5968e-01, 9.6311e-01, 9.7543e-01, 9.9623e-01,
        1.0130e+00, 1.3241e+00, 1.3245e+00, 3.6381e+05, 3.8231e+05, 3.8304e+05,
        3.8641e+05, 3.9661e+05, 3.9686e+05, 3.9875e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.2400e-01, 8.7309e-01, 9.4789e-01, 1.0935e+00, 1.2810e+00,
        1.3241e+00, 1.3541e+00, 1.4374e+00, 3.6380e+05, 3.8230e+05, 3.8305e+05,
        3.8639e+05, 3.9656e+05, 3.9683e+05, 3.9876e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7086e-01, 9.0214e-01, 9.3628e-01, 9.4426e-01, 9.5968e-01,
        9.9620e-01, 1.0935e+00, 1.1413e+00, 3.6379e+05, 3.8230e+05, 3.8304e+05,
        3.8640e+05, 3.9659e+05, 3.9688e+05, 3.9874e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396814.8438, 396827.5938, 396832.7500, 396843.7812,
        396855.7500, 396858.5625, 396858.7500, 396880.5312, 396883.0312,
        753472.1875, 770805.9375, 776728.6250, 784716.3125, 794565.0625,
        803220.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398715.5625, 398741.8750, 398749.8750, 398750.9688,
        398752.4062, 398756.6250, 398761.0625, 398762.0000, 398770.5625,
        779327.8750, 785510.5000, 788225.3125, 794565.0625, 795191.5625,
        808124.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396563.9688, 396584.0000, 396587.2500, 396588.4375,
        396588.5000, 396590.9688, 396591.9062, 396600.4062, 396613.2500,
        765850.1875, 770835.5625, 782658.6250, 801497.3750, 803220.3750,
        808124.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383023.0625, 383036.5938, 383040.7188, 383040.7500,
        383043.4375, 383046.3125, 383046.7500, 383048.8750, 383069.8438,
        736819.0000, 770805.9375, 774244.8750, 775483.2500, 795191.5625,
        801497.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.9620e-01, 9.9623e-01, 1.0113e+00, 1.0180e+00, 1.0309e+00,
        1.0318e+00, 1.3541e+00, 1.3833e+00, 3.6378e+05, 3.8230e+05, 3.8304e+05,
        3.8638e+05, 3.9660e+05, 3.9686e+05, 3.9872e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386382.3125, 386385.0312, 386397.8438, 386398.2812,
        386399.3438, 386402.7188, 386405.6250, 386409.9688, 386410.1250,
        767283.3125, 770835.5625, 773931.5000, 774244.8750, 784716.3125,
        788225.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 363776.1250, 363777.7500, 363778.8438, 363785.6875,
        363786.3750, 363793.8750, 363799.0312, 363801.4688, 363808.1250,
        736819.0000, 753472.1875, 762616.8125, 765850.1875, 767283.3125,
        779327.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.2400e-01, 9.7536e-01, 1.0038e+00, 1.1413e+00, 1.2426e+00,
        1.3245e+00, 1.3833e+00, 1.4062e+00, 3.6379e+05, 3.8230e+05, 3.8307e+05,
        3.8640e+05, 3.9659e+05, 3.9681e+05, 3.9875e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.0214e-01, 9.3182e-01, 9.6311e-01, 9.7983e-01, 1.0083e+00,
        1.0180e+00, 1.2426e+00, 1.2810e+00, 3.6380e+05, 3.8233e+05, 3.8305e+05,
        3.8640e+05, 3.9659e+05, 3.9683e+05, 3.9875e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.3182e-01, 9.4426e-01, 9.5731e-01, 1.0309e+00, 1.0420e+00,
        1.0539e+00, 1.4062e+00, 1.4374e+00, 3.6379e+05, 3.8231e+05, 3.8302e+05,
        3.8641e+05, 3.9658e+05, 3.9684e+05, 3.9877e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382297.3750, 382298.5312, 382298.5625, 382299.3125,
        382301.2500, 382302.0000, 382311.2500, 382314.8750, 382333.2500,
        762616.8125, 773931.5000, 775483.2500, 776728.6250, 782658.6250,
        785510.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8824e-01, 9.3628e-01, 9.4789e-01, 9.7543e-01, 1.0038e+00,
        1.0083e+00, 1.0113e+00, 1.0539e+00, 3.6378e+05, 3.8230e+05, 3.8304e+05,
        3.8641e+05, 3.9659e+05, 3.9686e+05, 3.9876e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['74608.23', '74613.14', '74610.65', '74609.54', '432512.81', '436808.91', '433515.91', '418421.56', '74608.59', '424487.44', '401092.66', '74610.49', '74614.30', '74610.57', '420337.31', '74608.41']
estimated f for each client, fs: [7, 7, 7, 7, 5, 5, 5, 5, 7, 5, 6, 7, 7, 7, 5, 7]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 8, 4, 10, 15, 13, 16, 20, 1, 17, 19, 11, 7, 2, 18, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0273s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:22...
global Accuracy on shared test data: 73.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 75 188]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:22, End: 2025-07-22 16:00:22)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 15, 18, 20, 3, 1, 9, 13, 17, 10, 5, 2, 7, 19, 11, 14], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8340e+05, 3.8196e+05, 3.9374e+05, 1.3860e+00, 1.4293e+00,
         9.8671e-01, 3.8904e+05, 3.9776e+05, 1.1050e+00, 9.2549e-01, 1.5153e+00,
         1.3209e+00, 3.9578e+05, 6.0760e-01, 3.8537e+05],
        [3.8340e+05, 0.0000e+00, 7.5183e+05, 7.7058e+05, 3.8339e+05, 3.8340e+05,
         3.8340e+05, 7.9039e+05, 7.9045e+05, 3.8340e+05, 3.8339e+05, 3.8341e+05,
         3.8338e+05, 7.8604e+05, 3.8340e+05, 7.9754e+05],
        [3.8196e+05, 7.5183e+05, 0.0000e+00, 7.7885e+05, 3.8197e+05, 3.8198e+05,
         3.8197e+05, 7.7048e+05, 7.9347e+05, 3.8197e+05, 3.8196e+05, 3.8197e+05,
         3.8198e+05, 7.6788e+05, 3.8196e+05, 7.7934e+05],
        [3.9374e+05, 7.7058e+05, 7.7885e+05, 0.0000e+00, 3.9377e+05, 3.9376e+05,
         3.9377e+05, 7.6876e+05, 7.5655e+05, 3.9378e+05, 3.9377e+05, 3.9374e+05,
         3.9379e+05, 7.9487e+05, 3.9376e+05, 7.8533e+05],
        [1.3860e+00, 3.8339e+05, 3.8197e+05, 3.9377e+05, 0.0000e+00, 9.8371e-01,
         9.7145e-01, 3.8906e+05, 3.9775e+05, 9.0333e-01, 1.0452e+00, 9.6575e-01,
         9.8588e-01, 3.9578e+05, 1.1633e+00, 3.8536e+05],
        [1.4293e+00, 3.8340e+05, 3.8198e+05, 3.9376e+05, 9.8371e-01, 0.0000e+00,
         9.9651e-01, 3.8908e+05, 3.9774e+05, 9.9353e-01, 1.0798e+00, 1.0302e+00,
         1.0312e+00, 3.9578e+05, 1.2332e+00, 3.8536e+05],
        [9.8671e-01, 3.8340e+05, 3.8197e+05, 3.9377e+05, 9.7145e-01, 9.9651e-01,
         0.0000e+00, 3.8906e+05, 3.9775e+05, 8.9491e-01, 9.2143e-01, 1.0108e+00,
         9.9897e-01, 3.9578e+05, 8.5434e-01, 3.8536e+05],
        [3.8904e+05, 7.9039e+05, 7.7048e+05, 7.6876e+05, 3.8906e+05, 3.8908e+05,
         3.8906e+05, 0.0000e+00, 7.7313e+05, 3.8909e+05, 3.8908e+05, 3.8909e+05,
         3.8907e+05, 7.8165e+05, 3.8905e+05, 7.6704e+05],
        [3.9776e+05, 7.9045e+05, 7.9347e+05, 7.5655e+05, 3.9775e+05, 3.9774e+05,
         3.9775e+05, 7.7313e+05, 0.0000e+00, 3.9777e+05, 3.9774e+05, 3.9775e+05,
         3.9775e+05, 7.9636e+05, 3.9776e+05, 7.7713e+05],
        [1.1050e+00, 3.8340e+05, 3.8197e+05, 3.9378e+05, 9.0333e-01, 9.9353e-01,
         8.9491e-01, 3.8909e+05, 3.9777e+05, 0.0000e+00, 8.9592e-01, 9.5952e-01,
         9.0741e-01, 3.9579e+05, 9.4352e-01, 3.8533e+05],
        [9.2549e-01, 3.8339e+05, 3.8196e+05, 3.9377e+05, 1.0452e+00, 1.0798e+00,
         9.2143e-01, 3.8908e+05, 3.9774e+05, 8.9592e-01, 0.0000e+00, 1.1635e+00,
         9.7291e-01, 3.9578e+05, 8.1223e-01, 3.8537e+05],
        [1.5153e+00, 3.8341e+05, 3.8197e+05, 3.9374e+05, 9.6575e-01, 1.0302e+00,
         1.0108e+00, 3.8909e+05, 3.9775e+05, 9.5952e-01, 1.1635e+00, 0.0000e+00,
         9.7156e-01, 3.9580e+05, 1.2326e+00, 3.8534e+05],
        [1.3209e+00, 3.8338e+05, 3.8198e+05, 3.9379e+05, 9.8588e-01, 1.0312e+00,
         9.9897e-01, 3.8907e+05, 3.9775e+05, 9.0741e-01, 9.7291e-01, 9.7156e-01,
         0.0000e+00, 3.9579e+05, 1.0863e+00, 3.8535e+05],
        [3.9578e+05, 7.8604e+05, 7.6788e+05, 7.9487e+05, 3.9578e+05, 3.9578e+05,
         3.9578e+05, 7.8165e+05, 7.9636e+05, 3.9579e+05, 3.9578e+05, 3.9580e+05,
         3.9579e+05, 0.0000e+00, 3.9578e+05, 7.8290e+05],
        [6.0760e-01, 3.8340e+05, 3.8196e+05, 3.9376e+05, 1.1633e+00, 1.2332e+00,
         8.5434e-01, 3.8905e+05, 3.9776e+05, 9.4352e-01, 8.1223e-01, 1.2326e+00,
         1.0863e+00, 3.9578e+05, 0.0000e+00, 3.8536e+05],
        [3.8537e+05, 7.9754e+05, 7.7934e+05, 7.8533e+05, 3.8536e+05, 3.8536e+05,
         3.8536e+05, 7.6704e+05, 7.7713e+05, 3.8533e+05, 3.8537e+05, 3.8534e+05,
         3.8535e+05, 7.8290e+05, 3.8536e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 6.0760e-01, 9.2549e-01, 9.8671e-01, 1.1050e+00, 1.3209e+00,
        1.3860e+00, 1.4293e+00, 1.5153e+00, 3.8196e+05, 3.8340e+05, 3.8537e+05,
        3.8904e+05, 3.9374e+05, 3.9578e+05, 3.9776e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383384.0625, 383387.1562, 383393.0000, 383396.1250,
        383399.5625, 383400.1562, 383400.6875, 383404.0938, 383408.5312,
        751830.1875, 770578.6875, 786042.7500, 790389.5000, 790451.6875,
        797542.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381956.5938, 381959.0000, 381959.8438, 381965.8125,
        381971.6562, 381972.3438, 381973.6562, 381977.1562, 381979.4062,
        751830.1875, 767879.0000, 770484.6875, 778854.0625, 779339.0625,
        793467.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393738.1875, 393740.3125, 393756.5000, 393758.5000,
        393767.6562, 393770.2188, 393771.1875, 393781.8125, 393785.5625,
        756545.1250, 768756.1875, 770578.6875, 778854.0625, 785330.1250,
        794872.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.0333e-01, 9.6575e-01, 9.7145e-01, 9.8371e-01, 9.8588e-01,
        1.0452e+00, 1.1633e+00, 1.3860e+00, 3.8197e+05, 3.8339e+05, 3.8536e+05,
        3.8906e+05, 3.9377e+05, 3.9578e+05, 3.9775e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8371e-01, 9.9353e-01, 9.9651e-01, 1.0302e+00, 1.0312e+00,
        1.0798e+00, 1.2332e+00, 1.4293e+00, 3.8198e+05, 3.8340e+05, 3.8536e+05,
        3.8908e+05, 3.9376e+05, 3.9578e+05, 3.9774e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.5434e-01, 8.9491e-01, 9.2143e-01, 9.7145e-01, 9.8671e-01,
        9.9651e-01, 9.9897e-01, 1.0108e+00, 3.8197e+05, 3.8340e+05, 3.8536e+05,
        3.8906e+05, 3.9377e+05, 3.9578e+05, 3.9775e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389038.3750, 389053.9688, 389055.5000, 389058.3125,
        389068.5000, 389076.1250, 389078.6562, 389085.7812, 389085.9062,
        767038.6250, 768756.1875, 770484.6875, 773131.6875, 781648.3125,
        790389.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397739.4688, 397743.4688, 397748.4375, 397748.5625,
        397748.5625, 397753.8750, 397757.8438, 397764.9375, 397772.0625,
        756545.1250, 773131.6875, 777133.4375, 790451.6875, 793467.1875,
        796355.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9491e-01, 8.9592e-01, 9.0333e-01, 9.0741e-01, 9.4352e-01,
        9.5952e-01, 9.9353e-01, 1.1050e+00, 3.8197e+05, 3.8340e+05, 3.8533e+05,
        3.8909e+05, 3.9378e+05, 3.9579e+05, 3.9777e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.1223e-01, 8.9592e-01, 9.2143e-01, 9.2549e-01, 9.7291e-01,
        1.0452e+00, 1.0798e+00, 1.1635e+00, 3.8196e+05, 3.8339e+05, 3.8537e+05,
        3.8908e+05, 3.9377e+05, 3.9578e+05, 3.9774e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.5952e-01, 9.6575e-01, 9.7156e-01, 1.0108e+00, 1.0302e+00,
        1.1635e+00, 1.2326e+00, 1.5153e+00, 3.8197e+05, 3.8341e+05, 3.8534e+05,
        3.8909e+05, 3.9374e+05, 3.9580e+05, 3.9775e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.0741e-01, 9.7156e-01, 9.7291e-01, 9.8588e-01, 9.9897e-01,
        1.0312e+00, 1.0863e+00, 1.3209e+00, 3.8198e+05, 3.8338e+05, 3.8535e+05,
        3.8907e+05, 3.9379e+05, 3.9579e+05, 3.9775e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395779.0000, 395779.9062, 395780.0625, 395782.9375,
        395783.5938, 395784.5625, 395786.2812, 395793.8750, 395795.4062,
        767879.0000, 781648.3125, 782899.1875, 786042.7500, 794872.5625,
        796355.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.0760e-01, 8.1223e-01, 8.5434e-01, 9.4352e-01, 1.0863e+00,
        1.1633e+00, 1.2326e+00, 1.2332e+00, 3.8196e+05, 3.8340e+05, 3.8536e+05,
        3.8905e+05, 3.9376e+05, 3.9578e+05, 3.9776e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385333.5938, 385344.5000, 385353.8125, 385356.5938,
        385358.7500, 385358.8750, 385361.1250, 385365.8438, 385370.5000,
        767038.6250, 777133.4375, 779339.0625, 782899.1875, 785330.1250,
        797542.6250])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76536.45', '420240.34', '418954.56', '430041.56', '76536.92', '76538.61', '76537.42', '426864.00', '433632.19', '76537.95', '76535.75', '76538.90', '76537.18', '432994.44', '76537.20', '423524.19']
estimated f for each client, fs: [7, 5, 5, 5, 7, 7, 7, 5, 5, 7, 7, 7, 7, 5, 7, 5]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 15, 18, 20, 3, 1, 9, 13, 17, 10, 5, 2, 7, 19, 11, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:22...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 72 191]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:22, End: 2025-07-22 16:00:22)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 1, 4, 18, 12, 9, 16, 2, 6, 14, 8, 10, 13, 17, 5, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0121e+00, 1.3307e+00, 4.0115e+05, 1.1145e+00, 1.0058e+00,
         3.8864e+05, 1.0029e+00, 1.0140e+00, 3.7784e+05, 1.0082e+00, 9.1855e-01,
         3.8834e+05, 3.8379e+05, 1.4751e+00, 3.9728e+05],
        [1.0121e+00, 0.0000e+00, 1.3824e+00, 4.0115e+05, 1.1861e+00, 9.7946e-01,
         3.8864e+05, 1.0676e+00, 1.0213e+00, 3.7783e+05, 1.0038e+00, 9.8793e-01,
         3.8836e+05, 3.8379e+05, 1.5578e+00, 3.9726e+05],
        [1.3307e+00, 1.3824e+00, 0.0000e+00, 4.0118e+05, 5.9554e-01, 9.5004e-01,
         3.8862e+05, 1.4807e+00, 9.1164e-01, 3.7783e+05, 1.2675e+00, 1.0585e+00,
         3.8835e+05, 3.8378e+05, 6.6946e-01, 3.9728e+05],
        [4.0115e+05, 4.0115e+05, 4.0118e+05, 0.0000e+00, 4.0117e+05, 4.0113e+05,
         7.9030e+05, 4.0115e+05, 4.0114e+05, 7.7860e+05, 4.0116e+05, 4.0115e+05,
         7.9256e+05, 8.0607e+05, 4.0116e+05, 7.9397e+05],
        [1.1145e+00, 1.1861e+00, 5.9554e-01, 4.0117e+05, 0.0000e+00, 8.8543e-01,
         3.8862e+05, 1.2606e+00, 8.2683e-01, 3.7783e+05, 1.1276e+00, 9.2447e-01,
         3.8838e+05, 3.8380e+05, 7.8900e-01, 3.9728e+05],
        [1.0058e+00, 9.7946e-01, 9.5004e-01, 4.0113e+05, 8.8543e-01, 0.0000e+00,
         3.8864e+05, 1.0477e+00, 8.9437e-01, 3.7785e+05, 9.6334e-01, 8.9013e-01,
         3.8834e+05, 3.8380e+05, 1.1647e+00, 3.9727e+05],
        [3.8864e+05, 3.8864e+05, 3.8862e+05, 7.9030e+05, 3.8862e+05, 3.8864e+05,
         0.0000e+00, 3.8866e+05, 3.8866e+05, 7.6802e+05, 3.8862e+05, 3.8863e+05,
         7.6664e+05, 7.7320e+05, 3.8862e+05, 8.0002e+05],
        [1.0029e+00, 1.0676e+00, 1.4807e+00, 4.0115e+05, 1.2606e+00, 1.0477e+00,
         3.8866e+05, 0.0000e+00, 1.0964e+00, 3.7783e+05, 1.0078e+00, 9.6283e-01,
         3.8833e+05, 3.8377e+05, 1.6994e+00, 3.9727e+05],
        [1.0140e+00, 1.0213e+00, 9.1164e-01, 4.0114e+05, 8.2683e-01, 8.9437e-01,
         3.8866e+05, 1.0964e+00, 0.0000e+00, 3.7785e+05, 9.8941e-01, 8.6664e-01,
         3.8836e+05, 3.8379e+05, 1.1191e+00, 3.9727e+05],
        [3.7784e+05, 3.7783e+05, 3.7783e+05, 7.7860e+05, 3.7783e+05, 3.7785e+05,
         7.6802e+05, 3.7783e+05, 3.7785e+05, 0.0000e+00, 3.7785e+05, 3.7785e+05,
         7.7144e+05, 7.9102e+05, 3.7785e+05, 7.7430e+05],
        [1.0082e+00, 1.0038e+00, 1.2675e+00, 4.0116e+05, 1.1276e+00, 9.6334e-01,
         3.8862e+05, 1.0078e+00, 9.8941e-01, 3.7785e+05, 0.0000e+00, 9.3767e-01,
         3.8833e+05, 3.8378e+05, 1.4848e+00, 3.9725e+05],
        [9.1855e-01, 9.8793e-01, 1.0585e+00, 4.0115e+05, 9.2447e-01, 8.9013e-01,
         3.8863e+05, 9.6283e-01, 8.6664e-01, 3.7785e+05, 9.3767e-01, 0.0000e+00,
         3.8837e+05, 3.8378e+05, 1.2319e+00, 3.9727e+05],
        [3.8834e+05, 3.8836e+05, 3.8835e+05, 7.9256e+05, 3.8838e+05, 3.8834e+05,
         7.6664e+05, 3.8833e+05, 3.8836e+05, 7.7144e+05, 3.8833e+05, 3.8837e+05,
         0.0000e+00, 7.7730e+05, 3.8836e+05, 7.6346e+05],
        [3.8379e+05, 3.8379e+05, 3.8378e+05, 8.0607e+05, 3.8380e+05, 3.8380e+05,
         7.7320e+05, 3.8377e+05, 3.8379e+05, 7.9102e+05, 3.8378e+05, 3.8378e+05,
         7.7730e+05, 0.0000e+00, 3.8378e+05, 7.8340e+05],
        [1.4751e+00, 1.5578e+00, 6.6946e-01, 4.0116e+05, 7.8900e-01, 1.1647e+00,
         3.8862e+05, 1.6994e+00, 1.1191e+00, 3.7785e+05, 1.4848e+00, 1.2319e+00,
         3.8836e+05, 3.8378e+05, 0.0000e+00, 3.9726e+05],
        [3.9728e+05, 3.9726e+05, 3.9728e+05, 7.9397e+05, 3.9728e+05, 3.9727e+05,
         8.0002e+05, 3.9727e+05, 3.9727e+05, 7.7430e+05, 3.9725e+05, 3.9727e+05,
         7.6346e+05, 7.8340e+05, 3.9726e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.1855e-01, 1.0029e+00, 1.0058e+00, 1.0082e+00, 1.0121e+00,
        1.0140e+00, 1.1145e+00, 1.3307e+00, 1.4751e+00, 3.7784e+05, 3.8379e+05,
        3.8834e+05, 3.8864e+05, 3.9728e+05, 4.0115e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7946e-01, 9.8793e-01, 1.0038e+00, 1.0121e+00, 1.0213e+00,
        1.0676e+00, 1.1861e+00, 1.3824e+00, 1.5578e+00, 3.7783e+05, 3.8379e+05,
        3.8836e+05, 3.8864e+05, 3.9726e+05, 4.0115e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.9554e-01, 6.6946e-01, 9.1164e-01, 9.5004e-01, 1.0585e+00,
        1.2675e+00, 1.3307e+00, 1.3824e+00, 1.4807e+00, 3.7783e+05, 3.8378e+05,
        3.8835e+05, 3.8862e+05, 3.9728e+05, 4.0118e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401131.0938, 401141.7188, 401145.2812, 401146.2188,
        401148.1875, 401151.0938, 401158.6562, 401160.6875, 401167.5312,
        401182.8750, 778601.8125, 790303.6250, 792561.6250, 793969.9375,
        806068.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.9554e-01, 7.8900e-01, 8.2683e-01, 8.8543e-01, 9.2447e-01,
        1.1145e+00, 1.1276e+00, 1.1861e+00, 1.2606e+00, 3.7783e+05, 3.8380e+05,
        3.8838e+05, 3.8862e+05, 3.9728e+05, 4.0117e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8543e-01, 8.9013e-01, 8.9437e-01, 9.5004e-01, 9.6334e-01,
        9.7946e-01, 1.0058e+00, 1.0477e+00, 1.1647e+00, 3.7785e+05, 3.8380e+05,
        3.8834e+05, 3.8864e+05, 3.9727e+05, 4.0113e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388619.7812, 388621.5000, 388621.6875, 388621.9375,
        388630.1250, 388636.2500, 388636.9688, 388638.3125, 388655.8125,
        388656.4688, 766644.0000, 768018.6250, 773200.6875, 790303.6250,
        800015.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.6283e-01, 1.0029e+00, 1.0078e+00, 1.0477e+00, 1.0676e+00,
        1.0964e+00, 1.2606e+00, 1.4807e+00, 1.6994e+00, 3.7783e+05, 3.8377e+05,
        3.8833e+05, 3.8866e+05, 3.9727e+05, 4.0115e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.2683e-01, 8.6664e-01, 8.9437e-01, 9.1164e-01, 9.8941e-01,
        1.0140e+00, 1.0213e+00, 1.0964e+00, 1.1191e+00, 3.7785e+05, 3.8379e+05,
        3.8836e+05, 3.8866e+05, 3.9727e+05, 4.0114e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377825.4062, 377828.8125, 377829.0625, 377832.6250,
        377841.8750, 377846.1250, 377846.3125, 377847.5312, 377850.0312,
        377852.2812, 768018.6250, 771444.3750, 774298.5000, 778601.8125,
        791021.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.3767e-01, 9.6334e-01, 9.8941e-01, 1.0038e+00, 1.0078e+00,
        1.0082e+00, 1.1276e+00, 1.2675e+00, 1.4848e+00, 3.7785e+05, 3.8378e+05,
        3.8833e+05, 3.8862e+05, 3.9725e+05, 4.0116e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6664e-01, 8.9013e-01, 9.1855e-01, 9.2447e-01, 9.3767e-01,
        9.6283e-01, 9.8793e-01, 1.0585e+00, 1.2319e+00, 3.7785e+05, 3.8378e+05,
        3.8837e+05, 3.8863e+05, 3.9727e+05, 4.0115e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388331.0938, 388333.4062, 388340.6875, 388344.3125,
        388351.5938, 388355.4062, 388360.7188, 388362.1875, 388371.6250,
        388377.5312, 763456.4375, 766644.0000, 771444.3750, 777298.1250,
        792561.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383768.1250, 383776.4062, 383777.5000, 383780.7188,
        383784.1250, 383787.4062, 383788.6562, 383792.7500, 383796.1875,
        383803.0625, 773200.6875, 777298.1250, 783402.7500, 791021.7500,
        806068.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.6946e-01, 7.8900e-01, 1.1191e+00, 1.1647e+00, 1.2319e+00,
        1.4751e+00, 1.4848e+00, 1.5578e+00, 1.6994e+00, 3.7785e+05, 3.8378e+05,
        3.8836e+05, 3.8862e+05, 3.9726e+05, 4.0116e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397247.2812, 397263.0625, 397264.4062, 397269.1875,
        397272.0625, 397272.7500, 397274.0625, 397275.0938, 397276.6875,
        397282.5938, 763456.4375, 774298.5000, 783402.7500, 793969.9375,
        800015.5000])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37785.17', '37783.56', '37784.23', '401153.34', '37783.75', '37785.51', '388633.91', '37783.96', '37786.10', '377839.97', '37785.59', '37785.63', '388352.84', '383785.50', '37786.12', '397269.69']
estimated f for each client, fs: [6, 6, 6, 4, 6, 6, 4, 6, 6, 5, 6, 6, 4, 5, 6, 4]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 1, 4, 18, 12, 9, 16, 2, 6, 14, 8, 10, 13, 17, 5, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0147s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:23...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[188  49]
 [ 78 185]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:23, End: 2025-07-22 16:00:23)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 15, 11, 19, 8, 13, 9, 12, 17, 10, 4, 2, 14, 6, 16, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9925e+05, 1.0724e+00, 4.0069e+05, 1.2656e+00, 3.9784e+05,
         1.0443e+00, 1.0420e+00, 3.7549e+05, 1.1092e+00, 1.0399e+00, 1.3720e+00,
         3.9489e+05, 1.1007e+00, 4.0547e+05, 3.9341e+05],
        [3.9925e+05, 0.0000e+00, 3.9918e+05, 8.0899e+05, 3.9920e+05, 8.0399e+05,
         3.9922e+05, 3.9920e+05, 7.7146e+05, 3.9921e+05, 3.9923e+05, 3.9921e+05,
         7.8650e+05, 3.9923e+05, 8.0780e+05, 7.9166e+05],
        [1.0724e+00, 3.9918e+05, 0.0000e+00, 4.0068e+05, 1.2654e+00, 3.9786e+05,
         9.4486e-01, 7.8820e-01, 3.7551e+05, 1.0626e+00, 7.3186e-01, 1.3727e+00,
         3.9487e+05, 9.6800e-01, 4.0546e+05, 3.9341e+05],
        [4.0069e+05, 8.0899e+05, 4.0068e+05, 0.0000e+00, 4.0071e+05, 7.9599e+05,
         4.0066e+05, 4.0068e+05, 7.5885e+05, 4.0065e+05, 4.0069e+05, 4.0069e+05,
         7.9213e+05, 4.0066e+05, 8.3195e+05, 8.0395e+05],
        [1.2656e+00, 3.9920e+05, 1.2654e+00, 4.0071e+05, 0.0000e+00, 3.9784e+05,
         1.0544e+00, 1.2178e+00, 3.7548e+05, 1.0715e+00, 1.4150e+00, 1.0880e+00,
         3.9488e+05, 1.1373e+00, 4.0545e+05, 3.9339e+05],
        [3.9784e+05, 8.0399e+05, 3.9786e+05, 7.9599e+05, 3.9784e+05, 0.0000e+00,
         3.9787e+05, 3.9784e+05, 7.7423e+05, 3.9783e+05, 3.9785e+05, 3.9784e+05,
         7.6513e+05, 3.9786e+05, 8.1166e+05, 8.1029e+05],
        [1.0443e+00, 3.9922e+05, 9.4486e-01, 4.0066e+05, 1.0544e+00, 3.9787e+05,
         0.0000e+00, 9.7998e-01, 3.7549e+05, 9.8573e-01, 1.0516e+00, 1.1490e+00,
         3.9490e+05, 1.0087e+00, 4.0546e+05, 3.9340e+05],
        [1.0420e+00, 3.9920e+05, 7.8820e-01, 4.0068e+05, 1.2178e+00, 3.9784e+05,
         9.7998e-01, 0.0000e+00, 3.7551e+05, 1.0089e+00, 7.1376e-01, 1.3656e+00,
         3.9489e+05, 9.7246e-01, 4.0544e+05, 3.9339e+05],
        [3.7549e+05, 7.7146e+05, 3.7551e+05, 7.5885e+05, 3.7548e+05, 7.7423e+05,
         3.7549e+05, 3.7551e+05, 0.0000e+00, 3.7552e+05, 3.7549e+05, 3.7549e+05,
         7.5134e+05, 3.7551e+05, 7.8771e+05, 7.7552e+05],
        [1.1092e+00, 3.9921e+05, 1.0626e+00, 4.0065e+05, 1.0715e+00, 3.9783e+05,
         9.8573e-01, 1.0089e+00, 3.7552e+05, 0.0000e+00, 1.1773e+00, 1.0650e+00,
         3.9487e+05, 9.9226e-01, 4.0545e+05, 3.9340e+05],
        [1.0399e+00, 3.9923e+05, 7.3186e-01, 4.0069e+05, 1.4150e+00, 3.9785e+05,
         1.0516e+00, 7.1376e-01, 3.7549e+05, 1.1773e+00, 0.0000e+00, 1.6675e+00,
         3.9488e+05, 1.1006e+00, 4.0546e+05, 3.9338e+05],
        [1.3720e+00, 3.9921e+05, 1.3727e+00, 4.0069e+05, 1.0880e+00, 3.9784e+05,
         1.1490e+00, 1.3656e+00, 3.7549e+05, 1.0650e+00, 1.6675e+00, 0.0000e+00,
         3.9485e+05, 1.1779e+00, 4.0545e+05, 3.9343e+05],
        [3.9489e+05, 7.8650e+05, 3.9487e+05, 7.9213e+05, 3.9488e+05, 7.6513e+05,
         3.9490e+05, 3.9489e+05, 7.5134e+05, 3.9487e+05, 3.9488e+05, 3.9485e+05,
         0.0000e+00, 3.9488e+05, 8.0055e+05, 7.6860e+05],
        [1.1007e+00, 3.9923e+05, 9.6800e-01, 4.0066e+05, 1.1373e+00, 3.9786e+05,
         1.0087e+00, 9.7246e-01, 3.7551e+05, 9.9226e-01, 1.1006e+00, 1.1779e+00,
         3.9488e+05, 0.0000e+00, 4.0542e+05, 3.9341e+05],
        [4.0547e+05, 8.0780e+05, 4.0546e+05, 8.3195e+05, 4.0545e+05, 8.1166e+05,
         4.0546e+05, 4.0544e+05, 7.8771e+05, 4.0545e+05, 4.0546e+05, 4.0545e+05,
         8.0055e+05, 4.0542e+05, 0.0000e+00, 7.8977e+05],
        [3.9341e+05, 7.9166e+05, 3.9341e+05, 8.0395e+05, 3.9339e+05, 8.1029e+05,
         3.9340e+05, 3.9339e+05, 7.7552e+05, 3.9340e+05, 3.9338e+05, 3.9343e+05,
         7.6860e+05, 3.9341e+05, 7.8977e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0399e+00, 1.0420e+00, 1.0443e+00, 1.0724e+00, 1.1007e+00,
        1.1092e+00, 1.2656e+00, 1.3720e+00, 3.7549e+05, 3.9341e+05, 3.9489e+05,
        3.9784e+05, 3.9925e+05, 4.0069e+05, 4.0547e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399180.5938, 399196.4062, 399196.5312, 399206.0312,
        399209.3438, 399217.3438, 399227.3750, 399233.9375, 399249.3125,
        771457.9375, 786496.0000, 791661.6250, 803993.6250, 807800.1250,
        808992.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.3186e-01, 7.8820e-01, 9.4486e-01, 9.6800e-01, 1.0626e+00,
        1.0724e+00, 1.2654e+00, 1.3727e+00, 3.7551e+05, 3.9341e+05, 3.9487e+05,
        3.9786e+05, 3.9918e+05, 4.0068e+05, 4.0546e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400649.0312, 400656.2500, 400657.1562, 400675.0625,
        400677.3438, 400685.0625, 400686.2500, 400692.2188, 400712.1562,
        758853.0000, 792129.0625, 795993.0000, 803949.2500, 808992.1250,
        831946.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0544e+00, 1.0715e+00, 1.0880e+00, 1.1373e+00, 1.2178e+00,
        1.2654e+00, 1.2656e+00, 1.4150e+00, 3.7548e+05, 3.9339e+05, 3.9488e+05,
        3.9784e+05, 3.9920e+05, 4.0071e+05, 4.0545e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397829.0938, 397837.0938, 397840.2500, 397840.8438,
        397841.9375, 397851.2500, 397856.7500, 397857.4375, 397874.5938,
        765133.0000, 774231.3750, 795993.0000, 803993.6250, 810289.3125,
        811661.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4486e-01, 9.7998e-01, 9.8573e-01, 1.0087e+00, 1.0443e+00,
        1.0516e+00, 1.0544e+00, 1.1490e+00, 3.7549e+05, 3.9340e+05, 3.9490e+05,
        3.9787e+05, 3.9922e+05, 4.0066e+05, 4.0546e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.1376e-01, 7.8820e-01, 9.7246e-01, 9.7998e-01, 1.0089e+00,
        1.0420e+00, 1.2178e+00, 1.3656e+00, 3.7551e+05, 3.9339e+05, 3.9489e+05,
        3.9784e+05, 3.9920e+05, 4.0068e+05, 4.0544e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 375484.3125, 375487.4375, 375489.3438, 375489.4062,
        375492.2812, 375506.3438, 375507.8750, 375511.1250, 375523.4688,
        751337.0000, 758853.0000, 771457.9375, 774231.3750, 775523.8750,
        787713.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8573e-01, 9.9226e-01, 1.0089e+00, 1.0626e+00, 1.0650e+00,
        1.0715e+00, 1.1092e+00, 1.1773e+00, 3.7552e+05, 3.9340e+05, 3.9487e+05,
        3.9783e+05, 3.9921e+05, 4.0065e+05, 4.0545e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.1376e-01, 7.3186e-01, 1.0399e+00, 1.0516e+00, 1.1006e+00,
        1.1773e+00, 1.4150e+00, 1.6675e+00, 3.7549e+05, 3.9338e+05, 3.9488e+05,
        3.9785e+05, 3.9923e+05, 4.0069e+05, 4.0546e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0650e+00, 1.0880e+00, 1.1490e+00, 1.1779e+00, 1.3656e+00,
        1.3720e+00, 1.3727e+00, 1.6675e+00, 3.7549e+05, 3.9343e+05, 3.9485e+05,
        3.9784e+05, 3.9921e+05, 4.0069e+05, 4.0545e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394854.3750, 394869.9688, 394874.7500, 394876.3125,
        394882.3438, 394883.9062, 394886.2188, 394894.6875, 394899.4062,
        751337.0000, 765133.0000, 768599.5000, 786496.0000, 792129.0625,
        800551.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.6800e-01, 9.7246e-01, 9.9226e-01, 1.0087e+00, 1.1006e+00,
        1.1007e+00, 1.1373e+00, 1.1779e+00, 3.7551e+05, 3.9341e+05, 3.9488e+05,
        3.9786e+05, 3.9923e+05, 4.0066e+05, 4.0542e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405424.0312, 405444.5938, 405449.2188, 405451.0312,
        405453.8438, 405460.5625, 405461.2500, 405463.7500, 405466.1875,
        787713.5000, 789767.7500, 800551.7500, 807800.1250, 811661.6875,
        831946.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393379.8125, 393392.7500, 393394.4062, 393401.1875,
        393402.3125, 393406.0625, 393407.0938, 393409.5000, 393429.6562,
        768599.5000, 775523.8750, 789767.7500, 791661.6250, 803949.2500,
        810289.3125])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76890.36', '436437.44', '76892.05', '436494.31', '76888.65', '434576.19', '76890.17', '76891.04', '413082.84', '76893.42', '76887.81', '76892.93', '430525.91', '76892.91', '443678.81', '430922.19']
estimated f for each client, fs: [7, 5, 7, 5, 7, 5, 7, 7, 6, 7, 7, 7, 5, 7, 5, 5]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 15, 11, 19, 8, 13, 9, 12, 17, 10, 4, 2, 14, 6, 16, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0153s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:24...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:24, End: 2025-07-22 16:00:24)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 8, 5, 3, 14, 6, 1, 2, 10, 11, 20, 17, 19, 18, 4, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9953e+05, 3.9953e+05, 3.9950e+05, 8.1454e+05, 3.9952e+05,
         3.9951e+05, 3.9950e+05, 3.9952e+05, 3.9953e+05, 7.9413e+05, 7.7786e+05,
         7.5971e+05, 8.0002e+05, 3.9953e+05, 3.9952e+05],
        [3.9953e+05, 0.0000e+00, 1.1568e+00, 9.5188e-01, 3.8799e+05, 9.5484e-01,
         9.3637e-01, 9.7303e-01, 8.9945e-01, 1.0552e+00, 3.8450e+05, 3.8564e+05,
         3.7361e+05, 4.0309e+05, 1.7454e+00, 9.0257e-01],
        [3.9953e+05, 1.1568e+00, 0.0000e+00, 1.1341e+00, 3.8796e+05, 9.2919e-01,
         8.6603e-01, 1.3159e+00, 9.7848e-01, 6.8381e-01, 3.8450e+05, 3.8563e+05,
         3.7358e+05, 4.0311e+05, 8.1872e-01, 9.5294e-01],
        [3.9950e+05, 9.5188e-01, 1.1341e+00, 0.0000e+00, 3.8796e+05, 1.0033e+00,
         9.5529e-01, 9.7805e-01, 9.0854e-01, 1.0964e+00, 3.8449e+05, 3.8562e+05,
         3.7361e+05, 4.0309e+05, 1.7669e+00, 9.9729e-01],
        [8.1454e+05, 3.8799e+05, 3.8796e+05, 3.8796e+05, 0.0000e+00, 3.8794e+05,
         3.8794e+05, 3.8802e+05, 3.8798e+05, 3.8795e+05, 7.6516e+05, 7.7991e+05,
         7.2381e+05, 7.6896e+05, 3.8796e+05, 3.8795e+05],
        [3.9952e+05, 9.5484e-01, 9.2919e-01, 1.0033e+00, 3.8794e+05, 0.0000e+00,
         8.7006e-01, 1.0559e+00, 8.9737e-01, 8.4410e-01, 3.8449e+05, 3.8564e+05,
         3.7358e+05, 4.0309e+05, 1.3700e+00, 9.1718e-01],
        [3.9951e+05, 9.3637e-01, 8.6603e-01, 9.5529e-01, 3.8794e+05, 8.7006e-01,
         0.0000e+00, 1.0463e+00, 8.7084e-01, 8.7645e-01, 3.8448e+05, 3.8563e+05,
         3.7357e+05, 4.0309e+05, 1.2933e+00, 8.4167e-01],
        [3.9950e+05, 9.7303e-01, 1.3159e+00, 9.7805e-01, 3.8802e+05, 1.0559e+00,
         1.0463e+00, 0.0000e+00, 9.6390e-01, 1.1400e+00, 3.8449e+05, 3.8562e+05,
         3.7357e+05, 4.0307e+05, 1.9200e+00, 1.0380e+00],
        [3.9952e+05, 8.9945e-01, 9.7848e-01, 9.0854e-01, 3.8798e+05, 8.9737e-01,
         8.7084e-01, 9.6390e-01, 0.0000e+00, 9.4318e-01, 3.8448e+05, 3.8562e+05,
         3.7357e+05, 4.0309e+05, 1.4685e+00, 9.1247e-01],
        [3.9953e+05, 1.0552e+00, 6.8381e-01, 1.0964e+00, 3.8795e+05, 8.4410e-01,
         8.7645e-01, 1.1400e+00, 9.4318e-01, 0.0000e+00, 3.8450e+05, 3.8563e+05,
         3.7358e+05, 4.0310e+05, 9.2499e-01, 8.4095e-01],
        [7.9413e+05, 3.8450e+05, 3.8450e+05, 3.8449e+05, 7.6516e+05, 3.8449e+05,
         3.8448e+05, 3.8449e+05, 3.8448e+05, 3.8450e+05, 0.0000e+00, 7.6057e+05,
         7.6615e+05, 8.1672e+05, 3.8449e+05, 3.8448e+05],
        [7.7786e+05, 3.8564e+05, 3.8563e+05, 3.8562e+05, 7.7991e+05, 3.8564e+05,
         3.8563e+05, 3.8562e+05, 3.8562e+05, 3.8563e+05, 7.6057e+05, 0.0000e+00,
         7.5700e+05, 7.8929e+05, 3.8563e+05, 3.8564e+05],
        [7.5971e+05, 3.7361e+05, 3.7358e+05, 3.7361e+05, 7.2381e+05, 3.7358e+05,
         3.7357e+05, 3.7357e+05, 3.7357e+05, 3.7358e+05, 7.6615e+05, 7.5700e+05,
         0.0000e+00, 7.6955e+05, 3.7357e+05, 3.7357e+05],
        [8.0002e+05, 4.0309e+05, 4.0311e+05, 4.0309e+05, 7.6896e+05, 4.0309e+05,
         4.0309e+05, 4.0307e+05, 4.0309e+05, 4.0310e+05, 8.1672e+05, 7.8929e+05,
         7.6955e+05, 0.0000e+00, 4.0312e+05, 4.0309e+05],
        [3.9953e+05, 1.7454e+00, 8.1872e-01, 1.7669e+00, 3.8796e+05, 1.3700e+00,
         1.2933e+00, 1.9200e+00, 1.4685e+00, 9.2499e-01, 3.8449e+05, 3.8563e+05,
         3.7357e+05, 4.0312e+05, 0.0000e+00, 1.3413e+00],
        [3.9952e+05, 9.0257e-01, 9.5294e-01, 9.9729e-01, 3.8795e+05, 9.1718e-01,
         8.4167e-01, 1.0380e+00, 9.1247e-01, 8.4095e-01, 3.8448e+05, 3.8564e+05,
         3.7357e+05, 4.0309e+05, 1.3413e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 399495.0625, 399500.0000, 399513.3125, 399516.2500,
        399517.0000, 399524.0938, 399526.0000, 399527.4375, 399529.2500,
        399529.9062, 759707.6250, 777860.2500, 794132.3750, 800021.4375,
        814538.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9945e-01, 9.0257e-01, 9.3637e-01, 9.5188e-01, 9.5484e-01,
        9.7303e-01, 1.0552e+00, 1.1568e+00, 1.7454e+00, 3.7361e+05, 3.8450e+05,
        3.8564e+05, 3.8799e+05, 3.9953e+05, 4.0309e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.8381e-01, 8.1872e-01, 8.6603e-01, 9.2919e-01, 9.5294e-01,
        9.7848e-01, 1.1341e+00, 1.1568e+00, 1.3159e+00, 3.7358e+05, 3.8450e+05,
        3.8563e+05, 3.8796e+05, 3.9953e+05, 4.0311e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.0854e-01, 9.5188e-01, 9.5529e-01, 9.7805e-01, 9.9729e-01,
        1.0033e+00, 1.0964e+00, 1.1341e+00, 1.7669e+00, 3.7361e+05, 3.8449e+05,
        3.8562e+05, 3.8796e+05, 3.9950e+05, 4.0309e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387940.5312, 387941.8438, 387945.1250, 387951.5625,
        387956.9375, 387958.7812, 387963.0938, 387980.2500, 387993.4688,
        388017.3438, 723812.6250, 765162.5000, 768963.1875, 779909.6250,
        814538.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4410e-01, 8.7006e-01, 8.9737e-01, 9.1718e-01, 9.2919e-01,
        9.5484e-01, 1.0033e+00, 1.0559e+00, 1.3700e+00, 3.7358e+05, 3.8449e+05,
        3.8564e+05, 3.8794e+05, 3.9952e+05, 4.0309e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4167e-01, 8.6603e-01, 8.7006e-01, 8.7084e-01, 8.7645e-01,
        9.3637e-01, 9.5529e-01, 1.0463e+00, 1.2933e+00, 3.7357e+05, 3.8448e+05,
        3.8563e+05, 3.8794e+05, 3.9951e+05, 4.0309e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.6390e-01, 9.7303e-01, 9.7805e-01, 1.0380e+00, 1.0463e+00,
        1.0559e+00, 1.1400e+00, 1.3159e+00, 1.9200e+00, 3.7357e+05, 3.8449e+05,
        3.8562e+05, 3.8802e+05, 3.9950e+05, 4.0307e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7084e-01, 8.9737e-01, 8.9945e-01, 9.0854e-01, 9.1247e-01,
        9.4318e-01, 9.6390e-01, 9.7848e-01, 1.4685e+00, 3.7357e+05, 3.8448e+05,
        3.8562e+05, 3.8798e+05, 3.9952e+05, 4.0309e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.8381e-01, 8.4095e-01, 8.4410e-01, 8.7645e-01, 9.2499e-01,
        9.4318e-01, 1.0552e+00, 1.0964e+00, 1.1400e+00, 3.7358e+05, 3.8450e+05,
        3.8563e+05, 3.8795e+05, 3.9953e+05, 4.0310e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384477.7500, 384480.1250, 384484.7812, 384490.9375,
        384491.3125, 384494.6875, 384494.7500, 384499.7188, 384502.0625,
        384502.7500, 760571.8125, 765162.5000, 766149.5000, 794132.3750,
        816724.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385617.4375, 385622.0000, 385623.8750, 385625.3438,
        385630.0625, 385631.1562, 385631.3750, 385637.2188, 385637.3750,
        385637.4688, 757001.8750, 760571.8125, 777860.2500, 779909.6250,
        789286.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 373568.6875, 373569.7500, 373571.4062, 373573.6875,
        373574.2812, 373576.2812, 373576.3438, 373577.9375, 373606.0312,
        373606.1875, 723812.6250, 757001.8750, 759707.6250, 766149.5000,
        769549.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403071.1562, 403085.4688, 403086.7500, 403089.5625,
        403093.4062, 403093.4375, 403094.0625, 403101.0312, 403106.9062,
        403121.1875, 768963.1875, 769549.0000, 789286.6250, 800021.4375,
        816724.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.1872e-01, 9.2499e-01, 1.2933e+00, 1.3413e+00, 1.3700e+00,
        1.4685e+00, 1.7454e+00, 1.7669e+00, 1.9200e+00, 3.7357e+05, 3.8449e+05,
        3.8563e+05, 3.8796e+05, 3.9953e+05, 4.0312e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4095e-01, 8.4167e-01, 9.0257e-01, 9.1247e-01, 9.1718e-01,
        9.5294e-01, 9.9729e-01, 1.0380e+00, 1.3413e+00, 3.7357e+05, 3.8448e+05,
        3.8564e+05, 3.8795e+05, 3.9952e+05, 4.0309e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['399517.81', '37361.58', '37358.52', '37361.58', '387964.91', '37358.52', '37358.00', '37358.46', '37357.75', '37358.63', '384491.88', '385629.31', '373580.06', '403094.31', '37358.63', '37357.85']
estimated f for each client, fs: [4, 6, 6, 6, 4, 6, 6, 6, 6, 6, 4, 4, 4, 4, 6, 6]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 8, 5, 3, 14, 6, 1, 2, 10, 11, 20, 17, 19, 18, 4, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0122s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:24...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:24, End: 2025-07-22 16:00:24)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 14, 1, 8, 12, 6, 19, 17, 2, 5, 20, 16, 9, 7, 3, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.8847e+05, 3.8639e+05, 3.8637e+05, 3.8639e+05, 3.8638e+05,
         7.4728e+05, 7.5677e+05, 3.8637e+05, 3.8641e+05, 7.4303e+05, 7.7834e+05,
         3.8639e+05, 3.8638e+05, 3.8639e+05, 7.7604e+05],
        [7.8847e+05, 0.0000e+00, 3.9624e+05, 3.9623e+05, 3.9621e+05, 3.9620e+05,
         7.8102e+05, 7.8191e+05, 3.9619e+05, 3.9621e+05, 7.8389e+05, 7.9112e+05,
         3.9622e+05, 3.9620e+05, 3.9622e+05, 7.7813e+05],
        [3.8639e+05, 3.9624e+05, 0.0000e+00, 1.0044e+00, 9.0001e-01, 8.6194e-01,
         3.8262e+05, 3.8558e+05, 1.1040e+00, 9.2567e-01, 3.8923e+05, 3.8012e+05,
         8.5808e-01, 1.0149e+00, 1.0021e+00, 4.0028e+05],
        [3.8637e+05, 3.9623e+05, 1.0044e+00, 0.0000e+00, 1.1635e+00, 9.9092e-01,
         3.8263e+05, 3.8557e+05, 1.0406e+00, 1.2641e+00, 3.8925e+05, 3.8010e+05,
         1.0049e+00, 1.0151e+00, 1.0450e+00, 4.0031e+05],
        [3.8639e+05, 3.9621e+05, 9.0001e-01, 1.1635e+00, 0.0000e+00, 8.8592e-01,
         3.8264e+05, 3.8562e+05, 1.2278e+00, 7.1695e-01, 3.8927e+05, 3.8012e+05,
         9.4325e-01, 1.0758e+00, 1.1544e+00, 4.0028e+05],
        [3.8638e+05, 3.9620e+05, 8.6194e-01, 9.9092e-01, 8.8592e-01, 0.0000e+00,
         3.8262e+05, 3.8564e+05, 1.0362e+00, 9.7406e-01, 3.8924e+05, 3.8010e+05,
         9.2528e-01, 9.7313e-01, 1.0364e+00, 4.0029e+05],
        [7.4728e+05, 7.8102e+05, 3.8262e+05, 3.8263e+05, 3.8264e+05, 3.8262e+05,
         0.0000e+00, 7.5599e+05, 3.8266e+05, 3.8262e+05, 7.9039e+05, 7.5831e+05,
         3.8261e+05, 3.8263e+05, 3.8264e+05, 7.9648e+05],
        [7.5677e+05, 7.8191e+05, 3.8558e+05, 3.8557e+05, 3.8562e+05, 3.8564e+05,
         7.5599e+05, 0.0000e+00, 3.8562e+05, 3.8562e+05, 7.8889e+05, 7.7746e+05,
         3.8560e+05, 3.8560e+05, 3.8560e+05, 8.0487e+05],
        [3.8637e+05, 3.9619e+05, 1.1040e+00, 1.0406e+00, 1.2278e+00, 1.0362e+00,
         3.8266e+05, 3.8562e+05, 0.0000e+00, 1.4176e+00, 3.8924e+05, 3.8011e+05,
         1.0717e+00, 9.9533e-01, 1.0282e+00, 4.0029e+05],
        [3.8641e+05, 3.9621e+05, 9.2567e-01, 1.2641e+00, 7.1695e-01, 9.7406e-01,
         3.8262e+05, 3.8562e+05, 1.4176e+00, 0.0000e+00, 3.8926e+05, 3.8012e+05,
         1.0132e+00, 1.1276e+00, 1.2436e+00, 4.0029e+05],
        [7.4303e+05, 7.8389e+05, 3.8923e+05, 3.8925e+05, 3.8927e+05, 3.8924e+05,
         7.9039e+05, 7.8889e+05, 3.8924e+05, 3.8926e+05, 0.0000e+00, 7.6554e+05,
         3.8923e+05, 3.8924e+05, 3.8924e+05, 8.0933e+05],
        [7.7834e+05, 7.9112e+05, 3.8012e+05, 3.8010e+05, 3.8012e+05, 3.8010e+05,
         7.5831e+05, 7.7746e+05, 3.8011e+05, 3.8012e+05, 7.6554e+05, 0.0000e+00,
         3.8013e+05, 3.8011e+05, 3.8010e+05, 7.7759e+05],
        [3.8639e+05, 3.9622e+05, 8.5808e-01, 1.0049e+00, 9.4325e-01, 9.2528e-01,
         3.8261e+05, 3.8560e+05, 1.0717e+00, 1.0132e+00, 3.8923e+05, 3.8013e+05,
         0.0000e+00, 1.0312e+00, 1.0322e+00, 4.0028e+05],
        [3.8638e+05, 3.9620e+05, 1.0149e+00, 1.0151e+00, 1.0758e+00, 9.7313e-01,
         3.8263e+05, 3.8560e+05, 9.9533e-01, 1.1276e+00, 3.8924e+05, 3.8011e+05,
         1.0312e+00, 0.0000e+00, 1.0399e+00, 4.0029e+05],
        [3.8639e+05, 3.9622e+05, 1.0021e+00, 1.0450e+00, 1.1544e+00, 1.0364e+00,
         3.8264e+05, 3.8560e+05, 1.0282e+00, 1.2436e+00, 3.8924e+05, 3.8010e+05,
         1.0322e+00, 1.0399e+00, 0.0000e+00, 4.0027e+05],
        [7.7604e+05, 7.7813e+05, 4.0028e+05, 4.0031e+05, 4.0028e+05, 4.0029e+05,
         7.9648e+05, 8.0487e+05, 4.0029e+05, 4.0029e+05, 8.0933e+05, 7.7759e+05,
         4.0028e+05, 4.0029e+05, 4.0027e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 386373.7188, 386374.1875, 386381.2500, 386382.5312,
        386385.6562, 386386.5312, 386390.8125, 386393.7500, 386408.0938,
        743033.3125, 747276.3125, 756767.5000, 776042.0000, 778340.3750,
        788471.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396190.3125, 396195.3438, 396200.6562, 396211.8750,
        396213.0312, 396215.1562, 396221.7812, 396232.4375, 396243.7500,
        778133.1250, 781022.6250, 781908.6875, 783886.6250, 788471.4375,
        791121.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.5808e-01, 8.6194e-01, 9.0001e-01, 9.2567e-01, 1.0021e+00,
        1.0044e+00, 1.0149e+00, 1.1040e+00, 3.8012e+05, 3.8262e+05, 3.8558e+05,
        3.8639e+05, 3.8923e+05, 3.9624e+05, 4.0028e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.9092e-01, 1.0044e+00, 1.0049e+00, 1.0151e+00, 1.0406e+00,
        1.0450e+00, 1.1635e+00, 1.2641e+00, 3.8010e+05, 3.8263e+05, 3.8557e+05,
        3.8637e+05, 3.8925e+05, 3.9623e+05, 4.0031e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.1695e-01, 8.8592e-01, 9.0001e-01, 9.4325e-01, 1.0758e+00,
        1.1544e+00, 1.1635e+00, 1.2278e+00, 3.8012e+05, 3.8264e+05, 3.8562e+05,
        3.8639e+05, 3.8927e+05, 3.9621e+05, 4.0028e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6194e-01, 8.8592e-01, 9.2528e-01, 9.7313e-01, 9.7406e-01,
        9.9092e-01, 1.0362e+00, 1.0364e+00, 3.8010e+05, 3.8262e+05, 3.8564e+05,
        3.8638e+05, 3.8924e+05, 3.9620e+05, 4.0029e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382614.2500, 382619.7500, 382621.3125, 382623.2500,
        382627.1562, 382630.0312, 382643.1875, 382643.4688, 382657.0938,
        747276.3125, 755987.8125, 758309.0000, 781022.6250, 790392.0000,
        796478.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385568.2812, 385581.4688, 385599.3750, 385601.2812,
        385601.6875, 385616.7500, 385620.1250, 385621.4062, 385640.5625,
        755987.8125, 756767.5000, 777461.2500, 781908.6875, 788886.0000,
        804868.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.9533e-01, 1.0282e+00, 1.0362e+00, 1.0406e+00, 1.0717e+00,
        1.1040e+00, 1.2278e+00, 1.4176e+00, 3.8011e+05, 3.8266e+05, 3.8562e+05,
        3.8637e+05, 3.8924e+05, 3.9619e+05, 4.0029e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.1695e-01, 9.2567e-01, 9.7406e-01, 1.0132e+00, 1.1276e+00,
        1.2436e+00, 1.2641e+00, 1.4176e+00, 3.8012e+05, 3.8262e+05, 3.8562e+05,
        3.8641e+05, 3.8926e+05, 3.9621e+05, 4.0029e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389227.2812, 389230.4375, 389238.2812, 389239.6250,
        389242.3750, 389244.0625, 389251.5000, 389256.4062, 389267.8438,
        743033.3125, 765535.0625, 783886.6250, 788886.0000, 790392.0000,
        809332.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380098.4062, 380100.3125, 380103.1562, 380107.8125,
        380108.4375, 380120.0000, 380121.8125, 380124.1562, 380126.1250,
        758309.0000, 765535.0625, 777461.2500, 777587.2500, 778340.3750,
        791121.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.5808e-01, 9.2528e-01, 9.4325e-01, 1.0049e+00, 1.0132e+00,
        1.0312e+00, 1.0322e+00, 1.0717e+00, 3.8013e+05, 3.8261e+05, 3.8560e+05,
        3.8639e+05, 3.8923e+05, 3.9622e+05, 4.0028e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7313e-01, 9.9533e-01, 1.0149e+00, 1.0151e+00, 1.0312e+00,
        1.0399e+00, 1.0758e+00, 1.1276e+00, 3.8011e+05, 3.8263e+05, 3.8560e+05,
        3.8638e+05, 3.8924e+05, 3.9620e+05, 4.0029e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0021e+00, 1.0282e+00, 1.0322e+00, 1.0364e+00, 1.0399e+00,
        1.0450e+00, 1.1544e+00, 1.2436e+00, 3.8010e+05, 3.8264e+05, 3.8560e+05,
        3.8639e+05, 3.8924e+05, 3.9622e+05, 4.0027e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400269.2500, 400283.0312, 400283.1875, 400283.8125,
        400290.2500, 400291.6250, 400292.3750, 400292.7500, 400306.9688,
        776042.0000, 777587.2500, 778133.1250, 796478.3125, 804868.3750,
        809332.8125])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['422051.00', '434405.75', '76275.27', '76273.41', '76277.56', '76272.79', '419095.59', '422643.91', '76277.45', '76275.00', '424623.09', '417931.94', '76274.83', '76274.61', '76275.50', '437863.50']
estimated f for each client, fs: [5, 5, 7, 7, 7, 7, 5, 5, 7, 7, 5, 5, 7, 7, 7, 5]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 14, 1, 8, 12, 6, 19, 17, 2, 5, 20, 16, 9, 7, 3, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0141s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:25...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 76 187]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:25, End: 2025-07-22 16:00:25)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 15, 3, 2, 7, 18, 5, 17, 20, 9, 19, 13, 4, 11, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9339e+05, 1.0285e+00, 9.9744e-01, 1.0043e+00, 3.8709e+05,
         1.2800e+00, 4.1389e+05, 3.8843e+05, 1.0241e+00, 4.0591e+05, 3.9124e+05,
         1.4233e+00, 1.2296e+00, 3.8540e+05, 1.3696e+00],
        [3.9339e+05, 0.0000e+00, 3.9337e+05, 3.9338e+05, 3.9337e+05, 7.7937e+05,
         3.9336e+05, 8.0242e+05, 7.8668e+05, 3.9337e+05, 7.8916e+05, 7.6450e+05,
         3.9339e+05, 3.9336e+05, 7.6726e+05, 3.9337e+05],
        [1.0285e+00, 3.9337e+05, 0.0000e+00, 1.0596e+00, 1.0590e+00, 3.8709e+05,
         1.2822e+00, 4.1390e+05, 3.8842e+05, 1.0644e+00, 4.0589e+05, 3.9124e+05,
         1.5052e+00, 1.2491e+00, 3.8537e+05, 1.4293e+00],
        [9.9744e-01, 3.9338e+05, 1.0596e+00, 0.0000e+00, 1.0204e+00, 3.8708e+05,
         1.4741e+00, 4.1391e+05, 3.8842e+05, 1.1328e+00, 4.0589e+05, 3.9122e+05,
         1.6321e+00, 1.3032e+00, 3.8539e+05, 1.4529e+00],
        [1.0043e+00, 3.9337e+05, 1.0590e+00, 1.0204e+00, 0.0000e+00, 3.8709e+05,
         1.2270e+00, 4.1387e+05, 3.8846e+05, 1.0653e+00, 4.0591e+05, 3.9123e+05,
         1.4711e+00, 1.1695e+00, 3.8542e+05, 1.3387e+00],
        [3.8709e+05, 7.7937e+05, 3.8709e+05, 3.8708e+05, 3.8709e+05, 0.0000e+00,
         3.8706e+05, 8.1518e+05, 7.8086e+05, 3.8708e+05, 8.0754e+05, 7.7319e+05,
         3.8709e+05, 3.8709e+05, 7.7154e+05, 3.8705e+05],
        [1.2800e+00, 3.9336e+05, 1.2822e+00, 1.4741e+00, 1.2270e+00, 3.8706e+05,
         0.0000e+00, 4.1391e+05, 3.8845e+05, 1.0788e+00, 4.0590e+05, 3.9125e+05,
         6.9003e-01, 8.1025e-01, 3.8544e+05, 9.1714e-01],
        [4.1389e+05, 8.0242e+05, 4.1390e+05, 4.1391e+05, 4.1387e+05, 8.1518e+05,
         4.1391e+05, 0.0000e+00, 8.2390e+05, 4.1388e+05, 8.2224e+05, 8.1115e+05,
         4.1389e+05, 4.1386e+05, 7.9651e+05, 4.1390e+05],
        [3.8843e+05, 7.8668e+05, 3.8842e+05, 3.8842e+05, 3.8846e+05, 7.8086e+05,
         3.8845e+05, 8.2390e+05, 0.0000e+00, 3.8844e+05, 7.9985e+05, 7.6382e+05,
         3.8846e+05, 3.8845e+05, 7.6231e+05, 3.8847e+05],
        [1.0241e+00, 3.9337e+05, 1.0644e+00, 1.1328e+00, 1.0653e+00, 3.8708e+05,
         1.0788e+00, 4.1388e+05, 3.8844e+05, 0.0000e+00, 4.0589e+05, 3.9123e+05,
         1.1238e+00, 1.0173e+00, 3.8541e+05, 1.1710e+00],
        [4.0591e+05, 7.8916e+05, 4.0589e+05, 4.0589e+05, 4.0591e+05, 8.0754e+05,
         4.0590e+05, 8.2224e+05, 7.9985e+05, 4.0589e+05, 0.0000e+00, 7.9077e+05,
         4.0589e+05, 4.0588e+05, 8.1488e+05, 4.0588e+05],
        [3.9124e+05, 7.6450e+05, 3.9124e+05, 3.9122e+05, 3.9123e+05, 7.7319e+05,
         3.9125e+05, 8.1115e+05, 7.6382e+05, 3.9123e+05, 7.9077e+05, 0.0000e+00,
         3.9125e+05, 3.9123e+05, 7.6914e+05, 3.9125e+05],
        [1.4233e+00, 3.9339e+05, 1.5052e+00, 1.6321e+00, 1.4711e+00, 3.8709e+05,
         6.9003e-01, 4.1389e+05, 3.8846e+05, 1.1238e+00, 4.0589e+05, 3.9125e+05,
         0.0000e+00, 7.7013e-01, 3.8542e+05, 8.1235e-01],
        [1.2296e+00, 3.9336e+05, 1.2491e+00, 1.3032e+00, 1.1695e+00, 3.8709e+05,
         8.1025e-01, 4.1386e+05, 3.8845e+05, 1.0173e+00, 4.0588e+05, 3.9123e+05,
         7.7013e-01, 0.0000e+00, 3.8540e+05, 9.0399e-01],
        [3.8540e+05, 7.6726e+05, 3.8537e+05, 3.8539e+05, 3.8542e+05, 7.7154e+05,
         3.8544e+05, 7.9651e+05, 7.6231e+05, 3.8541e+05, 8.1488e+05, 7.6914e+05,
         3.8542e+05, 3.8540e+05, 0.0000e+00, 3.8540e+05],
        [1.3696e+00, 3.9337e+05, 1.4293e+00, 1.4529e+00, 1.3387e+00, 3.8705e+05,
         9.1714e-01, 4.1390e+05, 3.8847e+05, 1.1710e+00, 4.0588e+05, 3.9125e+05,
         8.1235e-01, 9.0399e-01, 3.8540e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.9744e-01, 1.0043e+00, 1.0241e+00, 1.0285e+00, 1.2296e+00,
        1.2800e+00, 1.3696e+00, 1.4233e+00, 3.8540e+05, 3.8709e+05, 3.8843e+05,
        3.9124e+05, 3.9339e+05, 4.0591e+05, 4.1389e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393356.8750, 393362.9062, 393366.5312, 393370.1250,
        393371.1250, 393373.8750, 393377.8750, 393385.7500, 393390.5000,
        764498.0625, 767261.6250, 779370.1875, 786676.6250, 789156.1250,
        802425.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0285e+00, 1.0590e+00, 1.0596e+00, 1.0644e+00, 1.2491e+00,
        1.2822e+00, 1.4293e+00, 1.5052e+00, 3.8537e+05, 3.8709e+05, 3.8842e+05,
        3.9124e+05, 3.9337e+05, 4.0589e+05, 4.1390e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.9744e-01, 1.0204e+00, 1.0596e+00, 1.1328e+00, 1.3032e+00,
        1.4529e+00, 1.4741e+00, 1.6321e+00, 3.8539e+05, 3.8708e+05, 3.8842e+05,
        3.9122e+05, 3.9338e+05, 4.0589e+05, 4.1391e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0043e+00, 1.0204e+00, 1.0590e+00, 1.0653e+00, 1.1695e+00,
        1.2270e+00, 1.3387e+00, 1.4711e+00, 3.8542e+05, 3.8709e+05, 3.8846e+05,
        3.9123e+05, 3.9337e+05, 4.0591e+05, 4.1387e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387045.6250, 387063.1562, 387075.6875, 387079.3438,
        387087.9688, 387089.1875, 387089.2812, 387093.0625, 387093.3125,
        771543.3750, 773186.6875, 779370.1875, 780860.6875, 807542.2500,
        815176.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.9003e-01, 8.1025e-01, 9.1714e-01, 1.0788e+00, 1.2270e+00,
        1.2800e+00, 1.2822e+00, 1.4741e+00, 3.8544e+05, 3.8706e+05, 3.8845e+05,
        3.9125e+05, 3.9336e+05, 4.0590e+05, 4.1391e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 413864.7812, 413870.7812, 413882.0312, 413888.6562,
        413894.7188, 413895.7500, 413902.0312, 413907.8750, 413908.4062,
        796507.8125, 802425.0000, 811150.5625, 815176.5625, 822238.2500,
        823904.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388416.2812, 388423.9062, 388430.3125, 388436.2500,
        388450.2812, 388452.7188, 388457.3125, 388460.4375, 388470.0938,
        762312.6875, 763819.9375, 780860.6875, 786676.6250, 799850.3750,
        823904.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0173e+00, 1.0241e+00, 1.0644e+00, 1.0653e+00, 1.0788e+00,
        1.1238e+00, 1.1328e+00, 1.1710e+00, 3.8541e+05, 3.8708e+05, 3.8844e+05,
        3.9123e+05, 3.9337e+05, 4.0589e+05, 4.1388e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405879.1875, 405884.8438, 405886.3438, 405891.2812,
        405893.7812, 405894.3750, 405902.0938, 405905.6562, 405908.5938,
        789156.1250, 790770.4375, 799850.3750, 807542.2500, 814877.8750,
        822238.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391221.8438, 391225.7188, 391227.1875, 391230.0000,
        391240.0938, 391240.4688, 391246.6250, 391249.5938, 391253.9688,
        763819.9375, 764498.0625, 769138.2500, 773186.6875, 790770.4375,
        811150.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.9003e-01, 7.7013e-01, 8.1235e-01, 1.1238e+00, 1.4233e+00,
        1.4711e+00, 1.5052e+00, 1.6321e+00, 3.8542e+05, 3.8709e+05, 3.8846e+05,
        3.9125e+05, 3.9339e+05, 4.0589e+05, 4.1389e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.7013e-01, 8.1025e-01, 9.0399e-01, 1.0173e+00, 1.1695e+00,
        1.2296e+00, 1.2491e+00, 1.3032e+00, 3.8540e+05, 3.8709e+05, 3.8845e+05,
        3.9123e+05, 3.9336e+05, 4.0588e+05, 4.1386e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385374.0000, 385386.7500, 385396.6875, 385403.8125,
        385404.6875, 385408.3750, 385416.7188, 385422.0312, 385436.2500,
        762312.6875, 767261.6250, 769138.2500, 771543.3750, 796507.8125,
        814877.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.1235e-01, 9.0399e-01, 9.1714e-01, 1.1710e+00, 1.3387e+00,
        1.3696e+00, 1.4293e+00, 1.4529e+00, 3.8540e+05, 3.8705e+05, 3.8847e+05,
        3.9125e+05, 3.9337e+05, 4.0588e+05, 4.1390e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77249.39', '430485.41', '77247.67', '77247.25', '77252.48', '425526.00', '77250.82', '452152.31', '425831.00', '77249.64', '444220.19', '428495.56', '77251.55', '77250.23', '423096.25', '77245.88']
estimated f for each client, fs: [7, 5, 7, 7, 7, 5, 7, 5, 5, 7, 5, 5, 7, 7, 5, 7]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [8, 15, 3, 2, 7, 18, 5, 17, 20, 9, 19, 13, 4, 11, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0139s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:25...
global Accuracy on shared test data: 73.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:25, End: 2025-07-22 16:00:25)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [18, 1, 2, 12, 13, 4, 15, 16, 14, 9, 6, 17, 8, 10, 11, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8313e+05, 3.8313e+05, 3.8312e+05, 7.8375e+05, 3.8315e+05,
         7.9660e+05, 7.5721e+05, 7.4287e+05, 3.8313e+05, 3.8315e+05, 7.9468e+05,
         3.8312e+05, 3.8315e+05, 3.8314e+05, 7.7630e+05],
        [3.8313e+05, 0.0000e+00, 9.8263e-01, 8.8051e-01, 3.9642e+05, 9.1741e-01,
         3.8426e+05, 3.8455e+05, 3.9264e+05, 8.3018e-01, 1.1947e+00, 3.9756e+05,
         9.6243e-01, 7.9924e-01, 8.7215e-01, 3.8250e+05],
        [3.8313e+05, 9.8263e-01, 0.0000e+00, 1.0727e+00, 3.9641e+05, 1.3203e+00,
         3.8429e+05, 3.8450e+05, 3.9264e+05, 9.7501e-01, 1.5981e+00, 3.9756e+05,
         9.2042e-01, 1.0157e+00, 1.0946e+00, 3.8252e+05],
        [3.8312e+05, 8.8051e-01, 1.0727e+00, 0.0000e+00, 3.9641e+05, 6.3781e-01,
         3.8429e+05, 3.8452e+05, 3.9263e+05, 8.6547e-01, 9.1017e-01, 3.9754e+05,
         1.0304e+00, 7.1071e-01, 7.1026e-01, 3.8251e+05],
        [7.8375e+05, 3.9642e+05, 3.9641e+05, 3.9641e+05, 0.0000e+00, 3.9641e+05,
         7.6615e+05, 7.9230e+05, 7.9471e+05, 3.9643e+05, 3.9641e+05, 8.0431e+05,
         3.9640e+05, 3.9641e+05, 3.9641e+05, 7.6733e+05],
        [3.8315e+05, 9.1741e-01, 1.3203e+00, 6.3781e-01, 3.9641e+05, 0.0000e+00,
         3.8428e+05, 3.8452e+05, 3.9263e+05, 9.8262e-01, 6.0500e-01, 3.9753e+05,
         1.1963e+00, 7.1460e-01, 6.2407e-01, 3.8251e+05],
        [7.9660e+05, 3.8426e+05, 3.8429e+05, 3.8429e+05, 7.6615e+05, 3.8428e+05,
         0.0000e+00, 7.4664e+05, 7.9125e+05, 3.8428e+05, 3.8429e+05, 7.8176e+05,
         3.8430e+05, 3.8429e+05, 3.8430e+05, 7.6153e+05],
        [7.5721e+05, 3.8455e+05, 3.8450e+05, 3.8452e+05, 7.9230e+05, 3.8452e+05,
         7.4664e+05, 0.0000e+00, 7.5937e+05, 3.8453e+05, 3.8449e+05, 7.8812e+05,
         3.8455e+05, 3.8453e+05, 3.8451e+05, 7.7403e+05],
        [7.4287e+05, 3.9264e+05, 3.9264e+05, 3.9263e+05, 7.9471e+05, 3.9263e+05,
         7.9125e+05, 7.5937e+05, 0.0000e+00, 3.9264e+05, 3.9264e+05, 7.8443e+05,
         3.9265e+05, 3.9264e+05, 3.9265e+05, 7.8136e+05],
        [3.8313e+05, 8.3018e-01, 9.7501e-01, 8.6547e-01, 3.9643e+05, 9.8262e-01,
         3.8428e+05, 3.8453e+05, 3.9264e+05, 0.0000e+00, 1.3046e+00, 3.9755e+05,
         9.2102e-01, 8.5027e-01, 8.5616e-01, 3.8252e+05],
        [3.8315e+05, 1.1947e+00, 1.5981e+00, 9.1017e-01, 3.9641e+05, 6.0500e-01,
         3.8429e+05, 3.8449e+05, 3.9264e+05, 1.3046e+00, 0.0000e+00, 3.9754e+05,
         1.5326e+00, 9.6810e-01, 8.5070e-01, 3.8251e+05],
        [7.9468e+05, 3.9756e+05, 3.9756e+05, 3.9754e+05, 8.0431e+05, 3.9753e+05,
         7.8176e+05, 7.8812e+05, 7.8443e+05, 3.9755e+05, 3.9754e+05, 0.0000e+00,
         3.9758e+05, 3.9754e+05, 3.9755e+05, 7.9660e+05],
        [3.8312e+05, 9.6243e-01, 9.2042e-01, 1.0304e+00, 3.9640e+05, 1.1963e+00,
         3.8430e+05, 3.8455e+05, 3.9265e+05, 9.2102e-01, 1.5326e+00, 3.9758e+05,
         0.0000e+00, 1.0065e+00, 1.0602e+00, 3.8249e+05],
        [3.8315e+05, 7.9924e-01, 1.0157e+00, 7.1071e-01, 3.9641e+05, 7.1460e-01,
         3.8429e+05, 3.8453e+05, 3.9264e+05, 8.5027e-01, 9.6810e-01, 3.9754e+05,
         1.0065e+00, 0.0000e+00, 7.5012e-01, 3.8253e+05],
        [3.8314e+05, 8.7215e-01, 1.0946e+00, 7.1026e-01, 3.9641e+05, 6.2407e-01,
         3.8430e+05, 3.8451e+05, 3.9265e+05, 8.5616e-01, 8.5070e-01, 3.9755e+05,
         1.0602e+00, 7.5012e-01, 0.0000e+00, 3.8251e+05],
        [7.7630e+05, 3.8250e+05, 3.8252e+05, 3.8251e+05, 7.6733e+05, 3.8251e+05,
         7.6153e+05, 7.7403e+05, 7.8136e+05, 3.8252e+05, 3.8251e+05, 7.9660e+05,
         3.8249e+05, 3.8253e+05, 3.8251e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 383119.8750, 383122.1562, 383125.6875, 383128.7500,
        383132.4375, 383135.7812, 383146.1562, 383151.7812, 383152.4688,
        742866.1875, 757213.1250, 776296.3125, 783746.1875, 794680.5000,
        796596.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.9924e-01, 8.3018e-01, 8.7215e-01, 8.8051e-01, 9.1741e-01,
        9.6243e-01, 9.8263e-01, 1.1947e+00, 3.8250e+05, 3.8313e+05, 3.8426e+05,
        3.8455e+05, 3.9264e+05, 3.9642e+05, 3.9756e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2042e-01, 9.7501e-01, 9.8263e-01, 1.0157e+00, 1.0727e+00,
        1.0946e+00, 1.3203e+00, 1.5981e+00, 3.8252e+05, 3.8313e+05, 3.8429e+05,
        3.8450e+05, 3.9264e+05, 3.9641e+05, 3.9756e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.3781e-01, 7.1026e-01, 7.1071e-01, 8.6547e-01, 8.8051e-01,
        9.1017e-01, 1.0304e+00, 1.0727e+00, 3.8251e+05, 3.8312e+05, 3.8429e+05,
        3.8452e+05, 3.9263e+05, 3.9641e+05, 3.9754e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396395.6250, 396406.1875, 396407.0000, 396407.6562,
        396411.6875, 396413.3438, 396414.0000, 396420.5625, 396432.0000,
        766152.4375, 767328.3750, 783746.1875, 792297.5000, 794713.6250,
        804308.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.0500e-01, 6.2407e-01, 6.3781e-01, 7.1460e-01, 9.1741e-01,
        9.8262e-01, 1.1963e+00, 1.3203e+00, 3.8251e+05, 3.8315e+05, 3.8428e+05,
        3.8452e+05, 3.9263e+05, 3.9641e+05, 3.9753e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384260.5000, 384275.2188, 384281.9375, 384285.6875,
        384287.8750, 384287.9062, 384290.7812, 384298.4062, 384301.9688,
        746636.7500, 761529.7500, 766152.4375, 781761.5625, 791250.5625,
        796596.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384492.6250, 384500.7188, 384509.1250, 384515.5938,
        384518.0312, 384528.5938, 384529.4062, 384553.6562, 384554.0000,
        746636.7500, 757213.1250, 759372.2500, 774025.8750, 788116.0000,
        792297.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392633.1875, 392634.9688, 392636.1875, 392637.8438,
        392640.6875, 392643.5000, 392643.6250, 392645.2500, 392647.9062,
        742866.1875, 759372.2500, 781358.5625, 784428.5000, 791250.5625,
        794713.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3018e-01, 8.5027e-01, 8.5616e-01, 8.6547e-01, 9.2102e-01,
        9.7501e-01, 9.8262e-01, 1.3046e+00, 3.8252e+05, 3.8313e+05, 3.8428e+05,
        3.8453e+05, 3.9264e+05, 3.9643e+05, 3.9755e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.0500e-01, 8.5070e-01, 9.1017e-01, 9.6810e-01, 1.1947e+00,
        1.3046e+00, 1.5326e+00, 1.5981e+00, 3.8251e+05, 3.8315e+05, 3.8429e+05,
        3.8449e+05, 3.9264e+05, 3.9641e+05, 3.9754e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397532.9375, 397537.2812, 397543.5938, 397543.7500,
        397551.8125, 397553.6562, 397559.5938, 397559.9688, 397579.2500,
        781761.5625, 784428.5000, 788116.0000, 794680.5000, 796596.1875,
        804308.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2042e-01, 9.2102e-01, 9.6243e-01, 1.0065e+00, 1.0304e+00,
        1.0602e+00, 1.1963e+00, 1.5326e+00, 3.8249e+05, 3.8312e+05, 3.8430e+05,
        3.8455e+05, 3.9265e+05, 3.9640e+05, 3.9758e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.1071e-01, 7.1460e-01, 7.5012e-01, 7.9924e-01, 8.5027e-01,
        9.6810e-01, 1.0065e+00, 1.0157e+00, 3.8253e+05, 3.8315e+05, 3.8429e+05,
        3.8453e+05, 3.9264e+05, 3.9641e+05, 3.9754e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.2407e-01, 7.1026e-01, 7.5012e-01, 8.5070e-01, 8.5616e-01,
        8.7215e-01, 1.0602e+00, 1.0946e+00, 3.8251e+05, 3.8314e+05, 3.8430e+05,
        3.8451e+05, 3.9265e+05, 3.9641e+05, 3.9755e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382486.7812, 382500.7188, 382505.4688, 382505.7188,
        382510.5000, 382512.8438, 382516.0000, 382519.8125, 382525.2500,
        761529.7500, 767328.3750, 774025.8750, 776296.3125, 781358.5625,
        796596.1875])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['419108.12', '76563.70', '76565.08', '76563.46', '433386.06', '76566.60', '420520.69', '420733.84', '427662.91', '76565.99', '76566.70', '435972.31', '76561.52', '76568.38', '76565.31', '420411.31']
estimated f for each client, fs: [5, 7, 7, 7, 5, 7, 5, 5, 5, 7, 7, 5, 7, 7, 7, 5]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [18, 1, 2, 12, 13, 4, 15, 16, 14, 9, 6, 17, 8, 10, 11, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:26...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:26, End: 2025-07-22 16:00:26)
start time is: 98972383750743, end time is: 99008306306735
The total time is: 35922555992ns.

 ------- aggregate method: rkrum, random_seed: 100 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 9, 8, 5, 15, 10, 2, 14, 13, 1, 6, 18, 4, 3, 19, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.8261e+00, 5.6289e+00, 5.3659e+00, 3.9643e+05, 4.8552e+00,
         5.3730e+00, 3.8004e+05, 4.0092e+05, 5.0623e+00, 5.3166e+00, 3.7885e+05,
         4.9239e+00, 5.2428e+00, 3.9305e+05, 3.8747e+05],
        [4.8261e+00, 0.0000e+00, 5.6176e+00, 5.2563e+00, 3.9645e+05, 4.4560e+00,
         4.9474e+00, 3.8006e+05, 4.0088e+05, 4.5367e+00, 5.2416e+00, 3.7887e+05,
         4.7404e+00, 5.3030e+00, 3.9311e+05, 3.8746e+05],
        [5.6289e+00, 5.6176e+00, 0.0000e+00, 5.5610e+00, 3.9646e+05, 5.5166e+00,
         6.1818e+00, 3.8008e+05, 4.0089e+05, 5.8245e+00, 5.3255e+00, 3.7888e+05,
         5.4523e+00, 5.7247e+00, 3.9310e+05, 3.8746e+05],
        [5.3659e+00, 5.2563e+00, 5.5610e+00, 0.0000e+00, 3.9644e+05, 5.6270e+00,
         5.7722e+00, 3.8003e+05, 4.0090e+05, 5.6644e+00, 4.7567e+00, 3.7883e+05,
         4.9696e+00, 4.4522e+00, 3.9308e+05, 3.8750e+05],
        [3.9643e+05, 3.9645e+05, 3.9646e+05, 3.9644e+05, 0.0000e+00, 3.9640e+05,
         3.9640e+05, 7.6868e+05, 7.5043e+05, 3.9640e+05, 3.9640e+05, 7.4113e+05,
         3.9640e+05, 3.9639e+05, 7.8671e+05, 7.7903e+05],
        [4.8552e+00, 4.4560e+00, 5.5166e+00, 5.6270e+00, 3.9640e+05, 0.0000e+00,
         4.0546e+00, 3.8001e+05, 4.0085e+05, 4.2407e+00, 5.2870e+00, 3.7888e+05,
         5.2170e+00, 5.4071e+00, 3.9307e+05, 3.8743e+05],
        [5.3730e+00, 4.9474e+00, 6.1818e+00, 5.7722e+00, 3.9640e+05, 4.0546e+00,
         0.0000e+00, 3.8004e+05, 4.0086e+05, 4.1595e+00, 5.0524e+00, 3.7886e+05,
         4.9336e+00, 5.4923e+00, 3.9310e+05, 3.8745e+05],
        [3.8004e+05, 3.8006e+05, 3.8008e+05, 3.8003e+05, 7.6868e+05, 3.8001e+05,
         3.8004e+05, 0.0000e+00, 7.8759e+05, 3.8006e+05, 3.8005e+05, 7.5499e+05,
         3.8000e+05, 3.8007e+05, 7.4801e+05, 7.6647e+05],
        [4.0092e+05, 4.0088e+05, 4.0089e+05, 4.0090e+05, 7.5043e+05, 4.0085e+05,
         4.0086e+05, 7.8759e+05, 0.0000e+00, 4.0094e+05, 4.0095e+05, 7.5727e+05,
         4.0099e+05, 4.0091e+05, 7.9889e+05, 7.7428e+05],
        [5.0623e+00, 4.5367e+00, 5.8245e+00, 5.6644e+00, 3.9640e+05, 4.2407e+00,
         4.1595e+00, 3.8006e+05, 4.0094e+05, 0.0000e+00, 5.4887e+00, 3.7887e+05,
         4.9895e+00, 5.6759e+00, 3.9308e+05, 3.8744e+05],
        [5.3166e+00, 5.2416e+00, 5.3255e+00, 4.7567e+00, 3.9640e+05, 5.2870e+00,
         5.0524e+00, 3.8005e+05, 4.0095e+05, 5.4887e+00, 0.0000e+00, 3.7884e+05,
         4.9099e+00, 4.5621e+00, 3.9308e+05, 3.8748e+05],
        [3.7885e+05, 3.7887e+05, 3.7888e+05, 3.7883e+05, 7.4113e+05, 3.7888e+05,
         3.7886e+05, 7.5499e+05, 7.5727e+05, 3.7887e+05, 3.7884e+05, 0.0000e+00,
         3.7885e+05, 3.7886e+05, 7.9292e+05, 7.7351e+05],
        [4.9239e+00, 4.7404e+00, 5.4523e+00, 4.9696e+00, 3.9640e+05, 5.2170e+00,
         4.9336e+00, 3.8000e+05, 4.0099e+05, 4.9895e+00, 4.9099e+00, 3.7885e+05,
         0.0000e+00, 5.2556e+00, 3.9307e+05, 3.8749e+05],
        [5.2428e+00, 5.3030e+00, 5.7247e+00, 4.4522e+00, 3.9639e+05, 5.4071e+00,
         5.4923e+00, 3.8007e+05, 4.0091e+05, 5.6759e+00, 4.5621e+00, 3.7886e+05,
         5.2556e+00, 0.0000e+00, 3.9314e+05, 3.8749e+05],
        [3.9305e+05, 3.9311e+05, 3.9310e+05, 3.9308e+05, 7.8671e+05, 3.9307e+05,
         3.9310e+05, 7.4801e+05, 7.9889e+05, 3.9308e+05, 3.9308e+05, 7.9292e+05,
         3.9307e+05, 3.9314e+05, 0.0000e+00, 7.6668e+05],
        [3.8747e+05, 3.8746e+05, 3.8746e+05, 3.8750e+05, 7.7903e+05, 3.8743e+05,
         3.8745e+05, 7.6647e+05, 7.7428e+05, 3.8744e+05, 3.8748e+05, 7.7351e+05,
         3.8749e+05, 3.8749e+05, 7.6668e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 4.8261e+00, 4.8552e+00, 4.9239e+00, 5.0623e+00, 5.2428e+00,
        5.3166e+00, 5.3659e+00, 5.3730e+00, 5.6289e+00, 3.7885e+05, 3.8004e+05,
        3.8747e+05, 3.9305e+05, 3.9643e+05, 4.0092e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.4560e+00, 4.5367e+00, 4.7404e+00, 4.8261e+00, 4.9474e+00,
        5.2416e+00, 5.2563e+00, 5.3030e+00, 5.6176e+00, 3.7887e+05, 3.8006e+05,
        3.8746e+05, 3.9311e+05, 3.9645e+05, 4.0088e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.3255e+00, 5.4523e+00, 5.5166e+00, 5.5610e+00, 5.6176e+00,
        5.6289e+00, 5.7247e+00, 5.8245e+00, 6.1818e+00, 3.7888e+05, 3.8008e+05,
        3.8746e+05, 3.9310e+05, 3.9646e+05, 4.0089e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.4522e+00, 4.7567e+00, 4.9696e+00, 5.2563e+00, 5.3659e+00,
        5.5610e+00, 5.6270e+00, 5.6644e+00, 5.7722e+00, 3.7883e+05, 3.8003e+05,
        3.8750e+05, 3.9308e+05, 3.9644e+05, 4.0090e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396388.3750, 396396.5625, 396398.6250, 396402.0312,
        396403.7500, 396403.9688, 396427.2500, 396437.7812, 396452.4062,
        396460.6875, 741125.6250, 750431.5000, 768684.8750, 779033.8750,
        786707.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.0546e+00, 4.2407e+00, 4.4560e+00, 4.8552e+00, 5.2170e+00,
        5.2870e+00, 5.4071e+00, 5.5166e+00, 5.6270e+00, 3.7888e+05, 3.8001e+05,
        3.8743e+05, 3.9307e+05, 3.9640e+05, 4.0085e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.0546e+00, 4.1595e+00, 4.9336e+00, 4.9474e+00, 5.0524e+00,
        5.3730e+00, 5.4923e+00, 5.7722e+00, 6.1818e+00, 3.7886e+05, 3.8004e+05,
        3.8745e+05, 3.9310e+05, 3.9640e+05, 4.0086e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379998.5938, 380005.2188, 380034.9062, 380037.0312,
        380038.8125, 380045.8125, 380055.6562, 380063.7812, 380070.8125,
        380082.1562, 748010.3750, 754990.6875, 766470.4375, 768684.8750,
        787587.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400852.0938, 400862.9688, 400883.2812, 400885.8438,
        400899.5625, 400909.8125, 400922.7500, 400938.2188, 400951.3750,
        400991.6875, 750431.5000, 757271.8750, 774277.0000, 787587.0000,
        798885.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.1595e+00, 4.2407e+00, 4.5367e+00, 4.9895e+00, 5.0623e+00,
        5.4887e+00, 5.6644e+00, 5.6759e+00, 5.8245e+00, 3.7887e+05, 3.8006e+05,
        3.8744e+05, 3.9308e+05, 3.9640e+05, 4.0094e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.5621e+00, 4.7567e+00, 4.9099e+00, 5.0524e+00, 5.2416e+00,
        5.2870e+00, 5.3166e+00, 5.3255e+00, 5.4887e+00, 3.7884e+05, 3.8005e+05,
        3.8748e+05, 3.9308e+05, 3.9640e+05, 4.0095e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 378828.6250, 378840.0625, 378846.3125, 378849.3750,
        378860.1250, 378860.7500, 378869.7188, 378870.8125, 378880.0000,
        378884.1250, 741125.6250, 754990.6875, 757271.8750, 773511.8750,
        792920.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.7404e+00, 4.9099e+00, 4.9239e+00, 4.9336e+00, 4.9696e+00,
        4.9895e+00, 5.2170e+00, 5.2556e+00, 5.4523e+00, 3.7885e+05, 3.8000e+05,
        3.8749e+05, 3.9307e+05, 3.9640e+05, 4.0099e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.4522e+00, 4.5621e+00, 5.2428e+00, 5.2556e+00, 5.3030e+00,
        5.4071e+00, 5.4923e+00, 5.6759e+00, 5.7247e+00, 3.7886e+05, 3.8007e+05,
        3.8749e+05, 3.9314e+05, 3.9639e+05, 4.0091e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393050.1250, 393073.3750, 393074.8125, 393076.0000,
        393080.1875, 393083.4688, 393096.5000, 393100.4688, 393109.5625,
        393143.6562, 748010.3750, 766677.6250, 786707.7500, 792920.3125,
        798885.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387434.9688, 387444.6562, 387446.6250, 387457.4375,
        387464.2188, 387471.1250, 387482.2812, 387488.6250, 387494.7500,
        387502.8750, 766470.4375, 766677.6250, 773511.8750, 774277.0000,
        779033.8750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37889.60', '37891.57', '37893.49', '37887.60', '396417.16', '37892.47', '37890.68', '380043.28', '400909.75', '37891.54', '37888.60', '378858.97', '37889.17', '37890.73', '393088.81', '387468.75']
estimated f for each client, fs: [6, 6, 6, 6, 4, 6, 6, 4, 4, 6, 6, 4, 6, 6, 4, 4]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 9, 8, 5, 15, 10, 2, 14, 13, 1, 6, 18, 4, 3, 19, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:27...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:27, End: 2025-07-22 16:00:27)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 14, 18, 17, 4, 3, 15, 19, 16, 10, 9, 5, 13, 2, 7, 20], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9461e+05, 3.9444e+05, 4.0811e+05, 1.8323e+00, 1.9640e+00,
         3.9182e+05, 3.9579e+05, 3.9486e+05, 1.8726e+00, 1.7574e+00, 2.0077e+00,
         3.9615e+05, 1.8930e+00, 1.8721e+00, 3.8920e+05],
        [3.9461e+05, 0.0000e+00, 7.7036e+05, 8.1563e+05, 3.9457e+05, 3.9461e+05,
         7.9437e+05, 7.8226e+05, 8.1570e+05, 3.9461e+05, 3.9459e+05, 3.9461e+05,
         8.1052e+05, 3.9457e+05, 3.9459e+05, 7.8782e+05],
        [3.9444e+05, 7.7036e+05, 0.0000e+00, 7.9662e+05, 3.9442e+05, 3.9440e+05,
         7.8075e+05, 7.7636e+05, 7.9527e+05, 3.9444e+05, 3.9444e+05, 3.9445e+05,
         8.1806e+05, 3.9445e+05, 3.9442e+05, 7.6549e+05],
        [4.0811e+05, 8.1563e+05, 7.9662e+05, 0.0000e+00, 4.0811e+05, 4.0810e+05,
         7.9574e+05, 8.1475e+05, 8.2314e+05, 4.0811e+05, 4.0806e+05, 4.0809e+05,
         8.0813e+05, 4.0808e+05, 4.0809e+05, 7.9052e+05],
        [1.8323e+00, 3.9457e+05, 3.9442e+05, 4.0811e+05, 0.0000e+00, 1.9591e+00,
         3.9176e+05, 3.9578e+05, 3.9485e+05, 1.9063e+00, 1.8869e+00, 2.1372e+00,
         3.9615e+05, 1.9221e+00, 1.6957e+00, 3.8923e+05],
        [1.9640e+00, 3.9461e+05, 3.9440e+05, 4.0810e+05, 1.9591e+00, 0.0000e+00,
         3.9177e+05, 3.9580e+05, 3.9485e+05, 1.9079e+00, 1.8104e+00, 2.0678e+00,
         3.9615e+05, 1.8707e+00, 1.9434e+00, 3.8921e+05],
        [3.9182e+05, 7.9437e+05, 7.8075e+05, 7.9574e+05, 3.9176e+05, 3.9177e+05,
         0.0000e+00, 7.7411e+05, 7.9298e+05, 3.9176e+05, 3.9180e+05, 3.9177e+05,
         7.8276e+05, 3.9178e+05, 3.9181e+05, 7.9158e+05],
        [3.9579e+05, 7.8226e+05, 7.7636e+05, 8.1475e+05, 3.9578e+05, 3.9580e+05,
         7.7411e+05, 0.0000e+00, 7.8276e+05, 3.9577e+05, 3.9577e+05, 3.9579e+05,
         7.8697e+05, 3.9576e+05, 3.9578e+05, 7.8181e+05],
        [3.9486e+05, 8.1570e+05, 7.9527e+05, 8.2314e+05, 3.9485e+05, 3.9485e+05,
         7.9298e+05, 7.8276e+05, 0.0000e+00, 3.9486e+05, 3.9487e+05, 3.9485e+05,
         8.0079e+05, 3.9485e+05, 3.9486e+05, 7.9088e+05],
        [1.8726e+00, 3.9461e+05, 3.9444e+05, 4.0811e+05, 1.9063e+00, 1.9079e+00,
         3.9176e+05, 3.9577e+05, 3.9486e+05, 0.0000e+00, 1.6920e+00, 2.0916e+00,
         3.9615e+05, 1.7463e+00, 1.7561e+00, 3.8923e+05],
        [1.7574e+00, 3.9459e+05, 3.9444e+05, 4.0806e+05, 1.8869e+00, 1.8104e+00,
         3.9180e+05, 3.9577e+05, 3.9487e+05, 1.6920e+00, 0.0000e+00, 2.1392e+00,
         3.9615e+05, 1.8171e+00, 1.9578e+00, 3.8920e+05],
        [2.0077e+00, 3.9461e+05, 3.9445e+05, 4.0809e+05, 2.1372e+00, 2.0678e+00,
         3.9177e+05, 3.9579e+05, 3.9485e+05, 2.0916e+00, 2.1392e+00, 0.0000e+00,
         3.9618e+05, 2.2339e+00, 1.9743e+00, 3.8926e+05],
        [3.9615e+05, 8.1052e+05, 8.1806e+05, 8.0813e+05, 3.9615e+05, 3.9615e+05,
         7.8276e+05, 7.8697e+05, 8.0079e+05, 3.9615e+05, 3.9615e+05, 3.9618e+05,
         0.0000e+00, 3.9615e+05, 3.9617e+05, 7.9382e+05],
        [1.8930e+00, 3.9457e+05, 3.9445e+05, 4.0808e+05, 1.9221e+00, 1.8707e+00,
         3.9178e+05, 3.9576e+05, 3.9485e+05, 1.7463e+00, 1.8171e+00, 2.2339e+00,
         3.9615e+05, 0.0000e+00, 1.7801e+00, 3.8922e+05],
        [1.8721e+00, 3.9459e+05, 3.9442e+05, 4.0809e+05, 1.6957e+00, 1.9434e+00,
         3.9181e+05, 3.9578e+05, 3.9486e+05, 1.7561e+00, 1.9578e+00, 1.9743e+00,
         3.9617e+05, 1.7801e+00, 0.0000e+00, 3.8925e+05],
        [3.8920e+05, 7.8782e+05, 7.6549e+05, 7.9052e+05, 3.8923e+05, 3.8921e+05,
         7.9158e+05, 7.8181e+05, 7.9088e+05, 3.8923e+05, 3.8920e+05, 3.8926e+05,
         7.9382e+05, 3.8922e+05, 3.8925e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7574e+00, 1.8323e+00, 1.8721e+00, 1.8726e+00, 1.8930e+00,
        1.9640e+00, 2.0077e+00, 3.8920e+05, 3.9182e+05, 3.9444e+05, 3.9461e+05,
        3.9486e+05, 3.9579e+05, 3.9615e+05, 4.0811e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394570.5312, 394574.1250, 394586.9688, 394590.3125,
        394608.7500, 394609.0312, 394611.7500, 394612.2812, 770358.1250,
        782259.7500, 787824.2500, 794367.9375, 810516.3125, 815632.8125,
        815705.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394395.1250, 394421.3750, 394422.9375, 394436.2500,
        394442.3750, 394443.2500, 394446.5625, 394453.1250, 765486.0000,
        770358.1250, 776357.4375, 780745.8750, 795267.5625, 796617.3750,
        818064.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 408057.0000, 408083.1250, 408085.0625, 408086.8750,
        408096.0938, 408107.2500, 408107.2812, 408114.1250, 790517.1875,
        795740.7500, 796617.3750, 808125.7500, 814752.5000, 815632.8125,
        823143.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6957e+00, 1.8323e+00, 1.8869e+00, 1.9063e+00, 1.9221e+00,
        1.9591e+00, 2.1372e+00, 3.8923e+05, 3.9176e+05, 3.9442e+05, 3.9457e+05,
        3.9485e+05, 3.9578e+05, 3.9615e+05, 4.0811e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8104e+00, 1.8707e+00, 1.9079e+00, 1.9434e+00, 1.9591e+00,
        1.9640e+00, 2.0678e+00, 3.8921e+05, 3.9177e+05, 3.9440e+05, 3.9461e+05,
        3.9485e+05, 3.9580e+05, 3.9615e+05, 4.0810e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391761.3125, 391761.4062, 391770.5312, 391774.0000,
        391778.6875, 391802.1875, 391806.2500, 391823.1250, 774106.3750,
        780745.8750, 782758.0000, 791580.0000, 792978.0000, 794367.9375,
        795740.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395764.0000, 395770.7500, 395772.2500, 395780.9062,
        395780.9375, 395792.6875, 395793.3125, 395801.1875, 774106.3750,
        776357.4375, 781813.0625, 782259.7500, 782764.5625, 786970.8750,
        814752.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394847.4375, 394852.2188, 394853.5625, 394854.3438,
        394855.5625, 394858.8750, 394860.9688, 394874.2500, 782764.5625,
        790879.8750, 792978.0000, 795267.5625, 800786.1875, 815705.0000,
        823143.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6920e+00, 1.7463e+00, 1.7561e+00, 1.8726e+00, 1.9063e+00,
        1.9079e+00, 2.0916e+00, 3.8923e+05, 3.9176e+05, 3.9444e+05, 3.9461e+05,
        3.9486e+05, 3.9577e+05, 3.9615e+05, 4.0811e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6920e+00, 1.7574e+00, 1.8104e+00, 1.8171e+00, 1.8869e+00,
        1.9578e+00, 2.1392e+00, 3.8920e+05, 3.9180e+05, 3.9444e+05, 3.9459e+05,
        3.9487e+05, 3.9577e+05, 3.9615e+05, 4.0806e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.9743e+00, 2.0077e+00, 2.0678e+00, 2.0916e+00, 2.1372e+00,
        2.1392e+00, 2.2339e+00, 3.8926e+05, 3.9177e+05, 3.9445e+05, 3.9461e+05,
        3.9485e+05, 3.9579e+05, 3.9618e+05, 4.0809e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396149.2500, 396149.2812, 396149.7500, 396152.4688,
        396153.3750, 396153.6875, 396174.1875, 396183.6875, 782758.0000,
        786970.8750, 793816.1250, 800786.1875, 808125.7500, 810516.3125,
        818064.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7463e+00, 1.7801e+00, 1.8171e+00, 1.8707e+00, 1.8930e+00,
        1.9221e+00, 2.2339e+00, 3.8922e+05, 3.9178e+05, 3.9445e+05, 3.9457e+05,
        3.9485e+05, 3.9576e+05, 3.9615e+05, 4.0808e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6957e+00, 1.7561e+00, 1.7801e+00, 1.8721e+00, 1.9434e+00,
        1.9578e+00, 1.9743e+00, 3.8925e+05, 3.9181e+05, 3.9442e+05, 3.9459e+05,
        3.9486e+05, 3.9578e+05, 3.9617e+05, 4.0809e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389196.5000, 389203.1250, 389206.4062, 389219.9375,
        389226.7812, 389229.5312, 389245.9375, 389264.0312, 765486.0000,
        781813.0625, 787824.2500, 790517.1875, 790879.8750, 791580.0000,
        793816.1250])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['117548.27', '470938.16', '469130.50', '485099.44', '117542.71', '117538.55', '468913.00', '471672.00', '473250.19', '117543.73', '117545.40', '117550.58', '473899.44', '117545.85', '117548.65', '466109.09']
estimated f for each client, fs: [8, 5, 5, 5, 8, 8, 5, 5, 6, 8, 8, 8, 5, 8, 8, 6]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 14, 18, 17, 4, 3, 15, 19, 16, 10, 9, 5, 13, 2, 7, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0111s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:27...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:27, End: 2025-07-22 16:00:27)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 9, 6, 13, 20, 16, 3, 18, 7, 1, 8, 11, 14, 10, 12, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8074e+05, 3.8067e+05, 7.5596e+05, 7.5537e+05, 7.4683e+05,
         3.8071e+05, 7.8480e+05, 3.8067e+05, 3.8069e+05, 3.8066e+05, 3.8069e+05,
         7.5507e+05, 3.8069e+05, 3.8069e+05, 7.7610e+05],
        [3.8074e+05, 0.0000e+00, 1.6553e+00, 3.8576e+05, 3.8055e+05, 3.9520e+05,
         1.7946e+00, 3.9560e+05, 1.7206e+00, 1.6060e+00, 1.6862e+00, 1.6087e+00,
         3.7920e+05, 1.5577e+00, 1.6705e+00, 3.8550e+05],
        [3.8067e+05, 1.6553e+00, 0.0000e+00, 3.8578e+05, 3.8058e+05, 3.9520e+05,
         2.1975e+00, 3.9559e+05, 1.7061e+00, 1.6263e+00, 1.7294e+00, 1.6386e+00,
         3.7919e+05, 1.6710e+00, 1.7070e+00, 3.8554e+05],
        [7.5596e+05, 3.8576e+05, 3.8578e+05, 0.0000e+00, 7.6744e+05, 7.7973e+05,
         3.8577e+05, 7.8729e+05, 3.8580e+05, 3.8578e+05, 3.8576e+05, 3.8574e+05,
         7.8898e+05, 3.8573e+05, 3.8575e+05, 7.7163e+05],
        [7.5537e+05, 3.8055e+05, 3.8058e+05, 7.6744e+05, 0.0000e+00, 7.8837e+05,
         3.8057e+05, 7.8013e+05, 3.8053e+05, 3.8053e+05, 3.8056e+05, 3.8057e+05,
         7.3688e+05, 3.8051e+05, 3.8056e+05, 7.6385e+05],
        [7.4683e+05, 3.9520e+05, 3.9520e+05, 7.7973e+05, 7.8837e+05, 0.0000e+00,
         3.9521e+05, 8.0582e+05, 3.9519e+05, 3.9520e+05, 3.9523e+05, 3.9521e+05,
         7.7346e+05, 3.9518e+05, 3.9518e+05, 7.8643e+05],
        [3.8071e+05, 1.7946e+00, 2.1975e+00, 3.8577e+05, 3.8057e+05, 3.9521e+05,
         0.0000e+00, 3.9560e+05, 1.8774e+00, 1.9067e+00, 1.8709e+00, 1.9533e+00,
         3.7919e+05, 1.8346e+00, 1.7690e+00, 3.8551e+05],
        [7.8480e+05, 3.9560e+05, 3.9559e+05, 7.8729e+05, 7.8013e+05, 8.0582e+05,
         3.9560e+05, 0.0000e+00, 3.9559e+05, 3.9559e+05, 3.9557e+05, 3.9560e+05,
         7.5547e+05, 3.9559e+05, 3.9560e+05, 7.8322e+05],
        [3.8067e+05, 1.7206e+00, 1.7061e+00, 3.8580e+05, 3.8053e+05, 3.9519e+05,
         1.8774e+00, 3.9559e+05, 0.0000e+00, 1.5762e+00, 1.7614e+00, 1.5411e+00,
         3.7919e+05, 1.5017e+00, 1.6246e+00, 3.8550e+05],
        [3.8069e+05, 1.6060e+00, 1.6263e+00, 3.8578e+05, 3.8053e+05, 3.9520e+05,
         1.9067e+00, 3.9559e+05, 1.5762e+00, 0.0000e+00, 1.7760e+00, 1.6189e+00,
         3.7918e+05, 1.5858e+00, 1.5998e+00, 3.8548e+05],
        [3.8066e+05, 1.6862e+00, 1.7294e+00, 3.8576e+05, 3.8056e+05, 3.9523e+05,
         1.8709e+00, 3.9557e+05, 1.7614e+00, 1.7760e+00, 0.0000e+00, 1.6793e+00,
         3.7922e+05, 1.5909e+00, 1.8172e+00, 3.8553e+05],
        [3.8069e+05, 1.6087e+00, 1.6386e+00, 3.8574e+05, 3.8057e+05, 3.9521e+05,
         1.9533e+00, 3.9560e+05, 1.5411e+00, 1.6189e+00, 1.6793e+00, 0.0000e+00,
         3.7918e+05, 1.6160e+00, 1.7133e+00, 3.8557e+05],
        [7.5507e+05, 3.7920e+05, 3.7919e+05, 7.8898e+05, 7.3688e+05, 7.7346e+05,
         3.7919e+05, 7.5547e+05, 3.7919e+05, 3.7918e+05, 3.7922e+05, 3.7918e+05,
         0.0000e+00, 3.7918e+05, 3.7919e+05, 7.8864e+05],
        [3.8069e+05, 1.5577e+00, 1.6710e+00, 3.8573e+05, 3.8051e+05, 3.9518e+05,
         1.8346e+00, 3.9559e+05, 1.5017e+00, 1.5858e+00, 1.5909e+00, 1.6160e+00,
         3.7918e+05, 0.0000e+00, 1.6106e+00, 3.8552e+05],
        [3.8069e+05, 1.6705e+00, 1.7070e+00, 3.8575e+05, 3.8056e+05, 3.9518e+05,
         1.7690e+00, 3.9560e+05, 1.6246e+00, 1.5998e+00, 1.8172e+00, 1.7133e+00,
         3.7919e+05, 1.6106e+00, 0.0000e+00, 3.8553e+05],
        [7.7610e+05, 3.8550e+05, 3.8554e+05, 7.7163e+05, 7.6385e+05, 7.8643e+05,
         3.8551e+05, 7.8322e+05, 3.8550e+05, 3.8548e+05, 3.8553e+05, 3.8557e+05,
         7.8864e+05, 3.8552e+05, 3.8553e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 380664.8125, 380667.1250, 380673.7812, 380686.7188,
        380692.0312, 380692.9062, 380693.9062, 380707.8125, 380736.1250,
        746831.2500, 755069.3750, 755367.3750, 755958.8750, 776097.6250,
        784804.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5577e+00, 1.6060e+00, 1.6087e+00, 1.6553e+00, 1.6705e+00,
        1.6862e+00, 1.7206e+00, 1.7946e+00, 3.7920e+05, 3.8055e+05, 3.8074e+05,
        3.8550e+05, 3.8576e+05, 3.9520e+05, 3.9560e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6263e+00, 1.6386e+00, 1.6553e+00, 1.6710e+00, 1.7061e+00,
        1.7070e+00, 1.7294e+00, 2.1975e+00, 3.7919e+05, 3.8058e+05, 3.8067e+05,
        3.8554e+05, 3.8578e+05, 3.9520e+05, 3.9559e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385733.2500, 385743.0625, 385748.2812, 385757.2188,
        385761.1250, 385773.8750, 385782.7188, 385784.1562, 385798.5000,
        755958.8750, 767438.8125, 771631.7500, 779728.5000, 787288.1250,
        788975.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380506.6250, 380531.0312, 380531.2188, 380552.2188,
        380555.1875, 380562.0312, 380566.8125, 380567.2500, 380577.3125,
        736877.9375, 755367.3750, 763847.6250, 767438.8125, 780127.5000,
        788366.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395182.6250, 395184.7812, 395191.5312, 395195.8125,
        395199.5312, 395201.5000, 395208.2188, 395214.2500, 395227.5000,
        746831.2500, 773459.2500, 779728.5000, 786428.8750, 788366.1875,
        805819.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7690e+00, 1.7946e+00, 1.8346e+00, 1.8709e+00, 1.8774e+00,
        1.9067e+00, 1.9533e+00, 2.1975e+00, 3.7919e+05, 3.8057e+05, 3.8071e+05,
        3.8551e+05, 3.8577e+05, 3.9521e+05, 3.9560e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395574.2500, 395586.0312, 395588.4688, 395588.8750,
        395593.7500, 395597.3438, 395598.1250, 395599.5000, 395603.7500,
        755474.2500, 780127.5000, 783222.3750, 784804.5625, 787288.1250,
        805819.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5017e+00, 1.5411e+00, 1.5762e+00, 1.6246e+00, 1.7061e+00,
        1.7206e+00, 1.7614e+00, 1.8774e+00, 3.7919e+05, 3.8053e+05, 3.8067e+05,
        3.8550e+05, 3.8580e+05, 3.9519e+05, 3.9559e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5762e+00, 1.5858e+00, 1.5998e+00, 1.6060e+00, 1.6189e+00,
        1.6263e+00, 1.7760e+00, 1.9067e+00, 3.7918e+05, 3.8053e+05, 3.8069e+05,
        3.8548e+05, 3.8578e+05, 3.9520e+05, 3.9559e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5909e+00, 1.6793e+00, 1.6862e+00, 1.7294e+00, 1.7614e+00,
        1.7760e+00, 1.8172e+00, 1.8709e+00, 3.7922e+05, 3.8056e+05, 3.8066e+05,
        3.8553e+05, 3.8576e+05, 3.9523e+05, 3.9557e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5411e+00, 1.6087e+00, 1.6160e+00, 1.6189e+00, 1.6386e+00,
        1.6793e+00, 1.7133e+00, 1.9533e+00, 3.7918e+05, 3.8057e+05, 3.8069e+05,
        3.8557e+05, 3.8574e+05, 3.9521e+05, 3.9560e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379175.4062, 379177.0625, 379177.2500, 379186.4688,
        379192.3125, 379192.9375, 379194.6875, 379199.4688, 379221.5938,
        736877.9375, 755069.3750, 755474.2500, 773459.2500, 788637.1250,
        788975.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5017e+00, 1.5577e+00, 1.5858e+00, 1.5909e+00, 1.6106e+00,
        1.6160e+00, 1.6710e+00, 1.8346e+00, 3.7918e+05, 3.8051e+05, 3.8069e+05,
        3.8552e+05, 3.8573e+05, 3.9518e+05, 3.9559e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5998e+00, 1.6106e+00, 1.6246e+00, 1.6705e+00, 1.7070e+00,
        1.7133e+00, 1.7690e+00, 1.8172e+00, 3.7919e+05, 3.8056e+05, 3.8069e+05,
        3.8553e+05, 3.8575e+05, 3.9518e+05, 3.9560e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385479.6562, 385498.7812, 385503.3125, 385512.6562,
        385515.9375, 385525.3750, 385531.5000, 385538.9375, 385574.6562,
        763847.6250, 771631.7500, 776097.6250, 783222.3750, 786428.8750,
        788637.1250])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['417304.69', '75976.51', '75978.35', '422784.16', '416182.75', '430363.69', '75976.89', '431580.41', '75973.74', '75972.16', '75979.75', '75975.56', '414959.53', '75969.66', '75976.34', '423352.84']
estimated f for each client, fs: [5, 7, 7, 5, 5, 5, 7, 5, 7, 7, 7, 7, 5, 7, 7, 5]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 9, 6, 13, 20, 16, 3, 18, 7, 1, 8, 11, 14, 10, 12, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:28...
global Accuracy on shared test data: 79.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 46 217]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:28, End: 2025-07-22 16:00:28)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 5, 11, 17, 9, 15, 18, 20, 16, 4, 13, 6, 19, 8, 12, 7], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8067e+05, 3.8065e+05, 7.8687e+05, 3.8068e+05, 7.7884e+05,
         7.7721e+05, 7.8522e+05, 7.7200e+05, 3.8063e+05, 7.7670e+05, 3.8067e+05,
         7.7823e+05, 3.8066e+05, 3.8068e+05, 3.8069e+05],
        [3.8067e+05, 0.0000e+00, 1.6578e+00, 3.9730e+05, 1.8614e+00, 3.8726e+05,
         3.9460e+05, 3.9527e+05, 3.9450e+05, 1.8441e+00, 3.8925e+05, 1.9872e+00,
         3.9345e+05, 1.9541e+00, 1.8713e+00, 1.7689e+00],
        [3.8065e+05, 1.6578e+00, 0.0000e+00, 3.9732e+05, 1.6147e+00, 3.8726e+05,
         3.9459e+05, 3.9526e+05, 3.9448e+05, 1.4584e+00, 3.8925e+05, 1.6804e+00,
         3.9342e+05, 1.7631e+00, 1.6564e+00, 1.5841e+00],
        [7.8687e+05, 3.9730e+05, 3.9732e+05, 0.0000e+00, 3.9726e+05, 7.6147e+05,
         7.8197e+05, 7.7394e+05, 7.9425e+05, 3.9730e+05, 7.4616e+05, 3.9730e+05,
         7.9672e+05, 3.9729e+05, 3.9727e+05, 3.9730e+05],
        [3.8068e+05, 1.8614e+00, 1.6147e+00, 3.9726e+05, 0.0000e+00, 3.8722e+05,
         3.9460e+05, 3.9524e+05, 3.9447e+05, 1.7210e+00, 3.8925e+05, 1.7256e+00,
         3.9344e+05, 1.7352e+00, 1.6569e+00, 1.8036e+00],
        [7.7884e+05, 3.8726e+05, 3.8726e+05, 7.6147e+05, 3.8722e+05, 0.0000e+00,
         8.0299e+05, 7.5962e+05, 7.6896e+05, 3.8727e+05, 7.7080e+05, 3.8724e+05,
         7.9810e+05, 3.8724e+05, 3.8726e+05, 3.8725e+05],
        [7.7721e+05, 3.9460e+05, 3.9459e+05, 7.8197e+05, 3.9460e+05, 8.0299e+05,
         0.0000e+00, 7.5786e+05, 7.9044e+05, 3.9461e+05, 7.6896e+05, 3.9460e+05,
         7.8945e+05, 3.9461e+05, 3.9461e+05, 3.9458e+05],
        [7.8522e+05, 3.9527e+05, 3.9526e+05, 7.7394e+05, 3.9524e+05, 7.5962e+05,
         7.5786e+05, 0.0000e+00, 7.8755e+05, 3.9526e+05, 7.8435e+05, 3.9526e+05,
         7.9687e+05, 3.9526e+05, 3.9526e+05, 3.9526e+05],
        [7.7200e+05, 3.9450e+05, 3.9448e+05, 7.9425e+05, 3.9447e+05, 7.6896e+05,
         7.9044e+05, 7.8755e+05, 0.0000e+00, 3.9449e+05, 7.7944e+05, 3.9444e+05,
         7.7736e+05, 3.9447e+05, 3.9451e+05, 3.9449e+05],
        [3.8063e+05, 1.8441e+00, 1.4584e+00, 3.9730e+05, 1.7210e+00, 3.8727e+05,
         3.9461e+05, 3.9526e+05, 3.9449e+05, 0.0000e+00, 3.8922e+05, 1.6129e+00,
         3.9346e+05, 1.6626e+00, 1.6314e+00, 1.5642e+00],
        [7.7670e+05, 3.8925e+05, 3.8925e+05, 7.4616e+05, 3.8925e+05, 7.7080e+05,
         7.6896e+05, 7.8435e+05, 7.7944e+05, 3.8922e+05, 0.0000e+00, 3.8927e+05,
         7.8949e+05, 3.8925e+05, 3.8925e+05, 3.8926e+05],
        [3.8067e+05, 1.9872e+00, 1.6804e+00, 3.9730e+05, 1.7256e+00, 3.8724e+05,
         3.9460e+05, 3.9526e+05, 3.9444e+05, 1.6129e+00, 3.8927e+05, 0.0000e+00,
         3.9342e+05, 1.8073e+00, 1.7959e+00, 1.8304e+00],
        [7.7823e+05, 3.9345e+05, 3.9342e+05, 7.9672e+05, 3.9344e+05, 7.9810e+05,
         7.8945e+05, 7.9687e+05, 7.7736e+05, 3.9346e+05, 7.8949e+05, 3.9342e+05,
         0.0000e+00, 3.9343e+05, 3.9343e+05, 3.9343e+05],
        [3.8066e+05, 1.9541e+00, 1.7631e+00, 3.9729e+05, 1.7352e+00, 3.8724e+05,
         3.9461e+05, 3.9526e+05, 3.9447e+05, 1.6626e+00, 3.8925e+05, 1.8073e+00,
         3.9343e+05, 0.0000e+00, 1.9258e+00, 1.8133e+00],
        [3.8068e+05, 1.8713e+00, 1.6564e+00, 3.9727e+05, 1.6569e+00, 3.8726e+05,
         3.9461e+05, 3.9526e+05, 3.9451e+05, 1.6314e+00, 3.8925e+05, 1.7959e+00,
         3.9343e+05, 1.9258e+00, 0.0000e+00, 1.6740e+00],
        [3.8069e+05, 1.7689e+00, 1.5841e+00, 3.9730e+05, 1.8036e+00, 3.8725e+05,
         3.9458e+05, 3.9526e+05, 3.9449e+05, 1.5642e+00, 3.8926e+05, 1.8304e+00,
         3.9343e+05, 1.8133e+00, 1.6740e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 380626.8750, 380653.0625, 380659.7812, 380670.1875,
        380673.6562, 380677.7188, 380680.8750, 380686.7500, 771996.0000,
        776700.1250, 777205.0625, 778229.6250, 778838.1250, 785223.1875,
        786869.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6578e+00, 1.7689e+00, 1.8441e+00, 1.8614e+00, 1.8713e+00,
        1.9541e+00, 1.9872e+00, 3.8067e+05, 3.8726e+05, 3.8925e+05, 3.9345e+05,
        3.9450e+05, 3.9460e+05, 3.9527e+05, 3.9730e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4584e+00, 1.5841e+00, 1.6147e+00, 1.6564e+00, 1.6578e+00,
        1.6804e+00, 1.7631e+00, 3.8065e+05, 3.8726e+05, 3.8925e+05, 3.9342e+05,
        3.9448e+05, 3.9459e+05, 3.9526e+05, 3.9732e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397262.1562, 397271.9688, 397290.0625, 397295.3125,
        397297.2812, 397297.5312, 397299.8438, 397315.5625, 746156.6875,
        761469.5000, 773942.8750, 781973.3125, 786869.8750, 794247.3750,
        796724.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6147e+00, 1.6569e+00, 1.7210e+00, 1.7256e+00, 1.7352e+00,
        1.8036e+00, 1.8614e+00, 3.8068e+05, 3.8722e+05, 3.8925e+05, 3.9344e+05,
        3.9447e+05, 3.9460e+05, 3.9524e+05, 3.9726e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387224.7188, 387243.5000, 387244.2188, 387254.4062,
        387259.7500, 387262.3438, 387263.8750, 387270.2188, 759622.7500,
        761469.5000, 768960.8750, 770802.5625, 778838.1250, 798096.6250,
        802992.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394577.2500, 394592.3750, 394598.0312, 394602.3438,
        394603.9062, 394609.0625, 394609.6250, 394613.5625, 757856.4375,
        768957.5625, 777205.0625, 781973.3125, 789453.8750, 790435.4375,
        802992.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395240.3750, 395259.9688, 395260.1250, 395260.2812,
        395262.6875, 395262.9062, 395264.9375, 395265.6250, 757856.4375,
        759622.7500, 773942.8750, 784349.1250, 785223.1875, 787552.6250,
        796869.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394441.6875, 394465.3125, 394471.5000, 394475.6250,
        394488.9062, 394491.5938, 394499.5000, 394509.3125, 768960.8750,
        771996.0000, 777359.3750, 779444.4375, 787552.6250, 790435.4375,
        794247.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4584e+00, 1.5642e+00, 1.6129e+00, 1.6314e+00, 1.6626e+00,
        1.7210e+00, 1.8441e+00, 3.8063e+05, 3.8727e+05, 3.8922e+05, 3.9346e+05,
        3.9449e+05, 3.9461e+05, 3.9526e+05, 3.9730e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389216.7500, 389245.9688, 389247.0000, 389250.7500,
        389252.5000, 389253.3750, 389263.0312, 389265.1875, 746156.6875,
        768957.5625, 770802.5625, 776700.1250, 779444.4375, 784349.1250,
        789489.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6129e+00, 1.6804e+00, 1.7256e+00, 1.7959e+00, 1.8073e+00,
        1.8304e+00, 1.9872e+00, 3.8067e+05, 3.8724e+05, 3.8927e+05, 3.9342e+05,
        3.9444e+05, 3.9460e+05, 3.9526e+05, 3.9730e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393422.8125, 393423.8750, 393425.8125, 393430.4375,
        393431.0625, 393442.1562, 393451.6875, 393458.6562, 777359.3750,
        778229.6250, 789453.8750, 789489.2500, 796724.6250, 796869.1250,
        798096.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6626e+00, 1.7352e+00, 1.7631e+00, 1.8073e+00, 1.8133e+00,
        1.9258e+00, 1.9541e+00, 3.8066e+05, 3.8724e+05, 3.8925e+05, 3.9343e+05,
        3.9447e+05, 3.9461e+05, 3.9526e+05, 3.9729e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6314e+00, 1.6564e+00, 1.6569e+00, 1.6740e+00, 1.7959e+00,
        1.8713e+00, 1.9258e+00, 3.8068e+05, 3.8726e+05, 3.8925e+05, 3.9343e+05,
        3.9451e+05, 3.9461e+05, 3.9526e+05, 3.9727e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5642e+00, 1.5841e+00, 1.6740e+00, 1.7689e+00, 1.8036e+00,
        1.8133e+00, 1.8304e+00, 3.8069e+05, 3.8725e+05, 3.8926e+05, 3.9343e+05,
        3.9449e+05, 3.9458e+05, 3.9526e+05, 3.9730e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['459402.50', '115719.25', '115717.67', '468595.56', '115716.81', '461911.50', '468362.00', '467955.59', '469680.06', '115712.55', '462910.84', '115719.55', '470307.50', '115716.67', '115720.30', '115721.62']
estimated f for each client, fs: [7, 8, 8, 5, 8, 5, 5, 5, 5, 8, 5, 8, 5, 8, 8, 8]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 5, 11, 17, 9, 15, 18, 20, 16, 4, 13, 6, 19, 8, 12, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0115s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:28...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:28, End: 2025-07-22 16:00:28)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 8, 18, 2, 6, 13, 3, 5, 17, 14, 11, 1, 12, 15, 19, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.8498e+00, 3.9232e+05, 1.8656e+00, 1.8243e+00, 3.9208e+05,
         1.8545e+00, 1.8956e+00, 3.9365e+05, 3.8429e+05, 1.8180e+00, 1.8476e+00,
         1.6732e+00, 4.0239e+05, 3.7714e+05, 3.9770e+05],
        [1.8498e+00, 0.0000e+00, 3.9231e+05, 2.0064e+00, 1.9471e+00, 3.9207e+05,
         1.9432e+00, 2.1696e+00, 3.9366e+05, 3.8427e+05, 1.8852e+00, 2.0027e+00,
         2.0644e+00, 4.0237e+05, 3.7713e+05, 3.9766e+05],
        [3.9232e+05, 3.9231e+05, 0.0000e+00, 3.9231e+05, 3.9228e+05, 8.0167e+05,
         3.9233e+05, 3.9229e+05, 7.9513e+05, 7.6387e+05, 3.9232e+05, 3.9233e+05,
         3.9230e+05, 8.0426e+05, 7.5733e+05, 8.0657e+05],
        [1.8656e+00, 2.0064e+00, 3.9231e+05, 0.0000e+00, 1.7618e+00, 3.9205e+05,
         1.8622e+00, 2.0528e+00, 3.9364e+05, 3.8431e+05, 1.8193e+00, 1.8285e+00,
         1.8337e+00, 4.0242e+05, 3.7716e+05, 3.9769e+05],
        [1.8243e+00, 1.9471e+00, 3.9228e+05, 1.7618e+00, 0.0000e+00, 3.9206e+05,
         2.2311e+00, 2.1287e+00, 3.9364e+05, 3.8430e+05, 1.8564e+00, 1.8586e+00,
         1.9421e+00, 4.0239e+05, 3.7718e+05, 3.9773e+05],
        [3.9208e+05, 3.9207e+05, 8.0167e+05, 3.9205e+05, 3.9206e+05, 0.0000e+00,
         3.9209e+05, 3.9207e+05, 7.8778e+05, 7.8645e+05, 3.9207e+05, 3.9207e+05,
         3.9205e+05, 7.7445e+05, 7.4283e+05, 7.9409e+05],
        [1.8545e+00, 1.9432e+00, 3.9233e+05, 1.8622e+00, 2.2311e+00, 3.9209e+05,
         0.0000e+00, 1.8174e+00, 3.9365e+05, 3.8431e+05, 2.0098e+00, 2.0273e+00,
         1.8165e+00, 4.0237e+05, 3.7714e+05, 3.9770e+05],
        [1.8956e+00, 2.1696e+00, 3.9229e+05, 2.0528e+00, 2.1287e+00, 3.9207e+05,
         1.8174e+00, 0.0000e+00, 3.9367e+05, 3.8433e+05, 1.8270e+00, 1.9272e+00,
         1.9556e+00, 4.0232e+05, 3.7716e+05, 3.9770e+05],
        [3.9365e+05, 3.9366e+05, 7.9513e+05, 3.9364e+05, 3.9364e+05, 7.8778e+05,
         3.9365e+05, 3.9367e+05, 0.0000e+00, 7.7012e+05, 3.9366e+05, 3.9363e+05,
         3.9365e+05, 8.0823e+05, 7.5446e+05, 8.0687e+05],
        [3.8429e+05, 3.8427e+05, 7.6387e+05, 3.8431e+05, 3.8430e+05, 7.8645e+05,
         3.8431e+05, 3.8433e+05, 7.7012e+05, 0.0000e+00, 3.8430e+05, 3.8430e+05,
         3.8429e+05, 8.0545e+05, 7.5405e+05, 7.7066e+05],
        [1.8180e+00, 1.8852e+00, 3.9232e+05, 1.8193e+00, 1.8564e+00, 3.9207e+05,
         2.0098e+00, 1.8270e+00, 3.9366e+05, 3.8430e+05, 0.0000e+00, 1.7823e+00,
         1.8579e+00, 4.0237e+05, 3.7719e+05, 3.9770e+05],
        [1.8476e+00, 2.0027e+00, 3.9233e+05, 1.8285e+00, 1.8586e+00, 3.9207e+05,
         2.0273e+00, 1.9272e+00, 3.9363e+05, 3.8430e+05, 1.7823e+00, 0.0000e+00,
         1.7728e+00, 4.0237e+05, 3.7713e+05, 3.9772e+05],
        [1.6732e+00, 2.0644e+00, 3.9230e+05, 1.8337e+00, 1.9421e+00, 3.9205e+05,
         1.8165e+00, 1.9556e+00, 3.9365e+05, 3.8429e+05, 1.8579e+00, 1.7728e+00,
         0.0000e+00, 4.0239e+05, 3.7715e+05, 3.9771e+05],
        [4.0239e+05, 4.0237e+05, 8.0426e+05, 4.0242e+05, 4.0239e+05, 7.7445e+05,
         4.0237e+05, 4.0232e+05, 8.0823e+05, 8.0545e+05, 4.0237e+05, 4.0237e+05,
         4.0239e+05, 0.0000e+00, 7.6651e+05, 7.9529e+05],
        [3.7714e+05, 3.7713e+05, 7.5733e+05, 3.7716e+05, 3.7718e+05, 7.4283e+05,
         3.7714e+05, 3.7716e+05, 7.5446e+05, 7.5405e+05, 3.7719e+05, 3.7713e+05,
         3.7715e+05, 7.6651e+05, 0.0000e+00, 7.9328e+05],
        [3.9770e+05, 3.9766e+05, 8.0657e+05, 3.9769e+05, 3.9773e+05, 7.9409e+05,
         3.9770e+05, 3.9770e+05, 8.0687e+05, 7.7066e+05, 3.9770e+05, 3.9772e+05,
         3.9771e+05, 7.9529e+05, 7.9328e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6732e+00, 1.8180e+00, 1.8243e+00, 1.8476e+00, 1.8498e+00,
        1.8545e+00, 1.8656e+00, 1.8956e+00, 3.7714e+05, 3.8429e+05, 3.9208e+05,
        3.9232e+05, 3.9365e+05, 3.9770e+05, 4.0239e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8498e+00, 1.8852e+00, 1.9432e+00, 1.9471e+00, 2.0027e+00,
        2.0064e+00, 2.0644e+00, 2.1696e+00, 3.7713e+05, 3.8427e+05, 3.9207e+05,
        3.9231e+05, 3.9366e+05, 3.9766e+05, 4.0237e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392282.8438, 392294.5312, 392303.5625, 392308.1250,
        392313.9375, 392318.3438, 392322.1875, 392329.2812, 392333.9375,
        757330.2500, 763874.1250, 795130.0625, 801672.0625, 804263.3125,
        806566.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7618e+00, 1.8193e+00, 1.8285e+00, 1.8337e+00, 1.8622e+00,
        1.8656e+00, 2.0064e+00, 2.0528e+00, 3.7716e+05, 3.8431e+05, 3.9205e+05,
        3.9231e+05, 3.9364e+05, 3.9769e+05, 4.0242e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7618e+00, 1.8243e+00, 1.8564e+00, 1.8586e+00, 1.9421e+00,
        1.9471e+00, 2.1287e+00, 2.2311e+00, 3.7718e+05, 3.8430e+05, 3.9206e+05,
        3.9228e+05, 3.9364e+05, 3.9773e+05, 4.0239e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392048.9062, 392052.6875, 392061.9062, 392067.2500,
        392067.8125, 392068.8125, 392073.3125, 392077.7812, 392085.3125,
        742833.8750, 774450.1250, 786446.5000, 787775.5625, 794094.7500,
        801672.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8165e+00, 1.8174e+00, 1.8545e+00, 1.8622e+00, 1.9432e+00,
        2.0098e+00, 2.0273e+00, 2.2311e+00, 3.7714e+05, 3.8431e+05, 3.9209e+05,
        3.9233e+05, 3.9365e+05, 3.9770e+05, 4.0237e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8174e+00, 1.8270e+00, 1.8956e+00, 1.9272e+00, 1.9556e+00,
        2.0528e+00, 2.1287e+00, 2.1696e+00, 3.7716e+05, 3.8433e+05, 3.9207e+05,
        3.9229e+05, 3.9367e+05, 3.9770e+05, 4.0232e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393627.8125, 393637.7500, 393643.5938, 393650.9062,
        393651.6562, 393653.3125, 393658.5625, 393663.9375, 393672.0000,
        754459.1250, 770116.8750, 787775.5625, 795130.0625, 806866.4375,
        808231.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384267.0938, 384288.8438, 384294.0625, 384296.9688,
        384299.0625, 384299.4062, 384310.5625, 384311.2188, 384330.9375,
        754049.5625, 763874.1250, 770116.8750, 770662.3750, 786446.5000,
        805447.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7823e+00, 1.8180e+00, 1.8193e+00, 1.8270e+00, 1.8564e+00,
        1.8579e+00, 1.8852e+00, 2.0098e+00, 3.7719e+05, 3.8430e+05, 3.9207e+05,
        3.9232e+05, 3.9366e+05, 3.9770e+05, 4.0237e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7728e+00, 1.7823e+00, 1.8285e+00, 1.8476e+00, 1.8586e+00,
        1.9272e+00, 2.0027e+00, 2.0273e+00, 3.7713e+05, 3.8430e+05, 3.9207e+05,
        3.9233e+05, 3.9363e+05, 3.9772e+05, 4.0237e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6732e+00, 1.7728e+00, 1.8165e+00, 1.8337e+00, 1.8579e+00,
        1.9421e+00, 1.9556e+00, 2.0644e+00, 3.7715e+05, 3.8429e+05, 3.9205e+05,
        3.9230e+05, 3.9365e+05, 3.9771e+05, 4.0239e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402322.0312, 402365.6250, 402369.1562, 402371.6250,
        402372.5938, 402385.9688, 402387.5000, 402388.6875, 402421.0625,
        766507.8125, 774450.1250, 795292.8750, 804263.3125, 805447.7500,
        808231.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377132.7500, 377132.9688, 377138.3750, 377144.8750,
        377154.6875, 377161.1562, 377162.6562, 377176.8438, 377190.0312,
        742833.8750, 754049.5625, 754459.1250, 757330.2500, 766507.8125,
        793281.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397661.6875, 397692.6250, 397695.6250, 397697.9688,
        397699.1250, 397701.2188, 397706.0625, 397719.8438, 397730.3750,
        770662.3750, 793281.0625, 794094.7500, 795292.8750, 806566.1250,
        806866.4375])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76145.36', '76141.58', '428813.75', '76148.73', '76149.18', '427143.75', '76146.45', '76150.94', '429731.84', '421274.75', '76150.19', '76144.70', '76145.84', '438789.19', '413722.84', '434996.69']
estimated f for each client, fs: [7, 7, 5, 7, 7, 5, 7, 7, 5, 5, 7, 7, 7, 5, 5, 5]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 8, 18, 2, 6, 13, 3, 5, 17, 14, 11, 1, 12, 15, 19, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0119s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:29...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:29, End: 2025-07-22 16:00:29)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [17, 3, 2, 7, 13, 16, 11, 18, 4, 5, 9, 8, 12, 15, 14, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9993e+05, 3.9992e+05, 3.9992e+05, 7.7738e+05, 7.9123e+05,
         3.9990e+05, 7.8991e+05, 3.9994e+05, 3.9992e+05, 3.9995e+05, 3.9994e+05,
         3.9996e+05, 8.0339e+05, 7.9533e+05, 3.9998e+05],
        [3.9993e+05, 0.0000e+00, 1.7890e+00, 1.9411e+00, 3.8876e+05, 3.9132e+05,
         1.9397e+00, 3.8953e+05, 1.7301e+00, 1.7745e+00, 1.8032e+00, 1.7787e+00,
         1.8230e+00, 4.0292e+05, 3.9846e+05, 2.0935e+00],
        [3.9992e+05, 1.7890e+00, 0.0000e+00, 1.6187e+00, 3.8874e+05, 3.9134e+05,
         1.7343e+00, 3.8959e+05, 1.7030e+00, 1.9711e+00, 1.6912e+00, 2.0045e+00,
         1.7734e+00, 4.0289e+05, 3.9842e+05, 1.6516e+00],
        [3.9992e+05, 1.9411e+00, 1.6187e+00, 0.0000e+00, 3.8875e+05, 3.9128e+05,
         1.6865e+00, 3.8958e+05, 1.7187e+00, 1.8742e+00, 1.8065e+00, 1.9593e+00,
         1.8072e+00, 4.0294e+05, 3.9847e+05, 1.9441e+00],
        [7.7738e+05, 3.8876e+05, 3.8874e+05, 3.8875e+05, 0.0000e+00, 8.0262e+05,
         3.8878e+05, 7.7163e+05, 3.8873e+05, 3.8877e+05, 3.8879e+05, 3.8876e+05,
         3.8875e+05, 7.7790e+05, 8.1613e+05, 3.8875e+05],
        [7.9123e+05, 3.9132e+05, 3.9134e+05, 3.9128e+05, 8.0262e+05, 0.0000e+00,
         3.9128e+05, 7.6704e+05, 3.9131e+05, 3.9131e+05, 3.9130e+05, 3.9129e+05,
         3.9129e+05, 7.8800e+05, 7.8148e+05, 3.9130e+05],
        [3.9990e+05, 1.9397e+00, 1.7343e+00, 1.6865e+00, 3.8878e+05, 3.9128e+05,
         0.0000e+00, 3.8960e+05, 1.6049e+00, 1.7519e+00, 1.7296e+00, 1.8706e+00,
         1.8278e+00, 4.0292e+05, 3.9843e+05, 1.8554e+00],
        [7.8991e+05, 3.8953e+05, 3.8959e+05, 3.8958e+05, 7.7163e+05, 7.6704e+05,
         3.8960e+05, 0.0000e+00, 3.8959e+05, 3.8955e+05, 3.8955e+05, 3.8954e+05,
         3.8954e+05, 7.8120e+05, 8.0015e+05, 3.8957e+05],
        [3.9994e+05, 1.7301e+00, 1.7030e+00, 1.7187e+00, 3.8873e+05, 3.9131e+05,
         1.6049e+00, 3.8959e+05, 0.0000e+00, 1.7682e+00, 1.7635e+00, 1.7246e+00,
         1.7053e+00, 4.0292e+05, 3.9845e+05, 1.7499e+00],
        [3.9992e+05, 1.7745e+00, 1.9711e+00, 1.8742e+00, 3.8877e+05, 3.9131e+05,
         1.7519e+00, 3.8955e+05, 1.7682e+00, 0.0000e+00, 1.9477e+00, 2.0034e+00,
         2.0334e+00, 4.0291e+05, 3.9844e+05, 2.0892e+00],
        [3.9995e+05, 1.8032e+00, 1.6912e+00, 1.8065e+00, 3.8879e+05, 3.9130e+05,
         1.7296e+00, 3.8955e+05, 1.7635e+00, 1.9477e+00, 0.0000e+00, 1.8412e+00,
         1.7851e+00, 4.0290e+05, 3.9841e+05, 1.8505e+00],
        [3.9994e+05, 1.7787e+00, 2.0045e+00, 1.9593e+00, 3.8876e+05, 3.9129e+05,
         1.8706e+00, 3.8954e+05, 1.7246e+00, 2.0034e+00, 1.8412e+00, 0.0000e+00,
         1.9848e+00, 4.0290e+05, 3.9842e+05, 1.9604e+00],
        [3.9996e+05, 1.8230e+00, 1.7734e+00, 1.8072e+00, 3.8875e+05, 3.9129e+05,
         1.8278e+00, 3.8954e+05, 1.7053e+00, 2.0334e+00, 1.7851e+00, 1.9848e+00,
         0.0000e+00, 4.0288e+05, 3.9847e+05, 1.9344e+00],
        [8.0339e+05, 4.0292e+05, 4.0289e+05, 4.0294e+05, 7.7790e+05, 7.8800e+05,
         4.0292e+05, 7.8120e+05, 4.0292e+05, 4.0291e+05, 4.0290e+05, 4.0290e+05,
         4.0288e+05, 0.0000e+00, 7.9319e+05, 4.0292e+05],
        [7.9533e+05, 3.9846e+05, 3.9842e+05, 3.9847e+05, 8.1613e+05, 7.8148e+05,
         3.9843e+05, 8.0015e+05, 3.9845e+05, 3.9844e+05, 3.9841e+05, 3.9842e+05,
         3.9847e+05, 7.9319e+05, 0.0000e+00, 3.9842e+05],
        [3.9998e+05, 2.0935e+00, 1.6516e+00, 1.9441e+00, 3.8875e+05, 3.9130e+05,
         1.8554e+00, 3.8957e+05, 1.7499e+00, 2.0892e+00, 1.8505e+00, 1.9604e+00,
         1.9344e+00, 4.0292e+05, 3.9842e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 399901.1250, 399916.7812, 399917.4062, 399919.9688,
        399932.8438, 399940.6250, 399943.0938, 399949.5000, 399958.1562,
        399982.2812, 777383.8125, 789909.5625, 791230.7500, 795328.8125,
        803388.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7301e+00, 1.7745e+00, 1.7787e+00, 1.7890e+00, 1.8032e+00,
        1.8230e+00, 1.9397e+00, 1.9411e+00, 2.0935e+00, 3.8876e+05, 3.8953e+05,
        3.9132e+05, 3.9846e+05, 3.9993e+05, 4.0292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6187e+00, 1.6516e+00, 1.6912e+00, 1.7030e+00, 1.7343e+00,
        1.7734e+00, 1.7890e+00, 1.9711e+00, 2.0045e+00, 3.8874e+05, 3.8959e+05,
        3.9134e+05, 3.9842e+05, 3.9992e+05, 4.0289e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6187e+00, 1.6865e+00, 1.7187e+00, 1.8065e+00, 1.8072e+00,
        1.8742e+00, 1.9411e+00, 1.9441e+00, 1.9593e+00, 3.8875e+05, 3.8958e+05,
        3.9128e+05, 3.9847e+05, 3.9992e+05, 4.0294e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388733.6250, 388744.1250, 388749.5938, 388752.8125,
        388753.8750, 388758.2500, 388762.8750, 388768.3438, 388775.0625,
        388790.6250, 771634.2500, 777383.8125, 777898.8750, 802619.1250,
        816131.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391275.1875, 391282.3750, 391286.6562, 391290.0000,
        391295.5625, 391303.1562, 391306.5000, 391308.6562, 391323.4375,
        391338.0625, 767037.8125, 781476.5625, 788004.4375, 791230.7500,
        802619.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6049e+00, 1.6865e+00, 1.7296e+00, 1.7343e+00, 1.7519e+00,
        1.8278e+00, 1.8554e+00, 1.8706e+00, 1.9397e+00, 3.8878e+05, 3.8960e+05,
        3.9128e+05, 3.9843e+05, 3.9990e+05, 4.0292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389534.8438, 389543.7188, 389544.7500, 389547.6875,
        389554.9062, 389568.8125, 389581.0312, 389586.6562, 389592.4062,
        389595.0000, 767037.8125, 771634.2500, 781202.1875, 789909.5625,
        800150.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6049e+00, 1.7030e+00, 1.7053e+00, 1.7187e+00, 1.7246e+00,
        1.7301e+00, 1.7499e+00, 1.7635e+00, 1.7682e+00, 3.8873e+05, 3.8959e+05,
        3.9131e+05, 3.9845e+05, 3.9994e+05, 4.0292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7519e+00, 1.7682e+00, 1.7745e+00, 1.8742e+00, 1.9477e+00,
        1.9711e+00, 2.0034e+00, 2.0334e+00, 2.0892e+00, 3.8877e+05, 3.8955e+05,
        3.9131e+05, 3.9844e+05, 3.9992e+05, 4.0291e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6912e+00, 1.7296e+00, 1.7635e+00, 1.7851e+00, 1.8032e+00,
        1.8065e+00, 1.8412e+00, 1.8505e+00, 1.9477e+00, 3.8879e+05, 3.8955e+05,
        3.9130e+05, 3.9841e+05, 3.9995e+05, 4.0290e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7246e+00, 1.7787e+00, 1.8412e+00, 1.8706e+00, 1.9593e+00,
        1.9604e+00, 1.9848e+00, 2.0034e+00, 2.0045e+00, 3.8876e+05, 3.8954e+05,
        3.9129e+05, 3.9842e+05, 3.9994e+05, 4.0290e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7053e+00, 1.7734e+00, 1.7851e+00, 1.8072e+00, 1.8230e+00,
        1.8278e+00, 1.9344e+00, 1.9848e+00, 2.0334e+00, 3.8875e+05, 3.8954e+05,
        3.9129e+05, 3.9847e+05, 3.9996e+05, 4.0288e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402875.7188, 402894.6562, 402901.4375, 402903.7812,
        402910.2812, 402918.0938, 402918.6250, 402919.8438, 402921.3125,
        402942.4062, 777898.8750, 781202.1875, 788004.4375, 793187.5000,
        803388.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398408.0000, 398418.7812, 398420.0938, 398422.9062,
        398427.0000, 398436.0938, 398445.9375, 398457.9375, 398467.1562,
        398471.8125, 781476.5625, 793187.5000, 795328.8125, 800150.1875,
        816131.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6516e+00, 1.7499e+00, 1.8505e+00, 1.8554e+00, 1.9344e+00,
        1.9441e+00, 1.9604e+00, 2.0892e+00, 2.0935e+00, 3.8875e+05, 3.8957e+05,
        3.9130e+05, 3.9842e+05, 3.9998e+05, 4.0292e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['399936.16', '38877.49', '38876.00', '38877.02', '388758.88', '391300.97', '38879.10', '389565.00', '38874.91', '38878.55', '38880.68', '38878.00', '38876.63', '402910.56', '398437.56', '38876.99']
estimated f for each client, fs: [4, 6, 6, 6, 4, 4, 6, 4, 6, 6, 6, 6, 6, 4, 4, 6]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [17, 3, 2, 7, 13, 16, 11, 18, 4, 5, 9, 8, 12, 15, 14, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0211s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:30...
global Accuracy on shared test data: 78.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:30, End: 2025-07-22 16:00:30)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 17, 4, 2, 14, 18, 15, 10, 3, 6, 5, 9, 8, 11, 13, 7], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0402e+05, 1.7545e+00, 1.5924e+00, 3.9070e+05, 3.9621e+05,
         3.9796e+05, 1.6038e+00, 1.7602e+00, 1.6602e+00, 1.6581e+00, 1.5701e+00,
         1.7619e+00, 1.5585e+00, 3.7838e+05, 1.6448e+00],
        [4.0402e+05, 0.0000e+00, 4.0402e+05, 4.0403e+05, 8.0146e+05, 8.0620e+05,
         7.9497e+05, 4.0404e+05, 4.0402e+05, 4.0402e+05, 4.0401e+05, 4.0398e+05,
         4.0404e+05, 4.0401e+05, 7.8918e+05, 4.0399e+05],
        [1.7545e+00, 4.0402e+05, 0.0000e+00, 1.8330e+00, 3.9069e+05, 3.9624e+05,
         3.9797e+05, 1.7766e+00, 1.6933e+00, 1.8293e+00, 1.6928e+00, 1.6793e+00,
         1.6376e+00, 1.6871e+00, 3.7837e+05, 1.8412e+00],
        [1.5924e+00, 4.0403e+05, 1.8330e+00, 0.0000e+00, 3.9072e+05, 3.9625e+05,
         3.9799e+05, 1.5740e+00, 1.6663e+00, 1.6014e+00, 1.8360e+00, 1.5208e+00,
         1.8352e+00, 1.6221e+00, 3.7840e+05, 1.5732e+00],
        [3.9070e+05, 8.0146e+05, 3.9069e+05, 3.9072e+05, 0.0000e+00, 7.8702e+05,
         7.9630e+05, 3.9071e+05, 3.9070e+05, 3.9071e+05, 3.9073e+05, 3.9073e+05,
         3.9069e+05, 3.9072e+05, 7.6673e+05, 3.9070e+05],
        [3.9621e+05, 8.0620e+05, 3.9624e+05, 3.9625e+05, 7.8702e+05, 0.0000e+00,
         8.0256e+05, 3.9622e+05, 3.9622e+05, 3.9621e+05, 3.9618e+05, 3.9622e+05,
         3.9621e+05, 3.9621e+05, 7.7329e+05, 3.9622e+05],
        [3.9796e+05, 7.9497e+05, 3.9797e+05, 3.9799e+05, 7.9630e+05, 8.0256e+05,
         0.0000e+00, 3.9798e+05, 3.9797e+05, 3.9797e+05, 3.9797e+05, 3.9795e+05,
         3.9793e+05, 3.9795e+05, 7.6806e+05, 3.9797e+05],
        [1.6038e+00, 4.0404e+05, 1.7766e+00, 1.5740e+00, 3.9071e+05, 3.9622e+05,
         3.9798e+05, 0.0000e+00, 1.6173e+00, 1.7930e+00, 1.6233e+00, 1.5377e+00,
         1.7156e+00, 1.6957e+00, 3.7839e+05, 1.6681e+00],
        [1.7602e+00, 4.0402e+05, 1.6933e+00, 1.6663e+00, 3.9070e+05, 3.9622e+05,
         3.9797e+05, 1.6173e+00, 0.0000e+00, 1.9444e+00, 1.6324e+00, 1.6919e+00,
         1.6492e+00, 1.7922e+00, 3.7838e+05, 1.8375e+00],
        [1.6602e+00, 4.0402e+05, 1.8293e+00, 1.6014e+00, 3.9071e+05, 3.9621e+05,
         3.9797e+05, 1.7930e+00, 1.9444e+00, 0.0000e+00, 1.9194e+00, 1.6434e+00,
         1.7704e+00, 1.6671e+00, 3.7841e+05, 1.7854e+00],
        [1.6581e+00, 4.0401e+05, 1.6928e+00, 1.8360e+00, 3.9073e+05, 3.9618e+05,
         3.9797e+05, 1.6233e+00, 1.6324e+00, 1.9194e+00, 0.0000e+00, 1.7211e+00,
         1.8365e+00, 1.6025e+00, 3.7835e+05, 1.7052e+00],
        [1.5701e+00, 4.0398e+05, 1.6793e+00, 1.5208e+00, 3.9073e+05, 3.9622e+05,
         3.9795e+05, 1.5377e+00, 1.6919e+00, 1.6434e+00, 1.7211e+00, 0.0000e+00,
         1.6397e+00, 1.5128e+00, 3.7836e+05, 1.6226e+00],
        [1.7619e+00, 4.0404e+05, 1.6376e+00, 1.8352e+00, 3.9069e+05, 3.9621e+05,
         3.9793e+05, 1.7156e+00, 1.6492e+00, 1.7704e+00, 1.8365e+00, 1.6397e+00,
         0.0000e+00, 1.6737e+00, 3.7835e+05, 1.8721e+00],
        [1.5585e+00, 4.0401e+05, 1.6871e+00, 1.6221e+00, 3.9072e+05, 3.9621e+05,
         3.9795e+05, 1.6957e+00, 1.7922e+00, 1.6671e+00, 1.6025e+00, 1.5128e+00,
         1.6737e+00, 0.0000e+00, 3.7837e+05, 1.5962e+00],
        [3.7838e+05, 7.8918e+05, 3.7837e+05, 3.7840e+05, 7.6673e+05, 7.7329e+05,
         7.6806e+05, 3.7839e+05, 3.7838e+05, 3.7841e+05, 3.7835e+05, 3.7836e+05,
         3.7835e+05, 3.7837e+05, 0.0000e+00, 3.7837e+05],
        [1.6448e+00, 4.0399e+05, 1.8412e+00, 1.5732e+00, 3.9070e+05, 3.9622e+05,
         3.9797e+05, 1.6681e+00, 1.8375e+00, 1.7854e+00, 1.7052e+00, 1.6226e+00,
         1.8721e+00, 1.5962e+00, 3.7837e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5585e+00, 1.5701e+00, 1.5924e+00, 1.6038e+00, 1.6448e+00,
        1.6581e+00, 1.6602e+00, 1.7545e+00, 1.7602e+00, 1.7619e+00, 3.7838e+05,
        3.9070e+05, 3.9621e+05, 3.9796e+05, 4.0402e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403977.8438, 403987.6875, 404005.5000, 404012.8750,
        404017.5625, 404018.2500, 404024.0625, 404024.8125, 404028.7500,
        404036.4375, 404036.6562, 789177.6250, 794970.2500, 801455.6250,
        806201.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6376e+00, 1.6793e+00, 1.6871e+00, 1.6928e+00, 1.6933e+00,
        1.7545e+00, 1.7766e+00, 1.8293e+00, 1.8330e+00, 1.8412e+00, 3.7837e+05,
        3.9069e+05, 3.9624e+05, 3.9797e+05, 4.0402e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5208e+00, 1.5732e+00, 1.5740e+00, 1.5924e+00, 1.6014e+00,
        1.6221e+00, 1.6663e+00, 1.8330e+00, 1.8352e+00, 1.8360e+00, 3.7840e+05,
        3.9072e+05, 3.9625e+05, 3.9799e+05, 4.0403e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390686.6562, 390692.6875, 390696.2812, 390696.7812,
        390702.1875, 390705.6250, 390708.8750, 390718.6250, 390723.2500,
        390725.8438, 390726.6875, 766726.6250, 787019.2500, 796298.4375,
        801455.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396180.0312, 396207.3750, 396209.5938, 396209.8438,
        396210.8438, 396215.6875, 396218.3438, 396220.3750, 396220.5938,
        396241.3438, 396248.1250, 773294.6875, 787019.2500, 802559.1875,
        806201.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 397934.1562, 397951.4688, 397953.0938, 397958.9062,
        397966.0938, 397966.9375, 397967.1250, 397967.8125, 397972.1875,
        397984.8125, 397987.9062, 768064.8125, 794970.2500, 796298.4375,
        802559.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5377e+00, 1.5740e+00, 1.6038e+00, 1.6173e+00, 1.6233e+00,
        1.6681e+00, 1.6957e+00, 1.7156e+00, 1.7766e+00, 1.7930e+00, 3.7839e+05,
        3.9071e+05, 3.9622e+05, 3.9798e+05, 4.0404e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6173e+00, 1.6324e+00, 1.6492e+00, 1.6663e+00, 1.6919e+00,
        1.6933e+00, 1.7602e+00, 1.7922e+00, 1.8375e+00, 1.9444e+00, 3.7838e+05,
        3.9070e+05, 3.9622e+05, 3.9797e+05, 4.0402e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6014e+00, 1.6434e+00, 1.6602e+00, 1.6671e+00, 1.7704e+00,
        1.7854e+00, 1.7930e+00, 1.8293e+00, 1.9194e+00, 1.9444e+00, 3.7841e+05,
        3.9071e+05, 3.9621e+05, 3.9797e+05, 4.0402e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6025e+00, 1.6233e+00, 1.6324e+00, 1.6581e+00, 1.6928e+00,
        1.7052e+00, 1.7211e+00, 1.8360e+00, 1.8365e+00, 1.9194e+00, 3.7835e+05,
        3.9073e+05, 3.9618e+05, 3.9797e+05, 4.0401e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5128e+00, 1.5208e+00, 1.5377e+00, 1.5701e+00, 1.6226e+00,
        1.6397e+00, 1.6434e+00, 1.6793e+00, 1.6919e+00, 1.7211e+00, 3.7836e+05,
        3.9073e+05, 3.9622e+05, 3.9795e+05, 4.0398e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6376e+00, 1.6397e+00, 1.6492e+00, 1.6737e+00, 1.7156e+00,
        1.7619e+00, 1.7704e+00, 1.8352e+00, 1.8365e+00, 1.8721e+00, 3.7835e+05,
        3.9069e+05, 3.9621e+05, 3.9793e+05, 4.0404e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5128e+00, 1.5585e+00, 1.5962e+00, 1.6025e+00, 1.6221e+00,
        1.6671e+00, 1.6737e+00, 1.6871e+00, 1.6957e+00, 1.7922e+00, 3.7837e+05,
        3.9072e+05, 3.9621e+05, 3.9795e+05, 4.0401e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 378350.3125, 378350.8438, 378363.3750, 378365.1875,
        378369.6250, 378374.5938, 378377.0938, 378379.9062, 378392.0000,
        378396.6875, 378406.4688, 766726.6250, 768064.8125, 773294.6875,
        789177.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5732e+00, 1.5962e+00, 1.6226e+00, 1.6448e+00, 1.6681e+00,
        1.7052e+00, 1.7854e+00, 1.8375e+00, 1.8412e+00, 1.8721e+00, 3.7837e+05,
        3.9070e+05, 3.9622e+05, 3.9797e+05, 4.0399e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.66', '404015.50', '1.74', '1.67', '390707.59', '396216.53', '397964.59', '1.66', '1.73', '1.76', '1.72', '1.61', '1.74', '1.64', '378371.94', '1.71']
estimated f for each client, fs: [5, 3, 5, 5, 3, 3, 3, 5, 5, 5, 5, 5, 5, 5, 5, 5]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 17, 4, 2, 14, 18, 15, 10, 3, 6, 5, 9, 8, 11, 13, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0289s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:30...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:30, End: 2025-07-22 16:00:30)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 14, 2, 19, 8, 11, 20, 10, 1, 3, 16, 17, 9, 5, 6, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8946e+05, 1.4900e+00, 3.8572e+05, 1.7848e+00, 1.5732e+00,
         3.8982e+05, 1.7331e+00, 1.6205e+00, 1.7520e+00, 3.8224e+05, 3.9241e+05,
         1.7765e+00, 1.7091e+00, 1.7830e+00, 3.8823e+05],
        [3.8946e+05, 0.0000e+00, 3.8944e+05, 7.7755e+05, 3.8945e+05, 3.8944e+05,
         7.7154e+05, 3.8946e+05, 3.8944e+05, 3.8944e+05, 7.7843e+05, 7.9657e+05,
         3.8945e+05, 3.8945e+05, 3.8944e+05, 8.0962e+05],
        [1.4900e+00, 3.8944e+05, 0.0000e+00, 3.8572e+05, 1.7329e+00, 1.5423e+00,
         3.8982e+05, 1.5968e+00, 1.5005e+00, 1.6226e+00, 3.8222e+05, 3.9241e+05,
         1.6614e+00, 1.8132e+00, 1.5549e+00, 3.8824e+05],
        [3.8572e+05, 7.7755e+05, 3.8572e+05, 0.0000e+00, 3.8572e+05, 3.8572e+05,
         7.8635e+05, 3.8569e+05, 3.8573e+05, 3.8572e+05, 7.7119e+05, 7.8925e+05,
         3.8572e+05, 3.8571e+05, 3.8573e+05, 8.1492e+05],
        [1.7848e+00, 3.8945e+05, 1.7329e+00, 3.8572e+05, 0.0000e+00, 1.6402e+00,
         3.8986e+05, 1.6360e+00, 1.7841e+00, 1.5421e+00, 3.8222e+05, 3.9240e+05,
         1.5455e+00, 1.7365e+00, 1.7886e+00, 3.8824e+05],
        [1.5732e+00, 3.8944e+05, 1.5423e+00, 3.8572e+05, 1.6402e+00, 0.0000e+00,
         3.8982e+05, 1.6820e+00, 1.5157e+00, 1.7061e+00, 3.8224e+05, 3.9244e+05,
         1.6485e+00, 1.6075e+00, 1.6404e+00, 3.8822e+05],
        [3.8982e+05, 7.7154e+05, 3.8982e+05, 7.8635e+05, 3.8986e+05, 3.8982e+05,
         0.0000e+00, 3.8982e+05, 3.8980e+05, 3.8982e+05, 7.6287e+05, 7.7860e+05,
         3.8982e+05, 3.8982e+05, 3.8986e+05, 7.7671e+05],
        [1.7331e+00, 3.8946e+05, 1.5968e+00, 3.8569e+05, 1.6360e+00, 1.6820e+00,
         3.8982e+05, 0.0000e+00, 1.6104e+00, 1.5483e+00, 3.8225e+05, 3.9241e+05,
         1.5417e+00, 1.6742e+00, 1.8140e+00, 3.8825e+05],
        [1.6205e+00, 3.8944e+05, 1.5005e+00, 3.8573e+05, 1.7841e+00, 1.5157e+00,
         3.8980e+05, 1.6104e+00, 0.0000e+00, 1.6930e+00, 3.8224e+05, 3.9241e+05,
         1.6422e+00, 1.7253e+00, 1.6113e+00, 3.8823e+05],
        [1.7520e+00, 3.8944e+05, 1.6226e+00, 3.8572e+05, 1.5421e+00, 1.7061e+00,
         3.8982e+05, 1.5483e+00, 1.6930e+00, 0.0000e+00, 3.8222e+05, 3.9240e+05,
         1.5784e+00, 1.5662e+00, 1.8807e+00, 3.8821e+05],
        [3.8224e+05, 7.7843e+05, 3.8222e+05, 7.7119e+05, 3.8222e+05, 3.8224e+05,
         7.6287e+05, 3.8225e+05, 3.8224e+05, 3.8222e+05, 0.0000e+00, 7.7707e+05,
         3.8222e+05, 3.8225e+05, 3.8224e+05, 7.7028e+05],
        [3.9241e+05, 7.9657e+05, 3.9241e+05, 7.8925e+05, 3.9240e+05, 3.9244e+05,
         7.7860e+05, 3.9241e+05, 3.9241e+05, 3.9240e+05, 7.7707e+05, 0.0000e+00,
         3.9242e+05, 3.9241e+05, 3.9242e+05, 7.7165e+05],
        [1.7765e+00, 3.8945e+05, 1.6614e+00, 3.8572e+05, 1.5455e+00, 1.6485e+00,
         3.8982e+05, 1.5417e+00, 1.6422e+00, 1.5784e+00, 3.8222e+05, 3.9242e+05,
         0.0000e+00, 1.6561e+00, 1.8352e+00, 3.8825e+05],
        [1.7091e+00, 3.8945e+05, 1.8132e+00, 3.8571e+05, 1.7365e+00, 1.6075e+00,
         3.8982e+05, 1.6742e+00, 1.7253e+00, 1.5662e+00, 3.8225e+05, 3.9241e+05,
         1.6561e+00, 0.0000e+00, 1.9672e+00, 3.8823e+05],
        [1.7830e+00, 3.8944e+05, 1.5549e+00, 3.8573e+05, 1.7886e+00, 1.6404e+00,
         3.8986e+05, 1.8140e+00, 1.6113e+00, 1.8807e+00, 3.8224e+05, 3.9242e+05,
         1.8352e+00, 1.9672e+00, 0.0000e+00, 3.8825e+05],
        [3.8823e+05, 8.0962e+05, 3.8824e+05, 8.1492e+05, 3.8824e+05, 3.8822e+05,
         7.7671e+05, 3.8825e+05, 3.8823e+05, 3.8821e+05, 7.7028e+05, 7.7165e+05,
         3.8825e+05, 3.8823e+05, 3.8825e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4900e+00, 1.5732e+00, 1.6205e+00, 1.7091e+00, 1.7331e+00,
        1.7520e+00, 1.7765e+00, 1.7830e+00, 1.7848e+00, 3.8224e+05, 3.8572e+05,
        3.8823e+05, 3.8946e+05, 3.8982e+05, 3.9241e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389435.2500, 389436.0625, 389439.3750, 389439.6250,
        389442.5938, 389447.7188, 389454.1875, 389454.9062, 389456.0625,
        389456.4062, 771543.8750, 777550.5625, 778431.4375, 796569.8125,
        809618.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4900e+00, 1.5005e+00, 1.5423e+00, 1.5549e+00, 1.5968e+00,
        1.6226e+00, 1.6614e+00, 1.7329e+00, 1.8132e+00, 3.8222e+05, 3.8572e+05,
        3.8824e+05, 3.8944e+05, 3.8982e+05, 3.9241e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385690.8125, 385710.9688, 385719.3438, 385720.9375,
        385720.9688, 385722.3125, 385724.2500, 385724.4375, 385725.7188,
        385728.2812, 771193.3125, 777550.5625, 786347.7500, 789246.3750,
        814924.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5421e+00, 1.5455e+00, 1.6360e+00, 1.6402e+00, 1.7329e+00,
        1.7365e+00, 1.7841e+00, 1.7848e+00, 1.7886e+00, 3.8222e+05, 3.8572e+05,
        3.8824e+05, 3.8945e+05, 3.8986e+05, 3.9240e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5157e+00, 1.5423e+00, 1.5732e+00, 1.6075e+00, 1.6402e+00,
        1.6404e+00, 1.6485e+00, 1.6820e+00, 1.7061e+00, 3.8224e+05, 3.8572e+05,
        3.8822e+05, 3.8944e+05, 3.8982e+05, 3.9244e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389804.9375, 389817.2188, 389819.1562, 389821.6875,
        389822.8125, 389823.1875, 389823.1875, 389823.5625, 389856.6875,
        389860.6875, 762874.0625, 771543.8750, 776705.9375, 778604.3125,
        786347.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5417e+00, 1.5483e+00, 1.5968e+00, 1.6104e+00, 1.6360e+00,
        1.6742e+00, 1.6820e+00, 1.7331e+00, 1.8140e+00, 3.8225e+05, 3.8569e+05,
        3.8825e+05, 3.8946e+05, 3.8982e+05, 3.9241e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5005e+00, 1.5157e+00, 1.6104e+00, 1.6113e+00, 1.6205e+00,
        1.6422e+00, 1.6930e+00, 1.7253e+00, 1.7841e+00, 3.8224e+05, 3.8573e+05,
        3.8823e+05, 3.8944e+05, 3.8980e+05, 3.9241e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5421e+00, 1.5483e+00, 1.5662e+00, 1.5784e+00, 1.6226e+00,
        1.6930e+00, 1.7061e+00, 1.7520e+00, 1.8807e+00, 3.8222e+05, 3.8572e+05,
        3.8821e+05, 3.8944e+05, 3.8982e+05, 3.9240e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382217.6250, 382223.1875, 382223.4375, 382224.2188,
        382235.2812, 382238.5625, 382239.5625, 382243.6250, 382248.4062,
        382250.8750, 762874.0625, 770276.5625, 771193.3125, 777067.4375,
        778431.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392397.9375, 392404.6562, 392410.1250, 392410.7812,
        392412.2188, 392413.1875, 392413.1875, 392416.0000, 392420.2188,
        392439.5000, 771653.7500, 777067.4375, 778604.3125, 789246.3750,
        796569.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5417e+00, 1.5455e+00, 1.5784e+00, 1.6422e+00, 1.6485e+00,
        1.6561e+00, 1.6614e+00, 1.7765e+00, 1.8352e+00, 3.8222e+05, 3.8572e+05,
        3.8825e+05, 3.8945e+05, 3.8982e+05, 3.9242e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5662e+00, 1.6075e+00, 1.6561e+00, 1.6742e+00, 1.7091e+00,
        1.7253e+00, 1.7365e+00, 1.8132e+00, 1.9672e+00, 3.8225e+05, 3.8571e+05,
        3.8823e+05, 3.8945e+05, 3.8982e+05, 3.9241e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5549e+00, 1.6113e+00, 1.6404e+00, 1.7830e+00, 1.7886e+00,
        1.8140e+00, 1.8352e+00, 1.8807e+00, 1.9672e+00, 3.8224e+05, 3.8573e+05,
        3.8825e+05, 3.8944e+05, 3.8986e+05, 3.9242e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388210.8125, 388218.8438, 388227.8438, 388228.8750,
        388230.5625, 388239.3125, 388244.8125, 388245.0625, 388246.1875,
        388249.5938, 770276.5625, 771653.7500, 776705.9375, 809618.1250,
        814924.4375])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38225.88', '389446.22', '38223.21', '385718.81', '38223.93', '38224.98', '389827.31', '38226.32', '38225.43', '38223.84', '382234.44', '392413.81', '38223.81', '38226.63', '38225.45', '388234.16']
estimated f for each client, fs: [6, 4, 6, 4, 6, 6, 4, 6, 6, 6, 4, 4, 6, 6, 6, 4]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 14, 2, 19, 8, 11, 20, 10, 1, 3, 16, 17, 9, 5, 6, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0120s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:31...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:31, End: 2025-07-22 16:00:31)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 7, 20, 14, 17, 16, 6, 11, 9, 19, 3, 4, 12, 15, 5, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.7136e+00, 3.9648e+05, 3.8904e+05, 3.8583e+05, 3.8462e+05,
         1.6882e+00, 1.7002e+00, 1.7252e+00, 3.9836e+05, 1.7653e+00, 1.7987e+00,
         1.6504e+00, 3.9785e+05, 1.7699e+00, 3.9182e+05],
        [1.7136e+00, 0.0000e+00, 3.9648e+05, 3.8905e+05, 3.8582e+05, 3.8463e+05,
         1.8017e+00, 1.6028e+00, 1.7298e+00, 3.9836e+05, 1.7332e+00, 1.7622e+00,
         1.6096e+00, 3.9786e+05, 1.6829e+00, 3.9177e+05],
        [3.9648e+05, 3.9648e+05, 0.0000e+00, 7.8934e+05, 7.8383e+05, 7.8694e+05,
         3.9649e+05, 3.9648e+05, 3.9650e+05, 7.8518e+05, 3.9647e+05, 3.9648e+05,
         3.9648e+05, 8.0236e+05, 3.9649e+05, 8.0634e+05],
        [3.8904e+05, 3.8905e+05, 7.8934e+05, 0.0000e+00, 7.6237e+05, 7.6886e+05,
         3.8907e+05, 3.8905e+05, 3.8902e+05, 7.7629e+05, 3.8902e+05, 3.8902e+05,
         3.8904e+05, 7.9362e+05, 3.8902e+05, 7.8029e+05],
        [3.8583e+05, 3.8582e+05, 7.8383e+05, 7.6237e+05, 0.0000e+00, 7.4924e+05,
         3.8586e+05, 3.8583e+05, 3.8584e+05, 7.9861e+05, 3.8580e+05, 3.8583e+05,
         3.8583e+05, 7.9272e+05, 3.8578e+05, 7.7487e+05],
        [3.8462e+05, 3.8463e+05, 7.8694e+05, 7.6886e+05, 7.4924e+05, 0.0000e+00,
         3.8465e+05, 3.8462e+05, 3.8463e+05, 7.7579e+05, 3.8466e+05, 3.8465e+05,
         3.8469e+05, 7.8770e+05, 3.8465e+05, 7.5881e+05],
        [1.6882e+00, 1.8017e+00, 3.9649e+05, 3.8907e+05, 3.8586e+05, 3.8465e+05,
         0.0000e+00, 1.7131e+00, 1.7987e+00, 3.9836e+05, 1.8491e+00, 1.8659e+00,
         1.6574e+00, 3.9784e+05, 1.9581e+00, 3.9176e+05],
        [1.7002e+00, 1.6028e+00, 3.9648e+05, 3.8905e+05, 3.8583e+05, 3.8462e+05,
         1.7131e+00, 0.0000e+00, 1.6815e+00, 3.9836e+05, 1.7580e+00, 1.7000e+00,
         1.6454e+00, 3.9787e+05, 1.6307e+00, 3.9178e+05],
        [1.7252e+00, 1.7298e+00, 3.9650e+05, 3.8902e+05, 3.8584e+05, 3.8463e+05,
         1.7987e+00, 1.6815e+00, 0.0000e+00, 3.9836e+05, 1.5992e+00, 1.5286e+00,
         1.6921e+00, 3.9783e+05, 1.6563e+00, 3.9180e+05],
        [3.9836e+05, 3.9836e+05, 7.8518e+05, 7.7629e+05, 7.9861e+05, 7.7579e+05,
         3.9836e+05, 3.9836e+05, 3.9836e+05, 0.0000e+00, 3.9838e+05, 3.9836e+05,
         3.9836e+05, 7.8870e+05, 3.9834e+05, 7.9922e+05],
        [1.7653e+00, 1.7332e+00, 3.9647e+05, 3.8902e+05, 3.8580e+05, 3.8466e+05,
         1.8491e+00, 1.7580e+00, 1.5992e+00, 3.9838e+05, 0.0000e+00, 1.6130e+00,
         1.5742e+00, 3.9785e+05, 1.6063e+00, 3.9178e+05],
        [1.7987e+00, 1.7622e+00, 3.9648e+05, 3.8902e+05, 3.8583e+05, 3.8465e+05,
         1.8659e+00, 1.7000e+00, 1.5286e+00, 3.9836e+05, 1.6130e+00, 0.0000e+00,
         1.6673e+00, 3.9786e+05, 1.6720e+00, 3.9181e+05],
        [1.6504e+00, 1.6096e+00, 3.9648e+05, 3.8904e+05, 3.8583e+05, 3.8469e+05,
         1.6574e+00, 1.6454e+00, 1.6921e+00, 3.9836e+05, 1.5742e+00, 1.6673e+00,
         0.0000e+00, 3.9789e+05, 1.8557e+00, 3.9180e+05],
        [3.9785e+05, 3.9786e+05, 8.0236e+05, 7.9362e+05, 7.9272e+05, 7.8770e+05,
         3.9784e+05, 3.9787e+05, 3.9783e+05, 7.8870e+05, 3.9785e+05, 3.9786e+05,
         3.9789e+05, 0.0000e+00, 3.9784e+05, 7.9035e+05],
        [1.7699e+00, 1.6829e+00, 3.9649e+05, 3.8902e+05, 3.8578e+05, 3.8465e+05,
         1.9581e+00, 1.6307e+00, 1.6563e+00, 3.9834e+05, 1.6063e+00, 1.6720e+00,
         1.8557e+00, 3.9784e+05, 0.0000e+00, 3.9181e+05],
        [3.9182e+05, 3.9177e+05, 8.0634e+05, 7.8029e+05, 7.7487e+05, 7.5881e+05,
         3.9176e+05, 3.9178e+05, 3.9180e+05, 7.9922e+05, 3.9178e+05, 3.9181e+05,
         3.9180e+05, 7.9035e+05, 3.9181e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6504e+00, 1.6882e+00, 1.7002e+00, 1.7136e+00, 1.7252e+00,
        1.7653e+00, 1.7699e+00, 1.7987e+00, 3.8462e+05, 3.8583e+05, 3.8904e+05,
        3.9182e+05, 3.9648e+05, 3.9785e+05, 3.9836e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6028e+00, 1.6096e+00, 1.6829e+00, 1.7136e+00, 1.7298e+00,
        1.7332e+00, 1.7622e+00, 1.8017e+00, 3.8463e+05, 3.8582e+05, 3.8905e+05,
        3.9177e+05, 3.9648e+05, 3.9786e+05, 3.9836e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396469.9062, 396477.7812, 396478.5625, 396478.9688,
        396479.9375, 396482.4062, 396489.7500, 396489.8750, 396497.9062,
        783827.0625, 785184.6250, 786937.7500, 789335.8750, 802357.0625,
        806340.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389015.8438, 389017.7812, 389017.7812, 389020.1562,
        389036.3750, 389042.8750, 389046.5312, 389049.5312, 389066.4688,
        762370.8125, 768859.4375, 776287.0000, 780286.2500, 789335.8750,
        793617.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385784.4375, 385800.4062, 385823.5312, 385825.4688,
        385832.1562, 385833.8125, 385833.9688, 385841.1875, 385861.2500,
        749240.1250, 762370.8125, 774868.5000, 783827.0625, 792723.6250,
        798607.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384618.2812, 384621.6875, 384630.6562, 384634.8750,
        384645.0625, 384652.9375, 384654.2500, 384659.3438, 384691.2500,
        749240.1250, 758811.3750, 768859.4375, 775787.2500, 786937.7500,
        787699.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6574e+00, 1.6882e+00, 1.7131e+00, 1.7987e+00, 1.8017e+00,
        1.8491e+00, 1.8659e+00, 1.9581e+00, 3.8465e+05, 3.8586e+05, 3.8907e+05,
        3.9176e+05, 3.9649e+05, 3.9784e+05, 3.9836e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6028e+00, 1.6307e+00, 1.6454e+00, 1.6815e+00, 1.7000e+00,
        1.7002e+00, 1.7131e+00, 1.7580e+00, 3.8462e+05, 3.8583e+05, 3.8905e+05,
        3.9178e+05, 3.9648e+05, 3.9787e+05, 3.9836e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5286e+00, 1.5992e+00, 1.6563e+00, 1.6815e+00, 1.6921e+00,
        1.7252e+00, 1.7298e+00, 1.7987e+00, 3.8463e+05, 3.8584e+05, 3.8902e+05,
        3.9180e+05, 3.9650e+05, 3.9783e+05, 3.9836e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398338.3125, 398355.4062, 398355.4375, 398357.5312,
        398359.0625, 398359.4375, 398361.5312, 398363.9375, 398377.2812,
        775787.2500, 776287.0000, 785184.6250, 788695.0625, 798607.8750,
        799218.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5742e+00, 1.5992e+00, 1.6063e+00, 1.6130e+00, 1.7332e+00,
        1.7580e+00, 1.7653e+00, 1.8491e+00, 3.8466e+05, 3.8580e+05, 3.8902e+05,
        3.9178e+05, 3.9647e+05, 3.9785e+05, 3.9838e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5286e+00, 1.6130e+00, 1.6673e+00, 1.6720e+00, 1.7000e+00,
        1.7622e+00, 1.7987e+00, 1.8659e+00, 3.8465e+05, 3.8583e+05, 3.8902e+05,
        3.9181e+05, 3.9648e+05, 3.9786e+05, 3.9836e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5742e+00, 1.6096e+00, 1.6454e+00, 1.6504e+00, 1.6574e+00,
        1.6673e+00, 1.6921e+00, 1.8557e+00, 3.8469e+05, 3.8583e+05, 3.8904e+05,
        3.9180e+05, 3.9648e+05, 3.9789e+05, 3.9836e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397832.7812, 397841.5625, 397842.3125, 397845.1250,
        397847.5000, 397860.9375, 397861.6875, 397867.2188, 397889.5625,
        787699.0000, 788695.0625, 790348.3750, 792723.6250, 793617.7500,
        802357.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6063e+00, 1.6307e+00, 1.6563e+00, 1.6720e+00, 1.6829e+00,
        1.7699e+00, 1.8557e+00, 1.9581e+00, 3.8465e+05, 3.8578e+05, 3.8902e+05,
        3.9181e+05, 3.9649e+05, 3.9784e+05, 3.9834e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391757.4062, 391774.6250, 391780.4375, 391783.7500,
        391796.2188, 391803.6875, 391809.7188, 391811.0938, 391815.0000,
        758811.3750, 774868.5000, 780286.2500, 790348.3750, 799218.1875,
        806340.3750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77046.77', '77047.20', '435217.25', '426368.44', '422167.66', '421104.84', '77052.07', '77045.71', '77048.54', '436101.50', '77047.33', '77050.17', '77053.86', '436838.75', '77045.12', '428494.34']
estimated f for each client, fs: [7, 7, 5, 5, 5, 5, 7, 7, 7, 5, 7, 7, 7, 5, 7, 5]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [1, 7, 20, 14, 17, 16, 6, 11, 9, 19, 3, 4, 12, 15, 5, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0117s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:31...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:31, End: 2025-07-22 16:00:31)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 6, 3, 7, 9, 5, 10, 17, 13, 19, 4, 12, 14, 20, 15, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4544e+00, 1.5833e+00, 1.4275e+00, 1.5146e+00, 1.7968e+00,
         1.4126e+00, 4.0106e+05, 3.8301e+05, 3.9586e+05, 1.4361e+00, 1.4226e+00,
         3.9485e+05, 4.0189e+05, 3.8791e+05, 3.8912e+05],
        [1.4544e+00, 0.0000e+00, 1.7660e+00, 1.5986e+00, 1.6279e+00, 2.2054e+00,
         1.5980e+00, 4.0106e+05, 3.8299e+05, 3.9583e+05, 1.5850e+00, 1.5862e+00,
         3.9487e+05, 4.0191e+05, 3.8793e+05, 3.8912e+05],
        [1.5833e+00, 1.7660e+00, 0.0000e+00, 1.5958e+00, 1.4628e+00, 1.6068e+00,
         1.4451e+00, 4.0106e+05, 3.8299e+05, 3.9585e+05, 1.4343e+00, 1.5531e+00,
         3.9486e+05, 4.0190e+05, 3.8790e+05, 3.8912e+05],
        [1.4275e+00, 1.5986e+00, 1.5958e+00, 0.0000e+00, 1.6294e+00, 1.8804e+00,
         1.5051e+00, 4.0105e+05, 3.8300e+05, 3.9588e+05, 1.4950e+00, 1.4600e+00,
         3.9487e+05, 4.0187e+05, 3.8792e+05, 3.8910e+05],
        [1.5146e+00, 1.6279e+00, 1.4628e+00, 1.6294e+00, 0.0000e+00, 1.6677e+00,
         1.3773e+00, 4.0103e+05, 3.8299e+05, 3.9587e+05, 1.3586e+00, 1.5480e+00,
         3.9485e+05, 4.0192e+05, 3.8797e+05, 3.8911e+05],
        [1.7968e+00, 2.2054e+00, 1.6068e+00, 1.8804e+00, 1.6677e+00, 0.0000e+00,
         1.6839e+00, 4.0106e+05, 3.8300e+05, 3.9585e+05, 1.5708e+00, 1.8481e+00,
         3.9487e+05, 4.0187e+05, 3.8791e+05, 3.8913e+05],
        [1.4126e+00, 1.5980e+00, 1.4451e+00, 1.5051e+00, 1.3773e+00, 1.6839e+00,
         0.0000e+00, 4.0102e+05, 3.8296e+05, 3.9583e+05, 1.4041e+00, 1.4480e+00,
         3.9487e+05, 4.0191e+05, 3.8793e+05, 3.8911e+05],
        [4.0106e+05, 4.0106e+05, 4.0106e+05, 4.0105e+05, 4.0103e+05, 4.0106e+05,
         4.0102e+05, 0.0000e+00, 7.8547e+05, 7.9329e+05, 4.0102e+05, 4.0103e+05,
         8.0239e+05, 7.8534e+05, 7.9281e+05, 8.0162e+05],
        [3.8301e+05, 3.8299e+05, 3.8299e+05, 3.8300e+05, 3.8299e+05, 3.8300e+05,
         3.8296e+05, 7.8547e+05, 0.0000e+00, 7.6988e+05, 3.8299e+05, 3.8299e+05,
         7.8233e+05, 7.8756e+05, 7.5317e+05, 7.5505e+05],
        [3.9586e+05, 3.9583e+05, 3.9585e+05, 3.9588e+05, 3.9587e+05, 3.9585e+05,
         3.9583e+05, 7.9329e+05, 7.6988e+05, 0.0000e+00, 3.9585e+05, 3.9584e+05,
         7.7560e+05, 7.8673e+05, 8.0444e+05, 7.9310e+05],
        [1.4361e+00, 1.5850e+00, 1.4343e+00, 1.4950e+00, 1.3586e+00, 1.5708e+00,
         1.4041e+00, 4.0102e+05, 3.8299e+05, 3.9585e+05, 0.0000e+00, 1.4638e+00,
         3.9484e+05, 4.0187e+05, 3.8792e+05, 3.8910e+05],
        [1.4226e+00, 1.5862e+00, 1.5531e+00, 1.4600e+00, 1.5480e+00, 1.8481e+00,
         1.4480e+00, 4.0103e+05, 3.8299e+05, 3.9584e+05, 1.4638e+00, 0.0000e+00,
         3.9487e+05, 4.0188e+05, 3.8793e+05, 3.8916e+05],
        [3.9485e+05, 3.9487e+05, 3.9486e+05, 3.9487e+05, 3.9485e+05, 3.9487e+05,
         3.9487e+05, 8.0239e+05, 7.8233e+05, 7.7560e+05, 3.9484e+05, 3.9487e+05,
         0.0000e+00, 7.8202e+05, 7.8624e+05, 7.9410e+05],
        [4.0189e+05, 4.0191e+05, 4.0190e+05, 4.0187e+05, 4.0192e+05, 4.0187e+05,
         4.0191e+05, 7.8534e+05, 7.8756e+05, 7.8673e+05, 4.0187e+05, 4.0188e+05,
         7.8202e+05, 0.0000e+00, 7.8506e+05, 7.7541e+05],
        [3.8791e+05, 3.8793e+05, 3.8790e+05, 3.8792e+05, 3.8797e+05, 3.8791e+05,
         3.8793e+05, 7.9281e+05, 7.5317e+05, 8.0444e+05, 3.8792e+05, 3.8793e+05,
         7.8624e+05, 7.8506e+05, 0.0000e+00, 7.8167e+05],
        [3.8912e+05, 3.8912e+05, 3.8912e+05, 3.8910e+05, 3.8911e+05, 3.8913e+05,
         3.8911e+05, 8.0162e+05, 7.5505e+05, 7.9310e+05, 3.8910e+05, 3.8916e+05,
         7.9410e+05, 7.7541e+05, 7.8167e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4126e+00, 1.4226e+00, 1.4275e+00, 1.4361e+00, 1.4544e+00,
        1.5146e+00, 1.5833e+00, 1.7968e+00, 3.8301e+05, 3.8791e+05, 3.8912e+05,
        3.9485e+05, 3.9586e+05, 4.0106e+05, 4.0189e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4544e+00, 1.5850e+00, 1.5862e+00, 1.5980e+00, 1.5986e+00,
        1.6279e+00, 1.7660e+00, 2.2054e+00, 3.8299e+05, 3.8793e+05, 3.8912e+05,
        3.9487e+05, 3.9583e+05, 4.0106e+05, 4.0191e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4343e+00, 1.4451e+00, 1.4628e+00, 1.5531e+00, 1.5833e+00,
        1.5958e+00, 1.6068e+00, 1.7660e+00, 3.8299e+05, 3.8790e+05, 3.8912e+05,
        3.9486e+05, 3.9585e+05, 4.0106e+05, 4.0190e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4275e+00, 1.4600e+00, 1.4950e+00, 1.5051e+00, 1.5958e+00,
        1.5986e+00, 1.6294e+00, 1.8804e+00, 3.8300e+05, 3.8792e+05, 3.8910e+05,
        3.9487e+05, 3.9588e+05, 4.0105e+05, 4.0187e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3586e+00, 1.3773e+00, 1.4628e+00, 1.5146e+00, 1.5480e+00,
        1.6279e+00, 1.6294e+00, 1.6677e+00, 3.8299e+05, 3.8797e+05, 3.8911e+05,
        3.9485e+05, 3.9587e+05, 4.0103e+05, 4.0192e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5708e+00, 1.6068e+00, 1.6677e+00, 1.6839e+00, 1.7968e+00,
        1.8481e+00, 1.8804e+00, 2.2054e+00, 3.8300e+05, 3.8791e+05, 3.8913e+05,
        3.9487e+05, 3.9585e+05, 4.0106e+05, 4.0187e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3773e+00, 1.4041e+00, 1.4126e+00, 1.4451e+00, 1.4480e+00,
        1.5051e+00, 1.5980e+00, 1.6839e+00, 3.8296e+05, 3.8793e+05, 3.8911e+05,
        3.9487e+05, 3.9583e+05, 4.0102e+05, 4.0191e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401020.8750, 401021.6875, 401029.0938, 401031.4062,
        401045.1562, 401057.0000, 401063.2500, 401064.1250, 401064.6250,
        785340.3125, 785466.7500, 792810.0625, 793293.9375, 801617.0000,
        802390.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382962.3750, 382985.0938, 382990.4688, 382992.2812,
        382992.9375, 382994.0000, 383001.0625, 383004.1875, 383011.5938,
        753169.5625, 755050.6250, 769883.3750, 782331.8750, 785466.7500,
        787556.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395828.1875, 395828.3125, 395838.0938, 395847.3125,
        395850.2500, 395851.2188, 395863.9062, 395871.7188, 395884.0000,
        769883.3750, 775595.5000, 786729.0000, 793100.5000, 793293.9375,
        804436.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3586e+00, 1.4041e+00, 1.4343e+00, 1.4361e+00, 1.4638e+00,
        1.4950e+00, 1.5708e+00, 1.5850e+00, 3.8299e+05, 3.8792e+05, 3.8910e+05,
        3.9484e+05, 3.9585e+05, 4.0102e+05, 4.0187e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4226e+00, 1.4480e+00, 1.4600e+00, 1.4638e+00, 1.5480e+00,
        1.5531e+00, 1.5862e+00, 1.8481e+00, 3.8299e+05, 3.8793e+05, 3.8916e+05,
        3.9487e+05, 3.9584e+05, 4.0103e+05, 4.0188e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394841.6250, 394846.9375, 394849.7500, 394856.4688,
        394866.6250, 394867.7812, 394869.3125, 394870.6875, 394874.3125,
        775595.5000, 782016.7500, 782331.8750, 786242.7500, 794104.3750,
        802390.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401868.0625, 401870.3750, 401871.3125, 401877.7500,
        401891.7812, 401900.5312, 401907.3750, 401913.5625, 401916.2188,
        775405.9375, 782016.7500, 785058.6250, 785340.3125, 786729.0000,
        787556.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387902.2500, 387907.6875, 387909.5938, 387917.1875,
        387923.2812, 387929.0938, 387930.5000, 387932.8750, 387965.3125,
        753169.5625, 781669.9375, 785058.6250, 786242.7500, 792810.0625,
        804436.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389099.1250, 389104.1250, 389107.2188, 389111.3750,
        389115.2812, 389121.3125, 389123.7812, 389133.5312, 389155.1250,
        755050.6250, 775405.9375, 781669.9375, 793100.5000, 794104.3750,
        801617.0000])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77093.13', '77093.14', '77090.87', '77093.09', '77096.80', '77092.80', '77090.34', '439473.75', '420010.34', '433254.59', '77092.80', '77093.51', '432933.84', '439242.31', '424448.69', '425712.16']
estimated f for each client, fs: [7, 7, 7, 7, 7, 7, 7, 5, 5, 5, 7, 7, 5, 5, 5, 5]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 6, 3, 7, 9, 5, 10, 17, 13, 19, 4, 12, 14, 20, 15, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:32...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:32, End: 2025-07-22 16:00:32)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 13, 15, 8, 19, 7, 9, 11, 14, 12, 6, 18, 2, 4, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.9497e+05, 7.9148e+05, 4.0285e+05, 7.8257e+05, 4.0284e+05,
         4.0283e+05, 4.0282e+05, 8.1268e+05, 4.0283e+05, 4.0283e+05, 7.4659e+05,
         4.0283e+05, 4.0282e+05, 4.0283e+05, 7.9172e+05],
        [7.9497e+05, 0.0000e+00, 7.6414e+05, 3.9405e+05, 7.6922e+05, 3.9406e+05,
         3.9404e+05, 3.9405e+05, 7.7535e+05, 3.9403e+05, 3.9402e+05, 7.6350e+05,
         3.9406e+05, 3.9404e+05, 3.9404e+05, 8.0675e+05],
        [7.9148e+05, 7.6414e+05, 0.0000e+00, 3.8621e+05, 7.8626e+05, 3.8617e+05,
         3.8620e+05, 3.8618e+05, 7.8428e+05, 3.8618e+05, 3.8619e+05, 7.6036e+05,
         3.8621e+05, 3.8621e+05, 3.8618e+05, 7.8584e+05],
        [4.0285e+05, 3.9405e+05, 3.8621e+05, 0.0000e+00, 3.9485e+05, 1.5162e+00,
         1.4392e+00, 1.4973e+00, 3.9522e+05, 1.5096e+00, 1.5416e+00, 3.8158e+05,
         1.5303e+00, 1.2850e+00, 1.7250e+00, 3.8574e+05],
        [7.8257e+05, 7.6922e+05, 7.8626e+05, 3.9485e+05, 0.0000e+00, 3.9487e+05,
         3.9484e+05, 3.9482e+05, 7.6687e+05, 3.9488e+05, 3.9485e+05, 7.8447e+05,
         3.9486e+05, 3.9487e+05, 3.9484e+05, 7.8871e+05],
        [4.0284e+05, 3.9406e+05, 3.8617e+05, 1.5162e+00, 3.9487e+05, 0.0000e+00,
         1.5962e+00, 1.3833e+00, 3.9522e+05, 1.4720e+00, 1.5198e+00, 3.8156e+05,
         1.4363e+00, 1.4522e+00, 1.8608e+00, 3.8572e+05],
        [4.0283e+05, 3.9404e+05, 3.8620e+05, 1.4392e+00, 3.9484e+05, 1.5962e+00,
         0.0000e+00, 1.5716e+00, 3.9523e+05, 1.5481e+00, 1.6192e+00, 3.8155e+05,
         1.4232e+00, 1.3654e+00, 1.4949e+00, 3.8578e+05],
        [4.0282e+05, 3.9405e+05, 3.8618e+05, 1.4973e+00, 3.9482e+05, 1.3833e+00,
         1.5716e+00, 0.0000e+00, 3.9527e+05, 1.4621e+00, 1.5304e+00, 3.8158e+05,
         1.4806e+00, 1.4254e+00, 1.9001e+00, 3.8570e+05],
        [8.1268e+05, 7.7535e+05, 7.8428e+05, 3.9522e+05, 7.6687e+05, 3.9522e+05,
         3.9523e+05, 3.9527e+05, 0.0000e+00, 3.9528e+05, 3.9526e+05, 7.7530e+05,
         3.9523e+05, 3.9524e+05, 3.9520e+05, 7.9931e+05],
        [4.0283e+05, 3.9403e+05, 3.8618e+05, 1.5096e+00, 3.9488e+05, 1.4720e+00,
         1.5481e+00, 1.4621e+00, 3.9528e+05, 0.0000e+00, 1.5900e+00, 3.8161e+05,
         1.5170e+00, 1.4732e+00, 1.7686e+00, 3.8575e+05],
        [4.0283e+05, 3.9402e+05, 3.8619e+05, 1.5416e+00, 3.9485e+05, 1.5198e+00,
         1.6192e+00, 1.5304e+00, 3.9526e+05, 1.5900e+00, 0.0000e+00, 3.8157e+05,
         1.5318e+00, 1.5411e+00, 2.0232e+00, 3.8574e+05],
        [7.4659e+05, 7.6350e+05, 7.6036e+05, 3.8158e+05, 7.8447e+05, 3.8156e+05,
         3.8155e+05, 3.8158e+05, 7.7530e+05, 3.8161e+05, 3.8157e+05, 0.0000e+00,
         3.8159e+05, 3.8157e+05, 3.8157e+05, 7.5617e+05],
        [4.0283e+05, 3.9406e+05, 3.8621e+05, 1.5303e+00, 3.9486e+05, 1.4363e+00,
         1.4232e+00, 1.4806e+00, 3.9523e+05, 1.5170e+00, 1.5318e+00, 3.8159e+05,
         0.0000e+00, 1.3796e+00, 1.6478e+00, 3.8575e+05],
        [4.0282e+05, 3.9404e+05, 3.8621e+05, 1.2850e+00, 3.9487e+05, 1.4522e+00,
         1.3654e+00, 1.4254e+00, 3.9524e+05, 1.4732e+00, 1.5411e+00, 3.8157e+05,
         1.3796e+00, 0.0000e+00, 1.6131e+00, 3.8575e+05],
        [4.0283e+05, 3.9404e+05, 3.8618e+05, 1.7250e+00, 3.9484e+05, 1.8608e+00,
         1.4949e+00, 1.9001e+00, 3.9520e+05, 1.7686e+00, 2.0232e+00, 3.8157e+05,
         1.6478e+00, 1.6131e+00, 0.0000e+00, 3.8575e+05],
        [7.9172e+05, 8.0675e+05, 7.8584e+05, 3.8574e+05, 7.8871e+05, 3.8572e+05,
         3.8578e+05, 3.8570e+05, 7.9931e+05, 3.8575e+05, 3.8574e+05, 7.5617e+05,
         3.8575e+05, 3.8575e+05, 3.8575e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 402820.6562, 402824.3438, 402825.6250, 402828.4688,
        402830.5625, 402832.2500, 402834.7188, 402842.1250, 402851.9062,
        746592.7500, 782569.8125, 791477.4375, 791716.5000, 794965.3750,
        812679.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394017.3438, 394029.5000, 394035.5000, 394037.0312,
        394037.0625, 394050.4688, 394054.4688, 394059.3125, 394059.4062,
        763497.1875, 764143.0000, 769219.6250, 775348.0000, 794965.3750,
        806751.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386173.5938, 386175.0625, 386182.4375, 386184.9062,
        386187.8438, 386196.0000, 386205.1250, 386213.4062, 386214.7812,
        760363.5625, 764143.0000, 784283.7500, 785838.2500, 786255.0000,
        791477.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2850e+00, 1.4392e+00, 1.4973e+00, 1.5096e+00, 1.5162e+00,
        1.5303e+00, 1.5416e+00, 1.7250e+00, 3.8158e+05, 3.8574e+05, 3.8621e+05,
        3.9405e+05, 3.9485e+05, 3.9522e+05, 4.0285e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394824.1562, 394838.4375, 394841.5625, 394845.6250,
        394852.1562, 394864.3438, 394872.6562, 394873.6875, 394876.1562,
        766868.6250, 769219.6250, 782569.8125, 784469.5000, 786255.0000,
        788707.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3833e+00, 1.4363e+00, 1.4522e+00, 1.4720e+00, 1.5162e+00,
        1.5198e+00, 1.5962e+00, 1.8608e+00, 3.8156e+05, 3.8572e+05, 3.8617e+05,
        3.9406e+05, 3.9487e+05, 3.9522e+05, 4.0284e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3654e+00, 1.4232e+00, 1.4392e+00, 1.4949e+00, 1.5481e+00,
        1.5716e+00, 1.5962e+00, 1.6192e+00, 3.8155e+05, 3.8578e+05, 3.8620e+05,
        3.9404e+05, 3.9484e+05, 3.9523e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3833e+00, 1.4254e+00, 1.4621e+00, 1.4806e+00, 1.4973e+00,
        1.5304e+00, 1.5716e+00, 1.9001e+00, 3.8158e+05, 3.8570e+05, 3.8618e+05,
        3.9405e+05, 3.9482e+05, 3.9527e+05, 4.0282e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395204.4062, 395218.9375, 395222.5000, 395230.2500,
        395230.8750, 395237.5938, 395260.0625, 395269.9688, 395276.0625,
        766868.6250, 775295.4375, 775348.0000, 784283.7500, 799314.2500,
        812679.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4621e+00, 1.4720e+00, 1.4732e+00, 1.5096e+00, 1.5170e+00,
        1.5481e+00, 1.5900e+00, 1.7686e+00, 3.8161e+05, 3.8575e+05, 3.8618e+05,
        3.9403e+05, 3.9488e+05, 3.9528e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5198e+00, 1.5304e+00, 1.5318e+00, 1.5411e+00, 1.5416e+00,
        1.5900e+00, 1.6192e+00, 2.0232e+00, 3.8157e+05, 3.8574e+05, 3.8619e+05,
        3.9402e+05, 3.9485e+05, 3.9526e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381548.3125, 381560.6250, 381568.5312, 381568.8750,
        381569.6875, 381579.3125, 381579.7188, 381587.4688, 381607.0000,
        746592.7500, 756173.0000, 760363.5625, 763497.1875, 775295.4375,
        784469.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3796e+00, 1.4232e+00, 1.4363e+00, 1.4806e+00, 1.5170e+00,
        1.5303e+00, 1.5318e+00, 1.6478e+00, 3.8159e+05, 3.8575e+05, 3.8621e+05,
        3.9406e+05, 3.9486e+05, 3.9523e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2850e+00, 1.3654e+00, 1.3796e+00, 1.4254e+00, 1.4522e+00,
        1.4732e+00, 1.5411e+00, 1.6131e+00, 3.8157e+05, 3.8575e+05, 3.8621e+05,
        3.9404e+05, 3.9487e+05, 3.9524e+05, 4.0282e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4949e+00, 1.6131e+00, 1.6478e+00, 1.7250e+00, 1.7686e+00,
        1.8608e+00, 1.9001e+00, 2.0232e+00, 3.8157e+05, 3.8575e+05, 3.8618e+05,
        3.9404e+05, 3.9484e+05, 3.9520e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385701.0312, 385723.7812, 385737.3750, 385738.0312,
        385747.2812, 385747.3125, 385747.3750, 385753.5312, 385778.7500,
        756173.0000, 785838.2500, 788707.0625, 791716.5000, 799314.2500,
        806751.8750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['437208.34', '430987.75', '423609.69', '76732.92', '432055.75', '76729.66', '76733.92', '76729.26', '432401.91', '76736.67', '76732.06', '418076.22', '76734.67', '76733.37', '76733.02', '422784.75']
estimated f for each client, fs: [5, 5, 5, 7, 5, 7, 7, 7, 5, 7, 7, 5, 7, 7, 7, 5]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 13, 15, 8, 19, 7, 9, 11, 14, 12, 6, 18, 2, 4, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0396s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:33...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:33, End: 2025-07-22 16:00:33)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 17, 15, 11, 16, 19, 12, 18, 6, 10, 2, 1, 5, 7, 8, 9], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7480e+05, 3.9287e+05, 1.4646e+00, 3.8459e+05, 3.8265e+05,
         1.5266e+00, 3.9652e+05, 1.6375e+00, 1.5922e+00, 1.5188e+00, 1.6291e+00,
         1.5434e+00, 1.5975e+00, 1.4835e+00, 1.4616e+00],
        [3.7480e+05, 0.0000e+00, 7.6149e+05, 3.7479e+05, 7.5304e+05, 7.7587e+05,
         3.7480e+05, 7.6644e+05, 3.7483e+05, 3.7480e+05, 3.7482e+05, 3.7484e+05,
         3.7481e+05, 3.7481e+05, 3.7478e+05, 3.7483e+05],
        [3.9287e+05, 7.6149e+05, 0.0000e+00, 3.9290e+05, 7.7878e+05, 7.6180e+05,
         3.9289e+05, 7.7540e+05, 3.9289e+05, 3.9287e+05, 3.9294e+05, 3.9286e+05,
         3.9291e+05, 3.9291e+05, 3.9289e+05, 3.9289e+05],
        [1.4646e+00, 3.7479e+05, 3.9290e+05, 0.0000e+00, 3.8456e+05, 3.8268e+05,
         1.5814e+00, 3.9653e+05, 1.7650e+00, 1.5938e+00, 1.5722e+00, 1.5799e+00,
         1.5761e+00, 1.6436e+00, 1.6286e+00, 1.5135e+00],
        [3.8459e+05, 7.5304e+05, 7.7878e+05, 3.8456e+05, 0.0000e+00, 7.7986e+05,
         3.8456e+05, 8.0357e+05, 3.8454e+05, 3.8458e+05, 3.8457e+05, 3.8457e+05,
         3.8460e+05, 3.8458e+05, 3.8457e+05, 3.8457e+05],
        [3.8265e+05, 7.7587e+05, 7.6180e+05, 3.8268e+05, 7.7986e+05, 0.0000e+00,
         3.8267e+05, 7.7915e+05, 3.8263e+05, 3.8267e+05, 3.8268e+05, 3.8264e+05,
         3.8268e+05, 3.8267e+05, 3.8267e+05, 3.8267e+05],
        [1.5266e+00, 3.7480e+05, 3.9289e+05, 1.5814e+00, 3.8456e+05, 3.8267e+05,
         0.0000e+00, 3.9655e+05, 1.6388e+00, 1.6977e+00, 1.5926e+00, 1.5593e+00,
         1.8086e+00, 1.5658e+00, 1.7004e+00, 1.6547e+00],
        [3.9652e+05, 7.6644e+05, 7.7540e+05, 3.9653e+05, 8.0357e+05, 7.7915e+05,
         3.9655e+05, 0.0000e+00, 3.9654e+05, 3.9653e+05, 3.9648e+05, 3.9654e+05,
         3.9651e+05, 3.9654e+05, 3.9655e+05, 3.9655e+05],
        [1.6375e+00, 3.7483e+05, 3.9289e+05, 1.7650e+00, 3.8454e+05, 3.8263e+05,
         1.6388e+00, 3.9654e+05, 0.0000e+00, 1.9682e+00, 1.6209e+00, 1.6243e+00,
         2.0669e+00, 1.7537e+00, 1.7389e+00, 1.6651e+00],
        [1.5922e+00, 3.7480e+05, 3.9287e+05, 1.5938e+00, 3.8458e+05, 3.8267e+05,
         1.6977e+00, 3.9653e+05, 1.9682e+00, 0.0000e+00, 1.6082e+00, 1.7154e+00,
         1.5199e+00, 1.8584e+00, 1.7262e+00, 1.5240e+00],
        [1.5188e+00, 3.7482e+05, 3.9294e+05, 1.5722e+00, 3.8457e+05, 3.8268e+05,
         1.5926e+00, 3.9648e+05, 1.6209e+00, 1.6082e+00, 0.0000e+00, 1.6058e+00,
         1.7305e+00, 1.6035e+00, 1.7044e+00, 1.5096e+00],
        [1.6291e+00, 3.7484e+05, 3.9286e+05, 1.5799e+00, 3.8457e+05, 3.8264e+05,
         1.5593e+00, 3.9654e+05, 1.6243e+00, 1.7154e+00, 1.6058e+00, 0.0000e+00,
         1.7565e+00, 1.6160e+00, 1.7311e+00, 1.6220e+00],
        [1.5434e+00, 3.7481e+05, 3.9291e+05, 1.5761e+00, 3.8460e+05, 3.8268e+05,
         1.8086e+00, 3.9651e+05, 2.0669e+00, 1.5199e+00, 1.7305e+00, 1.7565e+00,
         0.0000e+00, 1.7983e+00, 1.7761e+00, 1.6017e+00],
        [1.5975e+00, 3.7481e+05, 3.9291e+05, 1.6436e+00, 3.8458e+05, 3.8267e+05,
         1.5658e+00, 3.9654e+05, 1.7537e+00, 1.8584e+00, 1.6035e+00, 1.6160e+00,
         1.7983e+00, 0.0000e+00, 1.7334e+00, 1.7014e+00],
        [1.4835e+00, 3.7478e+05, 3.9289e+05, 1.6286e+00, 3.8457e+05, 3.8267e+05,
         1.7004e+00, 3.9655e+05, 1.7389e+00, 1.7262e+00, 1.7044e+00, 1.7311e+00,
         1.7761e+00, 1.7334e+00, 0.0000e+00, 1.5828e+00],
        [1.4616e+00, 3.7483e+05, 3.9289e+05, 1.5135e+00, 3.8457e+05, 3.8267e+05,
         1.6547e+00, 3.9655e+05, 1.6651e+00, 1.5240e+00, 1.5096e+00, 1.6220e+00,
         1.6017e+00, 1.7014e+00, 1.5828e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4616e+00, 1.4646e+00, 1.4835e+00, 1.5188e+00, 1.5266e+00,
        1.5434e+00, 1.5922e+00, 1.5975e+00, 1.6291e+00, 1.6375e+00, 3.7480e+05,
        3.8265e+05, 3.8459e+05, 3.9287e+05, 3.9652e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374781.8750, 374787.7188, 374798.8750, 374799.5000,
        374802.5312, 374809.4062, 374810.6250, 374823.0312, 374825.4062,
        374830.8750, 374835.3750, 753035.3750, 761491.7500, 766442.7500,
        775870.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392862.7188, 392870.7188, 392873.5312, 392886.1250,
        392886.3750, 392889.7188, 392892.1875, 392895.8750, 392907.6875,
        392908.3125, 392936.8750, 761491.7500, 761800.9375, 775398.6875,
        778775.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4646e+00, 1.5135e+00, 1.5722e+00, 1.5761e+00, 1.5799e+00,
        1.5814e+00, 1.5938e+00, 1.6286e+00, 1.6436e+00, 1.7650e+00, 3.7479e+05,
        3.8268e+05, 3.8456e+05, 3.9290e+05, 3.9653e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384541.9375, 384555.4062, 384557.9688, 384567.1875,
        384571.0000, 384571.8750, 384572.6562, 384581.1875, 384582.1250,
        384591.1875, 384597.1875, 753035.3750, 778775.6250, 779857.3125,
        803565.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 382626.1250, 382638.6875, 382648.8438, 382666.5312,
        382668.5938, 382671.0000, 382672.8750, 382674.1875, 382677.0000,
        382680.0000, 382684.1250, 761800.9375, 775870.3750, 779146.2500,
        779857.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.5266e+00, 1.5593e+00, 1.5658e+00, 1.5814e+00, 1.5926e+00,
        1.6388e+00, 1.6547e+00, 1.6977e+00, 1.7004e+00, 1.8086e+00, 3.7480e+05,
        3.8267e+05, 3.8456e+05, 3.9289e+05, 3.9655e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396478.1875, 396506.0000, 396517.6250, 396529.8750,
        396530.3750, 396535.4375, 396541.3125, 396544.3750, 396548.8125,
        396549.5312, 396549.6250, 766442.7500, 775398.6875, 779146.2500,
        803565.5625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.6209e+00, 1.6243e+00, 1.6375e+00, 1.6388e+00, 1.6651e+00,
        1.7389e+00, 1.7537e+00, 1.7650e+00, 1.9682e+00, 2.0669e+00, 3.7483e+05,
        3.8263e+05, 3.8454e+05, 3.9289e+05, 3.9654e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5199e+00, 1.5240e+00, 1.5922e+00, 1.5938e+00, 1.6082e+00,
        1.6977e+00, 1.7154e+00, 1.7262e+00, 1.8584e+00, 1.9682e+00, 3.7480e+05,
        3.8267e+05, 3.8458e+05, 3.9287e+05, 3.9653e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5096e+00, 1.5188e+00, 1.5722e+00, 1.5926e+00, 1.6035e+00,
        1.6058e+00, 1.6082e+00, 1.6209e+00, 1.7044e+00, 1.7305e+00, 3.7482e+05,
        3.8268e+05, 3.8457e+05, 3.9294e+05, 3.9648e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5593e+00, 1.5799e+00, 1.6058e+00, 1.6160e+00, 1.6220e+00,
        1.6243e+00, 1.6291e+00, 1.7154e+00, 1.7311e+00, 1.7565e+00, 3.7484e+05,
        3.8264e+05, 3.8457e+05, 3.9286e+05, 3.9654e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5199e+00, 1.5434e+00, 1.5761e+00, 1.6017e+00, 1.7305e+00,
        1.7565e+00, 1.7761e+00, 1.7983e+00, 1.8086e+00, 2.0669e+00, 3.7481e+05,
        3.8268e+05, 3.8460e+05, 3.9291e+05, 3.9651e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5658e+00, 1.5975e+00, 1.6035e+00, 1.6160e+00, 1.6436e+00,
        1.7014e+00, 1.7334e+00, 1.7537e+00, 1.7983e+00, 1.8584e+00, 3.7481e+05,
        3.8267e+05, 3.8458e+05, 3.9291e+05, 3.9654e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4835e+00, 1.5828e+00, 1.6286e+00, 1.7004e+00, 1.7044e+00,
        1.7262e+00, 1.7311e+00, 1.7334e+00, 1.7389e+00, 1.7761e+00, 3.7478e+05,
        3.8267e+05, 3.8457e+05, 3.9289e+05, 3.9655e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4616e+00, 1.5096e+00, 1.5135e+00, 1.5240e+00, 1.5828e+00,
        1.6017e+00, 1.6220e+00, 1.6547e+00, 1.6651e+00, 1.7014e+00, 3.7483e+05,
        3.8267e+05, 3.8457e+05, 3.9289e+05, 3.9655e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.55', '374807.00', '392891.88', '1.59', '384571.81', '382664.31', '1.63', '396530.12', '1.75', '1.68', '1.61', '1.64', '1.72', '1.69', '1.68', '1.58']
estimated f for each client, fs: [5, 5, 3, 5, 3, 3, 5, 3, 5, 5, 5, 5, 5, 5, 5, 5]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 17, 15, 11, 16, 19, 12, 18, 6, 10, 2, 1, 5, 7, 8, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0135s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:33...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 16:00:33, End: 2025-07-22 16:00:33)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 5, 16, 11, 10, 3, 15, 13, 6, 7, 2, 4, 8, 12, 19, 20], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5084e+00, 3.8891e+05, 1.3062e+00, 1.4838e+00, 1.4907e+00,
         3.8887e+05, 3.9878e+05, 1.4676e+00, 1.4043e+00, 1.3741e+00, 1.7475e+00,
         1.5066e+00, 1.3674e+00, 3.8972e+05, 3.9305e+05],
        [1.5084e+00, 0.0000e+00, 3.8891e+05, 1.3588e+00, 1.3123e+00, 1.4291e+00,
         3.8889e+05, 3.9879e+05, 1.8700e+00, 1.5925e+00, 1.5150e+00, 1.3799e+00,
         1.5614e+00, 1.5715e+00, 3.8972e+05, 3.9308e+05],
        [3.8891e+05, 3.8891e+05, 0.0000e+00, 3.8889e+05, 3.8891e+05, 3.8895e+05,
         7.6361e+05, 7.7359e+05, 3.8892e+05, 3.8890e+05, 3.8892e+05, 3.8893e+05,
         3.8891e+05, 3.8892e+05, 7.8701e+05, 7.8081e+05],
        [1.3062e+00, 1.3588e+00, 3.8889e+05, 0.0000e+00, 1.3710e+00, 1.4180e+00,
         3.8886e+05, 3.9880e+05, 1.5090e+00, 1.3873e+00, 1.3244e+00, 1.4782e+00,
         1.3418e+00, 1.4113e+00, 3.8975e+05, 3.9302e+05],
        [1.4838e+00, 1.3123e+00, 3.8891e+05, 1.3710e+00, 0.0000e+00, 1.3798e+00,
         3.8890e+05, 3.9879e+05, 1.7581e+00, 1.6297e+00, 1.4116e+00, 1.5016e+00,
         1.5206e+00, 1.5006e+00, 3.8973e+05, 3.9304e+05],
        [1.4907e+00, 1.4291e+00, 3.8895e+05, 1.4180e+00, 1.3798e+00, 0.0000e+00,
         3.8887e+05, 3.9880e+05, 1.6298e+00, 1.5523e+00, 1.3846e+00, 1.6534e+00,
         1.4323e+00, 1.4272e+00, 3.8970e+05, 3.9302e+05],
        [3.8887e+05, 3.8889e+05, 7.6361e+05, 3.8886e+05, 3.8890e+05, 3.8887e+05,
         0.0000e+00, 7.7108e+05, 3.8885e+05, 3.8890e+05, 3.8886e+05, 3.8887e+05,
         3.8888e+05, 3.8887e+05, 7.8314e+05, 7.8591e+05],
        [3.9878e+05, 3.9879e+05, 7.7359e+05, 3.9880e+05, 3.9879e+05, 3.9880e+05,
         7.7108e+05, 0.0000e+00, 3.9883e+05, 3.9880e+05, 3.9878e+05, 3.9882e+05,
         3.9880e+05, 3.9883e+05, 7.7009e+05, 7.8077e+05],
        [1.4676e+00, 1.8700e+00, 3.8892e+05, 1.5090e+00, 1.7581e+00, 1.6298e+00,
         3.8885e+05, 3.9883e+05, 0.0000e+00, 1.5437e+00, 1.4613e+00, 2.0197e+00,
         1.5046e+00, 1.4937e+00, 3.8975e+05, 3.9303e+05],
        [1.4043e+00, 1.5925e+00, 3.8890e+05, 1.3873e+00, 1.6297e+00, 1.5523e+00,
         3.8890e+05, 3.9880e+05, 1.5437e+00, 0.0000e+00, 1.3989e+00, 1.8402e+00,
         1.5386e+00, 1.3647e+00, 3.8974e+05, 3.9302e+05],
        [1.3741e+00, 1.5150e+00, 3.8892e+05, 1.3244e+00, 1.4116e+00, 1.3846e+00,
         3.8886e+05, 3.9878e+05, 1.4613e+00, 1.3989e+00, 0.0000e+00, 1.6025e+00,
         1.4599e+00, 1.3886e+00, 3.8973e+05, 3.9302e+05],
        [1.7475e+00, 1.3799e+00, 3.8893e+05, 1.4782e+00, 1.5016e+00, 1.6534e+00,
         3.8887e+05, 3.9882e+05, 2.0197e+00, 1.8402e+00, 1.6025e+00, 0.0000e+00,
         1.6098e+00, 1.7556e+00, 3.8974e+05, 3.9304e+05],
        [1.5066e+00, 1.5614e+00, 3.8891e+05, 1.3418e+00, 1.5206e+00, 1.4323e+00,
         3.8888e+05, 3.9880e+05, 1.5046e+00, 1.5386e+00, 1.4599e+00, 1.6098e+00,
         0.0000e+00, 1.5311e+00, 3.8973e+05, 3.9305e+05],
        [1.3674e+00, 1.5715e+00, 3.8892e+05, 1.4113e+00, 1.5006e+00, 1.4272e+00,
         3.8887e+05, 3.9883e+05, 1.4937e+00, 1.3647e+00, 1.3886e+00, 1.7556e+00,
         1.5311e+00, 0.0000e+00, 3.8971e+05, 3.9304e+05],
        [3.8972e+05, 3.8972e+05, 7.8701e+05, 3.8975e+05, 3.8973e+05, 3.8970e+05,
         7.8314e+05, 7.7009e+05, 3.8975e+05, 3.8974e+05, 3.8973e+05, 3.8974e+05,
         3.8973e+05, 3.8971e+05, 0.0000e+00, 7.6728e+05],
        [3.9305e+05, 3.9308e+05, 7.8081e+05, 3.9302e+05, 3.9304e+05, 3.9302e+05,
         7.8591e+05, 7.8077e+05, 3.9303e+05, 3.9302e+05, 3.9302e+05, 3.9304e+05,
         3.9305e+05, 3.9304e+05, 7.6728e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3062e+00, 1.3674e+00, 1.3741e+00, 1.4043e+00, 1.4676e+00,
        1.4838e+00, 1.4907e+00, 1.5066e+00, 1.5084e+00, 1.7475e+00, 3.8887e+05,
        3.8891e+05, 3.8972e+05, 3.9305e+05, 3.9878e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3123e+00, 1.3588e+00, 1.3799e+00, 1.4291e+00, 1.5084e+00,
        1.5150e+00, 1.5614e+00, 1.5715e+00, 1.5925e+00, 1.8700e+00, 3.8889e+05,
        3.8891e+05, 3.8972e+05, 3.9308e+05, 3.9879e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388890.5000, 388899.1875, 388909.2812, 388911.1562,
        388911.3438, 388914.2500, 388920.7188, 388920.7812, 388924.4688,
        388928.3125, 388946.5625, 763610.6250, 773594.5625, 780813.1250,
        787005.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3062e+00, 1.3244e+00, 1.3418e+00, 1.3588e+00, 1.3710e+00,
        1.3873e+00, 1.4113e+00, 1.4180e+00, 1.4782e+00, 1.5090e+00, 3.8886e+05,
        3.8889e+05, 3.8975e+05, 3.9302e+05, 3.9880e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3123e+00, 1.3710e+00, 1.3798e+00, 1.4116e+00, 1.4838e+00,
        1.5006e+00, 1.5016e+00, 1.5206e+00, 1.6297e+00, 1.7581e+00, 3.8890e+05,
        3.8891e+05, 3.8973e+05, 3.9304e+05, 3.9879e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3798e+00, 1.3846e+00, 1.4180e+00, 1.4272e+00, 1.4291e+00,
        1.4323e+00, 1.4907e+00, 1.5523e+00, 1.6298e+00, 1.6534e+00, 3.8887e+05,
        3.8895e+05, 3.8970e+05, 3.9302e+05, 3.9880e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388852.4375, 388859.3750, 388860.8750, 388866.7500,
        388869.8125, 388870.4375, 388872.9062, 388880.0625, 388887.0625,
        388897.9375, 388899.0938, 763610.6250, 771078.1875, 783138.6250,
        785905.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 398777.6875, 398783.6250, 398788.5312, 398791.3750,
        398796.2812, 398798.2188, 398801.5625, 398804.0000, 398819.8438,
        398826.0312, 398831.2500, 770090.5000, 771078.1875, 773594.5625,
        780774.6875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4613e+00, 1.4676e+00, 1.4937e+00, 1.5046e+00, 1.5090e+00,
        1.5437e+00, 1.6298e+00, 1.7581e+00, 1.8700e+00, 2.0197e+00, 3.8885e+05,
        3.8892e+05, 3.8975e+05, 3.9303e+05, 3.9883e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3647e+00, 1.3873e+00, 1.3989e+00, 1.4043e+00, 1.5386e+00,
        1.5437e+00, 1.5523e+00, 1.5925e+00, 1.6297e+00, 1.8402e+00, 3.8890e+05,
        3.8890e+05, 3.8974e+05, 3.9302e+05, 3.9880e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3244e+00, 1.3741e+00, 1.3846e+00, 1.3886e+00, 1.3989e+00,
        1.4116e+00, 1.4599e+00, 1.4613e+00, 1.5150e+00, 1.6025e+00, 3.8886e+05,
        3.8892e+05, 3.8973e+05, 3.9302e+05, 3.9878e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3799e+00, 1.4782e+00, 1.5016e+00, 1.6025e+00, 1.6098e+00,
        1.6534e+00, 1.7475e+00, 1.7556e+00, 1.8402e+00, 2.0197e+00, 3.8887e+05,
        3.8893e+05, 3.8974e+05, 3.9304e+05, 3.9882e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3418e+00, 1.4323e+00, 1.4599e+00, 1.5046e+00, 1.5066e+00,
        1.5206e+00, 1.5311e+00, 1.5386e+00, 1.5614e+00, 1.6098e+00, 3.8888e+05,
        3.8891e+05, 3.8973e+05, 3.9305e+05, 3.9880e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3647e+00, 1.3674e+00, 1.3886e+00, 1.4113e+00, 1.4272e+00,
        1.4937e+00, 1.5006e+00, 1.5311e+00, 1.5715e+00, 1.7556e+00, 3.8887e+05,
        3.8892e+05, 3.8971e+05, 3.9304e+05, 3.9883e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389704.2812, 389706.1250, 389715.9688, 389716.0625,
        389726.5625, 389732.2188, 389734.7812, 389741.2188, 389743.5938,
        389748.5312, 389752.5000, 767284.8125, 770090.5000, 783138.6250,
        787005.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 393021.7500, 393022.2500, 393023.4062, 393023.9062,
        393027.1250, 393035.8125, 393038.4375, 393044.8750, 393046.3750,
        393046.4688, 393076.3125, 767284.8125, 780774.6875, 780813.1250,
        785905.9375])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['1.47', '1.51', '388916.03', '1.39', '1.49', '1.48', '388874.28', '398801.69', '1.63', '1.53', '1.43', '1.66', '1.50', '1.48', '389729.22', '393037.00']
estimated f for each client, fs: [5, 5, 3, 5, 5, 5, 3, 3, 5, 5, 5, 5, 5, 5, 3, 3]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 5, 16, 11, 10, 3, 15, 13, 6, 7, 2, 4, 8, 12, 19, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0173s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:34...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:34, End: 2025-07-22 16:00:34)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 20, 9, 14, 2, 6, 16, 4, 8, 13, 12, 1, 17, 5, 7, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.8590e+05, 4.0027e+05, 8.0274e+05, 4.0027e+05, 4.0030e+05,
         8.0153e+05, 4.0023e+05, 4.0030e+05, 7.8345e+05, 4.0026e+05, 4.0029e+05,
         7.9932e+05, 4.0028e+05, 4.0026e+05, 8.2243e+05],
        [7.8590e+05, 0.0000e+00, 3.8913e+05, 7.8499e+05, 3.8911e+05, 3.8916e+05,
         8.0812e+05, 3.8913e+05, 3.8912e+05, 7.9082e+05, 3.8911e+05, 3.8913e+05,
         7.7413e+05, 3.8915e+05, 3.8914e+05, 7.9274e+05],
        [4.0027e+05, 3.8913e+05, 0.0000e+00, 3.9272e+05, 1.2623e+00, 1.5048e+00,
         4.0001e+05, 1.3136e+00, 1.3649e+00, 3.8456e+05, 1.4243e+00, 1.4263e+00,
         3.9714e+05, 1.4283e+00, 1.4864e+00, 4.0451e+05],
        [8.0274e+05, 7.8499e+05, 3.9272e+05, 0.0000e+00, 3.9271e+05, 3.9272e+05,
         7.9803e+05, 3.9268e+05, 3.9269e+05, 7.7690e+05, 3.9267e+05, 3.9270e+05,
         7.8642e+05, 3.9272e+05, 3.9269e+05, 8.2039e+05],
        [4.0027e+05, 3.8911e+05, 1.2623e+00, 3.9271e+05, 0.0000e+00, 1.3442e+00,
         4.0000e+05, 1.3951e+00, 1.3418e+00, 3.8455e+05, 1.2951e+00, 1.3463e+00,
         3.9714e+05, 1.4387e+00, 1.3368e+00, 4.0448e+05],
        [4.0030e+05, 3.8916e+05, 1.5048e+00, 3.9272e+05, 1.3442e+00, 0.0000e+00,
         3.9997e+05, 1.6893e+00, 1.4087e+00, 3.8458e+05, 1.4241e+00, 1.4282e+00,
         3.9713e+05, 1.7470e+00, 1.4899e+00, 4.0451e+05],
        [8.0153e+05, 8.0812e+05, 4.0001e+05, 7.9803e+05, 4.0000e+05, 3.9997e+05,
         0.0000e+00, 3.9996e+05, 4.0000e+05, 7.9391e+05, 3.9999e+05, 4.0000e+05,
         8.1757e+05, 3.9998e+05, 3.9996e+05, 8.0496e+05],
        [4.0023e+05, 3.8913e+05, 1.3136e+00, 3.9268e+05, 1.3951e+00, 1.6893e+00,
         3.9996e+05, 0.0000e+00, 1.3871e+00, 3.8458e+05, 1.4846e+00, 1.5196e+00,
         3.9713e+05, 1.2525e+00, 1.5585e+00, 4.0448e+05],
        [4.0030e+05, 3.8912e+05, 1.3649e+00, 3.9269e+05, 1.3418e+00, 1.4087e+00,
         4.0000e+05, 1.3871e+00, 0.0000e+00, 3.8458e+05, 1.4105e+00, 1.4443e+00,
         3.9714e+05, 1.4618e+00, 1.4218e+00, 4.0450e+05],
        [7.8345e+05, 7.9082e+05, 3.8456e+05, 7.7690e+05, 3.8455e+05, 3.8458e+05,
         7.9391e+05, 3.8458e+05, 3.8458e+05, 0.0000e+00, 3.8454e+05, 3.8455e+05,
         7.7258e+05, 3.8459e+05, 3.8454e+05, 7.9489e+05],
        [4.0026e+05, 3.8911e+05, 1.4243e+00, 3.9267e+05, 1.2951e+00, 1.4241e+00,
         3.9999e+05, 1.4846e+00, 1.4105e+00, 3.8454e+05, 0.0000e+00, 1.3549e+00,
         3.9715e+05, 1.4581e+00, 1.3373e+00, 4.0450e+05],
        [4.0029e+05, 3.8913e+05, 1.4263e+00, 3.9270e+05, 1.3463e+00, 1.4282e+00,
         4.0000e+05, 1.5196e+00, 1.4443e+00, 3.8455e+05, 1.3549e+00, 0.0000e+00,
         3.9713e+05, 1.4623e+00, 1.4170e+00, 4.0449e+05],
        [7.9932e+05, 7.7413e+05, 3.9714e+05, 7.8642e+05, 3.9714e+05, 3.9713e+05,
         8.1757e+05, 3.9713e+05, 3.9714e+05, 7.7258e+05, 3.9715e+05, 3.9713e+05,
         0.0000e+00, 3.9716e+05, 3.9714e+05, 8.0606e+05],
        [4.0028e+05, 3.8915e+05, 1.4283e+00, 3.9272e+05, 1.4387e+00, 1.7470e+00,
         3.9998e+05, 1.2525e+00, 1.4618e+00, 3.8459e+05, 1.4581e+00, 1.4623e+00,
         3.9716e+05, 0.0000e+00, 1.5218e+00, 4.0452e+05],
        [4.0026e+05, 3.8914e+05, 1.4864e+00, 3.9269e+05, 1.3368e+00, 1.4899e+00,
         3.9996e+05, 1.5585e+00, 1.4218e+00, 3.8454e+05, 1.3373e+00, 1.4170e+00,
         3.9714e+05, 1.5218e+00, 0.0000e+00, 4.0448e+05],
        [8.2243e+05, 7.9274e+05, 4.0451e+05, 8.2039e+05, 4.0448e+05, 4.0451e+05,
         8.0496e+05, 4.0448e+05, 4.0450e+05, 7.9489e+05, 4.0450e+05, 4.0449e+05,
         8.0606e+05, 4.0452e+05, 4.0448e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 400232.8750, 400260.5000, 400263.8438, 400267.5938,
        400274.2500, 400284.5312, 400285.5625, 400300.0312, 400302.6250,
        783446.9375, 785897.3125, 799325.0000, 801531.2500, 802740.8125,
        822432.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389109.9375, 389114.7812, 389123.7500, 389129.7500,
        389130.6250, 389134.5938, 389141.4062, 389148.4688, 389155.0625,
        774134.9375, 784990.4375, 785897.3125, 790822.2500, 792743.4375,
        808116.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2623e+00, 1.3136e+00, 1.3649e+00, 1.4243e+00, 1.4263e+00,
        1.4283e+00, 1.4864e+00, 1.5048e+00, 3.8456e+05, 3.8913e+05, 3.9272e+05,
        3.9714e+05, 4.0001e+05, 4.0027e+05, 4.0451e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392670.9688, 392679.3125, 392687.1250, 392691.9375,
        392697.9688, 392707.1875, 392715.3750, 392716.9375, 392717.8750,
        776896.3750, 784990.4375, 786423.8125, 798031.6875, 802740.8125,
        820393.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2623e+00, 1.2951e+00, 1.3368e+00, 1.3418e+00, 1.3442e+00,
        1.3463e+00, 1.3951e+00, 1.4387e+00, 3.8455e+05, 3.8911e+05, 3.9271e+05,
        3.9714e+05, 4.0000e+05, 4.0027e+05, 4.0448e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3442e+00, 1.4087e+00, 1.4241e+00, 1.4282e+00, 1.4899e+00,
        1.5048e+00, 1.6893e+00, 1.7470e+00, 3.8458e+05, 3.8916e+05, 3.9272e+05,
        3.9713e+05, 3.9997e+05, 4.0030e+05, 4.0451e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399958.4375, 399960.1562, 399972.6250, 399983.5000,
        399985.7500, 399996.2500, 399997.2188, 399998.1875, 400013.9062,
        793912.3125, 798031.6875, 801531.2500, 804962.2500, 808116.7500,
        817571.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2525e+00, 1.3136e+00, 1.3871e+00, 1.3951e+00, 1.4846e+00,
        1.5196e+00, 1.5585e+00, 1.6893e+00, 3.8458e+05, 3.8913e+05, 3.9268e+05,
        3.9713e+05, 3.9996e+05, 4.0023e+05, 4.0448e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3418e+00, 1.3649e+00, 1.3871e+00, 1.4087e+00, 1.4105e+00,
        1.4218e+00, 1.4443e+00, 1.4618e+00, 3.8458e+05, 3.8912e+05, 3.9269e+05,
        3.9714e+05, 4.0000e+05, 4.0030e+05, 4.0450e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384535.9375, 384544.7812, 384549.2812, 384553.3438,
        384559.2500, 384575.5625, 384575.7188, 384583.4062, 384586.7500,
        772576.4375, 776896.3750, 783446.9375, 790822.2500, 793912.3125,
        794894.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2951e+00, 1.3373e+00, 1.3549e+00, 1.4105e+00, 1.4241e+00,
        1.4243e+00, 1.4581e+00, 1.4846e+00, 3.8454e+05, 3.8911e+05, 3.9267e+05,
        3.9715e+05, 3.9999e+05, 4.0026e+05, 4.0450e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3463e+00, 1.3549e+00, 1.4170e+00, 1.4263e+00, 1.4282e+00,
        1.4443e+00, 1.4623e+00, 1.5196e+00, 3.8455e+05, 3.8913e+05, 3.9270e+05,
        3.9713e+05, 4.0000e+05, 4.0029e+05, 4.0449e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397129.6250, 397130.5312, 397132.9375, 397137.8750,
        397139.1250, 397139.3125, 397144.4062, 397150.0000, 397155.6562,
        772576.4375, 774134.9375, 786423.8125, 799325.0000, 806058.6250,
        817571.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2525e+00, 1.4283e+00, 1.4387e+00, 1.4581e+00, 1.4618e+00,
        1.4623e+00, 1.5218e+00, 1.7470e+00, 3.8459e+05, 3.8915e+05, 3.9272e+05,
        3.9716e+05, 3.9998e+05, 4.0028e+05, 4.0452e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3368e+00, 1.3373e+00, 1.4170e+00, 1.4218e+00, 1.4864e+00,
        1.4899e+00, 1.5218e+00, 1.5585e+00, 3.8454e+05, 3.8914e+05, 3.9269e+05,
        3.9714e+05, 3.9996e+05, 4.0026e+05, 4.0448e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404478.4375, 404481.9688, 404483.0938, 404494.5938,
        404499.2188, 404499.8750, 404505.0312, 404506.0312, 404518.5000,
        792743.4375, 794894.8750, 804962.2500, 806058.6250, 820393.3125,
        822432.1250])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['438591.84', '427632.34', '77370.11', '431118.09', '77367.48', '77374.29', '439377.84', '77371.69', '77371.84', '423364.06', '77365.71', '77369.94', '434683.59', '77374.70', '77369.77', '443321.00']
estimated f for each client, fs: [5, 5, 7, 5, 7, 7, 5, 7, 7, 6, 7, 7, 5, 7, 7, 5]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 20, 9, 14, 2, 6, 16, 4, 8, 13, 12, 1, 17, 5, 7, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0255s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:34...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:34, End: 2025-07-22 16:00:34)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 8, 2, 19, 4, 16, 20, 1, 7, 10, 6, 11, 14, 17, 18, 5], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4117e+00, 1.4172e+00, 3.9531e+05, 1.5152e+00, 3.9019e+05,
         3.7797e+05, 1.5641e+00, 1.5049e+00, 1.3889e+00, 1.6528e+00, 1.5080e+00,
         3.8507e+05, 3.8500e+05, 3.8788e+05, 1.4751e+00],
        [1.4117e+00, 0.0000e+00, 1.4244e+00, 3.9534e+05, 1.4525e+00, 3.9021e+05,
         3.7797e+05, 1.5113e+00, 1.4538e+00, 1.4094e+00, 1.4674e+00, 1.4287e+00,
         3.8513e+05, 3.8501e+05, 3.8790e+05, 1.5624e+00],
        [1.4172e+00, 1.4244e+00, 0.0000e+00, 3.9529e+05, 1.4618e+00, 3.9017e+05,
         3.7797e+05, 1.4091e+00, 1.3653e+00, 1.3561e+00, 1.4229e+00, 1.4019e+00,
         3.8509e+05, 3.8499e+05, 3.8791e+05, 1.5079e+00],
        [3.9531e+05, 3.9534e+05, 3.9529e+05, 0.0000e+00, 3.9532e+05, 7.8366e+05,
         7.7658e+05, 3.9532e+05, 3.9529e+05, 3.9530e+05, 3.9531e+05, 3.9529e+05,
         7.9143e+05, 7.8711e+05, 7.7721e+05, 3.9530e+05],
        [1.5152e+00, 1.4525e+00, 1.4618e+00, 3.9532e+05, 0.0000e+00, 3.9018e+05,
         3.7796e+05, 1.5753e+00, 1.6240e+00, 1.3596e+00, 1.7530e+00, 1.1802e+00,
         3.8510e+05, 3.8500e+05, 3.8787e+05, 1.3539e+00],
        [3.9019e+05, 3.9021e+05, 3.9017e+05, 7.8366e+05, 3.9018e+05, 0.0000e+00,
         7.5834e+05, 3.9019e+05, 3.9019e+05, 3.9016e+05, 3.9019e+05, 3.9019e+05,
         7.8311e+05, 7.6395e+05, 7.8357e+05, 3.9016e+05],
        [3.7797e+05, 3.7797e+05, 3.7797e+05, 7.7658e+05, 3.7796e+05, 7.5834e+05,
         0.0000e+00, 3.7796e+05, 3.7798e+05, 3.7797e+05, 3.7799e+05, 3.7795e+05,
         7.5325e+05, 7.7100e+05, 7.5277e+05, 3.7796e+05],
        [1.5641e+00, 1.5113e+00, 1.4091e+00, 3.9532e+05, 1.5753e+00, 3.9019e+05,
         3.7796e+05, 0.0000e+00, 1.4489e+00, 1.4262e+00, 1.4684e+00, 1.4764e+00,
         3.8512e+05, 3.8499e+05, 3.8791e+05, 1.4882e+00],
        [1.5049e+00, 1.4538e+00, 1.3653e+00, 3.9529e+05, 1.6240e+00, 3.9019e+05,
         3.7798e+05, 1.4489e+00, 0.0000e+00, 1.4898e+00, 1.4789e+00, 1.4944e+00,
         3.8510e+05, 3.8495e+05, 3.8793e+05, 1.5223e+00],
        [1.3889e+00, 1.4094e+00, 1.3561e+00, 3.9530e+05, 1.3596e+00, 3.9016e+05,
         3.7797e+05, 1.4262e+00, 1.4898e+00, 0.0000e+00, 1.6668e+00, 1.2995e+00,
         3.8509e+05, 3.8501e+05, 3.8790e+05, 1.3118e+00],
        [1.6528e+00, 1.4674e+00, 1.4229e+00, 3.9531e+05, 1.7530e+00, 3.9019e+05,
         3.7799e+05, 1.4684e+00, 1.4789e+00, 1.6668e+00, 0.0000e+00, 1.7155e+00,
         3.8511e+05, 3.8502e+05, 3.8792e+05, 1.7860e+00],
        [1.5080e+00, 1.4287e+00, 1.4019e+00, 3.9529e+05, 1.1802e+00, 3.9019e+05,
         3.7795e+05, 1.4764e+00, 1.4944e+00, 1.2995e+00, 1.7155e+00, 0.0000e+00,
         3.8510e+05, 3.8499e+05, 3.8787e+05, 1.2433e+00],
        [3.8507e+05, 3.8513e+05, 3.8509e+05, 7.9143e+05, 3.8510e+05, 7.8311e+05,
         7.5325e+05, 3.8512e+05, 3.8510e+05, 3.8509e+05, 3.8511e+05, 3.8510e+05,
         0.0000e+00, 7.6414e+05, 7.6611e+05, 3.8506e+05],
        [3.8500e+05, 3.8501e+05, 3.8499e+05, 7.8711e+05, 3.8500e+05, 7.6395e+05,
         7.7100e+05, 3.8499e+05, 3.8495e+05, 3.8501e+05, 3.8502e+05, 3.8499e+05,
         7.6414e+05, 0.0000e+00, 7.7737e+05, 3.8500e+05],
        [3.8788e+05, 3.8790e+05, 3.8791e+05, 7.7721e+05, 3.8787e+05, 7.8357e+05,
         7.5277e+05, 3.8791e+05, 3.8793e+05, 3.8790e+05, 3.8792e+05, 3.8787e+05,
         7.6611e+05, 7.7737e+05, 0.0000e+00, 3.8788e+05],
        [1.4751e+00, 1.5624e+00, 1.5079e+00, 3.9530e+05, 1.3539e+00, 3.9016e+05,
         3.7796e+05, 1.4882e+00, 1.5223e+00, 1.3118e+00, 1.7860e+00, 1.2433e+00,
         3.8506e+05, 3.8500e+05, 3.8788e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3889e+00, 1.4117e+00, 1.4172e+00, 1.4751e+00, 1.5049e+00,
        1.5080e+00, 1.5152e+00, 1.5641e+00, 1.6528e+00, 3.7797e+05, 3.8500e+05,
        3.8507e+05, 3.8788e+05, 3.9019e+05, 3.9531e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4094e+00, 1.4117e+00, 1.4244e+00, 1.4287e+00, 1.4525e+00,
        1.4538e+00, 1.4674e+00, 1.5113e+00, 1.5624e+00, 3.7797e+05, 3.8501e+05,
        3.8513e+05, 3.8790e+05, 3.9021e+05, 3.9534e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3561e+00, 1.3653e+00, 1.4019e+00, 1.4091e+00, 1.4172e+00,
        1.4229e+00, 1.4244e+00, 1.4618e+00, 1.5079e+00, 3.7797e+05, 3.8499e+05,
        3.8509e+05, 3.8791e+05, 3.9017e+05, 3.9529e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395286.3125, 395288.5938, 395294.1250, 395300.7188,
        395303.9062, 395305.6250, 395307.4375, 395316.4062, 395324.4062,
        395339.3438, 776579.1875, 777211.5625, 783658.1875, 787112.6875,
        791425.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1802e+00, 1.3539e+00, 1.3596e+00, 1.4525e+00, 1.4618e+00,
        1.5152e+00, 1.5753e+00, 1.6240e+00, 1.7530e+00, 3.7796e+05, 3.8500e+05,
        3.8510e+05, 3.8787e+05, 3.9018e+05, 3.9532e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390158.3750, 390163.9375, 390166.7812, 390175.3438,
        390185.6250, 390187.8125, 390188.0000, 390191.1875, 390193.5625,
        390209.9688, 758340.8750, 763947.8125, 783111.6250, 783567.5000,
        783658.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377949.5312, 377957.6250, 377958.6250, 377963.5625,
        377966.2188, 377966.7188, 377973.4688, 377974.0625, 377981.6250,
        377985.6250, 752773.0625, 753253.5625, 758340.8750, 770995.1875,
        776579.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4091e+00, 1.4262e+00, 1.4489e+00, 1.4684e+00, 1.4764e+00,
        1.4882e+00, 1.5113e+00, 1.5641e+00, 1.5753e+00, 3.7796e+05, 3.8499e+05,
        3.8512e+05, 3.8791e+05, 3.9019e+05, 3.9532e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3653e+00, 1.4489e+00, 1.4538e+00, 1.4789e+00, 1.4898e+00,
        1.4944e+00, 1.5049e+00, 1.5223e+00, 1.6240e+00, 3.7798e+05, 3.8495e+05,
        3.8510e+05, 3.8793e+05, 3.9019e+05, 3.9529e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2995e+00, 1.3118e+00, 1.3561e+00, 1.3596e+00, 1.3889e+00,
        1.4094e+00, 1.4262e+00, 1.4898e+00, 1.6668e+00, 3.7797e+05, 3.8501e+05,
        3.8509e+05, 3.8790e+05, 3.9016e+05, 3.9530e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4229e+00, 1.4674e+00, 1.4684e+00, 1.4789e+00, 1.6528e+00,
        1.6668e+00, 1.7155e+00, 1.7530e+00, 1.7860e+00, 3.7799e+05, 3.8502e+05,
        3.8511e+05, 3.8792e+05, 3.9019e+05, 3.9531e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1802e+00, 1.2433e+00, 1.2995e+00, 1.4019e+00, 1.4287e+00,
        1.4764e+00, 1.4944e+00, 1.5080e+00, 1.7155e+00, 3.7795e+05, 3.8499e+05,
        3.8510e+05, 3.8787e+05, 3.9019e+05, 3.9529e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385063.3125, 385069.0625, 385087.4375, 385090.0938,
        385095.1875, 385097.7812, 385099.4062, 385108.4062, 385119.2812,
        385133.7500, 753253.5625, 764136.2500, 766112.4375, 783111.6250,
        791425.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384947.3750, 384987.9062, 384990.3750, 384992.0938,
        384998.0000, 385000.1875, 385004.4062, 385005.7500, 385014.1250,
        385015.2188, 763947.8125, 764136.2500, 770995.1875, 777369.5000,
        787112.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387870.2812, 387874.3125, 387876.6875, 387877.5000,
        387895.2500, 387897.7188, 387908.3125, 387913.7500, 387919.9062,
        387929.9688, 752773.0625, 766112.4375, 777211.5625, 777369.5000,
        783567.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2433e+00, 1.3118e+00, 1.3539e+00, 1.4751e+00, 1.4882e+00,
        1.5079e+00, 1.5223e+00, 1.5624e+00, 1.7860e+00, 3.7796e+05, 3.8500e+05,
        3.8506e+05, 3.8788e+05, 3.9016e+05, 3.9530e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37797.96', '37797.98', '37798.68', '395306.69', '37797.68', '390182.06', '377967.69', '37797.20', '37799.50', '37798.62', '37800.00', '37796.23', '385096.38', '384995.56', '387896.38', '37797.09']
estimated f for each client, fs: [6, 6, 6, 4, 6, 4, 4, 6, 6, 6, 6, 6, 4, 4, 4, 6]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 8, 2, 19, 4, 16, 20, 1, 7, 10, 6, 11, 14, 17, 18, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:35...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[161  76]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:35, End: 2025-07-22 16:00:35)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 16, 8, 1, 9, 14, 11, 4, 6, 17, 2, 15, 12, 5, 7, 3], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0901e+05, 1.1534e+00, 1.1858e+00, 1.0596e+00, 3.8744e+05,
         1.3785e+00, 1.1256e+00, 1.4160e+00, 3.9465e+05, 1.1570e+00, 4.0616e+05,
         1.0568e+00, 1.1302e+00, 1.2807e+00, 1.1767e+00],
        [4.0901e+05, 0.0000e+00, 4.0906e+05, 4.0906e+05, 4.0904e+05, 7.9601e+05,
         4.0909e+05, 4.0906e+05, 4.0905e+05, 8.2357e+05, 4.0905e+05, 8.2776e+05,
         4.0904e+05, 4.0905e+05, 4.0905e+05, 4.0903e+05],
        [1.1534e+00, 4.0906e+05, 0.0000e+00, 1.2621e+00, 1.0981e+00, 3.8744e+05,
         1.6679e+00, 1.2204e+00, 1.2216e+00, 3.9468e+05, 1.1740e+00, 4.0614e+05,
         1.2060e+00, 1.3244e+00, 1.2500e+00, 1.1587e+00],
        [1.1858e+00, 4.0906e+05, 1.2621e+00, 0.0000e+00, 1.1654e+00, 3.8743e+05,
         1.7238e+00, 1.3283e+00, 1.2587e+00, 3.9467e+05, 1.1772e+00, 4.0613e+05,
         1.1830e+00, 1.2686e+00, 1.2693e+00, 1.2788e+00],
        [1.0596e+00, 4.0904e+05, 1.0981e+00, 1.1654e+00, 0.0000e+00, 3.8742e+05,
         1.4650e+00, 1.1152e+00, 1.2468e+00, 3.9467e+05, 1.0915e+00, 4.0613e+05,
         1.1050e+00, 1.1991e+00, 1.2481e+00, 1.1156e+00],
        [3.8744e+05, 7.9601e+05, 3.8744e+05, 3.8743e+05, 3.8742e+05, 0.0000e+00,
         3.8743e+05, 3.8743e+05, 3.8743e+05, 7.9536e+05, 3.8743e+05, 7.8613e+05,
         3.8742e+05, 3.8745e+05, 3.8748e+05, 3.8742e+05],
        [1.3785e+00, 4.0909e+05, 1.6679e+00, 1.7238e+00, 1.4650e+00, 3.8743e+05,
         0.0000e+00, 1.1803e+00, 2.0128e+00, 3.9465e+05, 1.6169e+00, 4.0612e+05,
         1.3758e+00, 1.3654e+00, 1.8300e+00, 1.6434e+00],
        [1.1256e+00, 4.0906e+05, 1.2204e+00, 1.3283e+00, 1.1152e+00, 3.8743e+05,
         1.1803e+00, 0.0000e+00, 1.4711e+00, 3.9465e+05, 1.2315e+00, 4.0615e+05,
         1.0793e+00, 1.1274e+00, 1.3887e+00, 1.2675e+00],
        [1.4160e+00, 4.0905e+05, 1.2216e+00, 1.2587e+00, 1.2468e+00, 3.8743e+05,
         2.0128e+00, 1.4711e+00, 0.0000e+00, 3.9467e+05, 1.1935e+00, 4.0618e+05,
         1.3946e+00, 1.5566e+00, 1.2897e+00, 1.3431e+00],
        [3.9465e+05, 8.2357e+05, 3.9468e+05, 3.9467e+05, 3.9467e+05, 7.9536e+05,
         3.9465e+05, 3.9465e+05, 3.9467e+05, 0.0000e+00, 3.9464e+05, 8.0234e+05,
         3.9466e+05, 3.9469e+05, 3.9467e+05, 3.9465e+05],
        [1.1570e+00, 4.0905e+05, 1.1740e+00, 1.1772e+00, 1.0915e+00, 3.8743e+05,
         1.6169e+00, 1.2315e+00, 1.1935e+00, 3.9464e+05, 0.0000e+00, 4.0617e+05,
         1.1402e+00, 1.3030e+00, 1.1855e+00, 1.1640e+00],
        [4.0616e+05, 8.2776e+05, 4.0614e+05, 4.0613e+05, 4.0613e+05, 7.8613e+05,
         4.0612e+05, 4.0615e+05, 4.0618e+05, 8.0234e+05, 4.0617e+05, 0.0000e+00,
         4.0614e+05, 4.0613e+05, 4.0614e+05, 4.0616e+05],
        [1.0568e+00, 4.0904e+05, 1.2060e+00, 1.1830e+00, 1.1050e+00, 3.8742e+05,
         1.3758e+00, 1.0793e+00, 1.3946e+00, 3.9466e+05, 1.1402e+00, 4.0614e+05,
         0.0000e+00, 1.1325e+00, 1.2544e+00, 1.1125e+00],
        [1.1302e+00, 4.0905e+05, 1.3244e+00, 1.2686e+00, 1.1991e+00, 3.8745e+05,
         1.3654e+00, 1.1274e+00, 1.5566e+00, 3.9469e+05, 1.3030e+00, 4.0613e+05,
         1.1325e+00, 0.0000e+00, 1.3506e+00, 1.2295e+00],
        [1.2807e+00, 4.0905e+05, 1.2500e+00, 1.2693e+00, 1.2481e+00, 3.8748e+05,
         1.8300e+00, 1.3887e+00, 1.2897e+00, 3.9467e+05, 1.1855e+00, 4.0614e+05,
         1.2544e+00, 1.3506e+00, 0.0000e+00, 1.2732e+00],
        [1.1767e+00, 4.0903e+05, 1.1587e+00, 1.2788e+00, 1.1156e+00, 3.8742e+05,
         1.6434e+00, 1.2675e+00, 1.3431e+00, 3.9465e+05, 1.1640e+00, 4.0616e+05,
         1.1125e+00, 1.2295e+00, 1.2732e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0568e+00, 1.0596e+00, 1.1256e+00, 1.1302e+00, 1.1534e+00,
        1.1570e+00, 1.1767e+00, 1.1858e+00, 1.2807e+00, 1.3785e+00, 1.4160e+00,
        3.8744e+05, 3.9465e+05, 4.0616e+05, 4.0901e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 409005.3438, 409034.1562, 409035.2812, 409039.0625,
        409046.0312, 409046.1250, 409052.0938, 409053.8438, 409055.9062,
        409056.3438, 409059.8125, 409090.1250, 796013.4375, 823570.6250,
        827764.5000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.0981e+00, 1.1534e+00, 1.1587e+00, 1.1740e+00, 1.2060e+00,
        1.2204e+00, 1.2216e+00, 1.2500e+00, 1.2621e+00, 1.3244e+00, 1.6679e+00,
        3.8744e+05, 3.9468e+05, 4.0614e+05, 4.0906e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1654e+00, 1.1772e+00, 1.1830e+00, 1.1858e+00, 1.2587e+00,
        1.2621e+00, 1.2686e+00, 1.2693e+00, 1.2788e+00, 1.3283e+00, 1.7238e+00,
        3.8743e+05, 3.9467e+05, 4.0613e+05, 4.0906e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0596e+00, 1.0915e+00, 1.0981e+00, 1.1050e+00, 1.1152e+00,
        1.1156e+00, 1.1654e+00, 1.1991e+00, 1.2468e+00, 1.2481e+00, 1.4650e+00,
        3.8742e+05, 3.9467e+05, 4.0613e+05, 4.0904e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387419.3125, 387421.9375, 387424.2812, 387425.8750,
        387426.5000, 387428.5938, 387431.1875, 387432.8750, 387436.5000,
        387444.8750, 387446.4375, 387482.8750, 786127.6250, 795361.9375,
        796013.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1803e+00, 1.3654e+00, 1.3758e+00, 1.3785e+00, 1.4650e+00,
        1.6169e+00, 1.6434e+00, 1.6679e+00, 1.7238e+00, 1.8300e+00, 2.0128e+00,
        3.8743e+05, 3.9465e+05, 4.0612e+05, 4.0909e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0793e+00, 1.1152e+00, 1.1256e+00, 1.1274e+00, 1.1803e+00,
        1.2204e+00, 1.2315e+00, 1.2675e+00, 1.3283e+00, 1.3887e+00, 1.4711e+00,
        3.8743e+05, 3.9465e+05, 4.0615e+05, 4.0906e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1935e+00, 1.2216e+00, 1.2468e+00, 1.2587e+00, 1.2897e+00,
        1.3431e+00, 1.3946e+00, 1.4160e+00, 1.4711e+00, 1.5566e+00, 2.0128e+00,
        3.8743e+05, 3.9467e+05, 4.0618e+05, 4.0905e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394641.9375, 394645.3438, 394651.8438, 394652.0938,
        394654.6875, 394658.0000, 394666.3750, 394670.6562, 394673.6250,
        394673.7500, 394684.1250, 394687.7188, 795361.9375, 802343.7500,
        823570.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0915e+00, 1.1402e+00, 1.1570e+00, 1.1640e+00, 1.1740e+00,
        1.1772e+00, 1.1855e+00, 1.1935e+00, 1.2315e+00, 1.3030e+00, 1.6169e+00,
        3.8743e+05, 3.9464e+05, 4.0617e+05, 4.0905e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406123.0625, 406130.0625, 406131.6562, 406133.7500,
        406136.8438, 406139.6875, 406141.9062, 406148.6875, 406161.7500,
        406161.9375, 406169.1250, 406183.6875, 786127.6250, 802343.7500,
        827764.5000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.0568e+00, 1.0793e+00, 1.1050e+00, 1.1125e+00, 1.1325e+00,
        1.1402e+00, 1.1830e+00, 1.2060e+00, 1.2544e+00, 1.3758e+00, 1.3946e+00,
        3.8742e+05, 3.9466e+05, 4.0614e+05, 4.0904e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1274e+00, 1.1302e+00, 1.1325e+00, 1.1991e+00, 1.2295e+00,
        1.2686e+00, 1.3030e+00, 1.3244e+00, 1.3506e+00, 1.3654e+00, 1.5566e+00,
        3.8745e+05, 3.9469e+05, 4.0613e+05, 4.0905e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1855e+00, 1.2481e+00, 1.2500e+00, 1.2544e+00, 1.2693e+00,
        1.2732e+00, 1.2807e+00, 1.2897e+00, 1.3506e+00, 1.3887e+00, 1.8300e+00,
        3.8748e+05, 3.9467e+05, 4.0614e+05, 4.0905e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1125e+00, 1.1156e+00, 1.1587e+00, 1.1640e+00, 1.1767e+00,
        1.2295e+00, 1.2675e+00, 1.2732e+00, 1.2788e+00, 1.3431e+00, 1.6434e+00,
        3.8742e+05, 3.9465e+05, 4.0616e+05, 4.0903e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.17', '409047.84', '1.21', '1.24', '1.14', '387429.19', '1.52', '1.21', '1.34', '394658.81', '1.18', '406146.84', '1.16', '1.24', '1.28', '1.21']
estimated f for each client, fs: [5, 2, 4, 4, 5, 5, 5, 5, 5, 5, 5, 2, 5, 5, 4, 5]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 16, 8, 1, 9, 14, 11, 4, 6, 17, 2, 15, 12, 5, 7, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0127s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:36...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:36, End: 2025-07-22 16:00:36)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 8, 12, 20, 2, 16, 5, 10, 4, 14, 1, 17, 3, 11, 13, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2233e+00, 1.3535e+00, 3.8832e+05, 1.1985e+00, 4.0092e+05,
         1.4679e+00, 1.4162e+00, 1.5026e+00, 3.9494e+05, 1.2479e+00, 3.8328e+05,
         1.3695e+00, 1.8450e+00, 3.9767e+05, 3.9455e+05],
        [1.2233e+00, 0.0000e+00, 1.2286e+00, 3.8835e+05, 1.2296e+00, 4.0092e+05,
         1.3357e+00, 1.2577e+00, 1.2604e+00, 3.9495e+05, 1.3285e+00, 3.8326e+05,
         1.2350e+00, 1.5623e+00, 3.9768e+05, 3.9456e+05],
        [1.3535e+00, 1.2286e+00, 0.0000e+00, 3.8837e+05, 1.1822e+00, 4.0087e+05,
         1.1205e+00, 1.1154e+00, 1.1252e+00, 3.9495e+05, 1.2415e+00, 3.8326e+05,
         1.1475e+00, 1.2646e+00, 3.9765e+05, 3.9454e+05],
        [3.8832e+05, 3.8835e+05, 3.8837e+05, 0.0000e+00, 3.8835e+05, 8.0569e+05,
         3.8835e+05, 3.8833e+05, 3.8836e+05, 7.6173e+05, 3.8835e+05, 7.7678e+05,
         3.8837e+05, 3.8837e+05, 7.7507e+05, 7.8597e+05],
        [1.1985e+00, 1.2296e+00, 1.1822e+00, 3.8835e+05, 0.0000e+00, 4.0090e+05,
         1.2942e+00, 1.3036e+00, 1.2753e+00, 3.9497e+05, 1.2351e+00, 3.8327e+05,
         1.2159e+00, 1.5163e+00, 3.9766e+05, 3.9453e+05],
        [4.0092e+05, 4.0092e+05, 4.0087e+05, 8.0569e+05, 4.0090e+05, 0.0000e+00,
         4.0092e+05, 4.0092e+05, 4.0093e+05, 8.0562e+05, 4.0089e+05, 7.8046e+05,
         4.0093e+05, 4.0093e+05, 7.9515e+05, 8.0296e+05],
        [1.4679e+00, 1.3357e+00, 1.1205e+00, 3.8835e+05, 1.2942e+00, 4.0092e+05,
         0.0000e+00, 1.1750e+00, 1.1129e+00, 3.9495e+05, 1.2937e+00, 3.8327e+05,
         1.1931e+00, 1.2691e+00, 3.9767e+05, 3.9451e+05],
        [1.4162e+00, 1.2577e+00, 1.1154e+00, 3.8833e+05, 1.3036e+00, 4.0092e+05,
         1.1750e+00, 0.0000e+00, 1.1922e+00, 3.9497e+05, 1.2706e+00, 3.8327e+05,
         1.2294e+00, 1.3199e+00, 3.9767e+05, 3.9452e+05],
        [1.5026e+00, 1.2604e+00, 1.1252e+00, 3.8836e+05, 1.2753e+00, 4.0093e+05,
         1.1129e+00, 1.1922e+00, 0.0000e+00, 3.9496e+05, 1.3685e+00, 3.8325e+05,
         1.2488e+00, 1.0915e+00, 3.9765e+05, 3.9453e+05],
        [3.9494e+05, 3.9495e+05, 3.9495e+05, 7.6173e+05, 3.9497e+05, 8.0562e+05,
         3.9495e+05, 3.9497e+05, 3.9496e+05, 0.0000e+00, 3.9494e+05, 7.7772e+05,
         3.9494e+05, 3.9493e+05, 8.0260e+05, 7.8342e+05],
        [1.2479e+00, 1.3285e+00, 1.2415e+00, 3.8835e+05, 1.2351e+00, 4.0089e+05,
         1.2937e+00, 1.2706e+00, 1.3685e+00, 3.9494e+05, 0.0000e+00, 3.8326e+05,
         1.3620e+00, 1.6148e+00, 3.9767e+05, 3.9453e+05],
        [3.8328e+05, 3.8326e+05, 3.8326e+05, 7.7678e+05, 3.8327e+05, 7.8046e+05,
         3.8327e+05, 3.8327e+05, 3.8325e+05, 7.7772e+05, 3.8326e+05, 0.0000e+00,
         3.8327e+05, 3.8327e+05, 7.9031e+05, 7.8299e+05],
        [1.3695e+00, 1.2350e+00, 1.1475e+00, 3.8837e+05, 1.2159e+00, 4.0093e+05,
         1.1931e+00, 1.2294e+00, 1.2488e+00, 3.9494e+05, 1.3620e+00, 3.8327e+05,
         0.0000e+00, 1.4833e+00, 3.9767e+05, 3.9454e+05],
        [1.8450e+00, 1.5623e+00, 1.2646e+00, 3.8837e+05, 1.5163e+00, 4.0093e+05,
         1.2691e+00, 1.3199e+00, 1.0915e+00, 3.9493e+05, 1.6148e+00, 3.8327e+05,
         1.4833e+00, 0.0000e+00, 3.9765e+05, 3.9454e+05],
        [3.9767e+05, 3.9768e+05, 3.9765e+05, 7.7507e+05, 3.9766e+05, 7.9515e+05,
         3.9767e+05, 3.9767e+05, 3.9765e+05, 8.0260e+05, 3.9767e+05, 7.9031e+05,
         3.9767e+05, 3.9765e+05, 0.0000e+00, 8.2261e+05],
        [3.9455e+05, 3.9456e+05, 3.9454e+05, 7.8597e+05, 3.9453e+05, 8.0296e+05,
         3.9451e+05, 3.9452e+05, 3.9453e+05, 7.8342e+05, 3.9453e+05, 7.8299e+05,
         3.9454e+05, 3.9454e+05, 8.2261e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1985e+00, 1.2233e+00, 1.2479e+00, 1.3535e+00, 1.3695e+00,
        1.4162e+00, 1.4679e+00, 1.5026e+00, 1.8450e+00, 3.8328e+05, 3.8832e+05,
        3.9455e+05, 3.9494e+05, 3.9767e+05, 4.0092e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2233e+00, 1.2286e+00, 1.2296e+00, 1.2350e+00, 1.2577e+00,
        1.2604e+00, 1.3285e+00, 1.3357e+00, 1.5623e+00, 3.8326e+05, 3.8835e+05,
        3.9456e+05, 3.9495e+05, 3.9768e+05, 4.0092e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1154e+00, 1.1205e+00, 1.1252e+00, 1.1475e+00, 1.1822e+00,
        1.2286e+00, 1.2415e+00, 1.2646e+00, 1.3535e+00, 3.8326e+05, 3.8837e+05,
        3.9454e+05, 3.9495e+05, 3.9765e+05, 4.0087e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388322.2500, 388334.2500, 388346.2500, 388349.1562,
        388349.3125, 388349.8750, 388357.2188, 388368.8125, 388370.1250,
        388370.8750, 761734.6875, 775066.5625, 776779.2500, 785967.0000,
        805691.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1822e+00, 1.1985e+00, 1.2159e+00, 1.2296e+00, 1.2351e+00,
        1.2753e+00, 1.2942e+00, 1.3036e+00, 1.5163e+00, 3.8327e+05, 3.8835e+05,
        3.9453e+05, 3.9497e+05, 3.9766e+05, 4.0090e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400872.4062, 400888.0938, 400904.0625, 400915.9375,
        400919.3125, 400924.0312, 400924.4375, 400928.0938, 400928.5312,
        400934.7188, 780457.5000, 795148.2500, 802960.8125, 805624.0625,
        805691.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1129e+00, 1.1205e+00, 1.1750e+00, 1.1931e+00, 1.2691e+00,
        1.2937e+00, 1.2942e+00, 1.3357e+00, 1.4679e+00, 3.8327e+05, 3.8835e+05,
        3.9451e+05, 3.9495e+05, 3.9767e+05, 4.0092e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1154e+00, 1.1750e+00, 1.1922e+00, 1.2294e+00, 1.2577e+00,
        1.2706e+00, 1.3036e+00, 1.3199e+00, 1.4162e+00, 3.8327e+05, 3.8833e+05,
        3.9452e+05, 3.9497e+05, 3.9767e+05, 4.0092e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0915e+00, 1.1129e+00, 1.1252e+00, 1.1922e+00, 1.2488e+00,
        1.2604e+00, 1.2753e+00, 1.3685e+00, 1.5026e+00, 3.8325e+05, 3.8836e+05,
        3.9453e+05, 3.9496e+05, 3.9765e+05, 4.0093e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394926.2500, 394942.4688, 394942.8750, 394944.9688,
        394946.3125, 394948.2500, 394952.5625, 394959.4062, 394965.2500,
        394972.5000, 761734.6875, 777719.3125, 783418.8750, 802601.6250,
        805624.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2351e+00, 1.2415e+00, 1.2479e+00, 1.2706e+00, 1.2937e+00,
        1.3285e+00, 1.3620e+00, 1.3685e+00, 1.6148e+00, 3.8326e+05, 3.8835e+05,
        3.9453e+05, 3.9494e+05, 3.9767e+05, 4.0089e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383246.9375, 383261.3125, 383264.4688, 383264.9062,
        383268.3750, 383271.0000, 383272.7812, 383272.9688, 383273.8750,
        383283.1562, 776779.2500, 777719.3125, 780457.5000, 782994.4375,
        790308.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1475e+00, 1.1931e+00, 1.2159e+00, 1.2294e+00, 1.2350e+00,
        1.2488e+00, 1.3620e+00, 1.3695e+00, 1.4833e+00, 3.8327e+05, 3.8837e+05,
        3.9454e+05, 3.9494e+05, 3.9767e+05, 4.0093e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0915e+00, 1.2646e+00, 1.2691e+00, 1.3199e+00, 1.4833e+00,
        1.5163e+00, 1.5623e+00, 1.6148e+00, 1.8450e+00, 3.8327e+05, 3.8837e+05,
        3.9454e+05, 3.9493e+05, 3.9765e+05, 4.0093e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397645.1875, 397649.8750, 397654.8125, 397660.1250,
        397665.2188, 397667.1250, 397670.5000, 397672.0312, 397673.0625,
        397679.8438, 775066.5625, 790308.5625, 795148.2500, 802601.6250,
        822605.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394512.8750, 394523.4375, 394527.6875, 394530.1250,
        394533.3438, 394538.7812, 394543.8438, 394543.8750, 394553.5938,
        394557.1250, 782994.4375, 783418.8750, 785967.0000, 802960.8125,
        822605.5000])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38329.57', '38327.66', '38327.21', '388351.81', '38328.43', '400913.94', '38328.52', '38328.43', '38325.81', '394950.06', '38327.65', '383267.97', '38328.25', '38328.13', '397663.81', '394536.44']
estimated f for each client, fs: [6, 6, 6, 4, 6, 4, 6, 6, 6, 4, 6, 5, 6, 6, 4, 4]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 8, 12, 20, 2, 16, 5, 10, 4, 14, 1, 17, 3, 11, 13, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0117s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:36...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:36, End: 2025-07-22 16:00:36)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 17, 10, 8, 1, 9, 11, 19, 13, 7, 6, 18, 16, 15, 5, 3], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9566e+05, 1.3406e+00, 1.5796e+00, 1.6137e+00, 1.0989e+00,
         9.6741e-01, 3.8223e+05, 3.9775e+05, 1.7321e+00, 1.8532e+00, 3.9923e+05,
         3.9332e+05, 3.9761e+05, 1.1861e+00, 1.4418e+00],
        [3.9566e+05, 0.0000e+00, 3.9569e+05, 3.9567e+05, 3.9569e+05, 3.9566e+05,
         3.9568e+05, 7.8852e+05, 7.8906e+05, 3.9567e+05, 3.9566e+05, 7.9382e+05,
         7.9103e+05, 7.9823e+05, 3.9566e+05, 3.9569e+05],
        [1.3406e+00, 3.9569e+05, 0.0000e+00, 1.1461e+00, 1.1537e+00, 1.0239e+00,
         1.1466e+00, 3.8223e+05, 3.9776e+05, 1.1842e+00, 1.2782e+00, 3.9924e+05,
         3.9327e+05, 3.9761e+05, 1.0557e+00, 1.0824e+00],
        [1.5796e+00, 3.9567e+05, 1.1461e+00, 0.0000e+00, 1.1149e+00, 1.2146e+00,
         1.3302e+00, 3.8225e+05, 3.9776e+05, 1.1261e+00, 1.0575e+00, 3.9926e+05,
         3.9328e+05, 3.9761e+05, 1.1958e+00, 1.0707e+00],
        [1.6137e+00, 3.9569e+05, 1.1537e+00, 1.1149e+00, 0.0000e+00, 1.2364e+00,
         1.3167e+00, 3.8224e+05, 3.9775e+05, 1.1152e+00, 1.1006e+00, 3.9925e+05,
         3.9329e+05, 3.9762e+05, 1.1388e+00, 1.1116e+00],
        [1.0989e+00, 3.9566e+05, 1.0239e+00, 1.2146e+00, 1.2364e+00, 0.0000e+00,
         9.3324e-01, 3.8223e+05, 3.9777e+05, 1.3288e+00, 1.3685e+00, 3.9925e+05,
         3.9330e+05, 3.9761e+05, 1.0396e+00, 1.0967e+00],
        [9.6741e-01, 3.9568e+05, 1.1466e+00, 1.3302e+00, 1.3167e+00, 9.3324e-01,
         0.0000e+00, 3.8222e+05, 3.9775e+05, 1.4031e+00, 1.5463e+00, 3.9926e+05,
         3.9332e+05, 3.9763e+05, 1.0270e+00, 1.2352e+00],
        [3.8223e+05, 7.8852e+05, 3.8223e+05, 3.8225e+05, 3.8224e+05, 3.8223e+05,
         3.8222e+05, 0.0000e+00, 7.7229e+05, 3.8224e+05, 3.8228e+05, 7.7824e+05,
         7.8329e+05, 7.8478e+05, 3.8224e+05, 3.8224e+05],
        [3.9775e+05, 7.8906e+05, 3.9776e+05, 3.9776e+05, 3.9775e+05, 3.9777e+05,
         3.9775e+05, 7.7229e+05, 0.0000e+00, 3.9776e+05, 3.9777e+05, 8.1962e+05,
         7.8961e+05, 7.9513e+05, 3.9773e+05, 3.9775e+05],
        [1.7321e+00, 3.9567e+05, 1.1842e+00, 1.1261e+00, 1.1152e+00, 1.3288e+00,
         1.4031e+00, 3.8224e+05, 3.9776e+05, 0.0000e+00, 1.1615e+00, 3.9925e+05,
         3.9327e+05, 3.9759e+05, 1.2247e+00, 1.1390e+00],
        [1.8532e+00, 3.9566e+05, 1.2782e+00, 1.0575e+00, 1.1006e+00, 1.3685e+00,
         1.5463e+00, 3.8228e+05, 3.9777e+05, 1.1615e+00, 0.0000e+00, 3.9925e+05,
         3.9328e+05, 3.9764e+05, 1.3497e+00, 1.1797e+00],
        [3.9923e+05, 7.9382e+05, 3.9924e+05, 3.9926e+05, 3.9925e+05, 3.9925e+05,
         3.9926e+05, 7.7824e+05, 8.1962e+05, 3.9925e+05, 3.9925e+05, 0.0000e+00,
         7.9542e+05, 7.8684e+05, 3.9926e+05, 3.9923e+05],
        [3.9332e+05, 7.9103e+05, 3.9327e+05, 3.9328e+05, 3.9329e+05, 3.9330e+05,
         3.9332e+05, 7.8329e+05, 7.8961e+05, 3.9327e+05, 3.9328e+05, 7.9542e+05,
         0.0000e+00, 7.8309e+05, 3.9331e+05, 3.9328e+05],
        [3.9761e+05, 7.9823e+05, 3.9761e+05, 3.9761e+05, 3.9762e+05, 3.9761e+05,
         3.9763e+05, 7.8478e+05, 7.9513e+05, 3.9759e+05, 3.9764e+05, 7.8684e+05,
         7.8309e+05, 0.0000e+00, 3.9761e+05, 3.9763e+05],
        [1.1861e+00, 3.9566e+05, 1.0557e+00, 1.1958e+00, 1.1388e+00, 1.0396e+00,
         1.0270e+00, 3.8224e+05, 3.9773e+05, 1.2247e+00, 1.3497e+00, 3.9926e+05,
         3.9331e+05, 3.9761e+05, 0.0000e+00, 1.0993e+00],
        [1.4418e+00, 3.9569e+05, 1.0824e+00, 1.0707e+00, 1.1116e+00, 1.0967e+00,
         1.2352e+00, 3.8224e+05, 3.9775e+05, 1.1390e+00, 1.1797e+00, 3.9923e+05,
         3.9328e+05, 3.9763e+05, 1.0993e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.6741e-01, 1.0989e+00, 1.1861e+00, 1.3406e+00, 1.4418e+00,
        1.5796e+00, 1.6137e+00, 1.7321e+00, 1.8532e+00, 3.8223e+05, 3.9332e+05,
        3.9566e+05, 3.9761e+05, 3.9775e+05, 3.9923e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395657.9375, 395662.1562, 395663.9062, 395664.5000,
        395668.3750, 395672.0625, 395678.0938, 395686.5938, 395687.2500,
        395693.8125, 788519.6875, 789057.0000, 791034.2500, 793820.9375,
        798232.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0239e+00, 1.0557e+00, 1.0824e+00, 1.1461e+00, 1.1466e+00,
        1.1537e+00, 1.1842e+00, 1.2782e+00, 1.3406e+00, 3.8223e+05, 3.9327e+05,
        3.9569e+05, 3.9761e+05, 3.9776e+05, 3.9924e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0575e+00, 1.0707e+00, 1.1149e+00, 1.1261e+00, 1.1461e+00,
        1.1958e+00, 1.2146e+00, 1.3302e+00, 1.5796e+00, 3.8225e+05, 3.9328e+05,
        3.9567e+05, 3.9761e+05, 3.9776e+05, 3.9926e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1006e+00, 1.1116e+00, 1.1149e+00, 1.1152e+00, 1.1388e+00,
        1.1537e+00, 1.2364e+00, 1.3167e+00, 1.6137e+00, 3.8224e+05, 3.9329e+05,
        3.9569e+05, 3.9762e+05, 3.9775e+05, 3.9925e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.3324e-01, 1.0239e+00, 1.0396e+00, 1.0967e+00, 1.0989e+00,
        1.2146e+00, 1.2364e+00, 1.3288e+00, 1.3685e+00, 3.8223e+05, 3.9330e+05,
        3.9566e+05, 3.9761e+05, 3.9777e+05, 3.9925e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.3324e-01, 9.6741e-01, 1.0270e+00, 1.1466e+00, 1.2352e+00,
        1.3167e+00, 1.3302e+00, 1.4031e+00, 1.5463e+00, 3.8222e+05, 3.9332e+05,
        3.9568e+05, 3.9763e+05, 3.9775e+05, 3.9926e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382224.4062, 382226.4688, 382228.9688, 382232.1875,
        382240.7812, 382243.2500, 382244.2188, 382244.7812, 382252.7500,
        382280.7188, 772292.8125, 778235.1250, 783288.7500, 784780.6875,
        788519.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397734.1562, 397745.1875, 397752.2812, 397754.1562,
        397754.2188, 397756.5625, 397758.1250, 397764.5000, 397768.7188,
        397770.5625, 772292.8125, 789057.0000, 789609.5625, 795129.0000,
        819623.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1152e+00, 1.1261e+00, 1.1390e+00, 1.1615e+00, 1.1842e+00,
        1.2247e+00, 1.3288e+00, 1.4031e+00, 1.7321e+00, 3.8224e+05, 3.9327e+05,
        3.9567e+05, 3.9759e+05, 3.9776e+05, 3.9925e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0575e+00, 1.1006e+00, 1.1615e+00, 1.1797e+00, 1.2782e+00,
        1.3497e+00, 1.3685e+00, 1.5463e+00, 1.8532e+00, 3.8228e+05, 3.9328e+05,
        3.9566e+05, 3.9764e+05, 3.9777e+05, 3.9925e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399229.0625, 399231.9062, 399241.2188, 399248.0625,
        399248.6250, 399250.1562, 399252.0000, 399256.8125, 399258.7500,
        399264.0312, 778235.1250, 786841.6875, 793820.9375, 795417.5000,
        819623.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393269.2188, 393271.6875, 393276.3125, 393276.3438,
        393283.6250, 393291.9375, 393300.0312, 393306.0625, 393319.5938,
        393320.0625, 783094.1875, 783288.7500, 789609.5625, 791034.2500,
        795417.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397593.0938, 397606.3750, 397607.2188, 397607.5312,
        397612.6562, 397614.5625, 397615.7500, 397626.2812, 397631.5312,
        397636.1562, 783094.1875, 784780.6875, 786841.6875, 795129.0000,
        798232.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0270e+00, 1.0396e+00, 1.0557e+00, 1.0993e+00, 1.1388e+00,
        1.1861e+00, 1.1958e+00, 1.2247e+00, 1.3497e+00, 3.8224e+05, 3.9331e+05,
        3.9566e+05, 3.9761e+05, 3.9773e+05, 3.9926e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0707e+00, 1.0824e+00, 1.0967e+00, 1.0993e+00, 1.1116e+00,
        1.1390e+00, 1.1797e+00, 1.2352e+00, 1.4418e+00, 3.8224e+05, 3.9328e+05,
        3.9569e+05, 3.9763e+05, 3.9775e+05, 3.9923e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38224.18', '395673.44', '38223.70', '38226.36', '38225.42', '38224.26', '38223.54', '382241.84', '397755.84', '38225.22', '38229.26', '399248.06', '393291.44', '397615.12', '38225.45', '38225.52']
estimated f for each client, fs: [6, 4, 6, 6, 6, 6, 6, 5, 4, 6, 6, 4, 4, 4, 6, 6]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 17, 10, 8, 1, 9, 11, 19, 13, 7, 6, 18, 16, 15, 5, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0118s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:37...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:37, End: 2025-07-22 16:00:37)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 10, 2, 20, 14, 17, 11, 18, 13, 4, 12, 3, 1, 5, 9, 8], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0325e+00, 9.6109e-01, 3.8111e+05, 4.0179e+05, 3.8148e+05,
         1.7851e+00, 3.9011e+05, 3.8510e+05, 1.3152e+00, 1.0017e+00, 9.9163e-01,
         1.0138e+00, 1.1214e+00, 1.2041e+00, 1.0202e+00],
        [1.0325e+00, 0.0000e+00, 9.7510e-01, 3.8109e+05, 4.0179e+05, 3.8149e+05,
         1.3254e+00, 3.9011e+05, 3.8508e+05, 9.7756e-01, 8.7977e-01, 9.1931e-01,
         9.7763e-01, 9.1404e-01, 8.8838e-01, 1.0054e+00],
        [9.6109e-01, 9.7510e-01, 0.0000e+00, 3.8107e+05, 4.0179e+05, 3.8150e+05,
         1.5643e+00, 3.9010e+05, 3.8509e+05, 1.1403e+00, 9.1402e-01, 9.1401e-01,
         9.3891e-01, 1.0487e+00, 1.0019e+00, 9.7904e-01],
        [3.8111e+05, 3.8109e+05, 3.8107e+05, 0.0000e+00, 7.8897e+05, 7.3792e+05,
         3.8107e+05, 7.8161e+05, 7.7713e+05, 3.8108e+05, 3.8110e+05, 3.8109e+05,
         3.8108e+05, 3.8108e+05, 3.8109e+05, 3.8109e+05],
        [4.0179e+05, 4.0179e+05, 4.0179e+05, 7.8897e+05, 0.0000e+00, 7.8725e+05,
         4.0179e+05, 7.9940e+05, 7.8199e+05, 4.0179e+05, 4.0182e+05, 4.0180e+05,
         4.0181e+05, 4.0180e+05, 4.0179e+05, 4.0179e+05],
        [3.8148e+05, 3.8149e+05, 3.8150e+05, 7.3792e+05, 7.8725e+05, 0.0000e+00,
         3.8151e+05, 7.7587e+05, 7.5214e+05, 3.8151e+05, 3.8151e+05, 3.8148e+05,
         3.8146e+05, 3.8149e+05, 3.8151e+05, 3.8147e+05],
        [1.7851e+00, 1.3254e+00, 1.5643e+00, 3.8107e+05, 4.0179e+05, 3.8151e+05,
         0.0000e+00, 3.9013e+05, 3.8505e+05, 8.1598e-01, 1.3450e+00, 1.5249e+00,
         1.6601e+00, 1.2918e+00, 1.0450e+00, 1.7128e+00],
        [3.9011e+05, 3.9011e+05, 3.9010e+05, 7.8161e+05, 7.9940e+05, 7.7587e+05,
         3.9013e+05, 0.0000e+00, 7.8640e+05, 3.9013e+05, 3.9012e+05, 3.9011e+05,
         3.9010e+05, 3.9012e+05, 3.9012e+05, 3.9010e+05],
        [3.8510e+05, 3.8508e+05, 3.8509e+05, 7.7713e+05, 7.8199e+05, 7.5214e+05,
         3.8505e+05, 7.8640e+05, 0.0000e+00, 3.8507e+05, 3.8508e+05, 3.8508e+05,
         3.8509e+05, 3.8505e+05, 3.8510e+05, 3.8508e+05],
        [1.3152e+00, 9.7756e-01, 1.1403e+00, 3.8108e+05, 4.0179e+05, 3.8151e+05,
         8.1598e-01, 3.9013e+05, 3.8507e+05, 0.0000e+00, 9.6438e-01, 1.0562e+00,
         1.1923e+00, 9.3174e-01, 8.1074e-01, 1.2329e+00],
        [1.0017e+00, 8.7977e-01, 9.1402e-01, 3.8110e+05, 4.0182e+05, 3.8151e+05,
         1.3450e+00, 3.9012e+05, 3.8508e+05, 9.6438e-01, 0.0000e+00, 8.8585e-01,
         9.5738e-01, 9.2866e-01, 9.2964e-01, 9.8265e-01],
        [9.9163e-01, 9.1931e-01, 9.1401e-01, 3.8109e+05, 4.0180e+05, 3.8148e+05,
         1.5249e+00, 3.9011e+05, 3.8508e+05, 1.0562e+00, 8.8585e-01, 0.0000e+00,
         9.8310e-01, 9.7331e-01, 9.4549e-01, 9.4572e-01],
        [1.0138e+00, 9.7763e-01, 9.3891e-01, 3.8108e+05, 4.0181e+05, 3.8146e+05,
         1.6601e+00, 3.9010e+05, 3.8509e+05, 1.1923e+00, 9.5738e-01, 9.8310e-01,
         0.0000e+00, 1.0186e+00, 1.0693e+00, 1.0023e+00],
        [1.1214e+00, 9.1404e-01, 1.0487e+00, 3.8108e+05, 4.0180e+05, 3.8149e+05,
         1.2918e+00, 3.9012e+05, 3.8505e+05, 9.3174e-01, 9.2866e-01, 9.7331e-01,
         1.0186e+00, 0.0000e+00, 9.6011e-01, 1.0866e+00],
        [1.2041e+00, 8.8838e-01, 1.0019e+00, 3.8109e+05, 4.0179e+05, 3.8151e+05,
         1.0450e+00, 3.9012e+05, 3.8510e+05, 8.1074e-01, 9.2964e-01, 9.4549e-01,
         1.0693e+00, 9.6011e-01, 0.0000e+00, 1.0760e+00],
        [1.0202e+00, 1.0054e+00, 9.7904e-01, 3.8109e+05, 4.0179e+05, 3.8147e+05,
         1.7128e+00, 3.9010e+05, 3.8508e+05, 1.2329e+00, 9.8265e-01, 9.4572e-01,
         1.0023e+00, 1.0866e+00, 1.0760e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.6109e-01, 9.9163e-01, 1.0017e+00, 1.0138e+00, 1.0202e+00,
        1.0325e+00, 1.1214e+00, 1.2041e+00, 1.3152e+00, 1.7851e+00, 3.8111e+05,
        3.8148e+05, 3.8510e+05, 3.9011e+05, 4.0179e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7977e-01, 8.8838e-01, 9.1404e-01, 9.1931e-01, 9.7510e-01,
        9.7756e-01, 9.7763e-01, 1.0054e+00, 1.0325e+00, 1.3254e+00, 3.8109e+05,
        3.8149e+05, 3.8508e+05, 3.9011e+05, 4.0179e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1401e-01, 9.1402e-01, 9.3891e-01, 9.6109e-01, 9.7510e-01,
        9.7904e-01, 1.0019e+00, 1.0487e+00, 1.1403e+00, 1.5643e+00, 3.8107e+05,
        3.8150e+05, 3.8509e+05, 3.9010e+05, 4.0179e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381065.8438, 381071.1875, 381079.0625, 381081.7188,
        381083.7812, 381087.4688, 381088.2500, 381088.8438, 381091.5000,
        381100.0000, 381109.8125, 737919.1875, 777128.0625, 781605.5000,
        788966.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 401785.5312, 401787.2500, 401787.3125, 401787.3750,
        401788.6250, 401792.8438, 401794.6250, 401800.8438, 401804.1250,
        401814.0625, 401822.0938, 781990.8750, 787247.7500, 788966.3125,
        799396.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 381459.3438, 381474.5312, 381480.5938, 381483.1875,
        381485.5312, 381488.7188, 381498.2188, 381508.6875, 381510.1562,
        381512.1250, 381513.3750, 737919.1875, 752143.2500, 775873.1250,
        787247.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.1598e-01, 1.0450e+00, 1.2918e+00, 1.3254e+00, 1.3450e+00,
        1.5249e+00, 1.5643e+00, 1.6601e+00, 1.7128e+00, 1.7851e+00, 3.8107e+05,
        3.8151e+05, 3.8505e+05, 3.9013e+05, 4.0179e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390096.6875, 390097.1562, 390104.0312, 390107.3750,
        390107.6250, 390110.3438, 390117.8438, 390120.8125, 390122.2188,
        390128.5938, 390132.5625, 775873.1250, 781605.5000, 786396.1250,
        799396.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 385050.5625, 385054.0000, 385067.4375, 385081.0938,
        385081.4062, 385081.8125, 385082.5312, 385086.0625, 385093.8750,
        385096.0938, 385103.3125, 752143.2500, 777128.0625, 781990.8750,
        786396.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.1074e-01, 8.1598e-01, 9.3174e-01, 9.6438e-01, 9.7756e-01,
        1.0562e+00, 1.1403e+00, 1.1923e+00, 1.2329e+00, 1.3152e+00, 3.8108e+05,
        3.8151e+05, 3.8507e+05, 3.9013e+05, 4.0179e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7977e-01, 8.8585e-01, 9.1402e-01, 9.2866e-01, 9.2964e-01,
        9.5738e-01, 9.6438e-01, 9.8265e-01, 1.0017e+00, 1.3450e+00, 3.8110e+05,
        3.8151e+05, 3.8508e+05, 3.9012e+05, 4.0182e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8585e-01, 9.1401e-01, 9.1931e-01, 9.4549e-01, 9.4572e-01,
        9.7331e-01, 9.8310e-01, 9.9163e-01, 1.0562e+00, 1.5249e+00, 3.8109e+05,
        3.8148e+05, 3.8508e+05, 3.9011e+05, 4.0180e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.3891e-01, 9.5738e-01, 9.7763e-01, 9.8310e-01, 1.0023e+00,
        1.0138e+00, 1.0186e+00, 1.0693e+00, 1.1923e+00, 1.6601e+00, 3.8108e+05,
        3.8146e+05, 3.8509e+05, 3.9010e+05, 4.0181e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1404e-01, 9.2866e-01, 9.3174e-01, 9.6011e-01, 9.7331e-01,
        1.0186e+00, 1.0487e+00, 1.0866e+00, 1.1214e+00, 1.2918e+00, 3.8108e+05,
        3.8149e+05, 3.8505e+05, 3.9012e+05, 4.0180e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.1074e-01, 8.8838e-01, 9.2964e-01, 9.4549e-01, 9.6011e-01,
        1.0019e+00, 1.0450e+00, 1.0693e+00, 1.0760e+00, 1.2041e+00, 3.8109e+05,
        3.8151e+05, 3.8510e+05, 3.9012e+05, 4.0179e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4572e-01, 9.7904e-01, 9.8265e-01, 1.0023e+00, 1.0054e+00,
        1.0202e+00, 1.0760e+00, 1.0866e+00, 1.2329e+00, 1.7128e+00, 3.8109e+05,
        3.8147e+05, 3.8508e+05, 3.9010e+05, 4.0179e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.14', '0.99', '1.04', '381086.12', '401796.78', '381492.22', '1.41', '390113.19', '385079.81', '1.04', '0.98', '1.01', '1.08', '1.03', '0.99', '1.10']
estimated f for each client, fs: [5, 5, 5, 3, 3, 3, 5, 3, 3, 5, 5, 5, 5, 5, 5, 5]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 10, 2, 20, 14, 17, 11, 18, 13, 4, 12, 3, 1, 5, 9, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0122s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:38...
global Accuracy on shared test data: 70.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 87 176]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:38, End: 2025-07-22 16:00:38)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 17, 9, 11, 19, 7, 5, 3, 1, 18, 12, 10, 4, 16, 15, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8288e+05, 1.0510e+00, 1.3698e+00, 4.0485e+05, 1.0319e+00,
         1.0676e+00, 9.9204e-01, 1.0344e+00, 3.8486e+05, 1.3277e+00, 1.0346e+00,
         1.2200e+00, 3.9162e+05, 3.7052e+05, 9.8654e-01],
        [3.8288e+05, 0.0000e+00, 3.8289e+05, 3.8290e+05, 7.7943e+05, 3.8291e+05,
         3.8290e+05, 3.8289e+05, 3.8289e+05, 7.5039e+05, 3.8288e+05, 3.8289e+05,
         3.8288e+05, 7.5319e+05, 7.4250e+05, 3.8288e+05],
        [1.0510e+00, 3.8289e+05, 0.0000e+00, 8.6879e-01, 4.0488e+05, 1.1670e+00,
         9.4572e-01, 9.7168e-01, 1.0811e+00, 3.8487e+05, 9.9745e-01, 8.8596e-01,
         8.4318e-01, 3.9161e+05, 3.7051e+05, 1.2094e+00],
        [1.3698e+00, 3.8290e+05, 8.6879e-01, 0.0000e+00, 4.0486e+05, 1.5016e+00,
         1.0214e+00, 1.2698e+00, 1.3597e+00, 3.8484e+05, 8.4652e-01, 1.0836e+00,
         6.8485e-01, 3.9162e+05, 3.7053e+05, 1.6372e+00],
        [4.0485e+05, 7.7943e+05, 4.0488e+05, 4.0486e+05, 0.0000e+00, 4.0485e+05,
         4.0483e+05, 4.0486e+05, 4.0484e+05, 7.9618e+05, 4.0486e+05, 4.0485e+05,
         4.0484e+05, 8.0416e+05, 7.7252e+05, 4.0488e+05],
        [1.0319e+00, 3.8291e+05, 1.1670e+00, 1.5016e+00, 4.0485e+05, 0.0000e+00,
         1.1196e+00, 1.0868e+00, 1.0499e+00, 3.8485e+05, 1.4371e+00, 1.0603e+00,
         1.3615e+00, 3.9161e+05, 3.7054e+05, 1.0668e+00],
        [1.0676e+00, 3.8290e+05, 9.4572e-01, 1.0214e+00, 4.0483e+05, 1.1196e+00,
         0.0000e+00, 1.0304e+00, 1.0380e+00, 3.8486e+05, 1.0474e+00, 9.2862e-01,
         9.7003e-01, 3.9160e+05, 3.7053e+05, 1.2513e+00],
        [9.9204e-01, 3.8289e+05, 9.7168e-01, 1.2698e+00, 4.0486e+05, 1.0868e+00,
         1.0304e+00, 0.0000e+00, 1.0627e+00, 3.8486e+05, 1.2138e+00, 1.0338e+00,
         1.1268e+00, 3.9162e+05, 3.7053e+05, 1.1055e+00],
        [1.0344e+00, 3.8289e+05, 1.0811e+00, 1.3597e+00, 4.0484e+05, 1.0499e+00,
         1.0380e+00, 1.0627e+00, 0.0000e+00, 3.8487e+05, 1.3226e+00, 1.0347e+00,
         1.2088e+00, 3.9159e+05, 3.7051e+05, 1.0208e+00],
        [3.8486e+05, 7.5039e+05, 3.8487e+05, 3.8484e+05, 7.9618e+05, 3.8485e+05,
         3.8486e+05, 3.8486e+05, 3.8487e+05, 0.0000e+00, 3.8488e+05, 3.8487e+05,
         3.8484e+05, 7.6821e+05, 7.4615e+05, 3.8486e+05],
        [1.3277e+00, 3.8288e+05, 9.9745e-01, 8.4652e-01, 4.0486e+05, 1.4371e+00,
         1.0474e+00, 1.2138e+00, 1.3226e+00, 3.8488e+05, 0.0000e+00, 1.1067e+00,
         8.9052e-01, 3.9159e+05, 3.7053e+05, 1.5538e+00],
        [1.0346e+00, 3.8289e+05, 8.8596e-01, 1.0836e+00, 4.0485e+05, 1.0603e+00,
         9.2862e-01, 1.0338e+00, 1.0347e+00, 3.8487e+05, 1.1067e+00, 0.0000e+00,
         1.0119e+00, 3.9162e+05, 3.7053e+05, 1.1257e+00],
        [1.2200e+00, 3.8288e+05, 8.4318e-01, 6.8485e-01, 4.0484e+05, 1.3615e+00,
         9.7003e-01, 1.1268e+00, 1.2088e+00, 3.8484e+05, 8.9052e-01, 1.0119e+00,
         0.0000e+00, 3.9161e+05, 3.7052e+05, 1.4558e+00],
        [3.9162e+05, 7.5319e+05, 3.9161e+05, 3.9162e+05, 8.0416e+05, 3.9161e+05,
         3.9160e+05, 3.9162e+05, 3.9159e+05, 7.6821e+05, 3.9159e+05, 3.9162e+05,
         3.9161e+05, 0.0000e+00, 7.4426e+05, 3.9161e+05],
        [3.7052e+05, 7.4250e+05, 3.7051e+05, 3.7053e+05, 7.7252e+05, 3.7054e+05,
         3.7053e+05, 3.7053e+05, 3.7051e+05, 7.4615e+05, 3.7053e+05, 3.7053e+05,
         3.7052e+05, 7.4426e+05, 0.0000e+00, 3.7048e+05],
        [9.8654e-01, 3.8288e+05, 1.2094e+00, 1.6372e+00, 4.0488e+05, 1.0668e+00,
         1.2513e+00, 1.1055e+00, 1.0208e+00, 3.8486e+05, 1.5538e+00, 1.1257e+00,
         1.4558e+00, 3.9161e+05, 3.7048e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.8654e-01, 9.9204e-01, 1.0319e+00, 1.0344e+00, 1.0346e+00,
        1.0510e+00, 1.0676e+00, 1.2200e+00, 1.3277e+00, 1.3698e+00, 3.7052e+05,
        3.8288e+05, 3.8486e+05, 3.9162e+05, 4.0485e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382877.0312, 382878.4062, 382879.6250, 382884.6250,
        382888.8125, 382889.6875, 382893.1250, 382894.6875, 382898.9062,
        382899.6250, 382913.6250, 742503.6250, 750394.4375, 753189.0000,
        779426.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.4318e-01, 8.6879e-01, 8.8596e-01, 9.4572e-01, 9.7168e-01,
        9.9745e-01, 1.0510e+00, 1.0811e+00, 1.1670e+00, 1.2094e+00, 3.7051e+05,
        3.8289e+05, 3.8487e+05, 3.9161e+05, 4.0488e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.8485e-01, 8.4652e-01, 8.6879e-01, 1.0214e+00, 1.0836e+00,
        1.2698e+00, 1.3597e+00, 1.3698e+00, 1.5016e+00, 1.6372e+00, 3.7053e+05,
        3.8290e+05, 3.8484e+05, 3.9162e+05, 4.0486e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404825.5625, 404836.7188, 404843.9375, 404845.5625,
        404845.7500, 404849.5625, 404855.2500, 404857.4375, 404860.8125,
        404879.7500, 404882.1875, 772515.7500, 779426.9375, 796182.5000,
        804160.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.0319e+00, 1.0499e+00, 1.0603e+00, 1.0668e+00, 1.0868e+00,
        1.1196e+00, 1.1670e+00, 1.3615e+00, 1.4371e+00, 1.5016e+00, 3.7054e+05,
        3.8291e+05, 3.8485e+05, 3.9161e+05, 4.0485e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2862e-01, 9.4572e-01, 9.7003e-01, 1.0214e+00, 1.0304e+00,
        1.0380e+00, 1.0474e+00, 1.0676e+00, 1.1196e+00, 1.2513e+00, 3.7053e+05,
        3.8290e+05, 3.8486e+05, 3.9160e+05, 4.0483e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7168e-01, 9.9204e-01, 1.0304e+00, 1.0338e+00, 1.0627e+00,
        1.0868e+00, 1.1055e+00, 1.1268e+00, 1.2138e+00, 1.2698e+00, 3.7053e+05,
        3.8289e+05, 3.8486e+05, 3.9162e+05, 4.0486e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0208e+00, 1.0344e+00, 1.0347e+00, 1.0380e+00, 1.0499e+00,
        1.0627e+00, 1.0811e+00, 1.2088e+00, 1.3226e+00, 1.3597e+00, 3.7051e+05,
        3.8289e+05, 3.8487e+05, 3.9159e+05, 4.0484e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384841.1875, 384842.8438, 384847.1875, 384855.5312,
        384858.5625, 384861.0625, 384862.6562, 384866.5938, 384871.4062,
        384874.7812, 384877.4688, 746148.8125, 750394.4375, 768214.5000,
        796182.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.4652e-01, 8.9052e-01, 9.9745e-01, 1.0474e+00, 1.1067e+00,
        1.2138e+00, 1.3226e+00, 1.3277e+00, 1.4371e+00, 1.5538e+00, 3.7053e+05,
        3.8288e+05, 3.8488e+05, 3.9159e+05, 4.0486e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8596e-01, 9.2862e-01, 1.0119e+00, 1.0338e+00, 1.0346e+00,
        1.0347e+00, 1.0603e+00, 1.0836e+00, 1.1067e+00, 1.1257e+00, 3.7053e+05,
        3.8289e+05, 3.8487e+05, 3.9162e+05, 4.0485e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.8485e-01, 8.4318e-01, 8.9052e-01, 9.7003e-01, 1.0119e+00,
        1.1268e+00, 1.2088e+00, 1.2200e+00, 1.3615e+00, 1.4558e+00, 3.7052e+05,
        3.8288e+05, 3.8484e+05, 3.9161e+05, 4.0484e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391592.9062, 391593.3750, 391601.3125, 391605.9062,
        391607.1875, 391608.1250, 391610.3750, 391620.5000, 391623.5000,
        391623.9062, 391625.0000, 744258.8750, 753189.0000, 768214.5000,
        804160.5000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 370484.8750, 370508.1875, 370513.5625, 370516.9375,
        370518.7188, 370525.6875, 370526.5000, 370529.3438, 370530.9375,
        370532.4375, 370536.3750, 742503.6250, 744258.8750, 746148.8125,
        772515.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8654e-01, 1.0208e+00, 1.0668e+00, 1.1055e+00, 1.1257e+00,
        1.2094e+00, 1.2513e+00, 1.4558e+00, 1.5538e+00, 1.6372e+00, 3.7048e+05,
        3.8288e+05, 3.8486e+05, 3.9161e+05, 4.0488e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.11', '382890.69', '1.00', '1.16', '404852.97', '1.19', '1.04', '1.09', '1.12', '384859.91', '1.17', '1.03', '1.08', '391610.22', '370518.72', '1.24']
estimated f for each client, fs: [5, 3, 5, 5, 3, 5, 5, 5, 5, 3, 5, 5, 5, 3, 5, 5]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 17, 9, 11, 19, 7, 5, 3, 1, 18, 12, 10, 4, 16, 15, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0124s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:38...
global Accuracy on shared test data: 72.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 75 188]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:38, End: 2025-07-22 16:00:38)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 14, 18, 16, 5, 7, 4, 15, 6, 3, 2, 19, 8, 11, 17, 10], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.6298e+05, 7.7032e+05, 8.1356e+05, 4.0235e+05, 4.0235e+05,
         4.0234e+05, 7.9629e+05, 4.0237e+05, 4.0236e+05, 4.0235e+05, 7.7344e+05,
         4.0236e+05, 4.0233e+05, 7.9568e+05, 4.0235e+05],
        [7.6298e+05, 0.0000e+00, 7.6694e+05, 7.8216e+05, 3.9455e+05, 3.9455e+05,
         3.9456e+05, 7.7080e+05, 3.9452e+05, 3.9455e+05, 3.9450e+05, 7.5790e+05,
         3.9455e+05, 3.9454e+05, 7.7279e+05, 3.9455e+05],
        [7.7032e+05, 7.6694e+05, 0.0000e+00, 7.7050e+05, 3.7275e+05, 3.7275e+05,
         3.7274e+05, 7.7340e+05, 3.7274e+05, 3.7271e+05, 3.7273e+05, 7.4776e+05,
         3.7272e+05, 3.7273e+05, 7.4619e+05, 3.7273e+05],
        [8.1356e+05, 7.8216e+05, 7.7050e+05, 0.0000e+00, 3.9045e+05, 3.9046e+05,
         3.9049e+05, 7.9886e+05, 3.9045e+05, 3.9046e+05, 3.9046e+05, 7.7438e+05,
         3.9047e+05, 3.9046e+05, 7.5985e+05, 3.9046e+05],
        [4.0235e+05, 3.9455e+05, 3.7275e+05, 3.9045e+05, 0.0000e+00, 1.0993e+00,
         9.4911e-01, 3.8922e+05, 1.1764e+00, 9.5514e-01, 1.0227e+00, 3.7719e+05,
         1.0734e+00, 1.0604e+00, 3.7892e+05, 9.1037e-01],
        [4.0235e+05, 3.9455e+05, 3.7275e+05, 3.9046e+05, 1.0993e+00, 0.0000e+00,
         1.3896e+00, 3.8920e+05, 1.0601e+00, 1.0940e+00, 1.0149e+00, 3.7718e+05,
         1.0829e+00, 1.5326e+00, 3.7891e+05, 1.0671e+00],
        [4.0234e+05, 3.9456e+05, 3.7274e+05, 3.9049e+05, 9.4911e-01, 1.3896e+00,
         0.0000e+00, 3.8923e+05, 1.4414e+00, 1.1093e+00, 1.1836e+00, 3.7716e+05,
         1.2700e+00, 7.5797e-01, 3.7892e+05, 1.0481e+00],
        [7.9629e+05, 7.7080e+05, 7.7340e+05, 7.9886e+05, 3.8922e+05, 3.8920e+05,
         3.8923e+05, 0.0000e+00, 3.8920e+05, 3.8922e+05, 3.8920e+05, 7.6497e+05,
         3.8922e+05, 3.8924e+05, 7.6743e+05, 3.8922e+05],
        [4.0237e+05, 3.9452e+05, 3.7274e+05, 3.9045e+05, 1.1764e+00, 1.0601e+00,
         1.4414e+00, 3.8920e+05, 0.0000e+00, 1.1077e+00, 1.0026e+00, 3.7717e+05,
         9.9610e-01, 1.6269e+00, 3.7888e+05, 1.0968e+00],
        [4.0236e+05, 3.9455e+05, 3.7271e+05, 3.9046e+05, 9.5514e-01, 1.0940e+00,
         1.1093e+00, 3.8922e+05, 1.1077e+00, 0.0000e+00, 9.8229e-01, 3.7719e+05,
         1.0424e+00, 1.2585e+00, 3.7892e+05, 9.7006e-01],
        [4.0235e+05, 3.9450e+05, 3.7273e+05, 3.9046e+05, 1.0227e+00, 1.0149e+00,
         1.1836e+00, 3.8920e+05, 1.0026e+00, 9.8229e-01, 0.0000e+00, 3.7718e+05,
         1.0428e+00, 1.3126e+00, 3.7891e+05, 1.0299e+00],
        [7.7344e+05, 7.5790e+05, 7.4776e+05, 7.7438e+05, 3.7719e+05, 3.7718e+05,
         3.7716e+05, 7.6497e+05, 3.7717e+05, 3.7719e+05, 3.7718e+05, 0.0000e+00,
         3.7719e+05, 3.7716e+05, 7.5308e+05, 3.7716e+05],
        [4.0236e+05, 3.9455e+05, 3.7272e+05, 3.9047e+05, 1.0734e+00, 1.0829e+00,
         1.2700e+00, 3.8922e+05, 9.9610e-01, 1.0424e+00, 1.0428e+00, 3.7719e+05,
         0.0000e+00, 1.4498e+00, 3.7891e+05, 1.0346e+00],
        [4.0233e+05, 3.9454e+05, 3.7273e+05, 3.9046e+05, 1.0604e+00, 1.5326e+00,
         7.5797e-01, 3.8924e+05, 1.6269e+00, 1.2585e+00, 1.3126e+00, 3.7716e+05,
         1.4498e+00, 0.0000e+00, 3.7893e+05, 1.1248e+00],
        [7.9568e+05, 7.7279e+05, 7.4619e+05, 7.5985e+05, 3.7892e+05, 3.7891e+05,
         3.7892e+05, 7.6743e+05, 3.7888e+05, 3.7892e+05, 3.7891e+05, 7.5308e+05,
         3.7891e+05, 3.7893e+05, 0.0000e+00, 3.7891e+05],
        [4.0235e+05, 3.9455e+05, 3.7273e+05, 3.9046e+05, 9.1037e-01, 1.0671e+00,
         1.0481e+00, 3.8922e+05, 1.0968e+00, 9.7006e-01, 1.0299e+00, 3.7716e+05,
         1.0346e+00, 1.1248e+00, 3.7891e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 402332.8438, 402339.5938, 402348.3750, 402349.4688,
        402351.5000, 402352.6562, 402356.0625, 402362.9062, 402365.1250,
        762981.6250, 770320.9375, 773436.1250, 795680.1875, 796294.2500,
        813564.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394505.0000, 394515.7188, 394541.6562, 394546.0938,
        394547.1250, 394550.6875, 394551.3125, 394551.5000, 394556.0938,
        757902.0625, 762981.6250, 766940.8750, 770799.5000, 772789.1250,
        782157.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 372712.7812, 372723.9688, 372729.6562, 372732.2812,
        372733.0000, 372736.3750, 372743.9375, 372748.4062, 372751.2500,
        746193.8125, 747755.0000, 766940.8750, 770320.9375, 770501.7500,
        773401.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390445.8125, 390452.7188, 390455.6250, 390458.5625,
        390459.7500, 390462.2188, 390462.5000, 390469.5000, 390488.2812,
        759852.1250, 770501.7500, 774376.7500, 782157.1875, 798855.4375,
        813564.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1037e-01, 9.4911e-01, 9.5514e-01, 1.0227e+00, 1.0604e+00,
        1.0734e+00, 1.0993e+00, 1.1764e+00, 3.7275e+05, 3.7719e+05, 3.7892e+05,
        3.8922e+05, 3.9045e+05, 3.9455e+05, 4.0235e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0149e+00, 1.0601e+00, 1.0671e+00, 1.0829e+00, 1.0940e+00,
        1.0993e+00, 1.3896e+00, 1.5326e+00, 3.7275e+05, 3.7718e+05, 3.7891e+05,
        3.8920e+05, 3.9046e+05, 3.9455e+05, 4.0235e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.5797e-01, 9.4911e-01, 1.0481e+00, 1.1093e+00, 1.1836e+00,
        1.2700e+00, 1.3896e+00, 1.4414e+00, 3.7274e+05, 3.7716e+05, 3.7892e+05,
        3.8923e+05, 3.9049e+05, 3.9456e+05, 4.0234e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389196.0625, 389198.3750, 389199.9375, 389217.9062,
        389218.1562, 389222.2500, 389223.0625, 389230.6250, 389235.2500,
        764970.2500, 767432.1875, 770799.5000, 773401.8750, 796294.2500,
        798855.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.9610e-01, 1.0026e+00, 1.0601e+00, 1.0968e+00, 1.1077e+00,
        1.1764e+00, 1.4414e+00, 1.6269e+00, 3.7274e+05, 3.7717e+05, 3.7888e+05,
        3.8920e+05, 3.9045e+05, 3.9452e+05, 4.0237e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.5514e-01, 9.7006e-01, 9.8229e-01, 1.0424e+00, 1.0940e+00,
        1.1077e+00, 1.1093e+00, 1.2585e+00, 3.7271e+05, 3.7719e+05, 3.7892e+05,
        3.8922e+05, 3.9046e+05, 3.9455e+05, 4.0236e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8229e-01, 1.0026e+00, 1.0149e+00, 1.0227e+00, 1.0299e+00,
        1.0428e+00, 1.1836e+00, 1.3126e+00, 3.7273e+05, 3.7718e+05, 3.7891e+05,
        3.8920e+05, 3.9046e+05, 3.9450e+05, 4.0235e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377163.9688, 377164.2812, 377164.6875, 377174.5000,
        377175.5625, 377176.2500, 377185.0938, 377187.3750, 377193.4062,
        747755.0000, 753077.9375, 757902.0625, 764970.2500, 773436.1250,
        774376.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.9610e-01, 1.0346e+00, 1.0424e+00, 1.0428e+00, 1.0734e+00,
        1.0829e+00, 1.2700e+00, 1.4498e+00, 3.7272e+05, 3.7719e+05, 3.7891e+05,
        3.8922e+05, 3.9047e+05, 3.9455e+05, 4.0236e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.5797e-01, 1.0604e+00, 1.1248e+00, 1.2585e+00, 1.3126e+00,
        1.4498e+00, 1.5326e+00, 1.6269e+00, 3.7273e+05, 3.7716e+05, 3.7893e+05,
        3.8924e+05, 3.9046e+05, 3.9454e+05, 4.0233e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 378885.0000, 378907.7188, 378908.9375, 378909.8125,
        378911.5312, 378917.5625, 378918.0938, 378924.7188, 378934.5312,
        746193.8125, 753077.9375, 759852.1250, 767432.1875, 772789.1250,
        795680.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1037e-01, 9.7006e-01, 1.0299e+00, 1.0346e+00, 1.0481e+00,
        1.0671e+00, 1.0968e+00, 1.1248e+00, 3.7273e+05, 3.7716e+05, 3.7891e+05,
        3.8922e+05, 3.9046e+05, 3.9455e+05, 4.0235e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['438414.00', '430876.69', '410080.56', '427400.69', '74995.29', '74993.40', '74991.73', '426791.19', '74992.05', '74990.65', '74991.71', '414234.00', '74992.04', '74990.45', '415641.16', '74990.46']
estimated f for each client, fs: [5, 5, 6, 5, 7, 7, 7, 5, 7, 7, 7, 5, 7, 7, 5, 7]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 14, 18, 16, 5, 7, 4, 15, 6, 3, 2, 19, 8, 11, 17, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0135s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:39...
global Accuracy on shared test data: 70.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[161  76]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:39, End: 2025-07-22 16:00:39)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 14, 18, 13, 12, 6, 1, 17, 11, 19, 2, 16, 15, 5, 7, 10], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.9284e+05, 7.7525e+05, 7.9435e+05, 3.9655e+05, 3.9654e+05,
         3.9654e+05, 7.7914e+05, 3.9657e+05, 7.8471e+05, 3.9653e+05, 7.9233e+05,
         7.8495e+05, 3.9658e+05, 3.9656e+05, 3.9656e+05],
        [7.9284e+05, 0.0000e+00, 7.8916e+05, 8.0200e+05, 3.9518e+05, 3.9519e+05,
         3.9518e+05, 7.9376e+05, 3.9517e+05, 7.7799e+05, 3.9518e+05, 7.8410e+05,
         7.7538e+05, 3.9516e+05, 3.9518e+05, 3.9518e+05],
        [7.7525e+05, 7.8916e+05, 0.0000e+00, 7.9361e+05, 3.8443e+05, 3.8442e+05,
         3.8439e+05, 7.9992e+05, 3.8441e+05, 7.5591e+05, 3.8442e+05, 7.9621e+05,
         7.7192e+05, 3.8441e+05, 3.8444e+05, 3.8444e+05],
        [7.9435e+05, 8.0200e+05, 7.9361e+05, 0.0000e+00, 4.0837e+05, 4.0842e+05,
         4.0842e+05, 7.9236e+05, 4.0838e+05, 7.8642e+05, 4.0841e+05, 8.1235e+05,
         8.0778e+05, 4.0839e+05, 4.0841e+05, 4.0841e+05],
        [3.9655e+05, 3.9518e+05, 3.8443e+05, 4.0837e+05, 0.0000e+00, 1.0884e+00,
         9.5203e-01, 4.0406e+05, 1.0284e+00, 3.8413e+05, 8.8065e-01, 3.9404e+05,
         3.9316e+05, 7.7087e-01, 9.7854e-01, 7.9406e-01],
        [3.9654e+05, 3.9519e+05, 3.8442e+05, 4.0842e+05, 1.0884e+00, 0.0000e+00,
         8.9106e-01, 4.0405e+05, 1.9093e+00, 3.8415e+05, 8.8845e-01, 3.9407e+05,
         3.9320e+05, 1.0556e+00, 9.8987e-01, 9.6714e-01],
        [3.9654e+05, 3.9518e+05, 3.8439e+05, 4.0842e+05, 9.5203e-01, 8.9106e-01,
         0.0000e+00, 4.0406e+05, 1.6772e+00, 3.8417e+05, 8.8169e-01, 3.9403e+05,
         3.9319e+05, 9.0776e-01, 9.3958e-01, 8.7105e-01],
        [7.7914e+05, 7.9376e+05, 7.9992e+05, 7.9236e+05, 4.0406e+05, 4.0405e+05,
         4.0406e+05, 0.0000e+00, 4.0404e+05, 7.8906e+05, 4.0405e+05, 7.9463e+05,
         7.9227e+05, 4.0406e+05, 4.0406e+05, 4.0406e+05],
        [3.9657e+05, 3.9517e+05, 3.8441e+05, 4.0838e+05, 1.0284e+00, 1.9093e+00,
         1.6772e+00, 4.0404e+05, 0.0000e+00, 3.8412e+05, 1.5616e+00, 3.9405e+05,
         3.9316e+05, 1.2856e+00, 1.7757e+00, 1.3307e+00],
        [7.8471e+05, 7.7799e+05, 7.5591e+05, 7.8642e+05, 3.8413e+05, 3.8415e+05,
         3.8417e+05, 7.8906e+05, 3.8412e+05, 0.0000e+00, 3.8414e+05, 7.7605e+05,
         7.8701e+05, 3.8414e+05, 3.8413e+05, 3.8417e+05],
        [3.9653e+05, 3.9518e+05, 3.8442e+05, 4.0841e+05, 8.8065e-01, 8.8845e-01,
         8.8169e-01, 4.0405e+05, 1.5616e+00, 3.8414e+05, 0.0000e+00, 3.9404e+05,
         3.9320e+05, 9.1785e-01, 8.9307e-01, 8.7223e-01],
        [7.9233e+05, 7.8410e+05, 7.9621e+05, 8.1235e+05, 3.9404e+05, 3.9407e+05,
         3.9403e+05, 7.9463e+05, 3.9405e+05, 7.7605e+05, 3.9404e+05, 0.0000e+00,
         7.8386e+05, 3.9403e+05, 3.9403e+05, 3.9405e+05],
        [7.8495e+05, 7.7538e+05, 7.7192e+05, 8.0778e+05, 3.9316e+05, 3.9320e+05,
         3.9319e+05, 7.9227e+05, 3.9316e+05, 7.8701e+05, 3.9320e+05, 7.8386e+05,
         0.0000e+00, 3.9319e+05, 3.9322e+05, 3.9321e+05],
        [3.9658e+05, 3.9516e+05, 3.8441e+05, 4.0839e+05, 7.7087e-01, 1.0556e+00,
         9.0776e-01, 4.0406e+05, 1.2856e+00, 3.8414e+05, 9.1785e-01, 3.9403e+05,
         3.9319e+05, 0.0000e+00, 9.6894e-01, 7.9214e-01],
        [3.9656e+05, 3.9518e+05, 3.8444e+05, 4.0841e+05, 9.7854e-01, 9.8987e-01,
         9.3958e-01, 4.0406e+05, 1.7757e+00, 3.8413e+05, 8.9307e-01, 3.9403e+05,
         3.9322e+05, 9.6894e-01, 0.0000e+00, 9.0064e-01],
        [3.9656e+05, 3.9518e+05, 3.8444e+05, 4.0841e+05, 7.9406e-01, 9.6714e-01,
         8.7105e-01, 4.0406e+05, 1.3307e+00, 3.8417e+05, 8.7223e-01, 3.9405e+05,
         3.9321e+05, 7.9214e-01, 9.0064e-01, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 396525.8125, 396535.6250, 396538.8125, 396552.4375,
        396558.6250, 396559.8750, 396567.6562, 396582.2500, 775246.5000,
        779135.6250, 784714.5000, 784948.0000, 792333.0000, 792843.8750,
        794350.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395164.0625, 395170.0000, 395175.6875, 395176.0000,
        395180.0625, 395183.5938, 395184.2812, 395188.5000, 775380.5000,
        777985.2500, 784097.3750, 789161.0625, 792843.8750, 793758.0000,
        801996.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384388.8750, 384413.3125, 384414.7500, 384421.4062,
        384424.6875, 384434.3750, 384441.1250, 384444.2500, 755910.3125,
        771919.5625, 775246.5000, 789161.0625, 793606.6250, 796207.1250,
        799918.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 408374.5625, 408376.0625, 408391.3750, 408406.4688,
        408409.1250, 408413.5000, 408417.2500, 408419.2500, 786423.9375,
        792355.0625, 793606.6250, 794350.0000, 801996.5000, 807778.5000,
        812346.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.7087e-01, 7.9406e-01, 8.8065e-01, 9.5203e-01, 9.7854e-01,
        1.0284e+00, 1.0884e+00, 3.8413e+05, 3.8443e+05, 3.9316e+05, 3.9404e+05,
        3.9518e+05, 3.9655e+05, 4.0406e+05, 4.0837e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8845e-01, 8.9106e-01, 9.6714e-01, 9.8987e-01, 1.0556e+00,
        1.0884e+00, 1.9093e+00, 3.8415e+05, 3.8442e+05, 3.9320e+05, 3.9407e+05,
        3.9519e+05, 3.9654e+05, 4.0405e+05, 4.0842e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7105e-01, 8.8169e-01, 8.9106e-01, 9.0776e-01, 9.3958e-01,
        9.5203e-01, 1.6772e+00, 3.8417e+05, 3.8439e+05, 3.9319e+05, 3.9403e+05,
        3.9518e+05, 3.9654e+05, 4.0406e+05, 4.0842e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404039.2188, 404045.1250, 404046.1250, 404055.5625,
        404061.6562, 404061.8125, 404063.8125, 404064.1562, 779135.6250,
        789055.6250, 792269.5000, 792355.0625, 793758.0000, 794630.5000,
        799918.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0284e+00, 1.2856e+00, 1.3307e+00, 1.5616e+00, 1.6772e+00,
        1.7757e+00, 1.9093e+00, 3.8412e+05, 3.8441e+05, 3.9316e+05, 3.9405e+05,
        3.9517e+05, 3.9657e+05, 4.0404e+05, 4.0838e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384118.3125, 384127.0625, 384132.0625, 384142.8125,
        384143.9062, 384154.7188, 384170.9062, 384172.1250, 755910.3125,
        776045.0625, 777985.2500, 784714.5000, 786423.9375, 787011.5000,
        789055.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7223e-01, 8.8065e-01, 8.8169e-01, 8.8845e-01, 8.9307e-01,
        9.1785e-01, 1.5616e+00, 3.8414e+05, 3.8442e+05, 3.9320e+05, 3.9404e+05,
        3.9518e+05, 3.9653e+05, 4.0405e+05, 4.0841e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394031.2812, 394031.7500, 394033.8438, 394036.3125,
        394036.4688, 394049.1875, 394051.2188, 394066.9375, 776045.0625,
        783862.5000, 784097.3750, 792333.0000, 794630.5000, 796207.1250,
        812346.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393161.0938, 393163.5000, 393190.5625, 393193.2500,
        393196.4375, 393198.4062, 393206.3750, 393223.6562, 771919.5625,
        775380.5000, 783862.5000, 784948.0000, 787011.5000, 792269.5000,
        807778.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.7087e-01, 7.9214e-01, 9.0776e-01, 9.1785e-01, 9.6894e-01,
        1.0556e+00, 1.2856e+00, 3.8414e+05, 3.8441e+05, 3.9319e+05, 3.9403e+05,
        3.9516e+05, 3.9658e+05, 4.0406e+05, 4.0839e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9307e-01, 9.0064e-01, 9.3958e-01, 9.6894e-01, 9.7854e-01,
        9.8987e-01, 1.7757e+00, 3.8413e+05, 3.8444e+05, 3.9322e+05, 3.9403e+05,
        3.9518e+05, 3.9656e+05, 4.0406e+05, 4.0841e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.9214e-01, 7.9406e-01, 8.7105e-01, 8.7223e-01, 9.0064e-01,
        9.6714e-01, 1.3307e+00, 3.8417e+05, 3.8444e+05, 3.9321e+05, 3.9405e+05,
        3.9518e+05, 3.9656e+05, 4.0406e+05, 4.0841e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['472680.31', '471478.81', '460321.31', '484598.59', '116173.40', '116178.36', '116175.88', '480062.84', '116170.71', '460511.69', '116177.06', '471224.44', '469283.31', '116175.62', '116180.23', '116182.48']
estimated f for each client, fs: [5, 5, 6, 5, 8, 8, 8, 5, 8, 6, 8, 5, 5, 8, 8, 8]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 14, 18, 13, 12, 6, 1, 17, 11, 19, 2, 16, 15, 5, 7, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0142s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:39...
global Accuracy on shared test data: 71.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[156  81]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:39, End: 2025-07-22 16:00:39)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 9, 10, 11, 16, 17, 2, 14, 15, 7, 19, 20, 18, 1, 8, 5], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0574e+00, 9.1156e-01, 1.7161e+00, 3.8718e+05, 3.8637e+05,
         8.3133e-01, 4.0996e+05, 3.9959e+05, 9.0358e-01, 3.9323e+05, 4.0245e+05,
         3.8778e+05, 8.2568e-01, 8.0696e-01, 9.4390e-01],
        [1.0574e+00, 0.0000e+00, 6.8858e-01, 6.6018e-01, 3.8715e+05, 3.8637e+05,
         8.1915e-01, 4.0998e+05, 3.9956e+05, 1.0264e+00, 3.9323e+05, 4.0245e+05,
         3.8778e+05, 9.0915e-01, 9.3995e-01, 7.4827e-01],
        [9.1156e-01, 6.8858e-01, 0.0000e+00, 1.1888e+00, 3.8718e+05, 3.8635e+05,
         8.1894e-01, 4.0999e+05, 3.9954e+05, 8.6102e-01, 3.9326e+05, 4.0244e+05,
         3.8778e+05, 8.2406e-01, 8.4477e-01, 7.4838e-01],
        [1.7161e+00, 6.6018e-01, 1.1888e+00, 0.0000e+00, 3.8716e+05, 3.8641e+05,
         1.3685e+00, 4.0998e+05, 3.9955e+05, 1.6620e+00, 3.9324e+05, 4.0247e+05,
         3.8777e+05, 1.4890e+00, 1.5586e+00, 1.1671e+00],
        [3.8718e+05, 3.8715e+05, 3.8718e+05, 3.8716e+05, 0.0000e+00, 7.6491e+05,
         3.8718e+05, 8.0108e+05, 7.9927e+05, 3.8718e+05, 7.6564e+05, 7.8962e+05,
         7.5788e+05, 3.8716e+05, 3.8716e+05, 3.8719e+05],
        [3.8637e+05, 3.8637e+05, 3.8635e+05, 3.8641e+05, 7.6491e+05, 0.0000e+00,
         3.8637e+05, 8.0663e+05, 7.7888e+05, 3.8637e+05, 7.6852e+05, 7.7181e+05,
         7.7577e+05, 3.8637e+05, 3.8635e+05, 3.8636e+05],
        [8.3133e-01, 8.1915e-01, 8.1894e-01, 1.3685e+00, 3.8718e+05, 3.8637e+05,
         0.0000e+00, 4.0997e+05, 3.9958e+05, 8.2541e-01, 3.9324e+05, 4.0244e+05,
         3.8774e+05, 7.8114e-01, 8.3690e-01, 8.3805e-01],
        [4.0996e+05, 4.0998e+05, 4.0999e+05, 4.0998e+05, 8.0108e+05, 8.0663e+05,
         4.0997e+05, 0.0000e+00, 8.2293e+05, 4.0998e+05, 8.0490e+05, 8.2126e+05,
         8.0825e+05, 4.0997e+05, 4.0999e+05, 4.0996e+05],
        [3.9959e+05, 3.9956e+05, 3.9954e+05, 3.9955e+05, 7.9927e+05, 7.7888e+05,
         3.9958e+05, 8.2293e+05, 0.0000e+00, 3.9952e+05, 8.0993e+05, 8.2308e+05,
         7.6853e+05, 3.9958e+05, 3.9955e+05, 3.9956e+05],
        [9.0358e-01, 1.0264e+00, 8.6102e-01, 1.6620e+00, 3.8718e+05, 3.8637e+05,
         8.2541e-01, 4.0998e+05, 3.9952e+05, 0.0000e+00, 3.9325e+05, 4.0244e+05,
         3.8776e+05, 8.5230e-01, 8.7474e-01, 8.6757e-01],
        [3.9323e+05, 3.9323e+05, 3.9326e+05, 3.9324e+05, 7.6564e+05, 7.6852e+05,
         3.9324e+05, 8.0490e+05, 8.0993e+05, 3.9325e+05, 0.0000e+00, 8.0357e+05,
         7.8662e+05, 3.9327e+05, 3.9325e+05, 3.9326e+05],
        [4.0245e+05, 4.0245e+05, 4.0244e+05, 4.0247e+05, 7.8962e+05, 7.7181e+05,
         4.0244e+05, 8.2126e+05, 8.2308e+05, 4.0244e+05, 8.0357e+05, 0.0000e+00,
         7.8037e+05, 4.0244e+05, 4.0244e+05, 4.0245e+05],
        [3.8778e+05, 3.8778e+05, 3.8778e+05, 3.8777e+05, 7.5788e+05, 7.7577e+05,
         3.8774e+05, 8.0825e+05, 7.6853e+05, 3.8776e+05, 7.8662e+05, 7.8037e+05,
         0.0000e+00, 3.8778e+05, 3.8776e+05, 3.8775e+05],
        [8.2568e-01, 9.0915e-01, 8.2406e-01, 1.4890e+00, 3.8716e+05, 3.8637e+05,
         7.8114e-01, 4.0997e+05, 3.9958e+05, 8.5230e-01, 3.9327e+05, 4.0244e+05,
         3.8778e+05, 0.0000e+00, 8.5139e-01, 8.2199e-01],
        [8.0696e-01, 9.3995e-01, 8.4477e-01, 1.5586e+00, 3.8716e+05, 3.8635e+05,
         8.3690e-01, 4.0999e+05, 3.9955e+05, 8.7474e-01, 3.9325e+05, 4.0244e+05,
         3.8776e+05, 8.5139e-01, 0.0000e+00, 8.3304e-01],
        [9.4390e-01, 7.4827e-01, 7.4838e-01, 1.1671e+00, 3.8719e+05, 3.8636e+05,
         8.3805e-01, 4.0996e+05, 3.9956e+05, 8.6757e-01, 3.9326e+05, 4.0245e+05,
         3.8775e+05, 8.2199e-01, 8.3304e-01, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.0696e-01, 8.2568e-01, 8.3133e-01, 9.0358e-01, 9.1156e-01,
        9.4390e-01, 1.0574e+00, 1.7161e+00, 3.8637e+05, 3.8718e+05, 3.8778e+05,
        3.9323e+05, 3.9959e+05, 4.0245e+05, 4.0996e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.6018e-01, 6.8858e-01, 7.4827e-01, 8.1915e-01, 9.0915e-01,
        9.3995e-01, 1.0264e+00, 1.0574e+00, 3.8637e+05, 3.8715e+05, 3.8778e+05,
        3.9323e+05, 3.9956e+05, 4.0245e+05, 4.0998e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.8858e-01, 7.4838e-01, 8.1894e-01, 8.2406e-01, 8.4477e-01,
        8.6102e-01, 9.1156e-01, 1.1888e+00, 3.8635e+05, 3.8718e+05, 3.8778e+05,
        3.9326e+05, 3.9954e+05, 4.0244e+05, 4.0999e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.6018e-01, 1.1671e+00, 1.1888e+00, 1.3685e+00, 1.4890e+00,
        1.5586e+00, 1.6620e+00, 1.7161e+00, 3.8641e+05, 3.8716e+05, 3.8777e+05,
        3.9324e+05, 3.9955e+05, 4.0247e+05, 4.0998e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387150.3125, 387159.4688, 387163.8125, 387164.8750,
        387176.0938, 387178.1250, 387178.5000, 387181.2500, 387185.1875,
        757878.3750, 764907.3750, 765642.2500, 789615.7500, 799273.3750,
        801075.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386353.9688, 386354.9688, 386357.8750, 386365.7188,
        386368.1562, 386371.4375, 386373.3750, 386373.5625, 386413.8125,
        764907.3750, 768520.6875, 771811.4375, 775769.3750, 778881.3125,
        806628.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.8114e-01, 8.1894e-01, 8.1915e-01, 8.2541e-01, 8.3133e-01,
        8.3690e-01, 8.3805e-01, 1.3685e+00, 3.8637e+05, 3.8718e+05, 3.8774e+05,
        3.9324e+05, 3.9958e+05, 4.0244e+05, 4.0997e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 409958.1562, 409961.2812, 409971.4375, 409974.3125,
        409976.1250, 409983.0000, 409984.3750, 409986.9688, 409990.0000,
        801075.8125, 804899.3125, 806628.5000, 808246.8750, 821260.3750,
        822932.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399520.1875, 399537.0938, 399550.0938, 399554.1250,
        399556.1250, 399556.1562, 399581.5625, 399583.8125, 399590.3125,
        768533.3750, 778881.3125, 799273.3750, 809930.5625, 822932.5000,
        823083.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.2541e-01, 8.5230e-01, 8.6102e-01, 8.6757e-01, 8.7474e-01,
        9.0358e-01, 1.0264e+00, 1.6620e+00, 3.8637e+05, 3.8718e+05, 3.8776e+05,
        3.9325e+05, 3.9952e+05, 4.0244e+05, 4.0998e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393226.6250, 393229.5938, 393235.8750, 393240.7188,
        393246.3125, 393247.0625, 393259.0000, 393261.4062, 393266.3750,
        765642.2500, 768520.6875, 786617.8750, 803567.6250, 804899.3125,
        809930.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402435.1250, 402436.9688, 402439.0000, 402439.0312,
        402443.5000, 402445.9688, 402447.4688, 402448.5625, 402466.9688,
        771811.4375, 780374.6250, 789615.7500, 803567.6250, 821260.3750,
        823083.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387743.6875, 387752.8125, 387755.2500, 387756.2188,
        387767.0000, 387778.2812, 387781.1562, 387783.5312, 387784.4688,
        757878.3750, 768533.3750, 775769.3750, 780374.6250, 786617.8750,
        808246.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.8114e-01, 8.2199e-01, 8.2406e-01, 8.2568e-01, 8.5139e-01,
        8.5230e-01, 9.0915e-01, 1.4890e+00, 3.8637e+05, 3.8716e+05, 3.8778e+05,
        3.9327e+05, 3.9958e+05, 4.0244e+05, 4.0997e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0696e-01, 8.3304e-01, 8.3690e-01, 8.4477e-01, 8.5139e-01,
        8.7474e-01, 9.3995e-01, 1.5586e+00, 3.8635e+05, 3.8716e+05, 3.8776e+05,
        3.9325e+05, 3.9955e+05, 4.0244e+05, 4.0999e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.4827e-01, 7.4838e-01, 8.2199e-01, 8.3304e-01, 8.3805e-01,
        8.6757e-01, 9.4390e-01, 1.1671e+00, 3.8636e+05, 3.8719e+05, 3.8775e+05,
        3.9326e+05, 3.9956e+05, 4.0245e+05, 4.0996e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77355.42', '77352.86', '77353.80', '77358.41', '424241.59', '424224.06', '77355.91', '449086.16', '436456.31', '77355.48', '430485.50', '439381.41', '424778.09', '77354.56', '77352.53', '77355.00']
estimated f for each client, fs: [7, 7, 7, 7, 5, 5, 7, 5, 5, 7, 5, 5, 5, 7, 7, 7]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [6, 9, 10, 11, 16, 17, 2, 14, 15, 7, 19, 20, 18, 1, 8, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:40...
global Accuracy on shared test data: 71.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 79 184]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:40, End: 2025-07-22 16:00:40)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 4, 15, 6, 13, 5, 11, 10, 12, 19, 7, 16, 3, 9, 18, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9718e+05, 7.8506e+05, 3.9717e+05, 8.0051e+05, 3.9719e+05,
         3.9719e+05, 3.9719e+05, 3.9717e+05, 7.8644e+05, 3.9718e+05, 7.9712e+05,
         3.9718e+05, 3.9718e+05, 7.8448e+05, 7.9508e+05],
        [3.9718e+05, 0.0000e+00, 3.9859e+05, 1.1753e+00, 3.8609e+05, 8.3038e-01,
         6.1563e-01, 8.6646e-01, 6.9785e-01, 3.9201e+05, 1.1996e+00, 3.9559e+05,
         9.7053e-01, 6.5459e-01, 3.9362e+05, 3.8583e+05],
        [7.8506e+05, 3.9859e+05, 0.0000e+00, 3.9859e+05, 7.9637e+05, 3.9857e+05,
         3.9858e+05, 3.9858e+05, 3.9857e+05, 8.0584e+05, 3.9856e+05, 8.0810e+05,
         3.9858e+05, 3.9859e+05, 7.8586e+05, 7.6520e+05],
        [3.9717e+05, 1.1753e+00, 3.9859e+05, 0.0000e+00, 3.8609e+05, 1.0140e+00,
         1.5545e+00, 9.4417e-01, 1.0526e+00, 3.9199e+05, 9.4307e-01, 3.9556e+05,
         9.7333e-01, 1.2068e+00, 3.9362e+05, 3.8584e+05],
        [8.0051e+05, 3.8609e+05, 7.9637e+05, 3.8609e+05, 0.0000e+00, 3.8607e+05,
         3.8609e+05, 3.8607e+05, 3.8609e+05, 7.7756e+05, 3.8607e+05, 7.7253e+05,
         3.8607e+05, 3.8607e+05, 7.9531e+05, 7.6958e+05],
        [3.9719e+05, 8.3038e-01, 3.9857e+05, 1.0140e+00, 3.8607e+05, 0.0000e+00,
         1.0143e+00, 8.1026e-01, 7.7366e-01, 3.9200e+05, 9.7454e-01, 3.9560e+05,
         8.8305e-01, 8.7872e-01, 3.9360e+05, 3.8584e+05],
        [3.9719e+05, 6.1563e-01, 3.9858e+05, 1.5545e+00, 3.8609e+05, 1.0143e+00,
         0.0000e+00, 1.0528e+00, 7.6288e-01, 3.9201e+05, 1.6087e+00, 3.9557e+05,
         1.2475e+00, 5.2319e-01, 3.9363e+05, 3.8583e+05],
        [3.9719e+05, 8.6646e-01, 3.9858e+05, 9.4417e-01, 3.8607e+05, 8.1026e-01,
         1.0528e+00, 0.0000e+00, 7.8945e-01, 3.9200e+05, 9.3215e-01, 3.9560e+05,
         8.6793e-01, 8.0375e-01, 3.9359e+05, 3.8582e+05],
        [3.9717e+05, 6.9785e-01, 3.9857e+05, 1.0526e+00, 3.8609e+05, 7.7366e-01,
         7.6288e-01, 7.8945e-01, 0.0000e+00, 3.9201e+05, 1.0732e+00, 3.9557e+05,
         8.6053e-01, 6.9239e-01, 3.9361e+05, 3.8584e+05],
        [7.8644e+05, 3.9201e+05, 8.0584e+05, 3.9199e+05, 7.7756e+05, 3.9200e+05,
         3.9201e+05, 3.9200e+05, 3.9201e+05, 0.0000e+00, 3.9200e+05, 7.7008e+05,
         3.9200e+05, 3.9200e+05, 8.0584e+05, 7.6473e+05],
        [3.9718e+05, 1.1996e+00, 3.9856e+05, 9.4307e-01, 3.8607e+05, 9.7454e-01,
         1.6087e+00, 9.3215e-01, 1.0732e+00, 3.9200e+05, 0.0000e+00, 3.9553e+05,
         9.9555e-01, 1.2612e+00, 3.9358e+05, 3.8587e+05],
        [7.9712e+05, 3.9559e+05, 8.0810e+05, 3.9556e+05, 7.7253e+05, 3.9560e+05,
         3.9557e+05, 3.9560e+05, 3.9557e+05, 7.7008e+05, 3.9553e+05, 0.0000e+00,
         3.9556e+05, 3.9559e+05, 7.7944e+05, 7.8956e+05],
        [3.9718e+05, 9.7053e-01, 3.9858e+05, 9.7333e-01, 3.8607e+05, 8.8305e-01,
         1.2475e+00, 8.6793e-01, 8.6053e-01, 3.9200e+05, 9.9555e-01, 3.9556e+05,
         0.0000e+00, 9.3708e-01, 3.9361e+05, 3.8583e+05],
        [3.9718e+05, 6.5459e-01, 3.9859e+05, 1.2068e+00, 3.8607e+05, 8.7872e-01,
         5.2319e-01, 8.0375e-01, 6.9239e-01, 3.9200e+05, 1.2612e+00, 3.9559e+05,
         9.3708e-01, 0.0000e+00, 3.9362e+05, 3.8584e+05],
        [7.8448e+05, 3.9362e+05, 7.8586e+05, 3.9362e+05, 7.9531e+05, 3.9360e+05,
         3.9363e+05, 3.9359e+05, 3.9361e+05, 8.0584e+05, 3.9358e+05, 7.7944e+05,
         3.9361e+05, 3.9362e+05, 0.0000e+00, 7.8294e+05],
        [7.9508e+05, 3.8583e+05, 7.6520e+05, 3.8584e+05, 7.6958e+05, 3.8584e+05,
         3.8583e+05, 3.8582e+05, 3.8584e+05, 7.6473e+05, 3.8587e+05, 7.8956e+05,
         3.8583e+05, 3.8584e+05, 7.8294e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 397171.5312, 397173.7188, 397176.8125, 397178.8750,
        397182.4375, 397184.1875, 397186.5000, 397187.0000, 397190.7500,
        784477.6250, 785060.5000, 786442.0000, 795075.8125, 797117.1250,
        800510.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.1563e-01, 6.5459e-01, 6.9785e-01, 8.3038e-01, 8.6646e-01,
        9.7053e-01, 1.1753e+00, 1.1996e+00, 3.8583e+05, 3.8609e+05, 3.9201e+05,
        3.9362e+05, 3.9559e+05, 3.9718e+05, 3.9859e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398563.4375, 398571.6875, 398574.4688, 398579.2500,
        398584.3125, 398584.5938, 398587.9062, 398593.2500, 398594.0000,
        765198.2500, 785060.5000, 785858.1875, 796370.2500, 805838.6250,
        808104.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4307e-01, 9.4417e-01, 9.7333e-01, 1.0140e+00, 1.0526e+00,
        1.1753e+00, 1.2068e+00, 1.5545e+00, 3.8584e+05, 3.8609e+05, 3.9199e+05,
        3.9362e+05, 3.9556e+05, 3.9717e+05, 3.9859e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386066.6875, 386067.1875, 386068.4375, 386069.5625,
        386074.7500, 386086.2188, 386086.6562, 386087.3125, 386090.3125,
        769575.1250, 772531.3750, 777556.3125, 795309.8125, 796370.2500,
        800510.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.7366e-01, 8.1026e-01, 8.3038e-01, 8.7872e-01, 8.8305e-01,
        9.7454e-01, 1.0140e+00, 1.0143e+00, 3.8584e+05, 3.8607e+05, 3.9200e+05,
        3.9360e+05, 3.9560e+05, 3.9719e+05, 3.9857e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.2319e-01, 6.1563e-01, 7.6288e-01, 1.0143e+00, 1.0528e+00,
        1.2475e+00, 1.5545e+00, 1.6087e+00, 3.8583e+05, 3.8609e+05, 3.9201e+05,
        3.9363e+05, 3.9557e+05, 3.9719e+05, 3.9858e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.8945e-01, 8.0375e-01, 8.1026e-01, 8.6646e-01, 8.6793e-01,
        9.3215e-01, 9.4417e-01, 1.0528e+00, 3.8582e+05, 3.8607e+05, 3.9200e+05,
        3.9359e+05, 3.9560e+05, 3.9719e+05, 3.9858e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.9239e-01, 6.9785e-01, 7.6288e-01, 7.7366e-01, 7.8945e-01,
        8.6053e-01, 1.0526e+00, 1.0732e+00, 3.8584e+05, 3.8609e+05, 3.9201e+05,
        3.9361e+05, 3.9557e+05, 3.9717e+05, 3.9857e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391991.2500, 391995.5625, 391996.1562, 391997.8438,
        392000.9375, 392002.8125, 392008.2812, 392013.7188, 392014.9062,
        764726.6875, 770081.1250, 777556.3125, 786442.0000, 805838.6250,
        805840.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.3215e-01, 9.4307e-01, 9.7454e-01, 9.9555e-01, 1.0732e+00,
        1.1996e+00, 1.2612e+00, 1.6087e+00, 3.8587e+05, 3.8607e+05, 3.9200e+05,
        3.9358e+05, 3.9553e+05, 3.9718e+05, 3.9856e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395534.2812, 395557.0938, 395559.6250, 395567.1562,
        395573.7500, 395586.5000, 395592.1875, 395598.5625, 395599.3438,
        770081.1250, 772531.3750, 779443.1250, 789560.0625, 797117.1250,
        808104.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6053e-01, 8.6793e-01, 8.8305e-01, 9.3708e-01, 9.7053e-01,
        9.7333e-01, 9.9555e-01, 1.2475e+00, 3.8583e+05, 3.8607e+05, 3.9200e+05,
        3.9361e+05, 3.9556e+05, 3.9718e+05, 3.9858e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.2319e-01, 6.5459e-01, 6.9239e-01, 8.0375e-01, 8.7872e-01,
        9.3708e-01, 1.2068e+00, 1.2612e+00, 3.8584e+05, 3.8607e+05, 3.9200e+05,
        3.9362e+05, 3.9559e+05, 3.9718e+05, 3.9859e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393580.1562, 393592.0000, 393602.5938, 393608.7188,
        393611.9688, 393616.5625, 393621.7500, 393623.6562, 393626.3125,
        779443.1250, 782937.0000, 784477.6250, 785858.1875, 795309.8125,
        805840.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385820.8750, 385827.3438, 385830.0938, 385833.4375,
        385836.7188, 385837.9688, 385839.9375, 385844.9062, 385865.5938,
        764726.6875, 765198.2500, 769575.1250, 782937.0000, 789560.0625,
        795075.8125])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['435911.00', '77192.71', '435243.09', '77193.91', '424427.25', '77192.67', '77192.20', '77189.76', '77193.07', '429274.81', '77194.12', '433025.00', '77190.63', '77191.20', '432192.69', '423726.34']
estimated f for each client, fs: [5, 7, 5, 7, 5, 7, 7, 7, 7, 5, 7, 5, 7, 7, 5, 5]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 4, 15, 6, 13, 5, 11, 10, 12, 19, 7, 16, 3, 9, 18, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:41...
global Accuracy on shared test data: 71.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 74 189]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:41, End: 2025-07-22 16:00:41)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 19, 5, 7, 20, 8, 15, 18, 13, 9, 14, 11, 17, 4, 16, 2], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7565e+05, 1.1013e+00, 1.5224e+00, 3.8128e+05, 1.0158e+00,
         3.8712e+05, 3.9106e+05, 3.9131e+05, 7.7030e-01, 3.8432e+05, 7.0573e-01,
         3.9676e+05, 8.4415e-01, 3.8644e+05, 1.3175e+00],
        [3.7565e+05, 0.0000e+00, 3.7563e+05, 3.7560e+05, 7.8347e+05, 3.7564e+05,
         7.4456e+05, 7.6015e+05, 7.8385e+05, 3.7564e+05, 7.4496e+05, 3.7563e+05,
         7.8139e+05, 3.7563e+05, 7.5755e+05, 3.7563e+05],
        [1.1013e+00, 3.7563e+05, 0.0000e+00, 1.0824e+00, 3.8125e+05, 8.8813e-01,
         3.8712e+05, 3.9104e+05, 3.9129e+05, 9.8534e-01, 3.8431e+05, 1.0831e+00,
         3.9674e+05, 8.6397e-01, 3.8646e+05, 1.0090e+00],
        [1.5224e+00, 3.7560e+05, 1.0824e+00, 0.0000e+00, 3.8127e+05, 1.0733e+00,
         3.8712e+05, 3.9105e+05, 3.9128e+05, 1.4113e+00, 3.8431e+05, 1.7256e+00,
         3.9679e+05, 1.2211e+00, 3.8646e+05, 9.9758e-01],
        [3.8128e+05, 7.8347e+05, 3.8125e+05, 3.8127e+05, 0.0000e+00, 3.8129e+05,
         7.9007e+05, 7.5054e+05, 7.6762e+05, 3.8126e+05, 7.8034e+05, 3.8126e+05,
         7.8221e+05, 3.8127e+05, 7.4584e+05, 3.8127e+05],
        [1.0158e+00, 3.7564e+05, 8.8813e-01, 1.0733e+00, 3.8129e+05, 0.0000e+00,
         3.8713e+05, 3.9106e+05, 3.9128e+05, 8.8648e-01, 3.8431e+05, 9.8190e-01,
         3.9677e+05, 8.0866e-01, 3.8644e+05, 9.3328e-01],
        [3.8712e+05, 7.4456e+05, 3.8712e+05, 3.8712e+05, 7.9007e+05, 3.8713e+05,
         0.0000e+00, 7.8612e+05, 7.7509e+05, 3.8713e+05, 7.7135e+05, 3.8713e+05,
         7.9080e+05, 3.8712e+05, 7.7582e+05, 3.8712e+05],
        [3.9106e+05, 7.6015e+05, 3.9104e+05, 3.9105e+05, 7.5054e+05, 3.9106e+05,
         7.8612e+05, 0.0000e+00, 7.7996e+05, 3.9108e+05, 7.5852e+05, 3.9107e+05,
         7.8739e+05, 3.9107e+05, 7.7793e+05, 3.9106e+05],
        [3.9131e+05, 7.8385e+05, 3.9129e+05, 3.9128e+05, 7.6762e+05, 3.9128e+05,
         7.7509e+05, 7.7996e+05, 0.0000e+00, 3.9129e+05, 7.7127e+05, 3.9131e+05,
         7.6610e+05, 3.9129e+05, 7.7752e+05, 3.9127e+05],
        [7.7030e-01, 3.7564e+05, 9.8534e-01, 1.4113e+00, 3.8126e+05, 8.8648e-01,
         3.8713e+05, 3.9108e+05, 3.9129e+05, 0.0000e+00, 3.8433e+05, 5.7419e-01,
         3.9674e+05, 7.2618e-01, 3.8643e+05, 1.1473e+00],
        [3.8432e+05, 7.4496e+05, 3.8431e+05, 3.8431e+05, 7.8034e+05, 3.8431e+05,
         7.7135e+05, 7.5852e+05, 7.7127e+05, 3.8433e+05, 0.0000e+00, 3.8432e+05,
         7.7301e+05, 3.8433e+05, 7.6852e+05, 3.8431e+05],
        [7.0573e-01, 3.7563e+05, 1.0831e+00, 1.7256e+00, 3.8126e+05, 9.8190e-01,
         3.8713e+05, 3.9107e+05, 3.9131e+05, 5.7419e-01, 3.8432e+05, 0.0000e+00,
         3.9674e+05, 6.9762e-01, 3.8641e+05, 1.4075e+00],
        [3.9676e+05, 7.8139e+05, 3.9674e+05, 3.9679e+05, 7.8221e+05, 3.9677e+05,
         7.9080e+05, 7.8739e+05, 7.6610e+05, 3.9674e+05, 7.7301e+05, 3.9674e+05,
         0.0000e+00, 3.9677e+05, 7.6915e+05, 3.9676e+05],
        [8.4415e-01, 3.7563e+05, 8.6397e-01, 1.2211e+00, 3.8127e+05, 8.0866e-01,
         3.8712e+05, 3.9107e+05, 3.9129e+05, 7.2618e-01, 3.8433e+05, 6.9762e-01,
         3.9677e+05, 0.0000e+00, 3.8642e+05, 1.0121e+00],
        [3.8644e+05, 7.5755e+05, 3.8646e+05, 3.8646e+05, 7.4584e+05, 3.8644e+05,
         7.7582e+05, 7.7793e+05, 7.7752e+05, 3.8643e+05, 7.6852e+05, 3.8641e+05,
         7.6915e+05, 3.8642e+05, 0.0000e+00, 3.8646e+05],
        [1.3175e+00, 3.7563e+05, 1.0090e+00, 9.9758e-01, 3.8127e+05, 9.3328e-01,
         3.8712e+05, 3.9106e+05, 3.9127e+05, 1.1473e+00, 3.8431e+05, 1.4075e+00,
         3.9676e+05, 1.0121e+00, 3.8646e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 7.0573e-01, 7.7030e-01, 8.4415e-01, 1.0158e+00, 1.1013e+00,
        1.3175e+00, 1.5224e+00, 3.7565e+05, 3.8128e+05, 3.8432e+05, 3.8644e+05,
        3.8712e+05, 3.9106e+05, 3.9131e+05, 3.9676e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 375604.3750, 375625.1250, 375626.9688, 375633.6875,
        375634.6875, 375637.8750, 375640.9062, 375651.7500, 744556.2500,
        744962.9375, 757552.6250, 760154.5000, 781392.2500, 783474.0000,
        783853.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6397e-01, 8.8813e-01, 9.8534e-01, 1.0090e+00, 1.0824e+00,
        1.0831e+00, 1.1013e+00, 3.7563e+05, 3.8125e+05, 3.8431e+05, 3.8646e+05,
        3.8712e+05, 3.9104e+05, 3.9129e+05, 3.9674e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.9758e-01, 1.0733e+00, 1.0824e+00, 1.2211e+00, 1.4113e+00,
        1.5224e+00, 1.7256e+00, 3.7560e+05, 3.8127e+05, 3.8431e+05, 3.8646e+05,
        3.8712e+05, 3.9105e+05, 3.9128e+05, 3.9679e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381249.8750, 381263.0938, 381264.7500, 381272.8750,
        381273.5000, 381274.0625, 381281.8125, 381286.0312, 745840.8125,
        750541.1875, 767616.6250, 780335.8750, 782213.5625, 783474.0000,
        790072.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0866e-01, 8.8648e-01, 8.8813e-01, 9.3328e-01, 9.8190e-01,
        1.0158e+00, 1.0733e+00, 3.7564e+05, 3.8129e+05, 3.8431e+05, 3.8644e+05,
        3.8713e+05, 3.9106e+05, 3.9128e+05, 3.9677e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387119.3125, 387120.9375, 387121.9062, 387123.4062,
        387124.2500, 387131.3438, 387131.6250, 387133.8750, 744556.2500,
        771354.3125, 775086.6250, 775822.8750, 786119.5625, 790072.3125,
        790796.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391043.7812, 391052.8438, 391055.5625, 391057.3438,
        391060.4375, 391070.5312, 391072.2500, 391084.1250, 750541.1875,
        758515.5000, 760154.5000, 777930.0625, 779963.7500, 786119.5625,
        787387.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391271.4688, 391276.4375, 391281.8125, 391288.9062,
        391293.8125, 391294.2812, 391307.2188, 391314.1562, 766101.8750,
        767616.6250, 771266.8125, 775086.6250, 777516.0000, 779963.7500,
        783853.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.7419e-01, 7.2618e-01, 7.7030e-01, 8.8648e-01, 9.8534e-01,
        1.1473e+00, 1.4113e+00, 3.7564e+05, 3.8126e+05, 3.8433e+05, 3.8643e+05,
        3.8713e+05, 3.9108e+05, 3.9129e+05, 3.9674e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384306.1875, 384309.6875, 384311.7812, 384313.5312,
        384315.2812, 384321.9062, 384325.0625, 384332.4062, 744962.9375,
        758515.5000, 768524.0000, 771266.8125, 771354.3125, 773008.7500,
        780335.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.7419e-01, 6.9762e-01, 7.0573e-01, 9.8190e-01, 1.0831e+00,
        1.4075e+00, 1.7256e+00, 3.7563e+05, 3.8126e+05, 3.8432e+05, 3.8641e+05,
        3.8713e+05, 3.9107e+05, 3.9131e+05, 3.9674e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396736.1250, 396738.5312, 396744.0000, 396761.7188,
        396761.8125, 396769.4375, 396769.5000, 396791.3125, 766101.8750,
        769154.6250, 773008.7500, 781392.2500, 782213.5625, 787387.8750,
        790796.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.9762e-01, 7.2618e-01, 8.0866e-01, 8.4415e-01, 8.6397e-01,
        1.0121e+00, 1.2211e+00, 3.7563e+05, 3.8127e+05, 3.8433e+05, 3.8642e+05,
        3.8712e+05, 3.9107e+05, 3.9129e+05, 3.9677e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386410.7500, 386424.5000, 386428.8125, 386437.5625,
        386441.3750, 386456.5312, 386460.1250, 386463.0000, 745840.8125,
        757552.6250, 768524.0000, 769154.6250, 775822.8750, 777516.0000,
        777930.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.3328e-01, 9.9758e-01, 1.0090e+00, 1.0121e+00, 1.1473e+00,
        1.3175e+00, 1.4075e+00, 3.7563e+05, 3.8127e+05, 3.8431e+05, 3.8646e+05,
        3.8712e+05, 3.9106e+05, 3.9127e+05, 3.9676e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['114125.61', '449457.50', '114119.00', '114119.92', '454654.81', '114124.02', '461291.75', '463755.31', '466404.66', '114124.29', '457801.44', '114122.85', '470932.94', '114123.00', '459491.59', '114122.79']
estimated f for each client, fs: [8, 5, 8, 8, 5, 8, 5, 5, 5, 8, 5, 8, 5, 8, 5, 8]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 19, 5, 7, 20, 8, 15, 18, 13, 9, 14, 11, 17, 4, 16, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0115s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:41...
global Accuracy on shared test data: 72.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 79 184]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:41, End: 2025-07-22 16:00:41)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 7, 1, 16, 10, 11, 18, 12, 4, 17, 8, 15, 14, 2, 3, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9590e+05, 3.9589e+05, 7.6495e+05, 3.9592e+05, 3.9593e+05,
         7.6945e+05, 3.9592e+05, 3.9590e+05, 7.9520e+05, 3.9589e+05, 8.1012e+05,
         7.8727e+05, 3.9587e+05, 3.9591e+05, 3.9590e+05],
        [3.9590e+05, 0.0000e+00, 1.0119e+00, 3.8325e+05, 1.2731e+00, 1.6991e+00,
         3.8144e+05, 1.1524e+00, 1.2610e+00, 4.0058e+05, 1.1123e+00, 4.0343e+05,
         4.0178e+05, 9.9516e-01, 1.0795e+00, 9.8805e-01],
        [3.9589e+05, 1.0119e+00, 0.0000e+00, 3.8326e+05, 1.1599e+00, 1.5137e+00,
         3.8147e+05, 1.0516e+00, 1.1127e+00, 4.0059e+05, 1.0264e+00, 4.0345e+05,
         4.0177e+05, 9.7567e-01, 1.0491e+00, 9.4693e-01],
        [7.6495e+05, 3.8325e+05, 3.8326e+05, 0.0000e+00, 3.8323e+05, 3.8325e+05,
         7.7083e+05, 3.8325e+05, 3.8325e+05, 7.8810e+05, 3.8326e+05, 8.0485e+05,
         7.9797e+05, 3.8322e+05, 3.8324e+05, 3.8326e+05],
        [3.9592e+05, 1.2731e+00, 1.1599e+00, 3.8323e+05, 0.0000e+00, 7.2140e-01,
         3.8146e+05, 8.0170e-01, 7.6665e-01, 4.0054e+05, 8.6073e-01, 4.0340e+05,
         4.0178e+05, 1.0994e+00, 1.0141e+00, 1.3098e+00],
        [3.9593e+05, 1.6991e+00, 1.5137e+00, 3.8325e+05, 7.2140e-01, 0.0000e+00,
         3.8147e+05, 8.9997e-01, 7.0211e-01, 4.0053e+05, 1.0145e+00, 4.0343e+05,
         4.0177e+05, 1.4039e+00, 1.3128e+00, 1.7360e+00],
        [7.6945e+05, 3.8144e+05, 3.8147e+05, 7.7083e+05, 3.8146e+05, 3.8147e+05,
         0.0000e+00, 3.8146e+05, 3.8148e+05, 7.5774e+05, 3.8145e+05, 7.9155e+05,
         7.8326e+05, 3.8146e+05, 3.8147e+05, 3.8146e+05],
        [3.9592e+05, 1.1524e+00, 1.0516e+00, 3.8325e+05, 8.0170e-01, 8.9997e-01,
         3.8146e+05, 0.0000e+00, 8.1821e-01, 4.0058e+05, 9.1655e-01, 4.0345e+05,
         4.0178e+05, 1.0078e+00, 9.4206e-01, 1.1821e+00],
        [3.9590e+05, 1.2610e+00, 1.1127e+00, 3.8325e+05, 7.6665e-01, 7.0211e-01,
         3.8148e+05, 8.1821e-01, 0.0000e+00, 4.0055e+05, 8.6433e-01, 4.0343e+05,
         4.0177e+05, 1.0658e+00, 1.0155e+00, 1.2722e+00],
        [7.9520e+05, 4.0058e+05, 4.0059e+05, 7.8810e+05, 4.0054e+05, 4.0053e+05,
         7.5774e+05, 4.0058e+05, 4.0055e+05, 0.0000e+00, 4.0055e+05, 7.9600e+05,
         7.9485e+05, 4.0058e+05, 4.0056e+05, 4.0057e+05],
        [3.9589e+05, 1.1123e+00, 1.0264e+00, 3.8326e+05, 8.6073e-01, 1.0145e+00,
         3.8145e+05, 9.1655e-01, 8.6433e-01, 4.0055e+05, 0.0000e+00, 4.0343e+05,
         4.0178e+05, 9.8838e-01, 9.7469e-01, 1.0522e+00],
        [8.1012e+05, 4.0343e+05, 4.0345e+05, 8.0485e+05, 4.0340e+05, 4.0343e+05,
         7.9155e+05, 4.0345e+05, 4.0343e+05, 7.9600e+05, 4.0343e+05, 0.0000e+00,
         8.0846e+05, 4.0341e+05, 4.0342e+05, 4.0343e+05],
        [7.8727e+05, 4.0178e+05, 4.0177e+05, 7.9797e+05, 4.0178e+05, 4.0177e+05,
         7.8326e+05, 4.0178e+05, 4.0177e+05, 7.9485e+05, 4.0178e+05, 8.0846e+05,
         0.0000e+00, 4.0178e+05, 4.0178e+05, 4.0176e+05],
        [3.9587e+05, 9.9516e-01, 9.7567e-01, 3.8322e+05, 1.0994e+00, 1.4039e+00,
         3.8146e+05, 1.0078e+00, 1.0658e+00, 4.0058e+05, 9.8838e-01, 4.0341e+05,
         4.0178e+05, 0.0000e+00, 9.6862e-01, 9.2826e-01],
        [3.9591e+05, 1.0795e+00, 1.0491e+00, 3.8324e+05, 1.0141e+00, 1.3128e+00,
         3.8147e+05, 9.4206e-01, 1.0155e+00, 4.0056e+05, 9.7469e-01, 4.0342e+05,
         4.0178e+05, 9.6862e-01, 0.0000e+00, 1.0515e+00],
        [3.9590e+05, 9.8805e-01, 9.4693e-01, 3.8326e+05, 1.3098e+00, 1.7360e+00,
         3.8146e+05, 1.1821e+00, 1.2722e+00, 4.0057e+05, 1.0522e+00, 4.0343e+05,
         4.0176e+05, 9.2826e-01, 1.0515e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 395870.6562, 395888.0938, 395889.5312, 395896.2188,
        395902.6875, 395904.6562, 395905.5000, 395915.5312, 395921.9062,
        395925.5000, 764948.0625, 769448.8750, 787265.5000, 795204.4375,
        810118.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8805e-01, 9.9516e-01, 1.0119e+00, 1.0795e+00, 1.1123e+00,
        1.1524e+00, 1.2610e+00, 1.2731e+00, 1.6991e+00, 3.8144e+05, 3.8325e+05,
        3.9590e+05, 4.0058e+05, 4.0178e+05, 4.0343e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4693e-01, 9.7567e-01, 1.0119e+00, 1.0264e+00, 1.0491e+00,
        1.0516e+00, 1.1127e+00, 1.1599e+00, 1.5137e+00, 3.8147e+05, 3.8326e+05,
        3.9589e+05, 4.0059e+05, 4.0177e+05, 4.0345e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383222.5312, 383225.1562, 383244.0625, 383245.2500,
        383248.1562, 383253.2188, 383253.7500, 383255.3750, 383255.6875,
        383255.9688, 764948.0625, 770830.9375, 788099.8125, 797966.9375,
        804852.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.2140e-01, 7.6665e-01, 8.0170e-01, 8.6073e-01, 1.0141e+00,
        1.0994e+00, 1.1599e+00, 1.2731e+00, 1.3098e+00, 3.8146e+05, 3.8323e+05,
        3.9592e+05, 4.0054e+05, 4.0178e+05, 4.0340e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.0211e-01, 7.2140e-01, 8.9997e-01, 1.0145e+00, 1.3128e+00,
        1.4039e+00, 1.5137e+00, 1.6991e+00, 1.7360e+00, 3.8147e+05, 3.8325e+05,
        3.9593e+05, 4.0053e+05, 4.0177e+05, 4.0343e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381444.0000, 381447.0000, 381455.1875, 381457.1875,
        381458.1875, 381459.8438, 381466.7812, 381467.1562, 381474.6250,
        381481.4688, 757742.7500, 769448.8750, 770830.9375, 783260.0625,
        791549.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0170e-01, 8.1821e-01, 8.9997e-01, 9.1655e-01, 9.4206e-01,
        1.0078e+00, 1.0516e+00, 1.1524e+00, 1.1821e+00, 3.8146e+05, 3.8325e+05,
        3.9592e+05, 4.0058e+05, 4.0178e+05, 4.0345e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.0211e-01, 7.6665e-01, 8.1821e-01, 8.6433e-01, 1.0155e+00,
        1.0658e+00, 1.1127e+00, 1.2610e+00, 1.2722e+00, 3.8148e+05, 3.8325e+05,
        3.9590e+05, 4.0055e+05, 4.0177e+05, 4.0343e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400525.8750, 400541.1562, 400550.5312, 400552.5000,
        400560.9688, 400572.9375, 400578.3438, 400578.4375, 400584.4375,
        400594.1875, 757742.7500, 788099.8125, 794850.0000, 795204.4375,
        795998.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6073e-01, 8.6433e-01, 9.1655e-01, 9.7469e-01, 9.8838e-01,
        1.0145e+00, 1.0264e+00, 1.0522e+00, 1.1123e+00, 3.8145e+05, 3.8326e+05,
        3.9589e+05, 4.0055e+05, 4.0178e+05, 4.0343e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403401.5312, 403412.8438, 403415.5625, 403426.8438,
        403428.5000, 403428.7188, 403430.2812, 403431.1250, 403447.2188,
        403451.7812, 791549.0000, 795998.1250, 804852.0000, 808464.1875,
        810118.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401759.1875, 401766.0625, 401767.0625, 401773.8750,
        401776.4688, 401777.1875, 401779.3125, 401779.5625, 401780.8438,
        401784.4062, 783260.0625, 787265.5000, 794850.0000, 797966.9375,
        808464.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2826e-01, 9.6862e-01, 9.7567e-01, 9.8838e-01, 9.9516e-01,
        1.0078e+00, 1.0658e+00, 1.0994e+00, 1.4039e+00, 3.8146e+05, 3.8322e+05,
        3.9587e+05, 4.0058e+05, 4.0178e+05, 4.0341e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4206e-01, 9.6862e-01, 9.7469e-01, 1.0141e+00, 1.0155e+00,
        1.0491e+00, 1.0515e+00, 1.0795e+00, 1.3128e+00, 3.8147e+05, 3.8324e+05,
        3.9591e+05, 4.0056e+05, 4.0178e+05, 4.0342e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2826e-01, 9.4693e-01, 9.8805e-01, 1.0515e+00, 1.0522e+00,
        1.1821e+00, 1.2722e+00, 1.3098e+00, 1.7360e+00, 3.8146e+05, 3.8326e+05,
        3.9590e+05, 4.0057e+05, 4.0176e+05, 4.0343e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['395902.03', '38145.46', '38147.66', '383245.91', '38146.72', '38148.56', '381461.16', '38146.86', '38149.04', '400563.94', '38145.59', '403427.44', '401774.41', '38146.66', '38147.66', '38146.57']
estimated f for each client, fs: [4, 6, 6, 4, 6, 6, 4, 6, 6, 4, 6, 4, 4, 6, 6, 6]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 7, 1, 16, 10, 11, 18, 12, 4, 17, 8, 15, 14, 2, 3, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0116s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:42...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:42, End: 2025-07-22 16:00:42)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 5, 18, 7, 15, 4, 14, 19, 17, 1, 13, 2, 16, 11, 6, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0335e+00, 3.7911e+05, 1.2256e+00, 3.9638e+05, 1.0548e+00,
         3.9074e+05, 3.9155e+05, 3.8372e+05, 1.2597e+00, 3.6584e+05, 1.2460e+00,
         3.8380e+05, 1.0991e+00, 1.4405e+00, 1.1613e+00],
        [1.0335e+00, 0.0000e+00, 3.7913e+05, 1.2002e+00, 3.9637e+05, 9.5320e-01,
         3.9075e+05, 3.9152e+05, 3.8371e+05, 1.4141e+00, 3.6582e+05, 1.4370e+00,
         3.8382e+05, 8.1702e-01, 1.7122e+00, 1.3440e+00],
        [3.7911e+05, 3.7913e+05, 0.0000e+00, 3.7913e+05, 7.6266e+05, 3.7914e+05,
         7.7188e+05, 7.8054e+05, 7.5642e+05, 3.7913e+05, 7.4714e+05, 3.7914e+05,
         7.6117e+05, 3.7915e+05, 3.7915e+05, 3.7915e+05],
        [1.2256e+00, 1.2002e+00, 3.7913e+05, 0.0000e+00, 3.9635e+05, 1.2261e+00,
         3.9072e+05, 3.9155e+05, 3.8372e+05, 1.3700e+00, 3.6582e+05, 1.2987e+00,
         3.8383e+05, 1.2609e+00, 1.5308e+00, 1.3438e+00],
        [3.9638e+05, 3.9637e+05, 7.6266e+05, 3.9635e+05, 0.0000e+00, 3.9638e+05,
         7.7415e+05, 7.7392e+05, 7.9147e+05, 3.9636e+05, 7.6753e+05, 3.9634e+05,
         7.8568e+05, 3.9636e+05, 3.9635e+05, 3.9638e+05],
        [1.0548e+00, 9.5320e-01, 3.7914e+05, 1.2261e+00, 3.9638e+05, 0.0000e+00,
         3.9074e+05, 3.9153e+05, 3.8373e+05, 1.4451e+00, 3.6583e+05, 1.3504e+00,
         3.8383e+05, 8.5933e-01, 1.6485e+00, 1.3385e+00],
        [3.9074e+05, 3.9075e+05, 7.7188e+05, 3.9072e+05, 7.7415e+05, 3.9074e+05,
         0.0000e+00, 7.7004e+05, 7.8864e+05, 3.9070e+05, 7.4620e+05, 3.9073e+05,
         7.7110e+05, 3.9077e+05, 3.9075e+05, 3.9073e+05],
        [3.9155e+05, 3.9152e+05, 7.8054e+05, 3.9155e+05, 7.7392e+05, 3.9153e+05,
         7.7004e+05, 0.0000e+00, 7.6913e+05, 3.9156e+05, 7.6049e+05, 3.9152e+05,
         7.8981e+05, 3.9156e+05, 3.9153e+05, 3.9154e+05],
        [3.8372e+05, 3.8371e+05, 7.5642e+05, 3.8372e+05, 7.9147e+05, 3.8373e+05,
         7.8864e+05, 7.6913e+05, 0.0000e+00, 3.8374e+05, 7.5294e+05, 3.8373e+05,
         7.5893e+05, 3.8370e+05, 3.8375e+05, 3.8372e+05],
        [1.2597e+00, 1.4141e+00, 3.7913e+05, 1.3700e+00, 3.9636e+05, 1.4451e+00,
         3.9070e+05, 3.9156e+05, 3.8374e+05, 0.0000e+00, 3.6582e+05, 1.1956e+00,
         3.8383e+05, 1.7121e+00, 1.1390e+00, 1.2242e+00],
        [3.6584e+05, 3.6582e+05, 7.4714e+05, 3.6582e+05, 7.6753e+05, 3.6583e+05,
         7.4620e+05, 7.6049e+05, 7.5294e+05, 3.6582e+05, 0.0000e+00, 3.6584e+05,
         7.5676e+05, 3.6584e+05, 3.6582e+05, 3.6582e+05],
        [1.2460e+00, 1.4370e+00, 3.7914e+05, 1.2987e+00, 3.9634e+05, 1.3504e+00,
         3.9073e+05, 3.9152e+05, 3.8373e+05, 1.1956e+00, 3.6584e+05, 0.0000e+00,
         3.8382e+05, 1.5644e+00, 1.1883e+00, 1.1637e+00],
        [3.8380e+05, 3.8382e+05, 7.6117e+05, 3.8383e+05, 7.8568e+05, 3.8383e+05,
         7.7110e+05, 7.8981e+05, 7.5893e+05, 3.8383e+05, 7.5676e+05, 3.8382e+05,
         0.0000e+00, 3.8384e+05, 3.8386e+05, 3.8383e+05],
        [1.0991e+00, 8.1702e-01, 3.7915e+05, 1.2609e+00, 3.9636e+05, 8.5933e-01,
         3.9077e+05, 3.9156e+05, 3.8370e+05, 1.7121e+00, 3.6584e+05, 1.5644e+00,
         3.8384e+05, 0.0000e+00, 1.9929e+00, 1.5522e+00],
        [1.4405e+00, 1.7122e+00, 3.7915e+05, 1.5308e+00, 3.9635e+05, 1.6485e+00,
         3.9075e+05, 3.9153e+05, 3.8375e+05, 1.1390e+00, 3.6582e+05, 1.1883e+00,
         3.8386e+05, 1.9929e+00, 0.0000e+00, 1.2848e+00],
        [1.1613e+00, 1.3440e+00, 3.7915e+05, 1.3438e+00, 3.9638e+05, 1.3385e+00,
         3.9073e+05, 3.9154e+05, 3.8372e+05, 1.2242e+00, 3.6582e+05, 1.1637e+00,
         3.8383e+05, 1.5522e+00, 1.2848e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0335e+00, 1.0548e+00, 1.0991e+00, 1.1613e+00, 1.2256e+00,
        1.2460e+00, 1.2597e+00, 1.4405e+00, 3.6584e+05, 3.7911e+05, 3.8372e+05,
        3.8380e+05, 3.9074e+05, 3.9155e+05, 3.9638e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.1702e-01, 9.5320e-01, 1.0335e+00, 1.2002e+00, 1.3440e+00,
        1.4141e+00, 1.4370e+00, 1.7122e+00, 3.6582e+05, 3.7913e+05, 3.8371e+05,
        3.8382e+05, 3.9075e+05, 3.9152e+05, 3.9637e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379108.9375, 379129.0000, 379132.7188, 379134.3438,
        379143.5000, 379143.6875, 379149.7500, 379151.0000, 379154.1250,
        747137.3125, 756419.5625, 761168.5000, 762665.0000, 771884.1250,
        780544.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2002e+00, 1.2256e+00, 1.2261e+00, 1.2609e+00, 1.2987e+00,
        1.3438e+00, 1.3700e+00, 1.5308e+00, 3.6582e+05, 3.7913e+05, 3.8372e+05,
        3.8383e+05, 3.9072e+05, 3.9155e+05, 3.9635e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396336.5938, 396347.7500, 396353.9375, 396356.8438,
        396358.2500, 396369.7812, 396375.3125, 396378.4688, 396379.2500,
        762665.0000, 767531.0000, 773918.3750, 774145.1250, 785683.2500,
        791473.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.5933e-01, 9.5320e-01, 1.0548e+00, 1.2261e+00, 1.3385e+00,
        1.3504e+00, 1.4451e+00, 1.6485e+00, 3.6583e+05, 3.7914e+05, 3.8373e+05,
        3.8383e+05, 3.9074e+05, 3.9153e+05, 3.9638e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390702.0625, 390720.3125, 390730.1875, 390734.0938,
        390742.4375, 390744.1875, 390751.7500, 390754.5312, 390768.8125,
        746195.7500, 770037.0000, 771095.4375, 771884.1250, 774145.1250,
        788637.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391516.5938, 391522.1250, 391527.0312, 391532.1250,
        391541.5625, 391549.5312, 391553.9375, 391562.1562, 391563.8438,
        760485.9375, 769130.1875, 770037.0000, 773918.3750, 780544.6875,
        789807.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383701.3750, 383714.1875, 383719.1250, 383720.6562,
        383721.4688, 383731.4375, 383732.6562, 383743.8125, 383748.6875,
        752943.1250, 756419.5625, 758930.0625, 769130.1875, 788637.5625,
        791473.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1390e+00, 1.1956e+00, 1.2242e+00, 1.2597e+00, 1.3700e+00,
        1.4141e+00, 1.4451e+00, 1.7121e+00, 3.6582e+05, 3.7913e+05, 3.8374e+05,
        3.8383e+05, 3.9070e+05, 3.9156e+05, 3.9636e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 365817.9062, 365823.4375, 365823.5000, 365823.6875,
        365824.7812, 365825.3438, 365835.1250, 365836.0625, 365838.7812,
        746195.7500, 747137.3125, 752943.1250, 756761.4375, 760485.9375,
        767531.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1637e+00, 1.1883e+00, 1.1956e+00, 1.2460e+00, 1.2987e+00,
        1.3504e+00, 1.4370e+00, 1.5644e+00, 3.6584e+05, 3.7914e+05, 3.8373e+05,
        3.8382e+05, 3.9073e+05, 3.9152e+05, 3.9634e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383800.2500, 383819.8750, 383819.9062, 383826.8750,
        383828.2188, 383830.5625, 383831.3750, 383839.3750, 383862.2500,
        756761.4375, 758930.0625, 761168.5000, 771095.4375, 785683.2500,
        789807.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.1702e-01, 8.5933e-01, 1.0991e+00, 1.2609e+00, 1.5522e+00,
        1.5644e+00, 1.7121e+00, 1.9929e+00, 3.6584e+05, 3.7915e+05, 3.8370e+05,
        3.8384e+05, 3.9077e+05, 3.9156e+05, 3.9636e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1390e+00, 1.1883e+00, 1.2848e+00, 1.4405e+00, 1.5308e+00,
        1.6485e+00, 1.7122e+00, 1.9929e+00, 3.6582e+05, 3.7915e+05, 3.8375e+05,
        3.8386e+05, 3.9075e+05, 3.9153e+05, 3.9635e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1613e+00, 1.1637e+00, 1.2242e+00, 1.2848e+00, 1.3385e+00,
        1.3438e+00, 1.3440e+00, 1.5522e+00, 3.6582e+05, 3.7915e+05, 3.8372e+05,
        3.8383e+05, 3.9073e+05, 3.9154e+05, 3.9638e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['74495.46', '74496.63', '415938.44', '74495.73', '432992.09', '74497.89', '426284.41', '428435.44', '420647.69', '74496.86', '403864.41', '74499.27', '421122.00', '74499.70', '74498.64', '74498.81']
estimated f for each client, fs: [7, 7, 5, 7, 5, 7, 5, 5, 5, 7, 6, 7, 5, 7, 7, 7]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 5, 18, 7, 15, 4, 14, 19, 17, 1, 13, 2, 16, 11, 6, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0123s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:42...
global Accuracy on shared test data: 72.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 81 182]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:42, End: 2025-07-22 16:00:42)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 13, 7, 17, 18, 14, 10, 20, 4, 12, 2, 5, 8, 3, 9, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7248e+05, 1.1719e+00, 4.0128e+05, 3.7444e+05, 3.9014e+05,
         8.1504e-01, 3.8253e+05, 7.8221e-01, 7.5324e-01, 1.3645e+00, 7.2359e-01,
         1.1243e+00, 1.3448e+00, 7.0703e-01, 3.9253e+05],
        [3.7248e+05, 0.0000e+00, 3.7251e+05, 7.9303e+05, 7.4670e+05, 7.4728e+05,
         3.7248e+05, 7.5256e+05, 3.7251e+05, 3.7250e+05, 3.7251e+05, 3.7248e+05,
         3.7250e+05, 3.7249e+05, 3.7247e+05, 7.7163e+05],
        [1.1719e+00, 3.7251e+05, 0.0000e+00, 4.0129e+05, 3.7444e+05, 3.9014e+05,
         1.0179e+00, 3.8255e+05, 1.0379e+00, 1.3257e+00, 9.8693e-01, 1.0366e+00,
         9.5872e-01, 1.0519e+00, 1.0591e+00, 3.9254e+05],
        [4.0128e+05, 7.9303e+05, 4.0129e+05, 0.0000e+00, 7.6782e+05, 7.6641e+05,
         4.0126e+05, 7.8294e+05, 4.0127e+05, 4.0131e+05, 4.0129e+05, 4.0127e+05,
         4.0127e+05, 4.0127e+05, 4.0127e+05, 7.9826e+05],
        [3.7444e+05, 7.4670e+05, 3.7444e+05, 7.6782e+05, 0.0000e+00, 7.5824e+05,
         3.7442e+05, 7.6798e+05, 3.7442e+05, 3.7444e+05, 3.7444e+05, 3.7442e+05,
         3.7442e+05, 3.7440e+05, 3.7443e+05, 7.7497e+05],
        [3.9014e+05, 7.4728e+05, 3.9014e+05, 7.6641e+05, 7.5824e+05, 0.0000e+00,
         3.9015e+05, 7.6548e+05, 3.9013e+05, 3.9015e+05, 3.9013e+05, 3.9016e+05,
         3.9015e+05, 3.9015e+05, 3.9015e+05, 7.6859e+05],
        [8.1504e-01, 3.7248e+05, 1.0179e+00, 4.0126e+05, 3.7442e+05, 3.9015e+05,
         0.0000e+00, 3.8253e+05, 9.0378e-01, 1.0162e+00, 1.1177e+00, 8.4182e-01,
         9.6920e-01, 1.0741e+00, 8.1663e-01, 3.9253e+05],
        [3.8253e+05, 7.5256e+05, 3.8255e+05, 7.8294e+05, 7.6798e+05, 7.6548e+05,
         3.8253e+05, 0.0000e+00, 3.8252e+05, 3.8256e+05, 3.8254e+05, 3.8253e+05,
         3.8253e+05, 3.8253e+05, 3.8254e+05, 7.6341e+05],
        [7.8221e-01, 3.7251e+05, 1.0379e+00, 4.0127e+05, 3.7442e+05, 3.9013e+05,
         9.0378e-01, 3.8252e+05, 0.0000e+00, 9.7781e-01, 1.1223e+00, 8.5190e-01,
         9.6855e-01, 1.1252e+00, 8.2848e-01, 3.9252e+05],
        [7.5324e-01, 3.7250e+05, 1.3257e+00, 4.0131e+05, 3.7444e+05, 3.9015e+05,
         1.0162e+00, 3.8256e+05, 9.7781e-01, 0.0000e+00, 1.4584e+00, 9.1095e-01,
         1.2892e+00, 1.3941e+00, 9.3438e-01, 3.9255e+05],
        [1.3645e+00, 3.7251e+05, 9.8693e-01, 4.0129e+05, 3.7444e+05, 3.9013e+05,
         1.1177e+00, 3.8254e+05, 1.1223e+00, 1.4584e+00, 0.0000e+00, 1.1986e+00,
         9.6948e-01, 9.9370e-01, 1.1507e+00, 3.9254e+05],
        [7.2359e-01, 3.7248e+05, 1.0366e+00, 4.0127e+05, 3.7442e+05, 3.9016e+05,
         8.4182e-01, 3.8253e+05, 8.5190e-01, 9.1095e-01, 1.1986e+00, 0.0000e+00,
         1.0006e+00, 1.1302e+00, 8.2945e-01, 3.9252e+05],
        [1.1243e+00, 3.7250e+05, 9.5872e-01, 4.0127e+05, 3.7442e+05, 3.9015e+05,
         9.6920e-01, 3.8253e+05, 9.6855e-01, 1.2892e+00, 9.6948e-01, 1.0006e+00,
         0.0000e+00, 9.8227e-01, 9.8918e-01, 3.9254e+05],
        [1.3448e+00, 3.7249e+05, 1.0519e+00, 4.0127e+05, 3.7440e+05, 3.9015e+05,
         1.0741e+00, 3.8253e+05, 1.1252e+00, 1.3941e+00, 9.9370e-01, 1.1302e+00,
         9.8227e-01, 0.0000e+00, 1.1154e+00, 3.9255e+05],
        [7.0703e-01, 3.7247e+05, 1.0591e+00, 4.0127e+05, 3.7443e+05, 3.9015e+05,
         8.1663e-01, 3.8254e+05, 8.2848e-01, 9.3438e-01, 1.1507e+00, 8.2945e-01,
         9.8918e-01, 1.1154e+00, 0.0000e+00, 3.9254e+05],
        [3.9253e+05, 7.7163e+05, 3.9254e+05, 7.9826e+05, 7.7497e+05, 7.6859e+05,
         3.9253e+05, 7.6341e+05, 3.9252e+05, 3.9255e+05, 3.9254e+05, 3.9252e+05,
         3.9254e+05, 3.9255e+05, 3.9254e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 7.0703e-01, 7.2359e-01, 7.5324e-01, 7.8221e-01, 8.1504e-01,
        1.1243e+00, 1.1719e+00, 1.3448e+00, 1.3645e+00, 3.7248e+05, 3.7444e+05,
        3.8253e+05, 3.9014e+05, 3.9253e+05, 4.0128e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 372470.3125, 372475.9375, 372480.6250, 372481.6562,
        372490.2500, 372500.5312, 372502.5625, 372508.8750, 372510.3438,
        372511.5312, 746702.1250, 747275.8125, 752563.8125, 771626.9375,
        793028.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.5872e-01, 9.8693e-01, 1.0179e+00, 1.0366e+00, 1.0379e+00,
        1.0519e+00, 1.0591e+00, 1.1719e+00, 1.3257e+00, 3.7251e+05, 3.7444e+05,
        3.8255e+05, 3.9014e+05, 3.9254e+05, 4.0129e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401256.0312, 401266.6562, 401270.1562, 401271.6562,
        401273.4375, 401274.4688, 401280.4688, 401286.1562, 401286.8125,
        401307.4688, 766413.7500, 767819.6875, 782935.3750, 793028.3750,
        798258.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374395.8125, 374415.0625, 374415.7500, 374416.5000,
        374424.4688, 374426.9375, 374435.8750, 374438.8438, 374441.1562,
        374443.1250, 746702.1250, 758242.4375, 767819.6875, 767975.8750,
        774970.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390129.8750, 390131.8125, 390138.2188, 390144.3438,
        390146.6250, 390148.5625, 390149.2188, 390151.4062, 390154.5938,
        390156.0000, 747275.8125, 758242.4375, 765482.1250, 766413.7500,
        768586.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.1504e-01, 8.1663e-01, 8.4182e-01, 9.0378e-01, 9.6920e-01,
        1.0162e+00, 1.0179e+00, 1.0741e+00, 1.1177e+00, 3.7248e+05, 3.7442e+05,
        3.8253e+05, 3.9015e+05, 3.9253e+05, 4.0126e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382519.5312, 382527.0312, 382527.5938, 382527.9688,
        382528.8125, 382534.0625, 382539.0312, 382542.9688, 382545.9062,
        382560.6250, 752563.8125, 763410.3750, 765482.1250, 767975.8750,
        782935.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.8221e-01, 8.2848e-01, 8.5190e-01, 9.0378e-01, 9.6855e-01,
        9.7781e-01, 1.0379e+00, 1.1223e+00, 1.1252e+00, 3.7251e+05, 3.7442e+05,
        3.8252e+05, 3.9013e+05, 3.9252e+05, 4.0127e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.5324e-01, 9.1095e-01, 9.3438e-01, 9.7781e-01, 1.0162e+00,
        1.2892e+00, 1.3257e+00, 1.3941e+00, 1.4584e+00, 3.7250e+05, 3.7444e+05,
        3.8256e+05, 3.9015e+05, 3.9255e+05, 4.0131e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.6948e-01, 9.8693e-01, 9.9370e-01, 1.1177e+00, 1.1223e+00,
        1.1507e+00, 1.1986e+00, 1.3645e+00, 1.4584e+00, 3.7251e+05, 3.7444e+05,
        3.8254e+05, 3.9013e+05, 3.9254e+05, 4.0129e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.2359e-01, 8.2945e-01, 8.4182e-01, 8.5190e-01, 9.1095e-01,
        1.0006e+00, 1.0366e+00, 1.1302e+00, 1.1986e+00, 3.7248e+05, 3.7442e+05,
        3.8253e+05, 3.9016e+05, 3.9252e+05, 4.0127e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.5872e-01, 9.6855e-01, 9.6920e-01, 9.6948e-01, 9.8227e-01,
        9.8918e-01, 1.0006e+00, 1.1243e+00, 1.2892e+00, 3.7250e+05, 3.7442e+05,
        3.8253e+05, 3.9015e+05, 3.9254e+05, 4.0127e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8227e-01, 9.9370e-01, 1.0519e+00, 1.0741e+00, 1.1154e+00,
        1.1252e+00, 1.1302e+00, 1.3448e+00, 1.3941e+00, 3.7249e+05, 3.7440e+05,
        3.8253e+05, 3.9015e+05, 3.9255e+05, 4.0127e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.0703e-01, 8.1663e-01, 8.2848e-01, 8.2945e-01, 9.3438e-01,
        9.8918e-01, 1.0591e+00, 1.1154e+00, 1.1507e+00, 3.7247e+05, 3.7443e+05,
        3.8254e+05, 3.9015e+05, 3.9254e+05, 4.0127e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392515.6875, 392521.9375, 392528.6250, 392534.9688,
        392538.9375, 392540.0312, 392543.0312, 392543.5312, 392545.6562,
        392548.9375, 763410.3750, 768586.5625, 771626.9375, 774970.2500,
        798258.9375])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37249.05', '372493.25', '37252.12', '401277.34', '374425.31', '390145.06', '37248.92', '382535.31', '37251.89', '37251.06', '37251.93', '37248.45', '37251.18', '37250.05', '37247.88', '392536.12']
estimated f for each client, fs: [6, 5, 6, 4, 4, 4, 6, 4, 6, 6, 6, 6, 6, 6, 6, 4]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [11, 13, 7, 17, 18, 14, 10, 20, 4, 12, 2, 5, 8, 3, 9, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0243s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:43...
global Accuracy on shared test data: 72.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:43, End: 2025-07-22 16:00:43)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 4, 5, 10, 8, 19, 14, 3, 11, 20, 12, 1, 13, 15, 16, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0287e+00, 1.0890e+00, 1.0411e+00, 9.3400e-01, 3.8421e+05,
         3.9306e+05, 9.6940e-01, 1.3196e+00, 3.7869e+05, 1.0685e+00, 9.5069e-01,
         4.0822e+05, 3.9295e+05, 4.0142e+05, 1.5317e+00],
        [1.0287e+00, 0.0000e+00, 7.8292e-01, 8.0491e-01, 8.7543e-01, 3.8420e+05,
         3.9304e+05, 1.0182e+00, 7.5174e-01, 3.7869e+05, 7.5596e-01, 1.0938e+00,
         4.0819e+05, 3.9295e+05, 4.0144e+05, 9.6627e-01],
        [1.0890e+00, 7.8292e-01, 0.0000e+00, 7.7055e-01, 9.5576e-01, 3.8420e+05,
         3.9303e+05, 9.9200e-01, 7.1411e-01, 3.7868e+05, 6.8767e-01, 1.0748e+00,
         4.0821e+05, 3.9296e+05, 4.0143e+05, 9.2195e-01],
        [1.0411e+00, 8.0491e-01, 7.7055e-01, 0.0000e+00, 8.9101e-01, 3.8421e+05,
         3.9307e+05, 9.4995e-01, 7.6129e-01, 3.7868e+05, 7.4384e-01, 1.0884e+00,
         4.0822e+05, 3.9294e+05, 4.0145e+05, 9.1608e-01],
        [9.3400e-01, 8.7543e-01, 9.5576e-01, 8.9101e-01, 0.0000e+00, 3.8422e+05,
         3.9305e+05, 9.2374e-01, 1.0774e+00, 3.7869e+05, 9.3601e-01, 9.7317e-01,
         4.0820e+05, 3.9294e+05, 4.0145e+05, 1.3368e+00],
        [3.8421e+05, 3.8420e+05, 3.8420e+05, 3.8421e+05, 3.8422e+05, 0.0000e+00,
         7.8208e+05, 3.8421e+05, 3.8417e+05, 7.6175e+05, 3.8420e+05, 3.8424e+05,
         7.8574e+05, 7.8607e+05, 7.9071e+05, 3.8416e+05],
        [3.9306e+05, 3.9304e+05, 3.9303e+05, 3.9307e+05, 3.9305e+05, 7.8208e+05,
         0.0000e+00, 3.9308e+05, 3.9305e+05, 7.7556e+05, 3.9306e+05, 3.9307e+05,
         7.9524e+05, 7.8119e+05, 7.9573e+05, 3.9305e+05],
        [9.6940e-01, 1.0182e+00, 9.9200e-01, 9.4995e-01, 9.2374e-01, 3.8421e+05,
         3.9308e+05, 0.0000e+00, 1.2734e+00, 3.7867e+05, 1.0168e+00, 9.9594e-01,
         4.0820e+05, 3.9297e+05, 4.0146e+05, 1.4270e+00],
        [1.3196e+00, 7.5174e-01, 7.1411e-01, 7.6129e-01, 1.0774e+00, 3.8417e+05,
         3.9305e+05, 1.2734e+00, 0.0000e+00, 3.7870e+05, 6.0897e-01, 1.4077e+00,
         4.0822e+05, 3.9294e+05, 4.0147e+05, 5.3802e-01],
        [3.7869e+05, 3.7869e+05, 3.7868e+05, 3.7868e+05, 3.7869e+05, 7.6175e+05,
         7.7556e+05, 3.7867e+05, 3.7870e+05, 0.0000e+00, 3.7871e+05, 3.7870e+05,
         8.0201e+05, 7.8109e+05, 7.6165e+05, 3.7870e+05],
        [1.0685e+00, 7.5596e-01, 6.8767e-01, 7.4384e-01, 9.3601e-01, 3.8420e+05,
         3.9306e+05, 1.0168e+00, 6.0897e-01, 3.7871e+05, 0.0000e+00, 1.1283e+00,
         4.0821e+05, 3.9296e+05, 4.0147e+05, 7.8159e-01],
        [9.5069e-01, 1.0938e+00, 1.0748e+00, 1.0884e+00, 9.7317e-01, 3.8424e+05,
         3.9307e+05, 9.9594e-01, 1.4077e+00, 3.7870e+05, 1.1283e+00, 0.0000e+00,
         4.0820e+05, 3.9298e+05, 4.0145e+05, 1.6313e+00],
        [4.0822e+05, 4.0819e+05, 4.0821e+05, 4.0822e+05, 4.0820e+05, 7.8574e+05,
         7.9524e+05, 4.0820e+05, 4.0822e+05, 8.0201e+05, 4.0821e+05, 4.0820e+05,
         0.0000e+00, 8.0979e+05, 7.9234e+05, 4.0823e+05],
        [3.9295e+05, 3.9295e+05, 3.9296e+05, 3.9294e+05, 3.9294e+05, 7.8607e+05,
         7.8119e+05, 3.9297e+05, 3.9294e+05, 7.8109e+05, 3.9296e+05, 3.9298e+05,
         8.0979e+05, 0.0000e+00, 8.0018e+05, 3.9293e+05],
        [4.0142e+05, 4.0144e+05, 4.0143e+05, 4.0145e+05, 4.0145e+05, 7.9071e+05,
         7.9573e+05, 4.0146e+05, 4.0147e+05, 7.6165e+05, 4.0147e+05, 4.0145e+05,
         7.9234e+05, 8.0018e+05, 0.0000e+00, 4.0148e+05],
        [1.5317e+00, 9.6627e-01, 9.2195e-01, 9.1608e-01, 1.3368e+00, 3.8416e+05,
         3.9305e+05, 1.4270e+00, 5.3802e-01, 3.7870e+05, 7.8159e-01, 1.6313e+00,
         4.0823e+05, 3.9293e+05, 4.0148e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.3400e-01, 9.5069e-01, 9.6940e-01, 1.0287e+00, 1.0411e+00,
        1.0685e+00, 1.0890e+00, 1.3196e+00, 1.5317e+00, 3.7869e+05, 3.8421e+05,
        3.9295e+05, 3.9306e+05, 4.0142e+05, 4.0822e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.5174e-01, 7.5596e-01, 7.8292e-01, 8.0491e-01, 8.7543e-01,
        9.6627e-01, 1.0182e+00, 1.0287e+00, 1.0938e+00, 3.7869e+05, 3.8420e+05,
        3.9295e+05, 3.9304e+05, 4.0144e+05, 4.0819e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.8767e-01, 7.1411e-01, 7.7055e-01, 7.8292e-01, 9.2195e-01,
        9.5576e-01, 9.9200e-01, 1.0748e+00, 1.0890e+00, 3.7868e+05, 3.8420e+05,
        3.9296e+05, 3.9303e+05, 4.0143e+05, 4.0821e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.4384e-01, 7.6129e-01, 7.7055e-01, 8.0491e-01, 8.9101e-01,
        9.1608e-01, 9.4995e-01, 1.0411e+00, 1.0884e+00, 3.7868e+05, 3.8421e+05,
        3.9294e+05, 3.9307e+05, 4.0145e+05, 4.0822e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7543e-01, 8.9101e-01, 9.2374e-01, 9.3400e-01, 9.3601e-01,
        9.5576e-01, 9.7317e-01, 1.0774e+00, 1.3368e+00, 3.7869e+05, 3.8422e+05,
        3.9294e+05, 3.9305e+05, 4.0145e+05, 4.0820e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384161.5938, 384167.4375, 384197.2500, 384198.9375,
        384200.0938, 384206.5938, 384211.9375, 384213.7188, 384222.3125,
        384240.8438, 761754.0000, 782079.7500, 785742.5625, 786067.2500,
        790714.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393033.7500, 393043.0938, 393051.2188, 393051.9375,
        393052.1875, 393060.9062, 393061.9375, 393067.5938, 393067.7188,
        393080.5625, 775560.5625, 781185.2500, 782079.7500, 795237.4375,
        795727.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2374e-01, 9.4995e-01, 9.6940e-01, 9.9200e-01, 9.9594e-01,
        1.0168e+00, 1.0182e+00, 1.2734e+00, 1.4270e+00, 3.7867e+05, 3.8421e+05,
        3.9297e+05, 3.9308e+05, 4.0146e+05, 4.0820e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.3802e-01, 6.0897e-01, 7.1411e-01, 7.5174e-01, 7.6129e-01,
        1.0774e+00, 1.2734e+00, 1.3196e+00, 1.4077e+00, 3.7870e+05, 3.8417e+05,
        3.9294e+05, 3.9305e+05, 4.0147e+05, 4.0822e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 378669.2812, 378681.5000, 378682.9062, 378685.3750,
        378689.1875, 378694.6875, 378695.3438, 378698.8750, 378699.8750,
        378705.9688, 761649.3750, 761754.0000, 775560.5625, 781090.9375,
        802012.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.0897e-01, 6.8767e-01, 7.4384e-01, 7.5596e-01, 7.8159e-01,
        9.3601e-01, 1.0168e+00, 1.0685e+00, 1.1283e+00, 3.7871e+05, 3.8420e+05,
        3.9296e+05, 3.9306e+05, 4.0147e+05, 4.0821e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.5069e-01, 9.7317e-01, 9.9594e-01, 1.0748e+00, 1.0884e+00,
        1.0938e+00, 1.1283e+00, 1.4077e+00, 1.6313e+00, 3.7870e+05, 3.8424e+05,
        3.9298e+05, 3.9307e+05, 4.0145e+05, 4.0820e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 408189.6875, 408199.2188, 408203.1250, 408204.8438,
        408208.7500, 408212.7500, 408216.3125, 408218.3125, 408220.1250,
        408230.4688, 785742.5625, 792336.0000, 795237.4375, 802012.8750,
        809794.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392931.0312, 392936.8438, 392937.7188, 392943.8750,
        392950.7500, 392951.4375, 392956.9375, 392957.3125, 392969.4375,
        392977.9375, 781090.9375, 781185.2500, 786067.2500, 800181.8125,
        809794.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401420.5312, 401430.9688, 401438.7500, 401446.5000,
        401447.0625, 401453.6562, 401464.8125, 401466.2500, 401474.9375,
        401476.6250, 761649.3750, 790714.1875, 792336.0000, 795727.5000,
        800181.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.3802e-01, 7.8159e-01, 9.1608e-01, 9.2195e-01, 9.6627e-01,
        1.3368e+00, 1.4270e+00, 1.5317e+00, 1.6313e+00, 3.7870e+05, 3.8416e+05,
        3.9293e+05, 3.9305e+05, 4.0148e+05, 4.0823e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37869.53', '37869.73', '37868.95', '37869.09', '37870.36', '384202.06', '393057.09', '37867.89', '37870.38', '378690.31', '37871.37', '37871.02', '408210.34', '392951.34', '401452.03', '37870.89']
estimated f for each client, fs: [6, 6, 6, 6, 6, 4, 4, 6, 6, 5, 6, 6, 4, 4, 4, 6]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 4, 5, 10, 8, 19, 14, 3, 11, 20, 12, 1, 13, 15, 16, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0118s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:44...
global Accuracy on shared test data: 73.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 74 189]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 16:00:44, End: 2025-07-22 16:00:44)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 6, 13, 1, 20, 18, 9, 12, 16, 2, 3, 17, 19, 15, 11, 10], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1258e+00, 4.0032e+05, 1.0379e+00, 3.9390e+05, 3.9105e+05,
         1.2868e+00, 1.0753e+00, 3.9032e+05, 9.4737e-01, 1.2105e+00, 3.9226e+05,
         3.9918e+05, 3.9450e+05, 1.1308e+00, 1.0345e+00],
        [1.1258e+00, 0.0000e+00, 4.0032e+05, 1.0191e+00, 3.9388e+05, 3.9100e+05,
         1.8041e+00, 1.4686e+00, 3.9034e+05, 9.8002e-01, 1.6069e+00, 3.9223e+05,
         3.9918e+05, 3.9452e+05, 1.6195e+00, 1.3873e+00],
        [4.0032e+05, 4.0032e+05, 0.0000e+00, 4.0032e+05, 7.9395e+05, 8.1695e+05,
         4.0027e+05, 4.0028e+05, 7.9753e+05, 4.0031e+05, 4.0029e+05, 7.7878e+05,
         7.9044e+05, 7.8215e+05, 4.0027e+05, 4.0031e+05],
        [1.0379e+00, 1.0191e+00, 4.0032e+05, 0.0000e+00, 3.9389e+05, 3.9101e+05,
         1.5493e+00, 1.2905e+00, 3.9032e+05, 1.0076e+00, 1.4087e+00, 3.9223e+05,
         3.9917e+05, 3.9453e+05, 1.4101e+00, 1.2312e+00],
        [3.9390e+05, 3.9388e+05, 7.9395e+05, 3.9389e+05, 0.0000e+00, 7.9986e+05,
         3.9388e+05, 3.9389e+05, 7.9226e+05, 3.9389e+05, 3.9386e+05, 7.8958e+05,
         7.9281e+05, 8.0335e+05, 3.9388e+05, 3.9390e+05],
        [3.9105e+05, 3.9100e+05, 8.1695e+05, 3.9101e+05, 7.9986e+05, 0.0000e+00,
         3.9105e+05, 3.9104e+05, 7.9747e+05, 3.9102e+05, 3.9107e+05, 7.7490e+05,
         8.1006e+05, 7.7031e+05, 3.9106e+05, 3.9103e+05],
        [1.2868e+00, 1.8041e+00, 4.0027e+05, 1.5493e+00, 3.9388e+05, 3.9105e+05,
         0.0000e+00, 7.7649e-01, 3.9035e+05, 1.4151e+00, 8.4894e-01, 3.9222e+05,
         3.9912e+05, 3.9452e+05, 5.6763e-01, 8.4736e-01],
        [1.0753e+00, 1.4686e+00, 4.0028e+05, 1.2905e+00, 3.9389e+05, 3.9104e+05,
         7.7649e-01, 0.0000e+00, 3.9035e+05, 1.1814e+00, 9.1700e-01, 3.9224e+05,
         3.9913e+05, 3.9453e+05, 7.1310e-01, 8.5992e-01],
        [3.9032e+05, 3.9034e+05, 7.9753e+05, 3.9032e+05, 7.9226e+05, 7.9747e+05,
         3.9035e+05, 3.9035e+05, 0.0000e+00, 3.9033e+05, 3.9033e+05, 7.7944e+05,
         7.7591e+05, 7.8431e+05, 3.9035e+05, 3.9036e+05],
        [9.4737e-01, 9.8002e-01, 4.0031e+05, 1.0076e+00, 3.9389e+05, 3.9102e+05,
         1.4151e+00, 1.1814e+00, 3.9033e+05, 0.0000e+00, 1.2726e+00, 3.9222e+05,
         3.9918e+05, 3.9451e+05, 1.2917e+00, 1.1497e+00],
        [1.2105e+00, 1.6069e+00, 4.0029e+05, 1.4087e+00, 3.9386e+05, 3.9107e+05,
         8.4894e-01, 9.1700e-01, 3.9033e+05, 1.2726e+00, 0.0000e+00, 3.9223e+05,
         3.9916e+05, 3.9451e+05, 8.4488e-01, 9.4465e-01],
        [3.9226e+05, 3.9223e+05, 7.7878e+05, 3.9223e+05, 7.8958e+05, 7.7490e+05,
         3.9222e+05, 3.9224e+05, 7.7944e+05, 3.9222e+05, 3.9223e+05, 0.0000e+00,
         8.1899e+05, 7.7117e+05, 3.9223e+05, 3.9224e+05],
        [3.9918e+05, 3.9918e+05, 7.9044e+05, 3.9917e+05, 7.9281e+05, 8.1006e+05,
         3.9912e+05, 3.9913e+05, 7.7591e+05, 3.9918e+05, 3.9916e+05, 8.1899e+05,
         0.0000e+00, 8.0711e+05, 3.9913e+05, 3.9914e+05],
        [3.9450e+05, 3.9452e+05, 7.8215e+05, 3.9453e+05, 8.0335e+05, 7.7031e+05,
         3.9452e+05, 3.9453e+05, 7.8431e+05, 3.9451e+05, 3.9451e+05, 7.7117e+05,
         8.0711e+05, 0.0000e+00, 3.9451e+05, 3.9450e+05],
        [1.1308e+00, 1.6195e+00, 4.0027e+05, 1.4101e+00, 3.9388e+05, 3.9106e+05,
         5.6763e-01, 7.1310e-01, 3.9035e+05, 1.2917e+00, 8.4488e-01, 3.9223e+05,
         3.9913e+05, 3.9451e+05, 0.0000e+00, 8.1214e-01],
        [1.0345e+00, 1.3873e+00, 4.0031e+05, 1.2312e+00, 3.9390e+05, 3.9103e+05,
         8.4736e-01, 8.5992e-01, 3.9036e+05, 1.1497e+00, 9.4465e-01, 3.9224e+05,
         3.9914e+05, 3.9450e+05, 8.1214e-01, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.4737e-01, 1.0345e+00, 1.0379e+00, 1.0753e+00, 1.1258e+00,
        1.1308e+00, 1.2105e+00, 1.2868e+00, 3.9032e+05, 3.9105e+05, 3.9226e+05,
        3.9390e+05, 3.9450e+05, 3.9918e+05, 4.0032e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8002e-01, 1.0191e+00, 1.1258e+00, 1.3873e+00, 1.4686e+00,
        1.6069e+00, 1.6195e+00, 1.8041e+00, 3.9034e+05, 3.9100e+05, 3.9223e+05,
        3.9388e+05, 3.9452e+05, 3.9918e+05, 4.0032e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400269.0312, 400271.5312, 400275.6562, 400286.0938,
        400307.0625, 400309.5312, 400315.9375, 400318.0625, 400319.2812,
        778785.0000, 782150.9375, 790443.4375, 793951.5000, 797532.5625,
        816947.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0076e+00, 1.0191e+00, 1.0379e+00, 1.2312e+00, 1.2905e+00,
        1.4087e+00, 1.4101e+00, 1.5493e+00, 3.9032e+05, 3.9101e+05, 3.9223e+05,
        3.9389e+05, 3.9453e+05, 3.9917e+05, 4.0032e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393861.8125, 393878.1250, 393878.5625, 393882.6250,
        393886.3125, 393888.2812, 393888.9688, 393898.8750, 393900.6875,
        789578.6250, 792261.8125, 792810.6250, 793951.5000, 799862.1875,
        803347.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391001.1875, 391013.3125, 391021.7500, 391032.6562,
        391035.9062, 391053.5312, 391053.9062, 391059.1562, 391071.2500,
        770311.8750, 774902.1250, 797468.5000, 799862.1875, 810058.1875,
        816947.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.6763e-01, 7.7649e-01, 8.4736e-01, 8.4894e-01, 1.2868e+00,
        1.4151e+00, 1.5493e+00, 1.8041e+00, 3.9035e+05, 3.9105e+05, 3.9222e+05,
        3.9388e+05, 3.9452e+05, 3.9912e+05, 4.0027e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.1310e-01, 7.7649e-01, 8.5992e-01, 9.1700e-01, 1.0753e+00,
        1.1814e+00, 1.2905e+00, 1.4686e+00, 3.9035e+05, 3.9104e+05, 3.9224e+05,
        3.9389e+05, 3.9453e+05, 3.9913e+05, 4.0028e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390323.7812, 390323.9688, 390326.0625, 390334.5625,
        390344.7188, 390345.5312, 390349.8438, 390353.4688, 390356.0000,
        775909.6250, 779439.5625, 784310.5625, 792261.8125, 797468.5000,
        797532.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4737e-01, 9.8002e-01, 1.0076e+00, 1.1497e+00, 1.1814e+00,
        1.2726e+00, 1.2917e+00, 1.4151e+00, 3.9033e+05, 3.9102e+05, 3.9222e+05,
        3.9389e+05, 3.9451e+05, 3.9918e+05, 4.0031e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4488e-01, 8.4894e-01, 9.1700e-01, 9.4465e-01, 1.2105e+00,
        1.2726e+00, 1.4087e+00, 1.6069e+00, 3.9033e+05, 3.9107e+05, 3.9223e+05,
        3.9386e+05, 3.9451e+05, 3.9916e+05, 4.0029e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392216.8125, 392221.1250, 392226.6875, 392226.8438,
        392231.9375, 392233.1875, 392243.0938, 392244.0938, 392259.1250,
        771165.3125, 774902.1250, 778785.0000, 779439.5625, 789578.6250,
        818993.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399123.1562, 399131.8438, 399132.6875, 399136.2500,
        399162.5938, 399166.6875, 399175.0938, 399177.6250, 399178.0000,
        775909.6250, 790443.4375, 792810.6250, 807111.2500, 810058.1875,
        818993.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394500.5938, 394503.2812, 394505.7500, 394508.0938,
        394510.7188, 394516.6250, 394522.3438, 394525.9375, 394526.8750,
        770311.8750, 771165.3125, 782150.9375, 784310.5625, 803347.9375,
        807111.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.6763e-01, 7.1310e-01, 8.1214e-01, 8.4488e-01, 1.1308e+00,
        1.2917e+00, 1.4101e+00, 1.6195e+00, 3.9035e+05, 3.9106e+05, 3.9223e+05,
        3.9388e+05, 3.9451e+05, 3.9913e+05, 4.0027e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.1214e-01, 8.4736e-01, 8.5992e-01, 9.4465e-01, 1.0345e+00,
        1.1497e+00, 1.2312e+00, 1.3873e+00, 3.9036e+05, 3.9103e+05, 3.9224e+05,
        3.9390e+05, 3.9450e+05, 3.9914e+05, 4.0031e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['78138.66', '78135.69', '438145.69', '78134.73', '433454.31', '428965.44', '78141.62', '78139.40', '428896.75', '78136.55', '78140.64', '430126.81', '436829.34', '432093.19', '78141.31', '78139.70']
estimated f for each client, fs: [7, 7, 5, 7, 6, 5, 7, 7, 5, 7, 7, 5, 5, 5, 7, 7]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 6, 13, 1, 20, 18, 9, 12, 16, 2, 3, 17, 19, 15, 11, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0112s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:44...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 72 191]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:44, End: 2025-07-22 16:00:44)
start time is: 99008306309611, end time is: 99026435877755
The total time is: 18129568144ns.

 ------- aggregate method: rkrum, random_seed: 200 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 14, 11, 12, 13, 9, 6, 10, 17, 16, 3, 15, 2, 19, 8, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0161e+05, 4.9418e+00, 4.1573e+00, 3.9653e+05, 4.5722e+00,
         5.1285e+00, 4.3208e+00, 3.8771e+05, 3.8920e+05, 4.3973e+00, 3.7054e+05,
         4.1875e+00, 3.8975e+05, 4.7372e+00, 3.9762e+05],
        [4.0161e+05, 0.0000e+00, 4.0165e+05, 4.0161e+05, 8.1266e+05, 4.0162e+05,
         4.0159e+05, 4.0164e+05, 7.7724e+05, 7.8400e+05, 4.0161e+05, 7.6843e+05,
         4.0162e+05, 7.9593e+05, 4.0166e+05, 8.1257e+05],
        [4.9418e+00, 4.0165e+05, 0.0000e+00, 4.5788e+00, 3.9644e+05, 4.0040e+00,
         4.3406e+00, 3.9373e+00, 3.8772e+05, 3.8928e+05, 5.0614e+00, 3.7055e+05,
         3.8505e+00, 3.8977e+05, 4.2621e+00, 3.9758e+05],
        [4.1573e+00, 4.0161e+05, 4.5788e+00, 0.0000e+00, 3.9649e+05, 5.2137e+00,
         5.0134e+00, 3.9523e+00, 3.8770e+05, 3.8931e+05, 3.8466e+00, 3.7054e+05,
         4.3327e+00, 3.8973e+05, 4.4226e+00, 3.9764e+05],
        [3.9653e+05, 8.1266e+05, 3.9644e+05, 3.9649e+05, 0.0000e+00, 3.9649e+05,
         3.9643e+05, 3.9645e+05, 7.8374e+05, 7.9018e+05, 3.9646e+05, 7.5778e+05,
         3.9646e+05, 7.8728e+05, 3.9641e+05, 7.9604e+05],
        [4.5722e+00, 4.0162e+05, 4.0040e+00, 5.2137e+00, 3.9649e+05, 0.0000e+00,
         4.1582e+00, 4.2448e+00, 3.8771e+05, 3.8929e+05, 4.8227e+00, 3.7056e+05,
         3.9056e+00, 3.8976e+05, 4.4285e+00, 3.9763e+05],
        [5.1285e+00, 4.0159e+05, 4.3406e+00, 5.0134e+00, 3.9643e+05, 4.1582e+00,
         0.0000e+00, 4.0560e+00, 3.8768e+05, 3.8926e+05, 5.1905e+00, 3.7055e+05,
         4.2014e+00, 3.8968e+05, 4.8037e+00, 3.9762e+05],
        [4.3208e+00, 4.0164e+05, 3.9373e+00, 3.9523e+00, 3.9645e+05, 4.2448e+00,
         4.0560e+00, 0.0000e+00, 3.8769e+05, 3.8924e+05, 4.2435e+00, 3.7051e+05,
         3.6888e+00, 3.8980e+05, 4.1207e+00, 3.9762e+05],
        [3.8771e+05, 7.7724e+05, 3.8772e+05, 3.8770e+05, 7.8374e+05, 3.8771e+05,
         3.8768e+05, 3.8769e+05, 0.0000e+00, 7.7221e+05, 3.8767e+05, 7.5175e+05,
         3.8769e+05, 7.7875e+05, 3.8771e+05, 7.7230e+05],
        [3.8920e+05, 7.8400e+05, 3.8928e+05, 3.8931e+05, 7.9018e+05, 3.8929e+05,
         3.8926e+05, 3.8924e+05, 7.7221e+05, 0.0000e+00, 3.8919e+05, 7.7290e+05,
         3.8924e+05, 7.8365e+05, 3.8928e+05, 7.6661e+05],
        [4.3973e+00, 4.0161e+05, 5.0614e+00, 3.8466e+00, 3.9646e+05, 4.8227e+00,
         5.1905e+00, 4.2435e+00, 3.8767e+05, 3.8919e+05, 0.0000e+00, 3.7056e+05,
         4.4168e+00, 3.8979e+05, 4.7890e+00, 3.9760e+05],
        [3.7054e+05, 7.6843e+05, 3.7055e+05, 3.7054e+05, 7.5778e+05, 3.7056e+05,
         3.7055e+05, 3.7051e+05, 7.5175e+05, 7.7290e+05, 3.7056e+05, 0.0000e+00,
         3.7054e+05, 7.6762e+05, 3.7054e+05, 7.7612e+05],
        [4.1875e+00, 4.0162e+05, 3.8505e+00, 4.3327e+00, 3.9646e+05, 3.9056e+00,
         4.2014e+00, 3.6888e+00, 3.8769e+05, 3.8924e+05, 4.4168e+00, 3.7054e+05,
         0.0000e+00, 3.8976e+05, 4.1526e+00, 3.9761e+05],
        [3.8975e+05, 7.9593e+05, 3.8977e+05, 3.8973e+05, 7.8728e+05, 3.8976e+05,
         3.8968e+05, 3.8980e+05, 7.7875e+05, 7.8365e+05, 3.8979e+05, 7.6762e+05,
         3.8976e+05, 0.0000e+00, 3.8980e+05, 7.7881e+05],
        [4.7372e+00, 4.0166e+05, 4.2621e+00, 4.4226e+00, 3.9641e+05, 4.4285e+00,
         4.8037e+00, 4.1207e+00, 3.8771e+05, 3.8928e+05, 4.7890e+00, 3.7054e+05,
         4.1526e+00, 3.8980e+05, 0.0000e+00, 3.9765e+05],
        [3.9762e+05, 8.1257e+05, 3.9758e+05, 3.9764e+05, 7.9604e+05, 3.9763e+05,
         3.9762e+05, 3.9762e+05, 7.7230e+05, 7.6661e+05, 3.9760e+05, 7.7612e+05,
         3.9761e+05, 7.7881e+05, 3.9765e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 4.1573e+00, 4.1875e+00, 4.3208e+00, 4.3973e+00, 4.5722e+00,
        4.7372e+00, 4.9418e+00, 5.1285e+00, 3.7054e+05, 3.8771e+05, 3.8920e+05,
        3.8975e+05, 3.9653e+05, 3.9762e+05, 4.0161e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401593.4688, 401605.5938, 401608.8125, 401610.5625,
        401620.0625, 401621.0938, 401639.5312, 401651.0938, 401655.2500,
        768433.2500, 777239.7500, 783998.6250, 795932.1250, 812573.3750,
        812659.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.8505e+00, 3.9373e+00, 4.0040e+00, 4.2621e+00, 4.3406e+00,
        4.5788e+00, 4.9418e+00, 5.0614e+00, 3.7055e+05, 3.8772e+05, 3.8928e+05,
        3.8977e+05, 3.9644e+05, 3.9758e+05, 4.0165e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.8466e+00, 3.9523e+00, 4.1573e+00, 4.3327e+00, 4.4226e+00,
        4.5788e+00, 5.0134e+00, 5.2137e+00, 3.7054e+05, 3.8770e+05, 3.8931e+05,
        3.8973e+05, 3.9649e+05, 3.9764e+05, 4.0161e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396408.0625, 396425.0625, 396442.5938, 396445.4688,
        396456.1562, 396457.2500, 396488.8438, 396492.4062, 396527.8125,
        757780.3750, 783743.9375, 787280.8750, 790177.0000, 796036.9375,
        812659.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.9056e+00, 4.0040e+00, 4.1582e+00, 4.2448e+00, 4.4285e+00,
        4.5722e+00, 4.8227e+00, 5.2137e+00, 3.7056e+05, 3.8771e+05, 3.8929e+05,
        3.8976e+05, 3.9649e+05, 3.9763e+05, 4.0162e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.0560e+00, 4.1582e+00, 4.2014e+00, 4.3406e+00, 4.8037e+00,
        5.0134e+00, 5.1285e+00, 5.1905e+00, 3.7055e+05, 3.8768e+05, 3.8926e+05,
        3.8968e+05, 3.9643e+05, 3.9762e+05, 4.0159e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6888e+00, 3.9373e+00, 3.9523e+00, 4.0560e+00, 4.1207e+00,
        4.2435e+00, 4.2448e+00, 4.3208e+00, 3.7051e+05, 3.8769e+05, 3.8924e+05,
        3.8980e+05, 3.9645e+05, 3.9762e+05, 4.0164e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387672.0000, 387683.5938, 387686.0312, 387688.8750,
        387699.2812, 387707.3125, 387711.0625, 387711.5312, 387724.0938,
        751747.4375, 772209.0000, 772303.1875, 777239.7500, 778749.0000,
        783743.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389185.9062, 389195.0938, 389237.4375, 389243.1250,
        389263.4062, 389280.3125, 389284.6562, 389292.9375, 389310.8125,
        766613.5000, 772209.0000, 772899.1250, 783651.2500, 783998.6250,
        790177.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.8466e+00, 4.2435e+00, 4.3973e+00, 4.4168e+00, 4.7890e+00,
        4.8227e+00, 5.0614e+00, 5.1905e+00, 3.7056e+05, 3.8767e+05, 3.8919e+05,
        3.8979e+05, 3.9646e+05, 3.9760e+05, 4.0161e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 370514.1875, 370536.3125, 370538.0312, 370540.5625,
        370543.0000, 370546.5625, 370550.3750, 370557.8438, 370558.5000,
        751747.4375, 757780.3750, 767616.5625, 768433.2500, 772899.1250,
        776120.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6888e+00, 3.8505e+00, 3.9056e+00, 4.1526e+00, 4.1875e+00,
        4.2014e+00, 4.3327e+00, 4.4168e+00, 3.7054e+05, 3.8769e+05, 3.8924e+05,
        3.8976e+05, 3.9646e+05, 3.9761e+05, 4.0162e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389676.6250, 389733.4062, 389751.5000, 389756.5000,
        389764.8125, 389768.0625, 389790.1250, 389797.9688, 389800.7500,
        767616.5625, 778749.0000, 778806.3750, 783651.2500, 787280.8750,
        795932.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.1207e+00, 4.1526e+00, 4.2621e+00, 4.4226e+00, 4.4285e+00,
        4.7372e+00, 4.7890e+00, 4.8037e+00, 3.7054e+05, 3.8771e+05, 3.8928e+05,
        3.8980e+05, 3.9641e+05, 3.9765e+05, 4.0166e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397578.1875, 397601.5000, 397607.8750, 397615.6250,
        397616.1875, 397623.4688, 397630.5625, 397639.6562, 397646.6562,
        766613.5000, 772303.1875, 776120.1250, 778806.3750, 796036.9375,
        812573.3750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75828.38', '438303.84', '75830.95', '75827.28', '432592.41', '75830.05', '75826.70', '75823.56', '424103.09', '426990.75', '75826.73', '408663.28', '75826.17', '427545.59', '75828.79', '434517.31']
estimated f for each client, fs: [7, 5, 7, 7, 5, 7, 7, 7, 5, 5, 7, 6, 7, 5, 7, 5]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 14, 11, 12, 13, 9, 6, 10, 17, 16, 3, 15, 2, 19, 8, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0233s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:45...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:45, End: 2025-07-22 16:00:45)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 19, 4, 15, 10, 18, 1, 17, 20, 8, 2, 12, 3, 5, 6, 7], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 8.2132e+05, 4.0709e+05, 7.9435e+05, 4.0711e+05, 8.0546e+05,
         4.0707e+05, 8.0512e+05, 7.9520e+05, 4.0710e+05, 4.0710e+05, 4.0708e+05,
         4.0710e+05, 4.0713e+05, 4.0706e+05, 4.0710e+05],
        [8.2132e+05, 0.0000e+00, 3.9742e+05, 8.0845e+05, 3.9744e+05, 7.7848e+05,
         3.9742e+05, 7.9130e+05, 7.9628e+05, 3.9742e+05, 3.9739e+05, 3.9744e+05,
         3.9740e+05, 3.9741e+05, 3.9739e+05, 3.9742e+05],
        [4.0709e+05, 3.9742e+05, 0.0000e+00, 3.9694e+05, 2.0105e+00, 3.8665e+05,
         2.0382e+00, 3.9288e+05, 3.8768e+05, 1.8661e+00, 1.8525e+00, 1.8982e+00,
         2.0106e+00, 1.9222e+00, 1.8598e+00, 1.9142e+00],
        [7.9435e+05, 8.0845e+05, 3.9694e+05, 0.0000e+00, 3.9696e+05, 7.7864e+05,
         3.9695e+05, 7.8057e+05, 8.0941e+05, 3.9693e+05, 3.9691e+05, 3.9694e+05,
         3.9698e+05, 3.9695e+05, 3.9696e+05, 3.9696e+05],
        [4.0711e+05, 3.9744e+05, 2.0105e+00, 3.9696e+05, 0.0000e+00, 3.8666e+05,
         1.9488e+00, 3.9288e+05, 3.8767e+05, 2.0198e+00, 1.8190e+00, 1.8314e+00,
         1.8960e+00, 1.9347e+00, 2.0515e+00, 1.8894e+00],
        [8.0546e+05, 7.7848e+05, 3.8665e+05, 7.7864e+05, 3.8666e+05, 0.0000e+00,
         3.8667e+05, 7.6684e+05, 7.6791e+05, 3.8664e+05, 3.8665e+05, 3.8665e+05,
         3.8666e+05, 3.8664e+05, 3.8670e+05, 3.8663e+05],
        [4.0707e+05, 3.9742e+05, 2.0382e+00, 3.9695e+05, 1.9488e+00, 3.8667e+05,
         0.0000e+00, 3.9290e+05, 3.8768e+05, 2.0577e+00, 1.8259e+00, 1.9202e+00,
         2.0733e+00, 1.9465e+00, 1.9111e+00, 1.8877e+00],
        [8.0512e+05, 7.9130e+05, 3.9288e+05, 7.8057e+05, 3.9288e+05, 7.6684e+05,
         3.9290e+05, 0.0000e+00, 7.7594e+05, 3.9292e+05, 3.9288e+05, 3.9290e+05,
         3.9291e+05, 3.9290e+05, 3.9291e+05, 3.9290e+05],
        [7.9520e+05, 7.9628e+05, 3.8768e+05, 8.0941e+05, 3.8767e+05, 7.6791e+05,
         3.8768e+05, 7.7594e+05, 0.0000e+00, 3.8766e+05, 3.8769e+05, 3.8769e+05,
         3.8766e+05, 3.8771e+05, 3.8768e+05, 3.8773e+05],
        [4.0710e+05, 3.9742e+05, 1.8661e+00, 3.9693e+05, 2.0198e+00, 3.8664e+05,
         2.0577e+00, 3.9292e+05, 3.8766e+05, 0.0000e+00, 2.0861e+00, 1.9589e+00,
         1.9919e+00, 2.0941e+00, 1.9967e+00, 2.0020e+00],
        [4.0710e+05, 3.9739e+05, 1.8525e+00, 3.9691e+05, 1.8190e+00, 3.8665e+05,
         1.8259e+00, 3.9288e+05, 3.8769e+05, 2.0861e+00, 0.0000e+00, 1.8266e+00,
         1.8580e+00, 1.9445e+00, 1.7916e+00, 1.7666e+00],
        [4.0708e+05, 3.9744e+05, 1.8982e+00, 3.9694e+05, 1.8314e+00, 3.8665e+05,
         1.9202e+00, 3.9290e+05, 3.8769e+05, 1.9589e+00, 1.8266e+00, 0.0000e+00,
         1.7430e+00, 1.8491e+00, 1.9807e+00, 1.8647e+00],
        [4.0710e+05, 3.9740e+05, 2.0106e+00, 3.9698e+05, 1.8960e+00, 3.8666e+05,
         2.0733e+00, 3.9291e+05, 3.8766e+05, 1.9919e+00, 1.8580e+00, 1.7430e+00,
         0.0000e+00, 1.8509e+00, 2.0934e+00, 2.0020e+00],
        [4.0713e+05, 3.9741e+05, 1.9222e+00, 3.9695e+05, 1.9347e+00, 3.8664e+05,
         1.9465e+00, 3.9290e+05, 3.8771e+05, 2.0941e+00, 1.9445e+00, 1.8491e+00,
         1.8509e+00, 0.0000e+00, 2.0236e+00, 1.7758e+00],
        [4.0706e+05, 3.9739e+05, 1.8598e+00, 3.9696e+05, 2.0515e+00, 3.8670e+05,
         1.9111e+00, 3.9291e+05, 3.8768e+05, 1.9967e+00, 1.7916e+00, 1.9807e+00,
         2.0934e+00, 2.0236e+00, 0.0000e+00, 1.9998e+00],
        [4.0710e+05, 3.9742e+05, 1.9142e+00, 3.9696e+05, 1.8894e+00, 3.8663e+05,
         1.8877e+00, 3.9290e+05, 3.8773e+05, 2.0020e+00, 1.7666e+00, 1.8647e+00,
         2.0020e+00, 1.7758e+00, 1.9998e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 407061.4375, 407074.3438, 407083.3125, 407088.5312,
        407095.1875, 407095.4375, 407096.2188, 407102.9375, 407105.5938,
        407128.5312, 794354.3125, 795200.5000, 805120.8750, 805457.8125,
        821318.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397386.8438, 397390.2500, 397400.7812, 397414.4375,
        397419.3750, 397422.0000, 397422.2500, 397423.9375, 397442.0000,
        397444.8750, 778480.3750, 791295.8750, 796284.6875, 808447.2500,
        821318.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8525e+00, 1.8598e+00, 1.8661e+00, 1.8982e+00, 1.9142e+00,
        1.9222e+00, 2.0105e+00, 2.0106e+00, 2.0382e+00, 3.8665e+05, 3.8768e+05,
        3.9288e+05, 3.9694e+05, 3.9742e+05, 4.0709e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396909.3750, 396931.5625, 396937.2500, 396941.3125,
        396947.8125, 396948.0938, 396955.1562, 396958.4688, 396960.0625,
        396976.7188, 778639.0000, 780570.8750, 794354.3125, 808447.2500,
        809411.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8190e+00, 1.8314e+00, 1.8894e+00, 1.8960e+00, 1.9347e+00,
        1.9488e+00, 2.0105e+00, 2.0198e+00, 2.0515e+00, 3.8666e+05, 3.8767e+05,
        3.9288e+05, 3.9696e+05, 3.9744e+05, 4.0711e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386625.7812, 386636.8125, 386645.0000, 386646.3750,
        386648.0000, 386653.3750, 386660.0625, 386662.1250, 386673.7500,
        386695.2188, 766835.0000, 767913.0000, 778480.3750, 778639.0000,
        805457.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8259e+00, 1.8877e+00, 1.9111e+00, 1.9202e+00, 1.9465e+00,
        1.9488e+00, 2.0382e+00, 2.0577e+00, 2.0733e+00, 3.8667e+05, 3.8768e+05,
        3.9290e+05, 3.9695e+05, 3.9742e+05, 4.0707e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392881.7500, 392884.1875, 392884.7812, 392895.2188,
        392902.5312, 392903.6875, 392904.3125, 392908.0625, 392908.5938,
        392919.3438, 766835.0000, 775937.5000, 780570.8750, 791295.8750,
        805120.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387662.3750, 387663.5625, 387673.2188, 387679.7812,
        387681.0312, 387681.4688, 387686.9688, 387690.2812, 387711.9062,
        387727.9062, 767913.0000, 775937.5000, 795200.5000, 796284.6875,
        809411.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8661e+00, 1.9589e+00, 1.9919e+00, 1.9967e+00, 2.0020e+00,
        2.0198e+00, 2.0577e+00, 2.0861e+00, 2.0941e+00, 3.8664e+05, 3.8766e+05,
        3.9292e+05, 3.9693e+05, 3.9742e+05, 4.0710e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7666e+00, 1.7916e+00, 1.8190e+00, 1.8259e+00, 1.8266e+00,
        1.8525e+00, 1.8580e+00, 1.9445e+00, 2.0861e+00, 3.8665e+05, 3.8769e+05,
        3.9288e+05, 3.9691e+05, 3.9739e+05, 4.0710e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7430e+00, 1.8266e+00, 1.8314e+00, 1.8491e+00, 1.8647e+00,
        1.8982e+00, 1.9202e+00, 1.9589e+00, 1.9807e+00, 3.8665e+05, 3.8769e+05,
        3.9290e+05, 3.9694e+05, 3.9744e+05, 4.0708e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7430e+00, 1.8509e+00, 1.8580e+00, 1.8960e+00, 1.9919e+00,
        2.0020e+00, 2.0106e+00, 2.0733e+00, 2.0934e+00, 3.8666e+05, 3.8766e+05,
        3.9291e+05, 3.9698e+05, 3.9740e+05, 4.0710e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7758e+00, 1.8491e+00, 1.8509e+00, 1.9222e+00, 1.9347e+00,
        1.9445e+00, 1.9465e+00, 2.0236e+00, 2.0941e+00, 3.8664e+05, 3.8771e+05,
        3.9290e+05, 3.9695e+05, 3.9741e+05, 4.0713e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7916e+00, 1.8598e+00, 1.9111e+00, 1.9807e+00, 1.9967e+00,
        1.9998e+00, 2.0236e+00, 2.0515e+00, 2.0934e+00, 3.8670e+05, 3.8768e+05,
        3.9291e+05, 3.9696e+05, 3.9739e+05, 4.0706e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7666e+00, 1.7758e+00, 1.8647e+00, 1.8877e+00, 1.8894e+00,
        1.9142e+00, 1.9998e+00, 2.0020e+00, 2.0020e+00, 3.8663e+05, 3.8773e+05,
        3.9290e+05, 3.9696e+05, 3.9742e+05, 4.0710e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['407093.19', '397416.69', '38666.54', '396946.56', '38667.95', '386654.66', '38669.13', '392899.25', '387685.84', '38665.49', '38667.01', '38666.32', '38667.76', '38666.23', '38671.29', '38664.29']
estimated f for each client, fs: [4, 4, 6, 4, 6, 4, 6, 4, 4, 6, 6, 6, 6, 6, 6, 6]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [14, 19, 4, 15, 10, 18, 1, 17, 20, 8, 2, 12, 3, 5, 6, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0212s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:45...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:45, End: 2025-07-22 16:00:45)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 20, 5, 14, 15, 17, 3, 1, 4, 19, 13, 6, 8, 9, 12, 2], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8117e+05, 1.7100e+00, 3.9354e+05, 3.8348e+05, 3.9766e+05,
         1.8414e+00, 1.7905e+00, 1.8773e+00, 4.0293e+05, 4.0092e+05, 1.8440e+00,
         1.8466e+00, 1.8268e+00, 1.7735e+00, 1.7174e+00],
        [3.8117e+05, 0.0000e+00, 3.8115e+05, 7.8925e+05, 7.5010e+05, 7.6985e+05,
         3.8116e+05, 3.8118e+05, 3.8116e+05, 7.7658e+05, 7.6803e+05, 3.8116e+05,
         3.8116e+05, 3.8116e+05, 3.8118e+05, 3.8120e+05],
        [1.7100e+00, 3.8115e+05, 0.0000e+00, 3.9354e+05, 3.8348e+05, 3.9762e+05,
         1.6943e+00, 1.7741e+00, 1.8198e+00, 4.0293e+05, 4.0093e+05, 1.8200e+00,
         1.9688e+00, 1.8787e+00, 1.7359e+00, 1.8142e+00],
        [3.9354e+05, 7.8925e+05, 3.9354e+05, 0.0000e+00, 7.4782e+05, 7.7852e+05,
         3.9351e+05, 3.9353e+05, 3.9352e+05, 8.0563e+05, 7.9524e+05, 3.9353e+05,
         3.9351e+05, 3.9349e+05, 3.9351e+05, 3.9352e+05],
        [3.8348e+05, 7.5010e+05, 3.8348e+05, 7.4782e+05, 0.0000e+00, 7.8490e+05,
         3.8347e+05, 3.8343e+05, 3.8343e+05, 8.0225e+05, 7.7250e+05, 3.8349e+05,
         3.8347e+05, 3.8345e+05, 3.8345e+05, 3.8347e+05],
        [3.9766e+05, 7.6985e+05, 3.9762e+05, 7.7852e+05, 7.8490e+05, 0.0000e+00,
         3.9762e+05, 3.9759e+05, 3.9762e+05, 8.1667e+05, 8.0606e+05, 3.9763e+05,
         3.9761e+05, 3.9762e+05, 3.9765e+05, 3.9765e+05],
        [1.8414e+00, 3.8116e+05, 1.6943e+00, 3.9351e+05, 3.8347e+05, 3.9762e+05,
         0.0000e+00, 1.9032e+00, 1.7429e+00, 4.0293e+05, 4.0088e+05, 1.8244e+00,
         1.7729e+00, 1.7325e+00, 1.6125e+00, 1.7274e+00],
        [1.7905e+00, 3.8118e+05, 1.7741e+00, 3.9353e+05, 3.8343e+05, 3.9759e+05,
         1.9032e+00, 0.0000e+00, 1.8728e+00, 4.0293e+05, 4.0088e+05, 1.6712e+00,
         1.8812e+00, 1.6171e+00, 1.7647e+00, 1.7584e+00],
        [1.8773e+00, 3.8116e+05, 1.8198e+00, 3.9352e+05, 3.8343e+05, 3.9762e+05,
         1.7429e+00, 1.8728e+00, 0.0000e+00, 4.0291e+05, 4.0088e+05, 1.7036e+00,
         1.8044e+00, 1.7473e+00, 1.7170e+00, 1.7932e+00],
        [4.0293e+05, 7.7658e+05, 4.0293e+05, 8.0563e+05, 8.0225e+05, 8.1667e+05,
         4.0293e+05, 4.0293e+05, 4.0291e+05, 0.0000e+00, 7.9949e+05, 4.0291e+05,
         4.0293e+05, 4.0294e+05, 4.0292e+05, 4.0291e+05],
        [4.0092e+05, 7.6803e+05, 4.0093e+05, 7.9524e+05, 7.7250e+05, 8.0606e+05,
         4.0088e+05, 4.0088e+05, 4.0088e+05, 7.9949e+05, 0.0000e+00, 4.0091e+05,
         4.0091e+05, 4.0092e+05, 4.0089e+05, 4.0087e+05],
        [1.8440e+00, 3.8116e+05, 1.8200e+00, 3.9353e+05, 3.8349e+05, 3.9763e+05,
         1.8244e+00, 1.6712e+00, 1.7036e+00, 4.0291e+05, 4.0091e+05, 0.0000e+00,
         1.8313e+00, 1.6926e+00, 1.7978e+00, 1.6506e+00],
        [1.8466e+00, 3.8116e+05, 1.9688e+00, 3.9351e+05, 3.8347e+05, 3.9761e+05,
         1.7729e+00, 1.8812e+00, 1.8044e+00, 4.0293e+05, 4.0091e+05, 1.8313e+00,
         0.0000e+00, 1.8579e+00, 1.8542e+00, 1.9086e+00],
        [1.8268e+00, 3.8116e+05, 1.8787e+00, 3.9349e+05, 3.8345e+05, 3.9762e+05,
         1.7325e+00, 1.6171e+00, 1.7473e+00, 4.0294e+05, 4.0092e+05, 1.6926e+00,
         1.8579e+00, 0.0000e+00, 1.7006e+00, 1.7510e+00],
        [1.7735e+00, 3.8118e+05, 1.7359e+00, 3.9351e+05, 3.8345e+05, 3.9765e+05,
         1.6125e+00, 1.7647e+00, 1.7170e+00, 4.0292e+05, 4.0089e+05, 1.7978e+00,
         1.8542e+00, 1.7006e+00, 0.0000e+00, 1.7292e+00],
        [1.7174e+00, 3.8120e+05, 1.8142e+00, 3.9352e+05, 3.8347e+05, 3.9765e+05,
         1.7274e+00, 1.7584e+00, 1.7932e+00, 4.0291e+05, 4.0087e+05, 1.6506e+00,
         1.9086e+00, 1.7510e+00, 1.7292e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7100e+00, 1.7174e+00, 1.7735e+00, 1.7905e+00, 1.8268e+00,
        1.8414e+00, 1.8440e+00, 1.8466e+00, 1.8773e+00, 3.8117e+05, 3.8348e+05,
        3.9354e+05, 3.9766e+05, 4.0092e+05, 4.0293e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381154.0000, 381158.9375, 381160.2188, 381163.2500,
        381164.8125, 381164.8125, 381168.7500, 381178.3125, 381182.9688,
        381202.9375, 750102.2500, 768026.4375, 769845.6250, 776575.3125,
        789249.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6943e+00, 1.7100e+00, 1.7359e+00, 1.7741e+00, 1.8142e+00,
        1.8198e+00, 1.8200e+00, 1.8787e+00, 1.9688e+00, 3.8115e+05, 3.8348e+05,
        3.9354e+05, 3.9762e+05, 4.0093e+05, 4.0293e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393491.1875, 393507.2500, 393507.9375, 393514.7500,
        393515.5000, 393518.0625, 393525.3125, 393529.4062, 393535.9375,
        393541.8750, 747823.6875, 778520.8750, 789249.6250, 795238.3125,
        805627.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383428.0938, 383434.6562, 383450.5625, 383453.0312,
        383467.0000, 383468.1250, 383471.5625, 383480.7188, 383481.7500,
        383486.0000, 747823.6875, 750102.2500, 772499.0000, 784901.1250,
        802247.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397594.2500, 397612.5938, 397615.2188, 397618.8750,
        397619.5000, 397624.2500, 397631.1250, 397645.1562, 397647.3438,
        397664.1250, 769845.6250, 778520.8750, 784901.1250, 806055.5000,
        816666.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6125e+00, 1.6943e+00, 1.7274e+00, 1.7325e+00, 1.7429e+00,
        1.7729e+00, 1.8244e+00, 1.8414e+00, 1.9032e+00, 3.8116e+05, 3.8347e+05,
        3.9351e+05, 3.9762e+05, 4.0088e+05, 4.0293e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6171e+00, 1.6712e+00, 1.7584e+00, 1.7647e+00, 1.7741e+00,
        1.7905e+00, 1.8728e+00, 1.8812e+00, 1.9032e+00, 3.8118e+05, 3.8343e+05,
        3.9353e+05, 3.9759e+05, 4.0088e+05, 4.0293e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7036e+00, 1.7170e+00, 1.7429e+00, 1.7473e+00, 1.7932e+00,
        1.8044e+00, 1.8198e+00, 1.8728e+00, 1.8773e+00, 3.8116e+05, 3.8343e+05,
        3.9352e+05, 3.9762e+05, 4.0088e+05, 4.0291e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402905.9062, 402906.7812, 402911.4062, 402923.0312,
        402925.2188, 402925.2500, 402931.0625, 402931.0625, 402933.4375,
        402943.8438, 776575.3125, 799493.5625, 802247.3750, 805627.5625,
        816666.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400870.8750, 400882.8125, 400884.0938, 400884.7188,
        400885.6250, 400907.4688, 400908.6875, 400922.6875, 400924.1875,
        400926.8125, 768026.4375, 772499.0000, 795238.3125, 799493.5625,
        806055.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6506e+00, 1.6712e+00, 1.6926e+00, 1.7036e+00, 1.7978e+00,
        1.8200e+00, 1.8244e+00, 1.8313e+00, 1.8440e+00, 3.8116e+05, 3.8349e+05,
        3.9353e+05, 3.9763e+05, 4.0091e+05, 4.0291e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7729e+00, 1.8044e+00, 1.8313e+00, 1.8466e+00, 1.8542e+00,
        1.8579e+00, 1.8812e+00, 1.9086e+00, 1.9688e+00, 3.8116e+05, 3.8347e+05,
        3.9351e+05, 3.9761e+05, 4.0091e+05, 4.0293e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6171e+00, 1.6926e+00, 1.7006e+00, 1.7325e+00, 1.7473e+00,
        1.7510e+00, 1.8268e+00, 1.8579e+00, 1.8787e+00, 3.8116e+05, 3.8345e+05,
        3.9349e+05, 3.9762e+05, 4.0092e+05, 4.0294e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6125e+00, 1.7006e+00, 1.7170e+00, 1.7292e+00, 1.7359e+00,
        1.7647e+00, 1.7735e+00, 1.7978e+00, 1.8542e+00, 3.8118e+05, 3.8345e+05,
        3.9351e+05, 3.9765e+05, 4.0089e+05, 4.0292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6506e+00, 1.7174e+00, 1.7274e+00, 1.7292e+00, 1.7510e+00,
        1.7584e+00, 1.7932e+00, 1.8142e+00, 1.9086e+00, 3.8120e+05, 3.8347e+05,
        3.9352e+05, 3.9765e+05, 4.0087e+05, 4.0291e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38118.50', '381169.88', '38117.02', '393518.72', '383462.12', '397627.28', '38117.61', '38119.90', '38117.93', '402923.69', '400899.81', '38117.48', '38118.15', '38118.05', '38119.40', '38121.88']
estimated f for each client, fs: [6, 4, 6, 4, 4, 4, 6, 6, 6, 4, 4, 6, 6, 6, 6, 6]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 20, 5, 14, 15, 17, 3, 1, 4, 19, 13, 6, 8, 9, 12, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0116s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:46...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:46, End: 2025-07-22 16:00:46)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 8, 10, 5, 7, 17, 4, 18, 12, 6, 19, 20, 3, 2, 16, 14], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.7454e+00, 1.6907e+00, 1.7947e+00, 1.6036e+00, 4.0297e+05,
         1.6869e+00, 3.7911e+05, 1.6175e+00, 1.5874e+00, 3.8057e+05, 3.9063e+05,
         1.6473e+00, 1.5557e+00, 3.7747e+05, 3.7257e+05],
        [1.7454e+00, 0.0000e+00, 1.6723e+00, 1.9921e+00, 1.6179e+00, 4.0295e+05,
         1.6121e+00, 3.7912e+05, 1.6653e+00, 1.6371e+00, 3.8057e+05, 3.9067e+05,
         1.5995e+00, 1.7383e+00, 3.7745e+05, 3.7263e+05],
        [1.6907e+00, 1.6723e+00, 0.0000e+00, 1.6933e+00, 1.4715e+00, 4.0290e+05,
         1.7219e+00, 3.7911e+05, 1.5717e+00, 1.7547e+00, 3.8057e+05, 3.9062e+05,
         1.6015e+00, 1.5051e+00, 3.7748e+05, 3.7260e+05],
        [1.7947e+00, 1.9921e+00, 1.6933e+00, 0.0000e+00, 1.6380e+00, 4.0294e+05,
         1.8931e+00, 3.7913e+05, 1.7652e+00, 1.9977e+00, 3.8056e+05, 3.9062e+05,
         1.7531e+00, 1.8949e+00, 3.7749e+05, 3.7260e+05],
        [1.6036e+00, 1.6179e+00, 1.4715e+00, 1.6380e+00, 0.0000e+00, 4.0294e+05,
         1.6330e+00, 3.7912e+05, 1.5569e+00, 1.7315e+00, 3.8054e+05, 3.9065e+05,
         1.5958e+00, 1.5545e+00, 3.7747e+05, 3.7256e+05],
        [4.0297e+05, 4.0295e+05, 4.0290e+05, 4.0294e+05, 4.0294e+05, 0.0000e+00,
         4.0292e+05, 7.8710e+05, 4.0294e+05, 4.0294e+05, 7.8517e+05, 7.9324e+05,
         4.0292e+05, 4.0291e+05, 7.8197e+05, 7.8168e+05],
        [1.6869e+00, 1.6121e+00, 1.7219e+00, 1.8931e+00, 1.6330e+00, 4.0292e+05,
         0.0000e+00, 3.7912e+05, 1.5237e+00, 1.5539e+00, 3.8052e+05, 3.9068e+05,
         1.6265e+00, 1.5426e+00, 3.7745e+05, 3.7255e+05],
        [3.7911e+05, 3.7912e+05, 3.7911e+05, 3.7913e+05, 3.7912e+05, 7.8710e+05,
         3.7912e+05, 0.0000e+00, 3.7913e+05, 3.7914e+05, 7.5562e+05, 7.6559e+05,
         3.7911e+05, 3.7911e+05, 7.4478e+05, 7.4324e+05],
        [1.6175e+00, 1.6653e+00, 1.5717e+00, 1.7652e+00, 1.5569e+00, 4.0294e+05,
         1.5237e+00, 3.7913e+05, 0.0000e+00, 1.6994e+00, 3.8055e+05, 3.9061e+05,
         1.4956e+00, 1.6099e+00, 3.7745e+05, 3.7261e+05],
        [1.5874e+00, 1.6371e+00, 1.7547e+00, 1.9977e+00, 1.7315e+00, 4.0294e+05,
         1.5539e+00, 3.7914e+05, 1.6994e+00, 0.0000e+00, 3.8055e+05, 3.9065e+05,
         1.7001e+00, 1.5121e+00, 3.7746e+05, 3.7260e+05],
        [3.8057e+05, 3.8057e+05, 3.8057e+05, 3.8056e+05, 3.8054e+05, 7.8517e+05,
         3.8052e+05, 7.5562e+05, 3.8055e+05, 3.8055e+05, 0.0000e+00, 7.7539e+05,
         3.8059e+05, 3.8056e+05, 7.4626e+05, 7.3903e+05],
        [3.9063e+05, 3.9067e+05, 3.9062e+05, 3.9062e+05, 3.9065e+05, 7.9324e+05,
         3.9068e+05, 7.6559e+05, 3.9061e+05, 3.9065e+05, 7.7539e+05, 0.0000e+00,
         3.9062e+05, 3.9067e+05, 7.6964e+05, 7.6914e+05],
        [1.6473e+00, 1.5995e+00, 1.6015e+00, 1.7531e+00, 1.5958e+00, 4.0292e+05,
         1.6265e+00, 3.7911e+05, 1.4956e+00, 1.7001e+00, 3.8059e+05, 3.9062e+05,
         0.0000e+00, 1.5646e+00, 3.7747e+05, 3.7261e+05],
        [1.5557e+00, 1.7383e+00, 1.5051e+00, 1.8949e+00, 1.5545e+00, 4.0291e+05,
         1.5426e+00, 3.7911e+05, 1.6099e+00, 1.5121e+00, 3.8056e+05, 3.9067e+05,
         1.5646e+00, 0.0000e+00, 3.7750e+05, 3.7261e+05],
        [3.7747e+05, 3.7745e+05, 3.7748e+05, 3.7749e+05, 3.7747e+05, 7.8197e+05,
         3.7745e+05, 7.4478e+05, 3.7745e+05, 3.7746e+05, 7.4626e+05, 7.6964e+05,
         3.7747e+05, 3.7750e+05, 0.0000e+00, 7.4248e+05],
        [3.7257e+05, 3.7263e+05, 3.7260e+05, 3.7260e+05, 3.7256e+05, 7.8168e+05,
         3.7255e+05, 7.4324e+05, 3.7261e+05, 3.7260e+05, 7.3903e+05, 7.6914e+05,
         3.7261e+05, 3.7261e+05, 7.4248e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5557e+00, 1.5874e+00, 1.6036e+00, 1.6175e+00, 1.6473e+00,
        1.6869e+00, 1.6907e+00, 1.7454e+00, 1.7947e+00, 3.7257e+05, 3.7747e+05,
        3.7911e+05, 3.8057e+05, 3.9063e+05, 4.0297e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5995e+00, 1.6121e+00, 1.6179e+00, 1.6371e+00, 1.6653e+00,
        1.6723e+00, 1.7383e+00, 1.7454e+00, 1.9921e+00, 3.7263e+05, 3.7745e+05,
        3.7912e+05, 3.8057e+05, 3.9067e+05, 4.0295e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4715e+00, 1.5051e+00, 1.5717e+00, 1.6015e+00, 1.6723e+00,
        1.6907e+00, 1.6933e+00, 1.7219e+00, 1.7547e+00, 3.7260e+05, 3.7748e+05,
        3.7911e+05, 3.8057e+05, 3.9062e+05, 4.0290e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6380e+00, 1.6933e+00, 1.7531e+00, 1.7652e+00, 1.7947e+00,
        1.8931e+00, 1.8949e+00, 1.9921e+00, 1.9977e+00, 3.7260e+05, 3.7749e+05,
        3.7913e+05, 3.8056e+05, 3.9062e+05, 4.0294e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4715e+00, 1.5545e+00, 1.5569e+00, 1.5958e+00, 1.6036e+00,
        1.6179e+00, 1.6330e+00, 1.6380e+00, 1.7315e+00, 3.7256e+05, 3.7747e+05,
        3.7912e+05, 3.8054e+05, 3.9065e+05, 4.0294e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402902.6562, 402912.7188, 402918.0625, 402922.0625,
        402941.2188, 402942.0312, 402942.3750, 402943.2500, 402951.6875,
        402970.0000, 781677.5000, 781968.5625, 785172.2500, 787095.9375,
        793238.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5237e+00, 1.5426e+00, 1.5539e+00, 1.6121e+00, 1.6265e+00,
        1.6330e+00, 1.6869e+00, 1.7219e+00, 1.8931e+00, 3.7255e+05, 3.7745e+05,
        3.7912e+05, 3.8052e+05, 3.9068e+05, 4.0292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379109.9375, 379111.0625, 379111.4688, 379111.8750,
        379117.2188, 379118.5000, 379123.5938, 379127.0625, 379128.2188,
        379135.3125, 743244.6875, 744778.0000, 755623.5625, 765594.8125,
        787095.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4956e+00, 1.5237e+00, 1.5569e+00, 1.5717e+00, 1.6099e+00,
        1.6175e+00, 1.6653e+00, 1.6994e+00, 1.7652e+00, 3.7261e+05, 3.7745e+05,
        3.7913e+05, 3.8055e+05, 3.9061e+05, 4.0294e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5121e+00, 1.5539e+00, 1.5874e+00, 1.6371e+00, 1.6994e+00,
        1.7001e+00, 1.7315e+00, 1.7547e+00, 1.9977e+00, 3.7260e+05, 3.7746e+05,
        3.7914e+05, 3.8055e+05, 3.9065e+05, 4.0294e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380517.9375, 380542.2500, 380550.5000, 380550.5625,
        380558.8750, 380563.8438, 380568.1875, 380568.7188, 380571.2188,
        380588.0000, 739033.2500, 746259.1250, 755623.5625, 775387.0625,
        785172.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390610.5000, 390615.4062, 390617.9062, 390620.6875,
        390626.2500, 390649.1250, 390652.7500, 390665.5000, 390667.7500,
        390678.0625, 765594.8125, 769142.6250, 769642.3125, 775387.0625,
        793238.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4956e+00, 1.5646e+00, 1.5958e+00, 1.5995e+00, 1.6015e+00,
        1.6265e+00, 1.6473e+00, 1.7001e+00, 1.7531e+00, 3.7261e+05, 3.7747e+05,
        3.7911e+05, 3.8059e+05, 3.9062e+05, 4.0292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5051e+00, 1.5121e+00, 1.5426e+00, 1.5545e+00, 1.5557e+00,
        1.5646e+00, 1.6099e+00, 1.7383e+00, 1.8949e+00, 3.7261e+05, 3.7750e+05,
        3.7911e+05, 3.8056e+05, 3.9067e+05, 4.0291e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377447.9375, 377449.3750, 377454.9062, 377464.9375,
        377468.5312, 377470.8125, 377474.2500, 377477.2812, 377487.4688,
        377495.0000, 742484.9375, 744778.0000, 746259.1250, 769642.3125,
        781968.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 372549.2500, 372560.6562, 372573.1250, 372595.9062,
        372597.2500, 372598.0938, 372608.0000, 372611.6562, 372614.2188,
        372628.6875, 739033.2500, 742484.9375, 743244.6875, 769142.6250,
        781677.5000])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37258.80', '37264.40', '37261.19', '37261.23', '37257.50', '402934.62', '37256.41', '379119.44', '37262.25', '37261.32', '380558.03', '390640.38', '37262.88', '37262.62', '377469.06', '372593.69']
estimated f for each client, fs: [6, 6, 6, 6, 6, 4, 6, 4, 6, 6, 4, 4, 6, 6, 4, 4]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 8, 10, 5, 7, 17, 4, 18, 12, 6, 19, 20, 3, 2, 16, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0277s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:47...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[189  48]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:47, End: 2025-07-22 16:00:47)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 10, 16, 13, 8, 2, 11, 20, 9, 19, 12, 1, 3, 18, 15, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.8850e+00, 4.0297e+05, 3.9858e+05, 1.7970e+00, 1.6594e+00,
         1.7403e+00, 3.9850e+05, 1.6595e+00, 3.8520e+05, 1.8289e+00, 1.7026e+00,
         1.8430e+00, 4.1583e+05, 3.8878e+05, 3.7758e+05],
        [1.8850e+00, 0.0000e+00, 4.0294e+05, 3.9859e+05, 1.7808e+00, 1.6603e+00,
         1.6971e+00, 3.9852e+05, 1.6389e+00, 3.8522e+05, 1.6099e+00, 1.8027e+00,
         1.7013e+00, 4.1579e+05, 3.8876e+05, 3.7757e+05],
        [4.0297e+05, 4.0294e+05, 0.0000e+00, 8.2737e+05, 4.0293e+05, 4.0297e+05,
         4.0295e+05, 8.0935e+05, 4.0297e+05, 7.8694e+05, 4.0294e+05, 4.0297e+05,
         4.0295e+05, 8.4398e+05, 7.9164e+05, 7.9448e+05],
        [3.9858e+05, 3.9859e+05, 8.2737e+05, 0.0000e+00, 3.9856e+05, 3.9856e+05,
         3.9857e+05, 8.1731e+05, 3.9858e+05, 7.8774e+05, 3.9858e+05, 3.9854e+05,
         3.9859e+05, 8.2512e+05, 7.8790e+05, 7.6755e+05],
        [1.7970e+00, 1.7808e+00, 4.0293e+05, 3.9856e+05, 0.0000e+00, 1.9945e+00,
         1.7621e+00, 3.9849e+05, 1.8413e+00, 3.8522e+05, 1.8648e+00, 1.9036e+00,
         1.8097e+00, 4.1579e+05, 3.8876e+05, 3.7761e+05],
        [1.6594e+00, 1.6603e+00, 4.0297e+05, 3.9856e+05, 1.9945e+00, 0.0000e+00,
         1.7600e+00, 3.9851e+05, 1.6874e+00, 3.8521e+05, 1.8111e+00, 1.7655e+00,
         1.7597e+00, 4.1580e+05, 3.8873e+05, 3.7759e+05],
        [1.7403e+00, 1.6971e+00, 4.0295e+05, 3.9857e+05, 1.7621e+00, 1.7600e+00,
         0.0000e+00, 3.9850e+05, 1.5723e+00, 3.8517e+05, 1.6883e+00, 1.6895e+00,
         1.7570e+00, 4.1580e+05, 3.8875e+05, 3.7755e+05],
        [3.9850e+05, 3.9852e+05, 8.0935e+05, 8.1731e+05, 3.9849e+05, 3.9851e+05,
         3.9850e+05, 0.0000e+00, 3.9853e+05, 7.8883e+05, 3.9851e+05, 3.9849e+05,
         3.9852e+05, 8.0624e+05, 7.8042e+05, 7.7894e+05],
        [1.6595e+00, 1.6389e+00, 4.0297e+05, 3.9858e+05, 1.8413e+00, 1.6874e+00,
         1.5723e+00, 3.9853e+05, 0.0000e+00, 3.8519e+05, 1.6946e+00, 1.5812e+00,
         1.6895e+00, 4.1579e+05, 3.8875e+05, 3.7757e+05],
        [3.8520e+05, 3.8522e+05, 7.8694e+05, 7.8774e+05, 3.8522e+05, 3.8521e+05,
         3.8517e+05, 7.8883e+05, 3.8519e+05, 0.0000e+00, 3.8523e+05, 3.8518e+05,
         3.8522e+05, 7.9486e+05, 7.6772e+05, 7.6496e+05],
        [1.8289e+00, 1.6099e+00, 4.0294e+05, 3.9858e+05, 1.8648e+00, 1.8111e+00,
         1.6883e+00, 3.9851e+05, 1.6946e+00, 3.8523e+05, 0.0000e+00, 1.7025e+00,
         1.6362e+00, 4.1579e+05, 3.8874e+05, 3.7758e+05],
        [1.7026e+00, 1.8027e+00, 4.0297e+05, 3.9854e+05, 1.9036e+00, 1.7655e+00,
         1.6895e+00, 3.9849e+05, 1.5812e+00, 3.8518e+05, 1.7025e+00, 0.0000e+00,
         1.8837e+00, 4.1579e+05, 3.8875e+05, 3.7758e+05],
        [1.8430e+00, 1.7013e+00, 4.0295e+05, 3.9859e+05, 1.8097e+00, 1.7597e+00,
         1.7570e+00, 3.9852e+05, 1.6895e+00, 3.8522e+05, 1.6362e+00, 1.8837e+00,
         0.0000e+00, 4.1578e+05, 3.8878e+05, 3.7758e+05],
        [4.1583e+05, 4.1579e+05, 8.4398e+05, 8.2512e+05, 4.1579e+05, 4.1580e+05,
         4.1580e+05, 8.0624e+05, 4.1579e+05, 7.9486e+05, 4.1579e+05, 4.1579e+05,
         4.1578e+05, 0.0000e+00, 7.8900e+05, 7.9727e+05],
        [3.8878e+05, 3.8876e+05, 7.9164e+05, 7.8790e+05, 3.8876e+05, 3.8873e+05,
         3.8875e+05, 7.8042e+05, 3.8875e+05, 7.6772e+05, 3.8874e+05, 3.8875e+05,
         3.8878e+05, 7.8900e+05, 0.0000e+00, 7.6501e+05],
        [3.7758e+05, 3.7757e+05, 7.9448e+05, 7.6755e+05, 3.7761e+05, 3.7759e+05,
         3.7755e+05, 7.7894e+05, 3.7757e+05, 7.6496e+05, 3.7758e+05, 3.7758e+05,
         3.7758e+05, 7.9727e+05, 7.6501e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6594e+00, 1.6595e+00, 1.7026e+00, 1.7403e+00, 1.7970e+00,
        1.8289e+00, 1.8430e+00, 1.8850e+00, 3.7758e+05, 3.8520e+05, 3.8878e+05,
        3.9850e+05, 3.9858e+05, 4.0297e+05, 4.1583e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6099e+00, 1.6389e+00, 1.6603e+00, 1.6971e+00, 1.7013e+00,
        1.7808e+00, 1.8027e+00, 1.8850e+00, 3.7757e+05, 3.8522e+05, 3.8876e+05,
        3.9852e+05, 3.9859e+05, 4.0294e+05, 4.1579e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402931.7188, 402936.9375, 402940.1562, 402945.1875,
        402950.2188, 402965.2188, 402968.9062, 402969.9375, 402973.8438,
        786937.1875, 791636.8125, 794477.5625, 809346.7500, 827373.3750,
        843981.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398544.7812, 398555.8750, 398560.3750, 398568.7500,
        398575.3438, 398576.0625, 398584.1562, 398585.5625, 398589.7812,
        767552.5000, 787739.5000, 787903.0000, 817307.2500, 825124.1875,
        827373.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7621e+00, 1.7808e+00, 1.7970e+00, 1.8097e+00, 1.8413e+00,
        1.8648e+00, 1.9036e+00, 1.9945e+00, 3.7761e+05, 3.8522e+05, 3.8876e+05,
        3.9849e+05, 3.9856e+05, 4.0293e+05, 4.1579e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6594e+00, 1.6603e+00, 1.6874e+00, 1.7597e+00, 1.7600e+00,
        1.7655e+00, 1.8111e+00, 1.9945e+00, 3.7759e+05, 3.8521e+05, 3.8873e+05,
        3.9851e+05, 3.9856e+05, 4.0297e+05, 4.1580e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5723e+00, 1.6883e+00, 1.6895e+00, 1.6971e+00, 1.7403e+00,
        1.7570e+00, 1.7600e+00, 1.7621e+00, 3.7755e+05, 3.8517e+05, 3.8875e+05,
        3.9850e+05, 3.9857e+05, 4.0295e+05, 4.1580e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398488.2500, 398494.4688, 398496.9688, 398504.1562,
        398505.0625, 398507.5625, 398516.6875, 398523.8438, 398533.0000,
        778939.7500, 780424.5625, 788827.7500, 806243.5000, 809346.7500,
        817307.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5723e+00, 1.5812e+00, 1.6389e+00, 1.6595e+00, 1.6874e+00,
        1.6895e+00, 1.6946e+00, 1.8413e+00, 3.7757e+05, 3.8519e+05, 3.8875e+05,
        3.9853e+05, 3.9858e+05, 4.0297e+05, 4.1579e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385167.6250, 385180.5000, 385186.0625, 385197.1562,
        385205.7812, 385218.3125, 385218.4688, 385223.5312, 385227.6250,
        764962.0625, 767720.6250, 786937.1875, 787739.5000, 788827.7500,
        794861.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6099e+00, 1.6362e+00, 1.6883e+00, 1.6946e+00, 1.7025e+00,
        1.8111e+00, 1.8289e+00, 1.8648e+00, 3.7758e+05, 3.8523e+05, 3.8874e+05,
        3.9851e+05, 3.9858e+05, 4.0294e+05, 4.1579e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5812e+00, 1.6895e+00, 1.7025e+00, 1.7026e+00, 1.7655e+00,
        1.8027e+00, 1.8837e+00, 1.9036e+00, 3.7758e+05, 3.8518e+05, 3.8875e+05,
        3.9849e+05, 3.9854e+05, 4.0297e+05, 4.1579e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6362e+00, 1.6895e+00, 1.7013e+00, 1.7570e+00, 1.7597e+00,
        1.8097e+00, 1.8430e+00, 1.8837e+00, 3.7758e+05, 3.8522e+05, 3.8878e+05,
        3.9852e+05, 3.9859e+05, 4.0295e+05, 4.1578e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 415777.3125, 415786.6562, 415789.0000, 415789.6250,
        415792.3125, 415793.6250, 415797.4375, 415804.2500, 415826.7188,
        788996.6875, 794861.5000, 797271.4375, 806243.5000, 825124.1875,
        843981.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388729.8438, 388740.5312, 388751.9375, 388752.0938,
        388754.7500, 388759.3750, 388763.0938, 388777.6250, 388783.5625,
        765011.0000, 767720.6250, 780424.5625, 787903.0000, 788996.6875,
        791636.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377554.4375, 377573.4375, 377573.5938, 377580.5312,
        377582.5625, 377583.2188, 377583.8438, 377585.1875, 377610.8750,
        764962.0625, 765011.0000, 767552.5000, 778939.7500, 794477.5625,
        797271.4375])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76279.45', '76280.55', '441351.94', '435469.31', '76284.91', '76280.52', '76273.57', '436551.00', '76277.30', '423178.75', '76282.40', '76277.49', '76281.63', '453115.41', '426382.34', '416318.97']
estimated f for each client, fs: [7, 7, 5, 5, 7, 7, 7, 5, 7, 5, 7, 7, 7, 5, 5, 6]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 10, 16, 13, 8, 2, 11, 20, 9, 19, 12, 1, 3, 18, 15, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0111s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:47...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:47, End: 2025-07-22 16:00:47)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 10, 11, 13, 8, 12, 1, 19, 6, 2, 18, 14, 15, 17, 20, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6078e+00, 1.6362e+00, 3.9060e+05, 1.7015e+00, 1.5345e+00,
         1.7760e+00, 3.8736e+05, 1.6404e+00, 1.6025e+00, 3.8759e+05, 3.9880e+05,
         3.9692e+05, 3.9874e+05, 3.6308e+05, 1.6215e+00],
        [1.6078e+00, 0.0000e+00, 1.7501e+00, 3.9065e+05, 1.7762e+00, 1.6418e+00,
         1.7906e+00, 3.8736e+05, 1.8721e+00, 1.5786e+00, 3.8757e+05, 3.9879e+05,
         3.9692e+05, 3.9877e+05, 3.6305e+05, 1.7171e+00],
        [1.6362e+00, 1.7501e+00, 0.0000e+00, 3.9061e+05, 1.8680e+00, 1.7708e+00,
         1.8399e+00, 3.8738e+05, 1.8820e+00, 1.8093e+00, 3.8759e+05, 3.9880e+05,
         3.9692e+05, 3.9873e+05, 3.6313e+05, 1.8972e+00],
        [3.9060e+05, 3.9065e+05, 3.9061e+05, 0.0000e+00, 3.9063e+05, 3.9062e+05,
         3.9059e+05, 7.9700e+05, 3.9061e+05, 3.9061e+05, 7.8962e+05, 7.8326e+05,
         7.8832e+05, 7.6672e+05, 7.3237e+05, 3.9061e+05],
        [1.7015e+00, 1.7762e+00, 1.8680e+00, 3.9063e+05, 0.0000e+00, 1.7435e+00,
         1.9352e+00, 3.8740e+05, 1.7872e+00, 1.8514e+00, 3.8759e+05, 3.9880e+05,
         3.9688e+05, 3.9871e+05, 3.6308e+05, 1.7272e+00],
        [1.5345e+00, 1.6418e+00, 1.7708e+00, 3.9062e+05, 1.7435e+00, 0.0000e+00,
         1.7878e+00, 3.8741e+05, 1.7690e+00, 1.6933e+00, 3.8761e+05, 3.9879e+05,
         3.9689e+05, 3.9874e+05, 3.6307e+05, 1.5937e+00],
        [1.7760e+00, 1.7906e+00, 1.8399e+00, 3.9059e+05, 1.9352e+00, 1.7878e+00,
         0.0000e+00, 3.8737e+05, 1.7074e+00, 1.6792e+00, 3.8760e+05, 3.9883e+05,
         3.9687e+05, 3.9872e+05, 3.6308e+05, 1.8849e+00],
        [3.8736e+05, 3.8736e+05, 3.8738e+05, 7.9700e+05, 3.8740e+05, 3.8741e+05,
         3.8737e+05, 0.0000e+00, 3.8739e+05, 3.8740e+05, 7.7560e+05, 7.8175e+05,
         7.7612e+05, 7.9149e+05, 7.4500e+05, 3.8737e+05],
        [1.6404e+00, 1.8721e+00, 1.8820e+00, 3.9061e+05, 1.7872e+00, 1.7690e+00,
         1.7074e+00, 3.8739e+05, 0.0000e+00, 1.6253e+00, 3.8759e+05, 3.9885e+05,
         3.9695e+05, 3.9874e+05, 3.6311e+05, 1.8243e+00],
        [1.6025e+00, 1.5786e+00, 1.8093e+00, 3.9061e+05, 1.8514e+00, 1.6933e+00,
         1.6792e+00, 3.8740e+05, 1.6253e+00, 0.0000e+00, 3.8760e+05, 3.9884e+05,
         3.9690e+05, 3.9875e+05, 3.6312e+05, 1.6892e+00],
        [3.8759e+05, 3.8757e+05, 3.8759e+05, 7.8962e+05, 3.8759e+05, 3.8761e+05,
         3.8760e+05, 7.7560e+05, 3.8759e+05, 3.8760e+05, 0.0000e+00, 7.9251e+05,
         8.0583e+05, 7.8010e+05, 7.4341e+05, 3.8761e+05],
        [3.9880e+05, 3.9879e+05, 3.9880e+05, 7.8326e+05, 3.9880e+05, 3.9879e+05,
         3.9883e+05, 7.8175e+05, 3.9885e+05, 3.9884e+05, 7.9251e+05, 0.0000e+00,
         8.0513e+05, 8.0078e+05, 7.3814e+05, 3.9882e+05],
        [3.9692e+05, 3.9692e+05, 3.9692e+05, 7.8832e+05, 3.9688e+05, 3.9689e+05,
         3.9687e+05, 7.7612e+05, 3.9695e+05, 3.9690e+05, 8.0583e+05, 8.0513e+05,
         0.0000e+00, 7.8515e+05, 7.6116e+05, 3.9690e+05],
        [3.9874e+05, 3.9877e+05, 3.9873e+05, 7.6672e+05, 3.9871e+05, 3.9874e+05,
         3.9872e+05, 7.9149e+05, 3.9874e+05, 3.9875e+05, 7.8010e+05, 8.0078e+05,
         7.8515e+05, 0.0000e+00, 7.6850e+05, 3.9872e+05],
        [3.6308e+05, 3.6305e+05, 3.6313e+05, 7.3237e+05, 3.6308e+05, 3.6307e+05,
         3.6308e+05, 7.4500e+05, 3.6311e+05, 3.6312e+05, 7.4341e+05, 7.3814e+05,
         7.6116e+05, 7.6850e+05, 0.0000e+00, 3.6308e+05],
        [1.6215e+00, 1.7171e+00, 1.8972e+00, 3.9061e+05, 1.7272e+00, 1.5937e+00,
         1.8849e+00, 3.8737e+05, 1.8243e+00, 1.6892e+00, 3.8761e+05, 3.9882e+05,
         3.9690e+05, 3.9872e+05, 3.6308e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5345e+00, 1.6025e+00, 1.6078e+00, 1.6215e+00, 1.6362e+00,
        1.6404e+00, 1.7015e+00, 1.7760e+00, 3.6308e+05, 3.8736e+05, 3.8759e+05,
        3.9060e+05, 3.9692e+05, 3.9874e+05, 3.9880e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5786e+00, 1.6078e+00, 1.6418e+00, 1.7171e+00, 1.7501e+00,
        1.7762e+00, 1.7906e+00, 1.8721e+00, 3.6305e+05, 3.8736e+05, 3.8757e+05,
        3.9065e+05, 3.9692e+05, 3.9877e+05, 3.9879e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6362e+00, 1.7501e+00, 1.7708e+00, 1.8093e+00, 1.8399e+00,
        1.8680e+00, 1.8820e+00, 1.8972e+00, 3.6313e+05, 3.8738e+05, 3.8759e+05,
        3.9061e+05, 3.9692e+05, 3.9873e+05, 3.9880e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390589.8750, 390604.7812, 390606.2188, 390608.9375,
        390610.2188, 390611.7812, 390621.5625, 390626.5938, 390646.8750,
        732370.0000, 766721.8750, 783262.4375, 788324.2500, 789623.4375,
        796997.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7015e+00, 1.7272e+00, 1.7435e+00, 1.7762e+00, 1.7872e+00,
        1.8514e+00, 1.8680e+00, 1.9352e+00, 3.6308e+05, 3.8740e+05, 3.8759e+05,
        3.9063e+05, 3.9688e+05, 3.9871e+05, 3.9880e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5345e+00, 1.5937e+00, 1.6418e+00, 1.6933e+00, 1.7435e+00,
        1.7690e+00, 1.7708e+00, 1.7878e+00, 3.6307e+05, 3.8741e+05, 3.8761e+05,
        3.9062e+05, 3.9689e+05, 3.9874e+05, 3.9879e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6792e+00, 1.7074e+00, 1.7760e+00, 1.7878e+00, 1.7906e+00,
        1.8399e+00, 1.8849e+00, 1.9352e+00, 3.6308e+05, 3.8737e+05, 3.8760e+05,
        3.9059e+05, 3.9687e+05, 3.9872e+05, 3.9883e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387357.6875, 387362.0938, 387370.1562, 387372.6250,
        387383.8750, 387393.5938, 387395.2812, 387396.4375, 387410.8438,
        744996.2500, 775600.1250, 776115.5000, 781753.7500, 791491.6875,
        796997.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6253e+00, 1.6404e+00, 1.7074e+00, 1.7690e+00, 1.7872e+00,
        1.8243e+00, 1.8721e+00, 1.8820e+00, 3.6311e+05, 3.8739e+05, 3.8759e+05,
        3.9061e+05, 3.9695e+05, 3.9874e+05, 3.9885e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5786e+00, 1.6025e+00, 1.6253e+00, 1.6792e+00, 1.6892e+00,
        1.6933e+00, 1.8093e+00, 1.8514e+00, 3.6312e+05, 3.8740e+05, 3.8760e+05,
        3.9061e+05, 3.9690e+05, 3.9875e+05, 3.9884e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387572.7500, 387587.8438, 387588.6562, 387589.0625,
        387589.9375, 387598.6875, 387603.0625, 387607.9062, 387609.7500,
        743412.2500, 775600.1250, 780097.0000, 789623.4375, 792506.6875,
        805826.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398787.1875, 398792.1875, 398799.1250, 398801.6250,
        398804.2500, 398823.5625, 398826.9062, 398838.7500, 398849.8125,
        738137.7500, 781753.7500, 783262.4375, 792506.6875, 800777.7500,
        805131.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396873.0625, 396881.4375, 396892.3125, 396902.5625,
        396903.6562, 396918.6562, 396922.3750, 396924.6250, 396945.0938,
        761156.2500, 776115.5000, 785147.3750, 788324.2500, 805131.3125,
        805826.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398712.7500, 398715.6250, 398721.5000, 398732.6875,
        398735.0938, 398735.2812, 398736.6562, 398751.8438, 398771.3125,
        766721.8750, 768503.1250, 780097.0000, 785147.3750, 791491.6875,
        800777.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 363052.9688, 363070.9375, 363075.9062, 363078.6250,
        363081.1250, 363084.8438, 363108.9375, 363118.3438, 363132.7812,
        732370.0000, 738137.7500, 743412.2500, 744996.2500, 761156.2500,
        768503.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5937e+00, 1.6215e+00, 1.6892e+00, 1.7171e+00, 1.7272e+00,
        1.8243e+00, 1.8849e+00, 1.8972e+00, 3.6308e+05, 3.8737e+05, 3.8761e+05,
        3.9061e+05, 3.9690e+05, 3.9872e+05, 3.9882e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75044.95', '75042.88', '75053.10', '424789.69', '75048.56', '75049.52', '75046.94', '423143.84', '75051.66', '75052.83', '423176.00', '432746.09', '433332.00', '435533.44', '400017.44', '75046.77']
estimated f for each client, fs: [7, 7, 7, 5, 7, 7, 7, 5, 7, 7, 5, 5, 5, 5, 6, 7]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 10, 11, 13, 8, 12, 1, 19, 6, 2, 18, 14, 15, 17, 20, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0142s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:48...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:48, End: 2025-07-22 16:00:48)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 14, 2, 9, 16, 15, 18, 12, 10, 8, 11, 4, 13, 3, 7, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0057e+05, 1.4344e+00, 1.4573e+00, 3.9858e+05, 3.9675e+05,
         3.9593e+05, 1.6100e+00, 1.8474e+00, 1.6885e+00, 1.5919e+00, 1.6087e+00,
         3.9030e+05, 1.6375e+00, 1.5918e+00, 1.5327e+00],
        [4.0057e+05, 0.0000e+00, 4.0058e+05, 4.0058e+05, 8.1707e+05, 8.0283e+05,
         7.9924e+05, 4.0057e+05, 4.0058e+05, 4.0058e+05, 4.0053e+05, 4.0058e+05,
         8.0805e+05, 4.0056e+05, 4.0059e+05, 4.0055e+05],
        [1.4344e+00, 4.0058e+05, 0.0000e+00, 1.5345e+00, 3.9864e+05, 3.9672e+05,
         3.9601e+05, 1.5267e+00, 1.6663e+00, 1.6389e+00, 1.6134e+00, 1.5093e+00,
         3.9032e+05, 1.4939e+00, 1.4593e+00, 1.4623e+00],
        [1.4573e+00, 4.0058e+05, 1.5345e+00, 0.0000e+00, 3.9861e+05, 3.9674e+05,
         3.9595e+05, 1.5700e+00, 1.7986e+00, 1.6214e+00, 1.6033e+00, 1.5233e+00,
         3.9030e+05, 1.5450e+00, 1.6496e+00, 1.5562e+00],
        [3.9858e+05, 8.1707e+05, 3.9864e+05, 3.9861e+05, 0.0000e+00, 8.0032e+05,
         7.9593e+05, 3.9860e+05, 3.9859e+05, 3.9861e+05, 3.9855e+05, 3.9858e+05,
         7.8300e+05, 3.9862e+05, 3.9860e+05, 3.9859e+05],
        [3.9675e+05, 8.0283e+05, 3.9672e+05, 3.9674e+05, 8.0032e+05, 0.0000e+00,
         7.8387e+05, 3.9675e+05, 3.9673e+05, 3.9671e+05, 3.9675e+05, 3.9674e+05,
         7.6625e+05, 3.9675e+05, 3.9674e+05, 3.9673e+05],
        [3.9593e+05, 7.9924e+05, 3.9601e+05, 3.9595e+05, 7.9593e+05, 7.8387e+05,
         0.0000e+00, 3.9594e+05, 3.9596e+05, 3.9594e+05, 3.9595e+05, 3.9595e+05,
         7.8972e+05, 3.9596e+05, 3.9598e+05, 3.9595e+05],
        [1.6100e+00, 4.0057e+05, 1.5267e+00, 1.5700e+00, 3.9860e+05, 3.9675e+05,
         3.9594e+05, 0.0000e+00, 1.7230e+00, 1.6081e+00, 1.6043e+00, 1.4951e+00,
         3.9032e+05, 1.4430e+00, 1.5819e+00, 1.6312e+00],
        [1.8474e+00, 4.0058e+05, 1.6663e+00, 1.7986e+00, 3.9859e+05, 3.9673e+05,
         3.9596e+05, 1.7230e+00, 0.0000e+00, 1.9113e+00, 1.6293e+00, 1.7432e+00,
         3.9033e+05, 1.7760e+00, 1.6155e+00, 2.0164e+00],
        [1.6885e+00, 4.0058e+05, 1.6389e+00, 1.6214e+00, 3.9861e+05, 3.9671e+05,
         3.9594e+05, 1.6081e+00, 1.9113e+00, 0.0000e+00, 1.6439e+00, 1.5225e+00,
         3.9029e+05, 1.5579e+00, 1.6373e+00, 1.6204e+00],
        [1.5919e+00, 4.0053e+05, 1.6134e+00, 1.6033e+00, 3.9855e+05, 3.9675e+05,
         3.9595e+05, 1.6043e+00, 1.6293e+00, 1.6439e+00, 0.0000e+00, 1.5415e+00,
         3.9030e+05, 1.6576e+00, 1.5181e+00, 1.7452e+00],
        [1.6087e+00, 4.0058e+05, 1.5093e+00, 1.5233e+00, 3.9858e+05, 3.9674e+05,
         3.9595e+05, 1.4951e+00, 1.7432e+00, 1.5225e+00, 1.5415e+00, 0.0000e+00,
         3.9033e+05, 1.5820e+00, 1.5503e+00, 1.5792e+00],
        [3.9030e+05, 8.0805e+05, 3.9032e+05, 3.9030e+05, 7.8300e+05, 7.6625e+05,
         7.8972e+05, 3.9032e+05, 3.9033e+05, 3.9029e+05, 3.9030e+05, 3.9033e+05,
         0.0000e+00, 3.9034e+05, 3.9030e+05, 3.9030e+05],
        [1.6375e+00, 4.0056e+05, 1.4939e+00, 1.5450e+00, 3.9862e+05, 3.9675e+05,
         3.9596e+05, 1.4430e+00, 1.7760e+00, 1.5579e+00, 1.6576e+00, 1.5820e+00,
         3.9034e+05, 0.0000e+00, 1.6327e+00, 1.6494e+00],
        [1.5918e+00, 4.0059e+05, 1.4593e+00, 1.6496e+00, 3.9860e+05, 3.9674e+05,
         3.9598e+05, 1.5819e+00, 1.6155e+00, 1.6373e+00, 1.5181e+00, 1.5503e+00,
         3.9030e+05, 1.6327e+00, 0.0000e+00, 1.6885e+00],
        [1.5327e+00, 4.0055e+05, 1.4623e+00, 1.5562e+00, 3.9859e+05, 3.9673e+05,
         3.9595e+05, 1.6312e+00, 2.0164e+00, 1.6204e+00, 1.7452e+00, 1.5792e+00,
         3.9030e+05, 1.6494e+00, 1.6885e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4344e+00, 1.4573e+00, 1.5327e+00, 1.5918e+00, 1.5919e+00,
        1.6087e+00, 1.6100e+00, 1.6375e+00, 1.6885e+00, 1.8474e+00, 3.9030e+05,
        3.9593e+05, 3.9675e+05, 3.9858e+05, 4.0057e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400530.5312, 400550.3750, 400558.5625, 400569.9375,
        400574.6562, 400575.7500, 400575.7500, 400576.8125, 400577.3750,
        400582.0312, 400592.2188, 799240.0000, 802832.1250, 808051.2500,
        817068.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4344e+00, 1.4593e+00, 1.4623e+00, 1.4939e+00, 1.5093e+00,
        1.5267e+00, 1.5345e+00, 1.6134e+00, 1.6389e+00, 1.6663e+00, 3.9032e+05,
        3.9601e+05, 3.9672e+05, 3.9864e+05, 4.0058e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4573e+00, 1.5233e+00, 1.5345e+00, 1.5450e+00, 1.5562e+00,
        1.5700e+00, 1.6033e+00, 1.6214e+00, 1.6496e+00, 1.7986e+00, 3.9030e+05,
        3.9595e+05, 3.9674e+05, 3.9861e+05, 4.0058e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398551.3750, 398581.8125, 398583.3125, 398587.1875,
        398594.6562, 398602.5625, 398603.8750, 398608.4688, 398613.6562,
        398616.9688, 398635.5000, 782995.9375, 795931.4375, 800320.1250,
        817068.4375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396706.5625, 396716.2812, 396725.0312, 396730.0938,
        396735.2188, 396744.5312, 396744.6562, 396747.9375, 396752.5312,
        396753.3438, 396754.9062, 766254.9375, 783871.1875, 800320.1250,
        802832.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 395927.8438, 395935.0625, 395937.8438, 395945.6875,
        395950.0938, 395950.9375, 395953.8438, 395960.8750, 395962.7812,
        395980.1562, 396010.4375, 783871.1875, 789723.8750, 795931.4375,
        799240.0000])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4430e+00, 1.4951e+00, 1.5267e+00, 1.5700e+00, 1.5819e+00,
        1.6043e+00, 1.6081e+00, 1.6100e+00, 1.6312e+00, 1.7230e+00, 3.9032e+05,
        3.9594e+05, 3.9675e+05, 3.9860e+05, 4.0057e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6155e+00, 1.6293e+00, 1.6663e+00, 1.7230e+00, 1.7432e+00,
        1.7760e+00, 1.7986e+00, 1.8474e+00, 1.9113e+00, 2.0164e+00, 3.9033e+05,
        3.9596e+05, 3.9673e+05, 3.9859e+05, 4.0058e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5225e+00, 1.5579e+00, 1.6081e+00, 1.6204e+00, 1.6214e+00,
        1.6373e+00, 1.6389e+00, 1.6439e+00, 1.6885e+00, 1.9113e+00, 3.9029e+05,
        3.9594e+05, 3.9671e+05, 3.9861e+05, 4.0058e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5181e+00, 1.5415e+00, 1.5919e+00, 1.6033e+00, 1.6043e+00,
        1.6134e+00, 1.6293e+00, 1.6439e+00, 1.6576e+00, 1.7452e+00, 3.9030e+05,
        3.9595e+05, 3.9675e+05, 3.9855e+05, 4.0053e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4951e+00, 1.5093e+00, 1.5225e+00, 1.5233e+00, 1.5415e+00,
        1.5503e+00, 1.5792e+00, 1.5820e+00, 1.6087e+00, 1.7432e+00, 3.9033e+05,
        3.9595e+05, 3.9674e+05, 3.9858e+05, 4.0058e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390293.3438, 390300.2812, 390301.7500, 390301.8438,
        390301.9062, 390304.3750, 390316.9375, 390319.0625, 390325.6875,
        390329.3438, 390343.7812, 766254.9375, 782995.9375, 789723.8750,
        808051.2500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.4430e+00, 1.4939e+00, 1.5450e+00, 1.5579e+00, 1.5820e+00,
        1.6327e+00, 1.6375e+00, 1.6494e+00, 1.6576e+00, 1.7760e+00, 3.9034e+05,
        3.9596e+05, 3.9675e+05, 3.9862e+05, 4.0056e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4593e+00, 1.5181e+00, 1.5503e+00, 1.5819e+00, 1.5918e+00,
        1.6155e+00, 1.6327e+00, 1.6373e+00, 1.6496e+00, 1.6885e+00, 3.9030e+05,
        3.9598e+05, 3.9674e+05, 3.9860e+05, 4.0059e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4623e+00, 1.5327e+00, 1.5562e+00, 1.5792e+00, 1.6204e+00,
        1.6312e+00, 1.6494e+00, 1.6885e+00, 1.7452e+00, 2.0164e+00, 3.9030e+05,
        3.9595e+05, 3.9673e+05, 3.9859e+05, 4.0055e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.60', '400569.47', '1.53', '1.59', '398598.12', '396737.38', '395955.97', '1.58', '1.77', '1.65', '1.61', '1.57', '390312.53', '1.60', '1.59', '1.65']
estimated f for each client, fs: [5, 3, 5, 5, 3, 3, 3, 5, 5, 5, 5, 5, 3, 5, 5, 5]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 14, 2, 9, 16, 15, 18, 12, 10, 8, 11, 4, 13, 3, 7, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0123s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:48...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:48, End: 2025-07-22 16:00:48)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 13, 12, 6, 9, 11, 15, 10, 17, 16, 7, 14, 2, 20, 19, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0623e+05, 1.5868e+00, 1.5757e+00, 1.3999e+00, 1.6069e+00,
         3.9759e+05, 1.7535e+00, 4.1396e+05, 3.8604e+05, 1.5732e+00, 3.8865e+05,
         1.6484e+00, 3.8700e+05, 3.8445e+05, 1.6769e+00],
        [4.0623e+05, 0.0000e+00, 4.0625e+05, 4.0625e+05, 4.0626e+05, 4.0625e+05,
         7.9914e+05, 4.0625e+05, 8.2586e+05, 7.9148e+05, 4.0627e+05, 7.9454e+05,
         4.0625e+05, 7.5824e+05, 7.7704e+05, 4.0623e+05],
        [1.5868e+00, 4.0625e+05, 0.0000e+00, 1.6789e+00, 1.5481e+00, 1.6443e+00,
         3.9757e+05, 1.6499e+00, 4.1396e+05, 3.8610e+05, 1.6314e+00, 3.8864e+05,
         1.6210e+00, 3.8705e+05, 3.8446e+05, 1.4824e+00],
        [1.5757e+00, 4.0625e+05, 1.6789e+00, 0.0000e+00, 1.5860e+00, 1.7482e+00,
         3.9754e+05, 1.9458e+00, 4.1396e+05, 3.8610e+05, 1.7612e+00, 3.8867e+05,
         1.6712e+00, 3.8700e+05, 3.8447e+05, 1.7149e+00],
        [1.3999e+00, 4.0626e+05, 1.5481e+00, 1.5860e+00, 0.0000e+00, 1.5628e+00,
         3.9757e+05, 1.7420e+00, 4.1396e+05, 3.8608e+05, 1.5980e+00, 3.8868e+05,
         1.6128e+00, 3.8702e+05, 3.8443e+05, 1.5647e+00],
        [1.6069e+00, 4.0625e+05, 1.6443e+00, 1.7482e+00, 1.5628e+00, 0.0000e+00,
         3.9758e+05, 1.5980e+00, 4.1400e+05, 3.8611e+05, 1.5795e+00, 3.8865e+05,
         1.6485e+00, 3.8704e+05, 3.8442e+05, 1.7168e+00],
        [3.9759e+05, 7.9914e+05, 3.9757e+05, 3.9754e+05, 3.9757e+05, 3.9758e+05,
         0.0000e+00, 3.9756e+05, 8.1893e+05, 7.8819e+05, 3.9756e+05, 7.8382e+05,
         3.9759e+05, 7.7720e+05, 7.8210e+05, 3.9756e+05],
        [1.7535e+00, 4.0625e+05, 1.6499e+00, 1.9458e+00, 1.7420e+00, 1.5980e+00,
         3.9756e+05, 0.0000e+00, 4.1401e+05, 3.8608e+05, 1.5747e+00, 3.8867e+05,
         1.4443e+00, 3.8704e+05, 3.8444e+05, 1.6747e+00],
        [4.1396e+05, 8.2586e+05, 4.1396e+05, 4.1396e+05, 4.1396e+05, 4.1400e+05,
         8.1893e+05, 4.1401e+05, 0.0000e+00, 8.1252e+05, 4.1399e+05, 8.1193e+05,
         4.1398e+05, 8.1519e+05, 7.9690e+05, 4.1394e+05],
        [3.8604e+05, 7.9148e+05, 3.8610e+05, 3.8610e+05, 3.8608e+05, 3.8611e+05,
         7.8819e+05, 3.8608e+05, 8.1252e+05, 0.0000e+00, 3.8608e+05, 7.6699e+05,
         3.8608e+05, 7.9615e+05, 7.6690e+05, 3.8608e+05],
        [1.5732e+00, 4.0627e+05, 1.6314e+00, 1.7612e+00, 1.5980e+00, 1.5795e+00,
         3.9756e+05, 1.5747e+00, 4.1399e+05, 3.8608e+05, 0.0000e+00, 3.8867e+05,
         1.5301e+00, 3.8701e+05, 3.8441e+05, 1.7047e+00],
        [3.8865e+05, 7.9454e+05, 3.8864e+05, 3.8867e+05, 3.8868e+05, 3.8865e+05,
         7.8382e+05, 3.8867e+05, 8.1193e+05, 7.6699e+05, 3.8867e+05, 0.0000e+00,
         3.8869e+05, 7.6911e+05, 7.8772e+05, 3.8866e+05],
        [1.6484e+00, 4.0625e+05, 1.6210e+00, 1.6712e+00, 1.6128e+00, 1.6485e+00,
         3.9759e+05, 1.4443e+00, 4.1398e+05, 3.8608e+05, 1.5301e+00, 3.8869e+05,
         0.0000e+00, 3.8703e+05, 3.8442e+05, 1.6156e+00],
        [3.8700e+05, 7.5824e+05, 3.8705e+05, 3.8700e+05, 3.8702e+05, 3.8704e+05,
         7.7720e+05, 3.8704e+05, 8.1519e+05, 7.9615e+05, 3.8701e+05, 7.6911e+05,
         3.8703e+05, 0.0000e+00, 7.7136e+05, 3.8705e+05],
        [3.8445e+05, 7.7704e+05, 3.8446e+05, 3.8447e+05, 3.8443e+05, 3.8442e+05,
         7.8210e+05, 3.8444e+05, 7.9690e+05, 7.6690e+05, 3.8441e+05, 7.8772e+05,
         3.8442e+05, 7.7136e+05, 0.0000e+00, 3.8445e+05],
        [1.6769e+00, 4.0623e+05, 1.4824e+00, 1.7149e+00, 1.5647e+00, 1.7168e+00,
         3.9756e+05, 1.6747e+00, 4.1394e+05, 3.8608e+05, 1.7047e+00, 3.8866e+05,
         1.6156e+00, 3.8705e+05, 3.8445e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3999e+00, 1.5732e+00, 1.5757e+00, 1.5868e+00, 1.6069e+00,
        1.6484e+00, 1.6769e+00, 1.7535e+00, 3.8445e+05, 3.8604e+05, 3.8700e+05,
        3.8865e+05, 3.9759e+05, 4.0623e+05, 4.1396e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406225.5625, 406228.5000, 406246.5625, 406247.3750,
        406249.4375, 406252.6875, 406253.8750, 406262.6250, 406267.7188,
        758235.8750, 777038.8750, 791480.5000, 794544.3750, 799144.3750,
        825855.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4824e+00, 1.5481e+00, 1.5868e+00, 1.6210e+00, 1.6314e+00,
        1.6443e+00, 1.6499e+00, 1.6789e+00, 3.8446e+05, 3.8610e+05, 3.8705e+05,
        3.8864e+05, 3.9757e+05, 4.0625e+05, 4.1396e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5757e+00, 1.5860e+00, 1.6712e+00, 1.6789e+00, 1.7149e+00,
        1.7482e+00, 1.7612e+00, 1.9458e+00, 3.8447e+05, 3.8610e+05, 3.8700e+05,
        3.8867e+05, 3.9754e+05, 4.0625e+05, 4.1396e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3999e+00, 1.5481e+00, 1.5628e+00, 1.5647e+00, 1.5860e+00,
        1.5980e+00, 1.6128e+00, 1.7420e+00, 3.8443e+05, 3.8608e+05, 3.8702e+05,
        3.8868e+05, 3.9757e+05, 4.0626e+05, 4.1396e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5628e+00, 1.5795e+00, 1.5980e+00, 1.6069e+00, 1.6443e+00,
        1.6485e+00, 1.7168e+00, 1.7482e+00, 3.8442e+05, 3.8611e+05, 3.8704e+05,
        3.8865e+05, 3.9758e+05, 4.0625e+05, 4.1400e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397542.0938, 397560.3125, 397562.8438, 397563.0938,
        397568.1562, 397572.9375, 397581.4688, 397586.3125, 397592.7188,
        777201.0625, 782098.8125, 783821.1875, 788187.6875, 799144.3750,
        818930.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4443e+00, 1.5747e+00, 1.5980e+00, 1.6499e+00, 1.6747e+00,
        1.7420e+00, 1.7535e+00, 1.9458e+00, 3.8444e+05, 3.8608e+05, 3.8704e+05,
        3.8867e+05, 3.9756e+05, 4.0625e+05, 4.1401e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 413944.2812, 413956.5625, 413957.3750, 413958.1875,
        413959.1875, 413975.5938, 413989.5312, 414000.1875, 414005.6250,
        796901.4375, 811931.0000, 812517.6250, 815186.8750, 818930.3750,
        825855.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386038.4375, 386075.0000, 386075.7812, 386078.4062,
        386080.2188, 386082.5312, 386096.1875, 386099.2188, 386106.7188,
        766895.2500, 766986.0000, 788187.6875, 791480.5000, 796150.8750,
        812517.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5301e+00, 1.5732e+00, 1.5747e+00, 1.5795e+00, 1.5980e+00,
        1.6314e+00, 1.7047e+00, 1.7612e+00, 3.8441e+05, 3.8608e+05, 3.8701e+05,
        3.8867e+05, 3.9756e+05, 4.0627e+05, 4.1399e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388637.9062, 388648.3438, 388650.1875, 388664.4062,
        388666.6250, 388670.0000, 388671.0000, 388675.7812, 388687.5625,
        766986.0000, 769112.2500, 783821.1875, 787715.0000, 794544.3750,
        811931.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4443e+00, 1.5301e+00, 1.6128e+00, 1.6156e+00, 1.6210e+00,
        1.6484e+00, 1.6485e+00, 1.6712e+00, 3.8442e+05, 3.8608e+05, 3.8703e+05,
        3.8869e+05, 3.9759e+05, 4.0625e+05, 4.1398e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387002.7500, 387003.2188, 387010.0938, 387020.2188,
        387027.1250, 387038.0000, 387040.5625, 387051.1562, 387052.3125,
        758235.8750, 769112.2500, 771362.8750, 777201.0625, 796150.8750,
        815186.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384407.3750, 384419.6562, 384422.6250, 384430.1875,
        384436.9688, 384452.2500, 384453.6562, 384458.3750, 384468.7188,
        766895.2500, 771362.8750, 777038.8750, 782098.8125, 787715.0000,
        796901.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4824e+00, 1.5647e+00, 1.6156e+00, 1.6747e+00, 1.6769e+00,
        1.7047e+00, 1.7149e+00, 1.7168e+00, 3.8445e+05, 3.8608e+05, 3.8705e+05,
        3.8866e+05, 3.9756e+05, 4.0623e+05, 4.1394e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77050.34', '441447.00', '77057.05', '77057.85', '77052.12', '77053.95', '435533.09', '77052.61', '452264.75', '424162.81', '77049.52', '426495.81', '77051.56', '424148.09', '422684.50', '77054.93']
estimated f for each client, fs: [7, 5, 7, 7, 7, 7, 5, 7, 5, 5, 7, 5, 7, 5, 5, 7]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 13, 12, 6, 9, 11, 15, 10, 17, 16, 7, 14, 2, 20, 19, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0155s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:49...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:49, End: 2025-07-22 16:00:49)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 20, 14, 12, 11, 1, 17, 3, 7, 18, 9, 10, 4, 15, 8, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8938e+05, 3.9184e+05, 1.4761e+00, 1.5336e+00, 1.5682e+00,
         3.8996e+05, 1.4815e+00, 1.4649e+00, 3.8964e+05, 1.5053e+00, 1.3868e+00,
         1.4741e+00, 3.9265e+05, 1.6031e+00, 3.9671e+05],
        [3.8938e+05, 0.0000e+00, 7.9804e+05, 3.8940e+05, 3.8940e+05, 3.8942e+05,
         7.7351e+05, 3.8939e+05, 3.8938e+05, 7.8150e+05, 3.8939e+05, 3.8937e+05,
         3.8940e+05, 7.8415e+05, 3.8942e+05, 7.5829e+05],
        [3.9184e+05, 7.9804e+05, 0.0000e+00, 3.9188e+05, 3.9187e+05, 3.9188e+05,
         7.6600e+05, 3.9188e+05, 3.9187e+05, 7.8733e+05, 3.9184e+05, 3.9188e+05,
         3.9185e+05, 7.9937e+05, 3.9188e+05, 8.0596e+05],
        [1.4761e+00, 3.8940e+05, 3.9188e+05, 0.0000e+00, 1.5199e+00, 1.4818e+00,
         3.8994e+05, 1.4065e+00, 1.7061e+00, 3.8963e+05, 1.4558e+00, 1.5800e+00,
         1.3861e+00, 3.9265e+05, 1.5398e+00, 3.9670e+05],
        [1.5336e+00, 3.8940e+05, 3.9187e+05, 1.5199e+00, 0.0000e+00, 1.5547e+00,
         3.8996e+05, 1.6286e+00, 1.6070e+00, 3.8963e+05, 1.4427e+00, 1.5452e+00,
         1.4483e+00, 3.9267e+05, 1.5456e+00, 3.9672e+05],
        [1.5682e+00, 3.8942e+05, 3.9188e+05, 1.4818e+00, 1.5547e+00, 0.0000e+00,
         3.8996e+05, 1.6201e+00, 1.7046e+00, 3.8962e+05, 1.3786e+00, 1.7316e+00,
         1.5662e+00, 3.9267e+05, 1.6043e+00, 3.9669e+05],
        [3.8996e+05, 7.7351e+05, 7.6600e+05, 3.8994e+05, 3.8996e+05, 3.8996e+05,
         0.0000e+00, 3.8994e+05, 3.8994e+05, 7.7671e+05, 3.8995e+05, 3.8996e+05,
         3.8995e+05, 7.5908e+05, 3.8995e+05, 7.8685e+05],
        [1.4815e+00, 3.8939e+05, 3.9188e+05, 1.4065e+00, 1.6286e+00, 1.6201e+00,
         3.8994e+05, 0.0000e+00, 1.7332e+00, 3.8966e+05, 1.4561e+00, 1.6391e+00,
         1.4929e+00, 3.9265e+05, 1.4857e+00, 3.9673e+05],
        [1.4649e+00, 3.8938e+05, 3.9187e+05, 1.7061e+00, 1.6070e+00, 1.7046e+00,
         3.8994e+05, 1.7332e+00, 0.0000e+00, 3.8962e+05, 1.6945e+00, 1.4257e+00,
         1.6988e+00, 3.9266e+05, 1.7590e+00, 3.9670e+05],
        [3.8964e+05, 7.8150e+05, 7.8733e+05, 3.8963e+05, 3.8963e+05, 3.8962e+05,
         7.7671e+05, 3.8966e+05, 3.8962e+05, 0.0000e+00, 3.8964e+05, 3.8961e+05,
         3.8961e+05, 7.9805e+05, 3.8965e+05, 7.8447e+05],
        [1.5053e+00, 3.8939e+05, 3.9184e+05, 1.4558e+00, 1.4427e+00, 1.3786e+00,
         3.8995e+05, 1.4561e+00, 1.6945e+00, 3.8964e+05, 0.0000e+00, 1.6717e+00,
         1.4237e+00, 3.9265e+05, 1.4484e+00, 3.9671e+05],
        [1.3868e+00, 3.8937e+05, 3.9188e+05, 1.5800e+00, 1.5452e+00, 1.7316e+00,
         3.8996e+05, 1.6391e+00, 1.4257e+00, 3.8961e+05, 1.6717e+00, 0.0000e+00,
         1.6227e+00, 3.9267e+05, 1.6944e+00, 3.9670e+05],
        [1.4741e+00, 3.8940e+05, 3.9185e+05, 1.3861e+00, 1.4483e+00, 1.5662e+00,
         3.8995e+05, 1.4929e+00, 1.6988e+00, 3.8961e+05, 1.4237e+00, 1.6227e+00,
         0.0000e+00, 3.9266e+05, 1.4794e+00, 3.9670e+05],
        [3.9265e+05, 7.8415e+05, 7.9937e+05, 3.9265e+05, 3.9267e+05, 3.9267e+05,
         7.5908e+05, 3.9265e+05, 3.9266e+05, 7.9805e+05, 3.9265e+05, 3.9267e+05,
         3.9266e+05, 0.0000e+00, 3.9265e+05, 7.7514e+05],
        [1.6031e+00, 3.8942e+05, 3.9188e+05, 1.5398e+00, 1.5456e+00, 1.6043e+00,
         3.8995e+05, 1.4857e+00, 1.7590e+00, 3.8965e+05, 1.4484e+00, 1.6944e+00,
         1.4794e+00, 3.9265e+05, 0.0000e+00, 3.9672e+05],
        [3.9671e+05, 7.5829e+05, 8.0596e+05, 3.9670e+05, 3.9672e+05, 3.9669e+05,
         7.8685e+05, 3.9673e+05, 3.9670e+05, 7.8447e+05, 3.9671e+05, 3.9670e+05,
         3.9670e+05, 7.7514e+05, 3.9672e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3868e+00, 1.4649e+00, 1.4741e+00, 1.4761e+00, 1.4815e+00,
        1.5053e+00, 1.5336e+00, 1.5682e+00, 1.6031e+00, 3.8938e+05, 3.8964e+05,
        3.8996e+05, 3.9184e+05, 3.9265e+05, 3.9671e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389366.4375, 389376.1250, 389380.5625, 389385.8125,
        389392.2500, 389399.2812, 389400.0000, 389404.2812, 389416.1250,
        389420.0625, 758289.1250, 773508.8125, 781495.0000, 784149.1250,
        798044.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391840.3125, 391842.0625, 391845.9375, 391868.1250,
        391874.5312, 391878.4688, 391879.5000, 391880.0000, 391881.1562,
        391882.2500, 766004.8750, 787325.1875, 798044.7500, 799370.2500,
        805956.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3861e+00, 1.4065e+00, 1.4558e+00, 1.4761e+00, 1.4818e+00,
        1.5199e+00, 1.5398e+00, 1.5800e+00, 1.7061e+00, 3.8940e+05, 3.8963e+05,
        3.8994e+05, 3.9188e+05, 3.9265e+05, 3.9670e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4427e+00, 1.4483e+00, 1.5199e+00, 1.5336e+00, 1.5452e+00,
        1.5456e+00, 1.5547e+00, 1.6070e+00, 1.6286e+00, 3.8940e+05, 3.8963e+05,
        3.8996e+05, 3.9187e+05, 3.9267e+05, 3.9672e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3786e+00, 1.4818e+00, 1.5547e+00, 1.5662e+00, 1.5682e+00,
        1.6043e+00, 1.6201e+00, 1.7046e+00, 1.7316e+00, 3.8942e+05, 3.8962e+05,
        3.8996e+05, 3.9188e+05, 3.9267e+05, 3.9669e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389936.1250, 389937.9688, 389939.7812, 389952.1562,
        389952.7500, 389953.8125, 389961.2812, 389963.6250, 389963.8438,
        389965.0000, 759077.2500, 766004.8750, 773508.8125, 776709.3750,
        786850.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4065e+00, 1.4561e+00, 1.4815e+00, 1.4857e+00, 1.4929e+00,
        1.6201e+00, 1.6286e+00, 1.6391e+00, 1.7332e+00, 3.8939e+05, 3.8966e+05,
        3.8994e+05, 3.9188e+05, 3.9265e+05, 3.9673e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4257e+00, 1.4649e+00, 1.6070e+00, 1.6945e+00, 1.6988e+00,
        1.7046e+00, 1.7061e+00, 1.7332e+00, 1.7590e+00, 3.8938e+05, 3.8962e+05,
        3.8994e+05, 3.9187e+05, 3.9266e+05, 3.9670e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389610.4375, 389614.0938, 389620.7500, 389623.6250,
        389631.9062, 389634.1250, 389638.3438, 389642.8438, 389647.9375,
        389657.1562, 776709.3750, 781495.0000, 784469.3750, 787325.1875,
        798046.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3786e+00, 1.4237e+00, 1.4427e+00, 1.4484e+00, 1.4558e+00,
        1.4561e+00, 1.5053e+00, 1.6717e+00, 1.6945e+00, 3.8939e+05, 3.8964e+05,
        3.8995e+05, 3.9184e+05, 3.9265e+05, 3.9671e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3868e+00, 1.4257e+00, 1.5452e+00, 1.5800e+00, 1.6227e+00,
        1.6391e+00, 1.6717e+00, 1.6944e+00, 1.7316e+00, 3.8937e+05, 3.8961e+05,
        3.8996e+05, 3.9188e+05, 3.9267e+05, 3.9670e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3861e+00, 1.4237e+00, 1.4483e+00, 1.4741e+00, 1.4794e+00,
        1.4929e+00, 1.5662e+00, 1.6227e+00, 1.6988e+00, 3.8940e+05, 3.8961e+05,
        3.8995e+05, 3.9185e+05, 3.9266e+05, 3.9670e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392645.1250, 392646.9688, 392649.0625, 392650.0000,
        392652.1250, 392658.1562, 392662.8750, 392670.2812, 392670.8750,
        392671.1250, 759077.2500, 775144.8125, 784149.1250, 798046.0625,
        799370.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4484e+00, 1.4794e+00, 1.4857e+00, 1.5398e+00, 1.5456e+00,
        1.6031e+00, 1.6043e+00, 1.6944e+00, 1.7590e+00, 3.8942e+05, 3.8965e+05,
        3.8995e+05, 3.9188e+05, 3.9265e+05, 3.9672e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396685.2500, 396695.9062, 396697.9375, 396700.2812,
        396702.0000, 396711.6875, 396712.3438, 396718.0625, 396718.4062,
        396729.3438, 758289.1250, 775144.8125, 784469.3750, 786850.1875,
        805956.5000])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38939.40', '389394.06', '391867.25', '38941.79', '38941.30', '38943.43', '389952.66', '38939.98', '38939.09', '389632.09', '38940.57', '38938.07', '38941.36', '392657.69', '38943.02', '396707.09']
estimated f for each client, fs: [6, 4, 4, 6, 6, 6, 4, 6, 6, 4, 6, 6, 6, 4, 6, 4]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 20, 14, 12, 11, 1, 17, 3, 7, 18, 9, 10, 4, 15, 8, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0140s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:50...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:50, End: 2025-07-22 16:00:50)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 7, 1, 19, 17, 18, 13, 10, 2, 16, 14, 6, 8, 5, 20, 9], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3832e+00, 1.3050e+00, 3.8847e+05, 3.8809e+05, 3.9730e+05,
         3.9738e+05, 1.8937e+00, 1.2811e+00, 3.8205e+05, 3.9077e+05, 1.3790e+00,
         1.3048e+00, 1.3539e+00, 3.9555e+05, 1.2422e+00],
        [1.3832e+00, 0.0000e+00, 1.3568e+00, 3.8847e+05, 3.8807e+05, 3.9732e+05,
         3.9739e+05, 1.3506e+00, 1.1679e+00, 3.8206e+05, 3.9076e+05, 1.4764e+00,
         1.4156e+00, 1.2388e+00, 3.9553e+05, 1.3619e+00],
        [1.3050e+00, 1.3568e+00, 0.0000e+00, 3.8846e+05, 3.8806e+05, 3.9731e+05,
         3.9737e+05, 1.9360e+00, 1.2499e+00, 3.8209e+05, 3.9078e+05, 1.2358e+00,
         1.3404e+00, 1.3606e+00, 3.9552e+05, 1.1458e+00],
        [3.8847e+05, 3.8847e+05, 3.8846e+05, 0.0000e+00, 7.5149e+05, 7.7816e+05,
         7.8368e+05, 3.8849e+05, 3.8848e+05, 7.9338e+05, 7.8644e+05, 3.8846e+05,
         3.8846e+05, 3.8849e+05, 7.8480e+05, 3.8847e+05],
        [3.8809e+05, 3.8807e+05, 3.8806e+05, 7.5149e+05, 0.0000e+00, 7.9844e+05,
         7.8372e+05, 3.8813e+05, 3.8810e+05, 7.5500e+05, 7.6943e+05, 3.8810e+05,
         3.8809e+05, 3.8807e+05, 7.7678e+05, 3.8808e+05],
        [3.9730e+05, 3.9732e+05, 3.9731e+05, 7.7816e+05, 7.9844e+05, 0.0000e+00,
         7.6803e+05, 3.9728e+05, 3.9730e+05, 8.0999e+05, 7.8306e+05, 3.9731e+05,
         3.9731e+05, 3.9730e+05, 8.1076e+05, 3.9730e+05],
        [3.9738e+05, 3.9739e+05, 3.9737e+05, 7.8368e+05, 7.8372e+05, 7.6803e+05,
         0.0000e+00, 3.9742e+05, 3.9740e+05, 7.8232e+05, 7.7314e+05, 3.9737e+05,
         3.9738e+05, 3.9739e+05, 8.0999e+05, 3.9738e+05],
        [1.8937e+00, 1.3506e+00, 1.9360e+00, 3.8849e+05, 3.8813e+05, 3.9728e+05,
         3.9742e+05, 0.0000e+00, 1.5135e+00, 3.8209e+05, 3.9078e+05, 2.1833e+00,
         2.0334e+00, 1.6347e+00, 3.9548e+05, 1.8897e+00],
        [1.2811e+00, 1.1679e+00, 1.2499e+00, 3.8848e+05, 3.8810e+05, 3.9730e+05,
         3.9740e+05, 1.5135e+00, 0.0000e+00, 3.8211e+05, 3.9077e+05, 1.3197e+00,
         1.3615e+00, 1.3290e+00, 3.9552e+05, 1.2626e+00],
        [3.8205e+05, 3.8206e+05, 3.8209e+05, 7.9338e+05, 7.5500e+05, 8.0999e+05,
         7.8232e+05, 3.8209e+05, 3.8211e+05, 0.0000e+00, 7.7848e+05, 3.8209e+05,
         3.8208e+05, 3.8206e+05, 7.8536e+05, 3.8208e+05],
        [3.9077e+05, 3.9076e+05, 3.9078e+05, 7.8644e+05, 7.6943e+05, 7.8306e+05,
         7.7314e+05, 3.9078e+05, 3.9077e+05, 7.7848e+05, 0.0000e+00, 3.9076e+05,
         3.9078e+05, 3.9075e+05, 7.9852e+05, 3.9080e+05],
        [1.3790e+00, 1.4764e+00, 1.2358e+00, 3.8846e+05, 3.8810e+05, 3.9731e+05,
         3.9737e+05, 2.1833e+00, 1.3197e+00, 3.8209e+05, 3.9076e+05, 0.0000e+00,
         1.3015e+00, 1.4638e+00, 3.9558e+05, 1.2671e+00],
        [1.3048e+00, 1.4156e+00, 1.3404e+00, 3.8846e+05, 3.8809e+05, 3.9731e+05,
         3.9738e+05, 2.0334e+00, 1.3615e+00, 3.8208e+05, 3.9078e+05, 1.3015e+00,
         0.0000e+00, 1.4460e+00, 3.9554e+05, 1.2761e+00],
        [1.3539e+00, 1.2388e+00, 1.3606e+00, 3.8849e+05, 3.8807e+05, 3.9730e+05,
         3.9739e+05, 1.6347e+00, 1.3290e+00, 3.8206e+05, 3.9075e+05, 1.4638e+00,
         1.4460e+00, 0.0000e+00, 3.9553e+05, 1.3837e+00],
        [3.9555e+05, 3.9553e+05, 3.9552e+05, 7.8480e+05, 7.7678e+05, 8.1076e+05,
         8.0999e+05, 3.9548e+05, 3.9552e+05, 7.8536e+05, 7.9852e+05, 3.9558e+05,
         3.9554e+05, 3.9553e+05, 0.0000e+00, 3.9552e+05],
        [1.2422e+00, 1.3619e+00, 1.1458e+00, 3.8847e+05, 3.8808e+05, 3.9730e+05,
         3.9738e+05, 1.8897e+00, 1.2626e+00, 3.8208e+05, 3.9080e+05, 1.2671e+00,
         1.2761e+00, 1.3837e+00, 3.9552e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2422e+00, 1.2811e+00, 1.3048e+00, 1.3050e+00, 1.3539e+00,
        1.3790e+00, 1.3832e+00, 1.8937e+00, 3.8205e+05, 3.8809e+05, 3.8847e+05,
        3.9077e+05, 3.9555e+05, 3.9730e+05, 3.9738e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1679e+00, 1.2388e+00, 1.3506e+00, 1.3568e+00, 1.3619e+00,
        1.3832e+00, 1.4156e+00, 1.4764e+00, 3.8206e+05, 3.8807e+05, 3.8847e+05,
        3.9076e+05, 3.9553e+05, 3.9732e+05, 3.9739e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1458e+00, 1.2358e+00, 1.2499e+00, 1.3050e+00, 1.3404e+00,
        1.3568e+00, 1.3606e+00, 1.9360e+00, 3.8209e+05, 3.8806e+05, 3.8846e+05,
        3.9078e+05, 3.9552e+05, 3.9731e+05, 3.9737e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388459.9688, 388461.2500, 388461.6875, 388471.0625,
        388472.5625, 388474.9375, 388476.9375, 388485.2188, 388491.3125,
        751494.3750, 778162.9375, 783683.3125, 784798.4375, 786439.5000,
        793381.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388055.5312, 388066.2500, 388066.7188, 388076.3125,
        388086.5000, 388091.1562, 388097.2812, 388100.0938, 388127.9062,
        751494.3750, 754996.3750, 769427.6250, 776781.3750, 783724.7500,
        798435.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397277.4062, 397299.5625, 397301.3125, 397301.3438,
        397302.2812, 397308.1562, 397308.7500, 397313.0625, 397318.6875,
        768027.5000, 778162.9375, 783057.0625, 798435.2500, 809987.3750,
        810758.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397372.9688, 397374.8125, 397377.5625, 397380.4062,
        397380.8750, 397389.8125, 397390.3750, 397396.9688, 397417.8438,
        768027.5000, 773137.3750, 782316.0000, 783683.3125, 783724.7500,
        809992.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3506e+00, 1.5135e+00, 1.6347e+00, 1.8897e+00, 1.8937e+00,
        1.9360e+00, 2.0334e+00, 2.1833e+00, 3.8209e+05, 3.8813e+05, 3.8849e+05,
        3.9078e+05, 3.9548e+05, 3.9728e+05, 3.9742e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1679e+00, 1.2499e+00, 1.2626e+00, 1.2811e+00, 1.3197e+00,
        1.3290e+00, 1.3615e+00, 1.5135e+00, 3.8211e+05, 3.8810e+05, 3.8848e+05,
        3.9077e+05, 3.9552e+05, 3.9730e+05, 3.9740e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382054.6562, 382057.5312, 382064.8438, 382079.9375,
        382080.1875, 382087.6250, 382093.6250, 382094.7812, 382108.8750,
        754996.3750, 778478.9375, 782316.0000, 785355.5625, 793381.0625,
        809987.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390753.3438, 390760.1250, 390764.0938, 390765.1562,
        390765.2188, 390776.5625, 390778.5000, 390781.5312, 390799.0938,
        769427.6250, 773137.3750, 778478.9375, 783057.0625, 786439.5000,
        798524.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2358e+00, 1.2671e+00, 1.3015e+00, 1.3197e+00, 1.3790e+00,
        1.4638e+00, 1.4764e+00, 2.1833e+00, 3.8209e+05, 3.8810e+05, 3.8846e+05,
        3.9076e+05, 3.9558e+05, 3.9731e+05, 3.9737e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2761e+00, 1.3015e+00, 1.3048e+00, 1.3404e+00, 1.3615e+00,
        1.4156e+00, 1.4460e+00, 2.0334e+00, 3.8208e+05, 3.8809e+05, 3.8846e+05,
        3.9078e+05, 3.9554e+05, 3.9731e+05, 3.9738e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2388e+00, 1.3290e+00, 1.3539e+00, 1.3606e+00, 1.3837e+00,
        1.4460e+00, 1.4638e+00, 1.6347e+00, 3.8206e+05, 3.8807e+05, 3.8849e+05,
        3.9075e+05, 3.9553e+05, 3.9730e+05, 3.9739e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395479.5000, 395517.8750, 395522.8438, 395524.1250,
        395528.7500, 395530.7812, 395536.1250, 395553.0312, 395580.1875,
        776781.3750, 784798.4375, 785355.5625, 798524.5000, 809992.0625,
        810758.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1458e+00, 1.2422e+00, 1.2626e+00, 1.2671e+00, 1.2761e+00,
        1.3619e+00, 1.3837e+00, 1.8897e+00, 3.8208e+05, 3.8808e+05, 3.8847e+05,
        3.9080e+05, 3.9552e+05, 3.9730e+05, 3.9738e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77015.70', '77013.52', '77016.01', '424774.94', '424426.19', '434375.81', '434450.91', '77023.71', '77021.95', '419371.81', '428637.16', '77019.65', '77017.80', '77014.23', '433655.44', '77016.73']
estimated f for each client, fs: [7, 7, 7, 5, 5, 5, 5, 7, 7, 5, 5, 7, 7, 7, 5, 7]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 7, 1, 19, 17, 18, 13, 10, 2, 16, 14, 6, 8, 5, 20, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:50...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:50, End: 2025-07-22 16:00:50)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 5, 15, 2, 11, 7, 9, 10, 13, 17, 20, 4, 19, 18, 1, 14], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2532e+00, 3.9715e+05, 1.2382e+00, 1.2469e+00, 1.6607e+00,
         1.2082e+00, 1.5640e+00, 3.7696e+05, 3.9748e+05, 3.9126e+05, 1.2430e+00,
         3.9267e+05, 4.0466e+05, 1.2534e+00, 3.9580e+05],
        [1.2532e+00, 0.0000e+00, 3.9717e+05, 1.2648e+00, 1.1534e+00, 1.4339e+00,
         1.3295e+00, 1.3153e+00, 3.7698e+05, 3.9745e+05, 3.9128e+05, 1.2430e+00,
         3.9270e+05, 4.0466e+05, 1.2650e+00, 3.9580e+05],
        [3.9715e+05, 3.9717e+05, 0.0000e+00, 3.9716e+05, 3.9717e+05, 3.9712e+05,
         3.9715e+05, 3.9716e+05, 7.5180e+05, 7.8645e+05, 7.8876e+05, 3.9716e+05,
         7.8401e+05, 7.8870e+05, 3.9714e+05, 7.6773e+05],
        [1.2382e+00, 1.2648e+00, 3.9716e+05, 0.0000e+00, 1.2202e+00, 1.3997e+00,
         1.2559e+00, 1.2698e+00, 3.7697e+05, 3.9745e+05, 3.9126e+05, 1.2509e+00,
         3.9270e+05, 4.0469e+05, 1.2564e+00, 3.9581e+05],
        [1.2469e+00, 1.1534e+00, 3.9717e+05, 1.2202e+00, 0.0000e+00, 1.4824e+00,
         1.2077e+00, 1.3508e+00, 3.7697e+05, 3.9745e+05, 3.9129e+05, 1.1904e+00,
         3.9270e+05, 4.0466e+05, 1.2390e+00, 3.9579e+05],
        [1.6607e+00, 1.4339e+00, 3.9712e+05, 1.3997e+00, 1.4824e+00, 0.0000e+00,
         1.7554e+00, 1.0346e+00, 3.7696e+05, 3.9746e+05, 3.9131e+05, 1.6766e+00,
         3.9266e+05, 4.0467e+05, 1.7347e+00, 3.9581e+05],
        [1.2082e+00, 1.3295e+00, 3.9715e+05, 1.2559e+00, 1.2077e+00, 1.7554e+00,
         0.0000e+00, 1.6124e+00, 3.7697e+05, 3.9744e+05, 3.9128e+05, 1.2133e+00,
         3.9270e+05, 4.0466e+05, 1.1329e+00, 3.9579e+05],
        [1.5640e+00, 1.3153e+00, 3.9716e+05, 1.2698e+00, 1.3508e+00, 1.0346e+00,
         1.6124e+00, 0.0000e+00, 3.7696e+05, 3.9745e+05, 3.9129e+05, 1.5667e+00,
         3.9265e+05, 4.0466e+05, 1.6067e+00, 3.9581e+05],
        [3.7696e+05, 3.7698e+05, 7.5180e+05, 3.7697e+05, 3.7697e+05, 3.7696e+05,
         3.7697e+05, 3.7696e+05, 0.0000e+00, 7.6802e+05, 7.7449e+05, 3.7697e+05,
         7.6130e+05, 7.7195e+05, 3.7696e+05, 7.8199e+05],
        [3.9748e+05, 3.9745e+05, 7.8645e+05, 3.9745e+05, 3.9745e+05, 3.9746e+05,
         3.9744e+05, 3.9745e+05, 7.6802e+05, 0.0000e+00, 7.7698e+05, 3.9744e+05,
         7.8175e+05, 8.0957e+05, 3.9744e+05, 7.9579e+05],
        [3.9126e+05, 3.9128e+05, 7.8876e+05, 3.9126e+05, 3.9129e+05, 3.9131e+05,
         3.9128e+05, 3.9129e+05, 7.7449e+05, 7.7698e+05, 0.0000e+00, 3.9126e+05,
         7.9058e+05, 7.9604e+05, 3.9127e+05, 7.9068e+05],
        [1.2430e+00, 1.2430e+00, 3.9716e+05, 1.2509e+00, 1.1904e+00, 1.6766e+00,
         1.2133e+00, 1.5667e+00, 3.7697e+05, 3.9744e+05, 3.9126e+05, 0.0000e+00,
         3.9270e+05, 4.0465e+05, 1.2226e+00, 3.9579e+05],
        [3.9267e+05, 3.9270e+05, 7.8401e+05, 3.9270e+05, 3.9270e+05, 3.9266e+05,
         3.9270e+05, 3.9265e+05, 7.6130e+05, 7.8175e+05, 7.9058e+05, 3.9270e+05,
         0.0000e+00, 7.9452e+05, 3.9273e+05, 7.8876e+05],
        [4.0466e+05, 4.0466e+05, 7.8870e+05, 4.0469e+05, 4.0466e+05, 4.0467e+05,
         4.0466e+05, 4.0466e+05, 7.7195e+05, 8.0957e+05, 7.9604e+05, 4.0465e+05,
         7.9452e+05, 0.0000e+00, 4.0469e+05, 8.0052e+05],
        [1.2534e+00, 1.2650e+00, 3.9714e+05, 1.2564e+00, 1.2390e+00, 1.7347e+00,
         1.1329e+00, 1.6067e+00, 3.7696e+05, 3.9744e+05, 3.9127e+05, 1.2226e+00,
         3.9273e+05, 4.0469e+05, 0.0000e+00, 3.9581e+05],
        [3.9580e+05, 3.9580e+05, 7.6773e+05, 3.9581e+05, 3.9579e+05, 3.9581e+05,
         3.9579e+05, 3.9581e+05, 7.8199e+05, 7.9579e+05, 7.9068e+05, 3.9579e+05,
         7.8876e+05, 8.0052e+05, 3.9581e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2082e+00, 1.2382e+00, 1.2430e+00, 1.2469e+00, 1.2532e+00,
        1.2534e+00, 1.5640e+00, 1.6607e+00, 3.7696e+05, 3.9126e+05, 3.9267e+05,
        3.9580e+05, 3.9715e+05, 3.9748e+05, 4.0466e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1534e+00, 1.2430e+00, 1.2532e+00, 1.2648e+00, 1.2650e+00,
        1.3153e+00, 1.3295e+00, 1.4339e+00, 3.7698e+05, 3.9128e+05, 3.9270e+05,
        3.9580e+05, 3.9717e+05, 3.9745e+05, 4.0466e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397124.5312, 397142.7188, 397149.4688, 397154.0938,
        397156.0625, 397156.3125, 397157.3125, 397168.2812, 397172.9375,
        751799.4375, 767732.5000, 784014.1875, 786450.8125, 788695.2500,
        788761.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2202e+00, 1.2382e+00, 1.2509e+00, 1.2559e+00, 1.2564e+00,
        1.2648e+00, 1.2698e+00, 1.3997e+00, 3.7697e+05, 3.9126e+05, 3.9270e+05,
        3.9581e+05, 3.9716e+05, 3.9745e+05, 4.0469e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1534e+00, 1.1904e+00, 1.2077e+00, 1.2202e+00, 1.2390e+00,
        1.2469e+00, 1.3508e+00, 1.4824e+00, 3.7697e+05, 3.9129e+05, 3.9270e+05,
        3.9579e+05, 3.9717e+05, 3.9745e+05, 4.0466e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0346e+00, 1.3997e+00, 1.4339e+00, 1.4824e+00, 1.6607e+00,
        1.6766e+00, 1.7347e+00, 1.7554e+00, 3.7696e+05, 3.9131e+05, 3.9266e+05,
        3.9581e+05, 3.9712e+05, 3.9746e+05, 4.0467e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1329e+00, 1.2077e+00, 1.2082e+00, 1.2133e+00, 1.2559e+00,
        1.3295e+00, 1.6124e+00, 1.7554e+00, 3.7697e+05, 3.9128e+05, 3.9270e+05,
        3.9579e+05, 3.9715e+05, 3.9744e+05, 4.0466e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0346e+00, 1.2698e+00, 1.3153e+00, 1.3508e+00, 1.5640e+00,
        1.5667e+00, 1.6067e+00, 1.6124e+00, 3.7696e+05, 3.9129e+05, 3.9265e+05,
        3.9581e+05, 3.9716e+05, 3.9745e+05, 4.0466e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376960.1562, 376961.4062, 376961.5312, 376964.8750,
        376965.0312, 376968.7188, 376969.0938, 376972.2812, 376979.2812,
        751799.4375, 761303.9375, 768020.9375, 771950.0000, 774489.0625,
        781988.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397436.0625, 397437.2188, 397443.6250, 397448.4375,
        397451.1875, 397452.4062, 397454.2812, 397456.6875, 397480.2812,
        768020.9375, 776983.7500, 781750.9375, 786450.8125, 795794.0000,
        809571.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391255.1562, 391255.5000, 391256.6562, 391269.1875,
        391277.2812, 391282.5625, 391288.4375, 391290.3125, 391306.0625,
        774489.0625, 776983.7500, 788761.3750, 790575.3125, 790676.1250,
        796039.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1904e+00, 1.2133e+00, 1.2226e+00, 1.2430e+00, 1.2430e+00,
        1.2509e+00, 1.5667e+00, 1.6766e+00, 3.7697e+05, 3.9126e+05, 3.9270e+05,
        3.9579e+05, 3.9716e+05, 3.9744e+05, 4.0465e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392651.5000, 392656.3125, 392670.9375, 392695.9688,
        392699.3438, 392700.4062, 392700.6250, 392702.9375, 392734.6875,
        761303.9375, 781750.9375, 784014.1875, 788757.2500, 790575.3125,
        794521.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404647.8750, 404655.1562, 404656.7188, 404663.0000,
        404663.9375, 404664.1562, 404673.3750, 404687.1250, 404693.9062,
        771950.0000, 788695.2500, 794521.3750, 796039.1875, 800515.9375,
        809571.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1329e+00, 1.2226e+00, 1.2390e+00, 1.2534e+00, 1.2564e+00,
        1.2650e+00, 1.6067e+00, 1.7347e+00, 3.7696e+05, 3.9127e+05, 3.9273e+05,
        3.9581e+05, 3.9714e+05, 3.9744e+05, 4.0469e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395789.9375, 395790.8125, 395791.5000, 395797.4062,
        395799.2500, 395806.0000, 395808.8438, 395811.0000, 395812.2500,
        767732.5000, 781988.8750, 788757.2500, 790676.1250, 795794.0000,
        800515.9375])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76823.11', '76826.67', '432618.09', '76823.40', '76827.27', '76827.85', '76825.83', '76826.14', '414450.16', '434508.09', '429597.06', '76823.64', '429551.69', '441395.50', '76824.14', '432993.94']
estimated f for each client, fs: [7, 7, 5, 7, 7, 7, 7, 7, 5, 5, 5, 7, 5, 5, 7, 5]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 5, 15, 2, 11, 7, 9, 10, 13, 17, 20, 4, 19, 18, 1, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0174s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:51...
global Accuracy on shared test data: 77.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:51, End: 2025-07-22 16:00:51)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 5, 12, 15, 2, 7, 10, 11, 16, 4, 17, 8, 18, 9, 20, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4122e+00, 1.3013e+00, 3.8988e+05, 1.3542e+00, 1.6122e+00,
         1.7509e+00, 1.3627e+00, 3.9031e+05, 1.3419e+00, 3.8269e+05, 1.3115e+00,
         4.1125e+05, 1.1725e+00, 4.0265e+05, 4.1246e+05],
        [1.4122e+00, 0.0000e+00, 1.3439e+00, 3.8995e+05, 1.4063e+00, 1.3509e+00,
         1.4561e+00, 1.2938e+00, 3.9031e+05, 1.4090e+00, 3.8265e+05, 1.4706e+00,
         4.1125e+05, 1.4400e+00, 4.0267e+05, 4.1246e+05],
        [1.3013e+00, 1.3439e+00, 0.0000e+00, 3.8994e+05, 1.3150e+00, 1.6135e+00,
         1.6612e+00, 1.3160e+00, 3.9032e+05, 1.2532e+00, 3.8264e+05, 1.3070e+00,
         4.1127e+05, 1.2471e+00, 4.0267e+05, 4.1246e+05],
        [3.8988e+05, 3.8995e+05, 3.8994e+05, 0.0000e+00, 3.8995e+05, 3.8990e+05,
         3.8994e+05, 3.8991e+05, 7.7465e+05, 3.8992e+05, 7.5946e+05, 3.8992e+05,
         7.8290e+05, 3.8991e+05, 7.9197e+05, 7.9894e+05],
        [1.3542e+00, 1.4063e+00, 1.3150e+00, 3.8995e+05, 0.0000e+00, 1.2800e+00,
         1.3684e+00, 1.2908e+00, 3.9032e+05, 1.3521e+00, 3.8262e+05, 1.4179e+00,
         4.1127e+05, 1.3150e+00, 4.0270e+05, 4.1243e+05],
        [1.6122e+00, 1.3509e+00, 1.6135e+00, 3.8990e+05, 1.2800e+00, 0.0000e+00,
         1.0121e+00, 1.4008e+00, 3.9029e+05, 1.5296e+00, 3.8263e+05, 1.6591e+00,
         4.1124e+05, 1.5780e+00, 4.0267e+05, 4.1244e+05],
        [1.7509e+00, 1.4561e+00, 1.6612e+00, 3.8994e+05, 1.3684e+00, 1.0121e+00,
         0.0000e+00, 1.4901e+00, 3.9031e+05, 1.6959e+00, 3.8265e+05, 1.7680e+00,
         4.1125e+05, 1.6821e+00, 4.0266e+05, 4.1245e+05],
        [1.3627e+00, 1.2938e+00, 1.3160e+00, 3.8991e+05, 1.2908e+00, 1.4008e+00,
         1.4901e+00, 0.0000e+00, 3.9033e+05, 1.2771e+00, 3.8263e+05, 1.3195e+00,
         4.1128e+05, 1.2910e+00, 4.0269e+05, 4.1244e+05],
        [3.9031e+05, 3.9031e+05, 3.9032e+05, 7.7465e+05, 3.9032e+05, 3.9029e+05,
         3.9031e+05, 3.9033e+05, 0.0000e+00, 3.9033e+05, 7.6724e+05, 3.9032e+05,
         8.0840e+05, 3.9033e+05, 7.9713e+05, 8.1026e+05],
        [1.3419e+00, 1.4090e+00, 1.2532e+00, 3.8992e+05, 1.3521e+00, 1.5296e+00,
         1.6959e+00, 1.2771e+00, 3.9033e+05, 0.0000e+00, 3.8267e+05, 1.3648e+00,
         4.1125e+05, 1.3078e+00, 4.0269e+05, 4.1246e+05],
        [3.8269e+05, 3.8265e+05, 3.8264e+05, 7.5946e+05, 3.8262e+05, 3.8263e+05,
         3.8265e+05, 3.8263e+05, 7.6724e+05, 3.8267e+05, 0.0000e+00, 3.8260e+05,
         7.8292e+05, 3.8269e+05, 7.9306e+05, 7.9819e+05],
        [1.3115e+00, 1.4706e+00, 1.3070e+00, 3.8992e+05, 1.4179e+00, 1.6591e+00,
         1.7680e+00, 1.3195e+00, 3.9032e+05, 1.3648e+00, 3.8260e+05, 0.0000e+00,
         4.1124e+05, 1.2712e+00, 4.0268e+05, 4.1246e+05],
        [4.1125e+05, 4.1125e+05, 4.1127e+05, 7.8290e+05, 4.1127e+05, 4.1124e+05,
         4.1125e+05, 4.1128e+05, 8.0840e+05, 4.1125e+05, 7.8292e+05, 4.1124e+05,
         0.0000e+00, 4.1125e+05, 8.2194e+05, 8.1360e+05],
        [1.1725e+00, 1.4400e+00, 1.2471e+00, 3.8991e+05, 1.3150e+00, 1.5780e+00,
         1.6821e+00, 1.2910e+00, 3.9033e+05, 1.3078e+00, 3.8269e+05, 1.2712e+00,
         4.1125e+05, 0.0000e+00, 4.0268e+05, 4.1247e+05],
        [4.0265e+05, 4.0267e+05, 4.0267e+05, 7.9197e+05, 4.0270e+05, 4.0267e+05,
         4.0266e+05, 4.0269e+05, 7.9713e+05, 4.0269e+05, 7.9306e+05, 4.0268e+05,
         8.2194e+05, 4.0268e+05, 0.0000e+00, 8.0435e+05],
        [4.1246e+05, 4.1246e+05, 4.1246e+05, 7.9894e+05, 4.1243e+05, 4.1244e+05,
         4.1245e+05, 4.1244e+05, 8.1026e+05, 4.1246e+05, 7.9819e+05, 4.1246e+05,
         8.1360e+05, 4.1247e+05, 8.0435e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1725e+00, 1.3013e+00, 1.3115e+00, 1.3419e+00, 1.3542e+00,
        1.3627e+00, 1.4122e+00, 1.6122e+00, 1.7509e+00, 3.8269e+05, 3.8988e+05,
        3.9031e+05, 4.0265e+05, 4.1125e+05, 4.1246e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2938e+00, 1.3439e+00, 1.3509e+00, 1.4063e+00, 1.4090e+00,
        1.4122e+00, 1.4400e+00, 1.4561e+00, 1.4706e+00, 3.8265e+05, 3.8995e+05,
        3.9031e+05, 4.0267e+05, 4.1125e+05, 4.1246e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2471e+00, 1.2532e+00, 1.3013e+00, 1.3070e+00, 1.3150e+00,
        1.3160e+00, 1.3439e+00, 1.6135e+00, 1.6612e+00, 3.8264e+05, 3.8994e+05,
        3.9032e+05, 4.0267e+05, 4.1127e+05, 4.1246e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389882.8438, 389900.8750, 389908.4375, 389911.6562,
        389923.2812, 389924.8438, 389936.5625, 389940.7812, 389947.2812,
        389954.5000, 759459.1875, 774648.5000, 782899.3750, 791973.6250,
        798943.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2800e+00, 1.2908e+00, 1.3150e+00, 1.3150e+00, 1.3521e+00,
        1.3542e+00, 1.3684e+00, 1.4063e+00, 1.4179e+00, 3.8262e+05, 3.8995e+05,
        3.9032e+05, 4.0270e+05, 4.1127e+05, 4.1243e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0121e+00, 1.2800e+00, 1.3509e+00, 1.4008e+00, 1.5296e+00,
        1.5780e+00, 1.6122e+00, 1.6135e+00, 1.6591e+00, 3.8263e+05, 3.8990e+05,
        3.9029e+05, 4.0267e+05, 4.1124e+05, 4.1244e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0121e+00, 1.3684e+00, 1.4561e+00, 1.4901e+00, 1.6612e+00,
        1.6821e+00, 1.6959e+00, 1.7509e+00, 1.7680e+00, 3.8265e+05, 3.8994e+05,
        3.9031e+05, 4.0266e+05, 4.1125e+05, 4.1245e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2771e+00, 1.2908e+00, 1.2910e+00, 1.2938e+00, 1.3160e+00,
        1.3195e+00, 1.3627e+00, 1.4008e+00, 1.4901e+00, 3.8263e+05, 3.8991e+05,
        3.9033e+05, 4.0269e+05, 4.1128e+05, 4.1244e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390290.7188, 390308.3750, 390310.4375, 390312.0938,
        390315.1250, 390323.2500, 390324.2812, 390327.1250, 390327.5312,
        390329.8125, 767235.2500, 774648.5000, 797127.1250, 808398.3750,
        810264.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2532e+00, 1.2771e+00, 1.3078e+00, 1.3419e+00, 1.3521e+00,
        1.3648e+00, 1.4090e+00, 1.5296e+00, 1.6959e+00, 3.8267e+05, 3.8992e+05,
        3.9033e+05, 4.0269e+05, 4.1125e+05, 4.1246e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382604.5000, 382619.6875, 382627.3125, 382627.3750,
        382643.8125, 382649.4375, 382649.7500, 382670.0312, 382686.8750,
        382687.5625, 759459.1875, 767235.2500, 782922.3750, 793055.8750,
        798186.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2712e+00, 1.3070e+00, 1.3115e+00, 1.3195e+00, 1.3648e+00,
        1.4179e+00, 1.4706e+00, 1.6591e+00, 1.7680e+00, 3.8260e+05, 3.8992e+05,
        3.9032e+05, 4.0268e+05, 4.1124e+05, 4.1246e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 411238.7812, 411244.9688, 411248.1250, 411248.4375,
        411251.8750, 411252.3750, 411254.3125, 411266.2812, 411267.5000,
        411279.3125, 782899.3750, 782922.3750, 808398.3750, 813595.0000,
        821936.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1725e+00, 1.2471e+00, 1.2712e+00, 1.2910e+00, 1.3078e+00,
        1.3150e+00, 1.4400e+00, 1.5780e+00, 1.6821e+00, 3.8269e+05, 3.8991e+05,
        3.9033e+05, 4.0268e+05, 4.1125e+05, 4.1247e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402651.8750, 402658.2188, 402667.5000, 402668.1250,
        402673.3125, 402678.0312, 402684.8438, 402686.4375, 402689.5312,
        402697.6250, 791973.6250, 793055.8750, 797127.1250, 804354.5000,
        821936.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 412428.2812, 412440.7188, 412444.6250, 412454.0000,
        412456.0312, 412458.2812, 412459.2500, 412459.5938, 412462.6562,
        412467.7812, 798186.5625, 798943.5625, 804354.5000, 810264.8125,
        813595.0000])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38269.95', '38266.23', '38265.62', '389923.09', '38263.18', '38264.04', '38266.34', '38263.93', '390316.84', '38268.26', '382646.66', '38261.74', '411255.19', '38269.99', '402675.56', '412453.09']
estimated f for each client, fs: [6, 6, 6, 4, 6, 6, 6, 6, 4, 6, 4, 6, 4, 6, 4, 4]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 5, 12, 15, 2, 7, 10, 11, 16, 4, 17, 8, 18, 9, 20, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0119s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:51...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:51, End: 2025-07-22 16:00:51)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 3, 19, 1, 15, 16, 7, 4, 10, 14, 13, 9, 11, 20, 5, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4169e+00, 3.7001e+05, 1.4610e+00, 3.8716e+05, 3.9269e+05,
         1.6540e+00, 1.3934e+00, 1.7195e+00, 3.9822e+05, 3.9383e+05, 1.3741e+00,
         1.4143e+00, 3.9997e+05, 1.3958e+00, 1.4764e+00],
        [1.4169e+00, 0.0000e+00, 3.7002e+05, 1.5750e+00, 3.8716e+05, 3.9268e+05,
         1.3455e+00, 1.4649e+00, 1.4585e+00, 3.9823e+05, 3.9384e+05, 1.4243e+00,
         1.4600e+00, 4.0001e+05, 1.3699e+00, 1.6571e+00],
        [3.7001e+05, 3.7002e+05, 0.0000e+00, 3.7001e+05, 7.6748e+05, 7.8412e+05,
         3.7002e+05, 3.7003e+05, 3.7001e+05, 7.5070e+05, 7.6151e+05, 3.6998e+05,
         3.7001e+05, 7.5025e+05, 3.7000e+05, 3.7002e+05],
        [1.4610e+00, 1.5750e+00, 3.7001e+05, 0.0000e+00, 3.8719e+05, 3.9274e+05,
         1.7182e+00, 1.4799e+00, 1.9106e+00, 3.9823e+05, 3.9385e+05, 1.3218e+00,
         1.4819e+00, 4.0000e+05, 1.4812e+00, 1.4627e+00],
        [3.8716e+05, 3.8716e+05, 7.6748e+05, 3.8719e+05, 0.0000e+00, 7.6809e+05,
         3.8715e+05, 3.8718e+05, 3.8720e+05, 7.8043e+05, 7.6831e+05, 3.8718e+05,
         3.8719e+05, 7.7523e+05, 3.8720e+05, 3.8715e+05],
        [3.9269e+05, 3.9268e+05, 7.8412e+05, 3.9274e+05, 7.6809e+05, 0.0000e+00,
         3.9270e+05, 3.9272e+05, 3.9268e+05, 8.1032e+05, 7.7929e+05, 3.9270e+05,
         3.9271e+05, 7.8079e+05, 3.9271e+05, 3.9269e+05],
        [1.6540e+00, 1.3455e+00, 3.7002e+05, 1.7182e+00, 3.8715e+05, 3.9270e+05,
         0.0000e+00, 1.6055e+00, 1.1201e+00, 3.9822e+05, 3.9384e+05, 1.6421e+00,
         1.4494e+00, 3.9996e+05, 1.3823e+00, 1.8533e+00],
        [1.3934e+00, 1.4649e+00, 3.7003e+05, 1.4799e+00, 3.8718e+05, 3.9272e+05,
         1.6055e+00, 0.0000e+00, 1.8262e+00, 3.9824e+05, 3.9387e+05, 1.3632e+00,
         1.3284e+00, 3.9999e+05, 1.4179e+00, 1.4348e+00],
        [1.7195e+00, 1.4585e+00, 3.7001e+05, 1.9106e+00, 3.8720e+05, 3.9268e+05,
         1.1201e+00, 1.8262e+00, 0.0000e+00, 3.9825e+05, 3.9385e+05, 1.7971e+00,
         1.5781e+00, 3.9998e+05, 1.5192e+00, 2.1110e+00],
        [3.9822e+05, 3.9823e+05, 7.5070e+05, 3.9823e+05, 7.8043e+05, 8.1032e+05,
         3.9822e+05, 3.9824e+05, 3.9825e+05, 0.0000e+00, 7.8234e+05, 3.9821e+05,
         3.9826e+05, 8.0930e+05, 3.9823e+05, 3.9823e+05],
        [3.9383e+05, 3.9384e+05, 7.6151e+05, 3.9385e+05, 7.6831e+05, 7.7929e+05,
         3.9384e+05, 3.9387e+05, 3.9385e+05, 7.8234e+05, 0.0000e+00, 3.9386e+05,
         3.9386e+05, 7.7414e+05, 3.9386e+05, 3.9386e+05],
        [1.3741e+00, 1.4243e+00, 3.6998e+05, 1.3218e+00, 3.8718e+05, 3.9270e+05,
         1.6421e+00, 1.3632e+00, 1.7971e+00, 3.9821e+05, 3.9386e+05, 0.0000e+00,
         1.3821e+00, 3.9998e+05, 1.4423e+00, 1.4538e+00],
        [1.4143e+00, 1.4600e+00, 3.7001e+05, 1.4819e+00, 3.8719e+05, 3.9271e+05,
         1.4494e+00, 1.3284e+00, 1.5781e+00, 3.9826e+05, 3.9386e+05, 1.3821e+00,
         0.0000e+00, 3.9998e+05, 1.2996e+00, 1.5874e+00],
        [3.9997e+05, 4.0001e+05, 7.5025e+05, 4.0000e+05, 7.7523e+05, 7.8079e+05,
         3.9996e+05, 3.9999e+05, 3.9998e+05, 8.0930e+05, 7.7414e+05, 3.9998e+05,
         3.9998e+05, 0.0000e+00, 4.0002e+05, 3.9999e+05],
        [1.3958e+00, 1.3699e+00, 3.7000e+05, 1.4812e+00, 3.8720e+05, 3.9271e+05,
         1.3823e+00, 1.4179e+00, 1.5192e+00, 3.9823e+05, 3.9386e+05, 1.4423e+00,
         1.2996e+00, 4.0002e+05, 0.0000e+00, 1.5588e+00],
        [1.4764e+00, 1.6571e+00, 3.7002e+05, 1.4627e+00, 3.8715e+05, 3.9269e+05,
         1.8533e+00, 1.4348e+00, 2.1110e+00, 3.9823e+05, 3.9386e+05, 1.4538e+00,
         1.5874e+00, 3.9999e+05, 1.5588e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3741e+00, 1.3934e+00, 1.3958e+00, 1.4143e+00, 1.4169e+00,
        1.4610e+00, 1.4764e+00, 1.6540e+00, 1.7195e+00, 3.7001e+05, 3.8716e+05,
        3.9269e+05, 3.9383e+05, 3.9822e+05, 3.9997e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3455e+00, 1.3699e+00, 1.4169e+00, 1.4243e+00, 1.4585e+00,
        1.4600e+00, 1.4649e+00, 1.5750e+00, 1.6571e+00, 3.7002e+05, 3.8716e+05,
        3.9268e+05, 3.9384e+05, 3.9823e+05, 4.0001e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 369975.0312, 369999.5000, 370009.3125, 370013.7812,
        370014.0938, 370014.2188, 370015.8125, 370022.6250, 370024.5625,
        370031.2812, 750245.8750, 750699.0625, 761507.3125, 767480.4375,
        784121.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3218e+00, 1.4610e+00, 1.4627e+00, 1.4799e+00, 1.4812e+00,
        1.4819e+00, 1.5750e+00, 1.7182e+00, 1.9106e+00, 3.7001e+05, 3.8719e+05,
        3.9274e+05, 3.9385e+05, 3.9823e+05, 4.0000e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387146.3750, 387146.7812, 387159.8438, 387163.4688,
        387176.0312, 387183.1562, 387188.7188, 387190.6875, 387201.5000,
        387202.5938, 767480.4375, 768088.7500, 768306.2500, 775234.3750,
        780430.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392676.6875, 392683.7500, 392693.3125, 392693.8438,
        392696.7812, 392703.9062, 392707.1562, 392707.5000, 392720.9062,
        392737.7188, 768088.7500, 779286.6250, 780794.1875, 784121.8125,
        810324.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1201e+00, 1.3455e+00, 1.3823e+00, 1.4494e+00, 1.6055e+00,
        1.6421e+00, 1.6540e+00, 1.7182e+00, 1.8533e+00, 3.7002e+05, 3.8715e+05,
        3.9270e+05, 3.9384e+05, 3.9822e+05, 3.9996e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3284e+00, 1.3632e+00, 1.3934e+00, 1.4179e+00, 1.4348e+00,
        1.4649e+00, 1.4799e+00, 1.6055e+00, 1.8262e+00, 3.7003e+05, 3.8718e+05,
        3.9272e+05, 3.9387e+05, 3.9824e+05, 3.9999e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1201e+00, 1.4585e+00, 1.5192e+00, 1.5781e+00, 1.7195e+00,
        1.7971e+00, 1.8262e+00, 1.9106e+00, 2.1110e+00, 3.7001e+05, 3.8720e+05,
        3.9268e+05, 3.9385e+05, 3.9825e+05, 3.9998e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398210.5625, 398216.8125, 398221.9375, 398229.4062,
        398229.7188, 398231.1250, 398234.4375, 398238.3750, 398248.6250,
        398257.8750, 750699.0625, 780430.0000, 782339.2500, 809295.6250,
        810324.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393830.1250, 393842.4375, 393845.0000, 393845.9688,
        393853.2500, 393856.2812, 393860.3750, 393860.7500, 393864.4375,
        393867.0312, 761507.3125, 768306.2500, 774141.8125, 779286.6250,
        782339.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3218e+00, 1.3632e+00, 1.3741e+00, 1.3821e+00, 1.4243e+00,
        1.4423e+00, 1.4538e+00, 1.6421e+00, 1.7971e+00, 3.6998e+05, 3.8718e+05,
        3.9270e+05, 3.9386e+05, 3.9821e+05, 3.9998e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2996e+00, 1.3284e+00, 1.3821e+00, 1.4143e+00, 1.4494e+00,
        1.4600e+00, 1.4819e+00, 1.5781e+00, 1.5874e+00, 3.7001e+05, 3.8719e+05,
        3.9271e+05, 3.9386e+05, 3.9826e+05, 3.9998e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399957.4375, 399972.9375, 399978.5312, 399979.9375,
        399984.9062, 399986.4062, 399992.4375, 399995.0625, 400009.2188,
        400017.6562, 750245.8750, 774141.8125, 775234.3750, 780794.1875,
        809295.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2996e+00, 1.3699e+00, 1.3823e+00, 1.3958e+00, 1.4179e+00,
        1.4423e+00, 1.4812e+00, 1.5192e+00, 1.5588e+00, 3.7000e+05, 3.8720e+05,
        3.9271e+05, 3.9386e+05, 3.9823e+05, 4.0002e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4348e+00, 1.4538e+00, 1.4627e+00, 1.4764e+00, 1.5588e+00,
        1.5874e+00, 1.6571e+00, 1.8533e+00, 2.1110e+00, 3.7002e+05, 3.8715e+05,
        3.9269e+05, 3.9386e+05, 3.9823e+05, 3.9999e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37002.71', '37003.77', '370012.00', '37002.80', '387175.94', '392702.16', '37002.96', '37004.46', '37002.92', '398231.91', '393852.56', '36998.83', '37002.23', '399987.47', '37001.24', '37003.73']
estimated f for each client, fs: [6, 6, 5, 6, 4, 4, 6, 6, 6, 4, 4, 6, 6, 4, 6, 6]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 3, 19, 1, 15, 16, 7, 4, 10, 14, 13, 9, 11, 20, 5, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0121s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:52...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:52, End: 2025-07-22 16:00:52)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 12, 10, 18, 3, 7, 15, 13, 4, 17, 19, 2, 20, 6, 8, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4950e+00, 1.4439e+00, 3.8153e+05, 1.4248e+00, 1.4502e+00,
         3.9687e+05, 3.8576e+05, 1.6141e+00, 3.8275e+05, 3.9421e+05, 1.4509e+00,
         4.0173e+05, 1.7418e+00, 1.4439e+00, 3.8396e+05],
        [1.4950e+00, 0.0000e+00, 1.6474e+00, 3.8155e+05, 1.4337e+00, 1.5858e+00,
         3.9686e+05, 3.8571e+05, 1.3824e+00, 3.8273e+05, 3.9423e+05, 1.3855e+00,
         4.0177e+05, 1.4634e+00, 1.4673e+00, 3.8394e+05],
        [1.4439e+00, 1.6474e+00, 0.0000e+00, 3.8155e+05, 1.4729e+00, 1.2175e+00,
         3.9688e+05, 3.8573e+05, 1.8198e+00, 3.8276e+05, 3.9425e+05, 1.4602e+00,
         4.0176e+05, 2.0476e+00, 1.5268e+00, 3.8399e+05],
        [3.8153e+05, 3.8155e+05, 3.8155e+05, 0.0000e+00, 3.8155e+05, 3.8155e+05,
         8.0087e+05, 7.7865e+05, 3.8158e+05, 7.6067e+05, 7.6263e+05, 3.8155e+05,
         7.5619e+05, 3.8155e+05, 3.8154e+05, 7.4816e+05],
        [1.4248e+00, 1.4337e+00, 1.4729e+00, 3.8155e+05, 0.0000e+00, 1.3588e+00,
         3.9686e+05, 3.8572e+05, 1.5429e+00, 3.8276e+05, 3.9424e+05, 1.3808e+00,
         4.0174e+05, 1.7071e+00, 1.3635e+00, 3.8396e+05],
        [1.4502e+00, 1.5858e+00, 1.2175e+00, 3.8155e+05, 1.3588e+00, 0.0000e+00,
         3.9690e+05, 3.8573e+05, 1.6674e+00, 3.8275e+05, 3.9421e+05, 1.3812e+00,
         4.0175e+05, 1.8059e+00, 1.4463e+00, 3.8397e+05],
        [3.9687e+05, 3.9686e+05, 3.9688e+05, 8.0087e+05, 3.9686e+05, 3.9690e+05,
         0.0000e+00, 7.8136e+05, 3.9691e+05, 7.8081e+05, 7.8644e+05, 3.9688e+05,
         7.9090e+05, 3.9684e+05, 3.9688e+05, 7.8945e+05],
        [3.8576e+05, 3.8571e+05, 3.8573e+05, 7.7865e+05, 3.8572e+05, 3.8573e+05,
         7.8136e+05, 0.0000e+00, 3.8574e+05, 7.9101e+05, 7.6154e+05, 3.8573e+05,
         7.9618e+05, 3.8572e+05, 3.8573e+05, 7.9521e+05],
        [1.6141e+00, 1.3824e+00, 1.8198e+00, 3.8158e+05, 1.5429e+00, 1.6674e+00,
         3.9691e+05, 3.8574e+05, 0.0000e+00, 3.8273e+05, 3.9420e+05, 1.4935e+00,
         4.0177e+05, 1.4815e+00, 1.4693e+00, 3.8393e+05],
        [3.8275e+05, 3.8273e+05, 3.8276e+05, 7.6067e+05, 3.8276e+05, 3.8275e+05,
         7.8081e+05, 7.9101e+05, 3.8273e+05, 0.0000e+00, 7.7992e+05, 3.8276e+05,
         7.8902e+05, 3.8276e+05, 3.8275e+05, 7.5625e+05],
        [3.9421e+05, 3.9423e+05, 3.9425e+05, 7.6263e+05, 3.9424e+05, 3.9421e+05,
         7.8644e+05, 7.6154e+05, 3.9420e+05, 7.7992e+05, 0.0000e+00, 3.9420e+05,
         8.1372e+05, 3.9420e+05, 3.9421e+05, 7.7533e+05],
        [1.4509e+00, 1.3855e+00, 1.4602e+00, 3.8155e+05, 1.3808e+00, 1.3812e+00,
         3.9688e+05, 3.8573e+05, 1.4935e+00, 3.8276e+05, 3.9420e+05, 0.0000e+00,
         4.0174e+05, 1.4922e+00, 1.4665e+00, 3.8398e+05],
        [4.0173e+05, 4.0177e+05, 4.0176e+05, 7.5619e+05, 4.0174e+05, 4.0175e+05,
         7.9090e+05, 7.9618e+05, 4.0177e+05, 7.8902e+05, 8.1372e+05, 4.0174e+05,
         0.0000e+00, 4.0178e+05, 4.0180e+05, 7.7385e+05],
        [1.7418e+00, 1.4634e+00, 2.0476e+00, 3.8155e+05, 1.7071e+00, 1.8059e+00,
         3.9684e+05, 3.8572e+05, 1.4815e+00, 3.8276e+05, 3.9420e+05, 1.4922e+00,
         4.0178e+05, 0.0000e+00, 1.5510e+00, 3.8392e+05],
        [1.4439e+00, 1.4673e+00, 1.5268e+00, 3.8154e+05, 1.3635e+00, 1.4463e+00,
         3.9688e+05, 3.8573e+05, 1.4693e+00, 3.8275e+05, 3.9421e+05, 1.4665e+00,
         4.0180e+05, 1.5510e+00, 0.0000e+00, 3.8394e+05],
        [3.8396e+05, 3.8394e+05, 3.8399e+05, 7.4816e+05, 3.8396e+05, 3.8397e+05,
         7.8945e+05, 7.9521e+05, 3.8393e+05, 7.5625e+05, 7.7533e+05, 3.8398e+05,
         7.7385e+05, 3.8392e+05, 3.8394e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4248e+00, 1.4439e+00, 1.4439e+00, 1.4502e+00, 1.4509e+00,
        1.4950e+00, 1.6141e+00, 1.7418e+00, 3.8153e+05, 3.8275e+05, 3.8396e+05,
        3.8576e+05, 3.9421e+05, 3.9687e+05, 4.0173e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3824e+00, 1.3855e+00, 1.4337e+00, 1.4634e+00, 1.4673e+00,
        1.4950e+00, 1.5858e+00, 1.6474e+00, 3.8155e+05, 3.8273e+05, 3.8394e+05,
        3.8571e+05, 3.9423e+05, 3.9686e+05, 4.0177e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2175e+00, 1.4439e+00, 1.4602e+00, 1.4729e+00, 1.5268e+00,
        1.6474e+00, 1.8198e+00, 2.0476e+00, 3.8155e+05, 3.8276e+05, 3.8399e+05,
        3.8573e+05, 3.9425e+05, 3.9688e+05, 4.0176e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381533.9375, 381543.5312, 381547.5625, 381549.1875,
        381550.3750, 381551.7500, 381553.5938, 381554.7812, 381577.7812,
        748160.8125, 756190.7500, 760668.2500, 762628.4375, 778647.5000,
        800868.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3588e+00, 1.3635e+00, 1.3808e+00, 1.4248e+00, 1.4337e+00,
        1.4729e+00, 1.5429e+00, 1.7071e+00, 3.8155e+05, 3.8276e+05, 3.8396e+05,
        3.8572e+05, 3.9424e+05, 3.9686e+05, 4.0174e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2175e+00, 1.3588e+00, 1.3812e+00, 1.4463e+00, 1.4502e+00,
        1.5858e+00, 1.6674e+00, 1.8059e+00, 3.8155e+05, 3.8275e+05, 3.8397e+05,
        3.8573e+05, 3.9421e+05, 3.9690e+05, 4.0175e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396843.3750, 396856.5000, 396864.8750, 396867.8750,
        396878.5625, 396879.1875, 396882.7812, 396904.1250, 396907.5938,
        780813.5625, 781356.3125, 786441.4375, 789451.8750, 790896.2500,
        800868.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385713.8750, 385715.7500, 385721.8750, 385725.3125,
        385725.4375, 385726.7500, 385731.3750, 385743.3750, 385764.3438,
        761535.0000, 778647.5000, 781356.3125, 791011.3750, 795214.8750,
        796175.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3824e+00, 1.4693e+00, 1.4815e+00, 1.4935e+00, 1.5429e+00,
        1.6141e+00, 1.6674e+00, 1.8198e+00, 3.8158e+05, 3.8273e+05, 3.8393e+05,
        3.8574e+05, 3.9420e+05, 3.9691e+05, 4.0177e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382733.6250, 382734.0312, 382751.8125, 382752.0625,
        382753.6875, 382756.6875, 382757.1250, 382759.6875, 382762.9062,
        756247.3125, 760668.2500, 779915.5625, 780813.5625, 789019.3750,
        791011.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394196.3438, 394196.3438, 394196.7812, 394208.6250,
        394209.0625, 394214.3125, 394230.6875, 394236.4375, 394250.3438,
        761535.0000, 762628.4375, 775328.5625, 779915.5625, 786441.4375,
        813723.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3808e+00, 1.3812e+00, 1.3855e+00, 1.4509e+00, 1.4602e+00,
        1.4665e+00, 1.4922e+00, 1.4935e+00, 3.8155e+05, 3.8276e+05, 3.8398e+05,
        3.8573e+05, 3.9420e+05, 3.9688e+05, 4.0174e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401732.6562, 401741.5625, 401742.9375, 401749.5312,
        401757.7500, 401765.4688, 401772.5000, 401775.1250, 401800.8750,
        756190.7500, 773854.7500, 789019.3750, 790896.2500, 796175.8750,
        813723.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4634e+00, 1.4815e+00, 1.4922e+00, 1.5510e+00, 1.7071e+00,
        1.7418e+00, 1.8059e+00, 2.0476e+00, 3.8155e+05, 3.8276e+05, 3.8392e+05,
        3.8572e+05, 3.9420e+05, 3.9684e+05, 4.0178e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3635e+00, 1.4439e+00, 1.4463e+00, 1.4665e+00, 1.4673e+00,
        1.4693e+00, 1.5268e+00, 1.5510e+00, 3.8154e+05, 3.8275e+05, 3.8394e+05,
        3.8573e+05, 3.9421e+05, 3.9688e+05, 4.0180e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383920.8438, 383929.8750, 383939.7812, 383940.3438,
        383960.6250, 383960.9375, 383974.1250, 383978.9375, 383987.0312,
        748160.8125, 756247.3125, 773854.7500, 775328.5625, 789451.8750,
        795214.8750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76429.97', '76429.34', '76431.89', '418212.31', '76432.50', '76431.73', '435269.84', '423310.34', '76432.39', '420100.91', '430947.41', '76432.59', '437202.91', '76432.17', '76430.73', '420375.34']
estimated f for each client, fs: [7, 7, 7, 5, 7, 7, 5, 5, 7, 5, 5, 7, 5, 7, 7, 5]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 12, 10, 18, 3, 7, 15, 13, 4, 17, 19, 2, 20, 6, 8, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0276s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:53...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:53, End: 2025-07-22 16:00:53)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [5, 18, 3, 8, 17, 16, 15, 14, 2, 4, 6, 9, 13, 11, 10, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7836e+05, 1.4538e+00, 1.5248e+00, 4.0379e+05, 3.8268e+05,
         3.9209e+05, 3.7957e+05, 1.5495e+00, 1.5956e+00, 1.6691e+00, 1.5085e+00,
         3.8194e+05, 1.4828e+00, 1.5556e+00, 3.9503e+05],
        [3.7836e+05, 0.0000e+00, 3.7834e+05, 3.7834e+05, 7.7345e+05, 7.5709e+05,
         7.8239e+05, 7.4204e+05, 3.7835e+05, 3.7837e+05, 3.7833e+05, 3.7835e+05,
         7.5260e+05, 3.7835e+05, 3.7835e+05, 7.8527e+05],
        [1.4538e+00, 3.7834e+05, 0.0000e+00, 1.3579e+00, 4.0380e+05, 3.8270e+05,
         3.9207e+05, 3.7958e+05, 1.3617e+00, 1.5791e+00, 1.6730e+00, 1.3069e+00,
         3.8194e+05, 1.5309e+00, 1.4576e+00, 3.9511e+05],
        [1.5248e+00, 3.7834e+05, 1.3579e+00, 0.0000e+00, 4.0380e+05, 3.8267e+05,
         3.9207e+05, 3.7959e+05, 1.4477e+00, 1.4818e+00, 1.5450e+00, 1.3490e+00,
         3.8193e+05, 1.4644e+00, 1.5215e+00, 3.9506e+05],
        [4.0379e+05, 7.7345e+05, 4.0380e+05, 4.0380e+05, 0.0000e+00, 7.8535e+05,
         8.1702e+05, 8.0357e+05, 4.0378e+05, 4.0380e+05, 4.0382e+05, 4.0379e+05,
         7.8655e+05, 4.0379e+05, 4.0377e+05, 8.1164e+05],
        [3.8268e+05, 7.5709e+05, 3.8270e+05, 3.8267e+05, 7.8535e+05, 0.0000e+00,
         7.8582e+05, 7.5818e+05, 3.8271e+05, 3.8269e+05, 3.8269e+05, 3.8272e+05,
         7.6697e+05, 3.8270e+05, 3.8270e+05, 7.8492e+05],
        [3.9209e+05, 7.8239e+05, 3.9207e+05, 3.9207e+05, 8.1702e+05, 7.8582e+05,
         0.0000e+00, 7.6111e+05, 3.9208e+05, 3.9205e+05, 3.9208e+05, 3.9207e+05,
         7.7813e+05, 3.9207e+05, 3.9211e+05, 7.9780e+05],
        [3.7957e+05, 7.4204e+05, 3.7958e+05, 3.7959e+05, 8.0357e+05, 7.5818e+05,
         7.6111e+05, 0.0000e+00, 3.7960e+05, 3.7962e+05, 3.7961e+05, 3.7959e+05,
         7.5967e+05, 3.7960e+05, 3.7959e+05, 7.9387e+05],
        [1.5495e+00, 3.7835e+05, 1.3617e+00, 1.4477e+00, 4.0378e+05, 3.8271e+05,
         3.9208e+05, 3.7960e+05, 0.0000e+00, 1.5015e+00, 1.4991e+00, 1.3422e+00,
         3.8190e+05, 1.4229e+00, 1.4351e+00, 3.9507e+05],
        [1.5956e+00, 3.7837e+05, 1.5791e+00, 1.4818e+00, 4.0380e+05, 3.8269e+05,
         3.9205e+05, 3.7962e+05, 1.5015e+00, 0.0000e+00, 1.4993e+00, 1.5019e+00,
         3.8194e+05, 1.4359e+00, 1.7742e+00, 3.9503e+05],
        [1.6691e+00, 3.7833e+05, 1.6730e+00, 1.5450e+00, 4.0382e+05, 3.8269e+05,
         3.9208e+05, 3.7961e+05, 1.4991e+00, 1.4993e+00, 0.0000e+00, 1.6091e+00,
         3.8192e+05, 1.5673e+00, 1.9638e+00, 3.9508e+05],
        [1.5085e+00, 3.7835e+05, 1.3069e+00, 1.3490e+00, 4.0379e+05, 3.8272e+05,
         3.9207e+05, 3.7959e+05, 1.3422e+00, 1.5019e+00, 1.6091e+00, 0.0000e+00,
         3.8194e+05, 1.4144e+00, 1.4443e+00, 3.9504e+05],
        [3.8194e+05, 7.5260e+05, 3.8194e+05, 3.8193e+05, 7.8655e+05, 7.6697e+05,
         7.7813e+05, 7.5967e+05, 3.8190e+05, 3.8194e+05, 3.8192e+05, 3.8194e+05,
         0.0000e+00, 3.8189e+05, 3.8192e+05, 7.7277e+05],
        [1.4828e+00, 3.7835e+05, 1.5309e+00, 1.4644e+00, 4.0379e+05, 3.8270e+05,
         3.9207e+05, 3.7960e+05, 1.4229e+00, 1.4359e+00, 1.5673e+00, 1.4144e+00,
         3.8189e+05, 0.0000e+00, 1.5497e+00, 3.9504e+05],
        [1.5556e+00, 3.7835e+05, 1.4576e+00, 1.5215e+00, 4.0377e+05, 3.8270e+05,
         3.9211e+05, 3.7959e+05, 1.4351e+00, 1.7742e+00, 1.9638e+00, 1.4443e+00,
         3.8192e+05, 1.5497e+00, 0.0000e+00, 3.9503e+05],
        [3.9503e+05, 7.8527e+05, 3.9511e+05, 3.9506e+05, 8.1164e+05, 7.8492e+05,
         7.9780e+05, 7.9387e+05, 3.9507e+05, 3.9503e+05, 3.9508e+05, 3.9504e+05,
         7.7277e+05, 3.9504e+05, 3.9503e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4538e+00, 1.4828e+00, 1.5085e+00, 1.5248e+00, 1.5495e+00,
        1.5556e+00, 1.5956e+00, 1.6691e+00, 3.7836e+05, 3.7957e+05, 3.8194e+05,
        3.8268e+05, 3.9209e+05, 3.9503e+05, 4.0379e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 378326.4375, 378338.7188, 378341.0625, 378347.4688,
        378348.5625, 378352.6875, 378354.2812, 378358.6875, 378371.3125,
        742035.4375, 752599.7500, 757090.1875, 773454.0625, 782392.4375,
        785266.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3069e+00, 1.3579e+00, 1.3617e+00, 1.4538e+00, 1.4576e+00,
        1.5309e+00, 1.5791e+00, 1.6730e+00, 3.7834e+05, 3.7958e+05, 3.8194e+05,
        3.8270e+05, 3.9207e+05, 3.9511e+05, 4.0380e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3490e+00, 1.3579e+00, 1.4477e+00, 1.4644e+00, 1.4818e+00,
        1.5215e+00, 1.5248e+00, 1.5450e+00, 3.7834e+05, 3.7959e+05, 3.8193e+05,
        3.8267e+05, 3.9207e+05, 3.9506e+05, 4.0380e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403772.3438, 403775.7500, 403793.3125, 403793.3438,
        403793.5625, 403795.4062, 403801.6250, 403803.4062, 403815.4062,
        773454.0625, 785352.9375, 786546.9375, 803566.1250, 811636.8750,
        817015.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382665.8438, 382677.7500, 382692.0625, 382692.0625,
        382699.4688, 382702.1875, 382702.9688, 382712.6562, 382717.3750,
        757090.1875, 758176.0625, 766970.4375, 784921.1875, 785352.9375,
        785815.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392047.6875, 392067.9375, 392070.1562, 392071.3438,
        392074.8125, 392078.3438, 392082.2812, 392086.2188, 392108.4062,
        761112.2500, 778134.8125, 782392.4375, 785815.0000, 797803.5625,
        817015.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379567.9688, 379581.9062, 379586.6250, 379591.2500,
        379594.2812, 379596.2188, 379603.5312, 379605.1875, 379615.8438,
        742035.4375, 758176.0625, 759674.4375, 761112.2500, 793874.0000,
        803566.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3422e+00, 1.3617e+00, 1.4229e+00, 1.4351e+00, 1.4477e+00,
        1.4991e+00, 1.5015e+00, 1.5495e+00, 3.7835e+05, 3.7960e+05, 3.8190e+05,
        3.8271e+05, 3.9208e+05, 3.9507e+05, 4.0378e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4359e+00, 1.4818e+00, 1.4993e+00, 1.5015e+00, 1.5019e+00,
        1.5791e+00, 1.5956e+00, 1.7742e+00, 3.7837e+05, 3.7962e+05, 3.8194e+05,
        3.8269e+05, 3.9205e+05, 3.9503e+05, 4.0380e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4991e+00, 1.4993e+00, 1.5450e+00, 1.5673e+00, 1.6091e+00,
        1.6691e+00, 1.6730e+00, 1.9638e+00, 3.7833e+05, 3.7961e+05, 3.8192e+05,
        3.8269e+05, 3.9208e+05, 3.9508e+05, 4.0382e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3069e+00, 1.3422e+00, 1.3490e+00, 1.4144e+00, 1.4443e+00,
        1.5019e+00, 1.5085e+00, 1.6091e+00, 3.7835e+05, 3.7959e+05, 3.8194e+05,
        3.8272e+05, 3.9207e+05, 3.9504e+05, 4.0379e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381887.2500, 381904.3125, 381919.0000, 381922.6562,
        381934.1250, 381935.5000, 381936.5312, 381940.7188, 381944.3125,
        752599.7500, 759674.4375, 766970.4375, 772765.5000, 778134.8125,
        786546.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4144e+00, 1.4229e+00, 1.4359e+00, 1.4644e+00, 1.4828e+00,
        1.5309e+00, 1.5497e+00, 1.5673e+00, 3.7835e+05, 3.7960e+05, 3.8189e+05,
        3.8270e+05, 3.9207e+05, 3.9504e+05, 4.0379e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4351e+00, 1.4443e+00, 1.4576e+00, 1.5215e+00, 1.5497e+00,
        1.5556e+00, 1.7742e+00, 1.9638e+00, 3.7835e+05, 3.7959e+05, 3.8192e+05,
        3.8270e+05, 3.9211e+05, 3.9503e+05, 4.0377e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395029.5938, 395031.6250, 395031.9062, 395039.2812,
        395041.8125, 395063.5625, 395072.8438, 395082.4375, 395109.3438,
        772765.5000, 784921.1875, 785266.6250, 793874.0000, 797803.5625,
        811636.8750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75793.90', '414717.47', '75793.47', '75794.47', '440759.84', '420135.25', '428979.91', '415837.81', '75795.63', '75799.95', '75794.47', '75795.55', '418992.44', '75796.97', '75794.67', '432826.75']
estimated f for each client, fs: [7, 5, 7, 7, 5, 5, 5, 5, 7, 7, 7, 7, 5, 7, 7, 5]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 18, 3, 8, 17, 16, 15, 14, 2, 4, 6, 9, 13, 11, 10, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0129s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:53...
global Accuracy on shared test data: 78.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 47 216]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:53, End: 2025-07-22 16:00:53)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 20, 6, 10, 16, 5, 2, 7, 12, 8, 18, 17, 3, 19, 1, 4], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.8727e+05, 3.8978e+05, 3.8976e+05, 7.7258e+05, 3.8979e+05,
         3.8976e+05, 3.8976e+05, 3.8976e+05, 3.8976e+05, 7.9794e+05, 7.7443e+05,
         3.8974e+05, 7.9151e+05, 3.8977e+05, 3.8979e+05],
        [7.8727e+05, 0.0000e+00, 4.1091e+05, 4.1091e+05, 8.0078e+05, 4.1091e+05,
         4.1090e+05, 4.1090e+05, 4.1087e+05, 4.1087e+05, 8.2623e+05, 8.0180e+05,
         4.1092e+05, 8.0839e+05, 4.1088e+05, 4.1089e+05],
        [3.8978e+05, 4.1091e+05, 0.0000e+00, 1.8323e+00, 3.8478e+05, 1.5233e+00,
         1.3602e+00, 1.6428e+00, 1.4296e+00, 1.3888e+00, 4.0132e+05, 3.9297e+05,
         2.0419e+00, 4.0358e+05, 1.2848e+00, 1.3847e+00],
        [3.8976e+05, 4.1091e+05, 1.8323e+00, 0.0000e+00, 3.8479e+05, 1.4602e+00,
         1.3281e+00, 1.1441e+00, 1.3182e+00, 1.4442e+00, 4.0128e+05, 3.9294e+05,
         1.3719e+00, 4.0362e+05, 1.6531e+00, 1.6472e+00],
        [7.7258e+05, 8.0078e+05, 3.8478e+05, 3.8479e+05, 0.0000e+00, 3.8478e+05,
         3.8481e+05, 3.8482e+05, 3.8477e+05, 3.8482e+05, 7.7064e+05, 7.6147e+05,
         3.8479e+05, 8.0642e+05, 3.8478e+05, 3.8479e+05],
        [3.8979e+05, 4.1091e+05, 1.5233e+00, 1.4602e+00, 3.8478e+05, 0.0000e+00,
         1.3809e+00, 1.3153e+00, 1.2880e+00, 1.3955e+00, 4.0132e+05, 3.9294e+05,
         1.5873e+00, 4.0360e+05, 1.3570e+00, 1.3694e+00],
        [3.8976e+05, 4.1090e+05, 1.3602e+00, 1.3281e+00, 3.8481e+05, 1.3809e+00,
         0.0000e+00, 1.2674e+00, 1.2718e+00, 1.3121e+00, 4.0132e+05, 3.9297e+05,
         1.5818e+00, 4.0362e+05, 1.2999e+00, 1.3057e+00],
        [3.8976e+05, 4.1090e+05, 1.6428e+00, 1.1441e+00, 3.8482e+05, 1.3153e+00,
         1.2674e+00, 0.0000e+00, 1.2425e+00, 1.3294e+00, 4.0133e+05, 3.9293e+05,
         1.3277e+00, 4.0362e+05, 1.4517e+00, 1.4293e+00],
        [3.8976e+05, 4.1087e+05, 1.4296e+00, 1.3182e+00, 3.8477e+05, 1.2880e+00,
         1.2718e+00, 1.2425e+00, 0.0000e+00, 1.2727e+00, 4.0128e+05, 3.9297e+05,
         1.4060e+00, 4.0363e+05, 1.3550e+00, 1.2936e+00],
        [3.8976e+05, 4.1087e+05, 1.3888e+00, 1.4442e+00, 3.8482e+05, 1.3955e+00,
         1.3121e+00, 1.3294e+00, 1.2727e+00, 0.0000e+00, 4.0131e+05, 3.9295e+05,
         1.5209e+00, 4.0359e+05, 1.3662e+00, 1.3547e+00],
        [7.9794e+05, 8.2623e+05, 4.0132e+05, 4.0128e+05, 7.7064e+05, 4.0132e+05,
         4.0132e+05, 4.0133e+05, 4.0128e+05, 4.0131e+05, 0.0000e+00, 7.9027e+05,
         4.0132e+05, 8.0738e+05, 4.0132e+05, 4.0131e+05],
        [7.7443e+05, 8.0180e+05, 3.9297e+05, 3.9294e+05, 7.6147e+05, 3.9294e+05,
         3.9297e+05, 3.9293e+05, 3.9297e+05, 3.9295e+05, 7.9027e+05, 0.0000e+00,
         3.9291e+05, 8.0136e+05, 3.9294e+05, 3.9296e+05],
        [3.8974e+05, 4.1092e+05, 2.0419e+00, 1.3719e+00, 3.8479e+05, 1.5873e+00,
         1.5818e+00, 1.3277e+00, 1.4060e+00, 1.5209e+00, 4.0132e+05, 3.9291e+05,
         0.0000e+00, 4.0360e+05, 1.7966e+00, 1.7678e+00],
        [7.9151e+05, 8.0839e+05, 4.0358e+05, 4.0362e+05, 8.0642e+05, 4.0360e+05,
         4.0362e+05, 4.0362e+05, 4.0363e+05, 4.0359e+05, 8.0738e+05, 8.0136e+05,
         4.0360e+05, 0.0000e+00, 4.0360e+05, 4.0360e+05],
        [3.8977e+05, 4.1088e+05, 1.2848e+00, 1.6531e+00, 3.8478e+05, 1.3570e+00,
         1.2999e+00, 1.4517e+00, 1.3550e+00, 1.3662e+00, 4.0132e+05, 3.9294e+05,
         1.7966e+00, 4.0360e+05, 0.0000e+00, 1.3499e+00],
        [3.8979e+05, 4.1089e+05, 1.3847e+00, 1.6472e+00, 3.8479e+05, 1.3694e+00,
         1.3057e+00, 1.4293e+00, 1.2936e+00, 1.3547e+00, 4.0131e+05, 3.9296e+05,
         1.7678e+00, 4.0360e+05, 1.3499e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 389737.3750, 389757.0625, 389758.5312, 389760.5000,
        389761.4375, 389761.8125, 389774.4062, 389783.8125, 389790.3438,
        389793.0625, 772584.0625, 774428.5000, 787271.8750, 791509.2500,
        797942.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 410871.0000, 410873.5938, 410876.1250, 410888.7500,
        410896.0625, 410904.5938, 410908.5000, 410909.2188, 410913.2812,
        410923.8438, 787271.8750, 800776.1250, 801801.3750, 808392.4375,
        826229.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2848e+00, 1.3602e+00, 1.3847e+00, 1.3888e+00, 1.4296e+00,
        1.5233e+00, 1.6428e+00, 1.8323e+00, 2.0419e+00, 3.8478e+05, 3.8978e+05,
        3.9297e+05, 4.0132e+05, 4.0358e+05, 4.1091e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1441e+00, 1.3182e+00, 1.3281e+00, 1.3719e+00, 1.4442e+00,
        1.4602e+00, 1.6472e+00, 1.6531e+00, 1.8323e+00, 3.8479e+05, 3.8976e+05,
        3.9294e+05, 4.0128e+05, 4.0362e+05, 4.1091e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384770.1250, 384776.6562, 384782.0625, 384782.2500,
        384786.3750, 384787.4062, 384788.9375, 384809.8438, 384815.5625,
        384816.7812, 761474.0625, 770636.1875, 772584.0625, 800776.1250,
        806421.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2880e+00, 1.3153e+00, 1.3570e+00, 1.3694e+00, 1.3809e+00,
        1.3955e+00, 1.4602e+00, 1.5233e+00, 1.5873e+00, 3.8478e+05, 3.8979e+05,
        3.9294e+05, 4.0132e+05, 4.0360e+05, 4.1091e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2674e+00, 1.2718e+00, 1.2999e+00, 1.3057e+00, 1.3121e+00,
        1.3281e+00, 1.3602e+00, 1.3809e+00, 1.5818e+00, 3.8481e+05, 3.8976e+05,
        3.9297e+05, 4.0132e+05, 4.0362e+05, 4.1090e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1441e+00, 1.2425e+00, 1.2674e+00, 1.3153e+00, 1.3277e+00,
        1.3294e+00, 1.4293e+00, 1.4517e+00, 1.6428e+00, 3.8482e+05, 3.8976e+05,
        3.9293e+05, 4.0133e+05, 4.0362e+05, 4.1090e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2425e+00, 1.2718e+00, 1.2727e+00, 1.2880e+00, 1.2936e+00,
        1.3182e+00, 1.3550e+00, 1.4060e+00, 1.4296e+00, 3.8477e+05, 3.8976e+05,
        3.9297e+05, 4.0128e+05, 4.0363e+05, 4.1087e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2727e+00, 1.3121e+00, 1.3294e+00, 1.3547e+00, 1.3662e+00,
        1.3888e+00, 1.3955e+00, 1.4442e+00, 1.5209e+00, 3.8482e+05, 3.8976e+05,
        3.9295e+05, 4.0131e+05, 4.0359e+05, 4.1087e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401280.4062, 401284.4062, 401307.4062, 401314.5000,
        401316.0625, 401316.4375, 401318.4375, 401322.9688, 401323.1250,
        401328.9375, 770636.1875, 790268.5625, 797942.3125, 807376.6875,
        826229.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392907.5000, 392931.7500, 392939.4062, 392941.3438,
        392942.1875, 392951.3125, 392955.7188, 392966.3438, 392966.5938,
        392972.2500, 761474.0625, 774428.5000, 790268.5625, 801355.8750,
        801801.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3277e+00, 1.3719e+00, 1.4060e+00, 1.5209e+00, 1.5818e+00,
        1.5873e+00, 1.7678e+00, 1.7966e+00, 2.0419e+00, 3.8479e+05, 3.8974e+05,
        3.9291e+05, 4.0132e+05, 4.0360e+05, 4.1092e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403577.2500, 403587.3750, 403596.2188, 403596.2500,
        403603.1875, 403604.1250, 403617.6250, 403622.4688, 403624.1875,
        403634.4062, 791509.2500, 801355.8750, 806421.1875, 807376.6875,
        808392.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2848e+00, 1.2999e+00, 1.3499e+00, 1.3550e+00, 1.3570e+00,
        1.3662e+00, 1.4517e+00, 1.6531e+00, 1.7966e+00, 3.8478e+05, 3.8977e+05,
        3.9294e+05, 4.0132e+05, 4.0360e+05, 4.1088e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2936e+00, 1.3057e+00, 1.3499e+00, 1.3547e+00, 1.3694e+00,
        1.3847e+00, 1.4293e+00, 1.6472e+00, 1.7678e+00, 3.8479e+05, 3.8979e+05,
        3.9296e+05, 4.0131e+05, 4.0360e+05, 4.1089e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['389767.81', '410896.47', '38479.60', '38479.96', '384791.62', '38478.93', '38482.20', '38482.90', '38478.20', '38482.80', '401311.28', '392947.44', '38480.34', '403606.31', '38479.51', '38480.03']
estimated f for each client, fs: [4, 4, 6, 6, 4, 6, 6, 6, 6, 6, 4, 4, 6, 4, 6, 6]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 20, 6, 10, 16, 5, 2, 7, 12, 8, 18, 17, 3, 19, 1, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0142s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:54...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:54, End: 2025-07-22 16:00:54)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 11, 17, 7, 18, 8, 16, 5, 20, 13, 4, 2, 15, 12, 14, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3274e+00, 3.9699e+05, 1.0694e+00, 3.8401e+05, 1.3212e+00,
         3.8147e+05, 1.3435e+00, 3.9821e+05, 3.9170e+05, 1.5362e+00, 1.2671e+00,
         3.9717e+05, 1.2407e+00, 3.9141e+05, 1.1881e+00],
        [1.3274e+00, 0.0000e+00, 3.9699e+05, 1.2999e+00, 3.8402e+05, 1.2768e+00,
         3.8144e+05, 1.2814e+00, 3.9821e+05, 3.9171e+05, 1.2936e+00, 1.2473e+00,
         3.9717e+05, 1.5644e+00, 3.9141e+05, 1.5022e+00],
        [3.9699e+05, 3.9699e+05, 0.0000e+00, 3.9699e+05, 7.6067e+05, 3.9698e+05,
         7.7656e+05, 3.9702e+05, 8.1151e+05, 7.7727e+05, 3.9699e+05, 3.9700e+05,
         7.9643e+05, 3.9704e+05, 7.6831e+05, 3.9699e+05],
        [1.0694e+00, 1.2999e+00, 3.9699e+05, 0.0000e+00, 3.8401e+05, 1.2316e+00,
         3.8146e+05, 1.2765e+00, 3.9820e+05, 3.9174e+05, 1.4300e+00, 1.2646e+00,
         3.9716e+05, 1.2807e+00, 3.9144e+05, 1.1719e+00],
        [3.8401e+05, 3.8402e+05, 7.6067e+05, 3.8401e+05, 0.0000e+00, 3.8404e+05,
         7.5905e+05, 3.8404e+05, 8.0255e+05, 7.9320e+05, 3.8404e+05, 3.8400e+05,
         7.7570e+05, 3.8402e+05, 7.7889e+05, 3.8403e+05],
        [1.3212e+00, 1.2768e+00, 3.9698e+05, 1.2316e+00, 3.8404e+05, 0.0000e+00,
         3.8148e+05, 1.3431e+00, 3.9822e+05, 3.9172e+05, 1.3251e+00, 1.2867e+00,
         3.9715e+05, 1.4115e+00, 3.9144e+05, 1.2787e+00],
        [3.8147e+05, 3.8144e+05, 7.7656e+05, 3.8146e+05, 7.5905e+05, 3.8148e+05,
         0.0000e+00, 3.8145e+05, 7.8663e+05, 7.6734e+05, 3.8141e+05, 3.8147e+05,
         7.8537e+05, 3.8148e+05, 7.6924e+05, 3.8146e+05],
        [1.3435e+00, 1.2814e+00, 3.9702e+05, 1.2765e+00, 3.8404e+05, 1.3431e+00,
         3.8145e+05, 0.0000e+00, 3.9821e+05, 3.9172e+05, 1.4139e+00, 1.3981e+00,
         3.9716e+05, 1.4219e+00, 3.9144e+05, 1.3513e+00],
        [3.9821e+05, 3.9821e+05, 8.1151e+05, 3.9820e+05, 8.0255e+05, 3.9822e+05,
         7.8663e+05, 3.9821e+05, 0.0000e+00, 7.8103e+05, 3.9820e+05, 3.9822e+05,
         7.8595e+05, 3.9822e+05, 8.1435e+05, 3.9820e+05],
        [3.9170e+05, 3.9171e+05, 7.7727e+05, 3.9174e+05, 7.9320e+05, 3.9172e+05,
         7.6734e+05, 3.9172e+05, 7.8103e+05, 0.0000e+00, 3.9171e+05, 3.9173e+05,
         7.9516e+05, 3.9174e+05, 7.8019e+05, 3.9173e+05],
        [1.5362e+00, 1.2936e+00, 3.9699e+05, 1.4300e+00, 3.8404e+05, 1.3251e+00,
         3.8141e+05, 1.4139e+00, 3.9820e+05, 3.9171e+05, 0.0000e+00, 1.3534e+00,
         3.9717e+05, 1.6143e+00, 3.9141e+05, 1.5338e+00],
        [1.2671e+00, 1.2473e+00, 3.9700e+05, 1.2646e+00, 3.8400e+05, 1.2867e+00,
         3.8147e+05, 1.3981e+00, 3.9822e+05, 3.9173e+05, 1.3534e+00, 0.0000e+00,
         3.9715e+05, 1.5315e+00, 3.9139e+05, 1.3768e+00],
        [3.9717e+05, 3.9717e+05, 7.9643e+05, 3.9716e+05, 7.7570e+05, 3.9715e+05,
         7.8537e+05, 3.9716e+05, 7.8595e+05, 7.9516e+05, 3.9717e+05, 3.9715e+05,
         0.0000e+00, 3.9716e+05, 7.9219e+05, 3.9714e+05],
        [1.2407e+00, 1.5644e+00, 3.9704e+05, 1.2807e+00, 3.8402e+05, 1.4115e+00,
         3.8148e+05, 1.4219e+00, 3.9822e+05, 3.9174e+05, 1.6143e+00, 1.5315e+00,
         3.9716e+05, 0.0000e+00, 3.9141e+05, 1.1677e+00],
        [3.9141e+05, 3.9141e+05, 7.6831e+05, 3.9144e+05, 7.7889e+05, 3.9144e+05,
         7.6924e+05, 3.9144e+05, 8.1435e+05, 7.8019e+05, 3.9141e+05, 3.9139e+05,
         7.9219e+05, 3.9141e+05, 0.0000e+00, 3.9145e+05],
        [1.1881e+00, 1.5022e+00, 3.9699e+05, 1.1719e+00, 3.8403e+05, 1.2787e+00,
         3.8146e+05, 1.3513e+00, 3.9820e+05, 3.9173e+05, 1.5338e+00, 1.3768e+00,
         3.9714e+05, 1.1677e+00, 3.9145e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0694e+00, 1.1881e+00, 1.2407e+00, 1.2671e+00, 1.3212e+00,
        1.3274e+00, 1.3435e+00, 1.5362e+00, 3.8147e+05, 3.8401e+05, 3.9141e+05,
        3.9170e+05, 3.9699e+05, 3.9717e+05, 3.9821e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2473e+00, 1.2768e+00, 1.2814e+00, 1.2936e+00, 1.2999e+00,
        1.3274e+00, 1.5022e+00, 1.5644e+00, 3.8144e+05, 3.8402e+05, 3.9141e+05,
        3.9171e+05, 3.9699e+05, 3.9717e+05, 3.9821e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396984.0000, 396986.3750, 396987.0625, 396987.2500,
        396991.0938, 396993.4062, 397004.7188, 397021.0000, 397039.4062,
        760673.1250, 768305.7500, 776559.7500, 777273.8750, 796432.5625,
        811510.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0694e+00, 1.1719e+00, 1.2316e+00, 1.2646e+00, 1.2765e+00,
        1.2807e+00, 1.2999e+00, 1.4300e+00, 3.8146e+05, 3.8401e+05, 3.9144e+05,
        3.9174e+05, 3.9699e+05, 3.9716e+05, 3.9820e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383996.4062, 384008.9375, 384013.7500, 384017.0312,
        384023.4688, 384025.8750, 384036.8750, 384038.5625, 384041.3438,
        759054.5000, 760673.1250, 775700.8750, 778887.0000, 793199.8750,
        802548.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2316e+00, 1.2768e+00, 1.2787e+00, 1.2867e+00, 1.3212e+00,
        1.3251e+00, 1.3431e+00, 1.4115e+00, 3.8148e+05, 3.8404e+05, 3.9144e+05,
        3.9172e+05, 3.9698e+05, 3.9715e+05, 3.9822e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381405.5000, 381443.0312, 381454.8125, 381458.9062,
        381460.3125, 381468.3125, 381472.0312, 381476.6875, 381476.8125,
        759054.5000, 767340.3750, 769244.0000, 776559.7500, 785369.4375,
        786625.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2765e+00, 1.2814e+00, 1.3431e+00, 1.3435e+00, 1.3513e+00,
        1.3981e+00, 1.4139e+00, 1.4219e+00, 3.8145e+05, 3.8404e+05, 3.9144e+05,
        3.9172e+05, 3.9702e+05, 3.9716e+05, 3.9821e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398200.8125, 398202.8750, 398204.2500, 398208.0312,
        398212.0000, 398213.1250, 398221.1875, 398223.2500, 398223.5312,
        781034.3125, 785952.8125, 786625.5625, 802548.4375, 811510.5625,
        814353.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391696.4375, 391711.4062, 391712.6562, 391720.0312,
        391722.3125, 391726.3125, 391733.9062, 391737.4375, 391744.5312,
        767340.3750, 777273.8750, 780191.1875, 781034.3125, 793199.8750,
        795156.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2936e+00, 1.3251e+00, 1.3534e+00, 1.4139e+00, 1.4300e+00,
        1.5338e+00, 1.5362e+00, 1.6143e+00, 3.8141e+05, 3.8404e+05, 3.9141e+05,
        3.9171e+05, 3.9699e+05, 3.9717e+05, 3.9820e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2473e+00, 1.2646e+00, 1.2671e+00, 1.2867e+00, 1.3534e+00,
        1.3768e+00, 1.3981e+00, 1.5315e+00, 3.8147e+05, 3.8400e+05, 3.9139e+05,
        3.9173e+05, 3.9700e+05, 3.9715e+05, 3.9822e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397142.7500, 397146.8125, 397147.4062, 397158.4375,
        397162.1250, 397162.6562, 397166.0312, 397168.4688, 397169.7188,
        775700.8750, 785369.4375, 785952.8125, 792189.6250, 795156.2500,
        796432.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1677e+00, 1.2407e+00, 1.2807e+00, 1.4115e+00, 1.4219e+00,
        1.5315e+00, 1.5644e+00, 1.6143e+00, 3.8148e+05, 3.8402e+05, 3.9141e+05,
        3.9174e+05, 3.9704e+05, 3.9716e+05, 3.9822e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391390.6562, 391408.8125, 391409.8750, 391410.3438,
        391410.9375, 391435.1875, 391437.5625, 391439.0312, 391447.8438,
        768305.7500, 769244.0000, 778887.0000, 780191.1875, 792189.6250,
        814353.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1677e+00, 1.1719e+00, 1.1881e+00, 1.2787e+00, 1.3513e+00,
        1.3768e+00, 1.5022e+00, 1.5338e+00, 3.8146e+05, 3.8403e+05, 3.9145e+05,
        3.9173e+05, 3.9699e+05, 3.9714e+05, 3.9820e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76548.75', '76547.09', '433366.75', '76548.27', '421525.69', '76552.58', '419217.06', '76550.25', '436494.34', '429284.50', '76545.85', '76547.92', '435012.56', '76551.14', '429109.59', '76549.68']
estimated f for each client, fs: [7, 7, 5, 7, 5, 7, 5, 7, 5, 5, 7, 7, 5, 7, 5, 7]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 11, 17, 7, 18, 8, 16, 5, 20, 13, 4, 2, 15, 12, 14, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:54...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:54, End: 2025-07-22 16:00:54)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [19, 2, 14, 18, 7, 3, 8, 4, 5, 10, 15, 6, 17, 13, 1, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9859e+05, 8.2213e+05, 7.8479e+05, 3.9862e+05, 3.9862e+05,
         3.9863e+05, 3.9859e+05, 3.9864e+05, 3.9861e+05, 7.7801e+05, 3.9860e+05,
         7.9662e+05, 8.0081e+05, 3.9865e+05, 3.9863e+05],
        [3.9859e+05, 0.0000e+00, 4.0162e+05, 3.8960e+05, 1.3537e+00, 1.4237e+00,
         1.3829e+00, 1.5298e+00, 1.3968e+00, 1.3373e+00, 3.9436e+05, 1.3710e+00,
         4.0816e+05, 3.9388e+05, 1.3327e+00, 1.4403e+00],
        [8.2213e+05, 4.0162e+05, 0.0000e+00, 7.9026e+05, 4.0164e+05, 4.0158e+05,
         4.0160e+05, 4.0161e+05, 4.0162e+05, 4.0165e+05, 7.8607e+05, 4.0160e+05,
         8.1147e+05, 7.9019e+05, 4.0160e+05, 4.0160e+05],
        [7.8479e+05, 3.8960e+05, 7.9026e+05, 0.0000e+00, 3.8961e+05, 3.8958e+05,
         3.8962e+05, 3.8961e+05, 3.8960e+05, 3.8961e+05, 8.0225e+05, 3.8960e+05,
         8.0950e+05, 7.6336e+05, 3.8955e+05, 3.8962e+05],
        [3.9862e+05, 1.3537e+00, 4.0164e+05, 3.8961e+05, 0.0000e+00, 1.2595e+00,
         1.3949e+00, 1.3754e+00, 1.3614e+00, 1.1645e+00, 3.9441e+05, 1.6500e+00,
         4.0816e+05, 3.9387e+05, 1.5657e+00, 1.2377e+00],
        [3.9862e+05, 1.4237e+00, 4.0158e+05, 3.8958e+05, 1.2595e+00, 0.0000e+00,
         1.3289e+00, 1.3862e+00, 1.3577e+00, 1.2176e+00, 3.9437e+05, 1.7029e+00,
         4.0817e+05, 3.9388e+05, 1.5555e+00, 1.1201e+00],
        [3.9863e+05, 1.3829e+00, 4.0160e+05, 3.8962e+05, 1.3949e+00, 1.3289e+00,
         0.0000e+00, 1.5092e+00, 1.4018e+00, 1.4168e+00, 3.9439e+05, 1.3972e+00,
         4.0818e+05, 3.9385e+05, 1.4032e+00, 1.3469e+00],
        [3.9859e+05, 1.5298e+00, 4.0161e+05, 3.8961e+05, 1.3754e+00, 1.3862e+00,
         1.5092e+00, 0.0000e+00, 1.4801e+00, 1.3805e+00, 3.9438e+05, 1.6898e+00,
         4.0814e+05, 3.9389e+05, 1.6679e+00, 1.3040e+00],
        [3.9864e+05, 1.3968e+00, 4.0162e+05, 3.8960e+05, 1.3614e+00, 1.3577e+00,
         1.4018e+00, 1.4801e+00, 0.0000e+00, 1.3409e+00, 3.9439e+05, 1.4972e+00,
         4.0816e+05, 3.9387e+05, 1.3932e+00, 1.2982e+00],
        [3.9861e+05, 1.3373e+00, 4.0165e+05, 3.8961e+05, 1.1645e+00, 1.2176e+00,
         1.4168e+00, 1.3805e+00, 1.3409e+00, 0.0000e+00, 3.9440e+05, 1.6800e+00,
         4.0821e+05, 3.9387e+05, 1.5969e+00, 1.1807e+00],
        [7.7801e+05, 3.9436e+05, 7.8607e+05, 8.0225e+05, 3.9441e+05, 3.9437e+05,
         3.9439e+05, 3.9438e+05, 3.9439e+05, 3.9440e+05, 0.0000e+00, 3.9439e+05,
         7.8079e+05, 8.0836e+05, 3.9438e+05, 3.9439e+05],
        [3.9860e+05, 1.3710e+00, 4.0160e+05, 3.8960e+05, 1.6500e+00, 1.7029e+00,
         1.3972e+00, 1.6898e+00, 1.4972e+00, 1.6800e+00, 3.9439e+05, 0.0000e+00,
         4.0818e+05, 3.9387e+05, 1.2787e+00, 1.6495e+00],
        [7.9662e+05, 4.0816e+05, 8.1147e+05, 8.0950e+05, 4.0816e+05, 4.0817e+05,
         4.0818e+05, 4.0814e+05, 4.0816e+05, 4.0821e+05, 7.8079e+05, 4.0818e+05,
         0.0000e+00, 8.1982e+05, 4.0818e+05, 4.0820e+05],
        [8.0081e+05, 3.9388e+05, 7.9019e+05, 7.6336e+05, 3.9387e+05, 3.9388e+05,
         3.9385e+05, 3.9389e+05, 3.9387e+05, 3.9387e+05, 8.0836e+05, 3.9387e+05,
         8.1982e+05, 0.0000e+00, 3.9387e+05, 3.9385e+05],
        [3.9865e+05, 1.3327e+00, 4.0160e+05, 3.8955e+05, 1.5657e+00, 1.5555e+00,
         1.4032e+00, 1.6679e+00, 1.3932e+00, 1.5969e+00, 3.9438e+05, 1.2787e+00,
         4.0818e+05, 3.9387e+05, 0.0000e+00, 1.6095e+00],
        [3.9863e+05, 1.4403e+00, 4.0160e+05, 3.8962e+05, 1.2377e+00, 1.1201e+00,
         1.3469e+00, 1.3040e+00, 1.2982e+00, 1.1807e+00, 3.9439e+05, 1.6495e+00,
         4.0820e+05, 3.9385e+05, 1.6095e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 398585.6250, 398594.5000, 398604.7188, 398605.4688,
        398616.3438, 398619.7188, 398626.7500, 398631.4688, 398643.1875,
        398654.0312, 778013.9375, 784787.1875, 796620.7500, 800810.8125,
        822128.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3327e+00, 1.3373e+00, 1.3537e+00, 1.3710e+00, 1.3829e+00,
        1.3968e+00, 1.4237e+00, 1.4403e+00, 1.5298e+00, 3.8960e+05, 3.9388e+05,
        3.9436e+05, 3.9859e+05, 4.0162e+05, 4.0816e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401578.5000, 401599.5625, 401601.1875, 401602.5625,
        401603.5938, 401606.0312, 401615.7500, 401619.0000, 401640.1250,
        401647.8750, 786074.2500, 790191.7500, 790263.6875, 811473.5000,
        822128.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389554.3750, 389580.2812, 389598.8125, 389603.6875,
        389604.5625, 389606.8125, 389609.0938, 389614.3750, 389621.2188,
        389622.9062, 763360.8125, 784787.1875, 790263.6875, 802246.5625,
        809497.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1645e+00, 1.2377e+00, 1.2595e+00, 1.3537e+00, 1.3614e+00,
        1.3754e+00, 1.3949e+00, 1.5657e+00, 1.6500e+00, 3.8961e+05, 3.9387e+05,
        3.9441e+05, 3.9862e+05, 4.0164e+05, 4.0816e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1201e+00, 1.2176e+00, 1.2595e+00, 1.3289e+00, 1.3577e+00,
        1.3862e+00, 1.4237e+00, 1.5555e+00, 1.7029e+00, 3.8958e+05, 3.9388e+05,
        3.9437e+05, 3.9862e+05, 4.0158e+05, 4.0817e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3289e+00, 1.3469e+00, 1.3829e+00, 1.3949e+00, 1.3972e+00,
        1.4018e+00, 1.4032e+00, 1.4168e+00, 1.5092e+00, 3.8962e+05, 3.9385e+05,
        3.9439e+05, 3.9863e+05, 4.0160e+05, 4.0818e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3040e+00, 1.3754e+00, 1.3805e+00, 1.3862e+00, 1.4801e+00,
        1.5092e+00, 1.5298e+00, 1.6679e+00, 1.6898e+00, 3.8961e+05, 3.9389e+05,
        3.9438e+05, 3.9859e+05, 4.0161e+05, 4.0814e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2982e+00, 1.3409e+00, 1.3577e+00, 1.3614e+00, 1.3932e+00,
        1.3968e+00, 1.4018e+00, 1.4801e+00, 1.4972e+00, 3.8960e+05, 3.9387e+05,
        3.9439e+05, 3.9864e+05, 4.0162e+05, 4.0816e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1645e+00, 1.1807e+00, 1.2176e+00, 1.3373e+00, 1.3409e+00,
        1.3805e+00, 1.4168e+00, 1.5969e+00, 1.6800e+00, 3.8961e+05, 3.9387e+05,
        3.9440e+05, 3.9861e+05, 4.0165e+05, 4.0821e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394355.9375, 394369.2500, 394379.7188, 394382.6250,
        394385.6562, 394391.4688, 394393.3125, 394393.5938, 394399.5938,
        394410.0938, 778013.9375, 780789.1250, 786074.2500, 802246.5625,
        808358.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2787e+00, 1.3710e+00, 1.3972e+00, 1.4972e+00, 1.6495e+00,
        1.6500e+00, 1.6800e+00, 1.6898e+00, 1.7029e+00, 3.8960e+05, 3.9387e+05,
        3.9439e+05, 3.9860e+05, 4.0160e+05, 4.0818e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 408140.5000, 408158.6562, 408159.4375, 408160.5000,
        408165.5312, 408175.0625, 408183.0000, 408183.5625, 408199.1562,
        408205.2500, 780789.1250, 796620.7500, 809497.3125, 811473.5000,
        819815.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393851.6562, 393854.5312, 393868.0625, 393869.7500,
        393871.5000, 393873.0625, 393873.8438, 393878.3750, 393879.7188,
        393885.8125, 763360.8125, 790191.7500, 800810.8125, 808358.2500,
        819815.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2787e+00, 1.3327e+00, 1.3932e+00, 1.4032e+00, 1.5555e+00,
        1.5657e+00, 1.5969e+00, 1.6095e+00, 1.6679e+00, 3.8955e+05, 3.9387e+05,
        3.9438e+05, 3.9865e+05, 4.0160e+05, 4.0818e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1201e+00, 1.1807e+00, 1.2377e+00, 1.2982e+00, 1.3040e+00,
        1.3469e+00, 1.4403e+00, 1.6095e+00, 1.6495e+00, 3.8962e+05, 3.9385e+05,
        3.9439e+05, 3.9863e+05, 4.0160e+05, 4.0820e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['398618.19', '38961.71', '401611.41', '389601.59', '38961.92', '38959.26', '38963.55', '38962.77', '38961.62', '38962.14', '394386.12', '38961.27', '408173.06', '393870.59', '38956.78', '38963.35']
estimated f for each client, fs: [4, 6, 4, 4, 6, 6, 6, 6, 6, 6, 4, 6, 4, 4, 6, 6]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [19, 2, 14, 18, 7, 3, 8, 4, 5, 10, 15, 6, 17, 13, 1, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0278s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:55...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[187  50]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:55, End: 2025-07-22 16:00:55)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 14, 3, 16, 2, 20, 1, 18, 4, 12, 7, 9, 13, 6, 15, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0238e+05, 1.3549e+00, 3.9097e+05, 1.4933e+00, 3.9678e+05,
         1.5677e+00, 3.8673e+05, 1.4801e+00, 1.2086e+00, 1.3135e+00, 1.4402e+00,
         3.9179e+05, 1.8541e+00, 4.0002e+05, 1.5057e+00],
        [4.0238e+05, 0.0000e+00, 4.0243e+05, 7.8867e+05, 4.0238e+05, 7.8874e+05,
         4.0240e+05, 7.6961e+05, 4.0240e+05, 4.0239e+05, 4.0237e+05, 4.0236e+05,
         8.0778e+05, 4.0240e+05, 7.9831e+05, 4.0241e+05],
        [1.3549e+00, 4.0243e+05, 0.0000e+00, 3.9098e+05, 1.5265e+00, 3.9678e+05,
         1.4946e+00, 3.8671e+05, 1.3994e+00, 1.1399e+00, 1.3477e+00, 1.4231e+00,
         3.9179e+05, 1.8364e+00, 4.0006e+05, 1.4578e+00],
        [3.9097e+05, 7.8867e+05, 3.9098e+05, 0.0000e+00, 3.9095e+05, 7.9330e+05,
         3.9097e+05, 7.9408e+05, 3.9096e+05, 3.9096e+05, 3.9099e+05, 3.9094e+05,
         7.8828e+05, 3.9095e+05, 7.8440e+05, 3.9095e+05],
        [1.4933e+00, 4.0238e+05, 1.5265e+00, 3.9095e+05, 0.0000e+00, 3.9681e+05,
         1.5571e+00, 3.8670e+05, 1.4689e+00, 1.3944e+00, 1.4557e+00, 1.4003e+00,
         3.9180e+05, 1.5263e+00, 4.0005e+05, 1.5103e+00],
        [3.9678e+05, 7.8874e+05, 3.9678e+05, 7.9330e+05, 3.9681e+05, 0.0000e+00,
         3.9680e+05, 7.8233e+05, 3.9678e+05, 3.9680e+05, 3.9678e+05, 3.9679e+05,
         7.8999e+05, 3.9681e+05, 8.1529e+05, 3.9679e+05],
        [1.5677e+00, 4.0240e+05, 1.4946e+00, 3.9097e+05, 1.5571e+00, 3.9680e+05,
         0.0000e+00, 3.8672e+05, 1.5018e+00, 1.4350e+00, 1.4769e+00, 1.3633e+00,
         3.9179e+05, 1.6168e+00, 4.0003e+05, 1.5519e+00],
        [3.8673e+05, 7.6961e+05, 3.8671e+05, 7.9408e+05, 3.8670e+05, 7.8233e+05,
         3.8672e+05, 0.0000e+00, 3.8674e+05, 3.8675e+05, 3.8672e+05, 3.8674e+05,
         7.8195e+05, 3.8673e+05, 7.8537e+05, 3.8669e+05],
        [1.4801e+00, 4.0240e+05, 1.3994e+00, 3.9096e+05, 1.4689e+00, 3.9678e+05,
         1.5018e+00, 3.8674e+05, 0.0000e+00, 1.2253e+00, 1.3851e+00, 1.4490e+00,
         3.9178e+05, 1.6414e+00, 4.0002e+05, 1.4738e+00],
        [1.2086e+00, 4.0239e+05, 1.1399e+00, 3.9096e+05, 1.3944e+00, 3.9680e+05,
         1.4350e+00, 3.8675e+05, 1.2253e+00, 0.0000e+00, 1.2599e+00, 1.2785e+00,
         3.9178e+05, 1.5909e+00, 4.0003e+05, 1.3404e+00],
        [1.3135e+00, 4.0237e+05, 1.3477e+00, 3.9099e+05, 1.4557e+00, 3.9678e+05,
         1.4769e+00, 3.8672e+05, 1.3851e+00, 1.2599e+00, 0.0000e+00, 1.3896e+00,
         3.9179e+05, 1.7283e+00, 4.0004e+05, 1.5075e+00],
        [1.4402e+00, 4.0236e+05, 1.4231e+00, 3.9094e+05, 1.4003e+00, 3.9679e+05,
         1.3633e+00, 3.8674e+05, 1.4490e+00, 1.2785e+00, 1.3896e+00, 0.0000e+00,
         3.9182e+05, 1.6049e+00, 4.0003e+05, 1.4075e+00],
        [3.9179e+05, 8.0778e+05, 3.9179e+05, 7.8828e+05, 3.9180e+05, 7.8999e+05,
         3.9179e+05, 7.8195e+05, 3.9178e+05, 3.9178e+05, 3.9179e+05, 3.9182e+05,
         0.0000e+00, 3.9177e+05, 7.9570e+05, 3.9181e+05],
        [1.8541e+00, 4.0240e+05, 1.8364e+00, 3.9095e+05, 1.5263e+00, 3.9681e+05,
         1.6168e+00, 3.8673e+05, 1.6414e+00, 1.5909e+00, 1.7283e+00, 1.6049e+00,
         3.9177e+05, 0.0000e+00, 4.0003e+05, 1.4839e+00],
        [4.0002e+05, 7.9831e+05, 4.0006e+05, 7.8440e+05, 4.0005e+05, 8.1529e+05,
         4.0003e+05, 7.8537e+05, 4.0002e+05, 4.0003e+05, 4.0004e+05, 4.0003e+05,
         7.9570e+05, 4.0003e+05, 0.0000e+00, 4.0003e+05],
        [1.5057e+00, 4.0241e+05, 1.4578e+00, 3.9095e+05, 1.5103e+00, 3.9679e+05,
         1.5519e+00, 3.8669e+05, 1.4738e+00, 1.3404e+00, 1.5075e+00, 1.4075e+00,
         3.9181e+05, 1.4839e+00, 4.0003e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2086e+00, 1.3135e+00, 1.3549e+00, 1.4402e+00, 1.4801e+00,
        1.4933e+00, 1.5057e+00, 1.5677e+00, 1.8541e+00, 3.8673e+05, 3.9097e+05,
        3.9179e+05, 3.9678e+05, 4.0002e+05, 4.0238e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402361.3438, 402370.8125, 402375.7500, 402380.5938,
        402387.9375, 402399.0312, 402400.0000, 402401.6875, 402412.3750,
        402429.1250, 769606.9375, 788665.6875, 788737.2500, 798306.0625,
        807775.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1399e+00, 1.3477e+00, 1.3549e+00, 1.3994e+00, 1.4231e+00,
        1.4578e+00, 1.4946e+00, 1.5265e+00, 1.8364e+00, 3.8671e+05, 3.9098e+05,
        3.9179e+05, 3.9678e+05, 4.0006e+05, 4.0243e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390944.6250, 390946.3750, 390949.2188, 390954.5625,
        390957.4688, 390963.7812, 390969.9062, 390973.2812, 390977.8438,
        390994.0938, 784404.0625, 788275.8750, 788665.6875, 793304.2500,
        794084.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3944e+00, 1.4003e+00, 1.4557e+00, 1.4689e+00, 1.4933e+00,
        1.5103e+00, 1.5263e+00, 1.5265e+00, 1.5571e+00, 3.8670e+05, 3.9095e+05,
        3.9180e+05, 3.9681e+05, 4.0005e+05, 4.0238e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396776.2500, 396782.6562, 396784.3125, 396784.3750,
        396786.2812, 396786.5000, 396798.0000, 396798.7500, 396809.3438,
        396813.4062, 782326.5625, 788737.2500, 789988.8125, 793304.2500,
        815291.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3633e+00, 1.4350e+00, 1.4769e+00, 1.4946e+00, 1.5018e+00,
        1.5519e+00, 1.5571e+00, 1.5677e+00, 1.6168e+00, 3.8672e+05, 3.9097e+05,
        3.9179e+05, 3.9680e+05, 4.0003e+05, 4.0240e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386689.4375, 386698.0000, 386714.2500, 386719.6250,
        386724.7500, 386732.4375, 386732.4375, 386736.5312, 386744.0625,
        386749.1562, 769606.9375, 781945.8125, 782326.5625, 785369.4375,
        794084.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2253e+00, 1.3851e+00, 1.3994e+00, 1.4490e+00, 1.4689e+00,
        1.4738e+00, 1.4801e+00, 1.5018e+00, 1.6414e+00, 3.8674e+05, 3.9096e+05,
        3.9178e+05, 3.9678e+05, 4.0002e+05, 4.0240e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1399e+00, 1.2086e+00, 1.2253e+00, 1.2599e+00, 1.2785e+00,
        1.3404e+00, 1.3944e+00, 1.4350e+00, 1.5909e+00, 3.8675e+05, 3.9096e+05,
        3.9178e+05, 3.9680e+05, 4.0003e+05, 4.0239e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2599e+00, 1.3135e+00, 1.3477e+00, 1.3851e+00, 1.3896e+00,
        1.4557e+00, 1.4769e+00, 1.5075e+00, 1.7283e+00, 3.8672e+05, 3.9099e+05,
        3.9179e+05, 3.9678e+05, 4.0004e+05, 4.0237e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2785e+00, 1.3633e+00, 1.3896e+00, 1.4003e+00, 1.4075e+00,
        1.4231e+00, 1.4402e+00, 1.4490e+00, 1.6049e+00, 3.8674e+05, 3.9094e+05,
        3.9182e+05, 3.9679e+05, 4.0003e+05, 4.0236e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391770.7188, 391784.2188, 391784.4062, 391785.9062,
        391786.1250, 391787.5000, 391794.8125, 391799.1562, 391811.0000,
        391823.0938, 781945.8125, 788275.8750, 789988.8125, 795702.5000,
        807775.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4839e+00, 1.5263e+00, 1.5909e+00, 1.6049e+00, 1.6168e+00,
        1.6414e+00, 1.7283e+00, 1.8364e+00, 1.8541e+00, 3.8673e+05, 3.9095e+05,
        3.9177e+05, 3.9681e+05, 4.0003e+05, 4.0240e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400016.9375, 400022.9062, 400026.3750, 400026.8750,
        400029.4375, 400030.8750, 400032.0312, 400037.7188, 400047.0000,
        400062.8750, 784404.0625, 785369.4375, 795702.5000, 798306.0625,
        815291.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3404e+00, 1.4075e+00, 1.4578e+00, 1.4738e+00, 1.4839e+00,
        1.5057e+00, 1.5075e+00, 1.5103e+00, 1.5519e+00, 3.8669e+05, 3.9095e+05,
        3.9181e+05, 3.9679e+05, 4.0003e+05, 4.0241e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38674.56', '402391.88', '38672.73', '390963.12', '38671.14', '396792.00', '38673.32', '386724.06', '38674.95', '38676.10', '38673.76', '38675.68', '391792.69', '38674.73', '400033.31', '38670.27']
estimated f for each client, fs: [6, 4, 6, 5, 6, 4, 6, 4, 6, 6, 6, 6, 4, 6, 4, 6]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [10, 14, 3, 16, 2, 20, 1, 18, 4, 12, 7, 9, 13, 6, 15, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0274s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:56...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 16:00:56, End: 2025-07-22 16:00:56)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 11, 4, 1, 7, 16, 3, 8, 18, 2, 19, 20, 5, 10, 6, 14], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3077e+00, 1.2794e+00, 1.1655e+00, 1.2768e+00, 3.9255e+05,
         1.2191e+00, 1.4665e+00, 3.9955e+05, 1.2472e+00, 3.7904e+05, 3.7826e+05,
         1.3345e+00, 1.2602e+00, 1.3957e+00, 3.9885e+05],
        [1.3077e+00, 0.0000e+00, 1.3281e+00, 1.3641e+00, 1.4040e+00, 3.9255e+05,
         1.4993e+00, 1.6701e+00, 3.9956e+05, 1.2959e+00, 3.7905e+05, 3.7825e+05,
         1.3275e+00, 1.3717e+00, 1.4433e+00, 3.9887e+05],
        [1.2794e+00, 1.3281e+00, 0.0000e+00, 1.3129e+00, 1.3180e+00, 3.9252e+05,
         1.2911e+00, 1.4516e+00, 3.9958e+05, 1.3571e+00, 3.7909e+05, 3.7825e+05,
         1.3378e+00, 1.3294e+00, 1.4416e+00, 3.9888e+05],
        [1.1655e+00, 1.3641e+00, 1.3129e+00, 0.0000e+00, 1.3176e+00, 3.9253e+05,
         1.3066e+00, 1.5171e+00, 3.9952e+05, 1.2976e+00, 3.7910e+05, 3.7825e+05,
         1.3180e+00, 1.3357e+00, 1.3937e+00, 3.9884e+05],
        [1.2768e+00, 1.4040e+00, 1.3180e+00, 1.3176e+00, 0.0000e+00, 3.9254e+05,
         1.2469e+00, 1.4451e+00, 3.9956e+05, 1.2973e+00, 3.7906e+05, 3.7825e+05,
         1.3259e+00, 1.2060e+00, 1.5669e+00, 3.9885e+05],
        [3.9255e+05, 3.9255e+05, 3.9252e+05, 3.9253e+05, 3.9254e+05, 0.0000e+00,
         3.9255e+05, 3.9256e+05, 8.1507e+05, 3.9255e+05, 7.7701e+05, 7.5075e+05,
         3.9256e+05, 3.9255e+05, 3.9252e+05, 7.9480e+05],
        [1.2191e+00, 1.4993e+00, 1.2911e+00, 1.3066e+00, 1.2469e+00, 3.9255e+05,
         0.0000e+00, 1.3741e+00, 3.9955e+05, 1.3535e+00, 3.7906e+05, 3.7824e+05,
         1.3191e+00, 1.2313e+00, 1.6411e+00, 3.9886e+05],
        [1.4665e+00, 1.6701e+00, 1.4516e+00, 1.5171e+00, 1.4451e+00, 3.9256e+05,
         1.3741e+00, 0.0000e+00, 3.9957e+05, 1.6142e+00, 3.7908e+05, 3.7827e+05,
         1.6446e+00, 1.4449e+00, 1.7263e+00, 3.9887e+05],
        [3.9955e+05, 3.9956e+05, 3.9958e+05, 3.9952e+05, 3.9956e+05, 8.1507e+05,
         3.9955e+05, 3.9957e+05, 0.0000e+00, 3.9956e+05, 7.7796e+05, 7.8959e+05,
         3.9954e+05, 3.9955e+05, 3.9953e+05, 7.7997e+05],
        [1.2472e+00, 1.2959e+00, 1.3571e+00, 1.2976e+00, 1.2973e+00, 3.9255e+05,
         1.3535e+00, 1.6142e+00, 3.9956e+05, 0.0000e+00, 3.7905e+05, 3.7828e+05,
         1.3582e+00, 1.3006e+00, 1.3628e+00, 3.9887e+05],
        [3.7904e+05, 3.7905e+05, 3.7909e+05, 3.7910e+05, 3.7906e+05, 7.7701e+05,
         3.7906e+05, 3.7908e+05, 7.7796e+05, 3.7905e+05, 0.0000e+00, 7.5025e+05,
         3.7903e+05, 3.7907e+05, 3.7904e+05, 7.9279e+05],
        [3.7826e+05, 3.7825e+05, 3.7825e+05, 3.7825e+05, 3.7825e+05, 7.5075e+05,
         3.7824e+05, 3.7827e+05, 7.8959e+05, 3.7828e+05, 7.5025e+05, 0.0000e+00,
         3.7826e+05, 3.7826e+05, 3.7828e+05, 7.7602e+05],
        [1.3345e+00, 1.3275e+00, 1.3378e+00, 1.3180e+00, 1.3259e+00, 3.9256e+05,
         1.3191e+00, 1.6446e+00, 3.9954e+05, 1.3582e+00, 3.7903e+05, 3.7826e+05,
         0.0000e+00, 1.3432e+00, 1.4995e+00, 3.9888e+05],
        [1.2602e+00, 1.3717e+00, 1.3294e+00, 1.3357e+00, 1.2060e+00, 3.9255e+05,
         1.2313e+00, 1.4449e+00, 3.9955e+05, 1.3006e+00, 3.7907e+05, 3.7826e+05,
         1.3432e+00, 0.0000e+00, 1.6314e+00, 3.9885e+05],
        [1.3957e+00, 1.4433e+00, 1.4416e+00, 1.3937e+00, 1.5669e+00, 3.9252e+05,
         1.6411e+00, 1.7263e+00, 3.9953e+05, 1.3628e+00, 3.7904e+05, 3.7828e+05,
         1.4995e+00, 1.6314e+00, 0.0000e+00, 3.9885e+05],
        [3.9885e+05, 3.9887e+05, 3.9888e+05, 3.9884e+05, 3.9885e+05, 7.9480e+05,
         3.9886e+05, 3.9887e+05, 7.7997e+05, 3.9887e+05, 7.9279e+05, 7.7602e+05,
         3.9888e+05, 3.9885e+05, 3.9885e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1655e+00, 1.2191e+00, 1.2472e+00, 1.2602e+00, 1.2768e+00,
        1.2794e+00, 1.3077e+00, 1.3345e+00, 1.3957e+00, 1.4665e+00, 3.7826e+05,
        3.7904e+05, 3.9255e+05, 3.9885e+05, 3.9955e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2959e+00, 1.3077e+00, 1.3275e+00, 1.3281e+00, 1.3641e+00,
        1.3717e+00, 1.4040e+00, 1.4433e+00, 1.4993e+00, 1.6701e+00, 3.7825e+05,
        3.7905e+05, 3.9255e+05, 3.9887e+05, 3.9956e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2794e+00, 1.2911e+00, 1.3129e+00, 1.3180e+00, 1.3281e+00,
        1.3294e+00, 1.3378e+00, 1.3571e+00, 1.4416e+00, 1.4516e+00, 3.7825e+05,
        3.7909e+05, 3.9252e+05, 3.9888e+05, 3.9958e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1655e+00, 1.2976e+00, 1.3066e+00, 1.3129e+00, 1.3176e+00,
        1.3180e+00, 1.3357e+00, 1.3641e+00, 1.3937e+00, 1.5171e+00, 3.7825e+05,
        3.7910e+05, 3.9253e+05, 3.9884e+05, 3.9952e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2060e+00, 1.2469e+00, 1.2768e+00, 1.2973e+00, 1.3176e+00,
        1.3180e+00, 1.3259e+00, 1.4040e+00, 1.4451e+00, 1.5669e+00, 3.7825e+05,
        3.7906e+05, 3.9254e+05, 3.9885e+05, 3.9956e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392517.6250, 392525.0000, 392530.7812, 392539.6562,
        392545.1250, 392545.3438, 392547.0938, 392547.3438, 392548.4375,
        392556.1562, 392563.4688, 750753.1250, 777013.9375, 794795.5625,
        815074.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2191e+00, 1.2313e+00, 1.2469e+00, 1.2911e+00, 1.3066e+00,
        1.3191e+00, 1.3535e+00, 1.3741e+00, 1.4993e+00, 1.6411e+00, 3.7824e+05,
        3.7906e+05, 3.9255e+05, 3.9886e+05, 3.9955e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3741e+00, 1.4449e+00, 1.4451e+00, 1.4516e+00, 1.4665e+00,
        1.5171e+00, 1.6142e+00, 1.6446e+00, 1.6701e+00, 1.7263e+00, 3.7827e+05,
        3.7908e+05, 3.9256e+05, 3.9887e+05, 3.9957e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399521.6562, 399527.1875, 399539.4688, 399551.7812,
        399552.4375, 399553.7500, 399555.4688, 399555.7812, 399556.4688,
        399570.3750, 399576.5312, 777964.8750, 779971.7500, 789590.1875,
        815074.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.2472e+00, 1.2959e+00, 1.2973e+00, 1.2976e+00, 1.3006e+00,
        1.3535e+00, 1.3571e+00, 1.3582e+00, 1.3628e+00, 1.6142e+00, 3.7828e+05,
        3.7905e+05, 3.9255e+05, 3.9887e+05, 3.9956e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379029.0625, 379043.5000, 379044.9375, 379045.7188,
        379052.4375, 379060.8125, 379061.0625, 379074.9062, 379083.5625,
        379094.2500, 379096.5625, 750245.7500, 777013.9375, 777964.8750,
        792785.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 378238.0938, 378246.8438, 378249.1875, 378252.4688,
        378253.8750, 378255.0000, 378256.2188, 378259.0312, 378267.5000,
        378276.0000, 378281.6562, 750245.7500, 750753.1250, 776016.2500,
        789590.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3180e+00, 1.3191e+00, 1.3259e+00, 1.3275e+00, 1.3345e+00,
        1.3378e+00, 1.3432e+00, 1.3582e+00, 1.4995e+00, 1.6446e+00, 3.7826e+05,
        3.7903e+05, 3.9256e+05, 3.9888e+05, 3.9954e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2060e+00, 1.2313e+00, 1.2602e+00, 1.3006e+00, 1.3294e+00,
        1.3357e+00, 1.3432e+00, 1.3717e+00, 1.4449e+00, 1.6314e+00, 3.7826e+05,
        3.7907e+05, 3.9255e+05, 3.9885e+05, 3.9955e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3628e+00, 1.3937e+00, 1.3957e+00, 1.4416e+00, 1.4433e+00,
        1.4995e+00, 1.5669e+00, 1.6314e+00, 1.6411e+00, 1.7263e+00, 3.7828e+05,
        3.7904e+05, 3.9252e+05, 3.9885e+05, 3.9953e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398836.9375, 398845.6562, 398848.0938, 398854.2500,
        398854.8125, 398864.9688, 398870.0000, 398872.0938, 398874.4375,
        398879.6875, 398882.0625, 776016.2500, 779971.7500, 792785.8750,
        794795.5625])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['1.30', '1.40', '1.34', '1.33', '1.34', '392542.38', '1.35', '1.54', '399551.00', '1.35', '379062.47', '378257.78', '1.38', '1.35', '1.51', '398862.09']
estimated f for each client, fs: [5, 5, 5, 5, 5, 3, 5, 5, 3, 5, 3, 3, 5, 5, 5, 3]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 11, 4, 1, 7, 16, 3, 8, 18, 2, 19, 20, 5, 10, 6, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0132s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:56...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:56, End: 2025-07-22 16:00:56)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 11, 19, 10, 2, 7, 15, 6, 16, 17, 13, 18, 1, 8, 14, 4], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6950e+00, 3.6504e+05, 1.3981e+00, 1.6123e+00, 1.3919e+00,
         4.0145e+05, 1.9050e+00, 3.9697e+05, 3.8357e+05, 3.9864e+05, 3.8435e+05,
         1.4078e+00, 1.3189e+00, 3.7764e+05, 1.4925e+00],
        [1.6950e+00, 0.0000e+00, 3.6501e+05, 1.3583e+00, 1.3065e+00, 1.3907e+00,
         4.0147e+05, 1.3767e+00, 3.9699e+05, 3.8358e+05, 3.9866e+05, 3.8437e+05,
         1.3001e+00, 1.3832e+00, 3.7763e+05, 1.2822e+00],
        [3.6504e+05, 3.6501e+05, 0.0000e+00, 3.6502e+05, 3.6502e+05, 3.6503e+05,
         7.6666e+05, 3.6500e+05, 7.6058e+05, 7.5612e+05, 7.6923e+05, 7.3321e+05,
         3.6500e+05, 3.6502e+05, 7.4317e+05, 3.6500e+05],
        [1.3981e+00, 1.3583e+00, 3.6502e+05, 0.0000e+00, 1.3358e+00, 1.2170e+00,
         4.0144e+05, 1.6071e+00, 3.9694e+05, 3.8356e+05, 3.9867e+05, 3.8438e+05,
         1.3387e+00, 1.2675e+00, 3.7761e+05, 1.3161e+00],
        [1.6123e+00, 1.3065e+00, 3.6502e+05, 1.3358e+00, 0.0000e+00, 1.3413e+00,
         4.0147e+05, 1.3710e+00, 3.9698e+05, 3.8357e+05, 3.9866e+05, 3.8437e+05,
         1.3378e+00, 1.4202e+00, 3.7763e+05, 1.3676e+00],
        [1.3919e+00, 1.3907e+00, 3.6503e+05, 1.2170e+00, 1.3413e+00, 0.0000e+00,
         4.0147e+05, 1.6015e+00, 3.9697e+05, 3.8358e+05, 3.9870e+05, 3.8438e+05,
         1.3248e+00, 1.2379e+00, 3.7762e+05, 1.2855e+00],
        [4.0145e+05, 4.0147e+05, 7.6666e+05, 4.0144e+05, 4.0147e+05, 4.0147e+05,
         0.0000e+00, 4.0148e+05, 8.0822e+05, 7.9717e+05, 7.5793e+05, 7.9058e+05,
         4.0147e+05, 4.0145e+05, 7.7811e+05, 4.0148e+05],
        [1.9050e+00, 1.3767e+00, 3.6500e+05, 1.6071e+00, 1.3710e+00, 1.6015e+00,
         4.0148e+05, 0.0000e+00, 3.9696e+05, 3.8357e+05, 3.9867e+05, 3.8437e+05,
         1.3844e+00, 1.4586e+00, 3.7764e+05, 1.3845e+00],
        [3.9697e+05, 3.9699e+05, 7.6058e+05, 3.9694e+05, 3.9698e+05, 3.9697e+05,
         8.0822e+05, 3.9696e+05, 0.0000e+00, 7.9158e+05, 8.0378e+05, 7.7317e+05,
         3.9696e+05, 3.9699e+05, 7.6590e+05, 3.9698e+05],
        [3.8357e+05, 3.8358e+05, 7.5612e+05, 3.8356e+05, 3.8357e+05, 3.8358e+05,
         7.9717e+05, 3.8357e+05, 7.9158e+05, 0.0000e+00, 7.8201e+05, 7.8457e+05,
         3.8357e+05, 3.8356e+05, 7.7065e+05, 3.8358e+05],
        [3.9864e+05, 3.9866e+05, 7.6923e+05, 3.9867e+05, 3.9866e+05, 3.9870e+05,
         7.5793e+05, 3.9867e+05, 8.0378e+05, 7.8201e+05, 0.0000e+00, 7.5912e+05,
         3.9864e+05, 3.9869e+05, 7.6400e+05, 3.9868e+05],
        [3.8435e+05, 3.8437e+05, 7.3321e+05, 3.8438e+05, 3.8437e+05, 3.8438e+05,
         7.9058e+05, 3.8437e+05, 7.7317e+05, 7.8457e+05, 7.5912e+05, 0.0000e+00,
         3.8440e+05, 3.8439e+05, 7.6852e+05, 3.8439e+05],
        [1.4078e+00, 1.3001e+00, 3.6500e+05, 1.3387e+00, 1.3378e+00, 1.3248e+00,
         4.0147e+05, 1.3844e+00, 3.9696e+05, 3.8357e+05, 3.9864e+05, 3.8440e+05,
         0.0000e+00, 1.2985e+00, 3.7764e+05, 1.3073e+00],
        [1.3189e+00, 1.3832e+00, 3.6502e+05, 1.2675e+00, 1.4202e+00, 1.2379e+00,
         4.0145e+05, 1.4586e+00, 3.9699e+05, 3.8356e+05, 3.9869e+05, 3.8439e+05,
         1.2985e+00, 0.0000e+00, 3.7762e+05, 1.2826e+00],
        [3.7764e+05, 3.7763e+05, 7.4317e+05, 3.7761e+05, 3.7763e+05, 3.7762e+05,
         7.7811e+05, 3.7764e+05, 7.6590e+05, 7.7065e+05, 7.6400e+05, 7.6852e+05,
         3.7764e+05, 3.7762e+05, 0.0000e+00, 3.7763e+05],
        [1.4925e+00, 1.2822e+00, 3.6500e+05, 1.3161e+00, 1.3676e+00, 1.2855e+00,
         4.0148e+05, 1.3845e+00, 3.9698e+05, 3.8358e+05, 3.9868e+05, 3.8439e+05,
         1.3073e+00, 1.2826e+00, 3.7763e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3189e+00, 1.3919e+00, 1.3981e+00, 1.4078e+00, 1.4925e+00,
        1.6123e+00, 1.6950e+00, 1.9050e+00, 3.6504e+05, 3.7764e+05, 3.8357e+05,
        3.8435e+05, 3.9697e+05, 3.9864e+05, 4.0145e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2822e+00, 1.3001e+00, 1.3065e+00, 1.3583e+00, 1.3767e+00,
        1.3832e+00, 1.3907e+00, 1.6950e+00, 3.6501e+05, 3.7763e+05, 3.8358e+05,
        3.8437e+05, 3.9699e+05, 3.9866e+05, 4.0147e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 364996.9375, 364998.5000, 364998.6875, 365007.9062,
        365015.5000, 365016.4062, 365019.4375, 365030.3750, 365044.5938,
        733205.9375, 743172.0625, 756121.6875, 760575.5000, 766656.2500,
        769230.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2170e+00, 1.2675e+00, 1.3161e+00, 1.3358e+00, 1.3387e+00,
        1.3583e+00, 1.3981e+00, 1.6071e+00, 3.6502e+05, 3.7761e+05, 3.8356e+05,
        3.8438e+05, 3.9694e+05, 3.9867e+05, 4.0144e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3065e+00, 1.3358e+00, 1.3378e+00, 1.3413e+00, 1.3676e+00,
        1.3710e+00, 1.4202e+00, 1.6123e+00, 3.6502e+05, 3.7763e+05, 3.8357e+05,
        3.8437e+05, 3.9698e+05, 3.9866e+05, 4.0147e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2170e+00, 1.2379e+00, 1.2855e+00, 1.3248e+00, 1.3413e+00,
        1.3907e+00, 1.3919e+00, 1.6015e+00, 3.6503e+05, 3.7762e+05, 3.8358e+05,
        3.8438e+05, 3.9697e+05, 3.9870e+05, 4.0147e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401437.3125, 401445.5938, 401449.8125, 401468.2812,
        401468.3125, 401470.0000, 401474.9062, 401479.5312, 401480.3750,
        757933.5000, 766656.2500, 778111.2500, 790578.1250, 797169.8750,
        808219.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3710e+00, 1.3767e+00, 1.3844e+00, 1.3845e+00, 1.4586e+00,
        1.6015e+00, 1.6071e+00, 1.9050e+00, 3.6500e+05, 3.7764e+05, 3.8357e+05,
        3.8437e+05, 3.9696e+05, 3.9867e+05, 4.0148e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396944.7188, 396960.0625, 396962.4688, 396970.9062,
        396971.3125, 396975.7812, 396980.2812, 396987.1250, 396988.4375,
        760575.5000, 765896.0625, 773173.5000, 791583.3125, 803776.5000,
        808219.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383559.5625, 383564.2188, 383565.9688, 383567.2500,
        383567.2812, 383571.1250, 383576.1875, 383576.2500, 383580.1250,
        756121.6875, 770648.8750, 782012.8750, 784573.3125, 791583.3125,
        797169.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398635.2188, 398643.3438, 398656.9688, 398663.1875,
        398670.7188, 398673.7500, 398677.7500, 398693.8438, 398697.9375,
        757933.5000, 759122.1250, 763995.3125, 769230.6250, 782012.8750,
        803776.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384353.2500, 384369.1875, 384370.1562, 384370.6562,
        384379.3750, 384383.7500, 384392.3125, 384393.8750, 384399.5312,
        733205.9375, 759122.1250, 768515.9375, 773173.5000, 784573.3125,
        790578.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2985e+00, 1.3001e+00, 1.3073e+00, 1.3248e+00, 1.3378e+00,
        1.3387e+00, 1.3844e+00, 1.4078e+00, 3.6500e+05, 3.7764e+05, 3.8357e+05,
        3.8440e+05, 3.9696e+05, 3.9864e+05, 4.0147e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2379e+00, 1.2675e+00, 1.2826e+00, 1.2985e+00, 1.3189e+00,
        1.3832e+00, 1.4202e+00, 1.4586e+00, 3.6502e+05, 3.7762e+05, 3.8356e+05,
        3.8439e+05, 3.9699e+05, 3.9869e+05, 4.0145e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377608.5000, 377615.1562, 377622.7500, 377625.2812,
        377629.8750, 377632.9375, 377636.4375, 377639.3750, 377641.5625,
        743172.0625, 763995.3125, 765896.0625, 768515.9375, 770648.8750,
        778111.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2822e+00, 1.2826e+00, 1.2855e+00, 1.3073e+00, 1.3161e+00,
        1.3676e+00, 1.3845e+00, 1.4925e+00, 3.6500e+05, 3.7763e+05, 3.8358e+05,
        3.8439e+05, 3.9698e+05, 3.9868e+05, 4.0148e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['74269.32', '74264.43', '401833.44', '74263.56', '74265.64', '74265.62', '437110.81', '74264.99', '433331.66', '420824.94', '434594.66', '419261.84', '74265.09', '74265.29', '414182.41', '74264.07']
estimated f for each client, fs: [7, 7, 6, 7, 7, 7, 5, 7, 5, 5, 5, 5, 7, 7, 5, 7]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 11, 19, 10, 2, 7, 15, 6, 16, 17, 13, 18, 1, 8, 14, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0111s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:57...
global Accuracy on shared test data: 78.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:57, End: 2025-07-22 16:00:57)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [5, 9, 14, 15, 18, 12, 10, 16, 8, 19, 2, 7, 17, 3, 1, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2527e+00, 3.8981e+05, 3.9673e+05, 4.0006e+05, 1.1214e+00,
         1.5219e+00, 4.0266e+05, 1.2287e+00, 3.8741e+05, 1.2882e+00, 1.2202e+00,
         4.0307e+05, 1.1627e+00, 1.1899e+00, 1.3629e+00],
        [1.2527e+00, 0.0000e+00, 3.8985e+05, 3.9676e+05, 4.0004e+05, 1.0718e+00,
         1.2079e+00, 4.0268e+05, 1.0894e+00, 3.8740e+05, 1.3055e+00, 1.1425e+00,
         4.0306e+05, 1.1229e+00, 1.1086e+00, 1.5277e+00],
        [3.8981e+05, 3.8985e+05, 0.0000e+00, 7.8592e+05, 7.8257e+05, 3.8983e+05,
         3.8985e+05, 7.8733e+05, 3.8982e+05, 7.8348e+05, 3.8984e+05, 3.8984e+05,
         7.8173e+05, 3.8983e+05, 3.8986e+05, 3.8983e+05],
        [3.9673e+05, 3.9676e+05, 7.8592e+05, 0.0000e+00, 8.1132e+05, 3.9673e+05,
         3.9678e+05, 7.8978e+05, 3.9676e+05, 7.7757e+05, 3.9673e+05, 3.9676e+05,
         8.0266e+05, 3.9674e+05, 3.9675e+05, 3.9676e+05],
        [4.0006e+05, 4.0004e+05, 7.8257e+05, 8.1132e+05, 0.0000e+00, 4.0006e+05,
         4.0005e+05, 8.0556e+05, 4.0002e+05, 7.9793e+05, 4.0008e+05, 4.0005e+05,
         8.0909e+05, 4.0002e+05, 4.0002e+05, 4.0004e+05],
        [1.1214e+00, 1.0718e+00, 3.8983e+05, 3.9673e+05, 4.0006e+05, 0.0000e+00,
         1.2067e+00, 4.0266e+05, 1.0726e+00, 3.8740e+05, 1.2202e+00, 1.0732e+00,
         4.0307e+05, 9.6480e-01, 1.1427e+00, 1.3361e+00],
        [1.5219e+00, 1.2079e+00, 3.8985e+05, 3.9678e+05, 4.0005e+05, 1.2067e+00,
         0.0000e+00, 4.0271e+05, 1.2630e+00, 3.8740e+05, 1.5914e+00, 1.2269e+00,
         4.0302e+05, 1.3096e+00, 1.4921e+00, 2.0078e+00],
        [4.0266e+05, 4.0268e+05, 7.8733e+05, 7.8978e+05, 8.0556e+05, 4.0266e+05,
         4.0271e+05, 0.0000e+00, 4.0267e+05, 7.8290e+05, 4.0267e+05, 4.0269e+05,
         7.9388e+05, 4.0265e+05, 4.0266e+05, 4.0266e+05],
        [1.2287e+00, 1.0894e+00, 3.8982e+05, 3.9676e+05, 4.0002e+05, 1.0726e+00,
         1.2630e+00, 4.0267e+05, 0.0000e+00, 3.8739e+05, 1.2676e+00, 1.1041e+00,
         4.0308e+05, 1.1122e+00, 1.1624e+00, 1.3408e+00],
        [3.8741e+05, 3.8740e+05, 7.8348e+05, 7.7757e+05, 7.9793e+05, 3.8740e+05,
         3.8740e+05, 7.8290e+05, 3.8739e+05, 0.0000e+00, 3.8741e+05, 3.8739e+05,
         7.8565e+05, 3.8740e+05, 3.8739e+05, 3.8741e+05],
        [1.2882e+00, 1.3055e+00, 3.8984e+05, 3.9673e+05, 4.0008e+05, 1.2202e+00,
         1.5914e+00, 4.0267e+05, 1.2676e+00, 3.8741e+05, 0.0000e+00, 1.2258e+00,
         4.0306e+05, 1.2603e+00, 1.1862e+00, 1.2398e+00],
        [1.2202e+00, 1.1425e+00, 3.8984e+05, 3.9676e+05, 4.0005e+05, 1.0732e+00,
         1.2269e+00, 4.0269e+05, 1.1041e+00, 3.8739e+05, 1.2258e+00, 0.0000e+00,
         4.0305e+05, 1.1131e+00, 1.1968e+00, 1.4316e+00],
        [4.0307e+05, 4.0306e+05, 7.8173e+05, 8.0266e+05, 8.0909e+05, 4.0307e+05,
         4.0302e+05, 7.9388e+05, 4.0308e+05, 7.8565e+05, 4.0306e+05, 4.0305e+05,
         0.0000e+00, 4.0304e+05, 4.0305e+05, 4.0308e+05],
        [1.1627e+00, 1.1229e+00, 3.8983e+05, 3.9674e+05, 4.0002e+05, 9.6480e-01,
         1.3096e+00, 4.0265e+05, 1.1122e+00, 3.8740e+05, 1.2603e+00, 1.1131e+00,
         4.0304e+05, 0.0000e+00, 1.1449e+00, 1.4566e+00],
        [1.1899e+00, 1.1086e+00, 3.8986e+05, 3.9675e+05, 4.0002e+05, 1.1427e+00,
         1.4921e+00, 4.0266e+05, 1.1624e+00, 3.8739e+05, 1.1862e+00, 1.1968e+00,
         4.0305e+05, 1.1449e+00, 0.0000e+00, 1.2167e+00],
        [1.3629e+00, 1.5277e+00, 3.8983e+05, 3.9676e+05, 4.0004e+05, 1.3361e+00,
         2.0078e+00, 4.0266e+05, 1.3408e+00, 3.8741e+05, 1.2398e+00, 1.4316e+00,
         4.0308e+05, 1.4566e+00, 1.2167e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1214e+00, 1.1627e+00, 1.1899e+00, 1.2202e+00, 1.2287e+00,
        1.2527e+00, 1.2882e+00, 1.3629e+00, 1.5219e+00, 3.8741e+05, 3.8981e+05,
        3.9673e+05, 4.0006e+05, 4.0266e+05, 4.0307e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0718e+00, 1.0894e+00, 1.1086e+00, 1.1229e+00, 1.1425e+00,
        1.2079e+00, 1.2527e+00, 1.3055e+00, 1.5277e+00, 3.8740e+05, 3.8985e+05,
        3.9676e+05, 4.0004e+05, 4.0268e+05, 4.0306e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389808.9375, 389820.1875, 389827.2812, 389828.0312,
        389828.2188, 389835.7500, 389839.0625, 389846.1875, 389852.0625,
        389859.6875, 781732.1875, 782571.1875, 783476.5625, 785924.8750,
        787325.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396729.6250, 396730.1875, 396734.7188, 396738.1250,
        396746.6875, 396755.6875, 396760.4688, 396761.7188, 396763.0625,
        396775.2188, 777569.3750, 785924.8750, 789779.7500, 802658.5625,
        811317.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400019.0938, 400020.4062, 400020.6562, 400038.3438,
        400040.4688, 400046.3125, 400048.7812, 400056.1562, 400058.3125,
        400076.1562, 782571.1875, 797934.8125, 805564.8750, 809091.3750,
        811317.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.6480e-01, 1.0718e+00, 1.0726e+00, 1.0732e+00, 1.1214e+00,
        1.1427e+00, 1.2067e+00, 1.2202e+00, 1.3361e+00, 3.8740e+05, 3.8983e+05,
        3.9673e+05, 4.0006e+05, 4.0266e+05, 4.0307e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2067e+00, 1.2079e+00, 1.2269e+00, 1.2630e+00, 1.3096e+00,
        1.4921e+00, 1.5219e+00, 1.5914e+00, 2.0078e+00, 3.8740e+05, 3.8985e+05,
        3.9678e+05, 4.0005e+05, 4.0271e+05, 4.0302e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402645.3750, 402658.0312, 402659.1250, 402660.8438,
        402664.5625, 402666.1875, 402672.8125, 402677.9375, 402686.5938,
        402707.6562, 782902.2500, 787325.0625, 789779.7500, 793879.2500,
        805564.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0726e+00, 1.0894e+00, 1.1041e+00, 1.1122e+00, 1.1624e+00,
        1.2287e+00, 1.2630e+00, 1.2676e+00, 1.3408e+00, 3.8739e+05, 3.8982e+05,
        3.9676e+05, 4.0002e+05, 4.0267e+05, 4.0308e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387387.9062, 387389.6562, 387390.3125, 387395.5625,
        387396.9375, 387398.0625, 387399.3438, 387405.5000, 387410.9375,
        387412.8438, 777569.3750, 782902.2500, 783476.5625, 785648.1250,
        797934.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1862e+00, 1.2202e+00, 1.2258e+00, 1.2398e+00, 1.2603e+00,
        1.2676e+00, 1.2882e+00, 1.3055e+00, 1.5914e+00, 3.8741e+05, 3.8984e+05,
        3.9673e+05, 4.0008e+05, 4.0267e+05, 4.0306e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0732e+00, 1.1041e+00, 1.1131e+00, 1.1425e+00, 1.1968e+00,
        1.2202e+00, 1.2258e+00, 1.2269e+00, 1.4316e+00, 3.8739e+05, 3.8984e+05,
        3.9676e+05, 4.0005e+05, 4.0269e+05, 4.0305e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403018.7500, 403042.5000, 403045.0938, 403051.0000,
        403056.0000, 403062.4375, 403068.4375, 403071.0000, 403078.7812,
        403083.9375, 781732.1875, 785648.1250, 793879.2500, 802658.5625,
        809091.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.6480e-01, 1.1122e+00, 1.1131e+00, 1.1229e+00, 1.1449e+00,
        1.1627e+00, 1.2603e+00, 1.3096e+00, 1.4566e+00, 3.8740e+05, 3.8983e+05,
        3.9674e+05, 4.0002e+05, 4.0265e+05, 4.0304e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1086e+00, 1.1427e+00, 1.1449e+00, 1.1624e+00, 1.1862e+00,
        1.1899e+00, 1.1968e+00, 1.2167e+00, 1.4921e+00, 3.8739e+05, 3.8986e+05,
        3.9675e+05, 4.0002e+05, 4.0266e+05, 4.0305e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2167e+00, 1.2398e+00, 1.3361e+00, 1.3408e+00, 1.3629e+00,
        1.4316e+00, 1.4566e+00, 1.5277e+00, 2.0078e+00, 3.8741e+05, 3.8983e+05,
        3.9676e+05, 4.0004e+05, 4.0266e+05, 4.0308e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38741.68', '38741.02', '389834.56', '396749.56', '400042.47', '38740.58', '38741.09', '402669.91', '38740.09', '387398.69', '38742.25', '38739.86', '403057.81', '38740.76', '38740.05', '38742.58']
estimated f for each client, fs: [6, 6, 5, 4, 4, 6, 6, 4, 6, 5, 6, 6, 4, 6, 6, 6]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 9, 14, 15, 18, 12, 10, 16, 8, 19, 2, 7, 17, 3, 1, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0228s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:57...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:57, End: 2025-07-22 16:00:57)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 6, 19, 15, 9, 5, 7, 16, 1, 3, 8, 18, 20, 10, 4, 14], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0985e+00, 3.8673e+05, 3.7777e+05, 1.2236e+00, 1.1986e+00,
         1.6176e+00, 3.8649e+05, 1.1020e+00, 1.1128e+00, 1.2127e+00, 3.9489e+05,
         3.8753e+05, 1.3975e+00, 1.1535e+00, 3.9092e+05],
        [1.0985e+00, 0.0000e+00, 3.8673e+05, 3.7777e+05, 1.3901e+00, 1.2525e+00,
         1.8875e+00, 3.8647e+05, 1.0928e+00, 1.2902e+00, 1.2676e+00, 3.9491e+05,
         3.8754e+05, 1.6986e+00, 1.2053e+00, 3.9090e+05],
        [3.8673e+05, 3.8673e+05, 0.0000e+00, 7.7783e+05, 3.8675e+05, 3.8674e+05,
         3.8672e+05, 7.6373e+05, 3.8672e+05, 3.8676e+05, 3.8671e+05, 7.9044e+05,
         7.7141e+05, 3.8673e+05, 3.8672e+05, 7.5924e+05],
        [3.7777e+05, 3.7777e+05, 7.7783e+05, 0.0000e+00, 3.7774e+05, 3.7776e+05,
         3.7773e+05, 7.7360e+05, 3.7776e+05, 3.7775e+05, 3.7775e+05, 7.7041e+05,
         7.5842e+05, 3.7773e+05, 3.7774e+05, 7.4871e+05],
        [1.2236e+00, 1.3901e+00, 3.8675e+05, 3.7774e+05, 0.0000e+00, 1.1566e+00,
         1.1944e+00, 3.8650e+05, 1.0401e+00, 1.0148e+00, 1.0154e+00, 3.9491e+05,
         3.8756e+05, 1.0772e+00, 1.1452e+00, 3.9094e+05],
        [1.1986e+00, 1.2525e+00, 3.8674e+05, 3.7776e+05, 1.1566e+00, 0.0000e+00,
         1.5388e+00, 3.8649e+05, 1.0815e+00, 1.0730e+00, 1.1736e+00, 3.9493e+05,
         3.8754e+05, 1.3326e+00, 1.1311e+00, 3.9091e+05],
        [1.6176e+00, 1.8875e+00, 3.8672e+05, 3.7773e+05, 1.1944e+00, 1.5388e+00,
         0.0000e+00, 3.8650e+05, 1.5196e+00, 1.2998e+00, 1.2908e+00, 3.9492e+05,
         3.8757e+05, 1.0303e+00, 1.4914e+00, 3.9092e+05],
        [3.8649e+05, 3.8647e+05, 7.6373e+05, 7.7360e+05, 3.8650e+05, 3.8649e+05,
         3.8650e+05, 0.0000e+00, 3.8649e+05, 3.8647e+05, 3.8647e+05, 7.8920e+05,
         7.7507e+05, 3.8649e+05, 3.8650e+05, 8.0830e+05],
        [1.1020e+00, 1.0928e+00, 3.8672e+05, 3.7776e+05, 1.0401e+00, 1.0815e+00,
         1.5196e+00, 3.8649e+05, 0.0000e+00, 1.0535e+00, 1.0903e+00, 3.9490e+05,
         3.8755e+05, 1.2904e+00, 1.1069e+00, 3.9092e+05],
        [1.1128e+00, 1.2902e+00, 3.8676e+05, 3.7775e+05, 1.0148e+00, 1.0730e+00,
         1.2998e+00, 3.8647e+05, 1.0535e+00, 0.0000e+00, 1.0222e+00, 3.9493e+05,
         3.8753e+05, 1.1284e+00, 1.0865e+00, 3.9092e+05],
        [1.2127e+00, 1.2676e+00, 3.8671e+05, 3.7775e+05, 1.0154e+00, 1.1736e+00,
         1.2908e+00, 3.8647e+05, 1.0903e+00, 1.0222e+00, 0.0000e+00, 3.9493e+05,
         3.8754e+05, 1.0970e+00, 1.1546e+00, 3.9090e+05],
        [3.9489e+05, 3.9491e+05, 7.9044e+05, 7.7041e+05, 3.9491e+05, 3.9493e+05,
         3.9492e+05, 7.8920e+05, 3.9490e+05, 3.9493e+05, 3.9493e+05, 0.0000e+00,
         7.8796e+05, 3.9493e+05, 3.9491e+05, 7.9093e+05],
        [3.8753e+05, 3.8754e+05, 7.7141e+05, 7.5842e+05, 3.8756e+05, 3.8754e+05,
         3.8757e+05, 7.7507e+05, 3.8755e+05, 3.8753e+05, 3.8754e+05, 7.8796e+05,
         0.0000e+00, 3.8754e+05, 3.8752e+05, 7.7173e+05],
        [1.3975e+00, 1.6986e+00, 3.8673e+05, 3.7773e+05, 1.0772e+00, 1.3326e+00,
         1.0303e+00, 3.8649e+05, 1.2904e+00, 1.1284e+00, 1.0970e+00, 3.9493e+05,
         3.8754e+05, 0.0000e+00, 1.3156e+00, 3.9091e+05],
        [1.1535e+00, 1.2053e+00, 3.8672e+05, 3.7774e+05, 1.1452e+00, 1.1311e+00,
         1.4914e+00, 3.8650e+05, 1.1069e+00, 1.0865e+00, 1.1546e+00, 3.9491e+05,
         3.8752e+05, 1.3156e+00, 0.0000e+00, 3.9094e+05],
        [3.9092e+05, 3.9090e+05, 7.5924e+05, 7.4871e+05, 3.9094e+05, 3.9091e+05,
         3.9092e+05, 8.0830e+05, 3.9092e+05, 3.9092e+05, 3.9090e+05, 7.9093e+05,
         7.7173e+05, 3.9091e+05, 3.9094e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0985e+00, 1.1020e+00, 1.1128e+00, 1.1535e+00, 1.1986e+00,
        1.2127e+00, 1.2236e+00, 1.3975e+00, 1.6176e+00, 3.7777e+05, 3.8649e+05,
        3.8673e+05, 3.8753e+05, 3.9092e+05, 3.9489e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0928e+00, 1.0985e+00, 1.2053e+00, 1.2525e+00, 1.2676e+00,
        1.2902e+00, 1.3901e+00, 1.6986e+00, 1.8875e+00, 3.7777e+05, 3.8647e+05,
        3.8673e+05, 3.8754e+05, 3.9090e+05, 3.9491e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386710.8125, 386722.8750, 386723.5938, 386725.0000,
        386726.3125, 386728.5938, 386730.1875, 386736.8750, 386748.0625,
        386757.9062, 759240.1250, 763730.2500, 771409.2500, 777834.7500,
        790435.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377727.8750, 377729.8125, 377736.3125, 377740.5625,
        377748.2188, 377754.0938, 377756.3438, 377758.9062, 377769.7188,
        377772.6875, 748713.8125, 758421.8125, 770408.5625, 773601.0000,
        777834.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0148e+00, 1.0154e+00, 1.0401e+00, 1.0772e+00, 1.1452e+00,
        1.1566e+00, 1.1944e+00, 1.2236e+00, 1.3901e+00, 3.7774e+05, 3.8650e+05,
        3.8675e+05, 3.8756e+05, 3.9094e+05, 3.9491e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0730e+00, 1.0815e+00, 1.1311e+00, 1.1566e+00, 1.1736e+00,
        1.1986e+00, 1.2525e+00, 1.3326e+00, 1.5388e+00, 3.7776e+05, 3.8649e+05,
        3.8674e+05, 3.8754e+05, 3.9091e+05, 3.9493e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0303e+00, 1.1944e+00, 1.2908e+00, 1.2998e+00, 1.4914e+00,
        1.5196e+00, 1.5388e+00, 1.6176e+00, 1.8875e+00, 3.7773e+05, 3.8650e+05,
        3.8672e+05, 3.8757e+05, 3.9092e+05, 3.9492e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386472.2500, 386473.3125, 386473.5000, 386486.5625,
        386487.8750, 386490.0312, 386491.8438, 386497.4375, 386498.0938,
        386503.4688, 763730.2500, 773601.0000, 775072.4375, 789202.6250,
        808300.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0401e+00, 1.0535e+00, 1.0815e+00, 1.0903e+00, 1.0928e+00,
        1.1020e+00, 1.1069e+00, 1.2904e+00, 1.5196e+00, 3.7776e+05, 3.8649e+05,
        3.8672e+05, 3.8755e+05, 3.9092e+05, 3.9490e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0148e+00, 1.0222e+00, 1.0535e+00, 1.0730e+00, 1.0865e+00,
        1.1128e+00, 1.1284e+00, 1.2902e+00, 1.2998e+00, 3.7775e+05, 3.8647e+05,
        3.8676e+05, 3.8753e+05, 3.9092e+05, 3.9493e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0154e+00, 1.0222e+00, 1.0903e+00, 1.0970e+00, 1.1546e+00,
        1.1736e+00, 1.2127e+00, 1.2676e+00, 1.2908e+00, 3.7775e+05, 3.8647e+05,
        3.8671e+05, 3.8754e+05, 3.9090e+05, 3.9493e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394886.9688, 394904.3750, 394912.4062, 394912.6875,
        394912.8750, 394922.3125, 394925.5312, 394925.7188, 394932.9688,
        394933.3438, 770408.5625, 787964.0000, 789202.6250, 790435.0625,
        790929.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387518.9062, 387530.3125, 387534.5000, 387536.6875,
        387538.9062, 387542.4062, 387542.9688, 387548.2812, 387560.4375,
        387570.7188, 758421.8125, 771409.2500, 771734.4375, 775072.4375,
        787964.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0303e+00, 1.0772e+00, 1.0970e+00, 1.1284e+00, 1.2904e+00,
        1.3156e+00, 1.3326e+00, 1.3975e+00, 1.6986e+00, 3.7773e+05, 3.8649e+05,
        3.8673e+05, 3.8754e+05, 3.9091e+05, 3.9493e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0865e+00, 1.1069e+00, 1.1311e+00, 1.1452e+00, 1.1535e+00,
        1.1546e+00, 1.2053e+00, 1.3156e+00, 1.4914e+00, 3.7774e+05, 3.8650e+05,
        3.8672e+05, 3.8752e+05, 3.9094e+05, 3.9491e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390903.7188, 390904.4375, 390906.5312, 390914.7188,
        390915.4688, 390915.7812, 390919.8125, 390924.3125, 390937.6562,
        390941.5000, 748713.8125, 759240.1250, 771734.4375, 790929.7500,
        808300.6250])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37778.38', '37778.19', '386731.00', '377749.44', '37774.65', '37776.98', '37774.07', '386487.44', '37776.67', '37775.83', '37776.45', '394916.91', '387542.44', '37774.12', '37775.14', '390918.38']
estimated f for each client, fs: [6, 6, 4, 4, 6, 6, 6, 4, 6, 6, 6, 4, 4, 6, 6, 4]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 6, 19, 15, 9, 5, 7, 16, 1, 3, 8, 18, 20, 10, 4, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0234s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:58...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:58, End: 2025-07-22 16:00:58)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 5, 14, 4, 19, 6, 13, 16, 10, 18, 1, 3, 20, 2, 17, 8], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.2398e-01, 3.9366e+05, 9.3576e-01, 3.9070e+05, 1.1332e+00,
         3.6938e+05, 3.9987e+05, 8.0743e-01, 3.9451e+05, 8.4237e-01, 8.2456e-01,
         3.8026e+05, 9.9819e-01, 3.9908e+05, 8.1278e-01],
        [9.2398e-01, 0.0000e+00, 3.9367e+05, 9.4105e-01, 3.9071e+05, 1.1069e+00,
         3.6937e+05, 3.9989e+05, 1.0276e+00, 3.9452e+05, 9.1407e-01, 9.2146e-01,
         3.8028e+05, 1.0481e+00, 3.9908e+05, 9.6540e-01],
        [3.9366e+05, 3.9367e+05, 0.0000e+00, 3.9368e+05, 7.6495e+05, 3.9368e+05,
         7.8627e+05, 7.8385e+05, 3.9364e+05, 7.8713e+05, 3.9367e+05, 3.9366e+05,
         7.7087e+05, 3.9368e+05, 8.0417e+05, 3.9365e+05],
        [9.3576e-01, 9.4105e-01, 3.9368e+05, 0.0000e+00, 3.9070e+05, 1.0294e+00,
         3.6936e+05, 3.9988e+05, 1.0318e+00, 3.9452e+05, 9.3275e-01, 9.0544e-01,
         3.8025e+05, 9.9612e-01, 3.9909e+05, 9.5178e-01],
        [3.9070e+05, 3.9071e+05, 7.6495e+05, 3.9070e+05, 0.0000e+00, 3.9071e+05,
         7.7308e+05, 7.7879e+05, 3.9069e+05, 7.7823e+05, 3.9072e+05, 3.9074e+05,
         7.7453e+05, 3.9072e+05, 7.9481e+05, 3.9072e+05],
        [1.1332e+00, 1.1069e+00, 3.9368e+05, 1.0294e+00, 3.9071e+05, 0.0000e+00,
         3.6941e+05, 3.9987e+05, 1.3026e+00, 3.9453e+05, 9.6844e-01, 1.0990e+00,
         3.8029e+05, 9.7814e-01, 3.9907e+05, 1.1044e+00],
        [3.6938e+05, 3.6937e+05, 7.8627e+05, 3.6936e+05, 7.7308e+05, 3.6941e+05,
         0.0000e+00, 7.4874e+05, 3.6937e+05, 7.6623e+05, 3.6937e+05, 3.6937e+05,
         7.6329e+05, 3.6939e+05, 7.8355e+05, 3.6935e+05],
        [3.9987e+05, 3.9989e+05, 7.8385e+05, 3.9988e+05, 7.7879e+05, 3.9987e+05,
         7.4874e+05, 0.0000e+00, 3.9987e+05, 7.8200e+05, 3.9988e+05, 3.9987e+05,
         7.5721e+05, 3.9989e+05, 7.9887e+05, 3.9989e+05],
        [8.0743e-01, 1.0276e+00, 3.9364e+05, 1.0318e+00, 3.9069e+05, 1.3026e+00,
         3.6937e+05, 3.9987e+05, 0.0000e+00, 3.9452e+05, 1.0200e+00, 8.6818e-01,
         3.8028e+05, 1.0898e+00, 3.9907e+05, 8.6886e-01],
        [3.9451e+05, 3.9452e+05, 7.8713e+05, 3.9452e+05, 7.7823e+05, 3.9453e+05,
         7.6623e+05, 7.8200e+05, 3.9452e+05, 0.0000e+00, 3.9452e+05, 3.9453e+05,
         7.8548e+05, 3.9452e+05, 8.0921e+05, 3.9453e+05],
        [8.4237e-01, 9.1407e-01, 3.9367e+05, 9.3275e-01, 3.9072e+05, 9.6844e-01,
         3.6937e+05, 3.9988e+05, 1.0200e+00, 3.9452e+05, 0.0000e+00, 8.7978e-01,
         3.8031e+05, 9.7964e-01, 3.9908e+05, 8.9670e-01],
        [8.2456e-01, 9.2146e-01, 3.9366e+05, 9.0544e-01, 3.9074e+05, 1.0990e+00,
         3.6937e+05, 3.9987e+05, 8.6818e-01, 3.9453e+05, 8.7978e-01, 0.0000e+00,
         3.8028e+05, 9.5998e-01, 3.9905e+05, 8.4648e-01],
        [3.8026e+05, 3.8028e+05, 7.7087e+05, 3.8025e+05, 7.7453e+05, 3.8029e+05,
         7.6329e+05, 7.5721e+05, 3.8028e+05, 7.8548e+05, 3.8031e+05, 3.8028e+05,
         0.0000e+00, 3.8027e+05, 7.8234e+05, 3.8026e+05],
        [9.9819e-01, 1.0481e+00, 3.9368e+05, 9.9612e-01, 3.9072e+05, 9.7814e-01,
         3.6939e+05, 3.9989e+05, 1.0898e+00, 3.9452e+05, 9.7964e-01, 9.5998e-01,
         3.8027e+05, 0.0000e+00, 3.9905e+05, 1.0076e+00],
        [3.9908e+05, 3.9908e+05, 8.0417e+05, 3.9909e+05, 7.9481e+05, 3.9907e+05,
         7.8355e+05, 7.9887e+05, 3.9907e+05, 8.0921e+05, 3.9908e+05, 3.9905e+05,
         7.8234e+05, 3.9905e+05, 0.0000e+00, 3.9908e+05],
        [8.1278e-01, 9.6540e-01, 3.9365e+05, 9.5178e-01, 3.9072e+05, 1.1044e+00,
         3.6935e+05, 3.9989e+05, 8.6886e-01, 3.9453e+05, 8.9670e-01, 8.4648e-01,
         3.8026e+05, 1.0076e+00, 3.9908e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.0743e-01, 8.1278e-01, 8.2456e-01, 8.4237e-01, 9.2398e-01,
        9.3576e-01, 9.9819e-01, 1.1332e+00, 3.6938e+05, 3.8026e+05, 3.9070e+05,
        3.9366e+05, 3.9451e+05, 3.9908e+05, 3.9987e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1407e-01, 9.2146e-01, 9.2398e-01, 9.4105e-01, 9.6540e-01,
        1.0276e+00, 1.0481e+00, 1.1069e+00, 3.6937e+05, 3.8028e+05, 3.9071e+05,
        3.9367e+05, 3.9452e+05, 3.9908e+05, 3.9989e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393639.5312, 393649.0625, 393659.9062, 393661.2188,
        393671.1562, 393671.9688, 393675.3438, 393677.7188, 393682.5312,
        764949.4375, 770866.7500, 783850.5000, 786267.8750, 787129.6875,
        804174.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.0544e-01, 9.3275e-01, 9.3576e-01, 9.4105e-01, 9.5178e-01,
        9.9612e-01, 1.0294e+00, 1.0318e+00, 3.6936e+05, 3.8025e+05, 3.9070e+05,
        3.9368e+05, 3.9452e+05, 3.9909e+05, 3.9988e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390692.5938, 390698.2188, 390700.8750, 390708.1875,
        390712.7188, 390715.1562, 390717.6250, 390718.9688, 390739.3750,
        764949.4375, 773079.5625, 774534.0000, 778233.0000, 778785.7500,
        794805.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.6844e-01, 9.7814e-01, 1.0294e+00, 1.0990e+00, 1.1044e+00,
        1.1069e+00, 1.1332e+00, 1.3026e+00, 3.6941e+05, 3.8029e+05, 3.9071e+05,
        3.9368e+05, 3.9453e+05, 3.9907e+05, 3.9987e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 369350.2812, 369361.4375, 369370.4688, 369371.6250,
        369371.7188, 369373.6875, 369377.7500, 369388.5312, 369406.3750,
        748740.0000, 763292.0000, 766232.1250, 773079.5625, 783550.6250,
        786267.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399869.1875, 399871.3125, 399872.2188, 399874.4375,
        399880.6250, 399883.6562, 399889.7500, 399892.0000, 399894.4062,
        748740.0000, 757205.3125, 778785.7500, 781996.3125, 783850.5000,
        798873.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0743e-01, 8.6818e-01, 8.6886e-01, 1.0200e+00, 1.0276e+00,
        1.0318e+00, 1.0898e+00, 1.3026e+00, 3.6937e+05, 3.8028e+05, 3.9069e+05,
        3.9364e+05, 3.9452e+05, 3.9907e+05, 3.9987e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394512.5000, 394515.0000, 394515.1562, 394515.6562,
        394519.4375, 394519.4375, 394526.5000, 394527.5625, 394533.9375,
        766232.1250, 778233.0000, 781996.3125, 785479.1250, 787129.6875,
        809206.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4237e-01, 8.7978e-01, 8.9670e-01, 9.1407e-01, 9.3275e-01,
        9.6844e-01, 9.7964e-01, 1.0200e+00, 3.6937e+05, 3.8031e+05, 3.9072e+05,
        3.9367e+05, 3.9452e+05, 3.9908e+05, 3.9988e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.2456e-01, 8.4648e-01, 8.6818e-01, 8.7978e-01, 9.0544e-01,
        9.2146e-01, 9.5998e-01, 1.0990e+00, 3.6937e+05, 3.8028e+05, 3.9074e+05,
        3.9366e+05, 3.9453e+05, 3.9905e+05, 3.9987e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380253.0000, 380258.6875, 380263.0312, 380273.6562,
        380278.0312, 380280.9062, 380281.3125, 380291.9062, 380307.2812,
        757205.3125, 763292.0000, 770866.7500, 774534.0000, 782335.3125,
        785479.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.5998e-01, 9.7814e-01, 9.7964e-01, 9.9612e-01, 9.9819e-01,
        1.0076e+00, 1.0481e+00, 1.0898e+00, 3.6939e+05, 3.8027e+05, 3.9072e+05,
        3.9368e+05, 3.9452e+05, 3.9905e+05, 3.9989e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399047.8750, 399051.9688, 399068.5000, 399072.0625,
        399076.6562, 399077.9375, 399078.2812, 399083.2188, 399089.9375,
        782335.3125, 783550.6250, 794805.7500, 798873.3125, 804174.8750,
        809206.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.1278e-01, 8.4648e-01, 8.6886e-01, 8.9670e-01, 9.5178e-01,
        9.6540e-01, 1.0076e+00, 1.1044e+00, 3.6935e+05, 3.8026e+05, 3.9072e+05,
        3.9365e+05, 3.9453e+05, 3.9908e+05, 3.9989e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['74964.37', '74966.29', '430793.81', '74962.21', '428135.34', '74970.70', '407311.19', '434766.75', '74966.06', '431691.75', '74968.52', '74965.70', '417969.31', '74967.02', '437398.16', '74962.08']
estimated f for each client, fs: [7, 7, 5, 7, 5, 7, 6, 5, 7, 5, 7, 7, 5, 7, 5, 7]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [9, 5, 14, 4, 19, 6, 13, 16, 10, 18, 1, 3, 20, 2, 17, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0269s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:59...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:59, End: 2025-07-22 16:00:59)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 14, 12, 8, 3, 1, 11, 17, 4, 15, 19, 7, 5, 20, 18, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7976e+05, 9.6643e-01, 1.4030e+00, 9.6551e-01, 9.9733e-01,
         1.0146e+00, 4.0094e+05, 9.9944e-01, 3.9596e+05, 3.9270e+05, 1.3131e+00,
         1.0477e+00, 3.8272e+05, 3.9826e+05, 1.0160e+00],
        [3.7976e+05, 0.0000e+00, 3.7976e+05, 3.7980e+05, 3.7977e+05, 3.7976e+05,
         3.7977e+05, 7.6195e+05, 3.7979e+05, 7.9269e+05, 7.6449e+05, 3.7976e+05,
         3.7977e+05, 7.7141e+05, 7.9046e+05, 3.7975e+05],
        [9.6643e-01, 3.7976e+05, 0.0000e+00, 1.0763e+00, 7.9833e-01, 9.2983e-01,
         9.9787e-01, 4.0098e+05, 8.7560e-01, 3.9594e+05, 3.9273e+05, 9.4548e-01,
         8.7888e-01, 3.8275e+05, 3.9827e+05, 1.0835e+00],
        [1.4030e+00, 3.7980e+05, 1.0763e+00, 0.0000e+00, 1.1586e+00, 1.2938e+00,
         1.4766e+00, 4.0099e+05, 1.2807e+00, 3.9593e+05, 3.9273e+05, 7.2347e-01,
         1.3571e+00, 3.8276e+05, 3.9823e+05, 1.6212e+00],
        [9.6551e-01, 3.7977e+05, 7.9833e-01, 1.1586e+00, 0.0000e+00, 9.3050e-01,
         1.0420e+00, 4.0097e+05, 9.3417e-01, 3.9593e+05, 3.9276e+05, 1.0484e+00,
         9.5851e-01, 3.8273e+05, 3.9825e+05, 1.1062e+00],
        [9.9733e-01, 3.7976e+05, 9.2983e-01, 1.2938e+00, 9.3050e-01, 0.0000e+00,
         9.7554e-01, 4.0092e+05, 9.6449e-01, 3.9593e+05, 3.9271e+05, 1.2245e+00,
         9.6834e-01, 3.8276e+05, 3.9825e+05, 1.0126e+00],
        [1.0146e+00, 3.7977e+05, 9.9787e-01, 1.4766e+00, 1.0420e+00, 9.7554e-01,
         0.0000e+00, 4.0097e+05, 9.9931e-01, 3.9595e+05, 3.9273e+05, 1.3402e+00,
         1.0070e+00, 3.8275e+05, 3.9826e+05, 1.1177e+00],
        [4.0094e+05, 7.6195e+05, 4.0098e+05, 4.0099e+05, 4.0097e+05, 4.0092e+05,
         4.0097e+05, 0.0000e+00, 4.0098e+05, 7.9729e+05, 7.8754e+05, 4.0099e+05,
         4.0097e+05, 7.8069e+05, 8.0972e+05, 4.0098e+05],
        [9.9944e-01, 3.7979e+05, 8.7560e-01, 1.2807e+00, 9.3417e-01, 9.6449e-01,
         9.9931e-01, 4.0098e+05, 0.0000e+00, 3.9592e+05, 3.9270e+05, 1.1816e+00,
         9.9817e-01, 3.8273e+05, 3.9823e+05, 1.1048e+00],
        [3.9596e+05, 7.9269e+05, 3.9594e+05, 3.9593e+05, 3.9593e+05, 3.9593e+05,
         3.9595e+05, 7.9729e+05, 3.9592e+05, 0.0000e+00, 7.9958e+05, 3.9590e+05,
         3.9593e+05, 7.7428e+05, 7.9088e+05, 3.9596e+05],
        [3.9270e+05, 7.6449e+05, 3.9273e+05, 3.9273e+05, 3.9276e+05, 3.9271e+05,
         3.9273e+05, 7.8754e+05, 3.9270e+05, 7.9958e+05, 0.0000e+00, 3.9273e+05,
         3.9271e+05, 7.8168e+05, 7.9598e+05, 3.9273e+05],
        [1.3131e+00, 3.7976e+05, 9.4548e-01, 7.2347e-01, 1.0484e+00, 1.2245e+00,
         1.3402e+00, 4.0099e+05, 1.1816e+00, 3.9590e+05, 3.9273e+05, 0.0000e+00,
         1.2122e+00, 3.8277e+05, 3.9823e+05, 1.6262e+00],
        [1.0477e+00, 3.7977e+05, 8.7888e-01, 1.3571e+00, 9.5851e-01, 9.6834e-01,
         1.0070e+00, 4.0097e+05, 9.9817e-01, 3.9593e+05, 3.9271e+05, 1.2122e+00,
         0.0000e+00, 3.8274e+05, 3.9824e+05, 1.1124e+00],
        [3.8272e+05, 7.7141e+05, 3.8275e+05, 3.8276e+05, 3.8273e+05, 3.8276e+05,
         3.8275e+05, 7.8069e+05, 3.8273e+05, 7.7428e+05, 7.8168e+05, 3.8277e+05,
         3.8274e+05, 0.0000e+00, 7.7666e+05, 3.8273e+05],
        [3.9826e+05, 7.9046e+05, 3.9827e+05, 3.9823e+05, 3.9825e+05, 3.9825e+05,
         3.9826e+05, 8.0972e+05, 3.9823e+05, 7.9088e+05, 7.9598e+05, 3.9823e+05,
         3.9824e+05, 7.7666e+05, 0.0000e+00, 3.9825e+05],
        [1.0160e+00, 3.7975e+05, 1.0835e+00, 1.6212e+00, 1.1062e+00, 1.0126e+00,
         1.1177e+00, 4.0098e+05, 1.1048e+00, 3.9596e+05, 3.9273e+05, 1.6262e+00,
         1.1124e+00, 3.8273e+05, 3.9825e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.6551e-01, 9.6643e-01, 9.9733e-01, 9.9944e-01, 1.0146e+00,
        1.0160e+00, 1.0477e+00, 1.3131e+00, 1.4030e+00, 3.7976e+05, 3.8272e+05,
        3.9270e+05, 3.9596e+05, 3.9826e+05, 4.0094e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379750.4375, 379758.1250, 379759.1250, 379760.0000,
        379760.9375, 379767.7500, 379767.9688, 379770.2500, 379789.1875,
        379803.0938, 761946.8125, 764492.0000, 771411.3125, 790458.3750,
        792694.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.9833e-01, 8.7560e-01, 8.7888e-01, 9.2983e-01, 9.4548e-01,
        9.6643e-01, 9.9787e-01, 1.0763e+00, 1.0835e+00, 3.7976e+05, 3.8275e+05,
        3.9273e+05, 3.9594e+05, 3.9827e+05, 4.0098e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.2347e-01, 1.0763e+00, 1.1586e+00, 1.2807e+00, 1.2938e+00,
        1.3571e+00, 1.4030e+00, 1.4766e+00, 1.6212e+00, 3.7980e+05, 3.8276e+05,
        3.9273e+05, 3.9593e+05, 3.9823e+05, 4.0099e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.9833e-01, 9.3050e-01, 9.3417e-01, 9.5851e-01, 9.6551e-01,
        1.0420e+00, 1.0484e+00, 1.1062e+00, 1.1586e+00, 3.7977e+05, 3.8273e+05,
        3.9276e+05, 3.9593e+05, 3.9825e+05, 4.0097e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2983e-01, 9.3050e-01, 9.6449e-01, 9.6834e-01, 9.7554e-01,
        9.9733e-01, 1.0126e+00, 1.2245e+00, 1.2938e+00, 3.7976e+05, 3.8276e+05,
        3.9271e+05, 3.9593e+05, 3.9825e+05, 4.0092e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7554e-01, 9.9787e-01, 9.9931e-01, 1.0070e+00, 1.0146e+00,
        1.0420e+00, 1.1177e+00, 1.3402e+00, 1.4766e+00, 3.7977e+05, 3.8275e+05,
        3.9273e+05, 3.9595e+05, 3.9826e+05, 4.0097e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400918.3750, 400936.7500, 400966.3438, 400967.5625,
        400973.5625, 400975.8750, 400976.1250, 400978.4062, 400989.5000,
        400991.1250, 761946.8125, 780694.7500, 787535.1250, 797293.6250,
        809721.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7560e-01, 9.3417e-01, 9.6449e-01, 9.9817e-01, 9.9931e-01,
        9.9944e-01, 1.1048e+00, 1.1816e+00, 1.2807e+00, 3.7979e+05, 3.8273e+05,
        3.9270e+05, 3.9592e+05, 3.9823e+05, 4.0098e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395901.2188, 395923.4688, 395926.3125, 395926.5000,
        395928.8125, 395933.4375, 395944.0938, 395949.6562, 395956.7500,
        395960.7188, 774283.8750, 790879.6875, 792694.6250, 797293.6250,
        799577.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392697.5625, 392703.5312, 392708.8750, 392709.9375,
        392725.0938, 392728.5312, 392728.6250, 392734.3125, 392734.8438,
        392755.9375, 764492.0000, 781678.3125, 787535.1250, 795978.1250,
        799577.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.2347e-01, 9.4548e-01, 1.0484e+00, 1.1816e+00, 1.2122e+00,
        1.2245e+00, 1.3131e+00, 1.3402e+00, 1.6262e+00, 3.7976e+05, 3.8277e+05,
        3.9273e+05, 3.9590e+05, 3.9823e+05, 4.0099e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7888e-01, 9.5851e-01, 9.6834e-01, 9.9817e-01, 1.0070e+00,
        1.0477e+00, 1.1124e+00, 1.2122e+00, 1.3571e+00, 3.7977e+05, 3.8274e+05,
        3.9271e+05, 3.9593e+05, 3.9824e+05, 4.0097e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382721.5625, 382727.5000, 382727.5938, 382733.7812,
        382738.4062, 382750.0938, 382753.2500, 382756.5938, 382759.1562,
        382765.8125, 771411.3125, 774283.8750, 776655.2500, 780694.7500,
        781678.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398228.0625, 398230.1250, 398232.0938, 398243.7812,
        398249.3750, 398249.9062, 398251.3125, 398256.3750, 398263.4062,
        398266.8438, 776655.2500, 790458.3750, 790879.6875, 795978.1250,
        809721.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0126e+00, 1.0160e+00, 1.0835e+00, 1.1048e+00, 1.1062e+00,
        1.1124e+00, 1.1177e+00, 1.6212e+00, 1.6262e+00, 3.7975e+05, 3.8273e+05,
        3.9273e+05, 3.9596e+05, 3.9825e+05, 4.0098e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37976.79', '379768.69', '37976.95', '37981.45', '37977.67', '37976.93', '37977.79', '400967.34', '37979.85', '395935.09', '392722.69', '37976.98', '37977.98', '382743.38', '398247.09', '37976.12']
estimated f for each client, fs: [6, 5, 6, 6, 6, 6, 6, 4, 6, 4, 4, 6, 6, 5, 4, 6]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [2, 14, 12, 8, 3, 1, 11, 17, 4, 15, 19, 7, 5, 20, 18, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0115s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:00:59...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [ 75 188]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:00:59, End: 2025-07-22 16:00:59)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 9, 11, 4, 17, 14, 3, 5, 20, 16, 13, 19, 6, 10, 2, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1179e+00, 1.1221e+00, 1.1469e+00, 3.9452e+05, 3.9874e+05,
         1.1482e+00, 1.1202e+00, 3.9889e+05, 3.9448e+05, 3.8188e+05, 4.1495e+05,
         1.2348e+00, 1.2681e+00, 1.1737e+00, 1.2758e+00],
        [1.1179e+00, 0.0000e+00, 1.3140e+00, 1.1627e+00, 3.9450e+05, 3.9874e+05,
         1.0852e+00, 1.1721e+00, 3.9888e+05, 3.9450e+05, 3.8191e+05, 4.1491e+05,
         1.2057e+00, 1.0305e+00, 1.2564e+00, 1.0087e+00],
        [1.1221e+00, 1.3140e+00, 0.0000e+00, 1.1862e+00, 3.9454e+05, 3.9874e+05,
         1.2727e+00, 1.1284e+00, 3.9884e+05, 3.9445e+05, 3.8192e+05, 4.1495e+05,
         1.4021e+00, 1.3605e+00, 1.1746e+00, 1.4815e+00],
        [1.1469e+00, 1.1627e+00, 1.1862e+00, 0.0000e+00, 3.9453e+05, 3.9873e+05,
         1.1502e+00, 1.1073e+00, 3.9883e+05, 3.9449e+05, 3.8191e+05, 4.1493e+05,
         1.2599e+00, 1.2444e+00, 1.2206e+00, 1.2424e+00],
        [3.9452e+05, 3.9450e+05, 3.9454e+05, 3.9453e+05, 0.0000e+00, 8.0313e+05,
         3.9452e+05, 3.9455e+05, 7.5560e+05, 7.7801e+05, 7.5313e+05, 7.9531e+05,
         3.9450e+05, 3.9449e+05, 3.9453e+05, 3.9449e+05],
        [3.9874e+05, 3.9874e+05, 3.9874e+05, 3.9873e+05, 8.0313e+05, 0.0000e+00,
         3.9874e+05, 3.9877e+05, 8.1428e+05, 8.0078e+05, 7.8717e+05, 8.0084e+05,
         3.9874e+05, 3.9875e+05, 3.9878e+05, 3.9875e+05],
        [1.1482e+00, 1.0852e+00, 1.2727e+00, 1.1502e+00, 3.9452e+05, 3.9874e+05,
         0.0000e+00, 1.1465e+00, 3.9884e+05, 3.9449e+05, 3.8193e+05, 4.1491e+05,
         1.2451e+00, 1.1158e+00, 1.1994e+00, 1.1278e+00],
        [1.1202e+00, 1.1721e+00, 1.1284e+00, 1.1073e+00, 3.9455e+05, 3.9877e+05,
         1.1465e+00, 0.0000e+00, 3.9885e+05, 3.9449e+05, 3.8192e+05, 4.1492e+05,
         1.2602e+00, 1.2267e+00, 1.2055e+00, 1.3018e+00],
        [3.9889e+05, 3.9888e+05, 3.9884e+05, 3.9883e+05, 7.5560e+05, 8.1428e+05,
         3.9884e+05, 3.9885e+05, 0.0000e+00, 7.8454e+05, 7.7343e+05, 8.1287e+05,
         3.9884e+05, 3.9887e+05, 3.9888e+05, 3.9885e+05],
        [3.9448e+05, 3.9450e+05, 3.9445e+05, 3.9449e+05, 7.7801e+05, 8.0078e+05,
         3.9449e+05, 3.9449e+05, 7.8454e+05, 0.0000e+00, 7.5271e+05, 8.1830e+05,
         3.9451e+05, 3.9450e+05, 3.9446e+05, 3.9451e+05],
        [3.8188e+05, 3.8191e+05, 3.8192e+05, 3.8191e+05, 7.5313e+05, 7.8717e+05,
         3.8193e+05, 3.8192e+05, 7.7343e+05, 7.5271e+05, 0.0000e+00, 7.9995e+05,
         3.8193e+05, 3.8187e+05, 3.8191e+05, 3.8188e+05],
        [4.1495e+05, 4.1491e+05, 4.1495e+05, 4.1493e+05, 7.9531e+05, 8.0084e+05,
         4.1491e+05, 4.1492e+05, 8.1287e+05, 8.1830e+05, 7.9995e+05, 0.0000e+00,
         4.1492e+05, 4.1492e+05, 4.1495e+05, 4.1489e+05],
        [1.2348e+00, 1.2057e+00, 1.4021e+00, 1.2599e+00, 3.9450e+05, 3.9874e+05,
         1.2451e+00, 1.2602e+00, 3.9884e+05, 3.9451e+05, 3.8193e+05, 4.1492e+05,
         0.0000e+00, 1.2421e+00, 1.2515e+00, 1.1762e+00],
        [1.2681e+00, 1.0305e+00, 1.3605e+00, 1.2444e+00, 3.9449e+05, 3.9875e+05,
         1.1158e+00, 1.2267e+00, 3.9887e+05, 3.9450e+05, 3.8187e+05, 4.1492e+05,
         1.2421e+00, 0.0000e+00, 1.2914e+00, 8.9096e-01],
        [1.1737e+00, 1.2564e+00, 1.1746e+00, 1.2206e+00, 3.9453e+05, 3.9878e+05,
         1.1994e+00, 1.2055e+00, 3.9888e+05, 3.9446e+05, 3.8191e+05, 4.1495e+05,
         1.2515e+00, 1.2914e+00, 0.0000e+00, 1.3800e+00],
        [1.2758e+00, 1.0087e+00, 1.4815e+00, 1.2424e+00, 3.9449e+05, 3.9875e+05,
         1.1278e+00, 1.3018e+00, 3.9885e+05, 3.9451e+05, 3.8188e+05, 4.1489e+05,
         1.1762e+00, 8.9096e-01, 1.3800e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1179e+00, 1.1202e+00, 1.1221e+00, 1.1469e+00, 1.1482e+00,
        1.1737e+00, 1.2348e+00, 1.2681e+00, 1.2758e+00, 3.8188e+05, 3.9448e+05,
        3.9452e+05, 3.9874e+05, 3.9889e+05, 4.1495e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0087e+00, 1.0305e+00, 1.0852e+00, 1.1179e+00, 1.1627e+00,
        1.1721e+00, 1.2057e+00, 1.2564e+00, 1.3140e+00, 3.8191e+05, 3.9450e+05,
        3.9450e+05, 3.9874e+05, 3.9888e+05, 4.1491e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1221e+00, 1.1284e+00, 1.1746e+00, 1.1862e+00, 1.2727e+00,
        1.3140e+00, 1.3605e+00, 1.4021e+00, 1.4815e+00, 3.8192e+05, 3.9445e+05,
        3.9454e+05, 3.9874e+05, 3.9884e+05, 4.1495e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1073e+00, 1.1469e+00, 1.1502e+00, 1.1627e+00, 1.1862e+00,
        1.2206e+00, 1.2424e+00, 1.2444e+00, 1.2599e+00, 3.8191e+05, 3.9449e+05,
        3.9453e+05, 3.9873e+05, 3.9883e+05, 4.1493e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394491.5625, 394494.6250, 394497.0000, 394502.8438,
        394516.4062, 394517.3750, 394528.6562, 394531.9062, 394535.9688,
        394545.9688, 753130.3750, 755600.1250, 778008.9375, 795313.6250,
        803131.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398729.9375, 398735.0938, 398741.5938, 398741.6562,
        398742.0000, 398744.6250, 398749.2188, 398749.8125, 398768.9062,
        398778.3438, 787166.0000, 800779.3125, 800836.8125, 803131.7500,
        814282.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0852e+00, 1.1158e+00, 1.1278e+00, 1.1465e+00, 1.1482e+00,
        1.1502e+00, 1.1994e+00, 1.2451e+00, 1.2727e+00, 3.8193e+05, 3.9449e+05,
        3.9452e+05, 3.9874e+05, 3.9884e+05, 4.1491e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1073e+00, 1.1202e+00, 1.1284e+00, 1.1465e+00, 1.1721e+00,
        1.2055e+00, 1.2267e+00, 1.2602e+00, 1.3018e+00, 3.8192e+05, 3.9449e+05,
        3.9455e+05, 3.9877e+05, 3.9885e+05, 4.1492e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398833.3750, 398835.0625, 398840.5000, 398840.6562,
        398845.0938, 398848.0625, 398869.4375, 398877.9688, 398878.6875,
        398887.5000, 755600.1250, 773432.6875, 784543.0000, 812866.5000,
        814282.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394447.2500, 394460.7812, 394476.6562, 394485.3125,
        394488.6875, 394489.6875, 394496.0312, 394501.6875, 394508.7188,
        394509.0312, 752712.2500, 778008.9375, 784543.0000, 800779.3125,
        818301.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381874.0000, 381880.6875, 381884.6562, 381905.3750,
        381908.0938, 381911.3750, 381918.1250, 381919.8125, 381927.3750,
        381930.9688, 752712.2500, 753130.3750, 773432.6875, 787166.0000,
        799953.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 414886.8125, 414906.4375, 414907.5625, 414915.4688,
        414919.0000, 414921.2188, 414934.2500, 414946.8438, 414949.4688,
        414954.2188, 795313.6250, 799953.1875, 800836.8125, 812866.5000,
        818301.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1762e+00, 1.2057e+00, 1.2348e+00, 1.2421e+00, 1.2451e+00,
        1.2515e+00, 1.2599e+00, 1.2602e+00, 1.4021e+00, 3.8193e+05, 3.9450e+05,
        3.9451e+05, 3.9874e+05, 3.9884e+05, 4.1492e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9096e-01, 1.0305e+00, 1.1158e+00, 1.2267e+00, 1.2421e+00,
        1.2444e+00, 1.2681e+00, 1.2914e+00, 1.3605e+00, 3.8187e+05, 3.9449e+05,
        3.9450e+05, 3.9875e+05, 3.9887e+05, 4.1492e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1737e+00, 1.1746e+00, 1.1994e+00, 1.2055e+00, 1.2206e+00,
        1.2515e+00, 1.2564e+00, 1.2914e+00, 1.3800e+00, 3.8191e+05, 3.9446e+05,
        3.9453e+05, 3.9878e+05, 3.9888e+05, 4.1495e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9096e-01, 1.0087e+00, 1.1278e+00, 1.1762e+00, 1.2424e+00,
        1.2758e+00, 1.3018e+00, 1.3800e+00, 1.4815e+00, 3.8188e+05, 3.9449e+05,
        3.9451e+05, 3.9875e+05, 3.9885e+05, 4.1489e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38189.54', '38192.18', '38192.96', '38191.88', '394516.28', '398748.16', '38193.79', '38193.05', '398855.62', '394486.41', '381906.03', '414924.12', '38194.23', '38188.47', '38191.65', '38189.16']
estimated f for each client, fs: [6, 6, 6, 6, 4, 4, 6, 6, 4, 4, 4, 4, 6, 6, 6, 6]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 9, 11, 4, 17, 14, 3, 5, 20, 16, 13, 19, 6, 10, 2, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:00...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:00, End: 2025-07-22 16:01:00)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 17, 20, 9, 11, 10, 18, 3, 2, 4, 12, 7, 19, 1, 6, 8], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.5172e+05, 7.8876e+05, 3.8648e+05, 3.8647e+05, 3.8647e+05,
         7.8089e+05, 3.8649e+05, 3.8646e+05, 3.8646e+05, 3.8649e+05, 3.8650e+05,
         7.6797e+05, 3.8647e+05, 3.8648e+05, 3.8648e+05],
        [7.5172e+05, 0.0000e+00, 7.8533e+05, 3.9204e+05, 3.9208e+05, 3.9205e+05,
         7.8402e+05, 3.9204e+05, 3.9207e+05, 3.9207e+05, 3.9205e+05, 3.9204e+05,
         8.0300e+05, 3.9208e+05, 3.9204e+05, 3.9207e+05],
        [7.8876e+05, 7.8533e+05, 0.0000e+00, 3.9698e+05, 3.9699e+05, 3.9700e+05,
         7.9787e+05, 3.9697e+05, 3.9699e+05, 3.9701e+05, 3.9696e+05, 3.9699e+05,
         7.7739e+05, 3.9697e+05, 3.9701e+05, 3.9700e+05],
        [3.8648e+05, 3.9204e+05, 3.9698e+05, 0.0000e+00, 1.1225e+00, 1.1813e+00,
         3.8966e+05, 9.0111e-01, 1.0960e+00, 1.0553e+00, 9.1981e-01, 9.8128e-01,
         3.9501e+05, 9.5437e-01, 9.9900e-01, 8.9874e-01],
        [3.8647e+05, 3.9208e+05, 3.9699e+05, 1.1225e+00, 0.0000e+00, 1.6303e+00,
         3.8967e+05, 1.0881e+00, 1.1111e+00, 1.0545e+00, 1.0991e+00, 1.4130e+00,
         3.9502e+05, 9.8479e-01, 1.1182e+00, 1.2112e+00],
        [3.8647e+05, 3.9205e+05, 3.9700e+05, 1.1813e+00, 1.6303e+00, 0.0000e+00,
         3.8966e+05, 1.2627e+00, 1.5564e+00, 1.5041e+00, 1.2025e+00, 6.3805e-01,
         3.9498e+05, 1.5537e+00, 1.4077e+00, 8.8562e-01],
        [7.8089e+05, 7.8402e+05, 7.9787e+05, 3.8966e+05, 3.8967e+05, 3.8966e+05,
         0.0000e+00, 3.8966e+05, 3.8965e+05, 3.8966e+05, 3.8968e+05, 3.8965e+05,
         8.0398e+05, 3.8965e+05, 3.8965e+05, 3.8966e+05],
        [3.8649e+05, 3.9204e+05, 3.9697e+05, 9.0111e-01, 1.0881e+00, 1.2627e+00,
         3.8966e+05, 0.0000e+00, 1.0311e+00, 1.0074e+00, 8.5345e-01, 1.0672e+00,
         3.9498e+05, 9.7840e-01, 9.9098e-01, 9.4597e-01],
        [3.8646e+05, 3.9207e+05, 3.9699e+05, 1.0960e+00, 1.1111e+00, 1.5564e+00,
         3.8965e+05, 1.0311e+00, 0.0000e+00, 1.0671e+00, 1.0478e+00, 1.3530e+00,
         3.9500e+05, 1.0654e+00, 9.8623e-01, 1.1879e+00],
        [3.8646e+05, 3.9207e+05, 3.9701e+05, 1.0553e+00, 1.0545e+00, 1.5041e+00,
         3.8966e+05, 1.0074e+00, 1.0671e+00, 0.0000e+00, 9.6145e-01, 1.2886e+00,
         3.9500e+05, 1.0257e+00, 1.0333e+00, 1.0902e+00],
        [3.8649e+05, 3.9205e+05, 3.9696e+05, 9.1981e-01, 1.0991e+00, 1.2025e+00,
         3.8968e+05, 8.5345e-01, 1.0478e+00, 9.6145e-01, 0.0000e+00, 1.0507e+00,
         3.9501e+05, 1.0194e+00, 9.7488e-01, 9.1794e-01],
        [3.8650e+05, 3.9204e+05, 3.9699e+05, 9.8128e-01, 1.4130e+00, 6.3805e-01,
         3.8965e+05, 1.0672e+00, 1.3530e+00, 1.2886e+00, 1.0507e+00, 0.0000e+00,
         3.9502e+05, 1.3434e+00, 1.1748e+00, 7.4063e-01],
        [7.6797e+05, 8.0300e+05, 7.7739e+05, 3.9501e+05, 3.9502e+05, 3.9498e+05,
         8.0398e+05, 3.9498e+05, 3.9500e+05, 3.9500e+05, 3.9501e+05, 3.9502e+05,
         0.0000e+00, 3.9498e+05, 3.9501e+05, 3.9500e+05],
        [3.8647e+05, 3.9208e+05, 3.9697e+05, 9.5437e-01, 9.8479e-01, 1.5537e+00,
         3.8965e+05, 9.7840e-01, 1.0654e+00, 1.0257e+00, 1.0194e+00, 1.3434e+00,
         3.9498e+05, 0.0000e+00, 9.8201e-01, 1.1040e+00],
        [3.8648e+05, 3.9204e+05, 3.9701e+05, 9.9900e-01, 1.1182e+00, 1.4077e+00,
         3.8965e+05, 9.9098e-01, 9.8623e-01, 1.0333e+00, 9.7488e-01, 1.1748e+00,
         3.9501e+05, 9.8201e-01, 0.0000e+00, 9.8129e-01],
        [3.8648e+05, 3.9207e+05, 3.9700e+05, 8.9874e-01, 1.2112e+00, 8.8562e-01,
         3.8966e+05, 9.4597e-01, 1.1879e+00, 1.0902e+00, 9.1794e-01, 7.4063e-01,
         3.9500e+05, 1.1040e+00, 9.8129e-01, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 386458.4375, 386462.9688, 386465.4375, 386466.6875,
        386472.7188, 386475.0312, 386480.8125, 386481.9062, 386486.9688,
        386487.1562, 386496.1875, 751723.8750, 767968.8750, 780885.1875,
        788759.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 392036.1875, 392037.3750, 392037.7500, 392041.0000,
        392046.0000, 392046.8750, 392067.4062, 392068.2188, 392068.4375,
        392076.3125, 392079.1562, 751723.8750, 784023.1875, 785328.0000,
        803002.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 396961.4375, 396967.9062, 396970.2812, 396983.1250,
        396990.4375, 396991.7188, 396994.9688, 396996.5625, 397002.5000,
        397007.6250, 397007.6875, 777388.5625, 785328.0000, 788759.3125,
        797869.3750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.9874e-01, 9.0111e-01, 9.1981e-01, 9.5437e-01, 9.8128e-01,
        9.9900e-01, 1.0553e+00, 1.0960e+00, 1.1225e+00, 1.1813e+00, 3.8648e+05,
        3.8966e+05, 3.9204e+05, 3.9501e+05, 3.9698e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8479e-01, 1.0545e+00, 1.0881e+00, 1.0991e+00, 1.1111e+00,
        1.1182e+00, 1.1225e+00, 1.2112e+00, 1.4130e+00, 1.6303e+00, 3.8647e+05,
        3.8967e+05, 3.9208e+05, 3.9502e+05, 3.9699e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.3805e-01, 8.8562e-01, 1.1813e+00, 1.2025e+00, 1.2627e+00,
        1.4077e+00, 1.5041e+00, 1.5537e+00, 1.5564e+00, 1.6303e+00, 3.8647e+05,
        3.8966e+05, 3.9205e+05, 3.9498e+05, 3.9700e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389651.3125, 389651.7500, 389652.0938, 389653.9375,
        389658.7188, 389658.7500, 389662.3438, 389663.9375, 389664.0312,
        389672.0000, 389682.0938, 780885.1875, 784023.1875, 797869.3750,
        803982.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.5345e-01, 9.0111e-01, 9.4597e-01, 9.7840e-01, 9.9098e-01,
        1.0074e+00, 1.0311e+00, 1.0672e+00, 1.0881e+00, 1.2627e+00, 3.8649e+05,
        3.8966e+05, 3.9204e+05, 3.9498e+05, 3.9697e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8623e-01, 1.0311e+00, 1.0478e+00, 1.0654e+00, 1.0671e+00,
        1.0960e+00, 1.1111e+00, 1.1879e+00, 1.3530e+00, 1.5564e+00, 3.8646e+05,
        3.8965e+05, 3.9207e+05, 3.9500e+05, 3.9699e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.6145e-01, 1.0074e+00, 1.0257e+00, 1.0333e+00, 1.0545e+00,
        1.0553e+00, 1.0671e+00, 1.0902e+00, 1.2886e+00, 1.5041e+00, 3.8646e+05,
        3.8966e+05, 3.9207e+05, 3.9500e+05, 3.9701e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.5345e-01, 9.1794e-01, 9.1981e-01, 9.6145e-01, 9.7488e-01,
        1.0194e+00, 1.0478e+00, 1.0507e+00, 1.0991e+00, 1.2025e+00, 3.8649e+05,
        3.8968e+05, 3.9205e+05, 3.9501e+05, 3.9696e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.3805e-01, 7.4063e-01, 9.8128e-01, 1.0507e+00, 1.0672e+00,
        1.1748e+00, 1.2886e+00, 1.3434e+00, 1.3530e+00, 1.4130e+00, 3.8650e+05,
        3.8965e+05, 3.9204e+05, 3.9502e+05, 3.9699e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394977.9375, 394981.6250, 394983.0938, 395000.8125,
        395003.1562, 395003.4062, 395008.3438, 395009.5938, 395010.9375,
        395020.5625, 395022.3750, 767968.8750, 777388.5625, 803002.9375,
        803982.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.5437e-01, 9.7840e-01, 9.8201e-01, 9.8479e-01, 1.0194e+00,
        1.0257e+00, 1.0654e+00, 1.1040e+00, 1.3434e+00, 1.5537e+00, 3.8647e+05,
        3.8965e+05, 3.9208e+05, 3.9498e+05, 3.9697e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7488e-01, 9.8129e-01, 9.8201e-01, 9.8623e-01, 9.9098e-01,
        9.9900e-01, 1.0333e+00, 1.1182e+00, 1.1748e+00, 1.4077e+00, 3.8648e+05,
        3.8965e+05, 3.9204e+05, 3.9501e+05, 3.9701e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.4063e-01, 8.8562e-01, 8.9874e-01, 9.1794e-01, 9.4597e-01,
        9.8129e-01, 1.0902e+00, 1.1040e+00, 1.1879e+00, 1.2112e+00, 3.8648e+05,
        3.8966e+05, 3.9207e+05, 3.9500e+05, 3.9700e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['386475.88', '392054.97', '396988.59', '1.01', '1.18', '1.28', '389658.88', '1.01', '1.15', '1.11', '1.00', '1.11', '395002.00', '1.10', '1.06', '1.00']
estimated f for each client, fs: [3, 3, 3, 5, 5, 5, 5, 5, 5, 5, 5, 5, 3, 5, 5, 5]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [16, 17, 20, 9, 11, 10, 18, 3, 2, 4, 12, 7, 19, 1, 6, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0121s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:00...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:00, End: 2025-07-22 16:01:00)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 3, 20, 2, 9, 7, 5, 10, 19, 8, 12, 4, 11, 6, 14, 18], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0032e+05, 7.6006e+05, 4.0035e+05, 4.0036e+05, 4.0033e+05,
         4.0035e+05, 4.0033e+05, 7.8965e+05, 4.0032e+05, 4.0035e+05, 4.0035e+05,
         4.0035e+05, 4.0035e+05, 8.0784e+05, 7.6226e+05],
        [4.0032e+05, 0.0000e+00, 3.7733e+05, 9.6622e-01, 8.6866e-01, 9.3327e-01,
         9.1054e-01, 1.0124e+00, 3.8753e+05, 1.1609e+00, 8.2431e-01, 9.1676e-01,
         1.0207e+00, 9.5795e-01, 3.9872e+05, 3.7652e+05],
        [7.6006e+05, 3.7733e+05, 0.0000e+00, 3.7731e+05, 3.7729e+05, 3.7730e+05,
         3.7730e+05, 3.7732e+05, 7.5904e+05, 3.7732e+05, 3.7730e+05, 3.7731e+05,
         3.7732e+05, 3.7730e+05, 7.9474e+05, 7.4352e+05],
        [4.0035e+05, 9.6622e-01, 3.7731e+05, 0.0000e+00, 9.7317e-01, 1.1343e+00,
         9.8887e-01, 1.2159e+00, 3.8752e+05, 1.4235e+00, 9.7484e-01, 9.6075e-01,
         1.0046e+00, 9.3194e-01, 3.9873e+05, 3.7650e+05],
        [4.0036e+05, 8.6866e-01, 3.7729e+05, 9.7317e-01, 0.0000e+00, 8.0660e-01,
         9.3962e-01, 8.9243e-01, 3.8748e+05, 1.0238e+00, 8.3732e-01, 9.2930e-01,
         1.0233e+00, 9.6072e-01, 3.9876e+05, 3.7650e+05],
        [4.0033e+05, 9.3327e-01, 3.7730e+05, 1.1343e+00, 8.0660e-01, 0.0000e+00,
         1.0614e+00, 5.1021e-01, 3.8750e+05, 6.3492e-01, 8.9011e-01, 1.0295e+00,
         1.1548e+00, 1.0466e+00, 3.9874e+05, 3.7650e+05],
        [4.0035e+05, 9.1054e-01, 3.7730e+05, 9.8887e-01, 9.3962e-01, 1.0614e+00,
         0.0000e+00, 1.1619e+00, 3.8750e+05, 1.3647e+00, 8.7182e-01, 9.1484e-01,
         9.4806e-01, 9.8120e-01, 3.9875e+05, 3.7652e+05],
        [4.0033e+05, 1.0124e+00, 3.7732e+05, 1.2159e+00, 8.9243e-01, 5.1021e-01,
         1.1619e+00, 0.0000e+00, 3.8751e+05, 6.0804e-01, 9.4111e-01, 1.1108e+00,
         1.2617e+00, 1.1352e+00, 3.9875e+05, 3.7651e+05],
        [7.8965e+05, 3.8753e+05, 7.5904e+05, 3.8752e+05, 3.8748e+05, 3.8750e+05,
         3.8750e+05, 3.8751e+05, 0.0000e+00, 3.8751e+05, 3.8752e+05, 3.8749e+05,
         3.8748e+05, 3.8751e+05, 7.8741e+05, 7.5367e+05],
        [4.0032e+05, 1.1609e+00, 3.7732e+05, 1.4235e+00, 1.0238e+00, 6.3492e-01,
         1.3647e+00, 6.0804e-01, 3.8751e+05, 0.0000e+00, 1.1104e+00, 1.2630e+00,
         1.4694e+00, 1.2584e+00, 3.9875e+05, 3.7653e+05],
        [4.0035e+05, 8.2431e-01, 3.7730e+05, 9.7484e-01, 8.3732e-01, 8.9011e-01,
         8.7182e-01, 9.4111e-01, 3.8752e+05, 1.1104e+00, 0.0000e+00, 8.8851e-01,
         1.0155e+00, 9.1535e-01, 3.9872e+05, 3.7651e+05],
        [4.0035e+05, 9.1676e-01, 3.7731e+05, 9.6075e-01, 9.2930e-01, 1.0295e+00,
         9.1484e-01, 1.1108e+00, 3.8749e+05, 1.2630e+00, 8.8851e-01, 0.0000e+00,
         9.6771e-01, 9.7139e-01, 3.9872e+05, 3.7653e+05],
        [4.0035e+05, 1.0207e+00, 3.7732e+05, 1.0046e+00, 1.0233e+00, 1.1548e+00,
         9.4806e-01, 1.2617e+00, 3.8748e+05, 1.4694e+00, 1.0155e+00, 9.6771e-01,
         0.0000e+00, 1.0766e+00, 3.9874e+05, 3.7651e+05],
        [4.0035e+05, 9.5795e-01, 3.7730e+05, 9.3194e-01, 9.6072e-01, 1.0466e+00,
         9.8120e-01, 1.1352e+00, 3.8751e+05, 1.2584e+00, 9.1535e-01, 9.7139e-01,
         1.0766e+00, 0.0000e+00, 3.9875e+05, 3.7652e+05],
        [8.0784e+05, 3.9872e+05, 7.9474e+05, 3.9873e+05, 3.9876e+05, 3.9874e+05,
         3.9875e+05, 3.9875e+05, 7.8741e+05, 3.9875e+05, 3.9872e+05, 3.9872e+05,
         3.9874e+05, 3.9875e+05, 0.0000e+00, 7.7463e+05],
        [7.6226e+05, 3.7652e+05, 7.4352e+05, 3.7650e+05, 3.7650e+05, 3.7650e+05,
         3.7652e+05, 3.7651e+05, 7.5367e+05, 3.7653e+05, 3.7651e+05, 3.7653e+05,
         3.7651e+05, 3.7652e+05, 7.7463e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 400323.5000, 400323.8125, 400326.2812, 400330.4375,
        400347.5625, 400348.0000, 400348.0625, 400350.9062, 400354.0938,
        400354.1875, 400356.9688, 760056.8750, 762261.5625, 789645.8750,
        807835.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.2431e-01, 8.6866e-01, 9.1054e-01, 9.1676e-01, 9.3327e-01,
        9.5795e-01, 9.6622e-01, 1.0124e+00, 1.0207e+00, 1.1609e+00, 3.7652e+05,
        3.7733e+05, 3.8753e+05, 3.9872e+05, 4.0032e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377293.3750, 377296.8125, 377299.3438, 377300.4375,
        377303.8750, 377306.5625, 377311.4062, 377317.6250, 377319.8438,
        377324.8750, 377325.9688, 743520.7500, 759037.2500, 760056.8750,
        794743.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 9.3194e-01, 9.6075e-01, 9.6622e-01, 9.7317e-01, 9.7484e-01,
        9.8887e-01, 1.0046e+00, 1.1343e+00, 1.2159e+00, 1.4235e+00, 3.7650e+05,
        3.7731e+05, 3.8752e+05, 3.9873e+05, 4.0035e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0660e-01, 8.3732e-01, 8.6866e-01, 8.9243e-01, 9.2930e-01,
        9.3962e-01, 9.6072e-01, 9.7317e-01, 1.0233e+00, 1.0238e+00, 3.7650e+05,
        3.7729e+05, 3.8748e+05, 3.9876e+05, 4.0036e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.1021e-01, 6.3492e-01, 8.0660e-01, 8.9011e-01, 9.3327e-01,
        1.0295e+00, 1.0466e+00, 1.0614e+00, 1.1343e+00, 1.1548e+00, 3.7650e+05,
        3.7730e+05, 3.8750e+05, 3.9874e+05, 4.0033e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7182e-01, 9.1054e-01, 9.1484e-01, 9.3962e-01, 9.4806e-01,
        9.8120e-01, 9.8887e-01, 1.0614e+00, 1.1619e+00, 1.3647e+00, 3.7652e+05,
        3.7730e+05, 3.8750e+05, 3.9875e+05, 4.0035e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.1021e-01, 6.0804e-01, 8.9243e-01, 9.4111e-01, 1.0124e+00,
        1.1108e+00, 1.1352e+00, 1.1619e+00, 1.2159e+00, 1.2617e+00, 3.7651e+05,
        3.7732e+05, 3.8751e+05, 3.9875e+05, 4.0033e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387480.8125, 387483.5625, 387488.9688, 387499.5938,
        387500.8438, 387508.8438, 387513.8438, 387514.9062, 387515.0312,
        387518.5625, 387530.8750, 753671.6250, 759037.2500, 787405.5000,
        789645.8750])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 6.0804e-01, 6.3492e-01, 1.0238e+00, 1.1104e+00, 1.1609e+00,
        1.2584e+00, 1.2630e+00, 1.3647e+00, 1.4235e+00, 1.4694e+00, 3.7653e+05,
        3.7732e+05, 3.8751e+05, 3.9875e+05, 4.0032e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.2431e-01, 8.3732e-01, 8.7182e-01, 8.8851e-01, 8.9011e-01,
        9.1535e-01, 9.4111e-01, 9.7484e-01, 1.0155e+00, 1.1104e+00, 3.7651e+05,
        3.7730e+05, 3.8752e+05, 3.9872e+05, 4.0035e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8851e-01, 9.1484e-01, 9.1676e-01, 9.2930e-01, 9.6075e-01,
        9.6771e-01, 9.7139e-01, 1.0295e+00, 1.1108e+00, 1.2630e+00, 3.7653e+05,
        3.7731e+05, 3.8749e+05, 3.9872e+05, 4.0035e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4806e-01, 9.6771e-01, 1.0046e+00, 1.0155e+00, 1.0207e+00,
        1.0233e+00, 1.0766e+00, 1.1548e+00, 1.2617e+00, 1.4694e+00, 3.7651e+05,
        3.7732e+05, 3.8748e+05, 3.9874e+05, 4.0035e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1535e-01, 9.3194e-01, 9.5795e-01, 9.6072e-01, 9.7139e-01,
        9.8120e-01, 1.0466e+00, 1.0766e+00, 1.1352e+00, 1.2584e+00, 3.7652e+05,
        3.7730e+05, 3.8751e+05, 3.9875e+05, 4.0035e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398717.3750, 398721.5625, 398723.7812, 398728.7500,
        398739.5312, 398740.0312, 398746.7812, 398748.8125, 398749.8438,
        398750.3438, 398760.3125, 774628.3125, 787405.5000, 794743.8125,
        807835.9375])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 376497.5625, 376498.4688, 376502.4062, 376509.9062,
        376510.7188, 376513.2812, 376519.5000, 376520.3438, 376522.1250,
        376529.5000, 376531.2188, 743520.7500, 753671.6250, 762261.5625,
        774628.3125])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['400342.12', '0.96', '377309.09', '1.06', '0.93', '0.92', '1.01', '0.98', '387505.03', '1.13', '0.93', '1.00', '1.09', '1.02', '398738.81', '376514.12']
estimated f for each client, fs: [3, 5, 3, 5, 5, 5, 5, 5, 3, 5, 5, 5, 5, 5, 3, 3]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 3, 20, 2, 9, 7, 5, 10, 19, 8, 12, 4, 11, 6, 14, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0122s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:01...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:01, End: 2025-07-22 16:01:01)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 14, 12, 7, 10, 9, 20, 2, 5, 6, 19, 8, 4, 13, 16, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0253e+05, 8.0348e-01, 1.2590e+00, 8.7933e-01, 8.4028e-01,
         4.0246e+05, 9.6022e-01, 8.7913e-01, 8.7983e-01, 3.8759e+05, 8.9092e-01,
         8.7753e-01, 3.9366e+05, 3.8428e+05, 3.8982e+05],
        [4.0253e+05, 0.0000e+00, 4.0252e+05, 4.0251e+05, 4.0252e+05, 4.0251e+05,
         8.0457e+05, 4.0251e+05, 4.0252e+05, 4.0252e+05, 7.9853e+05, 4.0250e+05,
         4.0254e+05, 8.0768e+05, 7.9616e+05, 8.0763e+05],
        [8.0348e-01, 4.0252e+05, 0.0000e+00, 1.2049e+00, 8.4117e-01, 8.1470e-01,
         4.0248e+05, 9.4354e-01, 8.4694e-01, 8.5899e-01, 3.8761e+05, 8.4303e-01,
         8.5405e-01, 3.9368e+05, 3.8428e+05, 3.8982e+05],
        [1.2590e+00, 4.0251e+05, 1.2049e+00, 0.0000e+00, 5.4350e-01, 1.1098e+00,
         4.0247e+05, 1.5551e+00, 1.3727e+00, 1.3858e+00, 3.8759e+05, 5.6440e-01,
         1.4026e+00, 3.9369e+05, 3.8424e+05, 3.8982e+05],
        [8.7933e-01, 4.0252e+05, 8.4117e-01, 5.4350e-01, 0.0000e+00, 7.9345e-01,
         4.0248e+05, 1.0882e+00, 9.7964e-01, 9.4558e-01, 3.8759e+05, 4.4487e-01,
         9.8514e-01, 3.9369e+05, 3.8426e+05, 3.8982e+05],
        [8.4028e-01, 4.0251e+05, 8.1470e-01, 1.1098e+00, 7.9345e-01, 0.0000e+00,
         4.0248e+05, 9.6265e-01, 8.8573e-01, 8.7863e-01, 3.8762e+05, 7.8499e-01,
         9.0660e-01, 3.9371e+05, 3.8429e+05, 3.8982e+05],
        [4.0246e+05, 8.0457e+05, 4.0248e+05, 4.0247e+05, 4.0248e+05, 4.0248e+05,
         0.0000e+00, 4.0245e+05, 4.0248e+05, 4.0246e+05, 7.9474e+05, 4.0248e+05,
         4.0248e+05, 8.0196e+05, 7.5812e+05, 8.2797e+05],
        [9.6022e-01, 4.0251e+05, 9.4354e-01, 1.5551e+00, 1.0882e+00, 9.6265e-01,
         4.0245e+05, 0.0000e+00, 9.8492e-01, 8.4788e-01, 3.8763e+05, 1.1173e+00,
         9.5855e-01, 3.9370e+05, 3.8429e+05, 3.8984e+05],
        [8.7913e-01, 4.0252e+05, 8.4694e-01, 1.3727e+00, 9.7964e-01, 8.8573e-01,
         4.0248e+05, 9.8492e-01, 0.0000e+00, 9.0727e-01, 3.8762e+05, 1.0014e+00,
         8.6279e-01, 3.9367e+05, 3.8428e+05, 3.8982e+05],
        [8.7983e-01, 4.0252e+05, 8.5899e-01, 1.3858e+00, 9.4558e-01, 8.7863e-01,
         4.0246e+05, 8.4788e-01, 9.0727e-01, 0.0000e+00, 3.8762e+05, 9.3408e-01,
         8.5504e-01, 3.9368e+05, 3.8429e+05, 3.8984e+05],
        [3.8759e+05, 7.9853e+05, 3.8761e+05, 3.8759e+05, 3.8759e+05, 3.8762e+05,
         7.9474e+05, 3.8763e+05, 3.8762e+05, 3.8762e+05, 0.0000e+00, 3.8760e+05,
         3.8761e+05, 7.9687e+05, 7.8298e+05, 7.6898e+05],
        [8.9092e-01, 4.0250e+05, 8.4303e-01, 5.6440e-01, 4.4487e-01, 7.8499e-01,
         4.0248e+05, 1.1173e+00, 1.0014e+00, 9.3408e-01, 3.8760e+05, 0.0000e+00,
         9.9405e-01, 3.9369e+05, 3.8426e+05, 3.8984e+05],
        [8.7753e-01, 4.0254e+05, 8.5405e-01, 1.4026e+00, 9.8514e-01, 9.0660e-01,
         4.0248e+05, 9.5855e-01, 8.6279e-01, 8.5504e-01, 3.8761e+05, 9.9405e-01,
         0.0000e+00, 3.9368e+05, 3.8430e+05, 3.8984e+05],
        [3.9366e+05, 8.0768e+05, 3.9368e+05, 3.9369e+05, 3.9369e+05, 3.9371e+05,
         8.0196e+05, 3.9370e+05, 3.9367e+05, 3.9368e+05, 7.9687e+05, 3.9369e+05,
         3.9368e+05, 0.0000e+00, 7.9438e+05, 7.7144e+05],
        [3.8428e+05, 7.9616e+05, 3.8428e+05, 3.8424e+05, 3.8426e+05, 3.8429e+05,
         7.5812e+05, 3.8429e+05, 3.8428e+05, 3.8429e+05, 7.8298e+05, 3.8426e+05,
         3.8430e+05, 7.9438e+05, 0.0000e+00, 7.7818e+05],
        [3.8982e+05, 8.0763e+05, 3.8982e+05, 3.8982e+05, 3.8982e+05, 3.8982e+05,
         8.2797e+05, 3.8984e+05, 3.8982e+05, 3.8984e+05, 7.6898e+05, 3.8984e+05,
         3.8984e+05, 7.7144e+05, 7.7818e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.0348e-01, 8.4028e-01, 8.7753e-01, 8.7913e-01, 8.7933e-01,
        8.7983e-01, 8.9092e-01, 9.6022e-01, 1.2590e+00, 3.8428e+05, 3.8759e+05,
        3.8982e+05, 3.9366e+05, 4.0246e+05, 4.0253e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402501.7812, 402512.5000, 402513.6250, 402513.9062,
        402517.0625, 402521.8125, 402522.0000, 402522.9062, 402530.4688,
        402535.3438, 796160.3125, 798525.7500, 804573.2500, 807631.5000,
        807677.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0348e-01, 8.1470e-01, 8.4117e-01, 8.4303e-01, 8.4694e-01,
        8.5405e-01, 8.5899e-01, 9.4354e-01, 1.2049e+00, 3.8428e+05, 3.8761e+05,
        3.8982e+05, 3.9368e+05, 4.0248e+05, 4.0252e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.4350e-01, 5.6440e-01, 1.1098e+00, 1.2049e+00, 1.2590e+00,
        1.3727e+00, 1.3858e+00, 1.4026e+00, 1.5551e+00, 3.8424e+05, 3.8759e+05,
        3.8982e+05, 3.9369e+05, 4.0247e+05, 4.0251e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.4487e-01, 5.4350e-01, 7.9345e-01, 8.4117e-01, 8.7933e-01,
        9.4558e-01, 9.7964e-01, 9.8514e-01, 1.0882e+00, 3.8426e+05, 3.8759e+05,
        3.8982e+05, 3.9369e+05, 4.0248e+05, 4.0252e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.8499e-01, 7.9345e-01, 8.1470e-01, 8.4028e-01, 8.7863e-01,
        8.8573e-01, 9.0660e-01, 9.6265e-01, 1.1098e+00, 3.8429e+05, 3.8762e+05,
        3.8982e+05, 3.9371e+05, 4.0248e+05, 4.0251e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402447.1875, 402460.6250, 402464.4375, 402473.8750,
        402475.1875, 402475.3750, 402478.1875, 402480.1250, 402480.9062,
        402481.7188, 758119.0000, 794744.1250, 801958.0625, 804573.2500,
        827970.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4788e-01, 9.4354e-01, 9.5855e-01, 9.6022e-01, 9.6265e-01,
        9.8492e-01, 1.0882e+00, 1.1173e+00, 1.5551e+00, 3.8429e+05, 3.8763e+05,
        3.8984e+05, 3.9370e+05, 4.0245e+05, 4.0251e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4694e-01, 8.6279e-01, 8.7913e-01, 8.8573e-01, 9.0727e-01,
        9.7964e-01, 9.8492e-01, 1.0014e+00, 1.3727e+00, 3.8428e+05, 3.8762e+05,
        3.8982e+05, 3.9367e+05, 4.0248e+05, 4.0252e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4788e-01, 8.5504e-01, 8.5899e-01, 8.7863e-01, 8.7983e-01,
        9.0727e-01, 9.3408e-01, 9.4558e-01, 1.3858e+00, 3.8429e+05, 3.8762e+05,
        3.8984e+05, 3.9368e+05, 4.0246e+05, 4.0252e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387591.1875, 387593.8750, 387594.5312, 387602.7812,
        387605.3125, 387610.1875, 387616.1562, 387622.0312, 387623.1250,
        387631.7812, 768984.1875, 782975.4375, 794744.1250, 796866.7500,
        798525.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.4487e-01, 5.6440e-01, 7.8499e-01, 8.4303e-01, 8.9092e-01,
        9.3408e-01, 9.9405e-01, 1.0014e+00, 1.1173e+00, 3.8426e+05, 3.8760e+05,
        3.8984e+05, 3.9369e+05, 4.0248e+05, 4.0250e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.5405e-01, 8.5504e-01, 8.6279e-01, 8.7753e-01, 9.0660e-01,
        9.5855e-01, 9.8514e-01, 9.9405e-01, 1.4026e+00, 3.8430e+05, 3.8761e+05,
        3.8984e+05, 3.9368e+05, 4.0248e+05, 4.0254e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393655.8750, 393671.8438, 393679.7188, 393683.7500,
        393684.6875, 393688.8125, 393690.6250, 393691.2812, 393703.7188,
        393712.2500, 771440.8750, 794376.6875, 796866.7500, 801958.0625,
        807677.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384243.0000, 384258.2500, 384263.3750, 384275.3750,
        384281.9375, 384282.7500, 384288.4375, 384289.5938, 384293.0625,
        384298.0000, 758119.0000, 778175.5000, 782975.4375, 794376.6875,
        796160.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389818.6250, 389818.8125, 389819.1250, 389820.6250,
        389820.9375, 389824.0625, 389837.1250, 389838.6875, 389840.8125,
        389843.5312, 768984.1875, 771440.8750, 778175.5000, 807631.5000,
        827970.3750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38429.10', '402519.16', '38428.99', '38425.34', '38426.57', '38429.76', '402471.75', '38429.79', '38428.41', '38430.15', '387609.09', '38427.10', '38430.67', '393686.28', '384277.38', '389828.22']
estimated f for each client, fs: [6, 4, 6, 6, 6, 6, 4, 6, 6, 6, 4, 6, 6, 4, 4, 4]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 14, 12, 7, 10, 9, 20, 2, 5, 6, 19, 8, 4, 13, 16, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0192s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:02...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:02, End: 2025-07-22 16:01:02)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 16, 5, 19, 7, 3, 10, 17, 18, 11, 13, 20, 1, 6, 4, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8610e+05, 9.4997e-01, 4.1516e+05, 1.1886e+00, 9.0306e-01,
         8.8293e-01, 3.9756e+05, 3.8351e+05, 9.4394e-01, 3.8326e+05, 3.9380e+05,
         9.0354e-01, 8.0083e-01, 9.0924e-01, 3.7255e+05],
        [3.8610e+05, 0.0000e+00, 3.8608e+05, 8.0628e+05, 3.8611e+05, 3.8608e+05,
         3.8608e+05, 7.7958e+05, 7.6796e+05, 3.8610e+05, 7.9597e+05, 7.8194e+05,
         3.8608e+05, 3.8609e+05, 3.8609e+05, 7.3039e+05],
        [9.4997e-01, 3.8608e+05, 0.0000e+00, 4.1517e+05, 1.2057e+00, 8.9264e-01,
         9.0026e-01, 3.9752e+05, 3.8353e+05, 9.0093e-01, 3.8327e+05, 3.9382e+05,
         8.6799e-01, 8.9991e-01, 8.4868e-01, 3.7257e+05],
        [4.1516e+05, 8.0628e+05, 4.1517e+05, 0.0000e+00, 4.1516e+05, 4.1516e+05,
         4.1516e+05, 8.1262e+05, 7.9356e+05, 4.1514e+05, 7.9887e+05, 8.1604e+05,
         4.1514e+05, 4.1516e+05, 4.1514e+05, 7.8527e+05],
        [1.1886e+00, 3.8611e+05, 1.2057e+00, 4.1516e+05, 0.0000e+00, 1.0061e+00,
         4.4067e-01, 3.9751e+05, 3.8350e+05, 1.2834e+00, 3.8324e+05, 3.9379e+05,
         1.2195e+00, 1.0944e+00, 1.1716e+00, 3.7256e+05],
        [9.0306e-01, 3.8608e+05, 8.9264e-01, 4.1516e+05, 1.0061e+00, 0.0000e+00,
         7.3312e-01, 3.9751e+05, 3.8352e+05, 9.2193e-01, 3.8325e+05, 3.9378e+05,
         8.5272e-01, 8.3082e-01, 8.4199e-01, 3.7257e+05],
        [8.8293e-01, 3.8608e+05, 9.0026e-01, 4.1516e+05, 4.4067e-01, 7.3312e-01,
         0.0000e+00, 3.9752e+05, 3.8349e+05, 9.3219e-01, 3.8324e+05, 3.9380e+05,
         8.8529e-01, 7.7146e-01, 8.5843e-01, 3.7257e+05],
        [3.9756e+05, 7.7958e+05, 3.9752e+05, 8.1262e+05, 3.9751e+05, 3.9751e+05,
         3.9752e+05, 0.0000e+00, 7.7332e+05, 3.9753e+05, 7.7789e+05, 8.1730e+05,
         3.9752e+05, 3.9754e+05, 3.9753e+05, 7.6615e+05],
        [3.8351e+05, 7.6796e+05, 3.8353e+05, 7.9356e+05, 3.8350e+05, 3.8352e+05,
         3.8349e+05, 7.7332e+05, 0.0000e+00, 3.8349e+05, 7.7202e+05, 7.9076e+05,
         3.8349e+05, 3.8353e+05, 3.8352e+05, 7.5465e+05],
        [9.4394e-01, 3.8610e+05, 9.0093e-01, 4.1514e+05, 1.2834e+00, 9.2193e-01,
         9.3219e-01, 3.9753e+05, 3.8349e+05, 0.0000e+00, 3.8327e+05, 3.9379e+05,
         8.6629e-01, 9.4261e-01, 8.7551e-01, 3.7256e+05],
        [3.8326e+05, 7.9597e+05, 3.8327e+05, 7.9887e+05, 3.8324e+05, 3.8325e+05,
         3.8324e+05, 7.7789e+05, 7.7202e+05, 3.8327e+05, 0.0000e+00, 7.7583e+05,
         3.8326e+05, 3.8325e+05, 3.8323e+05, 7.6166e+05],
        [3.9380e+05, 7.8194e+05, 3.9382e+05, 8.1604e+05, 3.9379e+05, 3.9378e+05,
         3.9380e+05, 8.1730e+05, 7.9076e+05, 3.9379e+05, 7.7583e+05, 0.0000e+00,
         3.9381e+05, 3.9381e+05, 3.9381e+05, 7.5942e+05],
        [9.0354e-01, 3.8608e+05, 8.6799e-01, 4.1514e+05, 1.2195e+00, 8.5272e-01,
         8.8529e-01, 3.9752e+05, 3.8349e+05, 8.6629e-01, 3.8326e+05, 3.9381e+05,
         0.0000e+00, 8.1929e-01, 8.5320e-01, 3.7259e+05],
        [8.0083e-01, 3.8609e+05, 8.9991e-01, 4.1516e+05, 1.0944e+00, 8.3082e-01,
         7.7146e-01, 3.9754e+05, 3.8353e+05, 9.4261e-01, 3.8325e+05, 3.9381e+05,
         8.1929e-01, 0.0000e+00, 8.4398e-01, 3.7258e+05],
        [9.0924e-01, 3.8609e+05, 8.4868e-01, 4.1514e+05, 1.1716e+00, 8.4199e-01,
         8.5843e-01, 3.9753e+05, 3.8352e+05, 8.7551e-01, 3.8323e+05, 3.9381e+05,
         8.5320e-01, 8.4398e-01, 0.0000e+00, 3.7258e+05],
        [3.7255e+05, 7.3039e+05, 3.7257e+05, 7.8527e+05, 3.7256e+05, 3.7257e+05,
         3.7257e+05, 7.6615e+05, 7.5465e+05, 3.7256e+05, 7.6166e+05, 7.5942e+05,
         3.7259e+05, 3.7258e+05, 3.7258e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.0083e-01, 8.8293e-01, 9.0306e-01, 9.0354e-01, 9.0924e-01,
        9.4394e-01, 9.4997e-01, 1.1886e+00, 3.7255e+05, 3.8326e+05, 3.8351e+05,
        3.8610e+05, 3.9380e+05, 3.9756e+05, 4.1516e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386075.3125, 386078.4375, 386083.7500, 386084.1562,
        386088.1875, 386093.5625, 386096.6875, 386099.0938, 386107.3750,
        730389.3125, 767963.7500, 779578.8125, 781937.8125, 795971.1250,
        806283.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4868e-01, 8.6799e-01, 8.9264e-01, 8.9991e-01, 9.0026e-01,
        9.0093e-01, 9.4997e-01, 1.2057e+00, 3.7257e+05, 3.8327e+05, 3.8353e+05,
        3.8608e+05, 3.9382e+05, 3.9752e+05, 4.1517e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 415136.3125, 415144.3125, 415144.7812, 415158.4375,
        415159.3438, 415161.6875, 415163.4062, 415164.4062, 415165.1250,
        785272.7500, 793564.2500, 798874.4375, 806283.2500, 812618.3125,
        816039.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.4067e-01, 1.0061e+00, 1.0944e+00, 1.1716e+00, 1.1886e+00,
        1.2057e+00, 1.2195e+00, 1.2834e+00, 3.7256e+05, 3.8324e+05, 3.8350e+05,
        3.8611e+05, 3.9379e+05, 3.9751e+05, 4.1516e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.3312e-01, 8.3082e-01, 8.4199e-01, 8.5272e-01, 8.9264e-01,
        9.0306e-01, 9.2193e-01, 1.0061e+00, 3.7257e+05, 3.8325e+05, 3.8352e+05,
        3.8608e+05, 3.9378e+05, 3.9751e+05, 4.1516e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.4067e-01, 7.3312e-01, 7.7146e-01, 8.5843e-01, 8.8293e-01,
        8.8529e-01, 9.0026e-01, 9.3219e-01, 3.7257e+05, 3.8324e+05, 3.8349e+05,
        3.8608e+05, 3.9380e+05, 3.9752e+05, 4.1516e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397505.8750, 397506.5625, 397515.6875, 397518.5625,
        397520.2500, 397529.9375, 397531.9688, 397543.3125, 397560.9688,
        766148.4375, 773320.5000, 777892.8750, 779578.8125, 812618.3125,
        817296.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383492.1562, 383493.1875, 383493.6562, 383497.6875,
        383512.6875, 383516.4062, 383519.0625, 383527.4375, 383531.8438,
        754652.8125, 767963.7500, 772023.2500, 773320.5000, 790755.4375,
        793564.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6629e-01, 8.7551e-01, 9.0093e-01, 9.2193e-01, 9.3219e-01,
        9.4261e-01, 9.4394e-01, 1.2834e+00, 3.7256e+05, 3.8327e+05, 3.8349e+05,
        3.8610e+05, 3.9379e+05, 3.9753e+05, 4.1514e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383234.5312, 383239.1250, 383240.5000, 383249.0312,
        383250.7812, 383256.7812, 383257.0312, 383265.8125, 383268.9375,
        761656.3750, 772023.2500, 775827.1875, 777892.8750, 795971.1250,
        798874.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393779.8750, 393788.1875, 393792.2812, 393795.6875,
        393796.7188, 393808.7188, 393809.4375, 393813.5000, 393817.3125,
        759416.0000, 775827.1875, 781937.8125, 790755.4375, 816039.3125,
        817296.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.1929e-01, 8.5272e-01, 8.5320e-01, 8.6629e-01, 8.6799e-01,
        8.8529e-01, 9.0354e-01, 1.2195e+00, 3.7259e+05, 3.8326e+05, 3.8349e+05,
        3.8608e+05, 3.9381e+05, 3.9752e+05, 4.1514e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.7146e-01, 8.0083e-01, 8.1929e-01, 8.3082e-01, 8.4398e-01,
        8.9991e-01, 9.4261e-01, 1.0944e+00, 3.7258e+05, 3.8325e+05, 3.8353e+05,
        3.8609e+05, 3.9381e+05, 3.9754e+05, 4.1516e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4199e-01, 8.4398e-01, 8.4868e-01, 8.5320e-01, 8.5843e-01,
        8.7551e-01, 9.0924e-01, 1.1716e+00, 3.7258e+05, 3.8323e+05, 3.8352e+05,
        3.8609e+05, 3.9381e+05, 3.9753e+05, 4.1514e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 372552.6875, 372561.4375, 372564.9688, 372573.5000,
        372574.5625, 372574.7812, 372578.8125, 372580.8125, 372586.0000,
        730389.3125, 754652.8125, 759416.0000, 761656.3750, 766148.4375,
        785272.7500])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75581.72', '420519.59', '75584.67', '452167.06', '75581.42', '75583.05', '75582.02', '434388.16', '420623.69', '75583.80', '421091.91', '430361.81', '75585.01', '75583.66', '75582.27', '408353.69']
estimated f for each client, fs: [7, 5, 7, 5, 7, 7, 7, 5, 5, 7, 5, 5, 7, 7, 7, 5]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 16, 5, 19, 7, 3, 10, 17, 18, 11, 13, 20, 1, 6, 4, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0125s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:02...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:02, End: 2025-07-22 16:01:02)
start time is: 99026435880641, end time is: 99044571563499
The total time is: 18135682858ns.

 ------- aggregate method: rkrum, random_seed: 300 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 10, 8, 11, 7, 5, 13, 14, 4, 6, 16, 18, 1, 19, 3, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9339e+05, 3.9337e+05, 3.9339e+05, 3.9335e+05, 3.9341e+05,
         7.7204e+05, 8.0135e+05, 3.9341e+05, 3.9336e+05, 7.8334e+05, 7.9129e+05,
         3.9339e+05, 7.9947e+05, 3.9337e+05, 3.9329e+05],
        [3.9339e+05, 0.0000e+00, 3.7957e+00, 4.4532e+00, 3.5433e+00, 3.7027e+00,
         4.0037e+05, 3.9952e+05, 4.8420e+00, 5.3398e+00, 4.0250e+05, 3.7540e+05,
         3.8781e+00, 3.9635e+05, 3.6720e+00, 4.8822e+00],
        [3.9337e+05, 3.7957e+00, 0.0000e+00, 3.8778e+00, 4.2664e+00, 3.8520e+00,
         4.0037e+05, 3.9950e+05, 4.3798e+00, 4.6733e+00, 4.0249e+05, 3.7537e+05,
         4.0019e+00, 3.9634e+05, 3.8339e+00, 4.2758e+00],
        [3.9339e+05, 4.4532e+00, 3.8778e+00, 0.0000e+00, 4.4756e+00, 3.4997e+00,
         4.0037e+05, 3.9956e+05, 3.8527e+00, 4.1596e+00, 4.0253e+05, 3.7533e+05,
         3.6953e+00, 3.9637e+05, 4.2451e+00, 3.8024e+00],
        [3.9335e+05, 3.5433e+00, 4.2664e+00, 4.4756e+00, 0.0000e+00, 3.6665e+00,
         4.0038e+05, 3.9954e+05, 4.7911e+00, 5.3955e+00, 4.0251e+05, 3.7535e+05,
         4.1201e+00, 3.9631e+05, 3.9636e+00, 4.4400e+00],
        [3.9341e+05, 3.7027e+00, 3.8520e+00, 3.4997e+00, 3.6665e+00, 0.0000e+00,
         4.0040e+05, 3.9959e+05, 3.7234e+00, 4.3714e+00, 4.0256e+05, 3.7534e+05,
         3.4391e+00, 3.9636e+05, 3.4093e+00, 4.3448e+00],
        [7.7204e+05, 4.0037e+05, 4.0037e+05, 4.0037e+05, 4.0038e+05, 4.0040e+05,
         0.0000e+00, 8.0418e+05, 4.0039e+05, 4.0040e+05, 8.1161e+05, 7.8134e+05,
         4.0038e+05, 7.9533e+05, 4.0035e+05, 4.0036e+05],
        [8.0135e+05, 3.9952e+05, 3.9950e+05, 3.9956e+05, 3.9954e+05, 3.9959e+05,
         8.0418e+05, 0.0000e+00, 3.9953e+05, 3.9954e+05, 7.9867e+05, 7.5897e+05,
         3.9951e+05, 8.1858e+05, 3.9950e+05, 3.9953e+05],
        [3.9341e+05, 4.8420e+00, 4.3798e+00, 3.8527e+00, 4.7911e+00, 3.7234e+00,
         4.0039e+05, 3.9953e+05, 0.0000e+00, 3.6679e+00, 4.0257e+05, 3.7531e+05,
         3.7857e+00, 3.9634e+05, 3.9107e+00, 4.4036e+00],
        [3.9336e+05, 5.3398e+00, 4.6733e+00, 4.1596e+00, 5.3955e+00, 4.3714e+00,
         4.0040e+05, 3.9954e+05, 3.6679e+00, 0.0000e+00, 4.0258e+05, 3.7536e+05,
         4.3376e+00, 3.9636e+05, 4.2487e+00, 4.8039e+00],
        [7.8334e+05, 4.0250e+05, 4.0249e+05, 4.0253e+05, 4.0251e+05, 4.0256e+05,
         8.1161e+05, 7.9867e+05, 4.0257e+05, 4.0258e+05, 0.0000e+00, 7.9700e+05,
         4.0255e+05, 7.9486e+05, 4.0254e+05, 4.0258e+05],
        [7.9129e+05, 3.7540e+05, 3.7537e+05, 3.7533e+05, 3.7535e+05, 3.7534e+05,
         7.8134e+05, 7.5897e+05, 3.7531e+05, 3.7536e+05, 7.9700e+05, 0.0000e+00,
         3.7533e+05, 7.6600e+05, 3.7531e+05, 3.7537e+05],
        [3.9339e+05, 3.8781e+00, 4.0019e+00, 3.6953e+00, 4.1201e+00, 3.4391e+00,
         4.0038e+05, 3.9951e+05, 3.7857e+00, 4.3376e+00, 4.0255e+05, 3.7533e+05,
         0.0000e+00, 3.9635e+05, 3.5857e+00, 4.3167e+00],
        [7.9947e+05, 3.9635e+05, 3.9634e+05, 3.9637e+05, 3.9631e+05, 3.9636e+05,
         7.9533e+05, 8.1858e+05, 3.9634e+05, 3.9636e+05, 7.9486e+05, 7.6600e+05,
         3.9635e+05, 0.0000e+00, 3.9633e+05, 3.9632e+05],
        [3.9337e+05, 3.6720e+00, 3.8339e+00, 4.2451e+00, 3.9636e+00, 3.4093e+00,
         4.0035e+05, 3.9950e+05, 3.9107e+00, 4.2487e+00, 4.0254e+05, 3.7531e+05,
         3.5857e+00, 3.9633e+05, 0.0000e+00, 4.6301e+00],
        [3.9329e+05, 4.8822e+00, 4.2758e+00, 3.8024e+00, 4.4400e+00, 4.3448e+00,
         4.0036e+05, 3.9953e+05, 4.4036e+00, 4.8039e+00, 4.0258e+05, 3.7537e+05,
         4.3167e+00, 3.9632e+05, 4.6301e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 393294.0000, 393346.1250, 393361.7812, 393365.4375,
        393371.8125, 393385.6562, 393387.5625, 393391.3438, 393406.3750,
        393409.1250, 772042.3750, 783344.3750, 791293.6875, 799471.6250,
        801350.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5433e+00, 3.6720e+00, 3.7027e+00, 3.7957e+00, 3.8781e+00,
        4.4532e+00, 4.8420e+00, 4.8822e+00, 5.3398e+00, 3.7540e+05, 3.9339e+05,
        3.9635e+05, 3.9952e+05, 4.0037e+05, 4.0250e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.7957e+00, 3.8339e+00, 3.8520e+00, 3.8778e+00, 4.0019e+00,
        4.2664e+00, 4.2758e+00, 4.3798e+00, 4.6733e+00, 3.7537e+05, 3.9337e+05,
        3.9634e+05, 3.9950e+05, 4.0037e+05, 4.0249e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4997e+00, 3.6953e+00, 3.8024e+00, 3.8527e+00, 3.8778e+00,
        4.1596e+00, 4.2451e+00, 4.4532e+00, 4.4756e+00, 3.7533e+05, 3.9339e+05,
        3.9637e+05, 3.9956e+05, 4.0037e+05, 4.0253e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.5433e+00, 3.6665e+00, 3.9636e+00, 4.1201e+00, 4.2664e+00,
        4.4400e+00, 4.4756e+00, 4.7911e+00, 5.3955e+00, 3.7535e+05, 3.9335e+05,
        3.9631e+05, 3.9954e+05, 4.0038e+05, 4.0251e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4093e+00, 3.4391e+00, 3.4997e+00, 3.6665e+00, 3.7027e+00,
        3.7234e+00, 3.8520e+00, 4.3448e+00, 4.3714e+00, 3.7534e+05, 3.9341e+05,
        3.9636e+05, 3.9959e+05, 4.0040e+05, 4.0256e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400348.7500, 400358.4375, 400366.5000, 400367.9375,
        400370.1562, 400379.6562, 400380.3438, 400387.1875, 400396.2500,
        400404.8750, 772042.3750, 781339.7500, 795332.1250, 804182.9375,
        811608.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399499.1875, 399503.5312, 399508.6250, 399519.6250,
        399530.1562, 399534.0938, 399538.0938, 399541.0312, 399559.2188,
        399588.7500, 758972.2500, 798674.5000, 801350.2500, 804182.9375,
        818575.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6679e+00, 3.7234e+00, 3.7857e+00, 3.8527e+00, 3.9107e+00,
        4.3798e+00, 4.4036e+00, 4.7911e+00, 4.8420e+00, 3.7531e+05, 3.9341e+05,
        3.9634e+05, 3.9953e+05, 4.0039e+05, 4.0257e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.6679e+00, 4.1596e+00, 4.2487e+00, 4.3376e+00, 4.3714e+00,
        4.6733e+00, 4.8039e+00, 5.3398e+00, 5.3955e+00, 3.7536e+05, 3.9336e+05,
        3.9636e+05, 3.9954e+05, 4.0040e+05, 4.0258e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402494.1875, 402504.4375, 402509.0312, 402527.9688,
        402535.0000, 402553.4062, 402558.6875, 402568.3438, 402577.5625,
        402580.3750, 783344.3750, 794858.4375, 797000.9375, 798674.5000,
        811608.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 375307.0938, 375314.2812, 375328.1250, 375331.6875,
        375335.9688, 375349.2812, 375359.4688, 375366.5625, 375368.2500,
        375395.4375, 758972.2500, 765997.6250, 781339.7500, 791293.6875,
        797000.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4391e+00, 3.5857e+00, 3.6953e+00, 3.7857e+00, 3.8781e+00,
        4.0019e+00, 4.1201e+00, 4.3167e+00, 4.3376e+00, 3.7533e+05, 3.9339e+05,
        3.9635e+05, 3.9951e+05, 4.0038e+05, 4.0255e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396313.1250, 396320.1875, 396325.0625, 396337.0312,
        396341.1250, 396352.4688, 396354.5312, 396355.8125, 396357.7188,
        396374.1250, 765997.6250, 794858.4375, 795332.1250, 799471.6250,
        818575.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.4093e+00, 3.5857e+00, 3.6720e+00, 3.8339e+00, 3.9107e+00,
        3.9636e+00, 4.2451e+00, 4.2487e+00, 4.6301e+00, 3.7531e+05, 3.9337e+05,
        3.9633e+05, 3.9950e+05, 4.0035e+05, 4.0254e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 3.8024e+00, 4.2758e+00, 4.3167e+00, 4.3448e+00, 4.4036e+00,
        4.4400e+00, 4.6301e+00, 4.8039e+00, 4.8822e+00, 3.7537e+05, 3.9329e+05,
        3.9632e+05, 3.9953e+05, 4.0036e+05, 4.0258e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['393371.91', '37543.35', '37540.52', '37536.42', '37538.79', '37536.99', '400376.03', '399532.22', '37535.16', '37540.05', '402540.91', '375345.59', '37536.68', '396343.12', '37534.26', '37540.65']
estimated f for each client, fs: [4, 6, 6, 6, 6, 6, 4, 4, 6, 6, 4, 5, 6, 4, 6, 6]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [20, 10, 8, 11, 7, 5, 13, 14, 4, 6, 16, 18, 1, 19, 3, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:03...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 16:01:03, End: 2025-07-22 16:01:03)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 12, 17, 19, 1, 10, 7, 20, 15, 18, 13, 3, 9, 6, 16, 11], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 2.0582e+00, 3.9881e+05, 3.8627e+05, 2.0697e+00, 1.9889e+00,
         2.0943e+00, 3.7313e+05, 3.9614e+05, 3.9218e+05, 3.8468e+05, 2.2255e+00,
         2.0334e+00, 1.9250e+00, 3.8411e+05, 1.9765e+00],
        [2.0582e+00, 0.0000e+00, 3.9879e+05, 3.8629e+05, 1.9269e+00, 1.8192e+00,
         1.9069e+00, 3.7317e+05, 3.9615e+05, 3.9217e+05, 3.8464e+05, 2.0380e+00,
         1.9342e+00, 1.9514e+00, 3.8417e+05, 1.9447e+00],
        [3.9881e+05, 3.9879e+05, 0.0000e+00, 7.9887e+05, 3.9879e+05, 3.9879e+05,
         3.9878e+05, 7.6377e+05, 7.9623e+05, 7.8725e+05, 7.5968e+05, 3.9879e+05,
         3.9877e+05, 3.9879e+05, 7.7860e+05, 3.9881e+05],
        [3.8627e+05, 3.8629e+05, 7.9887e+05, 0.0000e+00, 3.8627e+05, 3.8630e+05,
         3.8631e+05, 7.4837e+05, 7.8482e+05, 8.0451e+05, 7.7802e+05, 3.8629e+05,
         3.8628e+05, 3.8628e+05, 7.6222e+05, 3.8628e+05],
        [2.0697e+00, 1.9269e+00, 3.9879e+05, 3.8627e+05, 0.0000e+00, 1.8656e+00,
         1.9473e+00, 3.7316e+05, 3.9612e+05, 3.9220e+05, 3.8467e+05, 2.4622e+00,
         1.8709e+00, 1.7725e+00, 3.8409e+05, 1.8732e+00],
        [1.9889e+00, 1.8192e+00, 3.9879e+05, 3.8630e+05, 1.8656e+00, 0.0000e+00,
         1.8841e+00, 3.7314e+05, 3.9614e+05, 3.9217e+05, 3.8465e+05, 2.1460e+00,
         1.8298e+00, 1.9928e+00, 3.8414e+05, 1.9109e+00],
        [2.0943e+00, 1.9069e+00, 3.9878e+05, 3.8631e+05, 1.9473e+00, 1.8841e+00,
         0.0000e+00, 3.7313e+05, 3.9617e+05, 3.9222e+05, 3.8461e+05, 2.2845e+00,
         1.9691e+00, 2.0059e+00, 3.8412e+05, 1.8144e+00],
        [3.7313e+05, 3.7317e+05, 7.6377e+05, 7.4837e+05, 3.7316e+05, 3.7314e+05,
         3.7313e+05, 0.0000e+00, 7.8048e+05, 7.6451e+05, 7.4532e+05, 3.7312e+05,
         3.7315e+05, 3.7313e+05, 7.5911e+05, 3.7313e+05],
        [3.9614e+05, 3.9615e+05, 7.9623e+05, 7.8482e+05, 3.9612e+05, 3.9614e+05,
         3.9617e+05, 7.8048e+05, 0.0000e+00, 7.8799e+05, 7.8200e+05, 3.9616e+05,
         3.9618e+05, 3.9618e+05, 7.8142e+05, 3.9615e+05],
        [3.9218e+05, 3.9217e+05, 7.8725e+05, 8.0451e+05, 3.9220e+05, 3.9217e+05,
         3.9222e+05, 7.6451e+05, 7.8799e+05, 0.0000e+00, 7.6870e+05, 3.9218e+05,
         3.9215e+05, 3.9219e+05, 7.9708e+05, 3.9214e+05],
        [3.8468e+05, 3.8464e+05, 7.5968e+05, 7.7802e+05, 3.8467e+05, 3.8465e+05,
         3.8461e+05, 7.4532e+05, 7.8200e+05, 7.6870e+05, 0.0000e+00, 3.8464e+05,
         3.8467e+05, 3.8466e+05, 7.6272e+05, 3.8465e+05],
        [2.2255e+00, 2.0380e+00, 3.9879e+05, 3.8629e+05, 2.4622e+00, 2.1460e+00,
         2.2845e+00, 3.7312e+05, 3.9616e+05, 3.9218e+05, 3.8464e+05, 0.0000e+00,
         2.1053e+00, 2.4835e+00, 3.8416e+05, 2.3991e+00],
        [2.0334e+00, 1.9342e+00, 3.9877e+05, 3.8628e+05, 1.8709e+00, 1.8298e+00,
         1.9691e+00, 3.7315e+05, 3.9618e+05, 3.9215e+05, 3.8467e+05, 2.1053e+00,
         0.0000e+00, 1.8664e+00, 3.8411e+05, 1.8797e+00],
        [1.9250e+00, 1.9514e+00, 3.9879e+05, 3.8628e+05, 1.7725e+00, 1.9928e+00,
         2.0059e+00, 3.7313e+05, 3.9618e+05, 3.9219e+05, 3.8466e+05, 2.4835e+00,
         1.8664e+00, 0.0000e+00, 3.8411e+05, 1.9602e+00],
        [3.8411e+05, 3.8417e+05, 7.7860e+05, 7.6222e+05, 3.8409e+05, 3.8414e+05,
         3.8412e+05, 7.5911e+05, 7.8142e+05, 7.9708e+05, 7.6272e+05, 3.8416e+05,
         3.8411e+05, 3.8411e+05, 0.0000e+00, 3.8412e+05],
        [1.9765e+00, 1.9447e+00, 3.9881e+05, 3.8628e+05, 1.8732e+00, 1.9109e+00,
         1.8144e+00, 3.7313e+05, 3.9615e+05, 3.9214e+05, 3.8465e+05, 2.3991e+00,
         1.8797e+00, 1.9602e+00, 3.8412e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.9250e+00, 1.9765e+00, 1.9889e+00, 2.0334e+00, 2.0582e+00,
        2.0697e+00, 2.0943e+00, 2.2255e+00, 3.7313e+05, 3.8411e+05, 3.8468e+05,
        3.8627e+05, 3.9218e+05, 3.9614e+05, 3.9881e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8192e+00, 1.9069e+00, 1.9269e+00, 1.9342e+00, 1.9447e+00,
        1.9514e+00, 2.0380e+00, 2.0582e+00, 3.7317e+05, 3.8417e+05, 3.8464e+05,
        3.8629e+05, 3.9217e+05, 3.9615e+05, 3.9879e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398771.1562, 398783.1875, 398787.3125, 398789.0000,
        398791.4062, 398793.5000, 398794.8438, 398809.5312, 398810.0625,
        759678.0000, 763772.6875, 778602.0625, 787254.5000, 796233.1875,
        798865.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386265.0938, 386271.0000, 386276.0000, 386281.8750,
        386284.2500, 386287.4375, 386292.6562, 386297.0625, 386311.9062,
        748365.3125, 762216.6875, 778019.7500, 784820.8750, 798865.8125,
        804513.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7725e+00, 1.8656e+00, 1.8709e+00, 1.8732e+00, 1.9269e+00,
        1.9473e+00, 2.0697e+00, 2.4622e+00, 3.7316e+05, 3.8409e+05, 3.8467e+05,
        3.8627e+05, 3.9220e+05, 3.9612e+05, 3.9879e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8192e+00, 1.8298e+00, 1.8656e+00, 1.8841e+00, 1.9109e+00,
        1.9889e+00, 1.9928e+00, 2.1460e+00, 3.7314e+05, 3.8414e+05, 3.8465e+05,
        3.8630e+05, 3.9217e+05, 3.9614e+05, 3.9879e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8144e+00, 1.8841e+00, 1.9069e+00, 1.9473e+00, 1.9691e+00,
        2.0059e+00, 2.0943e+00, 2.2845e+00, 3.7313e+05, 3.8412e+05, 3.8461e+05,
        3.8631e+05, 3.9222e+05, 3.9617e+05, 3.9878e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 373123.4375, 373129.6562, 373130.8438, 373132.1250,
        373134.5000, 373135.2812, 373145.9375, 373155.3125, 373165.2188,
        745323.3750, 748365.3125, 759113.3750, 763772.6875, 764507.6875,
        780482.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396120.8438, 396135.2500, 396144.5312, 396147.0625,
        396147.4375, 396164.1875, 396166.7500, 396175.9062, 396176.8750,
        780482.6875, 781416.7500, 782000.3125, 784820.8750, 787985.5000,
        796233.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392140.3438, 392153.5000, 392168.5312, 392169.8125,
        392176.5625, 392182.5938, 392185.8750, 392199.8438, 392218.5000,
        764507.6875, 768700.8125, 787254.5000, 787985.5000, 797083.9375,
        804513.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384613.4688, 384643.3438, 384643.8750, 384649.3750,
        384650.2188, 384657.9062, 384666.1875, 384674.7500, 384677.2188,
        745323.3750, 759678.0000, 762715.3125, 768700.8125, 778019.7500,
        782000.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 2.0380e+00, 2.1053e+00, 2.1460e+00, 2.2255e+00, 2.2845e+00,
        2.3991e+00, 2.4622e+00, 2.4835e+00, 3.7312e+05, 3.8416e+05, 3.8464e+05,
        3.8629e+05, 3.9218e+05, 3.9616e+05, 3.9879e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8298e+00, 1.8664e+00, 1.8709e+00, 1.8797e+00, 1.9342e+00,
        1.9691e+00, 2.0334e+00, 2.1053e+00, 3.7315e+05, 3.8411e+05, 3.8467e+05,
        3.8628e+05, 3.9215e+05, 3.9618e+05, 3.9877e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7725e+00, 1.8664e+00, 1.9250e+00, 1.9514e+00, 1.9602e+00,
        1.9928e+00, 2.0059e+00, 2.4835e+00, 3.7313e+05, 3.8411e+05, 3.8466e+05,
        3.8628e+05, 3.9219e+05, 3.9618e+05, 3.9879e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384086.1875, 384109.3750, 384114.6875, 384114.8125,
        384116.0000, 384122.5000, 384142.5312, 384158.3750, 384170.0312,
        759113.3750, 762216.6875, 762715.3125, 778602.0625, 781416.7500,
        797083.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8144e+00, 1.8732e+00, 1.8797e+00, 1.9109e+00, 1.9447e+00,
        1.9602e+00, 1.9765e+00, 2.3991e+00, 3.7313e+05, 3.8412e+05, 3.8465e+05,
        3.8628e+05, 3.9214e+05, 3.9615e+05, 3.9881e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75726.04', '75735.09', '434880.81', '422493.31', '75725.73', '75729.33', '75726.16', '410357.56', '434586.16', '429410.34', '420720.00', '75730.00', '75727.62', '75726.29', '421624.75', '75726.91']
estimated f for each client, fs: [7, 7, 5, 5, 7, 7, 7, 5, 5, 5, 5, 7, 7, 7, 5, 7]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 12, 17, 19, 1, 10, 7, 20, 15, 18, 13, 3, 9, 6, 16, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0245s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:03...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:03, End: 2025-07-22 16:01:03)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 20, 14, 15, 4, 9, 2, 3, 11, 7, 8, 10, 17, 19, 13, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.8957e+05, 7.6681e+05, 8.0916e+05, 3.8510e+05, 3.8508e+05,
         3.8506e+05, 3.8512e+05, 3.8510e+05, 3.8509e+05, 3.8506e+05, 3.8506e+05,
         7.5353e+05, 7.7659e+05, 7.7754e+05, 3.8510e+05],
        [7.8957e+05, 0.0000e+00, 7.7138e+05, 7.8442e+05, 3.9089e+05, 3.9085e+05,
         3.9088e+05, 3.9091e+05, 3.9087e+05, 3.9090e+05, 3.9087e+05, 3.9089e+05,
         7.7145e+05, 7.6909e+05, 8.0527e+05, 3.9090e+05],
        [7.6681e+05, 7.7138e+05, 0.0000e+00, 7.9671e+05, 3.8733e+05, 3.8731e+05,
         3.8735e+05, 3.8734e+05, 3.8733e+05, 3.8732e+05, 3.8733e+05, 3.8730e+05,
         7.7745e+05, 7.7146e+05, 7.6338e+05, 3.8731e+05],
        [8.0916e+05, 7.8442e+05, 7.9671e+05, 0.0000e+00, 4.0949e+05, 4.0947e+05,
         4.0945e+05, 4.0943e+05, 4.0942e+05, 4.0947e+05, 4.0945e+05, 4.0948e+05,
         8.1481e+05, 7.7990e+05, 8.1758e+05, 4.0946e+05],
        [3.8510e+05, 3.9089e+05, 3.8733e+05, 4.0949e+05, 0.0000e+00, 1.7932e+00,
         1.8211e+00, 2.0373e+00, 1.6934e+00, 1.7746e+00, 1.7364e+00, 1.8686e+00,
         3.9141e+05, 3.9150e+05, 3.9832e+05, 1.7673e+00],
        [3.8508e+05, 3.9085e+05, 3.8731e+05, 4.0947e+05, 1.7932e+00, 0.0000e+00,
         1.6689e+00, 1.7560e+00, 1.6632e+00, 1.7777e+00, 1.7574e+00, 1.6076e+00,
         3.9138e+05, 3.9153e+05, 3.9830e+05, 1.6879e+00],
        [3.8506e+05, 3.9088e+05, 3.8735e+05, 4.0945e+05, 1.8211e+00, 1.6689e+00,
         0.0000e+00, 1.9465e+00, 1.7200e+00, 1.6705e+00, 1.8624e+00, 1.6900e+00,
         3.9144e+05, 3.9149e+05, 3.9830e+05, 1.7264e+00],
        [3.8512e+05, 3.9091e+05, 3.8734e+05, 4.0943e+05, 2.0373e+00, 1.7560e+00,
         1.9465e+00, 0.0000e+00, 2.0641e+00, 2.0081e+00, 1.8831e+00, 1.8024e+00,
         3.9141e+05, 3.9152e+05, 3.9834e+05, 1.7289e+00],
        [3.8510e+05, 3.9087e+05, 3.8733e+05, 4.0942e+05, 1.6934e+00, 1.6632e+00,
         1.7200e+00, 2.0641e+00, 0.0000e+00, 1.7155e+00, 1.7564e+00, 1.7303e+00,
         3.9141e+05, 3.9150e+05, 3.9833e+05, 1.7696e+00],
        [3.8509e+05, 3.9090e+05, 3.8732e+05, 4.0947e+05, 1.7746e+00, 1.7777e+00,
         1.6705e+00, 2.0081e+00, 1.7155e+00, 0.0000e+00, 1.8990e+00, 1.6940e+00,
         3.9141e+05, 3.9150e+05, 3.9829e+05, 1.8005e+00],
        [3.8506e+05, 3.9087e+05, 3.8733e+05, 4.0945e+05, 1.7364e+00, 1.7574e+00,
         1.8624e+00, 1.8831e+00, 1.7564e+00, 1.8990e+00, 0.0000e+00, 1.7666e+00,
         3.9142e+05, 3.9150e+05, 3.9833e+05, 1.7663e+00],
        [3.8506e+05, 3.9089e+05, 3.8730e+05, 4.0948e+05, 1.8686e+00, 1.6076e+00,
         1.6900e+00, 1.8024e+00, 1.7303e+00, 1.6940e+00, 1.7666e+00, 0.0000e+00,
         3.9141e+05, 3.9152e+05, 3.9831e+05, 1.6490e+00],
        [7.5353e+05, 7.7145e+05, 7.7745e+05, 8.1481e+05, 3.9141e+05, 3.9138e+05,
         3.9144e+05, 3.9141e+05, 3.9141e+05, 3.9141e+05, 3.9142e+05, 3.9141e+05,
         0.0000e+00, 7.9012e+05, 7.7601e+05, 3.9141e+05],
        [7.7659e+05, 7.6909e+05, 7.7146e+05, 7.7990e+05, 3.9150e+05, 3.9153e+05,
         3.9149e+05, 3.9152e+05, 3.9150e+05, 3.9150e+05, 3.9150e+05, 3.9152e+05,
         7.9012e+05, 0.0000e+00, 8.0285e+05, 3.9150e+05],
        [7.7754e+05, 8.0527e+05, 7.6338e+05, 8.1758e+05, 3.9832e+05, 3.9830e+05,
         3.9830e+05, 3.9834e+05, 3.9833e+05, 3.9829e+05, 3.9833e+05, 3.9831e+05,
         7.7601e+05, 8.0285e+05, 0.0000e+00, 3.9831e+05],
        [3.8510e+05, 3.9090e+05, 3.8731e+05, 4.0946e+05, 1.7673e+00, 1.6879e+00,
         1.7264e+00, 1.7289e+00, 1.7696e+00, 1.8005e+00, 1.7663e+00, 1.6490e+00,
         3.9141e+05, 3.9150e+05, 3.9831e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 385061.6562, 385062.5312, 385064.0312, 385082.2188,
        385086.5625, 385100.5938, 385100.6875, 385102.7500, 385115.5000,
        753527.7500, 766810.7500, 776590.3750, 777541.8125, 789570.8125,
        809164.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390848.1875, 390866.1875, 390870.9375, 390875.9062,
        390890.8125, 390892.8750, 390904.3750, 390904.7500, 390909.2188,
        769091.3750, 771376.3125, 771448.1250, 784416.9375, 789570.8125,
        805272.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387301.5000, 387311.7500, 387313.9375, 387316.7500,
        387329.7812, 387331.1250, 387333.5625, 387342.8125, 387352.6250,
        763377.0000, 766810.7500, 771376.3125, 771456.3125, 777446.4375,
        796706.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 409421.5625, 409426.7500, 409452.0625, 409453.3125,
        409458.4062, 409468.8125, 409473.4062, 409475.3125, 409491.1875,
        779902.5000, 784416.9375, 796706.6875, 809164.5625, 814809.3750,
        817582.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6934e+00, 1.7364e+00, 1.7673e+00, 1.7746e+00, 1.7932e+00,
        1.8211e+00, 1.8686e+00, 2.0373e+00, 3.8510e+05, 3.8733e+05, 3.9089e+05,
        3.9141e+05, 3.9150e+05, 3.9832e+05, 4.0949e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6076e+00, 1.6632e+00, 1.6689e+00, 1.6879e+00, 1.7560e+00,
        1.7574e+00, 1.7777e+00, 1.7932e+00, 3.8508e+05, 3.8731e+05, 3.9085e+05,
        3.9138e+05, 3.9153e+05, 3.9830e+05, 4.0947e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6689e+00, 1.6705e+00, 1.6900e+00, 1.7200e+00, 1.7264e+00,
        1.8211e+00, 1.8624e+00, 1.9465e+00, 3.8506e+05, 3.8735e+05, 3.9088e+05,
        3.9144e+05, 3.9149e+05, 3.9830e+05, 4.0945e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7289e+00, 1.7560e+00, 1.8024e+00, 1.8831e+00, 1.9465e+00,
        2.0081e+00, 2.0373e+00, 2.0641e+00, 3.8512e+05, 3.8734e+05, 3.9091e+05,
        3.9141e+05, 3.9152e+05, 3.9834e+05, 4.0943e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6632e+00, 1.6934e+00, 1.7155e+00, 1.7200e+00, 1.7303e+00,
        1.7564e+00, 1.7696e+00, 2.0641e+00, 3.8510e+05, 3.8733e+05, 3.9087e+05,
        3.9141e+05, 3.9150e+05, 3.9833e+05, 4.0942e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6705e+00, 1.6940e+00, 1.7155e+00, 1.7746e+00, 1.7777e+00,
        1.8005e+00, 1.8990e+00, 2.0081e+00, 3.8509e+05, 3.8732e+05, 3.9090e+05,
        3.9141e+05, 3.9150e+05, 3.9829e+05, 4.0947e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7364e+00, 1.7564e+00, 1.7574e+00, 1.7663e+00, 1.7666e+00,
        1.8624e+00, 1.8831e+00, 1.8990e+00, 3.8506e+05, 3.8733e+05, 3.9087e+05,
        3.9142e+05, 3.9150e+05, 3.9833e+05, 4.0945e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6076e+00, 1.6490e+00, 1.6900e+00, 1.6940e+00, 1.7303e+00,
        1.7666e+00, 1.8024e+00, 1.8686e+00, 3.8506e+05, 3.8730e+05, 3.9089e+05,
        3.9141e+05, 3.9152e+05, 3.9831e+05, 4.0948e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391382.8125, 391408.6250, 391410.1875, 391410.5312,
        391410.9688, 391412.4688, 391414.7812, 391418.6875, 391445.0000,
        753527.7500, 771448.1250, 776014.0000, 777446.4375, 790121.5625,
        814809.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391492.6250, 391497.6250, 391498.3438, 391501.0938,
        391502.8438, 391504.3750, 391516.0312, 391521.2500, 391526.0312,
        769091.3750, 771456.3125, 776590.3750, 779902.5000, 790121.5625,
        802851.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398294.1250, 398298.1562, 398300.9062, 398307.2812,
        398311.8750, 398315.5312, 398325.2812, 398325.3750, 398335.3750,
        763377.0000, 776014.0000, 777541.8125, 802851.5000, 805272.8125,
        817582.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6490e+00, 1.6879e+00, 1.7264e+00, 1.7289e+00, 1.7663e+00,
        1.7673e+00, 1.7696e+00, 1.8005e+00, 3.8510e+05, 3.8731e+05, 3.9090e+05,
        3.9141e+05, 3.9150e+05, 3.9831e+05, 4.0946e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['421930.41', '428705.50', '424931.09', '446502.34', '77244.70', '77240.77', '77242.93', '77247.36', '77244.83', '77241.76', '77240.95', '77237.70', '427624.16', '429265.09', '434819.06', '77242.85']
estimated f for each client, fs: [5, 5, 5, 5, 7, 7, 7, 7, 7, 7, 7, 7, 5, 5, 5, 7]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 20, 14, 15, 4, 9, 2, 3, 11, 7, 8, 10, 17, 19, 13, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0305s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:04...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 41 222]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:04, End: 2025-07-22 16:01:04)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 14, 15, 17, 3, 19, 7, 12, 16, 20, 5, 2, 8, 1, 10, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.8772e+05, 7.8495e+05, 7.8837e+05, 3.9908e+05, 8.0151e+05,
         3.9906e+05, 3.9910e+05, 8.1074e+05, 7.8077e+05, 3.9905e+05, 3.9906e+05,
         3.9906e+05, 3.9907e+05, 3.9908e+05, 3.9910e+05],
        [7.8772e+05, 0.0000e+00, 7.9379e+05, 7.7178e+05, 3.8946e+05, 7.8844e+05,
         3.8950e+05, 3.8947e+05, 7.6344e+05, 7.9190e+05, 3.8946e+05, 3.8951e+05,
         3.8948e+05, 3.8946e+05, 3.8947e+05, 3.8947e+05],
        [7.8495e+05, 7.9379e+05, 0.0000e+00, 7.8485e+05, 3.8655e+05, 7.8284e+05,
         3.8653e+05, 3.8650e+05, 7.6318e+05, 7.8433e+05, 3.8655e+05, 3.8655e+05,
         3.8655e+05, 3.8655e+05, 3.8654e+05, 3.8652e+05],
        [7.8837e+05, 7.7178e+05, 7.8485e+05, 0.0000e+00, 3.9452e+05, 7.8936e+05,
         3.9446e+05, 3.9453e+05, 7.7496e+05, 7.9490e+05, 3.9447e+05, 3.9452e+05,
         3.9451e+05, 3.9448e+05, 3.9446e+05, 3.9448e+05],
        [3.9908e+05, 3.8946e+05, 3.8655e+05, 3.9452e+05, 0.0000e+00, 3.8729e+05,
         2.0423e+00, 1.7146e+00, 3.8060e+05, 3.9340e+05, 1.6929e+00, 1.9384e+00,
         1.9687e+00, 1.8421e+00, 1.7026e+00, 2.1017e+00],
        [8.0151e+05, 7.8844e+05, 7.8284e+05, 7.8936e+05, 3.8729e+05, 0.0000e+00,
         3.8731e+05, 3.8732e+05, 7.7759e+05, 7.8549e+05, 3.8734e+05, 3.8732e+05,
         3.8731e+05, 3.8735e+05, 3.8729e+05, 3.8733e+05],
        [3.9906e+05, 3.8950e+05, 3.8653e+05, 3.9446e+05, 2.0423e+00, 3.8731e+05,
         0.0000e+00, 1.7255e+00, 3.8059e+05, 3.9342e+05, 1.6801e+00, 1.6074e+00,
         1.8335e+00, 1.8962e+00, 1.9589e+00, 1.8472e+00],
        [3.9910e+05, 3.8947e+05, 3.8650e+05, 3.9453e+05, 1.7146e+00, 3.8732e+05,
         1.7255e+00, 0.0000e+00, 3.8054e+05, 3.9336e+05, 1.6786e+00, 1.6510e+00,
         1.7667e+00, 1.7230e+00, 1.7860e+00, 1.7372e+00],
        [8.1074e+05, 7.6344e+05, 7.6318e+05, 7.7496e+05, 3.8060e+05, 7.7759e+05,
         3.8059e+05, 3.8054e+05, 0.0000e+00, 7.8158e+05, 3.8057e+05, 3.8058e+05,
         3.8058e+05, 3.8057e+05, 3.8056e+05, 3.8054e+05],
        [7.8077e+05, 7.9190e+05, 7.8433e+05, 7.9490e+05, 3.9340e+05, 7.8549e+05,
         3.9342e+05, 3.9336e+05, 7.8158e+05, 0.0000e+00, 3.9336e+05, 3.9338e+05,
         3.9339e+05, 3.9339e+05, 3.9340e+05, 3.9341e+05],
        [3.9905e+05, 3.8946e+05, 3.8655e+05, 3.9447e+05, 1.6929e+00, 3.8734e+05,
         1.6801e+00, 1.6786e+00, 3.8057e+05, 3.9336e+05, 0.0000e+00, 1.8093e+00,
         1.8956e+00, 1.7937e+00, 1.8682e+00, 1.8132e+00],
        [3.9906e+05, 3.8951e+05, 3.8655e+05, 3.9452e+05, 1.9384e+00, 3.8732e+05,
         1.6074e+00, 1.6510e+00, 3.8058e+05, 3.9338e+05, 1.8093e+00, 0.0000e+00,
         1.8700e+00, 1.6905e+00, 1.8550e+00, 1.6193e+00],
        [3.9906e+05, 3.8948e+05, 3.8655e+05, 3.9451e+05, 1.9687e+00, 3.8731e+05,
         1.8335e+00, 1.7667e+00, 3.8058e+05, 3.9339e+05, 1.8956e+00, 1.8700e+00,
         0.0000e+00, 1.9437e+00, 2.0139e+00, 1.7137e+00],
        [3.9907e+05, 3.8946e+05, 3.8655e+05, 3.9448e+05, 1.8421e+00, 3.8735e+05,
         1.8962e+00, 1.7230e+00, 3.8057e+05, 3.9339e+05, 1.7937e+00, 1.6905e+00,
         1.9437e+00, 0.0000e+00, 1.7259e+00, 1.7804e+00],
        [3.9908e+05, 3.8947e+05, 3.8654e+05, 3.9446e+05, 1.7026e+00, 3.8729e+05,
         1.9589e+00, 1.7860e+00, 3.8056e+05, 3.9340e+05, 1.8682e+00, 1.8550e+00,
         2.0139e+00, 1.7259e+00, 0.0000e+00, 2.0102e+00],
        [3.9910e+05, 3.8947e+05, 3.8652e+05, 3.9448e+05, 2.1017e+00, 3.8733e+05,
         1.8472e+00, 1.7372e+00, 3.8054e+05, 3.9341e+05, 1.8132e+00, 1.6193e+00,
         1.7137e+00, 1.7804e+00, 2.0102e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 399049.9062, 399058.8125, 399062.1562, 399063.1250,
        399074.0312, 399080.3125, 399083.1875, 399095.5312, 399104.6250,
        780773.3750, 784946.0000, 787719.2500, 788365.9375, 801506.3750,
        810737.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389459.0625, 389459.2500, 389464.5000, 389465.8438,
        389469.2188, 389473.5000, 389482.0312, 389497.1562, 389511.7188,
        763436.3125, 771782.1250, 787719.2500, 788436.3750, 791902.5625,
        793789.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386503.7500, 386519.6250, 386531.4688, 386536.8750,
        386546.9688, 386547.7188, 386549.8750, 386551.4062, 386552.7812,
        763183.4375, 782840.8750, 784330.3125, 784853.6250, 784946.0000,
        793789.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394461.5000, 394462.1875, 394469.4062, 394478.5938,
        394482.0000, 394508.3750, 394515.3438, 394522.9375, 394525.9688,
        771782.1250, 774963.5625, 784853.6250, 788365.9375, 789355.6875,
        794903.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6929e+00, 1.7026e+00, 1.7146e+00, 1.8421e+00, 1.9384e+00,
        1.9687e+00, 2.0423e+00, 2.1017e+00, 3.8060e+05, 3.8655e+05, 3.8729e+05,
        3.8946e+05, 3.9340e+05, 3.9452e+05, 3.9908e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387289.5312, 387291.8438, 387310.2500, 387312.0312,
        387318.4375, 387319.7500, 387325.7500, 387342.8750, 387345.4062,
        777585.7500, 782840.8750, 785486.8750, 788436.3750, 789355.6875,
        801506.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6074e+00, 1.6801e+00, 1.7255e+00, 1.8335e+00, 1.8472e+00,
        1.8962e+00, 1.9589e+00, 2.0423e+00, 3.8059e+05, 3.8653e+05, 3.8731e+05,
        3.8950e+05, 3.9342e+05, 3.9446e+05, 3.9906e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6510e+00, 1.6786e+00, 1.7146e+00, 1.7230e+00, 1.7255e+00,
        1.7372e+00, 1.7667e+00, 1.7860e+00, 3.8054e+05, 3.8650e+05, 3.8732e+05,
        3.8947e+05, 3.9336e+05, 3.9453e+05, 3.9910e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380542.0312, 380542.5312, 380561.4375, 380565.6875,
        380567.3750, 380581.4062, 380583.7500, 380593.8750, 380598.3438,
        763183.4375, 763436.3125, 774963.5625, 777585.7500, 781582.1250,
        810737.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393360.6562, 393361.0312, 393377.5938, 393386.4375,
        393389.4688, 393396.1250, 393400.1562, 393406.4375, 393415.0938,
        780773.3750, 781582.1250, 784330.3125, 785486.8750, 791902.5625,
        794903.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6786e+00, 1.6801e+00, 1.6929e+00, 1.7937e+00, 1.8093e+00,
        1.8132e+00, 1.8682e+00, 1.8956e+00, 3.8057e+05, 3.8655e+05, 3.8734e+05,
        3.8946e+05, 3.9336e+05, 3.9447e+05, 3.9905e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6074e+00, 1.6193e+00, 1.6510e+00, 1.6905e+00, 1.8093e+00,
        1.8550e+00, 1.8700e+00, 1.9384e+00, 3.8058e+05, 3.8655e+05, 3.8732e+05,
        3.8951e+05, 3.9338e+05, 3.9452e+05, 3.9906e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7137e+00, 1.7667e+00, 1.8335e+00, 1.8700e+00, 1.8956e+00,
        1.9437e+00, 1.9687e+00, 2.0139e+00, 3.8058e+05, 3.8655e+05, 3.8731e+05,
        3.8948e+05, 3.9339e+05, 3.9451e+05, 3.9906e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6905e+00, 1.7230e+00, 1.7259e+00, 1.7804e+00, 1.7937e+00,
        1.8421e+00, 1.8962e+00, 1.9437e+00, 3.8057e+05, 3.8655e+05, 3.8735e+05,
        3.8946e+05, 3.9339e+05, 3.9448e+05, 3.9907e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7026e+00, 1.7259e+00, 1.7860e+00, 1.8550e+00, 1.8682e+00,
        1.9589e+00, 2.0102e+00, 2.0139e+00, 3.8056e+05, 3.8654e+05, 3.8729e+05,
        3.8947e+05, 3.9340e+05, 3.9446e+05, 3.9908e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6193e+00, 1.7137e+00, 1.7372e+00, 1.7804e+00, 1.8132e+00,
        1.8472e+00, 2.0102e+00, 2.1017e+00, 3.8054e+05, 3.8652e+05, 3.8733e+05,
        3.8947e+05, 3.9341e+05, 3.9448e+05, 3.9910e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['437244.50', '426871.84', '424202.41', '432220.81', '76716.47', '426344.16', '76714.00', '76705.95', '418832.00', '432126.66', '76713.15', '76714.32', '76715.14', '76712.70', '76711.33', '76707.67']
estimated f for each client, fs: [5, 5, 5, 5, 7, 6, 7, 7, 6, 5, 7, 7, 7, 7, 7, 7]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 14, 15, 17, 3, 19, 7, 12, 16, 20, 5, 2, 8, 1, 10, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0279s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:05...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:05, End: 2025-07-22 16:01:05)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 12, 16, 11, 13, 18, 14, 9, 19, 4, 2, 8, 5, 20, 7, 17], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0539e+05, 8.1358e+05, 4.0538e+05, 8.1024e+05, 7.8530e+05,
         7.9499e+05, 4.0537e+05, 7.9964e+05, 4.0540e+05, 4.0538e+05, 4.0543e+05,
         4.0539e+05, 8.1161e+05, 4.0538e+05, 7.9520e+05],
        [4.0539e+05, 0.0000e+00, 3.8772e+05, 1.9562e+00, 3.9781e+05, 3.9914e+05,
         3.9977e+05, 1.7865e+00, 3.9540e+05, 1.8246e+00, 1.8766e+00, 1.9421e+00,
         1.7334e+00, 3.9102e+05, 1.8714e+00, 3.9276e+05],
        [8.1358e+05, 3.8772e+05, 0.0000e+00, 3.8768e+05, 7.7765e+05, 7.8509e+05,
         7.8707e+05, 3.8771e+05, 7.8850e+05, 3.8769e+05, 3.8767e+05, 3.8771e+05,
         3.8768e+05, 7.7471e+05, 3.8765e+05, 7.8375e+05],
        [4.0538e+05, 1.9562e+00, 3.8768e+05, 0.0000e+00, 3.9778e+05, 3.9912e+05,
         3.9977e+05, 1.6192e+00, 3.9539e+05, 1.5403e+00, 1.6693e+00, 1.6596e+00,
         1.6289e+00, 3.9104e+05, 1.6243e+00, 3.9278e+05],
        [8.1024e+05, 3.9781e+05, 7.7765e+05, 3.9778e+05, 0.0000e+00, 7.9925e+05,
         7.8478e+05, 3.9776e+05, 8.0652e+05, 3.9782e+05, 3.9777e+05, 3.9777e+05,
         3.9781e+05, 7.8113e+05, 3.9779e+05, 8.0451e+05],
        [7.8530e+05, 3.9914e+05, 7.8509e+05, 3.9912e+05, 7.9925e+05, 0.0000e+00,
         8.0866e+05, 3.9914e+05, 7.7470e+05, 3.9914e+05, 3.9914e+05, 3.9912e+05,
         3.9914e+05, 7.6762e+05, 3.9915e+05, 7.7284e+05],
        [7.9499e+05, 3.9977e+05, 7.8707e+05, 3.9977e+05, 7.8478e+05, 8.0866e+05,
         0.0000e+00, 3.9981e+05, 8.1018e+05, 3.9978e+05, 3.9979e+05, 3.9981e+05,
         3.9978e+05, 8.0075e+05, 3.9980e+05, 7.7496e+05],
        [4.0537e+05, 1.7865e+00, 3.8771e+05, 1.6192e+00, 3.9776e+05, 3.9914e+05,
         3.9981e+05, 0.0000e+00, 3.9540e+05, 1.7398e+00, 1.6554e+00, 1.6709e+00,
         1.8490e+00, 3.9105e+05, 1.6722e+00, 3.9278e+05],
        [7.9964e+05, 3.9540e+05, 7.8850e+05, 3.9539e+05, 8.0652e+05, 7.7470e+05,
         8.1018e+05, 3.9540e+05, 0.0000e+00, 3.9538e+05, 3.9537e+05, 3.9540e+05,
         3.9540e+05, 7.7446e+05, 3.9538e+05, 7.9532e+05],
        [4.0540e+05, 1.8246e+00, 3.8769e+05, 1.5403e+00, 3.9782e+05, 3.9914e+05,
         3.9978e+05, 1.7398e+00, 3.9538e+05, 0.0000e+00, 1.7034e+00, 1.6171e+00,
         1.7157e+00, 3.9104e+05, 1.5811e+00, 3.9277e+05],
        [4.0538e+05, 1.8766e+00, 3.8767e+05, 1.6693e+00, 3.9777e+05, 3.9914e+05,
         3.9979e+05, 1.6554e+00, 3.9537e+05, 1.7034e+00, 0.0000e+00, 1.8552e+00,
         1.8948e+00, 3.9104e+05, 1.5600e+00, 3.9279e+05],
        [4.0543e+05, 1.9421e+00, 3.8771e+05, 1.6596e+00, 3.9777e+05, 3.9912e+05,
         3.9981e+05, 1.6709e+00, 3.9540e+05, 1.6171e+00, 1.8552e+00, 0.0000e+00,
         1.9064e+00, 3.9103e+05, 1.7634e+00, 3.9276e+05],
        [4.0539e+05, 1.7334e+00, 3.8768e+05, 1.6289e+00, 3.9781e+05, 3.9914e+05,
         3.9978e+05, 1.8490e+00, 3.9540e+05, 1.7157e+00, 1.8948e+00, 1.9064e+00,
         0.0000e+00, 3.9103e+05, 1.6474e+00, 3.9277e+05],
        [8.1161e+05, 3.9102e+05, 7.7471e+05, 3.9104e+05, 7.8113e+05, 7.6762e+05,
         8.0075e+05, 3.9105e+05, 7.7446e+05, 3.9104e+05, 3.9104e+05, 3.9103e+05,
         3.9103e+05, 0.0000e+00, 3.9104e+05, 7.6415e+05],
        [4.0538e+05, 1.8714e+00, 3.8765e+05, 1.6243e+00, 3.9779e+05, 3.9915e+05,
         3.9980e+05, 1.6722e+00, 3.9538e+05, 1.5811e+00, 1.5600e+00, 1.7634e+00,
         1.6474e+00, 3.9104e+05, 0.0000e+00, 3.9276e+05],
        [7.9520e+05, 3.9276e+05, 7.8375e+05, 3.9278e+05, 8.0451e+05, 7.7284e+05,
         7.7496e+05, 3.9278e+05, 7.9532e+05, 3.9277e+05, 3.9279e+05, 3.9276e+05,
         3.9277e+05, 7.6415e+05, 3.9276e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 405367.1562, 405376.3125, 405377.7500, 405381.8125,
        405388.2188, 405390.3125, 405399.0625, 405432.9375, 785303.0000,
        794987.1250, 795198.2500, 799637.2500, 810240.2500, 811608.8125,
        813582.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7334e+00, 1.7865e+00, 1.8246e+00, 1.8714e+00, 1.8766e+00,
        1.9421e+00, 1.9562e+00, 3.8772e+05, 3.9102e+05, 3.9276e+05, 3.9540e+05,
        3.9781e+05, 3.9914e+05, 3.9977e+05, 4.0539e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387654.5312, 387670.4688, 387677.1250, 387681.3125,
        387692.3125, 387708.2812, 387711.1250, 387715.8438, 774711.0625,
        777652.9375, 783747.6250, 785094.0000, 787065.5625, 788498.8750,
        813582.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5403e+00, 1.6192e+00, 1.6243e+00, 1.6289e+00, 1.6596e+00,
        1.6693e+00, 1.9562e+00, 3.8768e+05, 3.9104e+05, 3.9278e+05, 3.9539e+05,
        3.9778e+05, 3.9912e+05, 3.9977e+05, 4.0538e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397764.8750, 397768.2500, 397772.0625, 397779.3750,
        397793.4062, 397811.2500, 397812.3750, 397820.6875, 777652.9375,
        781133.9375, 784778.6250, 799248.7500, 804510.0000, 806524.1250,
        810240.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399117.1562, 399123.3125, 399141.8438, 399141.9062,
        399142.8438, 399143.0000, 399144.7188, 399148.8125, 767616.7500,
        772839.4375, 774699.0000, 785094.0000, 785303.0000, 799248.7500,
        808656.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399766.3125, 399770.5625, 399776.9062, 399778.2500,
        399788.1250, 399800.1250, 399806.5312, 399807.3125, 774960.3125,
        784778.6250, 787065.5625, 794987.1250, 800746.8125, 808656.3750,
        810182.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6192e+00, 1.6554e+00, 1.6709e+00, 1.6722e+00, 1.7398e+00,
        1.7865e+00, 1.8490e+00, 3.8771e+05, 3.9105e+05, 3.9278e+05, 3.9540e+05,
        3.9776e+05, 3.9914e+05, 3.9981e+05, 4.0537e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395367.8125, 395375.6875, 395378.9375, 395391.2188,
        395395.5938, 395399.8125, 395401.2188, 395401.5625, 774457.7500,
        774699.0000, 788498.8750, 795324.5625, 799637.2500, 806524.1250,
        810182.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5403e+00, 1.5811e+00, 1.6171e+00, 1.7034e+00, 1.7157e+00,
        1.7398e+00, 1.8246e+00, 3.8769e+05, 3.9104e+05, 3.9277e+05, 3.9538e+05,
        3.9782e+05, 3.9914e+05, 3.9978e+05, 4.0540e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5600e+00, 1.6554e+00, 1.6693e+00, 1.7034e+00, 1.8552e+00,
        1.8766e+00, 1.8948e+00, 3.8767e+05, 3.9104e+05, 3.9279e+05, 3.9537e+05,
        3.9777e+05, 3.9914e+05, 3.9979e+05, 4.0538e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6171e+00, 1.6596e+00, 1.6709e+00, 1.7634e+00, 1.8552e+00,
        1.9064e+00, 1.9421e+00, 3.8771e+05, 3.9103e+05, 3.9276e+05, 3.9540e+05,
        3.9777e+05, 3.9912e+05, 3.9981e+05, 4.0543e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6289e+00, 1.6474e+00, 1.7157e+00, 1.7334e+00, 1.8490e+00,
        1.8948e+00, 1.9064e+00, 3.8768e+05, 3.9103e+05, 3.9277e+05, 3.9540e+05,
        3.9781e+05, 3.9914e+05, 3.9978e+05, 4.0539e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391017.4062, 391025.0938, 391029.5625, 391040.0938,
        391041.1875, 391043.3438, 391044.0625, 391048.8750, 764145.3125,
        767616.7500, 774457.7500, 774711.0625, 781133.9375, 800746.8125,
        811608.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5600e+00, 1.5811e+00, 1.6243e+00, 1.6474e+00, 1.6722e+00,
        1.7634e+00, 1.8714e+00, 3.8765e+05, 3.9104e+05, 3.9276e+05, 3.9538e+05,
        3.9779e+05, 3.9915e+05, 3.9980e+05, 4.0538e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392757.9688, 392759.0938, 392762.0625, 392768.0312,
        392771.0000, 392775.7500, 392776.7812, 392793.3750, 764145.3125,
        772839.4375, 774960.3125, 783747.6250, 795198.2500, 795324.5625,
        804510.0000])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['482340.34', '117150.84', '465387.50', '117150.58', '474110.91', '473356.00', '475803.31', '117154.60', '471226.84', '117151.54', '117151.61', '117150.67', '117149.42', '466005.16', '117146.94', '467914.91']
estimated f for each client, fs: [5, 8, 6, 8, 5, 5, 5, 8, 5, 8, 8, 8, 8, 5, 8, 5]
selected_index: 14
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [15, 12, 16, 11, 13, 18, 14, 9, 19, 4, 2, 8, 5, 20, 7, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0310s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:05...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:05, End: 2025-07-22 16:01:05)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 10, 11, 5, 14, 9, 3, 2, 13, 20, 8, 15, 7, 4, 6, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.6928e+05, 3.6927e+05, 3.6929e+05, 7.5623e+05, 3.6928e+05,
         3.6930e+05, 3.6926e+05, 7.5143e+05, 7.7805e+05, 3.6929e+05, 7.7148e+05,
         3.6930e+05, 3.6929e+05, 3.6930e+05, 7.6813e+05],
        [3.6928e+05, 0.0000e+00, 1.9580e+00, 1.9148e+00, 3.9005e+05, 1.7646e+00,
         1.7010e+00, 1.7662e+00, 3.7573e+05, 4.0252e+05, 1.9458e+00, 3.8808e+05,
         1.7344e+00, 2.0725e+00, 1.9706e+00, 4.0976e+05],
        [3.6927e+05, 1.9580e+00, 0.0000e+00, 1.7579e+00, 3.9002e+05, 1.6760e+00,
         2.1878e+00, 1.7732e+00, 3.7574e+05, 4.0252e+05, 1.8318e+00, 3.8811e+05,
         1.9805e+00, 1.7485e+00, 1.9053e+00, 4.0975e+05],
        [3.6929e+05, 1.9148e+00, 1.7579e+00, 0.0000e+00, 3.9004e+05, 1.9600e+00,
         1.8485e+00, 1.9384e+00, 3.7571e+05, 4.0251e+05, 2.0178e+00, 3.8809e+05,
         1.8338e+00, 1.9581e+00, 2.0058e+00, 4.0974e+05],
        [7.5623e+05, 3.9005e+05, 3.9002e+05, 3.9004e+05, 0.0000e+00, 3.9003e+05,
         3.9002e+05, 3.9000e+05, 7.4679e+05, 8.0180e+05, 3.9004e+05, 7.8059e+05,
         3.9004e+05, 3.9003e+05, 3.9000e+05, 7.9901e+05],
        [3.6928e+05, 1.7646e+00, 1.6760e+00, 1.9600e+00, 3.9003e+05, 0.0000e+00,
         1.8494e+00, 1.6980e+00, 3.7573e+05, 4.0252e+05, 1.7621e+00, 3.8808e+05,
         1.7859e+00, 1.8336e+00, 1.7627e+00, 4.0974e+05],
        [3.6930e+05, 1.7010e+00, 2.1878e+00, 1.8485e+00, 3.9002e+05, 1.8494e+00,
         0.0000e+00, 1.9673e+00, 3.7574e+05, 4.0255e+05, 2.0138e+00, 3.8808e+05,
         1.8999e+00, 2.0658e+00, 2.1789e+00, 4.0977e+05],
        [3.6926e+05, 1.7662e+00, 1.7732e+00, 1.9384e+00, 3.9000e+05, 1.6980e+00,
         1.9673e+00, 0.0000e+00, 3.7574e+05, 4.0251e+05, 1.8980e+00, 3.8810e+05,
         1.7672e+00, 1.8428e+00, 1.7415e+00, 4.0980e+05],
        [7.5143e+05, 3.7573e+05, 3.7574e+05, 3.7571e+05, 7.4679e+05, 3.7573e+05,
         3.7574e+05, 3.7574e+05, 0.0000e+00, 7.7703e+05, 3.7572e+05, 7.5500e+05,
         3.7575e+05, 3.7571e+05, 3.7574e+05, 7.9219e+05],
        [7.7805e+05, 4.0252e+05, 4.0252e+05, 4.0251e+05, 8.0180e+05, 4.0252e+05,
         4.0255e+05, 4.0251e+05, 7.7703e+05, 0.0000e+00, 4.0250e+05, 7.9483e+05,
         4.0250e+05, 4.0251e+05, 4.0251e+05, 8.0488e+05],
        [3.6929e+05, 1.9458e+00, 1.8318e+00, 2.0178e+00, 3.9004e+05, 1.7621e+00,
         2.0138e+00, 1.8980e+00, 3.7572e+05, 4.0250e+05, 0.0000e+00, 3.8807e+05,
         2.0024e+00, 1.7448e+00, 1.8806e+00, 4.0975e+05],
        [7.7148e+05, 3.8808e+05, 3.8811e+05, 3.8809e+05, 7.8059e+05, 3.8808e+05,
         3.8808e+05, 3.8810e+05, 7.5500e+05, 7.9483e+05, 3.8807e+05, 0.0000e+00,
         3.8806e+05, 3.8806e+05, 3.8813e+05, 7.8806e+05],
        [3.6930e+05, 1.7344e+00, 1.9805e+00, 1.8338e+00, 3.9004e+05, 1.7859e+00,
         1.8999e+00, 1.7672e+00, 3.7575e+05, 4.0250e+05, 2.0024e+00, 3.8806e+05,
         0.0000e+00, 1.8654e+00, 2.0523e+00, 4.0976e+05],
        [3.6929e+05, 2.0725e+00, 1.7485e+00, 1.9581e+00, 3.9003e+05, 1.8336e+00,
         2.0658e+00, 1.8428e+00, 3.7571e+05, 4.0251e+05, 1.7448e+00, 3.8806e+05,
         1.8654e+00, 0.0000e+00, 1.8161e+00, 4.0975e+05],
        [3.6930e+05, 1.9706e+00, 1.9053e+00, 2.0058e+00, 3.9000e+05, 1.7627e+00,
         2.1789e+00, 1.7415e+00, 3.7574e+05, 4.0251e+05, 1.8806e+00, 3.8813e+05,
         2.0523e+00, 1.8161e+00, 0.0000e+00, 4.0977e+05],
        [7.6813e+05, 4.0976e+05, 4.0975e+05, 4.0974e+05, 7.9901e+05, 4.0974e+05,
         4.0977e+05, 4.0980e+05, 7.9219e+05, 8.0488e+05, 4.0975e+05, 7.8806e+05,
         4.0976e+05, 4.0975e+05, 4.0977e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 369259.4688, 369267.7188, 369278.1250, 369278.4375,
        369291.8438, 369292.0000, 369293.8750, 369295.6250, 369299.0312,
        369301.1250, 751433.5000, 756232.3125, 768132.0625, 771476.3750,
        778051.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7010e+00, 1.7344e+00, 1.7646e+00, 1.7662e+00, 1.9148e+00,
        1.9458e+00, 1.9580e+00, 1.9706e+00, 2.0725e+00, 3.6928e+05, 3.7573e+05,
        3.8808e+05, 3.9005e+05, 4.0252e+05, 4.0976e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6760e+00, 1.7485e+00, 1.7579e+00, 1.7732e+00, 1.8318e+00,
        1.9053e+00, 1.9580e+00, 1.9805e+00, 2.1878e+00, 3.6927e+05, 3.7574e+05,
        3.8811e+05, 3.9002e+05, 4.0252e+05, 4.0975e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7579e+00, 1.8338e+00, 1.8485e+00, 1.9148e+00, 1.9384e+00,
        1.9581e+00, 1.9600e+00, 2.0058e+00, 2.0178e+00, 3.6929e+05, 3.7571e+05,
        3.8809e+05, 3.9004e+05, 4.0251e+05, 4.0974e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389996.1250, 389999.3438, 390015.8438, 390019.3125,
        390030.5625, 390031.0625, 390035.7188, 390037.3125, 390043.9375,
        390046.6250, 746791.7500, 756232.3125, 780585.8125, 799010.4375,
        801801.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6760e+00, 1.6980e+00, 1.7621e+00, 1.7627e+00, 1.7646e+00,
        1.7859e+00, 1.8336e+00, 1.8494e+00, 1.9600e+00, 3.6928e+05, 3.7573e+05,
        3.8808e+05, 3.9003e+05, 4.0252e+05, 4.0974e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7010e+00, 1.8485e+00, 1.8494e+00, 1.8999e+00, 1.9673e+00,
        2.0138e+00, 2.0658e+00, 2.1789e+00, 2.1878e+00, 3.6930e+05, 3.7574e+05,
        3.8808e+05, 3.9002e+05, 4.0255e+05, 4.0977e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6980e+00, 1.7415e+00, 1.7662e+00, 1.7672e+00, 1.7732e+00,
        1.8428e+00, 1.8980e+00, 1.9384e+00, 1.9673e+00, 3.6926e+05, 3.7574e+05,
        3.8810e+05, 3.9000e+05, 4.0251e+05, 4.0980e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 375707.0312, 375709.3438, 375718.0312, 375725.0312,
        375730.6250, 375735.5000, 375736.8750, 375737.3125, 375738.3438,
        375746.9375, 746791.7500, 751433.5000, 754996.3125, 777027.2500,
        792189.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402498.0938, 402500.7812, 402511.5000, 402512.8125,
        402512.9688, 402513.1562, 402516.3438, 402523.9688, 402524.9375,
        402547.1250, 777027.2500, 778051.1250, 794831.3750, 801801.2500,
        804880.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7448e+00, 1.7621e+00, 1.8318e+00, 1.8806e+00, 1.8980e+00,
        1.9458e+00, 2.0024e+00, 2.0138e+00, 2.0178e+00, 3.6929e+05, 3.7572e+05,
        3.8807e+05, 3.9004e+05, 4.0250e+05, 4.0975e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388056.9688, 388064.3750, 388067.3438, 388076.7500,
        388079.1875, 388081.6875, 388085.2188, 388096.3750, 388114.0625,
        388127.7500, 754996.3125, 771476.3750, 780585.8125, 788058.1250,
        794831.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7344e+00, 1.7672e+00, 1.7859e+00, 1.8338e+00, 1.8654e+00,
        1.8999e+00, 1.9805e+00, 2.0024e+00, 2.0523e+00, 3.6930e+05, 3.7575e+05,
        3.8806e+05, 3.9004e+05, 4.0250e+05, 4.0976e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7448e+00, 1.7485e+00, 1.8161e+00, 1.8336e+00, 1.8428e+00,
        1.8654e+00, 1.9581e+00, 2.0658e+00, 2.0725e+00, 3.6929e+05, 3.7571e+05,
        3.8806e+05, 3.9003e+05, 4.0251e+05, 4.0975e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7415e+00, 1.7627e+00, 1.8161e+00, 1.8806e+00, 1.9053e+00,
        1.9706e+00, 2.0058e+00, 2.0523e+00, 2.1789e+00, 3.6930e+05, 3.7574e+05,
        3.8813e+05, 3.9000e+05, 4.0251e+05, 4.0977e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 409736.1250, 409742.0625, 409746.0938, 409754.3750,
        409754.3750, 409757.9375, 409764.6562, 409767.6250, 409773.7188,
        409800.3750, 768132.0625, 788058.1250, 792189.8750, 799010.4375,
        804880.8750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['369285.69', '36929.52', '36928.46', '36931.11', '390025.56', '36929.42', '36931.88', '36927.59', '375728.53', '402516.19', '36930.91', '388085.00', '36931.60', '36930.88', '36931.29', '409759.75']
estimated f for each client, fs: [5, 6, 6, 6, 4, 6, 6, 6, 4, 4, 6, 4, 6, 6, 6, 4]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 10, 11, 5, 14, 9, 3, 2, 13, 20, 8, 15, 7, 4, 6, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0273s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:06...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:06, End: 2025-07-22 16:01:06)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 2, 15, 11, 4, 10, 19, 16, 17, 8, 13, 1, 3, 20, 18, 5], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6419e+00, 3.9265e+05, 1.8719e+00, 1.8720e+00, 1.6776e+00,
         4.0198e+05, 3.8520e+05, 3.8132e+05, 2.0261e+00, 3.9834e+05, 1.7848e+00,
         1.8313e+00, 3.9745e+05, 3.9734e+05, 1.7413e+00],
        [1.6419e+00, 0.0000e+00, 3.9266e+05, 1.8053e+00, 1.8320e+00, 1.6931e+00,
         4.0197e+05, 3.8520e+05, 3.8131e+05, 1.9654e+00, 3.9831e+05, 1.7074e+00,
         1.8453e+00, 3.9744e+05, 3.9730e+05, 1.9013e+00],
        [3.9265e+05, 3.9266e+05, 0.0000e+00, 3.9265e+05, 3.9265e+05, 3.9263e+05,
         8.1065e+05, 7.7778e+05, 7.7770e+05, 3.9266e+05, 8.0901e+05, 3.9265e+05,
         3.9266e+05, 7.8741e+05, 7.9332e+05, 3.9263e+05],
        [1.8719e+00, 1.8053e+00, 3.9265e+05, 0.0000e+00, 1.5981e+00, 1.8438e+00,
         4.0198e+05, 3.8522e+05, 3.8128e+05, 1.6867e+00, 3.9833e+05, 1.7587e+00,
         1.9419e+00, 3.9747e+05, 3.9734e+05, 1.6320e+00],
        [1.8720e+00, 1.8320e+00, 3.9265e+05, 1.5981e+00, 0.0000e+00, 1.9481e+00,
         4.0194e+05, 3.8523e+05, 3.8129e+05, 1.7604e+00, 3.9835e+05, 1.8412e+00,
         1.9658e+00, 3.9746e+05, 3.9731e+05, 1.8371e+00],
        [1.6776e+00, 1.6931e+00, 3.9263e+05, 1.8438e+00, 1.9481e+00, 0.0000e+00,
         4.0197e+05, 3.8519e+05, 3.8132e+05, 1.8511e+00, 3.9830e+05, 1.7341e+00,
         1.5961e+00, 3.9746e+05, 3.9731e+05, 1.7589e+00],
        [4.0198e+05, 4.0197e+05, 8.1065e+05, 4.0198e+05, 4.0194e+05, 4.0197e+05,
         0.0000e+00, 7.7576e+05, 8.0225e+05, 4.0196e+05, 8.1265e+05, 4.0197e+05,
         4.0199e+05, 7.7906e+05, 7.9450e+05, 4.0200e+05],
        [3.8520e+05, 3.8520e+05, 7.7778e+05, 3.8522e+05, 3.8523e+05, 3.8519e+05,
         7.7576e+05, 0.0000e+00, 7.5511e+05, 3.8522e+05, 7.8717e+05, 3.8521e+05,
         3.8521e+05, 7.8446e+05, 7.8981e+05, 3.8521e+05],
        [3.8132e+05, 3.8131e+05, 7.7770e+05, 3.8128e+05, 3.8129e+05, 3.8132e+05,
         8.0225e+05, 7.5511e+05, 0.0000e+00, 3.8133e+05, 8.0126e+05, 3.8131e+05,
         3.8129e+05, 7.8867e+05, 7.9731e+05, 3.8130e+05],
        [2.0261e+00, 1.9654e+00, 3.9266e+05, 1.6867e+00, 1.7604e+00, 1.8511e+00,
         4.0196e+05, 3.8522e+05, 3.8133e+05, 0.0000e+00, 3.9831e+05, 1.9318e+00,
         1.9259e+00, 3.9746e+05, 3.9735e+05, 1.9099e+00],
        [3.9834e+05, 3.9831e+05, 8.0901e+05, 3.9833e+05, 3.9835e+05, 3.9830e+05,
         8.1265e+05, 7.8717e+05, 8.0126e+05, 3.9831e+05, 0.0000e+00, 3.9832e+05,
         3.9834e+05, 7.8780e+05, 8.0494e+05, 3.9832e+05],
        [1.7848e+00, 1.7074e+00, 3.9265e+05, 1.7587e+00, 1.8412e+00, 1.7341e+00,
         4.0197e+05, 3.8521e+05, 3.8131e+05, 1.9318e+00, 3.9832e+05, 0.0000e+00,
         1.8736e+00, 3.9750e+05, 3.9732e+05, 1.8434e+00],
        [1.8313e+00, 1.8453e+00, 3.9266e+05, 1.9419e+00, 1.9658e+00, 1.5961e+00,
         4.0199e+05, 3.8521e+05, 3.8129e+05, 1.9259e+00, 3.9834e+05, 1.8736e+00,
         0.0000e+00, 3.9743e+05, 3.9736e+05, 1.7871e+00],
        [3.9745e+05, 3.9744e+05, 7.8741e+05, 3.9747e+05, 3.9746e+05, 3.9746e+05,
         7.7906e+05, 7.8446e+05, 7.8867e+05, 3.9746e+05, 7.8780e+05, 3.9750e+05,
         3.9743e+05, 0.0000e+00, 7.9358e+05, 3.9746e+05],
        [3.9734e+05, 3.9730e+05, 7.9332e+05, 3.9734e+05, 3.9731e+05, 3.9731e+05,
         7.9450e+05, 7.8981e+05, 7.9731e+05, 3.9735e+05, 8.0494e+05, 3.9732e+05,
         3.9736e+05, 7.9358e+05, 0.0000e+00, 3.9735e+05],
        [1.7413e+00, 1.9013e+00, 3.9263e+05, 1.6320e+00, 1.8371e+00, 1.7589e+00,
         4.0200e+05, 3.8521e+05, 3.8130e+05, 1.9099e+00, 3.9832e+05, 1.8434e+00,
         1.7871e+00, 3.9746e+05, 3.9735e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6419e+00, 1.6776e+00, 1.7413e+00, 1.7848e+00, 1.8313e+00,
        1.8719e+00, 1.8720e+00, 2.0261e+00, 3.8132e+05, 3.8520e+05, 3.9265e+05,
        3.9734e+05, 3.9745e+05, 3.9834e+05, 4.0198e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6419e+00, 1.6931e+00, 1.7074e+00, 1.8053e+00, 1.8320e+00,
        1.8453e+00, 1.9013e+00, 1.9654e+00, 3.8131e+05, 3.8520e+05, 3.9266e+05,
        3.9730e+05, 3.9744e+05, 3.9831e+05, 4.0197e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392629.4688, 392633.5625, 392648.6875, 392650.8125,
        392652.9062, 392653.2188, 392655.0938, 392658.8750, 392659.2812,
        777703.0625, 777784.3125, 787407.8750, 793322.1250, 809011.3750,
        810654.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5981e+00, 1.6320e+00, 1.6867e+00, 1.7587e+00, 1.8053e+00,
        1.8438e+00, 1.8719e+00, 1.9419e+00, 3.8128e+05, 3.8522e+05, 3.9265e+05,
        3.9734e+05, 3.9747e+05, 3.9833e+05, 4.0198e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5981e+00, 1.7604e+00, 1.8320e+00, 1.8371e+00, 1.8412e+00,
        1.8720e+00, 1.9481e+00, 1.9658e+00, 3.8129e+05, 3.8523e+05, 3.9265e+05,
        3.9731e+05, 3.9746e+05, 3.9835e+05, 4.0194e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5961e+00, 1.6776e+00, 1.6931e+00, 1.7341e+00, 1.7589e+00,
        1.8438e+00, 1.8511e+00, 1.9481e+00, 3.8132e+05, 3.8519e+05, 3.9263e+05,
        3.9731e+05, 3.9746e+05, 3.9830e+05, 4.0197e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401939.2188, 401962.1250, 401967.3750, 401969.3750,
        401971.7188, 401975.3438, 401984.9375, 401991.1875, 401997.6250,
        775761.3750, 779057.1250, 794501.8750, 802246.7500, 810654.3750,
        812650.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385194.5000, 385197.7188, 385205.0000, 385207.3438,
        385210.9062, 385211.7812, 385217.5938, 385218.9375, 385228.2188,
        755110.9375, 775761.3750, 777784.3125, 784460.4375, 787167.6250,
        789806.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381276.8750, 381287.3125, 381287.6875, 381295.2812,
        381311.5000, 381313.1250, 381316.3125, 381319.4062, 381326.8438,
        755110.9375, 777703.0625, 788669.0000, 797307.8750, 801260.9375,
        802246.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6867e+00, 1.7604e+00, 1.8511e+00, 1.9099e+00, 1.9259e+00,
        1.9318e+00, 1.9654e+00, 2.0261e+00, 3.8133e+05, 3.8522e+05, 3.9266e+05,
        3.9735e+05, 3.9746e+05, 3.9831e+05, 4.0196e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398299.0000, 398305.2188, 398307.5625, 398320.0625,
        398323.6875, 398333.1250, 398338.7812, 398343.1875, 398349.0938,
        787167.6250, 787797.8125, 801260.9375, 804944.6875, 809011.3750,
        812650.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7074e+00, 1.7341e+00, 1.7587e+00, 1.7848e+00, 1.8412e+00,
        1.8434e+00, 1.8736e+00, 1.9318e+00, 3.8131e+05, 3.8521e+05, 3.9265e+05,
        3.9732e+05, 3.9750e+05, 3.9832e+05, 4.0197e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5961e+00, 1.7871e+00, 1.8313e+00, 1.8453e+00, 1.8736e+00,
        1.9259e+00, 1.9419e+00, 1.9658e+00, 3.8129e+05, 3.8521e+05, 3.9266e+05,
        3.9736e+05, 3.9743e+05, 3.9834e+05, 4.0199e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397426.5938, 397440.9062, 397451.9062, 397455.4062,
        397455.6875, 397459.8125, 397462.8750, 397471.2188, 397500.2500,
        779057.1250, 784460.4375, 787407.8750, 787797.8125, 788669.0000,
        793577.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397303.3438, 397313.8125, 397313.8750, 397316.1562,
        397337.5000, 397343.9375, 397349.2188, 397354.7188, 397363.5000,
        789806.4375, 793322.1250, 793577.5000, 794501.8750, 797307.8750,
        804944.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6320e+00, 1.7413e+00, 1.7589e+00, 1.7871e+00, 1.8371e+00,
        1.8434e+00, 1.9013e+00, 1.9099e+00, 3.8130e+05, 3.8521e+05, 3.9263e+05,
        3.9735e+05, 3.9746e+05, 3.9832e+05, 4.0200e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76652.84', '76653.08', '431154.50', '76651.00', '76653.05', '76652.80', '439352.00', '422200.31', '418684.53', '76655.95', '437208.75', '76653.93', '76651.30', '435618.16', '436580.25', '76651.70']
estimated f for each client, fs: [7, 7, 5, 7, 7, 7, 5, 5, 5, 7, 5, 7, 7, 5, 5, 7]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 2, 15, 11, 4, 10, 19, 16, 17, 8, 13, 1, 3, 20, 18, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:06...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:06, End: 2025-07-22 16:01:06)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 7, 9, 4, 10, 13, 14, 17, 3, 5, 6, 8, 12, 18, 15, 20], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.8064e+00, 1.8113e+00, 1.8743e+00, 1.8371e+00, 4.0228e+05,
         3.8352e+05, 3.9643e+05, 2.0251e+00, 1.9296e+00, 1.8996e+00, 2.0378e+00,
         1.7924e+00, 3.8501e+05, 3.9526e+05, 3.8885e+05],
        [1.8064e+00, 0.0000e+00, 1.7843e+00, 1.8084e+00, 1.6893e+00, 4.0228e+05,
         3.8353e+05, 3.9645e+05, 1.8016e+00, 1.7296e+00, 2.1087e+00, 1.9691e+00,
         1.6864e+00, 3.8502e+05, 3.9526e+05, 3.8884e+05],
        [1.8113e+00, 1.7843e+00, 0.0000e+00, 1.8102e+00, 1.8057e+00, 4.0228e+05,
         3.8349e+05, 3.9648e+05, 1.8206e+00, 1.9390e+00, 1.7397e+00, 1.8317e+00,
         1.7895e+00, 3.8505e+05, 3.9527e+05, 3.8887e+05],
        [1.8743e+00, 1.8084e+00, 1.8102e+00, 0.0000e+00, 1.9334e+00, 4.0227e+05,
         3.8352e+05, 3.9647e+05, 1.9584e+00, 1.9243e+00, 1.7440e+00, 1.8067e+00,
         1.7240e+00, 3.8504e+05, 3.9530e+05, 3.8883e+05],
        [1.8371e+00, 1.6893e+00, 1.8057e+00, 1.9334e+00, 0.0000e+00, 4.0227e+05,
         3.8356e+05, 3.9649e+05, 1.6712e+00, 1.8478e+00, 1.9535e+00, 1.9285e+00,
         1.6685e+00, 3.8501e+05, 3.9525e+05, 3.8885e+05],
        [4.0228e+05, 4.0228e+05, 4.0228e+05, 4.0227e+05, 4.0227e+05, 0.0000e+00,
         7.4977e+05, 7.9863e+05, 4.0226e+05, 4.0228e+05, 4.0228e+05, 4.0228e+05,
         4.0229e+05, 8.0892e+05, 7.9342e+05, 7.7342e+05],
        [3.8352e+05, 3.8353e+05, 3.8349e+05, 3.8352e+05, 3.8356e+05, 7.4977e+05,
         0.0000e+00, 7.9844e+05, 3.8352e+05, 3.8356e+05, 3.8351e+05, 3.8353e+05,
         3.8354e+05, 7.7034e+05, 7.6284e+05, 7.5887e+05],
        [3.9643e+05, 3.9645e+05, 3.9648e+05, 3.9647e+05, 3.9649e+05, 7.9863e+05,
         7.9844e+05, 0.0000e+00, 3.9648e+05, 3.9645e+05, 3.9648e+05, 3.9646e+05,
         3.9646e+05, 7.8294e+05, 7.7907e+05, 7.6563e+05],
        [2.0251e+00, 1.8016e+00, 1.8206e+00, 1.9584e+00, 1.6712e+00, 4.0226e+05,
         3.8352e+05, 3.9648e+05, 0.0000e+00, 1.8203e+00, 2.1630e+00, 2.0722e+00,
         1.6104e+00, 3.8502e+05, 3.9525e+05, 3.8886e+05],
        [1.9296e+00, 1.7296e+00, 1.9390e+00, 1.9243e+00, 1.8478e+00, 4.0228e+05,
         3.8356e+05, 3.9645e+05, 1.8203e+00, 0.0000e+00, 1.9784e+00, 2.0377e+00,
         1.8086e+00, 3.8503e+05, 3.9527e+05, 3.8888e+05],
        [1.8996e+00, 2.1087e+00, 1.7397e+00, 1.7440e+00, 1.9535e+00, 4.0228e+05,
         3.8351e+05, 3.9648e+05, 2.1630e+00, 1.9784e+00, 0.0000e+00, 1.8001e+00,
         1.9542e+00, 3.8503e+05, 3.9528e+05, 3.8889e+05],
        [2.0378e+00, 1.9691e+00, 1.8317e+00, 1.8067e+00, 1.9285e+00, 4.0228e+05,
         3.8353e+05, 3.9646e+05, 2.0722e+00, 2.0377e+00, 1.8001e+00, 0.0000e+00,
         1.9372e+00, 3.8505e+05, 3.9529e+05, 3.8885e+05],
        [1.7924e+00, 1.6864e+00, 1.7895e+00, 1.7240e+00, 1.6685e+00, 4.0229e+05,
         3.8354e+05, 3.9646e+05, 1.6104e+00, 1.8086e+00, 1.9542e+00, 1.9372e+00,
         0.0000e+00, 3.8502e+05, 3.9529e+05, 3.8885e+05],
        [3.8501e+05, 3.8502e+05, 3.8505e+05, 3.8504e+05, 3.8501e+05, 8.0892e+05,
         7.7034e+05, 7.8294e+05, 3.8502e+05, 3.8503e+05, 3.8503e+05, 3.8505e+05,
         3.8502e+05, 0.0000e+00, 7.8459e+05, 7.6535e+05],
        [3.9526e+05, 3.9526e+05, 3.9527e+05, 3.9530e+05, 3.9525e+05, 7.9342e+05,
         7.6284e+05, 7.7907e+05, 3.9525e+05, 3.9527e+05, 3.9528e+05, 3.9529e+05,
         3.9529e+05, 7.8459e+05, 0.0000e+00, 7.8845e+05],
        [3.8885e+05, 3.8884e+05, 3.8887e+05, 3.8883e+05, 3.8885e+05, 7.7342e+05,
         7.5887e+05, 7.6563e+05, 3.8886e+05, 3.8888e+05, 3.8889e+05, 3.8885e+05,
         3.8885e+05, 7.6535e+05, 7.8845e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.7924e+00, 1.8064e+00, 1.8113e+00, 1.8371e+00, 1.8743e+00,
        1.8996e+00, 1.9296e+00, 2.0251e+00, 2.0378e+00, 3.8352e+05, 3.8501e+05,
        3.8885e+05, 3.9526e+05, 3.9643e+05, 4.0228e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6864e+00, 1.6893e+00, 1.7296e+00, 1.7843e+00, 1.8016e+00,
        1.8064e+00, 1.8084e+00, 1.9691e+00, 2.1087e+00, 3.8353e+05, 3.8502e+05,
        3.8884e+05, 3.9526e+05, 3.9645e+05, 4.0228e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7397e+00, 1.7843e+00, 1.7895e+00, 1.8057e+00, 1.8102e+00,
        1.8113e+00, 1.8206e+00, 1.8317e+00, 1.9390e+00, 3.8349e+05, 3.8505e+05,
        3.8887e+05, 3.9527e+05, 3.9648e+05, 4.0228e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7240e+00, 1.7440e+00, 1.8067e+00, 1.8084e+00, 1.8102e+00,
        1.8743e+00, 1.9243e+00, 1.9334e+00, 1.9584e+00, 3.8352e+05, 3.8504e+05,
        3.8883e+05, 3.9530e+05, 3.9647e+05, 4.0227e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6685e+00, 1.6712e+00, 1.6893e+00, 1.8057e+00, 1.8371e+00,
        1.8478e+00, 1.9285e+00, 1.9334e+00, 1.9535e+00, 3.8356e+05, 3.8501e+05,
        3.8885e+05, 3.9525e+05, 3.9649e+05, 4.0227e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402261.9688, 402269.7812, 402273.8125, 402275.2500,
        402278.3750, 402280.7188, 402280.9688, 402281.1875, 402282.0312,
        402286.0000, 749771.6875, 773422.4375, 793419.2500, 798632.6250,
        808919.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383486.0312, 383505.7500, 383515.0938, 383516.2188,
        383523.0000, 383531.6250, 383534.2500, 383542.9062, 383559.2500,
        383564.0312, 749771.6875, 758870.4375, 762836.2500, 770335.1875,
        798443.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396426.4688, 396448.3125, 396448.3438, 396455.5312,
        396460.4062, 396470.8750, 396475.9062, 396479.5000, 396479.5312,
        396494.4688, 765626.3125, 779073.8125, 782940.5000, 798443.3125,
        798632.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6104e+00, 1.6712e+00, 1.8016e+00, 1.8203e+00, 1.8206e+00,
        1.9584e+00, 2.0251e+00, 2.0722e+00, 2.1630e+00, 3.8352e+05, 3.8502e+05,
        3.8886e+05, 3.9525e+05, 3.9648e+05, 4.0226e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7296e+00, 1.8086e+00, 1.8203e+00, 1.8478e+00, 1.9243e+00,
        1.9296e+00, 1.9390e+00, 1.9784e+00, 2.0377e+00, 3.8356e+05, 3.8503e+05,
        3.8888e+05, 3.9527e+05, 3.9645e+05, 4.0228e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7397e+00, 1.7440e+00, 1.8001e+00, 1.8996e+00, 1.9535e+00,
        1.9542e+00, 1.9784e+00, 2.1087e+00, 2.1630e+00, 3.8351e+05, 3.8503e+05,
        3.8889e+05, 3.9528e+05, 3.9648e+05, 4.0228e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8001e+00, 1.8067e+00, 1.8317e+00, 1.9285e+00, 1.9372e+00,
        1.9691e+00, 2.0377e+00, 2.0378e+00, 2.0722e+00, 3.8353e+05, 3.8505e+05,
        3.8885e+05, 3.9529e+05, 3.9646e+05, 4.0228e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6104e+00, 1.6685e+00, 1.6864e+00, 1.7240e+00, 1.7895e+00,
        1.7924e+00, 1.8086e+00, 1.9372e+00, 1.9542e+00, 3.8354e+05, 3.8502e+05,
        3.8885e+05, 3.9529e+05, 3.9646e+05, 4.0229e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385008.4062, 385012.0625, 385019.8125, 385023.5000,
        385023.8438, 385027.5625, 385027.8125, 385044.2812, 385045.3750,
        385052.3750, 765345.4375, 770335.1875, 782940.5000, 784586.2500,
        808919.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395247.1875, 395253.4062, 395256.0312, 395257.8125,
        395266.6875, 395274.8125, 395281.8125, 395287.6875, 395289.6562,
        395302.1250, 762836.2500, 779073.8125, 784586.2500, 788453.7500,
        793419.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388825.6250, 388840.4688, 388845.8750, 388848.5312,
        388849.9688, 388850.4688, 388856.3125, 388870.2500, 388882.1562,
        388886.5000, 758870.4375, 765345.4375, 765626.3125, 773422.4375,
        788453.7500])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38353.21', '38355.06', '38350.24', '38353.29', '38357.56', '402277.00', '383527.81', '396463.94', '38353.99', '38358.10', '38352.31', '38354.91', '38355.89', '385028.47', '395271.72', '388855.62']
estimated f for each client, fs: [6, 6, 6, 6, 6, 4, 4, 4, 6, 6, 6, 6, 6, 4, 4, 4]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 7, 9, 4, 10, 13, 14, 17, 3, 5, 6, 8, 12, 18, 15, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0139s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:07...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:07, End: 2025-07-22 16:01:07)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 9, 18, 6, 4, 16, 13, 19, 10, 12, 7, 1, 11, 3, 20, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0207e+05, 8.0849e+05, 4.0204e+05, 4.0204e+05, 7.8692e+05,
         7.6704e+05, 7.7257e+05, 4.0209e+05, 4.0207e+05, 4.0208e+05, 4.0206e+05,
         4.0208e+05, 4.0209e+05, 7.8256e+05, 4.0208e+05],
        [4.0207e+05, 0.0000e+00, 3.8790e+05, 1.9082e+00, 1.9508e+00, 3.8810e+05,
         3.8604e+05, 3.7734e+05, 1.7424e+00, 1.6748e+00, 1.7345e+00, 1.6894e+00,
         1.6745e+00, 1.7516e+00, 3.8628e+05, 1.9371e+00],
        [8.0849e+05, 3.8790e+05, 0.0000e+00, 3.8789e+05, 3.8790e+05, 7.8313e+05,
         7.7864e+05, 7.8336e+05, 3.8787e+05, 3.8792e+05, 3.8790e+05, 3.8790e+05,
         3.8786e+05, 3.8789e+05, 7.7474e+05, 3.8791e+05],
        [4.0204e+05, 1.9082e+00, 3.8789e+05, 0.0000e+00, 1.6327e+00, 3.8807e+05,
         3.8602e+05, 3.7739e+05, 1.8831e+00, 1.8323e+00, 1.8646e+00, 1.7329e+00,
         1.8358e+00, 2.0448e+00, 3.8626e+05, 1.6403e+00],
        [4.0204e+05, 1.9508e+00, 3.8790e+05, 1.6327e+00, 0.0000e+00, 3.8809e+05,
         3.8607e+05, 3.7739e+05, 1.9048e+00, 1.7155e+00, 1.7161e+00, 1.7631e+00,
         1.7256e+00, 1.9255e+00, 3.8629e+05, 1.6353e+00],
        [7.8692e+05, 3.8810e+05, 7.8313e+05, 3.8807e+05, 3.8809e+05, 0.0000e+00,
         7.6292e+05, 7.6505e+05, 3.8810e+05, 3.8814e+05, 3.8811e+05, 3.8810e+05,
         3.8811e+05, 3.8809e+05, 7.8438e+05, 3.8808e+05],
        [7.6704e+05, 3.8604e+05, 7.7864e+05, 3.8602e+05, 3.8607e+05, 7.6292e+05,
         0.0000e+00, 7.7355e+05, 3.8602e+05, 3.8603e+05, 3.8603e+05, 3.8606e+05,
         3.8604e+05, 3.8602e+05, 7.6795e+05, 3.8604e+05],
        [7.7257e+05, 3.7734e+05, 7.8336e+05, 3.7739e+05, 3.7739e+05, 7.6505e+05,
         7.7355e+05, 0.0000e+00, 3.7737e+05, 3.7736e+05, 3.7737e+05, 3.7738e+05,
         3.7735e+05, 3.7737e+05, 7.8000e+05, 3.7739e+05],
        [4.0209e+05, 1.7424e+00, 3.8787e+05, 1.8831e+00, 1.9048e+00, 3.8810e+05,
         3.8602e+05, 3.7737e+05, 0.0000e+00, 1.5777e+00, 1.6373e+00, 1.7292e+00,
         1.7346e+00, 1.6396e+00, 3.8627e+05, 1.7904e+00],
        [4.0207e+05, 1.6748e+00, 3.8792e+05, 1.8323e+00, 1.7155e+00, 3.8814e+05,
         3.8603e+05, 3.7736e+05, 1.5777e+00, 0.0000e+00, 1.5775e+00, 1.7171e+00,
         1.6872e+00, 1.5950e+00, 3.8630e+05, 1.8347e+00],
        [4.0208e+05, 1.7345e+00, 3.8790e+05, 1.8646e+00, 1.7161e+00, 3.8811e+05,
         3.8603e+05, 3.7737e+05, 1.6373e+00, 1.5775e+00, 0.0000e+00, 1.6685e+00,
         1.6615e+00, 1.7778e+00, 3.8630e+05, 1.8365e+00],
        [4.0206e+05, 1.6894e+00, 3.8790e+05, 1.7329e+00, 1.7631e+00, 3.8810e+05,
         3.8606e+05, 3.7738e+05, 1.7292e+00, 1.7171e+00, 1.6685e+00, 0.0000e+00,
         1.6593e+00, 1.9018e+00, 3.8629e+05, 1.8728e+00],
        [4.0208e+05, 1.6745e+00, 3.8786e+05, 1.8358e+00, 1.7256e+00, 3.8811e+05,
         3.8604e+05, 3.7735e+05, 1.7346e+00, 1.6872e+00, 1.6615e+00, 1.6593e+00,
         0.0000e+00, 1.8800e+00, 3.8627e+05, 1.8005e+00],
        [4.0209e+05, 1.7516e+00, 3.8789e+05, 2.0448e+00, 1.9255e+00, 3.8809e+05,
         3.8602e+05, 3.7737e+05, 1.6396e+00, 1.5950e+00, 1.7778e+00, 1.9018e+00,
         1.8800e+00, 0.0000e+00, 3.8628e+05, 1.9703e+00],
        [7.8256e+05, 3.8628e+05, 7.7474e+05, 3.8626e+05, 3.8629e+05, 7.8438e+05,
         7.6795e+05, 7.8000e+05, 3.8627e+05, 3.8630e+05, 3.8630e+05, 3.8629e+05,
         3.8627e+05, 3.8628e+05, 0.0000e+00, 3.8632e+05],
        [4.0208e+05, 1.9371e+00, 3.8791e+05, 1.6403e+00, 1.6353e+00, 3.8808e+05,
         3.8604e+05, 3.7739e+05, 1.7904e+00, 1.8347e+00, 1.8365e+00, 1.8728e+00,
         1.8005e+00, 1.9703e+00, 3.8632e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 402043.8438, 402044.0625, 402058.5312, 402070.4375,
        402070.5000, 402078.5312, 402080.1875, 402080.9688, 402091.2500,
        402092.3125, 767042.9375, 772568.5625, 782558.0625, 786915.9375,
        808490.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6745e+00, 1.6748e+00, 1.6894e+00, 1.7345e+00, 1.7424e+00,
        1.7516e+00, 1.9082e+00, 1.9371e+00, 1.9508e+00, 3.7734e+05, 3.8604e+05,
        3.8628e+05, 3.8790e+05, 3.8810e+05, 4.0207e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387861.0000, 387872.4375, 387886.0625, 387887.6562,
        387896.4062, 387898.2188, 387900.0000, 387902.3750, 387910.4688,
        387915.1250, 774737.6875, 778642.4375, 783125.8750, 783355.0625,
        808490.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6327e+00, 1.6403e+00, 1.7329e+00, 1.8323e+00, 1.8358e+00,
        1.8646e+00, 1.8831e+00, 1.9082e+00, 2.0448e+00, 3.7739e+05, 3.8602e+05,
        3.8626e+05, 3.8789e+05, 3.8807e+05, 4.0204e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6327e+00, 1.6353e+00, 1.7155e+00, 1.7161e+00, 1.7256e+00,
        1.7631e+00, 1.9048e+00, 1.9255e+00, 1.9508e+00, 3.7739e+05, 3.8607e+05,
        3.8629e+05, 3.8790e+05, 3.8809e+05, 4.0204e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388071.9062, 388081.9375, 388088.0000, 388089.5000,
        388098.6250, 388098.9062, 388101.8750, 388109.8125, 388111.6250,
        388140.7812, 762921.5000, 765050.1250, 783125.8750, 784375.9375,
        786915.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386017.2500, 386018.3438, 386022.1250, 386026.1250,
        386034.3438, 386038.8125, 386042.9375, 386044.9062, 386062.7188,
        386074.9375, 762921.5000, 767042.9375, 767952.7500, 773554.8125,
        778642.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377336.1875, 377346.0938, 377362.5938, 377370.6562,
        377371.7500, 377372.5938, 377376.0938, 377387.1250, 377387.3438,
        377392.1875, 765050.1250, 772568.5625, 773554.8125, 779996.3125,
        783355.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5777e+00, 1.6373e+00, 1.6396e+00, 1.7292e+00, 1.7346e+00,
        1.7424e+00, 1.7904e+00, 1.8831e+00, 1.9048e+00, 3.7737e+05, 3.8602e+05,
        3.8627e+05, 3.8787e+05, 3.8810e+05, 4.0209e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5775e+00, 1.5777e+00, 1.5950e+00, 1.6748e+00, 1.6872e+00,
        1.7155e+00, 1.7171e+00, 1.8323e+00, 1.8347e+00, 3.7736e+05, 3.8603e+05,
        3.8630e+05, 3.8792e+05, 3.8814e+05, 4.0207e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5775e+00, 1.6373e+00, 1.6615e+00, 1.6685e+00, 1.7161e+00,
        1.7345e+00, 1.7778e+00, 1.8365e+00, 1.8646e+00, 3.7737e+05, 3.8603e+05,
        3.8630e+05, 3.8790e+05, 3.8811e+05, 4.0208e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6593e+00, 1.6685e+00, 1.6894e+00, 1.7171e+00, 1.7292e+00,
        1.7329e+00, 1.7631e+00, 1.8728e+00, 1.9018e+00, 3.7738e+05, 3.8606e+05,
        3.8629e+05, 3.8790e+05, 3.8810e+05, 4.0206e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6593e+00, 1.6615e+00, 1.6745e+00, 1.6872e+00, 1.7256e+00,
        1.7346e+00, 1.8005e+00, 1.8358e+00, 1.8800e+00, 3.7735e+05, 3.8604e+05,
        3.8627e+05, 3.8786e+05, 3.8811e+05, 4.0208e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5950e+00, 1.6396e+00, 1.7516e+00, 1.7778e+00, 1.8800e+00,
        1.9018e+00, 1.9255e+00, 1.9703e+00, 2.0448e+00, 3.7737e+05, 3.8602e+05,
        3.8628e+05, 3.8789e+05, 3.8809e+05, 4.0209e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386264.1250, 386268.5312, 386269.6875, 386276.4375,
        386281.1875, 386288.0938, 386291.3750, 386298.0625, 386299.6875,
        386317.9062, 767952.7500, 774737.6875, 779996.3125, 782558.0625,
        784375.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6353e+00, 1.6403e+00, 1.7904e+00, 1.8005e+00, 1.8347e+00,
        1.8365e+00, 1.8728e+00, 1.9371e+00, 1.9703e+00, 3.7739e+05, 3.8604e+05,
        3.8632e+05, 3.8791e+05, 3.8808e+05, 4.0208e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['402071.06', '37735.23', '387893.00', '37740.85', '37740.33', '388099.31', '386038.25', '377370.25', '37738.62', '37737.78', '37738.72', '37739.18', '37736.18', '37738.91', '386285.50', '37740.34']
estimated f for each client, fs: [4, 6, 4, 6, 6, 4, 4, 5, 6, 6, 6, 6, 6, 6, 4, 6]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 9, 18, 6, 4, 16, 13, 19, 10, 12, 7, 1, 11, 3, 20, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0132s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:07...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:07, End: 2025-07-22 16:01:07)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 13, 18, 8, 20, 5, 6, 4, 19, 3, 9, 15, 1, 12, 16, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.8849e+05, 8.0313e+05, 3.9663e+05, 7.6266e+05, 3.9664e+05,
         3.9664e+05, 3.9663e+05, 7.7941e+05, 3.9665e+05, 3.9662e+05, 7.8720e+05,
         3.9660e+05, 3.9664e+05, 7.7179e+05, 3.9663e+05],
        [7.8849e+05, 0.0000e+00, 8.1679e+05, 4.0353e+05, 7.8254e+05, 4.0362e+05,
         4.0356e+05, 4.0357e+05, 7.8171e+05, 4.0356e+05, 4.0359e+05, 7.8559e+05,
         4.0358e+05, 4.0356e+05, 7.7083e+05, 4.0356e+05],
        [8.0313e+05, 8.1679e+05, 0.0000e+00, 4.0293e+05, 7.7829e+05, 4.0295e+05,
         4.0297e+05, 4.0296e+05, 7.7112e+05, 4.0298e+05, 4.0299e+05, 7.6723e+05,
         4.0299e+05, 4.0296e+05, 7.8816e+05, 4.0298e+05],
        [3.9663e+05, 4.0353e+05, 4.0293e+05, 0.0000e+00, 3.8158e+05, 1.5236e+00,
         1.3847e+00, 1.3740e+00, 3.7455e+05, 1.6490e+00, 2.1560e+00, 3.8391e+05,
         1.5902e+00, 1.5140e+00, 3.8108e+05, 1.5884e+00],
        [7.6266e+05, 7.8254e+05, 7.7829e+05, 3.8158e+05, 0.0000e+00, 3.8159e+05,
         3.8158e+05, 3.8158e+05, 7.3351e+05, 3.8162e+05, 3.8160e+05, 7.8646e+05,
         3.8159e+05, 3.8160e+05, 7.6350e+05, 3.8164e+05],
        [3.9664e+05, 4.0362e+05, 4.0295e+05, 1.5236e+00, 3.8159e+05, 0.0000e+00,
         1.4729e+00, 1.4463e+00, 3.7455e+05, 1.4993e+00, 2.0356e+00, 3.8393e+05,
         1.4270e+00, 1.4119e+00, 3.8108e+05, 1.4917e+00],
        [3.9664e+05, 4.0356e+05, 4.0297e+05, 1.3847e+00, 3.8158e+05, 1.4729e+00,
         0.0000e+00, 1.3555e+00, 3.7453e+05, 1.7278e+00, 2.1805e+00, 3.8391e+05,
         1.4769e+00, 1.5190e+00, 3.8111e+05, 1.4887e+00],
        [3.9663e+05, 4.0357e+05, 4.0296e+05, 1.3740e+00, 3.8158e+05, 1.4463e+00,
         1.3555e+00, 0.0000e+00, 3.7455e+05, 1.5815e+00, 2.1225e+00, 3.8395e+05,
         1.4745e+00, 1.4172e+00, 3.8110e+05, 1.5227e+00],
        [7.7941e+05, 7.8171e+05, 7.7112e+05, 3.7455e+05, 7.3351e+05, 3.7455e+05,
         3.7453e+05, 3.7455e+05, 0.0000e+00, 3.7458e+05, 3.7456e+05, 7.4828e+05,
         3.7452e+05, 3.7456e+05, 7.5084e+05, 3.7453e+05],
        [3.9665e+05, 4.0356e+05, 4.0298e+05, 1.6490e+00, 3.8162e+05, 1.4993e+00,
         1.7278e+00, 1.5815e+00, 3.7458e+05, 0.0000e+00, 1.6957e+00, 3.8392e+05,
         1.5792e+00, 1.3680e+00, 3.8107e+05, 1.5120e+00],
        [3.9662e+05, 4.0359e+05, 4.0299e+05, 2.1560e+00, 3.8160e+05, 2.0356e+00,
         2.1805e+00, 2.1225e+00, 3.7456e+05, 1.6957e+00, 0.0000e+00, 3.8390e+05,
         1.7706e+00, 1.6952e+00, 3.8107e+05, 1.6887e+00],
        [7.8720e+05, 7.8559e+05, 7.6723e+05, 3.8391e+05, 7.8646e+05, 3.8393e+05,
         3.8391e+05, 3.8395e+05, 7.4828e+05, 3.8392e+05, 3.8390e+05, 0.0000e+00,
         3.8395e+05, 3.8393e+05, 7.6876e+05, 3.8393e+05],
        [3.9660e+05, 4.0358e+05, 4.0299e+05, 1.5902e+00, 3.8159e+05, 1.4270e+00,
         1.4769e+00, 1.4745e+00, 3.7452e+05, 1.5792e+00, 1.7706e+00, 3.8395e+05,
         0.0000e+00, 1.3879e+00, 3.8111e+05, 1.4011e+00],
        [3.9664e+05, 4.0356e+05, 4.0296e+05, 1.5140e+00, 3.8160e+05, 1.4119e+00,
         1.5190e+00, 1.4172e+00, 3.7456e+05, 1.3680e+00, 1.6952e+00, 3.8393e+05,
         1.3879e+00, 0.0000e+00, 3.8111e+05, 1.3470e+00],
        [7.7179e+05, 7.7083e+05, 7.8816e+05, 3.8108e+05, 7.6350e+05, 3.8108e+05,
         3.8111e+05, 3.8110e+05, 7.5084e+05, 3.8107e+05, 3.8107e+05, 7.6876e+05,
         3.8111e+05, 3.8111e+05, 0.0000e+00, 3.8108e+05],
        [3.9663e+05, 4.0356e+05, 4.0298e+05, 1.5884e+00, 3.8164e+05, 1.4917e+00,
         1.4887e+00, 1.5227e+00, 3.7453e+05, 1.5120e+00, 1.6887e+00, 3.8393e+05,
         1.4011e+00, 1.3470e+00, 3.8108e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 396597.8438, 396619.8750, 396628.0625, 396630.3750,
        396632.2500, 396635.7812, 396636.2188, 396643.5312, 396648.9375,
        762661.0625, 771788.9375, 779406.4375, 787201.8750, 788492.6250,
        803127.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403526.3750, 403557.6875, 403561.1250, 403562.0000,
        403564.0312, 403566.2500, 403575.6250, 403587.5312, 403619.2500,
        770827.1250, 781708.1250, 782535.8750, 785585.0625, 788492.6250,
        816785.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402932.3125, 402954.3750, 402960.3750, 402962.2500,
        402965.6250, 402979.7812, 402980.5938, 402986.3438, 402988.4688,
        767227.2500, 771123.6250, 778286.8125, 788164.5000, 803127.1250,
        816785.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3740e+00, 1.3847e+00, 1.5140e+00, 1.5236e+00, 1.5884e+00,
        1.5902e+00, 1.6490e+00, 2.1560e+00, 3.7455e+05, 3.8108e+05, 3.8158e+05,
        3.8391e+05, 3.9663e+05, 4.0293e+05, 4.0353e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381581.7500, 381584.2812, 381584.4375, 381588.8750,
        381591.9688, 381599.8750, 381600.2188, 381620.3125, 381636.7812,
        733509.1250, 762661.0625, 763496.2500, 778286.8125, 782535.8750,
        786463.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4119e+00, 1.4270e+00, 1.4463e+00, 1.4729e+00, 1.4917e+00,
        1.4993e+00, 1.5236e+00, 2.0356e+00, 3.7455e+05, 3.8108e+05, 3.8159e+05,
        3.8393e+05, 3.9664e+05, 4.0295e+05, 4.0362e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3555e+00, 1.3847e+00, 1.4729e+00, 1.4769e+00, 1.4887e+00,
        1.5190e+00, 1.7278e+00, 2.1805e+00, 3.7453e+05, 3.8111e+05, 3.8158e+05,
        3.8391e+05, 3.9664e+05, 4.0297e+05, 4.0356e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3555e+00, 1.3740e+00, 1.4172e+00, 1.4463e+00, 1.4745e+00,
        1.5227e+00, 1.5815e+00, 2.1225e+00, 3.7455e+05, 3.8110e+05, 3.8158e+05,
        3.8395e+05, 3.9663e+05, 4.0296e+05, 4.0357e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374519.6875, 374528.3125, 374533.6562, 374549.1562,
        374553.9688, 374554.7188, 374555.0938, 374560.2812, 374576.3750,
        733509.1250, 748280.3750, 750841.8125, 771123.6250, 779406.4375,
        781708.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3680e+00, 1.4993e+00, 1.5120e+00, 1.5792e+00, 1.5815e+00,
        1.6490e+00, 1.6957e+00, 1.7278e+00, 3.7458e+05, 3.8107e+05, 3.8162e+05,
        3.8392e+05, 3.9665e+05, 4.0298e+05, 4.0356e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6887e+00, 1.6952e+00, 1.6957e+00, 1.7706e+00, 2.0356e+00,
        2.1225e+00, 2.1560e+00, 2.1805e+00, 3.7456e+05, 3.8107e+05, 3.8160e+05,
        3.8390e+05, 3.9662e+05, 4.0299e+05, 4.0359e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383900.4375, 383906.1250, 383912.0625, 383923.1875,
        383926.8750, 383927.6250, 383928.7500, 383951.6875, 383954.1875,
        748280.3750, 767227.2500, 768760.8750, 785585.0625, 786463.9375,
        787201.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3879e+00, 1.4011e+00, 1.4270e+00, 1.4745e+00, 1.4769e+00,
        1.5792e+00, 1.5902e+00, 1.7706e+00, 3.7452e+05, 3.8111e+05, 3.8159e+05,
        3.8395e+05, 3.9660e+05, 4.0299e+05, 4.0358e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3470e+00, 1.3680e+00, 1.3879e+00, 1.4119e+00, 1.4172e+00,
        1.5140e+00, 1.5190e+00, 1.6952e+00, 3.7456e+05, 3.8111e+05, 3.8160e+05,
        3.8393e+05, 3.9664e+05, 4.0296e+05, 4.0356e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381065.4688, 381065.9375, 381082.0938, 381082.5938,
        381084.9062, 381095.3125, 381105.0938, 381107.3125, 381108.4375,
        750841.8125, 763496.2500, 768760.8750, 770827.1250, 771788.9375,
        788164.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3470e+00, 1.4011e+00, 1.4887e+00, 1.4917e+00, 1.5120e+00,
        1.5227e+00, 1.5884e+00, 1.6887e+00, 3.7453e+05, 3.8108e+05, 3.8164e+05,
        3.8393e+05, 3.9663e+05, 4.0298e+05, 4.0356e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['433233.41', '440294.69', '439393.69', '75564.99', '416789.75', '75564.64', '75565.14', '75566.16', '410444.06', '75565.48', '75564.11', '420361.16', '75563.91', '75567.52', '418063.88', '75562.23']
estimated f for each client, fs: [5, 5, 5, 7, 5, 7, 7, 7, 5, 7, 7, 5, 7, 7, 5, 7]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [14, 13, 18, 8, 20, 5, 6, 4, 19, 3, 9, 15, 1, 12, 16, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0287s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:08...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:08, End: 2025-07-22 16:01:08)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 4, 6, 18, 14, 20, 19, 9, 2, 15, 1, 8, 11, 17, 13, 7], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6046e+00, 1.7322e+00, 4.0286e+05, 3.8883e+05, 3.8506e+05,
         3.8497e+05, 1.5291e+00, 1.6506e+00, 3.8639e+05, 1.6289e+00, 1.6963e+00,
         1.6268e+00, 3.9960e+05, 3.9369e+05, 1.5198e+00],
        [1.6046e+00, 0.0000e+00, 1.4728e+00, 4.0285e+05, 3.8887e+05, 3.8507e+05,
         3.8501e+05, 1.9832e+00, 1.8933e+00, 3.8636e+05, 1.5969e+00, 1.4536e+00,
         1.4992e+00, 3.9955e+05, 3.9371e+05, 1.5306e+00],
        [1.7322e+00, 1.4728e+00, 0.0000e+00, 4.0284e+05, 3.8887e+05, 3.8508e+05,
         3.8499e+05, 1.9692e+00, 1.9409e+00, 3.8635e+05, 1.5785e+00, 1.4392e+00,
         1.6021e+00, 3.9955e+05, 3.9370e+05, 1.6772e+00],
        [4.0286e+05, 4.0285e+05, 4.0284e+05, 0.0000e+00, 7.7829e+05, 7.9816e+05,
         7.8279e+05, 4.0285e+05, 4.0282e+05, 7.7144e+05, 4.0284e+05, 4.0284e+05,
         4.0284e+05, 8.1783e+05, 7.8725e+05, 4.0283e+05],
        [3.8883e+05, 3.8887e+05, 3.8887e+05, 7.7829e+05, 0.0000e+00, 7.7219e+05,
         7.6436e+05, 3.8884e+05, 3.8883e+05, 7.5527e+05, 3.8884e+05, 3.8886e+05,
         3.8885e+05, 8.1224e+05, 7.6489e+05, 3.8887e+05],
        [3.8506e+05, 3.8507e+05, 3.8508e+05, 7.9816e+05, 7.7219e+05, 0.0000e+00,
         7.5328e+05, 3.8507e+05, 3.8507e+05, 7.6887e+05, 3.8509e+05, 3.8506e+05,
         3.8510e+05, 7.8439e+05, 7.9561e+05, 3.8507e+05],
        [3.8497e+05, 3.8501e+05, 3.8499e+05, 7.8279e+05, 7.6436e+05, 7.5328e+05,
         0.0000e+00, 3.8497e+05, 3.8498e+05, 7.5862e+05, 3.8498e+05, 3.8497e+05,
         3.8499e+05, 7.7294e+05, 7.7170e+05, 3.8498e+05],
        [1.5291e+00, 1.9832e+00, 1.9692e+00, 4.0285e+05, 3.8884e+05, 3.8507e+05,
         3.8497e+05, 0.0000e+00, 1.3155e+00, 3.8638e+05, 1.5732e+00, 1.9748e+00,
         1.6448e+00, 3.9960e+05, 3.9374e+05, 1.6101e+00],
        [1.6506e+00, 1.8933e+00, 1.9409e+00, 4.0282e+05, 3.8883e+05, 3.8507e+05,
         3.8498e+05, 1.3155e+00, 0.0000e+00, 3.8638e+05, 1.6525e+00, 1.9988e+00,
         1.6712e+00, 3.9961e+05, 3.9370e+05, 1.5637e+00],
        [3.8639e+05, 3.8636e+05, 3.8635e+05, 7.7144e+05, 7.5527e+05, 7.6887e+05,
         7.5862e+05, 3.8638e+05, 3.8638e+05, 0.0000e+00, 3.8636e+05, 3.8638e+05,
         3.8637e+05, 7.8409e+05, 7.8422e+05, 3.8637e+05],
        [1.6289e+00, 1.5969e+00, 1.5785e+00, 4.0284e+05, 3.8884e+05, 3.8509e+05,
         3.8498e+05, 1.5732e+00, 1.6525e+00, 3.8636e+05, 0.0000e+00, 1.6116e+00,
         1.4130e+00, 3.9955e+05, 3.9371e+05, 1.4972e+00],
        [1.6963e+00, 1.4536e+00, 1.4392e+00, 4.0284e+05, 3.8886e+05, 3.8506e+05,
         3.8497e+05, 1.9748e+00, 1.9988e+00, 3.8638e+05, 1.6116e+00, 0.0000e+00,
         1.5029e+00, 3.9960e+05, 3.9372e+05, 1.6205e+00],
        [1.6268e+00, 1.4992e+00, 1.6021e+00, 4.0284e+05, 3.8885e+05, 3.8510e+05,
         3.8499e+05, 1.6448e+00, 1.6712e+00, 3.8637e+05, 1.4130e+00, 1.5029e+00,
         0.0000e+00, 3.9957e+05, 3.9369e+05, 1.5015e+00],
        [3.9960e+05, 3.9955e+05, 3.9955e+05, 8.1783e+05, 8.1224e+05, 7.8439e+05,
         7.7294e+05, 3.9960e+05, 3.9961e+05, 7.8409e+05, 3.9955e+05, 3.9960e+05,
         3.9957e+05, 0.0000e+00, 8.0170e+05, 3.9959e+05],
        [3.9369e+05, 3.9371e+05, 3.9370e+05, 7.8725e+05, 7.6489e+05, 7.9561e+05,
         7.7170e+05, 3.9374e+05, 3.9370e+05, 7.8422e+05, 3.9371e+05, 3.9372e+05,
         3.9369e+05, 8.0170e+05, 0.0000e+00, 3.9372e+05],
        [1.5198e+00, 1.5306e+00, 1.6772e+00, 4.0283e+05, 3.8887e+05, 3.8507e+05,
         3.8498e+05, 1.6101e+00, 1.5637e+00, 3.8637e+05, 1.4972e+00, 1.6205e+00,
         1.5015e+00, 3.9959e+05, 3.9372e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5198e+00, 1.5291e+00, 1.6046e+00, 1.6268e+00, 1.6289e+00,
        1.6506e+00, 1.6963e+00, 1.7322e+00, 3.8497e+05, 3.8506e+05, 3.8639e+05,
        3.8883e+05, 3.9369e+05, 3.9960e+05, 4.0286e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4536e+00, 1.4728e+00, 1.4992e+00, 1.5306e+00, 1.5969e+00,
        1.6046e+00, 1.8933e+00, 1.9832e+00, 3.8501e+05, 3.8507e+05, 3.8636e+05,
        3.8887e+05, 3.9371e+05, 3.9955e+05, 4.0285e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4392e+00, 1.4728e+00, 1.5785e+00, 1.6021e+00, 1.6772e+00,
        1.7322e+00, 1.9409e+00, 1.9692e+00, 3.8499e+05, 3.8508e+05, 3.8635e+05,
        3.8887e+05, 3.9370e+05, 3.9955e+05, 4.0284e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402824.3125, 402833.8125, 402837.8438, 402839.8750,
        402841.1562, 402844.0312, 402846.0625, 402847.7500, 402858.3125,
        771440.0625, 778290.3125, 782790.9375, 787246.7500, 798162.9375,
        817830.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388831.6250, 388834.4375, 388835.0312, 388840.9688,
        388850.8438, 388857.1875, 388867.2500, 388868.3438, 388873.7500,
        755265.0625, 764359.2500, 764885.9375, 772193.0625, 778290.3125,
        812242.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385057.2188, 385060.2188, 385067.7812, 385068.5938,
        385068.7812, 385073.2188, 385079.0625, 385086.6250, 385097.7500,
        753275.6250, 768866.9375, 772193.0625, 784394.9375, 795606.0000,
        798162.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384968.5312, 384971.7500, 384974.8750, 384981.6250,
        384984.3125, 384984.6562, 384989.4688, 384994.0938, 385014.4062,
        753275.6250, 758622.8125, 764359.2500, 771696.3750, 772939.5625,
        782790.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3155e+00, 1.5291e+00, 1.5732e+00, 1.6101e+00, 1.6448e+00,
        1.9692e+00, 1.9748e+00, 1.9832e+00, 3.8497e+05, 3.8507e+05, 3.8638e+05,
        3.8884e+05, 3.9374e+05, 3.9960e+05, 4.0285e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3155e+00, 1.5637e+00, 1.6506e+00, 1.6525e+00, 1.6712e+00,
        1.8933e+00, 1.9409e+00, 1.9988e+00, 3.8498e+05, 3.8507e+05, 3.8638e+05,
        3.8883e+05, 3.9370e+05, 3.9961e+05, 4.0282e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386352.0000, 386359.4688, 386359.9375, 386369.7188,
        386373.8125, 386375.0625, 386383.7500, 386384.2188, 386385.9062,
        755265.0625, 758622.8125, 768866.9375, 771440.0625, 784092.4375,
        784218.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4130e+00, 1.4972e+00, 1.5732e+00, 1.5785e+00, 1.5969e+00,
        1.6116e+00, 1.6289e+00, 1.6525e+00, 3.8498e+05, 3.8509e+05, 3.8636e+05,
        3.8884e+05, 3.9371e+05, 3.9955e+05, 4.0284e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4392e+00, 1.4536e+00, 1.5029e+00, 1.6116e+00, 1.6205e+00,
        1.6963e+00, 1.9748e+00, 1.9988e+00, 3.8497e+05, 3.8506e+05, 3.8638e+05,
        3.8886e+05, 3.9372e+05, 3.9960e+05, 4.0284e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4130e+00, 1.4992e+00, 1.5015e+00, 1.5029e+00, 1.6021e+00,
        1.6268e+00, 1.6448e+00, 1.6712e+00, 3.8499e+05, 3.8510e+05, 3.8637e+05,
        3.8885e+05, 3.9369e+05, 3.9957e+05, 4.0284e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399547.1562, 399552.0625, 399554.3438, 399572.0000,
        399589.5625, 399595.2500, 399596.1875, 399600.3750, 399606.0312,
        772939.5625, 784092.4375, 784394.9375, 801696.6250, 812242.5625,
        817830.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393690.5625, 393694.5000, 393697.9688, 393702.7500,
        393706.6875, 393707.6875, 393719.2500, 393720.7812, 393739.0938,
        764885.9375, 771696.3750, 784218.1250, 787246.7500, 795606.0000,
        801696.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4972e+00, 1.5015e+00, 1.5198e+00, 1.5306e+00, 1.5637e+00,
        1.6101e+00, 1.6205e+00, 1.6772e+00, 3.8498e+05, 3.8507e+05, 3.8637e+05,
        3.8887e+05, 3.9372e+05, 3.9959e+05, 4.0283e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77004.51', '77010.07', '77008.66', '439701.31', '425492.44', '421893.50', '421813.91', '77004.99', '77006.65', '423260.91', '77008.08', '77004.53', '77009.98', '436915.25', '430826.56', '77006.59']
estimated f for each client, fs: [7, 7, 7, 5, 5, 5, 5, 7, 7, 5, 7, 7, 7, 5, 5, 7]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 4, 6, 18, 14, 20, 19, 9, 2, 15, 1, 8, 11, 17, 13, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0116s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:09...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 16:01:09, End: 2025-07-22 16:01:09)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 1, 19, 6, 14, 12, 3, 5, 9, 7, 8, 20, 11, 18, 17, 2], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0163e+05, 7.8659e+05, 4.0163e+05, 8.0465e+05, 4.0164e+05,
         4.0159e+05, 4.0162e+05, 4.0162e+05, 4.0165e+05, 4.0165e+05, 8.2090e+05,
         4.0164e+05, 7.8983e+05, 8.0620e+05, 4.0161e+05],
        [4.0163e+05, 0.0000e+00, 3.8910e+05, 1.4305e+00, 3.9801e+05, 1.3834e+00,
         1.8489e+00, 1.4663e+00, 1.5836e+00, 1.4303e+00, 1.4973e+00, 4.0497e+05,
         1.3084e+00, 3.9099e+05, 4.1047e+05, 1.5402e+00],
        [7.8659e+05, 3.8910e+05, 0.0000e+00, 3.8915e+05, 7.7562e+05, 3.8909e+05,
         3.8911e+05, 3.8915e+05, 3.8910e+05, 3.8912e+05, 3.8913e+05, 7.9236e+05,
         3.8913e+05, 7.8076e+05, 8.2340e+05, 3.8911e+05],
        [4.0163e+05, 1.4305e+00, 3.8915e+05, 0.0000e+00, 3.9803e+05, 1.5719e+00,
         2.2196e+00, 1.5518e+00, 1.9371e+00, 1.5974e+00, 1.3695e+00, 4.0504e+05,
         1.4607e+00, 3.9098e+05, 4.1044e+05, 1.7847e+00],
        [8.0465e+05, 3.9801e+05, 7.7562e+05, 3.9803e+05, 0.0000e+00, 3.9801e+05,
         3.9798e+05, 3.9804e+05, 3.9798e+05, 3.9801e+05, 3.9804e+05, 8.2185e+05,
         3.9803e+05, 7.9186e+05, 8.1946e+05, 3.9800e+05],
        [4.0164e+05, 1.3834e+00, 3.8909e+05, 1.5719e+00, 3.9801e+05, 0.0000e+00,
         1.6055e+00, 1.4924e+00, 1.5043e+00, 1.4011e+00, 1.5488e+00, 4.0507e+05,
         1.3979e+00, 3.9100e+05, 4.1045e+05, 1.4720e+00],
        [4.0159e+05, 1.8489e+00, 3.8911e+05, 2.2196e+00, 3.9798e+05, 1.6055e+00,
         0.0000e+00, 1.9110e+00, 1.4445e+00, 1.7738e+00, 2.1121e+00, 4.0504e+05,
         1.8702e+00, 3.9099e+05, 4.1045e+05, 1.5314e+00],
        [4.0162e+05, 1.4663e+00, 3.8915e+05, 1.5518e+00, 3.9804e+05, 1.4924e+00,
         1.9110e+00, 0.0000e+00, 1.8508e+00, 1.4375e+00, 1.6212e+00, 4.0502e+05,
         1.3465e+00, 3.9099e+05, 4.1046e+05, 1.7684e+00],
        [4.0162e+05, 1.5836e+00, 3.8910e+05, 1.9371e+00, 3.9798e+05, 1.5043e+00,
         1.4445e+00, 1.8508e+00, 0.0000e+00, 1.6011e+00, 1.9072e+00, 4.0506e+05,
         1.5851e+00, 3.9100e+05, 4.1048e+05, 1.2783e+00],
        [4.0165e+05, 1.4303e+00, 3.8912e+05, 1.5974e+00, 3.9801e+05, 1.4011e+00,
         1.7738e+00, 1.4375e+00, 1.6011e+00, 0.0000e+00, 1.5756e+00, 4.0502e+05,
         1.3904e+00, 3.9100e+05, 4.1042e+05, 1.4304e+00],
        [4.0165e+05, 1.4973e+00, 3.8913e+05, 1.3695e+00, 3.9804e+05, 1.5488e+00,
         2.1121e+00, 1.6212e+00, 1.9072e+00, 1.5756e+00, 0.0000e+00, 4.0504e+05,
         1.4808e+00, 3.9098e+05, 4.1044e+05, 1.8370e+00],
        [8.2090e+05, 4.0497e+05, 7.9236e+05, 4.0504e+05, 8.2185e+05, 4.0507e+05,
         4.0504e+05, 4.0502e+05, 4.0506e+05, 4.0502e+05, 4.0504e+05, 0.0000e+00,
         4.0503e+05, 8.0360e+05, 8.2519e+05, 4.0505e+05],
        [4.0164e+05, 1.3084e+00, 3.8913e+05, 1.4607e+00, 3.9803e+05, 1.3979e+00,
         1.8702e+00, 1.3465e+00, 1.5851e+00, 1.3904e+00, 1.4808e+00, 4.0503e+05,
         0.0000e+00, 3.9096e+05, 4.1044e+05, 1.4655e+00],
        [7.8983e+05, 3.9099e+05, 7.8076e+05, 3.9098e+05, 7.9186e+05, 3.9100e+05,
         3.9099e+05, 3.9099e+05, 3.9100e+05, 3.9100e+05, 3.9098e+05, 8.0360e+05,
         3.9096e+05, 0.0000e+00, 8.1818e+05, 3.9098e+05],
        [8.0620e+05, 4.1047e+05, 8.2340e+05, 4.1044e+05, 8.1946e+05, 4.1045e+05,
         4.1045e+05, 4.1046e+05, 4.1048e+05, 4.1042e+05, 4.1044e+05, 8.2519e+05,
         4.1044e+05, 8.1818e+05, 0.0000e+00, 4.1045e+05],
        [4.0161e+05, 1.5402e+00, 3.8911e+05, 1.7847e+00, 3.9800e+05, 1.4720e+00,
         1.5314e+00, 1.7684e+00, 1.2783e+00, 1.4304e+00, 1.8370e+00, 4.0505e+05,
         1.4655e+00, 3.9098e+05, 4.1045e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 401593.9688, 401605.6250, 401619.0938, 401620.0625,
        401629.9062, 401634.7188, 401639.0625, 401640.6562, 401645.0312,
        401647.0000, 786588.6250, 789825.0625, 804645.6875, 806198.1250,
        820899.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3084e+00, 1.3834e+00, 1.4303e+00, 1.4305e+00, 1.4663e+00,
        1.4973e+00, 1.5402e+00, 1.5836e+00, 1.8489e+00, 3.8910e+05, 3.9099e+05,
        3.9801e+05, 4.0163e+05, 4.0497e+05, 4.1047e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389085.0938, 389095.2500, 389095.5938, 389106.0625,
        389106.2188, 389124.6250, 389127.2188, 389133.0625, 389146.7188,
        389153.6875, 775618.4375, 780764.8750, 786588.6250, 792355.0625,
        823400.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3695e+00, 1.4305e+00, 1.4607e+00, 1.5518e+00, 1.5719e+00,
        1.5974e+00, 1.7847e+00, 1.9371e+00, 2.2196e+00, 3.8915e+05, 3.9098e+05,
        3.9803e+05, 4.0163e+05, 4.0504e+05, 4.1044e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397979.9375, 397981.4688, 398001.3125, 398007.1562,
        398008.5000, 398014.3125, 398031.4062, 398033.0000, 398041.2500,
        398042.0938, 775618.4375, 791862.0625, 804645.6875, 819457.7500,
        821853.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3834e+00, 1.3979e+00, 1.4011e+00, 1.4720e+00, 1.4924e+00,
        1.5043e+00, 1.5488e+00, 1.5719e+00, 1.6055e+00, 3.8909e+05, 3.9100e+05,
        3.9801e+05, 4.0164e+05, 4.0507e+05, 4.1045e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4445e+00, 1.5314e+00, 1.6055e+00, 1.7738e+00, 1.8489e+00,
        1.8702e+00, 1.9110e+00, 2.1121e+00, 2.2196e+00, 3.8911e+05, 3.9099e+05,
        3.9798e+05, 4.0159e+05, 4.0504e+05, 4.1045e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3465e+00, 1.4375e+00, 1.4663e+00, 1.4924e+00, 1.5518e+00,
        1.6212e+00, 1.7684e+00, 1.8508e+00, 1.9110e+00, 3.8915e+05, 3.9099e+05,
        3.9804e+05, 4.0162e+05, 4.0502e+05, 4.1046e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2783e+00, 1.4445e+00, 1.5043e+00, 1.5836e+00, 1.5851e+00,
        1.6011e+00, 1.8508e+00, 1.9072e+00, 1.9371e+00, 3.8910e+05, 3.9100e+05,
        3.9798e+05, 4.0162e+05, 4.0506e+05, 4.1048e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3904e+00, 1.4011e+00, 1.4303e+00, 1.4304e+00, 1.4375e+00,
        1.5756e+00, 1.5974e+00, 1.6011e+00, 1.7738e+00, 3.8912e+05, 3.9100e+05,
        3.9801e+05, 4.0165e+05, 4.0502e+05, 4.1042e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3695e+00, 1.4808e+00, 1.4973e+00, 1.5488e+00, 1.5756e+00,
        1.6212e+00, 1.8370e+00, 1.9072e+00, 2.1121e+00, 3.8913e+05, 3.9098e+05,
        3.9804e+05, 4.0165e+05, 4.0504e+05, 4.1044e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404974.1250, 405020.6875, 405021.8438, 405033.7188,
        405041.3125, 405041.8125, 405044.5938, 405045.5312, 405055.2188,
        405072.5938, 792355.0625, 803603.0625, 820899.1875, 821853.6875,
        825189.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3084e+00, 1.3465e+00, 1.3904e+00, 1.3979e+00, 1.4607e+00,
        1.4655e+00, 1.4808e+00, 1.5851e+00, 1.8702e+00, 3.8913e+05, 3.9096e+05,
        3.9803e+05, 4.0164e+05, 4.0503e+05, 4.1044e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390963.0938, 390977.9688, 390979.0938, 390980.9062,
        390985.2188, 390987.0312, 390989.5625, 390998.1875, 391000.7188,
        391004.0938, 780764.8750, 789825.0625, 791862.0625, 803603.0625,
        818177.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 410424.4375, 410440.0625, 410443.3750, 410443.5312,
        410448.6875, 410449.0625, 410450.8125, 410456.8438, 410466.0625,
        410477.6875, 806198.1250, 818177.6250, 819457.7500, 823400.6250,
        825189.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2783e+00, 1.4304e+00, 1.4655e+00, 1.4720e+00, 1.5314e+00,
        1.5402e+00, 1.7684e+00, 1.7847e+00, 1.8370e+00, 3.8911e+05, 3.9098e+05,
        3.9800e+05, 4.0161e+05, 4.0505e+05, 4.1045e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['401627.53', '38910.91', '389117.38', '38916.16', '398014.06', '38909.85', '38912.24', '38916.82', '38910.99', '38913.82', '38914.80', '405035.12', '38914.05', '390986.59', '410450.06', '38912.04']
estimated f for each client, fs: [4, 6, 4, 6, 4, 6, 6, 6, 6, 6, 6, 4, 6, 4, 4, 6]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 1, 19, 6, 14, 12, 3, 5, 9, 7, 8, 20, 11, 18, 17, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0111s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:09...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:09, End: 2025-07-22 16:01:09)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 18, 9, 8, 19, 20, 14, 1, 7, 5, 15, 6, 16, 4, 3, 11], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9025e+05, 1.4238e+00, 1.4741e+00, 3.8436e+05, 3.7475e+05,
         4.0589e+05, 1.3921e+00, 1.3856e+00, 1.4661e+00, 3.7740e+05, 1.5493e+00,
         3.9903e+05, 1.5888e+00, 1.5833e+00, 1.3548e+00],
        [3.9025e+05, 0.0000e+00, 3.9022e+05, 3.9026e+05, 7.6981e+05, 7.5129e+05,
         7.8811e+05, 3.9025e+05, 3.9025e+05, 3.9024e+05, 7.8028e+05, 3.9025e+05,
         7.8930e+05, 3.9024e+05, 3.9024e+05, 3.9024e+05],
        [1.4238e+00, 3.9022e+05, 0.0000e+00, 1.6442e+00, 3.8437e+05, 3.7475e+05,
         4.0592e+05, 1.4110e+00, 1.4276e+00, 1.6245e+00, 3.7740e+05, 1.7125e+00,
         3.9903e+05, 1.6585e+00, 1.2088e+00, 1.4140e+00],
        [1.4741e+00, 3.9026e+05, 1.6442e+00, 0.0000e+00, 3.8437e+05, 3.7477e+05,
         4.0590e+05, 1.4162e+00, 1.4691e+00, 1.5286e+00, 3.7736e+05, 1.2949e+00,
         3.9907e+05, 1.3322e+00, 1.8637e+00, 1.3186e+00],
        [3.8436e+05, 7.6981e+05, 3.8437e+05, 3.8437e+05, 0.0000e+00, 7.6697e+05,
         8.2097e+05, 3.8436e+05, 3.8438e+05, 3.8439e+05, 7.5209e+05, 3.8437e+05,
         7.8902e+05, 3.8439e+05, 3.8437e+05, 3.8440e+05],
        [3.7475e+05, 7.5129e+05, 3.7475e+05, 3.7477e+05, 7.6697e+05, 0.0000e+00,
         7.6004e+05, 3.7478e+05, 3.7473e+05, 3.7481e+05, 7.7431e+05, 3.7478e+05,
         7.6960e+05, 3.7476e+05, 3.7473e+05, 3.7475e+05],
        [4.0589e+05, 7.8811e+05, 4.0592e+05, 4.0590e+05, 8.2097e+05, 7.6004e+05,
         0.0000e+00, 4.0592e+05, 4.0592e+05, 4.0592e+05, 8.0104e+05, 4.0596e+05,
         8.0767e+05, 4.0592e+05, 4.0594e+05, 4.0593e+05],
        [1.3921e+00, 3.9025e+05, 1.4110e+00, 1.4162e+00, 3.8436e+05, 3.7478e+05,
         4.0592e+05, 0.0000e+00, 1.4301e+00, 1.4458e+00, 3.7733e+05, 1.3738e+00,
         3.9903e+05, 1.4056e+00, 1.6327e+00, 1.3067e+00],
        [1.3856e+00, 3.9025e+05, 1.4276e+00, 1.4691e+00, 3.8438e+05, 3.7473e+05,
         4.0592e+05, 1.4301e+00, 0.0000e+00, 1.3932e+00, 3.7737e+05, 1.5359e+00,
         3.9903e+05, 1.4523e+00, 1.6077e+00, 1.3533e+00],
        [1.4661e+00, 3.9024e+05, 1.6245e+00, 1.5286e+00, 3.8439e+05, 3.7481e+05,
         4.0592e+05, 1.4458e+00, 1.3932e+00, 0.0000e+00, 3.7738e+05, 1.4989e+00,
         3.9903e+05, 1.4728e+00, 1.7218e+00, 1.3049e+00],
        [3.7740e+05, 7.8028e+05, 3.7740e+05, 3.7736e+05, 7.5209e+05, 7.7431e+05,
         8.0104e+05, 3.7733e+05, 3.7737e+05, 3.7738e+05, 0.0000e+00, 3.7736e+05,
         7.8907e+05, 3.7737e+05, 3.7736e+05, 3.7735e+05],
        [1.5493e+00, 3.9025e+05, 1.7125e+00, 1.2949e+00, 3.8437e+05, 3.7478e+05,
         4.0596e+05, 1.3738e+00, 1.5359e+00, 1.4989e+00, 3.7736e+05, 0.0000e+00,
         3.9902e+05, 1.3417e+00, 1.9628e+00, 1.3659e+00],
        [3.9903e+05, 7.8930e+05, 3.9903e+05, 3.9907e+05, 7.8902e+05, 7.6960e+05,
         8.0767e+05, 3.9903e+05, 3.9903e+05, 3.9903e+05, 7.8907e+05, 3.9902e+05,
         0.0000e+00, 3.9904e+05, 3.9904e+05, 3.9902e+05],
        [1.5888e+00, 3.9024e+05, 1.6585e+00, 1.3322e+00, 3.8439e+05, 3.7476e+05,
         4.0592e+05, 1.4056e+00, 1.4523e+00, 1.4728e+00, 3.7737e+05, 1.3417e+00,
         3.9904e+05, 0.0000e+00, 1.8065e+00, 1.3330e+00],
        [1.5833e+00, 3.9024e+05, 1.2088e+00, 1.8637e+00, 3.8437e+05, 3.7473e+05,
         4.0594e+05, 1.6327e+00, 1.6077e+00, 1.7218e+00, 3.7736e+05, 1.9628e+00,
         3.9904e+05, 1.8065e+00, 0.0000e+00, 1.7018e+00],
        [1.3548e+00, 3.9024e+05, 1.4140e+00, 1.3186e+00, 3.8440e+05, 3.7475e+05,
         4.0593e+05, 1.3067e+00, 1.3533e+00, 1.3049e+00, 3.7735e+05, 1.3659e+00,
         3.9902e+05, 1.3330e+00, 1.7018e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3548e+00, 1.3856e+00, 1.3921e+00, 1.4238e+00, 1.4661e+00,
        1.4741e+00, 1.5493e+00, 1.5833e+00, 1.5888e+00, 3.7475e+05, 3.7740e+05,
        3.8436e+05, 3.9025e+05, 3.9903e+05, 4.0589e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390221.0000, 390236.0000, 390237.1250, 390239.6875,
        390242.1562, 390245.2500, 390252.1250, 390254.0312, 390254.9688,
        390261.5312, 751286.0625, 769810.8125, 780276.5625, 788113.5625,
        789302.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2088e+00, 1.4110e+00, 1.4140e+00, 1.4238e+00, 1.4276e+00,
        1.6245e+00, 1.6442e+00, 1.6585e+00, 1.7125e+00, 3.7475e+05, 3.7740e+05,
        3.8437e+05, 3.9022e+05, 3.9903e+05, 4.0592e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2949e+00, 1.3186e+00, 1.3322e+00, 1.4162e+00, 1.4691e+00,
        1.4741e+00, 1.5286e+00, 1.6442e+00, 1.8637e+00, 3.7477e+05, 3.7736e+05,
        3.8437e+05, 3.9026e+05, 3.9907e+05, 4.0590e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384359.5000, 384361.3750, 384369.1562, 384369.8750,
        384371.3750, 384373.2500, 384384.3750, 384386.8438, 384388.5000,
        384398.5625, 752093.2500, 766972.7500, 769810.8125, 789016.3125,
        820974.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374731.0938, 374733.6562, 374745.1875, 374745.8125,
        374750.2188, 374759.6250, 374765.0938, 374775.8750, 374780.9062,
        374806.9375, 751286.0625, 760039.9375, 766972.7500, 769601.4375,
        774306.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405889.8438, 405901.8750, 405915.8438, 405916.7500,
        405918.0000, 405922.6875, 405924.3125, 405931.8750, 405936.3125,
        405960.4062, 760039.9375, 788113.5625, 801041.8125, 807666.5625,
        820974.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3067e+00, 1.3738e+00, 1.3921e+00, 1.4056e+00, 1.4110e+00,
        1.4162e+00, 1.4301e+00, 1.4458e+00, 1.6327e+00, 3.7478e+05, 3.7733e+05,
        3.8436e+05, 3.9025e+05, 3.9903e+05, 4.0592e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3533e+00, 1.3856e+00, 1.3932e+00, 1.4276e+00, 1.4301e+00,
        1.4523e+00, 1.4691e+00, 1.5359e+00, 1.6077e+00, 3.7473e+05, 3.7737e+05,
        3.8438e+05, 3.9025e+05, 3.9903e+05, 4.0592e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3049e+00, 1.3932e+00, 1.4458e+00, 1.4661e+00, 1.4728e+00,
        1.4989e+00, 1.5286e+00, 1.6245e+00, 1.7218e+00, 3.7481e+05, 3.7738e+05,
        3.8439e+05, 3.9024e+05, 3.9903e+05, 4.0592e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377331.1250, 377351.5312, 377357.3125, 377357.8438,
        377361.0625, 377365.1562, 377366.6250, 377382.3438, 377396.3750,
        377398.2188, 752093.2500, 774306.9375, 780276.5625, 789069.1875,
        801041.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2949e+00, 1.3417e+00, 1.3659e+00, 1.3738e+00, 1.4989e+00,
        1.5359e+00, 1.5493e+00, 1.7125e+00, 1.9628e+00, 3.7478e+05, 3.7736e+05,
        3.8437e+05, 3.9025e+05, 3.9902e+05, 4.0596e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399022.8125, 399024.5625, 399026.7500, 399031.1562,
        399033.8750, 399034.0938, 399034.2812, 399038.0000, 399044.7500,
        399072.4375, 769601.4375, 789016.3125, 789069.1875, 789302.1875,
        807666.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3322e+00, 1.3330e+00, 1.3417e+00, 1.4056e+00, 1.4523e+00,
        1.4728e+00, 1.5888e+00, 1.6585e+00, 1.8065e+00, 3.7476e+05, 3.7737e+05,
        3.8439e+05, 3.9024e+05, 3.9904e+05, 4.0592e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2088e+00, 1.5833e+00, 1.6077e+00, 1.6327e+00, 1.7018e+00,
        1.7218e+00, 1.8065e+00, 1.8637e+00, 1.9628e+00, 3.7473e+05, 3.7736e+05,
        3.8437e+05, 3.9024e+05, 3.9904e+05, 4.0594e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3049e+00, 1.3067e+00, 1.3186e+00, 1.3330e+00, 1.3533e+00,
        1.3548e+00, 1.3659e+00, 1.4140e+00, 1.7018e+00, 3.7475e+05, 3.7735e+05,
        3.8440e+05, 3.9024e+05, 3.9902e+05, 4.0593e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37475.84', '390244.41', '37475.94', '37477.84', '384376.28', '374759.44', '405921.81', '37479.37', '37474.41', '37482.04', '377366.72', '37478.95', '399036.28', '37477.30', '37474.88', '37476.27']
estimated f for each client, fs: [6, 4, 6, 6, 4, 5, 4, 6, 6, 6, 4, 6, 4, 6, 6, 6]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 18, 9, 8, 19, 20, 14, 1, 7, 5, 15, 6, 16, 4, 3, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0244s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:10...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:10, End: 2025-07-22 16:01:10)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 8, 17, 14, 20, 6, 16, 11, 5, 2, 19, 7, 1, 4, 9, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.7015e+00, 3.7738e+05, 3.8134e+05, 3.7972e+05, 1.7972e+00,
         3.7656e+05, 1.5929e+00, 1.5508e+00, 1.3470e+00, 3.9033e+05, 1.3481e+00,
         1.5197e+00, 1.6481e+00, 1.2446e+00, 3.9752e+05],
        [1.7015e+00, 0.0000e+00, 3.7742e+05, 3.8140e+05, 3.7971e+05, 1.3629e+00,
         3.7650e+05, 1.4256e+00, 1.4720e+00, 1.7350e+00, 3.9029e+05, 1.8392e+00,
         1.4567e+00, 1.3450e+00, 1.7390e+00, 3.9753e+05],
        [3.7738e+05, 3.7742e+05, 0.0000e+00, 7.4673e+05, 7.5784e+05, 3.7744e+05,
         7.5920e+05, 3.7742e+05, 3.7744e+05, 3.7741e+05, 7.7928e+05, 3.7739e+05,
         3.7743e+05, 3.7744e+05, 3.7740e+05, 7.7230e+05],
        [3.8134e+05, 3.8140e+05, 7.4673e+05, 0.0000e+00, 7.5637e+05, 3.8139e+05,
         7.6155e+05, 3.8137e+05, 3.8137e+05, 3.8135e+05, 7.6080e+05, 3.8135e+05,
         3.8136e+05, 3.8137e+05, 3.8136e+05, 7.7444e+05],
        [3.7972e+05, 3.7971e+05, 7.5784e+05, 7.5637e+05, 0.0000e+00, 3.7970e+05,
         7.4830e+05, 3.7971e+05, 3.7973e+05, 3.7973e+05, 7.6532e+05, 3.7975e+05,
         3.7976e+05, 3.7974e+05, 3.7972e+05, 7.8434e+05],
        [1.7972e+00, 1.3629e+00, 3.7744e+05, 3.8139e+05, 3.7970e+05, 0.0000e+00,
         3.7651e+05, 1.4999e+00, 1.4941e+00, 1.7515e+00, 3.9031e+05, 2.0148e+00,
         1.4294e+00, 1.3744e+00, 1.8264e+00, 3.9749e+05],
        [3.7656e+05, 3.7650e+05, 7.5920e+05, 7.6155e+05, 7.4830e+05, 3.7651e+05,
         0.0000e+00, 3.7650e+05, 3.7656e+05, 3.7652e+05, 7.9269e+05, 3.7654e+05,
         3.7653e+05, 3.7652e+05, 3.7655e+05, 7.7699e+05],
        [1.5929e+00, 1.4256e+00, 3.7742e+05, 3.8137e+05, 3.7971e+05, 1.4999e+00,
         3.7650e+05, 0.0000e+00, 1.3823e+00, 1.4690e+00, 3.9031e+05, 1.6214e+00,
         1.3395e+00, 1.4237e+00, 1.4918e+00, 3.9757e+05],
        [1.5508e+00, 1.4720e+00, 3.7744e+05, 3.8137e+05, 3.7973e+05, 1.4941e+00,
         3.7656e+05, 1.3823e+00, 0.0000e+00, 1.6583e+00, 3.9034e+05, 1.7034e+00,
         1.4186e+00, 1.3909e+00, 1.6781e+00, 3.9753e+05],
        [1.3470e+00, 1.7350e+00, 3.7741e+05, 3.8135e+05, 3.7973e+05, 1.7515e+00,
         3.7652e+05, 1.4690e+00, 1.6583e+00, 0.0000e+00, 3.9029e+05, 1.3641e+00,
         1.5163e+00, 1.6482e+00, 1.2499e+00, 3.9753e+05],
        [3.9033e+05, 3.9029e+05, 7.7928e+05, 7.6080e+05, 7.6532e+05, 3.9031e+05,
         7.9269e+05, 3.9031e+05, 3.9034e+05, 3.9029e+05, 0.0000e+00, 3.9033e+05,
         3.9034e+05, 3.9032e+05, 3.9034e+05, 8.0728e+05],
        [1.3481e+00, 1.8392e+00, 3.7739e+05, 3.8135e+05, 3.7975e+05, 2.0148e+00,
         3.7654e+05, 1.6214e+00, 1.7034e+00, 1.3641e+00, 3.9033e+05, 0.0000e+00,
         1.5891e+00, 1.7472e+00, 1.3641e+00, 3.9750e+05],
        [1.5197e+00, 1.4567e+00, 3.7743e+05, 3.8136e+05, 3.7976e+05, 1.4294e+00,
         3.7653e+05, 1.3395e+00, 1.4186e+00, 1.5163e+00, 3.9034e+05, 1.5891e+00,
         0.0000e+00, 1.3824e+00, 1.4640e+00, 3.9751e+05],
        [1.6481e+00, 1.3450e+00, 3.7744e+05, 3.8137e+05, 3.7974e+05, 1.3744e+00,
         3.7652e+05, 1.4237e+00, 1.3909e+00, 1.6482e+00, 3.9032e+05, 1.7472e+00,
         1.3824e+00, 0.0000e+00, 1.7433e+00, 3.9754e+05],
        [1.2446e+00, 1.7390e+00, 3.7740e+05, 3.8136e+05, 3.7972e+05, 1.8264e+00,
         3.7655e+05, 1.4918e+00, 1.6781e+00, 1.2499e+00, 3.9034e+05, 1.3641e+00,
         1.4640e+00, 1.7433e+00, 0.0000e+00, 3.9753e+05],
        [3.9752e+05, 3.9753e+05, 7.7230e+05, 7.7444e+05, 7.8434e+05, 3.9749e+05,
         7.7699e+05, 3.9757e+05, 3.9753e+05, 3.9753e+05, 8.0728e+05, 3.9750e+05,
         3.9751e+05, 3.9754e+05, 3.9753e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2446e+00, 1.3470e+00, 1.3481e+00, 1.5197e+00, 1.5508e+00,
        1.5929e+00, 1.6481e+00, 1.7015e+00, 1.7972e+00, 3.7656e+05, 3.7738e+05,
        3.7972e+05, 3.8134e+05, 3.9033e+05, 3.9752e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3450e+00, 1.3629e+00, 1.4256e+00, 1.4567e+00, 1.4720e+00,
        1.7015e+00, 1.7350e+00, 1.7390e+00, 1.8392e+00, 3.7650e+05, 3.7742e+05,
        3.7971e+05, 3.8140e+05, 3.9029e+05, 3.9753e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377382.9688, 377390.4375, 377399.4688, 377414.7500,
        377418.0625, 377424.6562, 377425.7812, 377439.1562, 377441.1250,
        377441.3125, 746731.8125, 757837.5000, 759195.2500, 772298.8750,
        779275.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381342.1562, 381350.7500, 381353.2812, 381358.7188,
        381362.7188, 381366.0000, 381367.5938, 381373.2812, 381388.1250,
        381396.1250, 746731.8125, 756369.3750, 760799.7500, 761551.3750,
        774441.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379703.8125, 379705.3750, 379714.9062, 379715.1875,
        379724.2500, 379725.1250, 379730.2188, 379738.8438, 379753.7188,
        379760.0625, 748296.8750, 756369.3750, 757837.5000, 765317.0000,
        784335.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3629e+00, 1.3744e+00, 1.4294e+00, 1.4941e+00, 1.4999e+00,
        1.7515e+00, 1.7972e+00, 1.8264e+00, 2.0148e+00, 3.7651e+05, 3.7744e+05,
        3.7970e+05, 3.8139e+05, 3.9031e+05, 3.9749e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376500.1562, 376503.6250, 376512.2812, 376518.4062,
        376519.7812, 376532.3125, 376540.0000, 376549.5312, 376557.0625,
        376557.8438, 748296.8750, 759195.2500, 761551.3750, 776988.5000,
        792694.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3395e+00, 1.3823e+00, 1.4237e+00, 1.4256e+00, 1.4690e+00,
        1.4918e+00, 1.4999e+00, 1.5929e+00, 1.6214e+00, 3.7650e+05, 3.7742e+05,
        3.7971e+05, 3.8137e+05, 3.9031e+05, 3.9757e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3823e+00, 1.3909e+00, 1.4186e+00, 1.4720e+00, 1.4941e+00,
        1.5508e+00, 1.6583e+00, 1.6781e+00, 1.7034e+00, 3.7656e+05, 3.7744e+05,
        3.7973e+05, 3.8137e+05, 3.9034e+05, 3.9753e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2499e+00, 1.3470e+00, 1.3641e+00, 1.4690e+00, 1.5163e+00,
        1.6482e+00, 1.6583e+00, 1.7350e+00, 1.7515e+00, 3.7652e+05, 3.7741e+05,
        3.7973e+05, 3.8135e+05, 3.9029e+05, 3.9753e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390293.0000, 390293.7500, 390305.8438, 390310.3438,
        390316.8125, 390328.9062, 390333.0938, 390336.5625, 390340.1875,
        390343.0938, 760799.7500, 765317.0000, 779275.2500, 792694.9375,
        807284.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3481e+00, 1.3641e+00, 1.3641e+00, 1.5891e+00, 1.6214e+00,
        1.7034e+00, 1.7472e+00, 1.8392e+00, 2.0148e+00, 3.7654e+05, 3.7739e+05,
        3.7975e+05, 3.8135e+05, 3.9033e+05, 3.9750e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3395e+00, 1.3824e+00, 1.4186e+00, 1.4294e+00, 1.4567e+00,
        1.4640e+00, 1.5163e+00, 1.5197e+00, 1.5891e+00, 3.7653e+05, 3.7743e+05,
        3.7976e+05, 3.8136e+05, 3.9034e+05, 3.9751e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3450e+00, 1.3744e+00, 1.3824e+00, 1.3909e+00, 1.4237e+00,
        1.6481e+00, 1.6482e+00, 1.7433e+00, 1.7472e+00, 3.7652e+05, 3.7744e+05,
        3.7974e+05, 3.8137e+05, 3.9032e+05, 3.9754e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2446e+00, 1.2499e+00, 1.3641e+00, 1.4640e+00, 1.4918e+00,
        1.6781e+00, 1.7390e+00, 1.7433e+00, 1.8264e+00, 3.7655e+05, 3.7740e+05,
        3.7972e+05, 3.8136e+05, 3.9034e+05, 3.9753e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397490.6875, 397495.1562, 397510.0938, 397519.0938,
        397527.3750, 397530.4062, 397530.9375, 397533.3125, 397544.1250,
        397568.7812, 772298.8750, 774441.3750, 776988.5000, 784335.6250,
        807284.2500])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37657.09', '37651.43', '377417.78', '381365.84', '379727.16', '37652.68', '376529.06', '37651.69', '37657.16', '37653.22', '390320.16', '37655.46', '37654.55', '37653.35', '37656.34', '397524.97']
estimated f for each client, fs: [6, 6, 4, 4, 4, 6, 4, 6, 6, 6, 4, 6, 6, 6, 6, 4]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 8, 17, 14, 20, 6, 16, 11, 5, 2, 19, 7, 1, 4, 9, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0155s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:10...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:10, End: 2025-07-22 16:01:10)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 19, 13, 16, 6, 12, 2, 14, 18, 15, 17, 8, 7, 5, 3, 1], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.5565e+05, 8.1211e+05, 7.6519e+05, 3.9367e+05, 3.9365e+05,
         3.9366e+05, 7.9798e+05, 7.5965e+05, 7.5450e+05, 7.8591e+05, 3.9367e+05,
         3.9365e+05, 3.9366e+05, 3.9362e+05, 3.9367e+05],
        [7.5565e+05, 0.0000e+00, 7.8997e+05, 7.5834e+05, 3.8058e+05, 3.8058e+05,
         3.8062e+05, 7.6131e+05, 7.6844e+05, 7.6525e+05, 7.5646e+05, 3.8058e+05,
         3.8059e+05, 3.8060e+05, 3.8056e+05, 3.8059e+05],
        [8.1211e+05, 7.8997e+05, 0.0000e+00, 7.9527e+05, 4.0987e+05, 4.0988e+05,
         4.0987e+05, 8.1544e+05, 8.1816e+05, 7.7351e+05, 8.0083e+05, 4.0985e+05,
         4.0986e+05, 4.0988e+05, 4.0986e+05, 4.0986e+05],
        [7.6519e+05, 7.5834e+05, 7.9527e+05, 0.0000e+00, 3.8742e+05, 3.8741e+05,
         3.8742e+05, 8.0031e+05, 7.6330e+05, 7.7450e+05, 7.7630e+05, 3.8743e+05,
         3.8742e+05, 3.8741e+05, 3.8742e+05, 3.8742e+05],
        [3.9367e+05, 3.8058e+05, 4.0987e+05, 3.8742e+05, 0.0000e+00, 1.9002e+00,
         1.7985e+00, 3.9270e+05, 3.8256e+05, 3.7249e+05, 3.8610e+05, 1.6901e+00,
         1.9185e+00, 1.6633e+00, 1.8709e+00, 1.5363e+00],
        [3.9365e+05, 3.8058e+05, 4.0988e+05, 3.8741e+05, 1.9002e+00, 0.0000e+00,
         1.3780e+00, 3.9270e+05, 3.8261e+05, 3.7251e+05, 3.8614e+05, 1.5831e+00,
         1.3553e+00, 1.6773e+00, 1.2804e+00, 1.5613e+00],
        [3.9366e+05, 3.8062e+05, 4.0987e+05, 3.8742e+05, 1.7985e+00, 1.3780e+00,
         0.0000e+00, 3.9272e+05, 3.8257e+05, 3.7249e+05, 3.8609e+05, 1.6582e+00,
         1.3209e+00, 1.7304e+00, 1.3802e+00, 1.5374e+00],
        [7.9798e+05, 7.6131e+05, 8.1544e+05, 8.0031e+05, 3.9270e+05, 3.9270e+05,
         3.9272e+05, 0.0000e+00, 7.7213e+05, 7.7364e+05, 7.3567e+05, 3.9275e+05,
         3.9271e+05, 3.9268e+05, 3.9268e+05, 3.9274e+05],
        [7.5965e+05, 7.6844e+05, 8.1816e+05, 7.6330e+05, 3.8256e+05, 3.8261e+05,
         3.8257e+05, 7.7213e+05, 0.0000e+00, 7.4592e+05, 7.7717e+05, 3.8259e+05,
         3.8258e+05, 3.8255e+05, 3.8260e+05, 3.8257e+05],
        [7.5450e+05, 7.6525e+05, 7.7351e+05, 7.7450e+05, 3.7249e+05, 3.7251e+05,
         3.7249e+05, 7.7364e+05, 7.4592e+05, 0.0000e+00, 7.5076e+05, 3.7252e+05,
         3.7249e+05, 3.7249e+05, 3.7248e+05, 3.7250e+05],
        [7.8591e+05, 7.5646e+05, 8.0083e+05, 7.7630e+05, 3.8610e+05, 3.8614e+05,
         3.8609e+05, 7.3567e+05, 7.7717e+05, 7.5076e+05, 0.0000e+00, 3.8610e+05,
         3.8610e+05, 3.8610e+05, 3.8609e+05, 3.8609e+05],
        [3.9367e+05, 3.8058e+05, 4.0985e+05, 3.8743e+05, 1.6901e+00, 1.5831e+00,
         1.6582e+00, 3.9275e+05, 3.8259e+05, 3.7252e+05, 3.8610e+05, 0.0000e+00,
         1.5709e+00, 1.7476e+00, 1.6038e+00, 1.6306e+00],
        [3.9365e+05, 3.8059e+05, 4.0986e+05, 3.8742e+05, 1.9185e+00, 1.3553e+00,
         1.3209e+00, 3.9271e+05, 3.8258e+05, 3.7249e+05, 3.8610e+05, 1.5709e+00,
         0.0000e+00, 1.6287e+00, 1.3865e+00, 1.5608e+00],
        [3.9366e+05, 3.8060e+05, 4.0988e+05, 3.8741e+05, 1.6633e+00, 1.6773e+00,
         1.7304e+00, 3.9268e+05, 3.8255e+05, 3.7249e+05, 3.8610e+05, 1.7476e+00,
         1.6287e+00, 0.0000e+00, 1.6136e+00, 1.5479e+00],
        [3.9362e+05, 3.8056e+05, 4.0986e+05, 3.8742e+05, 1.8709e+00, 1.2804e+00,
         1.3802e+00, 3.9268e+05, 3.8260e+05, 3.7248e+05, 3.8609e+05, 1.6038e+00,
         1.3865e+00, 1.6136e+00, 0.0000e+00, 1.6202e+00],
        [3.9367e+05, 3.8059e+05, 4.0986e+05, 3.8742e+05, 1.5363e+00, 1.5613e+00,
         1.5374e+00, 3.9274e+05, 3.8257e+05, 3.7250e+05, 3.8609e+05, 1.6306e+00,
         1.5608e+00, 1.5479e+00, 1.6202e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 393615.7812, 393653.1250, 393654.3125, 393655.9688,
        393656.8438, 393666.5625, 393668.7188, 393671.6875, 754500.5000,
        755646.6250, 759650.3750, 765191.5000, 785907.0625, 797977.7500,
        812112.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380555.6562, 380576.7500, 380581.0938, 380581.8125,
        380587.0625, 380594.6875, 380598.0312, 380617.7812, 755646.6250,
        756459.7500, 758338.5000, 761310.2500, 765246.3125, 768436.6875,
        789972.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 409847.5938, 409856.5312, 409861.8125, 409864.6250,
        409868.5000, 409871.9688, 409875.0625, 409883.5000, 773513.8125,
        789972.4375, 795266.1250, 800825.1250, 812112.8125, 815435.8750,
        818161.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387405.9375, 387412.9688, 387415.8750, 387419.0000,
        387419.2812, 387423.0938, 387424.7188, 387433.7500, 758338.5000,
        763302.8750, 765191.5000, 774499.0000, 776296.5000, 795266.1250,
        800308.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5363e+00, 1.6633e+00, 1.6901e+00, 1.7985e+00, 1.8709e+00,
        1.9002e+00, 1.9185e+00, 3.7249e+05, 3.8058e+05, 3.8256e+05, 3.8610e+05,
        3.8742e+05, 3.9270e+05, 3.9367e+05, 4.0987e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2804e+00, 1.3553e+00, 1.3780e+00, 1.5613e+00, 1.5831e+00,
        1.6773e+00, 1.9002e+00, 3.7251e+05, 3.8058e+05, 3.8261e+05, 3.8614e+05,
        3.8741e+05, 3.9270e+05, 3.9365e+05, 4.0988e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3209e+00, 1.3780e+00, 1.3802e+00, 1.5374e+00, 1.6582e+00,
        1.7304e+00, 1.7985e+00, 3.7249e+05, 3.8062e+05, 3.8257e+05, 3.8609e+05,
        3.8742e+05, 3.9272e+05, 3.9366e+05, 4.0987e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392676.8750, 392681.1562, 392698.0312, 392699.6562,
        392708.4375, 392720.5312, 392740.1250, 392748.4688, 735667.6250,
        761310.2500, 772125.3750, 773643.5000, 797977.7500, 800308.0000,
        815435.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382549.9375, 382559.8125, 382572.3125, 382572.9688,
        382584.0000, 382586.5312, 382603.8438, 382606.7188, 745916.7500,
        759650.3750, 763302.8750, 768436.6875, 772125.3750, 777173.8125,
        818161.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 372478.9688, 372490.7500, 372491.3125, 372491.5625,
        372494.3125, 372500.2188, 372513.1875, 372521.7812, 745916.7500,
        750763.8750, 754500.5000, 765246.3125, 773513.8125, 773643.5000,
        774499.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386085.4375, 386085.6562, 386087.0625, 386097.6562,
        386099.8438, 386100.3125, 386102.0625, 386140.2500, 735667.6250,
        750763.8750, 756459.7500, 776296.5000, 777173.8125, 785907.0625,
        800825.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5709e+00, 1.5831e+00, 1.6038e+00, 1.6306e+00, 1.6582e+00,
        1.6901e+00, 1.7476e+00, 3.7252e+05, 3.8058e+05, 3.8259e+05, 3.8610e+05,
        3.8743e+05, 3.9275e+05, 3.9367e+05, 4.0985e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3209e+00, 1.3553e+00, 1.3865e+00, 1.5608e+00, 1.5709e+00,
        1.6287e+00, 1.9185e+00, 3.7249e+05, 3.8059e+05, 3.8258e+05, 3.8610e+05,
        3.8742e+05, 3.9271e+05, 3.9365e+05, 4.0986e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5479e+00, 1.6136e+00, 1.6287e+00, 1.6633e+00, 1.6773e+00,
        1.7304e+00, 1.7476e+00, 3.7249e+05, 3.8060e+05, 3.8255e+05, 3.8610e+05,
        3.8741e+05, 3.9268e+05, 3.9366e+05, 4.0988e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2804e+00, 1.3802e+00, 1.3865e+00, 1.6038e+00, 1.6136e+00,
        1.6202e+00, 1.8709e+00, 3.7248e+05, 3.8056e+05, 3.8260e+05, 3.8609e+05,
        3.8742e+05, 3.9268e+05, 3.9362e+05, 4.0986e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5363e+00, 1.5374e+00, 1.5479e+00, 1.5608e+00, 1.5613e+00,
        1.6202e+00, 1.6306e+00, 3.7250e+05, 3.8059e+05, 3.8257e+05, 3.8609e+05,
        3.8742e+05, 3.9274e+05, 3.9367e+05, 4.0986e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['465938.94', '455679.91', '484241.59', '462099.59', '113564.54', '113570.73', '113569.60', '463865.16', '456620.31', '447666.31', '457523.00', '113570.09', '113568.10', '113565.05', '113564.92', '113567.06']
estimated f for each client, fs: [5, 5, 5, 5, 8, 8, 8, 5, 5, 7, 5, 8, 8, 8, 8, 8]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 19, 13, 16, 6, 12, 2, 14, 18, 15, 17, 8, 7, 5, 3, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0161s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:11...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:11, End: 2025-07-22 16:01:11)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 18, 7, 1, 2, 9, 8, 11, 4, 15, 20, 10, 5, 16, 13, 17], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9011e+05, 1.7791e+00, 1.6527e+00, 1.7325e+00, 1.5892e+00,
         1.5751e+00, 1.6728e+00, 1.6628e+00, 3.8612e+05, 3.7278e+05, 1.6852e+00,
         1.7115e+00, 3.8803e+05, 4.0480e+05, 3.9245e+05],
        [3.9011e+05, 0.0000e+00, 3.9014e+05, 3.9016e+05, 3.9013e+05, 3.9013e+05,
         3.9013e+05, 3.9013e+05, 3.9014e+05, 7.5126e+05, 7.6344e+05, 3.9014e+05,
         3.9014e+05, 7.9397e+05, 8.0323e+05, 7.7991e+05],
        [1.7791e+00, 3.9014e+05, 0.0000e+00, 1.6286e+00, 1.4582e+00, 1.4376e+00,
         1.6464e+00, 1.6511e+00, 1.8248e+00, 3.8612e+05, 3.7281e+05, 1.5385e+00,
         1.7102e+00, 3.8802e+05, 4.0481e+05, 3.9245e+05],
        [1.6527e+00, 3.9016e+05, 1.6286e+00, 0.0000e+00, 1.6627e+00, 1.6027e+00,
         1.6491e+00, 1.6176e+00, 1.6645e+00, 3.8612e+05, 3.7278e+05, 1.5662e+00,
         1.6377e+00, 3.8804e+05, 4.0479e+05, 3.9242e+05],
        [1.7325e+00, 3.9013e+05, 1.4582e+00, 1.6627e+00, 0.0000e+00, 1.3977e+00,
         1.7586e+00, 1.6389e+00, 1.8247e+00, 3.8610e+05, 3.7279e+05, 1.6042e+00,
         1.8566e+00, 3.8805e+05, 4.0481e+05, 3.9241e+05],
        [1.5892e+00, 3.9013e+05, 1.4376e+00, 1.6027e+00, 1.3977e+00, 0.0000e+00,
         1.6078e+00, 1.6158e+00, 1.8302e+00, 3.8612e+05, 3.7279e+05, 1.5976e+00,
         1.7519e+00, 3.8806e+05, 4.0483e+05, 3.9243e+05],
        [1.5751e+00, 3.9013e+05, 1.6464e+00, 1.6491e+00, 1.7586e+00, 1.6078e+00,
         0.0000e+00, 1.6701e+00, 1.6863e+00, 3.8611e+05, 3.7278e+05, 1.6509e+00,
         1.7974e+00, 3.8802e+05, 4.0483e+05, 3.9244e+05],
        [1.6728e+00, 3.9013e+05, 1.6511e+00, 1.6176e+00, 1.6389e+00, 1.6158e+00,
         1.6701e+00, 0.0000e+00, 1.6671e+00, 3.8614e+05, 3.7280e+05, 1.5827e+00,
         1.5627e+00, 3.8802e+05, 4.0482e+05, 3.9243e+05],
        [1.6628e+00, 3.9014e+05, 1.8248e+00, 1.6645e+00, 1.8247e+00, 1.8302e+00,
         1.6863e+00, 1.6671e+00, 0.0000e+00, 3.8612e+05, 3.7280e+05, 1.7838e+00,
         1.6811e+00, 3.8804e+05, 4.0482e+05, 3.9246e+05],
        [3.8612e+05, 7.5126e+05, 3.8612e+05, 3.8612e+05, 3.8610e+05, 3.8612e+05,
         3.8611e+05, 3.8614e+05, 3.8612e+05, 0.0000e+00, 7.6199e+05, 3.8613e+05,
         3.8615e+05, 7.7041e+05, 7.8444e+05, 7.6267e+05],
        [3.7278e+05, 7.6344e+05, 3.7281e+05, 3.7278e+05, 3.7279e+05, 3.7279e+05,
         3.7278e+05, 3.7280e+05, 3.7280e+05, 7.6199e+05, 0.0000e+00, 3.7279e+05,
         3.7279e+05, 7.6227e+05, 7.5890e+05, 7.6476e+05],
        [1.6852e+00, 3.9014e+05, 1.5385e+00, 1.5662e+00, 1.6042e+00, 1.5976e+00,
         1.6509e+00, 1.5827e+00, 1.7838e+00, 3.8613e+05, 3.7279e+05, 0.0000e+00,
         1.5585e+00, 3.8805e+05, 4.0480e+05, 3.9241e+05],
        [1.7115e+00, 3.9014e+05, 1.7102e+00, 1.6377e+00, 1.8566e+00, 1.7519e+00,
         1.7974e+00, 1.5627e+00, 1.6811e+00, 3.8615e+05, 3.7279e+05, 1.5585e+00,
         0.0000e+00, 3.8803e+05, 4.0483e+05, 3.9244e+05],
        [3.8803e+05, 7.9397e+05, 3.8802e+05, 3.8804e+05, 3.8805e+05, 3.8806e+05,
         3.8802e+05, 3.8802e+05, 3.8804e+05, 7.7041e+05, 7.6227e+05, 3.8805e+05,
         3.8803e+05, 0.0000e+00, 8.0074e+05, 7.9240e+05],
        [4.0480e+05, 8.0323e+05, 4.0481e+05, 4.0479e+05, 4.0481e+05, 4.0483e+05,
         4.0483e+05, 4.0482e+05, 4.0482e+05, 7.8444e+05, 7.5890e+05, 4.0480e+05,
         4.0483e+05, 8.0074e+05, 0.0000e+00, 8.1049e+05],
        [3.9245e+05, 7.7991e+05, 3.9245e+05, 3.9242e+05, 3.9241e+05, 3.9243e+05,
         3.9244e+05, 3.9243e+05, 3.9246e+05, 7.6267e+05, 7.6476e+05, 3.9241e+05,
         3.9244e+05, 7.9240e+05, 8.1049e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5751e+00, 1.5892e+00, 1.6527e+00, 1.6628e+00, 1.6728e+00,
        1.6852e+00, 1.7115e+00, 1.7325e+00, 1.7791e+00, 3.7278e+05, 3.8612e+05,
        3.8803e+05, 3.9011e+05, 3.9245e+05, 4.0480e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390110.1250, 390126.1250, 390127.2500, 390128.1562,
        390133.1250, 390137.0312, 390138.0312, 390140.9062, 390144.9688,
        390158.7812, 751257.8750, 763444.3125, 779909.0625, 793971.8750,
        803225.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4376e+00, 1.4582e+00, 1.5385e+00, 1.6286e+00, 1.6464e+00,
        1.6511e+00, 1.7102e+00, 1.7791e+00, 1.8248e+00, 3.7281e+05, 3.8612e+05,
        3.8802e+05, 3.9014e+05, 3.9245e+05, 4.0481e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5662e+00, 1.6027e+00, 1.6176e+00, 1.6286e+00, 1.6377e+00,
        1.6491e+00, 1.6527e+00, 1.6627e+00, 1.6645e+00, 3.7278e+05, 3.8612e+05,
        3.8804e+05, 3.9016e+05, 3.9242e+05, 4.0479e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3977e+00, 1.4582e+00, 1.6042e+00, 1.6389e+00, 1.6627e+00,
        1.7325e+00, 1.7586e+00, 1.8247e+00, 1.8566e+00, 3.7279e+05, 3.8610e+05,
        3.8805e+05, 3.9013e+05, 3.9241e+05, 4.0481e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3977e+00, 1.4376e+00, 1.5892e+00, 1.5976e+00, 1.6027e+00,
        1.6078e+00, 1.6158e+00, 1.7519e+00, 1.8302e+00, 3.7279e+05, 3.8612e+05,
        3.8806e+05, 3.9013e+05, 3.9243e+05, 4.0483e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5751e+00, 1.6078e+00, 1.6464e+00, 1.6491e+00, 1.6509e+00,
        1.6701e+00, 1.6863e+00, 1.7586e+00, 1.7974e+00, 3.7278e+05, 3.8611e+05,
        3.8802e+05, 3.9013e+05, 3.9244e+05, 4.0483e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5627e+00, 1.5827e+00, 1.6158e+00, 1.6176e+00, 1.6389e+00,
        1.6511e+00, 1.6671e+00, 1.6701e+00, 1.6728e+00, 3.7280e+05, 3.8614e+05,
        3.8802e+05, 3.9013e+05, 3.9243e+05, 4.0482e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6628e+00, 1.6645e+00, 1.6671e+00, 1.6811e+00, 1.6863e+00,
        1.7838e+00, 1.8247e+00, 1.8248e+00, 1.8302e+00, 3.7280e+05, 3.8612e+05,
        3.8804e+05, 3.9014e+05, 3.9246e+05, 4.0482e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386104.9062, 386106.0000, 386119.6875, 386122.0625,
        386122.9062, 386124.5625, 386124.9688, 386133.8125, 386143.9688,
        386154.9688, 751257.8750, 761985.6250, 762671.9375, 770410.3125,
        784442.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 372779.2188, 372782.0000, 372783.7500, 372786.6250,
        372788.9375, 372789.5312, 372790.3438, 372799.7188, 372799.7500,
        372805.6562, 758895.8125, 761985.6250, 762270.0625, 763444.3125,
        764759.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5385e+00, 1.5585e+00, 1.5662e+00, 1.5827e+00, 1.5976e+00,
        1.6042e+00, 1.6509e+00, 1.6852e+00, 1.7838e+00, 3.7279e+05, 3.8613e+05,
        3.8805e+05, 3.9014e+05, 3.9241e+05, 4.0480e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5585e+00, 1.5627e+00, 1.6377e+00, 1.6811e+00, 1.7102e+00,
        1.7115e+00, 1.7519e+00, 1.7974e+00, 1.8566e+00, 3.7279e+05, 3.8615e+05,
        3.8803e+05, 3.9014e+05, 3.9244e+05, 4.0483e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388018.8125, 388020.7812, 388024.6250, 388025.7188,
        388032.7812, 388036.5000, 388043.8750, 388046.0625, 388050.8750,
        388056.9062, 762270.0625, 770410.3125, 792403.0000, 793971.8750,
        800740.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404788.1250, 404802.3750, 404804.6250, 404806.5938,
        404808.1875, 404815.0625, 404816.1562, 404829.0938, 404832.3438,
        404834.0625, 758895.8125, 784442.3750, 800740.1875, 803225.1250,
        810485.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392410.0938, 392410.5625, 392421.0625, 392427.3750,
        392429.6875, 392437.4062, 392440.0625, 392447.5000, 392450.9375,
        392460.2812, 762671.9375, 764759.3750, 779909.0625, 792403.0000,
        810485.1875])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37279.88', '390134.44', '37282.04', '37279.39', '37280.44', '37280.11', '37279.70', '37281.44', '37281.54', '386125.78', '372790.56', '37280.35', '37280.56', '388035.66', '404813.66', '392433.53']
estimated f for each client, fs: [6, 4, 6, 6, 6, 6, 6, 6, 6, 4, 5, 6, 6, 4, 4, 4]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 18, 7, 1, 2, 9, 8, 11, 4, 15, 20, 10, 5, 16, 13, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0134s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:12...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:12, End: 2025-07-22 16:01:12)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 16, 3, 7, 2, 20, 15, 14, 4, 8, 6, 13, 9, 12, 17, 5], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9765e+05, 1.6121e+00, 1.5863e+00, 1.6113e+00, 3.7934e+05,
         3.7628e+05, 3.8346e+05, 1.9064e+00, 1.7189e+00, 1.7165e+00, 3.9701e+05,
         1.5114e+00, 1.5592e+00, 3.7389e+05, 1.8506e+00],
        [3.9765e+05, 0.0000e+00, 3.9767e+05, 3.9767e+05, 3.9767e+05, 7.5609e+05,
         7.6069e+05, 8.0768e+05, 3.9768e+05, 3.9770e+05, 3.9767e+05, 7.9610e+05,
         3.9769e+05, 3.9765e+05, 7.7183e+05, 3.9767e+05],
        [1.6121e+00, 3.9767e+05, 0.0000e+00, 1.3531e+00, 1.4539e+00, 3.7935e+05,
         3.7627e+05, 3.8345e+05, 1.7034e+00, 1.5594e+00, 1.5754e+00, 3.9701e+05,
         1.3525e+00, 1.3025e+00, 3.7390e+05, 1.5217e+00],
        [1.5863e+00, 3.9767e+05, 1.3531e+00, 0.0000e+00, 1.3453e+00, 3.7940e+05,
         3.7628e+05, 3.8346e+05, 1.6917e+00, 1.4978e+00, 1.5706e+00, 3.9700e+05,
         1.3526e+00, 1.3357e+00, 3.7390e+05, 1.5400e+00],
        [1.6113e+00, 3.9767e+05, 1.4539e+00, 1.3453e+00, 0.0000e+00, 3.7939e+05,
         3.7628e+05, 3.8344e+05, 1.7081e+00, 1.6108e+00, 1.5598e+00, 3.9701e+05,
         1.3529e+00, 1.4412e+00, 3.7391e+05, 1.6924e+00],
        [3.7934e+05, 7.5609e+05, 3.7935e+05, 3.7940e+05, 3.7939e+05, 0.0000e+00,
         7.6981e+05, 7.4962e+05, 3.7936e+05, 3.7937e+05, 3.7934e+05, 7.9440e+05,
         3.7935e+05, 3.7937e+05, 7.3068e+05, 3.7938e+05],
        [3.7628e+05, 7.6069e+05, 3.7627e+05, 3.7628e+05, 3.7628e+05, 7.6981e+05,
         0.0000e+00, 7.4282e+05, 3.7628e+05, 3.7625e+05, 3.7626e+05, 7.8124e+05,
         3.7627e+05, 3.7627e+05, 7.4688e+05, 3.7628e+05],
        [3.8346e+05, 8.0768e+05, 3.8345e+05, 3.8346e+05, 3.8344e+05, 7.4962e+05,
         7.4282e+05, 0.0000e+00, 3.8346e+05, 3.8346e+05, 3.8349e+05, 7.9093e+05,
         3.8344e+05, 3.8345e+05, 7.6046e+05, 3.8346e+05],
        [1.9064e+00, 3.9768e+05, 1.7034e+00, 1.6917e+00, 1.7081e+00, 3.7936e+05,
         3.7628e+05, 3.8346e+05, 0.0000e+00, 1.5435e+00, 1.5495e+00, 3.9700e+05,
         1.7996e+00, 1.6954e+00, 3.7390e+05, 1.5845e+00],
        [1.7189e+00, 3.9770e+05, 1.5594e+00, 1.4978e+00, 1.6108e+00, 3.7937e+05,
         3.7625e+05, 3.8346e+05, 1.5435e+00, 0.0000e+00, 1.3920e+00, 3.9694e+05,
         1.5514e+00, 1.4939e+00, 3.7392e+05, 1.6277e+00],
        [1.7165e+00, 3.9767e+05, 1.5754e+00, 1.5706e+00, 1.5598e+00, 3.7934e+05,
         3.7626e+05, 3.8349e+05, 1.5495e+00, 1.3920e+00, 0.0000e+00, 3.9698e+05,
         1.5364e+00, 1.5240e+00, 3.7390e+05, 1.5313e+00],
        [3.9701e+05, 7.9610e+05, 3.9701e+05, 3.9700e+05, 3.9701e+05, 7.9440e+05,
         7.8124e+05, 7.9093e+05, 3.9700e+05, 3.9694e+05, 3.9698e+05, 0.0000e+00,
         3.9703e+05, 3.9696e+05, 7.5953e+05, 3.9699e+05],
        [1.5114e+00, 3.9769e+05, 1.3525e+00, 1.3526e+00, 1.3529e+00, 3.7935e+05,
         3.7627e+05, 3.8344e+05, 1.7996e+00, 1.5514e+00, 1.5364e+00, 3.9703e+05,
         0.0000e+00, 1.3450e+00, 3.7388e+05, 1.7061e+00],
        [1.5592e+00, 3.9765e+05, 1.3025e+00, 1.3357e+00, 1.4412e+00, 3.7937e+05,
         3.7627e+05, 3.8345e+05, 1.6954e+00, 1.4939e+00, 1.5240e+00, 3.9696e+05,
         1.3450e+00, 0.0000e+00, 3.7390e+05, 1.5982e+00],
        [3.7389e+05, 7.7183e+05, 3.7390e+05, 3.7390e+05, 3.7391e+05, 7.3068e+05,
         7.4688e+05, 7.6046e+05, 3.7390e+05, 3.7392e+05, 3.7390e+05, 7.5953e+05,
         3.7388e+05, 3.7390e+05, 0.0000e+00, 3.7388e+05],
        [1.8506e+00, 3.9767e+05, 1.5217e+00, 1.5400e+00, 1.6924e+00, 3.7938e+05,
         3.7628e+05, 3.8346e+05, 1.5845e+00, 1.6277e+00, 1.5313e+00, 3.9699e+05,
         1.7061e+00, 1.5982e+00, 3.7388e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5114e+00, 1.5592e+00, 1.5863e+00, 1.6113e+00, 1.6121e+00,
        1.7165e+00, 1.7189e+00, 1.8506e+00, 1.9064e+00, 3.7389e+05, 3.7628e+05,
        3.7934e+05, 3.8346e+05, 3.9701e+05, 3.9765e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397646.2188, 397652.2188, 397665.6875, 397668.3125,
        397670.4062, 397672.7188, 397674.1562, 397684.8125, 397691.2500,
        397696.0000, 756090.0625, 760688.5625, 771834.1875, 796101.6250,
        807679.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3025e+00, 1.3525e+00, 1.3531e+00, 1.4539e+00, 1.5217e+00,
        1.5594e+00, 1.5754e+00, 1.6121e+00, 1.7034e+00, 3.7390e+05, 3.7627e+05,
        3.7935e+05, 3.8345e+05, 3.9701e+05, 3.9767e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3357e+00, 1.3453e+00, 1.3526e+00, 1.3531e+00, 1.4978e+00,
        1.5400e+00, 1.5706e+00, 1.5863e+00, 1.6917e+00, 3.7390e+05, 3.7628e+05,
        3.7940e+05, 3.8346e+05, 3.9700e+05, 3.9767e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3453e+00, 1.3529e+00, 1.4412e+00, 1.4539e+00, 1.5598e+00,
        1.6108e+00, 1.6113e+00, 1.6924e+00, 1.7081e+00, 3.7391e+05, 3.7628e+05,
        3.7939e+05, 3.8344e+05, 3.9701e+05, 3.9767e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379335.6250, 379336.4688, 379348.8750, 379354.3750,
        379362.6250, 379369.8438, 379370.3125, 379375.2812, 379387.4688,
        379404.2500, 730677.0000, 749623.6250, 756090.0625, 769810.1875,
        794402.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376253.5938, 376258.9688, 376265.6250, 376267.4062,
        376267.5625, 376280.3125, 376281.9688, 376282.4375, 376283.4375,
        376283.8125, 742815.6250, 746876.8125, 760688.5625, 769810.1875,
        781239.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383439.1875, 383443.2500, 383452.5312, 383453.0938,
        383455.6562, 383456.8125, 383457.2188, 383463.6250, 383463.6250,
        383490.0000, 742815.6250, 749623.6250, 760459.0000, 790933.6250,
        807679.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5435e+00, 1.5495e+00, 1.5845e+00, 1.6917e+00, 1.6954e+00,
        1.7034e+00, 1.7081e+00, 1.7996e+00, 1.9064e+00, 3.7390e+05, 3.7628e+05,
        3.7936e+05, 3.8346e+05, 3.9700e+05, 3.9768e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3920e+00, 1.4939e+00, 1.4978e+00, 1.5435e+00, 1.5514e+00,
        1.5594e+00, 1.6108e+00, 1.6277e+00, 1.7189e+00, 3.7392e+05, 3.7625e+05,
        3.7937e+05, 3.8346e+05, 3.9694e+05, 3.9770e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3920e+00, 1.5240e+00, 1.5313e+00, 1.5364e+00, 1.5495e+00,
        1.5598e+00, 1.5706e+00, 1.5754e+00, 1.7165e+00, 3.7390e+05, 3.7626e+05,
        3.7934e+05, 3.8349e+05, 3.9698e+05, 3.9767e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396944.2812, 396964.6562, 396979.0625, 396986.8125,
        396999.3125, 397004.8125, 397005.7812, 397011.0312, 397011.7188,
        397025.1250, 759527.5000, 781239.6875, 790933.6250, 794402.8750,
        796101.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3450e+00, 1.3525e+00, 1.3526e+00, 1.3529e+00, 1.5114e+00,
        1.5364e+00, 1.5514e+00, 1.7061e+00, 1.7996e+00, 3.7388e+05, 3.7627e+05,
        3.7935e+05, 3.8344e+05, 3.9703e+05, 3.9769e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3025e+00, 1.3357e+00, 1.3450e+00, 1.4412e+00, 1.4939e+00,
        1.5240e+00, 1.5592e+00, 1.5982e+00, 1.6954e+00, 3.7390e+05, 3.7627e+05,
        3.7937e+05, 3.8345e+05, 3.9696e+05, 3.9765e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 373877.8750, 373879.2500, 373894.3750, 373898.0938,
        373898.2500, 373898.9375, 373901.2812, 373903.8125, 373905.3438,
        373915.5000, 730677.0000, 746876.8125, 759527.5000, 760459.0000,
        771834.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5217e+00, 1.5313e+00, 1.5400e+00, 1.5845e+00, 1.5982e+00,
        1.6277e+00, 1.6924e+00, 1.7061e+00, 1.8506e+00, 3.7388e+05, 3.7628e+05,
        3.7938e+05, 3.8346e+05, 3.9699e+05, 3.9767e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37390.95', '397672.19', '37391.17', '37391.45', '37391.91', '379364.47', '376272.53', '383457.50', '37391.41', '37392.95', '37391.21', '396993.22', '37389.27', '37391.71', '373897.28', '37389.25']
estimated f for each client, fs: [6, 4, 6, 6, 6, 4, 4, 4, 6, 6, 6, 4, 6, 6, 4, 6]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [1, 16, 3, 7, 2, 20, 15, 14, 4, 8, 6, 13, 9, 12, 17, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0349s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:12...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:12, End: 2025-07-22 16:01:12)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 8, 17, 18, 15, 16, 2, 19, 12, 3, 6, 4, 20, 14, 5, 13], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6452e+00, 3.8903e+05, 3.9159e+05, 3.9184e+05, 4.0187e+05,
         1.3853e+00, 3.8045e+05, 1.3854e+00, 1.4584e+00, 1.5994e+00, 1.8423e+00,
         3.9070e+05, 3.8240e+05, 1.6363e+00, 3.8402e+05],
        [1.6452e+00, 0.0000e+00, 3.8898e+05, 3.9161e+05, 3.9183e+05, 4.0183e+05,
         1.5606e+00, 3.8042e+05, 1.5120e+00, 1.6514e+00, 1.4410e+00, 1.5582e+00,
         3.9071e+05, 3.8237e+05, 1.7375e+00, 3.8399e+05],
        [3.8903e+05, 3.8898e+05, 0.0000e+00, 7.8757e+05, 7.6669e+05, 7.7799e+05,
         3.8901e+05, 7.6338e+05, 3.8901e+05, 3.8902e+05, 3.8902e+05, 3.8899e+05,
         7.7285e+05, 7.6721e+05, 3.8904e+05, 7.7959e+05],
        [3.9159e+05, 3.9161e+05, 7.8757e+05, 0.0000e+00, 7.8243e+05, 8.1253e+05,
         3.9161e+05, 7.7426e+05, 3.9161e+05, 3.9160e+05, 3.9161e+05, 3.9164e+05,
         7.9405e+05, 7.9120e+05, 3.9161e+05, 7.7887e+05],
        [3.9184e+05, 3.9183e+05, 7.6669e+05, 7.8243e+05, 0.0000e+00, 7.8225e+05,
         3.9184e+05, 7.6906e+05, 3.9181e+05, 3.9181e+05, 3.9183e+05, 3.9183e+05,
         7.8003e+05, 7.6704e+05, 3.9182e+05, 7.8420e+05],
        [4.0187e+05, 4.0183e+05, 7.7799e+05, 8.1253e+05, 7.8225e+05, 0.0000e+00,
         4.0188e+05, 7.5373e+05, 4.0186e+05, 4.0186e+05, 4.0188e+05, 4.0188e+05,
         7.9808e+05, 7.8703e+05, 4.0187e+05, 7.9062e+05],
        [1.3853e+00, 1.5606e+00, 3.8901e+05, 3.9161e+05, 3.9184e+05, 4.0188e+05,
         0.0000e+00, 3.8044e+05, 1.4347e+00, 1.5340e+00, 1.5264e+00, 1.6132e+00,
         3.9071e+05, 3.8241e+05, 1.6443e+00, 3.8398e+05],
        [3.8045e+05, 3.8042e+05, 7.6338e+05, 7.7426e+05, 7.6906e+05, 7.5373e+05,
         3.8044e+05, 0.0000e+00, 3.8043e+05, 3.8043e+05, 3.8042e+05, 3.8044e+05,
         7.7704e+05, 7.6587e+05, 3.8047e+05, 7.7452e+05],
        [1.3854e+00, 1.5120e+00, 3.8901e+05, 3.9161e+05, 3.9181e+05, 4.0186e+05,
         1.4347e+00, 3.8043e+05, 0.0000e+00, 1.3858e+00, 1.5782e+00, 1.6921e+00,
         3.9072e+05, 3.8236e+05, 1.4871e+00, 3.8400e+05],
        [1.4584e+00, 1.6514e+00, 3.8902e+05, 3.9160e+05, 3.9181e+05, 4.0186e+05,
         1.5340e+00, 3.8043e+05, 1.3858e+00, 0.0000e+00, 1.6620e+00, 1.8282e+00,
         3.9073e+05, 3.8238e+05, 1.5365e+00, 3.8400e+05],
        [1.5994e+00, 1.4410e+00, 3.8902e+05, 3.9161e+05, 3.9183e+05, 4.0188e+05,
         1.5264e+00, 3.8042e+05, 1.5782e+00, 1.6620e+00, 0.0000e+00, 1.5895e+00,
         3.9071e+05, 3.8240e+05, 1.6929e+00, 3.8398e+05],
        [1.8423e+00, 1.5582e+00, 3.8899e+05, 3.9164e+05, 3.9183e+05, 4.0188e+05,
         1.6132e+00, 3.8044e+05, 1.6921e+00, 1.8282e+00, 1.5895e+00, 0.0000e+00,
         3.9074e+05, 3.8240e+05, 1.7891e+00, 3.8403e+05],
        [3.9070e+05, 3.9071e+05, 7.7285e+05, 7.9405e+05, 7.8003e+05, 7.9808e+05,
         3.9071e+05, 7.7704e+05, 3.9072e+05, 3.9073e+05, 3.9071e+05, 3.9074e+05,
         0.0000e+00, 7.7742e+05, 3.9071e+05, 7.7926e+05],
        [3.8240e+05, 3.8237e+05, 7.6721e+05, 7.9120e+05, 7.6704e+05, 7.8703e+05,
         3.8241e+05, 7.6587e+05, 3.8236e+05, 3.8238e+05, 3.8240e+05, 3.8240e+05,
         7.7742e+05, 0.0000e+00, 3.8239e+05, 7.7920e+05],
        [1.6363e+00, 1.7375e+00, 3.8904e+05, 3.9161e+05, 3.9182e+05, 4.0187e+05,
         1.6443e+00, 3.8047e+05, 1.4871e+00, 1.5365e+00, 1.6929e+00, 1.7891e+00,
         3.9071e+05, 3.8239e+05, 0.0000e+00, 3.8400e+05],
        [3.8402e+05, 3.8399e+05, 7.7959e+05, 7.7887e+05, 7.8420e+05, 7.9062e+05,
         3.8398e+05, 7.7452e+05, 3.8400e+05, 3.8400e+05, 3.8398e+05, 3.8403e+05,
         7.7926e+05, 7.7920e+05, 3.8400e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3853e+00, 1.3854e+00, 1.4584e+00, 1.5994e+00, 1.6363e+00,
        1.6452e+00, 1.8423e+00, 3.8045e+05, 3.8240e+05, 3.8402e+05, 3.8903e+05,
        3.9070e+05, 3.9159e+05, 3.9184e+05, 4.0187e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4410e+00, 1.5120e+00, 1.5582e+00, 1.5606e+00, 1.6452e+00,
        1.6514e+00, 1.7375e+00, 3.8042e+05, 3.8237e+05, 3.8399e+05, 3.8898e+05,
        3.9071e+05, 3.9161e+05, 3.9183e+05, 4.0183e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388985.0000, 388992.7188, 389013.1875, 389013.2812,
        389019.3125, 389023.6250, 389032.6562, 389039.1562, 763380.0625,
        766692.7500, 767210.9375, 772854.5625, 777985.7500, 779593.0000,
        787573.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391588.3750, 391598.0312, 391609.0625, 391610.4375,
        391612.0000, 391614.4062, 391614.7188, 391637.0938, 774263.3750,
        778870.5000, 782425.5625, 787573.1250, 791204.1250, 794046.6250,
        812532.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391807.3750, 391811.5938, 391821.9375, 391825.1250,
        391829.5625, 391830.5938, 391836.6875, 391838.9375, 766692.7500,
        767039.9375, 769062.7500, 780029.2500, 782251.0000, 782425.5625,
        784197.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401833.0000, 401857.5000, 401860.0625, 401865.4688,
        401873.4062, 401878.7188, 401882.0938, 401883.5625, 753730.2500,
        777985.7500, 782251.0000, 787029.8125, 790621.3750, 798076.6250,
        812532.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3853e+00, 1.4347e+00, 1.5264e+00, 1.5340e+00, 1.5606e+00,
        1.6132e+00, 1.6443e+00, 3.8044e+05, 3.8241e+05, 3.8398e+05, 3.8901e+05,
        3.9071e+05, 3.9161e+05, 3.9184e+05, 4.0188e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380423.5625, 380424.9375, 380425.9375, 380427.1875,
        380436.2812, 380437.2188, 380451.9375, 380469.4375, 753730.2500,
        763380.0625, 765869.2500, 769062.7500, 774263.3750, 774515.5000,
        777043.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3854e+00, 1.3858e+00, 1.4347e+00, 1.4871e+00, 1.5120e+00,
        1.5782e+00, 1.6921e+00, 3.8043e+05, 3.8236e+05, 3.8400e+05, 3.8901e+05,
        3.9072e+05, 3.9161e+05, 3.9181e+05, 4.0186e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3858e+00, 1.4584e+00, 1.5340e+00, 1.5365e+00, 1.6514e+00,
        1.6620e+00, 1.8282e+00, 3.8043e+05, 3.8238e+05, 3.8400e+05, 3.8902e+05,
        3.9073e+05, 3.9160e+05, 3.9181e+05, 4.0186e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4410e+00, 1.5264e+00, 1.5782e+00, 1.5895e+00, 1.5994e+00,
        1.6620e+00, 1.6929e+00, 3.8042e+05, 3.8240e+05, 3.8398e+05, 3.8902e+05,
        3.9071e+05, 3.9161e+05, 3.9183e+05, 4.0188e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5582e+00, 1.5895e+00, 1.6132e+00, 1.6921e+00, 1.7891e+00,
        1.8282e+00, 1.8423e+00, 3.8044e+05, 3.8240e+05, 3.8403e+05, 3.8899e+05,
        3.9074e+05, 3.9164e+05, 3.9183e+05, 4.0188e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390702.8125, 390712.5625, 390712.8750, 390714.0312,
        390714.0938, 390719.1875, 390727.9688, 390744.7812, 772854.5625,
        777043.7500, 777423.4375, 779258.5000, 780029.2500, 794046.6250,
        798076.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382362.8125, 382372.3438, 382377.8125, 382385.8750,
        382403.3125, 382403.4062, 382404.7500, 382405.7500, 765869.2500,
        767039.9375, 767210.9375, 777423.4375, 779199.8750, 787029.8125,
        791204.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4871e+00, 1.5365e+00, 1.6363e+00, 1.6443e+00, 1.6929e+00,
        1.7375e+00, 1.7891e+00, 3.8047e+05, 3.8239e+05, 3.8400e+05, 3.8904e+05,
        3.9071e+05, 3.9161e+05, 3.9182e+05, 4.0187e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383975.7812, 383982.5000, 383985.9062, 383996.2500,
        383997.8750, 384001.6250, 384018.0000, 384025.5938, 774515.5000,
        778870.5000, 779199.8750, 779258.5000, 779593.0000, 784197.0625,
        790621.3750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['114688.42', '114679.42', '464219.16', '468601.81', '466833.44', '474665.00', '114683.52', '456060.69', '114679.67', '114681.65', '114681.38', '114687.95', '467564.66', '459202.50', '114686.48', '462536.94']
estimated f for each client, fs: [8, 8, 5, 5, 5, 5, 8, 6, 8, 8, 8, 8, 5, 7, 8, 7]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 8, 17, 18, 15, 16, 2, 19, 12, 3, 6, 4, 20, 14, 5, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0148s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:13...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:13, End: 2025-07-22 16:01:13)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 8, 19, 1, 11, 10, 18, 14, 13, 17, 7, 5, 4, 6, 2, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6266e+00, 3.9735e+05, 1.3437e+00, 1.5109e+00, 1.4842e+00,
         3.8314e+05, 3.7499e+05, 3.9462e+05, 3.9601e+05, 1.3776e+00, 1.4388e+00,
         1.6734e+00, 1.4431e+00, 1.3752e+00, 3.8178e+05],
        [1.6266e+00, 0.0000e+00, 3.9734e+05, 1.4781e+00, 1.8067e+00, 1.7870e+00,
         3.8315e+05, 3.7501e+05, 3.9461e+05, 3.9598e+05, 1.5538e+00, 1.6058e+00,
         1.8305e+00, 1.6416e+00, 1.6547e+00, 3.8176e+05],
        [3.9735e+05, 3.9734e+05, 0.0000e+00, 3.9738e+05, 3.9736e+05, 3.9733e+05,
         7.5441e+05, 7.6841e+05, 7.7909e+05, 7.8124e+05, 3.9734e+05, 3.9737e+05,
         3.9734e+05, 3.9738e+05, 3.9736e+05, 7.8716e+05],
        [1.3437e+00, 1.4781e+00, 3.9738e+05, 0.0000e+00, 1.4900e+00, 1.4364e+00,
         3.8315e+05, 3.7500e+05, 3.9463e+05, 3.9600e+05, 1.3841e+00, 1.3418e+00,
         1.5865e+00, 1.4211e+00, 1.3309e+00, 3.8174e+05],
        [1.5109e+00, 1.8067e+00, 3.9736e+05, 1.4900e+00, 0.0000e+00, 1.4369e+00,
         3.8312e+05, 3.7501e+05, 3.9462e+05, 3.9601e+05, 1.5015e+00, 1.3792e+00,
         1.4348e+00, 1.4065e+00, 1.4576e+00, 3.8175e+05],
        [1.4842e+00, 1.7870e+00, 3.9733e+05, 1.4364e+00, 1.4369e+00, 0.0000e+00,
         3.8313e+05, 3.7498e+05, 3.9460e+05, 3.9604e+05, 1.4384e+00, 1.4325e+00,
         1.5576e+00, 1.4658e+00, 1.4059e+00, 3.8179e+05],
        [3.8314e+05, 3.8315e+05, 7.5441e+05, 3.8315e+05, 3.8312e+05, 3.8313e+05,
         0.0000e+00, 7.6722e+05, 7.6977e+05, 7.7235e+05, 3.8311e+05, 3.8311e+05,
         3.8313e+05, 3.8316e+05, 3.8315e+05, 7.7419e+05],
        [3.7499e+05, 3.7501e+05, 7.6841e+05, 3.7500e+05, 3.7501e+05, 3.7498e+05,
         7.6722e+05, 0.0000e+00, 7.5882e+05, 7.5471e+05, 3.7499e+05, 3.7499e+05,
         3.7500e+05, 3.7497e+05, 3.7500e+05, 7.4725e+05],
        [3.9462e+05, 3.9461e+05, 7.7909e+05, 3.9463e+05, 3.9462e+05, 3.9460e+05,
         7.6977e+05, 7.5882e+05, 0.0000e+00, 7.9429e+05, 3.9464e+05, 3.9462e+05,
         3.9466e+05, 3.9464e+05, 3.9464e+05, 7.8544e+05],
        [3.9601e+05, 3.9598e+05, 7.8124e+05, 3.9600e+05, 3.9601e+05, 3.9604e+05,
         7.7235e+05, 7.5471e+05, 7.9429e+05, 0.0000e+00, 3.9600e+05, 3.9599e+05,
         3.9600e+05, 3.9604e+05, 3.9601e+05, 7.8637e+05],
        [1.3776e+00, 1.5538e+00, 3.9734e+05, 1.3841e+00, 1.5015e+00, 1.4384e+00,
         3.8311e+05, 3.7499e+05, 3.9464e+05, 3.9600e+05, 0.0000e+00, 1.3573e+00,
         1.6016e+00, 1.5829e+00, 1.3008e+00, 3.8176e+05],
        [1.4388e+00, 1.6058e+00, 3.9737e+05, 1.3418e+00, 1.3792e+00, 1.4325e+00,
         3.8311e+05, 3.7499e+05, 3.9462e+05, 3.9599e+05, 1.3573e+00, 0.0000e+00,
         1.5347e+00, 1.4690e+00, 1.4565e+00, 3.8178e+05],
        [1.6734e+00, 1.8305e+00, 3.9734e+05, 1.5865e+00, 1.4348e+00, 1.5576e+00,
         3.8313e+05, 3.7500e+05, 3.9466e+05, 3.9600e+05, 1.6016e+00, 1.5347e+00,
         0.0000e+00, 1.3950e+00, 1.5415e+00, 3.8175e+05],
        [1.4431e+00, 1.6416e+00, 3.9738e+05, 1.4211e+00, 1.4065e+00, 1.4658e+00,
         3.8316e+05, 3.7497e+05, 3.9464e+05, 3.9604e+05, 1.5829e+00, 1.4690e+00,
         1.3950e+00, 0.0000e+00, 1.4536e+00, 3.8175e+05],
        [1.3752e+00, 1.6547e+00, 3.9736e+05, 1.3309e+00, 1.4576e+00, 1.4059e+00,
         3.8315e+05, 3.7500e+05, 3.9464e+05, 3.9601e+05, 1.3008e+00, 1.4565e+00,
         1.5415e+00, 1.4536e+00, 0.0000e+00, 3.8177e+05],
        [3.8178e+05, 3.8176e+05, 7.8716e+05, 3.8174e+05, 3.8175e+05, 3.8179e+05,
         7.7419e+05, 7.4725e+05, 7.8544e+05, 7.8637e+05, 3.8176e+05, 3.8178e+05,
         3.8175e+05, 3.8175e+05, 3.8177e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3437e+00, 1.3752e+00, 1.3776e+00, 1.4388e+00, 1.4431e+00,
        1.4842e+00, 1.5109e+00, 1.6266e+00, 1.6734e+00, 3.7499e+05, 3.8178e+05,
        3.8314e+05, 3.9462e+05, 3.9601e+05, 3.9735e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4781e+00, 1.5538e+00, 1.6058e+00, 1.6266e+00, 1.6416e+00,
        1.6547e+00, 1.7870e+00, 1.8067e+00, 1.8305e+00, 3.7501e+05, 3.8176e+05,
        3.8315e+05, 3.9461e+05, 3.9598e+05, 3.9734e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397330.0625, 397338.0312, 397338.9375, 397343.0625,
        397353.3750, 397356.1250, 397356.9688, 397369.1562, 397378.7188,
        397379.3125, 754411.6250, 768413.6250, 779093.7500, 781237.9375,
        787159.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3309e+00, 1.3418e+00, 1.3437e+00, 1.3841e+00, 1.4211e+00,
        1.4364e+00, 1.4781e+00, 1.4900e+00, 1.5865e+00, 3.7500e+05, 3.8174e+05,
        3.8315e+05, 3.9463e+05, 3.9600e+05, 3.9738e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3792e+00, 1.4065e+00, 1.4348e+00, 1.4369e+00, 1.4576e+00,
        1.4900e+00, 1.5015e+00, 1.5109e+00, 1.8067e+00, 3.7501e+05, 3.8175e+05,
        3.8312e+05, 3.9462e+05, 3.9601e+05, 3.9736e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4059e+00, 1.4325e+00, 1.4364e+00, 1.4369e+00, 1.4384e+00,
        1.4658e+00, 1.4842e+00, 1.5576e+00, 1.7870e+00, 3.7498e+05, 3.8179e+05,
        3.8313e+05, 3.9460e+05, 3.9604e+05, 3.9733e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383105.6250, 383107.4375, 383116.2188, 383126.1562,
        383134.7188, 383143.0000, 383145.5000, 383151.5000, 383152.0000,
        383155.6250, 754411.6250, 767219.3750, 769771.3125, 772347.5000,
        774188.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374968.8125, 374977.7188, 374989.0625, 374991.2500,
        374993.0625, 374995.2188, 375000.2188, 375000.6562, 375010.2188,
        375010.4375, 747252.6250, 754705.3125, 758818.2500, 767219.3750,
        768413.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394595.6562, 394605.9062, 394619.3125, 394619.4688,
        394623.9062, 394626.0312, 394635.4062, 394638.0312, 394644.3438,
        394664.8438, 758818.2500, 769771.3125, 779093.7500, 785435.1250,
        794289.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395980.1875, 395987.2500, 395996.9375, 396001.1875,
        396003.4062, 396008.0625, 396009.4062, 396014.3750, 396039.4062,
        396043.8750, 754705.3125, 772347.5000, 781237.9375, 786368.9375,
        794289.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3008e+00, 1.3573e+00, 1.3776e+00, 1.3841e+00, 1.4384e+00,
        1.5015e+00, 1.5538e+00, 1.5829e+00, 1.6016e+00, 3.7499e+05, 3.8176e+05,
        3.8311e+05, 3.9464e+05, 3.9600e+05, 3.9734e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3418e+00, 1.3573e+00, 1.3792e+00, 1.4325e+00, 1.4388e+00,
        1.4565e+00, 1.4690e+00, 1.5347e+00, 1.6058e+00, 3.7499e+05, 3.8178e+05,
        3.8311e+05, 3.9462e+05, 3.9599e+05, 3.9737e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3950e+00, 1.4348e+00, 1.5347e+00, 1.5415e+00, 1.5576e+00,
        1.5865e+00, 1.6016e+00, 1.6734e+00, 1.8305e+00, 3.7500e+05, 3.8175e+05,
        3.8313e+05, 3.9466e+05, 3.9600e+05, 3.9734e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3950e+00, 1.4065e+00, 1.4211e+00, 1.4431e+00, 1.4536e+00,
        1.4658e+00, 1.4690e+00, 1.5829e+00, 1.6416e+00, 3.7497e+05, 3.8175e+05,
        3.8316e+05, 3.9464e+05, 3.9604e+05, 3.9738e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3008e+00, 1.3309e+00, 1.3752e+00, 1.4059e+00, 1.4536e+00,
        1.4565e+00, 1.4576e+00, 1.5415e+00, 1.6547e+00, 3.7500e+05, 3.8177e+05,
        3.8315e+05, 3.9464e+05, 3.9601e+05, 3.9736e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381739.9062, 381750.1250, 381750.8750, 381751.3750,
        381755.4375, 381760.0000, 381772.0000, 381775.5938, 381779.5000,
        381787.5938, 747252.6250, 774188.6250, 785435.1250, 786368.9375,
        787159.0000])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37500.63', '37502.54', '397354.38', '37500.80', '37502.37', '37499.12', '383133.81', '374993.69', '394627.31', '396008.44', '37500.43', '37500.21', '37501.48', '37498.21', '37501.32', '381762.25']
estimated f for each client, fs: [6, 6, 4, 6, 6, 6, 4, 4, 4, 4, 6, 6, 6, 6, 6, 4]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 8, 19, 1, 11, 10, 18, 14, 13, 17, 7, 5, 4, 6, 2, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:13...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:13, End: 2025-07-22 16:01:13)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [18, 1, 2, 20, 5, 17, 9, 15, 6, 8, 13, 3, 14, 11, 10, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9349e+05, 3.9348e+05, 7.6603e+05, 3.9348e+05, 7.8314e+05,
         3.9347e+05, 7.7913e+05, 3.9349e+05, 3.9349e+05, 7.7258e+05, 3.9347e+05,
         7.8472e+05, 3.9349e+05, 3.9347e+05, 7.7986e+05],
        [3.9349e+05, 0.0000e+00, 1.3462e+00, 3.9402e+05, 1.3343e+00, 3.8335e+05,
         1.3334e+00, 3.8571e+05, 1.3780e+00, 1.3189e+00, 3.9012e+05, 1.4015e+00,
         3.9159e+05, 1.4824e+00, 1.4292e+00, 3.8383e+05],
        [3.9348e+05, 1.3462e+00, 0.0000e+00, 3.9403e+05, 1.4522e+00, 3.8337e+05,
         1.3482e+00, 3.8566e+05, 1.4665e+00, 1.4945e+00, 3.9010e+05, 1.4037e+00,
         3.9156e+05, 1.4337e+00, 1.3927e+00, 3.8383e+05],
        [7.6603e+05, 3.9402e+05, 3.9403e+05, 0.0000e+00, 3.9403e+05, 7.7782e+05,
         3.9400e+05, 7.7995e+05, 3.9401e+05, 3.9399e+05, 8.1830e+05, 3.9403e+05,
         7.9838e+05, 3.9403e+05, 3.9403e+05, 7.7034e+05],
        [3.9348e+05, 1.3343e+00, 1.4522e+00, 3.9403e+05, 0.0000e+00, 3.8339e+05,
         1.4136e+00, 3.8568e+05, 1.4864e+00, 1.4491e+00, 3.9011e+05, 1.3148e+00,
         3.9160e+05, 1.3758e+00, 1.4186e+00, 3.8383e+05],
        [7.8314e+05, 3.8335e+05, 3.8337e+05, 7.7782e+05, 3.8339e+05, 0.0000e+00,
         3.8337e+05, 7.5699e+05, 3.8336e+05, 3.8335e+05, 7.6159e+05, 3.8335e+05,
         7.7895e+05, 3.8335e+05, 3.8338e+05, 7.4966e+05],
        [3.9347e+05, 1.3334e+00, 1.3482e+00, 3.9400e+05, 1.4136e+00, 3.8337e+05,
         0.0000e+00, 3.8568e+05, 1.3681e+00, 1.4428e+00, 3.9008e+05, 1.3589e+00,
         3.9159e+05, 1.4974e+00, 1.4535e+00, 3.8380e+05],
        [7.7913e+05, 3.8571e+05, 3.8566e+05, 7.7995e+05, 3.8568e+05, 7.5699e+05,
         3.8568e+05, 0.0000e+00, 3.8570e+05, 3.8569e+05, 7.8571e+05, 3.8567e+05,
         7.7196e+05, 3.8566e+05, 3.8566e+05, 7.6444e+05],
        [3.9349e+05, 1.3780e+00, 1.4665e+00, 3.9401e+05, 1.4864e+00, 3.8336e+05,
         1.3681e+00, 3.8570e+05, 0.0000e+00, 1.3115e+00, 3.9009e+05, 1.4572e+00,
         3.9157e+05, 1.5771e+00, 1.5717e+00, 3.8382e+05],
        [3.9349e+05, 1.3189e+00, 1.4945e+00, 3.9399e+05, 1.4491e+00, 3.8335e+05,
         1.4428e+00, 3.8569e+05, 1.3115e+00, 0.0000e+00, 3.9011e+05, 1.4210e+00,
         3.9160e+05, 1.5804e+00, 1.4968e+00, 3.8382e+05],
        [7.7258e+05, 3.9012e+05, 3.9010e+05, 8.1830e+05, 3.9011e+05, 7.6159e+05,
         3.9008e+05, 7.8571e+05, 3.9009e+05, 3.9011e+05, 0.0000e+00, 3.9011e+05,
         7.4940e+05, 3.9008e+05, 3.9008e+05, 7.7888e+05],
        [3.9347e+05, 1.4015e+00, 1.4037e+00, 3.9403e+05, 1.3148e+00, 3.8335e+05,
         1.3589e+00, 3.8567e+05, 1.4572e+00, 1.4210e+00, 3.9011e+05, 0.0000e+00,
         3.9163e+05, 1.5763e+00, 1.4143e+00, 3.8382e+05],
        [7.8472e+05, 3.9159e+05, 3.9156e+05, 7.9838e+05, 3.9160e+05, 7.7895e+05,
         3.9159e+05, 7.7196e+05, 3.9157e+05, 3.9160e+05, 7.4940e+05, 3.9163e+05,
         0.0000e+00, 3.9155e+05, 3.9157e+05, 7.7045e+05],
        [3.9349e+05, 1.4824e+00, 1.4337e+00, 3.9403e+05, 1.3758e+00, 3.8335e+05,
         1.4974e+00, 3.8566e+05, 1.5771e+00, 1.5804e+00, 3.9008e+05, 1.5763e+00,
         3.9155e+05, 0.0000e+00, 1.4342e+00, 3.8379e+05],
        [3.9347e+05, 1.4292e+00, 1.3927e+00, 3.9403e+05, 1.4186e+00, 3.8338e+05,
         1.4535e+00, 3.8566e+05, 1.5717e+00, 1.4968e+00, 3.9008e+05, 1.4143e+00,
         3.9157e+05, 1.4342e+00, 0.0000e+00, 3.8382e+05],
        [7.7986e+05, 3.8383e+05, 3.8383e+05, 7.7034e+05, 3.8383e+05, 7.4966e+05,
         3.8380e+05, 7.6444e+05, 3.8382e+05, 3.8382e+05, 7.7888e+05, 3.8382e+05,
         7.7045e+05, 3.8379e+05, 3.8382e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 393469.7812, 393472.5000, 393473.5625, 393483.5625,
        393484.5625, 393488.6562, 393489.2500, 393490.9062, 393493.8438,
        766031.5625, 772577.0000, 779128.5000, 779860.6250, 783142.8750,
        784722.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3189e+00, 1.3334e+00, 1.3343e+00, 1.3462e+00, 1.3780e+00,
        1.4015e+00, 1.4292e+00, 1.4824e+00, 3.8335e+05, 3.8383e+05, 3.8571e+05,
        3.9012e+05, 3.9159e+05, 3.9349e+05, 3.9402e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3462e+00, 1.3482e+00, 1.3927e+00, 1.4037e+00, 1.4337e+00,
        1.4522e+00, 1.4665e+00, 1.4945e+00, 3.8337e+05, 3.8383e+05, 3.8566e+05,
        3.9010e+05, 3.9156e+05, 3.9348e+05, 3.9403e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393991.0938, 394000.2500, 394014.8438, 394015.0312,
        394025.2500, 394027.9688, 394028.7500, 394030.3750, 394034.8125,
        766031.5625, 770342.3750, 777824.6875, 779951.5000, 798383.3125,
        818303.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3148e+00, 1.3343e+00, 1.3758e+00, 1.4136e+00, 1.4186e+00,
        1.4491e+00, 1.4522e+00, 1.4864e+00, 3.8339e+05, 3.8383e+05, 3.8568e+05,
        3.9011e+05, 3.9160e+05, 3.9348e+05, 3.9403e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383347.1562, 383347.4375, 383349.2812, 383354.2812,
        383359.5000, 383374.0625, 383374.6250, 383377.9062, 383390.7812,
        749655.1250, 756993.8750, 761592.2500, 777824.6875, 778951.4375,
        783142.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3334e+00, 1.3482e+00, 1.3589e+00, 1.3681e+00, 1.4136e+00,
        1.4428e+00, 1.4535e+00, 1.4974e+00, 3.8337e+05, 3.8380e+05, 3.8568e+05,
        3.9008e+05, 3.9159e+05, 3.9347e+05, 3.9400e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385656.2500, 385658.1875, 385663.6875, 385673.5312,
        385676.4375, 385682.5625, 385692.5000, 385698.8750, 385713.9062,
        756993.8750, 764442.0000, 771960.3750, 779128.5000, 779951.5000,
        785707.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3115e+00, 1.3681e+00, 1.3780e+00, 1.4572e+00, 1.4665e+00,
        1.4864e+00, 1.5717e+00, 1.5771e+00, 3.8336e+05, 3.8382e+05, 3.8570e+05,
        3.9009e+05, 3.9157e+05, 3.9349e+05, 3.9401e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3115e+00, 1.3189e+00, 1.4210e+00, 1.4428e+00, 1.4491e+00,
        1.4945e+00, 1.4968e+00, 1.5804e+00, 3.8335e+05, 3.8382e+05, 3.8569e+05,
        3.9011e+05, 3.9160e+05, 3.9349e+05, 3.9399e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390079.6875, 390082.3750, 390082.4062, 390086.7500,
        390096.1250, 390108.1250, 390108.6562, 390109.5000, 390122.2812,
        749399.1875, 761592.2500, 772577.0000, 778876.1875, 785707.1250,
        818303.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3148e+00, 1.3589e+00, 1.4015e+00, 1.4037e+00, 1.4143e+00,
        1.4210e+00, 1.4572e+00, 1.5763e+00, 3.8335e+05, 3.8382e+05, 3.8567e+05,
        3.9011e+05, 3.9163e+05, 3.9347e+05, 3.9403e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391545.4688, 391562.9375, 391572.0000, 391574.8125,
        391587.6250, 391593.7812, 391597.3125, 391604.1875, 391630.1250,
        749399.1875, 770446.3125, 771960.3750, 778951.4375, 784722.7500,
        798383.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3758e+00, 1.4337e+00, 1.4342e+00, 1.4824e+00, 1.4974e+00,
        1.5763e+00, 1.5771e+00, 1.5804e+00, 3.8335e+05, 3.8379e+05, 3.8566e+05,
        3.9008e+05, 3.9155e+05, 3.9349e+05, 3.9403e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3927e+00, 1.4143e+00, 1.4186e+00, 1.4292e+00, 1.4342e+00,
        1.4535e+00, 1.4968e+00, 1.5717e+00, 3.8338e+05, 3.8382e+05, 3.8566e+05,
        3.9008e+05, 3.9157e+05, 3.9347e+05, 3.9403e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383788.7812, 383802.0000, 383818.8438, 383820.2812,
        383820.5312, 383821.5000, 383827.0625, 383830.5000, 383833.0625,
        749655.1250, 764442.0000, 770342.3750, 770446.3125, 778876.1875,
        779860.6250])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['430737.81', '76718.52', '76721.59', '431220.00', '76723.52', '419993.00', '76718.79', '422811.00', '76719.26', '76717.77', '426027.50', '76718.61', '427366.69', '76715.00', '76720.98', '420401.75']
estimated f for each client, fs: [5, 7, 7, 5, 7, 5, 7, 5, 7, 7, 5, 7, 5, 7, 7, 5]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [18, 1, 2, 20, 5, 17, 9, 15, 6, 8, 13, 3, 14, 11, 10, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0279s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:14...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[167  70]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:14, End: 2025-07-22 16:01:14)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [18, 1, 14, 12, 8, 9, 20, 10, 15, 2, 11, 3, 6, 19, 7, 17], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0044e+05, 7.8027e+05, 4.0046e+05, 4.0041e+05, 4.0043e+05,
         8.1999e+05, 4.0041e+05, 7.9887e+05, 4.0042e+05, 4.0039e+05, 4.0044e+05,
         4.0041e+05, 7.8461e+05, 4.0043e+05, 8.0562e+05],
        [4.0044e+05, 0.0000e+00, 3.9365e+05, 1.3174e+00, 1.2950e+00, 1.3478e+00,
         4.0026e+05, 1.4349e+00, 3.9636e+05, 1.3262e+00, 1.3755e+00, 1.3851e+00,
         1.3334e+00, 3.8487e+05, 1.3915e+00, 4.0632e+05],
        [7.8027e+05, 3.9365e+05, 0.0000e+00, 3.9366e+05, 3.9367e+05, 3.9366e+05,
         8.1642e+05, 3.9365e+05, 7.9402e+05, 3.9362e+05, 3.9367e+05, 3.9366e+05,
         3.9365e+05, 7.6314e+05, 3.9369e+05, 7.8555e+05],
        [4.0046e+05, 1.3174e+00, 3.9366e+05, 0.0000e+00, 1.2974e+00, 1.3362e+00,
         4.0026e+05, 1.3491e+00, 3.9635e+05, 1.3388e+00, 1.3683e+00, 1.2301e+00,
         1.2836e+00, 3.8486e+05, 1.3007e+00, 4.0630e+05],
        [4.0041e+05, 1.2950e+00, 3.9367e+05, 1.2974e+00, 0.0000e+00, 1.3918e+00,
         4.0026e+05, 1.4180e+00, 3.9637e+05, 1.4166e+00, 1.3786e+00, 1.3350e+00,
         1.1856e+00, 3.8488e+05, 1.3258e+00, 4.0628e+05],
        [4.0043e+05, 1.3478e+00, 3.9366e+05, 1.3362e+00, 1.3918e+00, 0.0000e+00,
         4.0023e+05, 1.4955e+00, 3.9635e+05, 1.3217e+00, 1.4373e+00, 1.3222e+00,
         1.3382e+00, 3.8489e+05, 1.3784e+00, 4.0629e+05],
        [8.1999e+05, 4.0026e+05, 8.1642e+05, 4.0026e+05, 4.0026e+05, 4.0023e+05,
         0.0000e+00, 4.0025e+05, 7.9748e+05, 4.0024e+05, 4.0026e+05, 4.0028e+05,
         4.0024e+05, 7.8399e+05, 4.0026e+05, 8.2485e+05],
        [4.0041e+05, 1.4349e+00, 3.9365e+05, 1.3491e+00, 1.4180e+00, 1.4955e+00,
         4.0025e+05, 0.0000e+00, 3.9638e+05, 1.3426e+00, 1.4957e+00, 1.3810e+00,
         1.4587e+00, 3.8487e+05, 1.3591e+00, 4.0632e+05],
        [7.9887e+05, 3.9636e+05, 7.9402e+05, 3.9635e+05, 3.9637e+05, 3.9635e+05,
         7.9748e+05, 3.9638e+05, 0.0000e+00, 3.9637e+05, 3.9634e+05, 3.9635e+05,
         3.9638e+05, 7.7137e+05, 3.9634e+05, 8.1792e+05],
        [4.0042e+05, 1.3262e+00, 3.9362e+05, 1.3388e+00, 1.4166e+00, 1.3217e+00,
         4.0024e+05, 1.3426e+00, 3.9637e+05, 0.0000e+00, 1.4041e+00, 1.3513e+00,
         1.3644e+00, 3.8486e+05, 1.2749e+00, 4.0633e+05],
        [4.0039e+05, 1.3755e+00, 3.9367e+05, 1.3683e+00, 1.3786e+00, 1.4373e+00,
         4.0026e+05, 1.4957e+00, 3.9634e+05, 1.4041e+00, 0.0000e+00, 1.4720e+00,
         1.3709e+00, 3.8486e+05, 1.3965e+00, 4.0629e+05],
        [4.0044e+05, 1.3851e+00, 3.9366e+05, 1.2301e+00, 1.3350e+00, 1.3222e+00,
         4.0028e+05, 1.3810e+00, 3.9635e+05, 1.3513e+00, 1.4720e+00, 0.0000e+00,
         1.3805e+00, 3.8486e+05, 1.3312e+00, 4.0632e+05],
        [4.0041e+05, 1.3334e+00, 3.9365e+05, 1.2836e+00, 1.1856e+00, 1.3382e+00,
         4.0024e+05, 1.4587e+00, 3.9638e+05, 1.3644e+00, 1.3709e+00, 1.3805e+00,
         0.0000e+00, 3.8488e+05, 1.4726e+00, 4.0628e+05],
        [7.8461e+05, 3.8487e+05, 7.6314e+05, 3.8486e+05, 3.8488e+05, 3.8489e+05,
         7.8399e+05, 3.8487e+05, 7.7137e+05, 3.8486e+05, 3.8486e+05, 3.8486e+05,
         3.8488e+05, 0.0000e+00, 3.8488e+05, 8.0431e+05],
        [4.0043e+05, 1.3915e+00, 3.9369e+05, 1.3007e+00, 1.3258e+00, 1.3784e+00,
         4.0026e+05, 1.3591e+00, 3.9634e+05, 1.2749e+00, 1.3965e+00, 1.3312e+00,
         1.4726e+00, 3.8488e+05, 0.0000e+00, 4.0631e+05],
        [8.0562e+05, 4.0632e+05, 7.8555e+05, 4.0630e+05, 4.0628e+05, 4.0629e+05,
         8.2485e+05, 4.0632e+05, 8.1792e+05, 4.0633e+05, 4.0629e+05, 4.0632e+05,
         4.0628e+05, 8.0431e+05, 4.0631e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 400388.5625, 400406.1875, 400408.4688, 400409.7812,
        400415.3750, 400426.6875, 400430.0000, 400438.0312, 400438.9688,
        400455.2500, 780265.1875, 784606.6250, 798874.7500, 805617.3750,
        819993.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2950e+00, 1.3174e+00, 1.3262e+00, 1.3334e+00, 1.3478e+00,
        1.3755e+00, 1.3851e+00, 1.3915e+00, 1.4349e+00, 3.8487e+05, 3.9365e+05,
        3.9636e+05, 4.0026e+05, 4.0044e+05, 4.0632e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393619.2500, 393647.1250, 393649.2812, 393652.4062,
        393662.6562, 393664.1250, 393664.7812, 393666.8438, 393671.8125,
        393694.7500, 763139.3750, 780265.1875, 785551.3750, 794022.6875,
        816418.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2301e+00, 1.2836e+00, 1.2974e+00, 1.3007e+00, 1.3174e+00,
        1.3362e+00, 1.3388e+00, 1.3491e+00, 1.3683e+00, 3.8486e+05, 3.9366e+05,
        3.9635e+05, 4.0026e+05, 4.0046e+05, 4.0630e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1856e+00, 1.2950e+00, 1.2974e+00, 1.3258e+00, 1.3350e+00,
        1.3786e+00, 1.3918e+00, 1.4166e+00, 1.4180e+00, 3.8488e+05, 3.9367e+05,
        3.9637e+05, 4.0026e+05, 4.0041e+05, 4.0628e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3217e+00, 1.3222e+00, 1.3362e+00, 1.3382e+00, 1.3478e+00,
        1.3784e+00, 1.3918e+00, 1.4373e+00, 1.4955e+00, 3.8489e+05, 3.9366e+05,
        3.9635e+05, 4.0023e+05, 4.0043e+05, 4.0629e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 400232.3750, 400235.4375, 400237.8438, 400245.7500,
        400257.3125, 400258.8750, 400259.2188, 400262.3750, 400263.2188,
        400279.5938, 783985.8125, 797477.0000, 816418.8125, 819993.9375,
        824850.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3426e+00, 1.3491e+00, 1.3591e+00, 1.3810e+00, 1.4180e+00,
        1.4349e+00, 1.4587e+00, 1.4955e+00, 1.4957e+00, 3.8487e+05, 3.9365e+05,
        3.9638e+05, 4.0025e+05, 4.0041e+05, 4.0632e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396343.6875, 396344.7188, 396347.0000, 396347.6875,
        396354.5312, 396358.1875, 396368.3750, 396374.9062, 396377.1562,
        396380.9375, 771365.7500, 794022.6875, 797477.0000, 798874.7500,
        817920.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2749e+00, 1.3217e+00, 1.3262e+00, 1.3388e+00, 1.3426e+00,
        1.3513e+00, 1.3644e+00, 1.4041e+00, 1.4166e+00, 3.8486e+05, 3.9362e+05,
        3.9637e+05, 4.0024e+05, 4.0042e+05, 4.0633e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3683e+00, 1.3709e+00, 1.3755e+00, 1.3786e+00, 1.3965e+00,
        1.4041e+00, 1.4373e+00, 1.4720e+00, 1.4957e+00, 3.8486e+05, 3.9367e+05,
        3.9634e+05, 4.0026e+05, 4.0039e+05, 4.0629e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2301e+00, 1.3222e+00, 1.3312e+00, 1.3350e+00, 1.3513e+00,
        1.3805e+00, 1.3810e+00, 1.3851e+00, 1.4720e+00, 3.8486e+05, 3.9366e+05,
        3.9635e+05, 4.0028e+05, 4.0044e+05, 4.0632e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1856e+00, 1.2836e+00, 1.3334e+00, 1.3382e+00, 1.3644e+00,
        1.3709e+00, 1.3805e+00, 1.4587e+00, 1.4726e+00, 3.8488e+05, 3.9365e+05,
        3.9638e+05, 4.0024e+05, 4.0041e+05, 4.0628e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384856.8125, 384861.6562, 384862.8125, 384863.8438,
        384868.0312, 384873.3125, 384875.0000, 384882.3125, 384883.6562,
        384889.5000, 763139.3750, 771365.7500, 783985.8125, 784606.6250,
        804310.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2749e+00, 1.3007e+00, 1.3258e+00, 1.3312e+00, 1.3591e+00,
        1.3784e+00, 1.3915e+00, 1.3965e+00, 1.4726e+00, 3.8488e+05, 3.9369e+05,
        3.9634e+05, 4.0026e+05, 4.0043e+05, 4.0631e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406281.5938, 406283.9375, 406287.6250, 406291.6562,
        406301.7500, 406314.9375, 406315.2500, 406317.3125, 406321.2500,
        406325.4688, 785551.3750, 804310.1875, 805617.3750, 817920.6250,
        824850.3125])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['400421.72', '38488.02', '393659.31', '38487.57', '38488.70', '38490.19', '400253.19', '38488.60', '396359.75', '38486.89', '38487.55', '38487.38', '38489.45', '384871.69', '38489.59', '406304.06']
estimated f for each client, fs: [4, 6, 4, 6, 6, 6, 4, 6, 4, 6, 6, 6, 6, 4, 6, 4]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [18, 1, 14, 12, 8, 9, 20, 10, 15, 2, 11, 3, 6, 19, 7, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0206s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:15...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:15, End: 2025-07-22 16:01:15)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 11, 8, 7, 5, 6, 13, 15, 14, 16, 12, 20, 17, 19, 18, 10], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1773e+00, 1.2542e+00, 1.2399e+00, 1.3096e+00, 1.1941e+00,
         3.8568e+05, 3.9245e+05, 3.8991e+05, 4.0215e+05, 1.1641e+00, 4.0335e+05,
         3.9118e+05, 3.9098e+05, 3.8811e+05, 1.3092e+00],
        [1.1773e+00, 0.0000e+00, 1.1678e+00, 1.1914e+00, 1.1595e+00, 1.1603e+00,
         3.8566e+05, 3.9247e+05, 3.8994e+05, 4.0214e+05, 1.1498e+00, 4.0334e+05,
         3.9118e+05, 3.9096e+05, 3.8810e+05, 1.2348e+00],
        [1.2542e+00, 1.1678e+00, 0.0000e+00, 1.2376e+00, 1.2669e+00, 1.1218e+00,
         3.8566e+05, 3.9246e+05, 3.8992e+05, 4.0214e+05, 1.1864e+00, 4.0336e+05,
         3.9119e+05, 3.9097e+05, 3.8810e+05, 1.2639e+00],
        [1.2399e+00, 1.1914e+00, 1.2376e+00, 0.0000e+00, 1.2540e+00, 1.2935e+00,
         3.8566e+05, 3.9246e+05, 3.8993e+05, 4.0214e+05, 1.1981e+00, 4.0337e+05,
         3.9120e+05, 3.9097e+05, 3.8810e+05, 1.2384e+00],
        [1.3096e+00, 1.1595e+00, 1.2669e+00, 1.2540e+00, 0.0000e+00, 1.2265e+00,
         3.8565e+05, 3.9247e+05, 3.8991e+05, 4.0210e+05, 1.2297e+00, 4.0335e+05,
         3.9119e+05, 3.9095e+05, 3.8814e+05, 1.2059e+00],
        [1.1941e+00, 1.1603e+00, 1.1218e+00, 1.2935e+00, 1.2265e+00, 0.0000e+00,
         3.8563e+05, 3.9248e+05, 3.8989e+05, 4.0213e+05, 1.1719e+00, 4.0338e+05,
         3.9118e+05, 3.9100e+05, 3.8810e+05, 1.2629e+00],
        [3.8568e+05, 3.8566e+05, 3.8566e+05, 3.8566e+05, 3.8565e+05, 3.8563e+05,
         0.0000e+00, 7.8700e+05, 7.7449e+05, 8.0454e+05, 3.8563e+05, 7.9831e+05,
         7.8088e+05, 7.7826e+05, 7.8608e+05, 3.8563e+05],
        [3.9245e+05, 3.9247e+05, 3.9246e+05, 3.9246e+05, 3.9247e+05, 3.9248e+05,
         7.8700e+05, 0.0000e+00, 7.7888e+05, 7.8191e+05, 3.9247e+05, 7.6619e+05,
         7.6238e+05, 8.1093e+05, 7.9159e+05, 3.9246e+05],
        [3.8991e+05, 3.8994e+05, 3.8992e+05, 3.8993e+05, 3.8991e+05, 3.8989e+05,
         7.7449e+05, 7.7888e+05, 0.0000e+00, 7.9736e+05, 3.8994e+05, 7.9408e+05,
         7.8300e+05, 7.7383e+05, 7.6022e+05, 3.8995e+05],
        [4.0215e+05, 4.0214e+05, 4.0214e+05, 4.0214e+05, 4.0210e+05, 4.0213e+05,
         8.0454e+05, 7.8191e+05, 7.9736e+05, 0.0000e+00, 4.0213e+05, 7.8838e+05,
         7.7978e+05, 7.9557e+05, 7.7296e+05, 4.0213e+05],
        [1.1641e+00, 1.1498e+00, 1.1864e+00, 1.1981e+00, 1.2297e+00, 1.1719e+00,
         3.8563e+05, 3.9247e+05, 3.8994e+05, 4.0213e+05, 0.0000e+00, 4.0338e+05,
         3.9118e+05, 3.9098e+05, 3.8812e+05, 1.2057e+00],
        [4.0335e+05, 4.0334e+05, 4.0336e+05, 4.0337e+05, 4.0335e+05, 4.0338e+05,
         7.9831e+05, 7.6619e+05, 7.9408e+05, 7.8838e+05, 4.0338e+05, 0.0000e+00,
         7.9699e+05, 7.9509e+05, 7.8055e+05, 4.0335e+05],
        [3.9118e+05, 3.9118e+05, 3.9119e+05, 3.9120e+05, 3.9119e+05, 3.9118e+05,
         7.8088e+05, 7.6238e+05, 7.8300e+05, 7.7978e+05, 3.9118e+05, 7.9699e+05,
         0.0000e+00, 7.7212e+05, 7.8217e+05, 3.9119e+05],
        [3.9098e+05, 3.9096e+05, 3.9097e+05, 3.9097e+05, 3.9095e+05, 3.9100e+05,
         7.7826e+05, 8.1093e+05, 7.7383e+05, 7.9557e+05, 3.9098e+05, 7.9509e+05,
         7.7212e+05, 0.0000e+00, 7.8625e+05, 3.9095e+05],
        [3.8811e+05, 3.8810e+05, 3.8810e+05, 3.8810e+05, 3.8814e+05, 3.8810e+05,
         7.8608e+05, 7.9159e+05, 7.6022e+05, 7.7296e+05, 3.8812e+05, 7.8055e+05,
         7.8217e+05, 7.8625e+05, 0.0000e+00, 3.8811e+05],
        [1.3092e+00, 1.2348e+00, 1.2639e+00, 1.2384e+00, 1.2059e+00, 1.2629e+00,
         3.8563e+05, 3.9246e+05, 3.8995e+05, 4.0213e+05, 1.2057e+00, 4.0335e+05,
         3.9119e+05, 3.9095e+05, 3.8811e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1641e+00, 1.1773e+00, 1.1941e+00, 1.2399e+00, 1.2542e+00,
        1.3092e+00, 1.3096e+00, 3.8568e+05, 3.8811e+05, 3.8991e+05, 3.9098e+05,
        3.9118e+05, 3.9245e+05, 4.0215e+05, 4.0335e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1498e+00, 1.1595e+00, 1.1603e+00, 1.1678e+00, 1.1773e+00,
        1.1914e+00, 1.2348e+00, 3.8566e+05, 3.8810e+05, 3.8994e+05, 3.9096e+05,
        3.9118e+05, 3.9247e+05, 4.0214e+05, 4.0334e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1218e+00, 1.1678e+00, 1.1864e+00, 1.2376e+00, 1.2542e+00,
        1.2639e+00, 1.2669e+00, 3.8566e+05, 3.8810e+05, 3.8992e+05, 3.9097e+05,
        3.9119e+05, 3.9246e+05, 4.0214e+05, 4.0336e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1914e+00, 1.1981e+00, 1.2376e+00, 1.2384e+00, 1.2399e+00,
        1.2540e+00, 1.2935e+00, 3.8566e+05, 3.8810e+05, 3.8993e+05, 3.9097e+05,
        3.9120e+05, 3.9246e+05, 4.0214e+05, 4.0337e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1595e+00, 1.2059e+00, 1.2265e+00, 1.2297e+00, 1.2540e+00,
        1.2669e+00, 1.3096e+00, 3.8565e+05, 3.8814e+05, 3.8991e+05, 3.9095e+05,
        3.9119e+05, 3.9247e+05, 4.0210e+05, 4.0335e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1218e+00, 1.1603e+00, 1.1719e+00, 1.1941e+00, 1.2265e+00,
        1.2629e+00, 1.2935e+00, 3.8563e+05, 3.8810e+05, 3.8989e+05, 3.9100e+05,
        3.9118e+05, 3.9248e+05, 4.0213e+05, 4.0338e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385627.3438, 385630.2500, 385634.3750, 385648.8125,
        385656.4375, 385663.3125, 385663.5000, 385677.8750, 774493.9375,
        778260.3750, 780876.6250, 786080.5000, 786996.1875, 798314.9375,
        804541.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392452.8125, 392462.4688, 392463.1875, 392464.1875,
        392465.5625, 392473.1250, 392474.8750, 392476.0312, 762378.5000,
        766194.1875, 778883.0625, 781910.6250, 786996.1875, 791589.2500,
        810927.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389887.9062, 389905.0625, 389914.0312, 389923.0625,
        389926.2500, 389938.8750, 389940.0625, 389945.5938, 760224.8750,
        773833.2500, 774493.9375, 778883.0625, 783001.1875, 794078.2500,
        797362.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402102.3125, 402126.7188, 402132.0312, 402132.3438,
        402135.8750, 402136.3125, 402140.1250, 402154.1875, 772961.6250,
        779782.4375, 781910.6250, 788379.4375, 795568.7500, 797362.5625,
        804541.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1498e+00, 1.1641e+00, 1.1719e+00, 1.1864e+00, 1.1981e+00,
        1.2057e+00, 1.2297e+00, 3.8563e+05, 3.8812e+05, 3.8994e+05, 3.9098e+05,
        3.9118e+05, 3.9247e+05, 4.0213e+05, 4.0338e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403344.0000, 403352.4062, 403353.2500, 403353.5312,
        403355.8125, 403368.7188, 403375.8125, 403376.0000, 766194.1875,
        780551.8750, 788379.4375, 794078.2500, 795093.5000, 796992.3750,
        798314.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391175.0312, 391180.1875, 391182.3125, 391182.4375,
        391189.4375, 391191.0000, 391193.1250, 391196.6875, 762378.5000,
        772121.2500, 779782.4375, 780876.6250, 782170.0000, 783001.1875,
        796992.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390948.3750, 390949.7188, 390956.9062, 390969.0938,
        390970.1250, 390975.3125, 390977.1875, 391003.7500, 772121.2500,
        773833.2500, 778260.3750, 786247.9375, 795093.5000, 795568.7500,
        810927.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388096.2812, 388097.7500, 388099.9688, 388104.3125,
        388105.4375, 388113.2500, 388119.4375, 388137.5938, 760224.8750,
        772961.6250, 780551.8750, 782170.0000, 786080.5000, 786247.9375,
        791589.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2057e+00, 1.2059e+00, 1.2348e+00, 1.2384e+00, 1.2629e+00,
        1.2639e+00, 1.3092e+00, 3.8563e+05, 3.8811e+05, 3.8995e+05, 3.9095e+05,
        3.9119e+05, 3.9246e+05, 4.0213e+05, 4.0335e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['116370.60', '116371.17', '116369.12', '116368.91', '116370.02', '116363.52', '463795.66', '466830.50', '465343.84', '476980.34', '116369.40', '477362.56', '466399.00', '467370.50', '463806.06', '116369.77']
estimated f for each client, fs: [8, 8, 8, 8, 8, 8, 7, 5, 5, 5, 8, 5, 5, 5, 5, 8]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 11, 8, 7, 5, 6, 13, 15, 14, 16, 12, 20, 17, 19, 18, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0120s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:15...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:15, End: 2025-07-22 16:01:15)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 10, 7, 17, 13, 15, 9, 5, 14, 1, 11, 4, 3, 12, 20, 18], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4312e+00, 1.3146e+00, 3.9359e+05, 3.7759e+05, 3.8117e+05,
         1.2364e+00, 1.3064e+00, 3.9935e+05, 1.2268e+00, 1.1554e+00, 1.5868e+00,
         1.2955e+00, 1.2170e+00, 3.9302e+05, 3.9982e+05],
        [1.4312e+00, 0.0000e+00, 1.1350e+00, 3.9359e+05, 3.7759e+05, 3.8119e+05,
         1.2664e+00, 1.1382e+00, 3.9936e+05, 1.2353e+00, 1.1976e+00, 1.2735e+00,
         1.1921e+00, 1.1844e+00, 3.9300e+05, 3.9977e+05],
        [1.3146e+00, 1.1350e+00, 0.0000e+00, 3.9359e+05, 3.7760e+05, 3.8117e+05,
         1.1773e+00, 1.1176e+00, 3.9936e+05, 1.1780e+00, 1.1324e+00, 1.3183e+00,
         1.1373e+00, 1.1367e+00, 3.9303e+05, 3.9981e+05],
        [3.9359e+05, 3.9359e+05, 3.9359e+05, 0.0000e+00, 7.7595e+05, 7.5937e+05,
         3.9361e+05, 3.9359e+05, 7.7982e+05, 3.9359e+05, 3.9358e+05, 3.9360e+05,
         3.9360e+05, 3.9357e+05, 7.9596e+05, 7.9113e+05],
        [3.7759e+05, 3.7759e+05, 3.7760e+05, 7.7595e+05, 0.0000e+00, 7.7339e+05,
         3.7762e+05, 3.7762e+05, 7.6652e+05, 3.7762e+05, 3.7761e+05, 3.7760e+05,
         3.7762e+05, 3.7761e+05, 7.6128e+05, 7.5821e+05],
        [3.8117e+05, 3.8119e+05, 3.8117e+05, 7.5937e+05, 7.7339e+05, 0.0000e+00,
         3.8118e+05, 3.8118e+05, 7.9166e+05, 3.8119e+05, 3.8118e+05, 3.8120e+05,
         3.8120e+05, 3.8122e+05, 7.9438e+05, 7.6288e+05],
        [1.2364e+00, 1.2664e+00, 1.1773e+00, 3.9361e+05, 3.7762e+05, 3.8118e+05,
         0.0000e+00, 1.2098e+00, 3.9937e+05, 1.1486e+00, 1.1566e+00, 1.3695e+00,
         1.1784e+00, 1.1546e+00, 3.9301e+05, 3.9980e+05],
        [1.3064e+00, 1.1382e+00, 1.1176e+00, 3.9359e+05, 3.7762e+05, 3.8118e+05,
         1.2098e+00, 0.0000e+00, 3.9936e+05, 1.0895e+00, 1.0836e+00, 1.2338e+00,
         1.1176e+00, 1.1749e+00, 3.9302e+05, 3.9980e+05],
        [3.9935e+05, 3.9936e+05, 3.9936e+05, 7.7982e+05, 7.6652e+05, 7.9166e+05,
         3.9937e+05, 3.9936e+05, 0.0000e+00, 3.9936e+05, 3.9935e+05, 3.9932e+05,
         3.9935e+05, 3.9935e+05, 8.0636e+05, 7.8839e+05],
        [1.2268e+00, 1.2353e+00, 1.1780e+00, 3.9359e+05, 3.7762e+05, 3.8119e+05,
         1.1486e+00, 1.0895e+00, 3.9936e+05, 0.0000e+00, 1.1007e+00, 1.2679e+00,
         1.1820e+00, 1.1354e+00, 3.9300e+05, 3.9983e+05],
        [1.1554e+00, 1.1976e+00, 1.1324e+00, 3.9358e+05, 3.7761e+05, 3.8118e+05,
         1.1566e+00, 1.0836e+00, 3.9935e+05, 1.1007e+00, 0.0000e+00, 1.2683e+00,
         1.1819e+00, 1.1247e+00, 3.9302e+05, 3.9979e+05],
        [1.5868e+00, 1.2735e+00, 1.3183e+00, 3.9360e+05, 3.7760e+05, 3.8120e+05,
         1.3695e+00, 1.2338e+00, 3.9932e+05, 1.2679e+00, 1.2683e+00, 0.0000e+00,
         1.3025e+00, 1.2994e+00, 3.9301e+05, 3.9982e+05],
        [1.2955e+00, 1.1921e+00, 1.1373e+00, 3.9360e+05, 3.7762e+05, 3.8120e+05,
         1.1784e+00, 1.1176e+00, 3.9935e+05, 1.1820e+00, 1.1819e+00, 1.3025e+00,
         0.0000e+00, 1.0497e+00, 3.9301e+05, 3.9982e+05],
        [1.2170e+00, 1.1844e+00, 1.1367e+00, 3.9357e+05, 3.7761e+05, 3.8122e+05,
         1.1546e+00, 1.1749e+00, 3.9935e+05, 1.1354e+00, 1.1247e+00, 1.2994e+00,
         1.0497e+00, 0.0000e+00, 3.9303e+05, 3.9979e+05],
        [3.9302e+05, 3.9300e+05, 3.9303e+05, 7.9596e+05, 7.6128e+05, 7.9438e+05,
         3.9301e+05, 3.9302e+05, 8.0636e+05, 3.9300e+05, 3.9302e+05, 3.9301e+05,
         3.9301e+05, 3.9303e+05, 0.0000e+00, 7.6639e+05],
        [3.9982e+05, 3.9977e+05, 3.9981e+05, 7.9113e+05, 7.5821e+05, 7.6288e+05,
         3.9980e+05, 3.9980e+05, 7.8839e+05, 3.9983e+05, 3.9979e+05, 3.9982e+05,
         3.9982e+05, 3.9979e+05, 7.6639e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1554e+00, 1.2170e+00, 1.2268e+00, 1.2364e+00, 1.2955e+00,
        1.3064e+00, 1.3146e+00, 1.4312e+00, 1.5868e+00, 3.7759e+05, 3.8117e+05,
        3.9302e+05, 3.9359e+05, 3.9935e+05, 3.9982e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1350e+00, 1.1382e+00, 1.1844e+00, 1.1921e+00, 1.1976e+00,
        1.2353e+00, 1.2664e+00, 1.2735e+00, 1.4312e+00, 3.7759e+05, 3.8119e+05,
        3.9300e+05, 3.9359e+05, 3.9936e+05, 3.9977e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1176e+00, 1.1324e+00, 1.1350e+00, 1.1367e+00, 1.1373e+00,
        1.1773e+00, 1.1780e+00, 1.3146e+00, 1.3183e+00, 3.7760e+05, 3.8117e+05,
        3.9303e+05, 3.9359e+05, 3.9936e+05, 3.9981e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393570.9375, 393582.3125, 393587.1875, 393587.9062,
        393589.1875, 393590.0312, 393593.9688, 393596.8438, 393603.2500,
        393612.5000, 759371.0625, 775946.9375, 779820.6250, 791126.9375,
        795962.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377593.3125, 377594.7188, 377600.8438, 377601.5938,
        377609.2812, 377611.0000, 377615.0938, 377616.4375, 377622.6875,
        377623.8750, 758211.4375, 761278.8750, 766524.8125, 773390.4375,
        775946.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381173.8125, 381174.1250, 381176.1250, 381176.8438,
        381183.7188, 381194.1875, 381194.9062, 381200.3438, 381201.5312,
        381221.0938, 759371.0625, 762883.8125, 773390.4375, 791661.8125,
        794384.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1486e+00, 1.1546e+00, 1.1566e+00, 1.1773e+00, 1.1784e+00,
        1.2098e+00, 1.2364e+00, 1.2664e+00, 1.3695e+00, 3.7762e+05, 3.8118e+05,
        3.9301e+05, 3.9361e+05, 3.9937e+05, 3.9980e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0836e+00, 1.0895e+00, 1.1176e+00, 1.1176e+00, 1.1382e+00,
        1.1749e+00, 1.2098e+00, 1.2338e+00, 1.3064e+00, 3.7762e+05, 3.8118e+05,
        3.9302e+05, 3.9359e+05, 3.9936e+05, 3.9980e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399324.6250, 399345.1250, 399345.7812, 399347.6875,
        399348.7188, 399357.1875, 399359.3750, 399363.1875, 399364.1250,
        399373.7812, 766524.8125, 779820.6250, 788392.8750, 791661.8125,
        806363.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0895e+00, 1.1007e+00, 1.1354e+00, 1.1486e+00, 1.1780e+00,
        1.1820e+00, 1.2268e+00, 1.2353e+00, 1.2679e+00, 3.7762e+05, 3.8119e+05,
        3.9300e+05, 3.9359e+05, 3.9936e+05, 3.9983e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0836e+00, 1.1007e+00, 1.1247e+00, 1.1324e+00, 1.1554e+00,
        1.1566e+00, 1.1819e+00, 1.1976e+00, 1.2683e+00, 3.7761e+05, 3.8118e+05,
        3.9302e+05, 3.9358e+05, 3.9935e+05, 3.9979e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2338e+00, 1.2679e+00, 1.2683e+00, 1.2735e+00, 1.2994e+00,
        1.3025e+00, 1.3183e+00, 1.3695e+00, 1.5868e+00, 3.7760e+05, 3.8120e+05,
        3.9301e+05, 3.9360e+05, 3.9932e+05, 3.9982e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0497e+00, 1.1176e+00, 1.1373e+00, 1.1784e+00, 1.1819e+00,
        1.1820e+00, 1.1921e+00, 1.2955e+00, 1.3025e+00, 3.7762e+05, 3.8120e+05,
        3.9301e+05, 3.9360e+05, 3.9935e+05, 3.9982e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0497e+00, 1.1247e+00, 1.1354e+00, 1.1367e+00, 1.1546e+00,
        1.1749e+00, 1.1844e+00, 1.2170e+00, 1.2994e+00, 3.7761e+05, 3.8122e+05,
        3.9303e+05, 3.9357e+05, 3.9935e+05, 3.9979e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392996.2188, 393004.2188, 393006.3750, 393011.5625,
        393013.4688, 393018.0938, 393018.1875, 393024.0312, 393028.2500,
        393031.3125, 761278.8750, 766389.8125, 794384.3125, 795962.0000,
        806363.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399769.0625, 399785.9375, 399791.9062, 399795.3125,
        399798.8750, 399812.8438, 399816.7188, 399817.1250, 399817.5938,
        399832.7188, 758211.4375, 762883.8125, 766389.8125, 788392.8750,
        791126.9375])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37760.51', '37760.58', '37761.15', '393591.44', '377608.88', '381189.69', '37762.74', '37762.56', '399352.97', '37763.45', '37761.97', '37761.36', '37763.34', '37762.15', '393015.19', '399803.81']
estimated f for each client, fs: [6, 6, 6, 4, 5, 4, 6, 6, 4, 6, 6, 6, 6, 6, 4, 4]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 10, 7, 17, 13, 15, 9, 5, 14, 1, 11, 4, 3, 12, 20, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0122s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:16...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:16, End: 2025-07-22 16:01:16)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 20, 6, 18, 9, 10, 17, 5, 11, 7, 19, 1, 14, 3, 4, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 8.1177e+05, 3.9755e+05, 7.7484e+05, 3.9755e+05, 3.9754e+05,
         8.2947e+05, 3.9755e+05, 3.9756e+05, 3.9751e+05, 7.4990e+05, 3.9754e+05,
         7.9495e+05, 3.9753e+05, 3.9752e+05, 3.9753e+05],
        [8.1177e+05, 0.0000e+00, 4.0619e+05, 7.7889e+05, 4.0618e+05, 4.0614e+05,
         8.0376e+05, 4.0617e+05, 4.0619e+05, 4.0619e+05, 7.7831e+05, 4.0620e+05,
         8.0868e+05, 4.0617e+05, 4.0618e+05, 4.0617e+05],
        [3.9755e+05, 4.0619e+05, 0.0000e+00, 3.8636e+05, 1.2804e+00, 1.5068e+00,
         4.0583e+05, 1.4420e+00, 1.2349e+00, 1.4233e+00, 3.7441e+05, 1.2616e+00,
         3.9342e+05, 1.3434e+00, 1.7353e+00, 1.2129e+00],
        [7.7484e+05, 7.7889e+05, 3.8636e+05, 0.0000e+00, 3.8635e+05, 3.8637e+05,
         8.1859e+05, 3.8636e+05, 3.8639e+05, 3.8639e+05, 7.5300e+05, 3.8636e+05,
         7.8441e+05, 3.8638e+05, 3.8634e+05, 3.8637e+05],
        [3.9755e+05, 4.0618e+05, 1.2804e+00, 3.8635e+05, 0.0000e+00, 1.0963e+00,
         4.0581e+05, 1.0510e+00, 9.9650e-01, 1.0193e+00, 3.7440e+05, 9.9083e-01,
         3.9339e+05, 1.0273e+00, 1.1815e+00, 9.9533e-01],
        [3.9754e+05, 4.0614e+05, 1.5068e+00, 3.8637e+05, 1.0963e+00, 0.0000e+00,
         4.0582e+05, 9.5349e-01, 9.9303e-01, 9.2838e-01, 3.7439e+05, 1.0626e+00,
         3.9337e+05, 1.0184e+00, 1.0899e+00, 1.0078e+00],
        [8.2947e+05, 8.0376e+05, 4.0583e+05, 8.1859e+05, 4.0581e+05, 4.0582e+05,
         0.0000e+00, 4.0584e+05, 4.0583e+05, 4.0584e+05, 7.8674e+05, 4.0582e+05,
         7.9471e+05, 4.0582e+05, 4.0583e+05, 4.0582e+05],
        [3.9755e+05, 4.0617e+05, 1.4420e+00, 3.8636e+05, 1.0510e+00, 9.5349e-01,
         4.0584e+05, 0.0000e+00, 9.3146e-01, 9.1360e-01, 3.7438e+05, 9.5426e-01,
         3.9339e+05, 9.6629e-01, 1.0666e+00, 1.0071e+00],
        [3.9756e+05, 4.0619e+05, 1.2349e+00, 3.8639e+05, 9.9650e-01, 9.9303e-01,
         4.0583e+05, 9.3146e-01, 0.0000e+00, 9.4630e-01, 3.7438e+05, 9.4183e-01,
         3.9338e+05, 1.0079e+00, 1.0724e+00, 9.2982e-01],
        [3.9751e+05, 4.0619e+05, 1.4233e+00, 3.8639e+05, 1.0193e+00, 9.2838e-01,
         4.0584e+05, 9.1360e-01, 9.4630e-01, 0.0000e+00, 3.7442e+05, 1.0047e+00,
         3.9340e+05, 9.4046e-01, 1.1078e+00, 9.5033e-01],
        [7.4990e+05, 7.7831e+05, 3.7441e+05, 7.5300e+05, 3.7440e+05, 3.7439e+05,
         7.8674e+05, 3.7438e+05, 3.7438e+05, 3.7442e+05, 0.0000e+00, 3.7438e+05,
         7.6955e+05, 3.7441e+05, 3.7440e+05, 3.7441e+05],
        [3.9754e+05, 4.0620e+05, 1.2616e+00, 3.8636e+05, 9.9083e-01, 1.0626e+00,
         4.0582e+05, 9.5426e-01, 9.4183e-01, 1.0047e+00, 3.7438e+05, 0.0000e+00,
         3.9339e+05, 1.0414e+00, 1.0969e+00, 9.5047e-01],
        [7.9495e+05, 8.0868e+05, 3.9342e+05, 7.8441e+05, 3.9339e+05, 3.9337e+05,
         7.9471e+05, 3.9339e+05, 3.9338e+05, 3.9340e+05, 7.6955e+05, 3.9339e+05,
         0.0000e+00, 3.9339e+05, 3.9337e+05, 3.9339e+05],
        [3.9753e+05, 4.0617e+05, 1.3434e+00, 3.8638e+05, 1.0273e+00, 1.0184e+00,
         4.0582e+05, 9.6629e-01, 1.0079e+00, 9.4046e-01, 3.7441e+05, 1.0414e+00,
         3.9339e+05, 0.0000e+00, 1.1257e+00, 9.0526e-01],
        [3.9752e+05, 4.0618e+05, 1.7353e+00, 3.8634e+05, 1.1815e+00, 1.0899e+00,
         4.0583e+05, 1.0666e+00, 1.0724e+00, 1.1078e+00, 3.7440e+05, 1.0969e+00,
         3.9337e+05, 1.1257e+00, 0.0000e+00, 1.1233e+00],
        [3.9753e+05, 4.0617e+05, 1.2129e+00, 3.8637e+05, 9.9533e-01, 1.0078e+00,
         4.0582e+05, 1.0071e+00, 9.2982e-01, 9.5033e-01, 3.7441e+05, 9.5047e-01,
         3.9339e+05, 9.0526e-01, 1.1233e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 397514.7188, 397519.0000, 397528.0625, 397532.3750,
        397542.6875, 397544.4688, 397545.1250, 397545.9688, 397554.3125,
        397558.8750, 749898.4375, 774843.3125, 794953.0000, 811770.0625,
        829466.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406135.5000, 406170.3750, 406172.8750, 406174.6562,
        406177.2812, 406181.8750, 406187.5312, 406188.4062, 406188.5625,
        406198.6250, 778314.0000, 778893.5625, 803763.8125, 808679.6875,
        811770.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2129e+00, 1.2349e+00, 1.2616e+00, 1.2804e+00, 1.3434e+00,
        1.4233e+00, 1.4420e+00, 1.5068e+00, 1.7353e+00, 3.7441e+05, 3.8636e+05,
        3.9342e+05, 3.9755e+05, 4.0583e+05, 4.0619e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386335.4688, 386348.7812, 386357.0625, 386361.0938,
        386361.9375, 386372.4375, 386373.5312, 386382.6562, 386390.4062,
        386391.5312, 753000.8750, 774843.3125, 778893.5625, 784413.6875,
        818590.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.9083e-01, 9.9533e-01, 9.9650e-01, 1.0193e+00, 1.0273e+00,
        1.0510e+00, 1.0963e+00, 1.1815e+00, 1.2804e+00, 3.7440e+05, 3.8635e+05,
        3.9339e+05, 3.9755e+05, 4.0581e+05, 4.0618e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2838e-01, 9.5349e-01, 9.9303e-01, 1.0078e+00, 1.0184e+00,
        1.0626e+00, 1.0899e+00, 1.0963e+00, 1.5068e+00, 3.7439e+05, 3.8637e+05,
        3.9337e+05, 3.9754e+05, 4.0582e+05, 4.0614e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405808.4062, 405816.2812, 405819.2500, 405820.0625,
        405820.3750, 405829.5312, 405830.9688, 405832.5000, 405836.6562,
        405838.7500, 786735.3125, 794706.1875, 803763.8125, 818590.3750,
        829466.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1360e-01, 9.3146e-01, 9.5349e-01, 9.5426e-01, 9.6629e-01,
        1.0071e+00, 1.0510e+00, 1.0666e+00, 1.4420e+00, 3.7438e+05, 3.8636e+05,
        3.9339e+05, 3.9755e+05, 4.0584e+05, 4.0617e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2982e-01, 9.3146e-01, 9.4183e-01, 9.4630e-01, 9.9303e-01,
        9.9650e-01, 1.0079e+00, 1.0724e+00, 1.2349e+00, 3.7438e+05, 3.8639e+05,
        3.9338e+05, 3.9756e+05, 4.0583e+05, 4.0619e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1360e-01, 9.2838e-01, 9.4046e-01, 9.4630e-01, 9.5033e-01,
        1.0047e+00, 1.0193e+00, 1.1078e+00, 1.4233e+00, 3.7442e+05, 3.8639e+05,
        3.9340e+05, 3.9751e+05, 4.0584e+05, 4.0619e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374375.9062, 374378.8438, 374383.1875, 374394.3750,
        374395.6875, 374399.9688, 374406.2812, 374408.7812, 374410.5312,
        374418.9375, 749898.4375, 753000.8750, 769547.8125, 778314.0000,
        786735.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4183e-01, 9.5047e-01, 9.5426e-01, 9.9083e-01, 1.0047e+00,
        1.0414e+00, 1.0626e+00, 1.0969e+00, 1.2616e+00, 3.7438e+05, 3.8636e+05,
        3.9339e+05, 3.9754e+05, 4.0582e+05, 4.0620e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393369.4688, 393371.6875, 393382.3125, 393386.6875,
        393386.8125, 393386.8438, 393389.9688, 393391.0938, 393403.5938,
        393418.9375, 769547.8125, 784413.6875, 794706.1875, 794953.0000,
        808679.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.0526e-01, 9.4046e-01, 9.6629e-01, 1.0079e+00, 1.0184e+00,
        1.0273e+00, 1.0414e+00, 1.1257e+00, 1.3434e+00, 3.7441e+05, 3.8638e+05,
        3.9339e+05, 3.9753e+05, 4.0582e+05, 4.0617e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0666e+00, 1.0724e+00, 1.0899e+00, 1.0969e+00, 1.1078e+00,
        1.1233e+00, 1.1257e+00, 1.1815e+00, 1.7353e+00, 3.7440e+05, 3.8634e+05,
        3.9337e+05, 3.9752e+05, 4.0583e+05, 4.0618e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.0526e-01, 9.2982e-01, 9.5033e-01, 9.5047e-01, 9.9533e-01,
        1.0071e+00, 1.0078e+00, 1.1233e+00, 1.2129e+00, 3.7441e+05, 3.8637e+05,
        3.9339e+05, 3.9753e+05, 4.0582e+05, 4.0617e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['397538.59', '406177.59', '37442.30', '386367.50', '37440.54', '37440.41', '405825.25', '37438.52', '37438.79', '37442.82', '374397.28', '37439.25', '393388.72', '37441.57', '37441.05', '37441.79']
estimated f for each client, fs: [4, 4, 6, 4, 6, 6, 4, 6, 6, 6, 5, 6, 4, 6, 6, 6]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 20, 6, 18, 9, 10, 17, 5, 11, 7, 19, 1, 14, 3, 4, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0117s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:16...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:16, End: 2025-07-22 16:01:16)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [19, 8, 12, 1, 20, 9, 6, 10, 13, 18, 14, 2, 16, 11, 5, 3], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9475e+05, 3.9475e+05, 3.9476e+05, 7.2933e+05, 3.9475e+05,
         3.9475e+05, 3.9475e+05, 8.1120e+05, 7.7146e+05, 7.9083e+05, 3.9478e+05,
         7.9310e+05, 3.9474e+05, 3.9477e+05, 3.9473e+05],
        [3.9475e+05, 0.0000e+00, 1.0738e+00, 1.0665e+00, 3.6436e+05, 1.0994e+00,
         1.0419e+00, 1.1117e+00, 4.0644e+05, 3.7950e+05, 3.9450e+05, 1.0911e+00,
         3.9589e+05, 1.0368e+00, 1.1414e+00, 1.0780e+00],
        [3.9475e+05, 1.0738e+00, 0.0000e+00, 1.0747e+00, 3.6436e+05, 1.0624e+00,
         1.1857e+00, 1.0951e+00, 4.0644e+05, 3.7948e+05, 3.9451e+05, 1.0666e+00,
         3.9595e+05, 1.0425e+00, 1.2138e+00, 1.0199e+00],
        [3.9476e+05, 1.0665e+00, 1.0747e+00, 0.0000e+00, 3.6434e+05, 1.0981e+00,
         1.1553e+00, 1.1732e+00, 4.0642e+05, 3.7947e+05, 3.9450e+05, 1.0783e+00,
         3.9591e+05, 1.0720e+00, 1.2123e+00, 1.1889e+00],
        [7.2933e+05, 3.6436e+05, 3.6436e+05, 3.6434e+05, 0.0000e+00, 3.6434e+05,
         3.6433e+05, 3.6436e+05, 7.6957e+05, 7.3825e+05, 7.8201e+05, 3.6434e+05,
         7.6813e+05, 3.6433e+05, 3.6436e+05, 3.6436e+05],
        [3.9475e+05, 1.0994e+00, 1.0624e+00, 1.0981e+00, 3.6434e+05, 0.0000e+00,
         1.1655e+00, 1.1247e+00, 4.0643e+05, 3.7947e+05, 3.9451e+05, 1.0212e+00,
         3.9593e+05, 1.0818e+00, 1.2392e+00, 1.1037e+00],
        [3.9475e+05, 1.0419e+00, 1.1857e+00, 1.1553e+00, 3.6433e+05, 1.1655e+00,
         0.0000e+00, 1.3263e+00, 4.0646e+05, 3.7948e+05, 3.9450e+05, 9.8452e-01,
         3.9592e+05, 1.1256e+00, 1.0302e+00, 1.2266e+00],
        [3.9475e+05, 1.1117e+00, 1.0951e+00, 1.1732e+00, 3.6436e+05, 1.1247e+00,
         1.3263e+00, 0.0000e+00, 4.0645e+05, 3.7948e+05, 3.9452e+05, 1.1061e+00,
         3.9593e+05, 1.0974e+00, 1.2535e+00, 1.0941e+00],
        [8.1120e+05, 4.0644e+05, 4.0644e+05, 4.0642e+05, 7.6957e+05, 4.0643e+05,
         4.0646e+05, 4.0645e+05, 0.0000e+00, 7.9592e+05, 8.0528e+05, 4.0644e+05,
         7.9692e+05, 4.0642e+05, 4.0641e+05, 4.0644e+05],
        [7.7146e+05, 3.7950e+05, 3.7948e+05, 3.7947e+05, 7.3825e+05, 3.7947e+05,
         3.7948e+05, 3.7948e+05, 7.9592e+05, 0.0000e+00, 7.7833e+05, 3.7947e+05,
         7.5904e+05, 3.7946e+05, 3.7946e+05, 3.7947e+05],
        [7.9083e+05, 3.9450e+05, 3.9451e+05, 3.9450e+05, 7.8201e+05, 3.9451e+05,
         3.9450e+05, 3.9452e+05, 8.0528e+05, 7.7833e+05, 0.0000e+00, 3.9453e+05,
         7.7328e+05, 3.9452e+05, 3.9449e+05, 3.9451e+05],
        [3.9478e+05, 1.0911e+00, 1.0666e+00, 1.0783e+00, 3.6434e+05, 1.0212e+00,
         9.8452e-01, 1.1061e+00, 4.0644e+05, 3.7947e+05, 3.9453e+05, 0.0000e+00,
         3.9596e+05, 1.0316e+00, 1.1779e+00, 1.0896e+00],
        [7.9310e+05, 3.9589e+05, 3.9595e+05, 3.9591e+05, 7.6813e+05, 3.9593e+05,
         3.9592e+05, 3.9593e+05, 7.9692e+05, 7.5904e+05, 7.7328e+05, 3.9596e+05,
         0.0000e+00, 3.9592e+05, 3.9593e+05, 3.9594e+05],
        [3.9474e+05, 1.0368e+00, 1.0425e+00, 1.0720e+00, 3.6433e+05, 1.0818e+00,
         1.1256e+00, 1.0974e+00, 4.0642e+05, 3.7946e+05, 3.9452e+05, 1.0316e+00,
         3.9592e+05, 0.0000e+00, 1.1322e+00, 1.1354e+00],
        [3.9477e+05, 1.1414e+00, 1.2138e+00, 1.2123e+00, 3.6436e+05, 1.2392e+00,
         1.0302e+00, 1.2535e+00, 4.0641e+05, 3.7946e+05, 3.9449e+05, 1.1779e+00,
         3.9593e+05, 1.1322e+00, 0.0000e+00, 1.1939e+00],
        [3.9473e+05, 1.0780e+00, 1.0199e+00, 1.1889e+00, 3.6436e+05, 1.1037e+00,
         1.2266e+00, 1.0941e+00, 4.0644e+05, 3.7947e+05, 3.9451e+05, 1.0896e+00,
         3.9594e+05, 1.1354e+00, 1.1939e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 394733.7500, 394742.8125, 394747.1875, 394751.7500,
        394753.5000, 394753.5625, 394754.0312, 394761.0938, 394772.3125,
        394776.8438, 729328.7500, 771460.7500, 790832.6875, 793104.1250,
        811200.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0368e+00, 1.0419e+00, 1.0665e+00, 1.0738e+00, 1.0780e+00,
        1.0911e+00, 1.0994e+00, 1.1117e+00, 1.1414e+00, 3.6436e+05, 3.7950e+05,
        3.9450e+05, 3.9475e+05, 3.9589e+05, 4.0644e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0199e+00, 1.0425e+00, 1.0624e+00, 1.0666e+00, 1.0738e+00,
        1.0747e+00, 1.0951e+00, 1.1857e+00, 1.2138e+00, 3.6436e+05, 3.7948e+05,
        3.9451e+05, 3.9475e+05, 3.9595e+05, 4.0644e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0665e+00, 1.0720e+00, 1.0747e+00, 1.0783e+00, 1.0981e+00,
        1.1553e+00, 1.1732e+00, 1.1889e+00, 1.2123e+00, 3.6434e+05, 3.7947e+05,
        3.9450e+05, 3.9476e+05, 3.9591e+05, 4.0642e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 364333.6562, 364334.3125, 364336.4062, 364341.6562,
        364344.9688, 364355.8750, 364356.9375, 364359.3125, 364361.8125,
        364362.5000, 729328.7500, 738253.8750, 768126.1250, 769573.8125,
        782012.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0212e+00, 1.0624e+00, 1.0818e+00, 1.0981e+00, 1.0994e+00,
        1.1037e+00, 1.1247e+00, 1.1655e+00, 1.2392e+00, 3.6434e+05, 3.7947e+05,
        3.9451e+05, 3.9475e+05, 3.9593e+05, 4.0643e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8452e-01, 1.0302e+00, 1.0419e+00, 1.1256e+00, 1.1553e+00,
        1.1655e+00, 1.1857e+00, 1.2266e+00, 1.3263e+00, 3.6433e+05, 3.7948e+05,
        3.9450e+05, 3.9475e+05, 3.9592e+05, 4.0646e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0941e+00, 1.0951e+00, 1.0974e+00, 1.1061e+00, 1.1117e+00,
        1.1247e+00, 1.1732e+00, 1.2535e+00, 1.3263e+00, 3.6436e+05, 3.7948e+05,
        3.9452e+05, 3.9475e+05, 3.9593e+05, 4.0645e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406412.7188, 406422.8125, 406423.4375, 406433.8750,
        406439.9375, 406441.6875, 406441.8125, 406442.4688, 406449.1250,
        406455.1250, 769573.8125, 795916.6250, 796915.6250, 805280.1875,
        811200.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379455.2500, 379459.5625, 379466.8125, 379470.3750,
        379472.3438, 379474.1250, 379477.3750, 379479.1250, 379479.5938,
        379496.3750, 738253.8750, 759041.0000, 771460.7500, 778328.5000,
        795916.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394485.7500, 394495.5312, 394500.9688, 394502.7188,
        394509.9688, 394510.6875, 394512.7500, 394517.6562, 394518.1250,
        394529.4375, 773283.6250, 778328.5000, 782012.5000, 790832.6875,
        805280.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.8452e-01, 1.0212e+00, 1.0316e+00, 1.0666e+00, 1.0783e+00,
        1.0896e+00, 1.0911e+00, 1.1061e+00, 1.1779e+00, 3.6434e+05, 3.7947e+05,
        3.9453e+05, 3.9478e+05, 3.9596e+05, 4.0644e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395890.8438, 395914.9688, 395917.1875, 395918.5625,
        395925.6875, 395928.3125, 395930.7500, 395939.5000, 395947.2188,
        395962.0000, 759041.0000, 768126.1250, 773283.6250, 793104.1250,
        796915.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0316e+00, 1.0368e+00, 1.0425e+00, 1.0720e+00, 1.0818e+00,
        1.0974e+00, 1.1256e+00, 1.1322e+00, 1.1354e+00, 3.6433e+05, 3.7946e+05,
        3.9452e+05, 3.9474e+05, 3.9592e+05, 4.0642e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0302e+00, 1.1322e+00, 1.1414e+00, 1.1779e+00, 1.1939e+00,
        1.2123e+00, 1.2138e+00, 1.2392e+00, 1.2535e+00, 3.6436e+05, 3.7946e+05,
        3.9449e+05, 3.9477e+05, 3.9593e+05, 4.0641e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0199e+00, 1.0780e+00, 1.0896e+00, 1.0941e+00, 1.1037e+00,
        1.1354e+00, 1.1889e+00, 1.1939e+00, 1.2266e+00, 3.6436e+05, 3.7947e+05,
        3.9451e+05, 3.9473e+05, 3.9594e+05, 4.0644e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['394754.69', '36437.15', '36437.23', '36435.18', '364348.72', '36435.50', '36434.39', '36436.73', '406436.31', '379473.09', '394508.38', '36434.61', '395927.50', '36434.40', '36436.99', '36436.60']
estimated f for each client, fs: [4, 6, 6, 6, 5, 6, 6, 6, 4, 4, 4, 6, 4, 6, 6, 6]
selected_index: 6
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [19, 8, 12, 1, 20, 9, 6, 10, 13, 18, 14, 2, 16, 11, 5, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0126s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:17...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:17, End: 2025-07-22 16:01:17)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 10, 6, 5, 20, 17, 2, 3, 12, 1, 19, 11, 18, 7, 9, 8], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9321e+05, 3.9323e+05, 3.9322e+05, 7.8266e+05, 7.4557e+05,
         3.9320e+05, 3.9321e+05, 3.9321e+05, 3.9321e+05, 7.8422e+05, 3.9321e+05,
         7.8220e+05, 3.9320e+05, 3.9321e+05, 3.9323e+05],
        [3.9321e+05, 0.0000e+00, 1.5070e+00, 9.1648e-01, 4.0691e+05, 3.7582e+05,
         9.4315e-01, 9.5929e-01, 9.2589e-01, 9.8762e-01, 3.9083e+05, 9.3837e-01,
         3.8445e+05, 8.7487e-01, 1.0123e+00, 9.3625e-01],
        [3.9323e+05, 1.5070e+00, 0.0000e+00, 1.0657e+00, 4.0691e+05, 3.7582e+05,
         1.1450e+00, 1.4094e+00, 1.3323e+00, 1.2867e+00, 3.9083e+05, 1.2820e+00,
         3.8441e+05, 1.4508e+00, 1.3136e+00, 1.1700e+00],
        [3.9322e+05, 9.1648e-01, 1.0657e+00, 0.0000e+00, 4.0692e+05, 3.7582e+05,
         8.8331e-01, 8.9315e-01, 8.6751e-01, 8.6441e-01, 3.9084e+05, 8.2212e-01,
         3.8444e+05, 8.5527e-01, 9.4470e-01, 8.3534e-01],
        [7.8266e+05, 4.0691e+05, 4.0691e+05, 4.0692e+05, 0.0000e+00, 7.7433e+05,
         4.0689e+05, 4.0691e+05, 4.0689e+05, 4.0689e+05, 8.2055e+05, 4.0690e+05,
         8.1579e+05, 4.0691e+05, 4.0690e+05, 4.0692e+05],
        [7.4557e+05, 3.7582e+05, 3.7582e+05, 3.7582e+05, 7.7433e+05, 0.0000e+00,
         3.7583e+05, 3.7583e+05, 3.7582e+05, 3.7582e+05, 7.5040e+05, 3.7581e+05,
         7.6328e+05, 3.7582e+05, 3.7583e+05, 3.7583e+05],
        [3.9320e+05, 9.4315e-01, 1.1450e+00, 8.8331e-01, 4.0689e+05, 3.7583e+05,
         0.0000e+00, 9.3949e-01, 8.7792e-01, 9.0370e-01, 3.9083e+05, 8.6318e-01,
         3.8444e+05, 8.4686e-01, 9.0733e-01, 8.9000e-01],
        [3.9321e+05, 9.5929e-01, 1.4094e+00, 8.9315e-01, 4.0691e+05, 3.7583e+05,
         9.3949e-01, 0.0000e+00, 8.6725e-01, 9.9709e-01, 3.9083e+05, 9.6030e-01,
         3.8447e+05, 8.6449e-01, 9.9288e-01, 9.0893e-01],
        [3.9321e+05, 9.2589e-01, 1.3323e+00, 8.6751e-01, 4.0689e+05, 3.7582e+05,
         8.7792e-01, 8.6725e-01, 0.0000e+00, 8.6377e-01, 3.9082e+05, 8.3990e-01,
         3.8446e+05, 8.6511e-01, 9.4276e-01, 8.9734e-01],
        [3.9321e+05, 9.8762e-01, 1.2867e+00, 8.6441e-01, 4.0689e+05, 3.7582e+05,
         9.0370e-01, 9.9709e-01, 8.6377e-01, 0.0000e+00, 3.9083e+05, 8.6783e-01,
         3.8446e+05, 9.1230e-01, 9.2394e-01, 8.8162e-01],
        [7.8422e+05, 3.9083e+05, 3.9083e+05, 3.9084e+05, 8.2055e+05, 7.5040e+05,
         3.9083e+05, 3.9083e+05, 3.9082e+05, 3.9083e+05, 0.0000e+00, 3.9082e+05,
         7.8238e+05, 3.9082e+05, 3.9085e+05, 3.9082e+05],
        [3.9321e+05, 9.3837e-01, 1.2820e+00, 8.2212e-01, 4.0690e+05, 3.7581e+05,
         8.6318e-01, 9.6030e-01, 8.3990e-01, 8.6783e-01, 3.9082e+05, 0.0000e+00,
         3.8444e+05, 8.5994e-01, 9.4087e-01, 8.8115e-01],
        [7.8220e+05, 3.8445e+05, 3.8441e+05, 3.8444e+05, 8.1579e+05, 7.6328e+05,
         3.8444e+05, 3.8447e+05, 3.8446e+05, 3.8446e+05, 7.8238e+05, 3.8444e+05,
         0.0000e+00, 3.8445e+05, 3.8448e+05, 3.8446e+05],
        [3.9320e+05, 8.7487e-01, 1.4508e+00, 8.5527e-01, 4.0691e+05, 3.7582e+05,
         8.4686e-01, 8.6449e-01, 8.6511e-01, 9.1230e-01, 3.9082e+05, 8.5994e-01,
         3.8445e+05, 0.0000e+00, 9.5742e-01, 8.9766e-01],
        [3.9321e+05, 1.0123e+00, 1.3136e+00, 9.4470e-01, 4.0690e+05, 3.7583e+05,
         9.0733e-01, 9.9288e-01, 9.4276e-01, 9.2394e-01, 3.9085e+05, 9.4087e-01,
         3.8448e+05, 9.5742e-01, 0.0000e+00, 9.6111e-01],
        [3.9323e+05, 9.3625e-01, 1.1700e+00, 8.3534e-01, 4.0692e+05, 3.7583e+05,
         8.9000e-01, 9.0893e-01, 8.9734e-01, 8.8162e-01, 3.9082e+05, 8.8115e-01,
         3.8446e+05, 8.9766e-01, 9.6111e-01, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 393200.5625, 393203.7188, 393205.5000, 393208.9375,
        393209.6875, 393212.0000, 393212.5000, 393213.0000, 393221.3750,
        393228.0000, 393228.1250, 745565.2500, 782203.3750, 782657.3125,
        784219.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.7487e-01, 9.1648e-01, 9.2589e-01, 9.3625e-01, 9.3837e-01,
        9.4315e-01, 9.5929e-01, 9.8762e-01, 1.0123e+00, 1.5070e+00, 3.7582e+05,
        3.8445e+05, 3.9083e+05, 3.9321e+05, 4.0691e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0657e+00, 1.1450e+00, 1.1700e+00, 1.2820e+00, 1.2867e+00,
        1.3136e+00, 1.3323e+00, 1.4094e+00, 1.4508e+00, 1.5070e+00, 3.7582e+05,
        3.8441e+05, 3.9083e+05, 3.9323e+05, 4.0691e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.2212e-01, 8.3534e-01, 8.5527e-01, 8.6441e-01, 8.6751e-01,
        8.8331e-01, 8.9315e-01, 9.1648e-01, 9.4470e-01, 1.0657e+00, 3.7582e+05,
        3.8444e+05, 3.9084e+05, 3.9322e+05, 4.0692e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 406889.2500, 406893.2812, 406893.3125, 406895.3125,
        406898.4062, 406906.8438, 406911.2812, 406914.1562, 406914.1875,
        406917.5625, 406922.4688, 774328.1875, 782657.3125, 815789.7500,
        820548.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 375812.6875, 375818.4062, 375819.0938, 375821.5625,
        375822.0625, 375823.8125, 375824.1250, 375826.3125, 375827.4375,
        375828.0312, 375829.6562, 745565.2500, 750398.0625, 763284.8750,
        774328.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.4686e-01, 8.6318e-01, 8.7792e-01, 8.8331e-01, 8.9000e-01,
        9.0370e-01, 9.0733e-01, 9.3949e-01, 9.4315e-01, 1.1450e+00, 3.7583e+05,
        3.8444e+05, 3.9083e+05, 3.9320e+05, 4.0689e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6449e-01, 8.6725e-01, 8.9315e-01, 9.0893e-01, 9.3949e-01,
        9.5929e-01, 9.6030e-01, 9.9288e-01, 9.9709e-01, 1.4094e+00, 3.7583e+05,
        3.8447e+05, 3.9083e+05, 3.9321e+05, 4.0691e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3990e-01, 8.6377e-01, 8.6511e-01, 8.6725e-01, 8.6751e-01,
        8.7792e-01, 8.9734e-01, 9.2589e-01, 9.4276e-01, 1.3323e+00, 3.7582e+05,
        3.8446e+05, 3.9082e+05, 3.9321e+05, 4.0689e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6377e-01, 8.6441e-01, 8.6783e-01, 8.8162e-01, 9.0370e-01,
        9.1230e-01, 9.2394e-01, 9.8762e-01, 9.9709e-01, 1.2867e+00, 3.7582e+05,
        3.8446e+05, 3.9083e+05, 3.9321e+05, 4.0689e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390819.3125, 390819.5312, 390821.2812, 390821.4688,
        390827.6562, 390834.0625, 390834.4688, 390834.5312, 390834.9062,
        390835.9062, 390849.7188, 750398.0625, 782375.3750, 784219.1250,
        820548.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.2212e-01, 8.3990e-01, 8.5994e-01, 8.6318e-01, 8.6783e-01,
        8.8115e-01, 9.3837e-01, 9.4087e-01, 9.6030e-01, 1.2820e+00, 3.7581e+05,
        3.8444e+05, 3.9082e+05, 3.9321e+05, 4.0690e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384410.2188, 384439.2188, 384439.5312, 384444.3125,
        384451.6250, 384452.9375, 384462.5312, 384462.8125, 384463.4375,
        384471.4062, 384479.3125, 763284.8750, 782203.3750, 782375.3750,
        815789.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.4686e-01, 8.5527e-01, 8.5994e-01, 8.6449e-01, 8.6511e-01,
        8.7487e-01, 8.9766e-01, 9.1230e-01, 9.5742e-01, 1.4508e+00, 3.7582e+05,
        3.8445e+05, 3.9082e+05, 3.9320e+05, 4.0691e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.0733e-01, 9.2394e-01, 9.4087e-01, 9.4276e-01, 9.4470e-01,
        9.5742e-01, 9.6111e-01, 9.9288e-01, 1.0123e+00, 1.3136e+00, 3.7583e+05,
        3.8448e+05, 3.9085e+05, 3.9321e+05, 4.0690e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3534e-01, 8.8115e-01, 8.8162e-01, 8.9000e-01, 8.9734e-01,
        8.9766e-01, 9.0893e-01, 9.3625e-01, 9.6111e-01, 1.1700e+00, 3.7583e+05,
        3.8446e+05, 3.9082e+05, 3.9323e+05, 4.0692e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['393213.03', '1.00', '1.30', '0.89', '406905.09', '375822.97', '0.92', '0.98', '0.93', '0.95', '390830.28', '0.93', '384452.50', '0.94', '0.99', '0.93']
estimated f for each client, fs: [3, 5, 5, 5, 3, 3, 5, 5, 5, 5, 3, 5, 3, 5, 5, 5]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 10, 6, 5, 20, 17, 2, 3, 12, 1, 19, 11, 18, 7, 9, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0403s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:18...
global Accuracy on shared test data: 73.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:18, End: 2025-07-22 16:01:18)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [5, 9, 6, 4, 13, 17, 18, 3, 19, 12, 14, 15, 11, 10, 1, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2116e+00, 6.9623e-01, 1.4976e+00, 3.8759e+05, 3.8868e+05,
         4.0577e+05, 1.1958e+00, 3.9685e+05, 1.1420e+00, 3.9198e+05, 3.7956e+05,
         1.1508e+00, 1.2829e+00, 1.1380e+00, 3.8939e+05],
        [1.2116e+00, 0.0000e+00, 1.0958e+00, 1.0207e+00, 3.8756e+05, 3.8872e+05,
         4.0574e+05, 9.8982e-01, 3.9685e+05, 9.0992e-01, 3.9198e+05, 3.7960e+05,
         9.3535e-01, 9.6343e-01, 9.3329e-01, 3.8938e+05],
        [6.9623e-01, 1.0958e+00, 0.0000e+00, 1.4784e+00, 3.8758e+05, 3.8870e+05,
         4.0576e+05, 1.1341e+00, 3.9683e+05, 1.0158e+00, 3.9195e+05, 3.7956e+05,
         1.0604e+00, 1.2360e+00, 9.9383e-01, 3.8938e+05],
        [1.4976e+00, 1.0207e+00, 1.4784e+00, 0.0000e+00, 3.8757e+05, 3.8870e+05,
         4.0577e+05, 1.0676e+00, 3.9685e+05, 9.7873e-01, 3.9196e+05, 3.7961e+05,
         9.8156e-01, 9.8735e-01, 1.0181e+00, 3.8940e+05],
        [3.8759e+05, 3.8756e+05, 3.8758e+05, 3.8757e+05, 0.0000e+00, 7.9895e+05,
         7.9871e+05, 3.8757e+05, 7.7520e+05, 3.8758e+05, 7.7493e+05, 7.5669e+05,
         3.8756e+05, 3.8757e+05, 3.8757e+05, 7.9262e+05],
        [3.8868e+05, 3.8872e+05, 3.8870e+05, 3.8870e+05, 7.9895e+05, 0.0000e+00,
         7.8548e+05, 3.8868e+05, 7.7892e+05, 3.8868e+05, 7.8098e+05, 7.7847e+05,
         3.8870e+05, 3.8871e+05, 3.8871e+05, 7.6927e+05],
        [4.0577e+05, 4.0574e+05, 4.0576e+05, 4.0577e+05, 7.9871e+05, 7.8548e+05,
         0.0000e+00, 4.0574e+05, 8.1090e+05, 4.0574e+05, 8.0128e+05, 7.7712e+05,
         4.0576e+05, 4.0575e+05, 4.0578e+05, 8.0500e+05],
        [1.1958e+00, 9.8982e-01, 1.1341e+00, 1.0676e+00, 3.8757e+05, 3.8868e+05,
         4.0574e+05, 0.0000e+00, 3.9686e+05, 8.8944e-01, 3.9199e+05, 3.7959e+05,
         1.0246e+00, 9.7680e-01, 1.0370e+00, 3.8941e+05],
        [3.9685e+05, 3.9685e+05, 3.9683e+05, 3.9685e+05, 7.7520e+05, 7.7892e+05,
         8.1090e+05, 3.9686e+05, 0.0000e+00, 3.9686e+05, 8.1277e+05, 7.8237e+05,
         3.9682e+05, 3.9686e+05, 3.9685e+05, 7.8421e+05],
        [1.1420e+00, 9.0992e-01, 1.0158e+00, 9.7873e-01, 3.8758e+05, 3.8868e+05,
         4.0574e+05, 8.8944e-01, 3.9686e+05, 0.0000e+00, 3.9197e+05, 3.7959e+05,
         8.6871e-01, 8.9559e-01, 8.6179e-01, 3.8940e+05],
        [3.9198e+05, 3.9198e+05, 3.9195e+05, 3.9196e+05, 7.7493e+05, 7.8098e+05,
         8.0128e+05, 3.9199e+05, 8.1277e+05, 3.9197e+05, 0.0000e+00, 7.8876e+05,
         3.9198e+05, 3.9195e+05, 3.9197e+05, 7.8753e+05],
        [3.7956e+05, 3.7960e+05, 3.7956e+05, 3.7961e+05, 7.5669e+05, 7.7847e+05,
         7.7712e+05, 3.7959e+05, 7.8237e+05, 3.7959e+05, 7.8876e+05, 0.0000e+00,
         3.7961e+05, 3.7959e+05, 3.7959e+05, 7.6358e+05],
        [1.1508e+00, 9.3535e-01, 1.0604e+00, 9.8156e-01, 3.8756e+05, 3.8870e+05,
         4.0576e+05, 1.0246e+00, 3.9682e+05, 8.6871e-01, 3.9198e+05, 3.7961e+05,
         0.0000e+00, 9.5382e-01, 9.0410e-01, 3.8941e+05],
        [1.2829e+00, 9.6343e-01, 1.2360e+00, 9.8735e-01, 3.8757e+05, 3.8871e+05,
         4.0575e+05, 9.7680e-01, 3.9686e+05, 8.9559e-01, 3.9195e+05, 3.7959e+05,
         9.5382e-01, 0.0000e+00, 9.7454e-01, 3.8941e+05],
        [1.1380e+00, 9.3329e-01, 9.9383e-01, 1.0181e+00, 3.8757e+05, 3.8871e+05,
         4.0578e+05, 1.0370e+00, 3.9685e+05, 8.6179e-01, 3.9197e+05, 3.7959e+05,
         9.0410e-01, 9.7454e-01, 0.0000e+00, 3.8940e+05],
        [3.8939e+05, 3.8938e+05, 3.8938e+05, 3.8940e+05, 7.9262e+05, 7.6927e+05,
         8.0500e+05, 3.8941e+05, 7.8421e+05, 3.8940e+05, 7.8753e+05, 7.6358e+05,
         3.8941e+05, 3.8941e+05, 3.8940e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 6.9623e-01, 1.1380e+00, 1.1420e+00, 1.1508e+00, 1.1958e+00,
        1.2116e+00, 1.2829e+00, 1.4976e+00, 3.7956e+05, 3.8759e+05, 3.8868e+05,
        3.8939e+05, 3.9198e+05, 3.9685e+05, 4.0577e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.0992e-01, 9.3329e-01, 9.3535e-01, 9.6343e-01, 9.8982e-01,
        1.0207e+00, 1.0958e+00, 1.2116e+00, 3.7960e+05, 3.8756e+05, 3.8872e+05,
        3.8938e+05, 3.9198e+05, 3.9685e+05, 4.0574e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.9623e-01, 9.9383e-01, 1.0158e+00, 1.0604e+00, 1.0958e+00,
        1.1341e+00, 1.2360e+00, 1.4784e+00, 3.7956e+05, 3.8758e+05, 3.8870e+05,
        3.8938e+05, 3.9195e+05, 3.9683e+05, 4.0576e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7873e-01, 9.8156e-01, 9.8735e-01, 1.0181e+00, 1.0207e+00,
        1.0676e+00, 1.4784e+00, 1.4976e+00, 3.7961e+05, 3.8757e+05, 3.8870e+05,
        3.8940e+05, 3.9196e+05, 3.9685e+05, 4.0577e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387558.9375, 387563.9062, 387568.6875, 387570.1250,
        387570.5938, 387574.9375, 387575.4375, 387575.8750, 387585.0312,
        756686.5625, 774930.2500, 775200.6875, 792617.7500, 798707.5000,
        798954.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388682.5000, 388683.3750, 388684.5625, 388695.1562,
        388696.7500, 388702.5312, 388709.4062, 388713.3125, 388715.1562,
        769265.8750, 778467.7500, 778920.8125, 780982.7500, 785477.1875,
        798954.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 405735.3438, 405744.7188, 405744.8750, 405748.6562,
        405759.5000, 405761.1250, 405770.5625, 405774.5312, 405780.9688,
        777116.0000, 785477.1875, 798707.5000, 801279.8750, 805000.3125,
        810896.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8944e-01, 9.7680e-01, 9.8982e-01, 1.0246e+00, 1.0370e+00,
        1.0676e+00, 1.1341e+00, 1.1958e+00, 3.7959e+05, 3.8757e+05, 3.8868e+05,
        3.8941e+05, 3.9199e+05, 3.9686e+05, 4.0574e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396816.5000, 396829.8438, 396847.5625, 396847.5625,
        396849.5000, 396849.9062, 396858.4062, 396859.4375, 396861.1562,
        775200.6875, 778920.8125, 782367.3750, 784206.3750, 810896.1250,
        812765.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6179e-01, 8.6871e-01, 8.8944e-01, 8.9559e-01, 9.0992e-01,
        9.7873e-01, 1.0158e+00, 1.1420e+00, 3.7959e+05, 3.8758e+05, 3.8868e+05,
        3.8940e+05, 3.9197e+05, 3.9686e+05, 4.0574e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391946.4688, 391952.7500, 391961.8438, 391965.0938,
        391970.2500, 391977.4062, 391979.4062, 391984.8438, 391986.9062,
        774930.2500, 780982.7500, 787532.5625, 788764.3750, 801279.8750,
        812765.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379555.6250, 379558.5938, 379585.7500, 379586.5625,
        379587.3125, 379592.8438, 379598.7500, 379608.5312, 379608.8750,
        756686.5625, 763580.7500, 777116.0000, 778467.7500, 782367.3750,
        788764.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6871e-01, 9.0410e-01, 9.3535e-01, 9.5382e-01, 9.8156e-01,
        1.0246e+00, 1.0604e+00, 1.1508e+00, 3.7961e+05, 3.8756e+05, 3.8870e+05,
        3.8941e+05, 3.9198e+05, 3.9682e+05, 4.0576e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9559e-01, 9.5382e-01, 9.6343e-01, 9.7454e-01, 9.7680e-01,
        9.8735e-01, 1.2360e+00, 1.2829e+00, 3.7959e+05, 3.8757e+05, 3.8871e+05,
        3.8941e+05, 3.9195e+05, 3.9686e+05, 4.0575e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6179e-01, 9.0410e-01, 9.3329e-01, 9.7454e-01, 9.9383e-01,
        1.0181e+00, 1.0370e+00, 1.1380e+00, 3.7959e+05, 3.8757e+05, 3.8871e+05,
        3.8940e+05, 3.9197e+05, 3.9685e+05, 4.0578e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389375.8125, 389380.0625, 389390.6562, 389400.0312,
        389403.0000, 389404.0625, 389405.7188, 389407.3125, 389410.2812,
        763580.7500, 769265.8750, 784206.3750, 787532.5625, 792617.7500,
        805000.3125])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76714.98', '76717.07', '76714.27', '76718.82', '424483.00', '426754.91', '442893.66', '76716.90', '434682.06', '76717.08', '430265.56', '417296.94', '76717.56', '76716.36', '76717.09', '426815.75']
estimated f for each client, fs: [7, 7, 7, 7, 5, 5, 5, 7, 5, 7, 5, 5, 7, 7, 7, 5]
selected_index: 2
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 9, 6, 4, 13, 17, 18, 3, 19, 12, 14, 15, 11, 10, 1, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0111s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:18...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 75 188]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:18, End: 2025-07-22 16:01:18)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 18, 13, 3, 14, 19, 6, 15, 9, 20, 1, 16, 8, 7, 12, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8768e+05, 3.9650e+05, 8.9054e-01, 3.7466e+05, 3.8845e+05,
         1.2682e+00, 3.8292e+05, 8.8858e-01, 3.7816e+05, 8.3098e-01, 3.9070e+05,
         8.1908e-01, 8.3294e-01, 7.7800e-01, 8.0629e-01],
        [3.8768e+05, 0.0000e+00, 7.7430e+05, 3.8767e+05, 7.3364e+05, 7.8080e+05,
         3.8766e+05, 7.8224e+05, 3.8769e+05, 7.8740e+05, 3.8769e+05, 7.8824e+05,
         3.8767e+05, 3.8765e+05, 3.8768e+05, 3.8767e+05],
        [3.9650e+05, 7.7430e+05, 0.0000e+00, 3.9650e+05, 7.5845e+05, 7.6827e+05,
         3.9650e+05, 7.8562e+05, 3.9652e+05, 7.7945e+05, 3.9649e+05, 8.0220e+05,
         3.9651e+05, 3.9653e+05, 3.9651e+05, 3.9652e+05],
        [8.9054e-01, 3.8767e+05, 3.9650e+05, 0.0000e+00, 3.7463e+05, 3.8844e+05,
         1.3013e+00, 3.8290e+05, 9.0200e-01, 3.7817e+05, 9.1553e-01, 3.9071e+05,
         8.2391e-01, 8.1882e-01, 7.9610e-01, 8.4196e-01],
        [3.7466e+05, 7.3364e+05, 7.5845e+05, 3.7463e+05, 0.0000e+00, 7.5152e+05,
         3.7466e+05, 7.6852e+05, 3.7465e+05, 7.6866e+05, 3.7465e+05, 7.5275e+05,
         3.7465e+05, 3.7464e+05, 3.7466e+05, 3.7464e+05],
        [3.8845e+05, 7.8080e+05, 7.6827e+05, 3.8844e+05, 7.5152e+05, 0.0000e+00,
         3.8847e+05, 7.5505e+05, 3.8845e+05, 7.6730e+05, 3.8846e+05, 7.7362e+05,
         3.8846e+05, 3.8844e+05, 3.8845e+05, 3.8846e+05],
        [1.2682e+00, 3.8766e+05, 3.9650e+05, 1.3013e+00, 3.7466e+05, 3.8847e+05,
         0.0000e+00, 3.8291e+05, 1.2971e+00, 3.7816e+05, 1.2538e+00, 3.9073e+05,
         1.1243e+00, 1.4318e+00, 1.3006e+00, 1.1369e+00],
        [3.8292e+05, 7.8224e+05, 7.8562e+05, 3.8290e+05, 7.6852e+05, 7.5505e+05,
         3.8291e+05, 0.0000e+00, 3.8289e+05, 7.7760e+05, 3.8291e+05, 7.8013e+05,
         3.8294e+05, 3.8291e+05, 3.8291e+05, 3.8291e+05],
        [8.8858e-01, 3.8769e+05, 3.9652e+05, 9.0200e-01, 3.7465e+05, 3.8845e+05,
         1.2971e+00, 3.8289e+05, 0.0000e+00, 3.7815e+05, 8.7554e-01, 3.9072e+05,
         8.8855e-01, 9.0243e-01, 8.5717e-01, 8.6098e-01],
        [3.7816e+05, 7.8740e+05, 7.7945e+05, 3.7817e+05, 7.6866e+05, 7.6730e+05,
         3.7816e+05, 7.7760e+05, 3.7815e+05, 0.0000e+00, 3.7816e+05, 7.6919e+05,
         3.7815e+05, 3.7815e+05, 3.7816e+05, 3.7812e+05],
        [8.3098e-01, 3.8769e+05, 3.9649e+05, 9.1553e-01, 3.7465e+05, 3.8846e+05,
         1.2538e+00, 3.8291e+05, 8.7554e-01, 3.7816e+05, 0.0000e+00, 3.9071e+05,
         8.4020e-01, 8.7431e-01, 8.0363e-01, 8.6420e-01],
        [3.9070e+05, 7.8824e+05, 8.0220e+05, 3.9071e+05, 7.5275e+05, 7.7362e+05,
         3.9073e+05, 7.8013e+05, 3.9072e+05, 7.6919e+05, 3.9071e+05, 0.0000e+00,
         3.9071e+05, 3.9072e+05, 3.9072e+05, 3.9070e+05],
        [8.1908e-01, 3.8767e+05, 3.9651e+05, 8.2391e-01, 3.7465e+05, 3.8846e+05,
         1.1243e+00, 3.8294e+05, 8.8855e-01, 3.7815e+05, 8.4020e-01, 3.9071e+05,
         0.0000e+00, 8.3657e-01, 8.0506e-01, 8.3116e-01],
        [8.3294e-01, 3.8765e+05, 3.9653e+05, 8.1882e-01, 3.7464e+05, 3.8844e+05,
         1.4318e+00, 3.8291e+05, 9.0243e-01, 3.7815e+05, 8.7431e-01, 3.9072e+05,
         8.3657e-01, 0.0000e+00, 8.0583e-01, 8.1683e-01],
        [7.7800e-01, 3.8768e+05, 3.9651e+05, 7.9610e-01, 3.7466e+05, 3.8845e+05,
         1.3006e+00, 3.8291e+05, 8.5717e-01, 3.7816e+05, 8.0363e-01, 3.9072e+05,
         8.0506e-01, 8.0583e-01, 0.0000e+00, 8.1259e-01],
        [8.0629e-01, 3.8767e+05, 3.9652e+05, 8.4196e-01, 3.7464e+05, 3.8846e+05,
         1.1369e+00, 3.8291e+05, 8.6098e-01, 3.7812e+05, 8.6420e-01, 3.9070e+05,
         8.3116e-01, 8.1683e-01, 8.1259e-01, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 7.7800e-01, 8.0629e-01, 8.1908e-01, 8.3098e-01, 8.3294e-01,
        8.8858e-01, 8.9054e-01, 1.2682e+00, 3.7466e+05, 3.7816e+05, 3.8292e+05,
        3.8768e+05, 3.8845e+05, 3.9070e+05, 3.9650e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387650.9375, 387659.9375, 387666.7812, 387668.5000,
        387673.5938, 387681.2812, 387682.6250, 387685.9688, 387690.0625,
        733638.0000, 774296.0000, 780804.9375, 782235.5625, 787399.8125,
        788235.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396486.7812, 396498.5000, 396499.1875, 396504.8438,
        396506.9688, 396513.6562, 396517.4375, 396521.6875, 396534.4062,
        758453.4375, 768274.8750, 774296.0000, 779451.3750, 785622.3125,
        802198.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.9610e-01, 8.1882e-01, 8.2391e-01, 8.4196e-01, 8.9054e-01,
        9.0200e-01, 9.1553e-01, 1.3013e+00, 3.7463e+05, 3.7817e+05, 3.8290e+05,
        3.8767e+05, 3.8844e+05, 3.9071e+05, 3.9650e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374633.7500, 374635.7188, 374642.0625, 374648.7188,
        374649.4375, 374651.4688, 374656.5938, 374659.0312, 374661.3125,
        733638.0000, 751524.2500, 752748.0000, 758453.4375, 768520.3125,
        768662.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388435.4062, 388435.8125, 388447.7500, 388448.3125,
        388450.9375, 388458.7500, 388459.2812, 388464.2188, 388474.2500,
        751524.2500, 755054.3750, 767298.8750, 768274.8750, 773620.6250,
        780804.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1243e+00, 1.1369e+00, 1.2538e+00, 1.2682e+00, 1.2971e+00,
        1.3006e+00, 1.3013e+00, 1.4318e+00, 3.7466e+05, 3.7816e+05, 3.8291e+05,
        3.8766e+05, 3.8847e+05, 3.9073e+05, 3.9650e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382886.0000, 382904.5938, 382909.1562, 382912.2500,
        382912.6875, 382914.0312, 382914.7188, 382923.3125, 382935.8750,
        755054.3750, 768520.3125, 777604.1875, 780127.5000, 782235.5625,
        785622.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.5717e-01, 8.6098e-01, 8.7554e-01, 8.8855e-01, 8.8858e-01,
        9.0200e-01, 9.0243e-01, 1.2971e+00, 3.7465e+05, 3.7815e+05, 3.8289e+05,
        3.8769e+05, 3.8845e+05, 3.9072e+05, 3.9652e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 378121.3125, 378146.0312, 378147.7188, 378151.1250,
        378157.1875, 378162.5938, 378164.5312, 378164.8125, 378167.7188,
        767298.8750, 768662.3750, 769188.0625, 777604.1875, 779451.3750,
        787399.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0363e-01, 8.3098e-01, 8.4020e-01, 8.6420e-01, 8.7431e-01,
        8.7554e-01, 9.1553e-01, 1.2538e+00, 3.7465e+05, 3.7816e+05, 3.8291e+05,
        3.8769e+05, 3.8846e+05, 3.9071e+05, 3.9649e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390701.9062, 390702.0625, 390705.2188, 390711.4688,
        390714.6562, 390718.0625, 390718.7812, 390719.2500, 390726.1875,
        752748.0000, 769188.0625, 773620.6250, 780127.5000, 788235.5000,
        802198.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0506e-01, 8.1908e-01, 8.2391e-01, 8.3116e-01, 8.3657e-01,
        8.4020e-01, 8.8855e-01, 1.1243e+00, 3.7465e+05, 3.7815e+05, 3.8294e+05,
        3.8767e+05, 3.8846e+05, 3.9071e+05, 3.9651e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0583e-01, 8.1683e-01, 8.1882e-01, 8.3294e-01, 8.3657e-01,
        8.7431e-01, 9.0243e-01, 1.4318e+00, 3.7464e+05, 3.7815e+05, 3.8291e+05,
        3.8765e+05, 3.8844e+05, 3.9072e+05, 3.9653e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.7800e-01, 7.9610e-01, 8.0363e-01, 8.0506e-01, 8.0583e-01,
        8.1259e-01, 8.5717e-01, 1.3006e+00, 3.7466e+05, 3.7816e+05, 3.8291e+05,
        3.8768e+05, 3.8845e+05, 3.9072e+05, 3.9651e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0629e-01, 8.1259e-01, 8.1683e-01, 8.3116e-01, 8.4196e-01,
        8.6098e-01, 8.6420e-01, 1.1369e+00, 3.7464e+05, 3.7812e+05, 3.8291e+05,
        3.8767e+05, 3.8846e+05, 3.9070e+05, 3.9652e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75283.09', '422269.75', '432703.69', '75280.88', '410547.59', '424759.91', '75283.12', '420126.69', '75281.01', '417068.19', '75282.15', '426916.59', '75280.33', '75279.54', '75282.33', '75276.39']
estimated f for each client, fs: [7, 5, 5, 7, 5, 5, 7, 5, 7, 6, 7, 5, 7, 7, 7, 7]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [11, 18, 13, 3, 14, 19, 6, 15, 9, 20, 1, 16, 8, 7, 12, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0111s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:19...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 74 189]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:19, End: 2025-07-22 16:01:19)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 12, 17, 19, 11, 5, 10, 4, 3, 2, 20, 14, 7, 9, 18, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 8.7422e-01, 3.8884e+05, 3.8187e+05, 8.4855e-01, 8.1270e-01,
         8.9981e-01, 9.0575e-01, 8.6101e-01, 1.0032e+00, 4.0288e+05, 3.8602e+05,
         8.7266e-01, 9.2756e-01, 3.8569e+05, 3.6906e+05],
        [8.7422e-01, 0.0000e+00, 3.8884e+05, 3.8186e+05, 8.1271e-01, 8.6175e-01,
         9.1832e-01, 9.1712e-01, 8.5332e-01, 1.0197e+00, 4.0289e+05, 3.8601e+05,
         8.7893e-01, 9.1462e-01, 3.8569e+05, 3.6904e+05],
        [3.8884e+05, 3.8884e+05, 0.0000e+00, 7.7424e+05, 3.8885e+05, 3.8887e+05,
         3.8886e+05, 3.8886e+05, 3.8888e+05, 3.8883e+05, 7.8525e+05, 7.8846e+05,
         3.8886e+05, 3.8885e+05, 7.6451e+05, 7.7125e+05],
        [3.8187e+05, 3.8186e+05, 7.7424e+05, 0.0000e+00, 3.8184e+05, 3.8186e+05,
         3.8184e+05, 3.8187e+05, 3.8187e+05, 3.8187e+05, 7.7716e+05, 7.7617e+05,
         3.8182e+05, 3.8184e+05, 7.5315e+05, 7.4784e+05],
        [8.4855e-01, 8.1271e-01, 3.8885e+05, 3.8184e+05, 0.0000e+00, 7.7352e-01,
         8.9810e-01, 8.9493e-01, 8.7194e-01, 9.9380e-01, 4.0287e+05, 3.8601e+05,
         8.5067e-01, 9.0305e-01, 3.8567e+05, 3.6904e+05],
        [8.1270e-01, 8.6175e-01, 3.8887e+05, 3.8186e+05, 7.7352e-01, 0.0000e+00,
         9.0166e-01, 1.0079e+00, 8.2736e-01, 7.5448e-01, 4.0289e+05, 3.8601e+05,
         8.7764e-01, 8.7434e-01, 3.8568e+05, 3.6906e+05],
        [8.9981e-01, 9.1832e-01, 3.8886e+05, 3.8184e+05, 8.9810e-01, 9.0166e-01,
         0.0000e+00, 9.1568e-01, 8.9965e-01, 1.1302e+00, 4.0289e+05, 3.8600e+05,
         8.6218e-01, 9.5245e-01, 3.8566e+05, 3.6906e+05],
        [9.0575e-01, 9.1712e-01, 3.8886e+05, 3.8187e+05, 8.9493e-01, 1.0079e+00,
         9.1568e-01, 0.0000e+00, 9.2068e-01, 1.2596e+00, 4.0288e+05, 3.8603e+05,
         9.1764e-01, 9.8133e-01, 3.8568e+05, 3.6902e+05],
        [8.6101e-01, 8.5332e-01, 3.8888e+05, 3.8187e+05, 8.7194e-01, 8.2736e-01,
         8.9965e-01, 9.2068e-01, 0.0000e+00, 1.0539e+00, 4.0292e+05, 3.8601e+05,
         8.4450e-01, 9.1451e-01, 3.8568e+05, 3.6905e+05],
        [1.0032e+00, 1.0197e+00, 3.8883e+05, 3.8187e+05, 9.9380e-01, 7.5448e-01,
         1.1302e+00, 1.2596e+00, 1.0539e+00, 0.0000e+00, 4.0288e+05, 3.8604e+05,
         1.0715e+00, 1.0598e+00, 3.8571e+05, 3.6905e+05],
        [4.0288e+05, 4.0289e+05, 7.8525e+05, 7.7716e+05, 4.0287e+05, 4.0289e+05,
         4.0289e+05, 4.0288e+05, 4.0292e+05, 4.0288e+05, 0.0000e+00, 7.7990e+05,
         4.0286e+05, 4.0289e+05, 7.9494e+05, 7.8916e+05],
        [3.8602e+05, 3.8601e+05, 7.8846e+05, 7.7617e+05, 3.8601e+05, 3.8601e+05,
         3.8600e+05, 3.8603e+05, 3.8601e+05, 3.8604e+05, 7.7990e+05, 0.0000e+00,
         3.8601e+05, 3.8601e+05, 7.9513e+05, 7.5127e+05],
        [8.7266e-01, 8.7893e-01, 3.8886e+05, 3.8182e+05, 8.5067e-01, 8.7764e-01,
         8.6218e-01, 9.1764e-01, 8.4450e-01, 1.0715e+00, 4.0286e+05, 3.8601e+05,
         0.0000e+00, 9.4004e-01, 3.8569e+05, 3.6906e+05],
        [9.2756e-01, 9.1462e-01, 3.8885e+05, 3.8184e+05, 9.0305e-01, 8.7434e-01,
         9.5245e-01, 9.8133e-01, 9.1451e-01, 1.0598e+00, 4.0289e+05, 3.8601e+05,
         9.4004e-01, 0.0000e+00, 3.8568e+05, 3.6905e+05],
        [3.8569e+05, 3.8569e+05, 7.6451e+05, 7.5315e+05, 3.8567e+05, 3.8568e+05,
         3.8566e+05, 3.8568e+05, 3.8568e+05, 3.8571e+05, 7.9494e+05, 7.9513e+05,
         3.8569e+05, 3.8568e+05, 0.0000e+00, 7.3979e+05],
        [3.6906e+05, 3.6904e+05, 7.7125e+05, 7.4784e+05, 3.6904e+05, 3.6906e+05,
         3.6906e+05, 3.6902e+05, 3.6905e+05, 3.6905e+05, 7.8916e+05, 7.5127e+05,
         3.6906e+05, 3.6905e+05, 7.3979e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.1270e-01, 8.4855e-01, 8.6101e-01, 8.7266e-01, 8.7422e-01,
        8.9981e-01, 9.0575e-01, 9.2756e-01, 1.0032e+00, 3.6906e+05, 3.8187e+05,
        3.8569e+05, 3.8602e+05, 3.8884e+05, 4.0288e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.1271e-01, 8.5332e-01, 8.6175e-01, 8.7422e-01, 8.7893e-01,
        9.1462e-01, 9.1712e-01, 9.1832e-01, 1.0197e+00, 3.6904e+05, 3.8186e+05,
        3.8569e+05, 3.8601e+05, 3.8884e+05, 4.0289e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388833.1250, 388840.1875, 388843.2188, 388846.3438,
        388851.3125, 388857.0000, 388861.4375, 388861.6875, 388866.0312,
        388881.6250, 764512.3125, 771245.1250, 774239.0625, 785253.5625,
        788456.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381824.6250, 381836.6875, 381841.7500, 381844.1250,
        381857.0312, 381862.3750, 381865.2812, 381871.5000, 381873.8125,
        381874.5625, 747840.5625, 753148.1250, 774239.0625, 776165.1875,
        777156.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.7352e-01, 8.1271e-01, 8.4855e-01, 8.5067e-01, 8.7194e-01,
        8.9493e-01, 8.9810e-01, 9.0305e-01, 9.9380e-01, 3.6904e+05, 3.8184e+05,
        3.8567e+05, 3.8601e+05, 3.8885e+05, 4.0287e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.5448e-01, 7.7352e-01, 8.1270e-01, 8.2736e-01, 8.6175e-01,
        8.7434e-01, 8.7764e-01, 9.0166e-01, 1.0079e+00, 3.6906e+05, 3.8186e+05,
        3.8568e+05, 3.8601e+05, 3.8887e+05, 4.0289e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6218e-01, 8.9810e-01, 8.9965e-01, 8.9981e-01, 9.0166e-01,
        9.1568e-01, 9.1832e-01, 9.5245e-01, 1.1302e+00, 3.6906e+05, 3.8184e+05,
        3.8566e+05, 3.8600e+05, 3.8886e+05, 4.0289e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9493e-01, 9.0575e-01, 9.1568e-01, 9.1712e-01, 9.1764e-01,
        9.2068e-01, 9.8133e-01, 1.0079e+00, 1.2596e+00, 3.6902e+05, 3.8187e+05,
        3.8568e+05, 3.8603e+05, 3.8886e+05, 4.0288e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.2736e-01, 8.4450e-01, 8.5332e-01, 8.6101e-01, 8.7194e-01,
        8.9965e-01, 9.1451e-01, 9.2068e-01, 1.0539e+00, 3.6905e+05, 3.8187e+05,
        3.8568e+05, 3.8601e+05, 3.8888e+05, 4.0292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.5448e-01, 9.9380e-01, 1.0032e+00, 1.0197e+00, 1.0539e+00,
        1.0598e+00, 1.0715e+00, 1.1302e+00, 1.2596e+00, 3.6905e+05, 3.8187e+05,
        3.8571e+05, 3.8604e+05, 3.8883e+05, 4.0288e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402857.7500, 402872.8125, 402883.3125, 402883.5312,
        402883.9375, 402886.3125, 402887.6250, 402887.9375, 402888.6562,
        402918.4688, 777156.0625, 779899.9375, 785253.5625, 789164.0625,
        794935.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386002.5000, 386005.0625, 386006.9062, 386008.3125,
        386010.2188, 386012.7500, 386014.4688, 386020.8125, 386025.6875,
        386036.6250, 751273.1250, 776165.1875, 779899.9375, 788456.6250,
        795133.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4450e-01, 8.5067e-01, 8.6218e-01, 8.7266e-01, 8.7764e-01,
        8.7893e-01, 9.1764e-01, 9.4004e-01, 1.0715e+00, 3.6906e+05, 3.8182e+05,
        3.8569e+05, 3.8601e+05, 3.8886e+05, 4.0286e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7434e-01, 9.0305e-01, 9.1451e-01, 9.1462e-01, 9.2756e-01,
        9.4004e-01, 9.5245e-01, 9.8133e-01, 1.0598e+00, 3.6905e+05, 3.8184e+05,
        3.8568e+05, 3.8601e+05, 3.8885e+05, 4.0289e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385664.8125, 385667.4062, 385677.0312, 385678.5625,
        385680.9062, 385681.2500, 385686.6562, 385690.6875, 385692.5625,
        385711.5000, 739789.0625, 753148.1250, 764512.3125, 794935.8125,
        795133.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 369024.9688, 369037.8125, 369038.5000, 369047.4375,
        369048.8438, 369051.5312, 369055.0000, 369059.1875, 369062.2812,
        369062.8125, 739789.0625, 747840.5625, 751273.1250, 771245.1250,
        789164.0625])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['36907.03', '36904.65', '388854.19', '381855.19', '36904.57', '36906.69', '36906.34', '36903.36', '36905.55', '36905.82', '402885.06', '386014.31', '36907.09', '36906.00', '385683.16', '369048.84']
estimated f for each client, fs: [6, 6, 4, 4, 6, 6, 6, 6, 6, 6, 4, 4, 6, 6, 4, 5]
selected_index: 7
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 12, 17, 19, 11, 5, 10, 4, 3, 2, 20, 14, 7, 9, 18, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:19...
global Accuracy on shared test data: 73.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:19, End: 2025-07-22 16:01:19)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 15, 20, 9, 1, 5, 14, 17, 16, 13, 6, 2, 19, 18, 8, 3], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8389e+05, 3.9664e+05, 1.0668e+00, 9.7296e-01, 9.5856e-01,
         3.8313e+05, 3.8486e+05, 4.0332e+05, 3.9362e+05, 9.5855e-01, 9.0600e-01,
         3.7973e+05, 3.8111e+05, 9.5843e-01, 9.6976e-01],
        [3.8389e+05, 0.0000e+00, 7.8584e+05, 3.8385e+05, 3.8388e+05, 3.8387e+05,
         7.6631e+05, 7.6314e+05, 7.8988e+05, 7.9386e+05, 3.8388e+05, 3.8388e+05,
         7.7187e+05, 7.6778e+05, 3.8386e+05, 3.8388e+05],
        [3.9664e+05, 7.8584e+05, 0.0000e+00, 3.9664e+05, 3.9664e+05, 3.9665e+05,
         7.7913e+05, 7.8015e+05, 7.9580e+05, 7.8637e+05, 3.9662e+05, 3.9662e+05,
         7.7168e+05, 7.5534e+05, 3.9663e+05, 3.9664e+05],
        [1.0668e+00, 3.8385e+05, 3.9664e+05, 0.0000e+00, 1.0584e+00, 1.0922e+00,
         3.8313e+05, 3.8485e+05, 4.0335e+05, 3.9364e+05, 1.1247e+00, 1.0713e+00,
         3.7973e+05, 3.8111e+05, 1.0530e+00, 1.0084e+00],
        [9.7296e-01, 3.8388e+05, 3.9664e+05, 1.0584e+00, 0.0000e+00, 1.0170e+00,
         3.8314e+05, 3.8487e+05, 4.0332e+05, 3.9362e+05, 1.0364e+00, 1.0187e+00,
         3.7975e+05, 3.8110e+05, 1.0090e+00, 1.0431e+00],
        [9.5856e-01, 3.8387e+05, 3.9665e+05, 1.0922e+00, 1.0170e+00, 0.0000e+00,
         3.8311e+05, 3.8487e+05, 4.0336e+05, 3.9364e+05, 6.3212e-01, 7.7166e-01,
         3.7972e+05, 3.8111e+05, 9.8727e-01, 9.8943e-01],
        [3.8313e+05, 7.6631e+05, 7.7913e+05, 3.8313e+05, 3.8314e+05, 3.8311e+05,
         0.0000e+00, 7.4105e+05, 8.0595e+05, 7.9193e+05, 3.8312e+05, 3.8312e+05,
         7.4069e+05, 7.6255e+05, 3.8313e+05, 3.8314e+05],
        [3.8486e+05, 7.6314e+05, 7.8015e+05, 3.8485e+05, 3.8487e+05, 3.8487e+05,
         7.4105e+05, 0.0000e+00, 7.9311e+05, 7.8358e+05, 3.8487e+05, 3.8487e+05,
         7.4504e+05, 7.5562e+05, 3.8486e+05, 3.8484e+05],
        [4.0332e+05, 7.8988e+05, 7.9580e+05, 4.0335e+05, 4.0332e+05, 4.0336e+05,
         8.0595e+05, 7.9311e+05, 0.0000e+00, 8.0264e+05, 4.0333e+05, 4.0333e+05,
         8.1391e+05, 7.8155e+05, 4.0333e+05, 4.0337e+05],
        [3.9362e+05, 7.9386e+05, 7.8637e+05, 3.9364e+05, 3.9362e+05, 3.9364e+05,
         7.9193e+05, 7.8358e+05, 8.0264e+05, 0.0000e+00, 3.9364e+05, 3.9365e+05,
         7.8655e+05, 7.6760e+05, 3.9364e+05, 3.9367e+05],
        [9.5855e-01, 3.8388e+05, 3.9662e+05, 1.1247e+00, 1.0364e+00, 6.3212e-01,
         3.8312e+05, 3.8487e+05, 4.0333e+05, 3.9364e+05, 0.0000e+00, 5.8053e-01,
         3.7971e+05, 3.8112e+05, 9.8366e-01, 1.0897e+00],
        [9.0600e-01, 3.8388e+05, 3.9662e+05, 1.0713e+00, 1.0187e+00, 7.7166e-01,
         3.8312e+05, 3.8487e+05, 4.0333e+05, 3.9365e+05, 5.8053e-01, 0.0000e+00,
         3.7971e+05, 3.8112e+05, 9.9159e-01, 1.0434e+00],
        [3.7973e+05, 7.7187e+05, 7.7168e+05, 3.7973e+05, 3.7975e+05, 3.7972e+05,
         7.4069e+05, 7.4504e+05, 8.1391e+05, 7.8655e+05, 3.7971e+05, 3.7971e+05,
         0.0000e+00, 7.6018e+05, 3.7971e+05, 3.7970e+05],
        [3.8111e+05, 7.6778e+05, 7.5534e+05, 3.8111e+05, 3.8110e+05, 3.8111e+05,
         7.6255e+05, 7.5562e+05, 7.8155e+05, 7.6760e+05, 3.8112e+05, 3.8112e+05,
         7.6018e+05, 0.0000e+00, 3.8111e+05, 3.8113e+05],
        [9.5843e-01, 3.8386e+05, 3.9663e+05, 1.0530e+00, 1.0090e+00, 9.8727e-01,
         3.8313e+05, 3.8486e+05, 4.0333e+05, 3.9364e+05, 9.8366e-01, 9.9159e-01,
         3.7971e+05, 3.8111e+05, 0.0000e+00, 9.4397e-01],
        [9.6976e-01, 3.8388e+05, 3.9664e+05, 1.0084e+00, 1.0431e+00, 9.8943e-01,
         3.8314e+05, 3.8484e+05, 4.0337e+05, 3.9367e+05, 1.0897e+00, 1.0434e+00,
         3.7970e+05, 3.8113e+05, 9.4397e-01, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.0600e-01, 9.5843e-01, 9.5855e-01, 9.5856e-01, 9.6976e-01,
        9.7296e-01, 1.0668e+00, 3.7973e+05, 3.8111e+05, 3.8313e+05, 3.8389e+05,
        3.8486e+05, 3.9362e+05, 3.9664e+05, 4.0332e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383845.4375, 383860.8750, 383872.4062, 383875.5000,
        383879.2500, 383879.4062, 383880.0625, 383890.0625, 763140.3125,
        766308.4375, 767780.1875, 771870.1875, 785840.6875, 789880.8750,
        793863.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396619.8438, 396622.6875, 396628.8438, 396638.0625,
        396641.8125, 396643.3438, 396644.3125, 396651.3438, 755337.4375,
        771679.3750, 779129.5000, 780146.3750, 785840.6875, 786365.1250,
        795798.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0084e+00, 1.0530e+00, 1.0584e+00, 1.0668e+00, 1.0713e+00,
        1.0922e+00, 1.1247e+00, 3.7973e+05, 3.8111e+05, 3.8313e+05, 3.8385e+05,
        3.8485e+05, 3.9364e+05, 3.9664e+05, 4.0335e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7296e-01, 1.0090e+00, 1.0170e+00, 1.0187e+00, 1.0364e+00,
        1.0431e+00, 1.0584e+00, 3.7975e+05, 3.8110e+05, 3.8314e+05, 3.8388e+05,
        3.8487e+05, 3.9362e+05, 3.9664e+05, 4.0332e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.3212e-01, 7.7166e-01, 9.5856e-01, 9.8727e-01, 9.8943e-01,
        1.0170e+00, 1.0922e+00, 3.7972e+05, 3.8111e+05, 3.8311e+05, 3.8387e+05,
        3.8487e+05, 3.9364e+05, 3.9665e+05, 4.0336e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383112.0625, 383121.5000, 383123.2500, 383131.7188,
        383133.1875, 383133.2188, 383139.0000, 383139.0312, 740685.7500,
        741049.6250, 762550.8750, 766308.4375, 779129.5000, 791933.3750,
        805945.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384837.1250, 384848.3438, 384862.0625, 384863.4688,
        384866.3750, 384871.4062, 384871.4375, 384874.0938, 741049.6250,
        745038.5000, 755621.1875, 763140.3125, 780146.3750, 783577.0000,
        793111.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403318.8438, 403323.8750, 403327.5000, 403328.4062,
        403329.7812, 403353.5312, 403361.0000, 403368.5625, 781550.5000,
        789880.8750, 793111.3750, 795798.6250, 802643.5625, 805945.1250,
        813912.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393619.2500, 393624.5938, 393635.0000, 393635.4375,
        393636.0000, 393643.6250, 393654.9375, 393669.5000, 767601.1875,
        783577.0000, 786365.1250, 786553.1875, 791933.3750, 793863.3125,
        802643.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.8053e-01, 6.3212e-01, 9.5855e-01, 9.8366e-01, 1.0364e+00,
        1.0897e+00, 1.1247e+00, 3.7971e+05, 3.8112e+05, 3.8312e+05, 3.8388e+05,
        3.8487e+05, 3.9364e+05, 3.9662e+05, 4.0333e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.8053e-01, 7.7166e-01, 9.0600e-01, 9.9159e-01, 1.0187e+00,
        1.0434e+00, 1.0713e+00, 3.7971e+05, 3.8112e+05, 3.8312e+05, 3.8388e+05,
        3.8487e+05, 3.9365e+05, 3.9662e+05, 4.0333e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379699.6875, 379709.7188, 379710.8125, 379714.3125,
        379719.9062, 379729.7188, 379734.7188, 379750.3438, 740685.7500,
        745038.5000, 760181.3750, 771679.3750, 771870.1875, 786553.1875,
        813912.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381099.6875, 381107.4688, 381108.3438, 381110.0312,
        381113.4062, 381115.5312, 381116.3125, 381130.4375, 755337.4375,
        755621.1875, 760181.3750, 762550.8750, 767601.1875, 767780.1875,
        781550.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4397e-01, 9.5843e-01, 9.8366e-01, 9.8727e-01, 9.9159e-01,
        1.0090e+00, 1.0530e+00, 3.7971e+05, 3.8111e+05, 3.8313e+05, 3.8386e+05,
        3.8486e+05, 3.9364e+05, 3.9663e+05, 4.0333e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4397e-01, 9.6976e-01, 9.8943e-01, 1.0084e+00, 1.0431e+00,
        1.0434e+00, 1.0897e+00, 3.7970e+05, 3.8113e+05, 3.8314e+05, 3.8388e+05,
        3.8484e+05, 3.9367e+05, 3.9664e+05, 4.0337e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['114398.31', '460043.19', '470010.69', '114398.14', '114399.62', '114394.66', '454676.84', '456498.25', '479814.25', '470029.66', '114395.85', '114395.48', '452349.34', '455985.94', '114396.10', '114397.62']
estimated f for each client, fs: [8, 5, 5, 8, 8, 8, 5, 5, 5, 5, 8, 8, 5, 5, 8, 8]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 15, 20, 9, 1, 5, 14, 17, 16, 13, 6, 2, 19, 18, 8, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:20...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:20, End: 2025-07-22 16:01:20)
start time is: 99044571566534, end time is: 99062280847710
The total time is: 17709281176ns.

 ------- aggregate method: rkrum, random_seed: 400 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 6, 13, 16, 7, 15, 9, 17, 14, 10, 8, 12, 20, 19, 1, 18], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 5.6688e+00, 3.9278e+05, 4.0404e+05, 5.3339e+00, 3.9672e+05,
         5.7985e+00, 3.8072e+05, 3.9001e+05, 4.9662e+00, 5.3374e+00, 4.7864e+00,
         3.8863e+05, 3.8400e+05, 7.6818e+00, 3.8988e+05],
        [5.6688e+00, 0.0000e+00, 3.9285e+05, 4.0404e+05, 6.7382e+00, 3.9670e+05,
         6.6991e+00, 3.8074e+05, 3.9000e+05, 6.5897e+00, 5.3421e+00, 6.1514e+00,
         3.8865e+05, 3.8389e+05, 8.5180e+00, 3.9001e+05],
        [3.9278e+05, 3.9285e+05, 0.0000e+00, 8.0337e+05, 3.9278e+05, 8.0108e+05,
         3.9283e+05, 7.7521e+05, 7.6090e+05, 3.9282e+05, 3.9278e+05, 3.9275e+05,
         7.5724e+05, 7.7740e+05, 3.9287e+05, 7.7690e+05],
        [4.0404e+05, 4.0404e+05, 8.0337e+05, 0.0000e+00, 4.0407e+05, 8.0348e+05,
         4.0410e+05, 7.8220e+05, 7.8168e+05, 4.0403e+05, 4.0407e+05, 4.0405e+05,
         7.7933e+05, 7.7974e+05, 4.0407e+05, 7.9322e+05],
        [5.3339e+00, 6.7382e+00, 3.9278e+05, 4.0407e+05, 0.0000e+00, 3.9671e+05,
         5.2070e+00, 3.8061e+05, 3.8999e+05, 5.1462e+00, 6.5858e+00, 4.6051e+00,
         3.8862e+05, 3.8398e+05, 5.6119e+00, 3.9000e+05],
        [3.9672e+05, 3.9670e+05, 8.0108e+05, 8.0348e+05, 3.9671e+05, 0.0000e+00,
         3.9665e+05, 7.7136e+05, 7.8655e+05, 3.9671e+05, 3.9670e+05, 3.9668e+05,
         7.7977e+05, 7.8332e+05, 3.9668e+05, 7.8571e+05],
        [5.7985e+00, 6.6991e+00, 3.9283e+05, 4.0410e+05, 5.2070e+00, 3.9665e+05,
         0.0000e+00, 3.8071e+05, 3.9001e+05, 6.0936e+00, 6.2001e+00, 5.7615e+00,
         3.8864e+05, 3.8403e+05, 4.7960e+00, 3.9002e+05],
        [3.8072e+05, 3.8074e+05, 7.7521e+05, 7.8220e+05, 3.8061e+05, 7.7136e+05,
         3.8071e+05, 0.0000e+00, 7.7256e+05, 3.8067e+05, 3.8068e+05, 3.8065e+05,
         7.7599e+05, 7.7764e+05, 3.8066e+05, 7.6369e+05],
        [3.9001e+05, 3.9000e+05, 7.6090e+05, 7.8168e+05, 3.8999e+05, 7.8655e+05,
         3.9001e+05, 7.7256e+05, 0.0000e+00, 3.9002e+05, 3.8999e+05, 3.8993e+05,
         7.8100e+05, 7.7359e+05, 3.9004e+05, 7.8859e+05],
        [4.9662e+00, 6.5897e+00, 3.9282e+05, 4.0403e+05, 5.1462e+00, 3.9671e+05,
         6.0936e+00, 3.8067e+05, 3.9002e+05, 0.0000e+00, 6.0059e+00, 5.0401e+00,
         3.8861e+05, 3.8399e+05, 7.1489e+00, 3.8997e+05],
        [5.3374e+00, 5.3421e+00, 3.9278e+05, 4.0407e+05, 6.5858e+00, 3.9670e+05,
         6.2001e+00, 3.8068e+05, 3.8999e+05, 6.0059e+00, 0.0000e+00, 5.5551e+00,
         3.8856e+05, 3.8395e+05, 7.6797e+00, 3.8993e+05],
        [4.7864e+00, 6.1514e+00, 3.9275e+05, 4.0405e+05, 4.6051e+00, 3.9668e+05,
         5.7615e+00, 3.8065e+05, 3.8993e+05, 5.0401e+00, 5.5551e+00, 0.0000e+00,
         3.8859e+05, 3.8401e+05, 6.6116e+00, 3.8994e+05],
        [3.8863e+05, 3.8865e+05, 7.5724e+05, 7.7933e+05, 3.8862e+05, 7.7977e+05,
         3.8864e+05, 7.7599e+05, 7.8100e+05, 3.8861e+05, 3.8856e+05, 3.8859e+05,
         0.0000e+00, 7.7112e+05, 3.8858e+05, 7.5018e+05],
        [3.8400e+05, 3.8389e+05, 7.7740e+05, 7.7974e+05, 3.8398e+05, 7.8332e+05,
         3.8403e+05, 7.7764e+05, 7.7359e+05, 3.8399e+05, 3.8395e+05, 3.8401e+05,
         7.7112e+05, 0.0000e+00, 3.8395e+05, 7.5370e+05],
        [7.6818e+00, 8.5180e+00, 3.9287e+05, 4.0407e+05, 5.6119e+00, 3.9668e+05,
         4.7960e+00, 3.8066e+05, 3.9004e+05, 7.1489e+00, 7.6797e+00, 6.6116e+00,
         3.8858e+05, 3.8395e+05, 0.0000e+00, 3.8996e+05],
        [3.8988e+05, 3.9001e+05, 7.7690e+05, 7.9322e+05, 3.9000e+05, 7.8571e+05,
         3.9002e+05, 7.6369e+05, 7.8859e+05, 3.8997e+05, 3.8993e+05, 3.8994e+05,
         7.5018e+05, 7.5370e+05, 3.8996e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 4.7864e+00, 4.9662e+00, 5.3339e+00, 5.3374e+00, 5.6688e+00,
        5.7985e+00, 7.6818e+00, 3.8072e+05, 3.8400e+05, 3.8863e+05, 3.8988e+05,
        3.9001e+05, 3.9278e+05, 3.9672e+05, 4.0404e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.3421e+00, 5.6688e+00, 6.1514e+00, 6.5897e+00, 6.6991e+00,
        6.7382e+00, 8.5180e+00, 3.8074e+05, 3.8389e+05, 3.8865e+05, 3.9000e+05,
        3.9001e+05, 3.9285e+05, 3.9670e+05, 4.0404e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392747.9375, 392778.7188, 392782.4375, 392784.5625,
        392823.3125, 392829.6875, 392850.8438, 392869.4375, 757242.0000,
        760899.1250, 775212.0000, 776901.6875, 777396.1250, 801082.2500,
        803370.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404031.9375, 404038.8125, 404042.8750, 404053.8125,
        404065.5312, 404068.3125, 404073.0000, 404103.6562, 779329.6875,
        779741.0000, 781675.9375, 782202.4375, 793220.2500, 803370.6250,
        803485.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.6051e+00, 5.1462e+00, 5.2070e+00, 5.3339e+00, 5.6119e+00,
        6.5858e+00, 6.7382e+00, 3.8061e+05, 3.8398e+05, 3.8862e+05, 3.8999e+05,
        3.9000e+05, 3.9278e+05, 3.9671e+05, 4.0407e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396647.4062, 396675.0000, 396683.5312, 396699.7188,
        396704.0938, 396709.5000, 396711.1250, 396723.9062, 771363.6250,
        779769.6875, 783319.0625, 785705.0625, 786545.1250, 801082.2500,
        803485.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.7960e+00, 5.2070e+00, 5.7615e+00, 5.7985e+00, 6.0936e+00,
        6.2001e+00, 6.6991e+00, 3.8071e+05, 3.8403e+05, 3.8864e+05, 3.9001e+05,
        3.9002e+05, 3.9283e+05, 3.9665e+05, 4.0410e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380607.2500, 380645.8750, 380661.1250, 380672.5000,
        380675.0000, 380710.7812, 380715.3750, 380738.6875, 763692.6250,
        771363.6250, 772563.8750, 775212.0000, 775987.3750, 777643.5000,
        782202.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389931.2500, 389992.8750, 389992.9688, 390004.2812,
        390007.8438, 390010.4062, 390017.9062, 390037.0312, 760899.1250,
        772563.8750, 773594.0000, 780998.8750, 781675.9375, 786545.1250,
        788587.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.9662e+00, 5.0401e+00, 5.1462e+00, 6.0059e+00, 6.0936e+00,
        6.5897e+00, 7.1489e+00, 3.8067e+05, 3.8399e+05, 3.8861e+05, 3.8997e+05,
        3.9002e+05, 3.9282e+05, 3.9671e+05, 4.0403e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 5.3374e+00, 5.3421e+00, 5.5551e+00, 6.0059e+00, 6.2001e+00,
        6.5858e+00, 7.6797e+00, 3.8068e+05, 3.8395e+05, 3.8856e+05, 3.8993e+05,
        3.8999e+05, 3.9278e+05, 3.9670e+05, 4.0407e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.6051e+00, 4.7864e+00, 5.0401e+00, 5.5551e+00, 5.7615e+00,
        6.1514e+00, 6.6116e+00, 3.8065e+05, 3.8401e+05, 3.8859e+05, 3.8993e+05,
        3.8994e+05, 3.9275e+05, 3.9668e+05, 4.0405e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388562.1250, 388578.7188, 388588.5625, 388611.8125,
        388616.4375, 388633.0625, 388641.4688, 388650.0625, 750176.6250,
        757242.0000, 771121.5000, 775987.3750, 779329.6875, 779769.6875,
        780998.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383892.6875, 383946.2188, 383947.3125, 383978.9688,
        383986.6562, 383997.0625, 384013.7500, 384028.1562, 753696.1250,
        771121.5000, 773594.0000, 777396.1250, 777643.5000, 779741.0000,
        783319.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 4.7960e+00, 5.6119e+00, 6.6116e+00, 7.1489e+00, 7.6797e+00,
        7.6818e+00, 8.5180e+00, 3.8066e+05, 3.8395e+05, 3.8858e+05, 3.8996e+05,
        3.9004e+05, 3.9287e+05, 3.9668e+05, 4.0407e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389881.3125, 389925.3438, 389942.8125, 389962.7188,
        389968.2500, 390000.3750, 390009.2812, 390023.7500, 750176.6250,
        753696.1250, 763692.6250, 776901.6875, 785705.0625, 788587.6875,
        793220.2500])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['115338.50', '115332.70', '466060.81', '479154.84', '115324.17', '472468.75', '115342.09', '458048.25', '465345.75', '115331.19', '115322.60', '115328.67', '461630.06', '459660.81', '115323.52', '462358.69']
estimated f for each client, fs: [8, 8, 5, 5, 8, 5, 8, 7, 5, 8, 8, 8, 5, 6, 8, 5]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 6, 13, 16, 7, 15, 9, 17, 14, 10, 8, 12, 20, 19, 1, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:21...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:21, End: 2025-07-22 16:01:21)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 1, 17, 11, 15, 20, 4, 19, 14, 7, 8, 3, 13, 16, 2, 9], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 2.0222e+00, 3.7568e+05, 1.9131e+00, 3.9725e+05, 3.9331e+05,
         1.9020e+00, 3.9681e+05, 3.7769e+05, 1.9692e+00, 2.1618e+00, 1.8211e+00,
         3.9255e+05, 3.9234e+05, 2.0273e+00, 1.8244e+00],
        [2.0222e+00, 0.0000e+00, 3.7569e+05, 1.9792e+00, 3.9719e+05, 3.9331e+05,
         1.8329e+00, 3.9680e+05, 3.7768e+05, 1.9030e+00, 2.2005e+00, 1.9441e+00,
         3.9259e+05, 3.9234e+05, 1.8444e+00, 1.7649e+00],
        [3.7568e+05, 3.7569e+05, 0.0000e+00, 3.7569e+05, 7.8073e+05, 7.8159e+05,
         3.7572e+05, 7.6757e+05, 7.2167e+05, 3.7572e+05, 3.7568e+05, 3.7568e+05,
         7.5352e+05, 7.5587e+05, 3.7569e+05, 3.7568e+05],
        [1.9131e+00, 1.9792e+00, 3.7569e+05, 0.0000e+00, 3.9724e+05, 3.9329e+05,
         1.7562e+00, 3.9676e+05, 3.7768e+05, 1.9448e+00, 2.1533e+00, 2.0039e+00,
         3.9260e+05, 3.9235e+05, 2.0016e+00, 1.8576e+00],
        [3.9725e+05, 3.9719e+05, 7.8073e+05, 3.9724e+05, 0.0000e+00, 7.8713e+05,
         3.9719e+05, 7.8541e+05, 7.9168e+05, 3.9720e+05, 3.9721e+05, 3.9717e+05,
         7.9622e+05, 7.7689e+05, 3.9717e+05, 3.9722e+05],
        [3.9331e+05, 3.9331e+05, 7.8159e+05, 3.9329e+05, 7.8713e+05, 0.0000e+00,
         3.9326e+05, 7.9340e+05, 7.8523e+05, 3.9331e+05, 3.9331e+05, 3.9332e+05,
         7.9145e+05, 7.7091e+05, 3.9330e+05, 3.9333e+05],
        [1.9020e+00, 1.8329e+00, 3.7572e+05, 1.7562e+00, 3.9719e+05, 3.9326e+05,
         0.0000e+00, 3.9678e+05, 3.7764e+05, 1.8428e+00, 2.0934e+00, 1.9050e+00,
         3.9256e+05, 3.9235e+05, 1.9404e+00, 1.8797e+00],
        [3.9681e+05, 3.9680e+05, 7.6757e+05, 3.9676e+05, 7.8541e+05, 7.9340e+05,
         3.9678e+05, 0.0000e+00, 7.8453e+05, 3.9682e+05, 3.9677e+05, 3.9678e+05,
         7.8402e+05, 7.8009e+05, 3.9685e+05, 3.9682e+05],
        [3.7769e+05, 3.7768e+05, 7.2167e+05, 3.7768e+05, 7.9168e+05, 7.8523e+05,
         3.7764e+05, 7.8453e+05, 0.0000e+00, 3.7769e+05, 3.7765e+05, 3.7770e+05,
         7.6572e+05, 7.6695e+05, 3.7769e+05, 3.7768e+05],
        [1.9692e+00, 1.9030e+00, 3.7572e+05, 1.9448e+00, 3.9720e+05, 3.9331e+05,
         1.8428e+00, 3.9682e+05, 3.7769e+05, 0.0000e+00, 2.3114e+00, 1.8661e+00,
         3.9260e+05, 3.9233e+05, 1.8417e+00, 1.8516e+00],
        [2.1618e+00, 2.2005e+00, 3.7568e+05, 2.1533e+00, 3.9721e+05, 3.9331e+05,
         2.0934e+00, 3.9677e+05, 3.7765e+05, 2.3114e+00, 0.0000e+00, 2.0987e+00,
         3.9257e+05, 3.9236e+05, 2.3592e+00, 2.0668e+00],
        [1.8211e+00, 1.9441e+00, 3.7568e+05, 2.0039e+00, 3.9717e+05, 3.9332e+05,
         1.9050e+00, 3.9678e+05, 3.7770e+05, 1.8661e+00, 2.0987e+00, 0.0000e+00,
         3.9258e+05, 3.9234e+05, 1.9529e+00, 1.7069e+00],
        [3.9255e+05, 3.9259e+05, 7.5352e+05, 3.9260e+05, 7.9622e+05, 7.9145e+05,
         3.9256e+05, 7.8402e+05, 7.6572e+05, 3.9260e+05, 3.9257e+05, 3.9258e+05,
         0.0000e+00, 7.5962e+05, 3.9261e+05, 3.9260e+05],
        [3.9234e+05, 3.9234e+05, 7.5587e+05, 3.9235e+05, 7.7689e+05, 7.7091e+05,
         3.9235e+05, 7.8009e+05, 7.6695e+05, 3.9233e+05, 3.9236e+05, 3.9234e+05,
         7.5962e+05, 0.0000e+00, 3.9235e+05, 3.9236e+05],
        [2.0273e+00, 1.8444e+00, 3.7569e+05, 2.0016e+00, 3.9717e+05, 3.9330e+05,
         1.9404e+00, 3.9685e+05, 3.7769e+05, 1.8417e+00, 2.3592e+00, 1.9529e+00,
         3.9261e+05, 3.9235e+05, 0.0000e+00, 1.8335e+00],
        [1.8244e+00, 1.7649e+00, 3.7568e+05, 1.8576e+00, 3.9722e+05, 3.9333e+05,
         1.8797e+00, 3.9682e+05, 3.7768e+05, 1.8516e+00, 2.0668e+00, 1.7069e+00,
         3.9260e+05, 3.9236e+05, 1.8335e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.8211e+00, 1.8244e+00, 1.9020e+00, 1.9131e+00, 1.9692e+00,
        2.0222e+00, 2.0273e+00, 2.1618e+00, 3.7568e+05, 3.7769e+05, 3.9234e+05,
        3.9255e+05, 3.9331e+05, 3.9681e+05, 3.9725e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7649e+00, 1.8329e+00, 1.8444e+00, 1.9030e+00, 1.9441e+00,
        1.9792e+00, 2.0222e+00, 2.2005e+00, 3.7569e+05, 3.7768e+05, 3.9234e+05,
        3.9259e+05, 3.9331e+05, 3.9680e+05, 3.9719e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 375677.3750, 375682.7500, 375683.8438, 375684.5625,
        375686.1250, 375692.9375, 375694.2500, 375717.0625, 375722.5000,
        721671.5000, 753524.4375, 755871.8125, 767571.0625, 780728.1250,
        781593.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7562e+00, 1.8576e+00, 1.9131e+00, 1.9448e+00, 1.9792e+00,
        2.0016e+00, 2.0039e+00, 2.1533e+00, 3.7569e+05, 3.7768e+05, 3.9235e+05,
        3.9260e+05, 3.9329e+05, 3.9676e+05, 3.9724e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397165.5625, 397174.2500, 397187.0000, 397187.4375,
        397204.6562, 397213.9062, 397216.0625, 397237.3750, 397245.9375,
        776893.6875, 780728.1250, 785413.1250, 787126.7500, 791680.3125,
        796222.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393264.9375, 393294.4062, 393297.7188, 393305.3438,
        393305.5000, 393306.7500, 393312.0312, 393317.9062, 393328.8125,
        770913.1250, 781593.1250, 785231.3750, 787126.7500, 791451.0000,
        793398.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7562e+00, 1.8329e+00, 1.8428e+00, 1.8797e+00, 1.9020e+00,
        1.9050e+00, 1.9404e+00, 2.0934e+00, 3.7572e+05, 3.7764e+05, 3.9235e+05,
        3.9256e+05, 3.9326e+05, 3.9678e+05, 3.9719e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396763.6875, 396772.3750, 396775.8438, 396784.6250,
        396803.9688, 396805.2812, 396820.2500, 396821.5938, 396852.5938,
        767571.0625, 780085.2500, 784015.5625, 784534.1250, 785413.1250,
        793398.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377644.6875, 377650.4688, 377679.0000, 377683.3750,
        377683.4375, 377686.0312, 377689.1250, 377690.1562, 377697.6875,
        721671.5000, 765719.3750, 766954.4375, 784534.1250, 785231.3750,
        791680.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8417e+00, 1.8428e+00, 1.8516e+00, 1.8661e+00, 1.9030e+00,
        1.9448e+00, 1.9692e+00, 2.3114e+00, 3.7572e+05, 3.7769e+05, 3.9233e+05,
        3.9260e+05, 3.9331e+05, 3.9682e+05, 3.9720e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 2.0668e+00, 2.0934e+00, 2.0987e+00, 2.1533e+00, 2.1618e+00,
        2.2005e+00, 2.3114e+00, 2.3592e+00, 3.7568e+05, 3.7765e+05, 3.9236e+05,
        3.9257e+05, 3.9331e+05, 3.9677e+05, 3.9721e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7069e+00, 1.8211e+00, 1.8661e+00, 1.9050e+00, 1.9441e+00,
        1.9529e+00, 2.0039e+00, 2.0987e+00, 3.7568e+05, 3.7770e+05, 3.9234e+05,
        3.9258e+05, 3.9332e+05, 3.9678e+05, 3.9717e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392550.0625, 392559.1250, 392565.1250, 392582.6875,
        392587.5625, 392595.0938, 392599.7812, 392604.9062, 392605.2500,
        753524.4375, 759620.8125, 765719.3750, 784015.5625, 791451.0000,
        796222.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392331.7500, 392339.6250, 392340.7500, 392341.7188,
        392349.5000, 392351.4375, 392354.5000, 392359.0625, 392362.4375,
        755871.8125, 759620.8125, 766954.4375, 770913.1250, 776893.6875,
        780085.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8335e+00, 1.8417e+00, 1.8444e+00, 1.9404e+00, 1.9529e+00,
        2.0016e+00, 2.0273e+00, 2.3592e+00, 3.7569e+05, 3.7769e+05, 3.9235e+05,
        3.9261e+05, 3.9330e+05, 3.9685e+05, 3.9717e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7069e+00, 1.7649e+00, 1.8244e+00, 1.8335e+00, 1.8516e+00,
        1.8576e+00, 1.8797e+00, 2.0668e+00, 3.7568e+05, 3.7768e+05, 3.9236e+05,
        3.9260e+05, 3.9333e+05, 3.9682e+05, 3.9722e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75338.31', '75338.05', '410291.28', '75339.20', '435172.59', '431064.66', '75337.67', '433877.09', '412077.56', '75342.71', '75335.07', '75339.67', '428677.41', '428700.31', '75339.60', '75338.27']
estimated f for each client, fs: [7, 7, 5, 7, 5, 5, 7, 5, 5, 7, 7, 7, 5, 5, 7, 7]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 1, 17, 11, 15, 20, 4, 19, 14, 7, 8, 3, 13, 16, 2, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0150s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:21...
global Accuracy on shared test data: 73.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:21, End: 2025-07-22 16:01:21)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 3, 6, 11, 1, 2, 7, 19, 20, 13, 5, 8, 12, 10, 15, 4], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9820e+05, 3.9816e+05, 3.9815e+05, 3.9818e+05, 3.9818e+05,
         3.9817e+05, 7.8113e+05, 7.8452e+05, 7.7974e+05, 3.9814e+05, 3.9820e+05,
         3.9817e+05, 3.9820e+05, 7.7517e+05, 3.9818e+05],
        [3.9820e+05, 0.0000e+00, 1.5186e+00, 1.5322e+00, 1.4994e+00, 1.4494e+00,
         1.4061e+00, 3.7402e+05, 3.8822e+05, 3.7994e+05, 1.4247e+00, 1.9045e+00,
         1.3884e+00, 1.4710e+00, 3.7985e+05, 1.4259e+00],
        [3.9816e+05, 1.5186e+00, 0.0000e+00, 1.4429e+00, 1.4997e+00, 1.3649e+00,
         1.5317e+00, 3.7406e+05, 3.8822e+05, 3.7998e+05, 1.5331e+00, 2.0298e+00,
         1.5031e+00, 1.4391e+00, 3.7980e+05, 1.3460e+00],
        [3.9815e+05, 1.5322e+00, 1.4429e+00, 0.0000e+00, 1.5076e+00, 1.4483e+00,
         1.4573e+00, 3.7403e+05, 3.8823e+05, 3.7995e+05, 1.3228e+00, 1.9246e+00,
         1.3987e+00, 1.5139e+00, 3.7982e+05, 1.3155e+00],
        [3.9818e+05, 1.4994e+00, 1.4997e+00, 1.5076e+00, 0.0000e+00, 1.3993e+00,
         1.4931e+00, 3.7403e+05, 3.8824e+05, 3.7999e+05, 1.4857e+00, 2.0444e+00,
         1.5244e+00, 1.4532e+00, 3.7982e+05, 1.3799e+00],
        [3.9818e+05, 1.4494e+00, 1.3649e+00, 1.4483e+00, 1.3993e+00, 0.0000e+00,
         1.3301e+00, 3.7403e+05, 3.8826e+05, 3.7994e+05, 1.4964e+00, 2.0400e+00,
         1.4641e+00, 1.3207e+00, 3.7982e+05, 1.4184e+00],
        [3.9817e+05, 1.4061e+00, 1.5317e+00, 1.4573e+00, 1.4931e+00, 1.3301e+00,
         0.0000e+00, 3.7405e+05, 3.8821e+05, 3.7997e+05, 1.3529e+00, 2.1026e+00,
         1.4545e+00, 1.4250e+00, 3.7979e+05, 1.4014e+00],
        [7.8113e+05, 3.7402e+05, 3.7406e+05, 3.7403e+05, 3.7403e+05, 3.7403e+05,
         3.7405e+05, 0.0000e+00, 7.7330e+05, 7.5696e+05, 3.7402e+05, 3.7400e+05,
         3.7405e+05, 3.7404e+05, 7.6151e+05, 3.7402e+05],
        [7.8452e+05, 3.8822e+05, 3.8822e+05, 3.8823e+05, 3.8824e+05, 3.8826e+05,
         3.8821e+05, 7.7330e+05, 0.0000e+00, 7.6751e+05, 3.8823e+05, 3.8827e+05,
         3.8824e+05, 3.8821e+05, 7.6184e+05, 3.8826e+05],
        [7.7974e+05, 3.7994e+05, 3.7998e+05, 3.7995e+05, 3.7999e+05, 3.7994e+05,
         3.7997e+05, 7.5696e+05, 7.6751e+05, 0.0000e+00, 3.7995e+05, 3.7994e+05,
         3.7994e+05, 3.7993e+05, 7.5789e+05, 3.7992e+05],
        [3.9814e+05, 1.4247e+00, 1.5331e+00, 1.3228e+00, 1.4857e+00, 1.4964e+00,
         1.3529e+00, 3.7402e+05, 3.8823e+05, 3.7995e+05, 0.0000e+00, 1.9370e+00,
         1.3917e+00, 1.4759e+00, 3.7982e+05, 1.3688e+00],
        [3.9820e+05, 1.9045e+00, 2.0298e+00, 1.9246e+00, 2.0444e+00, 2.0400e+00,
         2.1026e+00, 3.7400e+05, 3.8827e+05, 3.7994e+05, 1.9370e+00, 0.0000e+00,
         1.8885e+00, 2.0175e+00, 3.7985e+05, 1.9233e+00],
        [3.9817e+05, 1.3884e+00, 1.5031e+00, 1.3987e+00, 1.5244e+00, 1.4641e+00,
         1.4545e+00, 3.7405e+05, 3.8824e+05, 3.7994e+05, 1.3917e+00, 1.8885e+00,
         0.0000e+00, 1.4222e+00, 3.7980e+05, 1.3933e+00],
        [3.9820e+05, 1.4710e+00, 1.4391e+00, 1.5139e+00, 1.4532e+00, 1.3207e+00,
         1.4250e+00, 3.7404e+05, 3.8821e+05, 3.7993e+05, 1.4759e+00, 2.0175e+00,
         1.4222e+00, 0.0000e+00, 3.7982e+05, 1.4122e+00],
        [7.7517e+05, 3.7985e+05, 3.7980e+05, 3.7982e+05, 3.7982e+05, 3.7982e+05,
         3.7979e+05, 7.6151e+05, 7.6184e+05, 7.5789e+05, 3.7982e+05, 3.7985e+05,
         3.7980e+05, 3.7982e+05, 0.0000e+00, 3.7982e+05],
        [3.9818e+05, 1.4259e+00, 1.3460e+00, 1.3155e+00, 1.3799e+00, 1.4184e+00,
         1.4014e+00, 3.7402e+05, 3.8826e+05, 3.7992e+05, 1.3688e+00, 1.9233e+00,
         1.3933e+00, 1.4122e+00, 3.7982e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 398143.9375, 398147.7812, 398156.5938, 398165.3125,
        398170.0000, 398180.1250, 398181.7500, 398184.9375, 398197.4375,
        398201.0625, 398202.4688, 775166.8125, 779739.3125, 781125.5000,
        784515.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3884e+00, 1.4061e+00, 1.4247e+00, 1.4259e+00, 1.4494e+00,
        1.4710e+00, 1.4994e+00, 1.5186e+00, 1.5322e+00, 1.9045e+00, 3.7402e+05,
        3.7985e+05, 3.7994e+05, 3.8822e+05, 3.9820e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3460e+00, 1.3649e+00, 1.4391e+00, 1.4429e+00, 1.4997e+00,
        1.5031e+00, 1.5186e+00, 1.5317e+00, 1.5331e+00, 2.0298e+00, 3.7406e+05,
        3.7980e+05, 3.7998e+05, 3.8822e+05, 3.9816e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3155e+00, 1.3228e+00, 1.3987e+00, 1.4429e+00, 1.4483e+00,
        1.4573e+00, 1.5076e+00, 1.5139e+00, 1.5322e+00, 1.9246e+00, 3.7403e+05,
        3.7982e+05, 3.7995e+05, 3.8823e+05, 3.9815e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3799e+00, 1.3993e+00, 1.4532e+00, 1.4857e+00, 1.4931e+00,
        1.4994e+00, 1.4997e+00, 1.5076e+00, 1.5244e+00, 2.0444e+00, 3.7403e+05,
        3.7982e+05, 3.7999e+05, 3.8824e+05, 3.9818e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3207e+00, 1.3301e+00, 1.3649e+00, 1.3993e+00, 1.4184e+00,
        1.4483e+00, 1.4494e+00, 1.4641e+00, 1.4964e+00, 2.0400e+00, 3.7403e+05,
        3.7982e+05, 3.7994e+05, 3.8826e+05, 3.9818e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3301e+00, 1.3529e+00, 1.4014e+00, 1.4061e+00, 1.4250e+00,
        1.4545e+00, 1.4573e+00, 1.4931e+00, 1.5317e+00, 2.1026e+00, 3.7405e+05,
        3.7979e+05, 3.7997e+05, 3.8821e+05, 3.9817e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 373995.8750, 374018.1875, 374023.5312, 374024.9688,
        374027.8125, 374028.5938, 374034.5000, 374044.1875, 374050.5312,
        374051.6875, 374057.5625, 756956.0000, 761514.1875, 773303.3750,
        781125.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388205.0312, 388207.0625, 388216.7500, 388224.4375,
        388231.4062, 388231.7500, 388243.7500, 388244.8125, 388255.4375,
        388258.8750, 388268.8438, 761836.0625, 767510.5000, 773303.3750,
        784515.1875])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 379915.8125, 379932.0000, 379935.0938, 379937.0625,
        379941.3438, 379944.7500, 379949.9375, 379952.5000, 379965.2188,
        379979.7500, 379987.3750, 756956.0000, 757892.4375, 767510.5000,
        779739.3125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3228e+00, 1.3529e+00, 1.3688e+00, 1.3917e+00, 1.4247e+00,
        1.4759e+00, 1.4857e+00, 1.4964e+00, 1.5331e+00, 1.9370e+00, 3.7402e+05,
        3.7982e+05, 3.7995e+05, 3.8823e+05, 3.9814e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.8885e+00, 1.9045e+00, 1.9233e+00, 1.9246e+00, 1.9370e+00,
        2.0175e+00, 2.0298e+00, 2.0400e+00, 2.0444e+00, 2.1026e+00, 3.7400e+05,
        3.7985e+05, 3.7994e+05, 3.8827e+05, 3.9820e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3884e+00, 1.3917e+00, 1.3933e+00, 1.3987e+00, 1.4222e+00,
        1.4545e+00, 1.4641e+00, 1.5031e+00, 1.5244e+00, 1.8885e+00, 3.7405e+05,
        3.7980e+05, 3.7994e+05, 3.8824e+05, 3.9817e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3207e+00, 1.4122e+00, 1.4222e+00, 1.4250e+00, 1.4391e+00,
        1.4532e+00, 1.4710e+00, 1.4759e+00, 1.5139e+00, 2.0175e+00, 3.7404e+05,
        3.7982e+05, 3.7993e+05, 3.8821e+05, 3.9820e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379791.9688, 379801.7188, 379803.5312, 379817.6562,
        379817.7188, 379818.6875, 379822.9375, 379824.5938, 379824.7500,
        379845.9062, 379854.0312, 757892.4375, 761514.1875, 761836.0625,
        775166.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 1.3155e+00, 1.3460e+00, 1.3688e+00, 1.3799e+00, 1.3933e+00,
        1.4014e+00, 1.4122e+00, 1.4184e+00, 1.4259e+00, 1.9233e+00, 3.7402e+05,
        3.7982e+05, 3.7992e+05, 3.8826e+05, 3.9818e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['398175.53', '1.50', '1.52', '1.49', '1.53', '1.47', '1.50', '374029.97', '388235.31', '379949.16', '1.48', '1.98', '1.48', '1.50', '379820.34', '1.44']
estimated f for each client, fs: [3, 5, 5, 5, 5, 5, 5, 5, 3, 3, 5, 5, 5, 5, 3, 5]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [16, 3, 6, 11, 1, 2, 7, 19, 20, 13, 5, 8, 12, 10, 15, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0134s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:22...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:22, End: 2025-07-22 16:01:22)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 17, 19, 3, 4, 9, 10, 14, 18, 12, 8, 16, 2, 7, 13, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7981e+05, 4.0379e+05, 1.8328e+00, 1.7419e+00, 1.5961e+00,
         1.7332e+00, 3.8902e+05, 3.8444e+05, 1.6324e+00, 1.9955e+00, 3.8801e+05,
         1.7112e+00, 1.7242e+00, 3.8827e+05, 3.9578e+05],
        [3.7981e+05, 0.0000e+00, 7.8034e+05, 3.7979e+05, 3.7980e+05, 3.7978e+05,
         3.7977e+05, 7.4988e+05, 7.5756e+05, 3.7980e+05, 3.7981e+05, 7.7818e+05,
         3.7977e+05, 3.7978e+05, 7.5081e+05, 7.8033e+05],
        [4.0379e+05, 7.8034e+05, 0.0000e+00, 4.0374e+05, 4.0373e+05, 4.0376e+05,
         4.0374e+05, 7.9220e+05, 7.9666e+05, 4.0379e+05, 4.0378e+05, 7.8780e+05,
         4.0375e+05, 4.0378e+05, 7.8837e+05, 7.9862e+05],
        [1.8328e+00, 3.7979e+05, 4.0374e+05, 0.0000e+00, 1.8088e+00, 1.6960e+00,
         1.7007e+00, 3.8900e+05, 3.8445e+05, 1.6592e+00, 2.0522e+00, 3.8803e+05,
         1.6973e+00, 1.7770e+00, 3.8830e+05, 3.9574e+05],
        [1.7419e+00, 3.7980e+05, 4.0373e+05, 1.8088e+00, 0.0000e+00, 1.7805e+00,
         1.7778e+00, 3.8900e+05, 3.8446e+05, 1.7542e+00, 1.7625e+00, 3.8803e+05,
         1.7778e+00, 1.7815e+00, 3.8832e+05, 3.9576e+05],
        [1.5961e+00, 3.7978e+05, 4.0376e+05, 1.6960e+00, 1.7805e+00, 0.0000e+00,
         1.6129e+00, 3.8897e+05, 3.8446e+05, 1.6551e+00, 1.9353e+00, 3.8800e+05,
         1.6581e+00, 1.7298e+00, 3.8831e+05, 3.9575e+05],
        [1.7332e+00, 3.7977e+05, 4.0374e+05, 1.7007e+00, 1.7778e+00, 1.6129e+00,
         0.0000e+00, 3.8901e+05, 3.8449e+05, 1.6637e+00, 2.1137e+00, 3.8800e+05,
         1.6570e+00, 1.6252e+00, 3.8827e+05, 3.9577e+05],
        [3.8902e+05, 7.4988e+05, 7.9220e+05, 3.8900e+05, 3.8900e+05, 3.8897e+05,
         3.8901e+05, 0.0000e+00, 7.8651e+05, 3.8901e+05, 3.8898e+05, 7.9044e+05,
         3.8902e+05, 3.8897e+05, 7.5518e+05, 7.6544e+05],
        [3.8444e+05, 7.5756e+05, 7.9666e+05, 3.8445e+05, 3.8446e+05, 3.8446e+05,
         3.8449e+05, 7.8651e+05, 0.0000e+00, 3.8445e+05, 3.8448e+05, 7.7751e+05,
         3.8444e+05, 3.8442e+05, 7.7553e+05, 7.5228e+05],
        [1.6324e+00, 3.7980e+05, 4.0379e+05, 1.6592e+00, 1.7542e+00, 1.6551e+00,
         1.6637e+00, 3.8901e+05, 3.8445e+05, 0.0000e+00, 1.9879e+00, 3.8802e+05,
         1.7370e+00, 1.7538e+00, 3.8829e+05, 3.9572e+05],
        [1.9955e+00, 3.7981e+05, 4.0378e+05, 2.0522e+00, 1.7625e+00, 1.9353e+00,
         2.1137e+00, 3.8898e+05, 3.8448e+05, 1.9879e+00, 0.0000e+00, 3.8801e+05,
         2.1547e+00, 2.2493e+00, 3.8830e+05, 3.9577e+05],
        [3.8801e+05, 7.7818e+05, 7.8780e+05, 3.8803e+05, 3.8803e+05, 3.8800e+05,
         3.8800e+05, 7.9044e+05, 7.7751e+05, 3.8802e+05, 3.8801e+05, 0.0000e+00,
         3.8800e+05, 3.8802e+05, 7.9501e+05, 7.8674e+05],
        [1.7112e+00, 3.7977e+05, 4.0375e+05, 1.6973e+00, 1.7778e+00, 1.6581e+00,
         1.6570e+00, 3.8902e+05, 3.8444e+05, 1.7370e+00, 2.1547e+00, 3.8800e+05,
         0.0000e+00, 1.6103e+00, 3.8829e+05, 3.9578e+05],
        [1.7242e+00, 3.7978e+05, 4.0378e+05, 1.7770e+00, 1.7815e+00, 1.7298e+00,
         1.6252e+00, 3.8897e+05, 3.8442e+05, 1.7538e+00, 2.2493e+00, 3.8802e+05,
         1.6103e+00, 0.0000e+00, 3.8829e+05, 3.9575e+05],
        [3.8827e+05, 7.5081e+05, 7.8837e+05, 3.8830e+05, 3.8832e+05, 3.8831e+05,
         3.8827e+05, 7.5518e+05, 7.7553e+05, 3.8829e+05, 3.8830e+05, 7.9501e+05,
         3.8829e+05, 3.8829e+05, 0.0000e+00, 7.7584e+05],
        [3.9578e+05, 7.8033e+05, 7.9862e+05, 3.9574e+05, 3.9576e+05, 3.9575e+05,
         3.9577e+05, 7.6544e+05, 7.5228e+05, 3.9572e+05, 3.9577e+05, 7.8674e+05,
         3.9578e+05, 3.9575e+05, 7.7584e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5961e+00, 1.6324e+00, 1.7112e+00, 1.7242e+00, 1.7332e+00,
        1.7419e+00, 1.8328e+00, 1.9955e+00, 3.7981e+05, 3.8444e+05, 3.8801e+05,
        3.8827e+05, 3.8902e+05, 3.9578e+05, 4.0379e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379766.9375, 379771.8438, 379775.7812, 379783.8750,
        379786.6875, 379799.3125, 379802.4375, 379807.3125, 379807.9062,
        749884.5000, 750813.6250, 757558.2500, 778180.2500, 780325.4375,
        780344.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403729.1250, 403737.6250, 403739.0625, 403752.0938,
        403760.5938, 403776.7188, 403781.5000, 403789.0312, 403793.3125,
        780344.6250, 787799.6875, 788374.2500, 792198.8750, 796659.9375,
        798618.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6592e+00, 1.6960e+00, 1.6973e+00, 1.7007e+00, 1.7770e+00,
        1.8088e+00, 1.8328e+00, 2.0522e+00, 3.7979e+05, 3.8445e+05, 3.8803e+05,
        3.8830e+05, 3.8900e+05, 3.9574e+05, 4.0374e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7419e+00, 1.7542e+00, 1.7625e+00, 1.7778e+00, 1.7778e+00,
        1.7805e+00, 1.7815e+00, 1.8088e+00, 3.7980e+05, 3.8446e+05, 3.8803e+05,
        3.8832e+05, 3.8900e+05, 3.9576e+05, 4.0373e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5961e+00, 1.6129e+00, 1.6551e+00, 1.6581e+00, 1.6960e+00,
        1.7298e+00, 1.7805e+00, 1.9353e+00, 3.7978e+05, 3.8446e+05, 3.8800e+05,
        3.8831e+05, 3.8897e+05, 3.9575e+05, 4.0376e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6129e+00, 1.6252e+00, 1.6570e+00, 1.6637e+00, 1.7007e+00,
        1.7332e+00, 1.7778e+00, 2.1137e+00, 3.7977e+05, 3.8449e+05, 3.8800e+05,
        3.8827e+05, 3.8901e+05, 3.9577e+05, 4.0374e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388966.1250, 388968.4062, 388982.7500, 389000.1875,
        389002.1875, 389005.5938, 389006.0312, 389016.1562, 389022.9062,
        749884.5000, 755176.6250, 765441.9375, 786509.3125, 790444.2500,
        792198.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384423.8125, 384439.6250, 384444.1250, 384447.4062,
        384448.5625, 384455.9062, 384456.0000, 384475.6250, 384487.2500,
        752279.6250, 757558.2500, 775529.7500, 777507.0000, 786509.3125,
        796659.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6324e+00, 1.6551e+00, 1.6592e+00, 1.6637e+00, 1.7370e+00,
        1.7538e+00, 1.7542e+00, 1.9879e+00, 3.7980e+05, 3.8445e+05, 3.8802e+05,
        3.8829e+05, 3.8901e+05, 3.9572e+05, 4.0379e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.7625e+00, 1.9353e+00, 1.9879e+00, 1.9955e+00, 2.0522e+00,
        2.1137e+00, 2.1547e+00, 2.2493e+00, 3.7981e+05, 3.8448e+05, 3.8801e+05,
        3.8830e+05, 3.8898e+05, 3.9577e+05, 4.0378e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387996.0625, 387997.1250, 387998.7500, 388007.3125,
        388013.8438, 388017.6875, 388023.2812, 388030.2188, 388031.8125,
        777507.0000, 778180.2500, 786744.1250, 787799.6875, 790444.2500,
        795009.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6103e+00, 1.6570e+00, 1.6581e+00, 1.6973e+00, 1.7112e+00,
        1.7370e+00, 1.7778e+00, 2.1547e+00, 3.7977e+05, 3.8444e+05, 3.8800e+05,
        3.8829e+05, 3.8902e+05, 3.9578e+05, 4.0375e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6103e+00, 1.6252e+00, 1.7242e+00, 1.7298e+00, 1.7538e+00,
        1.7770e+00, 1.7815e+00, 2.2493e+00, 3.7978e+05, 3.8442e+05, 3.8802e+05,
        3.8829e+05, 3.8897e+05, 3.9575e+05, 4.0378e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388268.0000, 388271.5625, 388285.9375, 388288.5312,
        388293.0000, 388296.9375, 388303.1562, 388314.0938, 388317.6875,
        750813.6250, 755176.6250, 775529.7500, 775837.5000, 788374.2500,
        795009.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395723.6250, 395742.0312, 395748.3438, 395751.6250,
        395759.3750, 395770.7500, 395771.7500, 395778.2500, 395784.2188,
        752279.6250, 765441.9375, 775837.5000, 780325.4375, 786744.1250,
        798618.3750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76426.55', '416798.69', '441420.34', '76424.83', '76427.26', '76424.54', '76427.30', '425085.44', '421235.81', '76426.17', '76429.98', '426962.25', '76422.05', '76422.20', '424545.25', '431411.00']
estimated f for each client, fs: [7, 5, 5, 7, 7, 7, 7, 5, 5, 7, 7, 6, 7, 7, 5, 5]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 17, 19, 3, 4, 9, 10, 14, 18, 12, 8, 16, 2, 7, 13, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0124s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:22...
global Accuracy on shared test data: 77.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:22, End: 2025-07-22 16:01:22)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 17, 13, 12, 20, 7, 11, 1, 15, 10, 19, 2, 14, 6, 8, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0165e+05, 3.9718e+05, 1.6074e+00, 3.7399e+05, 1.6976e+00,
         1.6468e+00, 1.6785e+00, 3.9235e+05, 1.7421e+00, 3.8124e+05, 1.6440e+00,
         3.8506e+05, 1.6757e+00, 1.6785e+00, 1.6764e+00],
        [4.0165e+05, 0.0000e+00, 7.7346e+05, 4.0165e+05, 7.7977e+05, 4.0165e+05,
         4.0166e+05, 4.0168e+05, 7.7454e+05, 4.0166e+05, 7.7797e+05, 4.0166e+05,
         8.1572e+05, 4.0164e+05, 4.0167e+05, 4.0164e+05],
        [3.9718e+05, 7.7346e+05, 0.0000e+00, 3.9718e+05, 7.9175e+05, 3.9721e+05,
         3.9716e+05, 3.9716e+05, 7.9143e+05, 3.9718e+05, 7.7473e+05, 3.9717e+05,
         7.8865e+05, 3.9719e+05, 3.9720e+05, 3.9715e+05],
        [1.6074e+00, 4.0165e+05, 3.9718e+05, 0.0000e+00, 3.7399e+05, 1.6872e+00,
         1.6025e+00, 1.7594e+00, 3.9240e+05, 1.6459e+00, 3.8123e+05, 1.8448e+00,
         3.8505e+05, 1.7188e+00, 1.9348e+00, 1.6655e+00],
        [3.7399e+05, 7.7977e+05, 7.9175e+05, 3.7399e+05, 0.0000e+00, 3.7398e+05,
         3.7398e+05, 3.7398e+05, 7.6103e+05, 3.7397e+05, 7.6070e+05, 3.7399e+05,
         7.4489e+05, 3.7397e+05, 3.7402e+05, 3.7399e+05],
        [1.6976e+00, 4.0165e+05, 3.9721e+05, 1.6872e+00, 3.7398e+05, 0.0000e+00,
         1.6308e+00, 1.7366e+00, 3.9237e+05, 1.6195e+00, 3.8123e+05, 1.7213e+00,
         3.8509e+05, 1.7828e+00, 2.0830e+00, 1.6758e+00],
        [1.6468e+00, 4.0166e+05, 3.9716e+05, 1.6025e+00, 3.7398e+05, 1.6308e+00,
         0.0000e+00, 1.6992e+00, 3.9238e+05, 1.7641e+00, 3.8126e+05, 1.7846e+00,
         3.8506e+05, 1.6545e+00, 1.8962e+00, 1.6899e+00],
        [1.6785e+00, 4.0168e+05, 3.9716e+05, 1.7594e+00, 3.7398e+05, 1.7366e+00,
         1.6992e+00, 0.0000e+00, 3.9238e+05, 1.6907e+00, 3.8127e+05, 1.7475e+00,
         3.8505e+05, 1.6722e+00, 2.0259e+00, 1.6445e+00],
        [3.9235e+05, 7.7454e+05, 7.9143e+05, 3.9240e+05, 7.6103e+05, 3.9237e+05,
         3.9238e+05, 3.9238e+05, 0.0000e+00, 3.9236e+05, 7.5014e+05, 3.9236e+05,
         7.6031e+05, 3.9236e+05, 3.9237e+05, 3.9237e+05],
        [1.7421e+00, 4.0166e+05, 3.9718e+05, 1.6459e+00, 3.7397e+05, 1.6195e+00,
         1.7641e+00, 1.6907e+00, 3.9236e+05, 0.0000e+00, 3.8126e+05, 1.7492e+00,
         3.8507e+05, 1.7502e+00, 1.9424e+00, 1.6741e+00],
        [3.8124e+05, 7.7797e+05, 7.7473e+05, 3.8123e+05, 7.6070e+05, 3.8123e+05,
         3.8126e+05, 3.8127e+05, 7.5014e+05, 3.8126e+05, 0.0000e+00, 3.8125e+05,
         7.7060e+05, 3.8127e+05, 3.8128e+05, 3.8127e+05],
        [1.6440e+00, 4.0166e+05, 3.9717e+05, 1.8448e+00, 3.7399e+05, 1.7213e+00,
         1.7846e+00, 1.7475e+00, 3.9236e+05, 1.7492e+00, 3.8125e+05, 0.0000e+00,
         3.8510e+05, 1.6906e+00, 1.7783e+00, 1.7411e+00],
        [3.8506e+05, 8.1572e+05, 7.8865e+05, 3.8505e+05, 7.4489e+05, 3.8509e+05,
         3.8506e+05, 3.8505e+05, 7.6031e+05, 3.8507e+05, 7.7060e+05, 3.8510e+05,
         0.0000e+00, 3.8507e+05, 3.8503e+05, 3.8509e+05],
        [1.6757e+00, 4.0164e+05, 3.9719e+05, 1.7188e+00, 3.7397e+05, 1.7828e+00,
         1.6545e+00, 1.6722e+00, 3.9236e+05, 1.7502e+00, 3.8127e+05, 1.6906e+00,
         3.8507e+05, 0.0000e+00, 2.0344e+00, 1.6337e+00],
        [1.6785e+00, 4.0167e+05, 3.9720e+05, 1.9348e+00, 3.7402e+05, 2.0830e+00,
         1.8962e+00, 2.0259e+00, 3.9237e+05, 1.9424e+00, 3.8128e+05, 1.7783e+00,
         3.8503e+05, 2.0344e+00, 0.0000e+00, 1.8473e+00],
        [1.6764e+00, 4.0164e+05, 3.9715e+05, 1.6655e+00, 3.7399e+05, 1.6758e+00,
         1.6899e+00, 1.6445e+00, 3.9237e+05, 1.6741e+00, 3.8127e+05, 1.7411e+00,
         3.8509e+05, 1.6337e+00, 1.8473e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.6074e+00, 1.6440e+00, 1.6468e+00, 1.6757e+00, 1.6764e+00,
        1.6785e+00, 1.6785e+00, 1.6976e+00, 1.7421e+00, 3.7399e+05, 3.8124e+05,
        3.8506e+05, 3.9235e+05, 3.9718e+05, 4.0165e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401636.9375, 401643.9375, 401645.7812, 401647.6875,
        401652.2500, 401657.5000, 401659.7500, 401659.9375, 401668.6250,
        401677.7500, 773461.8125, 774537.5000, 777971.5625, 779767.5000,
        815722.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397152.7188, 397155.5938, 397158.8125, 397172.2812,
        397177.3750, 397180.1250, 397180.1250, 397189.2500, 397201.4062,
        397209.2500, 773461.8125, 774733.7500, 788653.7500, 791430.3750,
        791745.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6025e+00, 1.6074e+00, 1.6459e+00, 1.6655e+00, 1.6872e+00,
        1.7188e+00, 1.7594e+00, 1.8448e+00, 1.9348e+00, 3.7399e+05, 3.8123e+05,
        3.8505e+05, 3.9240e+05, 3.9718e+05, 4.0165e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 373966.8125, 373968.5312, 373976.9688, 373977.2500,
        373980.1875, 373985.7500, 373988.6250, 373988.8438, 373991.3125,
        374023.1250, 744888.2500, 760701.2500, 761029.3125, 779767.5000,
        791745.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6195e+00, 1.6308e+00, 1.6758e+00, 1.6872e+00, 1.6976e+00,
        1.7213e+00, 1.7366e+00, 1.7828e+00, 2.0830e+00, 3.7398e+05, 3.8123e+05,
        3.8509e+05, 3.9237e+05, 3.9721e+05, 4.0165e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6025e+00, 1.6308e+00, 1.6468e+00, 1.6545e+00, 1.6899e+00,
        1.6992e+00, 1.7641e+00, 1.7846e+00, 1.8962e+00, 3.7398e+05, 3.8126e+05,
        3.8506e+05, 3.9238e+05, 3.9716e+05, 4.0166e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6445e+00, 1.6722e+00, 1.6785e+00, 1.6907e+00, 1.6992e+00,
        1.7366e+00, 1.7475e+00, 1.7594e+00, 2.0259e+00, 3.7398e+05, 3.8127e+05,
        3.8505e+05, 3.9238e+05, 3.9716e+05, 4.0168e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392354.1875, 392358.3125, 392360.6562, 392365.0000,
        392367.1250, 392368.6250, 392372.1562, 392377.0625, 392378.6562,
        392396.0625, 750142.7500, 760311.5000, 761029.3125, 774537.5000,
        791430.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6195e+00, 1.6459e+00, 1.6741e+00, 1.6907e+00, 1.7421e+00,
        1.7492e+00, 1.7502e+00, 1.7641e+00, 1.9424e+00, 3.7397e+05, 3.8126e+05,
        3.8507e+05, 3.9236e+05, 3.9718e+05, 4.0166e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381226.7812, 381228.3438, 381243.0938, 381253.5000,
        381256.0312, 381258.5938, 381265.3750, 381265.5938, 381272.1562,
        381277.8438, 750142.7500, 760701.2500, 770601.5000, 774733.7500,
        777971.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6440e+00, 1.6906e+00, 1.7213e+00, 1.7411e+00, 1.7475e+00,
        1.7492e+00, 1.7783e+00, 1.7846e+00, 1.8448e+00, 3.7399e+05, 3.8125e+05,
        3.8510e+05, 3.9236e+05, 3.9717e+05, 4.0166e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385032.8750, 385053.2500, 385053.9062, 385058.6875,
        385062.9375, 385065.2500, 385069.1562, 385086.8750, 385094.5000,
        385096.1250, 744888.2500, 760311.5000, 770601.5000, 788653.7500,
        815722.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6337e+00, 1.6545e+00, 1.6722e+00, 1.6757e+00, 1.6906e+00,
        1.7188e+00, 1.7502e+00, 1.7828e+00, 2.0344e+00, 3.7397e+05, 3.8127e+05,
        3.8507e+05, 3.9236e+05, 3.9719e+05, 4.0164e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6785e+00, 1.7783e+00, 1.8473e+00, 1.8962e+00, 1.9348e+00,
        1.9424e+00, 2.0259e+00, 2.0344e+00, 2.0830e+00, 3.7402e+05, 3.8128e+05,
        3.8503e+05, 3.9237e+05, 3.9720e+05, 4.0167e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6337e+00, 1.6445e+00, 1.6655e+00, 1.6741e+00, 1.6758e+00,
        1.6764e+00, 1.6899e+00, 1.7411e+00, 1.8473e+00, 3.7399e+05, 3.8127e+05,
        3.8509e+05, 3.9237e+05, 3.9715e+05, 4.0164e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37400.64', '401655.03', '397177.69', '37400.41', '373984.72', '37399.59', '37399.26', '37399.27', '392369.78', '37398.24', '381254.69', '37400.46', '385067.34', '37398.41', '37404.04', '37400.10']
estimated f for each client, fs: [6, 4, 4, 6, 4, 6, 6, 6, 4, 6, 4, 6, 4, 6, 6, 6]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 17, 13, 12, 20, 7, 11, 1, 15, 10, 19, 2, 14, 6, 8, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0117s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:23...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 45 218]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:23, End: 2025-07-22 16:01:23)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [19, 15, 9, 18, 3, 2, 8, 13, 10, 5, 4, 17, 11, 12, 1, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.8189e+05, 3.9210e+05, 7.9625e+05, 3.9213e+05, 3.9211e+05,
         3.9210e+05, 8.1544e+05, 3.9212e+05, 3.9211e+05, 3.9208e+05, 7.8412e+05,
         3.9210e+05, 3.9213e+05, 3.9210e+05, 7.9694e+05],
        [7.8189e+05, 0.0000e+00, 3.9996e+05, 7.9217e+05, 3.9994e+05, 3.9995e+05,
         3.9996e+05, 7.8843e+05, 3.9996e+05, 3.9995e+05, 3.9996e+05, 8.0165e+05,
         3.9994e+05, 3.9995e+05, 3.9998e+05, 8.0855e+05],
        [3.9210e+05, 3.9996e+05, 0.0000e+00, 3.8311e+05, 1.6384e+00, 1.5968e+00,
         1.7921e+00, 4.1045e+05, 1.6902e+00, 1.6399e+00, 1.6205e+00, 3.8257e+05,
         1.6533e+00, 1.6300e+00, 1.5814e+00, 3.9620e+05],
        [7.9625e+05, 7.9217e+05, 3.8311e+05, 0.0000e+00, 3.8312e+05, 3.8313e+05,
         3.8312e+05, 8.2745e+05, 3.8311e+05, 3.8311e+05, 3.8314e+05, 7.7597e+05,
         3.8311e+05, 3.8312e+05, 3.8310e+05, 7.6954e+05],
        [3.9213e+05, 3.9994e+05, 1.6384e+00, 3.8312e+05, 0.0000e+00, 1.6139e+00,
         1.8328e+00, 4.1048e+05, 1.7470e+00, 1.5522e+00, 1.6091e+00, 3.8257e+05,
         1.7604e+00, 1.5365e+00, 1.6645e+00, 3.9616e+05],
        [3.9211e+05, 3.9995e+05, 1.5968e+00, 3.8313e+05, 1.6139e+00, 0.0000e+00,
         1.6626e+00, 4.1046e+05, 1.5830e+00, 1.6947e+00, 1.5538e+00, 3.8255e+05,
         1.7536e+00, 1.6697e+00, 1.6399e+00, 3.9618e+05],
        [3.9210e+05, 3.9996e+05, 1.7921e+00, 3.8312e+05, 1.8328e+00, 1.6626e+00,
         0.0000e+00, 4.1048e+05, 1.7455e+00, 1.9326e+00, 1.5917e+00, 3.8257e+05,
         1.9220e+00, 1.8580e+00, 1.9281e+00, 3.9622e+05],
        [8.1544e+05, 7.8843e+05, 4.1045e+05, 8.2745e+05, 4.1048e+05, 4.1046e+05,
         4.1048e+05, 0.0000e+00, 4.1041e+05, 4.1045e+05, 4.1047e+05, 7.8089e+05,
         4.1046e+05, 4.1045e+05, 4.1045e+05, 8.0458e+05],
        [3.9212e+05, 3.9996e+05, 1.6902e+00, 3.8311e+05, 1.7470e+00, 1.5830e+00,
         1.7455e+00, 4.1041e+05, 0.0000e+00, 1.7993e+00, 1.7945e+00, 3.8258e+05,
         1.9169e+00, 1.7517e+00, 1.7843e+00, 3.9619e+05],
        [3.9211e+05, 3.9995e+05, 1.6399e+00, 3.8311e+05, 1.5522e+00, 1.6947e+00,
         1.9326e+00, 4.1045e+05, 1.7993e+00, 0.0000e+00, 1.5934e+00, 3.8254e+05,
         1.5426e+00, 1.6016e+00, 1.6300e+00, 3.9624e+05],
        [3.9208e+05, 3.9996e+05, 1.6205e+00, 3.8314e+05, 1.6091e+00, 1.5538e+00,
         1.5917e+00, 4.1047e+05, 1.7945e+00, 1.5934e+00, 0.0000e+00, 3.8256e+05,
         1.5729e+00, 1.6014e+00, 1.6013e+00, 3.9622e+05],
        [7.8412e+05, 8.0165e+05, 3.8257e+05, 7.7597e+05, 3.8257e+05, 3.8255e+05,
         3.8257e+05, 7.8089e+05, 3.8258e+05, 3.8254e+05, 3.8256e+05, 0.0000e+00,
         3.8256e+05, 3.8256e+05, 3.8254e+05, 7.6775e+05],
        [3.9210e+05, 3.9994e+05, 1.6533e+00, 3.8311e+05, 1.7604e+00, 1.7536e+00,
         1.9220e+00, 4.1046e+05, 1.9169e+00, 1.5426e+00, 1.5729e+00, 3.8256e+05,
         0.0000e+00, 1.5857e+00, 1.6426e+00, 3.9621e+05],
        [3.9213e+05, 3.9995e+05, 1.6300e+00, 3.8312e+05, 1.5365e+00, 1.6697e+00,
         1.8580e+00, 4.1045e+05, 1.7517e+00, 1.6016e+00, 1.6014e+00, 3.8256e+05,
         1.5857e+00, 0.0000e+00, 1.7134e+00, 3.9621e+05],
        [3.9210e+05, 3.9998e+05, 1.5814e+00, 3.8310e+05, 1.6645e+00, 1.6399e+00,
         1.9281e+00, 4.1045e+05, 1.7843e+00, 1.6300e+00, 1.6013e+00, 3.8254e+05,
         1.6426e+00, 1.7134e+00, 0.0000e+00, 3.9621e+05],
        [7.9694e+05, 8.0855e+05, 3.9620e+05, 7.6954e+05, 3.9616e+05, 3.9618e+05,
         3.9622e+05, 8.0458e+05, 3.9619e+05, 3.9624e+05, 3.9622e+05, 7.6775e+05,
         3.9621e+05, 3.9621e+05, 3.9621e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 392083.7812, 392101.0000, 392101.8125, 392102.2500,
        392104.6875, 392109.9375, 392114.7188, 392118.7812, 392131.0000,
        392131.7500, 781890.8750, 784120.4375, 796247.9375, 796941.1875,
        815436.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399942.0000, 399942.5312, 399945.9688, 399949.2500,
        399951.7188, 399956.5625, 399961.8750, 399963.5625, 399963.9062,
        399975.8438, 781890.8750, 788434.3750, 792165.5000, 801648.0000,
        808554.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5814e+00, 1.5968e+00, 1.6205e+00, 1.6300e+00, 1.6384e+00,
        1.6399e+00, 1.6533e+00, 1.6902e+00, 1.7921e+00, 3.8257e+05, 3.8311e+05,
        3.9210e+05, 3.9620e+05, 3.9996e+05, 4.1045e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383103.9062, 383108.2188, 383109.5312, 383110.8125,
        383114.0625, 383119.3438, 383120.9375, 383123.2812, 383127.5625,
        383135.4375, 769537.6250, 775968.1875, 792165.5000, 796247.9375,
        827449.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5365e+00, 1.5522e+00, 1.6091e+00, 1.6139e+00, 1.6384e+00,
        1.6645e+00, 1.7470e+00, 1.7604e+00, 1.8328e+00, 3.8257e+05, 3.8312e+05,
        3.9213e+05, 3.9616e+05, 3.9994e+05, 4.1048e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5538e+00, 1.5830e+00, 1.5968e+00, 1.6139e+00, 1.6399e+00,
        1.6626e+00, 1.6697e+00, 1.6947e+00, 1.7536e+00, 3.8255e+05, 3.8313e+05,
        3.9211e+05, 3.9618e+05, 3.9995e+05, 4.1046e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5917e+00, 1.6626e+00, 1.7455e+00, 1.7921e+00, 1.8328e+00,
        1.8580e+00, 1.9220e+00, 1.9281e+00, 1.9326e+00, 3.8257e+05, 3.8312e+05,
        3.9210e+05, 3.9622e+05, 3.9996e+05, 4.1048e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 410406.2812, 410445.1250, 410449.1875, 410450.3125,
        410454.9375, 410455.0625, 410461.5625, 410469.6562, 410477.9062,
        410482.1250, 780887.0000, 788434.3750, 804576.0625, 815436.7500,
        827449.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5830e+00, 1.6902e+00, 1.7455e+00, 1.7470e+00, 1.7517e+00,
        1.7843e+00, 1.7945e+00, 1.7993e+00, 1.9169e+00, 3.8258e+05, 3.8311e+05,
        3.9212e+05, 3.9619e+05, 3.9996e+05, 4.1041e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5426e+00, 1.5522e+00, 1.5934e+00, 1.6016e+00, 1.6300e+00,
        1.6399e+00, 1.6947e+00, 1.7993e+00, 1.9326e+00, 3.8254e+05, 3.8311e+05,
        3.9211e+05, 3.9624e+05, 3.9995e+05, 4.1045e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5538e+00, 1.5729e+00, 1.5917e+00, 1.5934e+00, 1.6013e+00,
        1.6014e+00, 1.6091e+00, 1.6205e+00, 1.7945e+00, 3.8256e+05, 3.8314e+05,
        3.9208e+05, 3.9622e+05, 3.9996e+05, 4.1047e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382537.5312, 382538.7500, 382548.8750, 382555.4375,
        382556.6250, 382562.3125, 382566.4375, 382568.7188, 382569.6250,
        382581.1562, 767746.2500, 775968.1875, 780887.0000, 784120.4375,
        801648.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5426e+00, 1.5729e+00, 1.5857e+00, 1.6426e+00, 1.6533e+00,
        1.7536e+00, 1.7604e+00, 1.9169e+00, 1.9220e+00, 3.8256e+05, 3.8311e+05,
        3.9210e+05, 3.9621e+05, 3.9994e+05, 4.1046e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5365e+00, 1.5857e+00, 1.6014e+00, 1.6016e+00, 1.6300e+00,
        1.6697e+00, 1.7134e+00, 1.7517e+00, 1.8580e+00, 3.8256e+05, 3.8312e+05,
        3.9213e+05, 3.9621e+05, 3.9995e+05, 4.1045e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5814e+00, 1.6013e+00, 1.6300e+00, 1.6399e+00, 1.6426e+00,
        1.6645e+00, 1.7134e+00, 1.7843e+00, 1.9281e+00, 3.8254e+05, 3.8310e+05,
        3.9210e+05, 3.9621e+05, 3.9998e+05, 4.1045e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396158.0312, 396182.7500, 396189.5312, 396196.3125,
        396209.8125, 396213.6875, 396214.3125, 396222.2188, 396222.3438,
        396236.6875, 767746.2500, 769537.6250, 796941.1875, 804576.0625,
        808554.8750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['392109.97', '399955.31', '38258.45', '383117.31', '38258.14', '38256.36', '38258.50', '410455.19', '38259.70', '38255.25', '38257.68', '382558.56', '38257.20', '38257.04', '38255.39', '396204.56']
estimated f for each client, fs: [4, 4, 6, 5, 6, 6, 6, 4, 6, 6, 6, 5, 6, 6, 6, 4]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [19, 15, 9, 18, 3, 2, 8, 13, 10, 5, 4, 17, 11, 12, 1, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0111s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:24...
global Accuracy on shared test data: 78.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:24, End: 2025-07-22 16:01:24)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 7, 15, 11, 2, 9, 6, 8, 14, 1, 18, 3, 13, 16, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7841e+05, 7.8227e+05, 3.7841e+05, 3.7843e+05, 3.7841e+05,
         3.7840e+05, 3.7842e+05, 7.6167e+05, 3.7841e+05, 7.8811e+05, 3.7843e+05,
         7.6753e+05, 7.5980e+05, 3.7840e+05, 7.6144e+05],
        [3.7841e+05, 0.0000e+00, 3.9377e+05, 1.5671e+00, 1.5406e+00, 1.5830e+00,
         1.6668e+00, 1.8777e+00, 3.7509e+05, 1.5951e+00, 3.9034e+05, 1.6329e+00,
         3.8914e+05, 3.8258e+05, 1.6429e+00, 3.7614e+05],
        [7.8227e+05, 3.9377e+05, 0.0000e+00, 3.9373e+05, 3.9376e+05, 3.9375e+05,
         3.9373e+05, 3.9374e+05, 7.6120e+05, 3.9375e+05, 8.0311e+05, 3.9374e+05,
         7.6540e+05, 7.7078e+05, 3.9378e+05, 7.7542e+05],
        [3.7841e+05, 1.5671e+00, 3.9373e+05, 0.0000e+00, 1.6853e+00, 1.6010e+00,
         1.6612e+00, 1.8772e+00, 3.7510e+05, 1.6513e+00, 3.9037e+05, 1.8279e+00,
         3.8915e+05, 3.8257e+05, 1.8106e+00, 3.7618e+05],
        [3.7843e+05, 1.5406e+00, 3.9376e+05, 1.6853e+00, 0.0000e+00, 1.5470e+00,
         1.5919e+00, 1.6421e+00, 3.7510e+05, 1.5888e+00, 3.9032e+05, 1.5936e+00,
         3.8913e+05, 3.8258e+05, 1.5042e+00, 3.7616e+05],
        [3.7841e+05, 1.5830e+00, 3.9375e+05, 1.6010e+00, 1.5470e+00, 0.0000e+00,
         1.5155e+00, 1.7488e+00, 3.7510e+05, 1.5463e+00, 3.9034e+05, 1.5516e+00,
         3.8911e+05, 3.8260e+05, 1.5575e+00, 3.7614e+05],
        [3.7840e+05, 1.6668e+00, 3.9373e+05, 1.6612e+00, 1.5919e+00, 1.5155e+00,
         0.0000e+00, 1.9094e+00, 3.7510e+05, 1.5186e+00, 3.9035e+05, 1.7186e+00,
         3.8909e+05, 3.8258e+05, 1.7439e+00, 3.7615e+05],
        [3.7842e+05, 1.8777e+00, 3.9374e+05, 1.8772e+00, 1.6421e+00, 1.7488e+00,
         1.9094e+00, 0.0000e+00, 3.7511e+05, 1.8662e+00, 3.9033e+05, 1.7991e+00,
         3.8911e+05, 3.8258e+05, 1.6405e+00, 3.7617e+05],
        [7.6167e+05, 3.7509e+05, 7.6120e+05, 3.7510e+05, 3.7510e+05, 3.7510e+05,
         3.7510e+05, 3.7511e+05, 0.0000e+00, 3.7512e+05, 7.6666e+05, 3.7508e+05,
         7.6554e+05, 7.6082e+05, 3.7515e+05, 7.3717e+05],
        [3.7841e+05, 1.5951e+00, 3.9375e+05, 1.6513e+00, 1.5888e+00, 1.5463e+00,
         1.5186e+00, 1.8662e+00, 3.7512e+05, 0.0000e+00, 3.9032e+05, 1.6773e+00,
         3.8914e+05, 3.8256e+05, 1.7002e+00, 3.7617e+05],
        [7.8811e+05, 3.9034e+05, 8.0311e+05, 3.9037e+05, 3.9032e+05, 3.9034e+05,
         3.9035e+05, 3.9033e+05, 7.6666e+05, 3.9032e+05, 0.0000e+00, 3.9035e+05,
         7.6435e+05, 7.6457e+05, 3.9032e+05, 7.7247e+05],
        [3.7843e+05, 1.6329e+00, 3.9374e+05, 1.8279e+00, 1.5936e+00, 1.5516e+00,
         1.7186e+00, 1.7991e+00, 3.7508e+05, 1.6773e+00, 3.9035e+05, 0.0000e+00,
         3.8909e+05, 3.8259e+05, 1.6239e+00, 3.7613e+05],
        [7.6753e+05, 3.8914e+05, 7.6540e+05, 3.8915e+05, 3.8913e+05, 3.8911e+05,
         3.8909e+05, 3.8911e+05, 7.6554e+05, 3.8914e+05, 7.6435e+05, 3.8909e+05,
         0.0000e+00, 7.8184e+05, 3.8913e+05, 7.7847e+05],
        [7.5980e+05, 3.8258e+05, 7.7078e+05, 3.8257e+05, 3.8258e+05, 3.8260e+05,
         3.8258e+05, 3.8258e+05, 7.6082e+05, 3.8256e+05, 7.6457e+05, 3.8259e+05,
         7.8184e+05, 0.0000e+00, 3.8257e+05, 7.6659e+05],
        [3.7840e+05, 1.6429e+00, 3.9378e+05, 1.8106e+00, 1.5042e+00, 1.5575e+00,
         1.7439e+00, 1.6405e+00, 3.7515e+05, 1.7002e+00, 3.9032e+05, 1.6239e+00,
         3.8913e+05, 3.8257e+05, 0.0000e+00, 3.7616e+05],
        [7.6144e+05, 3.7614e+05, 7.7542e+05, 3.7618e+05, 3.7616e+05, 3.7614e+05,
         3.7615e+05, 3.7617e+05, 7.3717e+05, 3.7617e+05, 7.7247e+05, 3.7613e+05,
         7.7847e+05, 7.6659e+05, 3.7616e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 378395.4688, 378400.3750, 378406.5000, 378407.1562,
        378408.5000, 378412.9375, 378424.1875, 378427.0000, 378430.7500,
        759801.2500, 761438.2500, 761667.1875, 767528.0000, 782267.8750,
        788114.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5406e+00, 1.5671e+00, 1.5830e+00, 1.5951e+00, 1.6329e+00,
        1.6429e+00, 1.6668e+00, 1.8777e+00, 3.7509e+05, 3.7614e+05, 3.7841e+05,
        3.8258e+05, 3.8914e+05, 3.9034e+05, 3.9377e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393731.3750, 393732.0312, 393738.2812, 393742.3750,
        393750.5938, 393753.7500, 393756.8750, 393765.9688, 393777.2188,
        761195.8125, 765401.3125, 770776.2500, 775424.6250, 782267.8750,
        803110.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5671e+00, 1.6010e+00, 1.6513e+00, 1.6612e+00, 1.6853e+00,
        1.8106e+00, 1.8279e+00, 1.8772e+00, 3.7510e+05, 3.7618e+05, 3.7841e+05,
        3.8257e+05, 3.8915e+05, 3.9037e+05, 3.9373e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5042e+00, 1.5406e+00, 1.5470e+00, 1.5888e+00, 1.5919e+00,
        1.5936e+00, 1.6421e+00, 1.6853e+00, 3.7510e+05, 3.7616e+05, 3.7843e+05,
        3.8258e+05, 3.8913e+05, 3.9032e+05, 3.9376e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5155e+00, 1.5463e+00, 1.5470e+00, 1.5516e+00, 1.5575e+00,
        1.5830e+00, 1.6010e+00, 1.7488e+00, 3.7510e+05, 3.7614e+05, 3.7841e+05,
        3.8260e+05, 3.8911e+05, 3.9034e+05, 3.9375e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5155e+00, 1.5186e+00, 1.5919e+00, 1.6612e+00, 1.6668e+00,
        1.7186e+00, 1.7439e+00, 1.9094e+00, 3.7510e+05, 3.7615e+05, 3.7840e+05,
        3.8258e+05, 3.8909e+05, 3.9035e+05, 3.9373e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6405e+00, 1.6421e+00, 1.7488e+00, 1.7991e+00, 1.8662e+00,
        1.8772e+00, 1.8777e+00, 1.9094e+00, 3.7511e+05, 3.7617e+05, 3.7842e+05,
        3.8258e+05, 3.8911e+05, 3.9033e+05, 3.9374e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 375083.5938, 375086.7812, 375098.5625, 375099.5312,
        375103.6875, 375104.2812, 375107.3125, 375121.3438, 375147.3750,
        737174.8125, 760817.1875, 761195.8125, 761667.1875, 765540.2500,
        766656.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5186e+00, 1.5463e+00, 1.5888e+00, 1.5951e+00, 1.6513e+00,
        1.6773e+00, 1.7002e+00, 1.8662e+00, 3.7512e+05, 3.7617e+05, 3.7841e+05,
        3.8256e+05, 3.8914e+05, 3.9032e+05, 3.9375e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390317.5000, 390319.1875, 390323.9688, 390327.8750,
        390335.0312, 390339.0312, 390346.8750, 390353.3438, 390368.2188,
        764354.8125, 764570.7500, 766656.8750, 772472.3750, 788114.0000,
        803110.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5516e+00, 1.5936e+00, 1.6239e+00, 1.6329e+00, 1.6773e+00,
        1.7186e+00, 1.7991e+00, 1.8279e+00, 3.7508e+05, 3.7613e+05, 3.7843e+05,
        3.8259e+05, 3.8909e+05, 3.9035e+05, 3.9374e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389089.6250, 389090.7500, 389109.4375, 389110.0938,
        389127.5625, 389127.5938, 389135.3125, 389137.4688, 389150.9688,
        764354.8125, 765401.3125, 765540.2500, 767528.0000, 778467.1250,
        781839.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382557.9688, 382567.9375, 382573.1875, 382579.4375,
        382579.6250, 382581.5312, 382583.7812, 382593.7812, 382603.4375,
        759801.2500, 760817.1875, 764570.7500, 766593.6250, 770776.2500,
        781839.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5042e+00, 1.5575e+00, 1.6239e+00, 1.6405e+00, 1.6429e+00,
        1.7002e+00, 1.7439e+00, 1.8106e+00, 3.7515e+05, 3.7616e+05, 3.7840e+05,
        3.8257e+05, 3.8913e+05, 3.9032e+05, 3.9378e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376127.7812, 376136.1875, 376138.9688, 376153.3125,
        376160.8750, 376164.3125, 376166.6562, 376170.2812, 376175.4062,
        737174.8125, 761438.2500, 766593.6250, 772472.3750, 775424.6250,
        778467.1250])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['416551.44', '75123.61', '430494.41', '75129.28', '75127.20', '75125.12', '75127.09', '75129.20', '411312.72', '75130.11', '427738.59', '75122.48', '426643.31', '420302.19', '75132.48', '412256.88']
estimated f for each client, fs: [6, 7, 5, 7, 7, 7, 7, 7, 5, 7, 5, 7, 5, 5, 7, 5]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 7, 15, 11, 2, 9, 6, 8, 14, 1, 18, 3, 13, 16, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0130s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:24...
global Accuracy on shared test data: 78.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:24, End: 2025-07-22 16:01:24)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 1, 17, 6, 7, 15, 9, 19, 3, 18, 13, 2, 20, 14, 16, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6256e+00, 3.8095e+05, 1.6786e+00, 1.5691e+00, 3.7689e+05,
         1.5278e+00, 3.8710e+05, 1.5913e+00, 3.9814e+05, 3.8780e+05, 1.3991e+00,
         4.0494e+05, 3.8663e+05, 3.8705e+05, 1.5646e+00],
        [1.6256e+00, 0.0000e+00, 3.8092e+05, 1.4733e+00, 1.5354e+00, 3.7688e+05,
         1.5101e+00, 3.8712e+05, 1.8418e+00, 3.9818e+05, 3.8784e+05, 1.5190e+00,
         4.0491e+05, 3.8665e+05, 3.8702e+05, 1.6057e+00],
        [3.8095e+05, 3.8092e+05, 0.0000e+00, 3.8094e+05, 3.8093e+05, 7.4908e+05,
         3.8092e+05, 7.5031e+05, 3.8091e+05, 7.6673e+05, 7.8443e+05, 3.8094e+05,
         7.7997e+05, 7.6117e+05, 7.6447e+05, 3.8090e+05],
        [1.6786e+00, 1.4733e+00, 3.8094e+05, 0.0000e+00, 1.6022e+00, 3.7690e+05,
         1.4914e+00, 3.8707e+05, 2.0093e+00, 3.9817e+05, 3.8785e+05, 1.5287e+00,
         4.0493e+05, 3.8660e+05, 3.8705e+05, 1.6305e+00],
        [1.5691e+00, 1.5354e+00, 3.8093e+05, 1.6022e+00, 0.0000e+00, 3.7690e+05,
         1.5797e+00, 3.8709e+05, 1.8821e+00, 3.9813e+05, 3.8782e+05, 1.4908e+00,
         4.0493e+05, 3.8662e+05, 3.8703e+05, 1.5561e+00],
        [3.7689e+05, 3.7688e+05, 7.4908e+05, 3.7690e+05, 3.7690e+05, 0.0000e+00,
         3.7686e+05, 7.5831e+05, 3.7687e+05, 7.7084e+05, 7.4699e+05, 3.7682e+05,
         8.0938e+05, 7.5876e+05, 7.3398e+05, 3.7686e+05],
        [1.5278e+00, 1.5101e+00, 3.8092e+05, 1.4914e+00, 1.5797e+00, 3.7686e+05,
         0.0000e+00, 3.8711e+05, 1.8087e+00, 3.9818e+05, 3.8783e+05, 1.5484e+00,
         4.0492e+05, 3.8665e+05, 3.8700e+05, 1.6248e+00],
        [3.8710e+05, 3.8712e+05, 7.5031e+05, 3.8707e+05, 3.8709e+05, 7.5831e+05,
         3.8711e+05, 0.0000e+00, 3.8710e+05, 7.5041e+05, 7.7152e+05, 3.8711e+05,
         8.1660e+05, 7.8578e+05, 7.6070e+05, 3.8711e+05],
        [1.5913e+00, 1.8418e+00, 3.8091e+05, 2.0093e+00, 1.8821e+00, 3.7687e+05,
         1.8087e+00, 3.8710e+05, 0.0000e+00, 3.9813e+05, 3.8780e+05, 1.6791e+00,
         4.0493e+05, 3.8665e+05, 3.8704e+05, 1.7567e+00],
        [3.9814e+05, 3.9818e+05, 7.6673e+05, 3.9817e+05, 3.9813e+05, 7.7084e+05,
         3.9818e+05, 7.5041e+05, 3.9813e+05, 0.0000e+00, 7.8695e+05, 3.9815e+05,
         8.1478e+05, 7.7282e+05, 7.7526e+05, 3.9817e+05],
        [3.8780e+05, 3.8784e+05, 7.8443e+05, 3.8785e+05, 3.8782e+05, 7.4699e+05,
         3.8783e+05, 7.7152e+05, 3.8780e+05, 7.8695e+05, 0.0000e+00, 3.8782e+05,
         7.9436e+05, 7.7458e+05, 7.6421e+05, 3.8780e+05],
        [1.3991e+00, 1.5190e+00, 3.8094e+05, 1.5287e+00, 1.4908e+00, 3.7682e+05,
         1.5484e+00, 3.8711e+05, 1.6791e+00, 3.9815e+05, 3.8782e+05, 0.0000e+00,
         4.0494e+05, 3.8661e+05, 3.8702e+05, 1.5920e+00],
        [4.0494e+05, 4.0491e+05, 7.7997e+05, 4.0493e+05, 4.0493e+05, 8.0938e+05,
         4.0492e+05, 8.1660e+05, 4.0493e+05, 8.1478e+05, 7.9436e+05, 4.0494e+05,
         0.0000e+00, 8.1405e+05, 7.7342e+05, 4.0489e+05],
        [3.8663e+05, 3.8665e+05, 7.6117e+05, 3.8660e+05, 3.8662e+05, 7.5876e+05,
         3.8665e+05, 7.8578e+05, 3.8665e+05, 7.7282e+05, 7.7458e+05, 3.8661e+05,
         8.1405e+05, 0.0000e+00, 7.6984e+05, 3.8660e+05],
        [3.8705e+05, 3.8702e+05, 7.6447e+05, 3.8705e+05, 3.8703e+05, 7.3398e+05,
         3.8700e+05, 7.6070e+05, 3.8704e+05, 7.7526e+05, 7.6421e+05, 3.8702e+05,
         7.7342e+05, 7.6984e+05, 0.0000e+00, 3.8704e+05],
        [1.5646e+00, 1.6057e+00, 3.8090e+05, 1.6305e+00, 1.5561e+00, 3.7686e+05,
         1.6248e+00, 3.8711e+05, 1.7567e+00, 3.9817e+05, 3.8780e+05, 1.5920e+00,
         4.0489e+05, 3.8660e+05, 3.8704e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3991e+00, 1.5278e+00, 1.5646e+00, 1.5691e+00, 1.5913e+00,
        1.6256e+00, 1.6786e+00, 3.7689e+05, 3.8095e+05, 3.8663e+05, 3.8705e+05,
        3.8710e+05, 3.8780e+05, 3.9814e+05, 4.0494e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4733e+00, 1.5101e+00, 1.5190e+00, 1.5354e+00, 1.6057e+00,
        1.6256e+00, 1.8418e+00, 3.7688e+05, 3.8092e+05, 3.8665e+05, 3.8702e+05,
        3.8712e+05, 3.8784e+05, 3.9818e+05, 4.0491e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380904.1250, 380911.7500, 380918.3438, 380924.4375,
        380929.0625, 380942.4375, 380943.8750, 380950.7500, 749084.8125,
        750307.2500, 761172.7500, 764474.5000, 766726.1875, 779972.7500,
        784429.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4733e+00, 1.4914e+00, 1.5287e+00, 1.6022e+00, 1.6305e+00,
        1.6786e+00, 2.0093e+00, 3.7690e+05, 3.8094e+05, 3.8660e+05, 3.8705e+05,
        3.8707e+05, 3.8785e+05, 3.9817e+05, 4.0493e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4908e+00, 1.5354e+00, 1.5561e+00, 1.5691e+00, 1.5797e+00,
        1.6022e+00, 1.8821e+00, 3.7690e+05, 3.8093e+05, 3.8662e+05, 3.8703e+05,
        3.8709e+05, 3.8782e+05, 3.9813e+05, 4.0493e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376824.1875, 376858.0000, 376860.0625, 376874.7188,
        376884.5938, 376887.2500, 376897.9375, 376898.5938, 733980.6875,
        746990.5625, 749084.8125, 758305.2500, 758755.5625, 770842.6875,
        809375.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4914e+00, 1.5101e+00, 1.5278e+00, 1.5484e+00, 1.5797e+00,
        1.6248e+00, 1.8087e+00, 3.7686e+05, 3.8092e+05, 3.8665e+05, 3.8700e+05,
        3.8711e+05, 3.8783e+05, 3.9818e+05, 4.0492e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387066.4688, 387093.3750, 387099.9062, 387103.3750,
        387106.2500, 387107.3750, 387111.0000, 387118.9688, 750307.2500,
        750414.7500, 758305.2500, 760696.5625, 771518.0000, 785784.1875,
        816604.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5913e+00, 1.6791e+00, 1.7567e+00, 1.8087e+00, 1.8418e+00,
        1.8821e+00, 2.0093e+00, 3.7687e+05, 3.8091e+05, 3.8665e+05, 3.8704e+05,
        3.8710e+05, 3.8780e+05, 3.9813e+05, 4.0493e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398133.5312, 398134.5000, 398140.1562, 398147.2500,
        398167.9375, 398173.5312, 398175.3750, 398182.1875, 750414.7500,
        766726.1875, 770842.6875, 772824.8750, 775260.7500, 786951.8125,
        814776.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387797.1250, 387798.1562, 387800.4375, 387816.5000,
        387824.0000, 387827.4062, 387838.9375, 387849.5625, 746990.5625,
        764213.8125, 771518.0000, 774578.5000, 784429.5625, 786951.8125,
        794359.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3991e+00, 1.4908e+00, 1.5190e+00, 1.5287e+00, 1.5484e+00,
        1.5920e+00, 1.6791e+00, 3.7682e+05, 3.8094e+05, 3.8661e+05, 3.8702e+05,
        3.8711e+05, 3.8782e+05, 3.9815e+05, 4.0494e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404891.8750, 404906.9688, 404920.7500, 404925.3750,
        404930.2500, 404932.6875, 404935.7188, 404939.0938, 773418.0000,
        779972.7500, 794359.3750, 809375.9375, 814046.8125, 814776.6250,
        816604.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386596.6562, 386596.7500, 386614.3750, 386619.8750,
        386633.3750, 386648.3438, 386649.9375, 386652.8438, 758755.5625,
        761172.7500, 769842.2500, 772824.8750, 774578.5000, 785784.1875,
        814046.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387000.9062, 387017.3438, 387018.2812, 387029.1250,
        387042.0938, 387042.4688, 387045.1875, 387046.4062, 733980.6875,
        760696.5625, 764213.8125, 764474.5000, 769842.2500, 773418.0000,
        775260.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5561e+00, 1.5646e+00, 1.5920e+00, 1.6057e+00, 1.6248e+00,
        1.6305e+00, 1.7567e+00, 3.7686e+05, 3.8090e+05, 3.8660e+05, 3.8704e+05,
        3.8711e+05, 3.8780e+05, 3.9817e+05, 4.0489e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['114448.23', '114446.85', '454681.69', '114445.06', '114445.81', '449595.66', '114444.23', '459752.91', '114444.89', '470239.56', '461375.66', '114439.17', '479277.31', '461294.06', '459091.91', '114437.00']
estimated f for each client, fs: [8, 8, 5, 8, 8, 5, 8, 5, 8, 5, 5, 8, 5, 5, 5, 8]
selected_index: 15
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [10, 1, 17, 6, 7, 15, 9, 19, 3, 18, 13, 2, 20, 14, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0119s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:25...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:25, End: 2025-07-22 16:01:25)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 20, 16, 2, 9, 17, 4, 5, 15, 19, 10, 13, 3, 11, 12, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0483e+05, 4.0436e+05, 1.6127e+00, 1.5519e+00, 4.1019e+05,
         1.5918e+00, 1.7487e+00, 3.8512e+05, 3.7783e+05, 1.6978e+00, 3.8015e+05,
         1.7843e+00, 1.6399e+00, 1.7381e+00, 3.9465e+05],
        [4.0483e+05, 0.0000e+00, 8.0918e+05, 4.0483e+05, 4.0484e+05, 8.2266e+05,
         4.0483e+05, 4.0482e+05, 7.8594e+05, 7.8558e+05, 4.0484e+05, 8.1314e+05,
         4.0484e+05, 4.0481e+05, 4.0484e+05, 8.0122e+05],
        [4.0436e+05, 8.0918e+05, 0.0000e+00, 4.0433e+05, 4.0437e+05, 8.3490e+05,
         4.0434e+05, 4.0435e+05, 7.8438e+05, 7.8415e+05, 4.0433e+05, 7.8248e+05,
         4.0435e+05, 4.0434e+05, 4.0435e+05, 8.0864e+05],
        [1.6127e+00, 4.0483e+05, 4.0433e+05, 0.0000e+00, 1.5609e+00, 4.1019e+05,
         1.5590e+00, 1.7483e+00, 3.8511e+05, 3.7784e+05, 1.4699e+00, 3.8020e+05,
         1.6417e+00, 1.6052e+00, 1.6411e+00, 3.9464e+05],
        [1.5519e+00, 4.0484e+05, 4.0437e+05, 1.5609e+00, 0.0000e+00, 4.1022e+05,
         1.7053e+00, 1.7603e+00, 3.8515e+05, 3.7784e+05, 1.5718e+00, 3.8019e+05,
         1.7692e+00, 1.5961e+00, 1.6828e+00, 3.9465e+05],
        [4.1019e+05, 8.2266e+05, 8.3490e+05, 4.1019e+05, 4.1022e+05, 0.0000e+00,
         4.1022e+05, 4.1019e+05, 8.0196e+05, 8.0096e+05, 4.1019e+05, 7.7847e+05,
         4.1017e+05, 4.1020e+05, 4.1020e+05, 8.2634e+05],
        [1.5918e+00, 4.0483e+05, 4.0434e+05, 1.5590e+00, 1.7053e+00, 4.1022e+05,
         0.0000e+00, 1.6407e+00, 3.8513e+05, 3.7780e+05, 1.6872e+00, 3.8018e+05,
         1.6963e+00, 1.5400e+00, 1.6250e+00, 3.9465e+05],
        [1.7487e+00, 4.0482e+05, 4.0435e+05, 1.7483e+00, 1.7603e+00, 4.1019e+05,
         1.6407e+00, 0.0000e+00, 3.8514e+05, 3.7784e+05, 1.6635e+00, 3.8020e+05,
         1.6111e+00, 1.6407e+00, 1.6074e+00, 3.9464e+05],
        [3.8512e+05, 7.8594e+05, 7.8438e+05, 3.8511e+05, 3.8515e+05, 8.0196e+05,
         3.8513e+05, 3.8514e+05, 0.0000e+00, 7.7628e+05, 3.8513e+05, 7.6765e+05,
         3.8512e+05, 3.8513e+05, 3.8512e+05, 7.7425e+05],
        [3.7783e+05, 7.8558e+05, 7.8415e+05, 3.7784e+05, 3.7784e+05, 8.0096e+05,
         3.7780e+05, 3.7784e+05, 7.7628e+05, 0.0000e+00, 3.7781e+05, 7.5796e+05,
         3.7781e+05, 3.7780e+05, 3.7784e+05, 7.7169e+05],
        [1.6978e+00, 4.0484e+05, 4.0433e+05, 1.4699e+00, 1.5718e+00, 4.1019e+05,
         1.6872e+00, 1.6635e+00, 3.8513e+05, 3.7781e+05, 0.0000e+00, 3.8017e+05,
         1.6208e+00, 1.6715e+00, 1.5961e+00, 3.9470e+05],
        [3.8015e+05, 8.1314e+05, 7.8248e+05, 3.8020e+05, 3.8019e+05, 7.7847e+05,
         3.8018e+05, 3.8020e+05, 7.6765e+05, 7.5796e+05, 3.8017e+05, 0.0000e+00,
         3.8018e+05, 3.8023e+05, 3.8021e+05, 7.9354e+05],
        [1.7843e+00, 4.0484e+05, 4.0435e+05, 1.6417e+00, 1.7692e+00, 4.1017e+05,
         1.6963e+00, 1.6111e+00, 3.8512e+05, 3.7781e+05, 1.6208e+00, 3.8018e+05,
         0.0000e+00, 1.8995e+00, 1.5643e+00, 3.9463e+05],
        [1.6399e+00, 4.0481e+05, 4.0434e+05, 1.6052e+00, 1.5961e+00, 4.1020e+05,
         1.5400e+00, 1.6407e+00, 3.8513e+05, 3.7780e+05, 1.6715e+00, 3.8023e+05,
         1.8995e+00, 0.0000e+00, 1.6802e+00, 3.9465e+05],
        [1.7381e+00, 4.0484e+05, 4.0435e+05, 1.6411e+00, 1.6828e+00, 4.1020e+05,
         1.6250e+00, 1.6074e+00, 3.8512e+05, 3.7784e+05, 1.5961e+00, 3.8021e+05,
         1.5643e+00, 1.6802e+00, 0.0000e+00, 3.9465e+05],
        [3.9465e+05, 8.0122e+05, 8.0864e+05, 3.9464e+05, 3.9465e+05, 8.2634e+05,
         3.9465e+05, 3.9464e+05, 7.7425e+05, 7.7169e+05, 3.9470e+05, 7.9354e+05,
         3.9463e+05, 3.9465e+05, 3.9465e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.5519e+00, 1.5918e+00, 1.6127e+00, 1.6399e+00, 1.6978e+00,
        1.7381e+00, 1.7487e+00, 1.7843e+00, 3.7783e+05, 3.8015e+05, 3.8512e+05,
        3.9465e+05, 4.0436e+05, 4.0483e+05, 4.1019e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404814.3125, 404821.0938, 404826.0000, 404826.6875,
        404826.7188, 404839.1250, 404840.0625, 404840.7500, 404842.0312,
        785575.5625, 785937.0625, 801219.6250, 809178.8750, 813144.6250,
        822656.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404329.4062, 404333.0312, 404336.2188, 404343.5000,
        404349.5625, 404350.4375, 404353.0312, 404364.7500, 404366.2812,
        782483.5000, 784147.3125, 784383.5000, 808643.9375, 809178.8750,
        834901.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4699e+00, 1.5590e+00, 1.5609e+00, 1.6052e+00, 1.6127e+00,
        1.6411e+00, 1.6417e+00, 1.7483e+00, 3.7784e+05, 3.8020e+05, 3.8511e+05,
        3.9464e+05, 4.0433e+05, 4.0483e+05, 4.1019e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5519e+00, 1.5609e+00, 1.5718e+00, 1.5961e+00, 1.6828e+00,
        1.7053e+00, 1.7603e+00, 1.7692e+00, 3.7784e+05, 3.8019e+05, 3.8515e+05,
        3.9465e+05, 4.0437e+05, 4.0484e+05, 4.1022e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 410172.7812, 410185.7812, 410190.2500, 410191.6250,
        410192.7188, 410199.0312, 410203.0312, 410218.0000, 410218.6250,
        778467.2500, 800964.1875, 801957.5625, 822656.7500, 826341.8125,
        834901.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5400e+00, 1.5590e+00, 1.5918e+00, 1.6250e+00, 1.6407e+00,
        1.6872e+00, 1.6963e+00, 1.7053e+00, 3.7780e+05, 3.8018e+05, 3.8513e+05,
        3.9465e+05, 4.0434e+05, 4.0483e+05, 4.1022e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.6074e+00, 1.6111e+00, 1.6407e+00, 1.6407e+00, 1.6635e+00,
        1.7483e+00, 1.7487e+00, 1.7603e+00, 3.7784e+05, 3.8020e+05, 3.8514e+05,
        3.9464e+05, 4.0435e+05, 4.0482e+05, 4.1019e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385114.6875, 385117.0000, 385119.6250, 385123.8438,
        385132.6875, 385134.2500, 385134.7188, 385138.1250, 385152.2500,
        767652.9375, 774254.6250, 776284.6250, 784383.5000, 785937.0625,
        801957.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377796.2500, 377798.1875, 377808.8750, 377812.5312,
        377832.0625, 377838.3125, 377842.5625, 377843.6250, 377844.8125,
        757961.7500, 771689.3125, 776284.6250, 784147.3125, 785575.5625,
        800964.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4699e+00, 1.5718e+00, 1.5961e+00, 1.6208e+00, 1.6635e+00,
        1.6715e+00, 1.6872e+00, 1.6978e+00, 3.7781e+05, 3.8017e+05, 3.8513e+05,
        3.9470e+05, 4.0433e+05, 4.0484e+05, 4.1019e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380148.4688, 380165.6562, 380178.0625, 380184.5625,
        380189.0938, 380196.6875, 380199.0312, 380212.3125, 380226.4375,
        757961.7500, 767652.9375, 778467.2500, 782483.5000, 793540.3125,
        813144.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5643e+00, 1.6111e+00, 1.6208e+00, 1.6417e+00, 1.6963e+00,
        1.7692e+00, 1.7843e+00, 1.8995e+00, 3.7781e+05, 3.8018e+05, 3.8512e+05,
        3.9463e+05, 4.0435e+05, 4.0484e+05, 4.1017e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5400e+00, 1.5961e+00, 1.6052e+00, 1.6399e+00, 1.6407e+00,
        1.6715e+00, 1.6802e+00, 1.8995e+00, 3.7780e+05, 3.8023e+05, 3.8513e+05,
        3.9465e+05, 4.0434e+05, 4.0481e+05, 4.1020e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5643e+00, 1.5961e+00, 1.6074e+00, 1.6250e+00, 1.6411e+00,
        1.6802e+00, 1.6828e+00, 1.7381e+00, 3.7784e+05, 3.8021e+05, 3.8512e+05,
        3.9465e+05, 4.0435e+05, 4.0484e+05, 4.1020e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394633.3750, 394636.6250, 394641.5312, 394645.6875,
        394647.0938, 394651.5312, 394653.4062, 394654.6562, 394704.6875,
        771689.3125, 774254.6250, 793540.3125, 801219.6250, 808643.9375,
        826341.8125])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75799.39', '442905.19', '442160.94', '75805.21', '75804.05', '447023.91', '75798.92', '75805.73', '423382.00', '415837.91', '75798.76', '417966.19', '75801.07', '75803.60', '75806.91', '432355.81']
estimated f for each client, fs: [7, 5, 5, 7, 7, 5, 7, 7, 5, 6, 7, 5, 7, 7, 7, 5]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 20, 16, 2, 9, 17, 4, 5, 15, 19, 10, 13, 3, 11, 12, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0110s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:25...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 46 217]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:25, End: 2025-07-22 16:01:25)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 5, 12, 17, 6, 9, 10, 11, 1, 16, 20, 4, 13, 15, 19, 14], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4345e+00, 1.4267e+00, 3.7474e+05, 1.7406e+00, 1.6635e+00,
         1.5375e+00, 1.7233e+00, 1.6348e+00, 3.9647e+05, 3.9199e+05, 1.5396e+00,
         4.0812e+05, 3.9662e+05, 3.8915e+05, 3.8526e+05],
        [1.4345e+00, 0.0000e+00, 1.4699e+00, 3.7471e+05, 1.7503e+00, 1.6693e+00,
         1.5844e+00, 1.5401e+00, 1.6193e+00, 3.9648e+05, 3.9199e+05, 1.4890e+00,
         4.0812e+05, 3.9662e+05, 3.8915e+05, 3.8524e+05],
        [1.4267e+00, 1.4699e+00, 0.0000e+00, 3.7476e+05, 1.5608e+00, 1.5520e+00,
         1.5241e+00, 1.5167e+00, 1.6008e+00, 3.9647e+05, 3.9199e+05, 1.4495e+00,
         4.0811e+05, 3.9660e+05, 3.8918e+05, 3.8526e+05],
        [3.7474e+05, 3.7471e+05, 3.7476e+05, 0.0000e+00, 3.7474e+05, 3.7470e+05,
         3.7473e+05, 3.7472e+05, 3.7475e+05, 7.5513e+05, 7.5455e+05, 3.7474e+05,
         7.8412e+05, 7.5244e+05, 7.3702e+05, 7.5247e+05],
        [1.7406e+00, 1.7503e+00, 1.5608e+00, 3.7474e+05, 0.0000e+00, 1.4909e+00,
         1.8804e+00, 1.4912e+00, 1.4682e+00, 3.9646e+05, 3.9201e+05, 1.4671e+00,
         4.0814e+05, 3.9664e+05, 3.8914e+05, 3.8525e+05],
        [1.6635e+00, 1.6693e+00, 1.5520e+00, 3.7470e+05, 1.4909e+00, 0.0000e+00,
         1.7685e+00, 1.4785e+00, 1.4424e+00, 3.9645e+05, 3.9199e+05, 1.5375e+00,
         4.0815e+05, 3.9664e+05, 3.8914e+05, 3.8527e+05],
        [1.5375e+00, 1.5844e+00, 1.5241e+00, 3.7473e+05, 1.8804e+00, 1.7685e+00,
         0.0000e+00, 1.8491e+00, 1.7960e+00, 3.9650e+05, 3.9198e+05, 1.7807e+00,
         4.0813e+05, 3.9658e+05, 3.8918e+05, 3.8527e+05],
        [1.7233e+00, 1.5401e+00, 1.5167e+00, 3.7472e+05, 1.4912e+00, 1.4785e+00,
         1.8491e+00, 0.0000e+00, 1.4957e+00, 3.9648e+05, 3.9202e+05, 1.3960e+00,
         4.0812e+05, 3.9660e+05, 3.8918e+05, 3.8525e+05],
        [1.6348e+00, 1.6193e+00, 1.6008e+00, 3.7475e+05, 1.4682e+00, 1.4424e+00,
         1.7960e+00, 1.4957e+00, 0.0000e+00, 3.9645e+05, 3.9201e+05, 1.4737e+00,
         4.0812e+05, 3.9662e+05, 3.8916e+05, 3.8524e+05],
        [3.9647e+05, 3.9648e+05, 3.9647e+05, 7.5513e+05, 3.9646e+05, 3.9645e+05,
         3.9650e+05, 3.9648e+05, 3.9645e+05, 0.0000e+00, 7.8706e+05, 3.9645e+05,
         8.0003e+05, 7.7919e+05, 7.6799e+05, 7.9582e+05],
        [3.9199e+05, 3.9199e+05, 3.9199e+05, 7.5455e+05, 3.9201e+05, 3.9199e+05,
         3.9198e+05, 3.9202e+05, 3.9201e+05, 7.8706e+05, 0.0000e+00, 3.9202e+05,
         8.0330e+05, 8.0067e+05, 7.8684e+05, 7.7863e+05],
        [1.5396e+00, 1.4890e+00, 1.4495e+00, 3.7474e+05, 1.4671e+00, 1.5375e+00,
         1.7807e+00, 1.3960e+00, 1.4737e+00, 3.9645e+05, 3.9202e+05, 0.0000e+00,
         4.0813e+05, 3.9662e+05, 3.8915e+05, 3.8524e+05],
        [4.0812e+05, 4.0812e+05, 4.0811e+05, 7.8412e+05, 4.0814e+05, 4.0815e+05,
         4.0813e+05, 4.0812e+05, 4.0812e+05, 8.0003e+05, 8.0330e+05, 4.0813e+05,
         0.0000e+00, 8.1746e+05, 8.1540e+05, 7.5410e+05],
        [3.9662e+05, 3.9662e+05, 3.9660e+05, 7.5244e+05, 3.9664e+05, 3.9664e+05,
         3.9658e+05, 3.9660e+05, 3.9662e+05, 7.7919e+05, 8.0067e+05, 3.9662e+05,
         8.1746e+05, 0.0000e+00, 7.9752e+05, 7.6736e+05],
        [3.8915e+05, 3.8915e+05, 3.8918e+05, 7.3702e+05, 3.8914e+05, 3.8914e+05,
         3.8918e+05, 3.8918e+05, 3.8916e+05, 7.6799e+05, 7.8684e+05, 3.8915e+05,
         8.1540e+05, 7.9752e+05, 0.0000e+00, 7.4720e+05],
        [3.8526e+05, 3.8524e+05, 3.8526e+05, 7.5247e+05, 3.8525e+05, 3.8527e+05,
         3.8527e+05, 3.8525e+05, 3.8524e+05, 7.9582e+05, 7.7863e+05, 3.8524e+05,
         7.5410e+05, 7.6736e+05, 7.4720e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.4267e+00, 1.4345e+00, 1.5375e+00, 1.5396e+00, 1.6348e+00,
        1.6635e+00, 1.7233e+00, 1.7406e+00, 3.7474e+05, 3.8526e+05, 3.8915e+05,
        3.9199e+05, 3.9647e+05, 3.9662e+05, 4.0812e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4345e+00, 1.4699e+00, 1.4890e+00, 1.5401e+00, 1.5844e+00,
        1.6193e+00, 1.6693e+00, 1.7503e+00, 3.7471e+05, 3.8524e+05, 3.8915e+05,
        3.9199e+05, 3.9648e+05, 3.9662e+05, 4.0812e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4267e+00, 1.4495e+00, 1.4699e+00, 1.5167e+00, 1.5241e+00,
        1.5520e+00, 1.5608e+00, 1.6008e+00, 3.7476e+05, 3.8526e+05, 3.8918e+05,
        3.9199e+05, 3.9647e+05, 3.9660e+05, 4.0811e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374703.1250, 374706.0938, 374721.3438, 374732.1875,
        374740.7500, 374740.9062, 374741.7188, 374751.1875, 374755.5938,
        737017.3125, 752443.6250, 752466.2500, 754548.2500, 755125.3750,
        784123.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4671e+00, 1.4682e+00, 1.4909e+00, 1.4912e+00, 1.5608e+00,
        1.7406e+00, 1.7503e+00, 1.8804e+00, 3.7474e+05, 3.8525e+05, 3.8914e+05,
        3.9201e+05, 3.9646e+05, 3.9664e+05, 4.0814e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4424e+00, 1.4785e+00, 1.4909e+00, 1.5375e+00, 1.5520e+00,
        1.6635e+00, 1.6693e+00, 1.7685e+00, 3.7470e+05, 3.8527e+05, 3.8914e+05,
        3.9199e+05, 3.9645e+05, 3.9664e+05, 4.0815e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.5241e+00, 1.5375e+00, 1.5844e+00, 1.7685e+00, 1.7807e+00,
        1.7960e+00, 1.8491e+00, 1.8804e+00, 3.7473e+05, 3.8527e+05, 3.8918e+05,
        3.9198e+05, 3.9650e+05, 3.9658e+05, 4.0813e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3960e+00, 1.4785e+00, 1.4912e+00, 1.4957e+00, 1.5167e+00,
        1.5401e+00, 1.7233e+00, 1.8491e+00, 3.7472e+05, 3.8525e+05, 3.8918e+05,
        3.9202e+05, 3.9648e+05, 3.9660e+05, 4.0812e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4424e+00, 1.4682e+00, 1.4737e+00, 1.4957e+00, 1.6008e+00,
        1.6193e+00, 1.6348e+00, 1.7960e+00, 3.7475e+05, 3.8524e+05, 3.8916e+05,
        3.9201e+05, 3.9645e+05, 3.9662e+05, 4.0812e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396449.2500, 396449.6875, 396453.6562, 396456.7812,
        396472.9688, 396473.0625, 396476.8750, 396478.3750, 396500.7500,
        755125.3750, 767986.1875, 779185.9375, 787063.6250, 795815.5625,
        800029.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391978.1250, 391987.5000, 391989.1250, 391992.9688,
        391994.3750, 392009.5625, 392011.9688, 392015.1250, 392016.0938,
        754548.2500, 778634.8750, 786840.1250, 787063.6250, 800667.4375,
        803299.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3960e+00, 1.4495e+00, 1.4671e+00, 1.4737e+00, 1.4890e+00,
        1.5375e+00, 1.5396e+00, 1.7807e+00, 3.7474e+05, 3.8524e+05, 3.8915e+05,
        3.9202e+05, 3.9645e+05, 3.9662e+05, 4.0813e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 408110.7500, 408116.1250, 408116.8750, 408119.5312,
        408121.8125, 408127.2500, 408127.9062, 408138.4375, 408145.8125,
        754096.5000, 784123.6250, 800029.1250, 803299.1875, 815400.0000,
        817462.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396575.3125, 396597.8125, 396602.2188, 396616.1562,
        396619.8125, 396623.3125, 396624.9375, 396639.4688, 396640.3750,
        752443.6250, 767359.7500, 779185.9375, 797522.5625, 800667.4375,
        817462.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389139.1250, 389140.8750, 389148.1562, 389150.2188,
        389151.2812, 389160.1562, 389176.0938, 389181.2500, 389182.5625,
        737017.3125, 747203.8750, 767986.1875, 786840.1250, 797522.5625,
        815400.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385236.1250, 385242.4375, 385242.6562, 385245.8750,
        385252.0625, 385259.5625, 385262.3750, 385265.5000, 385267.6875,
        747203.8750, 752466.2500, 754096.5000, 767359.7500, 778634.8750,
        795815.5625])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76001.31', '75995.48', '76003.02', '410961.06', '76000.66', '75998.13', '76001.36', '75997.98', '76000.62', '432333.69', '428254.31', '75999.57', '442722.09', '432198.31', '423944.69', '421447.81']
estimated f for each client, fs: [7, 7, 7, 5, 7, 7, 7, 7, 7, 5, 5, 7, 5, 5, 5, 5]
selected_index: 1
rkrum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 5, 12, 17, 6, 9, 10, 11, 1, 16, 20, 4, 13, 15, 19, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0115s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:26...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:26, End: 2025-07-22 16:01:26)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 2, 6, 5, 17, 3, 7, 19, 8, 20, 16, 18, 4, 15, 11, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3213e+00, 1.4314e+00, 1.5777e+00, 3.9644e+05, 1.3409e+00,
         1.4073e+00, 3.9029e+05, 1.3551e+00, 3.9851e+05, 3.9852e+05, 3.8480e+05,
         1.3652e+00, 3.8817e+05, 1.4492e+00, 1.4291e+00],
        [1.3213e+00, 0.0000e+00, 1.3551e+00, 1.6862e+00, 3.9642e+05, 1.3737e+00,
         1.3414e+00, 3.9027e+05, 1.4362e+00, 3.9848e+05, 3.9851e+05, 3.8476e+05,
         1.3661e+00, 3.8812e+05, 1.3829e+00, 1.3398e+00],
        [1.4314e+00, 1.3551e+00, 0.0000e+00, 1.9469e+00, 3.9644e+05, 1.5726e+00,
         1.4211e+00, 3.9028e+05, 1.5778e+00, 3.9849e+05, 3.9854e+05, 3.8477e+05,
         1.4097e+00, 3.8811e+05, 1.4176e+00, 1.3260e+00],
        [1.5777e+00, 1.6862e+00, 1.9469e+00, 0.0000e+00, 3.9645e+05, 1.4799e+00,
         1.8089e+00, 3.9031e+05, 1.5801e+00, 3.9849e+05, 3.9852e+05, 3.8476e+05,
         1.7020e+00, 3.8813e+05, 1.7105e+00, 1.8162e+00],
        [3.9644e+05, 3.9642e+05, 3.9644e+05, 3.9645e+05, 0.0000e+00, 3.9642e+05,
         3.9644e+05, 7.8798e+05, 3.9644e+05, 7.9888e+05, 8.0055e+05, 7.7909e+05,
         3.9645e+05, 7.7764e+05, 3.9644e+05, 3.9643e+05],
        [1.3409e+00, 1.3737e+00, 1.5726e+00, 1.4799e+00, 3.9642e+05, 0.0000e+00,
         1.5159e+00, 3.9029e+05, 1.4309e+00, 3.9848e+05, 3.9852e+05, 3.8476e+05,
         1.4675e+00, 3.8812e+05, 1.6085e+00, 1.4619e+00],
        [1.4073e+00, 1.3414e+00, 1.4211e+00, 1.8089e+00, 3.9644e+05, 1.5159e+00,
         0.0000e+00, 3.9027e+05, 1.5909e+00, 3.9846e+05, 3.9849e+05, 3.8476e+05,
         1.4211e+00, 3.8812e+05, 1.3526e+00, 1.3964e+00],
        [3.9029e+05, 3.9027e+05, 3.9028e+05, 3.9031e+05, 7.8798e+05, 3.9029e+05,
         3.9027e+05, 0.0000e+00, 3.9032e+05, 7.6381e+05, 7.8763e+05, 7.7688e+05,
         3.9029e+05, 7.7659e+05, 3.9026e+05, 3.9027e+05],
        [1.3551e+00, 1.4362e+00, 1.5778e+00, 1.5801e+00, 3.9644e+05, 1.4309e+00,
         1.5909e+00, 3.9032e+05, 0.0000e+00, 3.9851e+05, 3.9850e+05, 3.8476e+05,
         1.4178e+00, 3.8816e+05, 1.5539e+00, 1.4593e+00],
        [3.9851e+05, 3.9848e+05, 3.9849e+05, 3.9849e+05, 7.9888e+05, 3.9848e+05,
         3.9846e+05, 7.6381e+05, 3.9851e+05, 0.0000e+00, 7.9214e+05, 7.7894e+05,
         3.9847e+05, 7.8564e+05, 3.9847e+05, 3.9848e+05],
        [3.9852e+05, 3.9851e+05, 3.9854e+05, 3.9852e+05, 8.0055e+05, 3.9852e+05,
         3.9849e+05, 7.8763e+05, 3.9850e+05, 7.9214e+05, 0.0000e+00, 7.8934e+05,
         3.9852e+05, 7.9025e+05, 3.9850e+05, 3.9851e+05],
        [3.8480e+05, 3.8476e+05, 3.8477e+05, 3.8476e+05, 7.7909e+05, 3.8476e+05,
         3.8476e+05, 7.7688e+05, 3.8476e+05, 7.7894e+05, 7.8934e+05, 0.0000e+00,
         3.8475e+05, 7.4881e+05, 3.8478e+05, 3.8476e+05],
        [1.3652e+00, 1.3661e+00, 1.4097e+00, 1.7020e+00, 3.9645e+05, 1.4675e+00,
         1.4211e+00, 3.9029e+05, 1.4178e+00, 3.9847e+05, 3.9852e+05, 3.8475e+05,
         0.0000e+00, 3.8814e+05, 1.3819e+00, 1.4454e+00],
        [3.8817e+05, 3.8812e+05, 3.8811e+05, 3.8813e+05, 7.7764e+05, 3.8812e+05,
         3.8812e+05, 7.7659e+05, 3.8816e+05, 7.8564e+05, 7.9025e+05, 7.4881e+05,
         3.8814e+05, 0.0000e+00, 3.8812e+05, 3.8810e+05],
        [1.4492e+00, 1.3829e+00, 1.4176e+00, 1.7105e+00, 3.9644e+05, 1.6085e+00,
         1.3526e+00, 3.9026e+05, 1.5539e+00, 3.9847e+05, 3.9850e+05, 3.8478e+05,
         1.3819e+00, 3.8812e+05, 0.0000e+00, 1.3565e+00],
        [1.4291e+00, 1.3398e+00, 1.3260e+00, 1.8162e+00, 3.9643e+05, 1.4619e+00,
         1.3964e+00, 3.9027e+05, 1.4593e+00, 3.9848e+05, 3.9851e+05, 3.8476e+05,
         1.4454e+00, 3.8810e+05, 1.3565e+00, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3213e+00, 1.3409e+00, 1.3551e+00, 1.3652e+00, 1.4073e+00,
        1.4291e+00, 1.4314e+00, 1.4492e+00, 1.5777e+00, 3.8480e+05, 3.8817e+05,
        3.9029e+05, 3.9644e+05, 3.9851e+05, 3.9852e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3213e+00, 1.3398e+00, 1.3414e+00, 1.3551e+00, 1.3661e+00,
        1.3737e+00, 1.3829e+00, 1.4362e+00, 1.6862e+00, 3.8476e+05, 3.8812e+05,
        3.9027e+05, 3.9642e+05, 3.9848e+05, 3.9851e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3260e+00, 1.3551e+00, 1.4097e+00, 1.4176e+00, 1.4211e+00,
        1.4314e+00, 1.5726e+00, 1.5778e+00, 1.9469e+00, 3.8477e+05, 3.8811e+05,
        3.9028e+05, 3.9644e+05, 3.9849e+05, 3.9854e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4799e+00, 1.5777e+00, 1.5801e+00, 1.6862e+00, 1.7020e+00,
        1.7105e+00, 1.8089e+00, 1.8162e+00, 1.9469e+00, 3.8476e+05, 3.8813e+05,
        3.9031e+05, 3.9645e+05, 3.9849e+05, 3.9852e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396418.6875, 396420.6562, 396434.0000, 396438.2500,
        396438.7500, 396439.3750, 396440.9375, 396443.8125, 396445.8438,
        396446.1875, 777637.1875, 779086.5625, 787975.8750, 798884.8125,
        800545.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3409e+00, 1.3737e+00, 1.4309e+00, 1.4619e+00, 1.4675e+00,
        1.4799e+00, 1.5159e+00, 1.5726e+00, 1.6085e+00, 3.8476e+05, 3.8812e+05,
        3.9029e+05, 3.9642e+05, 3.9848e+05, 3.9852e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3414e+00, 1.3526e+00, 1.3964e+00, 1.4073e+00, 1.4211e+00,
        1.4211e+00, 1.5159e+00, 1.5909e+00, 1.8089e+00, 3.8476e+05, 3.8812e+05,
        3.9027e+05, 3.9644e+05, 3.9846e+05, 3.9849e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390259.5938, 390266.1562, 390266.5625, 390273.2500,
        390278.3125, 390286.3125, 390288.8750, 390292.9062, 390305.0625,
        390320.3438, 763813.1875, 776588.6250, 776885.0000, 787629.0000,
        787975.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3551e+00, 1.4178e+00, 1.4309e+00, 1.4362e+00, 1.4593e+00,
        1.5539e+00, 1.5778e+00, 1.5801e+00, 1.5909e+00, 3.8476e+05, 3.8816e+05,
        3.9032e+05, 3.9644e+05, 3.9850e+05, 3.9851e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398463.9375, 398471.2812, 398472.5625, 398475.5938,
        398480.4062, 398480.8750, 398488.1250, 398493.3750, 398506.0000,
        398506.0000, 763813.1875, 778940.9375, 785637.9375, 792136.1250,
        798884.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398488.2812, 398499.9688, 398503.6875, 398505.5312,
        398510.6875, 398520.7500, 398523.0625, 398523.1562, 398523.2812,
        398542.7812, 787629.0000, 789338.9375, 790246.8750, 792136.1250,
        800545.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384751.0625, 384756.5938, 384757.8125, 384758.0000,
        384759.2812, 384760.8125, 384762.1562, 384771.9688, 384784.5938,
        384798.4688, 748813.0000, 776885.0000, 778940.9375, 779086.5625,
        789338.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3652e+00, 1.3661e+00, 1.3819e+00, 1.4097e+00, 1.4178e+00,
        1.4211e+00, 1.4454e+00, 1.4675e+00, 1.7020e+00, 3.8475e+05, 3.8814e+05,
        3.9029e+05, 3.9645e+05, 3.9847e+05, 3.9852e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388103.8438, 388112.4062, 388117.5938, 388117.8438,
        388118.7812, 388120.8125, 388128.6875, 388143.5312, 388160.0625,
        388171.5625, 748813.0000, 776588.6250, 777637.1875, 785637.9375,
        790246.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3526e+00, 1.3565e+00, 1.3819e+00, 1.3829e+00, 1.4176e+00,
        1.4492e+00, 1.5539e+00, 1.6085e+00, 1.7105e+00, 3.8478e+05, 3.8812e+05,
        3.9026e+05, 3.9644e+05, 3.9847e+05, 3.9850e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3260e+00, 1.3398e+00, 1.3565e+00, 1.3964e+00, 1.4291e+00,
        1.4454e+00, 1.4593e+00, 1.4619e+00, 1.8162e+00, 3.8476e+05, 3.8810e+05,
        3.9027e+05, 3.9643e+05, 3.9848e+05, 3.9851e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38481.11', '38477.34', '38478.54', '38477.31', '396436.62', '38477.54', '38476.98', '390283.75', '38477.14', '398483.81', '398514.12', '384766.06', '38476.40', '388129.50', '38479.77', '38477.23']
estimated f for each client, fs: [6, 6, 6, 6, 4, 6, 6, 4, 6, 4, 4, 4, 6, 4, 6, 6]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 2, 6, 5, 17, 3, 7, 19, 8, 20, 16, 18, 4, 15, 11, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0162s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:27...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:27, End: 2025-07-22 16:01:27)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 1, 4, 6, 2, 9, 10, 8, 14, 16, 13, 11, 3, 5, 18, 19], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4530e+00, 1.5039e+00, 1.5785e+00, 1.3839e+00, 1.4659e+00,
         1.3804e+00, 1.4993e+00, 3.9750e+05, 3.8389e+05, 3.7938e+05, 1.4864e+00,
         1.3781e+00, 1.5408e+00, 3.8295e+05, 3.8359e+05],
        [1.4530e+00, 0.0000e+00, 1.5697e+00, 1.3946e+00, 1.3866e+00, 1.3976e+00,
         1.6510e+00, 1.7419e+00, 3.9749e+05, 3.8391e+05, 3.7937e+05, 1.4889e+00,
         1.5188e+00, 1.7194e+00, 3.8290e+05, 3.8364e+05],
        [1.5039e+00, 1.5697e+00, 0.0000e+00, 1.8115e+00, 1.5362e+00, 1.7267e+00,
         1.4812e+00, 1.4947e+00, 3.9752e+05, 3.8392e+05, 3.7938e+05, 1.7086e+00,
         1.5490e+00, 1.4217e+00, 3.8292e+05, 3.8365e+05],
        [1.5785e+00, 1.3946e+00, 1.8115e+00, 0.0000e+00, 1.4442e+00, 1.4215e+00,
         1.8418e+00, 1.7913e+00, 3.9748e+05, 3.8393e+05, 3.7936e+05, 1.5438e+00,
         1.7300e+00, 1.9426e+00, 3.8296e+05, 3.8361e+05],
        [1.3839e+00, 1.3866e+00, 1.5362e+00, 1.4442e+00, 0.0000e+00, 1.4174e+00,
         1.3821e+00, 1.5688e+00, 3.9746e+05, 3.8392e+05, 3.7939e+05, 1.4395e+00,
         1.4212e+00, 1.5810e+00, 3.8298e+05, 3.8362e+05],
        [1.4659e+00, 1.3976e+00, 1.7267e+00, 1.4215e+00, 1.4174e+00, 0.0000e+00,
         1.6279e+00, 1.6537e+00, 3.9747e+05, 3.8388e+05, 3.7938e+05, 1.4178e+00,
         1.6198e+00, 1.8330e+00, 3.8294e+05, 3.8364e+05],
        [1.3804e+00, 1.6510e+00, 1.4812e+00, 1.8418e+00, 1.3821e+00, 1.6279e+00,
         0.0000e+00, 1.5050e+00, 3.9747e+05, 3.8394e+05, 3.7939e+05, 1.7227e+00,
         1.4548e+00, 1.3616e+00, 3.8293e+05, 3.8363e+05],
        [1.4993e+00, 1.7419e+00, 1.4947e+00, 1.7913e+00, 1.5688e+00, 1.6537e+00,
         1.5050e+00, 0.0000e+00, 3.9750e+05, 3.8390e+05, 3.7939e+05, 1.7018e+00,
         1.5421e+00, 1.5726e+00, 3.8294e+05, 3.8365e+05],
        [3.9750e+05, 3.9749e+05, 3.9752e+05, 3.9748e+05, 3.9746e+05, 3.9747e+05,
         3.9747e+05, 3.9750e+05, 0.0000e+00, 8.0233e+05, 7.9084e+05, 3.9752e+05,
         3.9747e+05, 3.9749e+05, 7.8247e+05, 7.7087e+05],
        [3.8389e+05, 3.8391e+05, 3.8392e+05, 3.8393e+05, 3.8392e+05, 3.8388e+05,
         3.8394e+05, 3.8390e+05, 8.0233e+05, 0.0000e+00, 7.6192e+05, 3.8392e+05,
         3.8390e+05, 3.8390e+05, 7.7581e+05, 7.7637e+05],
        [3.7938e+05, 3.7937e+05, 3.7938e+05, 3.7936e+05, 3.7939e+05, 3.7938e+05,
         3.7939e+05, 3.7939e+05, 7.9084e+05, 7.6192e+05, 0.0000e+00, 3.7937e+05,
         3.7938e+05, 3.7937e+05, 7.6218e+05, 7.7502e+05],
        [1.4864e+00, 1.4889e+00, 1.7086e+00, 1.5438e+00, 1.4395e+00, 1.4178e+00,
         1.7227e+00, 1.7018e+00, 3.9752e+05, 3.8392e+05, 3.7937e+05, 0.0000e+00,
         1.7164e+00, 1.7222e+00, 3.8294e+05, 3.8365e+05],
        [1.3781e+00, 1.5188e+00, 1.5490e+00, 1.7300e+00, 1.4212e+00, 1.6198e+00,
         1.4548e+00, 1.5421e+00, 3.9747e+05, 3.8390e+05, 3.7938e+05, 1.7164e+00,
         0.0000e+00, 1.4950e+00, 3.8294e+05, 3.8365e+05],
        [1.5408e+00, 1.7194e+00, 1.4217e+00, 1.9426e+00, 1.5810e+00, 1.8330e+00,
         1.3616e+00, 1.5726e+00, 3.9749e+05, 3.8390e+05, 3.7937e+05, 1.7222e+00,
         1.4950e+00, 0.0000e+00, 3.8291e+05, 3.8362e+05],
        [3.8295e+05, 3.8290e+05, 3.8292e+05, 3.8296e+05, 3.8298e+05, 3.8294e+05,
         3.8293e+05, 3.8294e+05, 7.8247e+05, 7.7581e+05, 7.6218e+05, 3.8294e+05,
         3.8294e+05, 3.8291e+05, 0.0000e+00, 7.7642e+05],
        [3.8359e+05, 3.8364e+05, 3.8365e+05, 3.8361e+05, 3.8362e+05, 3.8364e+05,
         3.8363e+05, 3.8365e+05, 7.7087e+05, 7.7637e+05, 7.7502e+05, 3.8365e+05,
         3.8365e+05, 3.8362e+05, 7.7642e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3781e+00, 1.3804e+00, 1.3839e+00, 1.4530e+00, 1.4659e+00,
        1.4864e+00, 1.4993e+00, 1.5039e+00, 1.5408e+00, 1.5785e+00, 3.7938e+05,
        3.8295e+05, 3.8359e+05, 3.8389e+05, 3.9750e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3866e+00, 1.3946e+00, 1.3976e+00, 1.4530e+00, 1.4889e+00,
        1.5188e+00, 1.5697e+00, 1.6510e+00, 1.7194e+00, 1.7419e+00, 3.7937e+05,
        3.8290e+05, 3.8364e+05, 3.8391e+05, 3.9749e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4217e+00, 1.4812e+00, 1.4947e+00, 1.5039e+00, 1.5362e+00,
        1.5490e+00, 1.5697e+00, 1.7086e+00, 1.7267e+00, 1.8115e+00, 3.7938e+05,
        3.8292e+05, 3.8365e+05, 3.8392e+05, 3.9752e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3946e+00, 1.4215e+00, 1.4442e+00, 1.5438e+00, 1.5785e+00,
        1.7300e+00, 1.7913e+00, 1.8115e+00, 1.8418e+00, 1.9426e+00, 3.7936e+05,
        3.8296e+05, 3.8361e+05, 3.8393e+05, 3.9748e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3821e+00, 1.3839e+00, 1.3866e+00, 1.4174e+00, 1.4212e+00,
        1.4395e+00, 1.4442e+00, 1.5362e+00, 1.5688e+00, 1.5810e+00, 3.7939e+05,
        3.8298e+05, 3.8362e+05, 3.8392e+05, 3.9746e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3976e+00, 1.4174e+00, 1.4178e+00, 1.4215e+00, 1.4659e+00,
        1.6198e+00, 1.6279e+00, 1.6537e+00, 1.7267e+00, 1.8330e+00, 3.7938e+05,
        3.8294e+05, 3.8364e+05, 3.8388e+05, 3.9747e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3616e+00, 1.3804e+00, 1.3821e+00, 1.4548e+00, 1.4812e+00,
        1.5050e+00, 1.6279e+00, 1.6510e+00, 1.7227e+00, 1.8418e+00, 3.7939e+05,
        3.8293e+05, 3.8363e+05, 3.8394e+05, 3.9747e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4947e+00, 1.4993e+00, 1.5050e+00, 1.5421e+00, 1.5688e+00,
        1.5726e+00, 1.6537e+00, 1.7018e+00, 1.7419e+00, 1.7913e+00, 3.7939e+05,
        3.8294e+05, 3.8365e+05, 3.8390e+05, 3.9750e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397457.3438, 397465.6250, 397472.1562, 397474.5625,
        397478.3438, 397493.2500, 397494.9375, 397498.7188, 397499.3125,
        397516.2500, 397519.1562, 770865.3125, 782474.7500, 790841.8750,
        802327.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 383883.5938, 383888.7500, 383896.8750, 383899.3750,
        383900.5938, 383908.7500, 383918.0625, 383921.3750, 383923.3750,
        383925.8750, 383942.3750, 761917.2500, 775811.6250, 776373.1875,
        802327.0625])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 379362.0625, 379365.3750, 379367.5625, 379370.5938,
        379376.6562, 379377.5938, 379378.1562, 379382.3438, 379387.9375,
        379390.6562, 379394.6875, 761917.2500, 762183.5625, 775020.8125,
        790841.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4178e+00, 1.4395e+00, 1.4864e+00, 1.4889e+00, 1.5438e+00,
        1.7018e+00, 1.7086e+00, 1.7164e+00, 1.7222e+00, 1.7227e+00, 3.7937e+05,
        3.8294e+05, 3.8365e+05, 3.8392e+05, 3.9752e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3781e+00, 1.4212e+00, 1.4548e+00, 1.4950e+00, 1.5188e+00,
        1.5421e+00, 1.5490e+00, 1.6198e+00, 1.7164e+00, 1.7300e+00, 3.7938e+05,
        3.8294e+05, 3.8365e+05, 3.8390e+05, 3.9747e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3616e+00, 1.4217e+00, 1.4950e+00, 1.5408e+00, 1.5726e+00,
        1.5810e+00, 1.7194e+00, 1.7222e+00, 1.8330e+00, 1.9426e+00, 3.7937e+05,
        3.8291e+05, 3.8362e+05, 3.8390e+05, 3.9749e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382902.3750, 382914.2812, 382915.0938, 382930.7812,
        382935.0312, 382935.8750, 382938.1562, 382942.5625, 382945.0312,
        382961.8750, 382984.3750, 762183.5625, 775811.6250, 776417.8750,
        782474.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 383591.7812, 383612.0000, 383618.0312, 383623.6562,
        383631.1250, 383635.5312, 383639.0312, 383649.9062, 383651.0625,
        383653.3125, 383653.9375, 770865.3125, 775020.8125, 776373.1875,
        776417.8750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['1.47', '1.53', '1.58', '1.65', '1.46', '1.56', '1.54', '1.61', '397488.12', '383909.91', '379375.91', '1.59', '1.54', '1.62', '382936.88', '383630.56']
estimated f for each client, fs: [5, 5, 5, 5, 5, 5, 5, 5, 3, 3, 5, 5, 5, 5, 3, 5]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 1, 4, 6, 2, 9, 10, 8, 14, 16, 13, 11, 3, 5, 18, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0118s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:27...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:27, End: 2025-07-22 16:01:27)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 8, 17, 1, 15, 16, 13, 7, 3, 11, 18, 20, 2, 4, 10, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7236e+05, 7.8355e+05, 3.7239e+05, 7.5421e+05, 7.4377e+05,
         7.6583e+05, 3.7238e+05, 3.7238e+05, 3.7237e+05, 7.6533e+05, 7.8843e+05,
         3.7235e+05, 3.7240e+05, 3.7239e+05, 3.7236e+05],
        [3.7236e+05, 0.0000e+00, 3.9621e+05, 1.6876e+00, 3.8488e+05, 3.8038e+05,
         3.9806e+05, 1.6356e+00, 1.4668e+00, 1.5941e+00, 3.9697e+05, 4.0434e+05,
         1.4862e+00, 1.3547e+00, 1.4228e+00, 1.6811e+00],
        [7.8355e+05, 3.9621e+05, 0.0000e+00, 3.9621e+05, 7.8226e+05, 7.7834e+05,
         8.0819e+05, 3.9622e+05, 3.9621e+05, 3.9622e+05, 7.9571e+05, 7.7239e+05,
         3.9625e+05, 3.9622e+05, 3.9622e+05, 3.9625e+05],
        [3.7239e+05, 1.6876e+00, 3.9621e+05, 0.0000e+00, 3.8487e+05, 3.8037e+05,
         3.9809e+05, 1.5331e+00, 1.5210e+00, 1.4550e+00, 3.9698e+05, 4.0435e+05,
         1.5844e+00, 1.5367e+00, 1.6201e+00, 1.4239e+00],
        [7.5421e+05, 3.8488e+05, 7.8226e+05, 3.8487e+05, 0.0000e+00, 7.6757e+05,
         7.7735e+05, 3.8484e+05, 3.8485e+05, 3.8486e+05, 7.7753e+05, 7.9690e+05,
         3.8486e+05, 3.8486e+05, 3.8484e+05, 3.8485e+05],
        [7.4377e+05, 3.8038e+05, 7.7834e+05, 3.8037e+05, 7.6757e+05, 0.0000e+00,
         7.9575e+05, 3.8036e+05, 3.8038e+05, 3.8037e+05, 7.8275e+05, 7.8050e+05,
         3.8036e+05, 3.8037e+05, 3.8035e+05, 3.8036e+05],
        [7.6583e+05, 3.9806e+05, 8.0819e+05, 3.9809e+05, 7.7735e+05, 7.9575e+05,
         0.0000e+00, 3.9809e+05, 3.9806e+05, 3.9807e+05, 7.7396e+05, 7.9824e+05,
         3.9809e+05, 3.9805e+05, 3.9806e+05, 3.9807e+05],
        [3.7238e+05, 1.6356e+00, 3.9622e+05, 1.5331e+00, 3.8484e+05, 3.8036e+05,
         3.9809e+05, 0.0000e+00, 1.5560e+00, 1.4403e+00, 3.9698e+05, 4.0434e+05,
         1.5925e+00, 1.5552e+00, 1.5684e+00, 1.5370e+00],
        [3.7238e+05, 1.4668e+00, 3.9621e+05, 1.5210e+00, 3.8485e+05, 3.8038e+05,
         3.9806e+05, 1.5560e+00, 0.0000e+00, 1.6176e+00, 3.9696e+05, 4.0436e+05,
         1.4627e+00, 1.4189e+00, 1.4040e+00, 1.6609e+00],
        [3.7237e+05, 1.5941e+00, 3.9622e+05, 1.4550e+00, 3.8486e+05, 3.8037e+05,
         3.9807e+05, 1.4403e+00, 1.6176e+00, 0.0000e+00, 3.9695e+05, 4.0434e+05,
         1.6257e+00, 1.5304e+00, 1.6495e+00, 1.4834e+00],
        [7.6533e+05, 3.9697e+05, 7.9571e+05, 3.9698e+05, 7.7753e+05, 7.8275e+05,
         7.7396e+05, 3.9698e+05, 3.9696e+05, 3.9695e+05, 0.0000e+00, 7.9360e+05,
         3.9697e+05, 3.9697e+05, 3.9695e+05, 3.9696e+05],
        [7.8843e+05, 4.0434e+05, 7.7239e+05, 4.0435e+05, 7.9690e+05, 7.8050e+05,
         7.9824e+05, 4.0434e+05, 4.0436e+05, 4.0434e+05, 7.9360e+05, 0.0000e+00,
         4.0438e+05, 4.0435e+05, 4.0433e+05, 4.0438e+05],
        [3.7235e+05, 1.4862e+00, 3.9625e+05, 1.5844e+00, 3.8486e+05, 3.8036e+05,
         3.9809e+05, 1.5925e+00, 1.4627e+00, 1.6257e+00, 3.9697e+05, 4.0438e+05,
         0.0000e+00, 1.3860e+00, 1.2664e+00, 1.6797e+00],
        [3.7240e+05, 1.3547e+00, 3.9622e+05, 1.5367e+00, 3.8486e+05, 3.8037e+05,
         3.9805e+05, 1.5552e+00, 1.4189e+00, 1.5304e+00, 3.9697e+05, 4.0435e+05,
         1.3860e+00, 0.0000e+00, 1.3555e+00, 1.6877e+00],
        [3.7239e+05, 1.4228e+00, 3.9622e+05, 1.6201e+00, 3.8484e+05, 3.8035e+05,
         3.9806e+05, 1.5684e+00, 1.4040e+00, 1.6495e+00, 3.9695e+05, 4.0433e+05,
         1.2664e+00, 1.3555e+00, 0.0000e+00, 1.7783e+00],
        [3.7236e+05, 1.6811e+00, 3.9625e+05, 1.4239e+00, 3.8485e+05, 3.8036e+05,
         3.9807e+05, 1.5370e+00, 1.6609e+00, 1.4834e+00, 3.9696e+05, 4.0438e+05,
         1.6797e+00, 1.6877e+00, 1.7783e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 372346.5000, 372356.3750, 372358.6250, 372372.0625,
        372381.3438, 372383.1875, 372387.5625, 372389.0000, 372401.1250,
        743768.0625, 754211.5625, 765333.7500, 765834.6250, 783552.0000,
        788432.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3547e+00, 1.4228e+00, 1.4668e+00, 1.4862e+00, 1.5941e+00,
        1.6356e+00, 1.6811e+00, 1.6876e+00, 3.7236e+05, 3.8038e+05, 3.8488e+05,
        3.9621e+05, 3.9697e+05, 3.9806e+05, 4.0434e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396208.6250, 396210.9688, 396213.2188, 396216.7188,
        396219.2812, 396219.9375, 396220.9375, 396248.2500, 396248.7500,
        772390.0000, 778338.0625, 782261.8750, 783552.0000, 795710.5625,
        808192.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4239e+00, 1.4550e+00, 1.5210e+00, 1.5331e+00, 1.5367e+00,
        1.5844e+00, 1.6201e+00, 1.6876e+00, 3.7239e+05, 3.8037e+05, 3.8487e+05,
        3.9621e+05, 3.9698e+05, 3.9809e+05, 4.0435e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384840.5000, 384844.1250, 384847.8750, 384850.7812,
        384861.4375, 384862.6875, 384863.8438, 384866.6562, 384881.6875,
        754211.5625, 767568.7500, 777352.8125, 777526.3125, 782261.8750,
        796897.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380353.1562, 380361.0938, 380361.8125, 380364.5938,
        380368.2812, 380369.0938, 380372.8750, 380378.8125, 380379.9375,
        743768.0625, 767568.7500, 778338.0625, 780500.7500, 782749.6875,
        795750.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 398048.9375, 398056.5625, 398058.8438, 398064.3125,
        398067.8750, 398071.3750, 398085.3125, 398087.9375, 398094.9062,
        765834.6250, 773958.3750, 777352.8125, 795750.6250, 798242.7500,
        808192.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4403e+00, 1.5331e+00, 1.5370e+00, 1.5552e+00, 1.5560e+00,
        1.5684e+00, 1.5925e+00, 1.6356e+00, 3.7238e+05, 3.8036e+05, 3.8484e+05,
        3.9622e+05, 3.9698e+05, 3.9809e+05, 4.0434e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4040e+00, 1.4189e+00, 1.4627e+00, 1.4668e+00, 1.5210e+00,
        1.5560e+00, 1.6176e+00, 1.6609e+00, 3.7238e+05, 3.8038e+05, 3.8485e+05,
        3.9621e+05, 3.9696e+05, 3.9806e+05, 4.0436e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4403e+00, 1.4550e+00, 1.4834e+00, 1.5304e+00, 1.5941e+00,
        1.6176e+00, 1.6257e+00, 1.6495e+00, 3.7237e+05, 3.8037e+05, 3.8486e+05,
        3.9622e+05, 3.9695e+05, 3.9807e+05, 4.0434e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396945.5938, 396951.2188, 396962.1250, 396963.6250,
        396968.2500, 396973.0625, 396973.5625, 396979.9375, 396984.6250,
        765333.7500, 773958.3750, 777526.3125, 782749.6875, 793600.8125,
        795710.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 404332.1250, 404340.8750, 404340.9688, 404344.5312,
        404346.5312, 404350.4375, 404361.6250, 404382.2188, 404382.4688,
        772390.0000, 780500.7500, 788432.5625, 793600.8125, 796897.0000,
        798242.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2664e+00, 1.3860e+00, 1.4627e+00, 1.4862e+00, 1.5844e+00,
        1.5925e+00, 1.6257e+00, 1.6797e+00, 3.7235e+05, 3.8036e+05, 3.8486e+05,
        3.9625e+05, 3.9697e+05, 3.9809e+05, 4.0438e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3547e+00, 1.3555e+00, 1.3860e+00, 1.4189e+00, 1.5304e+00,
        1.5367e+00, 1.5552e+00, 1.6877e+00, 3.7240e+05, 3.8037e+05, 3.8486e+05,
        3.9622e+05, 3.9697e+05, 3.9805e+05, 4.0435e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2664e+00, 1.3555e+00, 1.4040e+00, 1.4228e+00, 1.5684e+00,
        1.6201e+00, 1.6495e+00, 1.7783e+00, 3.7239e+05, 3.8035e+05, 3.8484e+05,
        3.9622e+05, 3.9695e+05, 3.9806e+05, 4.0433e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4239e+00, 1.4834e+00, 1.5370e+00, 1.6609e+00, 1.6797e+00,
        1.6811e+00, 1.6877e+00, 1.7783e+00, 3.7236e+05, 3.8036e+05, 3.8485e+05,
        3.9625e+05, 3.9696e+05, 3.9807e+05, 4.0438e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['409514.38', '75274.87', '433839.69', '75276.83', '421793.09', '416707.72', '434847.06', '75276.02', '75277.22', '75275.73', '433803.56', '441157.16', '75272.03', '75278.21', '75275.41', '75273.27']
estimated f for each client, fs: [5, 7, 5, 7, 5, 5, 5, 7, 7, 7, 5, 5, 7, 7, 7, 7]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 8, 17, 1, 15, 16, 13, 7, 3, 11, 18, 20, 2, 4, 10, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0170s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:28...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:28, End: 2025-07-22 16:01:28)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 11, 18, 12, 4, 20, 2, 15, 7, 17, 19, 13, 5, 14, 16, 9], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3609e+00, 3.9132e+05, 1.1090e+00, 1.1445e+00, 3.9150e+05,
         1.2697e+00, 3.9337e+05, 1.3019e+00, 3.7942e+05, 3.8181e+05, 3.8989e+05,
         1.0742e+00, 3.8545e+05, 3.7684e+05, 1.3335e+00],
        [1.3609e+00, 0.0000e+00, 3.9132e+05, 1.1581e+00, 1.2629e+00, 3.9150e+05,
         1.8272e+00, 3.9339e+05, 1.1969e+00, 3.7940e+05, 3.8182e+05, 3.8988e+05,
         1.3012e+00, 3.8541e+05, 3.7687e+05, 1.2321e+00],
        [3.9132e+05, 3.9132e+05, 0.0000e+00, 3.9132e+05, 3.9132e+05, 7.8295e+05,
         3.9131e+05, 7.8022e+05, 3.9133e+05, 7.8563e+05, 7.8255e+05, 7.7340e+05,
         3.9131e+05, 7.5347e+05, 7.6926e+05, 3.9133e+05],
        [1.1090e+00, 1.1581e+00, 3.9132e+05, 0.0000e+00, 1.1000e+00, 3.9147e+05,
         1.6129e+00, 3.9340e+05, 1.2132e+00, 3.7943e+05, 3.8180e+05, 3.8989e+05,
         1.2044e+00, 3.8541e+05, 3.7684e+05, 1.1642e+00],
        [1.1445e+00, 1.2629e+00, 3.9132e+05, 1.1000e+00, 0.0000e+00, 3.9146e+05,
         1.4137e+00, 3.9336e+05, 1.2809e+00, 3.7942e+05, 3.8182e+05, 3.8987e+05,
         1.1296e+00, 3.8541e+05, 3.7684e+05, 1.3100e+00],
        [3.9150e+05, 3.9150e+05, 7.8295e+05, 3.9147e+05, 3.9146e+05, 0.0000e+00,
         3.9152e+05, 7.9031e+05, 3.9149e+05, 7.5721e+05, 7.8947e+05, 7.9341e+05,
         3.9151e+05, 7.5660e+05, 7.4927e+05, 3.9149e+05],
        [1.2697e+00, 1.8272e+00, 3.9131e+05, 1.6129e+00, 1.4137e+00, 3.9152e+05,
         0.0000e+00, 3.9337e+05, 1.8247e+00, 3.7941e+05, 3.8185e+05, 3.8990e+05,
         1.3658e+00, 3.8544e+05, 3.7681e+05, 1.8158e+00],
        [3.9337e+05, 3.9339e+05, 7.8022e+05, 3.9340e+05, 3.9336e+05, 7.9031e+05,
         3.9337e+05, 0.0000e+00, 3.9337e+05, 7.8402e+05, 7.9060e+05, 7.7071e+05,
         3.9336e+05, 7.9068e+05, 7.7452e+05, 3.9337e+05],
        [1.3019e+00, 1.1969e+00, 3.9133e+05, 1.2132e+00, 1.2809e+00, 3.9149e+05,
         1.8247e+00, 3.9337e+05, 0.0000e+00, 3.7939e+05, 3.8181e+05, 3.8989e+05,
         1.3496e+00, 3.8540e+05, 3.7687e+05, 1.2865e+00],
        [3.7942e+05, 3.7940e+05, 7.8563e+05, 3.7943e+05, 3.7942e+05, 7.5721e+05,
         3.7941e+05, 7.8402e+05, 3.7939e+05, 0.0000e+00, 7.6258e+05, 7.7711e+05,
         3.7942e+05, 7.5762e+05, 7.5398e+05, 3.7943e+05],
        [3.8181e+05, 3.8182e+05, 7.8255e+05, 3.8180e+05, 3.8182e+05, 7.8947e+05,
         3.8185e+05, 7.9060e+05, 3.8181e+05, 7.6258e+05, 0.0000e+00, 7.7592e+05,
         3.8179e+05, 7.5691e+05, 7.6295e+05, 3.8185e+05],
        [3.8989e+05, 3.8988e+05, 7.7340e+05, 3.8989e+05, 3.8987e+05, 7.9341e+05,
         3.8990e+05, 7.7071e+05, 3.8989e+05, 7.7711e+05, 7.7592e+05, 0.0000e+00,
         3.8988e+05, 7.9359e+05, 7.6432e+05, 3.8988e+05],
        [1.0742e+00, 1.3012e+00, 3.9131e+05, 1.2044e+00, 1.1296e+00, 3.9151e+05,
         1.3658e+00, 3.9336e+05, 1.3496e+00, 3.7942e+05, 3.8179e+05, 3.8988e+05,
         0.0000e+00, 3.8543e+05, 3.7686e+05, 1.3967e+00],
        [3.8545e+05, 3.8541e+05, 7.5347e+05, 3.8541e+05, 3.8541e+05, 7.5660e+05,
         3.8544e+05, 7.9068e+05, 3.8540e+05, 7.5762e+05, 7.5691e+05, 7.9359e+05,
         3.8543e+05, 0.0000e+00, 7.6239e+05, 3.8540e+05],
        [3.7684e+05, 3.7687e+05, 7.6926e+05, 3.7684e+05, 3.7684e+05, 7.4927e+05,
         3.7681e+05, 7.7452e+05, 3.7687e+05, 7.5398e+05, 7.6295e+05, 7.6432e+05,
         3.7686e+05, 7.6239e+05, 0.0000e+00, 3.7683e+05],
        [1.3335e+00, 1.2321e+00, 3.9133e+05, 1.1642e+00, 1.3100e+00, 3.9149e+05,
         1.8158e+00, 3.9337e+05, 1.2865e+00, 3.7943e+05, 3.8185e+05, 3.8988e+05,
         1.3967e+00, 3.8540e+05, 3.7683e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.0742e+00, 1.1090e+00, 1.1445e+00, 1.2697e+00, 1.3019e+00,
        1.3335e+00, 1.3609e+00, 3.7684e+05, 3.7942e+05, 3.8181e+05, 3.8545e+05,
        3.8989e+05, 3.9132e+05, 3.9150e+05, 3.9337e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1581e+00, 1.1969e+00, 1.2321e+00, 1.2629e+00, 1.3012e+00,
        1.3609e+00, 1.8272e+00, 3.7687e+05, 3.7940e+05, 3.8182e+05, 3.8541e+05,
        3.8988e+05, 3.9132e+05, 3.9150e+05, 3.9339e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391309.2500, 391313.8750, 391317.5000, 391318.5312,
        391324.1250, 391324.4688, 391327.5312, 391334.7500, 753467.0000,
        769256.3750, 773399.6250, 780218.7500, 782548.6250, 782954.6875,
        785630.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1000e+00, 1.1090e+00, 1.1581e+00, 1.1642e+00, 1.2044e+00,
        1.2132e+00, 1.6129e+00, 3.7684e+05, 3.7943e+05, 3.8180e+05, 3.8541e+05,
        3.8989e+05, 3.9132e+05, 3.9147e+05, 3.9340e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1000e+00, 1.1296e+00, 1.1445e+00, 1.2629e+00, 1.2809e+00,
        1.3100e+00, 1.4137e+00, 3.7684e+05, 3.7942e+05, 3.8182e+05, 3.8541e+05,
        3.8987e+05, 3.9132e+05, 3.9146e+05, 3.9336e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391464.8438, 391474.6562, 391486.1875, 391494.0625,
        391500.9062, 391501.8125, 391509.4688, 391516.3750, 749269.6875,
        756601.1250, 757210.6875, 782954.6875, 789470.6875, 790313.0000,
        793412.4375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2697e+00, 1.3658e+00, 1.4137e+00, 1.6129e+00, 1.8158e+00,
        1.8247e+00, 1.8272e+00, 3.7681e+05, 3.7941e+05, 3.8185e+05, 3.8544e+05,
        3.8990e+05, 3.9131e+05, 3.9152e+05, 3.9337e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393355.9688, 393364.8438, 393367.8125, 393369.2188,
        393370.1875, 393371.6562, 393386.8125, 393402.0000, 770712.0625,
        774518.7500, 780218.7500, 784018.3750, 790313.0000, 790599.0625,
        790684.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1969e+00, 1.2132e+00, 1.2809e+00, 1.2865e+00, 1.3019e+00,
        1.3496e+00, 1.8247e+00, 3.7687e+05, 3.7939e+05, 3.8181e+05, 3.8540e+05,
        3.8989e+05, 3.9133e+05, 3.9149e+05, 3.9337e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379391.4062, 379400.9062, 379406.9375, 379418.5312,
        379421.3125, 379424.0938, 379425.1562, 379428.3125, 753983.8125,
        757210.6875, 757616.9375, 762577.0000, 777109.5000, 784018.3750,
        785630.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381790.5000, 381800.9688, 381810.0000, 381812.6250,
        381820.8750, 381821.5625, 381848.4688, 381848.6250, 756911.6250,
        762577.0000, 762949.1250, 775917.1875, 782548.6250, 789470.6875,
        790599.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389873.0000, 389880.1875, 389881.7188, 389884.6250,
        389887.9062, 389890.8125, 389894.2188, 389897.5312, 764315.5000,
        770712.0625, 773399.6250, 775917.1875, 777109.5000, 793412.4375,
        793592.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0742e+00, 1.1296e+00, 1.2044e+00, 1.3012e+00, 1.3496e+00,
        1.3658e+00, 1.3967e+00, 3.7686e+05, 3.7942e+05, 3.8179e+05, 3.8543e+05,
        3.8988e+05, 3.9131e+05, 3.9151e+05, 3.9336e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385401.7500, 385403.3438, 385405.1875, 385407.4062,
        385414.8438, 385425.7812, 385435.5625, 385454.5625, 753467.0000,
        756601.1250, 756911.6250, 757616.9375, 762390.1250, 790684.3750,
        793592.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 376810.8750, 376831.8438, 376835.6875, 376837.4375,
        376842.4688, 376855.7812, 376866.9062, 376868.4375, 749269.6875,
        753983.8125, 762390.1250, 762949.1250, 764315.5000, 769256.3750,
        774518.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1642e+00, 1.2321e+00, 1.2865e+00, 1.3100e+00, 1.3335e+00,
        1.3967e+00, 1.8158e+00, 3.7683e+05, 3.7943e+05, 3.8185e+05, 3.8540e+05,
        3.8988e+05, 3.9133e+05, 3.9149e+05, 3.9337e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['113808.52', '113809.95', '465329.31', '113807.05', '113808.62', '463781.91', '113807.75', '469221.94', '113808.04', '454651.09', '457404.19', '465411.75', '113807.64', '459341.66', '451800.31', '113811.81']
estimated f for each client, fs: [8, 8, 5, 8, 8, 5, 8, 5, 8, 5, 5, 5, 8, 5, 6, 8]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 11, 18, 12, 4, 20, 2, 15, 7, 17, 19, 13, 5, 14, 16, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0117s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:28...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:28, End: 2025-07-22 16:01:28)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 3, 5, 15, 8, 10, 14, 13, 2, 20, 1, 12, 4, 19, 11, 18], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3749e+00, 1.4650e+00, 3.8021e+05, 1.4832e+00, 1.4217e+00,
         3.8130e+05, 3.9292e+05, 1.6325e+00, 3.8452e+05, 1.3240e+00, 1.5923e+00,
         1.3977e+00, 3.8629e+05, 1.2374e+00, 3.8440e+05],
        [1.3749e+00, 0.0000e+00, 1.2591e+00, 3.8027e+05, 1.3032e+00, 1.2645e+00,
         3.8130e+05, 3.9292e+05, 1.2933e+00, 3.8445e+05, 1.3117e+00, 1.3337e+00,
         1.2533e+00, 3.8632e+05, 1.4176e+00, 3.8439e+05],
        [1.4650e+00, 1.2591e+00, 0.0000e+00, 3.8025e+05, 1.2788e+00, 1.1779e+00,
         3.8134e+05, 3.9292e+05, 1.2016e+00, 3.8448e+05, 1.4629e+00, 1.1814e+00,
         1.2646e+00, 3.8628e+05, 1.4307e+00, 3.8437e+05],
        [3.8021e+05, 3.8027e+05, 3.8025e+05, 0.0000e+00, 3.8024e+05, 3.8026e+05,
         7.5405e+05, 7.8879e+05, 3.8026e+05, 7.6965e+05, 3.8027e+05, 3.8024e+05,
         3.8025e+05, 7.6758e+05, 3.8023e+05, 7.4777e+05],
        [1.4832e+00, 1.3032e+00, 1.2788e+00, 3.8024e+05, 0.0000e+00, 1.2367e+00,
         3.8134e+05, 3.9289e+05, 1.2470e+00, 3.8447e+05, 1.4692e+00, 1.2937e+00,
         1.2520e+00, 3.8631e+05, 1.4146e+00, 3.8435e+05],
        [1.4217e+00, 1.2645e+00, 1.1779e+00, 3.8026e+05, 1.2367e+00, 0.0000e+00,
         3.8132e+05, 3.9289e+05, 1.1032e+00, 3.8447e+05, 1.4192e+00, 1.1820e+00,
         1.2270e+00, 3.8629e+05, 1.4140e+00, 3.8437e+05],
        [3.8130e+05, 3.8130e+05, 3.8134e+05, 7.5405e+05, 3.8134e+05, 3.8132e+05,
         0.0000e+00, 7.7911e+05, 3.8135e+05, 7.5509e+05, 3.8135e+05, 3.8132e+05,
         3.8134e+05, 7.6356e+05, 3.8133e+05, 7.6760e+05],
        [3.9292e+05, 3.9292e+05, 3.9292e+05, 7.8879e+05, 3.9289e+05, 3.9289e+05,
         7.7911e+05, 0.0000e+00, 3.9292e+05, 7.8033e+05, 3.9293e+05, 3.9292e+05,
         3.9290e+05, 7.8822e+05, 3.9291e+05, 7.8480e+05],
        [1.6325e+00, 1.2933e+00, 1.2016e+00, 3.8026e+05, 1.2470e+00, 1.1032e+00,
         3.8135e+05, 3.9292e+05, 0.0000e+00, 3.8448e+05, 1.5557e+00, 1.1276e+00,
         1.2033e+00, 3.8629e+05, 1.5312e+00, 3.8436e+05],
        [3.8452e+05, 3.8445e+05, 3.8448e+05, 7.6965e+05, 3.8447e+05, 3.8447e+05,
         7.5509e+05, 7.8033e+05, 3.8448e+05, 0.0000e+00, 3.8444e+05, 3.8447e+05,
         3.8445e+05, 7.8426e+05, 3.8449e+05, 7.8007e+05],
        [1.3240e+00, 1.3117e+00, 1.4629e+00, 3.8027e+05, 1.4692e+00, 1.4192e+00,
         3.8135e+05, 3.9293e+05, 1.5557e+00, 3.8444e+05, 0.0000e+00, 1.5714e+00,
         1.3398e+00, 3.8632e+05, 1.2664e+00, 3.8438e+05],
        [1.5923e+00, 1.3337e+00, 1.1814e+00, 3.8024e+05, 1.2937e+00, 1.1820e+00,
         3.8132e+05, 3.9292e+05, 1.1276e+00, 3.8447e+05, 1.5714e+00, 0.0000e+00,
         1.2039e+00, 3.8629e+05, 1.4859e+00, 3.8438e+05],
        [1.3977e+00, 1.2533e+00, 1.2646e+00, 3.8025e+05, 1.2520e+00, 1.2270e+00,
         3.8134e+05, 3.9290e+05, 1.2033e+00, 3.8445e+05, 1.3398e+00, 1.2039e+00,
         0.0000e+00, 3.8631e+05, 1.3323e+00, 3.8436e+05],
        [3.8629e+05, 3.8632e+05, 3.8628e+05, 7.6758e+05, 3.8631e+05, 3.8629e+05,
         7.6356e+05, 7.8822e+05, 3.8629e+05, 7.8426e+05, 3.8632e+05, 3.8629e+05,
         3.8631e+05, 0.0000e+00, 3.8632e+05, 7.7152e+05],
        [1.2374e+00, 1.4176e+00, 1.4307e+00, 3.8023e+05, 1.4146e+00, 1.4140e+00,
         3.8133e+05, 3.9291e+05, 1.5312e+00, 3.8449e+05, 1.2664e+00, 1.4859e+00,
         1.3323e+00, 3.8632e+05, 0.0000e+00, 3.8440e+05],
        [3.8440e+05, 3.8439e+05, 3.8437e+05, 7.4777e+05, 3.8435e+05, 3.8437e+05,
         7.6760e+05, 7.8480e+05, 3.8436e+05, 7.8007e+05, 3.8438e+05, 3.8438e+05,
         3.8436e+05, 7.7152e+05, 3.8440e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2374e+00, 1.3240e+00, 1.3749e+00, 1.3977e+00, 1.4217e+00,
        1.4650e+00, 1.4832e+00, 1.5923e+00, 1.6325e+00, 3.8021e+05, 3.8130e+05,
        3.8440e+05, 3.8452e+05, 3.8629e+05, 3.9292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2533e+00, 1.2591e+00, 1.2645e+00, 1.2933e+00, 1.3032e+00,
        1.3117e+00, 1.3337e+00, 1.3749e+00, 1.4176e+00, 3.8027e+05, 3.8130e+05,
        3.8439e+05, 3.8445e+05, 3.8632e+05, 3.9292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1779e+00, 1.1814e+00, 1.2016e+00, 1.2591e+00, 1.2646e+00,
        1.2788e+00, 1.4307e+00, 1.4629e+00, 1.4650e+00, 3.8025e+05, 3.8134e+05,
        3.8437e+05, 3.8448e+05, 3.8628e+05, 3.9292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380211.6250, 380225.7188, 380241.3750, 380244.4062,
        380248.0312, 380249.7812, 380257.2812, 380260.0000, 380265.1875,
        380271.9375, 747772.7500, 754051.7500, 767579.6250, 769653.0000,
        788793.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2367e+00, 1.2470e+00, 1.2520e+00, 1.2788e+00, 1.2937e+00,
        1.3032e+00, 1.4146e+00, 1.4692e+00, 1.4832e+00, 3.8024e+05, 3.8134e+05,
        3.8435e+05, 3.8447e+05, 3.8631e+05, 3.9289e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1032e+00, 1.1779e+00, 1.1820e+00, 1.2270e+00, 1.2367e+00,
        1.2645e+00, 1.4140e+00, 1.4192e+00, 1.4217e+00, 3.8026e+05, 3.8132e+05,
        3.8437e+05, 3.8447e+05, 3.8629e+05, 3.9289e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381300.8125, 381303.3125, 381315.9375, 381322.1562,
        381330.1250, 381336.8125, 381337.3750, 381337.6562, 381348.2188,
        381353.8125, 754051.7500, 755092.7500, 763555.5000, 767603.8750,
        779107.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392889.3750, 392892.6875, 392904.5625, 392911.1250,
        392915.9688, 392917.4062, 392918.7812, 392919.3125, 392922.3750,
        392932.8750, 779107.1875, 780325.3125, 784801.1875, 788218.5000,
        788793.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1032e+00, 1.1276e+00, 1.2016e+00, 1.2033e+00, 1.2470e+00,
        1.2933e+00, 1.5312e+00, 1.5557e+00, 1.6325e+00, 3.8026e+05, 3.8135e+05,
        3.8436e+05, 3.8448e+05, 3.8629e+05, 3.9292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384444.8750, 384446.0312, 384448.3438, 384466.6875,
        384466.7812, 384472.5000, 384476.5000, 384478.2812, 384488.6875,
        384518.6250, 755092.7500, 769653.0000, 780073.0000, 780325.3125,
        784261.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2664e+00, 1.3117e+00, 1.3240e+00, 1.3398e+00, 1.4192e+00,
        1.4629e+00, 1.4692e+00, 1.5557e+00, 1.5714e+00, 3.8027e+05, 3.8135e+05,
        3.8438e+05, 3.8444e+05, 3.8632e+05, 3.9293e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1276e+00, 1.1814e+00, 1.1820e+00, 1.2039e+00, 1.2937e+00,
        1.3337e+00, 1.4859e+00, 1.5714e+00, 1.5923e+00, 3.8024e+05, 3.8132e+05,
        3.8438e+05, 3.8447e+05, 3.8629e+05, 3.9292e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2033e+00, 1.2039e+00, 1.2270e+00, 1.2520e+00, 1.2533e+00,
        1.2646e+00, 1.3323e+00, 1.3398e+00, 1.3977e+00, 3.8025e+05, 3.8134e+05,
        3.8436e+05, 3.8445e+05, 3.8631e+05, 3.9290e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386279.5000, 386285.8125, 386285.8750, 386291.5938,
        386293.1250, 386305.3750, 386308.2188, 386317.1250, 386319.1875,
        386321.1875, 763555.5000, 767579.6250, 771519.1875, 784261.0000,
        788218.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2374e+00, 1.2664e+00, 1.3323e+00, 1.4140e+00, 1.4146e+00,
        1.4176e+00, 1.4307e+00, 1.4859e+00, 1.5312e+00, 3.8023e+05, 3.8133e+05,
        3.8440e+05, 3.8449e+05, 3.8632e+05, 3.9291e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384345.3125, 384362.0938, 384362.4375, 384367.5938,
        384372.4688, 384377.3125, 384382.8750, 384391.7500, 384397.0625,
        384403.1875, 747772.7500, 767603.8750, 771519.1875, 780073.0000,
        784801.1875])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['38022.45', '38027.70', '38025.98', '380247.53', '38025.64', '38027.14', '381328.62', '392912.44', '38026.91', '384470.72', '38028.46', '38025.34', '38026.13', '386300.75', '38023.83', '384376.19']
estimated f for each client, fs: [6, 6, 6, 4, 6, 6, 4, 4, 6, 4, 6, 6, 6, 4, 6, 4]
selected_index: 0
rkrum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 3, 5, 15, 8, 10, 14, 13, 2, 20, 1, 12, 4, 19, 11, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:29...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:29, End: 2025-07-22 16:01:29)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 6, 2, 13, 14, 5, 17, 7, 11, 16, 20, 9, 19, 10, 18, 15], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5205e+00, 1.4207e+00, 4.0260e+05, 3.9776e+05, 1.3598e+00,
         3.8759e+05, 1.4873e+00, 1.5593e+00, 3.9684e+05, 3.9431e+05, 1.4438e+00,
         3.8255e+05, 1.3299e+00, 3.8393e+05, 3.9754e+05],
        [1.5205e+00, 0.0000e+00, 1.7000e+00, 4.0265e+05, 3.9775e+05, 1.6789e+00,
         3.8759e+05, 1.6216e+00, 1.4463e+00, 3.9682e+05, 3.9426e+05, 1.3509e+00,
         3.8257e+05, 1.5616e+00, 3.8391e+05, 3.9754e+05],
        [1.4207e+00, 1.7000e+00, 0.0000e+00, 4.0264e+05, 3.9772e+05, 1.3429e+00,
         3.8758e+05, 1.3557e+00, 1.6578e+00, 3.9688e+05, 3.9429e+05, 1.7124e+00,
         3.8254e+05, 1.1576e+00, 3.8393e+05, 3.9753e+05],
        [4.0260e+05, 4.0265e+05, 4.0264e+05, 0.0000e+00, 7.9181e+05, 4.0261e+05,
         7.7179e+05, 4.0266e+05, 4.0263e+05, 7.9214e+05, 7.8758e+05, 4.0264e+05,
         7.6860e+05, 4.0266e+05, 7.9261e+05, 8.1487e+05],
        [3.9776e+05, 3.9775e+05, 3.9772e+05, 7.9181e+05, 0.0000e+00, 3.9776e+05,
         8.0459e+05, 3.9779e+05, 3.9777e+05, 7.8956e+05, 7.9992e+05, 3.9774e+05,
         7.6181e+05, 3.9773e+05, 7.8745e+05, 8.0562e+05],
        [1.3598e+00, 1.6789e+00, 1.3429e+00, 4.0261e+05, 3.9776e+05, 0.0000e+00,
         3.8755e+05, 1.3946e+00, 1.5196e+00, 3.9684e+05, 3.9430e+05, 1.6367e+00,
         3.8258e+05, 1.2577e+00, 3.8395e+05, 3.9750e+05],
        [3.8759e+05, 3.8759e+05, 3.8758e+05, 7.7179e+05, 8.0459e+05, 3.8755e+05,
         0.0000e+00, 3.8757e+05, 3.8758e+05, 8.0347e+05, 7.6862e+05, 3.8760e+05,
         7.5999e+05, 3.8759e+05, 7.8628e+05, 7.9828e+05],
        [1.4873e+00, 1.6216e+00, 1.3557e+00, 4.0266e+05, 3.9779e+05, 1.3946e+00,
         3.8757e+05, 0.0000e+00, 1.4776e+00, 3.9684e+05, 3.9429e+05, 1.5536e+00,
         3.8256e+05, 1.3353e+00, 3.8393e+05, 3.9753e+05],
        [1.5593e+00, 1.4463e+00, 1.6578e+00, 4.0263e+05, 3.9777e+05, 1.5196e+00,
         3.8758e+05, 1.4776e+00, 0.0000e+00, 3.9685e+05, 3.9429e+05, 1.4182e+00,
         3.8259e+05, 1.4898e+00, 3.8392e+05, 3.9754e+05],
        [3.9684e+05, 3.9682e+05, 3.9688e+05, 7.9214e+05, 7.8956e+05, 3.9684e+05,
         8.0347e+05, 3.9684e+05, 3.9685e+05, 0.0000e+00, 7.9361e+05, 3.9685e+05,
         7.6677e+05, 3.9685e+05, 7.7661e+05, 8.0271e+05],
        [3.9431e+05, 3.9426e+05, 3.9429e+05, 7.8758e+05, 7.9992e+05, 3.9430e+05,
         7.6862e+05, 3.9429e+05, 3.9429e+05, 7.9361e+05, 0.0000e+00, 3.9430e+05,
         7.9574e+05, 3.9426e+05, 7.7951e+05, 7.9515e+05],
        [1.4438e+00, 1.3509e+00, 1.7124e+00, 4.0264e+05, 3.9774e+05, 1.6367e+00,
         3.8760e+05, 1.5536e+00, 1.4182e+00, 3.9685e+05, 3.9430e+05, 0.0000e+00,
         3.8255e+05, 1.5157e+00, 3.8390e+05, 3.9753e+05],
        [3.8255e+05, 3.8257e+05, 3.8254e+05, 7.6860e+05, 7.6181e+05, 3.8258e+05,
         7.5999e+05, 3.8256e+05, 3.8259e+05, 7.6677e+05, 7.9574e+05, 3.8255e+05,
         0.0000e+00, 3.8257e+05, 7.4355e+05, 7.7546e+05],
        [1.3299e+00, 1.5616e+00, 1.1576e+00, 4.0266e+05, 3.9773e+05, 1.2577e+00,
         3.8759e+05, 1.3353e+00, 1.4898e+00, 3.9685e+05, 3.9426e+05, 1.5157e+00,
         3.8257e+05, 0.0000e+00, 3.8393e+05, 3.9753e+05],
        [3.8393e+05, 3.8391e+05, 3.8393e+05, 7.9261e+05, 7.8745e+05, 3.8395e+05,
         7.8628e+05, 3.8393e+05, 3.8392e+05, 7.7661e+05, 7.7951e+05, 3.8390e+05,
         7.4355e+05, 3.8393e+05, 0.0000e+00, 7.9305e+05],
        [3.9754e+05, 3.9754e+05, 3.9753e+05, 8.1487e+05, 8.0562e+05, 3.9750e+05,
         7.9828e+05, 3.9753e+05, 3.9754e+05, 8.0271e+05, 7.9515e+05, 3.9753e+05,
         7.7546e+05, 3.9753e+05, 7.9305e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3299e+00, 1.3598e+00, 1.4207e+00, 1.4438e+00, 1.4873e+00,
        1.5205e+00, 1.5593e+00, 3.8255e+05, 3.8393e+05, 3.8759e+05, 3.9431e+05,
        3.9684e+05, 3.9754e+05, 3.9776e+05, 4.0260e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3509e+00, 1.4463e+00, 1.5205e+00, 1.5616e+00, 1.6216e+00,
        1.6789e+00, 1.7000e+00, 3.8257e+05, 3.8391e+05, 3.8759e+05, 3.9426e+05,
        3.9682e+05, 3.9754e+05, 3.9775e+05, 4.0265e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1576e+00, 1.3429e+00, 1.3557e+00, 1.4207e+00, 1.6578e+00,
        1.7000e+00, 1.7124e+00, 3.8254e+05, 3.8393e+05, 3.8758e+05, 3.9429e+05,
        3.9688e+05, 3.9753e+05, 3.9772e+05, 4.0264e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402600.0625, 402610.4688, 402628.5938, 402639.1875,
        402640.8438, 402645.1562, 402659.4688, 402664.5625, 768595.8125,
        771794.1250, 787579.3750, 791812.3750, 792140.3750, 792606.0625,
        814870.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397722.4062, 397731.9062, 397735.7500, 397751.8125,
        397759.5625, 397763.3750, 397767.1562, 397787.7500, 761812.5000,
        787446.6250, 789557.3125, 791812.3750, 799922.1875, 804587.6250,
        805622.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2577e+00, 1.3429e+00, 1.3598e+00, 1.3946e+00, 1.5196e+00,
        1.6367e+00, 1.6789e+00, 3.8258e+05, 3.8395e+05, 3.8755e+05, 3.9430e+05,
        3.9684e+05, 3.9750e+05, 3.9776e+05, 4.0261e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387545.7188, 387566.5938, 387583.0938, 387584.2812,
        387589.3438, 387590.9062, 387591.0938, 387595.5938, 759992.7500,
        768623.0000, 771794.1250, 786277.0625, 798280.8750, 803470.5625,
        804587.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3353e+00, 1.3557e+00, 1.3946e+00, 1.4776e+00, 1.4873e+00,
        1.5536e+00, 1.6216e+00, 3.8256e+05, 3.8393e+05, 3.8757e+05, 3.9429e+05,
        3.9684e+05, 3.9753e+05, 3.9779e+05, 4.0266e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4182e+00, 1.4463e+00, 1.4776e+00, 1.4898e+00, 1.5196e+00,
        1.5593e+00, 1.6578e+00, 3.8259e+05, 3.8392e+05, 3.8758e+05, 3.9429e+05,
        3.9685e+05, 3.9754e+05, 3.9777e+05, 4.0263e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396819.9375, 396839.5000, 396841.2188, 396843.5938,
        396845.0625, 396849.8750, 396851.4375, 396880.2188, 766772.0000,
        776608.8750, 789557.3125, 792140.3750, 793613.0000, 802714.5000,
        803470.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394261.6250, 394263.9688, 394285.5625, 394288.3125,
        394292.4688, 394300.4375, 394301.0312, 394312.4062, 768623.0000,
        779505.7500, 787579.3750, 793613.0000, 795147.3750, 795742.8750,
        799922.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3509e+00, 1.4182e+00, 1.4438e+00, 1.5157e+00, 1.5536e+00,
        1.6367e+00, 1.7124e+00, 3.8255e+05, 3.8390e+05, 3.8760e+05, 3.9430e+05,
        3.9685e+05, 3.9753e+05, 3.9774e+05, 4.0264e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382540.1250, 382550.1250, 382550.4062, 382562.2812,
        382568.0000, 382573.8438, 382582.1562, 382588.9375, 743546.0625,
        759992.7500, 761812.5000, 766772.0000, 768595.8125, 775455.1250,
        795742.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1576e+00, 1.2577e+00, 1.3299e+00, 1.3353e+00, 1.4898e+00,
        1.5157e+00, 1.5616e+00, 3.8257e+05, 3.8393e+05, 3.8759e+05, 3.9426e+05,
        3.9685e+05, 3.9753e+05, 3.9773e+05, 4.0266e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383896.9375, 383906.2812, 383923.1250, 383928.9688,
        383929.2188, 383929.8125, 383931.8750, 383949.2500, 743546.0625,
        776608.8750, 779505.7500, 786277.0625, 787446.6250, 792606.0625,
        793054.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397496.3125, 397526.6562, 397528.5625, 397531.5938,
        397534.9688, 397536.8750, 397538.2500, 397540.0000, 775455.1250,
        793054.9375, 795147.3750, 798280.8750, 802714.5000, 805622.3750,
        814870.8750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['115408.09', '115408.19', '115406.55', '476147.81', '473127.91', '115408.73', '462926.19', '115406.89', '115410.70', '471815.16', '470243.44', '115405.33', '456405.44', '115409.60', '459155.09', '474874.31']
estimated f for each client, fs: [8, 8, 8, 5, 5, 8, 5, 8, 8, 5, 5, 8, 5, 8, 6, 5]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 6, 2, 13, 14, 5, 17, 7, 11, 16, 20, 9, 19, 10, 18, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0237s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:29...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[160  77]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:29, End: 2025-07-22 16:01:29)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 17, 20, 9, 11, 12, 3, 1, 14, 15, 8, 4, 13, 7, 16, 19], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8487e+05, 3.9094e+05, 1.3786e+00, 1.6155e+00, 1.1638e+00,
         1.4039e+00, 1.6099e+00, 3.6787e+05, 3.9561e+05, 1.4340e+00, 1.3672e+00,
         3.9709e+05, 1.3589e+00, 3.8863e+05, 3.8265e+05],
        [3.8487e+05, 0.0000e+00, 7.9461e+05, 3.8490e+05, 3.8484e+05, 3.8488e+05,
         3.8488e+05, 3.8487e+05, 7.3916e+05, 7.7682e+05, 3.8489e+05, 3.8490e+05,
         7.8133e+05, 3.8488e+05, 7.6579e+05, 7.6716e+05],
        [3.9094e+05, 7.9461e+05, 0.0000e+00, 3.9093e+05, 3.9094e+05, 3.9093e+05,
         3.9094e+05, 3.9091e+05, 7.6236e+05, 7.9368e+05, 3.9092e+05, 3.9097e+05,
         7.9051e+05, 3.9096e+05, 8.0660e+05, 7.9102e+05],
        [1.3786e+00, 3.8490e+05, 3.9093e+05, 0.0000e+00, 1.5422e+00, 1.3338e+00,
         1.4812e+00, 1.5205e+00, 3.6788e+05, 3.9562e+05, 1.5007e+00, 1.4395e+00,
         3.9708e+05, 1.4840e+00, 3.8867e+05, 3.8262e+05],
        [1.6155e+00, 3.8484e+05, 3.9094e+05, 1.5422e+00, 0.0000e+00, 1.4136e+00,
         1.5541e+00, 1.4070e+00, 3.6788e+05, 3.9562e+05, 1.5610e+00, 1.4679e+00,
         3.9713e+05, 1.4289e+00, 3.8862e+05, 3.8258e+05],
        [1.1638e+00, 3.8488e+05, 3.9093e+05, 1.3338e+00, 1.4136e+00, 0.0000e+00,
         1.3141e+00, 1.5475e+00, 3.6787e+05, 3.9563e+05, 1.3507e+00, 1.2505e+00,
         3.9711e+05, 1.3197e+00, 3.8866e+05, 3.8264e+05],
        [1.4039e+00, 3.8488e+05, 3.9094e+05, 1.4812e+00, 1.5541e+00, 1.3141e+00,
         0.0000e+00, 1.4862e+00, 3.6788e+05, 3.9564e+05, 1.4866e+00, 1.4476e+00,
         3.9707e+05, 1.4758e+00, 3.8865e+05, 3.8260e+05],
        [1.6099e+00, 3.8487e+05, 3.9091e+05, 1.5205e+00, 1.4070e+00, 1.5475e+00,
         1.4862e+00, 0.0000e+00, 3.6790e+05, 3.9562e+05, 1.7170e+00, 1.5012e+00,
         3.9710e+05, 1.5704e+00, 3.8870e+05, 3.8260e+05],
        [3.6787e+05, 7.3916e+05, 7.6236e+05, 3.6788e+05, 3.6788e+05, 3.6787e+05,
         3.6788e+05, 3.6790e+05, 0.0000e+00, 7.5209e+05, 3.6787e+05, 3.6790e+05,
         7.8663e+05, 3.6791e+05, 7.5574e+05, 7.4759e+05],
        [3.9561e+05, 7.7682e+05, 7.9368e+05, 3.9562e+05, 3.9562e+05, 3.9563e+05,
         3.9564e+05, 3.9562e+05, 7.5209e+05, 0.0000e+00, 3.9563e+05, 3.9561e+05,
         7.9676e+05, 3.9565e+05, 7.7857e+05, 7.7967e+05],
        [1.4340e+00, 3.8489e+05, 3.9092e+05, 1.5007e+00, 1.5610e+00, 1.3507e+00,
         1.4866e+00, 1.7170e+00, 3.6787e+05, 3.9563e+05, 0.0000e+00, 1.4293e+00,
         3.9710e+05, 1.4558e+00, 3.8866e+05, 3.8261e+05],
        [1.3672e+00, 3.8490e+05, 3.9097e+05, 1.4395e+00, 1.4679e+00, 1.2505e+00,
         1.4476e+00, 1.5012e+00, 3.6790e+05, 3.9561e+05, 1.4293e+00, 0.0000e+00,
         3.9710e+05, 1.3871e+00, 3.8865e+05, 3.8262e+05],
        [3.9709e+05, 7.8133e+05, 7.9051e+05, 3.9708e+05, 3.9713e+05, 3.9711e+05,
         3.9707e+05, 3.9710e+05, 7.8663e+05, 7.9676e+05, 3.9710e+05, 3.9710e+05,
         0.0000e+00, 3.9709e+05, 8.0313e+05, 7.8452e+05],
        [1.3589e+00, 3.8488e+05, 3.9096e+05, 1.4840e+00, 1.4289e+00, 1.3197e+00,
         1.4758e+00, 1.5704e+00, 3.6791e+05, 3.9565e+05, 1.4558e+00, 1.3871e+00,
         3.9709e+05, 0.0000e+00, 3.8863e+05, 3.8263e+05],
        [3.8863e+05, 7.6579e+05, 8.0660e+05, 3.8867e+05, 3.8862e+05, 3.8866e+05,
         3.8865e+05, 3.8870e+05, 7.5574e+05, 7.7857e+05, 3.8866e+05, 3.8865e+05,
         8.0313e+05, 3.8863e+05, 0.0000e+00, 7.7136e+05],
        [3.8265e+05, 7.6716e+05, 7.9102e+05, 3.8262e+05, 3.8258e+05, 3.8264e+05,
         3.8260e+05, 3.8260e+05, 7.4759e+05, 7.7967e+05, 3.8261e+05, 3.8262e+05,
         7.8452e+05, 3.8263e+05, 7.7136e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1638e+00, 1.3589e+00, 1.3672e+00, 1.3786e+00, 1.4039e+00,
        1.4340e+00, 1.6099e+00, 1.6155e+00, 3.6787e+05, 3.8265e+05, 3.8487e+05,
        3.8863e+05, 3.9094e+05, 3.9561e+05, 3.9709e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384839.0625, 384868.7188, 384869.3438, 384878.6562,
        384879.8125, 384883.3750, 384886.8125, 384897.4062, 384904.6875,
        739160.5000, 765785.5625, 767161.4375, 776820.7500, 781332.0625,
        794610.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390914.5938, 390920.9062, 390927.2500, 390929.3438,
        390938.2500, 390939.1875, 390944.5938, 390959.7500, 390974.5625,
        762361.2500, 790510.8750, 791022.3750, 793681.1250, 794610.5000,
        806597.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3338e+00, 1.3786e+00, 1.4395e+00, 1.4812e+00, 1.4840e+00,
        1.5007e+00, 1.5205e+00, 1.5422e+00, 3.6788e+05, 3.8262e+05, 3.8490e+05,
        3.8867e+05, 3.9093e+05, 3.9562e+05, 3.9708e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4070e+00, 1.4136e+00, 1.4289e+00, 1.4679e+00, 1.5422e+00,
        1.5541e+00, 1.5610e+00, 1.6155e+00, 3.6788e+05, 3.8258e+05, 3.8484e+05,
        3.8862e+05, 3.9094e+05, 3.9562e+05, 3.9713e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1638e+00, 1.2505e+00, 1.3141e+00, 1.3197e+00, 1.3338e+00,
        1.3507e+00, 1.4136e+00, 1.5475e+00, 3.6787e+05, 3.8264e+05, 3.8488e+05,
        3.8866e+05, 3.9093e+05, 3.9563e+05, 3.9711e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3141e+00, 1.4039e+00, 1.4476e+00, 1.4758e+00, 1.4812e+00,
        1.4862e+00, 1.4866e+00, 1.5541e+00, 3.6788e+05, 3.8260e+05, 3.8488e+05,
        3.8865e+05, 3.9094e+05, 3.9564e+05, 3.9707e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4070e+00, 1.4862e+00, 1.5012e+00, 1.5205e+00, 1.5475e+00,
        1.5704e+00, 1.6099e+00, 1.7170e+00, 3.6790e+05, 3.8260e+05, 3.8487e+05,
        3.8870e+05, 3.9091e+05, 3.9562e+05, 3.9710e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 367865.4375, 367870.7812, 367872.0312, 367880.9062,
        367884.1250, 367884.6562, 367897.2500, 367903.3438, 367912.2812,
        739160.5000, 747588.9375, 752089.6250, 755743.7500, 762361.2500,
        786632.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395612.2812, 395613.9375, 395618.5312, 395620.0625,
        395624.3125, 395626.3438, 395632.9062, 395636.8750, 395648.4375,
        752089.6250, 776820.7500, 778569.0000, 779671.6875, 793681.1250,
        796756.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3507e+00, 1.4293e+00, 1.4340e+00, 1.4558e+00, 1.4866e+00,
        1.5007e+00, 1.5610e+00, 1.7170e+00, 3.6787e+05, 3.8261e+05, 3.8489e+05,
        3.8866e+05, 3.9092e+05, 3.9563e+05, 3.9710e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2505e+00, 1.3672e+00, 1.3871e+00, 1.4293e+00, 1.4395e+00,
        1.4476e+00, 1.4679e+00, 1.5012e+00, 3.6790e+05, 3.8262e+05, 3.8490e+05,
        3.8865e+05, 3.9097e+05, 3.9561e+05, 3.9710e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397073.1250, 397079.8750, 397094.2500, 397094.6562,
        397100.5938, 397102.4375, 397104.5312, 397109.1250, 397126.0625,
        781332.0625, 784521.3125, 786632.2500, 790510.8750, 796756.6875,
        803126.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3197e+00, 1.3589e+00, 1.3871e+00, 1.4289e+00, 1.4558e+00,
        1.4758e+00, 1.4840e+00, 1.5704e+00, 3.6791e+05, 3.8263e+05, 3.8488e+05,
        3.8863e+05, 3.9096e+05, 3.9565e+05, 3.9709e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388620.5625, 388629.2500, 388634.6875, 388650.5312,
        388653.0312, 388657.4375, 388661.7500, 388671.7500, 388697.5000,
        755743.7500, 765785.5625, 771359.1875, 778569.0000, 803126.8125,
        806597.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382584.1250, 382595.1875, 382604.5312, 382614.0938,
        382621.1250, 382624.7500, 382634.0312, 382640.9688, 382649.1250,
        747588.9375, 767161.4375, 771359.1875, 779671.6875, 784521.3125,
        791022.3750])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['75053.25', '420306.81', '428080.94', '75052.05', '75048.08', '75051.71', '75048.78', '75051.41', '405013.12', '431272.31', '75049.68', '75053.58', '435521.69', '75055.78', '425362.00', '419115.69']
estimated f for each client, fs: [7, 5, 5, 7, 7, 7, 7, 7, 6, 5, 7, 7, 5, 7, 5, 5]
selected_index: 4
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 17, 20, 9, 11, 12, 3, 1, 14, 15, 8, 4, 13, 7, 16, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0145s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:30...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 48 215]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:30, End: 2025-07-22 16:01:30)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 4, 11, 17, 20, 10, 16, 5, 13, 19, 12, 9, 7, 15, 8, 1], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9515e+05, 3.9514e+05, 7.6351e+05, 7.9379e+05, 3.9516e+05,
         7.9362e+05, 3.9519e+05, 8.0025e+05, 8.0281e+05, 3.9515e+05, 3.9514e+05,
         3.9519e+05, 7.7760e+05, 3.9519e+05, 3.9519e+05],
        [3.9515e+05, 0.0000e+00, 1.4127e+00, 3.7448e+05, 3.9913e+05, 1.3792e+00,
         4.0848e+05, 1.3631e+00, 3.8684e+05, 4.0392e+05, 1.2244e+00, 1.3883e+00,
         1.3983e+00, 3.9140e+05, 1.4077e+00, 1.4670e+00],
        [3.9514e+05, 1.4127e+00, 0.0000e+00, 3.7450e+05, 3.9912e+05, 1.4749e+00,
         4.0850e+05, 1.3418e+00, 3.8686e+05, 4.0395e+05, 1.3812e+00, 1.4641e+00,
         1.4936e+00, 3.9138e+05, 1.5583e+00, 1.5685e+00],
        [7.6351e+05, 3.7448e+05, 3.7450e+05, 0.0000e+00, 7.7015e+05, 3.7450e+05,
         7.8680e+05, 3.7450e+05, 7.7239e+05, 7.7111e+05, 3.7451e+05, 3.7447e+05,
         3.7447e+05, 7.5758e+05, 3.7451e+05, 3.7448e+05],
        [7.9379e+05, 3.9913e+05, 3.9912e+05, 7.7015e+05, 0.0000e+00, 3.9912e+05,
         8.1799e+05, 3.9911e+05, 8.1081e+05, 7.8661e+05, 3.9912e+05, 3.9909e+05,
         3.9912e+05, 7.8292e+05, 3.9913e+05, 3.9912e+05],
        [3.9516e+05, 1.3792e+00, 1.4749e+00, 3.7450e+05, 3.9912e+05, 0.0000e+00,
         4.0849e+05, 1.3357e+00, 3.8685e+05, 4.0393e+05, 1.2549e+00, 1.3513e+00,
         1.4393e+00, 3.9138e+05, 1.4222e+00, 1.5141e+00],
        [7.9362e+05, 4.0848e+05, 4.0850e+05, 7.8680e+05, 8.1799e+05, 4.0849e+05,
         0.0000e+00, 4.0849e+05, 7.7701e+05, 8.1752e+05, 4.0849e+05, 4.0846e+05,
         4.0849e+05, 8.1192e+05, 4.0848e+05, 4.0847e+05],
        [3.9519e+05, 1.3631e+00, 1.3418e+00, 3.7450e+05, 3.9911e+05, 1.3357e+00,
         4.0849e+05, 0.0000e+00, 3.8683e+05, 4.0395e+05, 1.2863e+00, 1.4271e+00,
         1.4145e+00, 3.9140e+05, 1.5220e+00, 1.5994e+00],
        [8.0025e+05, 3.8684e+05, 3.8686e+05, 7.7239e+05, 8.1081e+05, 3.8685e+05,
         7.7701e+05, 3.8683e+05, 0.0000e+00, 7.8611e+05, 3.8684e+05, 3.8684e+05,
         3.8684e+05, 7.6593e+05, 3.8683e+05, 3.8685e+05],
        [8.0281e+05, 4.0392e+05, 4.0395e+05, 7.7111e+05, 7.8661e+05, 4.0393e+05,
         8.1752e+05, 4.0395e+05, 7.8611e+05, 0.0000e+00, 4.0394e+05, 4.0393e+05,
         4.0392e+05, 8.2520e+05, 4.0394e+05, 4.0394e+05],
        [3.9515e+05, 1.2244e+00, 1.3812e+00, 3.7451e+05, 3.9912e+05, 1.2549e+00,
         4.0849e+05, 1.2863e+00, 3.8684e+05, 4.0394e+05, 0.0000e+00, 1.2953e+00,
         1.3880e+00, 3.9139e+05, 1.3770e+00, 1.5638e+00],
        [3.9514e+05, 1.3883e+00, 1.4641e+00, 3.7447e+05, 3.9909e+05, 1.3513e+00,
         4.0846e+05, 1.4271e+00, 3.8684e+05, 4.0393e+05, 1.2953e+00, 0.0000e+00,
         1.4199e+00, 3.9140e+05, 1.4858e+00, 1.4149e+00],
        [3.9519e+05, 1.3983e+00, 1.4936e+00, 3.7447e+05, 3.9912e+05, 1.4393e+00,
         4.0849e+05, 1.4145e+00, 3.8684e+05, 4.0392e+05, 1.3880e+00, 1.4199e+00,
         0.0000e+00, 3.9136e+05, 1.5062e+00, 1.5807e+00],
        [7.7760e+05, 3.9140e+05, 3.9138e+05, 7.5758e+05, 7.8292e+05, 3.9138e+05,
         8.1192e+05, 3.9140e+05, 7.6593e+05, 8.2520e+05, 3.9139e+05, 3.9140e+05,
         3.9136e+05, 0.0000e+00, 3.9138e+05, 3.9139e+05],
        [3.9519e+05, 1.4077e+00, 1.5583e+00, 3.7451e+05, 3.9913e+05, 1.4222e+00,
         4.0848e+05, 1.5220e+00, 3.8683e+05, 4.0394e+05, 1.3770e+00, 1.4858e+00,
         1.5062e+00, 3.9138e+05, 0.0000e+00, 1.6615e+00],
        [3.9519e+05, 1.4670e+00, 1.5685e+00, 3.7448e+05, 3.9912e+05, 1.5141e+00,
         4.0847e+05, 1.5994e+00, 3.8685e+05, 4.0394e+05, 1.5638e+00, 1.4149e+00,
         1.5807e+00, 3.9139e+05, 1.6615e+00, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 395141.4375, 395141.5312, 395147.8750, 395149.6562,
        395157.6875, 395185.0312, 395185.4375, 395186.9375, 395191.8750,
        763512.5625, 777596.6250, 793620.3750, 793786.8750, 800253.4375,
        802806.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2244e+00, 1.3631e+00, 1.3792e+00, 1.3883e+00, 1.3983e+00,
        1.4077e+00, 1.4127e+00, 1.4670e+00, 3.7448e+05, 3.8684e+05, 3.9140e+05,
        3.9515e+05, 3.9913e+05, 4.0392e+05, 4.0848e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3418e+00, 1.3812e+00, 1.4127e+00, 1.4641e+00, 1.4749e+00,
        1.4936e+00, 1.5583e+00, 1.5685e+00, 3.7450e+05, 3.8686e+05, 3.9138e+05,
        3.9514e+05, 3.9912e+05, 4.0395e+05, 4.0850e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 374470.1875, 374474.2188, 374477.7500, 374483.0625,
        374498.8750, 374503.3438, 374503.3750, 374508.3125, 374511.8438,
        757578.6875, 763512.5625, 770154.5000, 771114.0000, 772391.6250,
        786804.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399088.2188, 399114.2812, 399119.0938, 399123.6250,
        399123.9375, 399124.5625, 399124.5938, 399126.6562, 399134.0000,
        770154.5000, 782915.9375, 786606.3750, 793786.8750, 810806.5625,
        817986.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2549e+00, 1.3357e+00, 1.3513e+00, 1.3792e+00, 1.4222e+00,
        1.4393e+00, 1.4749e+00, 1.5141e+00, 3.7450e+05, 3.8685e+05, 3.9138e+05,
        3.9516e+05, 3.9912e+05, 4.0393e+05, 4.0849e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 408455.5000, 408472.0938, 408475.9688, 408477.3125,
        408490.4062, 408491.9688, 408493.4688, 408494.2500, 408496.0000,
        777011.6250, 786804.5000, 793620.3750, 811922.1875, 817518.1250,
        817986.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2863e+00, 1.3357e+00, 1.3418e+00, 1.3631e+00, 1.4145e+00,
        1.4271e+00, 1.5220e+00, 1.5994e+00, 3.7450e+05, 3.8683e+05, 3.9140e+05,
        3.9519e+05, 3.9911e+05, 4.0395e+05, 4.0849e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386828.6875, 386834.1875, 386835.8125, 386838.0625,
        386840.9375, 386841.6875, 386848.8125, 386851.4375, 386864.5938,
        765929.9375, 772391.6250, 777011.6250, 786108.1250, 800253.4375,
        810806.5625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403918.3750, 403923.4688, 403932.5625, 403932.7500,
        403935.7812, 403941.5000, 403944.0312, 403945.6875, 403952.9688,
        771114.0000, 786108.1250, 786606.3750, 802806.2500, 817518.1250,
        825198.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2244e+00, 1.2549e+00, 1.2863e+00, 1.2953e+00, 1.3770e+00,
        1.3812e+00, 1.3880e+00, 1.5638e+00, 3.7451e+05, 3.8684e+05, 3.9139e+05,
        3.9515e+05, 3.9912e+05, 4.0394e+05, 4.0849e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2953e+00, 1.3513e+00, 1.3883e+00, 1.4149e+00, 1.4199e+00,
        1.4271e+00, 1.4641e+00, 1.4858e+00, 3.7447e+05, 3.8684e+05, 3.9140e+05,
        3.9514e+05, 3.9909e+05, 4.0393e+05, 4.0846e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3880e+00, 1.3983e+00, 1.4145e+00, 1.4199e+00, 1.4393e+00,
        1.4936e+00, 1.5062e+00, 1.5807e+00, 3.7447e+05, 3.8684e+05, 3.9136e+05,
        3.9519e+05, 3.9912e+05, 4.0392e+05, 4.0849e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391360.0000, 391376.8750, 391380.1250, 391383.0000,
        391385.3750, 391389.9688, 391395.9688, 391400.0625, 391400.6875,
        757578.6875, 765929.9375, 777596.6250, 782915.9375, 811922.1875,
        825198.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3770e+00, 1.4077e+00, 1.4222e+00, 1.4858e+00, 1.5062e+00,
        1.5220e+00, 1.5583e+00, 1.6615e+00, 3.7451e+05, 3.8683e+05, 3.9138e+05,
        3.9519e+05, 3.9913e+05, 4.0394e+05, 4.0848e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.4149e+00, 1.4670e+00, 1.5141e+00, 1.5638e+00, 1.5685e+00,
        1.5807e+00, 1.5994e+00, 1.6615e+00, 3.7448e+05, 3.8685e+05, 3.9139e+05,
        3.9519e+05, 3.9912e+05, 4.0394e+05, 4.0847e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['432000.06', '76132.99', '76137.97', '412800.94', '436223.31', '76136.15', '445335.91', '76134.88', '424751.41', '440654.09', '76135.72', '76132.64', '76132.35', '428005.09', '76135.25', '76133.89']
estimated f for each client, fs: [5, 7, 7, 6, 5, 7, 5, 7, 5, 5, 7, 7, 7, 5, 7, 7]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 4, 11, 17, 20, 10, 16, 5, 13, 19, 12, 9, 7, 15, 8, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0249s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:31...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:31, End: 2025-07-22 16:01:31)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 11, 3, 14, 19, 2, 9, 13, 17, 20, 6, 8, 16, 5, 15, 18], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2953e+00, 1.3174e+00, 4.0125e+05, 3.8760e+05, 1.4405e+00,
         1.2799e+00, 3.8141e+05, 3.9621e+05, 3.8161e+05, 1.2235e+00, 1.4542e+00,
         4.0222e+05, 1.4039e+00, 3.9994e+05, 4.0400e+05],
        [1.2953e+00, 0.0000e+00, 1.3843e+00, 4.0126e+05, 3.8760e+05, 1.2395e+00,
         1.2224e+00, 3.8143e+05, 3.9623e+05, 3.8158e+05, 1.3891e+00, 1.2822e+00,
         4.0218e+05, 1.1583e+00, 3.9990e+05, 4.0404e+05],
        [1.3174e+00, 1.3843e+00, 0.0000e+00, 4.0129e+05, 3.8762e+05, 1.3080e+00,
         1.2967e+00, 3.8140e+05, 3.9621e+05, 3.8161e+05, 1.4164e+00, 1.3535e+00,
         4.0224e+05, 1.2727e+00, 3.9991e+05, 4.0400e+05],
        [4.0125e+05, 4.0126e+05, 4.0129e+05, 0.0000e+00, 7.6543e+05, 4.0129e+05,
         4.0127e+05, 7.8729e+05, 8.0067e+05, 7.8670e+05, 4.0126e+05, 4.0127e+05,
         8.0089e+05, 4.0127e+05, 8.0826e+05, 8.1692e+05],
        [3.8760e+05, 3.8760e+05, 3.8762e+05, 7.6543e+05, 0.0000e+00, 3.8758e+05,
         3.8760e+05, 7.7351e+05, 7.9927e+05, 7.8895e+05, 3.8760e+05, 3.8757e+05,
         7.9259e+05, 3.8760e+05, 7.7594e+05, 7.6751e+05],
        [1.4405e+00, 1.2395e+00, 1.3080e+00, 4.0129e+05, 3.8758e+05, 0.0000e+00,
         1.2510e+00, 3.8142e+05, 3.9624e+05, 3.8161e+05, 1.5028e+00, 1.2820e+00,
         4.0221e+05, 1.2474e+00, 3.9988e+05, 4.0404e+05],
        [1.2799e+00, 1.2224e+00, 1.2967e+00, 4.0127e+05, 3.8760e+05, 1.2510e+00,
         0.0000e+00, 3.8139e+05, 3.9623e+05, 3.8162e+05, 1.3495e+00, 1.3083e+00,
         4.0221e+05, 1.3421e+00, 3.9990e+05, 4.0404e+05],
        [3.8141e+05, 3.8143e+05, 3.8140e+05, 7.8729e+05, 7.7351e+05, 3.8142e+05,
         3.8139e+05, 0.0000e+00, 7.7976e+05, 7.6779e+05, 3.8142e+05, 3.8141e+05,
         7.7337e+05, 3.8144e+05, 7.7033e+05, 7.8540e+05],
        [3.9621e+05, 3.9623e+05, 3.9621e+05, 8.0067e+05, 7.9927e+05, 3.9624e+05,
         3.9623e+05, 7.7976e+05, 0.0000e+00, 7.9536e+05, 3.9623e+05, 3.9623e+05,
         7.9208e+05, 3.9624e+05, 7.8128e+05, 8.0408e+05],
        [3.8161e+05, 3.8158e+05, 3.8161e+05, 7.8670e+05, 7.8895e+05, 3.8161e+05,
         3.8162e+05, 7.6779e+05, 7.9536e+05, 0.0000e+00, 3.8160e+05, 3.8161e+05,
         7.7200e+05, 3.8156e+05, 7.9506e+05, 7.7383e+05],
        [1.2235e+00, 1.3891e+00, 1.4164e+00, 4.0126e+05, 3.8760e+05, 1.5028e+00,
         1.3495e+00, 3.8142e+05, 3.9623e+05, 3.8160e+05, 0.0000e+00, 1.4037e+00,
         4.0221e+05, 1.4623e+00, 3.9993e+05, 4.0403e+05],
        [1.4542e+00, 1.2822e+00, 1.3535e+00, 4.0127e+05, 3.8757e+05, 1.2820e+00,
         1.3083e+00, 3.8141e+05, 3.9623e+05, 3.8161e+05, 1.4037e+00, 0.0000e+00,
         4.0221e+05, 1.3054e+00, 3.9991e+05, 4.0402e+05],
        [4.0222e+05, 4.0218e+05, 4.0224e+05, 8.0089e+05, 7.9259e+05, 4.0221e+05,
         4.0221e+05, 7.7337e+05, 7.9208e+05, 7.7200e+05, 4.0221e+05, 4.0221e+05,
         0.0000e+00, 4.0222e+05, 8.0584e+05, 8.2200e+05],
        [1.4039e+00, 1.1583e+00, 1.2727e+00, 4.0127e+05, 3.8760e+05, 1.2474e+00,
         1.3421e+00, 3.8144e+05, 3.9624e+05, 3.8156e+05, 1.4623e+00, 1.3054e+00,
         4.0222e+05, 0.0000e+00, 3.9990e+05, 4.0404e+05],
        [3.9994e+05, 3.9990e+05, 3.9991e+05, 8.0826e+05, 7.7594e+05, 3.9988e+05,
         3.9990e+05, 7.7033e+05, 7.8128e+05, 7.9506e+05, 3.9993e+05, 3.9991e+05,
         8.0584e+05, 3.9990e+05, 0.0000e+00, 7.9677e+05],
        [4.0400e+05, 4.0404e+05, 4.0400e+05, 8.1692e+05, 7.6751e+05, 4.0404e+05,
         4.0404e+05, 7.8540e+05, 8.0408e+05, 7.7383e+05, 4.0403e+05, 4.0402e+05,
         8.2200e+05, 4.0404e+05, 7.9677e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.2235e+00, 1.2799e+00, 1.2953e+00, 1.3174e+00, 1.4039e+00,
        1.4405e+00, 1.4542e+00, 3.8141e+05, 3.8161e+05, 3.8760e+05, 3.9621e+05,
        3.9994e+05, 4.0125e+05, 4.0222e+05, 4.0400e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1583e+00, 1.2224e+00, 1.2395e+00, 1.2822e+00, 1.2953e+00,
        1.3843e+00, 1.3891e+00, 3.8143e+05, 3.8158e+05, 3.8760e+05, 3.9623e+05,
        3.9990e+05, 4.0126e+05, 4.0218e+05, 4.0404e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2727e+00, 1.2967e+00, 1.3080e+00, 1.3174e+00, 1.3535e+00,
        1.3843e+00, 1.4164e+00, 3.8140e+05, 3.8161e+05, 3.8762e+05, 3.9621e+05,
        3.9991e+05, 4.0129e+05, 4.0224e+05, 4.0400e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401250.1875, 401257.1875, 401257.3438, 401267.6250,
        401268.0000, 401271.4375, 401287.2500, 401289.1875, 765429.7500,
        786697.1875, 787293.3750, 800671.6250, 800894.1250, 808263.0000,
        816921.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387570.7500, 387581.1562, 387595.5625, 387599.4375,
        387599.8438, 387603.5938, 387604.9688, 387622.4062, 765429.7500,
        767506.5000, 773505.8125, 775944.8750, 788947.5000, 792586.5625,
        799271.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2395e+00, 1.2474e+00, 1.2510e+00, 1.2820e+00, 1.3080e+00,
        1.4405e+00, 1.5028e+00, 3.8142e+05, 3.8161e+05, 3.8758e+05, 3.9624e+05,
        3.9988e+05, 4.0129e+05, 4.0221e+05, 4.0404e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2224e+00, 1.2510e+00, 1.2799e+00, 1.2967e+00, 1.3083e+00,
        1.3421e+00, 1.3495e+00, 3.8139e+05, 3.8162e+05, 3.8760e+05, 3.9623e+05,
        3.9990e+05, 4.0127e+05, 4.0221e+05, 4.0404e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381390.9375, 381403.1562, 381406.4062, 381408.5000,
        381419.1875, 381422.8125, 381427.4062, 381436.4375, 767794.1250,
        770328.1875, 773367.1250, 773505.8125, 779757.0000, 785395.5000,
        787293.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396210.0312, 396214.6250, 396226.7500, 396231.0312,
        396232.3750, 396233.0625, 396238.0000, 396243.1562, 779757.0000,
        781275.4375, 792077.6250, 795363.0000, 799271.2500, 800671.6250,
        804080.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381562.7812, 381576.4375, 381602.3125, 381606.8125,
        381607.1250, 381610.0625, 381611.1875, 381615.4688, 767794.1250,
        772004.0000, 773834.1875, 786697.1875, 788947.5000, 795064.2500,
        795363.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2235e+00, 1.3495e+00, 1.3891e+00, 1.4037e+00, 1.4164e+00,
        1.4623e+00, 1.5028e+00, 3.8142e+05, 3.8160e+05, 3.8760e+05, 3.9623e+05,
        3.9993e+05, 4.0126e+05, 4.0221e+05, 4.0403e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2820e+00, 1.2822e+00, 1.3054e+00, 1.3083e+00, 1.3535e+00,
        1.4037e+00, 1.4542e+00, 3.8141e+05, 3.8161e+05, 3.8757e+05, 3.9623e+05,
        3.9991e+05, 4.0127e+05, 4.0221e+05, 4.0402e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402178.7500, 402206.0000, 402210.6875, 402213.5312,
        402213.8125, 402215.0312, 402217.3438, 402235.6250, 772004.0000,
        773367.1250, 792077.6250, 792586.5625, 800894.1250, 805840.5000,
        821996.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1583e+00, 1.2474e+00, 1.2727e+00, 1.3054e+00, 1.3421e+00,
        1.4039e+00, 1.4623e+00, 3.8144e+05, 3.8156e+05, 3.8760e+05, 3.9624e+05,
        3.9990e+05, 4.0127e+05, 4.0222e+05, 4.0404e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399881.9375, 399895.4062, 399900.9062, 399903.8750,
        399908.0312, 399913.9688, 399925.8438, 399936.5625, 770328.1875,
        775944.8750, 781275.4375, 795064.2500, 796769.3750, 805840.5000,
        808263.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403999.8750, 404003.5312, 404016.8438, 404034.4062,
        404036.9062, 404038.5000, 404040.3750, 404042.9688, 767506.5000,
        773834.1875, 785395.5000, 796769.3750, 804080.3750, 816921.7500,
        821996.7500])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['115062.79', '115061.27', '115064.50', '476227.50', '463371.41', '115062.45', '115061.48', '458943.75', '473086.09', '459259.00', '115062.67', '115059.55', '476306.19', '115061.20', '474554.00', '477355.44']
estimated f for each client, fs: [8, 8, 8, 5, 5, 8, 8, 7, 5, 7, 8, 8, 5, 8, 5, 5]
selected_index: 11
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 11, 3, 14, 19, 2, 9, 13, 17, 20, 6, 8, 16, 5, 15, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0154s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:31...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:31, End: 2025-07-22 16:01:31)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 13, 17, 18, 15, 20, 11, 7, 10, 9, 6, 4, 5, 14, 16, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9153e+05, 3.9160e+05, 3.8456e+05, 3.9944e+05, 4.0230e+05,
         1.2739e+00, 1.2289e+00, 1.1853e+00, 1.1885e+00, 1.3393e+00, 1.2155e+00,
         1.1362e+00, 3.9510e+05, 3.9201e+05, 1.1531e+00],
        [3.9153e+05, 0.0000e+00, 7.5817e+05, 7.7708e+05, 7.7755e+05, 8.0263e+05,
         3.9152e+05, 3.9154e+05, 3.9154e+05, 3.9154e+05, 3.9152e+05, 3.9153e+05,
         3.9154e+05, 7.8725e+05, 7.7415e+05, 3.9153e+05],
        [3.9160e+05, 7.5817e+05, 0.0000e+00, 7.9558e+05, 7.9929e+05, 8.0212e+05,
         3.9162e+05, 3.9164e+05, 3.9163e+05, 3.9164e+05, 3.9161e+05, 3.9164e+05,
         3.9164e+05, 7.8879e+05, 7.8484e+05, 3.9163e+05],
        [3.8456e+05, 7.7708e+05, 7.9558e+05, 0.0000e+00, 7.7881e+05, 7.9819e+05,
         3.8457e+05, 3.8458e+05, 3.8458e+05, 3.8456e+05, 3.8455e+05, 3.8456e+05,
         3.8458e+05, 7.7204e+05, 7.8109e+05, 3.8459e+05],
        [3.9944e+05, 7.7755e+05, 7.9929e+05, 7.7881e+05, 0.0000e+00, 7.8106e+05,
         3.9946e+05, 3.9945e+05, 3.9947e+05, 3.9945e+05, 3.9946e+05, 3.9946e+05,
         3.9948e+05, 8.1905e+05, 7.9641e+05, 3.9943e+05],
        [4.0230e+05, 8.0263e+05, 8.0212e+05, 7.9819e+05, 7.8106e+05, 0.0000e+00,
         4.0231e+05, 4.0228e+05, 4.0230e+05, 4.0227e+05, 4.0231e+05, 4.0230e+05,
         4.0229e+05, 7.9634e+05, 8.0516e+05, 4.0229e+05],
        [1.2739e+00, 3.9152e+05, 3.9162e+05, 3.8457e+05, 3.9946e+05, 4.0231e+05,
         0.0000e+00, 1.1002e+00, 1.1397e+00, 1.1084e+00, 1.2750e+00, 1.0969e+00,
         1.0890e+00, 3.9512e+05, 3.9198e+05, 1.1155e+00],
        [1.2289e+00, 3.9154e+05, 3.9164e+05, 3.8458e+05, 3.9945e+05, 4.0228e+05,
         1.1002e+00, 0.0000e+00, 1.1611e+00, 1.1365e+00, 1.4716e+00, 1.1580e+00,
         1.1023e+00, 3.9514e+05, 3.9198e+05, 1.0222e+00],
        [1.1853e+00, 3.9154e+05, 3.9163e+05, 3.8458e+05, 3.9947e+05, 4.0230e+05,
         1.1397e+00, 1.1611e+00, 0.0000e+00, 1.1546e+00, 1.3822e+00, 1.2430e+00,
         1.1084e+00, 3.9512e+05, 3.9200e+05, 1.0457e+00],
        [1.1885e+00, 3.9154e+05, 3.9164e+05, 3.8456e+05, 3.9945e+05, 4.0227e+05,
         1.1084e+00, 1.1365e+00, 1.1546e+00, 0.0000e+00, 1.2471e+00, 1.1573e+00,
         1.1995e+00, 3.9514e+05, 3.9200e+05, 1.1570e+00],
        [1.3393e+00, 3.9152e+05, 3.9161e+05, 3.8455e+05, 3.9946e+05, 4.0231e+05,
         1.2750e+00, 1.4716e+00, 1.3822e+00, 1.2471e+00, 0.0000e+00, 1.3617e+00,
         1.3812e+00, 3.9513e+05, 3.9200e+05, 1.3702e+00],
        [1.2155e+00, 3.9153e+05, 3.9164e+05, 3.8456e+05, 3.9946e+05, 4.0230e+05,
         1.0969e+00, 1.1580e+00, 1.2430e+00, 1.1573e+00, 1.3617e+00, 0.0000e+00,
         1.1442e+00, 3.9511e+05, 3.9201e+05, 1.1610e+00],
        [1.1362e+00, 3.9154e+05, 3.9164e+05, 3.8458e+05, 3.9948e+05, 4.0229e+05,
         1.0890e+00, 1.1023e+00, 1.1084e+00, 1.1995e+00, 1.3812e+00, 1.1442e+00,
         0.0000e+00, 3.9513e+05, 3.9199e+05, 1.1344e+00],
        [3.9510e+05, 7.8725e+05, 7.8879e+05, 7.7204e+05, 8.1905e+05, 7.9634e+05,
         3.9512e+05, 3.9514e+05, 3.9512e+05, 3.9514e+05, 3.9513e+05, 3.9511e+05,
         3.9513e+05, 0.0000e+00, 7.8897e+05, 3.9511e+05],
        [3.9201e+05, 7.7415e+05, 7.8484e+05, 7.8109e+05, 7.9641e+05, 8.0516e+05,
         3.9198e+05, 3.9198e+05, 3.9200e+05, 3.9200e+05, 3.9200e+05, 3.9201e+05,
         3.9199e+05, 7.8897e+05, 0.0000e+00, 3.9200e+05],
        [1.1531e+00, 3.9153e+05, 3.9163e+05, 3.8459e+05, 3.9943e+05, 4.0229e+05,
         1.1155e+00, 1.0222e+00, 1.0457e+00, 1.1570e+00, 1.3702e+00, 1.1610e+00,
         1.1344e+00, 3.9511e+05, 3.9200e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.1362e+00, 1.1531e+00, 1.1853e+00, 1.1885e+00, 1.2155e+00,
        1.2289e+00, 1.2739e+00, 1.3393e+00, 3.8456e+05, 3.9153e+05, 3.9160e+05,
        3.9201e+05, 3.9510e+05, 3.9944e+05, 4.0230e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391515.3750, 391520.4375, 391525.4688, 391530.9062,
        391534.6875, 391536.7812, 391539.2500, 391539.2812, 391541.7812,
        758167.6250, 774153.5000, 777081.1875, 777553.0000, 787248.2500,
        802631.8125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391604.3438, 391607.8750, 391617.9062, 391626.9375,
        391629.3125, 391635.7500, 391637.5625, 391638.5000, 391644.8438,
        758167.6250, 784843.0625, 788786.5000, 795578.5000, 799285.6875,
        802120.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384554.0000, 384561.4375, 384561.9062, 384564.9375,
        384568.6562, 384575.4375, 384581.8125, 384582.0938, 384588.0625,
        772040.5625, 777081.1875, 778809.2500, 781094.5000, 795578.5000,
        798194.0625])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 399434.3438, 399440.6875, 399445.4062, 399446.9062,
        399459.4062, 399459.8125, 399461.6250, 399472.9062, 399482.2812,
        777553.0000, 778809.2500, 781057.5000, 796413.3750, 799285.6875,
        819054.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402272.4688, 402280.6250, 402290.9062, 402293.4375,
        402298.1562, 402304.0938, 402304.1875, 402308.4062, 402308.5312,
        781057.5000, 796338.3750, 798194.0625, 802120.1250, 802631.8125,
        805157.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0890e+00, 1.0969e+00, 1.1002e+00, 1.1084e+00, 1.1155e+00,
        1.1397e+00, 1.2739e+00, 1.2750e+00, 3.8457e+05, 3.9152e+05, 3.9162e+05,
        3.9198e+05, 3.9512e+05, 3.9946e+05, 4.0231e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0222e+00, 1.1002e+00, 1.1023e+00, 1.1365e+00, 1.1580e+00,
        1.1611e+00, 1.2289e+00, 1.4716e+00, 3.8458e+05, 3.9154e+05, 3.9164e+05,
        3.9198e+05, 3.9514e+05, 3.9945e+05, 4.0228e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0457e+00, 1.1084e+00, 1.1397e+00, 1.1546e+00, 1.1611e+00,
        1.1853e+00, 1.2430e+00, 1.3822e+00, 3.8458e+05, 3.9154e+05, 3.9163e+05,
        3.9200e+05, 3.9512e+05, 3.9947e+05, 4.0230e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.1084e+00, 1.1365e+00, 1.1546e+00, 1.1570e+00, 1.1573e+00,
        1.1885e+00, 1.1995e+00, 1.2471e+00, 3.8456e+05, 3.9154e+05, 3.9164e+05,
        3.9200e+05, 3.9514e+05, 3.9945e+05, 4.0227e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2471e+00, 1.2750e+00, 1.3393e+00, 1.3617e+00, 1.3702e+00,
        1.3812e+00, 1.3822e+00, 1.4716e+00, 3.8455e+05, 3.9152e+05, 3.9161e+05,
        3.9200e+05, 3.9513e+05, 3.9946e+05, 4.0231e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0969e+00, 1.1442e+00, 1.1573e+00, 1.1580e+00, 1.1610e+00,
        1.2155e+00, 1.2430e+00, 1.3617e+00, 3.8456e+05, 3.9153e+05, 3.9164e+05,
        3.9201e+05, 3.9511e+05, 3.9946e+05, 4.0230e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0890e+00, 1.1023e+00, 1.1084e+00, 1.1344e+00, 1.1362e+00,
        1.1442e+00, 1.1995e+00, 1.3812e+00, 3.8458e+05, 3.9154e+05, 3.9164e+05,
        3.9199e+05, 3.9513e+05, 3.9948e+05, 4.0229e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395100.8125, 395112.3125, 395114.6250, 395115.5312,
        395120.4062, 395131.1250, 395131.7500, 395143.3438, 395143.9688,
        772040.5625, 787248.2500, 788786.5000, 788972.6250, 796338.3750,
        819054.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391975.5000, 391982.2188, 391992.4688, 391999.2500,
        392001.3750, 392003.1250, 392003.3125, 392006.1562, 392013.3438,
        774153.5000, 781094.5000, 784843.0625, 788972.6250, 796413.3750,
        805157.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0222e+00, 1.0457e+00, 1.1155e+00, 1.1344e+00, 1.1531e+00,
        1.1570e+00, 1.1610e+00, 1.3702e+00, 3.8459e+05, 3.9153e+05, 3.9163e+05,
        3.9200e+05, 3.9511e+05, 3.9943e+05, 4.0229e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77609.70', '428195.19', '428281.09', '423317.91', '437265.66', '440171.84', '77609.83', '77612.81', '77612.42', '77611.01', '77608.02', '77610.55', '77613.31', '432815.41', '430213.00', '77613.20']
estimated f for each client, fs: [7, 5, 5, 6, 5, 5, 7, 7, 7, 7, 7, 7, 7, 5, 5, 7]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 13, 17, 18, 15, 20, 11, 7, 10, 9, 6, 4, 5, 14, 16, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:32...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:32, End: 2025-07-22 16:01:32)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 8, 15, 14, 5, 6, 13, 18, 11, 17, 3, 4, 12, 7, 16, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.8000e+00, 3.8972e+05, 3.8265e+05, 1.4929e+00, 1.4484e+00,
         3.9513e+05, 3.8653e+05, 1.3658e+00, 3.8881e+05, 1.3929e+00, 1.4438e+00,
         1.5553e+00, 1.5929e+00, 3.8968e+05, 4.0962e+05],
        [1.8000e+00, 0.0000e+00, 3.8974e+05, 3.8264e+05, 1.3612e+00, 1.4468e+00,
         3.9510e+05, 3.8653e+05, 1.3999e+00, 3.8882e+05, 1.5059e+00, 1.3320e+00,
         1.3327e+00, 1.2217e+00, 3.8967e+05, 4.0957e+05],
        [3.8972e+05, 3.8974e+05, 0.0000e+00, 7.8593e+05, 3.8971e+05, 3.8970e+05,
         7.9164e+05, 7.9337e+05, 3.8968e+05, 8.0152e+05, 3.8970e+05, 3.8973e+05,
         3.8970e+05, 3.8970e+05, 7.7458e+05, 8.0053e+05],
        [3.8265e+05, 3.8264e+05, 7.8593e+05, 0.0000e+00, 3.8267e+05, 3.8264e+05,
         8.1151e+05, 7.8139e+05, 3.8266e+05, 7.9402e+05, 3.8264e+05, 3.8265e+05,
         3.8264e+05, 3.8261e+05, 7.7466e+05, 7.8808e+05],
        [1.4929e+00, 1.3612e+00, 3.8971e+05, 3.8267e+05, 0.0000e+00, 1.4250e+00,
         3.9510e+05, 3.8655e+05, 1.2334e+00, 3.8884e+05, 1.2700e+00, 1.2898e+00,
         1.2639e+00, 1.2272e+00, 3.8967e+05, 4.0961e+05],
        [1.4484e+00, 1.4468e+00, 3.8970e+05, 3.8264e+05, 1.4250e+00, 0.0000e+00,
         3.9508e+05, 3.8653e+05, 1.3641e+00, 3.8887e+05, 1.4575e+00, 1.4180e+00,
         1.3847e+00, 1.3823e+00, 3.8968e+05, 4.0962e+05],
        [3.9513e+05, 3.9510e+05, 7.9164e+05, 8.1151e+05, 3.9510e+05, 3.9508e+05,
         0.0000e+00, 7.7179e+05, 3.9512e+05, 7.7465e+05, 3.9509e+05, 3.9509e+05,
         3.9513e+05, 3.9511e+05, 7.8193e+05, 8.2615e+05],
        [3.8653e+05, 3.8653e+05, 7.9337e+05, 7.8139e+05, 3.8655e+05, 3.8653e+05,
         7.7179e+05, 0.0000e+00, 3.8653e+05, 7.7512e+05, 3.8654e+05, 3.8653e+05,
         3.8654e+05, 3.8654e+05, 7.7077e+05, 8.2432e+05],
        [1.3658e+00, 1.3999e+00, 3.8968e+05, 3.8266e+05, 1.2334e+00, 1.3641e+00,
         3.9512e+05, 3.8653e+05, 0.0000e+00, 3.8882e+05, 1.3631e+00, 1.2176e+00,
         1.2732e+00, 1.2539e+00, 3.8967e+05, 4.0961e+05],
        [3.8881e+05, 3.8882e+05, 8.0152e+05, 7.9402e+05, 3.8884e+05, 3.8887e+05,
         7.7465e+05, 7.7512e+05, 3.8882e+05, 0.0000e+00, 3.8885e+05, 3.8882e+05,
         3.8884e+05, 3.8882e+05, 7.7966e+05, 7.8696e+05],
        [1.3929e+00, 1.5059e+00, 3.8970e+05, 3.8264e+05, 1.2700e+00, 1.4575e+00,
         3.9509e+05, 3.8654e+05, 1.3631e+00, 3.8885e+05, 0.0000e+00, 1.3060e+00,
         1.2672e+00, 1.3133e+00, 3.8968e+05, 4.0960e+05],
        [1.4438e+00, 1.3320e+00, 3.8973e+05, 3.8265e+05, 1.2898e+00, 1.4180e+00,
         3.9509e+05, 3.8653e+05, 1.2176e+00, 3.8882e+05, 1.3060e+00, 0.0000e+00,
         1.3036e+00, 1.2727e+00, 3.8969e+05, 4.0957e+05],
        [1.5553e+00, 1.3327e+00, 3.8970e+05, 3.8264e+05, 1.2639e+00, 1.3847e+00,
         3.9513e+05, 3.8654e+05, 1.2732e+00, 3.8884e+05, 1.2672e+00, 1.3036e+00,
         0.0000e+00, 1.2467e+00, 3.8969e+05, 4.0955e+05],
        [1.5929e+00, 1.2217e+00, 3.8970e+05, 3.8261e+05, 1.2272e+00, 1.3823e+00,
         3.9511e+05, 3.8654e+05, 1.2539e+00, 3.8882e+05, 1.3133e+00, 1.2727e+00,
         1.2467e+00, 0.0000e+00, 3.8966e+05, 4.0960e+05],
        [3.8968e+05, 3.8967e+05, 7.7458e+05, 7.7466e+05, 3.8967e+05, 3.8968e+05,
         7.8193e+05, 7.7077e+05, 3.8967e+05, 7.7966e+05, 3.8968e+05, 3.8969e+05,
         3.8969e+05, 3.8966e+05, 0.0000e+00, 8.2041e+05],
        [4.0962e+05, 4.0957e+05, 8.0053e+05, 7.8808e+05, 4.0961e+05, 4.0962e+05,
         8.2615e+05, 8.2432e+05, 4.0961e+05, 7.8696e+05, 4.0960e+05, 4.0957e+05,
         4.0955e+05, 4.0960e+05, 8.2041e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 1.3658e+00, 1.3929e+00, 1.4438e+00, 1.4484e+00, 1.4929e+00,
        1.5553e+00, 1.5929e+00, 1.8000e+00, 3.8265e+05, 3.8653e+05, 3.8881e+05,
        3.8968e+05, 3.8972e+05, 3.9513e+05, 4.0962e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2217e+00, 1.3320e+00, 1.3327e+00, 1.3612e+00, 1.3999e+00,
        1.4468e+00, 1.5059e+00, 1.8000e+00, 3.8264e+05, 3.8653e+05, 3.8882e+05,
        3.8967e+05, 3.8974e+05, 3.9510e+05, 4.0957e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389681.0000, 389697.0625, 389697.6875, 389699.1250,
        389702.3750, 389714.6562, 389718.4688, 389728.2812, 389740.5625,
        774575.8750, 785930.1875, 791641.2500, 793370.8125, 800530.6875,
        801522.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 382611.9375, 382635.7188, 382641.8125, 382642.0938,
        382643.0312, 382647.4375, 382654.6875, 382662.5312, 382665.4375,
        774664.7500, 781392.6875, 785930.1875, 788083.3750, 794015.0625,
        811508.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2272e+00, 1.2334e+00, 1.2639e+00, 1.2700e+00, 1.2898e+00,
        1.3612e+00, 1.4250e+00, 1.4929e+00, 3.8267e+05, 3.8655e+05, 3.8884e+05,
        3.8967e+05, 3.8971e+05, 3.9510e+05, 4.0961e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.3641e+00, 1.3823e+00, 1.3847e+00, 1.4180e+00, 1.4250e+00,
        1.4468e+00, 1.4484e+00, 1.4575e+00, 3.8264e+05, 3.8653e+05, 3.8887e+05,
        3.8968e+05, 3.8970e+05, 3.9508e+05, 4.0962e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395079.6875, 395086.2188, 395091.5625, 395095.7812,
        395096.0625, 395114.9688, 395116.7500, 395125.3750, 395130.1875,
        771787.7500, 774645.5625, 781933.8750, 791641.2500, 811508.5000,
        826145.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386530.4062, 386531.4375, 386531.8438, 386532.0312,
        386533.2500, 386540.3750, 386541.7812, 386544.0625, 386546.5938,
        770769.3750, 771787.7500, 775117.8125, 781392.6875, 793370.8125,
        824321.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2176e+00, 1.2334e+00, 1.2539e+00, 1.2732e+00, 1.3631e+00,
        1.3641e+00, 1.3658e+00, 1.3999e+00, 3.8266e+05, 3.8653e+05, 3.8882e+05,
        3.8967e+05, 3.8968e+05, 3.9512e+05, 4.0961e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388811.5938, 388817.3438, 388819.7812, 388821.5000,
        388823.5625, 388836.3750, 388838.9375, 388851.3438, 388866.0938,
        774645.5625, 775117.8125, 779656.1250, 786957.1875, 794015.0625,
        801522.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2672e+00, 1.2700e+00, 1.3060e+00, 1.3133e+00, 1.3631e+00,
        1.3929e+00, 1.4575e+00, 1.5059e+00, 3.8264e+05, 3.8654e+05, 3.8885e+05,
        3.8968e+05, 3.8970e+05, 3.9509e+05, 4.0960e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2176e+00, 1.2727e+00, 1.2898e+00, 1.3036e+00, 1.3060e+00,
        1.3320e+00, 1.4180e+00, 1.4438e+00, 3.8265e+05, 3.8653e+05, 3.8882e+05,
        3.8969e+05, 3.8973e+05, 3.9509e+05, 4.0957e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2467e+00, 1.2639e+00, 1.2672e+00, 1.2732e+00, 1.3036e+00,
        1.3327e+00, 1.3847e+00, 1.5553e+00, 3.8264e+05, 3.8654e+05, 3.8884e+05,
        3.8969e+05, 3.8970e+05, 3.9513e+05, 4.0955e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.2217e+00, 1.2272e+00, 1.2467e+00, 1.2539e+00, 1.2727e+00,
        1.3133e+00, 1.3823e+00, 1.5929e+00, 3.8261e+05, 3.8654e+05, 3.8882e+05,
        3.8966e+05, 3.8970e+05, 3.9511e+05, 4.0960e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 389664.9375, 389666.2188, 389666.4375, 389670.0625,
        389676.6875, 389678.6875, 389681.0000, 389687.5000, 389689.5312,
        770769.3750, 774575.8750, 774664.7500, 779656.1250, 781933.8750,
        820407.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 409548.0625, 409571.4375, 409573.5000, 409600.6875,
        409603.6875, 409610.9062, 409614.3750, 409620.4062, 409624.2500,
        786957.1875, 788083.3750, 800530.6875, 820407.8750, 824321.0000,
        826145.5000])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76919.13', '76918.59', '428195.56', '421846.94', '76922.27', '76917.74', '432772.44', '424960.09', '76920.62', '427413.25', '76919.67', '76919.73', '76919.30', '76916.42', '427785.06', '447332.50']
estimated f for each client, fs: [7, 7, 5, 6, 7, 7, 5, 5, 7, 5, 7, 7, 7, 7, 5, 5]
selected_index: 13
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 8, 15, 14, 5, 6, 13, 18, 11, 17, 3, 4, 12, 7, 16, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0110s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:32...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:32, End: 2025-07-22 16:01:32)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 5, 3, 8, 6, 2, 10, 4, 18, 12, 13, 11, 9, 1, 15, 7], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8632e+05, 3.8628e+05, 3.8628e+05, 3.8630e+05, 3.8628e+05,
         3.8626e+05, 3.8631e+05, 7.5869e+05, 3.8630e+05, 8.0275e+05, 3.8630e+05,
         3.8631e+05, 3.8628e+05, 7.7533e+05, 3.8629e+05],
        [3.8632e+05, 0.0000e+00, 1.0687e+00, 1.0556e+00, 1.0623e+00, 1.0777e+00,
         1.0160e+00, 1.0453e+00, 3.7301e+05, 1.0081e+00, 4.0383e+05, 1.0324e+00,
         1.1532e+00, 1.1981e+00, 3.9559e+05, 1.2715e+00],
        [3.8628e+05, 1.0687e+00, 0.0000e+00, 1.2033e+00, 1.1100e+00, 1.1069e+00,
         1.0387e+00, 1.0942e+00, 3.7301e+05, 1.0029e+00, 4.0381e+05, 1.1692e+00,
         1.1090e+00, 1.1371e+00, 3.9562e+05, 1.4948e+00],
        [3.8628e+05, 1.0556e+00, 1.2033e+00, 0.0000e+00, 1.0823e+00, 9.7236e-01,
         1.0588e+00, 1.0275e+00, 3.7302e+05, 1.0222e+00, 4.0381e+05, 1.1317e+00,
         1.0976e+00, 1.4115e+00, 3.9562e+05, 1.0651e+00],
        [3.8630e+05, 1.0623e+00, 1.1100e+00, 1.0823e+00, 0.0000e+00, 1.0049e+00,
         1.0861e+00, 1.0584e+00, 3.7301e+05, 1.0011e+00, 4.0379e+05, 1.0811e+00,
         1.0701e+00, 1.0760e+00, 3.9561e+05, 1.3887e+00],
        [3.8628e+05, 1.0777e+00, 1.1069e+00, 9.7236e-01, 1.0049e+00, 0.0000e+00,
         9.8551e-01, 1.0582e+00, 3.7300e+05, 1.0125e+00, 4.0383e+05, 1.1063e+00,
         1.0823e+00, 1.2664e+00, 3.9564e+05, 1.0954e+00],
        [3.8626e+05, 1.0160e+00, 1.0387e+00, 1.0588e+00, 1.0861e+00, 9.8551e-01,
         0.0000e+00, 1.1066e+00, 3.7300e+05, 9.6236e-01, 4.0383e+05, 1.0708e+00,
         1.0866e+00, 1.1881e+00, 3.9560e+05, 1.3628e+00],
        [3.8631e+05, 1.0453e+00, 1.0942e+00, 1.0275e+00, 1.0584e+00, 1.0582e+00,
         1.1066e+00, 0.0000e+00, 3.7298e+05, 1.0492e+00, 4.0382e+05, 1.0734e+00,
         1.0710e+00, 1.1678e+00, 3.9561e+05, 1.3270e+00],
        [7.5869e+05, 3.7301e+05, 3.7301e+05, 3.7302e+05, 3.7301e+05, 3.7300e+05,
         3.7300e+05, 3.7298e+05, 0.0000e+00, 3.7297e+05, 7.8331e+05, 3.7299e+05,
         3.7299e+05, 3.7296e+05, 7.7825e+05, 3.7301e+05],
        [3.8630e+05, 1.0081e+00, 1.0029e+00, 1.0222e+00, 1.0011e+00, 1.0125e+00,
         9.6236e-01, 1.0492e+00, 3.7297e+05, 0.0000e+00, 4.0381e+05, 1.0431e+00,
         1.0769e+00, 1.1795e+00, 3.9562e+05, 1.3190e+00],
        [8.0275e+05, 4.0383e+05, 4.0381e+05, 4.0381e+05, 4.0379e+05, 4.0383e+05,
         4.0383e+05, 4.0382e+05, 7.8331e+05, 4.0381e+05, 0.0000e+00, 4.0383e+05,
         4.0381e+05, 4.0380e+05, 8.1103e+05, 4.0381e+05],
        [3.8630e+05, 1.0324e+00, 1.1692e+00, 1.1317e+00, 1.0811e+00, 1.1063e+00,
         1.0708e+00, 1.0734e+00, 3.7299e+05, 1.0431e+00, 4.0383e+05, 0.0000e+00,
         1.1070e+00, 1.1183e+00, 3.9564e+05, 1.4071e+00],
        [3.8631e+05, 1.1532e+00, 1.1090e+00, 1.0976e+00, 1.0701e+00, 1.0823e+00,
         1.0866e+00, 1.0710e+00, 3.7299e+05, 1.0769e+00, 4.0381e+05, 1.1070e+00,
         0.0000e+00, 1.1597e+00, 3.9563e+05, 1.3528e+00],
        [3.8628e+05, 1.1981e+00, 1.1371e+00, 1.4115e+00, 1.0760e+00, 1.2664e+00,
         1.1881e+00, 1.1678e+00, 3.7296e+05, 1.1795e+00, 4.0380e+05, 1.1183e+00,
         1.1597e+00, 0.0000e+00, 3.9562e+05, 1.7899e+00],
        [7.7533e+05, 3.9559e+05, 3.9562e+05, 3.9562e+05, 3.9561e+05, 3.9564e+05,
         3.9560e+05, 3.9561e+05, 7.7825e+05, 3.9562e+05, 8.1103e+05, 3.9564e+05,
         3.9563e+05, 3.9562e+05, 0.0000e+00, 3.9560e+05],
        [3.8629e+05, 1.2715e+00, 1.4948e+00, 1.0651e+00, 1.3887e+00, 1.0954e+00,
         1.3628e+00, 1.3270e+00, 3.7301e+05, 1.3190e+00, 4.0381e+05, 1.4071e+00,
         1.3528e+00, 1.7899e+00, 3.9560e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 386264.2188, 386280.0938, 386280.8125, 386284.6562,
        386284.9688, 386290.7812, 386299.0625, 386301.7812, 386304.5312,
        386308.7500, 386312.9062, 386317.9688, 758694.3125, 775329.4375,
        802754.1875])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.0081e+00, 1.0160e+00, 1.0324e+00, 1.0453e+00, 1.0556e+00,
        1.0623e+00, 1.0687e+00, 1.0777e+00, 1.1532e+00, 1.1981e+00, 1.2715e+00,
        3.7301e+05, 3.8632e+05, 3.9559e+05, 4.0383e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0029e+00, 1.0387e+00, 1.0687e+00, 1.0942e+00, 1.1069e+00,
        1.1090e+00, 1.1100e+00, 1.1371e+00, 1.1692e+00, 1.2033e+00, 1.4948e+00,
        3.7301e+05, 3.8628e+05, 3.9562e+05, 4.0381e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7236e-01, 1.0222e+00, 1.0275e+00, 1.0556e+00, 1.0588e+00,
        1.0651e+00, 1.0823e+00, 1.0976e+00, 1.1317e+00, 1.2033e+00, 1.4115e+00,
        3.7302e+05, 3.8628e+05, 3.9562e+05, 4.0381e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0011e+00, 1.0049e+00, 1.0584e+00, 1.0623e+00, 1.0701e+00,
        1.0760e+00, 1.0811e+00, 1.0823e+00, 1.0861e+00, 1.1100e+00, 1.3887e+00,
        3.7301e+05, 3.8630e+05, 3.9561e+05, 4.0379e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7236e-01, 9.8551e-01, 1.0049e+00, 1.0125e+00, 1.0582e+00,
        1.0777e+00, 1.0823e+00, 1.0954e+00, 1.1063e+00, 1.1069e+00, 1.2664e+00,
        3.7300e+05, 3.8628e+05, 3.9564e+05, 4.0383e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.6236e-01, 9.8551e-01, 1.0160e+00, 1.0387e+00, 1.0588e+00,
        1.0708e+00, 1.0861e+00, 1.0866e+00, 1.1066e+00, 1.1881e+00, 1.3628e+00,
        3.7300e+05, 3.8626e+05, 3.9560e+05, 4.0383e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0275e+00, 1.0453e+00, 1.0492e+00, 1.0582e+00, 1.0584e+00,
        1.0710e+00, 1.0734e+00, 1.0942e+00, 1.1066e+00, 1.1678e+00, 1.3270e+00,
        3.7298e+05, 3.8631e+05, 3.9561e+05, 4.0382e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 372964.7188, 372969.3750, 372977.9375, 372990.5625,
        372992.6250, 372996.1562, 373003.3750, 373006.6875, 373008.7812,
        373010.2500, 373013.6250, 373019.5000, 758694.3125, 778251.5000,
        783310.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.6236e-01, 1.0011e+00, 1.0029e+00, 1.0081e+00, 1.0125e+00,
        1.0222e+00, 1.0431e+00, 1.0492e+00, 1.0769e+00, 1.1795e+00, 1.3190e+00,
        3.7297e+05, 3.8630e+05, 3.9562e+05, 4.0381e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 403790.0938, 403803.9375, 403805.9375, 403806.6875,
        403810.5000, 403811.1875, 403812.5938, 403817.2500, 403827.6562,
        403828.3438, 403829.4375, 403833.8438, 783310.7500, 802754.1875,
        811030.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.0324e+00, 1.0431e+00, 1.0708e+00, 1.0734e+00, 1.0811e+00,
        1.1063e+00, 1.1070e+00, 1.1183e+00, 1.1317e+00, 1.1692e+00, 1.4071e+00,
        3.7299e+05, 3.8630e+05, 3.9564e+05, 4.0383e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0701e+00, 1.0710e+00, 1.0769e+00, 1.0823e+00, 1.0866e+00,
        1.0976e+00, 1.1070e+00, 1.1090e+00, 1.1532e+00, 1.1597e+00, 1.3528e+00,
        3.7299e+05, 3.8631e+05, 3.9563e+05, 4.0381e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0760e+00, 1.1183e+00, 1.1371e+00, 1.1597e+00, 1.1678e+00,
        1.1795e+00, 1.1881e+00, 1.1981e+00, 1.2664e+00, 1.4115e+00, 1.7899e+00,
        3.7296e+05, 3.8628e+05, 3.9562e+05, 4.0380e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395590.9062, 395603.2500, 395604.1250, 395613.4062,
        395614.3750, 395615.8750, 395616.3125, 395617.3438, 395618.3750,
        395627.8125, 395636.7500, 395640.0312, 775329.4375, 778251.5000,
        811030.8750])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 1.0651e+00, 1.0954e+00, 1.2715e+00, 1.3190e+00, 1.3270e+00,
        1.3528e+00, 1.3628e+00, 1.3887e+00, 1.4071e+00, 1.4948e+00, 1.7899e+00,
        3.7301e+05, 3.8629e+05, 3.9560e+05, 4.0381e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['386294.25', '1.07', '1.10', '1.07', '1.06', '1.05', '1.06', '1.08', '372992.03', '1.04', '403814.84', '1.09', '1.10', '1.19', '395616.59', '1.31']
estimated f for each client, fs: [2, 5, 5, 5, 4, 5, 5, 5, 5, 5, 2, 5, 5, 5, 2, 5]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 5, 3, 8, 6, 2, 10, 4, 18, 12, 13, 11, 9, 1, 15, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0130s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:33...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:33, End: 2025-07-22 16:01:33)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 19, 8, 11, 14, 10, 15, 3, 7, 1, 13, 20, 18, 5, 17, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8836e+05, 9.8319e-01, 1.2150e+00, 4.0131e+05, 1.1226e+00,
         3.9381e+05, 1.2146e+00, 9.8353e-01, 1.5285e+00, 3.8864e+05, 3.9039e+05,
         3.9386e+05, 1.1042e+00, 4.0262e+05, 1.2228e+00],
        [3.8836e+05, 0.0000e+00, 3.8834e+05, 3.8835e+05, 7.8636e+05, 3.8836e+05,
         7.9164e+05, 3.8835e+05, 3.8832e+05, 3.8835e+05, 7.6626e+05, 7.7440e+05,
         8.0144e+05, 3.8836e+05, 7.9633e+05, 3.8836e+05],
        [9.8319e-01, 3.8834e+05, 0.0000e+00, 1.1021e+00, 4.0129e+05, 1.0352e+00,
         3.9382e+05, 1.1667e+00, 9.2527e-01, 1.3592e+00, 3.8864e+05, 3.9044e+05,
         3.9384e+05, 1.0296e+00, 4.0261e+05, 1.0686e+00],
        [1.2150e+00, 3.8835e+05, 1.1021e+00, 0.0000e+00, 4.0126e+05, 1.0522e+00,
         3.9383e+05, 1.1552e+00, 1.1654e+00, 1.0842e+00, 3.8862e+05, 3.9038e+05,
         3.9386e+05, 1.0355e+00, 4.0267e+05, 1.0622e+00],
        [4.0131e+05, 7.8636e+05, 4.0129e+05, 4.0126e+05, 0.0000e+00, 4.0127e+05,
         7.9058e+05, 4.0127e+05, 4.0129e+05, 4.0126e+05, 7.8920e+05, 8.2173e+05,
         8.1542e+05, 4.0126e+05, 7.7954e+05, 4.0125e+05],
        [1.1226e+00, 3.8836e+05, 1.0352e+00, 1.0522e+00, 4.0127e+05, 0.0000e+00,
         3.9384e+05, 1.0748e+00, 1.1345e+00, 1.2065e+00, 3.8863e+05, 3.9040e+05,
         3.9383e+05, 1.0076e+00, 4.0264e+05, 1.0974e+00],
        [3.9381e+05, 7.9164e+05, 3.9382e+05, 3.9383e+05, 7.9058e+05, 3.9384e+05,
         0.0000e+00, 3.9382e+05, 3.9380e+05, 3.9381e+05, 7.6733e+05, 7.9316e+05,
         7.9492e+05, 3.9383e+05, 8.0963e+05, 3.9383e+05],
        [1.2146e+00, 3.8835e+05, 1.1667e+00, 1.1552e+00, 4.0127e+05, 1.0748e+00,
         3.9382e+05, 0.0000e+00, 1.2536e+00, 1.1377e+00, 3.8865e+05, 3.9041e+05,
         3.9384e+05, 1.0587e+00, 4.0265e+05, 1.1510e+00],
        [9.8353e-01, 3.8832e+05, 9.2527e-01, 1.1654e+00, 4.0129e+05, 1.1345e+00,
         3.9380e+05, 1.2536e+00, 0.0000e+00, 1.5045e+00, 3.8860e+05, 3.9038e+05,
         3.9385e+05, 1.0650e+00, 4.0262e+05, 1.1943e+00],
        [1.5285e+00, 3.8835e+05, 1.3592e+00, 1.0842e+00, 4.0126e+05, 1.2065e+00,
         3.9381e+05, 1.1377e+00, 1.5045e+00, 0.0000e+00, 3.8864e+05, 3.9039e+05,
         3.9388e+05, 1.2101e+00, 4.0267e+05, 1.0715e+00],
        [3.8864e+05, 7.6626e+05, 3.8864e+05, 3.8862e+05, 7.8920e+05, 3.8863e+05,
         7.6733e+05, 3.8865e+05, 3.8860e+05, 3.8864e+05, 0.0000e+00, 7.6762e+05,
         7.8381e+05, 3.8860e+05, 7.8827e+05, 3.8862e+05],
        [3.9039e+05, 7.7440e+05, 3.9044e+05, 3.9038e+05, 8.2173e+05, 3.9040e+05,
         7.9316e+05, 3.9041e+05, 3.9038e+05, 3.9039e+05, 7.6762e+05, 0.0000e+00,
         7.8931e+05, 3.9038e+05, 7.9840e+05, 3.9041e+05],
        [3.9386e+05, 8.0144e+05, 3.9384e+05, 3.9386e+05, 8.1542e+05, 3.9383e+05,
         7.9492e+05, 3.9384e+05, 3.9385e+05, 3.9388e+05, 7.8381e+05, 7.8931e+05,
         0.0000e+00, 3.9382e+05, 8.0555e+05, 3.9385e+05],
        [1.1042e+00, 3.8836e+05, 1.0296e+00, 1.0355e+00, 4.0126e+05, 1.0076e+00,
         3.9383e+05, 1.0587e+00, 1.0650e+00, 1.2101e+00, 3.8860e+05, 3.9038e+05,
         3.9382e+05, 0.0000e+00, 4.0262e+05, 1.0891e+00],
        [4.0262e+05, 7.9633e+05, 4.0261e+05, 4.0267e+05, 7.7954e+05, 4.0264e+05,
         8.0963e+05, 4.0265e+05, 4.0262e+05, 4.0267e+05, 7.8827e+05, 7.9840e+05,
         8.0555e+05, 4.0262e+05, 0.0000e+00, 4.0265e+05],
        [1.2228e+00, 3.8836e+05, 1.0686e+00, 1.0622e+00, 4.0125e+05, 1.0974e+00,
         3.9383e+05, 1.1510e+00, 1.1943e+00, 1.0715e+00, 3.8862e+05, 3.9041e+05,
         3.9385e+05, 1.0891e+00, 4.0265e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 9.8319e-01, 9.8353e-01, 1.1042e+00, 1.1226e+00, 1.2146e+00,
        1.2150e+00, 1.2228e+00, 1.5285e+00, 3.8836e+05, 3.8864e+05, 3.9039e+05,
        3.9381e+05, 3.9386e+05, 4.0131e+05, 4.0262e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388320.7500, 388335.3125, 388345.3125, 388345.9375,
        388351.0938, 388357.7500, 388359.7500, 388359.9375, 388364.9688,
        766264.6250, 774398.1250, 786357.7500, 791638.6250, 796328.2500,
        801443.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2527e-01, 9.8319e-01, 1.0296e+00, 1.0352e+00, 1.0686e+00,
        1.1021e+00, 1.1667e+00, 1.3592e+00, 3.8834e+05, 3.8864e+05, 3.9044e+05,
        3.9382e+05, 3.9384e+05, 4.0129e+05, 4.0261e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0355e+00, 1.0522e+00, 1.0622e+00, 1.0842e+00, 1.1021e+00,
        1.1552e+00, 1.1654e+00, 1.2150e+00, 3.8835e+05, 3.8862e+05, 3.9038e+05,
        3.9383e+05, 3.9386e+05, 4.0126e+05, 4.0267e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401249.5000, 401255.3750, 401257.8125, 401261.9375,
        401268.6562, 401273.4688, 401288.5312, 401292.5312, 401306.2188,
        779539.8750, 786357.7500, 789199.8750, 790575.2500, 815422.7500,
        821734.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0076e+00, 1.0352e+00, 1.0522e+00, 1.0748e+00, 1.0974e+00,
        1.1226e+00, 1.1345e+00, 1.2065e+00, 3.8836e+05, 3.8863e+05, 3.9040e+05,
        3.9383e+05, 3.9384e+05, 4.0127e+05, 4.0264e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393799.1250, 393807.0625, 393814.3750, 393815.2500,
        393823.4375, 393826.2812, 393826.9062, 393829.2812, 393843.1875,
        767325.1875, 790575.2500, 791638.6250, 793162.8750, 794920.0000,
        809633.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0587e+00, 1.0748e+00, 1.1377e+00, 1.1510e+00, 1.1552e+00,
        1.1667e+00, 1.2146e+00, 1.2536e+00, 3.8835e+05, 3.8865e+05, 3.9041e+05,
        3.9382e+05, 3.9384e+05, 4.0127e+05, 4.0265e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2527e-01, 9.8353e-01, 1.0650e+00, 1.1345e+00, 1.1654e+00,
        1.1943e+00, 1.2536e+00, 1.5045e+00, 3.8832e+05, 3.8860e+05, 3.9038e+05,
        3.9380e+05, 3.9385e+05, 4.0129e+05, 4.0262e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0715e+00, 1.0842e+00, 1.1377e+00, 1.2065e+00, 1.2101e+00,
        1.3592e+00, 1.5045e+00, 1.5285e+00, 3.8835e+05, 3.8864e+05, 3.9039e+05,
        3.9381e+05, 3.9388e+05, 4.0126e+05, 4.0267e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388603.5938, 388604.3125, 388617.9688, 388619.0625,
        388627.5938, 388639.1250, 388639.7500, 388642.2812, 388646.1250,
        766264.6250, 767325.1875, 767619.3125, 783808.4375, 788273.0625,
        789199.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390381.2188, 390383.5625, 390384.1250, 390387.2812,
        390394.3750, 390401.5625, 390410.3750, 390412.0938, 390441.2500,
        767619.3125, 774398.1250, 789305.6250, 793162.8750, 798395.4375,
        821734.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393815.4375, 393829.5000, 393835.0938, 393841.5625,
        393845.4062, 393849.6875, 393857.6250, 393862.1875, 393876.5625,
        783808.4375, 789305.6250, 794920.0000, 801443.3125, 805554.1875,
        815422.7500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0076e+00, 1.0296e+00, 1.0355e+00, 1.0587e+00, 1.0650e+00,
        1.0891e+00, 1.1042e+00, 1.2101e+00, 3.8836e+05, 3.8860e+05, 3.9038e+05,
        3.9382e+05, 3.9383e+05, 4.0126e+05, 4.0262e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402614.0000, 402621.6250, 402622.1250, 402623.7500,
        402638.5312, 402651.4375, 402652.6875, 402666.0312, 402674.1562,
        779539.8750, 788273.0625, 796328.2500, 798395.4375, 805554.1875,
        809633.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0622e+00, 1.0686e+00, 1.0715e+00, 1.0891e+00, 1.0974e+00,
        1.1510e+00, 1.1943e+00, 1.2228e+00, 3.8836e+05, 3.8862e+05, 3.9041e+05,
        3.9383e+05, 3.9385e+05, 4.0125e+05, 4.0265e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77701.16', '426140.56', '77698.38', '77697.90', '439099.41', '77700.13', '431171.06', '77700.12', '77693.43', '77699.45', '426390.44', '428121.50', '432842.16', '77697.20', '440330.44', '77698.47']
estimated f for each client, fs: [7, 5, 7, 7, 5, 7, 5, 7, 7, 7, 5, 5, 5, 7, 5, 7]
selected_index: 8
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 19, 8, 11, 14, 10, 15, 3, 7, 1, 13, 20, 18, 5, 17, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:34...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:34, End: 2025-07-22 16:01:34)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 11, 14, 5, 16, 8, 18, 12, 15, 2, 4, 10, 7, 19, 3, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9670e+05, 7.5573e+05, 3.9670e+05, 7.8794e+05, 3.9673e+05,
         7.5236e+05, 3.9670e+05, 7.6740e+05, 3.9673e+05, 3.9671e+05, 3.9673e+05,
         3.9671e+05, 8.1344e+05, 3.9671e+05, 3.9671e+05],
        [3.9670e+05, 0.0000e+00, 3.9134e+05, 8.9077e-01, 3.9266e+05, 9.6095e-01,
         3.7780e+05, 9.7809e-01, 3.8504e+05, 9.3184e-01, 9.0929e-01, 9.3862e-01,
         1.4896e+00, 4.0861e+05, 1.0154e+00, 9.0960e-01],
        [7.5573e+05, 3.9134e+05, 0.0000e+00, 3.9132e+05, 7.8770e+05, 3.9133e+05,
         7.5994e+05, 3.9131e+05, 7.8275e+05, 3.9133e+05, 3.9131e+05, 3.9133e+05,
         3.9130e+05, 7.8777e+05, 3.9131e+05, 3.9133e+05],
        [3.9670e+05, 8.9077e-01, 3.9132e+05, 0.0000e+00, 3.9266e+05, 8.6445e-01,
         3.7777e+05, 9.1244e-01, 3.8506e+05, 9.4097e-01, 8.9226e-01, 9.1045e-01,
         1.3044e+00, 4.0861e+05, 9.4031e-01, 8.9887e-01],
        [7.8794e+05, 3.9266e+05, 7.8770e+05, 3.9266e+05, 0.0000e+00, 3.9268e+05,
         7.7730e+05, 3.9268e+05, 7.7228e+05, 3.9266e+05, 3.9268e+05, 3.9266e+05,
         3.9267e+05, 8.0162e+05, 3.9266e+05, 3.9264e+05],
        [3.9673e+05, 9.6095e-01, 3.9133e+05, 8.6445e-01, 3.9268e+05, 0.0000e+00,
         3.7778e+05, 7.9497e-01, 3.8505e+05, 8.2646e-01, 8.5929e-01, 8.9493e-01,
         1.0348e+00, 4.0860e+05, 1.0145e+00, 8.8871e-01],
        [7.5236e+05, 3.7780e+05, 7.5994e+05, 3.7777e+05, 7.7730e+05, 3.7778e+05,
         0.0000e+00, 3.7780e+05, 7.7550e+05, 3.7778e+05, 3.7777e+05, 3.7777e+05,
         3.7778e+05, 7.9437e+05, 3.7780e+05, 3.7777e+05],
        [3.9670e+05, 9.7809e-01, 3.9131e+05, 9.1244e-01, 3.9268e+05, 7.9497e-01,
         3.7780e+05, 0.0000e+00, 3.8505e+05, 8.2071e-01, 9.2928e-01, 8.7639e-01,
         1.0171e+00, 4.0861e+05, 9.7518e-01, 9.3419e-01],
        [7.6740e+05, 3.8504e+05, 7.8275e+05, 3.8506e+05, 7.7228e+05, 3.8505e+05,
         7.7550e+05, 3.8505e+05, 0.0000e+00, 3.8505e+05, 3.8503e+05, 3.8507e+05,
         3.8505e+05, 7.7195e+05, 3.8503e+05, 3.8502e+05],
        [3.9673e+05, 9.3184e-01, 3.9133e+05, 9.4097e-01, 3.9266e+05, 8.2646e-01,
         3.7778e+05, 8.2071e-01, 3.8505e+05, 0.0000e+00, 9.1000e-01, 8.5377e-01,
         1.0887e+00, 4.0861e+05, 9.5560e-01, 8.4830e-01],
        [3.9671e+05, 9.0929e-01, 3.9131e+05, 8.9226e-01, 3.9268e+05, 8.5929e-01,
         3.7777e+05, 9.2928e-01, 3.8503e+05, 9.1000e-01, 0.0000e+00, 9.6727e-01,
         1.3655e+00, 4.0862e+05, 9.4510e-01, 9.0199e-01],
        [3.9673e+05, 9.3862e-01, 3.9133e+05, 9.1045e-01, 3.9266e+05, 8.9493e-01,
         3.7777e+05, 8.7639e-01, 3.8507e+05, 8.5377e-01, 9.6727e-01, 0.0000e+00,
         1.3454e+00, 4.0862e+05, 9.3623e-01, 9.2762e-01],
        [3.9671e+05, 1.4896e+00, 3.9130e+05, 1.3044e+00, 3.9267e+05, 1.0348e+00,
         3.7778e+05, 1.0171e+00, 3.8505e+05, 1.0887e+00, 1.3655e+00, 1.3454e+00,
         0.0000e+00, 4.0862e+05, 1.5181e+00, 1.4054e+00],
        [8.1344e+05, 4.0861e+05, 7.8777e+05, 4.0861e+05, 8.0162e+05, 4.0860e+05,
         7.9437e+05, 4.0861e+05, 7.7195e+05, 4.0861e+05, 4.0862e+05, 4.0862e+05,
         4.0862e+05, 0.0000e+00, 4.0861e+05, 4.0859e+05],
        [3.9671e+05, 1.0154e+00, 3.9131e+05, 9.4031e-01, 3.9266e+05, 1.0145e+00,
         3.7780e+05, 9.7518e-01, 3.8503e+05, 9.5560e-01, 9.4510e-01, 9.3623e-01,
         1.5181e+00, 4.0861e+05, 0.0000e+00, 9.6767e-01],
        [3.9671e+05, 9.0960e-01, 3.9133e+05, 8.9887e-01, 3.9264e+05, 8.8871e-01,
         3.7777e+05, 9.3419e-01, 3.8502e+05, 8.4830e-01, 9.0199e-01, 9.2762e-01,
         1.4054e+00, 4.0859e+05, 9.6767e-01, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 396699.2812, 396702.9062, 396703.7500, 396705.2188,
        396706.2500, 396708.7812, 396709.1562, 396725.0312, 396728.2500,
        396732.6562, 752359.3750, 755732.1250, 767399.0000, 787937.1250,
        813436.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9077e-01, 9.0929e-01, 9.0960e-01, 9.3184e-01, 9.3862e-01,
        9.6095e-01, 9.7809e-01, 1.0154e+00, 1.4896e+00, 3.7780e+05, 3.8504e+05,
        3.9134e+05, 3.9266e+05, 3.9670e+05, 4.0861e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391299.3750, 391311.6250, 391313.0312, 391313.3750,
        391324.7812, 391326.0000, 391328.6250, 391330.8125, 391334.5312,
        391341.1250, 755732.1250, 759944.9375, 782753.2500, 787697.0000,
        787769.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6445e-01, 8.9077e-01, 8.9226e-01, 8.9887e-01, 9.1045e-01,
        9.1244e-01, 9.4031e-01, 9.4097e-01, 1.3044e+00, 3.7777e+05, 3.8506e+05,
        3.9132e+05, 3.9266e+05, 3.9670e+05, 4.0861e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392640.2812, 392657.3125, 392661.4062, 392661.8125,
        392662.0312, 392662.1250, 392669.8438, 392679.2188, 392679.5000,
        392679.7500, 772284.0000, 777303.8750, 787697.0000, 787937.1250,
        801622.5000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.9497e-01, 8.2646e-01, 8.5929e-01, 8.6445e-01, 8.8871e-01,
        8.9493e-01, 9.6095e-01, 1.0145e+00, 1.0348e+00, 3.7778e+05, 3.8505e+05,
        3.9133e+05, 3.9268e+05, 3.9673e+05, 4.0860e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 377765.8750, 377766.8438, 377770.5625, 377773.6875,
        377776.9375, 377777.0000, 377777.5000, 377795.2188, 377801.3750,
        377803.4062, 752359.3750, 759944.9375, 775504.1875, 777303.8750,
        794365.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.9497e-01, 8.2071e-01, 8.7639e-01, 9.1244e-01, 9.2928e-01,
        9.3419e-01, 9.7518e-01, 9.7809e-01, 1.0171e+00, 3.7780e+05, 3.8505e+05,
        3.9131e+05, 3.9268e+05, 3.9670e+05, 4.0861e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385020.9375, 385028.5312, 385029.6250, 385042.2812,
        385045.4062, 385047.5000, 385048.4688, 385050.1250, 385061.8438,
        385067.9375, 767399.0000, 771954.2500, 772284.0000, 775504.1875,
        782753.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.2071e-01, 8.2646e-01, 8.4830e-01, 8.5377e-01, 9.1000e-01,
        9.3184e-01, 9.4097e-01, 9.5560e-01, 1.0887e+00, 3.7778e+05, 3.8505e+05,
        3.9133e+05, 3.9266e+05, 3.9673e+05, 4.0861e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.5929e-01, 8.9226e-01, 9.0199e-01, 9.0929e-01, 9.1000e-01,
        9.2928e-01, 9.4510e-01, 9.6727e-01, 1.3655e+00, 3.7777e+05, 3.8503e+05,
        3.9131e+05, 3.9268e+05, 3.9671e+05, 4.0862e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.5377e-01, 8.7639e-01, 8.9493e-01, 9.1045e-01, 9.2762e-01,
        9.3623e-01, 9.3862e-01, 9.6727e-01, 1.3454e+00, 3.7777e+05, 3.8507e+05,
        3.9133e+05, 3.9266e+05, 3.9673e+05, 4.0862e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 1.0171e+00, 1.0348e+00, 1.0887e+00, 1.3044e+00, 1.3454e+00,
        1.3655e+00, 1.4054e+00, 1.4896e+00, 1.5181e+00, 3.7778e+05, 3.8505e+05,
        3.9130e+05, 3.9267e+05, 3.9671e+05, 4.0862e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 408591.0000, 408603.8125, 408606.3125, 408607.0000,
        408609.7812, 408610.9062, 408613.7500, 408616.4375, 408619.1250,
        408623.7188, 771954.2500, 787769.6875, 794365.8750, 801622.5000,
        813436.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.3623e-01, 9.4031e-01, 9.4510e-01, 9.5560e-01, 9.6767e-01,
        9.7518e-01, 1.0145e+00, 1.0154e+00, 1.5181e+00, 3.7780e+05, 3.8503e+05,
        3.9131e+05, 3.9266e+05, 3.9671e+05, 4.0861e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4830e-01, 8.8871e-01, 8.9887e-01, 9.0199e-01, 9.0960e-01,
        9.2762e-01, 9.3419e-01, 9.6767e-01, 1.4054e+00, 3.7777e+05, 3.8502e+05,
        3.9133e+05, 3.9264e+05, 3.9671e+05, 4.0859e+05])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['396712.12', '37781.04', '391322.31', '37777.54', '392665.31', '37778.50', '377780.84', '37781.16', '385044.31', '37778.52', '37777.46', '37778.23', '37778.91', '408610.19', '37780.45', '37777.93']
estimated f for each client, fs: [4, 6, 4, 6, 4, 6, 4, 6, 4, 6, 6, 6, 6, 4, 6, 6]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 11, 14, 5, 16, 8, 18, 12, 15, 2, 4, 10, 7, 19, 3, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:34...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:34, End: 2025-07-22 16:01:34)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 8, 9, 3, 4, 13, 6, 1, 16, 14, 11, 2, 12, 10, 5, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.3044e-01, 1.1914e+00, 1.3397e+00, 8.8956e-01, 3.8517e+05,
         1.2627e+00, 1.6511e+00, 3.9079e+05, 3.7249e+05, 1.2953e+00, 9.8161e-01,
         8.7165e-01, 1.1913e+00, 1.1142e+00, 3.8639e+05],
        [9.3044e-01, 0.0000e+00, 1.0661e+00, 1.1425e+00, 9.5218e-01, 3.8518e+05,
         1.0475e+00, 1.2728e+00, 3.9081e+05, 3.7250e+05, 1.0784e+00, 9.9634e-01,
         9.1436e-01, 1.0119e+00, 9.8700e-01, 3.8638e+05],
        [1.1914e+00, 1.0661e+00, 0.0000e+00, 1.0499e+00, 1.1600e+00, 3.8518e+05,
         9.7346e-01, 1.0636e+00, 3.9082e+05, 3.7249e+05, 1.0087e+00, 1.0750e+00,
         1.0222e+00, 9.7433e-01, 1.0831e+00, 3.8640e+05],
        [1.3397e+00, 1.1425e+00, 1.0499e+00, 0.0000e+00, 1.2640e+00, 3.8519e+05,
         1.0628e+00, 1.0407e+00, 3.9081e+05, 3.7251e+05, 1.0929e+00, 1.0803e+00,
         1.0316e+00, 9.7073e-01, 1.0078e+00, 3.8641e+05],
        [8.8956e-01, 9.5218e-01, 1.1600e+00, 1.2640e+00, 0.0000e+00, 3.8517e+05,
         1.2090e+00, 1.4184e+00, 3.9079e+05, 3.7248e+05, 1.2239e+00, 1.0644e+00,
         9.6438e-01, 1.1895e+00, 1.1063e+00, 3.8640e+05],
        [3.8517e+05, 3.8518e+05, 3.8518e+05, 3.8519e+05, 3.8517e+05, 0.0000e+00,
         3.8517e+05, 3.8519e+05, 7.7571e+05, 7.6427e+05, 3.8518e+05, 3.8517e+05,
         3.8520e+05, 3.8518e+05, 3.8522e+05, 7.5986e+05],
        [1.2627e+00, 1.0475e+00, 9.7346e-01, 1.0628e+00, 1.2090e+00, 3.8517e+05,
         0.0000e+00, 9.7240e-01, 3.9081e+05, 3.7249e+05, 1.0005e+00, 9.8485e-01,
         1.0226e+00, 9.8162e-01, 1.0075e+00, 3.8641e+05],
        [1.6511e+00, 1.2728e+00, 1.0636e+00, 1.0407e+00, 1.4184e+00, 3.8519e+05,
         9.7240e-01, 0.0000e+00, 3.9082e+05, 3.7247e+05, 1.0289e+00, 1.2028e+00,
         1.2750e+00, 1.0617e+00, 1.0982e+00, 3.8641e+05],
        [3.9079e+05, 3.9081e+05, 3.9082e+05, 3.9081e+05, 3.9079e+05, 7.7571e+05,
         3.9081e+05, 3.9082e+05, 0.0000e+00, 7.4004e+05, 3.9082e+05, 3.9082e+05,
         3.9082e+05, 3.9081e+05, 3.9080e+05, 7.7313e+05],
        [3.7249e+05, 3.7250e+05, 3.7249e+05, 3.7251e+05, 3.7248e+05, 7.6427e+05,
         3.7249e+05, 3.7247e+05, 7.4004e+05, 0.0000e+00, 3.7248e+05, 3.7249e+05,
         3.7250e+05, 3.7250e+05, 3.7250e+05, 7.7530e+05],
        [1.2953e+00, 1.0784e+00, 1.0087e+00, 1.0929e+00, 1.2239e+00, 3.8518e+05,
         1.0005e+00, 1.0289e+00, 3.9082e+05, 3.7248e+05, 0.0000e+00, 1.0840e+00,
         1.0550e+00, 9.7164e-01, 9.8003e-01, 3.8642e+05],
        [9.8161e-01, 9.9634e-01, 1.0750e+00, 1.0803e+00, 1.0644e+00, 3.8517e+05,
         9.8485e-01, 1.2028e+00, 3.9082e+05, 3.7249e+05, 1.0840e+00, 0.0000e+00,
         9.1162e-01, 9.5632e-01, 1.0478e+00, 3.8641e+05],
        [8.7165e-01, 9.1436e-01, 1.0222e+00, 1.0316e+00, 9.6438e-01, 3.8520e+05,
         1.0226e+00, 1.2750e+00, 3.9082e+05, 3.7250e+05, 1.0550e+00, 9.1162e-01,
         0.0000e+00, 9.2065e-01, 9.7413e-01, 3.8639e+05],
        [1.1913e+00, 1.0119e+00, 9.7433e-01, 9.7073e-01, 1.1895e+00, 3.8518e+05,
         9.8162e-01, 1.0617e+00, 3.9081e+05, 3.7250e+05, 9.7164e-01, 9.5632e-01,
         9.2065e-01, 0.0000e+00, 9.5103e-01, 3.8640e+05],
        [1.1142e+00, 9.8700e-01, 1.0831e+00, 1.0078e+00, 1.1063e+00, 3.8522e+05,
         1.0075e+00, 1.0982e+00, 3.9080e+05, 3.7250e+05, 9.8003e-01, 1.0478e+00,
         9.7413e-01, 9.5103e-01, 0.0000e+00, 3.8640e+05],
        [3.8639e+05, 3.8638e+05, 3.8640e+05, 3.8641e+05, 3.8640e+05, 7.5986e+05,
         3.8641e+05, 3.8641e+05, 7.7313e+05, 7.7530e+05, 3.8642e+05, 3.8641e+05,
         3.8639e+05, 3.8640e+05, 3.8640e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.7165e-01, 8.8956e-01, 9.3044e-01, 9.8161e-01, 1.1142e+00,
        1.1913e+00, 1.1914e+00, 1.2627e+00, 1.2953e+00, 1.3397e+00, 1.6511e+00,
        3.7249e+05, 3.8517e+05, 3.8639e+05, 3.9079e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1436e-01, 9.3044e-01, 9.5218e-01, 9.8700e-01, 9.9634e-01,
        1.0119e+00, 1.0475e+00, 1.0661e+00, 1.0784e+00, 1.1425e+00, 1.2728e+00,
        3.7250e+05, 3.8518e+05, 3.8638e+05, 3.9081e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7346e-01, 9.7433e-01, 1.0087e+00, 1.0222e+00, 1.0499e+00,
        1.0636e+00, 1.0661e+00, 1.0750e+00, 1.0831e+00, 1.1600e+00, 1.1914e+00,
        3.7249e+05, 3.8518e+05, 3.8640e+05, 3.9082e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7073e-01, 1.0078e+00, 1.0316e+00, 1.0407e+00, 1.0499e+00,
        1.0628e+00, 1.0803e+00, 1.0929e+00, 1.1425e+00, 1.2640e+00, 1.3397e+00,
        3.7251e+05, 3.8519e+05, 3.8641e+05, 3.9081e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8956e-01, 9.5218e-01, 9.6438e-01, 1.0644e+00, 1.1063e+00,
        1.1600e+00, 1.1895e+00, 1.2090e+00, 1.2239e+00, 1.2640e+00, 1.4184e+00,
        3.7248e+05, 3.8517e+05, 3.8640e+05, 3.9079e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 385165.5625, 385169.0938, 385170.0000, 385173.8750,
        385175.8125, 385180.7188, 385181.1875, 385183.6250, 385187.8438,
        385190.1875, 385204.0625, 385215.3750, 759862.7500, 764272.8125,
        775708.6250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 9.7240e-01, 9.7346e-01, 9.8162e-01, 9.8485e-01, 1.0005e+00,
        1.0075e+00, 1.0226e+00, 1.0475e+00, 1.0628e+00, 1.2090e+00, 1.2627e+00,
        3.7249e+05, 3.8517e+05, 3.8641e+05, 3.9081e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7240e-01, 1.0289e+00, 1.0407e+00, 1.0617e+00, 1.0636e+00,
        1.0982e+00, 1.2028e+00, 1.2728e+00, 1.2750e+00, 1.4184e+00, 1.6511e+00,
        3.7247e+05, 3.8519e+05, 3.8641e+05, 3.9082e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390788.6250, 390792.1875, 390802.9062, 390807.1250,
        390807.7188, 390811.4062, 390812.1250, 390815.4688, 390819.2500,
        390821.8438, 390822.3750, 390823.6875, 740043.4375, 773128.5625,
        775708.6250])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([     0.0000, 372467.6875, 372476.4688, 372483.6562, 372486.3438,
        372488.6250, 372489.6875, 372492.9375, 372496.8125, 372497.2500,
        372500.1250, 372504.1562, 372505.5000, 740043.4375, 764272.8125,
        775300.0000])
Index of maximum distance difference after half of values: 12
sorted_distances: tensor([0.0000e+00, 9.7164e-01, 9.8003e-01, 1.0005e+00, 1.0087e+00, 1.0289e+00,
        1.0550e+00, 1.0784e+00, 1.0840e+00, 1.0929e+00, 1.2239e+00, 1.2953e+00,
        3.7248e+05, 3.8518e+05, 3.8642e+05, 3.9082e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1162e-01, 9.5632e-01, 9.8161e-01, 9.8485e-01, 9.9634e-01,
        1.0478e+00, 1.0644e+00, 1.0750e+00, 1.0803e+00, 1.0840e+00, 1.2028e+00,
        3.7249e+05, 3.8517e+05, 3.8641e+05, 3.9082e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7165e-01, 9.1162e-01, 9.1436e-01, 9.2065e-01, 9.6438e-01,
        9.7413e-01, 1.0222e+00, 1.0226e+00, 1.0316e+00, 1.0550e+00, 1.2750e+00,
        3.7250e+05, 3.8520e+05, 3.8639e+05, 3.9082e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2065e-01, 9.5103e-01, 9.5632e-01, 9.7073e-01, 9.7164e-01,
        9.7433e-01, 9.8162e-01, 1.0119e+00, 1.0617e+00, 1.1895e+00, 1.1913e+00,
        3.7250e+05, 3.8518e+05, 3.8640e+05, 3.9081e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.5103e-01, 9.7413e-01, 9.8003e-01, 9.8700e-01, 1.0075e+00,
        1.0078e+00, 1.0478e+00, 1.0831e+00, 1.0982e+00, 1.1063e+00, 1.1142e+00,
        3.7250e+05, 3.8522e+05, 3.8640e+05, 3.9080e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386378.3438, 386385.0625, 386390.5625, 386398.0312,
        386399.2500, 386403.5938, 386403.7188, 386405.8750, 386407.8125,
        386411.1250, 386411.1875, 386424.3438, 759862.7500, 773128.5625,
        775300.0000])
Index of maximum distance difference after half of values: 12
adaptive_Krum scores:  ['1.11', '1.01', '1.05', '1.07', '1.10', '385183.09', '1.03', '1.14', '390810.41', '372490.78', '1.05', '1.02', '0.97', '1.00', '1.02', '386401.59']
estimated f for each client, fs: [5, 5, 5, 5, 5, 2, 5, 5, 2, 2, 5, 5, 5, 5, 5, 2]
selected_index: 12
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 8, 9, 3, 4, 13, 6, 1, 16, 14, 11, 2, 12, 10, 5, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0211s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:35...
global Accuracy on shared test data: 72.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 82 181]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:35, End: 2025-07-22 16:01:35)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 10, 11, 18, 16, 6, 15, 4, 2, 20, 5, 17, 3, 1, 12, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.1350e-01, 9.1200e-01, 4.0252e+05, 3.9595e+05, 8.7376e-01,
         3.9144e+05, 8.7691e-01, 9.1437e-01, 3.7918e+05, 9.6139e-01, 3.8687e+05,
         9.2115e-01, 9.9669e-01, 1.2605e+00, 3.8107e+05],
        [9.1350e-01, 0.0000e+00, 9.0984e-01, 4.0249e+05, 3.9595e+05, 9.3776e-01,
         3.9144e+05, 9.5585e-01, 8.6432e-01, 3.7917e+05, 8.8190e-01, 3.8687e+05,
         9.3248e-01, 1.0622e+00, 1.2013e+00, 3.8107e+05],
        [9.1200e-01, 9.0984e-01, 0.0000e+00, 4.0247e+05, 3.9595e+05, 9.1164e-01,
         3.9142e+05, 9.3599e-01, 9.3491e-01, 3.7918e+05, 8.6766e-01, 3.8688e+05,
         9.9309e-01, 9.7172e-01, 1.2946e+00, 3.8108e+05],
        [4.0252e+05, 4.0249e+05, 4.0247e+05, 0.0000e+00, 7.9171e+05, 4.0247e+05,
         7.8768e+05, 4.0248e+05, 4.0248e+05, 7.7108e+05, 4.0247e+05, 8.0402e+05,
         4.0251e+05, 4.0254e+05, 4.0247e+05, 7.8224e+05],
        [3.9595e+05, 3.9595e+05, 3.9595e+05, 7.9171e+05, 0.0000e+00, 3.9597e+05,
         7.8812e+05, 3.9595e+05, 3.9593e+05, 7.6228e+05, 3.9594e+05, 7.7709e+05,
         3.9593e+05, 3.9594e+05, 3.9593e+05, 7.9084e+05],
        [8.7376e-01, 9.3776e-01, 9.1164e-01, 4.0247e+05, 3.9597e+05, 0.0000e+00,
         3.9142e+05, 9.9080e-01, 8.9863e-01, 3.7918e+05, 9.2474e-01, 3.8689e+05,
         9.9069e-01, 9.3532e-01, 1.3463e+00, 3.8112e+05],
        [3.9144e+05, 3.9144e+05, 3.9142e+05, 7.8768e+05, 7.8812e+05, 3.9142e+05,
         0.0000e+00, 3.9145e+05, 3.9146e+05, 7.6854e+05, 3.9142e+05, 7.7074e+05,
         3.9146e+05, 3.9142e+05, 3.9144e+05, 7.9723e+05],
        [8.7691e-01, 9.5585e-01, 9.3599e-01, 4.0248e+05, 3.9595e+05, 9.9080e-01,
         3.9145e+05, 0.0000e+00, 8.2788e-01, 3.7916e+05, 8.8716e-01, 3.8688e+05,
         1.0170e+00, 1.1681e+00, 9.1472e-01, 3.8108e+05],
        [9.1437e-01, 8.6432e-01, 9.3491e-01, 4.0248e+05, 3.9593e+05, 8.9863e-01,
         3.9146e+05, 8.2788e-01, 0.0000e+00, 3.7918e+05, 9.2934e-01, 3.8689e+05,
         9.5288e-01, 1.0900e+00, 1.0286e+00, 3.8105e+05],
        [3.7918e+05, 3.7917e+05, 3.7918e+05, 7.7108e+05, 7.6228e+05, 3.7918e+05,
         7.6854e+05, 3.7916e+05, 3.7918e+05, 0.0000e+00, 3.7916e+05, 7.6892e+05,
         3.7917e+05, 3.7918e+05, 3.7917e+05, 7.7308e+05],
        [9.6139e-01, 8.8190e-01, 8.6766e-01, 4.0247e+05, 3.9594e+05, 9.2474e-01,
         3.9142e+05, 8.8716e-01, 9.2934e-01, 3.7916e+05, 0.0000e+00, 3.8688e+05,
         9.4939e-01, 1.0660e+00, 1.1711e+00, 3.8108e+05],
        [3.8687e+05, 3.8687e+05, 3.8688e+05, 8.0402e+05, 7.7709e+05, 3.8689e+05,
         7.7074e+05, 3.8688e+05, 3.8689e+05, 7.6892e+05, 3.8688e+05, 0.0000e+00,
         3.8687e+05, 3.8690e+05, 3.8686e+05, 7.6638e+05],
        [9.2115e-01, 9.3248e-01, 9.9309e-01, 4.0251e+05, 3.9593e+05, 9.9069e-01,
         3.9146e+05, 1.0170e+00, 9.5288e-01, 3.7917e+05, 9.4939e-01, 3.8687e+05,
         0.0000e+00, 1.0182e+00, 1.3062e+00, 3.8107e+05],
        [9.9669e-01, 1.0622e+00, 9.7172e-01, 4.0254e+05, 3.9594e+05, 9.3532e-01,
         3.9142e+05, 1.1681e+00, 1.0900e+00, 3.7918e+05, 1.0660e+00, 3.8690e+05,
         1.0182e+00, 0.0000e+00, 1.6827e+00, 3.8110e+05],
        [1.2605e+00, 1.2013e+00, 1.2946e+00, 4.0247e+05, 3.9593e+05, 1.3463e+00,
         3.9144e+05, 9.1472e-01, 1.0286e+00, 3.7917e+05, 1.1711e+00, 3.8686e+05,
         1.3062e+00, 1.6827e+00, 0.0000e+00, 3.8108e+05],
        [3.8107e+05, 3.8107e+05, 3.8108e+05, 7.8224e+05, 7.9084e+05, 3.8112e+05,
         7.9723e+05, 3.8108e+05, 3.8105e+05, 7.7308e+05, 3.8108e+05, 7.6638e+05,
         3.8107e+05, 3.8110e+05, 3.8108e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.7376e-01, 8.7691e-01, 9.1200e-01, 9.1350e-01, 9.1437e-01,
        9.2115e-01, 9.6139e-01, 9.9669e-01, 1.2605e+00, 3.7918e+05, 3.8107e+05,
        3.8687e+05, 3.9144e+05, 3.9595e+05, 4.0252e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6432e-01, 8.8190e-01, 9.0984e-01, 9.1350e-01, 9.3248e-01,
        9.3776e-01, 9.5585e-01, 1.0622e+00, 1.2013e+00, 3.7917e+05, 3.8107e+05,
        3.8687e+05, 3.9144e+05, 3.9595e+05, 4.0249e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6766e-01, 9.0984e-01, 9.1164e-01, 9.1200e-01, 9.3491e-01,
        9.3599e-01, 9.7172e-01, 9.9309e-01, 1.2946e+00, 3.7918e+05, 3.8108e+05,
        3.8688e+05, 3.9142e+05, 3.9595e+05, 4.0247e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402466.1562, 402468.7500, 402469.7812, 402473.5000,
        402475.5938, 402478.7500, 402489.8750, 402506.8125, 402519.0625,
        402538.6562, 771083.8750, 782242.2500, 787678.0000, 791708.3125,
        804019.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395932.3438, 395934.4062, 395934.4375, 395936.9062,
        395940.9375, 395945.8438, 395946.6875, 395947.5312, 395950.0312,
        395965.7500, 762278.1875, 777094.6250, 788119.4375, 790841.8125,
        791708.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.7376e-01, 8.9863e-01, 9.1164e-01, 9.2474e-01, 9.3532e-01,
        9.3776e-01, 9.9069e-01, 9.9080e-01, 1.3463e+00, 3.7918e+05, 3.8112e+05,
        3.8689e+05, 3.9142e+05, 3.9597e+05, 4.0247e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391419.2500, 391419.8438, 391420.5625, 391421.4062,
        391435.7188, 391436.6875, 391438.2500, 391450.0938, 391457.8438,
        391459.7812, 768541.3750, 770736.4375, 787678.0000, 788119.4375,
        797225.2500])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.2788e-01, 8.7691e-01, 8.8716e-01, 9.1472e-01, 9.3599e-01,
        9.5585e-01, 9.9080e-01, 1.0170e+00, 1.1681e+00, 3.7916e+05, 3.8108e+05,
        3.8688e+05, 3.9145e+05, 3.9595e+05, 4.0248e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.2788e-01, 8.6432e-01, 8.9863e-01, 9.1437e-01, 9.2934e-01,
        9.3491e-01, 9.5288e-01, 1.0286e+00, 1.0900e+00, 3.7918e+05, 3.8105e+05,
        3.8689e+05, 3.9146e+05, 3.9593e+05, 4.0248e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379162.7500, 379163.7500, 379167.8750, 379174.6250,
        379174.7500, 379175.2500, 379177.5938, 379179.1875, 379183.1250,
        379183.3125, 762278.1875, 768541.3750, 768919.2500, 771083.8750,
        773081.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6766e-01, 8.8190e-01, 8.8716e-01, 9.2474e-01, 9.2934e-01,
        9.4939e-01, 9.6139e-01, 1.0660e+00, 1.1711e+00, 3.7916e+05, 3.8108e+05,
        3.8688e+05, 3.9142e+05, 3.9594e+05, 4.0247e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386862.7500, 386866.6875, 386867.5625, 386871.7500,
        386879.7188, 386880.2500, 386881.6250, 386885.8125, 386894.2812,
        386902.9375, 766379.3125, 768919.2500, 770736.4375, 777094.6250,
        804019.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2115e-01, 9.3248e-01, 9.4939e-01, 9.5288e-01, 9.9069e-01,
        9.9309e-01, 1.0170e+00, 1.0182e+00, 1.3062e+00, 3.7917e+05, 3.8107e+05,
        3.8687e+05, 3.9146e+05, 3.9593e+05, 4.0251e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.3532e-01, 9.7172e-01, 9.9669e-01, 1.0182e+00, 1.0622e+00,
        1.0660e+00, 1.0900e+00, 1.1681e+00, 1.6827e+00, 3.7918e+05, 3.8110e+05,
        3.8690e+05, 3.9142e+05, 3.9594e+05, 4.0254e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.1472e-01, 1.0286e+00, 1.1711e+00, 1.2013e+00, 1.2605e+00,
        1.2946e+00, 1.3062e+00, 1.3463e+00, 1.6827e+00, 3.7917e+05, 3.8108e+05,
        3.8686e+05, 3.9144e+05, 3.9593e+05, 4.0247e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381054.9375, 381065.4062, 381071.9062, 381074.2500,
        381077.2812, 381077.5625, 381079.8750, 381082.6250, 381103.5000,
        381116.8750, 766379.3125, 773081.6250, 782242.2500, 790841.8125,
        797225.2500])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37919.17', '37918.33', '37918.40', '402488.69', '395943.50', '37918.80', '391435.94', '37917.23', '37919.18', '379174.22', '37917.14', '386879.31', '37918.38', '37918.76', '37917.90', '381080.41']
estimated f for each client, fs: [6, 6, 6, 4, 4, 6, 4, 6, 6, 5, 6, 4, 6, 6, 6, 5]
selected_index: 10
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 10, 11, 18, 16, 6, 15, 4, 2, 20, 5, 17, 3, 1, 12, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0114s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:35...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:35, End: 2025-07-22 16:01:35)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 16, 2, 4, 20, 5, 19, 11, 9, 1, 12, 15, 13, 6, 14, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0965e+05, 8.5896e-01, 9.6886e-01, 3.8066e+05, 1.0952e+00,
         3.8359e+05, 9.4136e-01, 9.5635e-01, 1.0902e+00, 1.0025e+00, 3.8666e+05,
         3.8121e+05, 9.6455e-01, 4.0274e+05, 3.8777e+05],
        [4.0965e+05, 0.0000e+00, 4.0967e+05, 4.0965e+05, 7.7565e+05, 4.0968e+05,
         7.7275e+05, 4.0966e+05, 4.0964e+05, 4.0963e+05, 4.0968e+05, 8.2137e+05,
         7.9346e+05, 4.0965e+05, 8.2042e+05, 7.8844e+05],
        [8.5896e-01, 4.0967e+05, 0.0000e+00, 8.3579e-01, 3.8066e+05, 1.0738e+00,
         3.8357e+05, 9.4185e-01, 9.5106e-01, 1.0758e+00, 8.9755e-01, 3.8667e+05,
         3.8121e+05, 8.8959e-01, 4.0272e+05, 3.8773e+05],
        [9.6886e-01, 4.0965e+05, 8.3579e-01, 0.0000e+00, 3.8066e+05, 9.4906e-01,
         3.8358e+05, 9.8423e-01, 9.4384e-01, 1.1729e+00, 8.0583e-01, 3.8667e+05,
         3.8119e+05, 9.8900e-01, 4.0271e+05, 3.8772e+05],
        [3.8066e+05, 7.7565e+05, 3.8066e+05, 3.8066e+05, 0.0000e+00, 3.8068e+05,
         7.4895e+05, 3.8066e+05, 3.8067e+05, 3.8069e+05, 3.8067e+05, 7.5664e+05,
         7.5345e+05, 3.8069e+05, 8.0148e+05, 7.5566e+05],
        [1.0952e+00, 4.0968e+05, 1.0738e+00, 9.4906e-01, 3.8068e+05, 0.0000e+00,
         3.8361e+05, 1.1734e+00, 1.2697e+00, 1.5212e+00, 8.2414e-01, 3.8668e+05,
         3.8121e+05, 1.2199e+00, 4.0273e+05, 3.8775e+05],
        [3.8359e+05, 7.7275e+05, 3.8357e+05, 3.8358e+05, 7.4895e+05, 3.8361e+05,
         0.0000e+00, 3.8356e+05, 3.8357e+05, 3.8359e+05, 3.8360e+05, 7.6701e+05,
         7.8552e+05, 3.8360e+05, 7.7592e+05, 7.7070e+05],
        [9.4136e-01, 4.0966e+05, 9.4185e-01, 9.8423e-01, 3.8066e+05, 1.1734e+00,
         3.8356e+05, 0.0000e+00, 9.4087e-01, 9.7968e-01, 1.1523e+00, 3.8666e+05,
         3.8122e+05, 9.5941e-01, 4.0271e+05, 3.8773e+05],
        [9.5635e-01, 4.0964e+05, 9.5106e-01, 9.4384e-01, 3.8067e+05, 1.2697e+00,
         3.8357e+05, 9.4087e-01, 0.0000e+00, 1.0332e+00, 1.1314e+00, 3.8666e+05,
         3.8122e+05, 9.4243e-01, 4.0278e+05, 3.8774e+05],
        [1.0902e+00, 4.0963e+05, 1.0758e+00, 1.1729e+00, 3.8069e+05, 1.5212e+00,
         3.8359e+05, 9.7968e-01, 1.0332e+00, 0.0000e+00, 1.4813e+00, 3.8667e+05,
         3.8125e+05, 9.6384e-01, 4.0276e+05, 3.8771e+05],
        [1.0025e+00, 4.0968e+05, 8.9755e-01, 8.0583e-01, 3.8067e+05, 8.2414e-01,
         3.8360e+05, 1.1523e+00, 1.1314e+00, 1.4813e+00, 0.0000e+00, 3.8667e+05,
         3.8119e+05, 1.1183e+00, 4.0271e+05, 3.8774e+05],
        [3.8666e+05, 8.2137e+05, 3.8667e+05, 3.8667e+05, 7.5664e+05, 3.8668e+05,
         7.6701e+05, 3.8666e+05, 3.8666e+05, 3.8667e+05, 3.8667e+05, 0.0000e+00,
         7.8487e+05, 3.8664e+05, 8.1423e+05, 7.5246e+05],
        [3.8121e+05, 7.9346e+05, 3.8121e+05, 3.8119e+05, 7.5345e+05, 3.8121e+05,
         7.8552e+05, 3.8122e+05, 3.8122e+05, 3.8125e+05, 3.8119e+05, 7.8487e+05,
         0.0000e+00, 3.8122e+05, 8.0798e+05, 7.8565e+05],
        [9.6455e-01, 4.0965e+05, 8.8959e-01, 9.8900e-01, 3.8069e+05, 1.2199e+00,
         3.8360e+05, 9.5941e-01, 9.4243e-01, 9.6384e-01, 1.1183e+00, 3.8664e+05,
         3.8122e+05, 0.0000e+00, 4.0276e+05, 3.8771e+05],
        [4.0274e+05, 8.2042e+05, 4.0272e+05, 4.0271e+05, 8.0148e+05, 4.0273e+05,
         7.7592e+05, 4.0271e+05, 4.0278e+05, 4.0276e+05, 4.0271e+05, 8.1423e+05,
         8.0798e+05, 4.0276e+05, 0.0000e+00, 7.6648e+05],
        [3.8777e+05, 7.8844e+05, 3.8773e+05, 3.8772e+05, 7.5566e+05, 3.8775e+05,
         7.7070e+05, 3.8773e+05, 3.8774e+05, 3.8771e+05, 3.8774e+05, 7.5246e+05,
         7.8565e+05, 3.8771e+05, 7.6648e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.5896e-01, 9.4136e-01, 9.5635e-01, 9.6455e-01, 9.6886e-01,
        1.0025e+00, 1.0902e+00, 1.0952e+00, 3.8066e+05, 3.8121e+05, 3.8359e+05,
        3.8666e+05, 3.8777e+05, 4.0274e+05, 4.0965e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 409633.4375, 409645.0000, 409647.9375, 409648.5625,
        409654.1562, 409657.1875, 409671.0625, 409678.3438, 409683.4375,
        772749.3125, 775649.5625, 788441.8125, 793463.2500, 820417.0000,
        821369.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.3579e-01, 8.5896e-01, 8.8959e-01, 8.9755e-01, 9.4185e-01,
        9.5106e-01, 1.0738e+00, 1.0758e+00, 3.8066e+05, 3.8121e+05, 3.8357e+05,
        3.8667e+05, 3.8773e+05, 4.0272e+05, 4.0967e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0583e-01, 8.3579e-01, 9.4384e-01, 9.4906e-01, 9.6886e-01,
        9.8423e-01, 9.8900e-01, 1.1729e+00, 3.8066e+05, 3.8119e+05, 3.8358e+05,
        3.8667e+05, 3.8772e+05, 4.0271e+05, 4.0965e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 380655.6562, 380657.4688, 380659.0625, 380660.4375,
        380666.1250, 380673.2188, 380682.0938, 380688.9375, 380690.1250,
        748949.6250, 753451.5000, 755660.6250, 756638.9375, 775649.5625,
        801477.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.2414e-01, 9.4906e-01, 1.0738e+00, 1.0952e+00, 1.1734e+00,
        1.2199e+00, 1.2697e+00, 1.5212e+00, 3.8068e+05, 3.8121e+05, 3.8361e+05,
        3.8668e+05, 3.8775e+05, 4.0273e+05, 4.0968e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383559.4688, 383565.2500, 383574.5000, 383578.6875,
        383587.0625, 383587.2188, 383595.5000, 383601.5000, 383608.9375,
        748949.6250, 767008.6250, 770698.3125, 772749.3125, 775923.5625,
        785517.9375])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4087e-01, 9.4136e-01, 9.4185e-01, 9.5941e-01, 9.7968e-01,
        9.8423e-01, 1.1523e+00, 1.1734e+00, 3.8066e+05, 3.8122e+05, 3.8356e+05,
        3.8666e+05, 3.8773e+05, 4.0271e+05, 4.0966e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.4087e-01, 9.4243e-01, 9.4384e-01, 9.5106e-01, 9.5635e-01,
        1.0332e+00, 1.1314e+00, 1.2697e+00, 3.8067e+05, 3.8122e+05, 3.8357e+05,
        3.8666e+05, 3.8774e+05, 4.0278e+05, 4.0964e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.6384e-01, 9.7968e-01, 1.0332e+00, 1.0758e+00, 1.0902e+00,
        1.1729e+00, 1.4813e+00, 1.5212e+00, 3.8069e+05, 3.8125e+05, 3.8359e+05,
        3.8667e+05, 3.8771e+05, 4.0276e+05, 4.0963e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0583e-01, 8.2414e-01, 8.9755e-01, 1.0025e+00, 1.1183e+00,
        1.1314e+00, 1.1523e+00, 1.4813e+00, 3.8067e+05, 3.8119e+05, 3.8360e+05,
        3.8667e+05, 3.8774e+05, 4.0271e+05, 4.0968e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 386637.7500, 386657.6250, 386660.0938, 386664.7812,
        386665.4688, 386666.3438, 386669.0938, 386671.1250, 386683.9688,
        752463.4375, 756638.9375, 767008.6250, 784872.3750, 814226.6250,
        821369.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381194.0938, 381194.4688, 381208.3438, 381208.8750,
        381211.0625, 381215.3125, 381218.5000, 381222.6562, 381254.1875,
        753451.5000, 784872.3750, 785517.9375, 785649.9375, 793463.2500,
        807984.8750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8959e-01, 9.4243e-01, 9.5941e-01, 9.6384e-01, 9.6455e-01,
        9.8900e-01, 1.1183e+00, 1.2199e+00, 3.8069e+05, 3.8122e+05, 3.8360e+05,
        3.8664e+05, 3.8771e+05, 4.0276e+05, 4.0965e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 402708.7188, 402713.0625, 402714.6875, 402722.0625,
        402732.5938, 402742.0312, 402759.7188, 402760.5625, 402776.9688,
        766480.6875, 775923.5625, 801477.1250, 807984.8750, 814226.6250,
        820417.0000])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 387707.8125, 387712.4062, 387719.3438, 387725.1250,
        387734.0312, 387739.0312, 387741.5625, 387753.3750, 387770.1562,
        752463.4375, 755660.6250, 766480.6875, 770698.3125, 785649.9375,
        788441.8125])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['76187.52', '445966.84', '76187.38', '76185.74', '417498.28', '76190.23', '420120.81', '76188.38', '76189.27', '76195.36', '76187.61', '423243.94', '418437.91', '76191.96', '439111.09', '424206.66']
estimated f for each client, fs: [7, 5, 7, 7, 5, 7, 5, 7, 7, 7, 7, 5, 5, 7, 5, 5]
selected_index: 3
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 16, 2, 4, 20, 5, 19, 11, 9, 1, 12, 15, 13, 6, 14, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0124s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:36...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:36, End: 2025-07-22 16:01:36)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 18, 2, 15, 4, 12, 3, 11, 7, 5, 20, 6, 1, 9, 8, 17], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.8617e+05, 3.8833e+05, 7.8252e+05, 3.8832e+05, 3.8833e+05,
         3.8835e+05, 3.8835e+05, 3.8831e+05, 3.8835e+05, 7.6962e+05, 3.8834e+05,
         3.8834e+05, 3.8834e+05, 3.8834e+05, 7.8866e+05],
        [7.8617e+05, 0.0000e+00, 4.0005e+05, 7.7794e+05, 4.0004e+05, 4.0003e+05,
         4.0002e+05, 4.0004e+05, 4.0001e+05, 4.0004e+05, 7.8333e+05, 4.0003e+05,
         4.0006e+05, 4.0004e+05, 4.0005e+05, 7.7015e+05],
        [3.8833e+05, 4.0005e+05, 0.0000e+00, 3.8886e+05, 1.0904e+00, 8.8593e-01,
         9.2870e-01, 9.5427e-01, 8.6089e-01, 9.0341e-01, 3.9216e+05, 9.1249e-01,
         1.0982e+00, 9.4180e-01, 8.7942e-01, 3.9476e+05],
        [7.8252e+05, 7.7794e+05, 3.8886e+05, 0.0000e+00, 3.8885e+05, 3.8885e+05,
         3.8885e+05, 3.8884e+05, 3.8883e+05, 3.8885e+05, 7.6540e+05, 3.8887e+05,
         3.8887e+05, 3.8883e+05, 3.8884e+05, 7.8266e+05],
        [3.8832e+05, 4.0004e+05, 1.0904e+00, 3.8885e+05, 0.0000e+00, 8.2166e-01,
         1.3595e+00, 1.3397e+00, 8.0620e-01, 8.9382e-01, 3.9219e+05, 1.3448e+00,
         1.6665e+00, 1.2248e+00, 9.8792e-01, 3.9476e+05],
        [3.8833e+05, 4.0003e+05, 8.8593e-01, 3.8885e+05, 8.2166e-01, 0.0000e+00,
         1.0964e+00, 1.1426e+00, 6.7223e-01, 7.6016e-01, 3.9214e+05, 1.1082e+00,
         1.4547e+00, 1.0401e+00, 8.5934e-01, 3.9474e+05],
        [3.8835e+05, 4.0002e+05, 9.2870e-01, 3.8885e+05, 1.3595e+00, 1.0964e+00,
         0.0000e+00, 9.8843e-01, 1.1166e+00, 9.8072e-01, 3.9218e+05, 9.7249e-01,
         9.9416e-01, 9.4359e-01, 9.9244e-01, 3.9476e+05],
        [3.8835e+05, 4.0004e+05, 9.5427e-01, 3.8884e+05, 1.3397e+00, 1.1426e+00,
         9.8843e-01, 0.0000e+00, 1.0935e+00, 1.0045e+00, 3.9219e+05, 9.3282e-01,
         9.9799e-01, 9.4292e-01, 9.6997e-01, 3.9476e+05],
        [3.8831e+05, 4.0001e+05, 8.6089e-01, 3.8883e+05, 8.0620e-01, 6.7223e-01,
         1.1166e+00, 1.0935e+00, 0.0000e+00, 7.4041e-01, 3.9216e+05, 1.0978e+00,
         1.4382e+00, 1.0117e+00, 8.2134e-01, 3.9477e+05],
        [3.8835e+05, 4.0004e+05, 9.0341e-01, 3.8885e+05, 8.9382e-01, 7.6016e-01,
         9.8072e-01, 1.0045e+00, 7.4041e-01, 0.0000e+00, 3.9217e+05, 9.9515e-01,
         1.2348e+00, 1.0064e+00, 8.0450e-01, 3.9475e+05],
        [7.6962e+05, 7.8333e+05, 3.9216e+05, 7.6540e+05, 3.9219e+05, 3.9214e+05,
         3.9218e+05, 3.9219e+05, 3.9216e+05, 3.9217e+05, 0.0000e+00, 3.9214e+05,
         3.9217e+05, 3.9217e+05, 3.9217e+05, 7.8386e+05],
        [3.8834e+05, 4.0003e+05, 9.1249e-01, 3.8887e+05, 1.3448e+00, 1.1082e+00,
         9.7249e-01, 9.3282e-01, 1.0978e+00, 9.9515e-01, 3.9214e+05, 0.0000e+00,
         9.7914e-01, 8.8340e-01, 9.4169e-01, 3.9477e+05],
        [3.8834e+05, 4.0006e+05, 1.0982e+00, 3.8887e+05, 1.6665e+00, 1.4547e+00,
         9.9416e-01, 9.9799e-01, 1.4382e+00, 1.2348e+00, 3.9217e+05, 9.7914e-01,
         0.0000e+00, 1.0038e+00, 1.1815e+00, 3.9479e+05],
        [3.8834e+05, 4.0004e+05, 9.4180e-01, 3.8883e+05, 1.2248e+00, 1.0401e+00,
         9.4359e-01, 9.4292e-01, 1.0117e+00, 1.0064e+00, 3.9217e+05, 8.8340e-01,
         1.0038e+00, 0.0000e+00, 9.3335e-01, 3.9479e+05],
        [3.8834e+05, 4.0005e+05, 8.7942e-01, 3.8884e+05, 9.8792e-01, 8.5934e-01,
         9.9244e-01, 9.6997e-01, 8.2134e-01, 8.0450e-01, 3.9217e+05, 9.4169e-01,
         1.1815e+00, 9.3335e-01, 0.0000e+00, 3.9477e+05],
        [7.8866e+05, 7.7015e+05, 3.9476e+05, 7.8266e+05, 3.9476e+05, 3.9474e+05,
         3.9476e+05, 3.9476e+05, 3.9477e+05, 3.9475e+05, 7.8386e+05, 3.9477e+05,
         3.9479e+05, 3.9479e+05, 3.9477e+05, 0.0000e+00]])
sorted_distances: tensor([     0.0000, 388311.4062, 388316.4688, 388325.1250, 388328.3125,
        388338.9375, 388340.8125, 388342.4062, 388343.7188, 388345.2500,
        388348.7188, 388349.0000, 769616.3750, 782524.5625, 786165.6250,
        788657.7500])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([     0.0000, 400013.0938, 400018.0625, 400027.7188, 400031.1875,
        400035.9375, 400040.0938, 400041.1875, 400042.0000, 400052.7812,
        400052.9062, 400055.1562, 770152.1250, 777941.6250, 783329.6250,
        786165.6250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.6089e-01, 8.7942e-01, 8.8593e-01, 9.0341e-01, 9.1249e-01,
        9.2870e-01, 9.4180e-01, 9.5427e-01, 1.0904e+00, 1.0982e+00, 3.8833e+05,
        3.8886e+05, 3.9216e+05, 3.9476e+05, 4.0005e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 388831.3750, 388832.0625, 388838.0625, 388843.7500,
        388847.1875, 388848.5938, 388851.5000, 388853.9688, 388856.6875,
        388867.6250, 388872.1562, 765402.8750, 777941.6250, 782524.5625,
        782657.1250])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.0620e-01, 8.2166e-01, 8.9382e-01, 9.8792e-01, 1.0904e+00,
        1.2248e+00, 1.3397e+00, 1.3448e+00, 1.3595e+00, 1.6665e+00, 3.8832e+05,
        3.8885e+05, 3.9219e+05, 3.9476e+05, 4.0004e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.7223e-01, 7.6016e-01, 8.2166e-01, 8.5934e-01, 8.8593e-01,
        1.0401e+00, 1.0964e+00, 1.1082e+00, 1.1426e+00, 1.4547e+00, 3.8833e+05,
        3.8885e+05, 3.9214e+05, 3.9474e+05, 4.0003e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2870e-01, 9.4359e-01, 9.7249e-01, 9.8072e-01, 9.8843e-01,
        9.9244e-01, 9.9416e-01, 1.0964e+00, 1.1166e+00, 1.3595e+00, 3.8835e+05,
        3.8885e+05, 3.9218e+05, 3.9476e+05, 4.0002e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.3282e-01, 9.4292e-01, 9.5427e-01, 9.6997e-01, 9.8843e-01,
        9.9799e-01, 1.0045e+00, 1.0935e+00, 1.1426e+00, 1.3397e+00, 3.8835e+05,
        3.8884e+05, 3.9219e+05, 3.9476e+05, 4.0004e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.7223e-01, 7.4041e-01, 8.0620e-01, 8.2134e-01, 8.6089e-01,
        1.0117e+00, 1.0935e+00, 1.0978e+00, 1.1166e+00, 1.4382e+00, 3.8831e+05,
        3.8883e+05, 3.9216e+05, 3.9477e+05, 4.0001e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.4041e-01, 7.6016e-01, 8.0450e-01, 8.9382e-01, 9.0341e-01,
        9.8072e-01, 9.9515e-01, 1.0045e+00, 1.0064e+00, 1.2348e+00, 3.8835e+05,
        3.8885e+05, 3.9217e+05, 3.9475e+05, 4.0004e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 392137.3125, 392143.2188, 392155.6562, 392163.6250,
        392167.8125, 392171.3125, 392171.9062, 392174.0625, 392180.0312,
        392187.5312, 392188.3125, 765402.8750, 769616.3750, 783329.6250,
        783857.8125])
Index of maximum distance difference after half of values: 11
sorted_distances: tensor([0.0000e+00, 8.8340e-01, 9.1249e-01, 9.3282e-01, 9.4169e-01, 9.7249e-01,
        9.7914e-01, 9.9515e-01, 1.0978e+00, 1.1082e+00, 1.3448e+00, 3.8834e+05,
        3.8887e+05, 3.9214e+05, 3.9477e+05, 4.0003e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.7914e-01, 9.9416e-01, 9.9799e-01, 1.0038e+00, 1.0982e+00,
        1.1815e+00, 1.2348e+00, 1.4382e+00, 1.4547e+00, 1.6665e+00, 3.8834e+05,
        3.8887e+05, 3.9217e+05, 3.9479e+05, 4.0006e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8340e-01, 9.3335e-01, 9.4180e-01, 9.4292e-01, 9.4359e-01,
        1.0038e+00, 1.0064e+00, 1.0117e+00, 1.0401e+00, 1.2248e+00, 3.8834e+05,
        3.8883e+05, 3.9217e+05, 3.9479e+05, 4.0004e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.0450e-01, 8.2134e-01, 8.5934e-01, 8.7942e-01, 9.3335e-01,
        9.4169e-01, 9.6997e-01, 9.8792e-01, 9.9244e-01, 1.1815e+00, 3.8834e+05,
        3.8884e+05, 3.9217e+05, 3.9477e+05, 4.0005e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 394743.2812, 394750.0312, 394758.7188, 394761.5938,
        394762.1250, 394762.6875, 394765.0312, 394767.8438, 394767.8750,
        394787.4375, 394791.8125, 770152.1250, 782657.1250, 783857.8125,
        788657.7500])
Index of maximum distance difference after half of values: 11
adaptive_Krum scores:  ['388335.47', '400037.28', '0.95', '388849.38', '1.15', '0.98', '1.04', '1.04', '0.97', '0.93', '392167.38', '1.02', '1.20', '0.99', '0.94', '394765.28']
estimated f for each client, fs: [3, 3, 5, 3, 5, 5, 5, 5, 5, 5, 3, 5, 5, 5, 5, 3]
selected_index: 9
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 18, 2, 15, 4, 12, 3, 11, 7, 5, 20, 6, 1, 9, 8, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0146s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:37...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:37, End: 2025-07-22 16:01:37)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 20, 18, 7, 14, 3, 9, 15, 5, 8, 1, 4, 11, 6, 17, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9764e+05, 3.7923e+05, 9.3688e-01, 3.9033e+05, 8.6383e-01,
         9.0041e-01, 3.8107e+05, 1.2513e+00, 9.1074e-01, 9.8714e-01, 9.8479e-01,
         8.8591e-01, 8.8520e-01, 4.0154e+05, 3.8447e+05],
        [3.9764e+05, 0.0000e+00, 7.8732e+05, 3.9760e+05, 7.7824e+05, 3.9765e+05,
         3.9764e+05, 7.7909e+05, 3.9760e+05, 3.9763e+05, 3.9766e+05, 3.9762e+05,
         3.9761e+05, 3.9763e+05, 8.1392e+05, 7.9292e+05],
        [3.7923e+05, 7.8732e+05, 0.0000e+00, 3.7922e+05, 7.7476e+05, 3.7921e+05,
         3.7924e+05, 7.6631e+05, 3.7922e+05, 3.7922e+05, 3.7923e+05, 3.7922e+05,
         3.7925e+05, 3.7923e+05, 7.6813e+05, 7.6109e+05],
        [9.3688e-01, 3.9760e+05, 3.7922e+05, 0.0000e+00, 3.9033e+05, 9.6730e-01,
         9.3817e-01, 3.8108e+05, 7.4335e-01, 7.7541e-01, 1.2591e+00, 6.0266e-01,
         9.8375e-01, 9.5164e-01, 4.0153e+05, 3.8449e+05],
        [3.9033e+05, 7.7824e+05, 7.7476e+05, 3.9033e+05, 0.0000e+00, 3.9031e+05,
         3.9033e+05, 7.7630e+05, 3.9033e+05, 3.9034e+05, 3.9033e+05, 3.9034e+05,
         3.9034e+05, 3.9034e+05, 7.6798e+05, 8.0153e+05],
        [8.6383e-01, 3.9765e+05, 3.7921e+05, 9.6730e-01, 3.9031e+05, 0.0000e+00,
         8.9590e-01, 3.8108e+05, 1.3071e+00, 9.3978e-01, 9.6496e-01, 1.0309e+00,
         9.6174e-01, 9.0761e-01, 4.0154e+05, 3.8447e+05],
        [9.0041e-01, 3.9764e+05, 3.7924e+05, 9.3817e-01, 3.9033e+05, 8.9590e-01,
         0.0000e+00, 3.8110e+05, 1.3067e+00, 9.2046e-01, 9.4240e-01, 9.7143e-01,
         8.9551e-01, 8.4116e-01, 4.0152e+05, 3.8446e+05],
        [3.8107e+05, 7.7909e+05, 7.6631e+05, 3.8108e+05, 7.7630e+05, 3.8108e+05,
         3.8110e+05, 0.0000e+00, 3.8108e+05, 3.8108e+05, 3.8113e+05, 3.8111e+05,
         3.8110e+05, 3.8112e+05, 7.8689e+05, 7.8366e+05],
        [1.2513e+00, 3.9760e+05, 3.7922e+05, 7.4335e-01, 3.9033e+05, 1.3071e+00,
         1.3067e+00, 3.8108e+05, 0.0000e+00, 1.0014e+00, 1.6660e+00, 7.4522e-01,
         1.3431e+00, 1.3386e+00, 4.0152e+05, 3.8448e+05],
        [9.1074e-01, 3.9763e+05, 3.7922e+05, 7.7541e-01, 3.9034e+05, 9.3978e-01,
         9.2046e-01, 3.8108e+05, 1.0014e+00, 0.0000e+00, 1.0847e+00, 7.6789e-01,
         9.5063e-01, 8.9517e-01, 4.0154e+05, 3.8448e+05],
        [9.8714e-01, 3.9766e+05, 3.7923e+05, 1.2591e+00, 3.9033e+05, 9.6496e-01,
         9.4240e-01, 3.8113e+05, 1.6660e+00, 1.0847e+00, 0.0000e+00, 1.2812e+00,
         9.1963e-01, 8.8994e-01, 4.0156e+05, 3.8447e+05],
        [9.8479e-01, 3.9762e+05, 3.7922e+05, 6.0266e-01, 3.9034e+05, 1.0309e+00,
         9.7143e-01, 3.8111e+05, 7.4522e-01, 7.6789e-01, 1.2812e+00, 0.0000e+00,
         1.0734e+00, 1.0258e+00, 4.0150e+05, 3.8448e+05],
        [8.8591e-01, 3.9761e+05, 3.7925e+05, 9.8375e-01, 3.9034e+05, 9.6174e-01,
         8.9551e-01, 3.8110e+05, 1.3431e+00, 9.5063e-01, 9.1963e-01, 1.0734e+00,
         0.0000e+00, 9.1184e-01, 4.0154e+05, 3.8445e+05],
        [8.8520e-01, 3.9763e+05, 3.7923e+05, 9.5164e-01, 3.9034e+05, 9.0761e-01,
         8.4116e-01, 3.8112e+05, 1.3386e+00, 8.9517e-01, 8.8994e-01, 1.0258e+00,
         9.1184e-01, 0.0000e+00, 4.0153e+05, 3.8445e+05],
        [4.0154e+05, 8.1392e+05, 7.6813e+05, 4.0153e+05, 7.6798e+05, 4.0154e+05,
         4.0152e+05, 7.8689e+05, 4.0152e+05, 4.0154e+05, 4.0156e+05, 4.0150e+05,
         4.0154e+05, 4.0153e+05, 0.0000e+00, 7.6827e+05],
        [3.8447e+05, 7.9292e+05, 7.6109e+05, 3.8449e+05, 8.0153e+05, 3.8447e+05,
         3.8446e+05, 7.8366e+05, 3.8448e+05, 3.8448e+05, 3.8447e+05, 3.8448e+05,
         3.8445e+05, 3.8445e+05, 7.6827e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.6383e-01, 8.8520e-01, 8.8591e-01, 9.0041e-01, 9.1074e-01,
        9.3688e-01, 9.8479e-01, 9.8714e-01, 1.2513e+00, 3.7923e+05, 3.8107e+05,
        3.8447e+05, 3.9033e+05, 3.9764e+05, 4.0154e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 397598.3125, 397603.7500, 397605.5312, 397621.8125,
        397625.5312, 397626.0000, 397635.5000, 397638.3125, 397647.4062,
        397655.0625, 778239.1875, 779086.5625, 787323.1250, 792916.0625,
        813918.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 379210.0625, 379216.6250, 379218.3438, 379218.4688,
        379219.8125, 379225.9375, 379228.1875, 379234.7812, 379242.5938,
        379250.9375, 761088.8750, 766308.7500, 768134.5625, 774756.1875,
        787323.1250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.0266e-01, 7.4335e-01, 7.7541e-01, 9.3688e-01, 9.3817e-01,
        9.5164e-01, 9.6730e-01, 9.8375e-01, 1.2591e+00, 3.7922e+05, 3.8108e+05,
        3.8449e+05, 3.9033e+05, 3.9760e+05, 4.0153e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390307.2500, 390328.7500, 390331.7812, 390332.3750,
        390332.8750, 390333.8125, 390335.3750, 390340.0625, 390344.1250,
        390344.1562, 767976.6250, 774756.1875, 776303.0000, 778239.1875,
        801526.6250])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.6383e-01, 8.9590e-01, 9.0761e-01, 9.3978e-01, 9.6174e-01,
        9.6496e-01, 9.6730e-01, 1.0309e+00, 1.3071e+00, 3.7921e+05, 3.8108e+05,
        3.8447e+05, 3.9031e+05, 3.9765e+05, 4.0154e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4116e-01, 8.9551e-01, 8.9590e-01, 9.0041e-01, 9.2046e-01,
        9.3817e-01, 9.4240e-01, 9.7143e-01, 1.3067e+00, 3.7924e+05, 3.8110e+05,
        3.8446e+05, 3.9033e+05, 3.9764e+05, 4.0152e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 381074.0625, 381077.0938, 381079.2500, 381082.0625,
        381084.0938, 381098.1875, 381101.2812, 381110.7500, 381117.0312,
        381126.4375, 766308.7500, 776303.0000, 779086.5625, 783656.3125,
        786890.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.4335e-01, 7.4522e-01, 1.0014e+00, 1.2513e+00, 1.3067e+00,
        1.3071e+00, 1.3386e+00, 1.3431e+00, 1.6660e+00, 3.7922e+05, 3.8108e+05,
        3.8448e+05, 3.9033e+05, 3.9760e+05, 4.0152e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.6789e-01, 7.7541e-01, 8.9517e-01, 9.1074e-01, 9.2046e-01,
        9.3978e-01, 9.5063e-01, 1.0014e+00, 1.0847e+00, 3.7922e+05, 3.8108e+05,
        3.8448e+05, 3.9034e+05, 3.9763e+05, 4.0154e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8994e-01, 9.1963e-01, 9.4240e-01, 9.6496e-01, 9.8714e-01,
        1.0847e+00, 1.2591e+00, 1.2812e+00, 1.6660e+00, 3.7923e+05, 3.8113e+05,
        3.8447e+05, 3.9033e+05, 3.9766e+05, 4.0156e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.0266e-01, 7.4522e-01, 7.6789e-01, 9.7143e-01, 9.8479e-01,
        1.0258e+00, 1.0309e+00, 1.0734e+00, 1.2812e+00, 3.7922e+05, 3.8111e+05,
        3.8448e+05, 3.9034e+05, 3.9762e+05, 4.0150e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.8591e-01, 8.9551e-01, 9.1184e-01, 9.1963e-01, 9.5063e-01,
        9.6174e-01, 9.8375e-01, 1.0734e+00, 1.3431e+00, 3.7925e+05, 3.8110e+05,
        3.8445e+05, 3.9034e+05, 3.9761e+05, 4.0154e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.4116e-01, 8.8520e-01, 8.8994e-01, 8.9517e-01, 9.0761e-01,
        9.1184e-01, 9.5164e-01, 1.0258e+00, 1.3386e+00, 3.7923e+05, 3.8112e+05,
        3.8445e+05, 3.9034e+05, 3.9763e+05, 4.0153e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 401501.9688, 401515.2500, 401517.6250, 401525.5312,
        401534.2188, 401536.3125, 401541.5312, 401543.3750, 401544.4062,
        401558.1250, 767976.6250, 768134.5625, 768268.2500, 786890.3750,
        813918.3750])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 384448.8125, 384449.0000, 384458.2500, 384467.2500,
        384468.1875, 384469.0625, 384478.5000, 384481.9375, 384482.3750,
        384492.7188, 761088.8750, 768268.2500, 783656.3125, 792916.0625,
        801526.6250])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['37923.46', '397625.69', '379226.56', '37922.66', '390333.06', '37921.89', '37925.12', '381095.03', '37922.73', '37922.80', '37923.82', '37922.68', '37925.98', '37924.34', '401531.84', '384469.62']
estimated f for each client, fs: [6, 4, 5, 6, 4, 6, 6, 5, 6, 6, 6, 6, 6, 6, 4, 4]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 20, 18, 7, 14, 3, 9, 15, 5, 8, 1, 4, 11, 6, 17, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0112s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:37...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:37, End: 2025-07-22 16:01:37)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 13, 18, 9, 4, 1, 16, 14, 20, 5, 17, 8, 6, 10, 12, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9142e+05, 3.9044e+05, 9.8025e-01, 9.2883e-01, 1.0543e+00,
         3.8322e+05, 3.9318e+05, 3.9566e+05, 9.8428e-01, 3.9620e+05, 8.9759e-01,
         9.3022e-01, 8.9222e-01, 9.0892e-01, 3.9620e+05],
        [3.9142e+05, 0.0000e+00, 7.8841e+05, 3.9141e+05, 3.9142e+05, 3.9142e+05,
         7.7798e+05, 7.9317e+05, 7.7211e+05, 3.9143e+05, 7.8252e+05, 3.9143e+05,
         3.9146e+05, 3.9144e+05, 3.9143e+05, 7.9282e+05],
        [3.9044e+05, 7.8841e+05, 0.0000e+00, 3.9043e+05, 3.9046e+05, 3.9041e+05,
         7.5976e+05, 7.7602e+05, 7.6458e+05, 3.9046e+05, 8.1147e+05, 3.9046e+05,
         3.9043e+05, 3.9042e+05, 3.9045e+05, 8.0012e+05],
        [9.8025e-01, 3.9141e+05, 3.9043e+05, 0.0000e+00, 1.0967e+00, 9.9810e-01,
         3.8323e+05, 3.9317e+05, 3.9569e+05, 1.1756e+00, 3.9623e+05, 1.0035e+00,
         9.6721e-01, 9.6242e-01, 1.0921e+00, 3.9617e+05],
        [9.2883e-01, 3.9142e+05, 3.9046e+05, 1.0967e+00, 0.0000e+00, 1.3376e+00,
         3.8321e+05, 3.9316e+05, 3.9567e+05, 6.8366e-01, 3.9622e+05, 8.5645e-01,
         1.1947e+00, 1.0597e+00, 7.2506e-01, 3.9623e+05],
        [1.0543e+00, 3.9142e+05, 3.9041e+05, 9.9810e-01, 1.3376e+00, 0.0000e+00,
         3.8319e+05, 3.9320e+05, 3.9568e+05, 1.4199e+00, 3.9621e+05, 1.1202e+00,
         9.2235e-01, 1.0150e+00, 1.3709e+00, 3.9616e+05],
        [3.8322e+05, 7.7798e+05, 7.5976e+05, 3.8323e+05, 3.8321e+05, 3.8319e+05,
         0.0000e+00, 7.6438e+05, 7.7086e+05, 3.8321e+05, 7.7883e+05, 3.8322e+05,
         3.8320e+05, 3.8321e+05, 3.8322e+05, 7.7305e+05],
        [3.9318e+05, 7.9317e+05, 7.7602e+05, 3.9317e+05, 3.9316e+05, 3.9320e+05,
         7.6438e+05, 0.0000e+00, 8.1017e+05, 3.9314e+05, 7.8993e+05, 3.9319e+05,
         3.9319e+05, 3.9318e+05, 3.9315e+05, 8.0730e+05],
        [3.9566e+05, 7.7211e+05, 7.6458e+05, 3.9569e+05, 3.9567e+05, 3.9568e+05,
         7.7086e+05, 8.1017e+05, 0.0000e+00, 3.9567e+05, 7.9218e+05, 3.9568e+05,
         3.9566e+05, 3.9568e+05, 3.9567e+05, 7.9979e+05],
        [9.8428e-01, 3.9143e+05, 3.9046e+05, 1.1756e+00, 6.8366e-01, 1.4199e+00,
         3.8321e+05, 3.9314e+05, 3.9567e+05, 0.0000e+00, 3.9624e+05, 8.7658e-01,
         1.2437e+00, 1.0423e+00, 7.2296e-01, 3.9618e+05],
        [3.9620e+05, 7.8252e+05, 8.1147e+05, 3.9623e+05, 3.9622e+05, 3.9621e+05,
         7.7883e+05, 7.8993e+05, 7.9218e+05, 3.9624e+05, 0.0000e+00, 3.9622e+05,
         3.9623e+05, 3.9621e+05, 3.9622e+05, 7.8452e+05],
        [8.9759e-01, 3.9143e+05, 3.9046e+05, 1.0035e+00, 8.5645e-01, 1.1202e+00,
         3.8322e+05, 3.9319e+05, 3.9568e+05, 8.7658e-01, 3.9622e+05, 0.0000e+00,
         9.8980e-01, 9.7173e-01, 8.9045e-01, 3.9618e+05],
        [9.3022e-01, 3.9146e+05, 3.9043e+05, 9.6721e-01, 1.1947e+00, 9.2235e-01,
         3.8320e+05, 3.9319e+05, 3.9566e+05, 1.2437e+00, 3.9623e+05, 9.8980e-01,
         0.0000e+00, 9.9846e-01, 1.1469e+00, 3.9615e+05],
        [8.9222e-01, 3.9144e+05, 3.9042e+05, 9.6242e-01, 1.0597e+00, 1.0150e+00,
         3.8321e+05, 3.9318e+05, 3.9568e+05, 1.0423e+00, 3.9621e+05, 9.7173e-01,
         9.9846e-01, 0.0000e+00, 1.0124e+00, 3.9620e+05],
        [9.0892e-01, 3.9143e+05, 3.9045e+05, 1.0921e+00, 7.2506e-01, 1.3709e+00,
         3.8322e+05, 3.9315e+05, 3.9567e+05, 7.2296e-01, 3.9622e+05, 8.9045e-01,
         1.1469e+00, 1.0124e+00, 0.0000e+00, 3.9620e+05],
        [3.9620e+05, 7.9282e+05, 8.0012e+05, 3.9617e+05, 3.9623e+05, 3.9616e+05,
         7.7305e+05, 8.0730e+05, 7.9979e+05, 3.9618e+05, 7.8452e+05, 3.9618e+05,
         3.9615e+05, 3.9620e+05, 3.9620e+05, 0.0000e+00]])
sorted_distances: tensor([0.0000e+00, 8.9222e-01, 8.9759e-01, 9.0892e-01, 9.2883e-01, 9.3022e-01,
        9.8025e-01, 9.8428e-01, 1.0543e+00, 3.8322e+05, 3.9044e+05, 3.9142e+05,
        3.9318e+05, 3.9566e+05, 3.9620e+05, 3.9620e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 391413.4688, 391418.0625, 391419.7812, 391420.8750,
        391426.5625, 391427.0625, 391430.1250, 391442.3125, 391456.0625,
        772114.9375, 777980.5625, 782525.0000, 788410.5625, 792820.4375,
        793174.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 390411.5625, 390422.4375, 390430.5000, 390430.9062,
        390436.2500, 390446.3125, 390460.0938, 390461.3125, 390461.3750,
        759758.8125, 764583.0625, 776017.4375, 788410.5625, 800124.1250,
        811468.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.6242e-01, 9.6721e-01, 9.8025e-01, 9.9810e-01, 1.0035e+00,
        1.0921e+00, 1.0967e+00, 1.1756e+00, 3.8323e+05, 3.9043e+05, 3.9141e+05,
        3.9317e+05, 3.9569e+05, 3.9617e+05, 3.9623e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.8366e-01, 7.2506e-01, 8.5645e-01, 9.2883e-01, 1.0597e+00,
        1.0967e+00, 1.1947e+00, 1.3376e+00, 3.8321e+05, 3.9046e+05, 3.9142e+05,
        3.9316e+05, 3.9567e+05, 3.9622e+05, 3.9623e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2235e-01, 9.9810e-01, 1.0150e+00, 1.0543e+00, 1.1202e+00,
        1.3376e+00, 1.3709e+00, 1.4199e+00, 3.8319e+05, 3.9041e+05, 3.9142e+05,
        3.9320e+05, 3.9568e+05, 3.9616e+05, 3.9621e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 383186.5000, 383203.0000, 383205.4375, 383212.8750,
        383212.9375, 383215.4375, 383223.0312, 383223.9375, 383226.5000,
        759758.8125, 764378.3125, 770858.7500, 773054.6250, 777980.5625,
        778830.3125])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 393144.3750, 393154.5938, 393156.3125, 393174.9688,
        393176.4688, 393182.5000, 393187.5312, 393189.3125, 393196.1875,
        764378.3125, 776017.4375, 789928.1875, 793174.1875, 807300.2500,
        810166.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 395655.6250, 395661.5625, 395668.5625, 395670.3750,
        395672.3125, 395680.2188, 395680.5000, 395681.8438, 395686.6875,
        764583.0625, 770858.7500, 772114.9375, 792183.9375, 799793.1250,
        810166.6875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 6.8366e-01, 7.2296e-01, 8.7658e-01, 9.8428e-01, 1.0423e+00,
        1.1756e+00, 1.2437e+00, 1.4199e+00, 3.8321e+05, 3.9046e+05, 3.9143e+05,
        3.9314e+05, 3.9567e+05, 3.9618e+05, 3.9624e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396195.5938, 396207.6562, 396209.0938, 396218.0938,
        396220.7500, 396220.8750, 396226.1562, 396229.7812, 396240.8438,
        778830.3125, 782525.0000, 784524.4375, 789928.1875, 792183.9375,
        811468.1875])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.5645e-01, 8.7658e-01, 8.9045e-01, 8.9759e-01, 9.7173e-01,
        9.8980e-01, 1.0035e+00, 1.1202e+00, 3.8322e+05, 3.9046e+05, 3.9143e+05,
        3.9319e+05, 3.9568e+05, 3.9618e+05, 3.9622e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 9.2235e-01, 9.3022e-01, 9.6721e-01, 9.8980e-01, 9.9846e-01,
        1.1469e+00, 1.1947e+00, 1.2437e+00, 3.8320e+05, 3.9043e+05, 3.9146e+05,
        3.9319e+05, 3.9566e+05, 3.9615e+05, 3.9623e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 8.9222e-01, 9.6242e-01, 9.7173e-01, 9.9846e-01, 1.0124e+00,
        1.0150e+00, 1.0423e+00, 1.0597e+00, 3.8321e+05, 3.9042e+05, 3.9144e+05,
        3.9318e+05, 3.9568e+05, 3.9620e+05, 3.9621e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([0.0000e+00, 7.2296e-01, 7.2506e-01, 8.9045e-01, 9.0892e-01, 1.0124e+00,
        1.0921e+00, 1.1469e+00, 1.3709e+00, 3.8322e+05, 3.9045e+05, 3.9143e+05,
        3.9315e+05, 3.9567e+05, 3.9620e+05, 3.9622e+05])
Index of maximum distance difference after half of values: 10
sorted_distances: tensor([     0.0000, 396147.3438, 396158.5312, 396174.5938, 396179.0000,
        396182.3125, 396198.4062, 396199.8125, 396202.1562, 396226.5625,
        773054.6250, 784524.4375, 792820.4375, 799793.1250, 800124.1250,
        807300.2500])
Index of maximum distance difference after half of values: 10
adaptive_Krum scores:  ['77365.93', '429496.91', '427371.94', '77366.52', '77368.21', '77360.73', '420866.84', '430294.06', '432564.09', '77367.51', '434479.91', '77369.08', '77364.23', '77364.33', '77367.81', '433872.34']
estimated f for each client, fs: [7, 5, 5, 7, 7, 7, 5, 5, 5, 7, 5, 7, 7, 7, 7, 5]
selected_index: 5
rkrum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 13, 18, 9, 4, 1, 16, 14, 20, 5, 17, 8, 6, 10, 12, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0113s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:38...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[167  70]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:38, End: 2025-07-22 16:01:38)
start time is: 99062280850845, end time is: 99080232798682
The total time is: 17951947837ns.

 ------- aggregate method: krum, random_seed: 0 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 3, 1, 13, 7, 14, 20, 12, 17, 5, 4, 19, 16, 10, 6, 11], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0782e+05, 4.0781e+05, 7.9168e+05, 4.0780e+05, 7.9267e+05,
         7.8040e+05, 4.0782e+05, 8.1076e+05, 4.0781e+05, 4.0781e+05, 8.3057e+05,
         7.9921e+05, 4.0781e+05, 4.0790e+05, 4.0778e+05],
        [4.0782e+05, 0.0000e+00, 4.4475e+00, 3.9196e+05, 3.7957e+00, 3.8853e+05,
         3.6682e+05, 4.2813e+00, 3.9674e+05, 3.9438e+00, 4.0201e+00, 3.9814e+05,
         3.8985e+05, 4.1487e+00, 4.7302e+00, 4.2971e+00],
        [4.0781e+05, 4.4475e+00, 0.0000e+00, 3.9203e+05, 4.8955e+00, 3.8855e+05,
         3.6682e+05, 4.6600e+00, 3.9674e+05, 4.1698e+00, 4.3490e+00, 3.9817e+05,
         3.8992e+05, 4.3946e+00, 4.7179e+00, 4.5480e+00],
        [7.9168e+05, 3.9196e+05, 3.9203e+05, 0.0000e+00, 3.9196e+05, 7.7922e+05,
         7.8422e+05, 3.9200e+05, 8.1022e+05, 3.9202e+05, 3.9198e+05, 8.1188e+05,
         7.5375e+05, 3.9199e+05, 3.9192e+05, 3.9194e+05],
        [4.0780e+05, 3.7957e+00, 4.8955e+00, 3.9196e+05, 0.0000e+00, 3.8854e+05,
         3.6687e+05, 4.0041e+00, 3.9672e+05, 3.7912e+00, 4.2296e+00, 3.9817e+05,
         3.8990e+05, 4.2448e+00, 4.6887e+00, 4.4737e+00],
        [7.9267e+05, 3.8853e+05, 3.8855e+05, 7.7922e+05, 3.8854e+05, 0.0000e+00,
         7.4331e+05, 3.8855e+05, 7.9024e+05, 3.8851e+05, 3.8850e+05, 7.7604e+05,
         7.7660e+05, 3.8851e+05, 3.8853e+05, 3.8856e+05],
        [7.8040e+05, 3.6682e+05, 3.6682e+05, 7.8422e+05, 3.6687e+05, 7.4331e+05,
         0.0000e+00, 3.6684e+05, 7.5269e+05, 3.6679e+05, 3.6681e+05, 7.4886e+05,
         7.5483e+05, 3.6682e+05, 3.6680e+05, 3.6681e+05],
        [4.0782e+05, 4.2813e+00, 4.6600e+00, 3.9200e+05, 4.0041e+00, 3.8855e+05,
         3.6684e+05, 0.0000e+00, 3.9673e+05, 3.7617e+00, 4.3553e+00, 3.9818e+05,
         3.8985e+05, 3.7129e+00, 4.4094e+00, 4.4081e+00],
        [8.1076e+05, 3.9674e+05, 3.9674e+05, 8.1022e+05, 3.9672e+05, 7.9024e+05,
         7.5269e+05, 3.9673e+05, 0.0000e+00, 3.9672e+05, 3.9672e+05, 7.8372e+05,
         8.0177e+05, 3.9676e+05, 3.9666e+05, 3.9674e+05],
        [4.0781e+05, 3.9438e+00, 4.1698e+00, 3.9202e+05, 3.7912e+00, 3.8851e+05,
         3.6679e+05, 3.7617e+00, 3.9672e+05, 0.0000e+00, 4.3643e+00, 3.9816e+05,
         3.8986e+05, 4.2791e+00, 4.9725e+00, 4.1428e+00],
        [4.0781e+05, 4.0201e+00, 4.3490e+00, 3.9198e+05, 4.2296e+00, 3.8850e+05,
         3.6681e+05, 4.3553e+00, 3.9672e+05, 4.3643e+00, 0.0000e+00, 3.9816e+05,
         3.8987e+05, 3.9699e+00, 4.0679e+00, 3.6942e+00],
        [8.3057e+05, 3.9814e+05, 3.9817e+05, 8.1188e+05, 3.9817e+05, 7.7604e+05,
         7.4886e+05, 3.9818e+05, 7.8372e+05, 3.9816e+05, 3.9816e+05, 0.0000e+00,
         7.8752e+05, 3.9820e+05, 3.9816e+05, 3.9818e+05],
        [7.9921e+05, 3.8985e+05, 3.8992e+05, 7.5375e+05, 3.8990e+05, 7.7660e+05,
         7.5483e+05, 3.8985e+05, 8.0177e+05, 3.8986e+05, 3.8987e+05, 7.8752e+05,
         0.0000e+00, 3.8993e+05, 3.8985e+05, 3.8985e+05],
        [4.0781e+05, 4.1487e+00, 4.3946e+00, 3.9199e+05, 4.2448e+00, 3.8851e+05,
         3.6682e+05, 3.7129e+00, 3.9676e+05, 4.2791e+00, 3.9699e+00, 3.9820e+05,
         3.8993e+05, 0.0000e+00, 4.2505e+00, 4.0771e+00],
        [4.0790e+05, 4.7302e+00, 4.7179e+00, 3.9192e+05, 4.6887e+00, 3.8853e+05,
         3.6680e+05, 4.4094e+00, 3.9666e+05, 4.9725e+00, 4.0679e+00, 3.9816e+05,
         3.8985e+05, 4.2505e+00, 0.0000e+00, 4.3484e+00],
        [4.0778e+05, 4.2971e+00, 4.5480e+00, 3.9194e+05, 4.4737e+00, 3.8856e+05,
         3.6681e+05, 4.4081e+00, 3.9674e+05, 4.1428e+00, 3.6942e+00, 3.9818e+05,
         3.8985e+05, 4.0771e+00, 4.3484e+00, 0.0000e+00]])
Krum scores: ['407805.00', '4.13', '4.47', '391964.91', '4.18', '388524.84', '366809.22', '4.13', '396718.28', '4.06', '4.10', '398163.41', '389860.44', '4.10', '4.46', '4.21']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 3, 1, 13, 7, 14, 20, 12, 17, 5, 4, 19, 16, 10, 6, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:38...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:38, End: 2025-07-22 16:01:38)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 13, 6, 12, 4, 1, 10, 9, 18, 5, 17, 8, 15, 16, 19, 14], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.6659e+05, 4.0100e+05, 4.0099e+05, 4.0101e+05, 4.0101e+05,
         4.0100e+05, 4.0098e+05, 7.8960e+05, 4.0097e+05, 8.0211e+05, 4.0096e+05,
         7.8402e+05, 7.8072e+05, 8.1270e+05, 8.0402e+05],
        [7.6659e+05, 0.0000e+00, 3.8002e+05, 3.7999e+05, 3.7999e+05, 3.8005e+05,
         3.8001e+05, 3.7999e+05, 7.2756e+05, 3.7998e+05, 7.7652e+05, 3.8002e+05,
         7.5863e+05, 7.9350e+05, 8.0349e+05, 7.8433e+05],
        [4.0100e+05, 3.8002e+05, 0.0000e+00, 1.9530e+00, 1.9348e+00, 1.9240e+00,
         1.9449e+00, 1.8558e+00, 3.8788e+05, 2.2286e+00, 3.8247e+05, 2.1100e+00,
         4.0165e+05, 3.8725e+05, 4.0538e+05, 3.9954e+05],
        [4.0099e+05, 3.7999e+05, 1.9530e+00, 0.0000e+00, 1.7128e+00, 1.8905e+00,
         1.7978e+00, 1.8158e+00, 3.8788e+05, 2.0111e+00, 3.8248e+05, 1.9690e+00,
         4.0164e+05, 3.8723e+05, 4.0538e+05, 3.9956e+05],
        [4.0101e+05, 3.7999e+05, 1.9348e+00, 1.7128e+00, 0.0000e+00, 1.8791e+00,
         1.8861e+00, 1.8008e+00, 3.8786e+05, 2.0256e+00, 3.8247e+05, 1.9527e+00,
         4.0166e+05, 3.8724e+05, 4.0536e+05, 3.9953e+05],
        [4.0101e+05, 3.8005e+05, 1.9240e+00, 1.8905e+00, 1.8791e+00, 0.0000e+00,
         1.8583e+00, 1.8192e+00, 3.8789e+05, 2.0553e+00, 3.8249e+05, 2.1525e+00,
         4.0163e+05, 3.8725e+05, 4.0538e+05, 3.9954e+05],
        [4.0100e+05, 3.8001e+05, 1.9449e+00, 1.7978e+00, 1.8861e+00, 1.8583e+00,
         0.0000e+00, 1.7078e+00, 3.8788e+05, 2.0601e+00, 3.8248e+05, 1.9767e+00,
         4.0167e+05, 3.8726e+05, 4.0539e+05, 3.9953e+05],
        [4.0098e+05, 3.7999e+05, 1.8558e+00, 1.8158e+00, 1.8008e+00, 1.8192e+00,
         1.7078e+00, 0.0000e+00, 3.8789e+05, 2.0714e+00, 3.8246e+05, 1.9526e+00,
         4.0164e+05, 3.8723e+05, 4.0536e+05, 3.9954e+05],
        [7.8960e+05, 7.2756e+05, 3.8788e+05, 3.8788e+05, 3.8786e+05, 3.8789e+05,
         3.8788e+05, 3.8789e+05, 0.0000e+00, 3.8790e+05, 7.6860e+05, 3.8785e+05,
         8.0934e+05, 7.5924e+05, 7.8110e+05, 7.6492e+05],
        [4.0097e+05, 3.7998e+05, 2.2286e+00, 2.0111e+00, 2.0256e+00, 2.0553e+00,
         2.0601e+00, 2.0714e+00, 3.8790e+05, 0.0000e+00, 3.8247e+05, 2.3272e+00,
         4.0166e+05, 3.8723e+05, 4.0538e+05, 3.9955e+05],
        [8.0211e+05, 7.7652e+05, 3.8247e+05, 3.8248e+05, 3.8247e+05, 3.8249e+05,
         3.8248e+05, 3.8246e+05, 7.6860e+05, 3.8247e+05, 0.0000e+00, 3.8245e+05,
         7.9124e+05, 7.7588e+05, 7.8423e+05, 7.6873e+05],
        [4.0096e+05, 3.8002e+05, 2.1100e+00, 1.9690e+00, 1.9527e+00, 2.1525e+00,
         1.9767e+00, 1.9526e+00, 3.8785e+05, 2.3272e+00, 3.8245e+05, 0.0000e+00,
         4.0163e+05, 3.8724e+05, 4.0538e+05, 3.9956e+05],
        [7.8402e+05, 7.5863e+05, 4.0165e+05, 4.0164e+05, 4.0166e+05, 4.0163e+05,
         4.0167e+05, 4.0164e+05, 8.0934e+05, 4.0166e+05, 7.9124e+05, 4.0163e+05,
         0.0000e+00, 7.9782e+05, 8.2124e+05, 8.0193e+05],
        [7.8072e+05, 7.9350e+05, 3.8725e+05, 3.8723e+05, 3.8724e+05, 3.8725e+05,
         3.8726e+05, 3.8723e+05, 7.5924e+05, 3.8723e+05, 7.7588e+05, 3.8724e+05,
         7.9782e+05, 0.0000e+00, 7.7990e+05, 7.6116e+05],
        [8.1270e+05, 8.0349e+05, 4.0538e+05, 4.0538e+05, 4.0536e+05, 4.0538e+05,
         4.0539e+05, 4.0536e+05, 7.8110e+05, 4.0538e+05, 7.8423e+05, 4.0538e+05,
         8.2124e+05, 7.7990e+05, 0.0000e+00, 7.9209e+05],
        [8.0402e+05, 7.8433e+05, 3.9954e+05, 3.9956e+05, 3.9953e+05, 3.9954e+05,
         3.9953e+05, 3.9954e+05, 7.6492e+05, 3.9955e+05, 7.6873e+05, 3.9956e+05,
         8.0193e+05, 7.6116e+05, 7.9209e+05, 0.0000e+00]])
Krum scores: ['400982.78', '379998.47', '1.95', '1.86', '1.86', '1.90', '1.86', '1.83', '387872.75', '2.08', '382466.59', '2.02', '401642.38', '387235.91', '405370.91', '399536.59']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 13, 6, 12, 4, 1, 10, 9, 18, 5, 17, 8, 15, 16, 19, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0088s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:39...
global Accuracy on shared test data: 77.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:39, End: 2025-07-22 16:01:39)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 14, 6, 7, 9, 3, 13, 12, 11, 2, 10, 1, 8, 5, 17, 4], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.8612e+05, 3.8975e+05, 3.8974e+05, 3.8972e+05, 3.8979e+05,
         7.7492e+05, 3.8975e+05, 3.8975e+05, 3.8977e+05, 3.8975e+05, 3.8974e+05,
         3.8979e+05, 3.8978e+05, 7.8868e+05, 3.8976e+05],
        [7.8612e+05, 0.0000e+00, 3.8720e+05, 3.8721e+05, 3.8718e+05, 3.8719e+05,
         7.6037e+05, 3.8717e+05, 3.8719e+05, 3.8720e+05, 3.8719e+05, 3.8720e+05,
         3.8719e+05, 3.8715e+05, 7.9422e+05, 3.8721e+05],
        [3.8975e+05, 3.8720e+05, 0.0000e+00, 1.8971e+00, 1.7484e+00, 1.9766e+00,
         3.7876e+05, 1.7427e+00, 1.8044e+00, 1.6973e+00, 1.8062e+00, 1.7798e+00,
         1.8229e+00, 1.9380e+00, 3.9733e+05, 1.6667e+00],
        [3.8974e+05, 3.8721e+05, 1.8971e+00, 0.0000e+00, 1.8592e+00, 1.8545e+00,
         3.7875e+05, 1.7618e+00, 1.8120e+00, 1.5921e+00, 1.7327e+00, 1.7839e+00,
         1.8606e+00, 1.8741e+00, 3.9738e+05, 1.7118e+00],
        [3.8972e+05, 3.8718e+05, 1.7484e+00, 1.8592e+00, 0.0000e+00, 1.6412e+00,
         3.7877e+05, 1.7103e+00, 1.6560e+00, 1.7823e+00, 1.6381e+00, 1.7786e+00,
         1.8482e+00, 1.7238e+00, 3.9735e+05, 1.8118e+00],
        [3.8979e+05, 3.8719e+05, 1.9766e+00, 1.8545e+00, 1.6412e+00, 0.0000e+00,
         3.7876e+05, 1.6535e+00, 1.8680e+00, 1.7488e+00, 1.6269e+00, 1.8752e+00,
         1.7711e+00, 1.7744e+00, 3.9737e+05, 1.7255e+00],
        [7.7492e+05, 7.6037e+05, 3.7876e+05, 3.7875e+05, 3.7877e+05, 3.7876e+05,
         0.0000e+00, 3.7878e+05, 3.7880e+05, 3.7876e+05, 3.7876e+05, 3.7878e+05,
         3.7878e+05, 3.7880e+05, 7.8516e+05, 3.7875e+05],
        [3.8975e+05, 3.8717e+05, 1.7427e+00, 1.7618e+00, 1.7103e+00, 1.6535e+00,
         3.7878e+05, 0.0000e+00, 1.7774e+00, 1.6741e+00, 1.5886e+00, 1.7919e+00,
         1.7245e+00, 1.8426e+00, 3.9735e+05, 1.5860e+00],
        [3.8975e+05, 3.8719e+05, 1.8044e+00, 1.8120e+00, 1.6560e+00, 1.8680e+00,
         3.7880e+05, 1.7774e+00, 0.0000e+00, 1.7219e+00, 1.6921e+00, 1.8498e+00,
         1.7891e+00, 1.7747e+00, 3.9736e+05, 1.6726e+00],
        [3.8977e+05, 3.8720e+05, 1.6973e+00, 1.5921e+00, 1.7823e+00, 1.7488e+00,
         3.7876e+05, 1.6741e+00, 1.7219e+00, 0.0000e+00, 1.5643e+00, 1.7453e+00,
         1.8231e+00, 1.8678e+00, 3.9738e+05, 1.7075e+00],
        [3.8975e+05, 3.8719e+05, 1.8062e+00, 1.7327e+00, 1.6381e+00, 1.6269e+00,
         3.7876e+05, 1.5886e+00, 1.6921e+00, 1.5643e+00, 0.0000e+00, 1.7252e+00,
         1.6817e+00, 1.8178e+00, 3.9737e+05, 1.7251e+00],
        [3.8974e+05, 3.8720e+05, 1.7798e+00, 1.7839e+00, 1.7786e+00, 1.8752e+00,
         3.7878e+05, 1.7919e+00, 1.8498e+00, 1.7453e+00, 1.7252e+00, 0.0000e+00,
         1.9176e+00, 1.8789e+00, 3.9740e+05, 1.8358e+00],
        [3.8979e+05, 3.8719e+05, 1.8229e+00, 1.8606e+00, 1.8482e+00, 1.7711e+00,
         3.7878e+05, 1.7245e+00, 1.7891e+00, 1.8231e+00, 1.6817e+00, 1.9176e+00,
         0.0000e+00, 1.9909e+00, 3.9736e+05, 1.7485e+00],
        [3.8978e+05, 3.8715e+05, 1.9380e+00, 1.8741e+00, 1.7238e+00, 1.7744e+00,
         3.7880e+05, 1.8426e+00, 1.7747e+00, 1.8678e+00, 1.8178e+00, 1.8789e+00,
         1.9909e+00, 0.0000e+00, 3.9735e+05, 1.7946e+00],
        [7.8868e+05, 7.9422e+05, 3.9733e+05, 3.9738e+05, 3.9735e+05, 3.9737e+05,
         7.8516e+05, 3.9735e+05, 3.9736e+05, 3.9738e+05, 3.9737e+05, 3.9740e+05,
         3.9736e+05, 3.9735e+05, 0.0000e+00, 3.9736e+05],
        [3.8976e+05, 3.8721e+05, 1.6667e+00, 1.7118e+00, 1.8118e+00, 1.7255e+00,
         3.7875e+05, 1.5860e+00, 1.6726e+00, 1.7075e+00, 1.7251e+00, 1.8358e+00,
         1.7485e+00, 1.7946e+00, 3.9736e+05, 0.0000e+00]])
Krum scores: ['389750.44', '387184.38', '1.79', '1.78', '1.73', '1.75', '378764.44', '1.70', '1.75', '1.71', '1.68', '1.80', '1.80', '1.83', '397359.50', '1.72']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 14, 6, 7, 9, 3, 13, 12, 11, 2, 10, 1, 8, 5, 17, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:40...
global Accuracy on shared test data: 77.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:40, End: 2025-07-22 16:01:40)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 7, 18, 17, 6, 10, 3, 1, 19, 4, 9, 8, 16, 14, 12, 13], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9331e+05, 7.8726e+05, 7.6348e+05, 3.9334e+05, 3.9335e+05,
         3.9336e+05, 3.9336e+05, 7.7335e+05, 3.9336e+05, 3.9337e+05, 3.9338e+05,
         7.9046e+05, 7.8148e+05, 3.9336e+05, 7.8527e+05],
        [3.9331e+05, 0.0000e+00, 3.9467e+05, 3.7929e+05, 1.8600e+00, 1.8600e+00,
         1.9109e+00, 1.7369e+00, 3.6910e+05, 1.6573e+00, 1.8797e+00, 1.8278e+00,
         3.9016e+05, 3.9792e+05, 1.7520e+00, 3.8086e+05],
        [7.8726e+05, 3.9467e+05, 0.0000e+00, 7.8321e+05, 3.9465e+05, 3.9468e+05,
         3.9466e+05, 3.9464e+05, 7.6291e+05, 3.9464e+05, 3.9463e+05, 3.9465e+05,
         7.7387e+05, 7.9531e+05, 3.9470e+05, 7.8442e+05],
        [7.6348e+05, 3.7929e+05, 7.8321e+05, 0.0000e+00, 3.7928e+05, 3.7926e+05,
         3.7929e+05, 3.7928e+05, 7.3260e+05, 3.7928e+05, 3.7932e+05, 3.7928e+05,
         7.5947e+05, 7.8386e+05, 3.7930e+05, 7.4868e+05],
        [3.9334e+05, 1.8600e+00, 3.9465e+05, 3.7928e+05, 0.0000e+00, 1.9282e+00,
         1.9369e+00, 1.6774e+00, 3.6909e+05, 1.6091e+00, 1.7269e+00, 1.7463e+00,
         3.9013e+05, 3.9792e+05, 1.7120e+00, 3.8090e+05],
        [3.9335e+05, 1.8600e+00, 3.9468e+05, 3.7926e+05, 1.9282e+00, 0.0000e+00,
         1.7216e+00, 1.7643e+00, 3.6908e+05, 1.9688e+00, 1.6308e+00, 1.8699e+00,
         3.9015e+05, 3.9791e+05, 1.7756e+00, 3.8090e+05],
        [3.9336e+05, 1.9109e+00, 3.9466e+05, 3.7929e+05, 1.9369e+00, 1.7216e+00,
         0.0000e+00, 1.8330e+00, 3.6910e+05, 1.7577e+00, 1.5916e+00, 1.8044e+00,
         3.9012e+05, 3.9790e+05, 1.6337e+00, 3.8092e+05],
        [3.9336e+05, 1.7369e+00, 3.9464e+05, 3.7928e+05, 1.6774e+00, 1.7643e+00,
         1.8330e+00, 0.0000e+00, 3.6911e+05, 1.7526e+00, 1.6819e+00, 1.8541e+00,
         3.9014e+05, 3.9789e+05, 1.7005e+00, 3.8090e+05],
        [7.7335e+05, 3.6910e+05, 7.6291e+05, 7.3260e+05, 3.6909e+05, 3.6908e+05,
         3.6910e+05, 3.6911e+05, 0.0000e+00, 3.6910e+05, 3.6910e+05, 3.6909e+05,
         7.4718e+05, 7.7924e+05, 3.6911e+05, 7.5162e+05],
        [3.9336e+05, 1.6573e+00, 3.9464e+05, 3.7928e+05, 1.6091e+00, 1.9688e+00,
         1.7577e+00, 1.7526e+00, 3.6910e+05, 0.0000e+00, 1.8329e+00, 1.6431e+00,
         3.9012e+05, 3.9790e+05, 1.6289e+00, 3.8089e+05],
        [3.9337e+05, 1.8797e+00, 3.9463e+05, 3.7932e+05, 1.7269e+00, 1.6308e+00,
         1.5916e+00, 1.6819e+00, 3.6910e+05, 1.8329e+00, 0.0000e+00, 1.7914e+00,
         3.9015e+05, 3.9791e+05, 1.6730e+00, 3.8088e+05],
        [3.9338e+05, 1.8278e+00, 3.9465e+05, 3.7928e+05, 1.7463e+00, 1.8699e+00,
         1.8044e+00, 1.8541e+00, 3.6909e+05, 1.6431e+00, 1.7914e+00, 0.0000e+00,
         3.9015e+05, 3.9789e+05, 1.7106e+00, 3.8090e+05],
        [7.9046e+05, 3.9016e+05, 7.7387e+05, 7.5947e+05, 3.9013e+05, 3.9015e+05,
         3.9012e+05, 3.9014e+05, 7.4718e+05, 3.9012e+05, 3.9015e+05, 3.9015e+05,
         0.0000e+00, 8.1332e+05, 3.9012e+05, 7.8320e+05],
        [7.8148e+05, 3.9792e+05, 7.9531e+05, 7.8386e+05, 3.9792e+05, 3.9791e+05,
         3.9790e+05, 3.9789e+05, 7.7924e+05, 3.9790e+05, 3.9791e+05, 3.9789e+05,
         8.1332e+05, 0.0000e+00, 3.9789e+05, 7.7817e+05],
        [3.9336e+05, 1.7520e+00, 3.9470e+05, 3.7930e+05, 1.7120e+00, 1.7756e+00,
         1.6337e+00, 1.7005e+00, 3.6911e+05, 1.6289e+00, 1.6730e+00, 1.7106e+00,
         3.9012e+05, 3.9789e+05, 0.0000e+00, 3.8089e+05],
        [7.8527e+05, 3.8086e+05, 7.8442e+05, 7.4868e+05, 3.8090e+05, 3.8090e+05,
         3.8092e+05, 3.8090e+05, 7.5162e+05, 3.8089e+05, 3.8088e+05, 3.8090e+05,
         7.8320e+05, 7.7817e+05, 3.8089e+05, 0.0000e+00]])
Krum scores: ['393346.94', '1.80', '394649.91', '379280.25', '1.75', '1.79', '1.75', '1.74', '369093.97', '1.70', '1.70', '1.77', '390133.91', '397898.16', '1.69', '380888.19']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [20, 7, 18, 17, 6, 10, 3, 1, 19, 4, 9, 8, 16, 14, 12, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0334s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:40...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 16:01:40, End: 2025-07-22 16:01:40)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 20, 18, 2, 7, 1, 12, 13, 3, 9, 15, 5, 19, 14, 10, 4], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.6053e+05, 7.5588e+05, 3.7824e+05, 3.7825e+05, 3.7822e+05,
         3.7825e+05, 7.6719e+05, 3.7822e+05, 3.7824e+05, 7.7249e+05, 3.7827e+05,
         7.8038e+05, 7.6965e+05, 3.7821e+05, 3.7821e+05],
        [7.6053e+05, 0.0000e+00, 7.8722e+05, 3.9700e+05, 3.9701e+05, 3.9699e+05,
         3.9698e+05, 7.9708e+05, 3.9700e+05, 3.9701e+05, 7.9924e+05, 3.9699e+05,
         8.0306e+05, 7.9364e+05, 3.9698e+05, 3.9698e+05],
        [7.5588e+05, 7.8722e+05, 0.0000e+00, 3.9415e+05, 3.9414e+05, 3.9412e+05,
         3.9413e+05, 8.1692e+05, 3.9411e+05, 3.9413e+05, 7.8987e+05, 3.9415e+05,
         7.8178e+05, 8.0343e+05, 3.9416e+05, 3.9413e+05],
        [3.7824e+05, 3.9700e+05, 3.9415e+05, 0.0000e+00, 1.5094e+00, 1.6001e+00,
         1.7167e+00, 4.0539e+05, 1.7242e+00, 1.6396e+00, 3.8102e+05, 1.8409e+00,
         3.9715e+05, 3.9743e+05, 1.6053e+00, 1.6785e+00],
        [3.7825e+05, 3.9701e+05, 3.9414e+05, 1.5094e+00, 0.0000e+00, 1.6608e+00,
         1.7206e+00, 4.0540e+05, 1.8410e+00, 1.7937e+00, 3.8103e+05, 1.8086e+00,
         3.9711e+05, 3.9744e+05, 1.7751e+00, 1.6530e+00],
        [3.7822e+05, 3.9699e+05, 3.9412e+05, 1.6001e+00, 1.6608e+00, 0.0000e+00,
         1.7151e+00, 4.0541e+05, 1.8250e+00, 1.6379e+00, 3.8104e+05, 1.7258e+00,
         3.9714e+05, 3.9745e+05, 1.7105e+00, 1.7356e+00],
        [3.7825e+05, 3.9698e+05, 3.9413e+05, 1.7167e+00, 1.7206e+00, 1.7151e+00,
         0.0000e+00, 4.0542e+05, 1.6271e+00, 1.5860e+00, 3.8102e+05, 1.5818e+00,
         3.9714e+05, 3.9742e+05, 1.5660e+00, 1.8048e+00],
        [7.6719e+05, 7.9708e+05, 8.1692e+05, 4.0539e+05, 4.0540e+05, 4.0541e+05,
         4.0542e+05, 0.0000e+00, 4.0542e+05, 4.0540e+05, 7.9016e+05, 4.0544e+05,
         8.1162e+05, 8.1261e+05, 4.0540e+05, 4.0545e+05],
        [3.7822e+05, 3.9700e+05, 3.9411e+05, 1.7242e+00, 1.8410e+00, 1.8250e+00,
         1.6271e+00, 4.0542e+05, 0.0000e+00, 1.5986e+00, 3.8102e+05, 1.7608e+00,
         3.9715e+05, 3.9740e+05, 1.6610e+00, 1.7934e+00],
        [3.7824e+05, 3.9701e+05, 3.9413e+05, 1.6396e+00, 1.7937e+00, 1.6379e+00,
         1.5860e+00, 4.0540e+05, 1.5986e+00, 0.0000e+00, 3.8102e+05, 1.7360e+00,
         3.9718e+05, 3.9741e+05, 1.5595e+00, 1.8135e+00],
        [7.7249e+05, 7.9924e+05, 7.8987e+05, 3.8102e+05, 3.8103e+05, 3.8104e+05,
         3.8102e+05, 7.9016e+05, 3.8102e+05, 3.8102e+05, 0.0000e+00, 3.8101e+05,
         7.8514e+05, 7.7958e+05, 3.8102e+05, 3.8099e+05],
        [3.7827e+05, 3.9699e+05, 3.9415e+05, 1.8409e+00, 1.8086e+00, 1.7258e+00,
         1.5818e+00, 4.0544e+05, 1.7608e+00, 1.7360e+00, 3.8101e+05, 0.0000e+00,
         3.9713e+05, 3.9740e+05, 1.7172e+00, 1.8482e+00],
        [7.8038e+05, 8.0306e+05, 7.8178e+05, 3.9715e+05, 3.9711e+05, 3.9714e+05,
         3.9714e+05, 8.1162e+05, 3.9715e+05, 3.9718e+05, 7.8514e+05, 3.9713e+05,
         0.0000e+00, 7.7359e+05, 3.9718e+05, 3.9716e+05],
        [7.6965e+05, 7.9364e+05, 8.0343e+05, 3.9743e+05, 3.9744e+05, 3.9745e+05,
         3.9742e+05, 8.1261e+05, 3.9740e+05, 3.9741e+05, 7.7958e+05, 3.9740e+05,
         7.7359e+05, 0.0000e+00, 3.9745e+05, 3.9741e+05],
        [3.7821e+05, 3.9698e+05, 3.9416e+05, 1.6053e+00, 1.7751e+00, 1.7105e+00,
         1.5660e+00, 4.0540e+05, 1.6610e+00, 1.5595e+00, 3.8102e+05, 1.7172e+00,
         3.9718e+05, 3.9745e+05, 0.0000e+00, 1.8523e+00],
        [3.7821e+05, 3.9698e+05, 3.9413e+05, 1.6785e+00, 1.6530e+00, 1.7356e+00,
         1.8048e+00, 4.0545e+05, 1.7934e+00, 1.8135e+00, 3.8099e+05, 1.8482e+00,
         3.9716e+05, 3.9741e+05, 1.8523e+00, 0.0000e+00]])
Krum scores: ['378227.03', '396990.41', '394129.47', '1.64', '1.70', '1.68', '1.64', '405407.09', '1.71', '1.65', '381013.91', '1.74', '397140.72', '397417.41', '1.66', '1.76']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 20, 18, 2, 7, 1, 12, 13, 3, 9, 15, 5, 19, 14, 10, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0161s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:41...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:41, End: 2025-07-22 16:01:41)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 4, 9, 16, 15, 5, 20, 19, 12, 2, 7, 18, 11, 10, 6, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.7957e+00, 1.8019e+00, 3.8143e+05, 3.8083e+05, 2.0393e+00,
         3.8810e+05, 3.8206e+05, 1.8266e+00, 1.9371e+00, 1.9253e+00, 3.7224e+05,
         1.8055e+00, 1.8857e+00, 1.8700e+00, 3.9224e+05],
        [1.7957e+00, 0.0000e+00, 1.8618e+00, 3.8146e+05, 3.8084e+05, 1.9036e+00,
         3.8806e+05, 3.8207e+05, 1.7825e+00, 1.7930e+00, 1.7882e+00, 3.7222e+05,
         1.7471e+00, 2.0240e+00, 1.8094e+00, 3.9220e+05],
        [1.8019e+00, 1.8618e+00, 0.0000e+00, 3.8143e+05, 3.8087e+05, 1.7913e+00,
         3.8806e+05, 3.8206e+05, 1.5607e+00, 1.6524e+00, 1.8732e+00, 3.7225e+05,
         1.6205e+00, 1.6017e+00, 1.8106e+00, 3.9224e+05],
        [3.8143e+05, 3.8146e+05, 3.8143e+05, 0.0000e+00, 7.7570e+05, 3.8145e+05,
         7.9069e+05, 7.4978e+05, 3.8144e+05, 3.8140e+05, 3.8146e+05, 7.5917e+05,
         3.8145e+05, 3.8143e+05, 3.8143e+05, 7.7093e+05],
        [3.8083e+05, 3.8084e+05, 3.8087e+05, 7.7570e+05, 0.0000e+00, 3.8087e+05,
         7.7991e+05, 7.3290e+05, 3.8084e+05, 3.8086e+05, 3.8083e+05, 7.4192e+05,
         3.8086e+05, 3.8087e+05, 3.8081e+05, 7.6047e+05],
        [2.0393e+00, 1.9036e+00, 1.7913e+00, 3.8145e+05, 3.8087e+05, 0.0000e+00,
         3.8803e+05, 3.8209e+05, 1.6552e+00, 1.7938e+00, 1.8787e+00, 3.7226e+05,
         1.7969e+00, 1.8190e+00, 2.1183e+00, 3.9224e+05],
        [3.8810e+05, 3.8806e+05, 3.8806e+05, 7.9069e+05, 7.7991e+05, 3.8803e+05,
         0.0000e+00, 7.5401e+05, 3.8808e+05, 3.8807e+05, 3.8808e+05, 7.7223e+05,
         3.8807e+05, 3.8808e+05, 3.8804e+05, 7.7927e+05],
        [3.8206e+05, 3.8207e+05, 3.8206e+05, 7.4978e+05, 7.3290e+05, 3.8209e+05,
         7.5401e+05, 0.0000e+00, 3.8208e+05, 3.8209e+05, 3.8207e+05, 7.4770e+05,
         3.8208e+05, 3.8204e+05, 3.8212e+05, 7.5766e+05],
        [1.8266e+00, 1.7825e+00, 1.5607e+00, 3.8144e+05, 3.8084e+05, 1.6552e+00,
         3.8808e+05, 3.8208e+05, 0.0000e+00, 1.6574e+00, 1.7894e+00, 3.7224e+05,
         1.7528e+00, 1.6199e+00, 1.8660e+00, 3.9223e+05],
        [1.9371e+00, 1.7930e+00, 1.6524e+00, 3.8140e+05, 3.8086e+05, 1.7938e+00,
         3.8807e+05, 3.8209e+05, 1.6574e+00, 0.0000e+00, 1.6668e+00, 3.7224e+05,
         1.8214e+00, 1.6622e+00, 1.7986e+00, 3.9224e+05],
        [1.9253e+00, 1.7882e+00, 1.8732e+00, 3.8146e+05, 3.8083e+05, 1.8787e+00,
         3.8808e+05, 3.8207e+05, 1.7894e+00, 1.6668e+00, 0.0000e+00, 3.7225e+05,
         1.8549e+00, 1.8574e+00, 1.9217e+00, 3.9224e+05],
        [3.7224e+05, 3.7222e+05, 3.7225e+05, 7.5917e+05, 7.4192e+05, 3.7226e+05,
         7.7223e+05, 7.4770e+05, 3.7224e+05, 3.7224e+05, 3.7225e+05, 0.0000e+00,
         3.7227e+05, 3.7224e+05, 3.7224e+05, 7.8964e+05],
        [1.8055e+00, 1.7471e+00, 1.6205e+00, 3.8145e+05, 3.8086e+05, 1.7969e+00,
         3.8807e+05, 3.8208e+05, 1.7528e+00, 1.8214e+00, 1.8549e+00, 3.7227e+05,
         0.0000e+00, 1.8311e+00, 1.8166e+00, 3.9224e+05],
        [1.8857e+00, 2.0240e+00, 1.6017e+00, 3.8143e+05, 3.8087e+05, 1.8190e+00,
         3.8808e+05, 3.8204e+05, 1.6199e+00, 1.6622e+00, 1.8574e+00, 3.7224e+05,
         1.8311e+00, 0.0000e+00, 2.0033e+00, 3.9224e+05],
        [1.8700e+00, 1.8094e+00, 1.8106e+00, 3.8143e+05, 3.8081e+05, 2.1183e+00,
         3.8804e+05, 3.8212e+05, 1.8660e+00, 1.7986e+00, 1.9217e+00, 3.7224e+05,
         1.8166e+00, 2.0033e+00, 0.0000e+00, 3.9224e+05],
        [3.9224e+05, 3.9220e+05, 3.9224e+05, 7.7093e+05, 7.6047e+05, 3.9224e+05,
         7.7927e+05, 7.5766e+05, 3.9223e+05, 3.9224e+05, 3.9224e+05, 7.8964e+05,
         3.9224e+05, 3.9224e+05, 3.9224e+05, 0.0000e+00]])
Krum scores: ['1.86', '1.81', '1.71', '381434.12', '380842.31', '1.83', '388060.31', '382069.59', '1.71', '1.73', '1.83', '372239.66', '1.77', '1.79', '1.86', '392232.06']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 4, 9, 16, 15, 5, 20, 19, 12, 2, 7, 18, 11, 10, 6, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:41...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:41, End: 2025-07-22 16:01:42)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 16, 8, 12, 2, 9, 11, 1, 10, 13, 14, 18, 20, 17, 15, 5], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8002e+05, 1.6026e+00, 1.7432e+00, 1.3743e+00, 1.5351e+00,
         1.4920e+00, 1.4965e+00, 1.5192e+00, 4.0044e+05, 3.8878e+05, 3.9250e+05,
         3.7750e+05, 3.8886e+05, 3.9117e+05, 1.5912e+00],
        [3.8002e+05, 0.0000e+00, 3.8005e+05, 3.8003e+05, 3.8002e+05, 3.8003e+05,
         3.8003e+05, 3.8002e+05, 3.7999e+05, 7.8824e+05, 7.4990e+05, 7.8154e+05,
         7.5994e+05, 7.8898e+05, 7.8616e+05, 3.8004e+05],
        [1.6026e+00, 3.8005e+05, 0.0000e+00, 1.7416e+00, 1.6290e+00, 1.5573e+00,
         1.5432e+00, 1.7405e+00, 1.6099e+00, 4.0043e+05, 3.8878e+05, 3.9248e+05,
         3.7747e+05, 3.8885e+05, 3.9116e+05, 1.7409e+00],
        [1.7432e+00, 3.8003e+05, 1.7416e+00, 0.0000e+00, 1.5465e+00, 1.4764e+00,
         1.7247e+00, 1.6882e+00, 1.4784e+00, 4.0041e+05, 3.8871e+05, 3.9250e+05,
         3.7747e+05, 3.8887e+05, 3.9113e+05, 1.4873e+00],
        [1.3743e+00, 3.8002e+05, 1.6290e+00, 1.5465e+00, 0.0000e+00, 1.3678e+00,
         1.5349e+00, 1.5005e+00, 1.3966e+00, 4.0043e+05, 3.8878e+05, 3.9247e+05,
         3.7748e+05, 3.8885e+05, 3.9117e+05, 1.5877e+00],
        [1.5351e+00, 3.8003e+05, 1.5573e+00, 1.4764e+00, 1.3678e+00, 0.0000e+00,
         1.3718e+00, 1.4932e+00, 1.3654e+00, 4.0041e+05, 3.8877e+05, 3.9248e+05,
         3.7748e+05, 3.8887e+05, 3.9117e+05, 1.5164e+00],
        [1.4920e+00, 3.8003e+05, 1.5432e+00, 1.7247e+00, 1.5349e+00, 1.3718e+00,
         0.0000e+00, 1.5100e+00, 1.4878e+00, 4.0043e+05, 3.8877e+05, 3.9252e+05,
         3.7746e+05, 3.8884e+05, 3.9119e+05, 1.4956e+00],
        [1.4965e+00, 3.8002e+05, 1.7405e+00, 1.6882e+00, 1.5005e+00, 1.4932e+00,
         1.5100e+00, 0.0000e+00, 1.5390e+00, 4.0045e+05, 3.8877e+05, 3.9252e+05,
         3.7747e+05, 3.8887e+05, 3.9117e+05, 1.5678e+00],
        [1.5192e+00, 3.7999e+05, 1.6099e+00, 1.4784e+00, 1.3966e+00, 1.3654e+00,
         1.4878e+00, 1.5390e+00, 0.0000e+00, 4.0041e+05, 3.8877e+05, 3.9251e+05,
         3.7747e+05, 3.8884e+05, 3.9117e+05, 1.5670e+00],
        [4.0044e+05, 7.8824e+05, 4.0043e+05, 4.0041e+05, 4.0043e+05, 4.0041e+05,
         4.0043e+05, 4.0045e+05, 4.0041e+05, 0.0000e+00, 7.8501e+05, 7.6042e+05,
         7.8508e+05, 7.7590e+05, 7.9529e+05, 4.0043e+05],
        [3.8878e+05, 7.4990e+05, 3.8878e+05, 3.8871e+05, 3.8878e+05, 3.8877e+05,
         3.8877e+05, 3.8877e+05, 3.8877e+05, 7.8501e+05, 0.0000e+00, 7.8775e+05,
         7.7744e+05, 7.8906e+05, 7.4982e+05, 3.8874e+05],
        [3.9250e+05, 7.8154e+05, 3.9248e+05, 3.9250e+05, 3.9247e+05, 3.9248e+05,
         3.9252e+05, 3.9252e+05, 3.9251e+05, 7.6042e+05, 7.8775e+05, 0.0000e+00,
         7.7659e+05, 7.8294e+05, 7.5387e+05, 3.9252e+05],
        [3.7750e+05, 7.5994e+05, 3.7747e+05, 3.7747e+05, 3.7748e+05, 3.7748e+05,
         3.7746e+05, 3.7747e+05, 3.7747e+05, 7.8508e+05, 7.7744e+05, 7.7659e+05,
         0.0000e+00, 7.5852e+05, 7.5793e+05, 3.7747e+05],
        [3.8886e+05, 7.8898e+05, 3.8885e+05, 3.8887e+05, 3.8885e+05, 3.8887e+05,
         3.8884e+05, 3.8887e+05, 3.8884e+05, 7.7590e+05, 7.8906e+05, 7.8294e+05,
         7.5852e+05, 0.0000e+00, 7.7464e+05, 3.8888e+05],
        [3.9117e+05, 7.8616e+05, 3.9116e+05, 3.9113e+05, 3.9117e+05, 3.9117e+05,
         3.9119e+05, 3.9117e+05, 3.9117e+05, 7.9529e+05, 7.4982e+05, 7.5387e+05,
         7.5793e+05, 7.7464e+05, 0.0000e+00, 3.9117e+05],
        [1.5912e+00, 3.8004e+05, 1.7409e+00, 1.4873e+00, 1.5877e+00, 1.5164e+00,
         1.4956e+00, 1.5678e+00, 1.5670e+00, 4.0043e+05, 3.8874e+05, 3.9252e+05,
         3.7747e+05, 3.8888e+05, 3.9117e+05, 0.0000e+00]])
Krum scores: ['1.52', '380019.72', '1.63', '1.59', '1.47', '1.45', '1.49', '1.54', '1.48', '400420.06', '388758.81', '392495.53', '377469.41', '388853.78', '391161.03', '1.54']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 16, 8, 12, 2, 9, 11, 1, 10, 13, 14, 18, 20, 17, 15, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0117s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:42...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:42, End: 2025-07-22 16:01:42)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 3, 13, 9, 7, 18, 2, 10, 5, 1, 15, 20, 17, 12, 4, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5368e+00, 4.0301e+05, 1.7054e+00, 1.5223e+00, 3.8534e+05,
         1.4553e+00, 1.4853e+00, 1.6225e+00, 1.6097e+00, 3.9106e+05, 3.8926e+05,
         3.9788e+05, 1.5194e+00, 1.4315e+00, 3.9502e+05],
        [1.5368e+00, 0.0000e+00, 4.0302e+05, 1.6406e+00, 1.6001e+00, 3.8532e+05,
         1.4423e+00, 1.4609e+00, 1.5325e+00, 1.6120e+00, 3.9106e+05, 3.8931e+05,
         3.9787e+05, 1.4889e+00, 1.4883e+00, 3.9501e+05],
        [4.0301e+05, 4.0302e+05, 0.0000e+00, 4.0303e+05, 4.0304e+05, 7.7669e+05,
         4.0303e+05, 4.0307e+05, 4.0301e+05, 4.0304e+05, 8.0352e+05, 7.6895e+05,
         7.8429e+05, 4.0300e+05, 4.0305e+05, 7.9624e+05],
        [1.7054e+00, 1.6406e+00, 4.0303e+05, 0.0000e+00, 1.8270e+00, 3.8532e+05,
         1.4801e+00, 1.4359e+00, 1.5400e+00, 1.7176e+00, 3.9105e+05, 3.8931e+05,
         3.9786e+05, 1.2943e+00, 1.8342e+00, 3.9503e+05],
        [1.5223e+00, 1.6001e+00, 4.0304e+05, 1.8270e+00, 0.0000e+00, 3.8533e+05,
         1.3315e+00, 1.5189e+00, 1.5359e+00, 1.4609e+00, 3.9105e+05, 3.8930e+05,
         3.9784e+05, 1.5716e+00, 1.4883e+00, 3.9499e+05],
        [3.8534e+05, 3.8532e+05, 7.7669e+05, 3.8532e+05, 3.8533e+05, 0.0000e+00,
         3.8532e+05, 3.8534e+05, 3.8530e+05, 3.8533e+05, 7.5649e+05, 7.6885e+05,
         7.8733e+05, 3.8533e+05, 3.8532e+05, 8.0452e+05],
        [1.4553e+00, 1.4423e+00, 4.0303e+05, 1.4801e+00, 1.3315e+00, 3.8532e+05,
         0.0000e+00, 1.2971e+00, 1.3970e+00, 1.4202e+00, 3.9107e+05, 3.8929e+05,
         3.9789e+05, 1.3172e+00, 1.4301e+00, 3.9501e+05],
        [1.4853e+00, 1.4609e+00, 4.0307e+05, 1.4359e+00, 1.5189e+00, 3.8534e+05,
         1.2971e+00, 0.0000e+00, 1.4543e+00, 1.4821e+00, 3.9107e+05, 3.8927e+05,
         3.9787e+05, 1.3148e+00, 1.6169e+00, 3.9504e+05],
        [1.6225e+00, 1.5325e+00, 4.0301e+05, 1.5400e+00, 1.5359e+00, 3.8530e+05,
         1.3970e+00, 1.4543e+00, 0.0000e+00, 1.5382e+00, 3.9105e+05, 3.8930e+05,
         3.9789e+05, 1.3668e+00, 1.4843e+00, 3.9504e+05],
        [1.6097e+00, 1.6120e+00, 4.0304e+05, 1.7176e+00, 1.4609e+00, 3.8533e+05,
         1.4202e+00, 1.4821e+00, 1.5382e+00, 0.0000e+00, 3.9106e+05, 3.8932e+05,
         3.9786e+05, 1.5199e+00, 1.5192e+00, 3.9503e+05],
        [3.9106e+05, 3.9106e+05, 8.0352e+05, 3.9105e+05, 3.9105e+05, 7.5649e+05,
         3.9107e+05, 3.9107e+05, 3.9105e+05, 3.9106e+05, 0.0000e+00, 7.7061e+05,
         7.7592e+05, 3.9107e+05, 3.9109e+05, 7.7519e+05],
        [3.8926e+05, 3.8931e+05, 7.6895e+05, 3.8931e+05, 3.8930e+05, 7.6885e+05,
         3.8929e+05, 3.8927e+05, 3.8930e+05, 3.8932e+05, 7.7061e+05, 0.0000e+00,
         7.9269e+05, 3.8930e+05, 3.8927e+05, 7.7448e+05],
        [3.9788e+05, 3.9787e+05, 7.8429e+05, 3.9786e+05, 3.9784e+05, 7.8733e+05,
         3.9789e+05, 3.9787e+05, 3.9789e+05, 3.9786e+05, 7.7592e+05, 7.9269e+05,
         0.0000e+00, 3.9785e+05, 3.9789e+05, 7.9275e+05],
        [1.5194e+00, 1.4889e+00, 4.0300e+05, 1.2943e+00, 1.5716e+00, 3.8533e+05,
         1.3172e+00, 1.3148e+00, 1.3668e+00, 1.5199e+00, 3.9107e+05, 3.8930e+05,
         3.9785e+05, 0.0000e+00, 1.6034e+00, 3.9503e+05],
        [1.4315e+00, 1.4883e+00, 4.0305e+05, 1.8342e+00, 1.4883e+00, 3.8532e+05,
         1.4301e+00, 1.6169e+00, 1.4843e+00, 1.5192e+00, 3.9109e+05, 3.8927e+05,
         3.9789e+05, 1.6034e+00, 0.0000e+00, 3.9502e+05],
        [3.9502e+05, 3.9501e+05, 7.9624e+05, 3.9503e+05, 3.9499e+05, 8.0452e+05,
         3.9501e+05, 3.9504e+05, 3.9504e+05, 3.9503e+05, 7.7519e+05, 7.7448e+05,
         7.9275e+05, 3.9503e+05, 3.9502e+05, 0.0000e+00]])
Krum scores: ['1.52', '1.52', '403024.09', '1.58', '1.50', '385322.00', '1.39', '1.43', '1.48', '1.52', '391058.00', '389288.25', '397864.53', '1.42', '1.51', '395019.94']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 3, 13, 9, 7, 18, 2, 10, 5, 1, 15, 20, 17, 12, 4, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:43...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:43, End: 2025-07-22 16:01:43)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 17, 11, 13, 19, 10, 7, 5, 16, 15, 20, 6, 1, 4, 8, 18], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 8.0588e+05, 3.9835e+05, 7.8684e+05, 7.8647e+05, 3.9836e+05,
         3.9832e+05, 3.9834e+05, 8.1169e+05, 7.7944e+05, 8.0419e+05, 3.9834e+05,
         3.9834e+05, 3.9835e+05, 3.9835e+05, 8.0586e+05],
        [8.0588e+05, 0.0000e+00, 3.9590e+05, 8.0023e+05, 8.2396e+05, 3.9588e+05,
         3.9591e+05, 3.9589e+05, 7.9647e+05, 7.5211e+05, 7.9595e+05, 3.9594e+05,
         3.9590e+05, 3.9594e+05, 3.9590e+05, 7.8734e+05],
        [3.9835e+05, 3.9590e+05, 0.0000e+00, 3.8813e+05, 4.0698e+05, 1.4798e+00,
         1.5152e+00, 1.4970e+00, 4.0162e+05, 3.7351e+05, 4.0017e+05, 1.4567e+00,
         1.4910e+00, 1.4627e+00, 1.4837e+00, 3.9354e+05],
        [7.8684e+05, 8.0023e+05, 3.8813e+05, 0.0000e+00, 7.9251e+05, 3.8811e+05,
         3.8814e+05, 3.8813e+05, 8.1959e+05, 7.7292e+05, 8.0077e+05, 3.8812e+05,
         3.8813e+05, 3.8811e+05, 3.8813e+05, 7.7242e+05],
        [7.8647e+05, 8.2396e+05, 4.0698e+05, 7.9251e+05, 0.0000e+00, 4.0695e+05,
         4.0698e+05, 4.0698e+05, 8.0422e+05, 7.6177e+05, 8.0568e+05, 4.0698e+05,
         4.0696e+05, 4.0697e+05, 4.0699e+05, 8.0894e+05],
        [3.9836e+05, 3.9588e+05, 1.4798e+00, 3.8811e+05, 4.0695e+05, 0.0000e+00,
         1.5176e+00, 1.5586e+00, 4.0160e+05, 3.7352e+05, 4.0018e+05, 1.6571e+00,
         1.5618e+00, 1.6943e+00, 1.5353e+00, 3.9359e+05],
        [3.9832e+05, 3.9591e+05, 1.5152e+00, 3.8814e+05, 4.0698e+05, 1.5176e+00,
         0.0000e+00, 1.6522e+00, 4.0158e+05, 3.7353e+05, 4.0018e+05, 1.5993e+00,
         1.5074e+00, 1.5445e+00, 1.5697e+00, 3.9354e+05],
        [3.9834e+05, 3.9589e+05, 1.4970e+00, 3.8813e+05, 4.0698e+05, 1.5586e+00,
         1.6522e+00, 0.0000e+00, 4.0162e+05, 3.7350e+05, 4.0017e+05, 1.8091e+00,
         1.6166e+00, 1.6235e+00, 1.7293e+00, 3.9360e+05],
        [8.1169e+05, 7.9647e+05, 4.0162e+05, 8.1959e+05, 8.0422e+05, 4.0160e+05,
         4.0158e+05, 4.0162e+05, 0.0000e+00, 7.9563e+05, 8.0000e+05, 4.0161e+05,
         4.0162e+05, 4.0160e+05, 4.0157e+05, 7.7732e+05],
        [7.7944e+05, 7.5211e+05, 3.7351e+05, 7.7292e+05, 7.6177e+05, 3.7352e+05,
         3.7353e+05, 3.7350e+05, 7.9563e+05, 0.0000e+00, 7.6964e+05, 3.7352e+05,
         3.7352e+05, 3.7352e+05, 3.7352e+05, 7.4013e+05],
        [8.0419e+05, 7.9595e+05, 4.0017e+05, 8.0077e+05, 8.0568e+05, 4.0018e+05,
         4.0018e+05, 4.0017e+05, 8.0000e+05, 7.6964e+05, 0.0000e+00, 4.0017e+05,
         4.0017e+05, 4.0018e+05, 4.0018e+05, 7.7824e+05],
        [3.9834e+05, 3.9594e+05, 1.4567e+00, 3.8812e+05, 4.0698e+05, 1.6571e+00,
         1.5993e+00, 1.8091e+00, 4.0161e+05, 3.7352e+05, 4.0017e+05, 0.0000e+00,
         1.5613e+00, 1.5159e+00, 1.5142e+00, 3.9353e+05],
        [3.9834e+05, 3.9590e+05, 1.4910e+00, 3.8813e+05, 4.0696e+05, 1.5618e+00,
         1.5074e+00, 1.6166e+00, 4.0162e+05, 3.7352e+05, 4.0017e+05, 1.5613e+00,
         0.0000e+00, 1.5629e+00, 1.6643e+00, 3.9359e+05],
        [3.9835e+05, 3.9594e+05, 1.4627e+00, 3.8811e+05, 4.0697e+05, 1.6943e+00,
         1.5445e+00, 1.6235e+00, 4.0160e+05, 3.7352e+05, 4.0018e+05, 1.5159e+00,
         1.5629e+00, 0.0000e+00, 1.5245e+00, 3.9357e+05],
        [3.9835e+05, 3.9590e+05, 1.4837e+00, 3.8813e+05, 4.0699e+05, 1.5353e+00,
         1.5697e+00, 1.7293e+00, 4.0157e+05, 3.7352e+05, 4.0018e+05, 1.5142e+00,
         1.6643e+00, 1.5245e+00, 0.0000e+00, 3.9356e+05],
        [8.0586e+05, 7.8734e+05, 3.9354e+05, 7.7242e+05, 8.0894e+05, 3.9359e+05,
         3.9354e+05, 3.9360e+05, 7.7732e+05, 7.4013e+05, 7.7824e+05, 3.9353e+05,
         3.9359e+05, 3.9357e+05, 3.9356e+05, 0.0000e+00]])
Krum scores: ['398339.72', '395896.50', '1.48', '388121.78', '406969.66', '1.55', '1.54', '1.61', '401595.34', '373514.72', '400171.53', '1.55', '1.55', '1.54', '1.55', '393555.38']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 17, 11, 13, 19, 10, 7, 5, 16, 15, 20, 6, 1, 4, 8, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:43...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:43, End: 2025-07-22 16:01:43)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 8, 6, 16, 11, 20, 18, 19, 4, 10, 9, 14, 3, 2, 7, 5], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6908e+00, 1.5314e+00, 3.9101e+05, 1.6266e+00, 3.8082e+05,
         3.9094e+05, 4.0074e+05, 1.5774e+00, 1.5312e+00, 1.6824e+00, 3.9797e+05,
         1.6343e+00, 1.6004e+00, 1.5966e+00, 1.6338e+00],
        [1.6908e+00, 0.0000e+00, 1.5398e+00, 3.9100e+05, 1.7289e+00, 3.8082e+05,
         3.9093e+05, 4.0073e+05, 1.5311e+00, 1.5437e+00, 1.6756e+00, 3.9797e+05,
         1.5797e+00, 1.6107e+00, 1.6482e+00, 1.7536e+00],
        [1.5314e+00, 1.5398e+00, 0.0000e+00, 3.9102e+05, 1.6581e+00, 3.8083e+05,
         3.9094e+05, 4.0074e+05, 1.5167e+00, 1.5574e+00, 1.7207e+00, 3.9797e+05,
         1.6833e+00, 1.5658e+00, 1.7005e+00, 1.7835e+00],
        [3.9101e+05, 3.9100e+05, 3.9102e+05, 0.0000e+00, 3.9101e+05, 7.6915e+05,
         7.8508e+05, 8.0382e+05, 3.9104e+05, 3.9102e+05, 3.9100e+05, 7.6891e+05,
         3.9100e+05, 3.9102e+05, 3.9104e+05, 3.9100e+05],
        [1.6266e+00, 1.7289e+00, 1.6581e+00, 3.9101e+05, 0.0000e+00, 3.8079e+05,
         3.9097e+05, 4.0073e+05, 1.6957e+00, 1.5240e+00, 1.3785e+00, 3.9801e+05,
         1.7994e+00, 1.5001e+00, 1.7866e+00, 1.4973e+00],
        [3.8082e+05, 3.8082e+05, 3.8083e+05, 7.6915e+05, 3.8079e+05, 0.0000e+00,
         7.6445e+05, 7.9413e+05, 3.8082e+05, 3.8083e+05, 3.8081e+05, 7.8200e+05,
         3.8081e+05, 3.8082e+05, 3.8082e+05, 3.8079e+05],
        [3.9094e+05, 3.9093e+05, 3.9094e+05, 7.8508e+05, 3.9097e+05, 7.6445e+05,
         0.0000e+00, 8.0729e+05, 3.9093e+05, 3.9098e+05, 3.9095e+05, 7.8306e+05,
         3.9096e+05, 3.9096e+05, 3.9097e+05, 3.9093e+05],
        [4.0074e+05, 4.0073e+05, 4.0074e+05, 8.0382e+05, 4.0073e+05, 7.9413e+05,
         8.0729e+05, 0.0000e+00, 4.0070e+05, 4.0075e+05, 4.0072e+05, 7.7671e+05,
         4.0075e+05, 4.0070e+05, 4.0075e+05, 4.0073e+05],
        [1.5774e+00, 1.5311e+00, 1.5167e+00, 3.9104e+05, 1.6957e+00, 3.8082e+05,
         3.9093e+05, 4.0070e+05, 0.0000e+00, 1.6668e+00, 1.7411e+00, 3.9802e+05,
         1.5433e+00, 1.6384e+00, 1.6299e+00, 1.6745e+00],
        [1.5312e+00, 1.5437e+00, 1.5574e+00, 3.9102e+05, 1.5240e+00, 3.8083e+05,
         3.9098e+05, 4.0075e+05, 1.6668e+00, 0.0000e+00, 1.3996e+00, 3.9800e+05,
         1.4880e+00, 1.3483e+00, 1.5699e+00, 1.5107e+00],
        [1.6824e+00, 1.6756e+00, 1.7207e+00, 3.9100e+05, 1.3785e+00, 3.8081e+05,
         3.9095e+05, 4.0072e+05, 1.7411e+00, 1.3996e+00, 0.0000e+00, 3.9794e+05,
         1.5298e+00, 1.2921e+00, 1.8183e+00, 1.5216e+00],
        [3.9797e+05, 3.9797e+05, 3.9797e+05, 7.6891e+05, 3.9801e+05, 7.8200e+05,
         7.8306e+05, 7.7671e+05, 3.9802e+05, 3.9800e+05, 3.9794e+05, 0.0000e+00,
         3.9796e+05, 3.9798e+05, 3.9801e+05, 3.9798e+05],
        [1.6343e+00, 1.5797e+00, 1.6833e+00, 3.9100e+05, 1.7994e+00, 3.8081e+05,
         3.9096e+05, 4.0075e+05, 1.5433e+00, 1.4880e+00, 1.5298e+00, 3.9796e+05,
         0.0000e+00, 1.5235e+00, 1.6283e+00, 1.6436e+00],
        [1.6004e+00, 1.6107e+00, 1.5658e+00, 3.9102e+05, 1.5001e+00, 3.8082e+05,
         3.9096e+05, 4.0070e+05, 1.6384e+00, 1.3483e+00, 1.2921e+00, 3.9798e+05,
         1.5235e+00, 0.0000e+00, 1.5619e+00, 1.4948e+00],
        [1.5966e+00, 1.6482e+00, 1.7005e+00, 3.9104e+05, 1.7866e+00, 3.8082e+05,
         3.9097e+05, 4.0075e+05, 1.6299e+00, 1.5699e+00, 1.8183e+00, 3.9801e+05,
         1.6283e+00, 1.5619e+00, 0.0000e+00, 1.6762e+00],
        [1.6338e+00, 1.7536e+00, 1.7835e+00, 3.9100e+05, 1.4973e+00, 3.8079e+05,
         3.9093e+05, 4.0073e+05, 1.6745e+00, 1.5107e+00, 1.5216e+00, 3.9798e+05,
         1.6436e+00, 1.4948e+00, 1.6762e+00, 0.0000e+00]])
Krum scores: ['1.60', '1.62', '1.61', '391009.31', '1.60', '380810.91', '390946.25', '400728.62', '1.61', '1.50', '1.55', '397974.25', '1.58', '1.50', '1.64', '1.60']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 8, 6, 16, 11, 20, 18, 19, 4, 10, 9, 14, 3, 2, 7, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0200s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:44...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:44, End: 2025-07-22 16:01:44)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 11, 14, 5, 19, 17, 7, 10, 8, 18, 15, 13, 6, 12, 4, 16], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8516e+05, 7.8744e+05, 3.8519e+05, 7.4710e+05, 7.9196e+05,
         3.8520e+05, 3.8518e+05, 3.8517e+05, 7.6501e+05, 7.5966e+05, 7.7006e+05,
         3.8514e+05, 3.8516e+05, 3.8519e+05, 7.6245e+05],
        [3.8516e+05, 0.0000e+00, 3.9972e+05, 1.2987e+00, 3.9480e+05, 4.0447e+05,
         1.5391e+00, 1.4548e+00, 1.4467e+00, 3.9851e+05, 3.7741e+05, 3.8602e+05,
         1.4601e+00, 1.2943e+00, 1.4628e+00, 3.9837e+05],
        [7.8744e+05, 3.9972e+05, 0.0000e+00, 3.9968e+05, 7.9898e+05, 8.1388e+05,
         3.9973e+05, 3.9974e+05, 3.9974e+05, 7.9086e+05, 7.7028e+05, 7.8284e+05,
         3.9974e+05, 3.9970e+05, 3.9972e+05, 8.0707e+05],
        [3.8519e+05, 1.2987e+00, 3.9968e+05, 0.0000e+00, 3.9483e+05, 4.0446e+05,
         1.5286e+00, 1.5473e+00, 1.5753e+00, 3.9849e+05, 3.7742e+05, 3.8602e+05,
         1.6035e+00, 1.3712e+00, 1.4839e+00, 3.9841e+05],
        [7.4710e+05, 3.9480e+05, 7.9898e+05, 3.9483e+05, 0.0000e+00, 7.8442e+05,
         3.9480e+05, 3.9484e+05, 3.9479e+05, 7.9458e+05, 7.6595e+05, 7.6591e+05,
         3.9476e+05, 3.9480e+05, 3.9478e+05, 7.8229e+05],
        [7.9196e+05, 4.0447e+05, 8.1388e+05, 4.0446e+05, 7.8442e+05, 0.0000e+00,
         4.0444e+05, 4.0443e+05, 4.0447e+05, 8.1108e+05, 7.8017e+05, 7.7747e+05,
         4.0444e+05, 4.0442e+05, 4.0448e+05, 8.0340e+05],
        [3.8520e+05, 1.5391e+00, 3.9973e+05, 1.5286e+00, 3.9480e+05, 4.0444e+05,
         0.0000e+00, 1.7453e+00, 1.4480e+00, 3.9854e+05, 3.7740e+05, 3.8604e+05,
         1.4889e+00, 1.5383e+00, 1.4304e+00, 3.9838e+05],
        [3.8518e+05, 1.4548e+00, 3.9974e+05, 1.5473e+00, 3.9484e+05, 4.0443e+05,
         1.7453e+00, 0.0000e+00, 1.7091e+00, 3.9850e+05, 3.7741e+05, 3.8605e+05,
         1.8428e+00, 1.3385e+00, 1.9134e+00, 3.9839e+05],
        [3.8517e+05, 1.4467e+00, 3.9974e+05, 1.5753e+00, 3.9479e+05, 4.0447e+05,
         1.4480e+00, 1.7091e+00, 0.0000e+00, 3.9854e+05, 3.7741e+05, 3.8603e+05,
         1.4100e+00, 1.4808e+00, 1.3981e+00, 3.9840e+05],
        [7.6501e+05, 3.9851e+05, 7.9086e+05, 3.9849e+05, 7.9458e+05, 8.1108e+05,
         3.9854e+05, 3.9850e+05, 3.9854e+05, 0.0000e+00, 7.6324e+05, 7.7657e+05,
         3.9854e+05, 3.9852e+05, 3.9853e+05, 7.8942e+05],
        [7.5966e+05, 3.7741e+05, 7.7028e+05, 3.7742e+05, 7.6595e+05, 7.8017e+05,
         3.7740e+05, 3.7741e+05, 3.7741e+05, 7.6324e+05, 0.0000e+00, 7.7918e+05,
         3.7740e+05, 3.7743e+05, 3.7741e+05, 7.8279e+05],
        [7.7006e+05, 3.8602e+05, 7.8284e+05, 3.8602e+05, 7.6591e+05, 7.7747e+05,
         3.8604e+05, 3.8605e+05, 3.8603e+05, 7.7657e+05, 7.7918e+05, 0.0000e+00,
         3.8604e+05, 3.8601e+05, 3.8603e+05, 7.8932e+05],
        [3.8514e+05, 1.4601e+00, 3.9974e+05, 1.6035e+00, 3.9476e+05, 4.0444e+05,
         1.4889e+00, 1.8428e+00, 1.4100e+00, 3.9854e+05, 3.7740e+05, 3.8604e+05,
         0.0000e+00, 1.5758e+00, 1.3983e+00, 3.9842e+05],
        [3.8516e+05, 1.2943e+00, 3.9970e+05, 1.3712e+00, 3.9480e+05, 4.0442e+05,
         1.5383e+00, 1.3385e+00, 1.4808e+00, 3.9852e+05, 3.7743e+05, 3.8601e+05,
         1.5758e+00, 0.0000e+00, 1.5915e+00, 3.9837e+05],
        [3.8519e+05, 1.4628e+00, 3.9972e+05, 1.4839e+00, 3.9478e+05, 4.0448e+05,
         1.4304e+00, 1.9134e+00, 1.3981e+00, 3.9853e+05, 3.7741e+05, 3.8603e+05,
         1.3983e+00, 1.5915e+00, 0.0000e+00, 3.9840e+05],
        [7.6245e+05, 3.9837e+05, 8.0707e+05, 3.9841e+05, 7.8229e+05, 8.0340e+05,
         3.9838e+05, 3.9839e+05, 3.9840e+05, 7.8942e+05, 7.8279e+05, 7.8932e+05,
         3.9842e+05, 3.9837e+05, 3.9840e+05, 0.0000e+00]])
Krum scores: ['385166.62', '1.40', '399715.09', '1.47', '394788.62', '404443.12', '1.50', '1.61', '1.46', '398512.38', '377407.97', '386025.16', '1.49', '1.43', '1.46', '398386.16']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 11, 14, 5, 19, 17, 7, 10, 8, 18, 15, 13, 6, 12, 4, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:44...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:44, End: 2025-07-22 16:01:44)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 17, 20, 4, 10, 14, 6, 11, 13, 8, 15, 1, 9, 7, 3, 5], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.5800e+05, 8.0943e+05, 3.8998e+05, 3.8995e+05, 7.8182e+05,
         3.8996e+05, 3.8996e+05, 7.8630e+05, 3.8997e+05, 7.9448e+05, 3.8994e+05,
         3.8997e+05, 3.8998e+05, 3.8997e+05, 3.9000e+05],
        [7.5800e+05, 0.0000e+00, 7.7624e+05, 3.8554e+05, 3.8555e+05, 8.0557e+05,
         3.8555e+05, 3.8554e+05, 7.8407e+05, 3.8549e+05, 7.8887e+05, 3.8553e+05,
         3.8552e+05, 3.8553e+05, 3.8554e+05, 3.8555e+05],
        [8.0943e+05, 7.7624e+05, 0.0000e+00, 4.0522e+05, 4.0522e+05, 8.0636e+05,
         4.0522e+05, 4.0524e+05, 7.7782e+05, 4.0519e+05, 7.9779e+05, 4.0520e+05,
         4.0519e+05, 4.0522e+05, 4.0523e+05, 4.0524e+05],
        [3.8998e+05, 3.8554e+05, 4.0522e+05, 0.0000e+00, 1.5808e+00, 3.9231e+05,
         1.2433e+00, 1.6809e+00, 3.9493e+05, 1.2861e+00, 3.9860e+05, 1.2858e+00,
         1.5357e+00, 1.2925e+00, 1.2801e+00, 1.3658e+00],
        [3.8995e+05, 3.8555e+05, 4.0522e+05, 1.5808e+00, 0.0000e+00, 3.9232e+05,
         1.4679e+00, 1.1879e+00, 3.9494e+05, 1.4610e+00, 3.9862e+05, 1.3959e+00,
         1.2018e+00, 1.4445e+00, 1.4472e+00, 1.2616e+00],
        [7.8182e+05, 8.0557e+05, 8.0636e+05, 3.9231e+05, 3.9232e+05, 0.0000e+00,
         3.9232e+05, 3.9233e+05, 7.9924e+05, 3.9231e+05, 7.9460e+05, 3.9228e+05,
         3.9233e+05, 3.9229e+05, 3.9230e+05, 3.9231e+05],
        [3.8996e+05, 3.8555e+05, 4.0522e+05, 1.2433e+00, 1.4679e+00, 3.9232e+05,
         0.0000e+00, 1.6431e+00, 3.9493e+05, 1.2882e+00, 3.9863e+05, 1.2684e+00,
         1.4748e+00, 1.3285e+00, 1.3726e+00, 1.4127e+00],
        [3.8996e+05, 3.8554e+05, 4.0524e+05, 1.6809e+00, 1.1879e+00, 3.9233e+05,
         1.6431e+00, 0.0000e+00, 3.9491e+05, 1.6909e+00, 3.9862e+05, 1.5745e+00,
         1.1888e+00, 1.6948e+00, 1.7365e+00, 1.3341e+00],
        [7.8630e+05, 7.8407e+05, 7.7782e+05, 3.9493e+05, 3.9494e+05, 7.9924e+05,
         3.9493e+05, 3.9491e+05, 0.0000e+00, 3.9494e+05, 8.1065e+05, 3.9491e+05,
         3.9495e+05, 3.9494e+05, 3.9493e+05, 3.9495e+05],
        [3.8997e+05, 3.8549e+05, 4.0519e+05, 1.2861e+00, 1.4610e+00, 3.9231e+05,
         1.2882e+00, 1.6909e+00, 3.9494e+05, 0.0000e+00, 3.9865e+05, 1.3996e+00,
         1.4879e+00, 1.3183e+00, 1.3323e+00, 1.4487e+00],
        [7.9448e+05, 7.8887e+05, 7.9779e+05, 3.9860e+05, 3.9862e+05, 7.9460e+05,
         3.9863e+05, 3.9862e+05, 8.1065e+05, 3.9865e+05, 0.0000e+00, 3.9860e+05,
         3.9860e+05, 3.9862e+05, 3.9859e+05, 3.9864e+05],
        [3.8994e+05, 3.8553e+05, 4.0520e+05, 1.2858e+00, 1.3959e+00, 3.9228e+05,
         1.2684e+00, 1.5745e+00, 3.9491e+05, 1.3996e+00, 3.9860e+05, 0.0000e+00,
         1.4658e+00, 1.2794e+00, 1.3463e+00, 1.3419e+00],
        [3.8997e+05, 3.8552e+05, 4.0519e+05, 1.5357e+00, 1.2018e+00, 3.9233e+05,
         1.4748e+00, 1.1888e+00, 3.9495e+05, 1.4879e+00, 3.9860e+05, 1.4658e+00,
         0.0000e+00, 1.5484e+00, 1.4076e+00, 1.3106e+00],
        [3.8998e+05, 3.8553e+05, 4.0522e+05, 1.2925e+00, 1.4445e+00, 3.9229e+05,
         1.3285e+00, 1.6948e+00, 3.9494e+05, 1.3183e+00, 3.9862e+05, 1.2794e+00,
         1.5484e+00, 0.0000e+00, 1.3612e+00, 1.3567e+00],
        [3.8997e+05, 3.8554e+05, 4.0523e+05, 1.2801e+00, 1.4472e+00, 3.9230e+05,
         1.3726e+00, 1.7365e+00, 3.9493e+05, 1.3323e+00, 3.9859e+05, 1.3463e+00,
         1.4076e+00, 1.3612e+00, 0.0000e+00, 1.3495e+00],
        [3.9000e+05, 3.8555e+05, 4.0524e+05, 1.3658e+00, 1.2616e+00, 3.9231e+05,
         1.4127e+00, 1.3341e+00, 3.9495e+05, 1.4487e+00, 3.9864e+05, 1.3419e+00,
         1.3106e+00, 1.3567e+00, 1.3495e+00, 0.0000e+00]])
Krum scores: ['389961.66', '385528.06', '405211.19', '1.36', '1.36', '392305.25', '1.36', '1.50', '394927.03', '1.38', '398610.59', '1.35', '1.38', '1.37', '1.36', '1.34']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [16, 17, 20, 4, 10, 14, 6, 11, 13, 8, 15, 1, 9, 7, 3, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0134s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:45...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:45, End: 2025-07-22 16:01:45)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 8, 5, 14, 1, 15, 18, 16, 9, 6, 13, 12, 20, 4, 19, 17], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3180e+00, 1.7883e+00, 3.9332e+05, 1.2159e+00, 3.9077e+05,
         3.7804e+05, 3.8280e+05, 1.4787e+00, 1.3180e+00, 3.9799e+05, 1.4205e+00,
         4.0858e+05, 1.2607e+00, 3.9846e+05, 3.8013e+05],
        [1.3180e+00, 0.0000e+00, 1.8080e+00, 3.9333e+05, 1.3875e+00, 3.9080e+05,
         3.7802e+05, 3.8275e+05, 1.4357e+00, 1.2589e+00, 3.9801e+05, 1.3914e+00,
         4.0856e+05, 1.2751e+00, 3.9849e+05, 3.8013e+05],
        [1.7883e+00, 1.8080e+00, 0.0000e+00, 3.9333e+05, 1.6330e+00, 3.9083e+05,
         3.7803e+05, 3.8281e+05, 1.2711e+00, 1.8515e+00, 3.9800e+05, 1.3323e+00,
         4.0856e+05, 1.7784e+00, 3.9847e+05, 3.8015e+05],
        [3.9332e+05, 3.9333e+05, 3.9333e+05, 0.0000e+00, 3.9332e+05, 7.8118e+05,
         7.6852e+05, 7.9381e+05, 3.9332e+05, 3.9335e+05, 7.9954e+05, 3.9333e+05,
         8.0351e+05, 3.9332e+05, 7.5369e+05, 7.6480e+05],
        [1.2159e+00, 1.3875e+00, 1.6330e+00, 3.9332e+05, 0.0000e+00, 3.9081e+05,
         3.7803e+05, 3.8280e+05, 1.3664e+00, 1.2548e+00, 3.9802e+05, 1.3036e+00,
         4.0858e+05, 1.3036e+00, 3.9848e+05, 3.8012e+05],
        [3.9077e+05, 3.9080e+05, 3.9083e+05, 7.8118e+05, 3.9081e+05, 0.0000e+00,
         7.4922e+05, 7.7314e+05, 3.9083e+05, 3.9079e+05, 7.8667e+05, 3.9081e+05,
         7.9706e+05, 3.9082e+05, 7.9967e+05, 7.5841e+05],
        [3.7804e+05, 3.7802e+05, 3.7803e+05, 7.6852e+05, 3.7803e+05, 7.4922e+05,
         0.0000e+00, 7.6091e+05, 3.7805e+05, 3.7806e+05, 7.6383e+05, 3.7802e+05,
         7.9594e+05, 3.7805e+05, 7.7227e+05, 7.5636e+05],
        [3.8280e+05, 3.8275e+05, 3.8281e+05, 7.9381e+05, 3.8280e+05, 7.7314e+05,
         7.6091e+05, 0.0000e+00, 3.8279e+05, 3.8278e+05, 7.6967e+05, 3.8280e+05,
         7.7357e+05, 3.8277e+05, 7.8349e+05, 7.8606e+05],
        [1.4787e+00, 1.4357e+00, 1.2711e+00, 3.9332e+05, 1.3664e+00, 3.9083e+05,
         3.7805e+05, 3.8279e+05, 0.0000e+00, 1.4546e+00, 3.9804e+05, 1.1575e+00,
         4.0857e+05, 1.4887e+00, 3.9845e+05, 3.8014e+05],
        [1.3180e+00, 1.2589e+00, 1.8515e+00, 3.9335e+05, 1.2548e+00, 3.9079e+05,
         3.7806e+05, 3.8278e+05, 1.4546e+00, 0.0000e+00, 3.9801e+05, 1.4120e+00,
         4.0858e+05, 1.2664e+00, 3.9845e+05, 3.8011e+05],
        [3.9799e+05, 3.9801e+05, 3.9800e+05, 7.9954e+05, 3.9802e+05, 7.8667e+05,
         7.6383e+05, 7.6967e+05, 3.9804e+05, 3.9801e+05, 0.0000e+00, 3.9801e+05,
         7.8601e+05, 3.9801e+05, 8.1514e+05, 7.8453e+05],
        [1.4205e+00, 1.3914e+00, 1.3323e+00, 3.9333e+05, 1.3036e+00, 3.9081e+05,
         3.7802e+05, 3.8280e+05, 1.1575e+00, 1.4120e+00, 3.9801e+05, 0.0000e+00,
         4.0858e+05, 1.4111e+00, 3.9845e+05, 3.8012e+05],
        [4.0858e+05, 4.0856e+05, 4.0856e+05, 8.0351e+05, 4.0858e+05, 7.9706e+05,
         7.9594e+05, 7.7357e+05, 4.0857e+05, 4.0858e+05, 7.8601e+05, 4.0858e+05,
         0.0000e+00, 4.0856e+05, 7.9052e+05, 7.5862e+05],
        [1.2607e+00, 1.2751e+00, 1.7784e+00, 3.9332e+05, 1.3036e+00, 3.9082e+05,
         3.7805e+05, 3.8277e+05, 1.4887e+00, 1.2664e+00, 3.9801e+05, 1.4111e+00,
         4.0856e+05, 0.0000e+00, 3.9848e+05, 3.8010e+05],
        [3.9846e+05, 3.9849e+05, 3.9847e+05, 7.5369e+05, 3.9848e+05, 7.9967e+05,
         7.7227e+05, 7.8349e+05, 3.9845e+05, 3.9845e+05, 8.1514e+05, 3.9845e+05,
         7.9052e+05, 3.9848e+05, 0.0000e+00, 7.5556e+05],
        [3.8013e+05, 3.8013e+05, 3.8015e+05, 7.6480e+05, 3.8012e+05, 7.5841e+05,
         7.5636e+05, 7.8606e+05, 3.8014e+05, 3.8011e+05, 7.8453e+05, 3.8012e+05,
         7.5862e+05, 3.8010e+05, 7.5556e+05, 0.0000e+00]])
Krum scores: ['1.34', '1.34', '1.60', '393322.09', '1.31', '390800.09', '378031.22', '382780.88', '1.36', '1.33', '398007.50', '1.33', '408567.16', '1.33', '398459.41', '380118.38']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 8, 5, 14, 1, 15, 18, 16, 9, 6, 13, 12, 20, 4, 19, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:46...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:46, End: 2025-07-22 16:01:46)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 7, 3, 2, 4, 18, 5, 14, 9, 12, 16, 13, 20, 19, 6, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5685e+00, 1.4864e+00, 1.2927e+00, 1.4982e+00, 3.8189e+05,
         1.1250e+00, 3.9483e+05, 1.1102e+00, 1.1936e+00, 3.8921e+05, 3.9492e+05,
         3.9806e+05, 3.9380e+05, 1.4553e+00, 3.9863e+05],
        [1.5685e+00, 0.0000e+00, 1.4890e+00, 1.4348e+00, 1.3901e+00, 3.8189e+05,
         1.7448e+00, 3.9485e+05, 1.6416e+00, 1.5750e+00, 3.8923e+05, 3.9491e+05,
         3.9808e+05, 3.9375e+05, 1.4128e+00, 3.9867e+05],
        [1.4864e+00, 1.4890e+00, 0.0000e+00, 1.3830e+00, 1.3558e+00, 3.8190e+05,
         1.5647e+00, 3.9485e+05, 1.3961e+00, 1.4165e+00, 3.8921e+05, 3.9497e+05,
         3.9807e+05, 3.9379e+05, 1.4329e+00, 3.9871e+05],
        [1.2927e+00, 1.4348e+00, 1.3830e+00, 0.0000e+00, 1.4183e+00, 3.8191e+05,
         1.4064e+00, 3.9483e+05, 1.2544e+00, 1.2946e+00, 3.8917e+05, 3.9491e+05,
         3.9808e+05, 3.9378e+05, 1.4056e+00, 3.9863e+05],
        [1.4982e+00, 1.3901e+00, 1.3558e+00, 1.4183e+00, 0.0000e+00, 3.8190e+05,
         1.6339e+00, 3.9484e+05, 1.5514e+00, 1.4735e+00, 3.8923e+05, 3.9493e+05,
         3.9805e+05, 3.9379e+05, 1.3065e+00, 3.9867e+05],
        [3.8189e+05, 3.8189e+05, 3.8190e+05, 3.8191e+05, 3.8190e+05, 0.0000e+00,
         3.8191e+05, 7.6688e+05, 3.8193e+05, 3.8192e+05, 7.7749e+05, 7.9360e+05,
         7.9372e+05, 7.7463e+05, 3.8190e+05, 7.9454e+05],
        [1.1250e+00, 1.7448e+00, 1.5647e+00, 1.4064e+00, 1.6339e+00, 3.8191e+05,
         0.0000e+00, 3.9483e+05, 1.2661e+00, 1.2955e+00, 3.8921e+05, 3.9496e+05,
         3.9808e+05, 3.9375e+05, 1.7193e+00, 3.9865e+05],
        [3.9483e+05, 3.9485e+05, 3.9485e+05, 3.9483e+05, 3.9484e+05, 7.6688e+05,
         3.9483e+05, 0.0000e+00, 3.9482e+05, 3.9486e+05, 7.6003e+05, 7.8101e+05,
         7.9929e+05, 8.0496e+05, 3.9485e+05, 8.0371e+05],
        [1.1102e+00, 1.6416e+00, 1.3961e+00, 1.2544e+00, 1.5514e+00, 3.8193e+05,
         1.2661e+00, 3.9482e+05, 0.0000e+00, 1.2502e+00, 3.8921e+05, 3.9496e+05,
         3.9811e+05, 3.9378e+05, 1.4982e+00, 3.9867e+05],
        [1.1936e+00, 1.5750e+00, 1.4165e+00, 1.2946e+00, 1.4735e+00, 3.8192e+05,
         1.2955e+00, 3.9486e+05, 1.2502e+00, 0.0000e+00, 3.8922e+05, 3.9494e+05,
         3.9806e+05, 3.9379e+05, 1.5061e+00, 3.9863e+05],
        [3.8921e+05, 3.8923e+05, 3.8921e+05, 3.8917e+05, 3.8923e+05, 7.7749e+05,
         3.8921e+05, 7.6003e+05, 3.8921e+05, 3.8922e+05, 0.0000e+00, 7.7481e+05,
         7.7258e+05, 7.9241e+05, 3.8920e+05, 7.7988e+05],
        [3.9492e+05, 3.9491e+05, 3.9497e+05, 3.9491e+05, 3.9493e+05, 7.9360e+05,
         3.9496e+05, 7.8101e+05, 3.9496e+05, 3.9494e+05, 7.7481e+05, 0.0000e+00,
         7.6698e+05, 7.8591e+05, 3.9492e+05, 7.8456e+05],
        [3.9806e+05, 3.9808e+05, 3.9807e+05, 3.9808e+05, 3.9805e+05, 7.9372e+05,
         3.9808e+05, 7.9929e+05, 3.9811e+05, 3.9806e+05, 7.7258e+05, 7.6698e+05,
         0.0000e+00, 7.9457e+05, 3.9806e+05, 7.7904e+05],
        [3.9380e+05, 3.9375e+05, 3.9379e+05, 3.9378e+05, 3.9379e+05, 7.7463e+05,
         3.9375e+05, 8.0496e+05, 3.9378e+05, 3.9379e+05, 7.9241e+05, 7.8591e+05,
         7.9457e+05, 0.0000e+00, 3.9380e+05, 8.0705e+05],
        [1.4553e+00, 1.4128e+00, 1.4329e+00, 1.4056e+00, 1.3065e+00, 3.8190e+05,
         1.7193e+00, 3.9485e+05, 1.4982e+00, 1.5061e+00, 3.8920e+05, 3.9492e+05,
         3.9806e+05, 3.9380e+05, 0.0000e+00, 3.9860e+05],
        [3.9863e+05, 3.9867e+05, 3.9871e+05, 3.9863e+05, 3.9867e+05, 7.9454e+05,
         3.9865e+05, 8.0371e+05, 3.9867e+05, 3.9863e+05, 7.7988e+05, 7.8456e+05,
         7.7904e+05, 8.0705e+05, 3.9860e+05, 0.0000e+00]])
Krum scores: ['1.31', '1.50', '1.42', '1.35', '1.43', '381899.72', '1.43', '394835.94', '1.33', '1.35', '389204.97', '394927.44', '398066.03', '393777.75', '1.43', '398641.53']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 7, 3, 2, 4, 18, 5, 14, 9, 12, 16, 13, 20, 19, 6, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0167s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:46...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[167  70]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:46, End: 2025-07-22 16:01:46)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [18, 1, 6, 13, 12, 19, 15, 17, 5, 4, 7, 10, 16, 2, 3, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9090e+05, 3.9091e+05, 7.8098e+05, 3.9089e+05, 7.8215e+05,
         7.7167e+05, 7.8301e+05, 3.9090e+05, 3.9091e+05, 3.9089e+05, 3.9089e+05,
         7.6531e+05, 3.9090e+05, 3.9091e+05, 3.9087e+05],
        [3.9090e+05, 0.0000e+00, 1.1796e+00, 3.8520e+05, 1.0495e+00, 3.9783e+05,
         3.9171e+05, 3.8878e+05, 1.0864e+00, 1.2405e+00, 1.2532e+00, 1.0553e+00,
         3.8379e+05, 1.1043e+00, 1.1865e+00, 1.0999e+00],
        [3.9091e+05, 1.1796e+00, 0.0000e+00, 3.8519e+05, 1.2526e+00, 3.9786e+05,
         3.9164e+05, 3.8882e+05, 1.4693e+00, 1.0845e+00, 1.2171e+00, 1.2646e+00,
         3.8381e+05, 1.1845e+00, 1.1852e+00, 1.3002e+00],
        [7.8098e+05, 3.8520e+05, 3.8519e+05, 0.0000e+00, 3.8520e+05, 7.9030e+05,
         7.7621e+05, 7.6989e+05, 3.8522e+05, 3.8521e+05, 3.8520e+05, 3.8520e+05,
         7.7270e+05, 3.8520e+05, 3.8518e+05, 3.8520e+05],
        [3.9089e+05, 1.0495e+00, 1.2526e+00, 3.8520e+05, 0.0000e+00, 3.9786e+05,
         3.9167e+05, 3.8882e+05, 1.1048e+00, 1.2223e+00, 1.2883e+00, 9.9780e-01,
         3.8379e+05, 1.0821e+00, 1.1690e+00, 1.0426e+00],
        [7.8215e+05, 3.9783e+05, 3.9786e+05, 7.9030e+05, 3.9786e+05, 0.0000e+00,
         8.0406e+05, 7.9484e+05, 3.9786e+05, 3.9785e+05, 3.9787e+05, 3.9787e+05,
         7.8675e+05, 3.9786e+05, 3.9785e+05, 3.9782e+05],
        [7.7167e+05, 3.9171e+05, 3.9164e+05, 7.7621e+05, 3.9167e+05, 8.0406e+05,
         0.0000e+00, 7.8389e+05, 3.9167e+05, 3.9167e+05, 3.9167e+05, 3.9166e+05,
         7.9173e+05, 3.9168e+05, 3.9168e+05, 3.9169e+05],
        [7.8301e+05, 3.8878e+05, 3.8882e+05, 7.6989e+05, 3.8882e+05, 7.9484e+05,
         7.8389e+05, 0.0000e+00, 3.8882e+05, 3.8883e+05, 3.8883e+05, 3.8882e+05,
         7.7920e+05, 3.8882e+05, 3.8882e+05, 3.8884e+05],
        [3.9090e+05, 1.0864e+00, 1.4693e+00, 3.8522e+05, 1.1048e+00, 3.9786e+05,
         3.9167e+05, 3.8882e+05, 0.0000e+00, 1.3990e+00, 1.4728e+00, 1.0706e+00,
         3.8380e+05, 1.1938e+00, 1.3196e+00, 1.0858e+00],
        [3.9091e+05, 1.2405e+00, 1.0845e+00, 3.8521e+05, 1.2223e+00, 3.9785e+05,
         3.9167e+05, 3.8883e+05, 1.3990e+00, 0.0000e+00, 1.1731e+00, 1.3261e+00,
         3.8382e+05, 1.1662e+00, 1.1145e+00, 1.3295e+00],
        [3.9089e+05, 1.2532e+00, 1.2171e+00, 3.8520e+05, 1.2883e+00, 3.9787e+05,
         3.9167e+05, 3.8883e+05, 1.4728e+00, 1.1731e+00, 0.0000e+00, 1.2841e+00,
         3.8380e+05, 1.1565e+00, 1.2426e+00, 1.3958e+00],
        [3.9089e+05, 1.0553e+00, 1.2646e+00, 3.8520e+05, 9.9780e-01, 3.9787e+05,
         3.9166e+05, 3.8882e+05, 1.0706e+00, 1.3261e+00, 1.2841e+00, 0.0000e+00,
         3.8378e+05, 1.0565e+00, 1.1881e+00, 1.0698e+00],
        [7.6531e+05, 3.8379e+05, 3.8381e+05, 7.7270e+05, 3.8379e+05, 7.8675e+05,
         7.9173e+05, 7.7920e+05, 3.8380e+05, 3.8382e+05, 3.8380e+05, 3.8378e+05,
         0.0000e+00, 3.8381e+05, 3.8381e+05, 3.8378e+05],
        [3.9090e+05, 1.1043e+00, 1.1845e+00, 3.8520e+05, 1.0821e+00, 3.9786e+05,
         3.9168e+05, 3.8882e+05, 1.1938e+00, 1.1662e+00, 1.1565e+00, 1.0565e+00,
         3.8381e+05, 0.0000e+00, 1.1657e+00, 1.0672e+00],
        [3.9091e+05, 1.1865e+00, 1.1852e+00, 3.8518e+05, 1.1690e+00, 3.9785e+05,
         3.9168e+05, 3.8882e+05, 1.3196e+00, 1.1145e+00, 1.2426e+00, 1.1881e+00,
         3.8381e+05, 1.1657e+00, 0.0000e+00, 1.1955e+00],
        [3.9087e+05, 1.0999e+00, 1.3002e+00, 3.8520e+05, 1.0426e+00, 3.9782e+05,
         3.9169e+05, 3.8884e+05, 1.0858e+00, 1.3295e+00, 1.3958e+00, 1.0698e+00,
         3.8378e+05, 1.0672e+00, 1.1955e+00, 0.0000e+00]])
Krum scores: ['390893.09', '1.13', '1.21', '385196.78', '1.12', '397850.59', '391665.88', '388815.56', '1.22', '1.21', '1.25', '1.12', '383795.75', '1.12', '1.18', '1.15']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [18, 1, 6, 13, 12, 19, 15, 17, 5, 4, 7, 10, 16, 2, 3, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0206s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:47...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:47, End: 2025-07-22 16:01:47)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 16, 11, 14, 18, 8, 19, 20, 7, 17, 2, 4, 6, 15, 5, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8647e+05, 1.5033e+00, 3.9299e+05, 3.6067e+05, 1.1898e+00,
         3.9431e+05, 3.9819e+05, 1.2672e+00, 4.0544e+05, 1.1856e+00, 1.1877e+00,
         1.2087e+00, 3.9995e+05, 1.2840e+00, 1.4473e+00],
        [3.8647e+05, 0.0000e+00, 3.8647e+05, 7.7954e+05, 7.4448e+05, 3.8646e+05,
         7.6662e+05, 7.6124e+05, 3.8649e+05, 8.0146e+05, 3.8648e+05, 3.8647e+05,
         3.8647e+05, 7.8319e+05, 3.8645e+05, 3.8644e+05],
        [1.5033e+00, 3.8647e+05, 0.0000e+00, 3.9298e+05, 3.6063e+05, 1.4907e+00,
         3.9430e+05, 3.9823e+05, 1.5864e+00, 4.0541e+05, 1.2054e+00, 1.5661e+00,
         1.4801e+00, 3.9993e+05, 8.9617e-01, 8.8920e-01],
        [3.9299e+05, 7.7954e+05, 3.9298e+05, 0.0000e+00, 7.5832e+05, 3.9297e+05,
         7.7056e+05, 8.0912e+05, 3.9297e+05, 8.0109e+05, 3.9295e+05, 3.9297e+05,
         3.9296e+05, 7.9265e+05, 3.9297e+05, 3.9296e+05],
        [3.6067e+05, 7.4448e+05, 3.6063e+05, 7.5832e+05, 0.0000e+00, 3.6064e+05,
         7.6031e+05, 7.5918e+05, 3.6067e+05, 7.4592e+05, 3.6063e+05, 3.6068e+05,
         3.6064e+05, 7.4563e+05, 3.6065e+05, 3.6066e+05],
        [1.1898e+00, 3.8646e+05, 1.4907e+00, 3.9297e+05, 3.6064e+05, 0.0000e+00,
         3.9430e+05, 3.9818e+05, 1.1680e+00, 4.0543e+05, 1.1724e+00, 1.0902e+00,
         1.0579e+00, 3.9995e+05, 1.3207e+00, 1.4850e+00],
        [3.9431e+05, 7.6662e+05, 3.9430e+05, 7.7056e+05, 7.6031e+05, 3.9430e+05,
         0.0000e+00, 8.0138e+05, 3.9430e+05, 7.9815e+05, 3.9428e+05, 3.9431e+05,
         3.9430e+05, 8.0561e+05, 3.9429e+05, 3.9426e+05],
        [3.9819e+05, 7.6124e+05, 3.9823e+05, 8.0912e+05, 7.5918e+05, 3.9818e+05,
         8.0138e+05, 0.0000e+00, 3.9819e+05, 8.0544e+05, 3.9822e+05, 3.9818e+05,
         3.9821e+05, 7.9654e+05, 3.9823e+05, 3.9822e+05],
        [1.2672e+00, 3.8649e+05, 1.5864e+00, 3.9297e+05, 3.6067e+05, 1.1680e+00,
         3.9430e+05, 3.9819e+05, 0.0000e+00, 4.0544e+05, 1.1653e+00, 1.1938e+00,
         1.1639e+00, 3.9995e+05, 1.4022e+00, 1.6301e+00],
        [4.0544e+05, 8.0146e+05, 4.0541e+05, 8.0109e+05, 7.4592e+05, 4.0543e+05,
         7.9815e+05, 8.0544e+05, 4.0544e+05, 0.0000e+00, 4.0544e+05, 4.0543e+05,
         4.0544e+05, 7.8981e+05, 4.0546e+05, 4.0546e+05],
        [1.1856e+00, 3.8648e+05, 1.2054e+00, 3.9295e+05, 3.6063e+05, 1.1724e+00,
         3.9428e+05, 3.9822e+05, 1.1653e+00, 4.0544e+05, 0.0000e+00, 1.1764e+00,
         1.1360e+00, 3.9995e+05, 1.1388e+00, 1.2640e+00],
        [1.1877e+00, 3.8647e+05, 1.5661e+00, 3.9297e+05, 3.6068e+05, 1.0902e+00,
         3.9431e+05, 3.9818e+05, 1.1938e+00, 4.0543e+05, 1.1764e+00, 0.0000e+00,
         1.0457e+00, 3.9997e+05, 1.3288e+00, 1.5543e+00],
        [1.2087e+00, 3.8647e+05, 1.4801e+00, 3.9296e+05, 3.6064e+05, 1.0579e+00,
         3.9430e+05, 3.9821e+05, 1.1639e+00, 4.0544e+05, 1.1360e+00, 1.0457e+00,
         0.0000e+00, 3.9993e+05, 1.3368e+00, 1.5264e+00],
        [3.9995e+05, 7.8319e+05, 3.9993e+05, 7.9265e+05, 7.4563e+05, 3.9995e+05,
         8.0561e+05, 7.9654e+05, 3.9995e+05, 7.8981e+05, 3.9995e+05, 3.9997e+05,
         3.9993e+05, 0.0000e+00, 3.9995e+05, 3.9994e+05],
        [1.2840e+00, 3.8645e+05, 8.9617e-01, 3.9297e+05, 3.6065e+05, 1.3207e+00,
         3.9429e+05, 3.9823e+05, 1.4022e+00, 4.0546e+05, 1.1388e+00, 1.3288e+00,
         1.3368e+00, 3.9995e+05, 0.0000e+00, 1.0274e+00],
        [1.4473e+00, 3.8644e+05, 8.8920e-01, 3.9296e+05, 3.6066e+05, 1.4850e+00,
         3.9426e+05, 3.9822e+05, 1.6301e+00, 4.0546e+05, 1.2640e+00, 1.5543e+00,
         1.5264e+00, 3.9994e+05, 1.0274e+00, 0.0000e+00]])
Krum scores: ['1.25', '386461.00', '1.29', '392964.56', '360645.72', '1.21', '394289.56', '398199.94', '1.28', '405433.03', '1.17', '1.23', '1.20', '399942.97', '1.19', '1.31']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 16, 11, 14, 18, 8, 19, 20, 7, 17, 2, 4, 6, 15, 5, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0168s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:47...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:47, End: 2025-07-22 16:01:47)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 1, 5, 9, 16, 12, 10, 7, 17, 13, 20, 18, 11, 4, 19, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2385e+00, 1.3023e+00, 1.2811e+00, 3.7530e+05, 1.3825e+00,
         1.2024e+00, 1.3133e+00, 3.8854e+05, 3.8559e+05, 3.8121e+05, 3.9855e+05,
         1.4577e+00, 1.1882e+00, 3.9693e+05, 3.6652e+05],
        [1.2385e+00, 0.0000e+00, 1.1111e+00, 1.1706e+00, 3.7531e+05, 1.1340e+00,
         1.0696e+00, 1.2393e+00, 3.8857e+05, 3.8557e+05, 3.8121e+05, 3.9857e+05,
         1.1196e+00, 1.2608e+00, 3.9690e+05, 3.6651e+05],
        [1.3023e+00, 1.1111e+00, 0.0000e+00, 1.0985e+00, 3.7530e+05, 1.0275e+00,
         1.0445e+00, 1.4099e+00, 3.8855e+05, 3.8560e+05, 3.8120e+05, 3.9857e+05,
         9.1958e-01, 1.3381e+00, 3.9691e+05, 3.6650e+05],
        [1.2811e+00, 1.1706e+00, 1.0985e+00, 0.0000e+00, 3.7529e+05, 1.0371e+00,
         1.1082e+00, 1.4296e+00, 3.8855e+05, 3.8557e+05, 3.8117e+05, 3.9856e+05,
         1.0103e+00, 1.3915e+00, 3.9691e+05, 3.6653e+05],
        [3.7530e+05, 3.7531e+05, 3.7530e+05, 3.7529e+05, 0.0000e+00, 3.7530e+05,
         3.7532e+05, 3.7531e+05, 7.8506e+05, 7.6027e+05, 7.4409e+05, 7.7158e+05,
         3.7531e+05, 3.7532e+05, 7.8818e+05, 7.4252e+05],
        [1.3825e+00, 1.1340e+00, 1.0275e+00, 1.0371e+00, 3.7530e+05, 0.0000e+00,
         9.9761e-01, 1.5160e+00, 3.8854e+05, 3.8554e+05, 3.8120e+05, 3.9857e+05,
         8.7372e-01, 1.4492e+00, 3.9692e+05, 3.6649e+05],
        [1.2024e+00, 1.0696e+00, 1.0445e+00, 1.1082e+00, 3.7532e+05, 9.9761e-01,
         0.0000e+00, 1.2926e+00, 3.8852e+05, 3.8556e+05, 3.8120e+05, 3.9855e+05,
         1.0164e+00, 1.3274e+00, 3.9694e+05, 3.6651e+05],
        [1.3133e+00, 1.2393e+00, 1.4099e+00, 1.4296e+00, 3.7531e+05, 1.5160e+00,
         1.2926e+00, 0.0000e+00, 3.8856e+05, 3.8557e+05, 3.8119e+05, 3.9856e+05,
         1.5173e+00, 1.2332e+00, 3.9692e+05, 3.6651e+05],
        [3.8854e+05, 3.8857e+05, 3.8855e+05, 3.8855e+05, 7.8506e+05, 3.8854e+05,
         3.8852e+05, 3.8856e+05, 0.0000e+00, 7.6652e+05, 7.7978e+05, 7.7083e+05,
         3.8855e+05, 3.8855e+05, 7.9142e+05, 7.5749e+05],
        [3.8559e+05, 3.8557e+05, 3.8560e+05, 3.8557e+05, 7.6027e+05, 3.8554e+05,
         3.8556e+05, 3.8557e+05, 7.6652e+05, 0.0000e+00, 7.6737e+05, 7.7161e+05,
         3.8555e+05, 3.8558e+05, 7.7665e+05, 7.4630e+05],
        [3.8121e+05, 3.8121e+05, 3.8120e+05, 3.8117e+05, 7.4409e+05, 3.8120e+05,
         3.8120e+05, 3.8119e+05, 7.7978e+05, 7.6737e+05, 0.0000e+00, 7.8822e+05,
         3.8118e+05, 3.8121e+05, 7.7562e+05, 7.7429e+05],
        [3.9855e+05, 3.9857e+05, 3.9857e+05, 3.9856e+05, 7.7158e+05, 3.9857e+05,
         3.9855e+05, 3.9856e+05, 7.7083e+05, 7.7161e+05, 7.8822e+05, 0.0000e+00,
         3.9855e+05, 3.9854e+05, 8.0373e+05, 7.6462e+05],
        [1.4577e+00, 1.1196e+00, 9.1958e-01, 1.0103e+00, 3.7531e+05, 8.7372e-01,
         1.0164e+00, 1.5173e+00, 3.8855e+05, 3.8555e+05, 3.8118e+05, 3.9855e+05,
         0.0000e+00, 1.5154e+00, 3.9693e+05, 3.6651e+05],
        [1.1882e+00, 1.2608e+00, 1.3381e+00, 1.3915e+00, 3.7532e+05, 1.4492e+00,
         1.3274e+00, 1.2332e+00, 3.8855e+05, 3.8558e+05, 3.8121e+05, 3.9854e+05,
         1.5154e+00, 0.0000e+00, 3.9694e+05, 3.6649e+05],
        [3.9693e+05, 3.9690e+05, 3.9691e+05, 3.9691e+05, 7.8818e+05, 3.9692e+05,
         3.9694e+05, 3.9692e+05, 7.9142e+05, 7.7665e+05, 7.7562e+05, 8.0373e+05,
         3.9693e+05, 3.9694e+05, 0.0000e+00, 7.6329e+05],
        [3.6652e+05, 3.6651e+05, 3.6650e+05, 3.6653e+05, 7.4252e+05, 3.6649e+05,
         3.6651e+05, 3.6651e+05, 7.5749e+05, 7.4630e+05, 7.7429e+05, 7.6462e+05,
         3.6651e+05, 3.6649e+05, 7.6329e+05, 0.0000e+00]])
Krum scores: ['1.27', '1.15', '1.12', '1.16', '375301.72', '1.13', '1.10', '1.35', '388544.34', '385565.94', '381192.16', '398555.22', '1.13', '1.31', '396918.84', '366503.00']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 1, 5, 9, 16, 12, 10, 7, 17, 13, 20, 18, 11, 4, 19, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:48...
global Accuracy on shared test data: 72.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:48, End: 2025-07-22 16:01:48)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 9, 1, 3, 14, 13, 18, 6, 10, 16, 11, 7, 8, 2, 20, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2780e+00, 1.1242e+00, 1.0911e+00, 3.8063e+05, 3.9635e+05,
         3.9226e+05, 9.9551e-01, 1.6727e+00, 3.9771e+05, 1.3865e+00, 1.0845e+00,
         1.0339e+00, 1.2668e+00, 3.7368e+05, 4.0084e+05],
        [1.2780e+00, 0.0000e+00, 1.0751e+00, 1.1474e+00, 3.8067e+05, 3.9636e+05,
         3.9227e+05, 1.1971e+00, 1.1897e+00, 3.9771e+05, 9.3986e-01, 1.2810e+00,
         1.2005e+00, 9.9452e-01, 3.7370e+05, 4.0089e+05],
        [1.1242e+00, 1.0751e+00, 0.0000e+00, 1.1331e+00, 3.8066e+05, 3.9636e+05,
         3.9222e+05, 1.0803e+00, 1.2722e+00, 3.9774e+05, 1.0456e+00, 1.1237e+00,
         1.1369e+00, 1.0789e+00, 3.7371e+05, 4.0089e+05],
        [1.0911e+00, 1.1474e+00, 1.1331e+00, 0.0000e+00, 3.8065e+05, 3.9636e+05,
         3.9224e+05, 1.1802e+00, 1.4921e+00, 3.9771e+05, 1.3528e+00, 1.1677e+00,
         1.1023e+00, 1.2176e+00, 3.7371e+05, 4.0086e+05],
        [3.8063e+05, 3.8067e+05, 3.8066e+05, 3.8065e+05, 0.0000e+00, 7.8495e+05,
         7.9271e+05, 3.8065e+05, 3.8065e+05, 7.6110e+05, 3.8063e+05, 3.8064e+05,
         3.8065e+05, 3.8062e+05, 7.4001e+05, 7.8358e+05],
        [3.9635e+05, 3.9636e+05, 3.9636e+05, 3.9636e+05, 7.8495e+05, 0.0000e+00,
         7.9958e+05, 3.9635e+05, 3.9636e+05, 8.0144e+05, 3.9634e+05, 3.9637e+05,
         3.9638e+05, 3.9641e+05, 7.7831e+05, 7.7979e+05],
        [3.9226e+05, 3.9227e+05, 3.9222e+05, 3.9224e+05, 7.9271e+05, 7.9958e+05,
         0.0000e+00, 3.9223e+05, 3.9225e+05, 7.9200e+05, 3.9224e+05, 3.9224e+05,
         3.9226e+05, 3.9224e+05, 7.7642e+05, 7.6835e+05],
        [9.9551e-01, 1.1971e+00, 1.0803e+00, 1.1802e+00, 3.8065e+05, 3.9635e+05,
         3.9223e+05, 0.0000e+00, 1.5996e+00, 3.9770e+05, 1.3349e+00, 1.1067e+00,
         1.0291e+00, 1.2814e+00, 3.7371e+05, 4.0090e+05],
        [1.6727e+00, 1.1897e+00, 1.2722e+00, 1.4921e+00, 3.8065e+05, 3.9636e+05,
         3.9225e+05, 1.5996e+00, 0.0000e+00, 3.9771e+05, 9.2510e-01, 1.6233e+00,
         1.6020e+00, 1.0681e+00, 3.7368e+05, 4.0090e+05],
        [3.9771e+05, 3.9771e+05, 3.9774e+05, 3.9771e+05, 7.6110e+05, 8.0144e+05,
         7.9200e+05, 3.9770e+05, 3.9771e+05, 0.0000e+00, 3.9772e+05, 3.9772e+05,
         3.9771e+05, 3.9771e+05, 7.7701e+05, 8.0783e+05],
        [1.3865e+00, 9.3986e-01, 1.0456e+00, 1.3528e+00, 3.8063e+05, 3.9634e+05,
         3.9224e+05, 1.3349e+00, 9.2510e-01, 3.9772e+05, 0.0000e+00, 1.4178e+00,
         1.3703e+00, 9.6395e-01, 3.7372e+05, 4.0088e+05],
        [1.0845e+00, 1.2810e+00, 1.1237e+00, 1.1677e+00, 3.8064e+05, 3.9637e+05,
         3.9224e+05, 1.1067e+00, 1.6233e+00, 3.9772e+05, 1.4178e+00, 0.0000e+00,
         1.1286e+00, 1.2489e+00, 3.7369e+05, 4.0086e+05],
        [1.0339e+00, 1.2005e+00, 1.1369e+00, 1.1023e+00, 3.8065e+05, 3.9638e+05,
         3.9226e+05, 1.0291e+00, 1.6020e+00, 3.9771e+05, 1.3703e+00, 1.1286e+00,
         0.0000e+00, 1.2352e+00, 3.7368e+05, 4.0090e+05],
        [1.2668e+00, 9.9452e-01, 1.0789e+00, 1.2176e+00, 3.8062e+05, 3.9641e+05,
         3.9224e+05, 1.2814e+00, 1.0681e+00, 3.9771e+05, 9.6395e-01, 1.2489e+00,
         1.2352e+00, 0.0000e+00, 3.7370e+05, 4.0087e+05],
        [3.7368e+05, 3.7370e+05, 3.7371e+05, 3.7371e+05, 7.4001e+05, 7.7831e+05,
         7.7642e+05, 3.7371e+05, 3.7368e+05, 7.7701e+05, 3.7372e+05, 3.7369e+05,
         3.7368e+05, 3.7370e+05, 0.0000e+00, 7.4400e+05],
        [4.0084e+05, 4.0089e+05, 4.0089e+05, 4.0086e+05, 7.8358e+05, 7.7979e+05,
         7.6835e+05, 4.0090e+05, 4.0090e+05, 8.0783e+05, 4.0088e+05, 4.0086e+05,
         4.0090e+05, 4.0087e+05, 7.4400e+05, 0.0000e+00]])
Krum scores: ['1.16', '1.13', '1.10', '1.17', '380639.97', '396357.28', '392241.59', '1.15', '1.35', '397709.69', '1.16', '1.19', '1.15', '1.13', '373695.59', '400872.75']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 9, 1, 3, 14, 13, 18, 6, 10, 16, 11, 7, 8, 2, 20, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:49...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:49, End: 2025-07-22 16:01:49)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 20, 2, 19, 14, 1, 4, 18, 6, 12, 15, 16, 9, 10, 7, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9841e+05, 9.9779e-01, 3.9479e+05, 3.8655e+05, 1.0098e+00,
         1.4820e+00, 3.9503e+05, 1.3720e+00, 8.8925e-01, 4.0142e+05, 4.0383e+05,
         1.0269e+00, 8.8612e-01, 1.5230e+00, 1.4222e+00],
        [3.9841e+05, 0.0000e+00, 3.9842e+05, 8.0852e+05, 7.9824e+05, 3.9841e+05,
         3.9841e+05, 7.9937e+05, 3.9841e+05, 3.9840e+05, 8.2161e+05, 7.9389e+05,
         3.9844e+05, 3.9840e+05, 3.9842e+05, 3.9840e+05],
        [9.9779e-01, 3.9842e+05, 0.0000e+00, 3.9480e+05, 3.8652e+05, 1.1161e+00,
         1.2888e+00, 3.9506e+05, 1.2444e+00, 9.1416e-01, 4.0143e+05, 4.0383e+05,
         9.9942e-01, 9.7461e-01, 1.2781e+00, 1.2288e+00],
        [3.9479e+05, 8.0852e+05, 3.9480e+05, 0.0000e+00, 7.9015e+05, 3.9479e+05,
         3.9477e+05, 7.7331e+05, 3.9476e+05, 3.9479e+05, 7.8190e+05, 8.0492e+05,
         3.9479e+05, 3.9479e+05, 3.9476e+05, 3.9474e+05],
        [3.8655e+05, 7.9824e+05, 3.8652e+05, 7.9015e+05, 0.0000e+00, 3.8654e+05,
         3.8652e+05, 7.7116e+05, 3.8652e+05, 3.8654e+05, 8.1239e+05, 8.0401e+05,
         3.8654e+05, 3.8654e+05, 3.8655e+05, 3.8653e+05],
        [1.0098e+00, 3.9841e+05, 1.1161e+00, 3.9479e+05, 3.8654e+05, 0.0000e+00,
         1.5287e+00, 3.9506e+05, 1.4506e+00, 1.0136e+00, 4.0143e+05, 4.0383e+05,
         1.1998e+00, 1.0129e+00, 1.5775e+00, 1.5080e+00],
        [1.4820e+00, 3.9841e+05, 1.2888e+00, 3.9477e+05, 3.8652e+05, 1.5287e+00,
         0.0000e+00, 3.9505e+05, 1.0433e+00, 1.3071e+00, 4.0143e+05, 4.0382e+05,
         1.2855e+00, 1.5312e+00, 1.1936e+00, 1.0927e+00],
        [3.9503e+05, 7.9937e+05, 3.9506e+05, 7.7331e+05, 7.7116e+05, 3.9506e+05,
         3.9505e+05, 0.0000e+00, 3.9504e+05, 3.9505e+05, 7.9424e+05, 8.1206e+05,
         3.9506e+05, 3.9505e+05, 3.9500e+05, 3.9503e+05],
        [1.3720e+00, 3.9841e+05, 1.2444e+00, 3.9476e+05, 3.8652e+05, 1.4506e+00,
         1.0433e+00, 3.9504e+05, 0.0000e+00, 1.2443e+00, 4.0144e+05, 4.0382e+05,
         1.2158e+00, 1.4121e+00, 1.1720e+00, 1.0509e+00],
        [8.8925e-01, 3.9840e+05, 9.1416e-01, 3.9479e+05, 3.8654e+05, 1.0136e+00,
         1.3071e+00, 3.9505e+05, 1.2443e+00, 0.0000e+00, 4.0142e+05, 4.0380e+05,
         9.6941e-01, 8.8266e-01, 1.3588e+00, 1.2397e+00],
        [4.0142e+05, 8.2161e+05, 4.0143e+05, 7.8190e+05, 8.1239e+05, 4.0143e+05,
         4.0143e+05, 7.9424e+05, 4.0144e+05, 4.0142e+05, 0.0000e+00, 7.9705e+05,
         4.0141e+05, 4.0143e+05, 4.0142e+05, 4.0142e+05],
        [4.0383e+05, 7.9389e+05, 4.0383e+05, 8.0492e+05, 8.0401e+05, 4.0383e+05,
         4.0382e+05, 8.1206e+05, 4.0382e+05, 4.0380e+05, 7.9705e+05, 0.0000e+00,
         4.0383e+05, 4.0381e+05, 4.0382e+05, 4.0381e+05],
        [1.0269e+00, 3.9844e+05, 9.9942e-01, 3.9479e+05, 3.8654e+05, 1.1998e+00,
         1.2855e+00, 3.9506e+05, 1.2158e+00, 9.6941e-01, 4.0141e+05, 4.0383e+05,
         0.0000e+00, 1.1127e+00, 1.3473e+00, 1.2155e+00],
        [8.8612e-01, 3.9840e+05, 9.7461e-01, 3.9479e+05, 3.8654e+05, 1.0129e+00,
         1.5312e+00, 3.9505e+05, 1.4121e+00, 8.8266e-01, 4.0143e+05, 4.0381e+05,
         1.1127e+00, 0.0000e+00, 1.4826e+00, 1.4171e+00],
        [1.5230e+00, 3.9842e+05, 1.2781e+00, 3.9476e+05, 3.8655e+05, 1.5775e+00,
         1.1936e+00, 3.9500e+05, 1.1720e+00, 1.3588e+00, 4.0142e+05, 4.0382e+05,
         1.3473e+00, 1.4826e+00, 0.0000e+00, 1.1985e+00],
        [1.4222e+00, 3.9840e+05, 1.2288e+00, 3.9474e+05, 3.8653e+05, 1.5080e+00,
         1.0927e+00, 3.9503e+05, 1.0509e+00, 1.2397e+00, 4.0142e+05, 4.0381e+05,
         1.2155e+00, 1.4171e+00, 1.1985e+00, 0.0000e+00]])
Krum scores: ['1.14', '398406.38', '1.09', '394774.81', '386531.09', '1.23', '1.28', '395039.38', '1.22', '1.06', '401421.88', '403817.38', '1.13', '1.15', '1.32', '1.23']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 20, 2, 19, 14, 1, 4, 18, 6, 12, 15, 16, 9, 10, 7, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:49...
global Accuracy on shared test data: 75.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:49, End: 2025-07-22 16:01:49)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 13, 9, 19, 8, 16, 18, 7, 3, 10, 5, 1, 6, 17, 20, 4], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8436e+05, 8.9344e-01, 3.9289e+05, 1.2796e+00, 4.0392e+05,
         3.8207e+05, 1.3175e+00, 1.2727e+00, 7.6674e-01, 8.3047e-01, 8.2157e-01,
         1.2106e+00, 4.0473e+05, 4.0012e+05, 1.3059e+00],
        [3.8436e+05, 0.0000e+00, 3.8436e+05, 7.9227e+05, 3.8433e+05, 7.7680e+05,
         7.7408e+05, 3.8432e+05, 3.8433e+05, 3.8435e+05, 3.8434e+05, 3.8435e+05,
         3.8433e+05, 7.9089e+05, 7.6629e+05, 3.8428e+05],
        [8.9344e-01, 3.8436e+05, 0.0000e+00, 3.9291e+05, 1.1310e+00, 4.0394e+05,
         3.8206e+05, 1.2351e+00, 1.1210e+00, 9.7138e-01, 9.8006e-01, 9.4466e-01,
         1.1368e+00, 4.0474e+05, 4.0010e+05, 1.1994e+00],
        [3.9289e+05, 7.9227e+05, 3.9291e+05, 0.0000e+00, 3.9288e+05, 8.0520e+05,
         7.7691e+05, 3.9288e+05, 3.9288e+05, 3.9286e+05, 3.9286e+05, 3.9287e+05,
         3.9288e+05, 8.0058e+05, 7.8350e+05, 3.9288e+05],
        [1.2796e+00, 3.8433e+05, 1.1310e+00, 3.9288e+05, 0.0000e+00, 4.0390e+05,
         3.8208e+05, 1.1092e+00, 1.1178e+00, 1.2528e+00, 1.1846e+00, 1.2151e+00,
         9.8271e-01, 4.0472e+05, 4.0011e+05, 1.0182e+00],
        [4.0392e+05, 7.7680e+05, 4.0394e+05, 8.0520e+05, 4.0390e+05, 0.0000e+00,
         7.7799e+05, 4.0392e+05, 4.0392e+05, 4.0392e+05, 4.0390e+05, 4.0392e+05,
         4.0393e+05, 8.0151e+05, 8.0941e+05, 4.0391e+05],
        [3.8207e+05, 7.7408e+05, 3.8206e+05, 7.7691e+05, 3.8208e+05, 7.7799e+05,
         0.0000e+00, 3.8207e+05, 3.8204e+05, 3.8205e+05, 3.8206e+05, 3.8207e+05,
         3.8209e+05, 7.7237e+05, 7.9551e+05, 3.8205e+05],
        [1.3175e+00, 3.8432e+05, 1.2351e+00, 3.9288e+05, 1.1092e+00, 4.0392e+05,
         3.8207e+05, 0.0000e+00, 1.1886e+00, 1.2953e+00, 1.2362e+00, 1.2478e+00,
         1.0962e+00, 4.0469e+05, 4.0010e+05, 1.1150e+00],
        [1.2727e+00, 3.8433e+05, 1.1210e+00, 3.9288e+05, 1.1178e+00, 4.0392e+05,
         3.8204e+05, 1.1886e+00, 0.0000e+00, 1.2071e+00, 1.1441e+00, 1.1890e+00,
         1.1445e+00, 4.0471e+05, 4.0010e+05, 1.1117e+00],
        [7.6674e-01, 3.8435e+05, 9.7138e-01, 3.9286e+05, 1.2528e+00, 4.0392e+05,
         3.8205e+05, 1.2953e+00, 1.2071e+00, 0.0000e+00, 9.1885e-01, 8.3507e-01,
         1.2534e+00, 4.0472e+05, 4.0011e+05, 1.3599e+00],
        [8.3047e-01, 3.8434e+05, 9.8006e-01, 3.9286e+05, 1.1846e+00, 4.0390e+05,
         3.8206e+05, 1.2362e+00, 1.1441e+00, 9.1885e-01, 0.0000e+00, 9.2615e-01,
         1.1925e+00, 4.0469e+05, 4.0012e+05, 1.1705e+00],
        [8.2157e-01, 3.8435e+05, 9.4466e-01, 3.9287e+05, 1.2151e+00, 4.0392e+05,
         3.8207e+05, 1.2478e+00, 1.1890e+00, 8.3507e-01, 9.2615e-01, 0.0000e+00,
         1.1648e+00, 4.0476e+05, 4.0010e+05, 1.2239e+00],
        [1.2106e+00, 3.8433e+05, 1.1368e+00, 3.9288e+05, 9.8271e-01, 4.0393e+05,
         3.8209e+05, 1.0962e+00, 1.1445e+00, 1.2534e+00, 1.1925e+00, 1.1648e+00,
         0.0000e+00, 4.0470e+05, 4.0010e+05, 9.6243e-01],
        [4.0473e+05, 7.9089e+05, 4.0474e+05, 8.0058e+05, 4.0472e+05, 8.0151e+05,
         7.7237e+05, 4.0469e+05, 4.0471e+05, 4.0472e+05, 4.0469e+05, 4.0476e+05,
         4.0470e+05, 0.0000e+00, 8.0873e+05, 4.0474e+05],
        [4.0012e+05, 7.6629e+05, 4.0010e+05, 7.8350e+05, 4.0011e+05, 8.0941e+05,
         7.9551e+05, 4.0010e+05, 4.0010e+05, 4.0011e+05, 4.0012e+05, 4.0010e+05,
         4.0010e+05, 8.0873e+05, 0.0000e+00, 4.0012e+05],
        [1.3059e+00, 3.8428e+05, 1.1994e+00, 3.9288e+05, 1.0182e+00, 4.0391e+05,
         3.8205e+05, 1.1150e+00, 1.1117e+00, 1.3599e+00, 1.1705e+00, 1.2239e+00,
         9.6243e-01, 4.0474e+05, 4.0012e+05, 0.0000e+00]])
Krum scores: ['1.05', '384328.06', '1.05', '392875.25', '1.13', '403915.06', '382059.62', '1.19', '1.15', '1.06', '1.04', '1.04', '1.11', '404711.91', '400104.91', '1.14']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 13, 9, 19, 8, 16, 18, 7, 3, 10, 5, 1, 6, 17, 20, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0074s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:50...
global Accuracy on shared test data: 73.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:50, End: 2025-07-22 16:01:50)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 14, 13, 18, 10, 4, 3, 11, 7, 9, 17, 2, 8, 16, 12, 20], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9285e+05, 3.8205e+05, 3.8037e+05, 9.1041e-01, 1.6240e+00,
         1.5285e+00, 9.0669e-01, 1.6849e+00, 1.1827e+00, 3.9933e+05, 1.1143e+00,
         1.6012e+00, 3.9116e+05, 7.3591e-01, 3.9848e+05],
        [3.9285e+05, 0.0000e+00, 7.8112e+05, 7.6558e+05, 3.9287e+05, 3.9286e+05,
         3.9284e+05, 3.9285e+05, 3.9285e+05, 3.9285e+05, 7.8763e+05, 3.9287e+05,
         3.9286e+05, 7.9051e+05, 3.9284e+05, 7.8685e+05],
        [3.8205e+05, 7.8112e+05, 0.0000e+00, 7.5824e+05, 3.8208e+05, 3.8206e+05,
         3.8207e+05, 3.8207e+05, 3.8204e+05, 3.8205e+05, 7.7616e+05, 3.8207e+05,
         3.8204e+05, 7.7670e+05, 3.8205e+05, 7.7441e+05],
        [3.8037e+05, 7.6558e+05, 7.5824e+05, 0.0000e+00, 3.8037e+05, 3.8038e+05,
         3.8041e+05, 3.8038e+05, 3.8039e+05, 3.8039e+05, 7.8211e+05, 3.8037e+05,
         3.8042e+05, 7.7590e+05, 3.8037e+05, 7.7722e+05],
        [9.1041e-01, 3.9287e+05, 3.8208e+05, 3.8037e+05, 0.0000e+00, 1.2495e+00,
         1.1193e+00, 7.7511e-01, 1.2248e+00, 9.3374e-01, 3.9934e+05, 8.3468e-01,
         1.1767e+00, 3.9116e+05, 7.0100e-01, 3.9847e+05],
        [1.6240e+00, 3.9286e+05, 3.8206e+05, 3.8038e+05, 1.2495e+00, 0.0000e+00,
         1.0205e+00, 1.2141e+00, 1.0632e+00, 1.0832e+00, 3.9932e+05, 1.0314e+00,
         9.5916e-01, 3.9115e+05, 1.3261e+00, 3.9850e+05],
        [1.5285e+00, 3.9284e+05, 3.8207e+05, 3.8041e+05, 1.1193e+00, 1.0205e+00,
         0.0000e+00, 1.1759e+00, 1.1275e+00, 1.0131e+00, 3.9934e+05, 1.0099e+00,
         1.0205e+00, 3.9115e+05, 1.1973e+00, 3.9849e+05],
        [9.0669e-01, 3.9285e+05, 3.8207e+05, 3.8038e+05, 7.7511e-01, 1.2141e+00,
         1.1759e+00, 0.0000e+00, 1.2558e+00, 8.8841e-01, 3.9936e+05, 8.7749e-01,
         1.2021e+00, 3.9114e+05, 7.6207e-01, 3.9848e+05],
        [1.6849e+00, 3.9285e+05, 3.8204e+05, 3.8039e+05, 1.2248e+00, 1.0632e+00,
         1.1275e+00, 1.2558e+00, 0.0000e+00, 1.1650e+00, 3.9933e+05, 1.0575e+00,
         1.0763e+00, 3.9112e+05, 1.3971e+00, 3.9850e+05],
        [1.1827e+00, 3.9285e+05, 3.8205e+05, 3.8039e+05, 9.3374e-01, 1.0832e+00,
         1.0131e+00, 8.8841e-01, 1.1650e+00, 0.0000e+00, 3.9935e+05, 8.4604e-01,
         1.0479e+00, 3.9115e+05, 9.1014e-01, 3.9847e+05],
        [3.9933e+05, 7.8763e+05, 7.7616e+05, 7.8211e+05, 3.9934e+05, 3.9932e+05,
         3.9934e+05, 3.9936e+05, 3.9933e+05, 3.9935e+05, 0.0000e+00, 3.9933e+05,
         3.9934e+05, 7.9536e+05, 3.9935e+05, 7.9011e+05],
        [1.1143e+00, 3.9287e+05, 3.8207e+05, 3.8037e+05, 8.3468e-01, 1.0314e+00,
         1.0099e+00, 8.7749e-01, 1.0575e+00, 8.4604e-01, 3.9933e+05, 0.0000e+00,
         1.0127e+00, 3.9114e+05, 8.7184e-01, 3.9847e+05],
        [1.6012e+00, 3.9286e+05, 3.8204e+05, 3.8042e+05, 1.1767e+00, 9.5916e-01,
         1.0205e+00, 1.2021e+00, 1.0763e+00, 1.0479e+00, 3.9934e+05, 1.0127e+00,
         0.0000e+00, 3.9114e+05, 1.2612e+00, 3.9851e+05],
        [3.9116e+05, 7.9051e+05, 7.7670e+05, 7.7590e+05, 3.9116e+05, 3.9115e+05,
         3.9115e+05, 3.9114e+05, 3.9112e+05, 3.9115e+05, 7.9536e+05, 3.9114e+05,
         3.9114e+05, 0.0000e+00, 3.9115e+05, 7.9955e+05],
        [7.3591e-01, 3.9284e+05, 3.8205e+05, 3.8037e+05, 7.0100e-01, 1.3261e+00,
         1.1973e+00, 7.6207e-01, 1.3971e+00, 9.1014e-01, 3.9935e+05, 8.7184e-01,
         1.2612e+00, 3.9115e+05, 0.0000e+00, 3.9847e+05],
        [3.9848e+05, 7.8685e+05, 7.7441e+05, 7.7722e+05, 3.9847e+05, 3.9850e+05,
         3.9849e+05, 3.9848e+05, 3.9850e+05, 3.9847e+05, 7.9011e+05, 3.9847e+05,
         3.9851e+05, 7.9955e+05, 3.9847e+05, 0.0000e+00]])
Krum scores: ['1.20', '392850.47', '382053.62', '380377.06', '0.96', '1.12', '1.09', '0.98', '1.17', '0.99', '399334.88', '0.94', '1.09', '391143.22', '0.97', '398477.56']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 14, 13, 18, 10, 4, 3, 11, 7, 9, 17, 2, 8, 16, 12, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:50...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 72 191]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:50, End: 2025-07-22 16:01:50)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 15, 4, 11, 12, 16, 7, 5, 8, 10, 1, 18, 2, 17, 9, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 8.0934e+05, 3.9766e+05, 3.9767e+05, 3.9767e+05, 7.7204e+05,
         3.9768e+05, 3.9766e+05, 3.9767e+05, 3.9766e+05, 3.9763e+05, 8.0299e+05,
         3.9765e+05, 7.8525e+05, 3.9767e+05, 3.9767e+05],
        [8.0934e+05, 0.0000e+00, 3.9187e+05, 3.9189e+05, 3.9189e+05, 7.8134e+05,
         3.9187e+05, 3.9189e+05, 3.9187e+05, 3.9190e+05, 3.9188e+05, 7.6556e+05,
         3.9190e+05, 7.9772e+05, 3.9187e+05, 3.9187e+05],
        [3.9766e+05, 3.9187e+05, 0.0000e+00, 1.1903e+00, 1.3616e+00, 3.8765e+05,
         1.0627e+00, 1.0787e+00, 9.5275e-01, 1.2655e+00, 1.3781e+00, 3.9931e+05,
         1.5593e+00, 3.9449e+05, 1.1200e+00, 9.6716e-01],
        [3.9767e+05, 3.9189e+05, 1.1903e+00, 0.0000e+00, 8.0092e-01, 3.8766e+05,
         1.2041e+00, 8.3396e-01, 1.2002e+00, 7.9506e-01, 7.6873e-01, 3.9928e+05,
         9.3284e-01, 3.9447e+05, 8.9499e-01, 1.1867e+00],
        [3.9767e+05, 3.9189e+05, 1.3616e+00, 8.0092e-01, 0.0000e+00, 3.8766e+05,
         1.4125e+00, 9.4619e-01, 1.3326e+00, 7.6909e-01, 7.2668e-01, 3.9928e+05,
         8.7454e-01, 3.9449e+05, 9.8166e-01, 1.4081e+00],
        [7.7204e+05, 7.8134e+05, 3.8765e+05, 3.8766e+05, 3.8766e+05, 0.0000e+00,
         3.8764e+05, 3.8766e+05, 3.8766e+05, 3.8767e+05, 3.8764e+05, 7.8751e+05,
         3.8768e+05, 7.8718e+05, 3.8765e+05, 3.8766e+05],
        [3.9768e+05, 3.9187e+05, 1.0627e+00, 1.2041e+00, 1.4125e+00, 3.8764e+05,
         0.0000e+00, 1.1625e+00, 1.0740e+00, 1.2113e+00, 1.4266e+00, 3.9930e+05,
         1.5434e+00, 3.9448e+05, 1.1794e+00, 1.0576e+00],
        [3.9766e+05, 3.9189e+05, 1.0787e+00, 8.3396e-01, 9.4619e-01, 3.8766e+05,
         1.1625e+00, 0.0000e+00, 1.1529e+00, 9.2050e-01, 9.3589e-01, 3.9929e+05,
         1.1318e+00, 3.9446e+05, 9.8210e-01, 1.1803e+00],
        [3.9767e+05, 3.9187e+05, 9.5275e-01, 1.2002e+00, 1.3326e+00, 3.8766e+05,
         1.0740e+00, 1.1529e+00, 0.0000e+00, 1.1990e+00, 1.4173e+00, 3.9932e+05,
         1.5450e+00, 3.9447e+05, 1.1093e+00, 9.8690e-01],
        [3.9766e+05, 3.9190e+05, 1.2655e+00, 7.9506e-01, 7.6909e-01, 3.8767e+05,
         1.2113e+00, 9.2050e-01, 1.1990e+00, 0.0000e+00, 8.2065e-01, 3.9926e+05,
         9.3903e-01, 3.9449e+05, 9.8258e-01, 1.2334e+00],
        [3.9763e+05, 3.9188e+05, 1.3781e+00, 7.6873e-01, 7.2668e-01, 3.8764e+05,
         1.4266e+00, 9.3589e-01, 1.4173e+00, 8.2065e-01, 0.0000e+00, 3.9928e+05,
         8.6145e-01, 3.9449e+05, 1.0288e+00, 1.4136e+00],
        [8.0299e+05, 7.6556e+05, 3.9931e+05, 3.9928e+05, 3.9928e+05, 7.8751e+05,
         3.9930e+05, 3.9929e+05, 3.9932e+05, 3.9926e+05, 3.9928e+05, 0.0000e+00,
         3.9926e+05, 7.7456e+05, 3.9929e+05, 3.9931e+05],
        [3.9765e+05, 3.9190e+05, 1.5593e+00, 9.3284e-01, 8.7454e-01, 3.8768e+05,
         1.5434e+00, 1.1318e+00, 1.5450e+00, 9.3903e-01, 8.6145e-01, 3.9926e+05,
         0.0000e+00, 3.9451e+05, 1.1283e+00, 1.6209e+00],
        [7.8525e+05, 7.9772e+05, 3.9449e+05, 3.9447e+05, 3.9449e+05, 7.8718e+05,
         3.9448e+05, 3.9446e+05, 3.9447e+05, 3.9449e+05, 3.9449e+05, 7.7456e+05,
         3.9451e+05, 0.0000e+00, 3.9448e+05, 3.9447e+05],
        [3.9767e+05, 3.9187e+05, 1.1200e+00, 8.9499e-01, 9.8166e-01, 3.8765e+05,
         1.1794e+00, 9.8210e-01, 1.1093e+00, 9.8258e-01, 1.0288e+00, 3.9929e+05,
         1.1283e+00, 3.9448e+05, 0.0000e+00, 1.1562e+00],
        [3.9767e+05, 3.9187e+05, 9.6716e-01, 1.1867e+00, 1.4081e+00, 3.8766e+05,
         1.0576e+00, 1.1803e+00, 9.8690e-01, 1.2334e+00, 1.4136e+00, 3.9931e+05,
         1.6209e+00, 3.9447e+05, 1.1562e+00, 0.0000e+00]])
Krum scores: ['397660.69', '391878.66', '1.15', '0.96', '1.02', '387652.53', '1.20', '1.02', '1.16', '0.99', '1.04', '399283.16', '1.17', '394479.09', '1.04', '1.18']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 15, 4, 11, 12, 16, 7, 5, 8, 10, 1, 18, 2, 17, 9, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0055s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:51...
global Accuracy on shared test data: 73.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:51, End: 2025-07-22 16:01:51)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 8, 4, 10, 15, 13, 16, 20, 1, 17, 19, 11, 7, 2, 18, 9], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1885e+00, 1.1861e+00, 6.9618e-01, 3.8526e+05, 3.8653e+05,
         3.9926e+05, 3.7703e+05, 6.1403e-01, 3.7788e+05, 3.8673e+05, 7.1338e-01,
         1.2209e+00, 6.5634e-01, 3.8584e+05, 8.1379e-01],
        [1.1885e+00, 0.0000e+00, 9.1292e-01, 1.1393e+00, 3.8529e+05, 3.8650e+05,
         3.9924e+05, 3.7700e+05, 1.2634e+00, 3.7793e+05, 3.8671e+05, 1.6494e+00,
         1.0226e+00, 1.1636e+00, 3.8582e+05, 1.0231e+00],
        [1.1861e+00, 9.1292e-01, 0.0000e+00, 1.1844e+00, 3.8527e+05, 3.8653e+05,
         3.9925e+05, 3.7702e+05, 1.2518e+00, 3.7789e+05, 3.8670e+05, 1.6429e+00,
         9.9071e-01, 1.1808e+00, 3.8584e+05, 1.0227e+00],
        [6.9618e-01, 1.1393e+00, 1.1844e+00, 0.0000e+00, 3.8526e+05, 3.8650e+05,
         3.9924e+05, 3.7705e+05, 7.6255e-01, 3.7788e+05, 3.8671e+05, 9.0995e-01,
         1.1106e+00, 7.9585e-01, 3.8582e+05, 8.9680e-01],
        [3.8526e+05, 3.8529e+05, 3.8527e+05, 3.8526e+05, 0.0000e+00, 7.7418e+05,
         7.9657e+05, 7.6447e+05, 3.8524e+05, 7.8544e+05, 7.6538e+05, 3.8525e+05,
         3.8527e+05, 3.8523e+05, 7.8101e+05, 3.8525e+05],
        [3.8653e+05, 3.8650e+05, 3.8653e+05, 3.8650e+05, 7.7418e+05, 0.0000e+00,
         8.0664e+05, 7.5809e+05, 3.8653e+05, 7.6108e+05, 7.6312e+05, 3.8654e+05,
         3.8652e+05, 3.8650e+05, 7.5958e+05, 3.8652e+05],
        [3.9926e+05, 3.9924e+05, 3.9925e+05, 3.9924e+05, 7.9657e+05, 8.0664e+05,
         0.0000e+00, 7.9004e+05, 3.9927e+05, 7.7025e+05, 7.7852e+05, 3.9926e+05,
         3.9926e+05, 3.9922e+05, 7.6273e+05, 3.9927e+05],
        [3.7703e+05, 3.7700e+05, 3.7702e+05, 3.7705e+05, 7.6447e+05, 7.5809e+05,
         7.9004e+05, 0.0000e+00, 3.7701e+05, 7.5492e+05, 7.6672e+05, 3.7702e+05,
         3.7699e+05, 3.7704e+05, 7.6537e+05, 3.7701e+05],
        [6.1403e-01, 1.2634e+00, 1.2518e+00, 7.6255e-01, 3.8524e+05, 3.8653e+05,
         3.9927e+05, 3.7701e+05, 0.0000e+00, 3.7789e+05, 3.8672e+05, 7.4228e-01,
         1.2682e+00, 7.1962e-01, 3.8582e+05, 8.8339e-01],
        [3.7788e+05, 3.7793e+05, 3.7789e+05, 3.7788e+05, 7.8544e+05, 7.6108e+05,
         7.7025e+05, 7.5492e+05, 3.7789e+05, 0.0000e+00, 7.5409e+05, 3.7786e+05,
         3.7788e+05, 3.7789e+05, 7.7347e+05, 3.7786e+05],
        [3.8673e+05, 3.8671e+05, 3.8670e+05, 3.8671e+05, 7.6538e+05, 7.6312e+05,
         7.7852e+05, 7.6672e+05, 3.8672e+05, 7.5409e+05, 0.0000e+00, 3.8671e+05,
         3.8670e+05, 3.8670e+05, 7.6317e+05, 3.8669e+05],
        [7.1338e-01, 1.6494e+00, 1.6429e+00, 9.0995e-01, 3.8525e+05, 3.8654e+05,
         3.9926e+05, 3.7702e+05, 7.4228e-01, 3.7786e+05, 3.8671e+05, 0.0000e+00,
         1.6305e+00, 8.2808e-01, 3.8582e+05, 1.0646e+00],
        [1.2209e+00, 1.0226e+00, 9.9071e-01, 1.1106e+00, 3.8527e+05, 3.8652e+05,
         3.9926e+05, 3.7699e+05, 1.2682e+00, 3.7788e+05, 3.8670e+05, 1.6305e+00,
         0.0000e+00, 1.1763e+00, 3.8584e+05, 1.0614e+00],
        [6.5634e-01, 1.1636e+00, 1.1808e+00, 7.9585e-01, 3.8523e+05, 3.8650e+05,
         3.9922e+05, 3.7704e+05, 7.1962e-01, 3.7789e+05, 3.8670e+05, 8.2808e-01,
         1.1763e+00, 0.0000e+00, 3.8583e+05, 8.3628e-01],
        [3.8584e+05, 3.8582e+05, 3.8584e+05, 3.8582e+05, 7.8101e+05, 7.5958e+05,
         7.6273e+05, 7.6537e+05, 3.8582e+05, 7.7347e+05, 7.6317e+05, 3.8582e+05,
         3.8584e+05, 3.8583e+05, 0.0000e+00, 3.8582e+05],
        [8.1379e-01, 1.0231e+00, 1.0227e+00, 8.9680e-01, 3.8525e+05, 3.8652e+05,
         3.9927e+05, 3.7701e+05, 8.8339e-01, 3.7786e+05, 3.8669e+05, 1.0646e+00,
         1.0614e+00, 8.3628e-01, 3.8582e+05, 0.0000e+00]])
Krum scores: ['0.84', '1.10', '1.10', '0.90', '385252.00', '386513.22', '399246.97', '377011.56', '0.89', '377876.31', '386703.78', '1.08', '1.12', '0.88', '385823.75', '0.93']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 8, 4, 10, 15, 13, 16, 20, 1, 17, 19, 11, 7, 2, 18, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0166s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:52...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 81 182]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:52, End: 2025-07-22 16:01:52)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 15, 18, 20, 3, 1, 9, 13, 17, 10, 5, 2, 7, 19, 11, 14], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9744e+05, 3.7681e+05, 3.9926e+05, 9.1083e-01, 1.1271e+00,
         9.6904e-01, 3.9416e+05, 4.0785e+05, 1.0749e+00, 9.2008e-01, 1.0806e+00,
         9.7594e-01, 3.9777e+05, 1.2279e+00, 3.8223e+05],
        [3.9744e+05, 0.0000e+00, 7.6453e+05, 7.7575e+05, 3.9747e+05, 3.9748e+05,
         3.9744e+05, 7.9034e+05, 8.1629e+05, 3.9746e+05, 3.9749e+05, 3.9748e+05,
         3.9746e+05, 7.8638e+05, 3.9747e+05, 7.8041e+05],
        [3.7681e+05, 7.6453e+05, 0.0000e+00, 7.7327e+05, 3.7682e+05, 3.7681e+05,
         3.7681e+05, 7.6974e+05, 7.7512e+05, 3.7682e+05, 3.7682e+05, 3.7684e+05,
         3.7682e+05, 7.8209e+05, 3.7679e+05, 7.6452e+05],
        [3.9926e+05, 7.7575e+05, 7.7327e+05, 0.0000e+00, 3.9924e+05, 3.9922e+05,
         3.9924e+05, 7.9666e+05, 7.9138e+05, 3.9922e+05, 3.9922e+05, 3.9924e+05,
         3.9926e+05, 8.2652e+05, 3.9921e+05, 7.8507e+05],
        [9.1083e-01, 3.9747e+05, 3.7682e+05, 3.9924e+05, 0.0000e+00, 1.0692e+00,
         9.1153e-01, 3.9417e+05, 4.0787e+05, 9.4886e-01, 8.9906e-01, 1.0503e+00,
         1.0277e+00, 3.9776e+05, 1.1669e+00, 3.8222e+05],
        [1.1271e+00, 3.9748e+05, 3.7681e+05, 3.9922e+05, 1.0692e+00, 0.0000e+00,
         8.4516e-01, 3.9415e+05, 4.0785e+05, 7.0225e-01, 7.8759e-01, 6.8486e-01,
         1.1926e+00, 3.9775e+05, 5.5824e-01, 3.8222e+05],
        [9.6904e-01, 3.9744e+05, 3.7681e+05, 3.9924e+05, 9.1153e-01, 8.4516e-01,
         0.0000e+00, 3.9416e+05, 4.0785e+05, 8.4838e-01, 8.3982e-01, 8.1587e-01,
         1.0370e+00, 3.9778e+05, 8.3810e-01, 3.8223e+05],
        [3.9416e+05, 7.9034e+05, 7.6974e+05, 7.9666e+05, 3.9417e+05, 3.9415e+05,
         3.9416e+05, 0.0000e+00, 8.2005e+05, 3.9416e+05, 3.9414e+05, 3.9415e+05,
         3.9417e+05, 7.9657e+05, 3.9415e+05, 7.5584e+05],
        [4.0785e+05, 8.1629e+05, 7.7512e+05, 7.9138e+05, 4.0787e+05, 4.0785e+05,
         4.0785e+05, 8.2005e+05, 0.0000e+00, 4.0785e+05, 4.0784e+05, 4.0786e+05,
         4.0786e+05, 8.0412e+05, 4.0784e+05, 7.7578e+05],
        [1.0749e+00, 3.9746e+05, 3.7682e+05, 3.9922e+05, 9.4886e-01, 7.0225e-01,
         8.4838e-01, 3.9416e+05, 4.0785e+05, 0.0000e+00, 7.8529e-01, 7.1125e-01,
         1.0443e+00, 3.9778e+05, 6.6856e-01, 3.8221e+05],
        [9.2008e-01, 3.9749e+05, 3.7682e+05, 3.9922e+05, 8.9906e-01, 7.8759e-01,
         8.3982e-01, 3.9414e+05, 4.0784e+05, 7.8529e-01, 0.0000e+00, 8.0173e-01,
         1.0158e+00, 3.9777e+05, 7.5757e-01, 3.8222e+05],
        [1.0806e+00, 3.9748e+05, 3.7684e+05, 3.9924e+05, 1.0503e+00, 6.8486e-01,
         8.1587e-01, 3.9415e+05, 4.0786e+05, 7.1125e-01, 8.0173e-01, 0.0000e+00,
         1.1167e+00, 3.9776e+05, 6.2755e-01, 3.8224e+05],
        [9.7594e-01, 3.9746e+05, 3.7682e+05, 3.9926e+05, 1.0277e+00, 1.1926e+00,
         1.0370e+00, 3.9417e+05, 4.0786e+05, 1.0443e+00, 1.0158e+00, 1.1167e+00,
         0.0000e+00, 3.9776e+05, 1.2520e+00, 3.8222e+05],
        [3.9777e+05, 7.8638e+05, 7.8209e+05, 8.2652e+05, 3.9776e+05, 3.9775e+05,
         3.9778e+05, 7.9657e+05, 8.0412e+05, 3.9778e+05, 3.9777e+05, 3.9776e+05,
         3.9776e+05, 0.0000e+00, 3.9777e+05, 7.6532e+05],
        [1.2279e+00, 3.9747e+05, 3.7679e+05, 3.9921e+05, 1.1669e+00, 5.5824e-01,
         8.3810e-01, 3.9415e+05, 4.0784e+05, 6.6856e-01, 7.5757e-01, 6.2755e-01,
         1.2520e+00, 3.9777e+05, 0.0000e+00, 3.8223e+05],
        [3.8223e+05, 7.8041e+05, 7.6452e+05, 7.8507e+05, 3.8222e+05, 3.8222e+05,
         3.8223e+05, 7.5584e+05, 7.7578e+05, 3.8221e+05, 3.8222e+05, 3.8224e+05,
         3.8222e+05, 7.6532e+05, 3.8223e+05, 0.0000e+00]])
Krum scores: ['1.01', '397460.22', '376811.78', '399226.97', '0.97', '0.82', '0.87', '394152.31', '407848.19', '0.82', '0.83', '0.82', '1.06', '397762.50', '0.83', '382221.22']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 15, 18, 20, 3, 1, 9, 13, 17, 10, 5, 2, 7, 19, 11, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0230s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:52...
global Accuracy on shared test data: 70.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 84 179]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:52, End: 2025-07-22 16:01:52)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 1, 4, 18, 12, 9, 16, 2, 6, 14, 8, 10, 13, 17, 5, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0859e+00, 9.1209e-01, 3.8538e+05, 1.2152e+00, 8.8592e-01,
         3.9411e+05, 1.0338e+00, 9.4995e-01, 3.9830e+05, 9.2963e-01, 1.3513e+00,
         3.9780e+05, 3.7674e+05, 9.1350e-01, 3.8913e+05],
        [1.0859e+00, 0.0000e+00, 1.1019e+00, 3.8541e+05, 5.9864e-01, 8.7716e-01,
         3.9412e+05, 7.1038e-01, 1.1162e+00, 3.9827e+05, 1.1290e+00, 7.3115e-01,
         3.9779e+05, 3.7677e+05, 7.7722e-01, 3.8911e+05],
        [9.1209e-01, 1.1019e+00, 0.0000e+00, 3.8540e+05, 1.2973e+00, 9.3004e-01,
         3.9410e+05, 1.0257e+00, 8.3238e-01, 3.9830e+05, 8.5125e-01, 1.4637e+00,
         3.9776e+05, 3.7679e+05, 9.0971e-01, 3.8911e+05],
        [3.8538e+05, 3.8541e+05, 3.8540e+05, 0.0000e+00, 3.8540e+05, 3.8539e+05,
         7.7755e+05, 3.8538e+05, 3.8540e+05, 8.2050e+05, 3.8541e+05, 3.8541e+05,
         7.9447e+05, 7.6730e+05, 3.8539e+05, 7.7700e+05],
        [1.2152e+00, 5.9864e-01, 1.2973e+00, 3.8540e+05, 0.0000e+00, 9.3657e-01,
         3.9412e+05, 6.8367e-01, 1.2930e+00, 3.9827e+05, 1.2836e+00, 5.4190e-01,
         3.9777e+05, 3.7676e+05, 8.1347e-01, 3.8915e+05],
        [8.8592e-01, 8.7716e-01, 9.3004e-01, 3.8539e+05, 9.3657e-01, 0.0000e+00,
         3.9413e+05, 8.0935e-01, 9.2166e-01, 3.9828e+05, 9.2352e-01, 1.1066e+00,
         3.9778e+05, 3.7676e+05, 8.0821e-01, 3.8914e+05],
        [3.9411e+05, 3.9412e+05, 3.9410e+05, 7.7755e+05, 3.9412e+05, 3.9413e+05,
         0.0000e+00, 3.9410e+05, 3.9409e+05, 7.6350e+05, 3.9412e+05, 3.9410e+05,
         7.7347e+05, 7.7981e+05, 3.9412e+05, 7.7922e+05],
        [1.0338e+00, 7.1038e-01, 1.0257e+00, 3.8538e+05, 6.8367e-01, 8.0935e-01,
         3.9410e+05, 0.0000e+00, 1.0501e+00, 3.9826e+05, 1.0196e+00, 8.1597e-01,
         3.9780e+05, 3.7678e+05, 7.6582e-01, 3.8913e+05],
        [9.4995e-01, 1.1162e+00, 8.3238e-01, 3.8540e+05, 1.2930e+00, 9.2166e-01,
         3.9409e+05, 1.0501e+00, 0.0000e+00, 3.9828e+05, 8.9235e-01, 1.4596e+00,
         3.9778e+05, 3.7677e+05, 9.7812e-01, 3.8914e+05],
        [3.9830e+05, 3.9827e+05, 3.9830e+05, 8.2050e+05, 3.9827e+05, 3.9828e+05,
         7.6350e+05, 3.9826e+05, 3.9828e+05, 0.0000e+00, 3.9828e+05, 3.9825e+05,
         7.8798e+05, 7.8242e+05, 3.9825e+05, 8.0814e+05],
        [9.2963e-01, 1.1290e+00, 8.5125e-01, 3.8541e+05, 1.2836e+00, 9.2352e-01,
         3.9412e+05, 1.0196e+00, 8.9235e-01, 3.9828e+05, 0.0000e+00, 1.4469e+00,
         3.9777e+05, 3.7678e+05, 9.6993e-01, 3.8913e+05],
        [1.3513e+00, 7.3115e-01, 1.4637e+00, 3.8541e+05, 5.4190e-01, 1.1066e+00,
         3.9410e+05, 8.1597e-01, 1.4596e+00, 3.9825e+05, 1.4469e+00, 0.0000e+00,
         3.9777e+05, 3.7679e+05, 9.4851e-01, 3.8912e+05],
        [3.9780e+05, 3.9779e+05, 3.9776e+05, 7.9447e+05, 3.9777e+05, 3.9778e+05,
         7.7347e+05, 3.9780e+05, 3.9778e+05, 7.8798e+05, 3.9777e+05, 3.9777e+05,
         0.0000e+00, 7.7235e+05, 3.9777e+05, 7.9806e+05],
        [3.7674e+05, 3.7677e+05, 3.7679e+05, 7.6730e+05, 3.7676e+05, 3.7676e+05,
         7.7981e+05, 3.7678e+05, 3.7677e+05, 7.8242e+05, 3.7678e+05, 3.7679e+05,
         7.7235e+05, 0.0000e+00, 3.7676e+05, 7.5778e+05],
        [9.1350e-01, 7.7722e-01, 9.0971e-01, 3.8539e+05, 8.1347e-01, 8.0821e-01,
         3.9412e+05, 7.6582e-01, 9.7812e-01, 3.9825e+05, 9.6993e-01, 9.4851e-01,
         3.9777e+05, 3.7676e+05, 0.0000e+00, 3.8912e+05],
        [3.8913e+05, 3.8911e+05, 3.8911e+05, 7.7700e+05, 3.8915e+05, 3.8914e+05,
         7.7922e+05, 3.8913e+05, 3.8914e+05, 8.0814e+05, 3.8913e+05, 3.8912e+05,
         7.9806e+05, 7.5778e+05, 3.8912e+05, 0.0000e+00]])
Krum scores: ['0.99', '0.87', '0.98', '385394.78', '0.92', '0.89', '394107.50', '0.86', '1.00', '398268.25', '1.00', '1.05', '397772.22', '376765.81', '0.86', '389125.28']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 1, 4, 18, 12, 9, 16, 2, 6, 14, 8, 10, 13, 17, 5, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:53...
global Accuracy on shared test data: 71.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 83 180]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:53, End: 2025-07-22 16:01:53)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 15, 11, 19, 8, 13, 9, 12, 17, 10, 4, 2, 14, 6, 16, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8366e+05, 5.7217e-01, 3.9274e+05, 1.0972e+00, 3.8674e+05,
         8.1154e-01, 6.0573e-01, 3.8103e+05, 6.3115e-01, 1.1093e+00, 7.8821e-01,
         4.0090e+05, 1.1173e+00, 3.7392e+05, 3.9128e+05],
        [3.8366e+05, 0.0000e+00, 3.8364e+05, 7.8304e+05, 3.8364e+05, 7.9127e+05,
         3.8365e+05, 3.8366e+05, 7.6921e+05, 3.8365e+05, 3.8367e+05, 3.8364e+05,
         7.8425e+05, 3.8365e+05, 7.5809e+05, 7.7110e+05],
        [5.7217e-01, 3.8364e+05, 0.0000e+00, 3.9275e+05, 1.1460e+00, 3.8674e+05,
         7.9087e-01, 5.2497e-01, 3.8105e+05, 5.4790e-01, 1.1701e+00, 6.6280e-01,
         4.0091e+05, 1.1706e+00, 3.7390e+05, 3.9129e+05],
        [3.9274e+05, 7.8304e+05, 3.9275e+05, 0.0000e+00, 3.9275e+05, 7.7152e+05,
         3.9275e+05, 3.9274e+05, 7.5427e+05, 3.9275e+05, 3.9273e+05, 3.9272e+05,
         7.8368e+05, 3.9274e+05, 7.6085e+05, 7.8807e+05],
        [1.0972e+00, 3.8364e+05, 1.1460e+00, 3.9275e+05, 0.0000e+00, 3.8673e+05,
         8.9742e-01, 1.2419e+00, 3.8102e+05, 1.2325e+00, 8.5259e-01, 1.4773e+00,
         4.0090e+05, 8.8128e-01, 3.7392e+05, 3.9129e+05],
        [3.8674e+05, 7.9127e+05, 3.8674e+05, 7.7152e+05, 3.8673e+05, 0.0000e+00,
         3.8676e+05, 3.8675e+05, 7.7160e+05, 3.8674e+05, 3.8675e+05, 3.8676e+05,
         7.8667e+05, 3.8678e+05, 7.4900e+05, 7.9335e+05],
        [8.1154e-01, 3.8365e+05, 7.9087e-01, 3.9275e+05, 8.9742e-01, 3.8676e+05,
         0.0000e+00, 8.7865e-01, 3.8102e+05, 9.0198e-01, 9.3232e-01, 1.0912e+00,
         4.0091e+05, 9.3269e-01, 3.7394e+05, 3.9128e+05],
        [6.0573e-01, 3.8366e+05, 5.2497e-01, 3.9274e+05, 1.2419e+00, 3.8675e+05,
         8.7865e-01, 0.0000e+00, 3.8103e+05, 5.0483e-01, 1.3027e+00, 6.0947e-01,
         4.0092e+05, 1.3261e+00, 3.7394e+05, 3.9132e+05],
        [3.8103e+05, 7.6921e+05, 3.8105e+05, 7.5427e+05, 3.8102e+05, 7.7160e+05,
         3.8102e+05, 3.8103e+05, 0.0000e+00, 3.8105e+05, 3.8104e+05, 3.8104e+05,
         7.7490e+05, 3.8104e+05, 7.6828e+05, 7.5955e+05],
        [6.3115e-01, 3.8365e+05, 5.4790e-01, 3.9275e+05, 1.2325e+00, 3.8674e+05,
         9.0198e-01, 5.0483e-01, 3.8105e+05, 0.0000e+00, 1.2882e+00, 6.5946e-01,
         4.0090e+05, 1.2977e+00, 3.7393e+05, 3.9130e+05],
        [1.1093e+00, 3.8367e+05, 1.1701e+00, 3.9273e+05, 8.5259e-01, 3.8675e+05,
         9.3232e-01, 1.3027e+00, 3.8104e+05, 1.2882e+00, 0.0000e+00, 1.5777e+00,
         4.0091e+05, 8.7177e-01, 3.7394e+05, 3.9130e+05],
        [7.8821e-01, 3.8364e+05, 6.6280e-01, 3.9272e+05, 1.4773e+00, 3.8676e+05,
         1.0912e+00, 6.0947e-01, 3.8104e+05, 6.5946e-01, 1.5777e+00, 0.0000e+00,
         4.0092e+05, 1.6182e+00, 3.7394e+05, 3.9130e+05],
        [4.0090e+05, 7.8425e+05, 4.0091e+05, 7.8368e+05, 4.0090e+05, 7.8667e+05,
         4.0091e+05, 4.0092e+05, 7.7490e+05, 4.0090e+05, 4.0091e+05, 4.0092e+05,
         0.0000e+00, 4.0088e+05, 7.8208e+05, 7.9827e+05],
        [1.1173e+00, 3.8365e+05, 1.1706e+00, 3.9274e+05, 8.8128e-01, 3.8678e+05,
         9.3269e-01, 1.3261e+00, 3.8104e+05, 1.2977e+00, 8.7177e-01, 1.6182e+00,
         4.0088e+05, 0.0000e+00, 3.7391e+05, 3.9128e+05],
        [3.7392e+05, 7.5809e+05, 3.7390e+05, 7.6085e+05, 3.7392e+05, 7.4900e+05,
         3.7394e+05, 3.7394e+05, 7.6828e+05, 3.7393e+05, 3.7394e+05, 3.7394e+05,
         7.8208e+05, 3.7391e+05, 0.0000e+00, 7.5596e+05],
        [3.9128e+05, 7.7110e+05, 3.9129e+05, 7.8807e+05, 3.9129e+05, 7.9335e+05,
         3.9128e+05, 3.9132e+05, 7.5955e+05, 3.9130e+05, 3.9130e+05, 3.9130e+05,
         7.9827e+05, 3.9128e+05, 7.5596e+05, 0.0000e+00]])
Krum scores: ['0.80', '383647.81', '0.77', '392738.16', '1.05', '386743.22', '0.88', '0.81', '381030.22', '0.82', '1.08', '0.98', '400901.75', '1.09', '373921.66', '391287.81']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 15, 11, 19, 8, 13, 9, 12, 17, 10, 4, 2, 14, 6, 16, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0066s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:53...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:53, End: 2025-07-22 16:01:53)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 8, 5, 3, 14, 6, 1, 2, 10, 11, 20, 17, 19, 18, 4, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9153e+05, 3.9153e+05, 3.9154e+05, 7.6830e+05, 3.9149e+05,
         3.9153e+05, 3.9151e+05, 3.9152e+05, 3.9152e+05, 7.6224e+05, 7.9331e+05,
         7.9330e+05, 7.8004e+05, 3.9151e+05, 3.9152e+05],
        [3.9153e+05, 0.0000e+00, 9.1435e-01, 8.6734e-01, 3.9445e+05, 8.2796e-01,
         1.0130e+00, 1.0845e+00, 1.0755e+00, 1.5300e+00, 3.7644e+05, 4.0030e+05,
         3.8074e+05, 3.8542e+05, 8.1462e-01, 8.7301e-01],
        [3.9153e+05, 9.1435e-01, 0.0000e+00, 8.3708e-01, 3.9446e+05, 8.9920e-01,
         7.6683e-01, 7.9188e-01, 7.7441e-01, 1.0314e+00, 3.7646e+05, 4.0031e+05,
         3.8073e+05, 3.8540e+05, 8.7502e-01, 7.9285e-01],
        [3.9154e+05, 8.6734e-01, 8.3708e-01, 0.0000e+00, 3.9447e+05, 8.9508e-01,
         9.4876e-01, 1.0627e+00, 9.7671e-01, 1.4407e+00, 3.7647e+05, 4.0033e+05,
         3.8072e+05, 3.8541e+05, 8.6252e-01, 8.1546e-01],
        [7.6830e+05, 3.9445e+05, 3.9446e+05, 3.9447e+05, 0.0000e+00, 3.9446e+05,
         3.9450e+05, 3.9446e+05, 3.9446e+05, 3.9449e+05, 7.6011e+05, 7.9961e+05,
         7.5419e+05, 7.6470e+05, 3.9447e+05, 3.9446e+05],
        [3.9149e+05, 8.2796e-01, 8.9920e-01, 8.9508e-01, 3.9446e+05, 0.0000e+00,
         9.6750e-01, 1.1042e+00, 1.0555e+00, 1.4621e+00, 3.7648e+05, 4.0035e+05,
         3.8073e+05, 3.8542e+05, 8.2627e-01, 8.5404e-01],
        [3.9153e+05, 1.0130e+00, 7.6683e-01, 9.4876e-01, 3.9450e+05, 9.6750e-01,
         0.0000e+00, 6.0155e-01, 6.0109e-01, 7.3977e-01, 3.7643e+05, 4.0033e+05,
         3.8073e+05, 3.8543e+05, 1.0223e+00, 7.6299e-01],
        [3.9151e+05, 1.0845e+00, 7.9188e-01, 1.0627e+00, 3.9446e+05, 1.1042e+00,
         6.0155e-01, 0.0000e+00, 5.1219e-01, 5.4506e-01, 3.7645e+05, 4.0033e+05,
         3.8074e+05, 3.8540e+05, 1.1295e+00, 7.7586e-01],
        [3.9152e+05, 1.0755e+00, 7.7441e-01, 9.7671e-01, 3.9446e+05, 1.0555e+00,
         6.0109e-01, 5.1219e-01, 0.0000e+00, 6.1931e-01, 3.7646e+05, 4.0032e+05,
         3.8074e+05, 3.8542e+05, 1.1056e+00, 7.9171e-01],
        [3.9152e+05, 1.5300e+00, 1.0314e+00, 1.4407e+00, 3.9449e+05, 1.4621e+00,
         7.3977e-01, 5.4506e-01, 6.1931e-01, 0.0000e+00, 3.7646e+05, 4.0032e+05,
         3.8075e+05, 3.8541e+05, 1.5243e+00, 1.0588e+00],
        [7.6224e+05, 3.7644e+05, 3.7646e+05, 3.7647e+05, 7.6011e+05, 3.7648e+05,
         3.7643e+05, 3.7645e+05, 3.7646e+05, 3.7646e+05, 0.0000e+00, 7.6994e+05,
         7.4880e+05, 7.7445e+05, 3.7647e+05, 3.7646e+05],
        [7.9331e+05, 4.0030e+05, 4.0031e+05, 4.0033e+05, 7.9961e+05, 4.0035e+05,
         4.0033e+05, 4.0033e+05, 4.0032e+05, 4.0032e+05, 7.6994e+05, 0.0000e+00,
         7.8182e+05, 7.9843e+05, 4.0034e+05, 4.0033e+05],
        [7.9330e+05, 3.8074e+05, 3.8073e+05, 3.8072e+05, 7.5419e+05, 3.8073e+05,
         3.8073e+05, 3.8074e+05, 3.8074e+05, 3.8075e+05, 7.4880e+05, 7.8182e+05,
         0.0000e+00, 7.4977e+05, 3.8074e+05, 3.8076e+05],
        [7.8004e+05, 3.8542e+05, 3.8540e+05, 3.8541e+05, 7.6470e+05, 3.8542e+05,
         3.8543e+05, 3.8540e+05, 3.8542e+05, 3.8541e+05, 7.7445e+05, 7.9843e+05,
         7.4977e+05, 0.0000e+00, 3.8540e+05, 3.8542e+05],
        [3.9151e+05, 8.1462e-01, 8.7502e-01, 8.6252e-01, 3.9447e+05, 8.2627e-01,
         1.0223e+00, 1.1295e+00, 1.1056e+00, 1.5243e+00, 3.7647e+05, 4.0034e+05,
         3.8074e+05, 3.8540e+05, 0.0000e+00, 8.9305e-01],
        [3.9152e+05, 8.7301e-01, 7.9285e-01, 8.1546e-01, 3.9446e+05, 8.5404e-01,
         7.6299e-01, 7.7586e-01, 7.9171e-01, 1.0588e+00, 3.7646e+05, 4.0033e+05,
         3.8076e+05, 3.8542e+05, 8.9305e-01, 0.0000e+00]])
Krum scores: ['391515.12', '0.93', '0.83', '0.91', '394462.47', '0.93', '0.80', '0.81', '0.80', '1.05', '376453.41', '400321.06', '380733.09', '385409.38', '0.94', '0.82']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 8, 5, 3, 14, 6, 1, 2, 10, 11, 20, 17, 19, 18, 4, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0169s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:54...
global Accuracy on shared test data: 73.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:54, End: 2025-07-22 16:01:54)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 14, 1, 8, 12, 6, 19, 17, 2, 5, 20, 16, 9, 7, 3, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.9141e+05, 3.8879e+05, 3.8876e+05, 3.8879e+05, 3.8879e+05,
         7.7001e+05, 7.6544e+05, 3.8880e+05, 3.8878e+05, 7.8524e+05, 7.8823e+05,
         3.8877e+05, 3.8877e+05, 3.8877e+05, 7.9450e+05],
        [7.9141e+05, 0.0000e+00, 3.9115e+05, 3.9117e+05, 3.9114e+05, 3.9115e+05,
         7.6282e+05, 7.6962e+05, 3.9117e+05, 3.9115e+05, 7.5384e+05, 8.0352e+05,
         3.9118e+05, 3.9117e+05, 3.9116e+05, 7.6996e+05],
        [3.8879e+05, 3.9115e+05, 0.0000e+00, 1.4501e+00, 5.4956e-01, 1.4356e+00,
         3.8513e+05, 3.8868e+05, 6.2571e-01, 9.7434e-01, 3.9023e+05, 3.9419e+05,
         1.0633e+00, 1.5593e+00, 1.4284e+00, 3.9332e+05],
        [3.8876e+05, 3.9117e+05, 1.4501e+00, 0.0000e+00, 1.1319e+00, 8.5222e-01,
         3.8517e+05, 3.8868e+05, 1.0868e+00, 9.4676e-01, 3.9021e+05, 3.9420e+05,
         9.0702e-01, 9.4099e-01, 9.2097e-01, 3.9325e+05],
        [3.8879e+05, 3.9114e+05, 5.4956e-01, 1.1319e+00, 0.0000e+00, 1.1158e+00,
         3.8515e+05, 3.8871e+05, 4.8344e-01, 7.9013e-01, 3.9024e+05, 3.9422e+05,
         8.2296e-01, 1.2470e+00, 1.1172e+00, 3.9331e+05],
        [3.8879e+05, 3.9115e+05, 1.4356e+00, 8.5222e-01, 1.1158e+00, 0.0000e+00,
         3.8517e+05, 3.8870e+05, 1.1355e+00, 9.3766e-01, 3.9024e+05, 3.9418e+05,
         9.0346e-01, 9.5257e-01, 9.1627e-01, 3.9330e+05],
        [7.7001e+05, 7.6282e+05, 3.8513e+05, 3.8517e+05, 3.8515e+05, 3.8517e+05,
         0.0000e+00, 7.9033e+05, 3.8514e+05, 3.8515e+05, 7.6184e+05, 7.6443e+05,
         3.8516e+05, 3.8515e+05, 3.8517e+05, 7.5668e+05],
        [7.6544e+05, 7.6962e+05, 3.8868e+05, 3.8868e+05, 3.8871e+05, 3.8870e+05,
         7.9033e+05, 0.0000e+00, 3.8870e+05, 3.8868e+05, 7.6214e+05, 8.1374e+05,
         3.8870e+05, 3.8866e+05, 3.8870e+05, 7.8719e+05],
        [3.8880e+05, 3.9117e+05, 6.2571e-01, 1.0868e+00, 4.8344e-01, 1.1355e+00,
         3.8514e+05, 3.8870e+05, 0.0000e+00, 8.0591e-01, 3.9023e+05, 3.9419e+05,
         8.3432e-01, 1.2014e+00, 1.1420e+00, 3.9331e+05],
        [3.8878e+05, 3.9115e+05, 9.7434e-01, 9.4676e-01, 7.9013e-01, 9.3766e-01,
         3.8515e+05, 3.8868e+05, 8.0591e-01, 0.0000e+00, 3.9024e+05, 3.9419e+05,
         8.2462e-01, 9.7428e-01, 8.9710e-01, 3.9332e+05],
        [7.8524e+05, 7.5384e+05, 3.9023e+05, 3.9021e+05, 3.9024e+05, 3.9024e+05,
         7.6184e+05, 7.6214e+05, 3.9023e+05, 3.9024e+05, 0.0000e+00, 7.9896e+05,
         3.9021e+05, 3.9021e+05, 3.9023e+05, 7.7592e+05],
        [7.8823e+05, 8.0352e+05, 3.9419e+05, 3.9420e+05, 3.9422e+05, 3.9418e+05,
         7.6443e+05, 8.1374e+05, 3.9419e+05, 3.9419e+05, 7.9896e+05, 0.0000e+00,
         3.9418e+05, 3.9421e+05, 3.9420e+05, 7.8445e+05],
        [3.8877e+05, 3.9118e+05, 1.0633e+00, 9.0702e-01, 8.2296e-01, 9.0346e-01,
         3.8516e+05, 3.8870e+05, 8.3432e-01, 8.2462e-01, 3.9021e+05, 3.9418e+05,
         0.0000e+00, 9.9380e-01, 9.0410e-01, 3.9331e+05],
        [3.8877e+05, 3.9117e+05, 1.5593e+00, 9.4099e-01, 1.2470e+00, 9.5257e-01,
         3.8515e+05, 3.8866e+05, 1.2014e+00, 9.7428e-01, 3.9021e+05, 3.9421e+05,
         9.9380e-01, 0.0000e+00, 9.9323e-01, 3.9329e+05],
        [3.8877e+05, 3.9116e+05, 1.4284e+00, 9.2097e-01, 1.1172e+00, 9.1627e-01,
         3.8517e+05, 3.8870e+05, 1.1420e+00, 8.9710e-01, 3.9023e+05, 3.9420e+05,
         9.0410e-01, 9.9323e-01, 0.0000e+00, 3.9330e+05],
        [7.9450e+05, 7.6996e+05, 3.9332e+05, 3.9325e+05, 3.9331e+05, 3.9330e+05,
         7.5668e+05, 7.8719e+05, 3.9331e+05, 3.9332e+05, 7.7592e+05, 7.8445e+05,
         3.9331e+05, 3.9329e+05, 3.9330e+05, 0.0000e+00]])
Krum scores: ['388775.25', '391154.41', '1.08', '0.97', '0.86', '0.97', '385150.78', '388684.44', '0.87', '0.88', '390223.66', '394191.09', '0.88', '1.04', '0.98', '393295.50']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 14, 1, 8, 12, 6, 19, 17, 2, 5, 20, 16, 9, 7, 3, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0064s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:55...
global Accuracy on shared test data: 70.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 82 181]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:55, End: 2025-07-22 16:01:55)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 15, 3, 2, 7, 18, 5, 17, 20, 9, 19, 13, 4, 11, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7891e+05, 8.6995e-01, 1.0289e+00, 9.1272e-01, 3.9587e+05,
         8.7980e-01, 3.7785e+05, 3.8728e+05, 8.6388e-01, 4.0066e+05, 3.9921e+05,
         8.0176e-01, 1.1024e+00, 3.8406e+05, 8.2066e-01],
        [3.7891e+05, 0.0000e+00, 3.7891e+05, 3.7892e+05, 3.7893e+05, 7.8368e+05,
         3.7891e+05, 7.4578e+05, 7.6947e+05, 3.7893e+05, 7.6974e+05, 7.7244e+05,
         3.7889e+05, 3.7894e+05, 7.4542e+05, 3.7891e+05],
        [8.6995e-01, 3.7891e+05, 0.0000e+00, 1.0473e+00, 9.4832e-01, 3.9585e+05,
         8.4084e-01, 3.7782e+05, 3.8726e+05, 8.3356e-01, 4.0068e+05, 3.9920e+05,
         8.3709e-01, 1.0758e+00, 3.8407e+05, 8.5960e-01],
        [1.0289e+00, 3.7892e+05, 1.0473e+00, 0.0000e+00, 1.1083e+00, 3.9587e+05,
         7.7320e-01, 3.7783e+05, 3.8731e+05, 7.7589e-01, 4.0067e+05, 3.9921e+05,
         1.0681e+00, 4.3131e-01, 3.8407e+05, 1.0415e+00],
        [9.1272e-01, 3.7893e+05, 9.4832e-01, 1.1083e+00, 0.0000e+00, 3.9583e+05,
         9.1075e-01, 3.7783e+05, 3.8731e+05, 9.5691e-01, 4.0066e+05, 3.9921e+05,
         9.1516e-01, 1.1380e+00, 3.8410e+05, 9.0570e-01],
        [3.9587e+05, 7.8368e+05, 3.9585e+05, 3.9587e+05, 3.9583e+05, 0.0000e+00,
         3.9584e+05, 7.7377e+05, 7.8168e+05, 3.9587e+05, 7.9788e+05, 7.9398e+05,
         3.9586e+05, 3.9585e+05, 7.6393e+05, 3.9586e+05],
        [8.7980e-01, 3.7891e+05, 8.4084e-01, 7.7320e-01, 9.1075e-01, 3.9584e+05,
         0.0000e+00, 3.7784e+05, 3.8730e+05, 7.6804e-01, 4.0071e+05, 3.9922e+05,
         8.3576e-01, 7.3254e-01, 3.8408e+05, 8.6296e-01],
        [3.7785e+05, 7.4578e+05, 3.7782e+05, 3.7783e+05, 3.7783e+05, 7.7377e+05,
         3.7784e+05, 0.0000e+00, 7.6526e+05, 3.7783e+05, 7.8643e+05, 7.8758e+05,
         3.7783e+05, 3.7783e+05, 7.6494e+05, 3.7783e+05],
        [3.8728e+05, 7.6947e+05, 3.8726e+05, 3.8731e+05, 3.8731e+05, 7.8168e+05,
         3.8730e+05, 7.6526e+05, 0.0000e+00, 3.8730e+05, 7.5797e+05, 7.9084e+05,
         3.8730e+05, 3.8733e+05, 7.9254e+05, 3.8730e+05],
        [8.6388e-01, 3.7893e+05, 8.3356e-01, 7.7589e-01, 9.5691e-01, 3.9587e+05,
         7.6804e-01, 3.7783e+05, 3.8730e+05, 0.0000e+00, 4.0069e+05, 3.9922e+05,
         8.7041e-01, 7.4428e-01, 3.8406e+05, 8.3941e-01],
        [4.0066e+05, 7.6974e+05, 4.0068e+05, 4.0067e+05, 4.0066e+05, 7.9788e+05,
         4.0071e+05, 7.8643e+05, 7.5797e+05, 4.0069e+05, 0.0000e+00, 8.1374e+05,
         4.0070e+05, 4.0067e+05, 7.6659e+05, 4.0071e+05],
        [3.9921e+05, 7.7244e+05, 3.9920e+05, 3.9921e+05, 3.9921e+05, 7.9398e+05,
         3.9922e+05, 7.8758e+05, 7.9084e+05, 3.9922e+05, 8.1374e+05, 0.0000e+00,
         3.9922e+05, 3.9924e+05, 7.8444e+05, 3.9922e+05],
        [8.0176e-01, 3.7889e+05, 8.3709e-01, 1.0681e+00, 9.1516e-01, 3.9586e+05,
         8.3576e-01, 3.7783e+05, 3.8730e+05, 8.7041e-01, 4.0070e+05, 3.9922e+05,
         0.0000e+00, 1.0939e+00, 3.8408e+05, 7.8815e-01],
        [1.1024e+00, 3.7894e+05, 1.0758e+00, 4.3131e-01, 1.1380e+00, 3.9585e+05,
         7.3254e-01, 3.7783e+05, 3.8733e+05, 7.4428e-01, 4.0067e+05, 3.9924e+05,
         1.0939e+00, 0.0000e+00, 3.8407e+05, 1.0376e+00],
        [3.8406e+05, 7.4542e+05, 3.8407e+05, 3.8407e+05, 3.8410e+05, 7.6393e+05,
         3.8408e+05, 7.6494e+05, 7.9254e+05, 3.8406e+05, 7.6659e+05, 7.8444e+05,
         3.8408e+05, 3.8407e+05, 0.0000e+00, 3.8407e+05],
        [8.2066e-01, 3.7891e+05, 8.5960e-01, 1.0415e+00, 9.0570e-01, 3.9586e+05,
         8.6296e-01, 3.7783e+05, 3.8730e+05, 8.3941e-01, 4.0071e+05, 3.9922e+05,
         7.8815e-01, 1.0376e+00, 3.8407e+05, 0.0000e+00]])
Krum scores: ['0.88', '378911.22', '0.89', '0.88', '0.95', '395851.81', '0.81', '377830.28', '387292.84', '0.81', '400673.34', '399212.44', '0.87', '0.89', '384070.41', '0.87']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 15, 3, 2, 7, 18, 5, 17, 20, 9, 19, 13, 4, 11, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:55...
global Accuracy on shared test data: 73.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0027 seconds (Start: 2025-07-22 16:01:55, End: 2025-07-22 16:01:55)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [18, 1, 2, 12, 13, 4, 15, 16, 14, 9, 6, 17, 8, 10, 11, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9446e+05, 3.9447e+05, 3.9447e+05, 7.8256e+05, 3.9448e+05,
         7.8175e+05, 7.9668e+05, 7.9022e+05, 3.9448e+05, 3.9449e+05, 7.8344e+05,
         3.9448e+05, 3.9447e+05, 3.9446e+05, 7.7705e+05],
        [3.9446e+05, 0.0000e+00, 5.0696e-01, 3.9171e-01, 4.0037e+05, 1.2326e+00,
         3.9545e+05, 4.0192e+05, 3.8926e+05, 8.6983e-01, 1.2214e+00, 3.9845e+05,
         1.2378e+00, 5.4434e-01, 3.9780e-01, 3.8302e+05],
        [3.9447e+05, 5.0696e-01, 0.0000e+00, 4.6087e-01, 4.0037e+05, 1.1070e+00,
         3.9545e+05, 4.0193e+05, 3.8925e+05, 7.7836e-01, 1.1294e+00, 3.9845e+05,
         1.0947e+00, 5.2907e-01, 4.5845e-01, 3.8302e+05],
        [3.9447e+05, 3.9171e-01, 4.6087e-01, 0.0000e+00, 4.0036e+05, 1.3311e+00,
         3.9545e+05, 4.0193e+05, 3.8925e+05, 9.0869e-01, 1.3174e+00, 3.9845e+05,
         1.3271e+00, 4.8617e-01, 3.7058e-01, 3.8301e+05],
        [7.8256e+05, 4.0037e+05, 4.0037e+05, 4.0036e+05, 0.0000e+00, 4.0035e+05,
         7.9912e+05, 8.0287e+05, 7.7337e+05, 4.0034e+05, 4.0035e+05, 7.9961e+05,
         4.0035e+05, 4.0037e+05, 4.0036e+05, 7.9750e+05],
        [3.9448e+05, 1.2326e+00, 1.1070e+00, 1.3311e+00, 4.0035e+05, 0.0000e+00,
         3.9545e+05, 4.0191e+05, 3.8925e+05, 9.0459e-01, 8.7892e-01, 3.9848e+05,
         8.3353e-01, 1.0894e+00, 1.1739e+00, 3.8302e+05],
        [7.8175e+05, 3.9545e+05, 3.9545e+05, 3.9545e+05, 7.9912e+05, 3.9545e+05,
         0.0000e+00, 7.9603e+05, 7.6762e+05, 3.9546e+05, 3.9546e+05, 7.9181e+05,
         3.9544e+05, 3.9545e+05, 3.9547e+05, 7.8797e+05],
        [7.9668e+05, 4.0192e+05, 4.0193e+05, 4.0193e+05, 8.0287e+05, 4.0191e+05,
         7.9603e+05, 0.0000e+00, 7.7581e+05, 4.0190e+05, 4.0188e+05, 8.0644e+05,
         4.0191e+05, 4.0193e+05, 4.0192e+05, 7.8494e+05],
        [7.9022e+05, 3.8926e+05, 3.8925e+05, 3.8925e+05, 7.7337e+05, 3.8925e+05,
         7.6762e+05, 7.7581e+05, 0.0000e+00, 3.8925e+05, 3.8924e+05, 7.8306e+05,
         3.8925e+05, 3.8925e+05, 3.8928e+05, 7.6927e+05],
        [3.9448e+05, 8.6983e-01, 7.7836e-01, 9.0869e-01, 4.0034e+05, 9.0459e-01,
         3.9546e+05, 4.0190e+05, 3.8925e+05, 0.0000e+00, 9.1741e-01, 3.9848e+05,
         9.0458e-01, 7.8821e-01, 7.9994e-01, 3.8305e+05],
        [3.9449e+05, 1.2214e+00, 1.1294e+00, 1.3174e+00, 4.0035e+05, 8.7892e-01,
         3.9546e+05, 4.0188e+05, 3.8924e+05, 9.1741e-01, 0.0000e+00, 3.9846e+05,
         8.9238e-01, 1.0687e+00, 1.1714e+00, 3.8299e+05],
        [7.8344e+05, 3.9845e+05, 3.9845e+05, 3.9845e+05, 7.9961e+05, 3.9848e+05,
         7.9181e+05, 8.0644e+05, 7.8306e+05, 3.9848e+05, 3.9846e+05, 0.0000e+00,
         3.9847e+05, 3.9844e+05, 3.9845e+05, 7.9017e+05],
        [3.9448e+05, 1.2378e+00, 1.0947e+00, 1.3271e+00, 4.0035e+05, 8.3353e-01,
         3.9544e+05, 4.0191e+05, 3.8925e+05, 9.0458e-01, 8.9238e-01, 3.9847e+05,
         0.0000e+00, 1.0687e+00, 1.1926e+00, 3.8302e+05],
        [3.9447e+05, 5.4434e-01, 5.2907e-01, 4.8617e-01, 4.0037e+05, 1.0894e+00,
         3.9545e+05, 4.0193e+05, 3.8925e+05, 7.8821e-01, 1.0687e+00, 3.9844e+05,
         1.0687e+00, 0.0000e+00, 4.9285e-01, 3.8301e+05],
        [3.9446e+05, 3.9780e-01, 4.5845e-01, 3.7058e-01, 4.0036e+05, 1.1739e+00,
         3.9547e+05, 4.0192e+05, 3.8928e+05, 7.9994e-01, 1.1714e+00, 3.9845e+05,
         1.1926e+00, 4.9285e-01, 0.0000e+00, 3.8303e+05],
        [7.7705e+05, 3.8302e+05, 3.8302e+05, 3.8301e+05, 7.9750e+05, 3.8302e+05,
         7.8797e+05, 7.8494e+05, 7.6927e+05, 3.8305e+05, 3.8299e+05, 7.9017e+05,
         3.8302e+05, 3.8301e+05, 3.8303e+05, 0.0000e+00]])
Krum scores: ['394469.72', '0.74', '0.71', '0.75', '400355.16', '1.03', '395452.00', '401911.78', '389249.06', '0.85', '1.04', '398455.34', '1.03', '0.71', '0.69', '383012.81']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [18, 1, 2, 12, 13, 4, 15, 16, 14, 9, 6, 17, 8, 10, 11, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0053s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:56...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:56, End: 2025-07-22 16:01:56)
start time is: 99080232803581, end time is: 99098076629714
The total time is: 17843826133ns.

 ------- aggregate method: krum, random_seed: 100 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 9, 8, 5, 15, 10, 2, 14, 13, 1, 6, 18, 4, 3, 19, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.4293e+00, 3.6631e+00, 3.3812e+00, 3.9453e+05, 3.3304e+00,
         3.4348e+00, 3.8696e+05, 3.7914e+05, 3.3083e+00, 3.4967e+00, 3.9547e+05,
         3.7491e+00, 3.4787e+00, 3.8025e+05, 3.9803e+05],
        [3.4293e+00, 0.0000e+00, 3.6348e+00, 3.7792e+00, 3.9453e+05, 3.3426e+00,
         3.4089e+00, 3.8694e+05, 3.7914e+05, 3.3238e+00, 3.5989e+00, 3.9548e+05,
         3.6299e+00, 3.6862e+00, 3.8024e+05, 3.9801e+05],
        [3.6631e+00, 3.6348e+00, 0.0000e+00, 4.2466e+00, 3.9455e+05, 3.5817e+00,
         4.0237e+00, 3.8693e+05, 3.7916e+05, 3.7826e+00, 4.0340e+00, 3.9550e+05,
         4.0451e+00, 4.0906e+00, 3.8024e+05, 3.9796e+05],
        [3.3812e+00, 3.7792e+00, 4.2466e+00, 0.0000e+00, 3.9455e+05, 3.8046e+00,
         3.5951e+00, 3.8691e+05, 3.7919e+05, 3.6065e+00, 3.5407e+00, 3.9553e+05,
         4.0001e+00, 3.3872e+00, 3.8029e+05, 3.9799e+05],
        [3.9453e+05, 3.9453e+05, 3.9455e+05, 3.9455e+05, 0.0000e+00, 3.9457e+05,
         3.9455e+05, 7.7481e+05, 7.7318e+05, 3.9449e+05, 3.9458e+05, 7.6801e+05,
         3.9455e+05, 3.9452e+05, 7.6764e+05, 7.8062e+05],
        [3.3304e+00, 3.3426e+00, 3.5817e+00, 3.8046e+00, 3.9457e+05, 0.0000e+00,
         3.2515e+00, 3.8692e+05, 3.7912e+05, 3.5223e+00, 3.4918e+00, 3.9548e+05,
         3.1943e+00, 3.6850e+00, 3.8025e+05, 3.9793e+05],
        [3.4348e+00, 3.4089e+00, 4.0237e+00, 3.5951e+00, 3.9455e+05, 3.2515e+00,
         0.0000e+00, 3.8698e+05, 3.7915e+05, 3.5388e+00, 3.4236e+00, 3.9552e+05,
         3.9485e+00, 3.7446e+00, 3.8026e+05, 3.9798e+05],
        [3.8696e+05, 3.8694e+05, 3.8693e+05, 3.8691e+05, 7.7481e+05, 3.8692e+05,
         3.8698e+05, 0.0000e+00, 7.6346e+05, 3.8694e+05, 3.8697e+05, 7.8426e+05,
         3.8693e+05, 3.8696e+05, 7.6338e+05, 7.8002e+05],
        [3.7914e+05, 3.7914e+05, 3.7916e+05, 3.7919e+05, 7.7318e+05, 3.7912e+05,
         3.7915e+05, 7.6346e+05, 0.0000e+00, 3.7913e+05, 3.7913e+05, 7.7424e+05,
         3.7918e+05, 3.7913e+05, 7.6075e+05, 7.7366e+05],
        [3.3083e+00, 3.3238e+00, 3.7826e+00, 3.6065e+00, 3.9449e+05, 3.5223e+00,
         3.5388e+00, 3.8694e+05, 3.7913e+05, 0.0000e+00, 3.6843e+00, 3.9547e+05,
         3.8829e+00, 3.6992e+00, 3.8021e+05, 3.9798e+05],
        [3.4967e+00, 3.5989e+00, 4.0340e+00, 3.5407e+00, 3.9458e+05, 3.4918e+00,
         3.4236e+00, 3.8697e+05, 3.7913e+05, 3.6843e+00, 0.0000e+00, 3.9548e+05,
         3.9073e+00, 3.6497e+00, 3.8023e+05, 3.9798e+05],
        [3.9547e+05, 3.9548e+05, 3.9550e+05, 3.9553e+05, 7.6801e+05, 3.9548e+05,
         3.9552e+05, 7.8426e+05, 7.7424e+05, 3.9547e+05, 3.9548e+05, 0.0000e+00,
         3.9551e+05, 3.9553e+05, 7.6339e+05, 8.0343e+05],
        [3.7491e+00, 3.6299e+00, 4.0451e+00, 4.0001e+00, 3.9455e+05, 3.1943e+00,
         3.9485e+00, 3.8693e+05, 3.7918e+05, 3.8829e+00, 3.9073e+00, 3.9551e+05,
         0.0000e+00, 4.2961e+00, 3.8022e+05, 3.9790e+05],
        [3.4787e+00, 3.6862e+00, 4.0906e+00, 3.3872e+00, 3.9452e+05, 3.6850e+00,
         3.7446e+00, 3.8696e+05, 3.7913e+05, 3.6992e+00, 3.6497e+00, 3.9553e+05,
         4.2961e+00, 0.0000e+00, 3.8022e+05, 3.9797e+05],
        [3.8025e+05, 3.8024e+05, 3.8024e+05, 3.8029e+05, 7.6764e+05, 3.8025e+05,
         3.8026e+05, 7.6338e+05, 7.6075e+05, 3.8021e+05, 3.8023e+05, 7.6339e+05,
         3.8022e+05, 3.8022e+05, 0.0000e+00, 7.9515e+05],
        [3.9803e+05, 3.9801e+05, 3.9796e+05, 3.9799e+05, 7.8062e+05, 3.9793e+05,
         3.9798e+05, 7.8002e+05, 7.7366e+05, 3.9798e+05, 3.9798e+05, 8.0343e+05,
         3.9790e+05, 3.9797e+05, 7.9515e+05, 0.0000e+00]])
Krum scores: ['3.44', '3.51', '3.86', '3.64', '394532.69', '3.42', '3.54', '386935.91', '379137.66', '3.56', '3.60', '395487.69', '3.79', '3.68', '380231.94', '397960.09']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 9, 8, 5, 15, 10, 2, 14, 13, 1, 6, 18, 4, 3, 19, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:56...
global Accuracy on shared test data: 71.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[153  84]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:56, End: 2025-07-22 16:01:56)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 14, 18, 17, 4, 3, 15, 19, 16, 10, 9, 5, 13, 2, 7, 20], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9566e+05, 3.9165e+05, 4.0077e+05, 1.9881e+00, 1.9011e+00,
         3.9095e+05, 3.8426e+05, 3.7964e+05, 1.9003e+00, 1.7128e+00, 1.8399e+00,
         3.9519e+05, 1.7582e+00, 1.9082e+00, 3.9376e+05],
        [3.9566e+05, 0.0000e+00, 7.7162e+05, 8.2058e+05, 3.9562e+05, 3.9566e+05,
         7.9615e+05, 7.8084e+05, 7.6956e+05, 3.9563e+05, 3.9562e+05, 3.9566e+05,
         7.9832e+05, 3.9558e+05, 3.9566e+05, 7.8407e+05],
        [3.9165e+05, 7.7162e+05, 0.0000e+00, 7.9106e+05, 3.9167e+05, 3.9167e+05,
         7.5402e+05, 7.6057e+05, 7.6837e+05, 3.9167e+05, 3.9168e+05, 3.9165e+05,
         8.1297e+05, 3.9166e+05, 3.9166e+05, 7.8352e+05],
        [4.0077e+05, 8.2058e+05, 7.9106e+05, 0.0000e+00, 4.0077e+05, 4.0078e+05,
         7.7771e+05, 7.7108e+05, 7.9301e+05, 4.0075e+05, 4.0078e+05, 4.0074e+05,
         8.2223e+05, 4.0075e+05, 4.0075e+05, 8.0081e+05],
        [1.9881e+00, 3.9562e+05, 3.9167e+05, 4.0077e+05, 0.0000e+00, 2.0402e+00,
         3.9093e+05, 3.8427e+05, 3.7966e+05, 2.0354e+00, 1.9069e+00, 1.8588e+00,
         3.9518e+05, 1.8588e+00, 1.8726e+00, 3.9376e+05],
        [1.9011e+00, 3.9566e+05, 3.9167e+05, 4.0078e+05, 2.0402e+00, 0.0000e+00,
         3.9090e+05, 3.8427e+05, 3.7965e+05, 1.8690e+00, 1.7889e+00, 1.8122e+00,
         3.9521e+05, 1.7999e+00, 2.0685e+00, 3.9375e+05],
        [3.9095e+05, 7.9615e+05, 7.5402e+05, 7.7771e+05, 3.9093e+05, 3.9090e+05,
         0.0000e+00, 7.4965e+05, 7.8876e+05, 3.9090e+05, 3.9093e+05, 3.9093e+05,
         8.0060e+05, 3.9090e+05, 3.9097e+05, 7.7207e+05],
        [3.8426e+05, 7.8084e+05, 7.6057e+05, 7.7108e+05, 3.8427e+05, 3.8427e+05,
         7.4965e+05, 0.0000e+00, 7.4638e+05, 3.8427e+05, 3.8423e+05, 3.8426e+05,
         7.9823e+05, 3.8425e+05, 3.8424e+05, 7.7567e+05],
        [3.7964e+05, 7.6956e+05, 7.6837e+05, 7.9301e+05, 3.7966e+05, 3.7965e+05,
         7.8876e+05, 7.4638e+05, 0.0000e+00, 3.7962e+05, 3.7965e+05, 3.7962e+05,
         7.6654e+05, 3.7964e+05, 3.7964e+05, 7.9180e+05],
        [1.9003e+00, 3.9563e+05, 3.9167e+05, 4.0075e+05, 2.0354e+00, 1.8690e+00,
         3.9090e+05, 3.8427e+05, 3.7962e+05, 0.0000e+00, 1.8293e+00, 1.9987e+00,
         3.9521e+05, 1.8361e+00, 2.0615e+00, 3.9372e+05],
        [1.7128e+00, 3.9562e+05, 3.9168e+05, 4.0078e+05, 1.9069e+00, 1.7889e+00,
         3.9093e+05, 3.8423e+05, 3.7965e+05, 1.8293e+00, 0.0000e+00, 1.9400e+00,
         3.9518e+05, 1.7858e+00, 1.9359e+00, 3.9370e+05],
        [1.8399e+00, 3.9566e+05, 3.9165e+05, 4.0074e+05, 1.8588e+00, 1.8122e+00,
         3.9093e+05, 3.8426e+05, 3.7962e+05, 1.9987e+00, 1.9400e+00, 0.0000e+00,
         3.9523e+05, 1.8514e+00, 1.8674e+00, 3.9375e+05],
        [3.9519e+05, 7.9832e+05, 8.1297e+05, 8.2223e+05, 3.9518e+05, 3.9521e+05,
         8.0060e+05, 7.9823e+05, 7.6654e+05, 3.9521e+05, 3.9518e+05, 3.9523e+05,
         0.0000e+00, 3.9521e+05, 3.9518e+05, 7.8593e+05],
        [1.7582e+00, 3.9558e+05, 3.9166e+05, 4.0075e+05, 1.8588e+00, 1.7999e+00,
         3.9090e+05, 3.8425e+05, 3.7964e+05, 1.8361e+00, 1.7858e+00, 1.8514e+00,
         3.9521e+05, 0.0000e+00, 1.8526e+00, 3.9373e+05],
        [1.9082e+00, 3.9566e+05, 3.9166e+05, 4.0075e+05, 1.8726e+00, 2.0685e+00,
         3.9097e+05, 3.8424e+05, 3.7964e+05, 2.0615e+00, 1.9359e+00, 1.8674e+00,
         3.9518e+05, 1.8526e+00, 0.0000e+00, 3.9377e+05],
        [3.9376e+05, 7.8407e+05, 7.8352e+05, 8.0081e+05, 3.9376e+05, 3.9375e+05,
         7.7207e+05, 7.7567e+05, 7.9180e+05, 3.9372e+05, 3.9370e+05, 3.9375e+05,
         7.8593e+05, 3.9373e+05, 3.9377e+05, 0.0000e+00]])
Krum scores: ['1.84', '395627.75', '391660.16', '400755.75', '1.92', '1.87', '390913.59', '384251.00', '379634.97', '1.91', '1.83', '1.86', '395190.34', '1.81', '1.92', '393734.75']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 14, 18, 17, 4, 3, 15, 19, 16, 10, 9, 5, 13, 2, 7, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:57...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:57, End: 2025-07-22 16:01:57)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 9, 6, 13, 20, 16, 3, 18, 7, 1, 8, 11, 14, 10, 12, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7559e+05, 3.7563e+05, 7.7964e+05, 7.6669e+05, 7.5985e+05,
         3.7558e+05, 7.7497e+05, 3.7563e+05, 3.7560e+05, 3.7559e+05, 3.7562e+05,
         7.4458e+05, 3.7559e+05, 3.7560e+05, 7.3627e+05],
        [3.7559e+05, 0.0000e+00, 1.6774e+00, 3.9600e+05, 3.8393e+05, 3.8934e+05,
         1.6218e+00, 3.9410e+05, 1.6604e+00, 1.5124e+00, 1.6701e+00, 1.6118e+00,
         3.7406e+05, 1.7125e+00, 1.6244e+00, 3.6775e+05],
        [3.7563e+05, 1.6774e+00, 0.0000e+00, 3.9598e+05, 3.8390e+05, 3.8938e+05,
         1.8804e+00, 3.9407e+05, 1.7844e+00, 1.6604e+00, 1.8818e+00, 1.6764e+00,
         3.7410e+05, 1.9364e+00, 1.6933e+00, 3.6775e+05],
        [7.7964e+05, 3.9600e+05, 3.9598e+05, 0.0000e+00, 7.9163e+05, 7.9896e+05,
         3.9599e+05, 8.0069e+05, 3.9600e+05, 3.9601e+05, 3.9599e+05, 3.9598e+05,
         7.7157e+05, 3.9600e+05, 3.9602e+05, 7.6153e+05],
        [7.6669e+05, 3.8393e+05, 3.8390e+05, 7.9163e+05, 0.0000e+00, 7.6784e+05,
         3.8393e+05, 7.7584e+05, 3.8389e+05, 3.8387e+05, 3.8389e+05, 3.8389e+05,
         7.4901e+05, 3.8394e+05, 3.8393e+05, 7.4903e+05],
        [7.5985e+05, 3.8934e+05, 3.8938e+05, 7.9896e+05, 7.6784e+05, 0.0000e+00,
         3.8933e+05, 7.7791e+05, 3.8937e+05, 3.8935e+05, 3.8935e+05, 3.8935e+05,
         7.8584e+05, 3.8932e+05, 3.8936e+05, 7.5727e+05],
        [3.7558e+05, 1.6218e+00, 1.8804e+00, 3.9599e+05, 3.8393e+05, 3.8933e+05,
         0.0000e+00, 3.9409e+05, 1.8341e+00, 1.7145e+00, 1.7429e+00, 1.8331e+00,
         3.7407e+05, 1.6967e+00, 1.5690e+00, 3.6776e+05],
        [7.7497e+05, 3.9410e+05, 3.9407e+05, 8.0069e+05, 7.7584e+05, 7.7791e+05,
         3.9409e+05, 0.0000e+00, 3.9411e+05, 3.9408e+05, 3.9409e+05, 3.9409e+05,
         7.5190e+05, 3.9407e+05, 3.9410e+05, 7.7166e+05],
        [3.7563e+05, 1.6604e+00, 1.7844e+00, 3.9600e+05, 3.8389e+05, 3.8937e+05,
         1.8341e+00, 3.9411e+05, 0.0000e+00, 1.6788e+00, 1.8752e+00, 1.6575e+00,
         3.7409e+05, 1.8378e+00, 1.7077e+00, 3.6775e+05],
        [3.7560e+05, 1.5124e+00, 1.6604e+00, 3.9601e+05, 3.8387e+05, 3.8935e+05,
         1.7145e+00, 3.9408e+05, 1.6788e+00, 0.0000e+00, 1.7985e+00, 1.5828e+00,
         3.7404e+05, 1.7894e+00, 1.6411e+00, 3.6774e+05],
        [3.7559e+05, 1.6701e+00, 1.8818e+00, 3.9599e+05, 3.8389e+05, 3.8935e+05,
         1.7429e+00, 3.9409e+05, 1.8752e+00, 1.7985e+00, 0.0000e+00, 1.7708e+00,
         3.7406e+05, 1.8236e+00, 1.7819e+00, 3.6781e+05],
        [3.7562e+05, 1.6118e+00, 1.6764e+00, 3.9598e+05, 3.8389e+05, 3.8935e+05,
         1.8331e+00, 3.9409e+05, 1.6575e+00, 1.5828e+00, 1.7708e+00, 0.0000e+00,
         3.7406e+05, 1.8619e+00, 1.6330e+00, 3.6775e+05],
        [7.4458e+05, 3.7406e+05, 3.7410e+05, 7.7157e+05, 7.4901e+05, 7.8584e+05,
         3.7407e+05, 7.5190e+05, 3.7409e+05, 3.7404e+05, 3.7406e+05, 3.7406e+05,
         0.0000e+00, 3.7410e+05, 3.7406e+05, 7.4258e+05],
        [3.7559e+05, 1.7125e+00, 1.9364e+00, 3.9600e+05, 3.8394e+05, 3.8932e+05,
         1.6967e+00, 3.9407e+05, 1.8378e+00, 1.7894e+00, 1.8236e+00, 1.8619e+00,
         3.7410e+05, 0.0000e+00, 1.6796e+00, 3.6773e+05],
        [3.7560e+05, 1.6244e+00, 1.6933e+00, 3.9602e+05, 3.8393e+05, 3.8936e+05,
         1.5690e+00, 3.9410e+05, 1.7077e+00, 1.6411e+00, 1.7819e+00, 1.6330e+00,
         3.7406e+05, 1.6796e+00, 0.0000e+00, 3.6775e+05],
        [7.3627e+05, 3.6775e+05, 3.6775e+05, 7.6153e+05, 7.4903e+05, 7.5727e+05,
         3.6776e+05, 7.7166e+05, 3.6775e+05, 3.6774e+05, 3.6781e+05, 3.6775e+05,
         7.4258e+05, 3.6773e+05, 3.6775e+05, 0.0000e+00]])
Krum scores: ['375595.22', '1.63', '1.75', '395990.72', '383900.44', '389342.00', '1.72', '394082.72', '1.74', '1.65', '1.78', '1.68', '374062.72', '1.77', '1.65', '367744.28']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 9, 6, 13, 20, 16, 3, 18, 7, 1, 8, 11, 14, 10, 12, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0074s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:57...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0028 seconds (Start: 2025-07-22 16:01:57, End: 2025-07-22 16:01:57)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 5, 11, 17, 9, 15, 18, 20, 16, 4, 13, 6, 19, 8, 12, 7], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0626e+05, 4.0627e+05, 7.5700e+05, 4.0627e+05, 8.1232e+05,
         8.0783e+05, 8.1613e+05, 8.0351e+05, 4.0628e+05, 7.9966e+05, 4.0631e+05,
         7.9784e+05, 4.0628e+05, 4.0630e+05, 4.0626e+05],
        [4.0626e+05, 0.0000e+00, 1.4946e+00, 3.6511e+05, 1.7389e+00, 3.8270e+05,
         3.9415e+05, 3.8642e+05, 3.9875e+05, 1.5207e+00, 3.8166e+05, 1.6327e+00,
         3.9777e+05, 1.7909e+00, 1.5573e+00, 1.6033e+00],
        [4.0627e+05, 1.4946e+00, 0.0000e+00, 3.6508e+05, 1.7892e+00, 3.8270e+05,
         3.9416e+05, 3.8642e+05, 3.9877e+05, 1.5006e+00, 3.8171e+05, 1.6303e+00,
         3.9773e+05, 1.7091e+00, 1.5606e+00, 1.5493e+00],
        [7.5700e+05, 3.6511e+05, 3.6508e+05, 0.0000e+00, 3.6505e+05, 7.4727e+05,
         7.4611e+05, 7.5844e+05, 7.7384e+05, 3.6506e+05, 7.6291e+05, 3.6510e+05,
         7.5524e+05, 3.6507e+05, 3.6508e+05, 3.6505e+05],
        [4.0627e+05, 1.7389e+00, 1.7892e+00, 3.6505e+05, 0.0000e+00, 3.8273e+05,
         3.9412e+05, 3.8640e+05, 3.9878e+05, 1.8640e+00, 3.8168e+05, 1.8338e+00,
         3.9778e+05, 1.7201e+00, 1.6502e+00, 1.7409e+00],
        [8.1232e+05, 3.8270e+05, 3.8270e+05, 7.4727e+05, 3.8273e+05, 0.0000e+00,
         7.7059e+05, 7.6450e+05, 8.0312e+05, 3.8273e+05, 7.8871e+05, 3.8274e+05,
         7.7957e+05, 3.8275e+05, 3.8274e+05, 3.8272e+05],
        [8.0783e+05, 3.9415e+05, 3.9416e+05, 7.4611e+05, 3.9412e+05, 7.7059e+05,
         0.0000e+00, 7.9843e+05, 8.1046e+05, 3.9419e+05, 7.8986e+05, 3.9416e+05,
         7.9378e+05, 3.9413e+05, 3.9414e+05, 3.9415e+05],
        [8.1613e+05, 3.8642e+05, 3.8642e+05, 7.5844e+05, 3.8640e+05, 7.6450e+05,
         7.9843e+05, 0.0000e+00, 8.0401e+05, 3.8643e+05, 7.5208e+05, 3.8643e+05,
         7.8117e+05, 3.8644e+05, 3.8642e+05, 3.8642e+05],
        [8.0351e+05, 3.9875e+05, 3.9877e+05, 7.7384e+05, 3.9878e+05, 8.0312e+05,
         8.1046e+05, 8.0401e+05, 0.0000e+00, 3.9877e+05, 7.7852e+05, 3.9876e+05,
         7.9159e+05, 3.9876e+05, 3.9878e+05, 3.9877e+05],
        [4.0628e+05, 1.5207e+00, 1.5006e+00, 3.6506e+05, 1.8640e+00, 3.8273e+05,
         3.9419e+05, 3.8643e+05, 3.9877e+05, 0.0000e+00, 3.8166e+05, 1.5321e+00,
         3.9775e+05, 1.5468e+00, 1.5525e+00, 1.5644e+00],
        [7.9966e+05, 3.8166e+05, 3.8171e+05, 7.6291e+05, 3.8168e+05, 7.8871e+05,
         7.8986e+05, 7.5208e+05, 7.7852e+05, 3.8166e+05, 0.0000e+00, 3.8168e+05,
         7.8961e+05, 3.8164e+05, 3.8164e+05, 3.8165e+05],
        [4.0631e+05, 1.6327e+00, 1.6303e+00, 3.6510e+05, 1.8338e+00, 3.8274e+05,
         3.9416e+05, 3.8643e+05, 3.9876e+05, 1.5321e+00, 3.8168e+05, 0.0000e+00,
         3.9775e+05, 1.7255e+00, 1.6218e+00, 1.7207e+00],
        [7.9784e+05, 3.9777e+05, 3.9773e+05, 7.5524e+05, 3.9778e+05, 7.7957e+05,
         7.9378e+05, 7.8117e+05, 7.9159e+05, 3.9775e+05, 7.8961e+05, 3.9775e+05,
         0.0000e+00, 3.9773e+05, 3.9773e+05, 3.9774e+05],
        [4.0628e+05, 1.7909e+00, 1.7091e+00, 3.6507e+05, 1.7201e+00, 3.8275e+05,
         3.9413e+05, 3.8644e+05, 3.9876e+05, 1.5468e+00, 3.8164e+05, 1.7255e+00,
         3.9773e+05, 0.0000e+00, 1.6731e+00, 1.7562e+00],
        [4.0630e+05, 1.5573e+00, 1.5606e+00, 3.6508e+05, 1.6502e+00, 3.8274e+05,
         3.9414e+05, 3.8642e+05, 3.9878e+05, 1.5525e+00, 3.8164e+05, 1.6218e+00,
         3.9773e+05, 1.6731e+00, 0.0000e+00, 1.5675e+00],
        [4.0626e+05, 1.6033e+00, 1.5493e+00, 3.6505e+05, 1.7409e+00, 3.8272e+05,
         3.9415e+05, 3.8642e+05, 3.9877e+05, 1.5644e+00, 3.8165e+05, 1.7207e+00,
         3.9774e+05, 1.7562e+00, 1.5675e+00, 0.0000e+00]])
Krum scores: ['406271.50', '1.59', '1.57', '365064.28', '1.75', '382720.00', '394140.25', '386416.75', '398762.50', '1.54', '381654.28', '1.64', '397738.12', '1.69', '1.58', '1.62']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 5, 11, 17, 9, 15, 18, 20, 16, 4, 13, 6, 19, 8, 12, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:58...
global Accuracy on shared test data: 78.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:58, End: 2025-07-22 16:01:58)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 8, 18, 2, 6, 13, 3, 5, 17, 14, 11, 1, 12, 15, 19, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.8079e+00, 3.9319e+05, 1.6501e+00, 1.8089e+00, 3.8370e+05,
         1.8415e+00, 1.7933e+00, 3.8708e+05, 3.9744e+05, 1.8084e+00, 1.8306e+00,
         1.6990e+00, 3.9006e+05, 3.9702e+05, 3.9418e+05],
        [1.8079e+00, 0.0000e+00, 3.9321e+05, 2.0143e+00, 1.9240e+00, 3.8375e+05,
         1.9018e+00, 2.1747e+00, 3.8713e+05, 3.9746e+05, 1.9764e+00, 2.0243e+00,
         1.9285e+00, 3.9007e+05, 3.9708e+05, 3.9419e+05],
        [3.9319e+05, 3.9321e+05, 0.0000e+00, 3.9323e+05, 3.9324e+05, 7.6727e+05,
         3.9321e+05, 3.9323e+05, 7.7961e+05, 7.9413e+05, 3.9319e+05, 3.9317e+05,
         3.9320e+05, 7.9474e+05, 8.0060e+05, 7.9616e+05],
        [1.6501e+00, 2.0143e+00, 3.9323e+05, 0.0000e+00, 1.7682e+00, 3.8370e+05,
         1.7323e+00, 1.8989e+00, 3.8710e+05, 3.9743e+05, 1.9051e+00, 1.7718e+00,
         1.7431e+00, 3.9007e+05, 3.9709e+05, 3.9417e+05],
        [1.8089e+00, 1.9240e+00, 3.9324e+05, 1.7682e+00, 0.0000e+00, 3.8373e+05,
         1.9338e+00, 1.9624e+00, 3.8709e+05, 3.9742e+05, 1.8043e+00, 1.7491e+00,
         1.8338e+00, 3.9004e+05, 3.9706e+05, 3.9419e+05],
        [3.8370e+05, 3.8375e+05, 7.6727e+05, 3.8370e+05, 3.8373e+05, 0.0000e+00,
         3.8373e+05, 3.8372e+05, 7.8741e+05, 7.6611e+05, 3.8372e+05, 3.8371e+05,
         3.8370e+05, 7.9374e+05, 7.7049e+05, 7.7301e+05],
        [1.8415e+00, 1.9018e+00, 3.9321e+05, 1.7323e+00, 1.9338e+00, 3.8373e+05,
         0.0000e+00, 1.7930e+00, 3.8708e+05, 3.9742e+05, 1.9703e+00, 1.8625e+00,
         1.6939e+00, 3.9002e+05, 3.9707e+05, 3.9417e+05],
        [1.7933e+00, 2.1747e+00, 3.9323e+05, 1.8989e+00, 1.9624e+00, 3.8372e+05,
         1.7930e+00, 0.0000e+00, 3.8706e+05, 3.9740e+05, 1.7110e+00, 1.7951e+00,
         1.7644e+00, 3.9002e+05, 3.9705e+05, 3.9420e+05],
        [3.8708e+05, 3.8713e+05, 7.7961e+05, 3.8710e+05, 3.8709e+05, 7.8741e+05,
         3.8708e+05, 3.8706e+05, 0.0000e+00, 7.6109e+05, 3.8710e+05, 3.8711e+05,
         3.8710e+05, 7.8760e+05, 7.8137e+05, 7.7183e+05],
        [3.9744e+05, 3.9746e+05, 7.9413e+05, 3.9743e+05, 3.9742e+05, 7.6611e+05,
         3.9742e+05, 3.9740e+05, 7.6109e+05, 0.0000e+00, 3.9742e+05, 3.9743e+05,
         3.9741e+05, 7.7504e+05, 8.1116e+05, 8.0130e+05],
        [1.8084e+00, 1.9764e+00, 3.9319e+05, 1.9051e+00, 1.8043e+00, 3.8372e+05,
         1.9703e+00, 1.7110e+00, 3.8710e+05, 3.9742e+05, 0.0000e+00, 1.6638e+00,
         1.7564e+00, 3.9010e+05, 3.9706e+05, 3.9419e+05],
        [1.8306e+00, 2.0243e+00, 3.9317e+05, 1.7718e+00, 1.7491e+00, 3.8371e+05,
         1.8625e+00, 1.7951e+00, 3.8711e+05, 3.9743e+05, 1.6638e+00, 0.0000e+00,
         1.7003e+00, 3.9007e+05, 3.9703e+05, 3.9419e+05],
        [1.6990e+00, 1.9285e+00, 3.9320e+05, 1.7431e+00, 1.8338e+00, 3.8370e+05,
         1.6939e+00, 1.7644e+00, 3.8710e+05, 3.9741e+05, 1.7564e+00, 1.7003e+00,
         0.0000e+00, 3.9004e+05, 3.9705e+05, 3.9418e+05],
        [3.9006e+05, 3.9007e+05, 7.9474e+05, 3.9007e+05, 3.9004e+05, 7.9374e+05,
         3.9002e+05, 3.9002e+05, 7.8760e+05, 7.7504e+05, 3.9010e+05, 3.9007e+05,
         3.9004e+05, 0.0000e+00, 7.8631e+05, 7.8594e+05],
        [3.9702e+05, 3.9708e+05, 8.0060e+05, 3.9709e+05, 3.9706e+05, 7.7049e+05,
         3.9707e+05, 3.9705e+05, 7.8137e+05, 8.1116e+05, 3.9706e+05, 3.9703e+05,
         3.9705e+05, 7.8631e+05, 0.0000e+00, 7.9870e+05],
        [3.9418e+05, 3.9419e+05, 7.9616e+05, 3.9417e+05, 3.9419e+05, 7.7301e+05,
         3.9417e+05, 3.9420e+05, 7.7183e+05, 8.0130e+05, 3.9419e+05, 3.9419e+05,
         3.9418e+05, 7.8594e+05, 7.9870e+05, 0.0000e+00]])
Krum scores: ['1.77', '1.94', '393200.50', '1.78', '1.83', '383712.28', '1.82', '1.82', '387088.56', '397419.09', '1.80', '1.77', '1.74', '390044.50', '397050.81', '394183.41']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 8, 18, 2, 6, 13, 3, 5, 17, 14, 11, 1, 12, 15, 19, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:59...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:59, End: 2025-07-22 16:01:59)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [17, 3, 2, 7, 13, 16, 11, 18, 4, 5, 9, 8, 12, 15, 14, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8360e+05, 3.8360e+05, 3.8357e+05, 7.7767e+05, 8.0337e+05,
         3.8358e+05, 7.5324e+05, 3.8358e+05, 3.8359e+05, 3.8358e+05, 3.8358e+05,
         3.8357e+05, 7.7513e+05, 8.0405e+05, 3.8361e+05],
        [3.8360e+05, 0.0000e+00, 1.6846e+00, 1.8262e+00, 3.9084e+05, 3.9670e+05,
         1.9189e+00, 3.8423e+05, 1.7681e+00, 1.8176e+00, 1.7256e+00, 1.8806e+00,
         1.7489e+00, 3.9806e+05, 3.9836e+05, 1.8710e+00],
        [3.8360e+05, 1.6846e+00, 0.0000e+00, 1.6695e+00, 3.9085e+05, 3.9669e+05,
         1.7406e+00, 3.8423e+05, 1.5852e+00, 1.8662e+00, 1.5583e+00, 1.9297e+00,
         1.7269e+00, 3.9805e+05, 3.9837e+05, 1.6630e+00],
        [3.8357e+05, 1.8262e+00, 1.6695e+00, 0.0000e+00, 3.9084e+05, 3.9668e+05,
         1.6074e+00, 3.8424e+05, 1.6085e+00, 1.7008e+00, 1.7519e+00, 1.8735e+00,
         1.8677e+00, 3.9804e+05, 3.9835e+05, 1.7877e+00],
        [7.7767e+05, 3.9084e+05, 3.9085e+05, 3.9084e+05, 0.0000e+00, 7.7702e+05,
         3.9082e+05, 7.6861e+05, 3.9084e+05, 3.9080e+05, 3.9084e+05, 3.9088e+05,
         3.9082e+05, 8.0580e+05, 7.8752e+05, 3.9082e+05],
        [8.0337e+05, 3.9670e+05, 3.9669e+05, 3.9668e+05, 7.7702e+05, 0.0000e+00,
         3.9669e+05, 8.0418e+05, 3.9668e+05, 3.9674e+05, 3.9666e+05, 3.9672e+05,
         3.9665e+05, 7.8227e+05, 8.1277e+05, 3.9671e+05],
        [3.8358e+05, 1.9189e+00, 1.7406e+00, 1.6074e+00, 3.9082e+05, 3.9669e+05,
         0.0000e+00, 3.8420e+05, 1.6363e+00, 1.6699e+00, 1.7303e+00, 1.8169e+00,
         1.8898e+00, 3.9804e+05, 3.9836e+05, 1.6762e+00],
        [7.5324e+05, 3.8423e+05, 3.8423e+05, 3.8424e+05, 7.6861e+05, 8.0418e+05,
         3.8420e+05, 0.0000e+00, 3.8424e+05, 3.8423e+05, 3.8425e+05, 3.8424e+05,
         3.8422e+05, 7.9103e+05, 7.8077e+05, 3.8423e+05],
        [3.8358e+05, 1.7681e+00, 1.5852e+00, 1.6085e+00, 3.9084e+05, 3.9668e+05,
         1.6363e+00, 3.8424e+05, 0.0000e+00, 1.7257e+00, 1.6983e+00, 1.7082e+00,
         1.6061e+00, 3.9809e+05, 3.9838e+05, 1.6554e+00],
        [3.8359e+05, 1.8176e+00, 1.8662e+00, 1.7008e+00, 3.9080e+05, 3.9674e+05,
         1.6699e+00, 3.8423e+05, 1.7257e+00, 0.0000e+00, 1.9139e+00, 2.0068e+00,
         1.7568e+00, 3.9805e+05, 3.9838e+05, 1.8154e+00],
        [3.8358e+05, 1.7256e+00, 1.5583e+00, 1.7519e+00, 3.9084e+05, 3.9666e+05,
         1.7303e+00, 3.8425e+05, 1.6983e+00, 1.9139e+00, 0.0000e+00, 1.8898e+00,
         1.6731e+00, 3.9808e+05, 3.9834e+05, 1.8046e+00],
        [3.8358e+05, 1.8806e+00, 1.9297e+00, 1.8735e+00, 3.9088e+05, 3.9672e+05,
         1.8169e+00, 3.8424e+05, 1.7082e+00, 2.0068e+00, 1.8898e+00, 0.0000e+00,
         1.9626e+00, 3.9805e+05, 3.9836e+05, 1.7731e+00],
        [3.8357e+05, 1.7489e+00, 1.7269e+00, 1.8677e+00, 3.9082e+05, 3.9665e+05,
         1.8898e+00, 3.8422e+05, 1.6061e+00, 1.7568e+00, 1.6731e+00, 1.9626e+00,
         0.0000e+00, 3.9807e+05, 3.9839e+05, 1.9137e+00],
        [7.7513e+05, 3.9806e+05, 3.9805e+05, 3.9804e+05, 8.0580e+05, 7.8227e+05,
         3.9804e+05, 7.9103e+05, 3.9809e+05, 3.9805e+05, 3.9808e+05, 3.9805e+05,
         3.9807e+05, 0.0000e+00, 8.1419e+05, 3.9809e+05],
        [8.0405e+05, 3.9836e+05, 3.9837e+05, 3.9835e+05, 7.8752e+05, 8.1277e+05,
         3.9836e+05, 7.8077e+05, 3.9838e+05, 3.9838e+05, 3.9834e+05, 3.9836e+05,
         3.9839e+05, 8.1419e+05, 0.0000e+00, 3.9835e+05],
        [3.8361e+05, 1.8710e+00, 1.6630e+00, 1.7877e+00, 3.9082e+05, 3.9671e+05,
         1.6762e+00, 3.8423e+05, 1.6554e+00, 1.8154e+00, 1.8046e+00, 1.7731e+00,
         1.9137e+00, 3.9809e+05, 3.9835e+05, 0.0000e+00]])
Krum scores: ['383580.84', '1.79', '1.69', '1.73', '390828.16', '396682.50', '1.72', '384226.03', '1.65', '1.78', '1.73', '1.85', '1.77', '398055.69', '398360.38', '1.76']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [17, 3, 2, 7, 13, 16, 11, 18, 4, 5, 9, 8, 12, 15, 14, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0074s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:01:59...
global Accuracy on shared test data: 77.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:01:59, End: 2025-07-22 16:01:59)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 17, 4, 2, 14, 18, 15, 10, 3, 6, 5, 9, 8, 11, 13, 7], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9861e+05, 1.7568e+00, 1.5548e+00, 4.0643e+05, 4.1734e+05,
         3.7327e+05, 1.6083e+00, 1.6737e+00, 1.5257e+00, 1.6574e+00, 1.5176e+00,
         1.7435e+00, 1.4897e+00, 4.1673e+05, 1.5168e+00],
        [3.9861e+05, 0.0000e+00, 3.9859e+05, 3.9860e+05, 8.1705e+05, 8.5610e+05,
         7.7440e+05, 3.9861e+05, 3.9862e+05, 3.9863e+05, 3.9861e+05, 3.9860e+05,
         3.9863e+05, 3.9860e+05, 8.1694e+05, 3.9859e+05],
        [1.7568e+00, 3.9859e+05, 0.0000e+00, 1.5466e+00, 4.0640e+05, 4.1733e+05,
         3.7328e+05, 1.6394e+00, 1.8344e+00, 1.8638e+00, 1.8357e+00, 1.6218e+00,
         1.8507e+00, 1.8803e+00, 4.1671e+05, 1.8570e+00],
        [1.5548e+00, 3.9860e+05, 1.5466e+00, 0.0000e+00, 4.0642e+05, 4.1732e+05,
         3.7329e+05, 1.4216e+00, 1.5936e+00, 1.5727e+00, 1.7396e+00, 1.4230e+00,
         1.7730e+00, 1.6481e+00, 4.1672e+05, 1.5237e+00],
        [4.0643e+05, 8.1705e+05, 4.0640e+05, 4.0642e+05, 0.0000e+00, 8.1439e+05,
         7.7536e+05, 4.0642e+05, 4.0640e+05, 4.0640e+05, 4.0637e+05, 4.0642e+05,
         4.0638e+05, 4.0636e+05, 8.0863e+05, 4.0640e+05],
        [4.1734e+05, 8.5610e+05, 4.1733e+05, 4.1732e+05, 8.1439e+05, 0.0000e+00,
         7.8012e+05, 4.1732e+05, 4.1737e+05, 4.1734e+05, 4.1736e+05, 4.1733e+05,
         4.1732e+05, 4.1736e+05, 8.4345e+05, 4.1733e+05],
        [3.7327e+05, 7.7440e+05, 3.7328e+05, 3.7329e+05, 7.7536e+05, 7.8012e+05,
         0.0000e+00, 3.7329e+05, 3.7329e+05, 3.7325e+05, 3.7330e+05, 3.7328e+05,
         3.7325e+05, 3.7325e+05, 7.7619e+05, 3.7329e+05],
        [1.6083e+00, 3.9861e+05, 1.6394e+00, 1.4216e+00, 4.0642e+05, 4.1732e+05,
         3.7329e+05, 0.0000e+00, 1.5738e+00, 1.7309e+00, 1.6084e+00, 1.4607e+00,
         1.6848e+00, 1.6836e+00, 4.1673e+05, 1.6212e+00],
        [1.6737e+00, 3.9862e+05, 1.8344e+00, 1.5936e+00, 4.0640e+05, 4.1737e+05,
         3.7329e+05, 1.5738e+00, 0.0000e+00, 1.7487e+00, 1.6462e+00, 1.6204e+00,
         1.7216e+00, 1.7618e+00, 4.1672e+05, 1.7000e+00],
        [1.5257e+00, 3.9863e+05, 1.8638e+00, 1.5727e+00, 4.0640e+05, 4.1734e+05,
         3.7325e+05, 1.7309e+00, 1.7487e+00, 0.0000e+00, 1.7431e+00, 1.6872e+00,
         1.6316e+00, 1.5990e+00, 4.1675e+05, 1.6072e+00],
        [1.6574e+00, 3.9861e+05, 1.8357e+00, 1.7396e+00, 4.0637e+05, 4.1736e+05,
         3.7330e+05, 1.6084e+00, 1.6462e+00, 1.7431e+00, 0.0000e+00, 1.7242e+00,
         1.9056e+00, 1.5709e+00, 4.1670e+05, 1.6334e+00],
        [1.5176e+00, 3.9860e+05, 1.6218e+00, 1.4230e+00, 4.0642e+05, 4.1733e+05,
         3.7328e+05, 1.4607e+00, 1.6204e+00, 1.6872e+00, 1.7242e+00, 0.0000e+00,
         1.7559e+00, 1.5590e+00, 4.1673e+05, 1.6291e+00],
        [1.7435e+00, 3.9863e+05, 1.8507e+00, 1.7730e+00, 4.0638e+05, 4.1732e+05,
         3.7325e+05, 1.6848e+00, 1.7216e+00, 1.6316e+00, 1.9056e+00, 1.7559e+00,
         0.0000e+00, 1.7044e+00, 4.1675e+05, 1.6884e+00],
        [1.4897e+00, 3.9860e+05, 1.8803e+00, 1.6481e+00, 4.0636e+05, 4.1736e+05,
         3.7325e+05, 1.6836e+00, 1.7618e+00, 1.5990e+00, 1.5709e+00, 1.5590e+00,
         1.7044e+00, 0.0000e+00, 4.1674e+05, 1.4877e+00],
        [4.1673e+05, 8.1694e+05, 4.1671e+05, 4.1672e+05, 8.0863e+05, 8.4345e+05,
         7.7619e+05, 4.1673e+05, 4.1672e+05, 4.1675e+05, 4.1670e+05, 4.1673e+05,
         4.1675e+05, 4.1674e+05, 0.0000e+00, 4.1673e+05],
        [1.5168e+00, 3.9859e+05, 1.8570e+00, 1.5237e+00, 4.0640e+05, 4.1733e+05,
         3.7329e+05, 1.6212e+00, 1.7000e+00, 1.6072e+00, 1.6334e+00, 1.6291e+00,
         1.6884e+00, 1.4877e+00, 4.1673e+05, 0.0000e+00]])
Krum scores: ['1.59', '398603.72', '1.76', '1.56', '406394.50', '417331.22', '373271.69', '1.59', '1.67', '1.65', '1.68', '1.58', '1.73', '1.61', '416724.19', '1.60']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 17, 4, 2, 14, 18, 15, 10, 3, 6, 5, 9, 8, 11, 13, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0056s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:00...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:00, End: 2025-07-22 16:02:00)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 14, 2, 19, 8, 11, 20, 10, 1, 3, 16, 17, 9, 5, 6, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9967e+05, 1.8639e+00, 3.8217e+05, 1.6338e+00, 1.4728e+00,
         3.8389e+05, 1.5787e+00, 1.5246e+00, 1.6507e+00, 3.9543e+05, 3.8884e+05,
         1.5971e+00, 1.4941e+00, 1.6216e+00, 3.9705e+05],
        [3.9967e+05, 0.0000e+00, 3.9969e+05, 8.0296e+05, 3.9966e+05, 3.9968e+05,
         7.9098e+05, 3.9967e+05, 3.9971e+05, 3.9966e+05, 8.0374e+05, 7.8350e+05,
         3.9967e+05, 3.9969e+05, 3.9971e+05, 8.0301e+05],
        [1.8639e+00, 3.9969e+05, 0.0000e+00, 3.8217e+05, 1.9267e+00, 1.9305e+00,
         3.8390e+05, 1.5189e+00, 1.7752e+00, 1.7622e+00, 3.9542e+05, 3.8880e+05,
         1.5134e+00, 1.8553e+00, 1.8774e+00, 3.9700e+05],
        [3.8217e+05, 8.0296e+05, 3.8217e+05, 0.0000e+00, 3.8216e+05, 3.8220e+05,
         7.5128e+05, 3.8219e+05, 3.8221e+05, 3.8222e+05, 7.8672e+05, 7.6893e+05,
         3.8217e+05, 3.8220e+05, 3.8219e+05, 7.8604e+05],
        [1.6338e+00, 3.9966e+05, 1.9267e+00, 3.8216e+05, 0.0000e+00, 1.5469e+00,
         3.8385e+05, 1.6104e+00, 1.6196e+00, 1.5764e+00, 3.9543e+05, 3.8883e+05,
         1.5855e+00, 1.7418e+00, 1.5959e+00, 3.9702e+05],
        [1.4728e+00, 3.9968e+05, 1.9305e+00, 3.8220e+05, 1.5469e+00, 0.0000e+00,
         3.8388e+05, 1.6405e+00, 1.4818e+00, 1.6395e+00, 3.9545e+05, 3.8883e+05,
         1.5344e+00, 1.4134e+00, 1.5835e+00, 3.9708e+05],
        [3.8389e+05, 7.9098e+05, 3.8390e+05, 7.5128e+05, 3.8385e+05, 3.8388e+05,
         0.0000e+00, 3.8387e+05, 3.8386e+05, 3.8385e+05, 7.6852e+05, 7.6352e+05,
         3.8388e+05, 3.8386e+05, 3.8387e+05, 7.8574e+05],
        [1.5787e+00, 3.9967e+05, 1.5189e+00, 3.8219e+05, 1.6104e+00, 1.6405e+00,
         3.8387e+05, 0.0000e+00, 1.5839e+00, 1.5428e+00, 3.9541e+05, 3.8885e+05,
         1.4627e+00, 1.5681e+00, 1.7012e+00, 3.9701e+05],
        [1.5246e+00, 3.9971e+05, 1.7752e+00, 3.8221e+05, 1.6196e+00, 1.4818e+00,
         3.8386e+05, 1.5839e+00, 0.0000e+00, 1.6372e+00, 3.9546e+05, 3.8882e+05,
         1.5449e+00, 1.5644e+00, 1.5690e+00, 3.9706e+05],
        [1.6507e+00, 3.9966e+05, 1.7622e+00, 3.8222e+05, 1.5764e+00, 1.6395e+00,
         3.8385e+05, 1.5428e+00, 1.6372e+00, 0.0000e+00, 3.9549e+05, 3.8879e+05,
         1.5375e+00, 1.5558e+00, 1.6771e+00, 3.9704e+05],
        [3.9543e+05, 8.0374e+05, 3.9542e+05, 7.8672e+05, 3.9543e+05, 3.9545e+05,
         7.6852e+05, 3.9541e+05, 3.9546e+05, 3.9549e+05, 0.0000e+00, 7.9607e+05,
         3.9541e+05, 3.9542e+05, 3.9544e+05, 8.0858e+05],
        [3.8884e+05, 7.8350e+05, 3.8880e+05, 7.6893e+05, 3.8883e+05, 3.8883e+05,
         7.6352e+05, 3.8885e+05, 3.8882e+05, 3.8879e+05, 7.9607e+05, 0.0000e+00,
         3.8885e+05, 3.8884e+05, 3.8884e+05, 7.5623e+05],
        [1.5971e+00, 3.9967e+05, 1.5134e+00, 3.8217e+05, 1.5855e+00, 1.5344e+00,
         3.8388e+05, 1.4627e+00, 1.5449e+00, 1.5375e+00, 3.9541e+05, 3.8885e+05,
         0.0000e+00, 1.6379e+00, 1.6763e+00, 3.9703e+05],
        [1.4941e+00, 3.9969e+05, 1.8553e+00, 3.8220e+05, 1.7418e+00, 1.4134e+00,
         3.8386e+05, 1.5681e+00, 1.5644e+00, 1.5558e+00, 3.9542e+05, 3.8884e+05,
         1.6379e+00, 0.0000e+00, 1.6914e+00, 3.9704e+05],
        [1.6216e+00, 3.9971e+05, 1.8774e+00, 3.8219e+05, 1.5959e+00, 1.5835e+00,
         3.8387e+05, 1.7012e+00, 1.5690e+00, 1.6771e+00, 3.9544e+05, 3.8884e+05,
         1.6763e+00, 1.6914e+00, 0.0000e+00, 3.9706e+05],
        [3.9705e+05, 8.0301e+05, 3.9700e+05, 7.8604e+05, 3.9702e+05, 3.9708e+05,
         7.8574e+05, 3.9701e+05, 3.9706e+05, 3.9704e+05, 8.0858e+05, 7.5623e+05,
         3.9703e+05, 3.9704e+05, 3.9706e+05, 0.0000e+00]])
Krum scores: ['1.57', '399675.00', '1.76', '382182.03', '1.61', '1.54', '383865.06', '1.56', '1.57', '1.60', '395425.59', '388824.31', '1.55', '1.58', '1.64', '397031.25']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 14, 2, 19, 8, 11, 20, 10, 1, 3, 16, 17, 9, 5, 6, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0072s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:01...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:02:01, End: 2025-07-22 16:02:01)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 7, 20, 14, 17, 16, 6, 11, 9, 19, 3, 4, 12, 15, 5, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6445e+00, 3.9495e+05, 3.8401e+05, 3.8938e+05, 3.9210e+05,
         1.6739e+00, 1.6448e+00, 1.6790e+00, 3.8770e+05, 1.7733e+00, 1.7517e+00,
         1.6910e+00, 3.7935e+05, 1.7329e+00, 3.8536e+05],
        [1.6445e+00, 0.0000e+00, 3.9492e+05, 3.8399e+05, 3.8938e+05, 3.9215e+05,
         1.6711e+00, 1.6220e+00, 1.6865e+00, 3.8771e+05, 1.6768e+00, 1.7212e+00,
         1.7309e+00, 3.7934e+05, 1.5617e+00, 3.8539e+05],
        [3.9495e+05, 3.9492e+05, 0.0000e+00, 7.5261e+05, 7.9184e+05, 7.8815e+05,
         3.9492e+05, 3.9490e+05, 3.9490e+05, 7.7879e+05, 3.9493e+05, 3.9490e+05,
         3.9493e+05, 7.5305e+05, 3.9495e+05, 7.9582e+05],
        [3.8401e+05, 3.8399e+05, 7.5261e+05, 0.0000e+00, 7.7716e+05, 7.6206e+05,
         3.8399e+05, 3.8400e+05, 3.8398e+05, 7.6798e+05, 3.8397e+05, 3.8399e+05,
         3.8398e+05, 7.6754e+05, 3.8400e+05, 7.6237e+05],
        [3.8938e+05, 3.8938e+05, 7.9184e+05, 7.7716e+05, 0.0000e+00, 7.7066e+05,
         3.8938e+05, 3.8936e+05, 3.8938e+05, 7.8300e+05, 3.8942e+05, 3.8940e+05,
         3.8939e+05, 7.8556e+05, 3.8937e+05, 7.4542e+05],
        [3.9210e+05, 3.9215e+05, 7.8815e+05, 7.6206e+05, 7.7066e+05, 0.0000e+00,
         3.9215e+05, 3.9213e+05, 3.9217e+05, 7.7105e+05, 3.9216e+05, 3.9213e+05,
         3.9214e+05, 7.6069e+05, 3.9211e+05, 7.6987e+05],
        [1.6739e+00, 1.6711e+00, 3.9492e+05, 3.8399e+05, 3.8938e+05, 3.9215e+05,
         0.0000e+00, 1.6901e+00, 1.7261e+00, 3.8770e+05, 1.7070e+00, 1.7758e+00,
         1.7836e+00, 3.7937e+05, 1.7419e+00, 3.8535e+05],
        [1.6448e+00, 1.6220e+00, 3.9490e+05, 3.8400e+05, 3.8936e+05, 3.9213e+05,
         1.6901e+00, 0.0000e+00, 1.5459e+00, 3.8773e+05, 1.7712e+00, 1.5734e+00,
         1.6328e+00, 3.7938e+05, 1.6491e+00, 3.8535e+05],
        [1.6790e+00, 1.6865e+00, 3.9490e+05, 3.8398e+05, 3.8938e+05, 3.9217e+05,
         1.7261e+00, 1.5459e+00, 0.0000e+00, 3.8772e+05, 1.6115e+00, 1.5190e+00,
         1.5586e+00, 3.7937e+05, 1.7960e+00, 3.8536e+05],
        [3.8770e+05, 3.8771e+05, 7.7879e+05, 7.6798e+05, 7.8300e+05, 7.7105e+05,
         3.8770e+05, 3.8773e+05, 3.8772e+05, 0.0000e+00, 3.8771e+05, 3.8773e+05,
         3.8768e+05, 7.6341e+05, 3.8773e+05, 7.7224e+05],
        [1.7733e+00, 1.6768e+00, 3.9493e+05, 3.8397e+05, 3.8942e+05, 3.9216e+05,
         1.7070e+00, 1.7712e+00, 1.6115e+00, 3.8771e+05, 0.0000e+00, 1.6401e+00,
         1.5909e+00, 3.7937e+05, 1.6091e+00, 3.8535e+05],
        [1.7517e+00, 1.7212e+00, 3.9490e+05, 3.8399e+05, 3.8940e+05, 3.9213e+05,
         1.7758e+00, 1.5734e+00, 1.5190e+00, 3.8773e+05, 1.6401e+00, 0.0000e+00,
         1.4539e+00, 3.7934e+05, 1.6970e+00, 3.8536e+05],
        [1.6910e+00, 1.7309e+00, 3.9493e+05, 3.8398e+05, 3.8939e+05, 3.9214e+05,
         1.7836e+00, 1.6328e+00, 1.5586e+00, 3.8768e+05, 1.5909e+00, 1.4539e+00,
         0.0000e+00, 3.7934e+05, 1.6845e+00, 3.8535e+05],
        [3.7935e+05, 3.7934e+05, 7.5305e+05, 7.6754e+05, 7.8556e+05, 7.6069e+05,
         3.7937e+05, 3.7938e+05, 3.7937e+05, 7.6341e+05, 3.7937e+05, 3.7934e+05,
         3.7934e+05, 0.0000e+00, 3.7935e+05, 7.8065e+05],
        [1.7329e+00, 1.5617e+00, 3.9495e+05, 3.8400e+05, 3.8937e+05, 3.9211e+05,
         1.7419e+00, 1.6491e+00, 1.7960e+00, 3.8773e+05, 1.6091e+00, 1.6970e+00,
         1.6845e+00, 3.7935e+05, 0.0000e+00, 3.8535e+05],
        [3.8536e+05, 3.8539e+05, 7.9582e+05, 7.6237e+05, 7.4542e+05, 7.6987e+05,
         3.8535e+05, 3.8535e+05, 3.8536e+05, 7.7224e+05, 3.8535e+05, 3.8536e+05,
         3.8535e+05, 7.8065e+05, 3.8535e+05, 0.0000e+00]])
Krum scores: ['1.69', '1.65', '394912.19', '383984.56', '389376.97', '392131.31', '1.71', '1.62', '1.62', '387706.50', '1.66', '1.62', '1.62', '379352.16', '1.67', '385353.44']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 7, 20, 14, 17, 16, 6, 11, 9, 19, 3, 4, 12, 15, 5, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:01...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:01, End: 2025-07-22 16:02:01)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 6, 3, 7, 9, 5, 10, 17, 13, 19, 4, 12, 14, 20, 15, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4314e+00, 1.5326e+00, 1.4581e+00, 1.7266e+00, 1.5153e+00,
         1.5236e+00, 3.7795e+05, 3.7952e+05, 3.9346e+05, 1.5303e+00, 1.5041e+00,
         3.9548e+05, 3.9621e+05, 3.9309e+05, 3.8341e+05],
        [1.4314e+00, 0.0000e+00, 1.4973e+00, 1.4497e+00, 1.9221e+00, 1.4417e+00,
         1.5664e+00, 3.7799e+05, 3.7956e+05, 3.9346e+05, 1.4902e+00, 1.5267e+00,
         3.9549e+05, 3.9620e+05, 3.9307e+05, 3.8342e+05],
        [1.5326e+00, 1.4973e+00, 0.0000e+00, 1.5091e+00, 1.6760e+00, 1.4395e+00,
         1.4353e+00, 3.7798e+05, 3.7952e+05, 3.9343e+05, 1.4664e+00, 1.4201e+00,
         3.9546e+05, 3.9618e+05, 3.9308e+05, 3.8340e+05],
        [1.4581e+00, 1.4497e+00, 1.5091e+00, 0.0000e+00, 1.8690e+00, 1.4273e+00,
         1.4759e+00, 3.7798e+05, 3.7954e+05, 3.9346e+05, 1.4853e+00, 1.5005e+00,
         3.9552e+05, 3.9618e+05, 3.9310e+05, 3.8335e+05],
        [1.7266e+00, 1.9221e+00, 1.6760e+00, 1.8690e+00, 0.0000e+00, 1.7817e+00,
         1.5271e+00, 3.7793e+05, 3.7952e+05, 3.9344e+05, 1.4776e+00, 1.5086e+00,
         3.9551e+05, 3.9614e+05, 3.9310e+05, 3.8342e+05],
        [1.5153e+00, 1.4417e+00, 1.4395e+00, 1.4273e+00, 1.7817e+00, 0.0000e+00,
         1.4564e+00, 3.7794e+05, 3.7953e+05, 3.9346e+05, 1.4337e+00, 1.4142e+00,
         3.9551e+05, 3.9620e+05, 3.9310e+05, 3.8338e+05],
        [1.5236e+00, 1.5664e+00, 1.4353e+00, 1.4759e+00, 1.5271e+00, 1.4564e+00,
         0.0000e+00, 3.7799e+05, 3.7952e+05, 3.9342e+05, 1.4262e+00, 1.3372e+00,
         3.9551e+05, 3.9618e+05, 3.9309e+05, 3.8338e+05],
        [3.7795e+05, 3.7799e+05, 3.7798e+05, 3.7798e+05, 3.7793e+05, 3.7794e+05,
         3.7799e+05, 0.0000e+00, 7.5085e+05, 7.8346e+05, 3.7796e+05, 3.7801e+05,
         7.6943e+05, 7.6562e+05, 7.8661e+05, 7.6813e+05],
        [3.7952e+05, 3.7956e+05, 3.7952e+05, 3.7954e+05, 3.7952e+05, 3.7953e+05,
         3.7952e+05, 7.5085e+05, 0.0000e+00, 7.6490e+05, 3.7953e+05, 3.7952e+05,
         7.9120e+05, 7.6017e+05, 7.7475e+05, 7.7547e+05],
        [3.9346e+05, 3.9346e+05, 3.9343e+05, 3.9346e+05, 3.9344e+05, 3.9346e+05,
         3.9342e+05, 7.8346e+05, 7.6490e+05, 0.0000e+00, 3.9343e+05, 3.9342e+05,
         7.9836e+05, 7.8025e+05, 7.9288e+05, 7.8670e+05],
        [1.5303e+00, 1.4902e+00, 1.4664e+00, 1.4853e+00, 1.4776e+00, 1.4337e+00,
         1.4262e+00, 3.7796e+05, 3.7953e+05, 3.9343e+05, 0.0000e+00, 1.3112e+00,
         3.9549e+05, 3.9621e+05, 3.9307e+05, 3.8340e+05],
        [1.5041e+00, 1.5267e+00, 1.4201e+00, 1.5005e+00, 1.5086e+00, 1.4142e+00,
         1.3372e+00, 3.7801e+05, 3.7952e+05, 3.9342e+05, 1.3112e+00, 0.0000e+00,
         3.9547e+05, 3.9616e+05, 3.9311e+05, 3.8339e+05],
        [3.9548e+05, 3.9549e+05, 3.9546e+05, 3.9552e+05, 3.9551e+05, 3.9551e+05,
         3.9551e+05, 7.6943e+05, 7.9120e+05, 7.9836e+05, 3.9549e+05, 3.9547e+05,
         0.0000e+00, 7.6971e+05, 7.8103e+05, 7.8990e+05],
        [3.9621e+05, 3.9620e+05, 3.9618e+05, 3.9618e+05, 3.9614e+05, 3.9620e+05,
         3.9618e+05, 7.6562e+05, 7.6017e+05, 7.8025e+05, 3.9621e+05, 3.9616e+05,
         7.6971e+05, 0.0000e+00, 7.8794e+05, 7.6397e+05],
        [3.9309e+05, 3.9307e+05, 3.9308e+05, 3.9310e+05, 3.9310e+05, 3.9310e+05,
         3.9309e+05, 7.8661e+05, 7.7475e+05, 7.9288e+05, 3.9307e+05, 3.9311e+05,
         7.8103e+05, 7.8794e+05, 0.0000e+00, 7.8161e+05],
        [3.8341e+05, 3.8342e+05, 3.8340e+05, 3.8335e+05, 3.8342e+05, 3.8338e+05,
         3.8338e+05, 7.6813e+05, 7.7547e+05, 7.8670e+05, 3.8340e+05, 3.8339e+05,
         7.8990e+05, 7.6397e+05, 7.8161e+05, 0.0000e+00]])
Krum scores: ['1.50', '1.49', '1.47', '1.47', '1.65', '1.45', '1.45', '377961.25', '379521.66', '393434.22', '1.44', '1.43', '395486.66', '396176.91', '393085.41', '383386.66']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 6, 3, 7, 9, 5, 10, 17, 13, 19, 4, 12, 14, 20, 15, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:02...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 72 191]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:02, End: 2025-07-22 16:02:02)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 13, 15, 8, 19, 7, 9, 11, 14, 12, 6, 18, 2, 4, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.7071e+05, 7.9763e+05, 3.9169e+05, 7.6549e+05, 3.9174e+05,
         3.9171e+05, 3.9170e+05, 7.9154e+05, 3.9171e+05, 3.9171e+05, 7.8277e+05,
         3.9173e+05, 3.9171e+05, 3.9171e+05, 7.7265e+05],
        [7.7071e+05, 0.0000e+00, 7.7348e+05, 3.8080e+05, 7.6104e+05, 3.8078e+05,
         3.8078e+05, 3.8083e+05, 7.4797e+05, 3.8078e+05, 3.8078e+05, 7.7432e+05,
         3.8078e+05, 3.8082e+05, 3.8077e+05, 7.7047e+05],
        [7.9763e+05, 7.7348e+05, 0.0000e+00, 4.0772e+05, 7.9190e+05, 4.0773e+05,
         4.0771e+05, 4.0772e+05, 8.0144e+05, 4.0774e+05, 4.0771e+05, 7.9709e+05,
         4.0776e+05, 4.0775e+05, 4.0772e+05, 7.9616e+05],
        [3.9169e+05, 3.8080e+05, 4.0772e+05, 0.0000e+00, 3.8341e+05, 1.5209e+00,
         1.7350e+00, 1.5331e+00, 3.8812e+05, 1.9368e+00, 1.4511e+00, 3.9135e+05,
         1.6888e+00, 1.5652e+00, 1.4548e+00, 3.9324e+05],
        [7.6549e+05, 7.6104e+05, 7.9190e+05, 3.8341e+05, 0.0000e+00, 3.8339e+05,
         3.8341e+05, 3.8341e+05, 7.6501e+05, 3.8342e+05, 3.8341e+05, 7.7135e+05,
         3.8343e+05, 3.8342e+05, 3.8346e+05, 7.5327e+05],
        [3.9174e+05, 3.8078e+05, 4.0773e+05, 1.5209e+00, 3.8339e+05, 0.0000e+00,
         1.6969e+00, 1.4162e+00, 3.8815e+05, 1.9828e+00, 1.4750e+00, 3.9130e+05,
         1.5911e+00, 1.5566e+00, 1.4487e+00, 3.9327e+05],
        [3.9171e+05, 3.8078e+05, 4.0771e+05, 1.7350e+00, 3.8341e+05, 1.6969e+00,
         0.0000e+00, 1.3608e+00, 3.8820e+05, 1.4028e+00, 1.7329e+00, 3.9131e+05,
         1.3257e+00, 1.3668e+00, 1.3704e+00, 3.9325e+05],
        [3.9170e+05, 3.8083e+05, 4.0772e+05, 1.5331e+00, 3.8341e+05, 1.4162e+00,
         1.3608e+00, 0.0000e+00, 3.8822e+05, 1.6779e+00, 1.4567e+00, 3.9130e+05,
         1.4195e+00, 1.3637e+00, 1.4284e+00, 3.9327e+05],
        [7.9154e+05, 7.4797e+05, 8.0144e+05, 3.8812e+05, 7.6501e+05, 3.8815e+05,
         3.8820e+05, 3.8822e+05, 0.0000e+00, 3.8817e+05, 3.8818e+05, 7.8459e+05,
         3.8820e+05, 3.8822e+05, 3.8815e+05, 7.7253e+05],
        [3.9171e+05, 3.8078e+05, 4.0774e+05, 1.9368e+00, 3.8342e+05, 1.9828e+00,
         1.4028e+00, 1.6779e+00, 3.8817e+05, 0.0000e+00, 1.9533e+00, 3.9129e+05,
         1.4777e+00, 1.4663e+00, 1.5339e+00, 3.9325e+05],
        [3.9171e+05, 3.8078e+05, 4.0771e+05, 1.4511e+00, 3.8341e+05, 1.4750e+00,
         1.7329e+00, 1.4567e+00, 3.8818e+05, 1.9533e+00, 0.0000e+00, 3.9132e+05,
         1.5545e+00, 1.5365e+00, 1.5397e+00, 3.9326e+05],
        [7.8277e+05, 7.7432e+05, 7.9709e+05, 3.9135e+05, 7.7135e+05, 3.9130e+05,
         3.9131e+05, 3.9130e+05, 7.8459e+05, 3.9129e+05, 3.9132e+05, 0.0000e+00,
         3.9133e+05, 3.9130e+05, 3.9134e+05, 7.9715e+05],
        [3.9173e+05, 3.8078e+05, 4.0776e+05, 1.6888e+00, 3.8343e+05, 1.5911e+00,
         1.3257e+00, 1.4195e+00, 3.8820e+05, 1.4777e+00, 1.5545e+00, 3.9133e+05,
         0.0000e+00, 1.2810e+00, 1.3409e+00, 3.9326e+05],
        [3.9171e+05, 3.8082e+05, 4.0775e+05, 1.5652e+00, 3.8342e+05, 1.5566e+00,
         1.3668e+00, 1.3637e+00, 3.8822e+05, 1.4663e+00, 1.5365e+00, 3.9130e+05,
         1.2810e+00, 0.0000e+00, 1.4435e+00, 3.9325e+05],
        [3.9171e+05, 3.8077e+05, 4.0772e+05, 1.4548e+00, 3.8346e+05, 1.4487e+00,
         1.3704e+00, 1.4284e+00, 3.8815e+05, 1.5339e+00, 1.5397e+00, 3.9134e+05,
         1.3409e+00, 1.4435e+00, 0.0000e+00, 3.9325e+05],
        [7.7265e+05, 7.7047e+05, 7.9616e+05, 3.9324e+05, 7.5327e+05, 3.9327e+05,
         3.9325e+05, 3.9327e+05, 7.7253e+05, 3.9325e+05, 3.9326e+05, 7.9715e+05,
         3.9326e+05, 3.9325e+05, 3.9325e+05, 0.0000e+00]])
Krum scores: ['391707.09', '380780.16', '407720.84', '1.56', '383409.84', '1.53', '1.47', '1.43', '388168.97', '1.64', '1.54', '391307.16', '1.43', '1.43', '1.43', '393250.94']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 13, 15, 8, 19, 7, 9, 11, 14, 12, 6, 18, 2, 4, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0072s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:02...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 49 214]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:02, End: 2025-07-22 16:02:02)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 17, 15, 11, 16, 19, 12, 18, 6, 10, 2, 1, 5, 7, 8, 9], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9440e+05, 3.8225e+05, 1.3549e+00, 4.0533e+05, 4.0083e+05,
         1.2762e+00, 3.9630e+05, 1.4684e+00, 1.3628e+00, 1.2339e+00, 1.4505e+00,
         1.3918e+00, 1.4624e+00, 1.4713e+00, 1.3026e+00],
        [3.9440e+05, 0.0000e+00, 7.8843e+05, 3.9440e+05, 7.8686e+05, 7.8874e+05,
         3.9438e+05, 7.8234e+05, 3.9441e+05, 3.9441e+05, 3.9441e+05, 3.9442e+05,
         3.9440e+05, 3.9440e+05, 3.9444e+05, 3.9440e+05],
        [3.8225e+05, 7.8843e+05, 0.0000e+00, 3.8229e+05, 7.6717e+05, 7.9304e+05,
         3.8226e+05, 7.8997e+05, 3.8223e+05, 3.8225e+05, 3.8226e+05, 3.8225e+05,
         3.8225e+05, 3.8227e+05, 3.8226e+05, 3.8226e+05],
        [1.3549e+00, 3.9440e+05, 3.8229e+05, 0.0000e+00, 4.0532e+05, 4.0083e+05,
         1.3307e+00, 3.9632e+05, 1.7443e+00, 1.4672e+00, 1.3884e+00, 1.5895e+00,
         1.5671e+00, 1.6893e+00, 1.7885e+00, 1.2974e+00],
        [4.0533e+05, 7.8686e+05, 7.6717e+05, 4.0532e+05, 0.0000e+00, 8.0237e+05,
         4.0536e+05, 7.9026e+05, 4.0531e+05, 4.0535e+05, 4.0531e+05, 4.0534e+05,
         4.0533e+05, 4.0534e+05, 4.0533e+05, 4.0534e+05],
        [4.0083e+05, 7.8874e+05, 7.9304e+05, 4.0083e+05, 8.0237e+05, 0.0000e+00,
         4.0081e+05, 7.8741e+05, 4.0083e+05, 4.0079e+05, 4.0083e+05, 4.0080e+05,
         4.0080e+05, 4.0080e+05, 4.0085e+05, 4.0081e+05],
        [1.2762e+00, 3.9438e+05, 3.8226e+05, 1.3307e+00, 4.0536e+05, 4.0081e+05,
         0.0000e+00, 3.9633e+05, 1.7438e+00, 1.3382e+00, 1.3440e+00, 1.5791e+00,
         1.5317e+00, 1.7908e+00, 1.7265e+00, 1.2415e+00],
        [3.9630e+05, 7.8234e+05, 7.8997e+05, 3.9632e+05, 7.9026e+05, 7.8741e+05,
         3.9633e+05, 0.0000e+00, 3.9635e+05, 3.9631e+05, 3.9632e+05, 3.9635e+05,
         3.9633e+05, 3.9634e+05, 3.9632e+05, 3.9634e+05],
        [1.4684e+00, 3.9441e+05, 3.8223e+05, 1.7443e+00, 4.0531e+05, 4.0083e+05,
         1.7438e+00, 3.9635e+05, 0.0000e+00, 1.5465e+00, 1.5465e+00, 1.4592e+00,
         1.4739e+00, 1.5051e+00, 1.4432e+00, 1.7025e+00],
        [1.3628e+00, 3.9441e+05, 3.8225e+05, 1.4672e+00, 4.0535e+05, 4.0079e+05,
         1.3382e+00, 3.9631e+05, 1.5465e+00, 0.0000e+00, 1.2943e+00, 1.4377e+00,
         1.4515e+00, 1.4575e+00, 1.4642e+00, 1.3675e+00],
        [1.2339e+00, 3.9441e+05, 3.8226e+05, 1.3884e+00, 4.0531e+05, 4.0083e+05,
         1.3440e+00, 3.9632e+05, 1.5465e+00, 1.2943e+00, 0.0000e+00, 1.5409e+00,
         1.5390e+00, 1.5948e+00, 1.6543e+00, 1.2865e+00],
        [1.4505e+00, 3.9442e+05, 3.8225e+05, 1.5895e+00, 4.0534e+05, 4.0080e+05,
         1.5791e+00, 3.9635e+05, 1.4592e+00, 1.4377e+00, 1.5409e+00, 0.0000e+00,
         1.4005e+00, 1.4159e+00, 1.5535e+00, 1.5611e+00],
        [1.3918e+00, 3.9440e+05, 3.8225e+05, 1.5671e+00, 4.0533e+05, 4.0080e+05,
         1.5317e+00, 3.9633e+05, 1.4739e+00, 1.4515e+00, 1.5390e+00, 1.4005e+00,
         0.0000e+00, 1.4168e+00, 1.6207e+00, 1.5704e+00],
        [1.4624e+00, 3.9440e+05, 3.8227e+05, 1.6893e+00, 4.0534e+05, 4.0080e+05,
         1.7908e+00, 3.9634e+05, 1.5051e+00, 1.4575e+00, 1.5948e+00, 1.4159e+00,
         1.4168e+00, 0.0000e+00, 1.5101e+00, 1.6592e+00],
        [1.4713e+00, 3.9444e+05, 3.8226e+05, 1.7885e+00, 4.0533e+05, 4.0085e+05,
         1.7265e+00, 3.9632e+05, 1.4432e+00, 1.4642e+00, 1.6543e+00, 1.5535e+00,
         1.6207e+00, 1.5101e+00, 0.0000e+00, 1.7102e+00],
        [1.3026e+00, 3.9440e+05, 3.8226e+05, 1.2974e+00, 4.0534e+05, 4.0081e+05,
         1.2415e+00, 3.9634e+05, 1.7025e+00, 1.3675e+00, 1.2865e+00, 1.5611e+00,
         1.5704e+00, 1.6592e+00, 1.7102e+00, 0.0000e+00]])
Krum scores: ['1.37', '394402.06', '382252.59', '1.49', '405326.62', '400811.09', '1.46', '396323.31', '1.54', '1.40', '1.42', '1.49', '1.48', '1.52', '1.57', '1.44']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 17, 15, 11, 16, 19, 12, 18, 6, 10, 2, 1, 5, 7, 8, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:03...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:03, End: 2025-07-22 16:02:03)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 5, 16, 11, 10, 3, 15, 13, 6, 7, 2, 4, 8, 12, 19, 20], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4040e+00, 3.8565e+05, 1.3598e+00, 1.3494e+00, 1.3930e+00,
         3.9544e+05, 4.0782e+05, 1.3820e+00, 1.2965e+00, 1.4237e+00, 1.7700e+00,
         1.5026e+00, 1.5020e+00, 3.8156e+05, 4.0189e+05],
        [1.4040e+00, 0.0000e+00, 3.8563e+05, 1.3831e+00, 1.3923e+00, 1.3729e+00,
         3.9545e+05, 4.0782e+05, 1.4561e+00, 1.4196e+00, 1.4868e+00, 1.7905e+00,
         1.6067e+00, 1.5174e+00, 3.8161e+05, 4.0192e+05],
        [3.8565e+05, 3.8563e+05, 0.0000e+00, 3.8562e+05, 3.8564e+05, 3.8566e+05,
         7.6730e+05, 7.8330e+05, 3.8562e+05, 3.8562e+05, 3.8560e+05, 3.8563e+05,
         3.8562e+05, 3.8563e+05, 7.8281e+05, 7.8140e+05],
        [1.3598e+00, 1.3831e+00, 3.8562e+05, 0.0000e+00, 1.3238e+00, 1.4704e+00,
         3.9542e+05, 4.0781e+05, 1.5122e+00, 1.4781e+00, 1.2158e+00, 1.2880e+00,
         1.5655e+00, 1.2187e+00, 3.8160e+05, 4.0193e+05],
        [1.3494e+00, 1.3923e+00, 3.8564e+05, 1.3238e+00, 0.0000e+00, 1.3338e+00,
         3.9543e+05, 4.0783e+05, 1.4522e+00, 1.3594e+00, 1.2202e+00, 1.5372e+00,
         1.3691e+00, 1.3163e+00, 3.8160e+05, 4.0193e+05],
        [1.3930e+00, 1.3729e+00, 3.8566e+05, 1.4704e+00, 1.3338e+00, 0.0000e+00,
         3.9546e+05, 4.0780e+05, 1.4224e+00, 1.3919e+00, 1.4648e+00, 1.7843e+00,
         1.4052e+00, 1.4733e+00, 3.8160e+05, 4.0192e+05],
        [3.9544e+05, 3.9545e+05, 7.6730e+05, 3.9542e+05, 3.9543e+05, 3.9546e+05,
         0.0000e+00, 7.7530e+05, 3.9544e+05, 3.9548e+05, 3.9543e+05, 3.9543e+05,
         3.9544e+05, 3.9545e+05, 7.7124e+05, 7.9080e+05],
        [4.0782e+05, 4.0782e+05, 7.8330e+05, 4.0781e+05, 4.0783e+05, 4.0780e+05,
         7.7530e+05, 0.0000e+00, 4.0784e+05, 4.0782e+05, 4.0784e+05, 4.0783e+05,
         4.0783e+05, 4.0782e+05, 7.8897e+05, 7.9128e+05],
        [1.3820e+00, 1.4561e+00, 3.8562e+05, 1.5122e+00, 1.4522e+00, 1.4224e+00,
         3.9544e+05, 4.0784e+05, 0.0000e+00, 1.3974e+00, 1.4947e+00, 1.9030e+00,
         1.3940e+00, 1.6713e+00, 3.8159e+05, 4.0189e+05],
        [1.2965e+00, 1.4196e+00, 3.8562e+05, 1.4781e+00, 1.3594e+00, 1.3919e+00,
         3.9548e+05, 4.0782e+05, 1.3974e+00, 0.0000e+00, 1.5063e+00, 1.9023e+00,
         1.4261e+00, 1.7198e+00, 3.8157e+05, 4.0193e+05],
        [1.4237e+00, 1.4868e+00, 3.8560e+05, 1.2158e+00, 1.2202e+00, 1.4648e+00,
         3.9543e+05, 4.0784e+05, 1.4947e+00, 1.5063e+00, 0.0000e+00, 1.2987e+00,
         1.5588e+00, 1.2925e+00, 3.8161e+05, 4.0189e+05],
        [1.7700e+00, 1.7905e+00, 3.8563e+05, 1.2880e+00, 1.5372e+00, 1.7843e+00,
         3.9543e+05, 4.0783e+05, 1.9030e+00, 1.9023e+00, 1.2987e+00, 0.0000e+00,
         1.9050e+00, 1.2855e+00, 3.8159e+05, 4.0191e+05],
        [1.5026e+00, 1.6067e+00, 3.8562e+05, 1.5655e+00, 1.3691e+00, 1.4052e+00,
         3.9544e+05, 4.0783e+05, 1.3940e+00, 1.4261e+00, 1.5588e+00, 1.9050e+00,
         0.0000e+00, 1.7069e+00, 3.8156e+05, 4.0190e+05],
        [1.5020e+00, 1.5174e+00, 3.8563e+05, 1.2187e+00, 1.3163e+00, 1.4733e+00,
         3.9545e+05, 4.0782e+05, 1.6713e+00, 1.7198e+00, 1.2925e+00, 1.2855e+00,
         1.7069e+00, 0.0000e+00, 3.8160e+05, 4.0192e+05],
        [3.8156e+05, 3.8161e+05, 7.8281e+05, 3.8160e+05, 3.8160e+05, 3.8160e+05,
         7.7124e+05, 7.8897e+05, 3.8159e+05, 3.8157e+05, 3.8161e+05, 3.8159e+05,
         3.8156e+05, 3.8160e+05, 0.0000e+00, 7.8819e+05],
        [4.0189e+05, 4.0192e+05, 7.8140e+05, 4.0193e+05, 4.0193e+05, 4.0192e+05,
         7.9080e+05, 7.9128e+05, 4.0189e+05, 4.0193e+05, 4.0189e+05, 4.0191e+05,
         4.0190e+05, 4.0192e+05, 7.8819e+05, 0.0000e+00]])
Krum scores: ['1.40', '1.45', '385623.16', '1.36', '1.35', '1.41', '395436.06', '407818.91', '1.46', '1.44', '1.38', '1.62', '1.50', '1.44', '381584.09', '401907.69']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 5, 16, 11, 10, 3, 15, 13, 6, 7, 2, 4, 8, 12, 19, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0206s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:04...
global Accuracy on shared test data: 73.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[164  73]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:04, End: 2025-07-22 16:02:04)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 20, 9, 14, 2, 6, 16, 4, 8, 13, 12, 1, 17, 5, 7, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.5570e+05, 3.7186e+05, 7.8290e+05, 3.7185e+05, 3.7182e+05,
         7.6172e+05, 3.7188e+05, 3.7184e+05, 7.6756e+05, 3.7184e+05, 3.7180e+05,
         7.6265e+05, 3.7181e+05, 3.7184e+05, 7.6663e+05],
        [7.5570e+05, 0.0000e+00, 3.9509e+05, 8.0585e+05, 3.9510e+05, 3.9507e+05,
         7.7967e+05, 3.9510e+05, 3.9509e+05, 7.8547e+05, 3.9506e+05, 3.9508e+05,
         7.5710e+05, 3.9511e+05, 3.9511e+05, 7.9078e+05],
        [3.7186e+05, 3.9509e+05, 0.0000e+00, 4.1170e+05, 1.1951e+00, 1.5477e+00,
         3.8005e+05, 1.1871e+00, 1.5338e+00, 4.0219e+05, 1.1823e+00, 1.4267e+00,
         3.8998e+05, 1.4498e+00, 1.5574e+00, 3.9297e+05],
        [7.8290e+05, 8.0585e+05, 4.1170e+05, 0.0000e+00, 4.1169e+05, 4.1168e+05,
         7.8631e+05, 4.1168e+05, 4.1165e+05, 8.1654e+05, 4.1168e+05, 4.1169e+05,
         8.2944e+05, 4.1166e+05, 4.1169e+05, 8.1718e+05],
        [3.7185e+05, 3.9510e+05, 1.1951e+00, 4.1169e+05, 0.0000e+00, 1.3588e+00,
         3.8005e+05, 1.1743e+00, 1.5287e+00, 4.0222e+05, 1.2407e+00, 1.3463e+00,
         3.8997e+05, 1.3836e+00, 1.4432e+00, 3.9296e+05],
        [3.7182e+05, 3.9507e+05, 1.5477e+00, 4.1168e+05, 1.3588e+00, 0.0000e+00,
         3.8005e+05, 1.6396e+00, 1.3101e+00, 4.0223e+05, 1.5784e+00, 1.2855e+00,
         3.8994e+05, 1.3438e+00, 1.3410e+00, 3.9293e+05],
        [7.6172e+05, 7.7967e+05, 3.8005e+05, 7.8631e+05, 3.8005e+05, 3.8005e+05,
         0.0000e+00, 3.8003e+05, 3.8008e+05, 7.6207e+05, 3.8004e+05, 3.8007e+05,
         7.8344e+05, 3.8006e+05, 3.8005e+05, 7.4495e+05],
        [3.7188e+05, 3.9510e+05, 1.1871e+00, 4.1168e+05, 1.1743e+00, 1.6396e+00,
         3.8003e+05, 0.0000e+00, 1.6805e+00, 4.0219e+05, 1.1555e+00, 1.5536e+00,
         3.8997e+05, 1.5518e+00, 1.6772e+00, 3.9298e+05],
        [3.7184e+05, 3.9509e+05, 1.5338e+00, 4.1165e+05, 1.5287e+00, 1.3101e+00,
         3.8008e+05, 1.6805e+00, 0.0000e+00, 4.0222e+05, 1.6350e+00, 1.3427e+00,
         3.8995e+05, 1.4990e+00, 1.4075e+00, 3.9296e+05],
        [7.6756e+05, 7.8547e+05, 4.0219e+05, 8.1654e+05, 4.0222e+05, 4.0223e+05,
         7.6207e+05, 4.0219e+05, 4.0222e+05, 0.0000e+00, 4.0223e+05, 4.0220e+05,
         7.8099e+05, 4.0221e+05, 4.0221e+05, 7.9014e+05],
        [3.7184e+05, 3.9506e+05, 1.1823e+00, 4.1168e+05, 1.2407e+00, 1.5784e+00,
         3.8004e+05, 1.1555e+00, 1.6350e+00, 4.0223e+05, 0.0000e+00, 1.4942e+00,
         3.8995e+05, 1.4301e+00, 1.6723e+00, 3.9298e+05],
        [3.7180e+05, 3.9508e+05, 1.4267e+00, 4.1169e+05, 1.3463e+00, 1.2855e+00,
         3.8007e+05, 1.5536e+00, 1.3427e+00, 4.0220e+05, 1.4942e+00, 0.0000e+00,
         3.8996e+05, 1.3078e+00, 1.2675e+00, 3.9296e+05],
        [7.6265e+05, 7.5710e+05, 3.8998e+05, 8.2944e+05, 3.8997e+05, 3.8994e+05,
         7.8344e+05, 3.8997e+05, 3.8995e+05, 7.8099e+05, 3.8995e+05, 3.8996e+05,
         0.0000e+00, 3.8995e+05, 3.8993e+05, 7.6075e+05],
        [3.7181e+05, 3.9511e+05, 1.4498e+00, 4.1166e+05, 1.3836e+00, 1.3438e+00,
         3.8006e+05, 1.5518e+00, 1.4990e+00, 4.0221e+05, 1.4301e+00, 1.3078e+00,
         3.8995e+05, 0.0000e+00, 1.3546e+00, 3.9298e+05],
        [3.7184e+05, 3.9511e+05, 1.5574e+00, 4.1169e+05, 1.4432e+00, 1.3410e+00,
         3.8005e+05, 1.6772e+00, 1.4075e+00, 4.0221e+05, 1.6723e+00, 1.2675e+00,
         3.8993e+05, 1.3546e+00, 0.0000e+00, 3.9295e+05],
        [7.6663e+05, 7.9078e+05, 3.9297e+05, 8.1718e+05, 3.9296e+05, 3.9293e+05,
         7.4495e+05, 3.9298e+05, 3.9296e+05, 7.9014e+05, 3.9298e+05, 3.9296e+05,
         7.6075e+05, 3.9298e+05, 3.9295e+05, 0.0000e+00]])
Krum scores: ['371828.66', '395083.34', '1.36', '411674.28', '1.31', '1.40', '380046.78', '1.42', '1.47', '402206.00', '1.39', '1.35', '389949.78', '1.40', '1.43', '392958.22']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 20, 9, 14, 2, 6, 16, 4, 8, 13, 12, 1, 17, 5, 7, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0047s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:04...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:04, End: 2025-07-22 16:02:04)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 8, 2, 19, 4, 16, 20, 1, 7, 10, 6, 11, 14, 17, 18, 5], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2736e+00, 1.7872e+00, 3.8761e+05, 1.5141e+00, 3.8700e+05,
         3.8203e+05, 1.2493e+00, 1.2626e+00, 1.3906e+00, 1.2930e+00, 1.3262e+00,
         3.7876e+05, 3.9481e+05, 3.9933e+05, 1.2391e+00],
        [1.2736e+00, 0.0000e+00, 1.9201e+00, 3.8763e+05, 1.5401e+00, 3.8701e+05,
         3.8204e+05, 1.2871e+00, 1.2669e+00, 1.4372e+00, 1.2023e+00, 1.3602e+00,
         3.7876e+05, 3.9481e+05, 3.9930e+05, 1.3973e+00],
        [1.7872e+00, 1.9201e+00, 0.0000e+00, 3.8762e+05, 1.1298e+00, 3.8697e+05,
         3.8205e+05, 1.8012e+00, 1.9086e+00, 1.1543e+00, 1.8381e+00, 1.3750e+00,
         3.7879e+05, 3.9484e+05, 3.9931e+05, 1.7428e+00],
        [3.8761e+05, 3.8763e+05, 3.8762e+05, 0.0000e+00, 3.8762e+05, 7.8549e+05,
         7.8224e+05, 3.8760e+05, 3.8763e+05, 3.8760e+05, 3.8763e+05, 3.8761e+05,
         7.8670e+05, 7.8270e+05, 7.8371e+05, 3.8759e+05],
        [1.5141e+00, 1.5401e+00, 1.1298e+00, 3.8762e+05, 0.0000e+00, 3.8701e+05,
         3.8206e+05, 1.5092e+00, 1.5951e+00, 1.0819e+00, 1.5456e+00, 1.1203e+00,
         3.7878e+05, 3.9484e+05, 3.9932e+05, 1.4799e+00],
        [3.8700e+05, 3.8701e+05, 3.8697e+05, 7.8549e+05, 3.8701e+05, 0.0000e+00,
         7.7036e+05, 3.8703e+05, 3.8703e+05, 3.8700e+05, 3.8701e+05, 3.8702e+05,
         7.6283e+05, 7.8024e+05, 7.9839e+05, 3.8700e+05],
        [3.8203e+05, 3.8204e+05, 3.8205e+05, 7.8224e+05, 3.8206e+05, 7.7036e+05,
         0.0000e+00, 3.8204e+05, 3.8201e+05, 3.8205e+05, 3.8203e+05, 3.8208e+05,
         7.6565e+05, 7.8126e+05, 7.6498e+05, 3.8206e+05],
        [1.2493e+00, 1.2871e+00, 1.8012e+00, 3.8760e+05, 1.5092e+00, 3.8703e+05,
         3.8204e+05, 0.0000e+00, 1.1762e+00, 1.3667e+00, 1.2524e+00, 1.2362e+00,
         3.7878e+05, 3.9482e+05, 3.9930e+05, 1.2530e+00],
        [1.2626e+00, 1.2669e+00, 1.9086e+00, 3.8763e+05, 1.5951e+00, 3.8703e+05,
         3.8201e+05, 1.1762e+00, 0.0000e+00, 1.4356e+00, 1.2388e+00, 1.2567e+00,
         3.7876e+05, 3.9484e+05, 3.9932e+05, 1.2593e+00],
        [1.3906e+00, 1.4372e+00, 1.1543e+00, 3.8760e+05, 1.0819e+00, 3.8700e+05,
         3.8205e+05, 1.3667e+00, 1.4356e+00, 0.0000e+00, 1.4755e+00, 1.1172e+00,
         3.7876e+05, 3.9484e+05, 3.9935e+05, 1.3340e+00],
        [1.2930e+00, 1.2023e+00, 1.8381e+00, 3.8763e+05, 1.5456e+00, 3.8701e+05,
         3.8203e+05, 1.2524e+00, 1.2388e+00, 1.4755e+00, 0.0000e+00, 1.3318e+00,
         3.7875e+05, 3.9479e+05, 3.9930e+05, 1.3414e+00],
        [1.3262e+00, 1.3602e+00, 1.3750e+00, 3.8761e+05, 1.1203e+00, 3.8702e+05,
         3.8208e+05, 1.2362e+00, 1.2567e+00, 1.1172e+00, 1.3318e+00, 0.0000e+00,
         3.7874e+05, 3.9481e+05, 3.9932e+05, 1.2227e+00],
        [3.7876e+05, 3.7876e+05, 3.7879e+05, 7.8670e+05, 3.7878e+05, 7.6283e+05,
         7.6565e+05, 3.7878e+05, 3.7876e+05, 3.7876e+05, 3.7875e+05, 3.7874e+05,
         0.0000e+00, 7.6818e+05, 7.8378e+05, 3.7877e+05],
        [3.9481e+05, 3.9481e+05, 3.9484e+05, 7.8270e+05, 3.9484e+05, 7.8024e+05,
         7.8126e+05, 3.9482e+05, 3.9484e+05, 3.9484e+05, 3.9479e+05, 3.9481e+05,
         7.6818e+05, 0.0000e+00, 7.9706e+05, 3.9483e+05],
        [3.9933e+05, 3.9930e+05, 3.9931e+05, 7.8371e+05, 3.9932e+05, 7.9839e+05,
         7.6498e+05, 3.9930e+05, 3.9932e+05, 3.9935e+05, 3.9930e+05, 3.9932e+05,
         7.8378e+05, 7.9706e+05, 0.0000e+00, 3.9929e+05],
        [1.2391e+00, 1.3973e+00, 1.7428e+00, 3.8759e+05, 1.4799e+00, 3.8700e+05,
         3.8206e+05, 1.2530e+00, 1.2593e+00, 1.3340e+00, 1.3414e+00, 1.2227e+00,
         3.7877e+05, 3.9483e+05, 3.9929e+05, 0.0000e+00]])
Krum scores: ['1.32', '1.35', '1.59', '387612.12', '1.37', '387003.28', '382039.97', '1.29', '1.31', '1.29', '1.34', '1.25', '378759.78', '394818.78', '399308.19', '1.32']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 8, 2, 19, 4, 16, 20, 1, 7, 10, 6, 11, 14, 17, 18, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0227s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:05...
global Accuracy on shared test data: 72.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[158  79]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:05, End: 2025-07-22 16:02:05)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 16, 8, 1, 9, 14, 11, 4, 6, 17, 2, 15, 12, 5, 7, 3], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9242e+05, 1.4309e+00, 1.4062e+00, 1.1104e+00, 4.0627e+05,
         1.1857e+00, 1.0890e+00, 1.4545e+00, 3.9969e+05, 1.0197e+00, 3.9162e+05,
         1.0207e+00, 1.3401e+00, 1.4402e+00, 1.3756e+00],
        [3.9242e+05, 0.0000e+00, 3.9243e+05, 3.9243e+05, 3.9245e+05, 7.9743e+05,
         3.9245e+05, 3.9246e+05, 3.9241e+05, 7.7894e+05, 3.9242e+05, 7.8645e+05,
         3.9244e+05, 3.9246e+05, 3.9242e+05, 3.9243e+05],
        [1.4309e+00, 3.9243e+05, 0.0000e+00, 1.3013e+00, 1.4582e+00, 4.0625e+05,
         1.8265e+00, 1.5630e+00, 1.2341e+00, 3.9969e+05, 1.5905e+00, 3.9164e+05,
         1.4232e+00, 1.3946e+00, 1.2585e+00, 1.2520e+00],
        [1.4062e+00, 3.9243e+05, 1.3013e+00, 0.0000e+00, 1.3619e+00, 4.0627e+05,
         1.6233e+00, 1.4909e+00, 1.2358e+00, 3.9971e+05, 1.4831e+00, 3.9164e+05,
         1.3238e+00, 1.2269e+00, 1.1636e+00, 1.2081e+00],
        [1.1104e+00, 3.9245e+05, 1.4582e+00, 1.3619e+00, 0.0000e+00, 4.0626e+05,
         1.2140e+00, 1.1063e+00, 1.4308e+00, 3.9971e+05, 1.0788e+00, 3.9163e+05,
         1.0654e+00, 1.3547e+00, 1.4107e+00, 1.3559e+00],
        [4.0627e+05, 7.9743e+05, 4.0625e+05, 4.0627e+05, 4.0626e+05, 0.0000e+00,
         4.0629e+05, 4.0630e+05, 4.0627e+05, 7.9542e+05, 4.0627e+05, 7.9536e+05,
         4.0628e+05, 4.0629e+05, 4.0627e+05, 4.0630e+05],
        [1.1857e+00, 3.9245e+05, 1.8265e+00, 1.6233e+00, 1.2140e+00, 4.0629e+05,
         0.0000e+00, 1.1210e+00, 1.7574e+00, 3.9967e+05, 1.1201e+00, 3.9162e+05,
         1.1889e+00, 1.5998e+00, 1.7194e+00, 1.7111e+00],
        [1.0890e+00, 3.9246e+05, 1.5630e+00, 1.4909e+00, 1.1063e+00, 4.0630e+05,
         1.1210e+00, 0.0000e+00, 1.5143e+00, 3.9971e+05, 9.9396e-01, 3.9162e+05,
         1.0895e+00, 1.4374e+00, 1.5664e+00, 1.4563e+00],
        [1.4545e+00, 3.9241e+05, 1.2341e+00, 1.2358e+00, 1.4308e+00, 4.0627e+05,
         1.7574e+00, 1.5143e+00, 0.0000e+00, 3.9972e+05, 1.5029e+00, 3.9164e+05,
         1.4002e+00, 1.2647e+00, 1.2176e+00, 1.2481e+00],
        [3.9969e+05, 7.7894e+05, 3.9969e+05, 3.9971e+05, 3.9971e+05, 7.9542e+05,
         3.9967e+05, 3.9971e+05, 3.9972e+05, 0.0000e+00, 3.9972e+05, 7.8716e+05,
         3.9969e+05, 3.9972e+05, 3.9973e+05, 3.9972e+05],
        [1.0197e+00, 3.9242e+05, 1.5905e+00, 1.4831e+00, 1.0788e+00, 4.0627e+05,
         1.1201e+00, 9.9396e-01, 1.5029e+00, 3.9972e+05, 0.0000e+00, 3.9163e+05,
         1.0829e+00, 1.4424e+00, 1.5426e+00, 1.4720e+00],
        [3.9162e+05, 7.8645e+05, 3.9164e+05, 3.9164e+05, 3.9163e+05, 7.9536e+05,
         3.9162e+05, 3.9162e+05, 3.9164e+05, 7.8716e+05, 3.9163e+05, 0.0000e+00,
         3.9163e+05, 3.9163e+05, 3.9164e+05, 3.9162e+05],
        [1.0207e+00, 3.9244e+05, 1.4232e+00, 1.3238e+00, 1.0654e+00, 4.0628e+05,
         1.1889e+00, 1.0895e+00, 1.4002e+00, 3.9969e+05, 1.0829e+00, 3.9163e+05,
         0.0000e+00, 1.2862e+00, 1.4386e+00, 1.2590e+00],
        [1.3401e+00, 3.9246e+05, 1.3946e+00, 1.2269e+00, 1.3547e+00, 4.0629e+05,
         1.5998e+00, 1.4374e+00, 1.2647e+00, 3.9972e+05, 1.4424e+00, 3.9163e+05,
         1.2862e+00, 0.0000e+00, 1.2311e+00, 1.1924e+00],
        [1.4402e+00, 3.9242e+05, 1.2585e+00, 1.1636e+00, 1.4107e+00, 4.0627e+05,
         1.7194e+00, 1.5664e+00, 1.2176e+00, 3.9973e+05, 1.5426e+00, 3.9164e+05,
         1.4386e+00, 1.2311e+00, 0.0000e+00, 1.2438e+00],
        [1.3756e+00, 3.9243e+05, 1.2520e+00, 1.2081e+00, 1.3559e+00, 4.0630e+05,
         1.7111e+00, 1.4563e+00, 1.2481e+00, 3.9972e+05, 1.4720e+00, 3.9162e+05,
         1.2590e+00, 1.1924e+00, 1.2438e+00, 0.0000e+00]])
Krum scores: ['1.24', '392429.06', '1.39', '1.32', '1.25', '406273.94', '1.42', '1.29', '1.35', '399703.31', '1.27', '391627.16', '1.21', '1.32', '1.35', '1.31']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 16, 8, 1, 9, 14, 11, 4, 6, 17, 2, 15, 12, 5, 7, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:05...
global Accuracy on shared test data: 71.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 78 185]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:05, End: 2025-07-22 16:02:05)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 8, 12, 20, 2, 16, 5, 10, 4, 14, 1, 17, 3, 11, 13, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1724e+00, 1.9391e+00, 3.8995e+05, 1.3347e+00, 3.8212e+05,
         1.2068e+00, 1.3512e+00, 1.3739e+00, 3.9017e+05, 1.2077e+00, 3.9002e+05,
         1.1894e+00, 1.4553e+00, 4.0810e+05, 4.0344e+05],
        [1.1724e+00, 0.0000e+00, 2.0306e+00, 3.8999e+05, 1.4882e+00, 3.8210e+05,
         1.3361e+00, 1.3684e+00, 1.4348e+00, 3.9015e+05, 1.2950e+00, 3.9000e+05,
         1.2101e+00, 1.5207e+00, 4.0806e+05, 4.0344e+05],
        [1.9391e+00, 2.0306e+00, 0.0000e+00, 3.8997e+05, 1.1013e+00, 3.8214e+05,
         1.6883e+00, 1.1871e+00, 1.1498e+00, 3.9021e+05, 1.7369e+00, 3.9003e+05,
         1.7290e+00, 1.0875e+00, 4.0809e+05, 4.0344e+05],
        [3.8995e+05, 3.8999e+05, 3.8997e+05, 0.0000e+00, 3.8997e+05, 7.6044e+05,
         3.8997e+05, 3.8996e+05, 3.8997e+05, 7.7335e+05, 3.8997e+05, 7.7988e+05,
         3.8998e+05, 3.8996e+05, 7.8842e+05, 7.8072e+05],
        [1.3347e+00, 1.4882e+00, 1.1013e+00, 3.8997e+05, 0.0000e+00, 3.8215e+05,
         1.3251e+00, 9.2649e-01, 9.3545e-01, 3.9019e+05, 1.3176e+00, 3.9001e+05,
         1.3406e+00, 9.2168e-01, 4.0809e+05, 4.0344e+05],
        [3.8212e+05, 3.8210e+05, 3.8214e+05, 7.6044e+05, 3.8215e+05, 0.0000e+00,
         3.8215e+05, 3.8216e+05, 3.8215e+05, 7.6157e+05, 3.8212e+05, 7.4479e+05,
         3.8214e+05, 3.8214e+05, 7.9587e+05, 7.8015e+05],
        [1.2068e+00, 1.3361e+00, 1.6883e+00, 3.8997e+05, 1.3251e+00, 3.8215e+05,
         0.0000e+00, 1.2596e+00, 1.3265e+00, 3.9018e+05, 1.2042e+00, 3.9004e+05,
         1.1732e+00, 1.3071e+00, 4.0812e+05, 4.0345e+05],
        [1.3512e+00, 1.3684e+00, 1.1871e+00, 3.8996e+05, 9.2649e-01, 3.8216e+05,
         1.2596e+00, 0.0000e+00, 1.0316e+00, 3.9019e+05, 1.2864e+00, 3.9006e+05,
         1.2744e+00, 9.8883e-01, 4.0809e+05, 4.0345e+05],
        [1.3739e+00, 1.4348e+00, 1.1498e+00, 3.8997e+05, 9.3545e-01, 3.8215e+05,
         1.3265e+00, 1.0316e+00, 0.0000e+00, 3.9019e+05, 1.3098e+00, 3.9004e+05,
         1.3126e+00, 9.1835e-01, 4.0808e+05, 4.0344e+05],
        [3.9017e+05, 3.9015e+05, 3.9021e+05, 7.7335e+05, 3.9019e+05, 7.6157e+05,
         3.9018e+05, 3.9019e+05, 3.9019e+05, 0.0000e+00, 3.9017e+05, 7.6226e+05,
         3.9018e+05, 3.9018e+05, 7.9474e+05, 7.8554e+05],
        [1.2077e+00, 1.2950e+00, 1.7369e+00, 3.8997e+05, 1.3176e+00, 3.8212e+05,
         1.2042e+00, 1.2864e+00, 1.3098e+00, 3.9017e+05, 0.0000e+00, 3.9001e+05,
         1.1910e+00, 1.3022e+00, 4.0808e+05, 4.0342e+05],
        [3.9002e+05, 3.9000e+05, 3.9003e+05, 7.7988e+05, 3.9001e+05, 7.4479e+05,
         3.9004e+05, 3.9006e+05, 3.9004e+05, 7.6226e+05, 3.9001e+05, 0.0000e+00,
         3.9001e+05, 3.9000e+05, 7.9267e+05, 7.8235e+05],
        [1.1894e+00, 1.2101e+00, 1.7290e+00, 3.8998e+05, 1.3406e+00, 3.8214e+05,
         1.1732e+00, 1.2744e+00, 1.3126e+00, 3.9018e+05, 1.1910e+00, 3.9001e+05,
         0.0000e+00, 1.3979e+00, 4.0808e+05, 4.0343e+05],
        [1.4553e+00, 1.5207e+00, 1.0875e+00, 3.8996e+05, 9.2168e-01, 3.8214e+05,
         1.3071e+00, 9.8883e-01, 9.1835e-01, 3.9018e+05, 1.3022e+00, 3.9000e+05,
         1.3979e+00, 0.0000e+00, 4.0807e+05, 4.0344e+05],
        [4.0810e+05, 4.0806e+05, 4.0809e+05, 7.8842e+05, 4.0809e+05, 7.9587e+05,
         4.0812e+05, 4.0809e+05, 4.0808e+05, 7.9474e+05, 4.0808e+05, 7.9267e+05,
         4.0808e+05, 4.0807e+05, 0.0000e+00, 8.1091e+05],
        [4.0344e+05, 4.0344e+05, 4.0344e+05, 7.8072e+05, 4.0344e+05, 7.8015e+05,
         4.0345e+05, 4.0345e+05, 4.0344e+05, 7.8554e+05, 4.0342e+05, 7.8235e+05,
         4.0343e+05, 4.0344e+05, 8.1091e+05, 0.0000e+00]])
Krum scores: ['1.29', '1.35', '1.45', '389964.72', '1.15', '382131.31', '1.27', '1.16', '1.17', '390176.91', '1.26', '390014.31', '1.26', '1.17', '408080.19', '403435.25']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 8, 12, 20, 2, 16, 5, 10, 4, 14, 1, 17, 3, 11, 13, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:06...
global Accuracy on shared test data: 73.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:06, End: 2025-07-22 16:02:06)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 17, 10, 8, 1, 9, 11, 19, 13, 7, 6, 18, 16, 15, 5, 3], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9009e+05, 9.2371e-01, 1.2893e+00, 1.2231e+00, 9.3457e-01,
         8.5675e-01, 3.9046e+05, 3.8270e+05, 1.3000e+00, 1.2671e+00, 3.9766e+05,
         3.8781e+05, 3.8412e+05, 1.1824e+00, 1.2353e+00],
        [3.9009e+05, 0.0000e+00, 3.9013e+05, 3.9008e+05, 3.9011e+05, 3.9009e+05,
         3.9011e+05, 7.4875e+05, 7.8460e+05, 3.9011e+05, 3.9009e+05, 7.9101e+05,
         7.7408e+05, 7.6348e+05, 3.9009e+05, 3.9009e+05],
        [9.2371e-01, 3.9013e+05, 0.0000e+00, 1.2377e+00, 1.1620e+00, 9.4932e-01,
         8.8338e-01, 3.9049e+05, 3.8269e+05, 1.2075e+00, 1.2297e+00, 3.9768e+05,
         3.8781e+05, 3.8410e+05, 1.1189e+00, 1.1632e+00],
        [1.2893e+00, 3.9008e+05, 1.2377e+00, 0.0000e+00, 1.1917e+00, 1.2288e+00,
         1.3780e+00, 3.9045e+05, 3.8270e+05, 1.1093e+00, 1.1189e+00, 3.9770e+05,
         3.8783e+05, 3.8409e+05, 1.1941e+00, 1.1337e+00],
        [1.2231e+00, 3.9011e+05, 1.1620e+00, 1.1917e+00, 0.0000e+00, 1.1442e+00,
         1.1699e+00, 3.9046e+05, 3.8270e+05, 1.0457e+00, 1.1340e+00, 3.9767e+05,
         3.8784e+05, 3.8414e+05, 1.0822e+00, 1.1035e+00],
        [9.3457e-01, 3.9009e+05, 9.4932e-01, 1.2288e+00, 1.1442e+00, 0.0000e+00,
         8.7954e-01, 3.9047e+05, 3.8271e+05, 1.1946e+00, 1.2241e+00, 3.9769e+05,
         3.8781e+05, 3.8410e+05, 1.1432e+00, 1.1824e+00],
        [8.5675e-01, 3.9011e+05, 8.8338e-01, 1.3780e+00, 1.1699e+00, 8.7954e-01,
         0.0000e+00, 3.9044e+05, 3.8269e+05, 1.2683e+00, 1.3138e+00, 3.9767e+05,
         3.8783e+05, 3.8412e+05, 1.1764e+00, 1.2889e+00],
        [3.9046e+05, 7.4875e+05, 3.9049e+05, 3.9045e+05, 3.9046e+05, 3.9047e+05,
         3.9044e+05, 0.0000e+00, 7.9812e+05, 3.9047e+05, 3.9044e+05, 8.0837e+05,
         7.5611e+05, 7.7860e+05, 3.9044e+05, 3.9045e+05],
        [3.8270e+05, 7.8460e+05, 3.8269e+05, 3.8270e+05, 3.8270e+05, 3.8271e+05,
         3.8269e+05, 7.9812e+05, 0.0000e+00, 3.8273e+05, 3.8269e+05, 7.6624e+05,
         7.7951e+05, 7.7976e+05, 3.8269e+05, 3.8270e+05],
        [1.3000e+00, 3.9011e+05, 1.2075e+00, 1.1093e+00, 1.0457e+00, 1.1946e+00,
         1.2683e+00, 3.9047e+05, 3.8273e+05, 0.0000e+00, 1.1332e+00, 3.9765e+05,
         3.8784e+05, 3.8412e+05, 1.1184e+00, 1.1106e+00],
        [1.2671e+00, 3.9009e+05, 1.2297e+00, 1.1189e+00, 1.1340e+00, 1.2241e+00,
         1.3138e+00, 3.9044e+05, 3.8269e+05, 1.1332e+00, 0.0000e+00, 3.9766e+05,
         3.8782e+05, 3.8408e+05, 1.1730e+00, 1.1544e+00],
        [3.9766e+05, 7.9101e+05, 3.9768e+05, 3.9770e+05, 3.9767e+05, 3.9769e+05,
         3.9767e+05, 8.0837e+05, 7.6624e+05, 3.9765e+05, 3.9766e+05, 0.0000e+00,
         8.0469e+05, 7.8141e+05, 3.9766e+05, 3.9768e+05],
        [3.8781e+05, 7.7408e+05, 3.8781e+05, 3.8783e+05, 3.8784e+05, 3.8781e+05,
         3.8783e+05, 7.5611e+05, 7.7951e+05, 3.8784e+05, 3.8782e+05, 8.0469e+05,
         0.0000e+00, 7.7295e+05, 3.8782e+05, 3.8780e+05],
        [3.8412e+05, 7.6348e+05, 3.8410e+05, 3.8409e+05, 3.8414e+05, 3.8410e+05,
         3.8412e+05, 7.7860e+05, 7.7976e+05, 3.8412e+05, 3.8408e+05, 7.8141e+05,
         7.7295e+05, 0.0000e+00, 3.8413e+05, 3.8411e+05],
        [1.1824e+00, 3.9009e+05, 1.1189e+00, 1.1941e+00, 1.0822e+00, 1.1432e+00,
         1.1764e+00, 3.9044e+05, 3.8269e+05, 1.1184e+00, 1.1730e+00, 3.9766e+05,
         3.8782e+05, 3.8413e+05, 0.0000e+00, 1.1030e+00],
        [1.2353e+00, 3.9009e+05, 1.1632e+00, 1.1337e+00, 1.1035e+00, 1.1824e+00,
         1.2889e+00, 3.9045e+05, 3.8270e+05, 1.1106e+00, 1.1544e+00, 3.9768e+05,
         3.8780e+05, 3.8411e+05, 1.1030e+00, 0.0000e+00]])
Krum scores: ['1.11', '390094.66', '1.08', '1.19', '1.13', '1.08', '1.10', '390451.38', '382696.03', '1.15', '1.18', '397666.78', '387816.88', '384104.72', '1.14', '1.15']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 17, 10, 8, 1, 9, 11, 19, 13, 7, 6, 18, 16, 15, 5, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0055s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:07...
global Accuracy on shared test data: 70.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [ 72 191]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:07, End: 2025-07-22 16:02:07)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 10, 2, 20, 14, 17, 11, 18, 13, 4, 12, 3, 1, 5, 9, 8], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.7697e+00, 1.5554e+00, 4.0559e+05, 4.0205e+05, 3.8730e+05,
         1.2164e+00, 3.8211e+05, 3.9103e+05, 1.2654e+00, 1.5244e+00, 1.1091e+00,
         1.0433e+00, 1.1027e+00, 1.1951e+00, 1.1392e+00],
        [1.7697e+00, 0.0000e+00, 8.0094e-01, 4.0561e+05, 4.0204e+05, 3.8727e+05,
         1.0365e+00, 3.8216e+05, 3.9107e+05, 1.1181e+00, 8.8306e-01, 1.6785e+00,
         1.6921e+00, 1.6276e+00, 1.2782e+00, 1.8783e+00],
        [1.5554e+00, 8.0094e-01, 0.0000e+00, 4.0562e+05, 4.0203e+05, 3.8727e+05,
         8.2185e-01, 3.8215e+05, 3.9108e+05, 8.6267e-01, 7.5267e-01, 1.4547e+00,
         1.4156e+00, 1.3979e+00, 1.0164e+00, 1.6207e+00],
        [4.0559e+05, 4.0561e+05, 4.0562e+05, 0.0000e+00, 8.1519e+05, 7.6426e+05,
         4.0559e+05, 7.8928e+05, 7.8050e+05, 4.0559e+05, 4.0562e+05, 4.0561e+05,
         4.0558e+05, 4.0559e+05, 4.0561e+05, 4.0558e+05],
        [4.0205e+05, 4.0204e+05, 4.0203e+05, 8.1519e+05, 0.0000e+00, 8.0174e+05,
         4.0204e+05, 7.8259e+05, 7.9591e+05, 4.0203e+05, 4.0204e+05, 4.0207e+05,
         4.0205e+05, 4.0206e+05, 4.0204e+05, 4.0206e+05],
        [3.8730e+05, 3.8727e+05, 3.8727e+05, 7.6426e+05, 8.0174e+05, 0.0000e+00,
         3.8729e+05, 7.5776e+05, 7.8318e+05, 3.8728e+05, 3.8728e+05, 3.8729e+05,
         3.8730e+05, 3.8727e+05, 3.8727e+05, 3.8727e+05],
        [1.2164e+00, 1.0365e+00, 8.2185e-01, 4.0559e+05, 4.0204e+05, 3.8729e+05,
         0.0000e+00, 3.8216e+05, 3.9108e+05, 8.3204e-01, 8.4478e-01, 1.2169e+00,
         1.1235e+00, 1.1142e+00, 8.9824e-01, 1.3091e+00],
        [3.8211e+05, 3.8216e+05, 3.8215e+05, 7.8928e+05, 7.8259e+05, 7.5776e+05,
         3.8216e+05, 0.0000e+00, 7.7957e+05, 3.8212e+05, 3.8216e+05, 3.8215e+05,
         3.8211e+05, 3.8213e+05, 3.8212e+05, 3.8212e+05],
        [3.9103e+05, 3.9107e+05, 3.9108e+05, 7.8050e+05, 7.9591e+05, 7.8318e+05,
         3.9108e+05, 7.7957e+05, 0.0000e+00, 3.9105e+05, 3.9108e+05, 3.9105e+05,
         3.9104e+05, 3.9104e+05, 3.9105e+05, 3.9108e+05],
        [1.2654e+00, 1.1181e+00, 8.6267e-01, 4.0559e+05, 4.0203e+05, 3.8728e+05,
         8.3204e-01, 3.8212e+05, 3.9105e+05, 0.0000e+00, 8.9237e-01, 1.2300e+00,
         1.2127e+00, 1.1897e+00, 9.6457e-01, 1.2831e+00],
        [1.5244e+00, 8.8306e-01, 7.5267e-01, 4.0562e+05, 4.0204e+05, 3.8728e+05,
         8.4478e-01, 3.8216e+05, 3.9108e+05, 8.9237e-01, 0.0000e+00, 1.3417e+00,
         1.3803e+00, 1.3132e+00, 1.0001e+00, 1.5408e+00],
        [1.1091e+00, 1.6785e+00, 1.4547e+00, 4.0561e+05, 4.0207e+05, 3.8729e+05,
         1.2169e+00, 3.8215e+05, 3.9105e+05, 1.2300e+00, 1.3417e+00, 0.0000e+00,
         1.0633e+00, 1.0955e+00, 1.1660e+00, 1.1107e+00],
        [1.0433e+00, 1.6921e+00, 1.4156e+00, 4.0558e+05, 4.0205e+05, 3.8730e+05,
         1.1235e+00, 3.8211e+05, 3.9104e+05, 1.2127e+00, 1.3803e+00, 1.0633e+00,
         0.0000e+00, 1.0681e+00, 1.1283e+00, 1.1275e+00],
        [1.1027e+00, 1.6276e+00, 1.3979e+00, 4.0559e+05, 4.0206e+05, 3.8727e+05,
         1.1142e+00, 3.8213e+05, 3.9104e+05, 1.1897e+00, 1.3132e+00, 1.0955e+00,
         1.0681e+00, 0.0000e+00, 1.1227e+00, 1.2098e+00],
        [1.1951e+00, 1.2782e+00, 1.0164e+00, 4.0561e+05, 4.0204e+05, 3.8727e+05,
         8.9824e-01, 3.8212e+05, 3.9105e+05, 9.6457e-01, 1.0001e+00, 1.1660e+00,
         1.1283e+00, 1.1227e+00, 0.0000e+00, 1.1968e+00],
        [1.1392e+00, 1.8783e+00, 1.6207e+00, 4.0558e+05, 4.0206e+05, 3.8727e+05,
         1.3091e+00, 3.8212e+05, 3.9108e+05, 1.2831e+00, 1.5408e+00, 1.1107e+00,
         1.1275e+00, 1.2098e+00, 1.1968e+00, 0.0000e+00]])
Krum scores: ['1.24', '1.32', '1.12', '405593.88', '402042.38', '387275.88', '1.01', '382128.84', '391054.56', '1.06', '1.10', '1.20', '1.17', '1.18', '1.08', '1.28']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 10, 2, 20, 14, 17, 11, 18, 13, 4, 12, 3, 1, 5, 9, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:07...
global Accuracy on shared test data: 73.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[164  73]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:07, End: 2025-07-22 16:02:07)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 17, 9, 11, 19, 7, 5, 3, 1, 18, 12, 10, 4, 16, 15, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7314e+05, 1.2553e+00, 1.9540e+00, 3.9282e+05, 1.1431e+00,
         1.2093e+00, 1.1317e+00, 1.1792e+00, 3.9999e+05, 1.4878e+00, 1.4988e+00,
         1.3388e+00, 3.8826e+05, 3.9518e+05, 1.1133e+00],
        [3.7314e+05, 0.0000e+00, 3.7309e+05, 3.7312e+05, 7.3214e+05, 3.7309e+05,
         3.7311e+05, 3.7312e+05, 3.7312e+05, 7.8482e+05, 3.7312e+05, 3.7314e+05,
         3.7312e+05, 7.5270e+05, 7.6246e+05, 3.7313e+05],
        [1.2553e+00, 3.7309e+05, 0.0000e+00, 1.1892e+00, 3.9283e+05, 1.2190e+00,
         1.1272e+00, 1.1368e+00, 1.1596e+00, 3.9998e+05, 9.3820e-01, 9.9456e-01,
         9.4561e-01, 3.8825e+05, 3.9517e+05, 1.1878e+00],
        [1.9540e+00, 3.7312e+05, 1.1892e+00, 0.0000e+00, 3.9283e+05, 1.7832e+00,
         1.6028e+00, 1.6960e+00, 1.6574e+00, 4.0001e+05, 8.8233e-01, 8.4718e-01,
         1.0447e+00, 3.8824e+05, 3.9519e+05, 1.7381e+00],
        [3.9282e+05, 7.3214e+05, 3.9283e+05, 3.9283e+05, 0.0000e+00, 3.9283e+05,
         3.9280e+05, 3.9281e+05, 3.9281e+05, 7.7328e+05, 3.9283e+05, 3.9285e+05,
         3.9283e+05, 7.9483e+05, 7.8957e+05, 3.9281e+05],
        [1.1431e+00, 3.7309e+05, 1.2190e+00, 1.7832e+00, 3.9283e+05, 0.0000e+00,
         1.0851e+00, 1.1104e+00, 1.0408e+00, 4.0002e+05, 1.4271e+00, 1.3981e+00,
         1.2700e+00, 3.8825e+05, 3.9519e+05, 1.1165e+00],
        [1.2093e+00, 3.7311e+05, 1.1272e+00, 1.6028e+00, 3.9280e+05, 1.0851e+00,
         0.0000e+00, 1.0424e+00, 1.0537e+00, 4.0000e+05, 1.2451e+00, 1.2449e+00,
         1.1689e+00, 3.8827e+05, 3.9519e+05, 1.0591e+00],
        [1.1317e+00, 3.7312e+05, 1.1368e+00, 1.6960e+00, 3.9281e+05, 1.1104e+00,
         1.0424e+00, 0.0000e+00, 1.0726e+00, 4.0000e+05, 1.2289e+00, 1.3116e+00,
         1.1853e+00, 3.8823e+05, 3.9517e+05, 1.0922e+00],
        [1.1792e+00, 3.7312e+05, 1.1596e+00, 1.6574e+00, 3.9281e+05, 1.0408e+00,
         1.0537e+00, 1.0726e+00, 0.0000e+00, 3.9998e+05, 1.3021e+00, 1.3369e+00,
         1.1973e+00, 3.8828e+05, 3.9521e+05, 1.0818e+00],
        [3.9999e+05, 7.8482e+05, 3.9998e+05, 4.0001e+05, 7.7328e+05, 4.0002e+05,
         4.0000e+05, 4.0000e+05, 3.9998e+05, 0.0000e+00, 4.0004e+05, 4.0000e+05,
         4.0000e+05, 7.9061e+05, 7.9312e+05, 3.9999e+05],
        [1.4878e+00, 3.7312e+05, 9.3820e-01, 8.8233e-01, 3.9283e+05, 1.4271e+00,
         1.2451e+00, 1.2289e+00, 1.3021e+00, 4.0004e+05, 0.0000e+00, 7.3626e-01,
         8.7349e-01, 3.8825e+05, 3.9517e+05, 1.3410e+00],
        [1.4988e+00, 3.7314e+05, 9.9456e-01, 8.4718e-01, 3.9285e+05, 1.3981e+00,
         1.2449e+00, 1.3116e+00, 1.3369e+00, 4.0000e+05, 7.3626e-01, 0.0000e+00,
         8.8714e-01, 3.8823e+05, 3.9518e+05, 1.3740e+00],
        [1.3388e+00, 3.7312e+05, 9.4561e-01, 1.0447e+00, 3.9283e+05, 1.2700e+00,
         1.1689e+00, 1.1853e+00, 1.1973e+00, 4.0000e+05, 8.7349e-01, 8.8714e-01,
         0.0000e+00, 3.8824e+05, 3.9519e+05, 1.1937e+00],
        [3.8826e+05, 7.5270e+05, 3.8825e+05, 3.8824e+05, 7.9483e+05, 3.8825e+05,
         3.8827e+05, 3.8823e+05, 3.8828e+05, 7.9061e+05, 3.8825e+05, 3.8823e+05,
         3.8824e+05, 0.0000e+00, 7.8340e+05, 3.8825e+05],
        [3.9518e+05, 7.6246e+05, 3.9517e+05, 3.9519e+05, 7.8957e+05, 3.9519e+05,
         3.9519e+05, 3.9517e+05, 3.9521e+05, 7.9312e+05, 3.9517e+05, 3.9518e+05,
         3.9519e+05, 7.8340e+05, 0.0000e+00, 3.9520e+05],
        [1.1133e+00, 3.7313e+05, 1.1878e+00, 1.7381e+00, 3.9281e+05, 1.1165e+00,
         1.0591e+00, 1.0922e+00, 1.0818e+00, 3.9999e+05, 1.3410e+00, 1.3740e+00,
         1.1937e+00, 3.8825e+05, 3.9520e+05, 0.0000e+00]])
Krum scores: ['1.26', '373114.41', '1.10', '1.38', '392818.88', '1.20', '1.14', '1.15', '1.16', '399994.34', '1.11', '1.13', '1.09', '388245.69', '395181.94', '1.17']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 17, 9, 11, 19, 7, 5, 3, 1, 18, 12, 10, 4, 16, 15, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:08...
global Accuracy on shared test data: 71.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 78 185]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:08, End: 2025-07-22 16:02:08)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 14, 18, 16, 5, 7, 4, 15, 6, 3, 2, 19, 8, 11, 17, 10], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.9977e+05, 7.9090e+05, 7.6909e+05, 3.8551e+05, 3.8551e+05,
         3.8548e+05, 7.7145e+05, 3.8550e+05, 3.8548e+05, 3.8549e+05, 7.8438e+05,
         3.8550e+05, 3.8549e+05, 7.6350e+05, 3.8551e+05],
        [7.9977e+05, 0.0000e+00, 7.9223e+05, 7.7910e+05, 3.9176e+05, 3.9178e+05,
         3.9178e+05, 8.0388e+05, 3.9172e+05, 3.9176e+05, 3.9176e+05, 7.8388e+05,
         3.9179e+05, 3.9177e+05, 7.6257e+05, 3.9175e+05],
        [7.9090e+05, 7.9223e+05, 0.0000e+00, 7.8187e+05, 3.9877e+05, 3.9875e+05,
         3.9876e+05, 7.8699e+05, 3.9879e+05, 3.9879e+05, 3.9877e+05, 7.7901e+05,
         3.9877e+05, 3.9876e+05, 7.5843e+05, 3.9877e+05],
        [7.6909e+05, 7.7910e+05, 7.8187e+05, 0.0000e+00, 3.8366e+05, 3.8367e+05,
         3.8366e+05, 7.6226e+05, 3.8366e+05, 3.8367e+05, 3.8366e+05, 7.6781e+05,
         3.8367e+05, 3.8366e+05, 7.4847e+05, 3.8367e+05],
        [3.8551e+05, 3.9176e+05, 3.9877e+05, 3.8366e+05, 0.0000e+00, 1.0834e+00,
         1.7222e+00, 3.8938e+05, 1.0664e+00, 1.0335e+00, 1.3243e+00, 3.8862e+05,
         1.1690e+00, 1.3489e+00, 3.8066e+05, 1.2341e+00],
        [3.8551e+05, 3.9178e+05, 3.9875e+05, 3.8367e+05, 1.0834e+00, 0.0000e+00,
         1.9089e+00, 3.8939e+05, 1.0711e+00, 1.0533e+00, 1.4324e+00, 3.8863e+05,
         1.0766e+00, 1.4820e+00, 3.8064e+05, 1.3454e+00],
        [3.8548e+05, 3.9178e+05, 3.9876e+05, 3.8366e+05, 1.7222e+00, 1.9089e+00,
         0.0000e+00, 3.8936e+05, 1.8141e+00, 1.7063e+00, 7.9759e-01, 3.8864e+05,
         1.8793e+00, 7.8242e-01, 3.8064e+05, 9.2284e-01],
        [7.7145e+05, 8.0388e+05, 7.8699e+05, 7.6226e+05, 3.8938e+05, 3.8939e+05,
         3.8936e+05, 0.0000e+00, 3.8943e+05, 3.8939e+05, 3.8938e+05, 7.7993e+05,
         3.8941e+05, 3.8938e+05, 7.7456e+05, 3.8937e+05],
        [3.8550e+05, 3.9172e+05, 3.9879e+05, 3.8366e+05, 1.0664e+00, 1.0711e+00,
         1.8141e+00, 3.8943e+05, 0.0000e+00, 1.0400e+00, 1.3088e+00, 3.8864e+05,
         1.0385e+00, 1.4496e+00, 3.8066e+05, 1.3175e+00],
        [3.8548e+05, 3.9176e+05, 3.9879e+05, 3.8367e+05, 1.0335e+00, 1.0533e+00,
         1.7063e+00, 3.8939e+05, 1.0400e+00, 0.0000e+00, 1.2881e+00, 3.8862e+05,
         1.0421e+00, 1.3708e+00, 3.8065e+05, 1.2329e+00],
        [3.8549e+05, 3.9176e+05, 3.9877e+05, 3.8366e+05, 1.3243e+00, 1.4324e+00,
         7.9759e-01, 3.8938e+05, 1.3088e+00, 1.2881e+00, 0.0000e+00, 3.8862e+05,
         1.4232e+00, 7.0437e-01, 3.8065e+05, 7.0653e-01],
        [7.8438e+05, 7.8388e+05, 7.7901e+05, 7.6781e+05, 3.8862e+05, 3.8863e+05,
         3.8864e+05, 7.7993e+05, 3.8864e+05, 3.8862e+05, 3.8862e+05, 0.0000e+00,
         3.8861e+05, 3.8864e+05, 7.9163e+05, 3.8863e+05],
        [3.8550e+05, 3.9179e+05, 3.9877e+05, 3.8367e+05, 1.1690e+00, 1.0766e+00,
         1.8793e+00, 3.8941e+05, 1.0385e+00, 1.0421e+00, 1.4232e+00, 3.8861e+05,
         0.0000e+00, 1.5139e+00, 3.8063e+05, 1.3573e+00],
        [3.8549e+05, 3.9177e+05, 3.9876e+05, 3.8366e+05, 1.3489e+00, 1.4820e+00,
         7.8242e-01, 3.8938e+05, 1.4496e+00, 1.3708e+00, 7.0437e-01, 3.8864e+05,
         1.5139e+00, 0.0000e+00, 3.8066e+05, 7.5252e-01],
        [7.6350e+05, 7.6257e+05, 7.5843e+05, 7.4847e+05, 3.8066e+05, 3.8064e+05,
         3.8064e+05, 7.7456e+05, 3.8066e+05, 3.8065e+05, 3.8065e+05, 7.9163e+05,
         3.8063e+05, 3.8066e+05, 0.0000e+00, 3.8064e+05],
        [3.8551e+05, 3.9175e+05, 3.9877e+05, 3.8367e+05, 1.2341e+00, 1.3454e+00,
         9.2284e-01, 3.8937e+05, 1.3175e+00, 1.2329e+00, 7.0653e-01, 3.8863e+05,
         1.3573e+00, 7.5252e-01, 3.8064e+05, 0.0000e+00]])
Krum scores: ['385492.72', '391757.59', '398764.22', '383661.84', '1.18', '1.22', '1.37', '389379.22', '1.18', '1.15', '1.08', '388622.44', '1.23', '1.13', '380643.44', '1.07']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [20, 14, 18, 16, 5, 7, 4, 15, 6, 3, 2, 19, 8, 11, 17, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:08...
global Accuracy on shared test data: 70.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[161  76]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:08, End: 2025-07-22 16:02:08)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 14, 18, 13, 12, 6, 1, 17, 11, 19, 2, 16, 15, 5, 7, 10], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.9080e+05, 7.3690e+05, 7.8836e+05, 3.8742e+05, 3.8745e+05,
         3.8745e+05, 7.8345e+05, 3.8743e+05, 7.8042e+05, 3.8743e+05, 7.7003e+05,
         7.7065e+05, 3.8745e+05, 3.8745e+05, 3.8743e+05],
        [7.9080e+05, 0.0000e+00, 7.6051e+05, 7.9522e+05, 4.0027e+05, 4.0025e+05,
         4.0024e+05, 7.9183e+05, 4.0024e+05, 7.8366e+05, 4.0024e+05, 7.8307e+05,
         7.9771e+05, 4.0023e+05, 4.0025e+05, 4.0025e+05],
        [7.3690e+05, 7.6051e+05, 0.0000e+00, 7.4590e+05, 3.7153e+05, 3.7153e+05,
         3.7155e+05, 7.7762e+05, 3.7156e+05, 7.7326e+05, 3.7153e+05, 7.5950e+05,
         7.3313e+05, 3.7149e+05, 3.7154e+05, 3.7155e+05],
        [7.8836e+05, 7.9522e+05, 7.4590e+05, 0.0000e+00, 3.9300e+05, 3.9300e+05,
         3.9302e+05, 7.7982e+05, 3.9300e+05, 7.8437e+05, 3.9302e+05, 7.7774e+05,
         7.7856e+05, 3.9304e+05, 3.9299e+05, 3.9299e+05],
        [3.8742e+05, 4.0027e+05, 3.7153e+05, 3.9300e+05, 0.0000e+00, 1.1262e+00,
         1.1801e+00, 3.9837e+05, 6.9311e-01, 3.9705e+05, 7.2166e-01, 3.8538e+05,
         3.7515e+05, 1.0956e+00, 1.2497e+00, 8.5872e-01],
        [3.8745e+05, 4.0025e+05, 3.7153e+05, 3.9300e+05, 1.1262e+00, 0.0000e+00,
         9.8811e-01, 3.9838e+05, 1.2147e+00, 3.9701e+05, 1.1554e+00, 3.8537e+05,
         3.7515e+05, 9.7966e-01, 1.0208e+00, 1.6850e+00],
        [3.8745e+05, 4.0024e+05, 3.7155e+05, 3.9302e+05, 1.1801e+00, 9.8811e-01,
         0.0000e+00, 3.9837e+05, 1.2366e+00, 3.9702e+05, 1.2493e+00, 3.8537e+05,
         3.7513e+05, 1.0103e+00, 9.7830e-01, 1.7618e+00],
        [7.8345e+05, 7.9183e+05, 7.7762e+05, 7.7982e+05, 3.9837e+05, 3.9838e+05,
         3.9837e+05, 0.0000e+00, 3.9836e+05, 7.9531e+05, 3.9835e+05, 7.9137e+05,
         7.8336e+05, 3.9839e+05, 3.9840e+05, 3.9834e+05],
        [3.8743e+05, 4.0024e+05, 3.7156e+05, 3.9300e+05, 6.9311e-01, 1.2147e+00,
         1.2366e+00, 3.9836e+05, 0.0000e+00, 3.9703e+05, 6.3808e-01, 3.8536e+05,
         3.7515e+05, 1.1676e+00, 1.2990e+00, 7.3318e-01],
        [7.8042e+05, 7.8366e+05, 7.7326e+05, 7.8437e+05, 3.9705e+05, 3.9701e+05,
         3.9702e+05, 7.9531e+05, 3.9703e+05, 0.0000e+00, 3.9701e+05, 7.8644e+05,
         7.8197e+05, 3.9702e+05, 3.9701e+05, 3.9701e+05],
        [3.8743e+05, 4.0024e+05, 3.7153e+05, 3.9302e+05, 7.2166e-01, 1.1554e+00,
         1.2493e+00, 3.9835e+05, 6.3808e-01, 3.9701e+05, 0.0000e+00, 3.8536e+05,
         3.7515e+05, 1.1910e+00, 1.3030e+00, 7.2232e-01],
        [7.7003e+05, 7.8307e+05, 7.5950e+05, 7.7774e+05, 3.8538e+05, 3.8537e+05,
         3.8537e+05, 7.9137e+05, 3.8536e+05, 7.8644e+05, 3.8536e+05, 0.0000e+00,
         7.4703e+05, 3.8533e+05, 3.8535e+05, 3.8537e+05],
        [7.7065e+05, 7.9771e+05, 7.3313e+05, 7.7856e+05, 3.7515e+05, 3.7515e+05,
         3.7513e+05, 7.8336e+05, 3.7515e+05, 7.8197e+05, 3.7515e+05, 7.4703e+05,
         0.0000e+00, 3.7515e+05, 3.7512e+05, 3.7514e+05],
        [3.8745e+05, 4.0023e+05, 3.7149e+05, 3.9304e+05, 1.0956e+00, 9.7966e-01,
         1.0103e+00, 3.9839e+05, 1.1676e+00, 3.9702e+05, 1.1910e+00, 3.8533e+05,
         3.7515e+05, 0.0000e+00, 1.0073e+00, 1.6224e+00],
        [3.8745e+05, 4.0025e+05, 3.7154e+05, 3.9299e+05, 1.2497e+00, 1.0208e+00,
         9.7830e-01, 3.9840e+05, 1.2990e+00, 3.9701e+05, 1.3030e+00, 3.8535e+05,
         3.7512e+05, 1.0073e+00, 0.0000e+00, 1.7936e+00],
        [3.8743e+05, 4.0025e+05, 3.7155e+05, 3.9299e+05, 8.5872e-01, 1.6850e+00,
         1.7618e+00, 3.9834e+05, 7.3318e-01, 3.9701e+05, 7.2232e-01, 3.8537e+05,
         3.7514e+05, 1.6224e+00, 1.7936e+00, 0.0000e+00]])
Krum scores: ['387434.62', '400241.28', '371527.59', '393001.34', '0.95', '1.08', '1.11', '398361.41', '0.95', '397013.66', '0.95', '385357.00', '375138.34', '1.08', '1.14', '1.23']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 14, 18, 13, 12, 6, 1, 17, 11, 19, 2, 16, 15, 5, 7, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:09...
global Accuracy on shared test data: 70.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 83 180]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:09, End: 2025-07-22 16:02:09)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 9, 10, 11, 16, 17, 2, 14, 15, 7, 19, 20, 18, 1, 8, 5], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0221e+00, 1.3625e+00, 1.2132e+00, 3.8522e+05, 3.9052e+05,
         1.1171e+00, 3.8573e+05, 3.8346e+05, 1.0258e+00, 3.9597e+05, 3.9500e+05,
         3.7955e+05, 1.0079e+00, 9.9109e-01, 1.0346e+00],
        [1.0221e+00, 0.0000e+00, 9.9248e-01, 8.5544e-01, 3.8520e+05, 3.9054e+05,
         8.4798e-01, 3.8573e+05, 3.8342e+05, 1.0618e+00, 3.9599e+05, 3.9499e+05,
         3.7959e+05, 1.0186e+00, 1.0453e+00, 1.0519e+00],
        [1.3625e+00, 9.9248e-01, 0.0000e+00, 6.0435e-01, 3.8524e+05, 3.9053e+05,
         5.9116e-01, 3.8574e+05, 3.8345e+05, 1.4278e+00, 3.9596e+05, 3.9498e+05,
         3.7957e+05, 1.3759e+00, 1.4736e+00, 1.2790e+00],
        [1.2132e+00, 8.5544e-01, 6.0435e-01, 0.0000e+00, 3.8525e+05, 3.9050e+05,
         6.4762e-01, 3.8576e+05, 3.8344e+05, 1.2487e+00, 3.9597e+05, 3.9501e+05,
         3.7958e+05, 1.1999e+00, 1.3407e+00, 1.1537e+00],
        [3.8522e+05, 3.8520e+05, 3.8524e+05, 3.8525e+05, 0.0000e+00, 7.6622e+05,
         3.8523e+05, 7.4718e+05, 7.6783e+05, 3.8525e+05, 7.7072e+05, 7.5630e+05,
         7.7235e+05, 3.8526e+05, 3.8523e+05, 3.8525e+05],
        [3.9052e+05, 3.9054e+05, 3.9053e+05, 3.9050e+05, 7.6622e+05, 0.0000e+00,
         3.9051e+05, 7.7028e+05, 7.7228e+05, 3.9053e+05, 7.7404e+05, 7.8901e+05,
         7.7826e+05, 3.9053e+05, 3.9049e+05, 3.9052e+05],
        [1.1171e+00, 8.4798e-01, 5.9116e-01, 6.4762e-01, 3.8523e+05, 3.9051e+05,
         0.0000e+00, 3.8575e+05, 3.8346e+05, 1.2318e+00, 3.9598e+05, 3.9500e+05,
         3.7958e+05, 1.1692e+00, 1.2631e+00, 1.1218e+00],
        [3.8573e+05, 3.8573e+05, 3.8574e+05, 3.8576e+05, 7.4718e+05, 7.7028e+05,
         3.8575e+05, 0.0000e+00, 7.7477e+05, 3.8574e+05, 7.8623e+05, 7.7937e+05,
         7.5183e+05, 3.8574e+05, 3.8574e+05, 3.8575e+05],
        [3.8346e+05, 3.8342e+05, 3.8345e+05, 3.8344e+05, 7.6783e+05, 7.7228e+05,
         3.8346e+05, 7.7477e+05, 0.0000e+00, 3.8341e+05, 7.8420e+05, 8.0935e+05,
         7.6894e+05, 3.8344e+05, 3.8341e+05, 3.8339e+05],
        [1.0258e+00, 1.0618e+00, 1.4278e+00, 1.2487e+00, 3.8525e+05, 3.9053e+05,
         1.2318e+00, 3.8574e+05, 3.8341e+05, 0.0000e+00, 3.9596e+05, 3.9500e+05,
         3.7956e+05, 9.7705e-01, 1.0606e+00, 1.0411e+00],
        [3.9597e+05, 3.9599e+05, 3.9596e+05, 3.9597e+05, 7.7072e+05, 7.7404e+05,
         3.9598e+05, 7.8623e+05, 7.8420e+05, 3.9596e+05, 0.0000e+00, 7.9516e+05,
         8.1071e+05, 3.9596e+05, 3.9597e+05, 3.9595e+05],
        [3.9500e+05, 3.9499e+05, 3.9498e+05, 3.9501e+05, 7.5630e+05, 7.8901e+05,
         3.9500e+05, 7.7937e+05, 8.0935e+05, 3.9500e+05, 7.9516e+05, 0.0000e+00,
         7.9267e+05, 3.9497e+05, 3.9498e+05, 3.9499e+05],
        [3.7955e+05, 3.7959e+05, 3.7957e+05, 3.7958e+05, 7.7235e+05, 7.7826e+05,
         3.7958e+05, 7.5183e+05, 7.6894e+05, 3.7956e+05, 8.1071e+05, 7.9267e+05,
         0.0000e+00, 3.7957e+05, 3.7953e+05, 3.7953e+05],
        [1.0079e+00, 1.0186e+00, 1.3759e+00, 1.1999e+00, 3.8526e+05, 3.9053e+05,
         1.1692e+00, 3.8574e+05, 3.8344e+05, 9.7705e-01, 3.9596e+05, 3.9497e+05,
         3.7957e+05, 0.0000e+00, 1.0886e+00, 1.0385e+00],
        [9.9109e-01, 1.0453e+00, 1.4736e+00, 1.3407e+00, 3.8523e+05, 3.9049e+05,
         1.2631e+00, 3.8574e+05, 3.8341e+05, 1.0606e+00, 3.9597e+05, 3.9498e+05,
         3.7953e+05, 1.0886e+00, 0.0000e+00, 1.1416e+00],
        [1.0346e+00, 1.0519e+00, 1.2790e+00, 1.1537e+00, 3.8525e+05, 3.9052e+05,
         1.1218e+00, 3.8575e+05, 3.8339e+05, 1.0411e+00, 3.9595e+05, 3.9499e+05,
         3.7953e+05, 1.0385e+00, 1.1416e+00, 0.0000e+00]])
Krum scores: ['1.06', '0.98', '1.09', '0.99', '385230.28', '390512.59', '0.96', '385737.72', '383424.81', '1.09', '395964.03', '394988.53', '379554.84', '1.07', '1.13', '1.08']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 9, 10, 11, 16, 17, 2, 14, 15, 7, 19, 20, 18, 1, 8, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:10...
global Accuracy on shared test data: 72.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 75 188]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:10, End: 2025-07-22 16:02:10)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 4, 15, 6, 13, 5, 11, 10, 12, 19, 7, 16, 3, 9, 18, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8450e+05, 7.8848e+05, 3.8453e+05, 7.6934e+05, 3.8453e+05,
         3.8452e+05, 3.8453e+05, 3.8453e+05, 7.6877e+05, 3.8454e+05, 7.9591e+05,
         3.8456e+05, 3.8453e+05, 7.9504e+05, 8.0354e+05],
        [3.8450e+05, 0.0000e+00, 4.0067e+05, 1.1817e+00, 3.8620e+05, 1.1632e+00,
         6.0547e-01, 5.8098e-01, 5.5358e-01, 4.0098e+05, 1.3042e+00, 3.8670e+05,
         1.2114e+00, 8.4449e-01, 3.9106e+05, 3.9734e+05],
        [7.8848e+05, 4.0067e+05, 0.0000e+00, 4.0064e+05, 8.0148e+05, 4.0065e+05,
         4.0067e+05, 4.0065e+05, 4.0067e+05, 8.0194e+05, 4.0068e+05, 7.7903e+05,
         4.0065e+05, 4.0066e+05, 7.9920e+05, 7.8034e+05],
        [3.8453e+05, 1.1817e+00, 4.0064e+05, 0.0000e+00, 3.8621e+05, 1.0013e+00,
         1.1424e+00, 1.2661e+00, 1.2153e+00, 4.0094e+05, 1.0302e+00, 3.8672e+05,
         9.9383e-01, 9.9591e-01, 3.9105e+05, 3.9733e+05],
        [7.6934e+05, 3.8620e+05, 8.0148e+05, 3.8621e+05, 0.0000e+00, 3.8620e+05,
         3.8621e+05, 3.8621e+05, 3.8620e+05, 7.7762e+05, 3.8619e+05, 7.5049e+05,
         3.8622e+05, 3.8622e+05, 7.9318e+05, 7.8323e+05],
        [3.8453e+05, 1.1632e+00, 4.0065e+05, 1.0013e+00, 3.8620e+05, 0.0000e+00,
         1.0729e+00, 1.1888e+00, 1.1262e+00, 4.0097e+05, 1.0191e+00, 3.8672e+05,
         9.8030e-01, 1.0134e+00, 3.9106e+05, 3.9733e+05],
        [3.8452e+05, 6.0547e-01, 4.0067e+05, 1.1424e+00, 3.8621e+05, 1.0729e+00,
         0.0000e+00, 5.6660e-01, 5.7865e-01, 4.0096e+05, 1.1922e+00, 3.8671e+05,
         1.1489e+00, 7.8166e-01, 3.9106e+05, 3.9732e+05],
        [3.8453e+05, 5.8098e-01, 4.0065e+05, 1.2661e+00, 3.8621e+05, 1.1888e+00,
         5.6660e-01, 0.0000e+00, 4.5870e-01, 4.0098e+05, 1.3399e+00, 3.8669e+05,
         1.2566e+00, 9.1801e-01, 3.9106e+05, 3.9732e+05],
        [3.8453e+05, 5.5358e-01, 4.0067e+05, 1.2153e+00, 3.8620e+05, 1.1262e+00,
         5.7865e-01, 4.5870e-01, 0.0000e+00, 4.0098e+05, 1.3513e+00, 3.8671e+05,
         1.1767e+00, 8.5855e-01, 3.9106e+05, 3.9734e+05],
        [7.6877e+05, 4.0098e+05, 8.0194e+05, 4.0094e+05, 7.7762e+05, 4.0097e+05,
         4.0096e+05, 4.0098e+05, 4.0098e+05, 0.0000e+00, 4.0096e+05, 8.0737e+05,
         4.0094e+05, 4.0098e+05, 8.0615e+05, 7.8741e+05],
        [3.8454e+05, 1.3042e+00, 4.0068e+05, 1.0302e+00, 3.8619e+05, 1.0191e+00,
         1.1922e+00, 1.3399e+00, 1.3513e+00, 4.0096e+05, 0.0000e+00, 3.8672e+05,
         1.0070e+00, 1.0468e+00, 3.9106e+05, 3.9732e+05],
        [7.9591e+05, 3.8670e+05, 7.7903e+05, 3.8672e+05, 7.5049e+05, 3.8672e+05,
         3.8671e+05, 3.8669e+05, 3.8671e+05, 8.0737e+05, 3.8672e+05, 0.0000e+00,
         3.8670e+05, 3.8673e+05, 7.8779e+05, 7.7024e+05],
        [3.8456e+05, 1.2114e+00, 4.0065e+05, 9.9383e-01, 3.8622e+05, 9.8030e-01,
         1.1489e+00, 1.2566e+00, 1.1767e+00, 4.0094e+05, 1.0070e+00, 3.8670e+05,
         0.0000e+00, 1.0009e+00, 3.9107e+05, 3.9732e+05],
        [3.8453e+05, 8.4449e-01, 4.0066e+05, 9.9591e-01, 3.8622e+05, 1.0134e+00,
         7.8166e-01, 9.1801e-01, 8.5855e-01, 4.0098e+05, 1.0468e+00, 3.8673e+05,
         1.0009e+00, 0.0000e+00, 3.9106e+05, 3.9734e+05],
        [7.9504e+05, 3.9106e+05, 7.9920e+05, 3.9105e+05, 7.9318e+05, 3.9106e+05,
         3.9106e+05, 3.9106e+05, 3.9106e+05, 8.0615e+05, 3.9106e+05, 7.8779e+05,
         3.9107e+05, 3.9106e+05, 0.0000e+00, 7.8397e+05],
        [8.0354e+05, 3.9734e+05, 7.8034e+05, 3.9733e+05, 7.8323e+05, 3.9733e+05,
         3.9732e+05, 3.9732e+05, 3.9734e+05, 7.8741e+05, 3.9732e+05, 7.7024e+05,
         3.9732e+05, 3.9734e+05, 7.8397e+05, 0.0000e+00]])
Krum scores: ['384522.72', '0.88', '400655.22', '1.08', '386203.06', '1.05', '0.84', '0.89', '0.85', '400961.47', '1.13', '386707.03', '1.07', '0.92', '391058.41', '397325.00']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 4, 15, 6, 13, 5, 11, 10, 12, 19, 7, 16, 3, 9, 18, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0061s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:10...
global Accuracy on shared test data: 71.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[158  79]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:10, End: 2025-07-22 16:02:10)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 19, 5, 7, 20, 8, 15, 18, 13, 9, 14, 11, 17, 4, 16, 2], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0208e+05, 1.1471e+00, 1.2422e+00, 3.9566e+05, 1.3290e+00,
         3.9039e+05, 3.8203e+05, 3.8870e+05, 8.8908e-01, 3.9248e+05, 6.1193e-01,
         3.9940e+05, 5.8104e-01, 3.8361e+05, 4.5359e-01],
        [4.0208e+05, 0.0000e+00, 4.0205e+05, 4.0206e+05, 7.7798e+05, 4.0206e+05,
         7.9779e+05, 7.9464e+05, 7.8924e+05, 4.0208e+05, 8.0599e+05, 4.0208e+05,
         8.2324e+05, 4.0207e+05, 7.8508e+05, 4.0209e+05],
        [1.1471e+00, 4.0205e+05, 0.0000e+00, 9.8093e-01, 3.9564e+05, 1.0751e+00,
         3.9039e+05, 3.8204e+05, 3.8868e+05, 1.0128e+00, 3.9246e+05, 1.5095e+00,
         3.9941e+05, 1.1077e+00, 3.8361e+05, 1.2057e+00],
        [1.2422e+00, 4.0206e+05, 9.8093e-01, 0.0000e+00, 3.9563e+05, 1.0132e+00,
         3.9040e+05, 3.8205e+05, 3.8869e+05, 1.0048e+00, 3.9250e+05, 1.6592e+00,
         3.9940e+05, 1.2214e+00, 3.8359e+05, 1.2898e+00],
        [3.9566e+05, 7.7798e+05, 3.9564e+05, 3.9563e+05, 0.0000e+00, 3.9561e+05,
         7.8741e+05, 7.6742e+05, 7.9073e+05, 3.9565e+05, 7.8277e+05, 3.9566e+05,
         7.9102e+05, 3.9563e+05, 7.9963e+05, 3.9565e+05],
        [1.3290e+00, 4.0206e+05, 1.0751e+00, 1.0132e+00, 3.9561e+05, 0.0000e+00,
         3.9043e+05, 3.8202e+05, 3.8866e+05, 1.0436e+00, 3.9248e+05, 1.7737e+00,
         3.9939e+05, 1.2368e+00, 3.8359e+05, 1.3923e+00],
        [3.9039e+05, 7.9779e+05, 3.9039e+05, 3.9040e+05, 7.8741e+05, 3.9043e+05,
         0.0000e+00, 7.6371e+05, 7.7646e+05, 3.9038e+05, 7.9028e+05, 3.9039e+05,
         7.7126e+05, 3.9039e+05, 7.6017e+05, 3.9039e+05],
        [3.8203e+05, 7.9464e+05, 3.8204e+05, 3.8205e+05, 7.6742e+05, 3.8202e+05,
         7.6371e+05, 0.0000e+00, 7.7389e+05, 3.8206e+05, 7.7815e+05, 3.8202e+05,
         7.8611e+05, 3.8205e+05, 7.8460e+05, 3.8205e+05],
        [3.8870e+05, 7.8924e+05, 3.8868e+05, 3.8869e+05, 7.9073e+05, 3.8866e+05,
         7.7646e+05, 7.7389e+05, 0.0000e+00, 3.8869e+05, 7.7744e+05, 3.8869e+05,
         7.8859e+05, 3.8869e+05, 7.8268e+05, 3.8871e+05],
        [8.8908e-01, 4.0208e+05, 1.0128e+00, 1.0048e+00, 3.9565e+05, 1.0436e+00,
         3.9038e+05, 3.8206e+05, 3.8869e+05, 0.0000e+00, 3.9250e+05, 1.1109e+00,
         3.9940e+05, 8.2471e-01, 3.8359e+05, 8.7120e-01],
        [3.9248e+05, 8.0599e+05, 3.9246e+05, 3.9250e+05, 7.8277e+05, 3.9248e+05,
         7.9028e+05, 7.7815e+05, 7.7744e+05, 3.9250e+05, 0.0000e+00, 3.9250e+05,
         7.9502e+05, 3.9248e+05, 7.9088e+05, 3.9248e+05],
        [6.1193e-01, 4.0208e+05, 1.5095e+00, 1.6592e+00, 3.9566e+05, 1.7737e+00,
         3.9039e+05, 3.8202e+05, 3.8869e+05, 1.1109e+00, 3.9250e+05, 0.0000e+00,
         3.9943e+05, 7.1930e-01, 3.8362e+05, 5.6533e-01],
        [3.9940e+05, 8.2324e+05, 3.9941e+05, 3.9940e+05, 7.9102e+05, 3.9939e+05,
         7.7126e+05, 7.8611e+05, 7.8859e+05, 3.9940e+05, 7.9502e+05, 3.9943e+05,
         0.0000e+00, 3.9941e+05, 7.8059e+05, 3.9941e+05],
        [5.8104e-01, 4.0207e+05, 1.1077e+00, 1.2214e+00, 3.9563e+05, 1.2368e+00,
         3.9039e+05, 3.8205e+05, 3.8869e+05, 8.2471e-01, 3.9248e+05, 7.1930e-01,
         3.9941e+05, 0.0000e+00, 3.8361e+05, 5.6422e-01],
        [3.8361e+05, 7.8508e+05, 3.8361e+05, 3.8359e+05, 7.9963e+05, 3.8359e+05,
         7.6017e+05, 7.8460e+05, 7.8268e+05, 3.8359e+05, 7.9088e+05, 3.8362e+05,
         7.8059e+05, 3.8361e+05, 0.0000e+00, 3.8364e+05],
        [4.5359e-01, 4.0209e+05, 1.2057e+00, 1.2898e+00, 3.9565e+05, 1.3923e+00,
         3.9039e+05, 3.8205e+05, 3.8871e+05, 8.7120e-01, 3.9248e+05, 5.6533e-01,
         3.9941e+05, 5.6422e-01, 3.8364e+05, 0.0000e+00]])
Krum scores: ['0.82', '402066.91', '1.09', '1.13', '395634.00', '1.18', '390389.25', '382034.38', '388683.41', '0.94', '392480.53', '1.03', '399401.50', '0.84', '383598.09', '0.82']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 19, 5, 7, 20, 8, 15, 18, 13, 9, 14, 11, 17, 4, 16, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:11...
global Accuracy on shared test data: 70.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[158  79]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:11, End: 2025-07-22 16:02:11)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 7, 1, 16, 10, 11, 18, 12, 4, 17, 8, 15, 14, 2, 3, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8753e+05, 3.8752e+05, 7.6855e+05, 3.8752e+05, 3.8752e+05,
         7.7729e+05, 3.8752e+05, 3.8752e+05, 8.0588e+05, 3.8752e+05, 7.9307e+05,
         8.0151e+05, 3.8752e+05, 3.8751e+05, 3.8751e+05],
        [3.8753e+05, 0.0000e+00, 8.9188e-01, 3.9204e+05, 1.5709e+00, 1.2183e+00,
         3.8306e+05, 1.1749e+00, 1.0417e+00, 4.1635e+05, 9.3212e-01, 3.9567e+05,
         4.0418e+05, 1.1649e+00, 8.7580e-01, 9.5854e-01],
        [3.8752e+05, 8.9188e-01, 0.0000e+00, 3.9203e+05, 1.5976e+00, 1.2241e+00,
         3.8304e+05, 1.1514e+00, 1.0431e+00, 4.1637e+05, 9.8277e-01, 3.9566e+05,
         4.0419e+05, 1.1720e+00, 8.9843e-01, 9.3547e-01],
        [7.6855e+05, 3.9204e+05, 3.9203e+05, 0.0000e+00, 3.9204e+05, 3.9205e+05,
         7.6381e+05, 3.9204e+05, 3.9204e+05, 8.2409e+05, 3.9203e+05, 7.8558e+05,
         8.1127e+05, 3.9204e+05, 3.9204e+05, 3.9204e+05],
        [3.8752e+05, 1.5709e+00, 1.5976e+00, 3.9204e+05, 0.0000e+00, 4.6191e-01,
         3.8310e+05, 5.4351e-01, 7.0247e-01, 4.1637e+05, 1.7157e+00, 3.9567e+05,
         4.0423e+05, 5.1066e-01, 1.4831e+00, 1.5729e+00],
        [3.8752e+05, 1.2183e+00, 1.2241e+00, 3.9205e+05, 4.6191e-01, 0.0000e+00,
         3.8309e+05, 4.4931e-01, 5.0597e-01, 4.1638e+05, 1.3460e+00, 3.9566e+05,
         4.0421e+05, 4.1904e-01, 1.1717e+00, 1.2460e+00],
        [7.7729e+05, 3.8306e+05, 3.8304e+05, 7.6381e+05, 3.8310e+05, 3.8309e+05,
         0.0000e+00, 3.8310e+05, 3.8307e+05, 7.9714e+05, 3.8306e+05, 7.8381e+05,
         7.9167e+05, 3.8311e+05, 3.8306e+05, 3.8305e+05],
        [3.8752e+05, 1.1749e+00, 1.1514e+00, 3.9204e+05, 5.4351e-01, 4.4931e-01,
         3.8310e+05, 0.0000e+00, 5.1457e-01, 4.1637e+05, 1.2758e+00, 3.9569e+05,
         4.0425e+05, 4.7816e-01, 1.0615e+00, 1.1440e+00],
        [3.8752e+05, 1.0417e+00, 1.0431e+00, 3.9204e+05, 7.0247e-01, 5.0597e-01,
         3.8307e+05, 5.1457e-01, 0.0000e+00, 4.1637e+05, 1.0859e+00, 3.9567e+05,
         4.0421e+05, 5.1312e-01, 9.9976e-01, 1.0323e+00],
        [8.0588e+05, 4.1635e+05, 4.1637e+05, 8.2409e+05, 4.1637e+05, 4.1638e+05,
         7.9714e+05, 4.1637e+05, 4.1637e+05, 0.0000e+00, 4.1639e+05, 8.1739e+05,
         8.1849e+05, 4.1637e+05, 4.1637e+05, 4.1638e+05],
        [3.8752e+05, 9.3212e-01, 9.8277e-01, 3.9203e+05, 1.7157e+00, 1.3460e+00,
         3.8306e+05, 1.2758e+00, 1.0859e+00, 4.1639e+05, 0.0000e+00, 3.9567e+05,
         4.0419e+05, 1.2916e+00, 9.1584e-01, 9.4974e-01],
        [7.9307e+05, 3.9567e+05, 3.9566e+05, 7.8558e+05, 3.9567e+05, 3.9566e+05,
         7.8381e+05, 3.9569e+05, 3.9567e+05, 8.1739e+05, 3.9567e+05, 0.0000e+00,
         8.0346e+05, 3.9567e+05, 3.9568e+05, 3.9567e+05],
        [8.0151e+05, 4.0418e+05, 4.0419e+05, 8.1127e+05, 4.0423e+05, 4.0421e+05,
         7.9167e+05, 4.0425e+05, 4.0421e+05, 8.1849e+05, 4.0419e+05, 8.0346e+05,
         0.0000e+00, 4.0421e+05, 4.0420e+05, 4.0420e+05],
        [3.8752e+05, 1.1649e+00, 1.1720e+00, 3.9204e+05, 5.1066e-01, 4.1904e-01,
         3.8311e+05, 4.7816e-01, 5.1312e-01, 4.1637e+05, 1.2916e+00, 3.9567e+05,
         4.0421e+05, 0.0000e+00, 1.1184e+00, 1.1168e+00],
        [3.8751e+05, 8.7580e-01, 8.9843e-01, 3.9204e+05, 1.4831e+00, 1.1717e+00,
         3.8306e+05, 1.0615e+00, 9.9976e-01, 4.1637e+05, 9.1584e-01, 3.9568e+05,
         4.0420e+05, 1.1184e+00, 0.0000e+00, 9.4354e-01],
        [3.8751e+05, 9.5854e-01, 9.3547e-01, 3.9204e+05, 1.5729e+00, 1.2460e+00,
         3.8305e+05, 1.1440e+00, 1.0323e+00, 4.1638e+05, 9.4974e-01, 3.9567e+05,
         4.0420e+05, 1.1168e+00, 9.4354e-01, 0.0000e+00]])
Krum scores: ['387516.25', '1.03', '1.04', '392038.00', '1.06', '0.84', '383065.84', '0.81', '0.79', '416367.25', '1.10', '395668.50', '404200.06', '0.81', '1.00', '1.04']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 7, 1, 16, 10, 11, 18, 12, 4, 17, 8, 15, 14, 2, 3, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0285s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:11...
global Accuracy on shared test data: 71.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 76 187]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:11, End: 2025-07-22 16:02:11)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 5, 18, 7, 15, 4, 14, 19, 17, 1, 13, 2, 16, 11, 6, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0860e+00, 3.7614e+05, 1.2526e+00, 3.9404e+05, 5.6636e-01,
         4.0669e+05, 3.8156e+05, 3.9642e+05, 1.1414e+00, 4.0531e+05, 4.9175e-01,
         3.8861e+05, 4.6829e-01, 1.1555e+00, 1.1145e+00],
        [1.0860e+00, 0.0000e+00, 3.7617e+05, 9.6696e-01, 3.9405e+05, 1.5086e+00,
         4.0669e+05, 3.8157e+05, 3.9642e+05, 9.1319e-01, 4.0530e+05, 1.1177e+00,
         3.8861e+05, 1.1319e+00, 9.5747e-01, 9.2426e-01],
        [3.7614e+05, 3.7617e+05, 0.0000e+00, 3.7617e+05, 7.6220e+05, 3.7614e+05,
         7.6771e+05, 7.6696e+05, 7.6190e+05, 3.7618e+05, 7.8807e+05, 3.7614e+05,
         7.5177e+05, 3.7614e+05, 3.7619e+05, 3.7618e+05],
        [1.2526e+00, 9.6696e-01, 3.7617e+05, 0.0000e+00, 3.9406e+05, 1.6661e+00,
         4.0670e+05, 3.8157e+05, 3.9638e+05, 9.3206e-01, 4.0533e+05, 1.2265e+00,
         3.8859e+05, 1.2556e+00, 9.7805e-01, 9.6266e-01],
        [3.9404e+05, 3.9405e+05, 7.6220e+05, 3.9406e+05, 0.0000e+00, 3.9404e+05,
         7.9521e+05, 7.8309e+05, 7.6861e+05, 3.9405e+05, 7.9160e+05, 3.9404e+05,
         7.9047e+05, 3.9406e+05, 3.9408e+05, 3.9407e+05],
        [5.6636e-01, 1.5086e+00, 3.7614e+05, 1.6661e+00, 3.9404e+05, 0.0000e+00,
         4.0667e+05, 3.8156e+05, 3.9642e+05, 1.5706e+00, 4.0533e+05, 5.2122e-01,
         3.8862e+05, 5.0722e-01, 1.5764e+00, 1.5572e+00],
        [4.0669e+05, 4.0669e+05, 7.6771e+05, 4.0670e+05, 7.9521e+05, 4.0667e+05,
         0.0000e+00, 7.7727e+05, 8.0979e+05, 4.0673e+05, 8.2102e+05, 4.0670e+05,
         8.3128e+05, 4.0670e+05, 4.0671e+05, 4.0670e+05],
        [3.8156e+05, 3.8157e+05, 7.6696e+05, 3.8157e+05, 7.8309e+05, 3.8156e+05,
         7.7727e+05, 0.0000e+00, 7.5265e+05, 3.8160e+05, 7.9453e+05, 3.8158e+05,
         7.6371e+05, 3.8156e+05, 3.8159e+05, 3.8159e+05],
        [3.9642e+05, 3.9642e+05, 7.6190e+05, 3.9638e+05, 7.6861e+05, 3.9642e+05,
         8.0979e+05, 7.5265e+05, 0.0000e+00, 3.9641e+05, 8.3075e+05, 3.9641e+05,
         7.7844e+05, 3.9641e+05, 3.9640e+05, 3.9640e+05],
        [1.1414e+00, 9.1319e-01, 3.7618e+05, 9.3206e-01, 3.9405e+05, 1.5706e+00,
         4.0673e+05, 3.8160e+05, 3.9641e+05, 0.0000e+00, 4.0529e+05, 1.1589e+00,
         3.8862e+05, 1.1860e+00, 9.0520e-01, 9.0173e-01],
        [4.0531e+05, 4.0530e+05, 7.8807e+05, 4.0533e+05, 7.9160e+05, 4.0533e+05,
         8.2102e+05, 7.9453e+05, 8.3075e+05, 4.0529e+05, 0.0000e+00, 4.0532e+05,
         7.9789e+05, 4.0533e+05, 4.0533e+05, 4.0531e+05],
        [4.9175e-01, 1.1177e+00, 3.7614e+05, 1.2265e+00, 3.9404e+05, 5.2122e-01,
         4.0670e+05, 3.8158e+05, 3.9641e+05, 1.1589e+00, 4.0532e+05, 0.0000e+00,
         3.8861e+05, 4.4177e-01, 1.1075e+00, 1.1187e+00],
        [3.8861e+05, 3.8861e+05, 7.5177e+05, 3.8859e+05, 7.9047e+05, 3.8862e+05,
         8.3128e+05, 7.6371e+05, 7.7844e+05, 3.8862e+05, 7.9789e+05, 3.8861e+05,
         0.0000e+00, 3.8861e+05, 3.8863e+05, 3.8863e+05],
        [4.6829e-01, 1.1319e+00, 3.7614e+05, 1.2556e+00, 3.9406e+05, 5.0722e-01,
         4.0670e+05, 3.8156e+05, 3.9641e+05, 1.1860e+00, 4.0533e+05, 4.4177e-01,
         3.8861e+05, 0.0000e+00, 1.1900e+00, 1.1755e+00],
        [1.1555e+00, 9.5747e-01, 3.7619e+05, 9.7805e-01, 3.9408e+05, 1.5764e+00,
         4.0671e+05, 3.8159e+05, 3.9640e+05, 9.0520e-01, 4.0533e+05, 1.1075e+00,
         3.8863e+05, 1.1900e+00, 0.0000e+00, 9.2603e-01],
        [1.1145e+00, 9.2426e-01, 3.7618e+05, 9.6266e-01, 3.9407e+05, 1.5572e+00,
         4.0670e+05, 3.8159e+05, 3.9640e+05, 9.0173e-01, 4.0531e+05, 1.1187e+00,
         3.8863e+05, 1.1755e+00, 9.2603e-01, 0.0000e+00]])
Krum scores: ['0.86', '1.01', '376153.56', '1.08', '394048.06', '1.12', '406694.09', '381571.06', '396405.25', '1.02', '405312.09', '0.85', '388609.78', '0.87', '1.03', '1.02']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 5, 18, 7, 15, 4, 14, 19, 17, 1, 13, 2, 16, 11, 6, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0073s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:12...
global Accuracy on shared test data: 71.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[167  70]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:12, End: 2025-07-22 16:02:12)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 13, 7, 17, 18, 14, 10, 20, 4, 12, 2, 5, 8, 3, 9, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8661e+05, 1.0756e+00, 3.9419e+05, 4.0512e+05, 4.1065e+05,
         3.5449e-01, 3.9568e+05, 4.0688e-01, 4.5412e-01, 5.0363e-01, 1.0185e+00,
         1.2142e+00, 1.0565e+00, 7.1875e-01, 4.0579e+05],
        [3.8661e+05, 0.0000e+00, 3.8661e+05, 7.7981e+05, 7.8297e+05, 8.0262e+05,
         3.8660e+05, 7.7966e+05, 3.8659e+05, 3.8660e+05, 3.8660e+05, 3.8662e+05,
         3.8660e+05, 3.8660e+05, 3.8659e+05, 7.9170e+05],
        [1.0756e+00, 3.8661e+05, 0.0000e+00, 3.9418e+05, 4.0510e+05, 4.1061e+05,
         1.1890e+00, 3.9568e+05, 1.3099e+00, 1.0988e+00, 1.5732e+00, 9.0612e-01,
         9.6470e-01, 9.0898e-01, 9.2616e-01, 4.0579e+05],
        [3.9419e+05, 7.7981e+05, 3.9418e+05, 0.0000e+00, 7.9571e+05, 7.9928e+05,
         3.9418e+05, 7.7556e+05, 3.9418e+05, 3.9415e+05, 3.9417e+05, 3.9419e+05,
         3.9419e+05, 3.9417e+05, 3.9418e+05, 8.1173e+05],
        [4.0512e+05, 7.8297e+05, 4.0510e+05, 7.9571e+05, 0.0000e+00, 8.1359e+05,
         4.0511e+05, 8.0988e+05, 4.0512e+05, 4.0510e+05, 4.0513e+05, 4.0511e+05,
         4.0506e+05, 4.0509e+05, 4.0512e+05, 8.1274e+05],
        [4.1065e+05, 8.0262e+05, 4.1061e+05, 7.9928e+05, 8.1359e+05, 0.0000e+00,
         4.1065e+05, 8.1760e+05, 4.1067e+05, 4.1064e+05, 4.1067e+05, 4.1063e+05,
         4.1065e+05, 4.1066e+05, 4.1063e+05, 8.2088e+05],
        [3.5449e-01, 3.8660e+05, 1.1890e+00, 3.9418e+05, 4.0511e+05, 4.1065e+05,
         0.0000e+00, 3.9568e+05, 3.8330e-01, 4.2330e-01, 4.2026e-01, 1.1207e+00,
         1.2984e+00, 1.1537e+00, 8.2863e-01, 4.0578e+05],
        [3.9568e+05, 7.7966e+05, 3.9568e+05, 7.7556e+05, 8.0988e+05, 8.1760e+05,
         3.9568e+05, 0.0000e+00, 3.9568e+05, 3.9569e+05, 3.9569e+05, 3.9567e+05,
         3.9567e+05, 3.9569e+05, 3.9567e+05, 8.2591e+05],
        [4.0688e-01, 3.8659e+05, 1.3099e+00, 3.9418e+05, 4.0512e+05, 4.1067e+05,
         3.8330e-01, 3.9568e+05, 0.0000e+00, 4.9557e-01, 4.3846e-01, 1.2308e+00,
         1.3714e+00, 1.2553e+00, 8.7007e-01, 4.0578e+05],
        [4.5412e-01, 3.8660e+05, 1.0988e+00, 3.9415e+05, 4.0510e+05, 4.1064e+05,
         4.2330e-01, 3.9569e+05, 4.9557e-01, 0.0000e+00, 6.2937e-01, 1.0049e+00,
         1.1873e+00, 9.9461e-01, 7.5556e-01, 4.0577e+05],
        [5.0363e-01, 3.8660e+05, 1.5732e+00, 3.9417e+05, 4.0513e+05, 4.1067e+05,
         4.2026e-01, 3.9569e+05, 4.3846e-01, 6.2937e-01, 0.0000e+00, 1.4922e+00,
         1.7093e+00, 1.5052e+00, 1.0985e+00, 4.0576e+05],
        [1.0185e+00, 3.8662e+05, 9.0612e-01, 3.9419e+05, 4.0511e+05, 4.1063e+05,
         1.1207e+00, 3.9567e+05, 1.2308e+00, 1.0049e+00, 1.4922e+00, 0.0000e+00,
         1.0076e+00, 9.0660e-01, 9.2972e-01, 4.0579e+05],
        [1.2142e+00, 3.8660e+05, 9.6470e-01, 3.9419e+05, 4.0506e+05, 4.1065e+05,
         1.2984e+00, 3.9567e+05, 1.3714e+00, 1.1873e+00, 1.7093e+00, 1.0076e+00,
         0.0000e+00, 9.1056e-01, 9.5145e-01, 4.0577e+05],
        [1.0565e+00, 3.8660e+05, 9.0898e-01, 3.9417e+05, 4.0509e+05, 4.1066e+05,
         1.1537e+00, 3.9569e+05, 1.2553e+00, 9.9461e-01, 1.5052e+00, 9.0660e-01,
         9.1056e-01, 0.0000e+00, 8.9768e-01, 4.0576e+05],
        [7.1875e-01, 3.8659e+05, 9.2616e-01, 3.9418e+05, 4.0512e+05, 4.1063e+05,
         8.2863e-01, 3.9567e+05, 8.7007e-01, 7.5556e-01, 1.0985e+00, 9.2972e-01,
         9.5145e-01, 8.9768e-01, 0.0000e+00, 4.0577e+05],
        [4.0579e+05, 7.9170e+05, 4.0579e+05, 8.1173e+05, 8.1274e+05, 8.2088e+05,
         4.0578e+05, 8.2591e+05, 4.0578e+05, 4.0577e+05, 4.0576e+05, 4.0579e+05,
         4.0577e+05, 4.0576e+05, 4.0577e+05, 0.0000e+00]])
Krum scores: ['0.70', '386597.06', '1.05', '394175.66', '405102.91', '410641.84', '0.73', '395676.94', '0.80', '0.73', '0.96', '1.02', '1.11', '1.01', '0.86', '405772.41']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 13, 7, 17, 18, 14, 10, 20, 4, 12, 2, 5, 8, 3, 9, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0134s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:13...
global Accuracy on shared test data: 70.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[158  79]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:13, End: 2025-07-22 16:02:13)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 4, 5, 10, 8, 19, 14, 3, 11, 20, 12, 1, 13, 15, 16, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.3318e-01, 1.1707e+00, 3.0178e-01, 1.3735e+00, 4.0101e+05,
         3.7968e+05, 1.1681e+00, 3.7421e-01, 3.9141e+05, 4.6362e-01, 1.2710e+00,
         3.7496e+05, 4.0520e+05, 3.8496e+05, 8.5155e-01],
        [3.3318e-01, 0.0000e+00, 1.1378e+00, 3.7498e-01, 1.2851e+00, 4.0101e+05,
         3.7968e+05, 1.1457e+00, 4.6291e-01, 3.9140e+05, 4.6980e-01, 1.2433e+00,
         3.7496e+05, 4.0520e+05, 3.8496e+05, 8.2894e-01],
        [1.1707e+00, 1.1378e+00, 0.0000e+00, 1.0874e+00, 1.0329e+00, 4.0103e+05,
         3.7965e+05, 9.0476e-01, 1.4010e+00, 3.9140e+05, 9.5690e-01, 9.3609e-01,
         3.7493e+05, 4.0521e+05, 3.8494e+05, 9.5072e-01],
        [3.0178e-01, 3.7498e-01, 1.0874e+00, 0.0000e+00, 1.2933e+00, 4.0102e+05,
         3.7967e+05, 1.1116e+00, 4.2593e-01, 3.9140e+05, 4.1972e-01, 1.2194e+00,
         3.7495e+05, 4.0521e+05, 3.8495e+05, 8.3645e-01],
        [1.3735e+00, 1.2851e+00, 1.0329e+00, 1.2933e+00, 0.0000e+00, 4.0105e+05,
         3.7966e+05, 9.4332e-01, 1.6586e+00, 3.9142e+05, 1.1508e+00, 1.0181e+00,
         3.7494e+05, 4.0521e+05, 3.8494e+05, 9.9609e-01],
        [4.0101e+05, 4.0101e+05, 4.0103e+05, 4.0102e+05, 4.0105e+05, 0.0000e+00,
         7.7283e+05, 4.0104e+05, 4.0102e+05, 8.0144e+05, 4.0102e+05, 4.0105e+05,
         7.6695e+05, 8.0087e+05, 7.7869e+05, 4.0105e+05],
        [3.7968e+05, 3.7968e+05, 3.7965e+05, 3.7967e+05, 3.7966e+05, 7.7283e+05,
         0.0000e+00, 3.7965e+05, 3.7968e+05, 7.7588e+05, 3.7967e+05, 3.7967e+05,
         7.5399e+05, 7.8174e+05, 7.7115e+05, 3.7964e+05],
        [1.1681e+00, 1.1457e+00, 9.0476e-01, 1.1116e+00, 9.4332e-01, 4.0104e+05,
         3.7965e+05, 0.0000e+00, 1.4304e+00, 3.9142e+05, 9.3603e-01, 9.3700e-01,
         3.7494e+05, 4.0521e+05, 3.8495e+05, 8.9858e-01],
        [3.7421e-01, 4.6291e-01, 1.4010e+00, 4.2593e-01, 1.6586e+00, 4.0102e+05,
         3.7968e+05, 1.4304e+00, 0.0000e+00, 3.9140e+05, 6.1406e-01, 1.5315e+00,
         3.7496e+05, 4.0520e+05, 3.8493e+05, 1.0714e+00],
        [3.9141e+05, 3.9140e+05, 3.9140e+05, 3.9140e+05, 3.9142e+05, 8.0144e+05,
         7.7588e+05, 3.9142e+05, 3.9140e+05, 0.0000e+00, 3.9140e+05, 3.9140e+05,
         7.6060e+05, 7.9681e+05, 7.8510e+05, 3.9141e+05],
        [4.6362e-01, 4.6980e-01, 9.5690e-01, 4.1972e-01, 1.1508e+00, 4.0102e+05,
         3.7967e+05, 9.3603e-01, 6.1406e-01, 3.9140e+05, 0.0000e+00, 1.0400e+00,
         3.7493e+05, 4.0520e+05, 3.8496e+05, 7.4638e-01],
        [1.2710e+00, 1.2433e+00, 9.3609e-01, 1.2194e+00, 1.0181e+00, 4.0105e+05,
         3.7967e+05, 9.3700e-01, 1.5315e+00, 3.9140e+05, 1.0400e+00, 0.0000e+00,
         3.7492e+05, 4.0521e+05, 3.8494e+05, 9.6266e-01],
        [3.7496e+05, 3.7496e+05, 3.7493e+05, 3.7495e+05, 3.7494e+05, 7.6695e+05,
         7.5399e+05, 3.7494e+05, 3.7496e+05, 7.6060e+05, 3.7493e+05, 3.7492e+05,
         0.0000e+00, 7.7180e+05, 7.4020e+05, 3.7493e+05],
        [4.0520e+05, 4.0520e+05, 4.0521e+05, 4.0521e+05, 4.0521e+05, 8.0087e+05,
         7.8174e+05, 4.0521e+05, 4.0520e+05, 7.9681e+05, 4.0520e+05, 4.0521e+05,
         7.7180e+05, 0.0000e+00, 7.8545e+05, 4.0519e+05],
        [3.8496e+05, 3.8496e+05, 3.8494e+05, 3.8495e+05, 3.8494e+05, 7.7869e+05,
         7.7115e+05, 3.8495e+05, 3.8493e+05, 7.8510e+05, 3.8496e+05, 3.8494e+05,
         7.4020e+05, 7.8545e+05, 0.0000e+00, 3.8498e+05],
        [8.5155e-01, 8.2894e-01, 9.5072e-01, 8.3645e-01, 9.9609e-01, 4.0105e+05,
         3.7964e+05, 8.9858e-01, 1.0714e+00, 3.9141e+05, 7.4638e-01, 9.6266e-01,
         3.7493e+05, 4.0519e+05, 3.8498e+05, 0.0000e+00]])
Krum scores: ['0.74', '0.75', '1.02', '0.72', '1.14', '401023.69', '379661.31', '1.01', '0.91', '391402.06', '0.71', '1.08', '374938.12', '405200.69', '384946.41', '0.88']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 4, 5, 10, 8, 19, 14, 3, 11, 20, 12, 1, 13, 15, 16, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0203s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:13...
global Accuracy on shared test data: 71.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 80 183]]
Function 'evaluate_global_model' executed in 0.0023 seconds (Start: 2025-07-22 16:02:13, End: 2025-07-22 16:02:13)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 6, 13, 1, 20, 18, 9, 12, 16, 2, 3, 17, 19, 15, 11, 10], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.7092e-01, 3.8239e+05, 9.4352e-01, 4.1118e+05, 4.0047e+05,
         1.0035e+00, 1.6425e+00, 3.7924e+05, 1.2631e+00, 9.2046e-01, 3.8957e+05,
         3.8031e+05, 3.8419e+05, 1.2881e+00, 1.2358e+00],
        [9.7092e-01, 0.0000e+00, 3.8242e+05, 9.1794e-01, 4.1114e+05, 4.0049e+05,
         9.3583e-01, 1.4167e+00, 3.7921e+05, 1.0693e+00, 9.1733e-01, 3.8959e+05,
         3.8030e+05, 3.8418e+05, 1.1243e+00, 1.0983e+00],
        [3.8239e+05, 3.8242e+05, 0.0000e+00, 3.8242e+05, 8.1629e+05, 7.7956e+05,
         3.8241e+05, 3.8240e+05, 7.5277e+05, 3.8243e+05, 3.8242e+05, 7.8325e+05,
         7.5849e+05, 7.3705e+05, 3.8242e+05, 3.8242e+05],
        [9.4352e-01, 9.1794e-01, 3.8242e+05, 0.0000e+00, 4.1113e+05, 4.0047e+05,
         9.5209e-01, 1.5359e+00, 3.7920e+05, 1.2040e+00, 9.2344e-01, 3.8958e+05,
         3.8032e+05, 3.8417e+05, 1.2307e+00, 1.2033e+00],
        [4.1118e+05, 4.1114e+05, 8.1629e+05, 4.1113e+05, 0.0000e+00, 8.0212e+05,
         4.1115e+05, 4.1116e+05, 7.8472e+05, 4.1114e+05, 4.1117e+05, 8.0520e+05,
         7.7277e+05, 7.9618e+05, 4.1115e+05, 4.1116e+05],
        [4.0047e+05, 4.0049e+05, 7.7956e+05, 4.0047e+05, 8.0212e+05, 0.0000e+00,
         4.0048e+05, 4.0049e+05, 7.7245e+05, 4.0047e+05, 4.0048e+05, 7.8215e+05,
         7.7364e+05, 7.9018e+05, 4.0047e+05, 4.0050e+05],
        [1.0035e+00, 9.3583e-01, 3.8241e+05, 9.5209e-01, 4.1115e+05, 4.0048e+05,
         0.0000e+00, 1.0959e+00, 3.7921e+05, 8.1568e-01, 9.2355e-01, 3.8959e+05,
         3.8029e+05, 3.8422e+05, 8.1998e-01, 8.3686e-01],
        [1.6425e+00, 1.4167e+00, 3.8240e+05, 1.5359e+00, 4.1116e+05, 4.0049e+05,
         1.0959e+00, 0.0000e+00, 3.7918e+05, 4.3955e-01, 1.3738e+00, 3.8960e+05,
         3.8030e+05, 3.8421e+05, 4.1060e-01, 4.5705e-01],
        [3.7924e+05, 3.7921e+05, 7.5277e+05, 3.7920e+05, 7.8472e+05, 7.7245e+05,
         3.7921e+05, 3.7918e+05, 0.0000e+00, 3.7919e+05, 3.7923e+05, 7.6513e+05,
         7.3915e+05, 7.7919e+05, 3.7919e+05, 3.7919e+05],
        [1.2631e+00, 1.0693e+00, 3.8243e+05, 1.2040e+00, 4.1114e+05, 4.0047e+05,
         8.1568e-01, 4.3955e-01, 3.7919e+05, 0.0000e+00, 1.0711e+00, 3.8958e+05,
         3.8030e+05, 3.8422e+05, 2.7636e-01, 3.1306e-01],
        [9.2046e-01, 9.1733e-01, 3.8242e+05, 9.2344e-01, 4.1117e+05, 4.0048e+05,
         9.2355e-01, 1.3738e+00, 3.7923e+05, 1.0711e+00, 0.0000e+00, 3.8956e+05,
         3.8028e+05, 3.8424e+05, 1.1033e+00, 1.0628e+00],
        [3.8957e+05, 3.8959e+05, 7.8325e+05, 3.8958e+05, 8.0520e+05, 7.8215e+05,
         3.8959e+05, 3.8960e+05, 7.6513e+05, 3.8958e+05, 3.8956e+05, 0.0000e+00,
         7.6475e+05, 7.9004e+05, 3.8959e+05, 3.8959e+05],
        [3.8031e+05, 3.8030e+05, 7.5849e+05, 3.8032e+05, 7.7277e+05, 7.7364e+05,
         3.8029e+05, 3.8030e+05, 7.3915e+05, 3.8030e+05, 3.8028e+05, 7.6475e+05,
         0.0000e+00, 7.8513e+05, 3.8030e+05, 3.8030e+05],
        [3.8419e+05, 3.8418e+05, 7.3705e+05, 3.8417e+05, 7.9618e+05, 7.9018e+05,
         3.8422e+05, 3.8421e+05, 7.7919e+05, 3.8422e+05, 3.8424e+05, 7.9004e+05,
         7.8513e+05, 0.0000e+00, 3.8422e+05, 3.8422e+05],
        [1.2881e+00, 1.1243e+00, 3.8242e+05, 1.2307e+00, 4.1115e+05, 4.0047e+05,
         8.1998e-01, 4.1060e-01, 3.7919e+05, 2.7636e-01, 1.1033e+00, 3.8959e+05,
         3.8030e+05, 3.8422e+05, 0.0000e+00, 3.0509e-01],
        [1.2358e+00, 1.0983e+00, 3.8242e+05, 1.2033e+00, 4.1116e+05, 4.0050e+05,
         8.3686e-01, 4.5705e-01, 3.7919e+05, 3.1306e-01, 1.0628e+00, 3.8959e+05,
         3.8030e+05, 3.8422e+05, 3.0509e-01, 0.0000e+00]])
Krum scores: ['1.09', '1.00', '382412.31', '1.05', '411145.28', '400474.94', '0.90', '0.96', '379195.56', '0.74', '0.99', '389580.16', '380295.78', '384201.78', '0.75', '0.75']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 6, 13, 1, 20, 18, 9, 12, 16, 2, 3, 17, 19, 15, 11, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0077s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:14...
global Accuracy on shared test data: 71.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 78 185]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:14, End: 2025-07-22 16:02:14)
start time is: 99098076632980, end time is: 99115988539559
The total time is: 17911906579ns.

 ------- aggregate method: krum, random_seed: 200 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 14, 11, 12, 13, 9, 6, 10, 17, 16, 3, 15, 2, 19, 8, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9359e+05, 4.6380e+00, 4.5598e+00, 3.8738e+05, 4.6548e+00,
         5.3735e+00, 4.5142e+00, 3.9622e+05, 4.0587e+05, 5.4571e+00, 3.8794e+05,
         4.7549e+00, 3.8451e+05, 6.7116e+00, 4.0174e+05],
        [3.9359e+05, 0.0000e+00, 3.9356e+05, 3.9358e+05, 7.8104e+05, 3.9355e+05,
         3.9352e+05, 3.9360e+05, 7.8285e+05, 8.1626e+05, 3.9357e+05, 7.7951e+05,
         3.9353e+05, 7.8114e+05, 3.9358e+05, 7.9814e+05],
        [4.6380e+00, 3.9356e+05, 0.0000e+00, 4.8321e+00, 3.8739e+05, 5.3278e+00,
         5.2496e+00, 4.6284e+00, 3.9620e+05, 4.0585e+05, 6.2411e+00, 3.8796e+05,
         4.6855e+00, 3.8454e+05, 6.0745e+00, 4.0172e+05],
        [4.5598e+00, 3.9358e+05, 4.8321e+00, 0.0000e+00, 3.8737e+05, 4.5538e+00,
         4.5619e+00, 4.3948e+00, 3.9621e+05, 4.0581e+05, 4.5108e+00, 3.8791e+05,
         4.6342e+00, 3.8455e+05, 5.4395e+00, 4.0175e+05],
        [3.8738e+05, 7.8104e+05, 3.8739e+05, 3.8737e+05, 0.0000e+00, 3.8740e+05,
         3.8742e+05, 3.8748e+05, 7.7466e+05, 7.8585e+05, 3.8744e+05, 7.8614e+05,
         3.8743e+05, 7.5296e+05, 3.8742e+05, 7.8688e+05],
        [4.6548e+00, 3.9355e+05, 5.3278e+00, 4.5538e+00, 3.8740e+05, 0.0000e+00,
         4.7726e+00, 4.7332e+00, 3.9618e+05, 4.0580e+05, 4.4018e+00, 3.8793e+05,
         4.5360e+00, 3.8454e+05, 5.5625e+00, 4.0172e+05],
        [5.3735e+00, 3.9352e+05, 5.2496e+00, 4.5619e+00, 3.8742e+05, 4.7726e+00,
         0.0000e+00, 4.3040e+00, 3.9625e+05, 4.0582e+05, 4.1407e+00, 3.8794e+05,
         4.9420e+00, 3.8448e+05, 5.4327e+00, 4.0172e+05],
        [4.5142e+00, 3.9360e+05, 4.6284e+00, 4.3948e+00, 3.8748e+05, 4.7332e+00,
         4.3040e+00, 0.0000e+00, 3.9623e+05, 4.0584e+05, 4.3759e+00, 3.8791e+05,
         5.0749e+00, 3.8453e+05, 5.6542e+00, 4.0177e+05],
        [3.9622e+05, 7.8285e+05, 3.9620e+05, 3.9621e+05, 7.7466e+05, 3.9618e+05,
         3.9625e+05, 3.9623e+05, 0.0000e+00, 7.8409e+05, 3.9617e+05, 7.9866e+05,
         3.9616e+05, 7.8814e+05, 3.9618e+05, 7.8932e+05],
        [4.0587e+05, 8.1626e+05, 4.0585e+05, 4.0581e+05, 7.8585e+05, 4.0580e+05,
         4.0582e+05, 4.0584e+05, 7.8409e+05, 0.0000e+00, 4.0581e+05, 7.9179e+05,
         4.0577e+05, 7.8921e+05, 4.0582e+05, 7.9455e+05],
        [5.4571e+00, 3.9357e+05, 6.2411e+00, 4.5108e+00, 3.8744e+05, 4.4018e+00,
         4.1407e+00, 4.3759e+00, 3.9617e+05, 4.0581e+05, 0.0000e+00, 3.8792e+05,
         5.1639e+00, 3.8448e+05, 5.3577e+00, 4.0175e+05],
        [3.8794e+05, 7.7951e+05, 3.8796e+05, 3.8791e+05, 7.8614e+05, 3.8793e+05,
         3.8794e+05, 3.8791e+05, 7.9866e+05, 7.9179e+05, 3.8792e+05, 0.0000e+00,
         3.8790e+05, 7.7666e+05, 3.8783e+05, 7.8981e+05],
        [4.7549e+00, 3.9353e+05, 4.6855e+00, 4.6342e+00, 3.8743e+05, 4.5360e+00,
         4.9420e+00, 5.0749e+00, 3.9616e+05, 4.0577e+05, 5.1639e+00, 3.8790e+05,
         0.0000e+00, 3.8449e+05, 6.2290e+00, 4.0169e+05],
        [3.8451e+05, 7.8114e+05, 3.8454e+05, 3.8455e+05, 7.5296e+05, 3.8454e+05,
         3.8448e+05, 3.8453e+05, 7.8814e+05, 7.8921e+05, 3.8448e+05, 7.7666e+05,
         3.8449e+05, 0.0000e+00, 3.8452e+05, 7.8833e+05],
        [6.7116e+00, 3.9358e+05, 6.0745e+00, 5.4395e+00, 3.8742e+05, 5.5625e+00,
         5.4327e+00, 5.6542e+00, 3.9618e+05, 4.0582e+05, 5.3577e+00, 3.8783e+05,
         6.2290e+00, 3.8452e+05, 0.0000e+00, 4.0175e+05],
        [4.0174e+05, 7.9814e+05, 4.0172e+05, 4.0175e+05, 7.8688e+05, 4.0172e+05,
         4.0172e+05, 4.0177e+05, 7.8932e+05, 7.9455e+05, 4.0175e+05, 7.8981e+05,
         4.0169e+05, 7.8833e+05, 4.0175e+05, 0.0000e+00]])
Krum scores: ['4.85', '393554.66', '5.06', '4.58', '387401.34', '4.71', '4.76', '4.58', '396188.75', '405810.47', '4.77', '387907.66', '4.83', '384507.31', '5.68', '401727.81']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 14, 11, 12, 13, 9, 6, 10, 17, 16, 3, 15, 2, 19, 8, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0057s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:14...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 16:02:14, End: 2025-07-22 16:02:14)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 19, 4, 15, 10, 18, 1, 17, 20, 8, 2, 12, 3, 5, 6, 7], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.7717e+05, 3.8413e+05, 7.8048e+05, 3.8410e+05, 7.7175e+05,
         3.8413e+05, 7.7731e+05, 7.9735e+05, 3.8413e+05, 3.8416e+05, 3.8414e+05,
         3.8413e+05, 3.8414e+05, 3.8416e+05, 3.8415e+05],
        [7.7717e+05, 0.0000e+00, 3.9271e+05, 7.9706e+05, 3.9273e+05, 8.0522e+05,
         3.9268e+05, 8.0765e+05, 7.9279e+05, 3.9265e+05, 3.9270e+05, 3.9269e+05,
         3.9267e+05, 3.9269e+05, 3.9271e+05, 3.9269e+05],
        [3.8413e+05, 3.9271e+05, 0.0000e+00, 3.9049e+05, 2.2932e+00, 3.9364e+05,
         2.1778e+00, 3.9508e+05, 4.0303e+05, 2.2087e+00, 2.2647e+00, 2.2341e+00,
         2.3216e+00, 2.1914e+00, 2.1967e+00, 2.1016e+00],
        [7.8048e+05, 7.9706e+05, 3.9049e+05, 0.0000e+00, 3.9049e+05, 8.0001e+05,
         3.9048e+05, 7.8482e+05, 7.9761e+05, 3.9048e+05, 3.9044e+05, 3.9048e+05,
         3.9052e+05, 3.9047e+05, 3.9046e+05, 3.9048e+05],
        [3.8410e+05, 3.9273e+05, 2.2932e+00, 3.9049e+05, 0.0000e+00, 3.9360e+05,
         2.2216e+00, 3.9509e+05, 4.0296e+05, 2.3214e+00, 2.1144e+00, 2.2912e+00,
         2.1677e+00, 2.2225e+00, 2.3783e+00, 2.3607e+00],
        [7.7175e+05, 8.0522e+05, 3.9364e+05, 8.0001e+05, 3.9360e+05, 0.0000e+00,
         3.9365e+05, 7.9439e+05, 8.2325e+05, 3.9362e+05, 3.9362e+05, 3.9369e+05,
         3.9368e+05, 3.9363e+05, 3.9361e+05, 3.9362e+05],
        [3.8413e+05, 3.9268e+05, 2.1778e+00, 3.9048e+05, 2.2216e+00, 3.9365e+05,
         0.0000e+00, 3.9510e+05, 4.0302e+05, 2.3725e+00, 2.0566e+00, 2.3574e+00,
         2.2910e+00, 2.2489e+00, 2.2985e+00, 2.2231e+00],
        [7.7731e+05, 8.0765e+05, 3.9508e+05, 7.8482e+05, 3.9509e+05, 7.9439e+05,
         3.9510e+05, 0.0000e+00, 7.6184e+05, 3.9512e+05, 3.9505e+05, 3.9509e+05,
         3.9510e+05, 3.9510e+05, 3.9506e+05, 3.9506e+05],
        [7.9735e+05, 7.9279e+05, 4.0303e+05, 7.9761e+05, 4.0296e+05, 8.2325e+05,
         4.0302e+05, 7.6184e+05, 0.0000e+00, 4.0300e+05, 4.0301e+05, 4.0303e+05,
         4.0302e+05, 4.0298e+05, 4.0300e+05, 4.0300e+05],
        [3.8413e+05, 3.9265e+05, 2.2087e+00, 3.9048e+05, 2.3214e+00, 3.9362e+05,
         2.3725e+00, 3.9512e+05, 4.0300e+05, 0.0000e+00, 2.3582e+00, 2.2672e+00,
         2.2525e+00, 2.4880e+00, 2.3488e+00, 2.3927e+00],
        [3.8416e+05, 3.9270e+05, 2.2647e+00, 3.9044e+05, 2.1144e+00, 3.9362e+05,
         2.0566e+00, 3.9505e+05, 4.0301e+05, 2.3582e+00, 0.0000e+00, 2.2750e+00,
         2.1398e+00, 2.2823e+00, 2.1518e+00, 2.0565e+00],
        [3.8414e+05, 3.9269e+05, 2.2341e+00, 3.9048e+05, 2.2912e+00, 3.9369e+05,
         2.3574e+00, 3.9509e+05, 4.0303e+05, 2.2672e+00, 2.2750e+00, 0.0000e+00,
         2.0752e+00, 2.2713e+00, 2.3794e+00, 2.2246e+00],
        [3.8413e+05, 3.9267e+05, 2.3216e+00, 3.9052e+05, 2.1677e+00, 3.9368e+05,
         2.2910e+00, 3.9510e+05, 4.0302e+05, 2.2525e+00, 2.1398e+00, 2.0752e+00,
         0.0000e+00, 2.1074e+00, 2.4813e+00, 2.1976e+00],
        [3.8414e+05, 3.9269e+05, 2.1914e+00, 3.9047e+05, 2.2225e+00, 3.9363e+05,
         2.2489e+00, 3.9510e+05, 4.0298e+05, 2.4880e+00, 2.2823e+00, 2.2713e+00,
         2.1074e+00, 0.0000e+00, 2.3361e+00, 2.2551e+00],
        [3.8416e+05, 3.9271e+05, 2.1967e+00, 3.9046e+05, 2.3783e+00, 3.9361e+05,
         2.2985e+00, 3.9506e+05, 4.0300e+05, 2.3488e+00, 2.1518e+00, 2.3794e+00,
         2.4813e+00, 2.3361e+00, 0.0000e+00, 2.4000e+00],
        [3.8415e+05, 3.9269e+05, 2.1016e+00, 3.9048e+05, 2.3607e+00, 3.9362e+05,
         2.2231e+00, 3.9506e+05, 4.0300e+05, 2.3927e+00, 2.0565e+00, 2.2246e+00,
         2.1976e+00, 2.2551e+00, 2.4000e+00, 0.0000e+00]])
Krum scores: ['384132.22', '392685.19', '2.21', '390472.75', '2.25', '393625.69', '2.23', '395078.19', '402999.81', '2.32', '2.17', '2.25', '2.19', '2.24', '2.31', '2.23']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 19, 4, 15, 10, 18, 1, 17, 20, 8, 2, 12, 3, 5, 6, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0072s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:15...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[184  53]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:15, End: 2025-07-22 16:02:15)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 20, 5, 14, 15, 17, 3, 1, 4, 19, 13, 6, 8, 9, 12, 2], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9381e+05, 1.7911e+00, 3.8937e+05, 3.9235e+05, 4.0540e+05,
         1.8553e+00, 1.9081e+00, 1.7187e+00, 3.8602e+05, 3.9785e+05, 1.9672e+00,
         1.9352e+00, 1.8404e+00, 1.8719e+00, 1.8750e+00],
        [3.9381e+05, 0.0000e+00, 3.9381e+05, 8.0944e+05, 7.8616e+05, 8.0921e+05,
         3.9379e+05, 3.9378e+05, 3.9382e+05, 7.8991e+05, 8.1402e+05, 3.9381e+05,
         3.9383e+05, 3.9378e+05, 3.9381e+05, 3.9380e+05],
        [1.7911e+00, 3.9381e+05, 0.0000e+00, 3.8938e+05, 3.9234e+05, 4.0542e+05,
         1.7398e+00, 1.9011e+00, 1.8329e+00, 3.8600e+05, 3.9791e+05, 1.9841e+00,
         2.0189e+00, 1.9490e+00, 1.8861e+00, 2.0073e+00],
        [3.8937e+05, 8.0944e+05, 3.8938e+05, 0.0000e+00, 7.9426e+05, 7.9557e+05,
         3.8937e+05, 3.8935e+05, 3.8937e+05, 7.8664e+05, 7.8032e+05, 3.8938e+05,
         3.8935e+05, 3.8936e+05, 3.8936e+05, 3.8940e+05],
        [3.9235e+05, 7.8616e+05, 3.9234e+05, 7.9426e+05, 0.0000e+00, 7.8575e+05,
         3.9239e+05, 3.9234e+05, 3.9236e+05, 7.6168e+05, 7.9472e+05, 3.9235e+05,
         3.9233e+05, 3.9237e+05, 3.9241e+05, 3.9235e+05],
        [4.0540e+05, 8.0921e+05, 4.0542e+05, 7.9557e+05, 7.8575e+05, 0.0000e+00,
         4.0542e+05, 4.0542e+05, 4.0538e+05, 7.9234e+05, 8.0392e+05, 4.0543e+05,
         4.0539e+05, 4.0542e+05, 4.0542e+05, 4.0538e+05],
        [1.8553e+00, 3.9379e+05, 1.7398e+00, 3.8937e+05, 3.9239e+05, 4.0542e+05,
         0.0000e+00, 1.9978e+00, 1.8407e+00, 3.8600e+05, 3.9788e+05, 2.0184e+00,
         1.8701e+00, 1.7399e+00, 1.7013e+00, 1.9165e+00],
        [1.9081e+00, 3.9378e+05, 1.9011e+00, 3.8935e+05, 3.9234e+05, 4.0542e+05,
         1.9978e+00, 0.0000e+00, 1.8314e+00, 3.8603e+05, 3.9787e+05, 1.9303e+00,
         1.9772e+00, 1.7780e+00, 1.9127e+00, 1.9262e+00],
        [1.7187e+00, 3.9382e+05, 1.8329e+00, 3.8937e+05, 3.9236e+05, 4.0538e+05,
         1.8407e+00, 1.8314e+00, 0.0000e+00, 3.8606e+05, 3.9785e+05, 1.7998e+00,
         1.7758e+00, 1.8774e+00, 1.7810e+00, 1.9782e+00],
        [3.8602e+05, 7.8991e+05, 3.8600e+05, 7.8664e+05, 7.6168e+05, 7.9234e+05,
         3.8600e+05, 3.8603e+05, 3.8606e+05, 0.0000e+00, 7.9857e+05, 3.8600e+05,
         3.8605e+05, 3.8607e+05, 3.8602e+05, 3.8604e+05],
        [3.9785e+05, 8.1402e+05, 3.9791e+05, 7.8032e+05, 7.9472e+05, 8.0392e+05,
         3.9788e+05, 3.9787e+05, 3.9785e+05, 7.9857e+05, 0.0000e+00, 3.9786e+05,
         3.9787e+05, 3.9784e+05, 3.9789e+05, 3.9786e+05],
        [1.9672e+00, 3.9381e+05, 1.9841e+00, 3.8938e+05, 3.9235e+05, 4.0543e+05,
         2.0184e+00, 1.9303e+00, 1.7998e+00, 3.8600e+05, 3.9786e+05, 0.0000e+00,
         1.9356e+00, 1.9246e+00, 1.9803e+00, 2.0291e+00],
        [1.9352e+00, 3.9383e+05, 2.0189e+00, 3.8935e+05, 3.9233e+05, 4.0539e+05,
         1.8701e+00, 1.9772e+00, 1.7758e+00, 3.8605e+05, 3.9787e+05, 1.9356e+00,
         0.0000e+00, 1.8669e+00, 1.8971e+00, 2.1031e+00],
        [1.8404e+00, 3.9378e+05, 1.9490e+00, 3.8936e+05, 3.9237e+05, 4.0542e+05,
         1.7399e+00, 1.7780e+00, 1.8774e+00, 3.8607e+05, 3.9784e+05, 1.9246e+00,
         1.8669e+00, 0.0000e+00, 1.8422e+00, 1.8460e+00],
        [1.8719e+00, 3.9381e+05, 1.8861e+00, 3.8936e+05, 3.9241e+05, 4.0542e+05,
         1.7013e+00, 1.9127e+00, 1.7810e+00, 3.8602e+05, 3.9789e+05, 1.9803e+00,
         1.8971e+00, 1.8422e+00, 0.0000e+00, 2.0089e+00],
        [1.8750e+00, 3.9380e+05, 2.0073e+00, 3.8940e+05, 3.9235e+05, 4.0538e+05,
         1.9165e+00, 1.9262e+00, 1.9782e+00, 3.8604e+05, 3.9786e+05, 2.0291e+00,
         2.1031e+00, 1.8460e+00, 2.0089e+00, 0.0000e+00]])
Krum scores: ['1.85', '393797.56', '1.89', '389365.09', '392348.22', '405403.28', '1.83', '1.90', '1.81', '386020.62', '397860.62', '1.94', '1.91', '1.84', '1.86', '1.95']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 20, 5, 14, 15, 17, 3, 1, 4, 19, 13, 6, 8, 9, 12, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0106s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:16...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:16, End: 2025-07-22 16:02:16)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 8, 10, 5, 7, 17, 4, 18, 12, 6, 19, 20, 3, 2, 16, 14], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 2.0157e+00, 1.9701e+00, 2.0188e+00, 1.8800e+00, 3.8349e+05,
         1.9489e+00, 3.8478e+05, 2.0087e+00, 1.9490e+00, 3.8286e+05, 4.1335e+05,
         2.0628e+00, 1.8728e+00, 3.8568e+05, 3.9604e+05],
        [2.0157e+00, 0.0000e+00, 1.9593e+00, 2.1889e+00, 2.0174e+00, 3.8349e+05,
         2.0476e+00, 3.8484e+05, 1.9829e+00, 1.9471e+00, 3.8286e+05, 4.1332e+05,
         1.9343e+00, 2.0783e+00, 3.8565e+05, 3.9605e+05],
        [1.9701e+00, 1.9593e+00, 0.0000e+00, 1.9636e+00, 2.0132e+00, 3.8348e+05,
         2.0207e+00, 3.8481e+05, 1.9241e+00, 2.0860e+00, 3.8286e+05, 4.1331e+05,
         1.8614e+00, 1.7593e+00, 3.8565e+05, 3.9605e+05],
        [2.0188e+00, 2.1889e+00, 1.9636e+00, 0.0000e+00, 1.8632e+00, 3.8352e+05,
         1.9773e+00, 3.8478e+05, 1.9733e+00, 2.1098e+00, 3.8285e+05, 4.1334e+05,
         1.8969e+00, 2.0187e+00, 3.8566e+05, 3.9602e+05],
        [1.8800e+00, 2.0174e+00, 2.0132e+00, 1.8632e+00, 0.0000e+00, 3.8351e+05,
         1.8602e+00, 3.8480e+05, 1.8865e+00, 1.9990e+00, 3.8286e+05, 4.1336e+05,
         1.9233e+00, 1.8089e+00, 3.8567e+05, 3.9604e+05],
        [3.8349e+05, 3.8349e+05, 3.8348e+05, 3.8352e+05, 3.8351e+05, 0.0000e+00,
         3.8351e+05, 7.7236e+05, 3.8350e+05, 3.8351e+05, 7.6154e+05, 7.9143e+05,
         3.8350e+05, 3.8352e+05, 7.5050e+05, 7.8090e+05],
        [1.9489e+00, 2.0476e+00, 2.0207e+00, 1.9773e+00, 1.8602e+00, 3.8351e+05,
         0.0000e+00, 3.8479e+05, 1.8839e+00, 1.9923e+00, 3.8284e+05, 4.1335e+05,
         1.9740e+00, 1.8633e+00, 3.8563e+05, 3.9600e+05],
        [3.8478e+05, 3.8484e+05, 3.8481e+05, 3.8478e+05, 3.8480e+05, 7.7236e+05,
         3.8479e+05, 0.0000e+00, 3.8481e+05, 3.8480e+05, 7.7584e+05, 8.0879e+05,
         3.8480e+05, 3.8481e+05, 7.7222e+05, 7.7295e+05],
        [2.0087e+00, 1.9829e+00, 1.9241e+00, 1.9733e+00, 1.8865e+00, 3.8350e+05,
         1.8839e+00, 3.8481e+05, 0.0000e+00, 1.9942e+00, 3.8286e+05, 4.1333e+05,
         1.7568e+00, 1.9508e+00, 3.8567e+05, 3.9602e+05],
        [1.9490e+00, 1.9471e+00, 2.0860e+00, 2.1098e+00, 1.9990e+00, 3.8351e+05,
         1.9923e+00, 3.8480e+05, 1.9942e+00, 0.0000e+00, 3.8284e+05, 4.1334e+05,
         2.1045e+00, 1.8978e+00, 3.8568e+05, 3.9604e+05],
        [3.8286e+05, 3.8286e+05, 3.8286e+05, 3.8285e+05, 3.8286e+05, 7.6154e+05,
         3.8284e+05, 7.7584e+05, 3.8286e+05, 3.8284e+05, 0.0000e+00, 8.2164e+05,
         3.8288e+05, 3.8283e+05, 7.6720e+05, 7.7773e+05],
        [4.1335e+05, 4.1332e+05, 4.1331e+05, 4.1334e+05, 4.1336e+05, 7.9143e+05,
         4.1335e+05, 8.0879e+05, 4.1333e+05, 4.1334e+05, 8.2164e+05, 0.0000e+00,
         4.1331e+05, 4.1335e+05, 8.0707e+05, 8.0020e+05],
        [2.0628e+00, 1.9343e+00, 1.8614e+00, 1.8969e+00, 1.9233e+00, 3.8350e+05,
         1.9740e+00, 3.8480e+05, 1.7568e+00, 2.1045e+00, 3.8288e+05, 4.1331e+05,
         0.0000e+00, 1.8823e+00, 3.8568e+05, 3.9605e+05],
        [1.8728e+00, 2.0783e+00, 1.7593e+00, 2.0187e+00, 1.8089e+00, 3.8352e+05,
         1.8633e+00, 3.8481e+05, 1.9508e+00, 1.8978e+00, 3.8283e+05, 4.1335e+05,
         1.8823e+00, 0.0000e+00, 3.8568e+05, 3.9603e+05],
        [3.8568e+05, 3.8565e+05, 3.8565e+05, 3.8566e+05, 3.8567e+05, 7.5050e+05,
         3.8563e+05, 7.7222e+05, 3.8567e+05, 3.8568e+05, 7.6720e+05, 8.0707e+05,
         3.8568e+05, 3.8568e+05, 0.0000e+00, 7.9342e+05],
        [3.9604e+05, 3.9605e+05, 3.9605e+05, 3.9602e+05, 3.9604e+05, 7.8090e+05,
         3.9600e+05, 7.7295e+05, 3.9602e+05, 3.9604e+05, 7.7773e+05, 8.0020e+05,
         3.9605e+05, 3.9603e+05, 7.9342e+05, 0.0000e+00]])
Krum scores: ['1.96', '2.00', '1.93', '1.98', '1.90', '383497.84', '1.94', '384795.03', '1.92', '2.00', '382849.78', '413331.12', '1.91', '1.88', '385661.06', '396030.28']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 8, 10, 5, 7, 17, 4, 18, 12, 6, 19, 20, 3, 2, 16, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0182s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:16...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:16, End: 2025-07-22 16:02:16)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 10, 16, 13, 8, 2, 11, 20, 9, 19, 12, 1, 3, 18, 15, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.7216e+00, 3.9226e+05, 3.7784e+05, 1.6211e+00, 1.9818e+00,
         1.5446e+00, 3.9280e+05, 1.5895e+00, 4.0005e+05, 1.6309e+00, 1.6444e+00,
         1.7347e+00, 3.9037e+05, 3.9727e+05, 3.9168e+05],
        [1.7216e+00, 0.0000e+00, 3.9224e+05, 3.7786e+05, 1.6234e+00, 1.7760e+00,
         1.6474e+00, 3.9276e+05, 1.5190e+00, 4.0001e+05, 1.5723e+00, 1.6468e+00,
         1.5859e+00, 3.9036e+05, 3.9723e+05, 3.9169e+05],
        [3.9226e+05, 3.9224e+05, 0.0000e+00, 7.8217e+05, 3.9227e+05, 3.9226e+05,
         3.9228e+05, 7.9615e+05, 3.9225e+05, 7.7645e+05, 3.9230e+05, 3.9227e+05,
         3.9225e+05, 7.8307e+05, 7.6931e+05, 7.9389e+05],
        [3.7784e+05, 3.7786e+05, 7.8217e+05, 0.0000e+00, 3.7782e+05, 3.7787e+05,
         3.7787e+05, 8.0148e+05, 3.7783e+05, 7.6886e+05, 3.7786e+05, 3.7782e+05,
         3.7787e+05, 7.8379e+05, 7.8003e+05, 7.6710e+05],
        [1.6211e+00, 1.6234e+00, 3.9227e+05, 3.7782e+05, 0.0000e+00, 2.0287e+00,
         1.5586e+00, 3.9278e+05, 1.5717e+00, 4.0003e+05, 1.6112e+00, 1.6791e+00,
         1.6041e+00, 3.9039e+05, 3.9730e+05, 3.9166e+05],
        [1.9818e+00, 1.7760e+00, 3.9226e+05, 3.7787e+05, 2.0287e+00, 0.0000e+00,
         2.0613e+00, 3.9281e+05, 1.7817e+00, 4.0004e+05, 1.9591e+00, 1.8928e+00,
         1.9511e+00, 3.9033e+05, 3.9730e+05, 3.9169e+05],
        [1.5446e+00, 1.6474e+00, 3.9228e+05, 3.7787e+05, 1.5586e+00, 2.0613e+00,
         0.0000e+00, 3.9278e+05, 1.4904e+00, 4.0003e+05, 1.5314e+00, 1.5635e+00,
         1.5497e+00, 3.9036e+05, 3.9725e+05, 3.9167e+05],
        [3.9280e+05, 3.9276e+05, 7.9615e+05, 8.0148e+05, 3.9278e+05, 3.9281e+05,
         3.9278e+05, 0.0000e+00, 3.9277e+05, 7.9843e+05, 3.9277e+05, 3.9277e+05,
         3.9281e+05, 7.8789e+05, 7.5616e+05, 8.0532e+05],
        [1.5895e+00, 1.5190e+00, 3.9225e+05, 3.7783e+05, 1.5717e+00, 1.7817e+00,
         1.4904e+00, 3.9277e+05, 0.0000e+00, 4.0002e+05, 1.4872e+00, 1.5207e+00,
         1.5304e+00, 3.9037e+05, 3.9728e+05, 3.9171e+05],
        [4.0005e+05, 4.0001e+05, 7.7645e+05, 7.6886e+05, 4.0003e+05, 4.0004e+05,
         4.0003e+05, 7.9843e+05, 4.0002e+05, 0.0000e+00, 4.0001e+05, 4.0002e+05,
         4.0002e+05, 7.9048e+05, 8.0683e+05, 7.7618e+05],
        [1.6309e+00, 1.5723e+00, 3.9230e+05, 3.7786e+05, 1.6112e+00, 1.9591e+00,
         1.5314e+00, 3.9277e+05, 1.4872e+00, 4.0001e+05, 0.0000e+00, 1.6457e+00,
         1.4398e+00, 3.9035e+05, 3.9727e+05, 3.9166e+05],
        [1.6444e+00, 1.6468e+00, 3.9227e+05, 3.7782e+05, 1.6791e+00, 1.8928e+00,
         1.5635e+00, 3.9277e+05, 1.5207e+00, 4.0002e+05, 1.6457e+00, 0.0000e+00,
         1.7526e+00, 3.9037e+05, 3.9723e+05, 3.9167e+05],
        [1.7347e+00, 1.5859e+00, 3.9225e+05, 3.7787e+05, 1.6041e+00, 1.9511e+00,
         1.5497e+00, 3.9281e+05, 1.5304e+00, 4.0002e+05, 1.4398e+00, 1.7526e+00,
         0.0000e+00, 3.9035e+05, 3.9727e+05, 3.9167e+05],
        [3.9037e+05, 3.9036e+05, 7.8307e+05, 7.8379e+05, 3.9039e+05, 3.9033e+05,
         3.9036e+05, 7.8789e+05, 3.9037e+05, 7.9048e+05, 3.9035e+05, 3.9037e+05,
         3.9035e+05, 0.0000e+00, 8.1344e+05, 7.9831e+05],
        [3.9727e+05, 3.9723e+05, 7.6931e+05, 7.8003e+05, 3.9730e+05, 3.9730e+05,
         3.9725e+05, 7.5616e+05, 3.9728e+05, 8.0683e+05, 3.9727e+05, 3.9723e+05,
         3.9727e+05, 8.1344e+05, 0.0000e+00, 7.9999e+05],
        [3.9168e+05, 3.9169e+05, 7.9389e+05, 7.6710e+05, 3.9166e+05, 3.9169e+05,
         3.9167e+05, 8.0532e+05, 3.9171e+05, 7.7618e+05, 3.9166e+05, 3.9167e+05,
         3.9167e+05, 7.9831e+05, 7.9999e+05, 0.0000e+00]])
Krum scores: ['1.64', '1.62', '392257.44', '377843.44', '1.61', '1.91', '1.56', '392777.28', '1.53', '400019.34', '1.56', '1.64', '1.60', '390355.44', '397257.06', '391672.00']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 10, 16, 13, 8, 2, 11, 20, 9, 19, 12, 1, 3, 18, 15, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0055s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:17...
global Accuracy on shared test data: 78.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:17, End: 2025-07-22 16:02:17)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 10, 11, 13, 8, 12, 1, 19, 6, 2, 18, 14, 15, 17, 20, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.7514e+00, 1.7024e+00, 3.8864e+05, 1.6575e+00, 1.5520e+00,
         1.7312e+00, 3.9615e+05, 1.6435e+00, 1.7384e+00, 3.9848e+05, 3.7504e+05,
         3.8649e+05, 3.9962e+05, 3.9390e+05, 1.6474e+00],
        [1.7514e+00, 0.0000e+00, 1.7314e+00, 3.8861e+05, 1.7389e+00, 1.6050e+00,
         1.7507e+00, 3.9615e+05, 1.7971e+00, 1.7533e+00, 3.9853e+05, 3.7506e+05,
         3.8650e+05, 3.9967e+05, 3.9393e+05, 1.6269e+00],
        [1.7024e+00, 1.7314e+00, 0.0000e+00, 3.8862e+05, 1.6884e+00, 1.5965e+00,
         1.5912e+00, 3.9612e+05, 1.5484e+00, 2.0225e+00, 3.9854e+05, 3.7503e+05,
         3.8649e+05, 3.9963e+05, 3.9390e+05, 1.6443e+00],
        [3.8864e+05, 3.8861e+05, 3.8862e+05, 0.0000e+00, 3.8861e+05, 3.8862e+05,
         3.8860e+05, 7.8280e+05, 3.8863e+05, 3.8860e+05, 7.8980e+05, 7.6811e+05,
         7.8103e+05, 7.7991e+05, 7.7051e+05, 3.8863e+05],
        [1.6575e+00, 1.7389e+00, 1.6884e+00, 3.8861e+05, 0.0000e+00, 1.6463e+00,
         1.8080e+00, 3.9614e+05, 1.6251e+00, 2.0362e+00, 3.9851e+05, 3.7505e+05,
         3.8650e+05, 3.9965e+05, 3.9390e+05, 1.6693e+00],
        [1.5520e+00, 1.6050e+00, 1.5965e+00, 3.8862e+05, 1.6463e+00, 0.0000e+00,
         1.6862e+00, 3.9615e+05, 1.6330e+00, 1.8663e+00, 3.9851e+05, 3.7502e+05,
         3.8650e+05, 3.9965e+05, 3.9389e+05, 1.4907e+00],
        [1.7312e+00, 1.7507e+00, 1.5912e+00, 3.8860e+05, 1.8080e+00, 1.6862e+00,
         0.0000e+00, 3.9611e+05, 1.6967e+00, 1.8512e+00, 3.9851e+05, 3.7502e+05,
         3.8648e+05, 3.9967e+05, 3.9389e+05, 1.7552e+00],
        [3.9615e+05, 3.9615e+05, 3.9612e+05, 7.8280e+05, 3.9614e+05, 3.9615e+05,
         3.9611e+05, 0.0000e+00, 3.9616e+05, 3.9616e+05, 8.0221e+05, 7.6039e+05,
         7.8636e+05, 8.2080e+05, 8.0617e+05, 3.9612e+05],
        [1.6435e+00, 1.7971e+00, 1.5484e+00, 3.8863e+05, 1.6251e+00, 1.6330e+00,
         1.6967e+00, 3.9616e+05, 0.0000e+00, 1.8940e+00, 3.9849e+05, 3.7501e+05,
         3.8649e+05, 3.9968e+05, 3.9392e+05, 1.7361e+00],
        [1.7384e+00, 1.7533e+00, 2.0225e+00, 3.8860e+05, 2.0362e+00, 1.8663e+00,
         1.8512e+00, 3.9616e+05, 1.8940e+00, 0.0000e+00, 3.9851e+05, 3.7507e+05,
         3.8647e+05, 3.9965e+05, 3.9390e+05, 1.8637e+00],
        [3.9848e+05, 3.9853e+05, 3.9854e+05, 7.8980e+05, 3.9851e+05, 3.9851e+05,
         3.9851e+05, 8.0221e+05, 3.9849e+05, 3.9851e+05, 0.0000e+00, 7.7537e+05,
         7.9814e+05, 8.1004e+05, 7.9315e+05, 3.9852e+05],
        [3.7504e+05, 3.7506e+05, 3.7503e+05, 7.6811e+05, 3.7505e+05, 3.7502e+05,
         3.7502e+05, 7.6039e+05, 3.7501e+05, 3.7507e+05, 7.7537e+05, 0.0000e+00,
         7.7349e+05, 7.7802e+05, 7.7568e+05, 3.7506e+05],
        [3.8649e+05, 3.8650e+05, 3.8649e+05, 7.8103e+05, 3.8650e+05, 3.8650e+05,
         3.8648e+05, 7.8636e+05, 3.8649e+05, 3.8647e+05, 7.9814e+05, 7.7349e+05,
         0.0000e+00, 7.7131e+05, 7.7396e+05, 3.8650e+05],
        [3.9962e+05, 3.9967e+05, 3.9963e+05, 7.7991e+05, 3.9965e+05, 3.9965e+05,
         3.9967e+05, 8.2080e+05, 3.9968e+05, 3.9965e+05, 8.1004e+05, 7.7802e+05,
         7.7131e+05, 0.0000e+00, 7.8742e+05, 3.9964e+05],
        [3.9390e+05, 3.9393e+05, 3.9390e+05, 7.7051e+05, 3.9390e+05, 3.9389e+05,
         3.9389e+05, 8.0617e+05, 3.9392e+05, 3.9390e+05, 7.9315e+05, 7.7568e+05,
         7.7396e+05, 7.8742e+05, 0.0000e+00, 3.9391e+05],
        [1.6474e+00, 1.6269e+00, 1.6443e+00, 3.8863e+05, 1.6693e+00, 1.4907e+00,
         1.7552e+00, 3.9612e+05, 1.7361e+00, 1.8637e+00, 3.9852e+05, 3.7506e+05,
         3.8650e+05, 3.9964e+05, 3.9391e+05, 0.0000e+00]])
Krum scores: ['1.67', '1.71', '1.64', '388613.59', '1.69', '1.60', '1.72', '396133.94', '1.67', '1.86', '398504.91', '375033.22', '386488.94', '399644.00', '393898.59', '1.65']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 10, 11, 13, 8, 12, 1, 19, 6, 2, 18, 14, 15, 17, 20, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:17...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:17, End: 2025-07-22 16:02:17)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 14, 2, 9, 16, 15, 18, 12, 10, 8, 11, 4, 13, 3, 7, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9760e+05, 1.7872e+00, 1.6790e+00, 3.9905e+05, 4.0109e+05,
         4.0332e+05, 1.8005e+00, 1.7776e+00, 1.8272e+00, 1.6653e+00, 1.6998e+00,
         3.9655e+05, 1.8750e+00, 1.7372e+00, 1.6995e+00],
        [3.9760e+05, 0.0000e+00, 3.9756e+05, 3.9760e+05, 7.7214e+05, 8.1396e+05,
         8.0456e+05, 3.9758e+05, 3.9761e+05, 3.9758e+05, 3.9757e+05, 3.9760e+05,
         7.8776e+05, 3.9758e+05, 3.9759e+05, 3.9762e+05],
        [1.7872e+00, 3.9756e+05, 0.0000e+00, 1.5272e+00, 3.9906e+05, 4.0109e+05,
         4.0332e+05, 1.6916e+00, 1.6625e+00, 1.9755e+00, 1.9353e+00, 1.6596e+00,
         3.9653e+05, 1.8274e+00, 1.8241e+00, 1.8368e+00],
        [1.6790e+00, 3.9760e+05, 1.5272e+00, 0.0000e+00, 3.9902e+05, 4.0115e+05,
         4.0331e+05, 1.5656e+00, 1.5030e+00, 1.7889e+00, 1.7269e+00, 1.6808e+00,
         3.9652e+05, 1.7124e+00, 1.7746e+00, 1.7758e+00],
        [3.9905e+05, 7.7214e+05, 3.9906e+05, 3.9902e+05, 0.0000e+00, 8.0621e+05,
         8.1082e+05, 3.9904e+05, 3.9903e+05, 3.9904e+05, 3.9905e+05, 3.9906e+05,
         8.1068e+05, 3.9906e+05, 3.9905e+05, 3.9905e+05],
        [4.0109e+05, 8.1396e+05, 4.0109e+05, 4.0115e+05, 8.0621e+05, 0.0000e+00,
         7.8469e+05, 4.0109e+05, 4.0106e+05, 4.0108e+05, 4.0108e+05, 4.0107e+05,
         7.8092e+05, 4.0105e+05, 4.0109e+05, 4.0111e+05],
        [4.0332e+05, 8.0456e+05, 4.0332e+05, 4.0331e+05, 8.1082e+05, 7.8469e+05,
         0.0000e+00, 4.0332e+05, 4.0332e+05, 4.0333e+05, 4.0333e+05, 4.0332e+05,
         8.0082e+05, 4.0334e+05, 4.0331e+05, 4.0329e+05],
        [1.8005e+00, 3.9758e+05, 1.6916e+00, 1.5656e+00, 3.9904e+05, 4.0109e+05,
         4.0332e+05, 0.0000e+00, 1.6009e+00, 1.8365e+00, 1.8609e+00, 1.6569e+00,
         3.9654e+05, 1.6822e+00, 1.8744e+00, 1.8674e+00],
        [1.7776e+00, 3.9761e+05, 1.6625e+00, 1.5030e+00, 3.9903e+05, 4.0106e+05,
         4.0332e+05, 1.6009e+00, 0.0000e+00, 1.7679e+00, 1.7021e+00, 1.7515e+00,
         3.9653e+05, 1.7538e+00, 1.8166e+00, 1.8523e+00],
        [1.8272e+00, 3.9758e+05, 1.9755e+00, 1.7889e+00, 3.9904e+05, 4.0108e+05,
         4.0333e+05, 1.8365e+00, 1.7679e+00, 0.0000e+00, 1.7995e+00, 1.7397e+00,
         3.9652e+05, 1.7818e+00, 1.8463e+00, 1.7078e+00],
        [1.6653e+00, 3.9757e+05, 1.9353e+00, 1.7269e+00, 3.9905e+05, 4.0108e+05,
         4.0333e+05, 1.8609e+00, 1.7021e+00, 1.7995e+00, 0.0000e+00, 1.7753e+00,
         3.9653e+05, 1.7779e+00, 1.6615e+00, 1.6821e+00],
        [1.6998e+00, 3.9760e+05, 1.6596e+00, 1.6808e+00, 3.9906e+05, 4.0107e+05,
         4.0332e+05, 1.6569e+00, 1.7515e+00, 1.7397e+00, 1.7753e+00, 0.0000e+00,
         3.9653e+05, 1.7347e+00, 1.6368e+00, 1.7182e+00],
        [3.9655e+05, 7.8776e+05, 3.9653e+05, 3.9652e+05, 8.1068e+05, 7.8092e+05,
         8.0082e+05, 3.9654e+05, 3.9653e+05, 3.9652e+05, 3.9653e+05, 3.9653e+05,
         0.0000e+00, 3.9652e+05, 3.9651e+05, 3.9656e+05],
        [1.8750e+00, 3.9758e+05, 1.8274e+00, 1.7124e+00, 3.9906e+05, 4.0105e+05,
         4.0334e+05, 1.6822e+00, 1.7538e+00, 1.7818e+00, 1.7779e+00, 1.7347e+00,
         3.9652e+05, 0.0000e+00, 1.7152e+00, 1.8188e+00],
        [1.7372e+00, 3.9759e+05, 1.8241e+00, 1.7746e+00, 3.9905e+05, 4.0109e+05,
         4.0331e+05, 1.8744e+00, 1.8166e+00, 1.8463e+00, 1.6615e+00, 1.6368e+00,
         3.9651e+05, 1.7152e+00, 0.0000e+00, 1.7576e+00],
        [1.6995e+00, 3.9762e+05, 1.8368e+00, 1.7758e+00, 3.9905e+05, 4.0111e+05,
         4.0329e+05, 1.8674e+00, 1.8523e+00, 1.7078e+00, 1.6821e+00, 1.7182e+00,
         3.9656e+05, 1.8188e+00, 1.7576e+00, 0.0000e+00]])
Krum scores: ['1.74', '397585.62', '1.75', '1.66', '399043.09', '401078.56', '403315.84', '1.73', '1.70', '1.79', '1.74', '1.70', '396525.22', '1.76', '1.75', '1.76']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 14, 2, 9, 16, 15, 18, 12, 10, 8, 11, 4, 13, 3, 7, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0203s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:18...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:18, End: 2025-07-22 16:02:18)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 13, 12, 6, 9, 11, 15, 10, 17, 16, 7, 14, 2, 20, 19, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9203e+05, 1.5020e+00, 1.4736e+00, 1.8454e+00, 1.3959e+00,
         3.8671e+05, 1.5611e+00, 3.8723e+05, 4.0443e+05, 1.5402e+00, 3.8511e+05,
         1.6044e+00, 3.7285e+05, 3.9293e+05, 1.5231e+00],
        [3.9203e+05, 0.0000e+00, 3.9204e+05, 3.9204e+05, 3.9203e+05, 3.9206e+05,
         7.8028e+05, 3.9203e+05, 7.8182e+05, 7.6861e+05, 3.9202e+05, 7.7569e+05,
         3.9202e+05, 7.3636e+05, 7.8782e+05, 3.9204e+05],
        [1.5020e+00, 3.9204e+05, 0.0000e+00, 1.5291e+00, 1.5408e+00, 1.5165e+00,
         3.8670e+05, 1.3378e+00, 3.8726e+05, 4.0450e+05, 1.5732e+00, 3.8508e+05,
         1.4128e+00, 3.7284e+05, 3.9292e+05, 1.3667e+00],
        [1.4736e+00, 3.9204e+05, 1.5291e+00, 0.0000e+00, 1.9924e+00, 1.3518e+00,
         3.8671e+05, 1.5660e+00, 3.8722e+05, 4.0445e+05, 1.5113e+00, 3.8509e+05,
         1.5941e+00, 3.7287e+05, 3.9294e+05, 1.5130e+00],
        [1.8454e+00, 3.9203e+05, 1.5408e+00, 1.9924e+00, 0.0000e+00, 1.9685e+00,
         3.8670e+05, 1.6408e+00, 3.8725e+05, 4.0448e+05, 2.0610e+00, 3.8508e+05,
         1.4865e+00, 3.7284e+05, 3.9294e+05, 1.8722e+00],
        [1.3959e+00, 3.9206e+05, 1.5165e+00, 1.3518e+00, 1.9685e+00, 0.0000e+00,
         3.8673e+05, 1.4648e+00, 3.8723e+05, 4.0444e+05, 1.4324e+00, 3.8508e+05,
         1.7146e+00, 3.7285e+05, 3.9293e+05, 1.4838e+00],
        [3.8671e+05, 7.8028e+05, 3.8670e+05, 3.8671e+05, 3.8670e+05, 3.8673e+05,
         0.0000e+00, 3.8673e+05, 7.7116e+05, 7.9850e+05, 3.8668e+05, 7.5787e+05,
         3.8670e+05, 7.6930e+05, 7.8484e+05, 3.8673e+05],
        [1.5611e+00, 3.9203e+05, 1.3378e+00, 1.5660e+00, 1.6408e+00, 1.4648e+00,
         3.8673e+05, 0.0000e+00, 3.8723e+05, 4.0445e+05, 1.6072e+00, 3.8505e+05,
         1.4988e+00, 3.7284e+05, 3.9292e+05, 1.4265e+00],
        [3.8723e+05, 7.8182e+05, 3.8726e+05, 3.8722e+05, 3.8725e+05, 3.8723e+05,
         7.7116e+05, 3.8723e+05, 0.0000e+00, 7.7168e+05, 3.8719e+05, 7.6006e+05,
         3.8721e+05, 7.5324e+05, 7.7146e+05, 3.8723e+05],
        [4.0443e+05, 7.6861e+05, 4.0450e+05, 4.0445e+05, 4.0448e+05, 4.0444e+05,
         7.9850e+05, 4.0445e+05, 7.7168e+05, 0.0000e+00, 4.0447e+05, 7.7938e+05,
         4.0445e+05, 7.6543e+05, 8.1345e+05, 4.0447e+05],
        [1.5402e+00, 3.9202e+05, 1.5732e+00, 1.5113e+00, 2.0610e+00, 1.4324e+00,
         3.8668e+05, 1.6072e+00, 3.8719e+05, 4.0447e+05, 0.0000e+00, 3.8508e+05,
         1.6312e+00, 3.7284e+05, 3.9292e+05, 1.4903e+00],
        [3.8511e+05, 7.7569e+05, 3.8508e+05, 3.8509e+05, 3.8508e+05, 3.8508e+05,
         7.5787e+05, 3.8505e+05, 7.6006e+05, 7.7938e+05, 3.8508e+05, 0.0000e+00,
         3.8507e+05, 7.5921e+05, 7.8646e+05, 3.8506e+05],
        [1.6044e+00, 3.9202e+05, 1.4128e+00, 1.5941e+00, 1.4865e+00, 1.7146e+00,
         3.8670e+05, 1.4988e+00, 3.8721e+05, 4.0445e+05, 1.6312e+00, 3.8507e+05,
         0.0000e+00, 3.7285e+05, 3.9293e+05, 1.5856e+00],
        [3.7285e+05, 7.3636e+05, 3.7284e+05, 3.7287e+05, 3.7284e+05, 3.7285e+05,
         7.6930e+05, 3.7284e+05, 7.5324e+05, 7.6543e+05, 3.7284e+05, 7.5921e+05,
         3.7285e+05, 0.0000e+00, 7.6357e+05, 3.7282e+05],
        [3.9293e+05, 7.8782e+05, 3.9292e+05, 3.9294e+05, 3.9294e+05, 3.9293e+05,
         7.8484e+05, 3.9292e+05, 7.7146e+05, 8.1345e+05, 3.9292e+05, 7.8646e+05,
         3.9293e+05, 7.6357e+05, 0.0000e+00, 3.9293e+05],
        [1.5231e+00, 3.9204e+05, 1.3667e+00, 1.5130e+00, 1.8722e+00, 1.4838e+00,
         3.8673e+05, 1.4265e+00, 3.8723e+05, 4.0447e+05, 1.4903e+00, 3.8506e+05,
         1.5856e+00, 3.7282e+05, 3.9293e+05, 0.0000e+00]])
Krum scores: ['1.51', '392031.22', '1.46', '1.51', '1.76', '1.48', '386703.69', '1.49', '387220.72', '404451.22', '1.54', '385070.22', '1.54', '372838.16', '392924.28', '1.48']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 13, 12, 6, 9, 11, 15, 10, 17, 16, 7, 14, 2, 20, 19, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0278s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:19...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[185  52]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:19, End: 2025-07-22 16:02:19)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 20, 14, 12, 11, 1, 17, 3, 7, 18, 9, 10, 4, 15, 8, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7791e+05, 4.0853e+05, 1.4438e+00, 1.6205e+00, 1.5037e+00,
         4.0641e+05, 1.5620e+00, 1.5501e+00, 3.9139e+05, 1.2776e+00, 1.4077e+00,
         1.4050e+00, 4.0002e+05, 1.6938e+00, 3.7468e+05],
        [3.7791e+05, 0.0000e+00, 7.8756e+05, 3.7790e+05, 3.7786e+05, 3.7790e+05,
         7.8371e+05, 3.7790e+05, 3.7787e+05, 7.7640e+05, 3.7789e+05, 3.7790e+05,
         3.7791e+05, 7.7737e+05, 3.7788e+05, 7.6497e+05],
        [4.0853e+05, 7.8756e+05, 0.0000e+00, 4.0855e+05, 4.0857e+05, 4.0854e+05,
         8.2418e+05, 4.0852e+05, 4.0851e+05, 8.0619e+05, 4.0857e+05, 4.0855e+05,
         4.0855e+05, 8.1716e+05, 4.0858e+05, 7.8390e+05],
        [1.4438e+00, 3.7790e+05, 4.0855e+05, 0.0000e+00, 1.8595e+00, 1.7026e+00,
         4.0645e+05, 1.7185e+00, 1.9033e+00, 3.9138e+05, 1.2511e+00, 1.4873e+00,
         1.5758e+00, 3.9998e+05, 1.8849e+00, 3.7468e+05],
        [1.6205e+00, 3.7786e+05, 4.0857e+05, 1.8595e+00, 0.0000e+00, 1.3761e+00,
         4.0640e+05, 1.4961e+00, 1.3617e+00, 3.9141e+05, 1.7152e+00, 1.3977e+00,
         1.4660e+00, 4.0002e+05, 1.4855e+00, 3.7466e+05],
        [1.5037e+00, 3.7790e+05, 4.0854e+05, 1.7026e+00, 1.3761e+00, 0.0000e+00,
         4.0643e+05, 1.5637e+00, 1.4948e+00, 3.9139e+05, 1.6140e+00, 1.4545e+00,
         1.4122e+00, 4.0002e+05, 1.5002e+00, 3.7471e+05],
        [4.0641e+05, 7.8371e+05, 8.2418e+05, 4.0645e+05, 4.0640e+05, 4.0643e+05,
         0.0000e+00, 4.0642e+05, 4.0637e+05, 8.0166e+05, 4.0641e+05, 4.0643e+05,
         4.0643e+05, 8.0158e+05, 4.0641e+05, 7.7281e+05],
        [1.5620e+00, 3.7790e+05, 4.0852e+05, 1.7185e+00, 1.4961e+00, 1.5637e+00,
         4.0642e+05, 0.0000e+00, 1.4228e+00, 3.9141e+05, 1.6948e+00, 1.4560e+00,
         1.4331e+00, 4.0000e+05, 1.4896e+00, 3.7470e+05],
        [1.5501e+00, 3.7787e+05, 4.0851e+05, 1.9033e+00, 1.3617e+00, 1.4948e+00,
         4.0637e+05, 1.4228e+00, 0.0000e+00, 3.9141e+05, 1.7630e+00, 1.4915e+00,
         1.3964e+00, 4.0005e+05, 1.5432e+00, 3.7470e+05],
        [3.9139e+05, 7.7640e+05, 8.0619e+05, 3.9138e+05, 3.9141e+05, 3.9139e+05,
         8.0166e+05, 3.9141e+05, 3.9141e+05, 0.0000e+00, 3.9139e+05, 3.9137e+05,
         3.9139e+05, 7.9138e+05, 3.9138e+05, 7.5695e+05],
        [1.2776e+00, 3.7789e+05, 4.0857e+05, 1.2511e+00, 1.7152e+00, 1.6140e+00,
         4.0641e+05, 1.6948e+00, 1.7630e+00, 3.9139e+05, 0.0000e+00, 1.4147e+00,
         1.5850e+00, 4.0000e+05, 1.7717e+00, 3.7469e+05],
        [1.4077e+00, 3.7790e+05, 4.0855e+05, 1.4873e+00, 1.3977e+00, 1.4545e+00,
         4.0643e+05, 1.4560e+00, 1.4915e+00, 3.9137e+05, 1.4147e+00, 0.0000e+00,
         1.4379e+00, 3.9998e+05, 1.4899e+00, 3.7471e+05],
        [1.4050e+00, 3.7791e+05, 4.0855e+05, 1.5758e+00, 1.4660e+00, 1.4122e+00,
         4.0643e+05, 1.4331e+00, 1.3964e+00, 3.9139e+05, 1.5850e+00, 1.4379e+00,
         0.0000e+00, 4.0002e+05, 1.4535e+00, 3.7468e+05],
        [4.0002e+05, 7.7737e+05, 8.1716e+05, 3.9998e+05, 4.0002e+05, 4.0002e+05,
         8.0158e+05, 4.0000e+05, 4.0005e+05, 7.9138e+05, 4.0000e+05, 3.9998e+05,
         4.0002e+05, 0.0000e+00, 4.0000e+05, 7.8542e+05],
        [1.6938e+00, 3.7788e+05, 4.0858e+05, 1.8849e+00, 1.4855e+00, 1.5002e+00,
         4.0641e+05, 1.4896e+00, 1.5432e+00, 3.9138e+05, 1.7717e+00, 1.4899e+00,
         1.4535e+00, 4.0000e+05, 0.0000e+00, 3.7466e+05],
        [3.7468e+05, 7.6497e+05, 7.8390e+05, 3.7468e+05, 3.7466e+05, 3.7471e+05,
         7.7281e+05, 3.7470e+05, 3.7470e+05, 7.5695e+05, 3.7469e+05, 3.7471e+05,
         3.7468e+05, 7.8542e+05, 3.7466e+05, 0.0000e+00]])
Krum scores: ['1.47', '377885.97', '408537.88', '1.62', '1.49', '1.49', '406409.75', '1.51', '1.50', '391385.47', '1.54', '1.44', '1.45', '400000.47', '1.55', '374680.31']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 20, 14, 12, 11, 1, 17, 3, 7, 18, 9, 10, 4, 15, 8, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0134s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:19...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 55 208]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:19, End: 2025-07-22 16:02:19)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 7, 1, 19, 17, 18, 13, 10, 2, 16, 14, 6, 8, 5, 20, 9], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4782e+00, 1.4842e+00, 3.9529e+05, 3.8938e+05, 3.7167e+05,
         4.0138e+05, 1.7471e+00, 1.5610e+00, 3.9307e+05, 3.8017e+05, 1.4974e+00,
         1.4746e+00, 1.4093e+00, 4.0681e+05, 1.6226e+00],
        [1.4782e+00, 0.0000e+00, 1.4968e+00, 3.9529e+05, 3.8938e+05, 3.7165e+05,
         4.0139e+05, 1.8653e+00, 1.5782e+00, 3.9309e+05, 3.8013e+05, 1.4423e+00,
         1.4922e+00, 1.5093e+00, 4.0684e+05, 1.7739e+00],
        [1.4842e+00, 1.4968e+00, 0.0000e+00, 3.9533e+05, 3.8937e+05, 3.7164e+05,
         4.0138e+05, 1.7493e+00, 1.5314e+00, 3.9305e+05, 3.8013e+05, 1.4090e+00,
         1.4922e+00, 1.5418e+00, 4.0680e+05, 1.5506e+00],
        [3.9529e+05, 3.9529e+05, 3.9533e+05, 0.0000e+00, 7.7736e+05, 7.6529e+05,
         7.7890e+05, 3.9527e+05, 3.9528e+05, 7.6267e+05, 7.7906e+05, 3.9529e+05,
         3.9529e+05, 3.9529e+05, 8.0878e+05, 3.9529e+05],
        [3.8938e+05, 3.8938e+05, 3.8937e+05, 7.7736e+05, 0.0000e+00, 7.6996e+05,
         7.8406e+05, 3.8938e+05, 3.8935e+05, 7.8478e+05, 7.6632e+05, 3.8936e+05,
         3.8939e+05, 3.8938e+05, 7.9020e+05, 3.8937e+05],
        [3.7167e+05, 3.7165e+05, 3.7164e+05, 7.6529e+05, 7.6996e+05, 0.0000e+00,
         7.6903e+05, 3.7163e+05, 3.7165e+05, 7.7341e+05, 7.4190e+05, 3.7166e+05,
         3.7164e+05, 3.7165e+05, 7.6834e+05, 3.7165e+05],
        [4.0138e+05, 4.0139e+05, 4.0138e+05, 7.7890e+05, 7.8406e+05, 7.6903e+05,
         0.0000e+00, 4.0139e+05, 4.0137e+05, 7.8942e+05, 7.9139e+05, 4.0137e+05,
         4.0136e+05, 4.0137e+05, 8.2012e+05, 4.0137e+05],
        [1.7471e+00, 1.8653e+00, 1.7493e+00, 3.9527e+05, 3.8938e+05, 3.7163e+05,
         4.0139e+05, 0.0000e+00, 1.3898e+00, 3.9308e+05, 3.8018e+05, 1.8917e+00,
         1.8584e+00, 1.6911e+00, 4.0682e+05, 1.2998e+00],
        [1.5610e+00, 1.5782e+00, 1.5314e+00, 3.9528e+05, 3.8935e+05, 3.7165e+05,
         4.0137e+05, 1.3898e+00, 0.0000e+00, 3.9308e+05, 3.8015e+05, 1.5246e+00,
         1.6934e+00, 1.6349e+00, 4.0683e+05, 1.2715e+00],
        [3.9307e+05, 3.9309e+05, 3.9305e+05, 7.6267e+05, 7.8478e+05, 7.7341e+05,
         7.8942e+05, 3.9308e+05, 3.9308e+05, 0.0000e+00, 7.7227e+05, 3.9309e+05,
         3.9305e+05, 3.9308e+05, 8.0359e+05, 3.9306e+05],
        [3.8017e+05, 3.8013e+05, 3.8013e+05, 7.7906e+05, 7.6632e+05, 7.4190e+05,
         7.9139e+05, 3.8018e+05, 3.8015e+05, 7.7227e+05, 0.0000e+00, 3.8014e+05,
         3.8015e+05, 3.8015e+05, 7.7982e+05, 3.8015e+05],
        [1.4974e+00, 1.4423e+00, 1.4090e+00, 3.9529e+05, 3.8936e+05, 3.7166e+05,
         4.0137e+05, 1.8917e+00, 1.5246e+00, 3.9309e+05, 3.8014e+05, 0.0000e+00,
         1.3810e+00, 1.5471e+00, 4.0681e+05, 1.7063e+00],
        [1.4746e+00, 1.4922e+00, 1.4922e+00, 3.9529e+05, 3.8939e+05, 3.7164e+05,
         4.0136e+05, 1.8584e+00, 1.6934e+00, 3.9305e+05, 3.8015e+05, 1.3810e+00,
         0.0000e+00, 1.5727e+00, 4.0682e+05, 1.6792e+00],
        [1.4093e+00, 1.5093e+00, 1.5418e+00, 3.9529e+05, 3.8938e+05, 3.7165e+05,
         4.0137e+05, 1.6911e+00, 1.6349e+00, 3.9308e+05, 3.8015e+05, 1.5471e+00,
         1.5727e+00, 0.0000e+00, 4.0680e+05, 1.6844e+00],
        [4.0681e+05, 4.0684e+05, 4.0680e+05, 8.0878e+05, 7.9020e+05, 7.6834e+05,
         8.2012e+05, 4.0682e+05, 4.0683e+05, 8.0359e+05, 7.7982e+05, 4.0681e+05,
         4.0682e+05, 4.0680e+05, 0.0000e+00, 4.0684e+05],
        [1.6226e+00, 1.7739e+00, 1.5506e+00, 3.9529e+05, 3.8937e+05, 3.7165e+05,
         4.0137e+05, 1.2998e+00, 1.2715e+00, 3.9306e+05, 3.8015e+05, 1.7063e+00,
         1.6792e+00, 1.6844e+00, 4.0684e+05, 0.0000e+00]])
Krum scores: ['1.50', '1.54', '1.50', '395287.31', '389370.44', '371642.03', '401370.00', '1.66', '1.50', '393068.31', '380142.53', '1.50', '1.54', '1.56', '406812.59', '1.54']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 7, 1, 19, 17, 18, 13, 10, 2, 16, 14, 6, 8, 5, 20, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0077s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:20...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:20, End: 2025-07-22 16:02:20)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 5, 15, 2, 11, 7, 9, 10, 13, 17, 20, 4, 19, 18, 1, 14], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1789e+00, 3.8770e+05, 1.8740e+00, 1.3110e+00, 1.3021e+00,
         1.4826e+00, 1.4297e+00, 3.8803e+05, 4.0250e+05, 4.0241e+05, 1.2710e+00,
         3.9815e+05, 3.9051e+05, 1.3495e+00, 3.9045e+05],
        [1.1789e+00, 0.0000e+00, 3.8770e+05, 1.8902e+00, 1.2236e+00, 1.2666e+00,
         1.5066e+00, 1.4151e+00, 3.8807e+05, 4.0251e+05, 4.0244e+05, 1.2709e+00,
         3.9814e+05, 3.9052e+05, 1.3350e+00, 3.9046e+05],
        [3.8770e+05, 3.8770e+05, 0.0000e+00, 3.8772e+05, 3.8772e+05, 3.8769e+05,
         3.8772e+05, 3.8775e+05, 7.9582e+05, 7.9812e+05, 7.8890e+05, 3.8773e+05,
         7.8468e+05, 7.8257e+05, 3.8773e+05, 7.8472e+05],
        [1.8740e+00, 1.8902e+00, 3.8772e+05, 0.0000e+00, 2.0724e+00, 1.9097e+00,
         1.1972e+00, 1.3401e+00, 3.8802e+05, 4.0248e+05, 4.0248e+05, 1.6666e+00,
         3.9820e+05, 3.9053e+05, 1.8480e+00, 3.9046e+05],
        [1.3110e+00, 1.2236e+00, 3.8772e+05, 2.0724e+00, 0.0000e+00, 1.2431e+00,
         1.5594e+00, 1.5523e+00, 3.8804e+05, 4.0252e+05, 4.0244e+05, 1.3180e+00,
         3.9818e+05, 3.9052e+05, 1.2544e+00, 3.9042e+05],
        [1.3021e+00, 1.2666e+00, 3.8769e+05, 1.9097e+00, 1.2431e+00, 0.0000e+00,
         1.5862e+00, 1.5409e+00, 3.8806e+05, 4.0248e+05, 4.0243e+05, 1.2447e+00,
         3.9815e+05, 3.9053e+05, 1.3395e+00, 3.9047e+05],
        [1.4826e+00, 1.5066e+00, 3.8772e+05, 1.1972e+00, 1.5594e+00, 1.5862e+00,
         0.0000e+00, 1.1605e+00, 3.8801e+05, 4.0249e+05, 4.0246e+05, 1.3931e+00,
         3.9818e+05, 3.9050e+05, 1.4236e+00, 3.9046e+05],
        [1.4297e+00, 1.4151e+00, 3.8775e+05, 1.3401e+00, 1.5523e+00, 1.5409e+00,
         1.1605e+00, 0.0000e+00, 3.8803e+05, 4.0250e+05, 4.0244e+05, 1.4056e+00,
         3.9818e+05, 3.9053e+05, 1.4480e+00, 3.9042e+05],
        [3.8803e+05, 3.8807e+05, 7.9582e+05, 3.8802e+05, 3.8804e+05, 3.8806e+05,
         3.8801e+05, 3.8803e+05, 0.0000e+00, 8.0226e+05, 7.8798e+05, 3.8806e+05,
         7.7545e+05, 8.0132e+05, 3.8804e+05, 7.8160e+05],
        [4.0250e+05, 4.0251e+05, 7.9812e+05, 4.0248e+05, 4.0252e+05, 4.0248e+05,
         4.0249e+05, 4.0250e+05, 8.0226e+05, 0.0000e+00, 8.2505e+05, 4.0252e+05,
         8.1952e+05, 7.8196e+05, 4.0252e+05, 7.8889e+05],
        [4.0241e+05, 4.0244e+05, 7.8890e+05, 4.0248e+05, 4.0244e+05, 4.0243e+05,
         4.0246e+05, 4.0244e+05, 7.8798e+05, 8.2505e+05, 0.0000e+00, 4.0245e+05,
         7.7226e+05, 8.1186e+05, 4.0245e+05, 7.8680e+05],
        [1.2710e+00, 1.2709e+00, 3.8773e+05, 1.6666e+00, 1.3180e+00, 1.2447e+00,
         1.3931e+00, 1.4056e+00, 3.8806e+05, 4.0252e+05, 4.0245e+05, 0.0000e+00,
         3.9816e+05, 3.9052e+05, 1.3045e+00, 3.9046e+05],
        [3.9815e+05, 3.9814e+05, 7.8468e+05, 3.9820e+05, 3.9818e+05, 3.9815e+05,
         3.9818e+05, 3.9818e+05, 7.7545e+05, 8.1952e+05, 7.7226e+05, 3.9816e+05,
         0.0000e+00, 7.9887e+05, 3.9816e+05, 8.1154e+05],
        [3.9051e+05, 3.9052e+05, 7.8257e+05, 3.9053e+05, 3.9052e+05, 3.9053e+05,
         3.9050e+05, 3.9053e+05, 8.0132e+05, 7.8196e+05, 8.1186e+05, 3.9052e+05,
         7.9887e+05, 0.0000e+00, 3.9053e+05, 7.6957e+05],
        [1.3495e+00, 1.3350e+00, 3.8773e+05, 1.8480e+00, 1.2544e+00, 1.3395e+00,
         1.4236e+00, 1.4480e+00, 3.8804e+05, 4.0252e+05, 4.0245e+05, 1.3045e+00,
         3.9816e+05, 3.9053e+05, 0.0000e+00, 3.9044e+05],
        [3.9045e+05, 3.9046e+05, 7.8472e+05, 3.9046e+05, 3.9042e+05, 3.9047e+05,
         3.9046e+05, 3.9042e+05, 7.8160e+05, 7.8889e+05, 7.8680e+05, 3.9046e+05,
         8.1154e+05, 7.6957e+05, 3.9044e+05, 0.0000e+00]])
Krum scores: ['1.33', '1.31', '387709.91', '1.68', '1.35', '1.36', '1.39', '1.39', '388032.69', '402497.31', '402436.84', '1.32', '398162.53', '390519.28', '1.35', '390442.84']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 5, 15, 2, 11, 7, 9, 10, 13, 17, 20, 4, 19, 18, 1, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0201s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:20...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:20, End: 2025-07-22 16:02:20)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 5, 12, 15, 2, 7, 10, 11, 16, 4, 17, 8, 18, 9, 20, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6687e+00, 1.4926e+00, 3.9025e+05, 1.6867e+00, 1.4078e+00,
         1.5523e+00, 1.3802e+00, 3.9479e+05, 1.4215e+00, 4.0283e+05, 1.4242e+00,
         3.7812e+05, 1.4573e+00, 3.9483e+05, 3.9904e+05],
        [1.6687e+00, 0.0000e+00, 1.4068e+00, 3.9028e+05, 1.4907e+00, 1.6401e+00,
         1.4002e+00, 1.6411e+00, 3.9475e+05, 1.6042e+00, 4.0280e+05, 1.7570e+00,
         3.7814e+05, 1.4751e+00, 3.9484e+05, 3.9900e+05],
        [1.4926e+00, 1.4068e+00, 0.0000e+00, 3.9023e+05, 1.1859e+00, 1.6559e+00,
         1.1274e+00, 1.6037e+00, 3.9477e+05, 1.3611e+00, 4.0280e+05, 1.6214e+00,
         3.7811e+05, 1.1653e+00, 3.9482e+05, 3.9902e+05],
        [3.9025e+05, 3.9028e+05, 3.9023e+05, 0.0000e+00, 3.9027e+05, 3.9027e+05,
         3.9025e+05, 3.9023e+05, 7.8542e+05, 3.9023e+05, 7.9919e+05, 3.9026e+05,
         7.8904e+05, 3.9024e+05, 7.6092e+05, 7.7462e+05],
        [1.6867e+00, 1.4907e+00, 1.1859e+00, 3.9027e+05, 0.0000e+00, 1.7362e+00,
         1.2096e+00, 1.8150e+00, 3.9479e+05, 1.5042e+00, 4.0280e+05, 1.8270e+00,
         3.7811e+05, 1.1404e+00, 3.9485e+05, 3.9900e+05],
        [1.4078e+00, 1.6401e+00, 1.6559e+00, 3.9027e+05, 1.7362e+00, 0.0000e+00,
         1.6080e+00, 1.3403e+00, 3.9475e+05, 1.3827e+00, 4.0282e+05, 1.4189e+00,
         3.7814e+05, 1.6181e+00, 3.9487e+05, 3.9903e+05],
        [1.5523e+00, 1.4002e+00, 1.1274e+00, 3.9025e+05, 1.2096e+00, 1.6080e+00,
         0.0000e+00, 1.5525e+00, 3.9476e+05, 1.4944e+00, 4.0280e+05, 1.6232e+00,
         3.7816e+05, 1.2066e+00, 3.9486e+05, 3.9900e+05],
        [1.3802e+00, 1.6411e+00, 1.6037e+00, 3.9023e+05, 1.8150e+00, 1.3403e+00,
         1.5525e+00, 0.0000e+00, 3.9475e+05, 1.4537e+00, 4.0283e+05, 1.3856e+00,
         3.7813e+05, 1.5633e+00, 3.9487e+05, 3.9903e+05],
        [3.9479e+05, 3.9475e+05, 3.9477e+05, 7.8542e+05, 3.9479e+05, 3.9475e+05,
         3.9476e+05, 3.9475e+05, 0.0000e+00, 3.9476e+05, 8.1832e+05, 3.9477e+05,
         7.7454e+05, 3.9477e+05, 7.9038e+05, 7.8815e+05],
        [1.4215e+00, 1.6042e+00, 1.3611e+00, 3.9023e+05, 1.5042e+00, 1.3827e+00,
         1.4944e+00, 1.4537e+00, 3.9476e+05, 0.0000e+00, 4.0283e+05, 1.4001e+00,
         3.7814e+05, 1.4787e+00, 3.9485e+05, 3.9903e+05],
        [4.0283e+05, 4.0280e+05, 4.0280e+05, 7.9919e+05, 4.0280e+05, 4.0282e+05,
         4.0280e+05, 4.0283e+05, 8.1832e+05, 4.0283e+05, 0.0000e+00, 4.0284e+05,
         7.8987e+05, 4.0283e+05, 8.0969e+05, 8.0134e+05],
        [1.4242e+00, 1.7570e+00, 1.6214e+00, 3.9026e+05, 1.8270e+00, 1.4189e+00,
         1.6232e+00, 1.3856e+00, 3.9477e+05, 1.4001e+00, 4.0284e+05, 0.0000e+00,
         3.7814e+05, 1.6188e+00, 3.9486e+05, 3.9900e+05],
        [3.7812e+05, 3.7814e+05, 3.7811e+05, 7.8904e+05, 3.7811e+05, 3.7814e+05,
         3.7816e+05, 3.7813e+05, 7.7454e+05, 3.7814e+05, 7.8987e+05, 3.7814e+05,
         0.0000e+00, 3.7813e+05, 7.6800e+05, 7.7575e+05],
        [1.4573e+00, 1.4751e+00, 1.1653e+00, 3.9024e+05, 1.1404e+00, 1.6181e+00,
         1.2066e+00, 1.5633e+00, 3.9477e+05, 1.4787e+00, 4.0283e+05, 1.6188e+00,
         3.7813e+05, 0.0000e+00, 3.9484e+05, 3.9903e+05],
        [3.9483e+05, 3.9484e+05, 3.9482e+05, 7.6092e+05, 3.9485e+05, 3.9487e+05,
         3.9486e+05, 3.9487e+05, 7.9038e+05, 3.9485e+05, 8.0969e+05, 3.9486e+05,
         7.6800e+05, 3.9484e+05, 0.0000e+00, 7.9737e+05],
        [3.9904e+05, 3.9900e+05, 3.9902e+05, 7.7462e+05, 3.9900e+05, 3.9903e+05,
         3.9900e+05, 3.9903e+05, 7.8815e+05, 3.9903e+05, 8.0134e+05, 3.9900e+05,
         7.7575e+05, 3.9903e+05, 7.9737e+05, 0.0000e+00]])
Krum scores: ['1.48', '1.54', '1.37', '390244.38', '1.47', '1.51', '1.39', '1.49', '394761.25', '1.44', '402813.47', '1.53', '378127.84', '1.39', '394841.91', '399012.94']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 5, 12, 15, 2, 7, 10, 11, 16, 4, 17, 8, 18, 9, 20, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0275s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:21...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:21, End: 2025-07-22 16:02:21)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 3, 19, 1, 15, 16, 7, 4, 10, 14, 13, 9, 11, 20, 5, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.7623e+00, 3.8875e+05, 1.7029e+00, 4.0167e+05, 3.8262e+05,
         1.9447e+00, 1.5633e+00, 1.1466e+00, 3.9558e+05, 4.0547e+05, 1.1559e+00,
         1.8476e+00, 3.7036e+05, 1.3428e+00, 1.8859e+00],
        [1.7623e+00, 0.0000e+00, 3.8871e+05, 1.2352e+00, 4.0163e+05, 3.8258e+05,
         1.2101e+00, 1.2098e+00, 1.3337e+00, 3.9558e+05, 4.0548e+05, 1.3128e+00,
         1.2029e+00, 3.7035e+05, 1.1753e+00, 1.1715e+00],
        [3.8875e+05, 3.8871e+05, 0.0000e+00, 3.8874e+05, 7.9664e+05, 7.6722e+05,
         3.8876e+05, 3.8871e+05, 3.8876e+05, 7.9006e+05, 8.0809e+05, 3.8873e+05,
         3.8873e+05, 7.5724e+05, 3.8875e+05, 3.8871e+05],
        [1.7029e+00, 1.2352e+00, 3.8874e+05, 0.0000e+00, 4.0161e+05, 3.8259e+05,
         1.2273e+00, 1.1707e+00, 1.3048e+00, 3.9554e+05, 4.0545e+05, 1.2182e+00,
         1.1282e+00, 3.7033e+05, 1.2151e+00, 1.1670e+00],
        [4.0167e+05, 4.0163e+05, 7.9664e+05, 4.0161e+05, 0.0000e+00, 7.9883e+05,
         4.0163e+05, 4.0165e+05, 4.0166e+05, 8.2712e+05, 8.1872e+05, 4.0163e+05,
         4.0165e+05, 7.5681e+05, 4.0164e+05, 4.0163e+05],
        [3.8262e+05, 3.8258e+05, 7.6722e+05, 3.8259e+05, 7.9883e+05, 0.0000e+00,
         3.8257e+05, 3.8257e+05, 3.8259e+05, 7.6070e+05, 7.5776e+05, 3.8260e+05,
         3.8256e+05, 7.4326e+05, 3.8259e+05, 3.8256e+05],
        [1.9447e+00, 1.2101e+00, 3.8876e+05, 1.2273e+00, 4.0163e+05, 3.8257e+05,
         0.0000e+00, 1.1420e+00, 1.4140e+00, 3.9554e+05, 4.0546e+05, 1.3803e+00,
         1.1656e+00, 3.7037e+05, 1.2536e+00, 1.1740e+00],
        [1.5633e+00, 1.2098e+00, 3.8871e+05, 1.1707e+00, 4.0165e+05, 3.8257e+05,
         1.1420e+00, 0.0000e+00, 1.2944e+00, 3.9553e+05, 4.0547e+05, 1.2303e+00,
         1.1977e+00, 3.7036e+05, 1.1529e+00, 1.1770e+00],
        [1.1466e+00, 1.3337e+00, 3.8876e+05, 1.3048e+00, 4.0166e+05, 3.8259e+05,
         1.4140e+00, 1.2944e+00, 0.0000e+00, 3.9556e+05, 4.0546e+05, 1.0246e+00,
         1.3036e+00, 3.7033e+05, 1.1015e+00, 1.3753e+00],
        [3.9558e+05, 3.9558e+05, 7.9006e+05, 3.9554e+05, 8.2712e+05, 7.6070e+05,
         3.9554e+05, 3.9553e+05, 3.9556e+05, 0.0000e+00, 8.0128e+05, 3.9556e+05,
         3.9553e+05, 7.4270e+05, 3.9556e+05, 3.9555e+05],
        [4.0547e+05, 4.0548e+05, 8.0809e+05, 4.0545e+05, 8.1872e+05, 7.5776e+05,
         4.0546e+05, 4.0547e+05, 4.0546e+05, 8.0128e+05, 0.0000e+00, 4.0547e+05,
         4.0545e+05, 7.9798e+05, 4.0545e+05, 4.0545e+05],
        [1.1559e+00, 1.3128e+00, 3.8873e+05, 1.2182e+00, 4.0163e+05, 3.8260e+05,
         1.3803e+00, 1.2303e+00, 1.0246e+00, 3.9556e+05, 4.0547e+05, 0.0000e+00,
         1.3234e+00, 3.7036e+05, 1.1214e+00, 1.3507e+00],
        [1.8476e+00, 1.2029e+00, 3.8873e+05, 1.1282e+00, 4.0165e+05, 3.8256e+05,
         1.1656e+00, 1.1977e+00, 1.3036e+00, 3.9553e+05, 4.0545e+05, 1.3234e+00,
         0.0000e+00, 3.7034e+05, 1.2025e+00, 1.0927e+00],
        [3.7036e+05, 3.7035e+05, 7.5724e+05, 3.7033e+05, 7.5681e+05, 7.4326e+05,
         3.7037e+05, 3.7036e+05, 3.7033e+05, 7.4270e+05, 7.9798e+05, 3.7036e+05,
         3.7034e+05, 0.0000e+00, 3.7033e+05, 3.7034e+05],
        [1.3428e+00, 1.1753e+00, 3.8875e+05, 1.2151e+00, 4.0164e+05, 3.8259e+05,
         1.2536e+00, 1.1529e+00, 1.1015e+00, 3.9556e+05, 4.0545e+05, 1.1214e+00,
         1.2025e+00, 3.7033e+05, 0.0000e+00, 1.2766e+00],
        [1.8859e+00, 1.1715e+00, 3.8871e+05, 1.1670e+00, 4.0163e+05, 3.8256e+05,
         1.1740e+00, 1.1770e+00, 1.3753e+00, 3.9555e+05, 4.0545e+05, 1.3507e+00,
         1.0927e+00, 3.7034e+05, 1.2766e+00, 0.0000e+00]])
Krum scores: ['1.55', '1.23', '388730.50', '1.21', '401633.69', '382576.44', '1.25', '1.20', '1.24', '395546.84', '405458.84', '1.22', '1.20', '370341.62', '1.19', '1.22']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [12, 3, 19, 1, 15, 16, 7, 4, 10, 14, 13, 9, 11, 20, 5, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0067s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:21...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:21, End: 2025-07-22 16:02:22)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 12, 10, 18, 3, 7, 15, 13, 4, 17, 19, 2, 20, 6, 8, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0120e+00, 1.0602e+00, 3.9751e+05, 1.2448e+00, 1.3328e+00,
         3.8590e+05, 3.9593e+05, 1.2184e+00, 3.9972e+05, 3.7792e+05, 9.3785e-01,
         3.9488e+05, 1.3140e+00, 1.3467e+00, 3.9004e+05],
        [1.0120e+00, 0.0000e+00, 9.9001e-01, 3.9754e+05, 1.4274e+00, 1.5963e+00,
         3.8593e+05, 3.9593e+05, 1.3136e+00, 3.9974e+05, 3.7793e+05, 8.9850e-01,
         3.9488e+05, 1.5965e+00, 1.6051e+00, 3.9003e+05],
        [1.0602e+00, 9.9001e-01, 0.0000e+00, 3.9751e+05, 1.2384e+00, 1.3441e+00,
         3.8588e+05, 3.9592e+05, 1.2715e+00, 3.9973e+05, 3.7790e+05, 1.0096e+00,
         3.9487e+05, 1.3620e+00, 1.3676e+00, 3.9004e+05],
        [3.9751e+05, 3.9754e+05, 3.9751e+05, 0.0000e+00, 3.9750e+05, 3.9752e+05,
         7.9175e+05, 7.8360e+05, 3.9751e+05, 8.0013e+05, 7.8143e+05, 3.9751e+05,
         7.7667e+05, 3.9750e+05, 3.9751e+05, 7.8778e+05],
        [1.2448e+00, 1.4274e+00, 1.2384e+00, 3.9750e+05, 0.0000e+00, 1.1954e+00,
         3.8595e+05, 3.9592e+05, 1.1769e+00, 3.9975e+05, 3.7792e+05, 1.3238e+00,
         3.9485e+05, 1.1688e+00, 1.2049e+00, 3.9004e+05],
        [1.3328e+00, 1.5963e+00, 1.3441e+00, 3.9752e+05, 1.1954e+00, 0.0000e+00,
         3.8594e+05, 3.9589e+05, 1.1346e+00, 3.9975e+05, 3.7792e+05, 1.3771e+00,
         3.9484e+05, 1.1108e+00, 1.1926e+00, 3.9003e+05],
        [3.8590e+05, 3.8593e+05, 3.8588e+05, 7.9175e+05, 3.8595e+05, 3.8594e+05,
         0.0000e+00, 7.9391e+05, 3.8594e+05, 7.9023e+05, 7.6314e+05, 3.8593e+05,
         7.5744e+05, 3.8594e+05, 3.8595e+05, 7.7219e+05],
        [3.9593e+05, 3.9593e+05, 3.9592e+05, 7.8360e+05, 3.9592e+05, 3.9589e+05,
         7.9391e+05, 0.0000e+00, 3.9592e+05, 8.0170e+05, 7.6213e+05, 3.9589e+05,
         7.7094e+05, 3.9593e+05, 3.9594e+05, 8.1114e+05],
        [1.2184e+00, 1.3136e+00, 1.2715e+00, 3.9751e+05, 1.1769e+00, 1.1346e+00,
         3.8594e+05, 3.9592e+05, 0.0000e+00, 3.9974e+05, 3.7794e+05, 1.1790e+00,
         3.9484e+05, 1.1726e+00, 1.1895e+00, 3.9005e+05],
        [3.9972e+05, 3.9974e+05, 3.9973e+05, 8.0013e+05, 3.9975e+05, 3.9975e+05,
         7.9023e+05, 8.0170e+05, 3.9974e+05, 0.0000e+00, 8.0112e+05, 3.9972e+05,
         8.1806e+05, 3.9976e+05, 3.9974e+05, 7.7951e+05],
        [3.7792e+05, 3.7793e+05, 3.7790e+05, 7.8143e+05, 3.7792e+05, 3.7792e+05,
         7.6314e+05, 7.6213e+05, 3.7794e+05, 8.0112e+05, 0.0000e+00, 3.7791e+05,
         7.8820e+05, 3.7793e+05, 3.7790e+05, 7.6779e+05],
        [9.3785e-01, 8.9850e-01, 1.0096e+00, 3.9751e+05, 1.3238e+00, 1.3771e+00,
         3.8593e+05, 3.9589e+05, 1.1790e+00, 3.9972e+05, 3.7791e+05, 0.0000e+00,
         3.9486e+05, 1.3327e+00, 1.4544e+00, 3.9003e+05],
        [3.9488e+05, 3.9488e+05, 3.9487e+05, 7.7667e+05, 3.9485e+05, 3.9484e+05,
         7.5744e+05, 7.7094e+05, 3.9484e+05, 8.1806e+05, 7.8820e+05, 3.9486e+05,
         0.0000e+00, 3.9487e+05, 3.9488e+05, 7.8481e+05],
        [1.3140e+00, 1.5965e+00, 1.3620e+00, 3.9750e+05, 1.1688e+00, 1.1108e+00,
         3.8594e+05, 3.9593e+05, 1.1726e+00, 3.9976e+05, 3.7793e+05, 1.3327e+00,
         3.9487e+05, 0.0000e+00, 1.1514e+00, 3.9005e+05],
        [1.3467e+00, 1.6051e+00, 1.3676e+00, 3.9751e+05, 1.2049e+00, 1.1926e+00,
         3.8595e+05, 3.9594e+05, 1.1895e+00, 3.9974e+05, 3.7790e+05, 1.4544e+00,
         3.9488e+05, 1.1514e+00, 0.0000e+00, 3.9003e+05],
        [3.9004e+05, 3.9003e+05, 3.9004e+05, 7.8778e+05, 3.9004e+05, 3.9003e+05,
         7.7219e+05, 8.1114e+05, 3.9005e+05, 7.7951e+05, 7.6779e+05, 3.9003e+05,
         7.8481e+05, 3.9005e+05, 3.9003e+05, 0.0000e+00]])
Krum scores: ['1.16', '1.26', '1.18', '397508.28', '1.22', '1.24', '385922.34', '395914.34', '1.19', '399735.94', '377913.94', '1.15', '394857.69', '1.23', '1.27', '390032.31']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 12, 10, 18, 3, 7, 15, 13, 4, 17, 19, 2, 20, 6, 8, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0190s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:22...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:22, End: 2025-07-22 16:02:22)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [5, 18, 3, 8, 17, 16, 15, 14, 2, 4, 6, 9, 13, 11, 10, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.1205e+05, 1.2704e+00, 1.3764e+00, 3.9222e+05, 3.8498e+05,
         4.0160e+05, 3.8809e+05, 1.0541e+00, 1.2283e+00, 1.4192e+00, 1.0039e+00,
         3.9815e+05, 1.3390e+00, 9.8612e-01, 3.8857e+05],
        [4.1205e+05, 0.0000e+00, 4.1204e+05, 4.1204e+05, 8.0454e+05, 8.0309e+05,
         8.1294e+05, 8.0018e+05, 4.1205e+05, 4.1203e+05, 4.1204e+05, 4.1202e+05,
         7.9903e+05, 4.1202e+05, 4.1203e+05, 7.9978e+05],
        [1.2704e+00, 4.1204e+05, 0.0000e+00, 1.0655e+00, 3.9223e+05, 3.8499e+05,
         4.0159e+05, 3.8811e+05, 1.7397e+00, 1.0877e+00, 1.0437e+00, 1.1747e+00,
         3.9814e+05, 1.0597e+00, 1.1230e+00, 3.8857e+05],
        [1.3764e+00, 4.1204e+05, 1.0655e+00, 0.0000e+00, 3.9225e+05, 3.8500e+05,
         4.0162e+05, 3.8806e+05, 1.8881e+00, 1.0769e+00, 1.0301e+00, 1.2413e+00,
         3.9815e+05, 1.0663e+00, 1.1896e+00, 3.8856e+05],
        [3.9222e+05, 8.0454e+05, 3.9223e+05, 3.9225e+05, 0.0000e+00, 7.8203e+05,
         7.8818e+05, 7.8289e+05, 3.9223e+05, 3.9221e+05, 3.9222e+05, 3.9222e+05,
         7.9315e+05, 3.9225e+05, 3.9223e+05, 7.8109e+05],
        [3.8498e+05, 8.0309e+05, 3.8499e+05, 3.8500e+05, 7.8203e+05, 0.0000e+00,
         7.8831e+05, 7.7610e+05, 3.8500e+05, 3.8498e+05, 3.8501e+05, 3.8500e+05,
         7.7260e+05, 3.8501e+05, 3.8501e+05, 7.8767e+05],
        [4.0160e+05, 8.1294e+05, 4.0159e+05, 4.0162e+05, 7.8818e+05, 7.8831e+05,
         0.0000e+00, 7.7937e+05, 4.0157e+05, 4.0159e+05, 4.0160e+05, 4.0159e+05,
         7.8804e+05, 4.0162e+05, 4.0159e+05, 7.8355e+05],
        [3.8809e+05, 8.0018e+05, 3.8811e+05, 3.8806e+05, 7.8289e+05, 7.7610e+05,
         7.7937e+05, 0.0000e+00, 3.8811e+05, 3.8810e+05, 3.8810e+05, 3.8809e+05,
         8.0164e+05, 3.8808e+05, 3.8808e+05, 7.6300e+05],
        [1.0541e+00, 4.1205e+05, 1.7397e+00, 1.8881e+00, 3.9223e+05, 3.8500e+05,
         4.0157e+05, 3.8811e+05, 0.0000e+00, 1.5817e+00, 1.7941e+00, 1.0812e+00,
         3.9818e+05, 1.9076e+00, 1.1874e+00, 3.8859e+05],
        [1.2283e+00, 4.1203e+05, 1.0877e+00, 1.0769e+00, 3.9221e+05, 3.8498e+05,
         4.0159e+05, 3.8810e+05, 1.5817e+00, 0.0000e+00, 1.1005e+00, 1.1366e+00,
         3.9816e+05, 1.1084e+00, 1.1197e+00, 3.8860e+05],
        [1.4192e+00, 4.1204e+05, 1.0437e+00, 1.0301e+00, 3.9222e+05, 3.8501e+05,
         4.0160e+05, 3.8810e+05, 1.7941e+00, 1.1005e+00, 0.0000e+00, 1.2183e+00,
         3.9815e+05, 1.0028e+00, 1.2038e+00, 3.8857e+05],
        [1.0039e+00, 4.1202e+05, 1.1747e+00, 1.2413e+00, 3.9222e+05, 3.8500e+05,
         4.0159e+05, 3.8809e+05, 1.0812e+00, 1.1366e+00, 1.2183e+00, 0.0000e+00,
         3.9815e+05, 1.2197e+00, 9.5505e-01, 3.8857e+05],
        [3.9815e+05, 7.9903e+05, 3.9814e+05, 3.9815e+05, 7.9315e+05, 7.7260e+05,
         7.8804e+05, 8.0164e+05, 3.9818e+05, 3.9816e+05, 3.9815e+05, 3.9815e+05,
         0.0000e+00, 3.9817e+05, 3.9816e+05, 7.8099e+05],
        [1.3390e+00, 4.1202e+05, 1.0597e+00, 1.0663e+00, 3.9225e+05, 3.8501e+05,
         4.0162e+05, 3.8808e+05, 1.9076e+00, 1.1084e+00, 1.0028e+00, 1.2197e+00,
         3.9817e+05, 0.0000e+00, 1.1505e+00, 3.8859e+05],
        [9.8612e-01, 4.1203e+05, 1.1230e+00, 1.1896e+00, 3.9223e+05, 3.8501e+05,
         4.0159e+05, 3.8808e+05, 1.1874e+00, 1.1197e+00, 1.2038e+00, 9.5505e-01,
         3.9816e+05, 1.1505e+00, 0.0000e+00, 3.8859e+05],
        [3.8857e+05, 7.9978e+05, 3.8857e+05, 3.8856e+05, 7.8109e+05, 7.8767e+05,
         7.8355e+05, 7.6300e+05, 3.8859e+05, 3.8860e+05, 3.8857e+05, 3.8857e+05,
         7.8099e+05, 3.8859e+05, 3.8859e+05, 0.0000e+00]])
Krum scores: ['1.18', '412028.53', '1.12', '1.15', '392221.72', '384994.03', '401590.50', '388085.97', '1.48', '1.12', '1.15', '1.11', '398153.00', '1.14', '1.10', '388573.09']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [5, 18, 3, 8, 17, 16, 15, 14, 2, 4, 6, 9, 13, 11, 10, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0066s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:23...
global Accuracy on shared test data: 72.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:23, End: 2025-07-22 16:02:23)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 20, 6, 10, 16, 5, 2, 7, 12, 8, 18, 17, 3, 19, 1, 4], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.5362e+05, 3.8599e+05, 3.8599e+05, 7.8331e+05, 3.8602e+05,
         3.8603e+05, 3.8601e+05, 3.8599e+05, 3.8601e+05, 7.8359e+05, 7.7225e+05,
         3.8602e+05, 7.8891e+05, 3.8603e+05, 3.8601e+05],
        [7.5362e+05, 0.0000e+00, 3.8525e+05, 3.8526e+05, 7.9571e+05, 3.8526e+05,
         3.8524e+05, 3.8523e+05, 3.8525e+05, 3.8522e+05, 7.9622e+05, 7.9843e+05,
         3.8523e+05, 7.9535e+05, 3.8524e+05, 3.8527e+05],
        [3.8599e+05, 3.8525e+05, 0.0000e+00, 1.6983e+00, 4.0221e+05, 1.3805e+00,
         1.5026e+00, 1.0300e+00, 1.3707e+00, 9.9567e-01, 3.9276e+05, 3.9363e+05,
         1.0291e+00, 3.9404e+05, 1.0773e+00, 1.0585e+00],
        [3.8599e+05, 3.8526e+05, 1.6983e+00, 0.0000e+00, 4.0224e+05, 1.0434e+00,
         8.5600e-01, 1.6790e+00, 8.6581e-01, 1.7159e+00, 3.9275e+05, 3.9361e+05,
         1.5728e+00, 3.9405e+05, 1.6509e+00, 1.5268e+00],
        [7.8331e+05, 7.9571e+05, 4.0221e+05, 4.0224e+05, 0.0000e+00, 4.0223e+05,
         4.0224e+05, 4.0222e+05, 4.0224e+05, 4.0223e+05, 7.9427e+05, 8.0580e+05,
         4.0220e+05, 7.9523e+05, 4.0223e+05, 4.0223e+05],
        [3.8602e+05, 3.8526e+05, 1.3805e+00, 1.0434e+00, 4.0223e+05, 0.0000e+00,
         9.2354e-01, 1.2809e+00, 8.4711e-01, 1.3189e+00, 3.9271e+05, 3.9362e+05,
         1.2137e+00, 3.9404e+05, 1.2845e+00, 1.1825e+00],
        [3.8603e+05, 3.8524e+05, 1.5026e+00, 8.5600e-01, 4.0224e+05, 9.2354e-01,
         0.0000e+00, 1.5311e+00, 7.5508e-01, 1.5767e+00, 3.9275e+05, 3.9365e+05,
         1.4389e+00, 3.9407e+05, 1.5049e+00, 1.3181e+00],
        [3.8601e+05, 3.8523e+05, 1.0300e+00, 1.6790e+00, 4.0222e+05, 1.2809e+00,
         1.5311e+00, 0.0000e+00, 1.3764e+00, 1.0415e+00, 3.9272e+05, 3.9365e+05,
         1.0833e+00, 3.9401e+05, 1.0620e+00, 1.0379e+00],
        [3.8599e+05, 3.8525e+05, 1.3707e+00, 8.6581e-01, 4.0224e+05, 8.4711e-01,
         7.5508e-01, 1.3764e+00, 0.0000e+00, 1.3598e+00, 3.9272e+05, 3.9361e+05,
         1.1932e+00, 3.9405e+05, 1.3133e+00, 1.1528e+00],
        [3.8601e+05, 3.8522e+05, 9.9567e-01, 1.7159e+00, 4.0223e+05, 1.3189e+00,
         1.5767e+00, 1.0415e+00, 1.3598e+00, 0.0000e+00, 3.9270e+05, 3.9362e+05,
         1.0491e+00, 3.9403e+05, 1.0449e+00, 1.0472e+00],
        [7.8359e+05, 7.9622e+05, 3.9276e+05, 3.9275e+05, 7.9427e+05, 3.9271e+05,
         3.9275e+05, 3.9272e+05, 3.9272e+05, 3.9270e+05, 0.0000e+00, 7.8554e+05,
         3.9273e+05, 7.8992e+05, 3.9274e+05, 3.9273e+05],
        [7.7225e+05, 7.9843e+05, 3.9363e+05, 3.9361e+05, 8.0580e+05, 3.9362e+05,
         3.9365e+05, 3.9365e+05, 3.9361e+05, 3.9362e+05, 7.8554e+05, 0.0000e+00,
         3.9362e+05, 7.8259e+05, 3.9363e+05, 3.9364e+05],
        [3.8602e+05, 3.8523e+05, 1.0291e+00, 1.5728e+00, 4.0220e+05, 1.2137e+00,
         1.4389e+00, 1.0833e+00, 1.1932e+00, 1.0491e+00, 3.9273e+05, 3.9362e+05,
         0.0000e+00, 3.9406e+05, 1.0877e+00, 1.0753e+00],
        [7.8891e+05, 7.9535e+05, 3.9404e+05, 3.9405e+05, 7.9523e+05, 3.9404e+05,
         3.9407e+05, 3.9401e+05, 3.9405e+05, 3.9403e+05, 7.8992e+05, 7.8259e+05,
         3.9406e+05, 0.0000e+00, 3.9406e+05, 3.9402e+05],
        [3.8603e+05, 3.8524e+05, 1.0773e+00, 1.6509e+00, 4.0223e+05, 1.2845e+00,
         1.5049e+00, 1.0620e+00, 1.3133e+00, 1.0449e+00, 3.9274e+05, 3.9363e+05,
         1.0877e+00, 3.9406e+05, 0.0000e+00, 1.0873e+00],
        [3.8601e+05, 3.8527e+05, 1.0585e+00, 1.5268e+00, 4.0223e+05, 1.1825e+00,
         1.3181e+00, 1.0379e+00, 1.1528e+00, 1.0472e+00, 3.9273e+05, 3.9364e+05,
         1.0753e+00, 3.9402e+05, 1.0873e+00, 0.0000e+00]])
Krum scores: ['386006.06', '385238.03', '1.18', '1.36', '402223.38', '1.14', '1.23', '1.18', '1.11', '1.18', '392725.94', '393622.59', '1.15', '394037.41', '1.18', '1.12']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 20, 6, 10, 16, 5, 2, 7, 12, 8, 18, 17, 3, 19, 1, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:23...
global Accuracy on shared test data: 73.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:23, End: 2025-07-22 16:02:23)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 11, 17, 7, 18, 8, 16, 5, 20, 13, 4, 2, 15, 12, 14, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2377e+00, 3.9875e+05, 1.2685e+00, 3.8499e+05, 1.2914e+00,
         3.8287e+05, 7.9932e-01, 4.0616e+05, 3.7876e+05, 1.1342e+00, 6.4390e-01,
         4.0879e+05, 7.3893e-01, 3.9632e+05, 1.2039e+00],
        [1.2377e+00, 0.0000e+00, 3.9876e+05, 9.6524e-01, 3.8496e+05, 9.7493e-01,
         3.8286e+05, 1.1147e+00, 4.0614e+05, 3.7879e+05, 9.9433e-01, 1.3441e+00,
         4.0879e+05, 1.6906e+00, 3.9631e+05, 9.9502e-01],
        [3.9875e+05, 3.9876e+05, 0.0000e+00, 3.9872e+05, 7.7730e+05, 3.9876e+05,
         7.7496e+05, 3.9874e+05, 8.1227e+05, 7.7315e+05, 3.9873e+05, 3.9876e+05,
         8.1800e+05, 3.9874e+05, 8.0594e+05, 3.9872e+05],
        [1.2685e+00, 9.6524e-01, 3.9872e+05, 0.0000e+00, 3.8500e+05, 9.9773e-01,
         3.8285e+05, 1.1222e+00, 4.0617e+05, 3.7878e+05, 9.2215e-01, 1.2938e+00,
         4.0875e+05, 1.7253e+00, 3.9628e+05, 1.0235e+00],
        [3.8499e+05, 3.8496e+05, 7.7730e+05, 3.8500e+05, 0.0000e+00, 3.8499e+05,
         7.6996e+05, 3.8500e+05, 7.9677e+05, 7.5992e+05, 3.8496e+05, 3.8499e+05,
         7.9256e+05, 3.8498e+05, 7.9336e+05, 3.8498e+05],
        [1.2914e+00, 9.7493e-01, 3.9876e+05, 9.9773e-01, 3.8499e+05, 0.0000e+00,
         3.8286e+05, 1.1469e+00, 4.0617e+05, 3.7877e+05, 9.6018e-01, 1.3140e+00,
         4.0880e+05, 1.7088e+00, 3.9630e+05, 9.8920e-01],
        [3.8287e+05, 3.8286e+05, 7.7496e+05, 3.8285e+05, 7.6996e+05, 3.8286e+05,
         0.0000e+00, 3.8287e+05, 7.7552e+05, 7.4943e+05, 3.8285e+05, 3.8286e+05,
         7.7813e+05, 3.8284e+05, 7.8349e+05, 3.8286e+05],
        [7.9932e-01, 1.1147e+00, 3.9874e+05, 1.1222e+00, 3.8500e+05, 1.1469e+00,
         3.8287e+05, 0.0000e+00, 4.0616e+05, 3.7878e+05, 9.8630e-01, 7.7291e-01,
         4.0877e+05, 9.3200e-01, 3.9632e+05, 1.0563e+00],
        [4.0616e+05, 4.0614e+05, 8.1227e+05, 4.0617e+05, 7.9677e+05, 4.0617e+05,
         7.7552e+05, 4.0616e+05, 0.0000e+00, 7.7039e+05, 4.0615e+05, 4.0617e+05,
         8.1630e+05, 4.0613e+05, 7.8696e+05, 4.0615e+05],
        [3.7876e+05, 3.7879e+05, 7.7315e+05, 3.7878e+05, 7.5992e+05, 3.7877e+05,
         7.4943e+05, 3.7878e+05, 7.7039e+05, 0.0000e+00, 3.7877e+05, 3.7879e+05,
         7.9201e+05, 3.7877e+05, 7.7617e+05, 3.7878e+05],
        [1.1342e+00, 9.9433e-01, 3.9873e+05, 9.2215e-01, 3.8496e+05, 9.6018e-01,
         3.8285e+05, 9.8630e-01, 4.0615e+05, 3.7877e+05, 0.0000e+00, 1.0873e+00,
         4.0877e+05, 1.4256e+00, 3.9628e+05, 1.0090e+00],
        [6.4390e-01, 1.3441e+00, 3.9876e+05, 1.2938e+00, 3.8499e+05, 1.3140e+00,
         3.8286e+05, 7.7291e-01, 4.0617e+05, 3.7879e+05, 1.0873e+00, 0.0000e+00,
         4.0877e+05, 6.8364e-01, 3.9631e+05, 1.2151e+00],
        [4.0879e+05, 4.0879e+05, 8.1800e+05, 4.0875e+05, 7.9256e+05, 4.0880e+05,
         7.7813e+05, 4.0877e+05, 8.1630e+05, 7.9201e+05, 4.0877e+05, 4.0877e+05,
         0.0000e+00, 4.0874e+05, 8.1790e+05, 4.0877e+05],
        [7.3893e-01, 1.6906e+00, 3.9874e+05, 1.7253e+00, 3.8498e+05, 1.7088e+00,
         3.8284e+05, 9.3200e-01, 4.0613e+05, 3.7877e+05, 1.4256e+00, 6.8364e-01,
         4.0874e+05, 0.0000e+00, 3.9634e+05, 1.5505e+00],
        [3.9632e+05, 3.9631e+05, 8.0594e+05, 3.9628e+05, 7.9336e+05, 3.9630e+05,
         7.8349e+05, 3.9632e+05, 7.8696e+05, 7.7617e+05, 3.9628e+05, 3.9631e+05,
         8.1790e+05, 3.9634e+05, 0.0000e+00, 3.9626e+05],
        [1.2039e+00, 9.9502e-01, 3.9872e+05, 1.0235e+00, 3.8498e+05, 9.8920e-01,
         3.8286e+05, 1.0563e+00, 4.0615e+05, 3.7878e+05, 1.0090e+00, 1.2151e+00,
         4.0877e+05, 1.5505e+00, 3.9626e+05, 0.0000e+00]])
Krum scores: ['1.00', '1.09', '398735.97', '1.08', '384978.66', '1.10', '382853.84', '0.97', '406152.28', '378772.59', '1.01', '1.00', '408766.28', '1.25', '396294.97', '1.07']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 11, 17, 7, 18, 8, 16, 5, 20, 13, 4, 2, 15, 12, 14, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:24...
global Accuracy on shared test data: 72.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[164  73]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:24, End: 2025-07-22 16:02:24)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [19, 2, 14, 18, 7, 3, 8, 4, 5, 10, 15, 6, 17, 13, 1, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0249e+05, 8.2095e+05, 7.8734e+05, 4.0250e+05, 4.0253e+05,
         4.0251e+05, 4.0250e+05, 4.0251e+05, 4.0250e+05, 7.7791e+05, 4.0250e+05,
         7.7718e+05, 7.6727e+05, 4.0250e+05, 4.0250e+05],
        [4.0249e+05, 0.0000e+00, 4.0949e+05, 3.9347e+05, 1.2116e+00, 1.1450e+00,
         1.2556e+00, 1.0075e+00, 7.7531e-01, 6.3398e-01, 3.8467e+05, 1.1942e+00,
         3.8957e+05, 3.9501e+05, 1.1027e+00, 5.9284e-01],
        [8.2095e+05, 4.0949e+05, 0.0000e+00, 8.0603e+05, 4.0948e+05, 4.0948e+05,
         4.0947e+05, 4.0947e+05, 4.0948e+05, 4.0945e+05, 7.8019e+05, 4.0946e+05,
         7.9534e+05, 8.1151e+05, 4.0946e+05, 4.0948e+05],
        [7.8734e+05, 3.9347e+05, 8.0603e+05, 0.0000e+00, 3.9344e+05, 3.9347e+05,
         3.9350e+05, 3.9347e+05, 3.9349e+05, 3.9347e+05, 7.8877e+05, 3.9347e+05,
         7.8420e+05, 7.7984e+05, 3.9346e+05, 3.9349e+05],
        [4.0250e+05, 1.2116e+00, 4.0948e+05, 3.9344e+05, 0.0000e+00, 1.0062e+00,
         9.8258e-01, 9.0902e-01, 1.6300e+00, 1.1804e+00, 3.8465e+05, 9.2949e-01,
         3.8957e+05, 3.9504e+05, 9.7981e-01, 1.4254e+00],
        [4.0253e+05, 1.1450e+00, 4.0948e+05, 3.9347e+05, 1.0062e+00, 0.0000e+00,
         9.9721e-01, 9.8956e-01, 1.5126e+00, 1.1183e+00, 3.8467e+05, 9.8046e-01,
         3.8957e+05, 3.9504e+05, 9.7805e-01, 1.2844e+00],
        [4.0251e+05, 1.2556e+00, 4.0947e+05, 3.9350e+05, 9.8258e-01, 9.9721e-01,
         0.0000e+00, 9.7957e-01, 1.6943e+00, 1.2234e+00, 3.8468e+05, 9.5464e-01,
         3.8955e+05, 3.9503e+05, 9.8794e-01, 1.4461e+00],
        [4.0250e+05, 1.0075e+00, 4.0947e+05, 3.9347e+05, 9.0902e-01, 9.8956e-01,
         9.7957e-01, 0.0000e+00, 1.4125e+00, 1.0525e+00, 3.8465e+05, 9.7287e-01,
         3.8957e+05, 3.9501e+05, 9.2640e-01, 1.1488e+00],
        [4.0251e+05, 7.7531e-01, 4.0948e+05, 3.9349e+05, 1.6300e+00, 1.5126e+00,
         1.6943e+00, 1.4125e+00, 0.0000e+00, 8.7062e-01, 3.8467e+05, 1.7231e+00,
         3.8956e+05, 3.9500e+05, 1.4786e+00, 6.8407e-01],
        [4.0250e+05, 6.3398e-01, 4.0945e+05, 3.9347e+05, 1.1804e+00, 1.1183e+00,
         1.2234e+00, 1.0525e+00, 8.7062e-01, 0.0000e+00, 3.8467e+05, 1.2122e+00,
         3.8956e+05, 3.9503e+05, 1.0894e+00, 6.2554e-01],
        [7.7791e+05, 3.8467e+05, 7.8019e+05, 7.8877e+05, 3.8465e+05, 3.8467e+05,
         3.8468e+05, 3.8465e+05, 3.8467e+05, 3.8467e+05, 0.0000e+00, 3.8464e+05,
         7.7711e+05, 7.7288e+05, 3.8467e+05, 3.8465e+05],
        [4.0250e+05, 1.1942e+00, 4.0946e+05, 3.9347e+05, 9.2949e-01, 9.8046e-01,
         9.5464e-01, 9.7287e-01, 1.7231e+00, 1.2122e+00, 3.8464e+05, 0.0000e+00,
         3.8955e+05, 3.9502e+05, 9.6247e-01, 1.4293e+00],
        [7.7718e+05, 3.8957e+05, 7.9534e+05, 7.8420e+05, 3.8957e+05, 3.8957e+05,
         3.8955e+05, 3.8957e+05, 3.8956e+05, 3.8956e+05, 7.7711e+05, 3.8955e+05,
         0.0000e+00, 7.7217e+05, 3.8956e+05, 3.8956e+05],
        [7.6727e+05, 3.9501e+05, 8.1151e+05, 7.7984e+05, 3.9504e+05, 3.9504e+05,
         3.9503e+05, 3.9501e+05, 3.9500e+05, 3.9503e+05, 7.7288e+05, 3.9502e+05,
         7.7217e+05, 0.0000e+00, 3.9503e+05, 3.9501e+05],
        [4.0250e+05, 1.1027e+00, 4.0946e+05, 3.9346e+05, 9.7981e-01, 9.7805e-01,
         9.8794e-01, 9.2640e-01, 1.4786e+00, 1.0894e+00, 3.8467e+05, 9.6247e-01,
         3.8956e+05, 3.9503e+05, 0.0000e+00, 1.2784e+00],
        [4.0250e+05, 5.9284e-01, 4.0948e+05, 3.9349e+05, 1.4254e+00, 1.2844e+00,
         1.4461e+00, 1.1488e+00, 6.8407e-01, 6.2554e-01, 3.8465e+05, 1.4293e+00,
         3.8956e+05, 3.9501e+05, 1.2784e+00, 0.0000e+00]])
Krum scores: ['402499.62', '0.96', '409469.59', '393467.31', '1.08', '1.06', '1.10', '1.00', '1.26', '0.97', '384657.06', '1.08', '389559.41', '395017.16', '1.04', '1.06']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [19, 2, 14, 18, 7, 3, 8, 4, 5, 10, 15, 6, 17, 13, 1, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0176s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:24...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:24, End: 2025-07-22 16:02:24)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 14, 3, 16, 2, 20, 1, 18, 4, 12, 7, 9, 13, 6, 15, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8982e+05, 1.1115e+00, 3.8838e+05, 7.2389e-01, 3.9597e+05,
         1.1453e+00, 4.0131e+05, 1.0524e+00, 5.7723e-01, 1.1266e+00, 7.9359e-01,
         3.7181e+05, 1.1851e+00, 3.7729e+05, 1.2075e+00],
        [3.8982e+05, 0.0000e+00, 3.8986e+05, 7.7948e+05, 3.8981e+05, 8.0320e+05,
         3.8983e+05, 8.0472e+05, 3.8984e+05, 3.8980e+05, 3.8983e+05, 3.8983e+05,
         7.5955e+05, 3.8983e+05, 7.6680e+05, 3.8986e+05],
        [1.1115e+00, 3.8986e+05, 0.0000e+00, 3.8841e+05, 1.4982e+00, 3.9597e+05,
         9.7937e-01, 4.0135e+05, 9.6921e-01, 1.1064e+00, 1.0067e+00, 9.8376e-01,
         3.7182e+05, 9.5828e-01, 3.7725e+05, 9.6524e-01],
        [3.8838e+05, 7.7948e+05, 3.8841e+05, 0.0000e+00, 3.8840e+05, 7.8150e+05,
         3.8839e+05, 7.9090e+05, 3.8842e+05, 3.8839e+05, 3.8841e+05, 3.8842e+05,
         7.6342e+05, 3.8840e+05, 7.7272e+05, 3.8842e+05],
        [7.2389e-01, 3.8981e+05, 1.4982e+00, 3.8840e+05, 0.0000e+00, 3.9597e+05,
         1.5298e+00, 4.0132e+05, 1.3713e+00, 5.0086e-01, 1.5491e+00, 8.9357e-01,
         3.7185e+05, 1.5998e+00, 3.7728e+05, 1.6745e+00],
        [3.9597e+05, 8.0320e+05, 3.9597e+05, 7.8150e+05, 3.9597e+05, 0.0000e+00,
         3.9595e+05, 7.8965e+05, 3.9596e+05, 3.9597e+05, 3.9593e+05, 3.9596e+05,
         7.7336e+05, 3.9595e+05, 7.7575e+05, 3.9596e+05],
        [1.1453e+00, 3.8983e+05, 9.7937e-01, 3.8839e+05, 1.5298e+00, 3.9595e+05,
         0.0000e+00, 4.0132e+05, 9.5713e-01, 1.2055e+00, 9.7188e-01, 9.9349e-01,
         3.7183e+05, 9.7714e-01, 3.7726e+05, 9.8118e-01],
        [4.0131e+05, 8.0472e+05, 4.0135e+05, 7.9090e+05, 4.0132e+05, 7.8965e+05,
         4.0132e+05, 0.0000e+00, 4.0133e+05, 4.0133e+05, 4.0134e+05, 4.0132e+05,
         7.8160e+05, 4.0135e+05, 7.7561e+05, 4.0136e+05],
        [1.0524e+00, 3.8984e+05, 9.6921e-01, 3.8842e+05, 1.3713e+00, 3.9596e+05,
         9.5713e-01, 4.0133e+05, 0.0000e+00, 1.0216e+00, 9.0022e-01, 9.6323e-01,
         3.7184e+05, 9.7391e-01, 3.7724e+05, 9.6677e-01],
        [5.7723e-01, 3.8980e+05, 1.1064e+00, 3.8839e+05, 5.0086e-01, 3.9597e+05,
         1.2055e+00, 4.0133e+05, 1.0216e+00, 0.0000e+00, 1.2245e+00, 7.3113e-01,
         3.7183e+05, 1.2490e+00, 3.7725e+05, 1.2820e+00],
        [1.1266e+00, 3.8983e+05, 1.0067e+00, 3.8841e+05, 1.5491e+00, 3.9593e+05,
         9.7188e-01, 4.0134e+05, 9.0022e-01, 1.2245e+00, 0.0000e+00, 1.0212e+00,
         3.7181e+05, 9.3000e-01, 3.7726e+05, 9.7713e-01],
        [7.9359e-01, 3.8983e+05, 9.8376e-01, 3.8842e+05, 8.9357e-01, 3.9596e+05,
         9.9349e-01, 4.0132e+05, 9.6323e-01, 7.3113e-01, 1.0212e+00, 0.0000e+00,
         3.7183e+05, 1.0336e+00, 3.7726e+05, 1.0741e+00],
        [3.7181e+05, 7.5955e+05, 3.7182e+05, 7.6342e+05, 3.7185e+05, 7.7336e+05,
         3.7183e+05, 7.8160e+05, 3.7184e+05, 3.7183e+05, 3.7181e+05, 3.7183e+05,
         0.0000e+00, 3.7181e+05, 7.5458e+05, 3.7181e+05],
        [1.1851e+00, 3.8983e+05, 9.5828e-01, 3.8840e+05, 1.5998e+00, 3.9595e+05,
         9.7714e-01, 4.0135e+05, 9.7391e-01, 1.2490e+00, 9.3000e-01, 1.0336e+00,
         3.7181e+05, 0.0000e+00, 3.7727e+05, 9.3732e-01],
        [3.7729e+05, 7.6680e+05, 3.7725e+05, 7.7272e+05, 3.7728e+05, 7.7575e+05,
         3.7726e+05, 7.7561e+05, 3.7724e+05, 3.7725e+05, 3.7726e+05, 3.7726e+05,
         7.5458e+05, 3.7727e+05, 0.0000e+00, 3.7725e+05],
        [1.2075e+00, 3.8986e+05, 9.6524e-01, 3.8842e+05, 1.6745e+00, 3.9596e+05,
         9.8118e-01, 4.0136e+05, 9.6677e-01, 1.2820e+00, 9.7713e-01, 1.0741e+00,
         3.7181e+05, 9.3732e-01, 3.7725e+05, 0.0000e+00]])
Krum scores: ['0.96', '389823.88', '1.01', '388399.62', '1.21', '395955.94', '1.03', '401328.81', '0.98', '0.95', '1.02', '0.93', '371818.84', '1.03', '377255.03', '1.05']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 14, 3, 16, 2, 20, 1, 18, 4, 12, 7, 9, 13, 6, 15, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:25...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:25, End: 2025-07-22 16:02:25)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 11, 4, 1, 7, 16, 3, 8, 18, 2, 19, 20, 5, 10, 6, 14], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5625e+00, 1.3410e+00, 1.4367e+00, 1.5402e+00, 3.9516e+05,
         1.3903e+00, 1.5636e+00, 3.9507e+05, 5.1630e-01, 3.9625e+05, 3.7696e+05,
         7.3665e-01, 8.1538e-01, 1.5979e+00, 3.9212e+05],
        [1.5625e+00, 0.0000e+00, 9.9946e-01, 9.6037e-01, 9.5662e-01, 3.9517e+05,
         9.6613e-01, 9.7522e-01, 3.9502e+05, 1.4233e+00, 3.9626e+05, 3.7691e+05,
         1.1896e+00, 1.1417e+00, 9.2617e-01, 3.9212e+05],
        [1.3410e+00, 9.9946e-01, 0.0000e+00, 1.0017e+00, 9.6228e-01, 3.9516e+05,
         9.8123e-01, 1.0057e+00, 3.9503e+05, 1.1456e+00, 3.9623e+05, 3.7694e+05,
         1.0695e+00, 1.0531e+00, 1.0115e+00, 3.9213e+05],
        [1.4367e+00, 9.6037e-01, 1.0017e+00, 0.0000e+00, 1.0089e+00, 3.9519e+05,
         9.7790e-01, 1.0106e+00, 3.9504e+05, 1.2951e+00, 3.9622e+05, 3.7696e+05,
         1.1527e+00, 1.1350e+00, 9.9514e-01, 3.9211e+05],
        [1.5402e+00, 9.5662e-01, 9.6228e-01, 1.0089e+00, 0.0000e+00, 3.9517e+05,
         1.0060e+00, 1.0115e+00, 3.9507e+05, 1.3606e+00, 3.9624e+05, 3.7696e+05,
         1.1966e+00, 1.1316e+00, 9.6704e-01, 3.9213e+05],
        [3.9516e+05, 3.9517e+05, 3.9516e+05, 3.9519e+05, 3.9517e+05, 0.0000e+00,
         3.9521e+05, 3.9517e+05, 8.0162e+05, 3.9514e+05, 7.8867e+05, 7.6759e+05,
         3.9516e+05, 3.9517e+05, 3.9515e+05, 7.7171e+05],
        [1.3903e+00, 9.6613e-01, 9.8123e-01, 9.7790e-01, 1.0060e+00, 3.9521e+05,
         0.0000e+00, 9.5314e-01, 3.9506e+05, 1.2508e+00, 3.9625e+05, 3.7693e+05,
         1.0862e+00, 1.0476e+00, 9.7143e-01, 3.9213e+05],
        [1.5636e+00, 9.7522e-01, 1.0057e+00, 1.0106e+00, 1.0115e+00, 3.9517e+05,
         9.5314e-01, 0.0000e+00, 3.9507e+05, 1.4280e+00, 3.9623e+05, 3.7694e+05,
         1.2601e+00, 1.1881e+00, 9.4457e-01, 3.9212e+05],
        [3.9507e+05, 3.9502e+05, 3.9503e+05, 3.9504e+05, 3.9507e+05, 8.0162e+05,
         3.9506e+05, 3.9507e+05, 0.0000e+00, 3.9509e+05, 7.8717e+05, 7.6822e+05,
         3.9505e+05, 3.9509e+05, 3.9505e+05, 7.9406e+05],
        [5.1630e-01, 1.4233e+00, 1.1456e+00, 1.2951e+00, 1.3606e+00, 3.9514e+05,
         1.2508e+00, 1.4280e+00, 3.9509e+05, 0.0000e+00, 3.9623e+05, 3.7696e+05,
         5.5983e-01, 6.3863e-01, 1.4029e+00, 3.9213e+05],
        [3.9625e+05, 3.9626e+05, 3.9623e+05, 3.9622e+05, 3.9624e+05, 7.8867e+05,
         3.9625e+05, 3.9623e+05, 7.8717e+05, 3.9623e+05, 0.0000e+00, 7.7585e+05,
         3.9623e+05, 3.9624e+05, 3.9625e+05, 7.7143e+05],
        [3.7696e+05, 3.7691e+05, 3.7694e+05, 3.7696e+05, 3.7696e+05, 7.6759e+05,
         3.7693e+05, 3.7694e+05, 7.6822e+05, 3.7696e+05, 7.7585e+05, 0.0000e+00,
         3.7695e+05, 3.7695e+05, 3.7694e+05, 7.7369e+05],
        [7.3665e-01, 1.1896e+00, 1.0695e+00, 1.1527e+00, 1.1966e+00, 3.9516e+05,
         1.0862e+00, 1.2601e+00, 3.9505e+05, 5.5983e-01, 3.9623e+05, 3.7695e+05,
         0.0000e+00, 6.8831e-01, 1.3252e+00, 3.9212e+05],
        [8.1538e-01, 1.1417e+00, 1.0531e+00, 1.1350e+00, 1.1316e+00, 3.9517e+05,
         1.0476e+00, 1.1881e+00, 3.9509e+05, 6.3863e-01, 3.9624e+05, 3.7695e+05,
         6.8831e-01, 0.0000e+00, 1.2116e+00, 3.9212e+05],
        [1.5979e+00, 9.2617e-01, 1.0115e+00, 9.9514e-01, 9.6704e-01, 3.9515e+05,
         9.7143e-01, 9.4457e-01, 3.9505e+05, 1.4029e+00, 3.9625e+05, 3.7694e+05,
         1.3252e+00, 1.2116e+00, 0.0000e+00, 3.9211e+05],
        [3.9212e+05, 3.9212e+05, 3.9213e+05, 3.9211e+05, 3.9213e+05, 7.7171e+05,
         3.9213e+05, 3.9212e+05, 7.9406e+05, 3.9213e+05, 7.7143e+05, 7.7369e+05,
         3.9212e+05, 3.9212e+05, 3.9211e+05, 0.0000e+00]])
Krum scores: ['1.21', '1.06', '1.03', '1.06', '1.07', '395163.84', '1.03', '1.09', '395049.81', '1.07', '396235.75', '376941.62', '0.99', '0.98', '1.08', '392118.75']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 11, 4, 1, 7, 16, 3, 8, 18, 2, 19, 20, 5, 10, 6, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:26...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[163  74]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:26, End: 2025-07-22 16:02:26)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 11, 19, 10, 2, 7, 15, 6, 16, 17, 13, 18, 1, 8, 14, 4], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2379e+00, 3.8919e+05, 6.5774e-01, 4.8057e-01, 1.2434e+00,
         4.0103e+05, 1.2358e+00, 4.0790e+05, 3.9014e+05, 3.9047e+05, 3.8786e+05,
         1.1278e+00, 1.2749e+00, 3.8876e+05, 1.1221e+00],
        [1.2379e+00, 0.0000e+00, 3.8919e+05, 1.5396e+00, 1.3301e+00, 9.6041e-01,
         4.0107e+05, 9.1781e-01, 4.0790e+05, 3.9010e+05, 3.9049e+05, 3.8784e+05,
         9.3377e-01, 9.6391e-01, 3.8878e+05, 9.6051e-01],
        [3.8919e+05, 3.8919e+05, 0.0000e+00, 3.8922e+05, 3.8924e+05, 3.8921e+05,
         7.9477e+05, 3.8918e+05, 7.7794e+05, 7.8920e+05, 7.7359e+05, 7.7887e+05,
         3.8919e+05, 3.8924e+05, 7.6882e+05, 3.8919e+05],
        [6.5774e-01, 1.5396e+00, 3.8922e+05, 0.0000e+00, 4.9774e-01, 1.5637e+00,
         4.0104e+05, 1.6273e+00, 4.0788e+05, 3.9013e+05, 3.9046e+05, 3.8788e+05,
         1.4839e+00, 1.6642e+00, 3.8877e+05, 1.4390e+00],
        [4.8057e-01, 1.3301e+00, 3.8924e+05, 4.9774e-01, 0.0000e+00, 1.3182e+00,
         4.0105e+05, 1.2950e+00, 4.0789e+05, 3.9011e+05, 3.9046e+05, 3.8789e+05,
         1.2168e+00, 1.3821e+00, 3.8874e+05, 1.1369e+00],
        [1.2434e+00, 9.6041e-01, 3.8921e+05, 1.5637e+00, 1.3182e+00, 0.0000e+00,
         4.0105e+05, 9.5477e-01, 4.0791e+05, 3.9012e+05, 3.9046e+05, 3.8786e+05,
         9.5152e-01, 9.7196e-01, 3.8875e+05, 9.1833e-01],
        [4.0103e+05, 4.0107e+05, 7.9477e+05, 4.0104e+05, 4.0105e+05, 4.0105e+05,
         0.0000e+00, 4.0102e+05, 8.1960e+05, 7.8962e+05, 8.0056e+05, 8.0154e+05,
         4.0103e+05, 4.0104e+05, 7.8060e+05, 4.0104e+05],
        [1.2358e+00, 9.1781e-01, 3.8918e+05, 1.6273e+00, 1.2950e+00, 9.5477e-01,
         4.0102e+05, 0.0000e+00, 4.0793e+05, 3.9011e+05, 3.9050e+05, 3.8784e+05,
         9.3780e-01, 9.2572e-01, 3.8876e+05, 9.4559e-01],
        [4.0790e+05, 4.0790e+05, 7.7794e+05, 4.0788e+05, 4.0789e+05, 4.0791e+05,
         8.1960e+05, 4.0793e+05, 0.0000e+00, 8.1782e+05, 7.9919e+05, 7.8869e+05,
         4.0790e+05, 4.0789e+05, 8.0160e+05, 4.0791e+05],
        [3.9014e+05, 3.9010e+05, 7.8920e+05, 3.9013e+05, 3.9011e+05, 3.9012e+05,
         7.8962e+05, 3.9011e+05, 8.1782e+05, 0.0000e+00, 7.6998e+05, 7.8411e+05,
         3.9011e+05, 3.9012e+05, 7.7103e+05, 3.9012e+05],
        [3.9047e+05, 3.9049e+05, 7.7359e+05, 3.9046e+05, 3.9046e+05, 3.9046e+05,
         8.0056e+05, 3.9050e+05, 7.9919e+05, 7.6998e+05, 0.0000e+00, 7.6473e+05,
         3.9051e+05, 3.9053e+05, 7.8512e+05, 3.9048e+05],
        [3.8786e+05, 3.8784e+05, 7.7887e+05, 3.8788e+05, 3.8789e+05, 3.8786e+05,
         8.0154e+05, 3.8784e+05, 7.8869e+05, 7.8411e+05, 7.6473e+05, 0.0000e+00,
         3.8785e+05, 3.8786e+05, 7.8419e+05, 3.8785e+05],
        [1.1278e+00, 9.3377e-01, 3.8919e+05, 1.4839e+00, 1.2168e+00, 9.5152e-01,
         4.0103e+05, 9.3780e-01, 4.0790e+05, 3.9011e+05, 3.9051e+05, 3.8785e+05,
         0.0000e+00, 9.6806e-01, 3.8876e+05, 9.1347e-01],
        [1.2749e+00, 9.6391e-01, 3.8924e+05, 1.6642e+00, 1.3821e+00, 9.7196e-01,
         4.0104e+05, 9.2572e-01, 4.0789e+05, 3.9012e+05, 3.9053e+05, 3.8786e+05,
         9.6806e-01, 0.0000e+00, 3.8876e+05, 9.4333e-01],
        [3.8876e+05, 3.8878e+05, 7.6882e+05, 3.8877e+05, 3.8874e+05, 3.8875e+05,
         7.8060e+05, 3.8876e+05, 8.0160e+05, 7.7103e+05, 7.8512e+05, 7.8419e+05,
         3.8876e+05, 3.8876e+05, 0.0000e+00, 3.8878e+05],
        [1.1221e+00, 9.6051e-01, 3.8919e+05, 1.4390e+00, 1.1369e+00, 9.1833e-01,
         4.0104e+05, 9.4559e-01, 4.0791e+05, 3.9012e+05, 3.9048e+05, 3.8785e+05,
         9.1347e-01, 9.4333e-01, 3.8878e+05, 0.0000e+00]])
Krum scores: ['1.02', '1.04', '389196.25', '1.26', '1.04', '1.05', '401036.94', '1.03', '407895.41', '390113.34', '390473.47', '387850.59', '1.01', '1.06', '388757.75', '0.99']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [9, 11, 19, 10, 2, 7, 15, 6, 16, 17, 13, 18, 1, 8, 14, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0054s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:26...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:26, End: 2025-07-22 16:02:26)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [5, 9, 14, 15, 18, 12, 10, 16, 8, 19, 2, 7, 17, 3, 1, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 8.1894e-01, 3.8522e+05, 3.8809e+05, 3.6698e+05, 7.4761e-01,
         7.4258e-01, 3.9980e+05, 1.4744e+00, 3.9482e+05, 7.2022e-01, 1.3916e+00,
         3.7837e+05, 1.3302e+00, 1.3312e+00, 1.5657e+00],
        [8.1894e-01, 0.0000e+00, 3.8520e+05, 3.8808e+05, 3.6696e+05, 7.0301e-01,
         6.8589e-01, 3.9984e+05, 1.4206e+00, 3.9481e+05, 6.1993e-01, 1.3652e+00,
         3.7838e+05, 1.2679e+00, 1.2751e+00, 1.4445e+00],
        [3.8522e+05, 3.8520e+05, 0.0000e+00, 7.8320e+05, 7.4124e+05, 3.8521e+05,
         3.8520e+05, 7.7088e+05, 3.8517e+05, 7.8182e+05, 3.8518e+05, 3.8519e+05,
         7.5054e+05, 3.8518e+05, 3.8519e+05, 3.8517e+05],
        [3.8809e+05, 3.8808e+05, 7.8320e+05, 0.0000e+00, 7.5341e+05, 3.8808e+05,
         3.8806e+05, 7.9322e+05, 3.8804e+05, 7.6292e+05, 3.8806e+05, 3.8808e+05,
         7.5648e+05, 3.8808e+05, 3.8806e+05, 3.8804e+05],
        [3.6698e+05, 3.6696e+05, 7.4124e+05, 7.5341e+05, 0.0000e+00, 3.6698e+05,
         3.6696e+05, 7.5289e+05, 3.6694e+05, 7.6641e+05, 3.6696e+05, 3.6695e+05,
         7.4458e+05, 3.6694e+05, 3.6696e+05, 3.6692e+05],
        [7.4761e-01, 7.0301e-01, 3.8521e+05, 3.8808e+05, 3.6698e+05, 0.0000e+00,
         6.0703e-01, 3.9982e+05, 1.5069e+00, 3.9480e+05, 6.2475e-01, 1.4826e+00,
         3.7839e+05, 1.3476e+00, 1.4202e+00, 1.5827e+00],
        [7.4258e-01, 6.8589e-01, 3.8520e+05, 3.8806e+05, 3.6696e+05, 6.0703e-01,
         0.0000e+00, 3.9983e+05, 1.5748e+00, 3.9482e+05, 5.6293e-01, 1.5045e+00,
         3.7838e+05, 1.4266e+00, 1.4274e+00, 1.6559e+00],
        [3.9980e+05, 3.9984e+05, 7.7088e+05, 7.9322e+05, 7.5289e+05, 3.9982e+05,
         3.9983e+05, 0.0000e+00, 3.9982e+05, 8.1026e+05, 3.9982e+05, 3.9980e+05,
         7.6372e+05, 3.9977e+05, 3.9979e+05, 3.9982e+05],
        [1.4744e+00, 1.4206e+00, 3.8517e+05, 3.8804e+05, 3.6694e+05, 1.5069e+00,
         1.5748e+00, 3.9982e+05, 0.0000e+00, 3.9480e+05, 1.5760e+00, 1.0799e+00,
         3.7836e+05, 1.0433e+00, 1.0808e+00, 1.0282e+00],
        [3.9482e+05, 3.9481e+05, 7.8182e+05, 7.6292e+05, 7.6641e+05, 3.9480e+05,
         3.9482e+05, 8.1026e+05, 3.9480e+05, 0.0000e+00, 3.9481e+05, 3.9479e+05,
         7.9805e+05, 3.9477e+05, 3.9480e+05, 3.9479e+05],
        [7.2022e-01, 6.1993e-01, 3.8518e+05, 3.8806e+05, 3.6696e+05, 6.2475e-01,
         5.6293e-01, 3.9982e+05, 1.5760e+00, 3.9481e+05, 0.0000e+00, 1.4765e+00,
         3.7836e+05, 1.4182e+00, 1.3975e+00, 1.5852e+00],
        [1.3916e+00, 1.3652e+00, 3.8519e+05, 3.8808e+05, 3.6695e+05, 1.4826e+00,
         1.5045e+00, 3.9980e+05, 1.0799e+00, 3.9479e+05, 1.4765e+00, 0.0000e+00,
         3.7834e+05, 1.0702e+00, 1.0372e+00, 1.0349e+00],
        [3.7837e+05, 3.7838e+05, 7.5054e+05, 7.5648e+05, 7.4458e+05, 3.7839e+05,
         3.7838e+05, 7.6372e+05, 3.7836e+05, 7.9805e+05, 3.7836e+05, 3.7834e+05,
         0.0000e+00, 3.7835e+05, 3.7838e+05, 3.7834e+05],
        [1.3302e+00, 1.2679e+00, 3.8518e+05, 3.8808e+05, 3.6694e+05, 1.3476e+00,
         1.4266e+00, 3.9977e+05, 1.0433e+00, 3.9477e+05, 1.4182e+00, 1.0702e+00,
         3.7835e+05, 0.0000e+00, 1.0400e+00, 1.0453e+00],
        [1.3312e+00, 1.2751e+00, 3.8519e+05, 3.8806e+05, 3.6696e+05, 1.4202e+00,
         1.4274e+00, 3.9979e+05, 1.0808e+00, 3.9480e+05, 1.3975e+00, 1.0372e+00,
         3.7838e+05, 1.0400e+00, 0.0000e+00, 1.0343e+00],
        [1.5657e+00, 1.4445e+00, 3.8517e+05, 3.8804e+05, 3.6692e+05, 1.5827e+00,
         1.6559e+00, 3.9982e+05, 1.0282e+00, 3.9479e+05, 1.5852e+00, 1.0349e+00,
         3.7834e+05, 1.0453e+00, 1.0343e+00, 0.0000e+00]])
Krum scores: ['1.07', '1.02', '385185.97', '388061.53', '366947.41', '1.05', '1.07', '399805.56', '1.28', '394794.78', '1.05', '1.24', '378360.19', '1.20', '1.20', '1.29']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 9, 14, 15, 18, 12, 10, 16, 8, 19, 2, 7, 17, 3, 1, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:27...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 16:02:27, End: 2025-07-22 16:02:27)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 6, 19, 15, 9, 5, 7, 16, 1, 3, 8, 18, 20, 10, 4, 14], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3496e+00, 3.9799e+05, 3.8265e+05, 5.0808e-01, 6.6251e-01,
         1.2819e+00, 3.9501e+05, 1.2410e+00, 1.2744e+00, 1.3492e+00, 3.8795e+05,
         3.7782e+05, 5.0626e-01, 7.7334e-01, 3.9329e+05],
        [1.3496e+00, 0.0000e+00, 3.9800e+05, 3.8264e+05, 1.7787e+00, 1.2826e+00,
         9.5709e-01, 3.9501e+05, 9.5459e-01, 9.6934e-01, 9.3604e-01, 3.8799e+05,
         3.7782e+05, 1.4212e+00, 1.0781e+00, 3.9331e+05],
        [3.9799e+05, 3.9800e+05, 0.0000e+00, 7.8364e+05, 3.9798e+05, 3.9801e+05,
         3.9801e+05, 7.9199e+05, 3.9802e+05, 3.9799e+05, 3.9798e+05, 7.8604e+05,
         7.7567e+05, 3.9797e+05, 3.9801e+05, 7.9466e+05],
        [3.8265e+05, 3.8264e+05, 7.8364e+05, 0.0000e+00, 3.8266e+05, 3.8263e+05,
         3.8264e+05, 7.5009e+05, 3.8263e+05, 3.8263e+05, 3.8263e+05, 7.8591e+05,
         7.7397e+05, 3.8264e+05, 3.8264e+05, 7.7892e+05],
        [5.0808e-01, 1.7787e+00, 3.9798e+05, 3.8266e+05, 0.0000e+00, 8.2184e-01,
         1.6570e+00, 3.9500e+05, 1.5803e+00, 1.6190e+00, 1.6858e+00, 3.8794e+05,
         3.7784e+05, 5.8077e-01, 1.0111e+00, 3.9330e+05],
        [6.6251e-01, 1.2826e+00, 3.9801e+05, 3.8263e+05, 8.2184e-01, 0.0000e+00,
         1.1484e+00, 3.9502e+05, 1.1113e+00, 1.1381e+00, 1.2072e+00, 3.8794e+05,
         3.7779e+05, 6.8766e-01, 8.2957e-01, 3.9329e+05],
        [1.2819e+00, 9.5709e-01, 3.9801e+05, 3.8264e+05, 1.6570e+00, 1.1484e+00,
         0.0000e+00, 3.9501e+05, 9.8353e-01, 1.0160e+00, 9.9980e-01, 3.8797e+05,
         3.7781e+05, 1.2812e+00, 1.0020e+00, 3.9333e+05],
        [3.9501e+05, 3.9501e+05, 7.9199e+05, 7.5009e+05, 3.9500e+05, 3.9502e+05,
         3.9501e+05, 0.0000e+00, 3.9499e+05, 3.9501e+05, 3.9499e+05, 8.0098e+05,
         7.7380e+05, 3.9499e+05, 3.9497e+05, 7.9195e+05],
        [1.2410e+00, 9.5459e-01, 3.9802e+05, 3.8263e+05, 1.5803e+00, 1.1113e+00,
         9.8353e-01, 3.9499e+05, 0.0000e+00, 9.7260e-01, 9.9586e-01, 3.8797e+05,
         3.7782e+05, 1.2703e+00, 1.0120e+00, 3.9331e+05],
        [1.2744e+00, 9.6934e-01, 3.9799e+05, 3.8263e+05, 1.6190e+00, 1.1381e+00,
         1.0160e+00, 3.9501e+05, 9.7260e-01, 0.0000e+00, 9.6910e-01, 3.8797e+05,
         3.7780e+05, 1.2738e+00, 1.0510e+00, 3.9330e+05],
        [1.3492e+00, 9.3604e-01, 3.9798e+05, 3.8263e+05, 1.6858e+00, 1.2072e+00,
         9.9980e-01, 3.9499e+05, 9.9586e-01, 9.6910e-01, 0.0000e+00, 3.8797e+05,
         3.7783e+05, 1.3200e+00, 1.0514e+00, 3.9329e+05],
        [3.8795e+05, 3.8799e+05, 7.8604e+05, 7.8591e+05, 3.8794e+05, 3.8794e+05,
         3.8797e+05, 8.0098e+05, 3.8797e+05, 3.8797e+05, 3.8797e+05, 0.0000e+00,
         7.5841e+05, 3.8797e+05, 3.8796e+05, 7.8191e+05],
        [3.7782e+05, 3.7782e+05, 7.7567e+05, 7.7397e+05, 3.7784e+05, 3.7779e+05,
         3.7781e+05, 7.7380e+05, 3.7782e+05, 3.7780e+05, 3.7783e+05, 7.5841e+05,
         0.0000e+00, 3.7783e+05, 3.7783e+05, 7.8064e+05],
        [5.0626e-01, 1.4212e+00, 3.9797e+05, 3.8264e+05, 5.8077e-01, 6.8766e-01,
         1.2812e+00, 3.9499e+05, 1.2703e+00, 1.2738e+00, 1.3200e+00, 3.8797e+05,
         3.7783e+05, 0.0000e+00, 8.5648e-01, 3.9328e+05],
        [7.7334e-01, 1.0781e+00, 3.9801e+05, 3.8264e+05, 1.0111e+00, 8.2957e-01,
         1.0020e+00, 3.9497e+05, 1.0120e+00, 1.0510e+00, 1.0514e+00, 3.8796e+05,
         3.7783e+05, 8.5648e-01, 0.0000e+00, 3.9330e+05],
        [3.9329e+05, 3.9331e+05, 7.9466e+05, 7.7892e+05, 3.9330e+05, 3.9329e+05,
         3.9333e+05, 7.9195e+05, 3.9331e+05, 3.9330e+05, 3.9329e+05, 7.8191e+05,
         7.8064e+05, 3.9328e+05, 3.9330e+05, 0.0000e+00]])
Krum scores: ['0.95', '1.12', '397991.16', '382635.53', '1.18', '0.95', '1.08', '394997.28', '1.07', '1.08', '1.10', '387958.59', '377815.62', '0.97', '0.95', '393296.03']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [2, 6, 19, 15, 9, 5, 7, 16, 1, 3, 8, 18, 20, 10, 4, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:28...
global Accuracy on shared test data: 71.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:28, End: 2025-07-22 16:02:28)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 5, 14, 4, 19, 6, 13, 16, 10, 18, 1, 3, 20, 2, 17, 8], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.3942e-01, 3.6470e+05, 6.4670e-01, 3.9010e+05, 1.5056e+00,
         3.8151e+05, 3.9459e+05, 5.5367e-01, 3.9835e+05, 1.3331e+00, 1.3551e+00,
         3.7771e+05, 4.7313e-01, 3.9469e+05, 1.5361e+00],
        [7.3942e-01, 0.0000e+00, 3.6468e+05, 8.8457e-01, 3.9012e+05, 1.2909e+00,
         3.8150e+05, 3.9460e+05, 7.2013e-01, 3.9834e+05, 1.1172e+00, 1.1522e+00,
         3.7771e+05, 6.9927e-01, 3.9468e+05, 1.2910e+00],
        [3.6470e+05, 3.6468e+05, 0.0000e+00, 3.6466e+05, 7.5843e+05, 3.6469e+05,
         7.4392e+05, 7.6229e+05, 3.6470e+05, 7.6372e+05, 3.6471e+05, 3.6469e+05,
         7.5712e+05, 3.6469e+05, 7.6458e+05, 3.6470e+05],
        [6.4670e-01, 8.8457e-01, 3.6466e+05, 0.0000e+00, 3.9009e+05, 1.6038e+00,
         3.8150e+05, 3.9461e+05, 7.7617e-01, 3.9835e+05, 1.3790e+00, 1.4638e+00,
         3.7774e+05, 6.7449e-01, 3.9471e+05, 1.5623e+00],
        [3.9010e+05, 3.9012e+05, 7.5843e+05, 3.9009e+05, 0.0000e+00, 3.9007e+05,
         7.6002e+05, 8.0445e+05, 3.9012e+05, 8.1355e+05, 3.9008e+05, 3.9010e+05,
         7.6069e+05, 3.9011e+05, 7.8068e+05, 3.9011e+05],
        [1.5056e+00, 1.2909e+00, 3.6469e+05, 1.6038e+00, 3.9007e+05, 0.0000e+00,
         3.8149e+05, 3.9458e+05, 1.3561e+00, 3.9841e+05, 9.5039e-01, 9.6905e-01,
         3.7770e+05, 1.3071e+00, 3.9471e+05, 9.4351e-01],
        [3.8151e+05, 3.8150e+05, 7.4392e+05, 3.8150e+05, 7.6002e+05, 3.8149e+05,
         0.0000e+00, 7.8512e+05, 3.8149e+05, 7.6625e+05, 3.8149e+05, 3.8152e+05,
         7.6727e+05, 3.8150e+05, 7.7497e+05, 3.8149e+05],
        [3.9459e+05, 3.9460e+05, 7.6229e+05, 3.9461e+05, 8.0445e+05, 3.9458e+05,
         7.8512e+05, 0.0000e+00, 3.9458e+05, 7.9601e+05, 3.9458e+05, 3.9455e+05,
         7.6475e+05, 3.9457e+05, 8.1104e+05, 3.9455e+05],
        [5.5367e-01, 7.2013e-01, 3.6470e+05, 7.7617e-01, 3.9012e+05, 1.3561e+00,
         3.8149e+05, 3.9458e+05, 0.0000e+00, 3.9834e+05, 1.2071e+00, 1.2141e+00,
         3.7773e+05, 5.5669e-01, 3.9469e+05, 1.3563e+00],
        [3.9835e+05, 3.9834e+05, 7.6372e+05, 3.9835e+05, 8.1355e+05, 3.9841e+05,
         7.6625e+05, 7.9601e+05, 3.9834e+05, 0.0000e+00, 3.9839e+05, 3.9839e+05,
         7.6854e+05, 3.9836e+05, 7.7950e+05, 3.9838e+05],
        [1.3331e+00, 1.1172e+00, 3.6471e+05, 1.3790e+00, 3.9008e+05, 9.5039e-01,
         3.8149e+05, 3.9458e+05, 1.2071e+00, 3.9839e+05, 0.0000e+00, 9.4058e-01,
         3.7771e+05, 1.1799e+00, 3.9467e+05, 1.0067e+00],
        [1.3551e+00, 1.1522e+00, 3.6469e+05, 1.4638e+00, 3.9010e+05, 9.6905e-01,
         3.8152e+05, 3.9455e+05, 1.2141e+00, 3.9839e+05, 9.4058e-01, 0.0000e+00,
         3.7771e+05, 1.2275e+00, 3.9470e+05, 9.6519e-01],
        [3.7771e+05, 3.7771e+05, 7.5712e+05, 3.7774e+05, 7.6069e+05, 3.7770e+05,
         7.6727e+05, 7.6475e+05, 3.7773e+05, 7.6854e+05, 3.7771e+05, 3.7771e+05,
         0.0000e+00, 3.7771e+05, 7.7547e+05, 3.7771e+05],
        [4.7313e-01, 6.9927e-01, 3.6469e+05, 6.7449e-01, 3.9011e+05, 1.3071e+00,
         3.8150e+05, 3.9457e+05, 5.5669e-01, 3.9836e+05, 1.1799e+00, 1.2275e+00,
         3.7771e+05, 0.0000e+00, 3.9469e+05, 1.3850e+00],
        [3.9469e+05, 3.9468e+05, 7.6458e+05, 3.9471e+05, 7.8068e+05, 3.9471e+05,
         7.7497e+05, 8.1104e+05, 3.9469e+05, 7.7950e+05, 3.9467e+05, 3.9470e+05,
         7.7547e+05, 3.9469e+05, 0.0000e+00, 3.9472e+05],
        [1.5361e+00, 1.2910e+00, 3.6470e+05, 1.5623e+00, 3.9011e+05, 9.4351e-01,
         3.8149e+05, 3.9455e+05, 1.3563e+00, 3.9838e+05, 1.0067e+00, 9.6519e-01,
         3.7771e+05, 1.3850e+00, 3.9472e+05, 0.0000e+00]])
Krum scores: ['0.94', '0.94', '364687.75', '1.06', '390092.97', '1.19', '381494.00', '394572.50', '0.91', '398359.44', '1.11', '1.12', '377708.91', '0.87', '394689.25', '1.21']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 5, 14, 4, 19, 6, 13, 16, 10, 18, 1, 3, 20, 2, 17, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:28...
global Accuracy on shared test data: 72.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:28, End: 2025-07-22 16:02:28)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 14, 12, 8, 3, 1, 11, 17, 4, 15, 19, 7, 5, 20, 18, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9316e+05, 5.6663e-01, 1.5484e+00, 1.4310e+00, 1.3567e+00,
         1.5013e+00, 3.8789e+05, 5.3821e-01, 3.8591e+05, 3.9366e+05, 1.4605e+00,
         7.4089e-01, 3.7839e+05, 3.8778e+05, 1.5727e+00],
        [3.9316e+05, 0.0000e+00, 3.9317e+05, 3.9315e+05, 3.9315e+05, 3.9315e+05,
         3.9314e+05, 7.8696e+05, 3.9318e+05, 7.8080e+05, 7.6337e+05, 3.9315e+05,
         3.9317e+05, 7.8269e+05, 7.5431e+05, 3.9316e+05],
        [5.6663e-01, 3.9317e+05, 0.0000e+00, 1.1578e+00, 1.0383e+00, 1.0564e+00,
         1.1026e+00, 3.8792e+05, 5.6330e-01, 3.8591e+05, 3.9366e+05, 1.1456e+00,
         6.4190e-01, 3.7838e+05, 3.8779e+05, 1.1970e+00],
        [1.5484e+00, 3.9315e+05, 1.1578e+00, 0.0000e+00, 8.8042e-01, 9.3516e-01,
         9.1528e-01, 3.8793e+05, 1.1622e+00, 3.8593e+05, 3.9365e+05, 9.5618e-01,
         1.1081e+00, 3.7839e+05, 3.8781e+05, 9.0616e-01],
        [1.4310e+00, 3.9315e+05, 1.0383e+00, 8.8042e-01, 0.0000e+00, 8.9411e-01,
         9.1374e-01, 3.8794e+05, 1.1351e+00, 3.8595e+05, 3.9367e+05, 9.7154e-01,
         1.0236e+00, 3.7837e+05, 3.8779e+05, 9.4786e-01],
        [1.3567e+00, 3.9315e+05, 1.0564e+00, 9.3516e-01, 8.9411e-01, 0.0000e+00,
         8.9556e-01, 3.8793e+05, 1.0499e+00, 3.8597e+05, 3.9367e+05, 9.2159e-01,
         9.8867e-01, 3.7835e+05, 3.8779e+05, 9.3607e-01],
        [1.5013e+00, 3.9314e+05, 1.1026e+00, 9.1528e-01, 9.1374e-01, 8.9556e-01,
         0.0000e+00, 3.8794e+05, 1.1506e+00, 3.8594e+05, 3.9366e+05, 9.3180e-01,
         1.0258e+00, 3.7835e+05, 3.8780e+05, 9.7496e-01],
        [3.8789e+05, 7.8696e+05, 3.8792e+05, 3.8793e+05, 3.8794e+05, 3.8793e+05,
         3.8794e+05, 0.0000e+00, 3.8792e+05, 7.9809e+05, 7.7902e+05, 3.8794e+05,
         3.8793e+05, 7.8421e+05, 7.8494e+05, 3.8794e+05],
        [5.3821e-01, 3.9318e+05, 5.6330e-01, 1.1622e+00, 1.1351e+00, 1.0499e+00,
         1.1506e+00, 3.8792e+05, 0.0000e+00, 3.8591e+05, 3.9365e+05, 1.1308e+00,
         6.9521e-01, 3.7838e+05, 3.8777e+05, 1.2395e+00],
        [3.8591e+05, 7.8080e+05, 3.8591e+05, 3.8593e+05, 3.8595e+05, 3.8597e+05,
         3.8594e+05, 7.9809e+05, 3.8591e+05, 0.0000e+00, 7.7722e+05, 3.8592e+05,
         3.8591e+05, 7.7683e+05, 7.8547e+05, 3.8595e+05],
        [3.9366e+05, 7.6337e+05, 3.9366e+05, 3.9365e+05, 3.9367e+05, 3.9367e+05,
         3.9366e+05, 7.7902e+05, 3.9365e+05, 7.7722e+05, 0.0000e+00, 3.9369e+05,
         3.9368e+05, 7.7299e+05, 7.7815e+05, 3.9367e+05],
        [1.4605e+00, 3.9315e+05, 1.1456e+00, 9.5618e-01, 9.7154e-01, 9.2159e-01,
         9.3180e-01, 3.8794e+05, 1.1308e+00, 3.8592e+05, 3.9369e+05, 0.0000e+00,
         1.0564e+00, 3.7837e+05, 3.8778e+05, 9.6037e-01],
        [7.4089e-01, 3.9317e+05, 6.4190e-01, 1.1081e+00, 1.0236e+00, 9.8867e-01,
         1.0258e+00, 3.8793e+05, 6.9521e-01, 3.8591e+05, 3.9368e+05, 1.0564e+00,
         0.0000e+00, 3.7838e+05, 3.8778e+05, 1.1635e+00],
        [3.7839e+05, 7.8269e+05, 3.7838e+05, 3.7839e+05, 3.7837e+05, 3.7835e+05,
         3.7835e+05, 7.8421e+05, 3.7838e+05, 7.7683e+05, 7.7299e+05, 3.7837e+05,
         3.7838e+05, 0.0000e+00, 7.6940e+05, 3.7840e+05],
        [3.8778e+05, 7.5431e+05, 3.8779e+05, 3.8781e+05, 3.8779e+05, 3.8779e+05,
         3.8780e+05, 7.8494e+05, 3.8777e+05, 7.8547e+05, 7.7815e+05, 3.8778e+05,
         3.8778e+05, 7.6940e+05, 0.0000e+00, 3.8779e+05],
        [1.5727e+00, 3.9316e+05, 1.1970e+00, 9.0616e-01, 9.4786e-01, 9.3607e-01,
         9.7496e-01, 3.8794e+05, 1.2395e+00, 3.8595e+05, 3.9367e+05, 9.6037e-01,
         1.1635e+00, 3.7840e+05, 3.8779e+05, 0.0000e+00]])
Krum scores: ['1.14', '393153.69', '0.91', '1.00', '0.98', '0.96', '0.99', '387925.28', '0.93', '385924.53', '393661.94', '1.01', '0.91', '378372.34', '387783.41', '1.04']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 14, 12, 8, 3, 1, 11, 17, 4, 15, 19, 7, 5, 20, 18, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:29...
global Accuracy on shared test data: 71.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:29, End: 2025-07-22 16:02:29)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 9, 11, 4, 17, 14, 3, 5, 20, 16, 13, 19, 6, 10, 2, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.0904e+00, 8.9321e-01, 1.0022e+00, 4.0133e+05, 3.8422e+05,
         9.0524e-01, 9.9852e-01, 3.7561e+05, 3.9869e+05, 3.6629e+05, 3.8006e+05,
         9.1227e-01, 1.1136e+00, 1.1777e+00, 9.0648e-01],
        [1.0904e+00, 0.0000e+00, 1.1601e+00, 4.8140e-01, 4.0134e+05, 3.8418e+05,
         1.0594e+00, 6.0643e-01, 3.7562e+05, 3.9866e+05, 3.6629e+05, 3.8007e+05,
         1.1772e+00, 4.8667e-01, 3.1618e-01, 1.1524e+00],
        [8.9321e-01, 1.1601e+00, 0.0000e+00, 1.0948e+00, 4.0136e+05, 3.8419e+05,
         9.4923e-01, 1.0268e+00, 3.7560e+05, 3.9872e+05, 3.6631e+05, 3.8006e+05,
         9.4711e-01, 1.1087e+00, 1.2790e+00, 9.0829e-01],
        [1.0022e+00, 4.8140e-01, 1.0948e+00, 0.0000e+00, 4.0135e+05, 3.8419e+05,
         1.0201e+00, 6.5181e-01, 3.7562e+05, 3.9868e+05, 3.6631e+05, 3.8008e+05,
         1.1067e+00, 6.2825e-01, 4.5670e-01, 1.0372e+00],
        [4.0133e+05, 4.0134e+05, 4.0136e+05, 4.0135e+05, 0.0000e+00, 7.9022e+05,
         4.0136e+05, 4.0136e+05, 7.9132e+05, 8.1335e+05, 7.5050e+05, 7.5649e+05,
         4.0134e+05, 4.0134e+05, 4.0134e+05, 4.0136e+05],
        [3.8422e+05, 3.8418e+05, 3.8419e+05, 3.8419e+05, 7.9022e+05, 0.0000e+00,
         3.8422e+05, 3.8420e+05, 7.5298e+05, 7.9128e+05, 7.4392e+05, 7.5616e+05,
         3.8417e+05, 3.8419e+05, 3.8418e+05, 3.8419e+05],
        [9.0524e-01, 1.0594e+00, 9.4923e-01, 1.0201e+00, 4.0136e+05, 3.8422e+05,
         0.0000e+00, 1.0033e+00, 3.7563e+05, 3.9870e+05, 3.6630e+05, 3.8006e+05,
         9.4683e-01, 1.0640e+00, 1.1459e+00, 8.8684e-01],
        [9.9852e-01, 6.0643e-01, 1.0268e+00, 6.5181e-01, 4.0136e+05, 3.8420e+05,
         1.0033e+00, 0.0000e+00, 3.7561e+05, 3.9867e+05, 3.6630e+05, 3.8007e+05,
         1.0933e+00, 6.6920e-01, 5.8254e-01, 1.0760e+00],
        [3.7561e+05, 3.7562e+05, 3.7560e+05, 3.7562e+05, 7.9132e+05, 7.5298e+05,
         3.7563e+05, 3.7561e+05, 0.0000e+00, 7.7748e+05, 7.3958e+05, 7.6956e+05,
         3.7560e+05, 3.7561e+05, 3.7562e+05, 3.7562e+05],
        [3.9869e+05, 3.9866e+05, 3.9872e+05, 3.9868e+05, 8.1335e+05, 7.9128e+05,
         3.9870e+05, 3.9867e+05, 7.7748e+05, 0.0000e+00, 7.9622e+05, 7.5958e+05,
         3.9871e+05, 3.9866e+05, 3.9868e+05, 3.9872e+05],
        [3.6629e+05, 3.6629e+05, 3.6631e+05, 3.6631e+05, 7.5050e+05, 7.4392e+05,
         3.6630e+05, 3.6630e+05, 7.3958e+05, 7.9622e+05, 0.0000e+00, 7.5877e+05,
         3.6629e+05, 3.6629e+05, 3.6628e+05, 3.6632e+05],
        [3.8006e+05, 3.8007e+05, 3.8006e+05, 3.8008e+05, 7.5649e+05, 7.5616e+05,
         3.8006e+05, 3.8007e+05, 7.6956e+05, 7.5958e+05, 7.5877e+05, 0.0000e+00,
         3.8008e+05, 3.8005e+05, 3.8006e+05, 3.8010e+05],
        [9.1227e-01, 1.1772e+00, 9.4711e-01, 1.1067e+00, 4.0134e+05, 3.8417e+05,
         9.4683e-01, 1.0933e+00, 3.7560e+05, 3.9871e+05, 3.6629e+05, 3.8008e+05,
         0.0000e+00, 1.1923e+00, 1.2569e+00, 8.7219e-01],
        [1.1136e+00, 4.8667e-01, 1.1087e+00, 6.2825e-01, 4.0134e+05, 3.8419e+05,
         1.0640e+00, 6.6920e-01, 3.7561e+05, 3.9866e+05, 3.6629e+05, 3.8005e+05,
         1.1923e+00, 0.0000e+00, 4.5939e-01, 1.1405e+00],
        [1.1777e+00, 3.1618e-01, 1.2790e+00, 4.5670e-01, 4.0134e+05, 3.8418e+05,
         1.1459e+00, 5.8254e-01, 3.7562e+05, 3.9868e+05, 3.6628e+05, 3.8006e+05,
         1.2569e+00, 4.5939e-01, 0.0000e+00, 1.2516e+00],
        [9.0648e-01, 1.1524e+00, 9.0829e-01, 1.0372e+00, 4.0136e+05, 3.8419e+05,
         8.8684e-01, 1.0760e+00, 3.7562e+05, 3.9872e+05, 3.6632e+05, 3.8010e+05,
         8.7219e-01, 1.1405e+00, 1.2516e+00, 0.0000e+00]])
Krum scores: ['0.98', '0.79', '1.01', '0.80', '401345.00', '384186.03', '0.98', '0.83', '375609.50', '398681.72', '366293.31', '380063.50', '1.03', '0.83', '0.83', '1.00']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 9, 11, 4, 17, 14, 3, 5, 20, 16, 13, 19, 6, 10, 2, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0200s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:29...
global Accuracy on shared test data: 72.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[161  76]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:29, End: 2025-07-22 16:02:29)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 17, 20, 9, 11, 10, 18, 3, 2, 4, 12, 7, 19, 1, 6, 8], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 8.0160e+05, 7.8878e+05, 3.9498e+05, 3.9497e+05, 3.9499e+05,
         7.7408e+05, 3.9499e+05, 3.9497e+05, 3.9499e+05, 3.9496e+05, 3.9495e+05,
         7.9332e+05, 3.9494e+05, 3.9495e+05, 3.9498e+05],
        [8.0160e+05, 0.0000e+00, 7.6782e+05, 3.9084e+05, 3.9079e+05, 3.9083e+05,
         7.8718e+05, 3.9080e+05, 3.9082e+05, 3.9082e+05, 3.9083e+05, 3.9080e+05,
         7.6959e+05, 3.9083e+05, 3.9083e+05, 3.9082e+05],
        [7.8878e+05, 7.6782e+05, 0.0000e+00, 3.8357e+05, 3.8353e+05, 3.8358e+05,
         7.6472e+05, 3.8355e+05, 3.8356e+05, 3.8354e+05, 3.8357e+05, 3.8353e+05,
         7.6555e+05, 3.8358e+05, 3.8355e+05, 3.8355e+05],
        [3.9498e+05, 3.9084e+05, 3.8357e+05, 0.0000e+00, 1.4102e+00, 5.5828e-01,
         3.9144e+05, 1.3512e+00, 3.1750e-01, 6.1713e-01, 3.6160e-01, 1.5060e+00,
         3.8713e+05, 1.4035e+00, 1.4861e+00, 1.5279e+00],
        [3.9497e+05, 3.9079e+05, 3.8353e+05, 1.4102e+00, 0.0000e+00, 9.8940e-01,
         3.9150e+05, 8.8433e-01, 1.0920e+00, 9.8923e-01, 1.1358e+00, 8.9594e-01,
         3.8713e+05, 8.4356e-01, 8.8828e-01, 9.1044e-01],
        [3.9499e+05, 3.9083e+05, 3.8358e+05, 5.5828e-01, 9.8940e-01, 0.0000e+00,
         3.9145e+05, 9.8764e-01, 4.0133e-01, 5.9409e-01, 4.4803e-01, 1.0830e+00,
         3.8714e+05, 1.0211e+00, 1.0810e+00, 1.1027e+00],
        [7.7408e+05, 7.8718e+05, 7.6472e+05, 3.9144e+05, 3.9150e+05, 3.9145e+05,
         0.0000e+00, 3.9148e+05, 3.9145e+05, 3.9147e+05, 3.9146e+05, 3.9149e+05,
         7.8246e+05, 3.9148e+05, 3.9150e+05, 3.9147e+05],
        [3.9499e+05, 3.9080e+05, 3.8355e+05, 1.3512e+00, 8.8433e-01, 9.8764e-01,
         3.9148e+05, 0.0000e+00, 1.0292e+00, 9.7728e-01, 1.0726e+00, 9.3821e-01,
         3.8714e+05, 8.5270e-01, 8.9515e-01, 8.8350e-01],
        [3.9497e+05, 3.9082e+05, 3.8356e+05, 3.1750e-01, 1.0920e+00, 4.0133e-01,
         3.9145e+05, 1.0292e+00, 0.0000e+00, 4.2605e-01, 2.8687e-01, 1.1453e+00,
         3.8714e+05, 1.0486e+00, 1.0973e+00, 1.1619e+00],
        [3.9499e+05, 3.9082e+05, 3.8354e+05, 6.1713e-01, 9.8923e-01, 5.9409e-01,
         3.9147e+05, 9.7728e-01, 4.2605e-01, 0.0000e+00, 4.8564e-01, 1.0396e+00,
         3.8713e+05, 9.5547e-01, 1.0255e+00, 1.0347e+00],
        [3.9496e+05, 3.9083e+05, 3.8357e+05, 3.6160e-01, 1.1358e+00, 4.4803e-01,
         3.9146e+05, 1.0726e+00, 2.8687e-01, 4.8564e-01, 0.0000e+00, 1.2434e+00,
         3.8713e+05, 1.1524e+00, 1.1989e+00, 1.2260e+00],
        [3.9495e+05, 3.9080e+05, 3.8353e+05, 1.5060e+00, 8.9594e-01, 1.0830e+00,
         3.9149e+05, 9.3821e-01, 1.1453e+00, 1.0396e+00, 1.2434e+00, 0.0000e+00,
         3.8711e+05, 9.0272e-01, 9.1160e-01, 9.4843e-01],
        [7.9332e+05, 7.6959e+05, 7.6555e+05, 3.8713e+05, 3.8713e+05, 3.8714e+05,
         7.8246e+05, 3.8714e+05, 3.8714e+05, 3.8713e+05, 3.8713e+05, 3.8711e+05,
         0.0000e+00, 3.8714e+05, 3.8711e+05, 3.8712e+05],
        [3.9494e+05, 3.9083e+05, 3.8358e+05, 1.4035e+00, 8.4356e-01, 1.0211e+00,
         3.9148e+05, 8.5270e-01, 1.0486e+00, 9.5547e-01, 1.1524e+00, 9.0272e-01,
         3.8714e+05, 0.0000e+00, 8.7276e-01, 9.1556e-01],
        [3.9495e+05, 3.9083e+05, 3.8355e+05, 1.4861e+00, 8.8828e-01, 1.0810e+00,
         3.9150e+05, 8.9515e-01, 1.0973e+00, 1.0255e+00, 1.1989e+00, 9.1160e-01,
         3.8711e+05, 8.7276e-01, 0.0000e+00, 8.5998e-01],
        [3.9498e+05, 3.9082e+05, 3.8355e+05, 1.5279e+00, 9.1044e-01, 1.1027e+00,
         3.9147e+05, 8.8350e-01, 1.1619e+00, 1.0347e+00, 1.2260e+00, 9.4843e-01,
         3.8712e+05, 9.1556e-01, 8.5998e-01, 0.0000e+00]])
Krum scores: ['394963.94', '390816.19', '383548.12', '1.00', '0.96', '0.80', '391465.00', '0.95', '0.76', '0.79', '0.82', '1.01', '387127.38', '0.95', '0.98', '1.00']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 17, 20, 9, 11, 10, 18, 3, 2, 4, 12, 7, 19, 1, 6, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:30...
global Accuracy on shared test data: 73.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:30, End: 2025-07-22 16:02:30)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 3, 20, 2, 9, 7, 5, 10, 19, 8, 12, 4, 11, 6, 14, 18], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8373e+05, 7.8732e+05, 3.8370e+05, 3.8371e+05, 3.8372e+05,
         3.8370e+05, 3.8372e+05, 7.6050e+05, 3.8372e+05, 3.8369e+05, 3.8370e+05,
         3.8372e+05, 3.8373e+05, 7.5606e+05, 7.8059e+05],
        [3.8373e+05, 0.0000e+00, 3.9293e+05, 1.1579e+00, 1.0736e+00, 9.1109e-01,
         9.1348e-01, 9.6406e-01, 3.7987e+05, 8.6862e-01, 9.8923e-01, 9.3433e-01,
         8.8510e-01, 8.6352e-01, 3.8376e+05, 3.8722e+05],
        [7.8732e+05, 3.9293e+05, 0.0000e+00, 3.9291e+05, 3.9293e+05, 3.9294e+05,
         3.9295e+05, 3.9291e+05, 7.8268e+05, 3.9294e+05, 3.9291e+05, 3.9291e+05,
         3.9292e+05, 3.9293e+05, 7.9242e+05, 7.7842e+05],
        [3.8370e+05, 1.1579e+00, 3.9291e+05, 0.0000e+00, 2.5439e-01, 1.2244e+00,
         6.6035e-01, 4.4046e-01, 3.7986e+05, 1.2409e+00, 3.1521e-01, 5.1163e-01,
         1.2573e+00, 1.2582e+00, 3.8375e+05, 3.8721e+05],
        [3.8371e+05, 1.0736e+00, 3.9293e+05, 2.5439e-01, 0.0000e+00, 1.1500e+00,
         6.2056e-01, 3.9799e-01, 3.7986e+05, 1.1559e+00, 2.6176e-01, 4.5873e-01,
         1.1694e+00, 1.1652e+00, 3.8374e+05, 3.8721e+05],
        [3.8372e+05, 9.1109e-01, 3.9294e+05, 1.2244e+00, 1.1500e+00, 0.0000e+00,
         9.3139e-01, 9.9662e-01, 3.7983e+05, 9.0761e-01, 1.0926e+00, 9.3336e-01,
         8.9897e-01, 8.7754e-01, 3.8375e+05, 3.8722e+05],
        [3.8370e+05, 9.1348e-01, 3.9295e+05, 6.6035e-01, 6.2056e-01, 9.3139e-01,
         0.0000e+00, 6.1206e-01, 3.7986e+05, 9.7088e-01, 5.6935e-01, 6.3320e-01,
         9.2082e-01, 9.7383e-01, 3.8374e+05, 3.8722e+05],
        [3.8372e+05, 9.6406e-01, 3.9291e+05, 4.4046e-01, 3.9799e-01, 9.9662e-01,
         6.1206e-01, 0.0000e+00, 3.7987e+05, 1.0081e+00, 3.9824e-01, 5.6043e-01,
         9.8821e-01, 1.0341e+00, 3.8373e+05, 3.8720e+05],
        [7.6050e+05, 3.7987e+05, 7.8268e+05, 3.7986e+05, 3.7986e+05, 3.7983e+05,
         3.7986e+05, 3.7987e+05, 0.0000e+00, 3.7985e+05, 3.7986e+05, 3.7984e+05,
         3.7987e+05, 3.7985e+05, 7.5320e+05, 7.6034e+05],
        [3.8372e+05, 8.6862e-01, 3.9294e+05, 1.2409e+00, 1.1559e+00, 9.0761e-01,
         9.7088e-01, 1.0081e+00, 3.7985e+05, 0.0000e+00, 1.0898e+00, 9.5273e-01,
         8.9876e-01, 8.2083e-01, 3.8376e+05, 3.8721e+05],
        [3.8369e+05, 9.8923e-01, 3.9291e+05, 3.1521e-01, 2.6176e-01, 1.0926e+00,
         5.6935e-01, 3.9824e-01, 3.7986e+05, 1.0898e+00, 0.0000e+00, 4.4083e-01,
         1.0799e+00, 1.0981e+00, 3.8373e+05, 3.8721e+05],
        [3.8370e+05, 9.3433e-01, 3.9291e+05, 5.1163e-01, 4.5873e-01, 9.3336e-01,
         6.3320e-01, 5.6043e-01, 3.7984e+05, 9.5273e-01, 4.4083e-01, 0.0000e+00,
         9.8031e-01, 9.7069e-01, 3.8375e+05, 3.8722e+05],
        [3.8372e+05, 8.8510e-01, 3.9292e+05, 1.2573e+00, 1.1694e+00, 8.9897e-01,
         9.2082e-01, 9.8821e-01, 3.7987e+05, 8.9876e-01, 1.0799e+00, 9.8031e-01,
         0.0000e+00, 8.7513e-01, 3.8377e+05, 3.8723e+05],
        [3.8373e+05, 8.6352e-01, 3.9293e+05, 1.2582e+00, 1.1652e+00, 8.7754e-01,
         9.7383e-01, 1.0341e+00, 3.7985e+05, 8.2083e-01, 1.0981e+00, 9.7069e-01,
         8.7513e-01, 0.0000e+00, 3.8376e+05, 3.8723e+05],
        [7.5606e+05, 3.8376e+05, 7.9242e+05, 3.8375e+05, 3.8374e+05, 3.8375e+05,
         3.8374e+05, 3.8373e+05, 7.5320e+05, 3.8376e+05, 3.8373e+05, 3.8375e+05,
         3.8377e+05, 3.8376e+05, 0.0000e+00, 7.7560e+05],
        [7.8059e+05, 3.8722e+05, 7.7842e+05, 3.8721e+05, 3.8721e+05, 3.8722e+05,
         3.8722e+05, 3.8720e+05, 7.6034e+05, 3.8721e+05, 3.8721e+05, 3.8722e+05,
         3.8723e+05, 3.8723e+05, 7.7560e+05, 0.0000e+00]])
Krum scores: ['383709.22', '0.93', '392921.38', '0.78', '0.73', '0.97', '0.76', '0.71', '379853.25', '0.96', '0.69', '0.71', '0.97', '0.96', '383745.62', '387212.31']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 3, 20, 2, 9, 7, 5, 10, 19, 8, 12, 4, 11, 6, 14, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:31...
global Accuracy on shared test data: 72.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:31, End: 2025-07-22 16:02:31)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 14, 12, 7, 10, 9, 20, 2, 5, 6, 19, 8, 4, 13, 16, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9593e+05, 1.2465e+00, 8.9178e-01, 9.0651e-01, 9.3296e-01,
         3.9065e+05, 9.3939e-01, 8.9072e-01, 8.6434e-01, 3.7977e+05, 8.4045e-01,
         8.7300e-01, 4.0107e+05, 3.9514e+05, 3.8641e+05],
        [3.9593e+05, 0.0000e+00, 3.9595e+05, 3.9594e+05, 3.9596e+05, 3.9596e+05,
         7.7457e+05, 3.9595e+05, 3.9597e+05, 3.9593e+05, 7.8853e+05, 3.9594e+05,
         3.9595e+05, 8.0381e+05, 7.9104e+05, 7.8300e+05],
        [1.2465e+00, 3.9595e+05, 0.0000e+00, 1.4042e+00, 6.0859e-01, 3.7141e-01,
         3.9069e+05, 3.5658e-01, 7.7078e-01, 1.4396e+00, 3.7977e+05, 1.4231e+00,
         6.6101e-01, 4.0106e+05, 3.9513e+05, 3.8646e+05],
        [8.9178e-01, 3.9594e+05, 1.4042e+00, 0.0000e+00, 9.4904e-01, 1.0321e+00,
         3.9071e+05, 1.0044e+00, 9.2741e-01, 8.8073e-01, 3.7977e+05, 9.0496e-01,
         8.8855e-01, 4.0110e+05, 3.9515e+05, 3.8645e+05],
        [9.0651e-01, 3.9596e+05, 6.0859e-01, 9.4904e-01, 0.0000e+00, 3.8806e-01,
         3.9070e+05, 3.6312e-01, 6.0219e-01, 1.0053e+00, 3.7975e+05, 9.8577e-01,
         5.5240e-01, 4.0107e+05, 3.9513e+05, 3.8645e+05],
        [9.3296e-01, 3.9596e+05, 3.7141e-01, 1.0321e+00, 3.8806e-01, 0.0000e+00,
         3.9069e+05, 1.6242e-01, 5.4766e-01, 1.0753e+00, 3.7975e+05, 1.0747e+00,
         4.0535e-01, 4.0108e+05, 3.9513e+05, 3.8644e+05],
        [3.9065e+05, 7.7457e+05, 3.9069e+05, 3.9071e+05, 3.9070e+05, 3.9069e+05,
         0.0000e+00, 3.9070e+05, 3.9070e+05, 3.9072e+05, 7.4798e+05, 3.9071e+05,
         3.9071e+05, 7.6452e+05, 7.9529e+05, 7.9136e+05],
        [9.3939e-01, 3.9595e+05, 3.5658e-01, 1.0044e+00, 3.6312e-01, 1.6242e-01,
         3.9070e+05, 0.0000e+00, 5.0210e-01, 1.0398e+00, 3.7976e+05, 1.0532e+00,
         3.9180e-01, 4.0108e+05, 3.9512e+05, 3.8644e+05],
        [8.9072e-01, 3.9597e+05, 7.7078e-01, 9.2741e-01, 6.0219e-01, 5.4766e-01,
         3.9070e+05, 5.0210e-01, 0.0000e+00, 9.7740e-01, 3.7980e+05, 9.8446e-01,
         6.0108e-01, 4.0106e+05, 3.9514e+05, 3.8645e+05],
        [8.6434e-01, 3.9593e+05, 1.4396e+00, 8.8073e-01, 1.0053e+00, 1.0753e+00,
         3.9072e+05, 1.0398e+00, 9.7740e-01, 0.0000e+00, 3.7977e+05, 8.2604e-01,
         9.4712e-01, 4.0107e+05, 3.9512e+05, 3.8645e+05],
        [3.7977e+05, 7.8853e+05, 3.7977e+05, 3.7977e+05, 3.7975e+05, 3.7975e+05,
         7.4798e+05, 3.7976e+05, 3.7980e+05, 3.7977e+05, 0.0000e+00, 3.7976e+05,
         3.7977e+05, 7.7814e+05, 7.7473e+05, 7.6176e+05],
        [8.4045e-01, 3.9594e+05, 1.4231e+00, 9.0496e-01, 9.8577e-01, 1.0747e+00,
         3.9071e+05, 1.0532e+00, 9.8446e-01, 8.2604e-01, 3.7976e+05, 0.0000e+00,
         9.1491e-01, 4.0107e+05, 3.9515e+05, 3.8645e+05],
        [8.7300e-01, 3.9595e+05, 6.6101e-01, 8.8855e-01, 5.5240e-01, 4.0535e-01,
         3.9071e+05, 3.9180e-01, 6.0108e-01, 9.4712e-01, 3.7977e+05, 9.1491e-01,
         0.0000e+00, 4.0108e+05, 3.9513e+05, 3.8643e+05],
        [4.0107e+05, 8.0381e+05, 4.0106e+05, 4.0110e+05, 4.0107e+05, 4.0108e+05,
         7.6452e+05, 4.0108e+05, 4.0106e+05, 4.0107e+05, 7.7814e+05, 4.0107e+05,
         4.0108e+05, 0.0000e+00, 8.2373e+05, 8.0880e+05],
        [3.9514e+05, 7.9104e+05, 3.9513e+05, 3.9515e+05, 3.9513e+05, 3.9513e+05,
         7.9529e+05, 3.9512e+05, 3.9514e+05, 3.9512e+05, 7.7473e+05, 3.9515e+05,
         3.9513e+05, 8.2373e+05, 0.0000e+00, 8.0239e+05],
        [3.8641e+05, 7.8300e+05, 3.8646e+05, 3.8645e+05, 3.8645e+05, 3.8644e+05,
         7.9136e+05, 3.8644e+05, 3.8645e+05, 3.8645e+05, 7.6176e+05, 3.8645e+05,
         3.8643e+05, 8.0880e+05, 8.0239e+05, 0.0000e+00]])
Krum scores: ['0.89', '395944.62', '0.86', '0.93', '0.67', '0.61', '390692.91', '0.59', '0.73', '0.95', '379763.34', '0.95', '0.66', '401070.28', '395129.91', '386438.22']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 14, 12, 7, 10, 9, 20, 2, 5, 6, 19, 8, 4, 13, 16, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:31...
global Accuracy on shared test data: 72.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:31, End: 2025-07-22 16:02:31)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 16, 5, 19, 7, 3, 10, 17, 18, 11, 13, 20, 1, 6, 4, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7810e+05, 7.4324e-01, 3.8445e+05, 1.2642e+00, 1.2054e+00,
         5.9507e-01, 3.9180e+05, 3.9561e+05, 1.2641e+00, 4.0851e+05, 3.8085e+05,
         1.2443e+00, 1.2839e+00, 6.4578e-01, 3.9337e+05],
        [3.7810e+05, 0.0000e+00, 3.7811e+05, 7.7398e+05, 3.7812e+05, 3.7812e+05,
         3.7811e+05, 7.7900e+05, 7.6467e+05, 3.7812e+05, 7.8968e+05, 7.3351e+05,
         3.7813e+05, 3.7811e+05, 3.7809e+05, 7.7771e+05],
        [7.4324e-01, 3.7811e+05, 0.0000e+00, 3.8443e+05, 9.3172e-01, 9.1169e-01,
         5.9106e-01, 3.9182e+05, 3.9561e+05, 8.8763e-01, 4.0850e+05, 3.8086e+05,
         9.0147e-01, 9.6471e-01, 6.0863e-01, 3.9336e+05],
        [3.8445e+05, 7.7398e+05, 3.8443e+05, 0.0000e+00, 3.8446e+05, 3.8446e+05,
         3.8444e+05, 7.6112e+05, 7.7672e+05, 3.8448e+05, 7.9633e+05, 7.7853e+05,
         3.8445e+05, 3.8445e+05, 3.8446e+05, 7.7965e+05],
        [1.2642e+00, 3.7812e+05, 9.3172e-01, 3.8446e+05, 0.0000e+00, 8.8925e-01,
         9.4052e-01, 3.9185e+05, 3.9562e+05, 8.5578e-01, 4.0849e+05, 3.8086e+05,
         8.5605e-01, 8.7061e-01, 8.8120e-01, 3.9338e+05],
        [1.2054e+00, 3.7812e+05, 9.1169e-01, 3.8446e+05, 8.8925e-01, 0.0000e+00,
         9.2979e-01, 3.9183e+05, 3.9562e+05, 8.5098e-01, 4.0850e+05, 3.8086e+05,
         8.6229e-01, 8.6694e-01, 8.9324e-01, 3.9338e+05],
        [5.9507e-01, 3.7811e+05, 5.9106e-01, 3.8444e+05, 9.4052e-01, 9.2979e-01,
         0.0000e+00, 3.9183e+05, 3.9562e+05, 9.0708e-01, 4.0850e+05, 3.8086e+05,
         9.4824e-01, 9.7667e-01, 5.4317e-01, 3.9335e+05],
        [3.9180e+05, 7.7900e+05, 3.9182e+05, 7.6112e+05, 3.9185e+05, 3.9183e+05,
         3.9183e+05, 0.0000e+00, 7.8063e+05, 3.9185e+05, 7.8331e+05, 7.5870e+05,
         3.9184e+05, 3.9185e+05, 3.9180e+05, 7.6139e+05],
        [3.9561e+05, 7.6467e+05, 3.9561e+05, 7.7672e+05, 3.9562e+05, 3.9562e+05,
         3.9562e+05, 7.8063e+05, 0.0000e+00, 3.9560e+05, 7.8195e+05, 7.6139e+05,
         3.9563e+05, 3.9562e+05, 3.9561e+05, 7.6791e+05],
        [1.2641e+00, 3.7812e+05, 8.8763e-01, 3.8448e+05, 8.5578e-01, 8.5098e-01,
         9.0708e-01, 3.9185e+05, 3.9560e+05, 0.0000e+00, 4.0848e+05, 3.8088e+05,
         8.1717e-01, 8.3271e-01, 9.0322e-01, 3.9336e+05],
        [4.0851e+05, 7.8968e+05, 4.0850e+05, 7.9633e+05, 4.0849e+05, 4.0850e+05,
         4.0850e+05, 7.8331e+05, 7.8195e+05, 4.0848e+05, 0.0000e+00, 8.1040e+05,
         4.0852e+05, 4.0849e+05, 4.0850e+05, 7.7511e+05],
        [3.8085e+05, 7.3351e+05, 3.8086e+05, 7.7853e+05, 3.8086e+05, 3.8086e+05,
         3.8086e+05, 7.5870e+05, 7.6139e+05, 3.8088e+05, 8.1040e+05, 0.0000e+00,
         3.8085e+05, 3.8085e+05, 3.8084e+05, 7.8429e+05],
        [1.2443e+00, 3.7813e+05, 9.0147e-01, 3.8445e+05, 8.5605e-01, 8.6229e-01,
         9.4824e-01, 3.9184e+05, 3.9563e+05, 8.1717e-01, 4.0852e+05, 3.8085e+05,
         0.0000e+00, 8.6831e-01, 8.5944e-01, 3.9337e+05],
        [1.2839e+00, 3.7811e+05, 9.6471e-01, 3.8445e+05, 8.7061e-01, 8.6694e-01,
         9.7667e-01, 3.9185e+05, 3.9562e+05, 8.3271e-01, 4.0849e+05, 3.8085e+05,
         8.6831e-01, 0.0000e+00, 9.1300e-01, 3.9335e+05],
        [6.4578e-01, 3.7809e+05, 6.0863e-01, 3.8446e+05, 8.8120e-01, 8.9324e-01,
         5.4317e-01, 3.9180e+05, 3.9561e+05, 9.0322e-01, 4.0850e+05, 3.8084e+05,
         8.5944e-01, 9.1300e-01, 0.0000e+00, 3.9335e+05],
        [3.9337e+05, 7.7771e+05, 3.9336e+05, 7.7965e+05, 3.9338e+05, 3.9338e+05,
         3.9335e+05, 7.6139e+05, 7.6791e+05, 3.9336e+05, 7.7511e+05, 7.8429e+05,
         3.9337e+05, 3.9335e+05, 3.9335e+05, 0.0000e+00]])
Krum scores: ['0.99', '378109.41', '0.80', '384447.03', '0.89', '0.89', '0.78', '391823.25', '395614.34', '0.86', '408496.19', '380851.28', '0.87', '0.90', '0.76', '393356.66']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [2, 16, 5, 19, 7, 3, 10, 17, 18, 11, 13, 20, 1, 6, 4, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:32...
global Accuracy on shared test data: 70.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[157  80]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:32, End: 2025-07-22 16:02:32)
start time is: 99115988542565, end time is: 99134144605309
The total time is: 18156062744ns.

 ------- aggregate method: krum, random_seed: 300 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 10, 8, 11, 7, 5, 13, 14, 4, 6, 16, 18, 1, 19, 3, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9731e+05, 3.9724e+05, 3.9733e+05, 3.9730e+05, 3.9736e+05,
         7.8761e+05, 8.1618e+05, 3.9734e+05, 3.9734e+05, 8.0706e+05, 7.8180e+05,
         3.9728e+05, 7.6496e+05, 3.9728e+05, 3.9733e+05],
        [3.9731e+05, 0.0000e+00, 3.7711e+00, 3.8205e+00, 3.8790e+00, 4.3243e+00,
         3.8428e+05, 3.9774e+05, 3.5231e+00, 3.5978e+00, 3.9046e+05, 3.8350e+05,
         3.5493e+00, 3.8774e+05, 4.0216e+00, 3.3314e+00],
        [3.9724e+05, 3.7711e+00, 0.0000e+00, 4.1474e+00, 4.2969e+00, 4.5310e+00,
         3.8425e+05, 3.9776e+05, 3.9567e+00, 4.1725e+00, 3.9048e+05, 3.8346e+05,
         3.9946e+00, 3.8777e+05, 4.6517e+00, 3.9358e+00],
        [3.9733e+05, 3.8205e+00, 4.1474e+00, 0.0000e+00, 4.6497e+00, 3.2775e+00,
         3.8424e+05, 3.9780e+05, 3.7882e+00, 4.3700e+00, 3.9047e+05, 3.8355e+05,
         3.6296e+00, 3.8776e+05, 5.4585e+00, 4.2002e+00],
        [3.9730e+05, 3.8790e+00, 4.2969e+00, 4.6497e+00, 0.0000e+00, 4.7686e+00,
         3.8427e+05, 3.9784e+05, 3.7677e+00, 4.0120e+00, 3.9048e+05, 3.8347e+05,
         4.2796e+00, 3.8776e+05, 4.0640e+00, 4.1258e+00],
        [3.9736e+05, 4.3243e+00, 4.5310e+00, 3.2775e+00, 4.7686e+00, 0.0000e+00,
         3.8426e+05, 3.9778e+05, 4.0505e+00, 4.7808e+00, 3.9044e+05, 3.8349e+05,
         3.9820e+00, 3.8778e+05, 5.4494e+00, 4.8985e+00],
        [7.8761e+05, 3.8428e+05, 3.8425e+05, 3.8424e+05, 3.8427e+05, 3.8426e+05,
         0.0000e+00, 7.9592e+05, 3.8428e+05, 3.8429e+05, 7.8257e+05, 7.6638e+05,
         3.8426e+05, 7.8229e+05, 3.8429e+05, 3.8429e+05],
        [8.1618e+05, 3.9774e+05, 3.9776e+05, 3.9780e+05, 3.9784e+05, 3.9778e+05,
         7.9592e+05, 0.0000e+00, 3.9783e+05, 3.9779e+05, 7.8205e+05, 7.8568e+05,
         3.9782e+05, 8.0080e+05, 3.9783e+05, 3.9780e+05],
        [3.9734e+05, 3.5231e+00, 3.9567e+00, 3.7882e+00, 3.7677e+00, 4.0505e+00,
         3.8428e+05, 3.9783e+05, 0.0000e+00, 3.6635e+00, 3.9045e+05, 3.8347e+05,
         3.5723e+00, 3.8772e+05, 4.2637e+00, 3.6476e+00],
        [3.9734e+05, 3.5978e+00, 4.1725e+00, 4.3700e+00, 4.0120e+00, 4.7808e+00,
         3.8429e+05, 3.9779e+05, 3.6635e+00, 0.0000e+00, 3.9046e+05, 3.8348e+05,
         3.8052e+00, 3.8775e+05, 3.9116e+00, 3.4191e+00],
        [8.0706e+05, 3.9046e+05, 3.9048e+05, 3.9047e+05, 3.9048e+05, 3.9044e+05,
         7.8257e+05, 7.8205e+05, 3.9045e+05, 3.9046e+05, 0.0000e+00, 7.9581e+05,
         3.9045e+05, 7.7979e+05, 3.9047e+05, 3.9041e+05],
        [7.8180e+05, 3.8350e+05, 3.8346e+05, 3.8355e+05, 3.8347e+05, 3.8349e+05,
         7.6638e+05, 7.8568e+05, 3.8347e+05, 3.8348e+05, 7.9581e+05, 0.0000e+00,
         3.8347e+05, 7.5608e+05, 3.8347e+05, 3.8346e+05],
        [3.9728e+05, 3.5493e+00, 3.9946e+00, 3.6296e+00, 4.2796e+00, 3.9820e+00,
         3.8426e+05, 3.9782e+05, 3.5723e+00, 3.8052e+00, 3.9045e+05, 3.8347e+05,
         0.0000e+00, 3.8779e+05, 4.7446e+00, 3.7093e+00],
        [7.6496e+05, 3.8774e+05, 3.8777e+05, 3.8776e+05, 3.8776e+05, 3.8778e+05,
         7.8229e+05, 8.0080e+05, 3.8772e+05, 3.8775e+05, 7.7979e+05, 7.5608e+05,
         3.8779e+05, 0.0000e+00, 3.8772e+05, 3.8777e+05],
        [3.9728e+05, 4.0216e+00, 4.6517e+00, 5.4585e+00, 4.0640e+00, 5.4494e+00,
         3.8429e+05, 3.9783e+05, 4.2637e+00, 3.9116e+00, 3.9047e+05, 3.8347e+05,
         4.7446e+00, 3.8772e+05, 0.0000e+00, 3.8868e+00],
        [3.9733e+05, 3.3314e+00, 3.9358e+00, 4.2002e+00, 4.1258e+00, 4.8985e+00,
         3.8429e+05, 3.9780e+05, 3.6476e+00, 3.4191e+00, 3.9041e+05, 3.8346e+05,
         3.7093e+00, 3.8777e+05, 3.8868e+00, 0.0000e+00]])
Krum scores: ['397301.53', '3.69', '4.10', '3.99', '4.13', '4.33', '384266.62', '397791.53', '3.75', '3.87', '390451.22', '383471.44', '3.82', '387747.38', '4.37', '3.78']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 10, 8, 11, 7, 5, 13, 14, 4, 6, 16, 18, 1, 19, 3, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0176s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:32...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[149  88]
 [ 42 221]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:32, End: 2025-07-22 16:02:32)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 12, 17, 19, 1, 10, 7, 20, 15, 18, 13, 3, 9, 6, 16, 11], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 2.1769e+00, 3.9083e+05, 3.9470e+05, 2.2041e+00, 2.2586e+00,
         2.2390e+00, 3.8523e+05, 3.8109e+05, 4.0089e+05, 3.7786e+05, 2.0639e+00,
         2.0418e+00, 2.1842e+00, 4.0302e+05, 2.1346e+00],
        [2.1769e+00, 0.0000e+00, 3.9085e+05, 3.9465e+05, 2.0197e+00, 2.0451e+00,
         2.0886e+00, 3.8527e+05, 3.8112e+05, 4.0085e+05, 3.7785e+05, 1.8530e+00,
         2.0095e+00, 2.0401e+00, 4.0301e+05, 2.1072e+00],
        [3.9083e+05, 3.9085e+05, 0.0000e+00, 7.8758e+05, 3.9084e+05, 3.9084e+05,
         3.9082e+05, 7.9130e+05, 7.4929e+05, 7.8353e+05, 7.5811e+05, 3.9084e+05,
         3.9087e+05, 3.9086e+05, 7.9305e+05, 3.9083e+05],
        [3.9470e+05, 3.9465e+05, 7.8758e+05, 0.0000e+00, 3.9470e+05, 3.9472e+05,
         3.9466e+05, 7.9142e+05, 7.6266e+05, 7.9648e+05, 7.7002e+05, 3.9468e+05,
         3.9469e+05, 3.9470e+05, 8.0023e+05, 3.9468e+05],
        [2.2041e+00, 2.0197e+00, 3.9084e+05, 3.9470e+05, 0.0000e+00, 1.9590e+00,
         2.0173e+00, 3.8521e+05, 3.8109e+05, 4.0086e+05, 3.7782e+05, 2.0589e+00,
         1.8513e+00, 1.9755e+00, 4.0303e+05, 1.9544e+00],
        [2.2586e+00, 2.0451e+00, 3.9084e+05, 3.9472e+05, 1.9590e+00, 0.0000e+00,
         2.1349e+00, 3.8525e+05, 3.8112e+05, 4.0087e+05, 3.7780e+05, 1.9020e+00,
         2.0035e+00, 2.2557e+00, 4.0304e+05, 2.2347e+00],
        [2.2390e+00, 2.0886e+00, 3.9082e+05, 3.9466e+05, 2.0173e+00, 2.1349e+00,
         0.0000e+00, 3.8518e+05, 3.8111e+05, 4.0090e+05, 3.7784e+05, 2.1674e+00,
         2.0918e+00, 2.0877e+00, 4.0297e+05, 1.9801e+00],
        [3.8523e+05, 3.8527e+05, 7.9130e+05, 7.9142e+05, 3.8521e+05, 3.8525e+05,
         3.8518e+05, 0.0000e+00, 7.6999e+05, 7.8852e+05, 7.6599e+05, 3.8526e+05,
         3.8522e+05, 3.8523e+05, 7.6764e+05, 3.8524e+05],
        [3.8109e+05, 3.8112e+05, 7.4929e+05, 7.6266e+05, 3.8109e+05, 3.8112e+05,
         3.8111e+05, 7.6999e+05, 0.0000e+00, 7.8564e+05, 7.5736e+05, 3.8107e+05,
         3.8110e+05, 3.8112e+05, 7.9876e+05, 3.8112e+05],
        [4.0089e+05, 4.0085e+05, 7.8353e+05, 7.9648e+05, 4.0086e+05, 4.0087e+05,
         4.0090e+05, 7.8852e+05, 7.8564e+05, 0.0000e+00, 7.9557e+05, 4.0086e+05,
         4.0087e+05, 4.0085e+05, 8.0818e+05, 4.0085e+05],
        [3.7786e+05, 3.7785e+05, 7.5811e+05, 7.7002e+05, 3.7782e+05, 3.7780e+05,
         3.7784e+05, 7.6599e+05, 7.5736e+05, 7.9557e+05, 0.0000e+00, 3.7785e+05,
         3.7784e+05, 3.7788e+05, 7.9940e+05, 3.7784e+05],
        [2.0639e+00, 1.8530e+00, 3.9084e+05, 3.9468e+05, 2.0589e+00, 1.9020e+00,
         2.1674e+00, 3.8526e+05, 3.8107e+05, 4.0086e+05, 3.7785e+05, 0.0000e+00,
         1.9127e+00, 2.2217e+00, 4.0300e+05, 2.1533e+00],
        [2.0418e+00, 2.0095e+00, 3.9087e+05, 3.9469e+05, 1.8513e+00, 2.0035e+00,
         2.0918e+00, 3.8522e+05, 3.8110e+05, 4.0087e+05, 3.7784e+05, 1.9127e+00,
         0.0000e+00, 1.9445e+00, 4.0300e+05, 1.9777e+00],
        [2.1842e+00, 2.0401e+00, 3.9086e+05, 3.9470e+05, 1.9755e+00, 2.2557e+00,
         2.0877e+00, 3.8523e+05, 3.8112e+05, 4.0085e+05, 3.7788e+05, 2.2217e+00,
         1.9445e+00, 0.0000e+00, 4.0299e+05, 2.0070e+00],
        [4.0302e+05, 4.0301e+05, 7.9305e+05, 8.0023e+05, 4.0303e+05, 4.0304e+05,
         4.0297e+05, 7.6764e+05, 7.9876e+05, 8.0818e+05, 7.9940e+05, 4.0300e+05,
         4.0300e+05, 4.0299e+05, 0.0000e+00, 4.0297e+05],
        [2.1346e+00, 2.1072e+00, 3.9083e+05, 3.9468e+05, 1.9544e+00, 2.2347e+00,
         1.9801e+00, 3.8524e+05, 3.8112e+05, 4.0085e+05, 3.7784e+05, 2.1533e+00,
         1.9777e+00, 2.0070e+00, 4.0297e+05, 0.0000e+00]])
Krum scores: ['2.15', '2.02', '390836.53', '394679.81', '1.98', '2.08', '2.08', '385221.94', '381100.19', '400859.94', '377833.75', '2.02', '1.96', '2.07', '402994.59', '2.04']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 12, 17, 19, 1, 10, 7, 20, 15, 18, 13, 3, 9, 6, 16, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0258s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:33...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[163  74]
 [ 44 219]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:33, End: 2025-07-22 16:02:33)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 20, 14, 15, 4, 9, 2, 3, 11, 7, 8, 10, 17, 19, 13, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.6656e+05, 7.8262e+05, 7.9968e+05, 3.8859e+05, 3.8861e+05,
         3.8861e+05, 3.8860e+05, 3.8860e+05, 3.8862e+05, 3.8862e+05, 3.8861e+05,
         7.6521e+05, 8.1499e+05, 7.4850e+05, 3.8858e+05],
        [7.6656e+05, 0.0000e+00, 7.9674e+05, 7.8919e+05, 3.8393e+05, 3.8391e+05,
         3.8394e+05, 3.8391e+05, 3.8395e+05, 3.8393e+05, 3.8396e+05, 3.8393e+05,
         7.8240e+05, 7.5721e+05, 7.5968e+05, 3.8397e+05],
        [7.8262e+05, 7.9674e+05, 0.0000e+00, 8.1585e+05, 3.9527e+05, 3.9524e+05,
         3.9525e+05, 3.9529e+05, 3.9528e+05, 3.9526e+05, 3.9528e+05, 3.9528e+05,
         7.6333e+05, 7.8690e+05, 7.7456e+05, 3.9525e+05],
        [7.9968e+05, 7.8919e+05, 8.1585e+05, 0.0000e+00, 4.0661e+05, 4.0663e+05,
         4.0665e+05, 4.0663e+05, 4.0664e+05, 4.0662e+05, 4.0665e+05, 4.0659e+05,
         7.7823e+05, 7.9245e+05, 7.8287e+05, 4.0661e+05],
        [3.8859e+05, 3.8393e+05, 3.9527e+05, 4.0661e+05, 0.0000e+00, 1.8756e+00,
         1.6461e+00, 1.7146e+00, 1.4965e+00, 1.5408e+00, 1.6004e+00, 1.8049e+00,
         3.8398e+05, 3.9736e+05, 3.7726e+05, 1.6442e+00],
        [3.8861e+05, 3.8391e+05, 3.9524e+05, 4.0663e+05, 1.8756e+00, 0.0000e+00,
         1.7881e+00, 1.7099e+00, 1.8351e+00, 1.9161e+00, 1.9040e+00, 1.5598e+00,
         3.8392e+05, 3.9739e+05, 3.7727e+05, 1.7032e+00],
        [3.8861e+05, 3.8394e+05, 3.9525e+05, 4.0665e+05, 1.6461e+00, 1.7881e+00,
         0.0000e+00, 1.6846e+00, 1.6942e+00, 1.6161e+00, 1.8485e+00, 1.7039e+00,
         3.8393e+05, 3.9738e+05, 3.7726e+05, 1.6491e+00],
        [3.8860e+05, 3.8391e+05, 3.9529e+05, 4.0663e+05, 1.7146e+00, 1.7099e+00,
         1.6846e+00, 0.0000e+00, 1.8688e+00, 1.8732e+00, 1.7216e+00, 1.5856e+00,
         3.8394e+05, 3.9739e+05, 3.7723e+05, 1.5901e+00],
        [3.8860e+05, 3.8395e+05, 3.9528e+05, 4.0664e+05, 1.4965e+00, 1.8351e+00,
         1.6942e+00, 1.8688e+00, 0.0000e+00, 1.6479e+00, 1.7385e+00, 1.7768e+00,
         3.8398e+05, 3.9738e+05, 3.7726e+05, 1.7388e+00],
        [3.8862e+05, 3.8393e+05, 3.9526e+05, 4.0662e+05, 1.5408e+00, 1.9161e+00,
         1.6161e+00, 1.8732e+00, 1.6479e+00, 0.0000e+00, 1.8367e+00, 1.8119e+00,
         3.8393e+05, 3.9740e+05, 3.7723e+05, 1.7574e+00],
        [3.8862e+05, 3.8396e+05, 3.9528e+05, 4.0665e+05, 1.6004e+00, 1.9040e+00,
         1.8485e+00, 1.7216e+00, 1.7385e+00, 1.8367e+00, 0.0000e+00, 1.7426e+00,
         3.8396e+05, 3.9736e+05, 3.7725e+05, 1.7598e+00],
        [3.8861e+05, 3.8393e+05, 3.9528e+05, 4.0659e+05, 1.8049e+00, 1.5598e+00,
         1.7039e+00, 1.5856e+00, 1.7768e+00, 1.8119e+00, 1.7426e+00, 0.0000e+00,
         3.8394e+05, 3.9737e+05, 3.7726e+05, 1.6690e+00],
        [7.6521e+05, 7.8240e+05, 7.6333e+05, 7.7823e+05, 3.8398e+05, 3.8392e+05,
         3.8393e+05, 3.8394e+05, 3.8398e+05, 3.8393e+05, 3.8396e+05, 3.8394e+05,
         0.0000e+00, 7.6812e+05, 7.6530e+05, 3.8391e+05],
        [8.1499e+05, 7.5721e+05, 7.8690e+05, 7.9245e+05, 3.9736e+05, 3.9739e+05,
         3.9738e+05, 3.9739e+05, 3.9738e+05, 3.9740e+05, 3.9736e+05, 3.9737e+05,
         7.6812e+05, 0.0000e+00, 7.4417e+05, 3.9739e+05],
        [7.4850e+05, 7.5968e+05, 7.7456e+05, 7.8287e+05, 3.7726e+05, 3.7727e+05,
         3.7726e+05, 3.7723e+05, 3.7726e+05, 3.7723e+05, 3.7725e+05, 3.7726e+05,
         7.6530e+05, 7.4417e+05, 0.0000e+00, 3.7726e+05],
        [3.8858e+05, 3.8397e+05, 3.9525e+05, 4.0661e+05, 1.6442e+00, 1.7032e+00,
         1.6491e+00, 1.5901e+00, 1.7388e+00, 1.7574e+00, 1.7598e+00, 1.6690e+00,
         3.8391e+05, 3.9739e+05, 3.7726e+05, 0.0000e+00]])
Krum scores: ['388599.06', '383928.56', '395259.19', '406617.25', '1.64', '1.77', '1.68', '1.70', '1.70', '1.73', '1.75', '1.69', '383934.56', '397375.66', '377250.91', '1.68']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 20, 14, 15, 4, 9, 2, 3, 11, 7, 8, 10, 17, 19, 13, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0046s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:34...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:34, End: 2025-07-22 16:02:34)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 14, 15, 17, 3, 19, 7, 12, 16, 20, 5, 2, 8, 1, 10, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.8552e+05, 7.8751e+05, 7.9666e+05, 3.9785e+05, 7.7929e+05,
         3.9784e+05, 3.9786e+05, 7.9800e+05, 7.7704e+05, 3.9780e+05, 3.9785e+05,
         3.9779e+05, 3.9785e+05, 3.9784e+05, 3.9782e+05],
        [7.8552e+05, 0.0000e+00, 7.8182e+05, 7.7500e+05, 3.8345e+05, 7.6259e+05,
         3.8348e+05, 3.8343e+05, 7.5502e+05, 7.6133e+05, 3.8348e+05, 3.8344e+05,
         3.8341e+05, 3.8345e+05, 3.8347e+05, 3.8345e+05],
        [7.8751e+05, 7.8182e+05, 0.0000e+00, 7.9331e+05, 3.9194e+05, 7.8555e+05,
         3.9197e+05, 3.9197e+05, 7.7561e+05, 7.6483e+05, 3.9194e+05, 3.9202e+05,
         3.9194e+05, 3.9197e+05, 3.9197e+05, 3.9199e+05],
        [7.9666e+05, 7.7500e+05, 7.9331e+05, 0.0000e+00, 4.0498e+05, 8.0317e+05,
         4.0501e+05, 4.0497e+05, 7.9627e+05, 8.0572e+05, 4.0495e+05, 4.0498e+05,
         4.0499e+05, 4.0497e+05, 4.0493e+05, 4.0498e+05],
        [3.9785e+05, 3.8345e+05, 3.9194e+05, 4.0498e+05, 0.0000e+00, 3.9672e+05,
         2.0247e+00, 1.8276e+00, 3.8856e+05, 3.8450e+05, 1.9049e+00, 1.8555e+00,
         1.9125e+00, 1.9859e+00, 1.7741e+00, 2.0530e+00],
        [7.7929e+05, 7.6259e+05, 7.8555e+05, 8.0317e+05, 3.9672e+05, 0.0000e+00,
         3.9671e+05, 3.9672e+05, 7.6971e+05, 7.7426e+05, 3.9667e+05, 3.9670e+05,
         3.9671e+05, 3.9672e+05, 3.9669e+05, 3.9670e+05],
        [3.9784e+05, 3.8348e+05, 3.9197e+05, 4.0501e+05, 2.0247e+00, 3.9671e+05,
         0.0000e+00, 1.8911e+00, 3.8856e+05, 3.8448e+05, 1.9381e+00, 1.6696e+00,
         1.9701e+00, 1.7705e+00, 1.8738e+00, 1.9271e+00],
        [3.9786e+05, 3.8343e+05, 3.9197e+05, 4.0497e+05, 1.8276e+00, 3.9672e+05,
         1.8911e+00, 0.0000e+00, 3.8856e+05, 3.8453e+05, 1.9081e+00, 1.8593e+00,
         1.9682e+00, 1.8864e+00, 1.8046e+00, 1.9491e+00],
        [7.9800e+05, 7.5502e+05, 7.7561e+05, 7.9627e+05, 3.8856e+05, 7.6971e+05,
         3.8856e+05, 3.8856e+05, 0.0000e+00, 7.7116e+05, 3.8859e+05, 3.8857e+05,
         3.8856e+05, 3.8855e+05, 3.8858e+05, 3.8857e+05],
        [7.7704e+05, 7.6133e+05, 7.6483e+05, 8.0572e+05, 3.8450e+05, 7.7426e+05,
         3.8448e+05, 3.8453e+05, 7.7116e+05, 0.0000e+00, 3.8449e+05, 3.8450e+05,
         3.8453e+05, 3.8452e+05, 3.8456e+05, 3.8454e+05],
        [3.9780e+05, 3.8348e+05, 3.9194e+05, 4.0495e+05, 1.9049e+00, 3.9667e+05,
         1.9381e+00, 1.9081e+00, 3.8859e+05, 3.8449e+05, 0.0000e+00, 1.9257e+00,
         2.2372e+00, 2.0390e+00, 1.9664e+00, 2.0091e+00],
        [3.9785e+05, 3.8344e+05, 3.9202e+05, 4.0498e+05, 1.8555e+00, 3.9670e+05,
         1.6696e+00, 1.8593e+00, 3.8857e+05, 3.8450e+05, 1.9257e+00, 0.0000e+00,
         1.9697e+00, 1.7412e+00, 1.8185e+00, 1.7456e+00],
        [3.9779e+05, 3.8341e+05, 3.9194e+05, 4.0499e+05, 1.9125e+00, 3.9671e+05,
         1.9701e+00, 1.9682e+00, 3.8856e+05, 3.8453e+05, 2.2372e+00, 1.9697e+00,
         0.0000e+00, 1.9348e+00, 1.8733e+00, 1.9282e+00],
        [3.9785e+05, 3.8345e+05, 3.9197e+05, 4.0497e+05, 1.9859e+00, 3.9672e+05,
         1.7705e+00, 1.8864e+00, 3.8855e+05, 3.8452e+05, 2.0390e+00, 1.7412e+00,
         1.9348e+00, 0.0000e+00, 1.7909e+00, 1.8124e+00],
        [3.9784e+05, 3.8347e+05, 3.9197e+05, 4.0493e+05, 1.7741e+00, 3.9669e+05,
         1.8738e+00, 1.8046e+00, 3.8858e+05, 3.8456e+05, 1.9664e+00, 1.8185e+00,
         1.8733e+00, 1.7909e+00, 0.0000e+00, 1.9821e+00],
        [3.9782e+05, 3.8345e+05, 3.9199e+05, 4.0498e+05, 2.0530e+00, 3.9670e+05,
         1.9271e+00, 1.9491e+00, 3.8857e+05, 3.8454e+05, 2.0091e+00, 1.7456e+00,
         1.9282e+00, 1.8124e+00, 1.9821e+00, 0.0000e+00]])
Krum scores: ['397825.97', '383441.91', '391954.84', '404967.16', '1.90', '396700.59', '1.86', '1.88', '388562.50', '384506.47', '1.96', '1.80', '1.94', '1.85', '1.84', '1.91']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 14, 15, 17, 3, 19, 7, 12, 16, 20, 5, 2, 8, 1, 10, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:34...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:34, End: 2025-07-22 16:02:34)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 12, 16, 11, 13, 18, 14, 9, 19, 4, 2, 8, 5, 20, 7, 17], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9854e+05, 7.6524e+05, 3.9849e+05, 7.5417e+05, 7.9383e+05,
         7.9177e+05, 3.9850e+05, 8.2795e+05, 3.9853e+05, 3.9854e+05, 3.9853e+05,
         3.9854e+05, 7.8122e+05, 3.9854e+05, 7.8618e+05],
        [3.9854e+05, 0.0000e+00, 3.7038e+05, 1.8013e+00, 3.8363e+05, 3.9482e+05,
         3.9785e+05, 1.7211e+00, 3.9684e+05, 1.6468e+00, 1.7837e+00, 1.8086e+00,
         1.7467e+00, 3.8919e+05, 1.7863e+00, 3.8054e+05],
        [7.6524e+05, 3.7038e+05, 0.0000e+00, 3.7039e+05, 7.5637e+05, 7.6109e+05,
         7.5282e+05, 3.7039e+05, 7.6368e+05, 3.7037e+05, 3.7040e+05, 3.7036e+05,
         3.7038e+05, 7.5717e+05, 3.7040e+05, 7.3709e+05],
        [3.9849e+05, 1.8013e+00, 3.7039e+05, 0.0000e+00, 3.8362e+05, 3.9484e+05,
         3.9787e+05, 1.7699e+00, 3.9680e+05, 1.6416e+00, 1.8813e+00, 1.6930e+00,
         1.6897e+00, 3.8917e+05, 1.7287e+00, 3.8050e+05],
        [7.5417e+05, 3.8363e+05, 7.5637e+05, 3.8362e+05, 0.0000e+00, 7.6908e+05,
         7.7084e+05, 3.8360e+05, 7.8438e+05, 3.8360e+05, 3.8361e+05, 3.8365e+05,
         3.8361e+05, 7.7381e+05, 3.8365e+05, 7.6214e+05],
        [7.9383e+05, 3.9482e+05, 7.6109e+05, 3.9484e+05, 7.6908e+05, 0.0000e+00,
         7.8979e+05, 3.9480e+05, 7.8598e+05, 3.9483e+05, 3.9483e+05, 3.9487e+05,
         3.9481e+05, 7.8338e+05, 3.9486e+05, 7.7669e+05],
        [7.9177e+05, 3.9785e+05, 7.5282e+05, 3.9787e+05, 7.7084e+05, 7.8979e+05,
         0.0000e+00, 3.9787e+05, 7.9011e+05, 3.9788e+05, 3.9785e+05, 3.9787e+05,
         3.9785e+05, 7.9460e+05, 3.9786e+05, 7.8747e+05],
        [3.9850e+05, 1.7211e+00, 3.7039e+05, 1.7699e+00, 3.8360e+05, 3.9480e+05,
         3.9787e+05, 0.0000e+00, 3.9683e+05, 1.6306e+00, 1.6269e+00, 1.8518e+00,
         1.8634e+00, 3.8920e+05, 1.8294e+00, 3.8054e+05],
        [8.2795e+05, 3.9684e+05, 7.6368e+05, 3.9680e+05, 7.8438e+05, 7.8598e+05,
         7.9011e+05, 3.9683e+05, 0.0000e+00, 3.9684e+05, 3.9685e+05, 3.9678e+05,
         3.9679e+05, 7.7053e+05, 3.9685e+05, 7.7562e+05],
        [3.9853e+05, 1.6468e+00, 3.7037e+05, 1.6416e+00, 3.8360e+05, 3.9483e+05,
         3.9788e+05, 1.6306e+00, 3.9684e+05, 0.0000e+00, 1.6646e+00, 1.6227e+00,
         1.7795e+00, 3.8917e+05, 1.5828e+00, 3.8052e+05],
        [3.9854e+05, 1.7837e+00, 3.7040e+05, 1.8813e+00, 3.8361e+05, 3.9483e+05,
         3.9785e+05, 1.6269e+00, 3.9685e+05, 1.6646e+00, 0.0000e+00, 1.8882e+00,
         1.8711e+00, 3.8918e+05, 1.7526e+00, 3.8053e+05],
        [3.9853e+05, 1.8086e+00, 3.7036e+05, 1.6930e+00, 3.8365e+05, 3.9487e+05,
         3.9787e+05, 1.8518e+00, 3.9678e+05, 1.6227e+00, 1.8882e+00, 0.0000e+00,
         1.9267e+00, 3.8917e+05, 1.7887e+00, 3.8054e+05],
        [3.9854e+05, 1.7467e+00, 3.7038e+05, 1.6897e+00, 3.8361e+05, 3.9481e+05,
         3.9785e+05, 1.8634e+00, 3.9679e+05, 1.7795e+00, 1.8711e+00, 1.9267e+00,
         0.0000e+00, 3.8915e+05, 1.7278e+00, 3.8052e+05],
        [7.8122e+05, 3.8919e+05, 7.5717e+05, 3.8917e+05, 7.7381e+05, 7.8338e+05,
         7.9460e+05, 3.8920e+05, 7.7053e+05, 3.8917e+05, 3.8918e+05, 3.8917e+05,
         3.8915e+05, 0.0000e+00, 3.8920e+05, 7.6510e+05],
        [3.9854e+05, 1.7863e+00, 3.7040e+05, 1.7287e+00, 3.8365e+05, 3.9486e+05,
         3.9786e+05, 1.8294e+00, 3.9685e+05, 1.5828e+00, 1.7526e+00, 1.7887e+00,
         1.7278e+00, 3.8920e+05, 0.0000e+00, 3.8050e+05],
        [7.8618e+05, 3.8054e+05, 7.3709e+05, 3.8050e+05, 7.6214e+05, 7.7669e+05,
         7.8747e+05, 3.8054e+05, 7.7562e+05, 3.8052e+05, 3.8053e+05, 3.8054e+05,
         3.8052e+05, 7.6510e+05, 3.8050e+05, 0.0000e+00]])
Krum scores: ['398521.03', '1.75', '370378.66', '1.72', '383609.28', '394821.75', '397859.50', '1.74', '396814.03', '1.63', '1.76', '1.78', '1.78', '389172.66', '1.73', '380516.62']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 12, 16, 11, 13, 18, 14, 9, 19, 4, 2, 8, 5, 20, 7, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:35...
global Accuracy on shared test data: 78.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:35, End: 2025-07-22 16:02:35)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 10, 11, 5, 14, 9, 3, 2, 13, 20, 8, 15, 7, 4, 6, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0112e+05, 4.0111e+05, 4.0113e+05, 7.9884e+05, 4.0113e+05,
         4.0116e+05, 4.0114e+05, 7.9220e+05, 7.6372e+05, 4.0113e+05, 8.1845e+05,
         4.0112e+05, 4.0114e+05, 4.0111e+05, 8.1900e+05],
        [4.0112e+05, 0.0000e+00, 1.6647e+00, 1.6994e+00, 4.0717e+05, 1.4973e+00,
         1.5668e+00, 1.6039e+00, 3.9087e+05, 3.7004e+05, 1.6669e+00, 4.0244e+05,
         1.7166e+00, 1.6990e+00, 1.7514e+00, 3.9347e+05],
        [4.0111e+05, 1.6647e+00, 0.0000e+00, 1.6155e+00, 4.0717e+05, 1.6700e+00,
         1.8232e+00, 1.7867e+00, 3.9087e+05, 3.7003e+05, 1.6407e+00, 4.0248e+05,
         1.6628e+00, 1.8138e+00, 1.6428e+00, 3.9347e+05],
        [4.0113e+05, 1.6994e+00, 1.6155e+00, 0.0000e+00, 4.0714e+05, 1.7872e+00,
         1.7209e+00, 1.7954e+00, 3.9087e+05, 3.7004e+05, 1.8969e+00, 4.0241e+05,
         1.6857e+00, 1.8445e+00, 1.7825e+00, 3.9343e+05],
        [7.9884e+05, 4.0717e+05, 4.0717e+05, 4.0714e+05, 0.0000e+00, 4.0712e+05,
         4.0714e+05, 4.0715e+05, 8.0784e+05, 7.6308e+05, 4.0716e+05, 8.1389e+05,
         4.0714e+05, 4.0712e+05, 4.0713e+05, 7.8592e+05],
        [4.0113e+05, 1.4973e+00, 1.6700e+00, 1.7872e+00, 4.0712e+05, 0.0000e+00,
         1.7047e+00, 1.5271e+00, 3.9086e+05, 3.7004e+05, 1.7997e+00, 4.0242e+05,
         1.7495e+00, 1.6108e+00, 1.6735e+00, 3.9348e+05],
        [4.0116e+05, 1.5668e+00, 1.8232e+00, 1.7209e+00, 4.0714e+05, 1.7047e+00,
         0.0000e+00, 1.6879e+00, 3.9086e+05, 3.7004e+05, 1.6520e+00, 4.0243e+05,
         1.8263e+00, 1.8098e+00, 1.8393e+00, 3.9342e+05],
        [4.0114e+05, 1.6039e+00, 1.7867e+00, 1.7954e+00, 4.0715e+05, 1.5271e+00,
         1.6879e+00, 0.0000e+00, 3.9086e+05, 3.7002e+05, 1.8364e+00, 4.0243e+05,
         1.7205e+00, 1.5852e+00, 1.7070e+00, 3.9346e+05],
        [7.9220e+05, 3.9087e+05, 3.9087e+05, 3.9087e+05, 8.0784e+05, 3.9086e+05,
         3.9086e+05, 3.9086e+05, 0.0000e+00, 7.4432e+05, 3.9086e+05, 7.9797e+05,
         3.9087e+05, 3.9087e+05, 3.9086e+05, 7.7624e+05],
        [7.6372e+05, 3.7004e+05, 3.7003e+05, 3.7004e+05, 7.6308e+05, 3.7004e+05,
         3.7004e+05, 3.7002e+05, 7.4432e+05, 0.0000e+00, 3.7001e+05, 7.7725e+05,
         3.7005e+05, 3.7006e+05, 3.7004e+05, 7.7469e+05],
        [4.0113e+05, 1.6669e+00, 1.6407e+00, 1.8969e+00, 4.0716e+05, 1.7997e+00,
         1.6520e+00, 1.8364e+00, 3.9086e+05, 3.7001e+05, 0.0000e+00, 4.0243e+05,
         1.7742e+00, 1.8180e+00, 1.6773e+00, 3.9347e+05],
        [8.1845e+05, 4.0244e+05, 4.0248e+05, 4.0241e+05, 8.1389e+05, 4.0242e+05,
         4.0243e+05, 4.0243e+05, 7.9797e+05, 7.7725e+05, 4.0243e+05, 0.0000e+00,
         4.0241e+05, 4.0245e+05, 4.0244e+05, 7.8620e+05],
        [4.0112e+05, 1.7166e+00, 1.6628e+00, 1.6857e+00, 4.0714e+05, 1.7495e+00,
         1.8263e+00, 1.7205e+00, 3.9087e+05, 3.7005e+05, 1.7742e+00, 4.0241e+05,
         0.0000e+00, 1.8607e+00, 1.7144e+00, 3.9345e+05],
        [4.0114e+05, 1.6990e+00, 1.8138e+00, 1.8445e+00, 4.0712e+05, 1.6108e+00,
         1.8098e+00, 1.5852e+00, 3.9087e+05, 3.7006e+05, 1.8180e+00, 4.0245e+05,
         1.8607e+00, 0.0000e+00, 1.8143e+00, 3.9344e+05],
        [4.0111e+05, 1.7514e+00, 1.6428e+00, 1.7825e+00, 4.0713e+05, 1.6735e+00,
         1.8393e+00, 1.7070e+00, 3.9086e+05, 3.7004e+05, 1.6773e+00, 4.0244e+05,
         1.7144e+00, 1.8143e+00, 0.0000e+00, 3.9345e+05],
        [8.1900e+05, 3.9347e+05, 3.9347e+05, 3.9343e+05, 7.8592e+05, 3.9348e+05,
         3.9342e+05, 3.9346e+05, 7.7624e+05, 7.7469e+05, 3.9347e+05, 7.8620e+05,
         3.9345e+05, 3.9344e+05, 3.9345e+05, 0.0000e+00]])
Krum scores: ['401125.06', '1.64', '1.69', '1.74', '407138.44', '1.65', '1.72', '1.68', '390863.06', '370031.47', '1.73', '402426.50', '1.73', '1.75', '1.72', '393449.31']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 10, 11, 5, 14, 9, 3, 2, 13, 20, 8, 15, 7, 4, 6, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0171s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:35...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 47 216]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:35, End: 2025-07-22 16:02:35)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 2, 15, 11, 4, 10, 19, 16, 17, 8, 13, 1, 3, 20, 18, 5], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.5293e+00, 3.8701e+05, 1.5177e+00, 1.7130e+00, 2.0517e+00,
         3.9582e+05, 3.8384e+05, 3.8251e+05, 1.6374e+00, 3.8985e+05, 1.5946e+00,
         1.7098e+00, 3.7626e+05, 3.7889e+05, 1.5295e+00],
        [1.5293e+00, 0.0000e+00, 3.8702e+05, 1.6721e+00, 1.4786e+00, 1.6700e+00,
         3.9582e+05, 3.8383e+05, 3.8257e+05, 1.6770e+00, 3.8983e+05, 1.5610e+00,
         1.5718e+00, 3.7628e+05, 3.7887e+05, 1.6630e+00],
        [3.8701e+05, 3.8702e+05, 0.0000e+00, 3.8700e+05, 3.8702e+05, 3.8702e+05,
         7.9637e+05, 7.6073e+05, 7.8295e+05, 3.8697e+05, 7.9317e+05, 3.8703e+05,
         3.8702e+05, 7.9326e+05, 7.8050e+05, 3.8700e+05],
        [1.5177e+00, 1.6721e+00, 3.8700e+05, 0.0000e+00, 1.6491e+00, 2.0208e+00,
         3.9583e+05, 3.8386e+05, 3.8250e+05, 1.5243e+00, 3.8988e+05, 1.5250e+00,
         1.6698e+00, 3.7630e+05, 3.7888e+05, 1.4906e+00],
        [1.7130e+00, 1.4786e+00, 3.8702e+05, 1.6491e+00, 0.0000e+00, 1.5697e+00,
         3.9584e+05, 3.8386e+05, 3.8251e+05, 1.6518e+00, 3.8983e+05, 1.6885e+00,
         1.6665e+00, 3.7627e+05, 3.7887e+05, 1.7074e+00],
        [2.0517e+00, 1.6700e+00, 3.8702e+05, 2.0208e+00, 1.5697e+00, 0.0000e+00,
         3.9586e+05, 3.8386e+05, 3.8252e+05, 2.0149e+00, 3.8984e+05, 1.8612e+00,
         1.7678e+00, 3.7628e+05, 3.7890e+05, 1.8926e+00],
        [3.9582e+05, 3.9582e+05, 7.9637e+05, 3.9583e+05, 3.9584e+05, 3.9586e+05,
         0.0000e+00, 7.8322e+05, 7.7435e+05, 3.9582e+05, 7.8479e+05, 3.9584e+05,
         3.9580e+05, 7.7829e+05, 7.4506e+05, 3.9582e+05],
        [3.8384e+05, 3.8383e+05, 7.6073e+05, 3.8386e+05, 3.8386e+05, 3.8386e+05,
         7.8322e+05, 0.0000e+00, 7.6687e+05, 3.8387e+05, 7.8150e+05, 3.8388e+05,
         3.8385e+05, 7.6206e+05, 7.7982e+05, 3.8384e+05],
        [3.8251e+05, 3.8257e+05, 7.8295e+05, 3.8250e+05, 3.8251e+05, 3.8252e+05,
         7.7435e+05, 7.6687e+05, 0.0000e+00, 3.8251e+05, 7.7223e+05, 3.8252e+05,
         3.8251e+05, 7.6903e+05, 7.6216e+05, 3.8256e+05],
        [1.6374e+00, 1.6770e+00, 3.8697e+05, 1.5243e+00, 1.6518e+00, 2.0149e+00,
         3.9582e+05, 3.8387e+05, 3.8251e+05, 0.0000e+00, 3.8988e+05, 1.6854e+00,
         1.5958e+00, 3.7629e+05, 3.7892e+05, 1.7100e+00],
        [3.8985e+05, 3.8983e+05, 7.9317e+05, 3.8988e+05, 3.8983e+05, 3.8984e+05,
         7.8479e+05, 7.8150e+05, 7.7223e+05, 3.8988e+05, 0.0000e+00, 3.8984e+05,
         3.8984e+05, 7.8413e+05, 7.6892e+05, 3.8986e+05],
        [1.5946e+00, 1.5610e+00, 3.8703e+05, 1.5250e+00, 1.6885e+00, 1.8612e+00,
         3.9584e+05, 3.8388e+05, 3.8252e+05, 1.6854e+00, 3.8984e+05, 0.0000e+00,
         1.6988e+00, 3.7626e+05, 3.7887e+05, 1.6512e+00],
        [1.7098e+00, 1.5718e+00, 3.8702e+05, 1.6698e+00, 1.6665e+00, 1.7678e+00,
         3.9580e+05, 3.8385e+05, 3.8251e+05, 1.5958e+00, 3.8984e+05, 1.6988e+00,
         0.0000e+00, 3.7627e+05, 3.7889e+05, 1.5730e+00],
        [3.7626e+05, 3.7628e+05, 7.9326e+05, 3.7630e+05, 3.7627e+05, 3.7628e+05,
         7.7829e+05, 7.6206e+05, 7.6903e+05, 3.7629e+05, 7.8413e+05, 3.7626e+05,
         3.7627e+05, 0.0000e+00, 7.5938e+05, 3.7629e+05],
        [3.7889e+05, 3.7887e+05, 7.8050e+05, 3.7888e+05, 3.7887e+05, 3.7890e+05,
         7.4506e+05, 7.7982e+05, 7.6216e+05, 3.7892e+05, 7.6892e+05, 3.7887e+05,
         3.7889e+05, 7.5938e+05, 0.0000e+00, 3.7887e+05],
        [1.5295e+00, 1.6630e+00, 3.8700e+05, 1.4906e+00, 1.7074e+00, 1.8926e+00,
         3.9582e+05, 3.8384e+05, 3.8256e+05, 1.7100e+00, 3.8986e+05, 1.6512e+00,
         1.5730e+00, 3.7629e+05, 3.7887e+05, 0.0000e+00]])
Krum scores: ['1.60', '1.59', '387005.94', '1.58', '1.63', '1.83', '395821.53', '383847.66', '382511.41', '1.64', '389842.56', '1.63', '1.64', '376274.00', '378877.28', '1.62']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 2, 15, 11, 4, 10, 19, 16, 17, 8, 13, 1, 3, 20, 18, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:36...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[167  70]
 [ 40 223]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:36, End: 2025-07-22 16:02:36)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 7, 9, 4, 10, 13, 14, 17, 3, 5, 6, 8, 12, 18, 15, 20], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.6514e+00, 1.6082e+00, 1.7799e+00, 1.7423e+00, 3.9029e+05,
         4.0470e+05, 3.9200e+05, 1.7721e+00, 1.7467e+00, 1.6269e+00, 1.7547e+00,
         1.7223e+00, 4.0223e+05, 3.8634e+05, 3.7874e+05],
        [1.6514e+00, 0.0000e+00, 1.7279e+00, 1.7774e+00, 1.9385e+00, 3.9031e+05,
         4.0474e+05, 3.9201e+05, 1.7130e+00, 1.6074e+00, 1.7109e+00, 1.7024e+00,
         1.6890e+00, 4.0225e+05, 3.8639e+05, 3.7878e+05],
        [1.6082e+00, 1.7279e+00, 0.0000e+00, 1.5709e+00, 1.5148e+00, 3.9028e+05,
         4.0467e+05, 3.9201e+05, 1.6557e+00, 1.8079e+00, 1.7011e+00, 1.7508e+00,
         1.7075e+00, 4.0224e+05, 3.8636e+05, 3.7878e+05],
        [1.7799e+00, 1.7774e+00, 1.5709e+00, 0.0000e+00, 1.5104e+00, 3.9032e+05,
         4.0472e+05, 3.9199e+05, 1.7281e+00, 1.7746e+00, 1.7728e+00, 1.7360e+00,
         1.6905e+00, 4.0226e+05, 3.8637e+05, 3.7878e+05],
        [1.7423e+00, 1.9385e+00, 1.5148e+00, 1.5104e+00, 0.0000e+00, 3.9030e+05,
         4.0475e+05, 3.9202e+05, 1.6854e+00, 1.8553e+00, 1.9880e+00, 1.8914e+00,
         1.7447e+00, 4.0223e+05, 3.8641e+05, 3.7875e+05],
        [3.9029e+05, 3.9031e+05, 3.9028e+05, 3.9032e+05, 3.9030e+05, 0.0000e+00,
         7.9025e+05, 7.6869e+05, 3.9029e+05, 3.9030e+05, 3.9033e+05, 3.9029e+05,
         3.9031e+05, 7.9048e+05, 7.7612e+05, 7.7573e+05],
        [4.0470e+05, 4.0474e+05, 4.0467e+05, 4.0472e+05, 4.0475e+05, 7.9025e+05,
         0.0000e+00, 8.0657e+05, 4.0476e+05, 4.0473e+05, 4.0472e+05, 4.0468e+05,
         4.0472e+05, 8.1852e+05, 7.7689e+05, 7.7957e+05],
        [3.9200e+05, 3.9201e+05, 3.9201e+05, 3.9199e+05, 3.9202e+05, 7.6869e+05,
         8.0657e+05, 0.0000e+00, 3.9201e+05, 3.9203e+05, 3.9200e+05, 3.9203e+05,
         3.9206e+05, 7.8426e+05, 7.8719e+05, 7.6606e+05],
        [1.7721e+00, 1.7130e+00, 1.6557e+00, 1.7281e+00, 1.6854e+00, 3.9029e+05,
         4.0476e+05, 3.9201e+05, 0.0000e+00, 1.6382e+00, 1.7998e+00, 1.7099e+00,
         1.6184e+00, 4.0225e+05, 3.8637e+05, 3.7876e+05],
        [1.7467e+00, 1.6074e+00, 1.8079e+00, 1.7746e+00, 1.8553e+00, 3.9030e+05,
         4.0473e+05, 3.9203e+05, 1.6382e+00, 0.0000e+00, 1.7483e+00, 1.8273e+00,
         1.7232e+00, 4.0221e+05, 3.8642e+05, 3.7877e+05],
        [1.6269e+00, 1.7109e+00, 1.7011e+00, 1.7728e+00, 1.9880e+00, 3.9033e+05,
         4.0472e+05, 3.9200e+05, 1.7998e+00, 1.7483e+00, 0.0000e+00, 1.6542e+00,
         1.7017e+00, 4.0222e+05, 3.8638e+05, 3.7878e+05],
        [1.7547e+00, 1.7024e+00, 1.7508e+00, 1.7360e+00, 1.8914e+00, 3.9029e+05,
         4.0468e+05, 3.9203e+05, 1.7099e+00, 1.8273e+00, 1.6542e+00, 0.0000e+00,
         1.6377e+00, 4.0223e+05, 3.8639e+05, 3.7877e+05],
        [1.7223e+00, 1.6890e+00, 1.7075e+00, 1.6905e+00, 1.7447e+00, 3.9031e+05,
         4.0472e+05, 3.9206e+05, 1.6184e+00, 1.7232e+00, 1.7017e+00, 1.6377e+00,
         0.0000e+00, 4.0224e+05, 3.8640e+05, 3.7880e+05],
        [4.0223e+05, 4.0225e+05, 4.0224e+05, 4.0226e+05, 4.0223e+05, 7.9048e+05,
         8.1852e+05, 7.8426e+05, 4.0225e+05, 4.0221e+05, 4.0222e+05, 4.0223e+05,
         4.0224e+05, 0.0000e+00, 8.0225e+05, 7.7303e+05],
        [3.8634e+05, 3.8639e+05, 3.8636e+05, 3.8637e+05, 3.8641e+05, 7.7612e+05,
         7.7689e+05, 7.8719e+05, 3.8637e+05, 3.8642e+05, 3.8638e+05, 3.8639e+05,
         3.8640e+05, 8.0225e+05, 0.0000e+00, 7.6149e+05],
        [3.7874e+05, 3.7878e+05, 3.7878e+05, 3.7878e+05, 3.7875e+05, 7.7573e+05,
         7.7957e+05, 7.6606e+05, 3.7876e+05, 3.7877e+05, 3.7878e+05, 3.7877e+05,
         3.7880e+05, 7.7303e+05, 7.6149e+05, 0.0000e+00]])
Krum scores: ['1.70', '1.70', '1.65', '1.70', '1.74', '390297.47', '404707.69', '392008.22', '1.69', '1.73', '1.71', '1.72', '1.69', '402231.44', '386376.12', '378765.72']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 7, 9, 4, 10, 13, 14, 17, 3, 5, 6, 8, 12, 18, 15, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:37...
global Accuracy on shared test data: 78.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 46 217]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:37, End: 2025-07-22 16:02:37)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 9, 18, 6, 4, 16, 13, 19, 10, 12, 7, 1, 11, 3, 20, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9794e+05, 7.9364e+05, 3.9793e+05, 3.9794e+05, 7.7784e+05,
         7.7525e+05, 7.9927e+05, 3.9794e+05, 3.9793e+05, 3.9793e+05, 3.9793e+05,
         3.9793e+05, 3.9793e+05, 7.9055e+05, 3.9791e+05],
        [3.9794e+05, 0.0000e+00, 3.7055e+05, 1.9895e+00, 1.5515e+00, 3.8381e+05,
         3.7954e+05, 3.8559e+05, 1.3646e+00, 1.7722e+00, 1.9917e+00, 1.7961e+00,
         1.5494e+00, 1.8138e+00, 3.8693e+05, 1.9753e+00],
        [7.9364e+05, 3.7055e+05, 0.0000e+00, 3.7052e+05, 3.7054e+05, 7.6326e+05,
         7.3240e+05, 7.7743e+05, 3.7056e+05, 3.7053e+05, 3.7052e+05, 3.7052e+05,
         3.7055e+05, 3.7053e+05, 7.6542e+05, 3.7051e+05],
        [3.9793e+05, 1.9895e+00, 3.7052e+05, 0.0000e+00, 1.4588e+00, 3.8382e+05,
         3.7958e+05, 3.8563e+05, 1.7708e+00, 1.3834e+00, 1.4184e+00, 1.4533e+00,
         1.3987e+00, 1.5326e+00, 3.8697e+05, 1.3977e+00],
        [3.9794e+05, 1.5515e+00, 3.7054e+05, 1.4588e+00, 0.0000e+00, 3.8380e+05,
         3.7956e+05, 3.8563e+05, 1.4074e+00, 1.4081e+00, 1.4834e+00, 1.5758e+00,
         1.2730e+00, 1.5150e+00, 3.8693e+05, 1.4553e+00],
        [7.7784e+05, 3.8381e+05, 7.6326e+05, 3.8382e+05, 3.8380e+05, 0.0000e+00,
         7.5513e+05, 7.7271e+05, 3.8382e+05, 3.8382e+05, 3.8381e+05, 3.8381e+05,
         3.8380e+05, 3.8381e+05, 7.6995e+05, 3.8379e+05],
        [7.7525e+05, 3.7954e+05, 7.3240e+05, 3.7958e+05, 3.7956e+05, 7.5513e+05,
         0.0000e+00, 7.5914e+05, 3.7954e+05, 3.7957e+05, 3.7956e+05, 3.7957e+05,
         3.7958e+05, 3.7958e+05, 7.7992e+05, 3.7957e+05],
        [7.9927e+05, 3.8559e+05, 7.7743e+05, 3.8563e+05, 3.8563e+05, 7.7271e+05,
         7.5914e+05, 0.0000e+00, 3.8562e+05, 3.8561e+05, 3.8561e+05, 3.8560e+05,
         3.8564e+05, 3.8560e+05, 7.7219e+05, 3.8562e+05],
        [3.9794e+05, 1.3646e+00, 3.7056e+05, 1.7708e+00, 1.4074e+00, 3.8382e+05,
         3.7954e+05, 3.8562e+05, 0.0000e+00, 1.5231e+00, 1.7529e+00, 1.5801e+00,
         1.4264e+00, 1.5161e+00, 3.8692e+05, 1.6581e+00],
        [3.9793e+05, 1.7722e+00, 3.7053e+05, 1.3834e+00, 1.4081e+00, 3.8382e+05,
         3.7957e+05, 3.8561e+05, 1.5231e+00, 0.0000e+00, 1.4528e+00, 1.5164e+00,
         1.3707e+00, 1.3594e+00, 3.8697e+05, 1.4000e+00],
        [3.9793e+05, 1.9917e+00, 3.7052e+05, 1.4184e+00, 1.4834e+00, 3.8381e+05,
         3.7956e+05, 3.8561e+05, 1.7529e+00, 1.4528e+00, 0.0000e+00, 1.5201e+00,
         1.4426e+00, 1.5059e+00, 3.8697e+05, 1.4437e+00],
        [3.9793e+05, 1.7961e+00, 3.7052e+05, 1.4533e+00, 1.5758e+00, 3.8381e+05,
         3.7957e+05, 3.8560e+05, 1.5801e+00, 1.5164e+00, 1.5201e+00, 0.0000e+00,
         1.4204e+00, 1.5428e+00, 3.8693e+05, 1.5667e+00],
        [3.9793e+05, 1.5494e+00, 3.7055e+05, 1.3987e+00, 1.2730e+00, 3.8380e+05,
         3.7958e+05, 3.8564e+05, 1.4264e+00, 1.3707e+00, 1.4426e+00, 1.4204e+00,
         0.0000e+00, 1.4957e+00, 3.8694e+05, 1.4502e+00],
        [3.9793e+05, 1.8138e+00, 3.7053e+05, 1.5326e+00, 1.5150e+00, 3.8381e+05,
         3.7958e+05, 3.8560e+05, 1.5161e+00, 1.3594e+00, 1.5059e+00, 1.5428e+00,
         1.4957e+00, 0.0000e+00, 3.8694e+05, 1.4503e+00],
        [7.9055e+05, 3.8693e+05, 7.6542e+05, 3.8697e+05, 3.8693e+05, 7.6995e+05,
         7.7992e+05, 7.7219e+05, 3.8692e+05, 3.8697e+05, 3.8697e+05, 3.8693e+05,
         3.8694e+05, 3.8694e+05, 0.0000e+00, 3.8693e+05],
        [3.9791e+05, 1.9753e+00, 3.7051e+05, 1.3977e+00, 1.4553e+00, 3.8379e+05,
         3.7957e+05, 3.8562e+05, 1.6581e+00, 1.4000e+00, 1.4437e+00, 1.5667e+00,
         1.4502e+00, 1.4503e+00, 3.8693e+05, 0.0000e+00]])
Krum scores: ['397928.88', '1.73', '370526.84', '1.48', '1.44', '383806.22', '379560.62', '385609.69', '1.53', '1.43', '1.50', '1.52', '1.41', '1.49', '386936.03', '1.48']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 9, 18, 6, 4, 16, 13, 19, 10, 12, 7, 1, 11, 3, 20, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0158s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:37...
global Accuracy on shared test data: 77.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 48 215]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:37, End: 2025-07-22 16:02:37)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 13, 18, 8, 20, 5, 6, 4, 19, 3, 9, 15, 1, 12, 16, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.8748e+05, 7.9505e+05, 3.9157e+05, 7.6245e+05, 3.9157e+05,
         3.9157e+05, 3.9157e+05, 7.7291e+05, 3.9156e+05, 3.9155e+05, 7.9173e+05,
         3.9153e+05, 3.9154e+05, 7.9252e+05, 3.9154e+05],
        [7.8748e+05, 0.0000e+00, 8.1037e+05, 3.8629e+05, 7.7575e+05, 3.8630e+05,
         3.8629e+05, 3.8626e+05, 8.0152e+05, 3.8630e+05, 3.8629e+05, 7.9699e+05,
         3.8627e+05, 3.8630e+05, 8.0110e+05, 3.8628e+05],
        [7.9505e+05, 8.1037e+05, 0.0000e+00, 4.0618e+05, 7.7329e+05, 4.0619e+05,
         4.0618e+05, 4.0620e+05, 8.0317e+05, 4.0618e+05, 4.0619e+05, 7.9236e+05,
         4.0615e+05, 4.0618e+05, 7.9920e+05, 4.0616e+05],
        [3.9157e+05, 3.8629e+05, 4.0618e+05, 0.0000e+00, 3.8201e+05, 1.6143e+00,
         1.3713e+00, 1.4627e+00, 4.0033e+05, 1.4736e+00, 1.7460e+00, 3.8839e+05,
         1.5588e+00, 1.4084e+00, 4.0057e+05, 1.5092e+00],
        [7.6245e+05, 7.7575e+05, 7.7329e+05, 3.8201e+05, 0.0000e+00, 3.8205e+05,
         3.8200e+05, 3.8202e+05, 8.0052e+05, 3.8201e+05, 3.8202e+05, 7.8226e+05,
         3.8203e+05, 3.8202e+05, 7.8131e+05, 3.8204e+05],
        [3.9157e+05, 3.8630e+05, 4.0619e+05, 1.6143e+00, 3.8205e+05, 0.0000e+00,
         1.4728e+00, 1.5350e+00, 4.0034e+05, 1.4059e+00, 1.6958e+00, 3.8842e+05,
         1.5113e+00, 1.4544e+00, 4.0057e+05, 1.4737e+00],
        [3.9157e+05, 3.8629e+05, 4.0618e+05, 1.3713e+00, 3.8200e+05, 1.4728e+00,
         0.0000e+00, 1.5049e+00, 4.0036e+05, 1.5085e+00, 1.7691e+00, 3.8842e+05,
         1.4498e+00, 1.3994e+00, 4.0051e+05, 1.3594e+00],
        [3.9157e+05, 3.8626e+05, 4.0620e+05, 1.4627e+00, 3.8202e+05, 1.5350e+00,
         1.5049e+00, 0.0000e+00, 4.0038e+05, 1.4869e+00, 1.3546e+00, 3.8838e+05,
         1.5364e+00, 1.4695e+00, 4.0052e+05, 1.3658e+00],
        [7.7291e+05, 8.0152e+05, 8.0317e+05, 4.0033e+05, 8.0052e+05, 4.0034e+05,
         4.0036e+05, 4.0038e+05, 0.0000e+00, 4.0031e+05, 4.0038e+05, 7.9834e+05,
         4.0033e+05, 4.0034e+05, 8.1898e+05, 4.0033e+05],
        [3.9156e+05, 3.8630e+05, 4.0618e+05, 1.4736e+00, 3.8201e+05, 1.4059e+00,
         1.5085e+00, 1.4869e+00, 4.0031e+05, 0.0000e+00, 1.5832e+00, 3.8841e+05,
         1.5716e+00, 1.3824e+00, 4.0058e+05, 1.4121e+00],
        [3.9155e+05, 3.8629e+05, 4.0619e+05, 1.7460e+00, 3.8202e+05, 1.6958e+00,
         1.7691e+00, 1.3546e+00, 4.0038e+05, 1.5832e+00, 0.0000e+00, 3.8843e+05,
         1.6057e+00, 1.6229e+00, 4.0055e+05, 1.4395e+00],
        [7.9173e+05, 7.9699e+05, 7.9236e+05, 3.8839e+05, 7.8226e+05, 3.8842e+05,
         3.8842e+05, 3.8838e+05, 7.9834e+05, 3.8841e+05, 3.8843e+05, 0.0000e+00,
         3.8842e+05, 3.8843e+05, 7.9508e+05, 3.8841e+05],
        [3.9153e+05, 3.8627e+05, 4.0615e+05, 1.5588e+00, 3.8203e+05, 1.5113e+00,
         1.4498e+00, 1.5364e+00, 4.0033e+05, 1.5716e+00, 1.6057e+00, 3.8842e+05,
         0.0000e+00, 1.5046e+00, 4.0052e+05, 1.3960e+00],
        [3.9154e+05, 3.8630e+05, 4.0618e+05, 1.4084e+00, 3.8202e+05, 1.4544e+00,
         1.3994e+00, 1.4695e+00, 4.0034e+05, 1.3824e+00, 1.6229e+00, 3.8843e+05,
         1.5046e+00, 0.0000e+00, 4.0056e+05, 1.4009e+00],
        [7.9252e+05, 8.0110e+05, 7.9920e+05, 4.0057e+05, 7.8131e+05, 4.0057e+05,
         4.0051e+05, 4.0052e+05, 8.1898e+05, 4.0058e+05, 4.0055e+05, 7.9508e+05,
         4.0052e+05, 4.0056e+05, 0.0000e+00, 4.0057e+05],
        [3.9154e+05, 3.8628e+05, 4.0616e+05, 1.5092e+00, 3.8204e+05, 1.4737e+00,
         1.3594e+00, 1.3658e+00, 4.0033e+05, 1.4121e+00, 1.4395e+00, 3.8841e+05,
         1.3960e+00, 1.4009e+00, 4.0057e+05, 0.0000e+00]])
Krum scores: ['391551.19', '386282.84', '406174.66', '1.49', '382017.16', '1.50', '1.44', '1.45', '400333.72', '1.46', '1.58', '388406.03', '1.50', '1.43', '400543.00', '1.41']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [14, 13, 18, 8, 20, 5, 6, 4, 19, 3, 9, 15, 1, 12, 16, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0215s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:38...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:38, End: 2025-07-22 16:02:38)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 4, 6, 18, 14, 20, 19, 9, 2, 15, 1, 8, 11, 17, 13, 7], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4918e+00, 1.5026e+00, 3.7724e+05, 3.9865e+05, 3.8622e+05,
         3.8857e+05, 1.6278e+00, 1.6383e+00, 4.0307e+05, 1.5224e+00, 1.4296e+00,
         1.6480e+00, 4.0513e+05, 3.9224e+05, 1.4803e+00],
        [1.4918e+00, 0.0000e+00, 1.4691e+00, 3.7726e+05, 3.9865e+05, 3.8627e+05,
         3.8856e+05, 1.3022e+00, 1.3587e+00, 4.0303e+05, 1.4868e+00, 1.4396e+00,
         1.2510e+00, 4.0513e+05, 3.9225e+05, 1.4488e+00],
        [1.5026e+00, 1.4691e+00, 0.0000e+00, 3.7726e+05, 3.9863e+05, 3.8625e+05,
         3.8856e+05, 1.7337e+00, 1.6805e+00, 4.0304e+05, 1.4317e+00, 1.3883e+00,
         1.5794e+00, 4.0514e+05, 3.9225e+05, 1.4035e+00],
        [3.7724e+05, 3.7726e+05, 3.7726e+05, 0.0000e+00, 7.6122e+05, 7.5712e+05,
         7.8377e+05, 3.7726e+05, 3.7727e+05, 7.7943e+05, 3.7724e+05, 3.7727e+05,
         3.7726e+05, 7.9032e+05, 7.6872e+05, 3.7726e+05],
        [3.9865e+05, 3.9865e+05, 3.9863e+05, 7.6122e+05, 0.0000e+00, 8.0048e+05,
         7.9907e+05, 3.9861e+05, 3.9861e+05, 8.2622e+05, 3.9862e+05, 3.9861e+05,
         3.9862e+05, 8.0825e+05, 7.9512e+05, 3.9865e+05],
        [3.8622e+05, 3.8627e+05, 3.8625e+05, 7.5712e+05, 8.0048e+05, 0.0000e+00,
         7.8067e+05, 3.8626e+05, 3.8626e+05, 7.9029e+05, 3.8626e+05, 3.8628e+05,
         3.8625e+05, 7.9043e+05, 7.7245e+05, 3.8629e+05],
        [3.8857e+05, 3.8856e+05, 3.8856e+05, 7.8377e+05, 7.9907e+05, 7.8067e+05,
         0.0000e+00, 3.8854e+05, 3.8856e+05, 8.1116e+05, 3.8852e+05, 3.8854e+05,
         3.8856e+05, 7.9573e+05, 7.9841e+05, 3.8856e+05],
        [1.6278e+00, 1.3022e+00, 1.7337e+00, 3.7726e+05, 3.9861e+05, 3.8626e+05,
         3.8854e+05, 0.0000e+00, 1.2973e+00, 4.0304e+05, 1.5027e+00, 1.7169e+00,
         1.2172e+00, 4.0514e+05, 3.9226e+05, 1.6771e+00],
        [1.6383e+00, 1.3587e+00, 1.6805e+00, 3.7727e+05, 3.9861e+05, 3.8626e+05,
         3.8856e+05, 1.2973e+00, 0.0000e+00, 4.0308e+05, 1.6113e+00, 1.8253e+00,
         1.3472e+00, 4.0511e+05, 3.9225e+05, 1.6875e+00],
        [4.0307e+05, 4.0303e+05, 4.0304e+05, 7.7943e+05, 8.2622e+05, 7.9029e+05,
         8.1116e+05, 4.0304e+05, 4.0308e+05, 0.0000e+00, 4.0303e+05, 4.0306e+05,
         4.0306e+05, 7.9181e+05, 8.0930e+05, 4.0305e+05],
        [1.5224e+00, 1.4868e+00, 1.4317e+00, 3.7724e+05, 3.9862e+05, 3.8626e+05,
         3.8852e+05, 1.5027e+00, 1.6113e+00, 4.0303e+05, 0.0000e+00, 1.4836e+00,
         1.5313e+00, 4.0513e+05, 3.9225e+05, 1.4357e+00],
        [1.4296e+00, 1.4396e+00, 1.3883e+00, 3.7727e+05, 3.9861e+05, 3.8628e+05,
         3.8854e+05, 1.7169e+00, 1.8253e+00, 4.0306e+05, 1.4836e+00, 0.0000e+00,
         1.6329e+00, 4.0513e+05, 3.9226e+05, 1.4224e+00],
        [1.6480e+00, 1.2510e+00, 1.5794e+00, 3.7726e+05, 3.9862e+05, 3.8625e+05,
         3.8856e+05, 1.2172e+00, 1.3472e+00, 4.0306e+05, 1.5313e+00, 1.6329e+00,
         0.0000e+00, 4.0513e+05, 3.9225e+05, 1.6293e+00],
        [4.0513e+05, 4.0513e+05, 4.0514e+05, 7.9032e+05, 8.0825e+05, 7.9043e+05,
         7.9573e+05, 4.0514e+05, 4.0511e+05, 7.9181e+05, 4.0513e+05, 4.0513e+05,
         4.0513e+05, 0.0000e+00, 8.0190e+05, 4.0513e+05],
        [3.9224e+05, 3.9225e+05, 3.9225e+05, 7.6872e+05, 7.9512e+05, 7.7245e+05,
         7.9841e+05, 3.9226e+05, 3.9225e+05, 8.0930e+05, 3.9225e+05, 3.9226e+05,
         3.9225e+05, 8.0190e+05, 0.0000e+00, 3.9226e+05],
        [1.4803e+00, 1.4488e+00, 1.4035e+00, 3.7726e+05, 3.9865e+05, 3.8629e+05,
         3.8856e+05, 1.6771e+00, 1.6875e+00, 4.0305e+05, 1.4357e+00, 1.4224e+00,
         1.6293e+00, 4.0513e+05, 3.9226e+05, 0.0000e+00]])
Krum scores: ['1.53', '1.39', '1.49', '377253.56', '398621.16', '386252.28', '388549.94', '1.48', '1.52', '403047.41', '1.48', '1.50', '1.46', '405128.91', '392249.06', '1.50']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 4, 6, 18, 14, 20, 19, 9, 2, 15, 1, 8, 11, 17, 13, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:38...
global Accuracy on shared test data: 77.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 47 216]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:38, End: 2025-07-22 16:02:38)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 1, 19, 6, 14, 12, 3, 5, 9, 7, 8, 20, 11, 18, 17, 2], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8878e+05, 8.0436e+05, 3.8879e+05, 7.8328e+05, 3.8878e+05,
         3.8875e+05, 3.8877e+05, 3.8879e+05, 3.8878e+05, 3.8880e+05, 7.6022e+05,
         3.8878e+05, 7.9462e+05, 8.1006e+05, 3.8880e+05],
        [3.8878e+05, 0.0000e+00, 3.9255e+05, 1.3175e+00, 3.8284e+05, 1.3774e+00,
         1.4272e+00, 1.3955e+00, 1.4122e+00, 1.3613e+00, 1.3659e+00, 3.9096e+05,
         1.4074e+00, 4.0160e+05, 3.9637e+05, 1.3847e+00],
        [8.0436e+05, 3.9255e+05, 0.0000e+00, 3.9257e+05, 7.7903e+05, 3.9256e+05,
         3.9257e+05, 3.9254e+05, 3.9254e+05, 3.9255e+05, 3.9256e+05, 7.9999e+05,
         3.9254e+05, 7.8694e+05, 7.6867e+05, 3.9254e+05],
        [3.8879e+05, 1.3175e+00, 3.9257e+05, 0.0000e+00, 3.8281e+05, 1.3305e+00,
         1.3938e+00, 1.3913e+00, 1.5455e+00, 1.2961e+00, 1.2892e+00, 3.9092e+05,
         1.4715e+00, 4.0158e+05, 3.9633e+05, 1.4325e+00],
        [7.8328e+05, 3.8284e+05, 7.7903e+05, 3.8281e+05, 0.0000e+00, 3.8280e+05,
         3.8281e+05, 3.8281e+05, 3.8282e+05, 3.8281e+05, 3.8279e+05, 7.7064e+05,
         3.8282e+05, 7.9882e+05, 7.6583e+05, 3.8279e+05],
        [3.8878e+05, 1.3774e+00, 3.9256e+05, 1.3305e+00, 3.8280e+05, 0.0000e+00,
         1.2788e+00, 1.3606e+00, 1.4366e+00, 1.3775e+00, 1.3360e+00, 3.9096e+05,
         1.3847e+00, 4.0159e+05, 3.9632e+05, 1.3832e+00],
        [3.8875e+05, 1.4272e+00, 3.9257e+05, 1.3938e+00, 3.8281e+05, 1.2788e+00,
         0.0000e+00, 1.4035e+00, 1.4470e+00, 1.4123e+00, 1.3378e+00, 3.9096e+05,
         1.5263e+00, 4.0161e+05, 3.9633e+05, 1.3817e+00],
        [3.8877e+05, 1.3955e+00, 3.9254e+05, 1.3913e+00, 3.8281e+05, 1.3606e+00,
         1.4035e+00, 0.0000e+00, 1.5327e+00, 1.3241e+00, 1.4674e+00, 3.9092e+05,
         1.4750e+00, 4.0159e+05, 3.9633e+05, 1.5371e+00],
        [3.8879e+05, 1.4122e+00, 3.9254e+05, 1.5455e+00, 3.8282e+05, 1.4366e+00,
         1.4470e+00, 1.5327e+00, 0.0000e+00, 1.5854e+00, 1.5688e+00, 3.9095e+05,
         1.1270e+00, 4.0158e+05, 3.9634e+05, 1.1295e+00],
        [3.8878e+05, 1.3613e+00, 3.9255e+05, 1.2961e+00, 3.8281e+05, 1.3775e+00,
         1.4123e+00, 1.3241e+00, 1.5854e+00, 0.0000e+00, 1.3473e+00, 3.9094e+05,
         1.5563e+00, 4.0160e+05, 3.9635e+05, 1.4617e+00],
        [3.8880e+05, 1.3659e+00, 3.9256e+05, 1.2892e+00, 3.8279e+05, 1.3360e+00,
         1.3378e+00, 1.4674e+00, 1.5688e+00, 1.3473e+00, 0.0000e+00, 3.9097e+05,
         1.4783e+00, 4.0158e+05, 3.9636e+05, 1.5616e+00],
        [7.6022e+05, 3.9096e+05, 7.9999e+05, 3.9092e+05, 7.7064e+05, 3.9096e+05,
         3.9096e+05, 3.9092e+05, 3.9095e+05, 3.9094e+05, 3.9097e+05, 0.0000e+00,
         3.9093e+05, 8.0676e+05, 7.9263e+05, 3.9095e+05],
        [3.8878e+05, 1.4074e+00, 3.9254e+05, 1.4715e+00, 3.8282e+05, 1.3847e+00,
         1.5263e+00, 1.4750e+00, 1.1270e+00, 1.5563e+00, 1.4783e+00, 3.9093e+05,
         0.0000e+00, 4.0162e+05, 3.9632e+05, 1.1547e+00],
        [7.9462e+05, 4.0160e+05, 7.8694e+05, 4.0158e+05, 7.9882e+05, 4.0159e+05,
         4.0161e+05, 4.0159e+05, 4.0158e+05, 4.0160e+05, 4.0158e+05, 8.0676e+05,
         4.0162e+05, 0.0000e+00, 8.1957e+05, 4.0159e+05],
        [8.1006e+05, 3.9637e+05, 7.6867e+05, 3.9633e+05, 7.6583e+05, 3.9632e+05,
         3.9633e+05, 3.9633e+05, 3.9634e+05, 3.9635e+05, 3.9636e+05, 7.9263e+05,
         3.9632e+05, 8.1957e+05, 0.0000e+00, 3.9633e+05],
        [3.8880e+05, 1.3847e+00, 3.9254e+05, 1.4325e+00, 3.8279e+05, 1.3832e+00,
         1.3817e+00, 1.5371e+00, 1.1295e+00, 1.4617e+00, 1.5616e+00, 3.9095e+05,
         1.1547e+00, 4.0159e+05, 3.9633e+05, 0.0000e+00]])
Krum scores: ['388776.44', '1.38', '392547.81', '1.37', '382804.62', '1.35', '1.39', '1.42', '1.40', '1.39', '1.40', '390941.31', '1.38', '401588.97', '396330.97', '1.36']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 1, 19, 6, 14, 12, 3, 5, 9, 7, 8, 20, 11, 18, 17, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:39...
global Accuracy on shared test data: 74.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:39, End: 2025-07-22 16:02:39)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 18, 9, 8, 19, 20, 14, 1, 7, 5, 15, 6, 16, 4, 3, 11], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8209e+05, 1.1684e+00, 1.5216e+00, 3.7821e+05, 3.8588e+05,
         3.8202e+05, 1.4886e+00, 1.5586e+00, 1.5601e+00, 4.0442e+05, 1.5078e+00,
         4.1062e+05, 1.1993e+00, 1.3946e+00, 1.1969e+00],
        [3.8209e+05, 0.0000e+00, 3.8208e+05, 3.8209e+05, 7.5134e+05, 7.6819e+05,
         7.3386e+05, 3.8209e+05, 3.8209e+05, 3.8208e+05, 8.0442e+05, 3.8209e+05,
         7.9099e+05, 3.8208e+05, 3.8209e+05, 3.8210e+05],
        [1.1684e+00, 3.8208e+05, 0.0000e+00, 1.5957e+00, 3.7820e+05, 3.8589e+05,
         3.8202e+05, 1.4990e+00, 1.5834e+00, 1.5170e+00, 4.0443e+05, 1.5348e+00,
         4.1063e+05, 1.1812e+00, 1.4142e+00, 1.1489e+00],
        [1.5216e+00, 3.8209e+05, 1.5957e+00, 0.0000e+00, 3.7821e+05, 3.8592e+05,
         3.8202e+05, 1.4135e+00, 1.3197e+00, 1.4821e+00, 4.0442e+05, 1.3031e+00,
         4.1059e+05, 1.6734e+00, 1.3696e+00, 1.4954e+00],
        [3.7821e+05, 7.5134e+05, 3.7820e+05, 3.7821e+05, 0.0000e+00, 7.7430e+05,
         7.6238e+05, 3.7822e+05, 3.7821e+05, 3.7825e+05, 7.8341e+05, 3.7824e+05,
         7.8599e+05, 3.7820e+05, 3.7820e+05, 3.7821e+05],
        [3.8588e+05, 7.6819e+05, 3.8589e+05, 3.8592e+05, 7.7430e+05, 0.0000e+00,
         7.5727e+05, 3.8590e+05, 3.8588e+05, 3.8592e+05, 8.0119e+05, 3.8593e+05,
         7.9450e+05, 3.8587e+05, 3.8591e+05, 3.8590e+05],
        [3.8202e+05, 7.3386e+05, 3.8202e+05, 3.8202e+05, 7.6238e+05, 7.5727e+05,
         0.0000e+00, 3.8199e+05, 3.8201e+05, 3.8201e+05, 7.9918e+05, 3.8202e+05,
         7.9819e+05, 3.8203e+05, 3.8200e+05, 3.8203e+05],
        [1.4886e+00, 3.8209e+05, 1.4990e+00, 1.4135e+00, 3.7822e+05, 3.8590e+05,
         3.8199e+05, 0.0000e+00, 1.3754e+00, 1.4609e+00, 4.0444e+05, 1.3322e+00,
         4.1061e+05, 1.6488e+00, 1.4695e+00, 1.4371e+00],
        [1.5586e+00, 3.8209e+05, 1.5834e+00, 1.3197e+00, 3.7821e+05, 3.8588e+05,
         3.8201e+05, 1.3754e+00, 0.0000e+00, 1.2825e+00, 4.0447e+05, 1.2987e+00,
         4.1060e+05, 1.6903e+00, 1.3974e+00, 1.4791e+00],
        [1.5601e+00, 3.8208e+05, 1.5170e+00, 1.4821e+00, 3.7825e+05, 3.8592e+05,
         3.8201e+05, 1.4609e+00, 1.2825e+00, 0.0000e+00, 4.0444e+05, 1.3825e+00,
         4.1065e+05, 1.7326e+00, 1.3527e+00, 1.5170e+00],
        [4.0442e+05, 8.0442e+05, 4.0443e+05, 4.0442e+05, 7.8341e+05, 8.0119e+05,
         7.9918e+05, 4.0444e+05, 4.0447e+05, 4.0444e+05, 0.0000e+00, 4.0444e+05,
         8.0413e+05, 4.0440e+05, 4.0445e+05, 4.0443e+05],
        [1.5078e+00, 3.8209e+05, 1.5348e+00, 1.3031e+00, 3.7824e+05, 3.8593e+05,
         3.8202e+05, 1.3322e+00, 1.2987e+00, 1.3825e+00, 4.0444e+05, 0.0000e+00,
         4.1063e+05, 1.6390e+00, 1.4141e+00, 1.4475e+00],
        [4.1062e+05, 7.9099e+05, 4.1063e+05, 4.1059e+05, 7.8599e+05, 7.9450e+05,
         7.9819e+05, 4.1061e+05, 4.1060e+05, 4.1065e+05, 8.0413e+05, 4.1063e+05,
         0.0000e+00, 4.1064e+05, 4.1059e+05, 4.1061e+05],
        [1.1993e+00, 3.8208e+05, 1.1812e+00, 1.6734e+00, 3.7820e+05, 3.8587e+05,
         3.8203e+05, 1.6488e+00, 1.6903e+00, 1.7326e+00, 4.0440e+05, 1.6390e+00,
         4.1064e+05, 0.0000e+00, 1.6034e+00, 1.1398e+00],
        [1.3946e+00, 3.8209e+05, 1.4142e+00, 1.3696e+00, 3.7820e+05, 3.8591e+05,
         3.8200e+05, 1.4695e+00, 1.3974e+00, 1.3527e+00, 4.0445e+05, 1.4141e+00,
         4.1059e+05, 1.6034e+00, 0.0000e+00, 1.4997e+00],
        [1.1969e+00, 3.8210e+05, 1.1489e+00, 1.4954e+00, 3.7821e+05, 3.8590e+05,
         3.8203e+05, 1.4371e+00, 1.4791e+00, 1.5170e+00, 4.0443e+05, 1.4475e+00,
         4.1061e+05, 1.1398e+00, 1.4997e+00, 0.0000e+00]])
Krum scores: ['1.38', '382086.19', '1.38', '1.44', '378208.34', '385893.25', '382010.41', '1.43', '1.41', '1.44', '404428.16', '1.40', '410610.75', '1.47', '1.41', '1.36']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [10, 18, 9, 8, 19, 20, 14, 1, 7, 5, 15, 6, 16, 4, 3, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:39...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [ 47 216]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:39, End: 2025-07-22 16:02:39)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 8, 17, 14, 20, 6, 16, 11, 5, 2, 19, 7, 1, 4, 9, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2121e+00, 4.0343e+05, 4.0578e+05, 3.9063e+05, 1.2763e+00,
         4.0152e+05, 1.7508e+00, 1.1697e+00, 1.2333e+00, 3.9394e+05, 1.2444e+00,
         1.2803e+00, 1.3762e+00, 1.3016e+00, 4.0616e+05],
        [1.2121e+00, 0.0000e+00, 4.0340e+05, 4.0577e+05, 3.9062e+05, 1.1582e+00,
         4.0156e+05, 1.8490e+00, 1.2663e+00, 1.3720e+00, 3.9394e+05, 1.2076e+00,
         1.2437e+00, 1.4521e+00, 1.4514e+00, 4.0613e+05],
        [4.0343e+05, 4.0340e+05, 0.0000e+00, 8.2000e+05, 7.7690e+05, 4.0342e+05,
         8.0721e+05, 4.0340e+05, 4.0344e+05, 4.0340e+05, 8.3027e+05, 4.0345e+05,
         4.0343e+05, 4.0342e+05, 4.0341e+05, 8.1279e+05],
        [4.0578e+05, 4.0577e+05, 8.2000e+05, 0.0000e+00, 7.7037e+05, 4.0578e+05,
         8.0256e+05, 4.0578e+05, 4.0577e+05, 4.0582e+05, 7.9421e+05, 4.0578e+05,
         4.0578e+05, 4.0577e+05, 4.0577e+05, 8.0820e+05],
        [3.9063e+05, 3.9062e+05, 7.7690e+05, 7.7037e+05, 0.0000e+00, 3.9067e+05,
         7.9186e+05, 3.9063e+05, 3.9064e+05, 3.9064e+05, 7.8572e+05, 3.9063e+05,
         3.9064e+05, 3.9063e+05, 3.9064e+05, 8.0280e+05],
        [1.2763e+00, 1.1582e+00, 4.0342e+05, 4.0578e+05, 3.9067e+05, 0.0000e+00,
         4.0155e+05, 1.7455e+00, 1.2190e+00, 1.2764e+00, 3.9395e+05, 1.2077e+00,
         1.1986e+00, 1.4137e+00, 1.4303e+00, 4.0614e+05],
        [4.0152e+05, 4.0156e+05, 8.0721e+05, 8.0256e+05, 7.9186e+05, 4.0155e+05,
         0.0000e+00, 4.0153e+05, 4.0156e+05, 4.0154e+05, 7.8093e+05, 4.0155e+05,
         4.0154e+05, 4.0154e+05, 4.0153e+05, 8.0515e+05],
        [1.7508e+00, 1.8490e+00, 4.0340e+05, 4.0578e+05, 3.9063e+05, 1.7455e+00,
         4.0153e+05, 0.0000e+00, 1.7464e+00, 1.2226e+00, 3.9394e+05, 1.8152e+00,
         1.7009e+00, 1.0502e+00, 1.2302e+00, 4.0613e+05],
        [1.1697e+00, 1.2663e+00, 4.0344e+05, 4.0577e+05, 3.9064e+05, 1.2190e+00,
         4.0156e+05, 1.7464e+00, 0.0000e+00, 1.3222e+00, 3.9394e+05, 1.1277e+00,
         1.2226e+00, 1.4136e+00, 1.3370e+00, 4.0613e+05],
        [1.2333e+00, 1.3720e+00, 4.0340e+05, 4.0582e+05, 3.9064e+05, 1.2764e+00,
         4.0154e+05, 1.2226e+00, 1.3222e+00, 0.0000e+00, 3.9397e+05, 1.2692e+00,
         1.2248e+00, 1.0441e+00, 1.0578e+00, 4.0613e+05],
        [3.9394e+05, 3.9394e+05, 8.3027e+05, 7.9421e+05, 7.8572e+05, 3.9395e+05,
         7.8093e+05, 3.9394e+05, 3.9394e+05, 3.9397e+05, 0.0000e+00, 3.9394e+05,
         3.9392e+05, 3.9394e+05, 3.9395e+05, 7.9566e+05],
        [1.2444e+00, 1.2076e+00, 4.0345e+05, 4.0578e+05, 3.9063e+05, 1.2077e+00,
         4.0155e+05, 1.8152e+00, 1.1277e+00, 1.2692e+00, 3.9394e+05, 0.0000e+00,
         1.2292e+00, 1.4684e+00, 1.4149e+00, 4.0614e+05],
        [1.2803e+00, 1.2437e+00, 4.0343e+05, 4.0578e+05, 3.9064e+05, 1.1986e+00,
         4.0154e+05, 1.7009e+00, 1.2226e+00, 1.2248e+00, 3.9392e+05, 1.2292e+00,
         0.0000e+00, 1.3834e+00, 1.3010e+00, 4.0612e+05],
        [1.3762e+00, 1.4521e+00, 4.0342e+05, 4.0577e+05, 3.9063e+05, 1.4137e+00,
         4.0154e+05, 1.0502e+00, 1.4136e+00, 1.0441e+00, 3.9394e+05, 1.4684e+00,
         1.3834e+00, 0.0000e+00, 1.0618e+00, 4.0610e+05],
        [1.3016e+00, 1.4514e+00, 4.0341e+05, 4.0577e+05, 3.9064e+05, 1.4303e+00,
         4.0153e+05, 1.2302e+00, 1.3370e+00, 1.0578e+00, 3.9395e+05, 1.4149e+00,
         1.3010e+00, 1.0618e+00, 0.0000e+00, 4.0612e+05],
        [4.0616e+05, 4.0613e+05, 8.1279e+05, 8.0820e+05, 8.0280e+05, 4.0614e+05,
         8.0515e+05, 4.0613e+05, 4.0613e+05, 4.0613e+05, 7.9566e+05, 4.0614e+05,
         4.0612e+05, 4.0610e+05, 4.0612e+05, 0.0000e+00]])
Krum scores: ['1.26', '1.30', '403415.38', '405772.69', '390632.38', '1.27', '401539.47', '1.53', '1.26', '1.21', '393938.84', '1.27', '1.26', '1.27', '1.27', '406125.03']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 8, 17, 14, 20, 6, 16, 11, 5, 2, 19, 7, 1, 4, 9, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:40...
global Accuracy on shared test data: 75.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:40, End: 2025-07-22 16:02:40)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 19, 13, 16, 6, 12, 2, 14, 18, 15, 17, 8, 7, 5, 3, 1], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.3259e+05, 7.3488e+05, 7.5259e+05, 3.6516e+05, 3.6517e+05,
         3.6520e+05, 7.4862e+05, 7.4541e+05, 7.5138e+05, 7.7276e+05, 3.6518e+05,
         3.6517e+05, 3.6519e+05, 3.6520e+05, 3.6519e+05],
        [7.3259e+05, 0.0000e+00, 7.7999e+05, 7.6340e+05, 3.7924e+05, 3.7922e+05,
         3.7923e+05, 7.6283e+05, 7.8770e+05, 7.5538e+05, 7.5922e+05, 3.7925e+05,
         3.7922e+05, 3.7924e+05, 3.7920e+05, 3.7924e+05],
        [7.3488e+05, 7.7999e+05, 0.0000e+00, 7.8065e+05, 3.9340e+05, 3.9337e+05,
         3.9340e+05, 7.8877e+05, 7.6874e+05, 7.6186e+05, 7.8303e+05, 3.9340e+05,
         3.9342e+05, 3.9342e+05, 3.9341e+05, 3.9339e+05],
        [7.5259e+05, 7.6340e+05, 7.8065e+05, 0.0000e+00, 3.9608e+05, 3.9609e+05,
         3.9612e+05, 7.9862e+05, 7.7917e+05, 7.5356e+05, 8.0540e+05, 3.9608e+05,
         3.9609e+05, 3.9608e+05, 3.9608e+05, 3.9610e+05],
        [3.6516e+05, 3.7924e+05, 3.9340e+05, 3.9608e+05, 0.0000e+00, 1.2083e+00,
         1.6417e+00, 3.8572e+05, 3.9595e+05, 3.7726e+05, 3.9254e+05, 1.1104e+00,
         1.1287e+00, 1.1991e+00, 1.2068e+00, 1.1344e+00],
        [3.6517e+05, 3.7922e+05, 3.9337e+05, 3.9609e+05, 1.2083e+00, 0.0000e+00,
         1.1899e+00, 3.8574e+05, 3.9597e+05, 3.7723e+05, 3.9253e+05, 1.2584e+00,
         1.2640e+00, 1.2608e+00, 1.1279e+00, 1.1915e+00],
        [3.6520e+05, 3.7923e+05, 3.9340e+05, 3.9612e+05, 1.6417e+00, 1.1899e+00,
         0.0000e+00, 3.8574e+05, 3.9597e+05, 3.7719e+05, 3.9254e+05, 1.7655e+00,
         1.6673e+00, 1.7625e+00, 1.5793e+00, 1.5452e+00],
        [7.4862e+05, 7.6283e+05, 7.8877e+05, 7.9862e+05, 3.8572e+05, 3.8574e+05,
         3.8574e+05, 0.0000e+00, 7.5749e+05, 7.6069e+05, 7.7637e+05, 3.8570e+05,
         3.8571e+05, 3.8574e+05, 3.8576e+05, 3.8570e+05],
        [7.4541e+05, 7.8770e+05, 7.6874e+05, 7.7917e+05, 3.9595e+05, 3.9597e+05,
         3.9597e+05, 7.5749e+05, 0.0000e+00, 7.7623e+05, 8.0119e+05, 3.9598e+05,
         3.9598e+05, 3.9597e+05, 3.9599e+05, 3.9596e+05],
        [7.5138e+05, 7.5538e+05, 7.6186e+05, 7.5356e+05, 3.7726e+05, 3.7723e+05,
         3.7719e+05, 7.6069e+05, 7.7623e+05, 0.0000e+00, 7.6120e+05, 3.7725e+05,
         3.7725e+05, 3.7727e+05, 3.7723e+05, 3.7726e+05],
        [7.7276e+05, 7.5922e+05, 7.8303e+05, 8.0540e+05, 3.9254e+05, 3.9253e+05,
         3.9254e+05, 7.7637e+05, 8.0119e+05, 7.6120e+05, 0.0000e+00, 3.9254e+05,
         3.9253e+05, 3.9255e+05, 3.9254e+05, 3.9254e+05],
        [3.6518e+05, 3.7925e+05, 3.9340e+05, 3.9608e+05, 1.1104e+00, 1.2584e+00,
         1.7655e+00, 3.8570e+05, 3.9598e+05, 3.7725e+05, 3.9254e+05, 0.0000e+00,
         1.1476e+00, 1.2802e+00, 1.1702e+00, 1.1738e+00],
        [3.6517e+05, 3.7922e+05, 3.9342e+05, 3.9609e+05, 1.1287e+00, 1.2640e+00,
         1.6673e+00, 3.8571e+05, 3.9598e+05, 3.7725e+05, 3.9253e+05, 1.1476e+00,
         0.0000e+00, 1.1363e+00, 1.2063e+00, 1.1752e+00],
        [3.6519e+05, 3.7924e+05, 3.9342e+05, 3.9608e+05, 1.1991e+00, 1.2608e+00,
         1.7625e+00, 3.8574e+05, 3.9597e+05, 3.7727e+05, 3.9255e+05, 1.2802e+00,
         1.1363e+00, 0.0000e+00, 1.1946e+00, 1.2132e+00],
        [3.6520e+05, 3.7920e+05, 3.9341e+05, 3.9608e+05, 1.2068e+00, 1.1279e+00,
         1.5793e+00, 3.8576e+05, 3.9599e+05, 3.7723e+05, 3.9254e+05, 1.1702e+00,
         1.2063e+00, 1.1946e+00, 0.0000e+00, 1.2106e+00],
        [3.6519e+05, 3.7924e+05, 3.9339e+05, 3.9610e+05, 1.1344e+00, 1.1915e+00,
         1.5452e+00, 3.8570e+05, 3.9596e+05, 3.7726e+05, 3.9254e+05, 1.1738e+00,
         1.1752e+00, 1.2132e+00, 1.2106e+00, 0.0000e+00]])
Krum scores: ['365175.47', '379224.97', '393395.09', '396083.91', '1.16', '1.21', '1.56', '385718.41', '395967.00', '377234.09', '392536.00', '1.19', '1.18', '1.21', '1.19', '1.18']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 19, 13, 16, 6, 12, 2, 14, 18, 15, 17, 8, 7, 5, 3, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:41...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:41, End: 2025-07-22 16:02:41)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 18, 7, 1, 2, 9, 8, 11, 4, 15, 20, 10, 5, 16, 13, 17], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7759e+05, 1.5105e+00, 1.3775e+00, 1.1795e+00, 1.3311e+00,
         1.4956e+00, 1.2297e+00, 1.2333e+00, 4.0300e+05, 3.8290e+05, 1.2656e+00,
         1.5006e+00, 3.8224e+05, 3.8452e+05, 3.9602e+05],
        [3.7759e+05, 0.0000e+00, 3.7758e+05, 3.7761e+05, 3.7760e+05, 3.7760e+05,
         3.7760e+05, 3.7761e+05, 3.7759e+05, 7.9588e+05, 7.6041e+05, 3.7761e+05,
         3.7758e+05, 7.6222e+05, 7.6983e+05, 7.6248e+05],
        [1.5105e+00, 3.7758e+05, 0.0000e+00, 1.3421e+00, 1.5732e+00, 1.5097e+00,
         1.3280e+00, 1.7094e+00, 1.5728e+00, 4.0294e+05, 3.8290e+05, 1.4578e+00,
         1.2730e+00, 3.8226e+05, 3.8452e+05, 3.9601e+05],
        [1.3775e+00, 3.7761e+05, 1.3421e+00, 0.0000e+00, 1.4985e+00, 1.3730e+00,
         1.3259e+00, 1.5324e+00, 1.4076e+00, 4.0293e+05, 3.8293e+05, 1.3529e+00,
         1.3310e+00, 3.8224e+05, 3.8450e+05, 3.9599e+05],
        [1.1795e+00, 3.7760e+05, 1.5732e+00, 1.4985e+00, 0.0000e+00, 1.0799e+00,
         1.7173e+00, 9.7871e-01, 1.0249e+00, 4.0298e+05, 3.8290e+05, 1.1400e+00,
         1.6652e+00, 3.8226e+05, 3.8455e+05, 3.9601e+05],
        [1.3311e+00, 3.7760e+05, 1.5097e+00, 1.3730e+00, 1.0799e+00, 0.0000e+00,
         1.5802e+00, 1.1733e+00, 1.1518e+00, 4.0293e+05, 3.8294e+05, 1.1544e+00,
         1.4867e+00, 3.8227e+05, 3.8456e+05, 3.9599e+05],
        [1.4956e+00, 3.7760e+05, 1.3280e+00, 1.3259e+00, 1.7173e+00, 1.5802e+00,
         0.0000e+00, 1.7421e+00, 1.5285e+00, 4.0297e+05, 3.8294e+05, 1.4676e+00,
         1.4103e+00, 3.8225e+05, 3.8450e+05, 3.9603e+05],
        [1.2297e+00, 3.7761e+05, 1.7094e+00, 1.5324e+00, 9.7871e-01, 1.1733e+00,
         1.7421e+00, 0.0000e+00, 1.0128e+00, 4.0295e+05, 3.8294e+05, 1.1894e+00,
         1.6753e+00, 3.8227e+05, 3.8453e+05, 3.9602e+05],
        [1.2333e+00, 3.7759e+05, 1.5728e+00, 1.4076e+00, 1.0249e+00, 1.1518e+00,
         1.5285e+00, 1.0128e+00, 0.0000e+00, 4.0296e+05, 3.8291e+05, 1.1371e+00,
         1.5837e+00, 3.8225e+05, 3.8452e+05, 3.9602e+05],
        [4.0300e+05, 7.9588e+05, 4.0294e+05, 4.0293e+05, 4.0298e+05, 4.0293e+05,
         4.0297e+05, 4.0295e+05, 4.0296e+05, 0.0000e+00, 7.8599e+05, 4.0294e+05,
         4.0290e+05, 7.8252e+05, 7.8769e+05, 8.0010e+05],
        [3.8290e+05, 7.6041e+05, 3.8290e+05, 3.8293e+05, 3.8290e+05, 3.8294e+05,
         3.8294e+05, 3.8294e+05, 3.8291e+05, 7.8599e+05, 0.0000e+00, 3.8290e+05,
         3.8291e+05, 7.4456e+05, 7.3899e+05, 7.8442e+05],
        [1.2656e+00, 3.7761e+05, 1.4578e+00, 1.3529e+00, 1.1400e+00, 1.1544e+00,
         1.4676e+00, 1.1894e+00, 1.1371e+00, 4.0294e+05, 3.8290e+05, 0.0000e+00,
         1.4554e+00, 3.8222e+05, 3.8453e+05, 3.9602e+05],
        [1.5006e+00, 3.7758e+05, 1.2730e+00, 1.3310e+00, 1.6652e+00, 1.4867e+00,
         1.4103e+00, 1.6753e+00, 1.5837e+00, 4.0290e+05, 3.8291e+05, 1.4554e+00,
         0.0000e+00, 3.8223e+05, 3.8451e+05, 3.9598e+05],
        [3.8224e+05, 7.6222e+05, 3.8226e+05, 3.8224e+05, 3.8226e+05, 3.8227e+05,
         3.8225e+05, 3.8227e+05, 3.8225e+05, 7.8252e+05, 7.4456e+05, 3.8222e+05,
         3.8223e+05, 0.0000e+00, 7.7385e+05, 7.7436e+05],
        [3.8452e+05, 7.6983e+05, 3.8452e+05, 3.8450e+05, 3.8455e+05, 3.8456e+05,
         3.8450e+05, 3.8453e+05, 3.8452e+05, 7.8769e+05, 7.3899e+05, 3.8453e+05,
         3.8451e+05, 7.7385e+05, 0.0000e+00, 7.8230e+05],
        [3.9602e+05, 7.6248e+05, 3.9601e+05, 3.9599e+05, 3.9601e+05, 3.9599e+05,
         3.9603e+05, 3.9602e+05, 3.9602e+05, 8.0010e+05, 7.8442e+05, 3.9602e+05,
         3.9598e+05, 7.7436e+05, 7.8230e+05, 0.0000e+00]])
Krum scores: ['1.33', '377593.19', '1.45', '1.38', '1.27', '1.28', '1.48', '1.31', '1.26', '402940.28', '382912.78', '1.27', '1.46', '382245.50', '384516.75', '396004.62']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 18, 7, 1, 2, 9, 8, 11, 4, 15, 20, 10, 5, 16, 13, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0057s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:41...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:41, End: 2025-07-22 16:02:41)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 16, 3, 7, 2, 20, 15, 14, 4, 8, 6, 13, 9, 12, 17, 5], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9026e+05, 1.1409e+00, 1.1728e+00, 1.2875e+00, 3.9134e+05,
         4.0890e+05, 3.9526e+05, 1.6136e+00, 1.1354e+00, 1.1129e+00, 3.8755e+05,
         1.1832e+00, 1.1707e+00, 3.9812e+05, 1.1535e+00],
        [3.9026e+05, 0.0000e+00, 3.9026e+05, 3.9024e+05, 3.9026e+05, 7.5981e+05,
         7.8618e+05, 7.9203e+05, 3.9024e+05, 3.9022e+05, 3.9025e+05, 7.8283e+05,
         3.9024e+05, 3.9023e+05, 8.0277e+05, 3.9026e+05],
        [1.1409e+00, 3.9026e+05, 0.0000e+00, 1.1517e+00, 1.2768e+00, 3.9133e+05,
         4.0892e+05, 3.9527e+05, 1.6468e+00, 1.1096e+00, 1.1617e+00, 3.8755e+05,
         1.1916e+00, 1.0976e+00, 3.9807e+05, 1.1350e+00],
        [1.1728e+00, 3.9024e+05, 1.1517e+00, 0.0000e+00, 1.3708e+00, 3.9135e+05,
         4.0888e+05, 3.9526e+05, 1.8670e+00, 1.1357e+00, 1.1987e+00, 3.8754e+05,
         1.3185e+00, 1.2666e+00, 3.9810e+05, 1.1159e+00],
        [1.2875e+00, 3.9026e+05, 1.2768e+00, 1.3708e+00, 0.0000e+00, 3.9135e+05,
         4.0888e+05, 3.9527e+05, 9.6698e-01, 1.4223e+00, 1.0315e+00, 3.8760e+05,
         9.5808e-01, 1.0083e+00, 3.9811e+05, 1.4002e+00],
        [3.9134e+05, 7.5981e+05, 3.9133e+05, 3.9135e+05, 3.9135e+05, 0.0000e+00,
         8.0640e+05, 7.9781e+05, 3.9136e+05, 3.9134e+05, 3.9131e+05, 7.8173e+05,
         3.9135e+05, 3.9134e+05, 7.9401e+05, 3.9132e+05],
        [4.0890e+05, 7.8618e+05, 4.0892e+05, 4.0888e+05, 4.0888e+05, 8.0640e+05,
         0.0000e+00, 8.2520e+05, 4.0891e+05, 4.0889e+05, 4.0891e+05, 7.9773e+05,
         4.0890e+05, 4.0890e+05, 8.0542e+05, 4.0890e+05],
        [3.9526e+05, 7.9203e+05, 3.9527e+05, 3.9526e+05, 3.9527e+05, 7.9781e+05,
         8.2520e+05, 0.0000e+00, 3.9524e+05, 3.9525e+05, 3.9527e+05, 7.9090e+05,
         3.9526e+05, 3.9528e+05, 7.8308e+05, 3.9524e+05],
        [1.6136e+00, 3.9024e+05, 1.6468e+00, 1.8670e+00, 9.6698e-01, 3.9136e+05,
         4.0891e+05, 3.9524e+05, 0.0000e+00, 1.8001e+00, 1.3484e+00, 3.8758e+05,
         1.1873e+00, 1.1968e+00, 3.9809e+05, 1.8219e+00],
        [1.1354e+00, 3.9022e+05, 1.1096e+00, 1.1357e+00, 1.4223e+00, 3.9134e+05,
         4.0889e+05, 3.9525e+05, 1.8001e+00, 0.0000e+00, 1.1727e+00, 3.8753e+05,
         1.3178e+00, 1.2294e+00, 3.9810e+05, 1.1919e+00],
        [1.1129e+00, 3.9025e+05, 1.1617e+00, 1.1987e+00, 1.0315e+00, 3.9131e+05,
         4.0891e+05, 3.9527e+05, 1.3484e+00, 1.1727e+00, 0.0000e+00, 3.8753e+05,
         1.0854e+00, 1.0232e+00, 3.9810e+05, 1.1974e+00],
        [3.8755e+05, 7.8283e+05, 3.8755e+05, 3.8754e+05, 3.8760e+05, 7.8173e+05,
         7.9773e+05, 7.9090e+05, 3.8758e+05, 3.8753e+05, 3.8753e+05, 0.0000e+00,
         3.8756e+05, 3.8757e+05, 7.9838e+05, 3.8756e+05],
        [1.1832e+00, 3.9024e+05, 1.1916e+00, 1.3185e+00, 9.5808e-01, 3.9135e+05,
         4.0890e+05, 3.9526e+05, 1.1873e+00, 1.3178e+00, 1.0854e+00, 3.8756e+05,
         0.0000e+00, 1.0541e+00, 3.9812e+05, 1.2737e+00],
        [1.1707e+00, 3.9023e+05, 1.0976e+00, 1.2666e+00, 1.0083e+00, 3.9134e+05,
         4.0890e+05, 3.9528e+05, 1.1968e+00, 1.2294e+00, 1.0232e+00, 3.8757e+05,
         1.0541e+00, 0.0000e+00, 3.9809e+05, 1.1908e+00],
        [3.9812e+05, 8.0277e+05, 3.9807e+05, 3.9810e+05, 3.9811e+05, 7.9401e+05,
         8.0542e+05, 7.8308e+05, 3.9809e+05, 3.9810e+05, 3.9810e+05, 7.9838e+05,
         3.9812e+05, 3.9809e+05, 0.0000e+00, 3.9813e+05],
        [1.1535e+00, 3.9026e+05, 1.1350e+00, 1.1159e+00, 1.4002e+00, 3.9132e+05,
         4.0890e+05, 3.9524e+05, 1.8219e+00, 1.1919e+00, 1.1974e+00, 3.8756e+05,
         1.2737e+00, 1.1908e+00, 3.9813e+05, 0.0000e+00]])
Krum scores: ['1.17', '390241.38', '1.16', '1.22', '1.16', '391334.25', '408894.50', '395255.75', '1.45', '1.21', '1.12', '387548.88', '1.16', '1.12', '398096.44', '1.21']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 16, 3, 7, 2, 20, 15, 14, 4, 8, 6, 13, 9, 12, 17, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0200s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:42...
global Accuracy on shared test data: 73.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:42, End: 2025-07-22 16:02:42)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 8, 17, 18, 15, 16, 2, 19, 12, 3, 6, 4, 20, 14, 5, 13], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2702e+00, 3.9617e+05, 3.8464e+05, 3.9461e+05, 3.8344e+05,
         9.1875e-01, 3.8873e+05, 1.1899e+00, 1.1491e+00, 1.0415e+00, 9.6340e-01,
         3.9320e+05, 3.9436e+05, 1.2182e+00, 3.7844e+05],
        [1.2702e+00, 0.0000e+00, 3.9618e+05, 3.8463e+05, 3.9459e+05, 3.8345e+05,
         1.3427e+00, 3.8873e+05, 1.6767e+00, 1.0546e+00, 1.0678e+00, 1.4096e+00,
         3.9321e+05, 3.9433e+05, 1.1457e+00, 3.7842e+05],
        [3.9617e+05, 3.9618e+05, 0.0000e+00, 7.5995e+05, 8.0254e+05, 7.7272e+05,
         3.9616e+05, 7.9564e+05, 3.9614e+05, 3.9617e+05, 3.9616e+05, 3.9617e+05,
         7.8505e+05, 7.6251e+05, 3.9616e+05, 7.4774e+05],
        [3.8464e+05, 3.8463e+05, 7.5995e+05, 0.0000e+00, 7.8567e+05, 7.6155e+05,
         3.8464e+05, 7.7142e+05, 3.8464e+05, 3.8465e+05, 3.8466e+05, 3.8463e+05,
         7.7858e+05, 8.0012e+05, 3.8463e+05, 7.6838e+05],
        [3.9461e+05, 3.9459e+05, 8.0254e+05, 7.8567e+05, 0.0000e+00, 7.5395e+05,
         3.9461e+05, 7.8828e+05, 3.9461e+05, 3.9462e+05, 3.9459e+05, 3.9462e+05,
         7.9570e+05, 8.0774e+05, 3.9459e+05, 7.7081e+05],
        [3.8344e+05, 3.8345e+05, 7.7272e+05, 7.6155e+05, 7.5395e+05, 0.0000e+00,
         3.8343e+05, 7.8903e+05, 3.8343e+05, 3.8344e+05, 3.8342e+05, 3.8342e+05,
         7.6418e+05, 7.9906e+05, 3.8342e+05, 7.7223e+05],
        [9.1875e-01, 1.3427e+00, 3.9616e+05, 3.8464e+05, 3.9461e+05, 3.8343e+05,
         0.0000e+00, 3.8875e+05, 9.9708e-01, 1.1713e+00, 9.9148e-01, 7.9607e-01,
         3.9320e+05, 3.9436e+05, 1.3307e+00, 3.7845e+05],
        [3.8873e+05, 3.8873e+05, 7.9564e+05, 7.7142e+05, 7.8828e+05, 7.8903e+05,
         3.8875e+05, 0.0000e+00, 3.8874e+05, 3.8873e+05, 3.8874e+05, 3.8875e+05,
         7.9122e+05, 7.9029e+05, 3.8877e+05, 7.8071e+05],
        [1.1899e+00, 1.6767e+00, 3.9614e+05, 3.8464e+05, 3.9461e+05, 3.8343e+05,
         9.9708e-01, 3.8874e+05, 0.0000e+00, 1.4877e+00, 1.2653e+00, 9.1712e-01,
         3.9317e+05, 3.9439e+05, 1.6495e+00, 3.7846e+05],
        [1.1491e+00, 1.0546e+00, 3.9617e+05, 3.8465e+05, 3.9462e+05, 3.8344e+05,
         1.1713e+00, 3.8873e+05, 1.4877e+00, 0.0000e+00, 1.1009e+00, 1.3134e+00,
         3.9320e+05, 3.9436e+05, 1.0860e+00, 3.7845e+05],
        [1.0415e+00, 1.0678e+00, 3.9616e+05, 3.8466e+05, 3.9459e+05, 3.8342e+05,
         9.9148e-01, 3.8874e+05, 1.2653e+00, 1.1009e+00, 0.0000e+00, 1.0647e+00,
         3.9319e+05, 3.9435e+05, 1.1168e+00, 3.7845e+05],
        [9.6340e-01, 1.4096e+00, 3.9617e+05, 3.8463e+05, 3.9462e+05, 3.8342e+05,
         7.9607e-01, 3.8875e+05, 9.1712e-01, 1.3134e+00, 1.0647e+00, 0.0000e+00,
         3.9319e+05, 3.9439e+05, 1.4697e+00, 3.7844e+05],
        [3.9320e+05, 3.9321e+05, 7.8505e+05, 7.7858e+05, 7.9570e+05, 7.6418e+05,
         3.9320e+05, 7.9122e+05, 3.9317e+05, 3.9320e+05, 3.9319e+05, 3.9319e+05,
         0.0000e+00, 8.0639e+05, 3.9320e+05, 7.8110e+05],
        [3.9436e+05, 3.9433e+05, 7.6251e+05, 8.0012e+05, 8.0774e+05, 7.9906e+05,
         3.9436e+05, 7.9029e+05, 3.9439e+05, 3.9436e+05, 3.9435e+05, 3.9439e+05,
         8.0639e+05, 0.0000e+00, 3.9437e+05, 7.9104e+05],
        [1.2182e+00, 1.1457e+00, 3.9616e+05, 3.8463e+05, 3.9459e+05, 3.8342e+05,
         1.3307e+00, 3.8877e+05, 1.6495e+00, 1.0860e+00, 1.1168e+00, 1.4697e+00,
         3.9320e+05, 3.9437e+05, 0.0000e+00, 3.7843e+05],
        [3.7844e+05, 3.7842e+05, 7.4774e+05, 7.6838e+05, 7.7081e+05, 7.7223e+05,
         3.7845e+05, 7.8071e+05, 3.7846e+05, 3.7845e+05, 3.7845e+05, 3.7844e+05,
         7.8110e+05, 7.9104e+05, 3.7843e+05, 0.0000e+00]])
Krum scores: ['1.08', '1.22', '396159.59', '384634.62', '394602.34', '383424.59', '1.03', '388736.09', '1.25', '1.15', '1.06', '1.08', '393192.72', '394354.50', '1.23', '378437.22']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 8, 17, 18, 15, 16, 2, 19, 12, 3, 6, 4, 20, 14, 5, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:42...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:42, End: 2025-07-22 16:02:42)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 8, 19, 1, 11, 10, 18, 14, 13, 17, 7, 5, 4, 6, 2, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1357e+00, 3.8936e+05, 1.0452e+00, 8.5502e-01, 8.6172e-01,
         3.8612e+05, 3.9915e+05, 3.8791e+05, 3.8726e+05, 1.1204e+00, 1.1095e+00,
         9.0001e-01, 9.4843e-01, 1.0767e+00, 3.8585e+05],
        [1.1357e+00, 0.0000e+00, 3.8936e+05, 1.0044e+00, 1.2737e+00, 1.0531e+00,
         3.8611e+05, 3.9917e+05, 3.8791e+05, 3.8727e+05, 1.0173e+00, 1.0926e+00,
         1.3167e+00, 1.0001e+00, 1.7409e+00, 3.8585e+05],
        [3.8936e+05, 3.8936e+05, 0.0000e+00, 3.8938e+05, 3.8937e+05, 3.8939e+05,
         7.8596e+05, 7.8485e+05, 7.7888e+05, 7.9069e+05, 3.8935e+05, 3.8939e+05,
         3.8936e+05, 3.8937e+05, 3.8937e+05, 7.8112e+05],
        [1.0452e+00, 1.0044e+00, 3.8938e+05, 0.0000e+00, 1.1693e+00, 9.8187e-01,
         3.8610e+05, 3.9916e+05, 3.8791e+05, 3.8726e+05, 1.0109e+00, 1.0537e+00,
         1.2435e+00, 9.7127e-01, 1.5972e+00, 3.8584e+05],
        [8.5502e-01, 1.2737e+00, 3.8937e+05, 1.1693e+00, 0.0000e+00, 8.6604e-01,
         3.8610e+05, 3.9915e+05, 3.8792e+05, 3.8727e+05, 1.2745e+00, 1.2426e+00,
         7.2210e-01, 9.4255e-01, 9.0960e-01, 3.8584e+05],
        [8.6172e-01, 1.0531e+00, 3.8939e+05, 9.8187e-01, 8.6604e-01, 0.0000e+00,
         3.8611e+05, 3.9916e+05, 3.8790e+05, 3.8726e+05, 1.0883e+00, 1.0743e+00,
         8.7472e-01, 9.0158e-01, 1.1486e+00, 3.8586e+05],
        [3.8612e+05, 3.8611e+05, 7.8596e+05, 3.8610e+05, 3.8610e+05, 3.8611e+05,
         0.0000e+00, 7.7647e+05, 7.6732e+05, 7.7283e+05, 3.8610e+05, 3.8608e+05,
         3.8610e+05, 3.8612e+05, 3.8611e+05, 7.8193e+05],
        [3.9915e+05, 3.9917e+05, 7.8485e+05, 3.9916e+05, 3.9915e+05, 3.9916e+05,
         7.7647e+05, 0.0000e+00, 7.9220e+05, 7.6714e+05, 3.9922e+05, 3.9918e+05,
         3.9914e+05, 3.9917e+05, 3.9914e+05, 7.8546e+05],
        [3.8791e+05, 3.8791e+05, 7.7888e+05, 3.8791e+05, 3.8792e+05, 3.8790e+05,
         7.6732e+05, 7.9220e+05, 0.0000e+00, 7.8230e+05, 3.8789e+05, 3.8791e+05,
         3.8793e+05, 3.8789e+05, 3.8792e+05, 7.7160e+05],
        [3.8726e+05, 3.8727e+05, 7.9069e+05, 3.8726e+05, 3.8727e+05, 3.8726e+05,
         7.7283e+05, 7.6714e+05, 7.8230e+05, 0.0000e+00, 3.8725e+05, 3.8729e+05,
         3.8726e+05, 3.8726e+05, 3.8729e+05, 7.6596e+05],
        [1.1204e+00, 1.0173e+00, 3.8935e+05, 1.0109e+00, 1.2745e+00, 1.0883e+00,
         3.8610e+05, 3.9922e+05, 3.8789e+05, 3.8725e+05, 0.0000e+00, 1.0266e+00,
         1.3900e+00, 1.0463e+00, 1.7238e+00, 3.8582e+05],
        [1.1095e+00, 1.0926e+00, 3.8939e+05, 1.0537e+00, 1.2426e+00, 1.0743e+00,
         3.8608e+05, 3.9918e+05, 3.8791e+05, 3.8729e+05, 1.0266e+00, 0.0000e+00,
         1.3952e+00, 1.0572e+00, 1.7302e+00, 3.8584e+05],
        [9.0001e-01, 1.3167e+00, 3.8936e+05, 1.2435e+00, 7.2210e-01, 8.7472e-01,
         3.8610e+05, 3.9914e+05, 3.8793e+05, 3.8726e+05, 1.3900e+00, 1.3952e+00,
         0.0000e+00, 1.0096e+00, 8.0464e-01, 3.8585e+05],
        [9.4843e-01, 1.0001e+00, 3.8937e+05, 9.7127e-01, 9.4255e-01, 9.0158e-01,
         3.8612e+05, 3.9917e+05, 3.8789e+05, 3.8726e+05, 1.0463e+00, 1.0572e+00,
         1.0096e+00, 0.0000e+00, 1.2904e+00, 3.8583e+05],
        [1.0767e+00, 1.7409e+00, 3.8937e+05, 1.5972e+00, 9.0960e-01, 1.1486e+00,
         3.8611e+05, 3.9914e+05, 3.8792e+05, 3.8729e+05, 1.7238e+00, 1.7302e+00,
         8.0464e-01, 1.2904e+00, 0.0000e+00, 3.8584e+05],
        [3.8585e+05, 3.8585e+05, 7.8112e+05, 3.8584e+05, 3.8584e+05, 3.8586e+05,
         7.8193e+05, 7.8546e+05, 7.7160e+05, 7.6596e+05, 3.8582e+05, 3.8584e+05,
         3.8585e+05, 3.8583e+05, 3.8584e+05, 0.0000e+00]])
Krum scores: ['0.99', '1.11', '389365.59', '1.06', '1.00', '0.96', '386100.03', '399154.69', '387905.94', '387261.56', '1.12', '1.13', '1.03', '0.98', '1.29', '385839.25']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 8, 19, 1, 11, 10, 18, 14, 13, 17, 7, 5, 4, 6, 2, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:43...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:43, End: 2025-07-22 16:02:43)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [18, 1, 2, 20, 5, 17, 9, 15, 6, 8, 13, 3, 14, 11, 10, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.1043e+05, 4.1045e+05, 7.8954e+05, 4.1043e+05, 8.0740e+05,
         4.1044e+05, 8.0415e+05, 4.1042e+05, 4.1043e+05, 8.1822e+05, 4.1041e+05,
         7.6385e+05, 4.1044e+05, 4.1044e+05, 8.0436e+05],
        [4.1043e+05, 0.0000e+00, 1.3235e+00, 3.9089e+05, 1.0732e+00, 4.0443e+05,
         1.0619e+00, 4.0185e+05, 9.7330e-01, 1.0340e+00, 3.9756e+05, 1.0729e+00,
         3.8042e+05, 1.1244e+00, 1.4441e+00, 3.8170e+05],
        [4.1045e+05, 1.3235e+00, 0.0000e+00, 3.9086e+05, 1.4583e+00, 4.0446e+05,
         9.2929e-01, 4.0183e+05, 1.0989e+00, 1.5106e+00, 3.9755e+05, 1.3739e+00,
         3.8047e+05, 8.0792e-01, 7.6687e-01, 3.8170e+05],
        [7.8954e+05, 3.9089e+05, 3.9086e+05, 0.0000e+00, 3.9092e+05, 7.7657e+05,
         3.9088e+05, 7.9915e+05, 3.9089e+05, 3.9091e+05, 8.0726e+05, 3.9089e+05,
         7.9115e+05, 3.9088e+05, 3.9088e+05, 7.6521e+05],
        [4.1043e+05, 1.0732e+00, 1.4583e+00, 3.9092e+05, 0.0000e+00, 4.0445e+05,
         1.1702e+00, 4.0186e+05, 1.0701e+00, 1.1021e+00, 3.9754e+05, 1.0688e+00,
         3.8043e+05, 1.2149e+00, 1.5585e+00, 3.8170e+05],
        [8.0740e+05, 4.0443e+05, 4.0446e+05, 7.7657e+05, 4.0445e+05, 0.0000e+00,
         4.0446e+05, 8.0692e+05, 4.0444e+05, 4.0446e+05, 7.9248e+05, 4.0446e+05,
         7.9166e+05, 4.0448e+05, 4.0446e+05, 7.8977e+05],
        [4.1044e+05, 1.0619e+00, 9.2929e-01, 3.9088e+05, 1.1702e+00, 4.0446e+05,
         0.0000e+00, 4.0182e+05, 9.8789e-01, 1.1877e+00, 3.9755e+05, 1.1142e+00,
         3.8044e+05, 8.9640e-01, 1.0892e+00, 3.8168e+05],
        [8.0415e+05, 4.0185e+05, 4.0183e+05, 7.9915e+05, 4.0186e+05, 8.0692e+05,
         4.0182e+05, 0.0000e+00, 4.0184e+05, 4.0183e+05, 7.9149e+05, 4.0183e+05,
         7.9057e+05, 4.0184e+05, 4.0181e+05, 8.0278e+05],
        [4.1042e+05, 9.7330e-01, 1.0989e+00, 3.9089e+05, 1.0701e+00, 4.0444e+05,
         9.8789e-01, 4.0184e+05, 0.0000e+00, 1.0082e+00, 3.9753e+05, 1.0569e+00,
         3.8045e+05, 9.5530e-01, 1.2691e+00, 3.8168e+05],
        [4.1043e+05, 1.0340e+00, 1.5106e+00, 3.9091e+05, 1.1021e+00, 4.0446e+05,
         1.1877e+00, 4.0183e+05, 1.0082e+00, 0.0000e+00, 3.9752e+05, 1.0648e+00,
         3.8043e+05, 1.2481e+00, 1.6193e+00, 3.8170e+05],
        [8.1822e+05, 3.9756e+05, 3.9755e+05, 8.0726e+05, 3.9754e+05, 7.9248e+05,
         3.9755e+05, 7.9149e+05, 3.9753e+05, 3.9752e+05, 0.0000e+00, 3.9754e+05,
         7.9489e+05, 3.9752e+05, 3.9753e+05, 7.8871e+05],
        [4.1041e+05, 1.0729e+00, 1.3739e+00, 3.9089e+05, 1.0688e+00, 4.0446e+05,
         1.1142e+00, 4.0183e+05, 1.0569e+00, 1.0648e+00, 3.9754e+05, 0.0000e+00,
         3.8043e+05, 1.2126e+00, 1.4696e+00, 3.8169e+05],
        [7.6385e+05, 3.8042e+05, 3.8047e+05, 7.9115e+05, 3.8043e+05, 7.9166e+05,
         3.8044e+05, 7.9057e+05, 3.8045e+05, 3.8043e+05, 7.9489e+05, 3.8043e+05,
         0.0000e+00, 3.8044e+05, 3.8045e+05, 7.6665e+05],
        [4.1044e+05, 1.1244e+00, 8.0792e-01, 3.9088e+05, 1.2149e+00, 4.0448e+05,
         8.9640e-01, 4.0184e+05, 9.5530e-01, 1.2481e+00, 3.9752e+05, 1.2126e+00,
         3.8044e+05, 0.0000e+00, 9.3594e-01, 3.8170e+05],
        [4.1044e+05, 1.4441e+00, 7.6687e-01, 3.9088e+05, 1.5585e+00, 4.0446e+05,
         1.0892e+00, 4.0181e+05, 1.2691e+00, 1.6193e+00, 3.9753e+05, 1.4696e+00,
         3.8045e+05, 9.3594e-01, 0.0000e+00, 3.8170e+05],
        [8.0436e+05, 3.8170e+05, 3.8170e+05, 7.6521e+05, 3.8170e+05, 7.8977e+05,
         3.8168e+05, 8.0278e+05, 3.8168e+05, 3.8170e+05, 7.8871e+05, 3.8169e+05,
         7.6665e+05, 3.8170e+05, 3.8170e+05, 0.0000e+00]])
Krum scores: ['410427.97', '1.09', '1.11', '390881.97', '1.17', '404450.06', '1.04', '401828.97', '1.02', '1.17', '397534.03', '1.14', '380431.81', '1.02', '1.22', '381692.06']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [18, 1, 2, 20, 5, 17, 9, 15, 6, 8, 13, 3, 14, 11, 10, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:44...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[160  77]
 [ 52 211]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:44, End: 2025-07-22 16:02:44)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [18, 1, 14, 12, 8, 9, 20, 10, 15, 2, 11, 3, 6, 19, 7, 17], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8555e+05, 7.5596e+05, 3.8555e+05, 3.8555e+05, 3.8555e+05,
         7.6758e+05, 3.8555e+05, 7.5448e+05, 3.8555e+05, 3.8556e+05, 3.8553e+05,
         3.8555e+05, 7.6602e+05, 3.8555e+05, 7.7797e+05],
        [3.8555e+05, 0.0000e+00, 3.8053e+05, 1.1636e+00, 1.0232e+00, 1.0453e+00,
         3.9485e+05, 1.1825e+00, 3.8329e+05, 1.2402e+00, 1.5008e+00, 1.0528e+00,
         9.5503e-01, 4.0575e+05, 1.0319e+00, 3.9065e+05],
        [7.5596e+05, 3.8053e+05, 0.0000e+00, 3.8051e+05, 3.8052e+05, 3.8052e+05,
         7.5031e+05, 3.8051e+05, 7.5732e+05, 3.8051e+05, 3.8049e+05, 3.8050e+05,
         3.8052e+05, 7.8573e+05, 3.8050e+05, 7.6872e+05],
        [3.8555e+05, 1.1636e+00, 3.8051e+05, 0.0000e+00, 1.2500e+00, 9.5564e-01,
         3.9487e+05, 7.4122e-01, 3.8329e+05, 7.1725e-01, 8.6166e-01, 1.1309e+00,
         9.6671e-01, 4.0575e+05, 1.2317e+00, 3.9065e+05],
        [3.8555e+05, 1.0232e+00, 3.8052e+05, 1.2500e+00, 0.0000e+00, 1.1474e+00,
         3.9487e+05, 1.2751e+00, 3.8328e+05, 1.3613e+00, 1.6374e+00, 1.0485e+00,
         9.7709e-01, 4.0576e+05, 1.0243e+00, 3.9067e+05],
        [3.8555e+05, 1.0453e+00, 3.8052e+05, 9.5564e-01, 1.1474e+00, 0.0000e+00,
         3.9486e+05, 9.1162e-01, 3.8332e+05, 8.9445e-01, 1.1123e+00, 1.0419e+00,
         9.7394e-01, 4.0573e+05, 1.1278e+00, 3.9066e+05],
        [7.6758e+05, 3.9485e+05, 7.5031e+05, 3.9487e+05, 3.9487e+05, 3.9486e+05,
         0.0000e+00, 3.9487e+05, 7.8997e+05, 3.9486e+05, 3.9487e+05, 3.9488e+05,
         3.9485e+05, 7.9155e+05, 3.9489e+05, 7.8103e+05],
        [3.8555e+05, 1.1825e+00, 3.8051e+05, 7.4122e-01, 1.2751e+00, 9.1162e-01,
         3.9487e+05, 0.0000e+00, 3.8328e+05, 6.7088e-01, 7.9672e-01, 1.1756e+00,
         9.9002e-01, 4.0575e+05, 1.3093e+00, 3.9065e+05],
        [7.5448e+05, 3.8329e+05, 7.5732e+05, 3.8329e+05, 3.8328e+05, 3.8332e+05,
         7.8997e+05, 3.8328e+05, 0.0000e+00, 3.8330e+05, 3.8328e+05, 3.8328e+05,
         3.8327e+05, 7.9997e+05, 3.8327e+05, 7.6387e+05],
        [3.8555e+05, 1.2402e+00, 3.8051e+05, 7.1725e-01, 1.3613e+00, 8.9445e-01,
         3.9486e+05, 6.7088e-01, 3.8330e+05, 0.0000e+00, 6.9884e-01, 1.2391e+00,
         9.6211e-01, 4.0576e+05, 1.3513e+00, 3.9064e+05],
        [3.8556e+05, 1.5008e+00, 3.8049e+05, 8.6166e-01, 1.6374e+00, 1.1123e+00,
         3.9487e+05, 7.9672e-01, 3.8328e+05, 6.9884e-01, 0.0000e+00, 1.5335e+00,
         1.1981e+00, 4.0576e+05, 1.6221e+00, 3.9064e+05],
        [3.8553e+05, 1.0528e+00, 3.8050e+05, 1.1309e+00, 1.0485e+00, 1.0419e+00,
         3.9488e+05, 1.1756e+00, 3.8328e+05, 1.2391e+00, 1.5335e+00, 0.0000e+00,
         1.0329e+00, 4.0570e+05, 1.0433e+00, 3.9068e+05],
        [3.8555e+05, 9.5503e-01, 3.8052e+05, 9.6671e-01, 9.7709e-01, 9.7394e-01,
         3.9485e+05, 9.9002e-01, 3.8327e+05, 9.6211e-01, 1.1981e+00, 1.0329e+00,
         0.0000e+00, 4.0573e+05, 1.0345e+00, 3.9067e+05],
        [7.6602e+05, 4.0575e+05, 7.8573e+05, 4.0575e+05, 4.0576e+05, 4.0573e+05,
         7.9155e+05, 4.0575e+05, 7.9997e+05, 4.0576e+05, 4.0576e+05, 4.0570e+05,
         4.0573e+05, 0.0000e+00, 4.0576e+05, 7.8071e+05],
        [3.8555e+05, 1.0319e+00, 3.8050e+05, 1.2317e+00, 1.0243e+00, 1.1278e+00,
         3.9489e+05, 1.3093e+00, 3.8327e+05, 1.3513e+00, 1.6221e+00, 1.0433e+00,
         1.0345e+00, 4.0576e+05, 0.0000e+00, 3.9066e+05],
        [7.7797e+05, 3.9065e+05, 7.6872e+05, 3.9065e+05, 3.9067e+05, 3.9066e+05,
         7.8103e+05, 3.9065e+05, 7.6387e+05, 3.9064e+05, 3.9064e+05, 3.9068e+05,
         3.9067e+05, 7.8071e+05, 3.9066e+05, 0.0000e+00]])
Krum scores: ['385547.16', '1.09', '380506.78', '0.97', '1.14', '1.01', '394864.12', '0.97', '383279.84', '0.97', '1.17', '1.10', '0.99', '405740.91', '1.14', '390651.66']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [18, 1, 14, 12, 8, 9, 20, 10, 15, 2, 11, 3, 6, 19, 7, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0224s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:44...
global Accuracy on shared test data: 73.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:44, End: 2025-07-22 16:02:44)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 11, 8, 7, 5, 6, 13, 15, 14, 16, 12, 20, 17, 19, 18, 10], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 8.3312e-01, 1.0538e+00, 1.0540e+00, 1.0257e+00, 9.2268e-01,
         3.9813e+05, 3.8884e+05, 3.9960e+05, 4.0287e+05, 8.6305e-01, 3.9544e+05,
         3.9271e+05, 4.0275e+05, 3.8916e+05, 1.0991e+00],
        [8.3312e-01, 0.0000e+00, 1.2387e+00, 1.2446e+00, 1.2196e+00, 9.3070e-01,
         3.9815e+05, 3.8885e+05, 3.9961e+05, 4.0288e+05, 6.5446e-01, 3.9544e+05,
         3.9272e+05, 4.0273e+05, 3.8920e+05, 6.2893e-01],
        [1.0538e+00, 1.2387e+00, 0.0000e+00, 9.6137e-01, 9.9422e-01, 9.1845e-01,
         3.9813e+05, 3.8885e+05, 3.9960e+05, 4.0288e+05, 1.1489e+00, 3.9540e+05,
         3.9271e+05, 4.0277e+05, 3.8919e+05, 1.6618e+00],
        [1.0540e+00, 1.2446e+00, 9.6137e-01, 0.0000e+00, 9.5315e-01, 9.5955e-01,
         3.9811e+05, 3.8881e+05, 3.9962e+05, 4.0286e+05, 1.1456e+00, 3.9543e+05,
         3.9271e+05, 4.0277e+05, 3.8918e+05, 1.7121e+00],
        [1.0257e+00, 1.2196e+00, 9.9422e-01, 9.5315e-01, 0.0000e+00, 9.7004e-01,
         3.9814e+05, 3.8881e+05, 3.9960e+05, 4.0287e+05, 1.0789e+00, 3.9543e+05,
         3.9274e+05, 4.0278e+05, 3.8919e+05, 1.6158e+00],
        [9.2268e-01, 9.3070e-01, 9.1845e-01, 9.5955e-01, 9.7004e-01, 0.0000e+00,
         3.9814e+05, 3.8885e+05, 3.9961e+05, 4.0287e+05, 8.9210e-01, 3.9542e+05,
         3.9270e+05, 4.0277e+05, 3.8921e+05, 1.3298e+00],
        [3.9813e+05, 3.9815e+05, 3.9813e+05, 3.9811e+05, 3.9814e+05, 3.9814e+05,
         0.0000e+00, 7.9831e+05, 8.0095e+05, 7.9684e+05, 3.9812e+05, 7.8736e+05,
         7.7896e+05, 8.1351e+05, 7.8352e+05, 3.9814e+05],
        [3.8884e+05, 3.8885e+05, 3.8885e+05, 3.8881e+05, 3.8881e+05, 3.8885e+05,
         7.9831e+05, 0.0000e+00, 7.8181e+05, 7.9224e+05, 3.8883e+05, 7.8192e+05,
         7.8736e+05, 7.8626e+05, 7.7806e+05, 3.8884e+05],
        [3.9960e+05, 3.9961e+05, 3.9960e+05, 3.9962e+05, 3.9960e+05, 3.9961e+05,
         8.0095e+05, 7.8181e+05, 0.0000e+00, 7.8472e+05, 3.9962e+05, 7.9307e+05,
         8.0392e+05, 8.1342e+05, 7.8091e+05, 3.9960e+05],
        [4.0287e+05, 4.0288e+05, 4.0288e+05, 4.0286e+05, 4.0287e+05, 4.0287e+05,
         7.9684e+05, 7.9224e+05, 7.8472e+05, 0.0000e+00, 4.0286e+05, 7.8562e+05,
         8.0386e+05, 8.0270e+05, 7.8636e+05, 4.0287e+05],
        [8.6305e-01, 6.5446e-01, 1.1489e+00, 1.1456e+00, 1.0789e+00, 8.9210e-01,
         3.9812e+05, 3.8883e+05, 3.9962e+05, 4.0286e+05, 0.0000e+00, 3.9546e+05,
         3.9269e+05, 4.0272e+05, 3.8921e+05, 7.7928e-01],
        [3.9544e+05, 3.9544e+05, 3.9540e+05, 3.9543e+05, 3.9543e+05, 3.9542e+05,
         7.8736e+05, 7.8192e+05, 7.9307e+05, 7.8562e+05, 3.9546e+05, 0.0000e+00,
         7.9488e+05, 7.7088e+05, 7.8283e+05, 3.9544e+05],
        [3.9271e+05, 3.9272e+05, 3.9271e+05, 3.9271e+05, 3.9274e+05, 3.9270e+05,
         7.7896e+05, 7.8736e+05, 8.0392e+05, 8.0386e+05, 3.9269e+05, 7.9488e+05,
         0.0000e+00, 8.1077e+05, 7.9749e+05, 3.9271e+05],
        [4.0275e+05, 4.0273e+05, 4.0277e+05, 4.0277e+05, 4.0278e+05, 4.0277e+05,
         8.1351e+05, 7.8626e+05, 8.1342e+05, 8.0270e+05, 4.0272e+05, 7.7088e+05,
         8.1077e+05, 0.0000e+00, 8.2875e+05, 4.0274e+05],
        [3.8916e+05, 3.8920e+05, 3.8919e+05, 3.8918e+05, 3.8919e+05, 3.8921e+05,
         7.8352e+05, 7.7806e+05, 7.8091e+05, 7.8636e+05, 3.8921e+05, 7.8283e+05,
         7.9749e+05, 8.2875e+05, 0.0000e+00, 3.8921e+05],
        [1.0991e+00, 6.2893e-01, 1.6618e+00, 1.7121e+00, 1.6158e+00, 1.3298e+00,
         3.9814e+05, 3.8884e+05, 3.9960e+05, 4.0287e+05, 7.7928e-01, 3.9544e+05,
         3.9271e+05, 4.0274e+05, 3.8921e+05, 0.0000e+00]])
Krum scores: ['0.96', '0.92', '1.05', '1.05', '1.04', '0.93', '398128.12', '388830.16', '399602.16', '402866.97', '0.90', '395426.28', '392706.59', '402746.25', '389189.09', '1.19']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 11, 8, 7, 5, 6, 13, 15, 14, 16, 12, 20, 17, 19, 18, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0257s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:45...
global Accuracy on shared test data: 72.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:45, End: 2025-07-22 16:02:45)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 10, 7, 17, 13, 15, 9, 5, 14, 1, 11, 4, 3, 12, 20, 18], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1257e+00, 9.4899e-01, 4.0624e+05, 4.0450e+05, 3.7798e+05,
         8.6810e-01, 9.5093e-01, 3.9406e+05, 9.0186e-01, 8.6882e-01, 8.5195e-01,
         9.5939e-01, 1.2813e+00, 3.9777e+05, 3.8696e+05],
        [1.1257e+00, 0.0000e+00, 1.4753e+00, 4.0625e+05, 4.0447e+05, 3.7795e+05,
         9.2790e-01, 1.3915e+00, 3.9408e+05, 1.3355e+00, 4.9989e-01, 6.0491e-01,
         1.2881e+00, 5.3153e-01, 3.9777e+05, 3.8694e+05],
        [9.4899e-01, 1.4753e+00, 0.0000e+00, 4.0624e+05, 4.0450e+05, 3.7799e+05,
         9.9064e-01, 9.2195e-01, 3.9406e+05, 9.7946e-01, 1.1605e+00, 1.1099e+00,
         9.9397e-01, 1.6097e+00, 3.9777e+05, 3.8697e+05],
        [4.0624e+05, 4.0625e+05, 4.0624e+05, 0.0000e+00, 8.3294e+05, 7.7057e+05,
         4.0626e+05, 4.0624e+05, 8.0698e+05, 4.0626e+05, 4.0625e+05, 4.0626e+05,
         4.0627e+05, 4.0625e+05, 8.1478e+05, 7.8427e+05],
        [4.0450e+05, 4.0447e+05, 4.0450e+05, 8.3294e+05, 0.0000e+00, 7.7315e+05,
         4.0449e+05, 4.0449e+05, 7.9831e+05, 4.0449e+05, 4.0447e+05, 4.0451e+05,
         4.0449e+05, 4.0449e+05, 8.1104e+05, 8.0185e+05],
        [3.7798e+05, 3.7795e+05, 3.7799e+05, 7.7057e+05, 7.7315e+05, 0.0000e+00,
         3.7797e+05, 3.7799e+05, 7.7703e+05, 3.7798e+05, 3.7795e+05, 3.7795e+05,
         3.7799e+05, 3.7796e+05, 7.7130e+05, 7.6647e+05],
        [8.6810e-01, 9.2790e-01, 9.9064e-01, 4.0626e+05, 4.0449e+05, 3.7797e+05,
         0.0000e+00, 9.8072e-01, 3.9406e+05, 9.5621e-01, 7.3701e-01, 7.6236e-01,
         9.5531e-01, 1.1104e+00, 3.9778e+05, 3.8696e+05],
        [9.5093e-01, 1.3915e+00, 9.2195e-01, 4.0624e+05, 4.0449e+05, 3.7799e+05,
         9.8072e-01, 0.0000e+00, 3.9409e+05, 9.6117e-01, 1.1277e+00, 1.0961e+00,
         9.6702e-01, 1.5344e+00, 3.9776e+05, 3.8695e+05],
        [3.9406e+05, 3.9408e+05, 3.9406e+05, 8.0698e+05, 7.9831e+05, 7.7703e+05,
         3.9406e+05, 3.9409e+05, 0.0000e+00, 3.9406e+05, 3.9407e+05, 3.9406e+05,
         3.9410e+05, 3.9408e+05, 7.9077e+05, 7.9134e+05],
        [9.0186e-01, 1.3355e+00, 9.7946e-01, 4.0626e+05, 4.0449e+05, 3.7798e+05,
         9.5621e-01, 9.6117e-01, 3.9406e+05, 0.0000e+00, 1.0658e+00, 1.0088e+00,
         9.8527e-01, 1.5156e+00, 3.9776e+05, 3.8697e+05],
        [8.6882e-01, 4.9989e-01, 1.1605e+00, 4.0625e+05, 4.0447e+05, 3.7795e+05,
         7.3701e-01, 1.1277e+00, 3.9407e+05, 1.0658e+00, 0.0000e+00, 5.2244e-01,
         1.0836e+00, 6.8182e-01, 3.9778e+05, 3.8694e+05],
        [8.5195e-01, 6.0491e-01, 1.1099e+00, 4.0626e+05, 4.0451e+05, 3.7795e+05,
         7.6236e-01, 1.0961e+00, 3.9406e+05, 1.0088e+00, 5.2244e-01, 0.0000e+00,
         9.9340e-01, 7.5489e-01, 3.9777e+05, 3.8694e+05],
        [9.5939e-01, 1.2881e+00, 9.9397e-01, 4.0627e+05, 4.0449e+05, 3.7799e+05,
         9.5531e-01, 9.6702e-01, 3.9410e+05, 9.8527e-01, 1.0836e+00, 9.9340e-01,
         0.0000e+00, 1.4489e+00, 3.9776e+05, 3.8696e+05],
        [1.2813e+00, 5.3153e-01, 1.6097e+00, 4.0625e+05, 4.0449e+05, 3.7796e+05,
         1.1104e+00, 1.5344e+00, 3.9408e+05, 1.5156e+00, 6.8182e-01, 7.5489e-01,
         1.4489e+00, 0.0000e+00, 3.9779e+05, 3.8692e+05],
        [3.9777e+05, 3.9777e+05, 3.9777e+05, 8.1478e+05, 8.1104e+05, 7.7130e+05,
         3.9778e+05, 3.9776e+05, 7.9077e+05, 3.9776e+05, 3.9778e+05, 3.9777e+05,
         3.9776e+05, 3.9779e+05, 0.0000e+00, 8.0119e+05],
        [3.8696e+05, 3.8694e+05, 3.8697e+05, 7.8427e+05, 8.0185e+05, 7.6647e+05,
         3.8696e+05, 3.8695e+05, 7.9134e+05, 3.8697e+05, 3.8694e+05, 3.8694e+05,
         3.8696e+05, 3.8692e+05, 8.0119e+05, 0.0000e+00]])
Krum scores: ['0.93', '0.96', '1.07', '406249.38', '404485.41', '377965.56', '0.90', '1.05', '394064.94', '1.02', '0.82', '0.82', '1.03', '1.11', '397767.03', '386946.81']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 10, 7, 17, 13, 15, 9, 5, 14, 1, 11, 4, 3, 12, 20, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0069s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:45...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[169  68]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:45, End: 2025-07-22 16:02:45)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 20, 6, 18, 9, 10, 17, 5, 11, 7, 19, 1, 14, 3, 4, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.6294e+05, 3.9412e+05, 7.8976e+05, 3.9411e+05, 3.9410e+05,
         7.8856e+05, 3.9413e+05, 3.9412e+05, 3.9411e+05, 7.9665e+05, 3.9414e+05,
         7.8821e+05, 3.9413e+05, 3.9413e+05, 3.9411e+05],
        [7.6294e+05, 0.0000e+00, 3.8310e+05, 7.6450e+05, 3.8312e+05, 3.8310e+05,
         8.0078e+05, 3.8310e+05, 3.8312e+05, 3.8312e+05, 7.6464e+05, 3.8310e+05,
         7.5427e+05, 3.8310e+05, 3.8309e+05, 3.8310e+05],
        [3.9412e+05, 3.8310e+05, 0.0000e+00, 3.8297e+05, 9.0761e-01, 1.0780e+00,
         3.9125e+05, 9.9116e-01, 1.1938e+00, 9.9265e-01, 3.9285e+05, 8.8484e-01,
         3.9836e+05, 9.4633e-01, 8.4994e-01, 9.5569e-01],
        [7.8976e+05, 7.6450e+05, 3.8297e+05, 0.0000e+00, 3.8299e+05, 3.8296e+05,
         7.8297e+05, 3.8298e+05, 3.8297e+05, 3.8299e+05, 7.7684e+05, 3.8297e+05,
         7.7935e+05, 3.8297e+05, 3.8298e+05, 3.8299e+05],
        [3.9411e+05, 3.8312e+05, 9.0761e-01, 3.8299e+05, 0.0000e+00, 8.8539e-01,
         3.9128e+05, 9.6292e-01, 9.9266e-01, 9.8072e-01, 3.9286e+05, 9.2568e-01,
         3.9833e+05, 9.1707e-01, 7.6814e-01, 8.4310e-01],
        [3.9410e+05, 3.8310e+05, 1.0780e+00, 3.8296e+05, 8.8539e-01, 0.0000e+00,
         3.9129e+05, 1.2922e+00, 4.7890e-01, 1.3606e+00, 3.9285e+05, 1.2440e+00,
         3.9831e+05, 1.2142e+00, 6.0143e-01, 4.4944e-01],
        [7.8856e+05, 8.0078e+05, 3.9125e+05, 7.8297e+05, 3.9128e+05, 3.9129e+05,
         0.0000e+00, 3.9125e+05, 3.9129e+05, 3.9124e+05, 7.7047e+05, 3.9124e+05,
         7.6662e+05, 3.9123e+05, 3.9127e+05, 3.9128e+05],
        [3.9413e+05, 3.8310e+05, 9.9116e-01, 3.8298e+05, 9.6292e-01, 1.2922e+00,
         3.9125e+05, 0.0000e+00, 1.4719e+00, 9.6735e-01, 3.9287e+05, 9.7084e-01,
         3.9836e+05, 9.7542e-01, 1.0824e+00, 1.1478e+00],
        [3.9412e+05, 3.8312e+05, 1.1938e+00, 3.8297e+05, 9.9266e-01, 4.7890e-01,
         3.9129e+05, 1.4719e+00, 0.0000e+00, 1.5250e+00, 3.9288e+05, 1.3969e+00,
         3.9832e+05, 1.4213e+00, 6.9366e-01, 5.5270e-01],
        [3.9411e+05, 3.8312e+05, 9.9265e-01, 3.8299e+05, 9.8072e-01, 1.3606e+00,
         3.9124e+05, 9.6735e-01, 1.5250e+00, 0.0000e+00, 3.9289e+05, 9.4997e-01,
         3.9833e+05, 9.6491e-01, 1.0863e+00, 1.2027e+00],
        [7.9665e+05, 7.6464e+05, 3.9285e+05, 7.7684e+05, 3.9286e+05, 3.9285e+05,
         7.7047e+05, 3.9287e+05, 3.9288e+05, 3.9289e+05, 0.0000e+00, 3.9286e+05,
         8.0266e+05, 3.9286e+05, 3.9284e+05, 3.9284e+05],
        [3.9414e+05, 3.8310e+05, 8.8484e-01, 3.8297e+05, 9.2568e-01, 1.2440e+00,
         3.9124e+05, 9.7084e-01, 1.3969e+00, 9.4997e-01, 3.9286e+05, 0.0000e+00,
         3.9832e+05, 9.3505e-01, 9.9118e-01, 1.1405e+00],
        [7.8821e+05, 7.5427e+05, 3.9836e+05, 7.7935e+05, 3.9833e+05, 3.9831e+05,
         7.6662e+05, 3.9836e+05, 3.9832e+05, 3.9833e+05, 8.0266e+05, 3.9832e+05,
         0.0000e+00, 3.9831e+05, 3.9832e+05, 3.9832e+05],
        [3.9413e+05, 3.8310e+05, 9.4633e-01, 3.8297e+05, 9.1707e-01, 1.2142e+00,
         3.9123e+05, 9.7542e-01, 1.4213e+00, 9.6491e-01, 3.9286e+05, 9.3505e-01,
         3.9831e+05, 0.0000e+00, 9.7531e-01, 1.0796e+00],
        [3.9413e+05, 3.8309e+05, 8.4994e-01, 3.8298e+05, 7.6814e-01, 6.0143e-01,
         3.9127e+05, 1.0824e+00, 6.9366e-01, 1.0863e+00, 3.9284e+05, 9.9118e-01,
         3.9832e+05, 9.7531e-01, 0.0000e+00, 5.9401e-01],
        [3.9411e+05, 3.8310e+05, 9.5569e-01, 3.8299e+05, 8.4310e-01, 4.4944e-01,
         3.9128e+05, 1.1478e+00, 5.5270e-01, 1.2027e+00, 3.9284e+05, 1.1405e+00,
         3.9832e+05, 1.0796e+00, 5.9401e-01, 0.0000e+00]])
Krum scores: ['394117.09', '383102.03', '0.95', '382974.19', '0.90', '0.91', '391256.97', '1.05', '1.03', '1.06', '392853.81', '1.01', '398321.91', '1.00', '0.82', '0.85']
Selected index: 14
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Chosen Update']
 ['Update 15']], selected_client_indices: [16, 20, 6, 18, 9, 10, 17, 5, 11, 7, 19, 1, 14, 3, 4, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0225s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:46...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 67 196]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:46, End: 2025-07-22 16:02:46)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [19, 8, 12, 1, 20, 9, 6, 10, 13, 18, 14, 2, 16, 11, 5, 3], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9483e+05, 3.9488e+05, 3.9489e+05, 7.8064e+05, 3.9486e+05,
         3.9487e+05, 3.9488e+05, 7.8136e+05, 7.9269e+05, 7.9841e+05, 3.9487e+05,
         8.0153e+05, 3.9487e+05, 3.9489e+05, 3.9487e+05],
        [3.9483e+05, 0.0000e+00, 1.2966e+00, 9.6215e-01, 3.8472e+05, 1.0228e+00,
         9.1033e-01, 1.2926e+00, 4.0793e+05, 4.0188e+05, 3.9996e+05, 1.1092e+00,
         3.8605e+05, 1.3511e+00, 9.5512e-01, 9.5533e-01],
        [3.9488e+05, 1.2966e+00, 0.0000e+00, 1.1550e+00, 3.8471e+05, 8.9144e-01,
         9.8515e-01, 4.6911e-01, 4.0791e+05, 4.0191e+05, 3.9998e+05, 5.6111e-01,
         3.8604e+05, 4.9264e-01, 1.2106e+00, 1.1113e+00],
        [3.9489e+05, 9.6215e-01, 1.1550e+00, 0.0000e+00, 3.8471e+05, 9.1696e-01,
         8.8343e-01, 1.1236e+00, 4.0793e+05, 4.0193e+05, 3.9998e+05, 9.5646e-01,
         3.8603e+05, 1.1540e+00, 9.4337e-01, 9.3459e-01],
        [7.8064e+05, 3.8472e+05, 3.8471e+05, 3.8471e+05, 0.0000e+00, 3.8472e+05,
         3.8471e+05, 3.8469e+05, 7.8438e+05, 7.8366e+05, 7.7076e+05, 3.8470e+05,
         7.6688e+05, 3.8468e+05, 3.8469e+05, 3.8468e+05],
        [3.9486e+05, 1.0228e+00, 8.9144e-01, 9.1696e-01, 3.8472e+05, 0.0000e+00,
         8.7305e-01, 8.6054e-01, 4.0793e+05, 4.0190e+05, 3.9998e+05, 7.3503e-01,
         3.8604e+05, 8.6524e-01, 9.4574e-01, 9.2690e-01],
        [3.9487e+05, 9.1033e-01, 9.8515e-01, 8.8343e-01, 3.8471e+05, 8.7305e-01,
         0.0000e+00, 9.8082e-01, 4.0793e+05, 4.0193e+05, 3.9999e+05, 8.2255e-01,
         3.8605e+05, 9.9350e-01, 9.4707e-01, 9.3790e-01],
        [3.9488e+05, 1.2926e+00, 4.6911e-01, 1.1236e+00, 3.8469e+05, 8.6054e-01,
         9.8082e-01, 0.0000e+00, 4.0792e+05, 4.0190e+05, 3.9998e+05, 5.2986e-01,
         3.8608e+05, 4.2679e-01, 1.2392e+00, 1.0956e+00],
        [7.8136e+05, 4.0793e+05, 4.0791e+05, 4.0793e+05, 7.8438e+05, 4.0793e+05,
         4.0793e+05, 4.0792e+05, 0.0000e+00, 8.1112e+05, 7.8813e+05, 4.0792e+05,
         7.9591e+05, 4.0792e+05, 4.0794e+05, 4.0792e+05],
        [7.9269e+05, 4.0188e+05, 4.0191e+05, 4.0193e+05, 7.8366e+05, 4.0190e+05,
         4.0193e+05, 4.0190e+05, 8.1112e+05, 0.0000e+00, 8.2842e+05, 4.0190e+05,
         7.7690e+05, 4.0192e+05, 4.0192e+05, 4.0193e+05],
        [7.9841e+05, 3.9996e+05, 3.9998e+05, 3.9998e+05, 7.7076e+05, 3.9998e+05,
         3.9999e+05, 3.9998e+05, 7.8813e+05, 8.2842e+05, 0.0000e+00, 3.9998e+05,
         7.8317e+05, 3.9999e+05, 3.9999e+05, 3.9999e+05],
        [3.9487e+05, 1.1092e+00, 5.6111e-01, 9.5646e-01, 3.8470e+05, 7.3503e-01,
         8.2255e-01, 5.2986e-01, 4.0792e+05, 4.0190e+05, 3.9998e+05, 0.0000e+00,
         3.8608e+05, 5.2648e-01, 1.0899e+00, 9.7319e-01],
        [8.0153e+05, 3.8605e+05, 3.8604e+05, 3.8603e+05, 7.6688e+05, 3.8604e+05,
         3.8605e+05, 3.8608e+05, 7.9591e+05, 7.7690e+05, 7.8317e+05, 3.8608e+05,
         0.0000e+00, 3.8605e+05, 3.8606e+05, 3.8606e+05],
        [3.9487e+05, 1.3511e+00, 4.9264e-01, 1.1540e+00, 3.8468e+05, 8.6524e-01,
         9.9350e-01, 4.2679e-01, 4.0792e+05, 4.0192e+05, 3.9999e+05, 5.2648e-01,
         3.8605e+05, 0.0000e+00, 1.2820e+00, 1.1733e+00],
        [3.9489e+05, 9.5512e-01, 1.2106e+00, 9.4337e-01, 3.8469e+05, 9.4574e-01,
         9.4707e-01, 1.2392e+00, 4.0794e+05, 4.0192e+05, 3.9999e+05, 1.0899e+00,
         3.8606e+05, 1.2820e+00, 0.0000e+00, 9.1709e-01],
        [3.9487e+05, 9.5533e-01, 1.1113e+00, 9.3459e-01, 3.8468e+05, 9.2690e-01,
         9.3790e-01, 1.0956e+00, 4.0792e+05, 4.0193e+05, 3.9999e+05, 9.7319e-01,
         3.8606e+05, 1.1733e+00, 9.1709e-01, 0.0000e+00]])
Krum scores: ['394867.03', '1.06', '0.86', '0.98', '384697.00', '0.88', '0.92', '0.84', '407922.53', '401906.16', '399979.81', '0.77', '386048.75', '0.86', '1.03', '0.98']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [19, 8, 12, 1, 20, 9, 6, 10, 13, 18, 14, 2, 16, 11, 5, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:47...
global Accuracy on shared test data: 76.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:47, End: 2025-07-22 16:02:47)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 10, 6, 5, 20, 17, 2, 3, 12, 1, 19, 11, 18, 7, 9, 8], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.1100e+05, 4.1104e+05, 4.1104e+05, 7.7133e+05, 7.7343e+05,
         4.1102e+05, 4.1104e+05, 4.1101e+05, 4.1100e+05, 8.2236e+05, 4.1101e+05,
         8.1755e+05, 4.1104e+05, 4.1102e+05, 4.1101e+05],
        [4.1100e+05, 0.0000e+00, 9.0893e-01, 1.1188e+00, 3.8240e+05, 3.8180e+05,
         5.2194e-01, 1.0583e+00, 4.3650e-01, 1.0512e+00, 4.1511e+05, 3.7953e-01,
         3.8757e+05, 1.2880e+00, 7.6309e-01, 1.2052e+00],
        [4.1104e+05, 9.0893e-01, 0.0000e+00, 9.0665e-01, 3.8243e+05, 3.8178e+05,
         1.1388e+00, 9.2194e-01, 8.8649e-01, 8.4213e-01, 4.1511e+05, 8.8887e-01,
         3.8754e+05, 9.7346e-01, 8.2465e-01, 8.8032e-01],
        [4.1104e+05, 1.1188e+00, 9.0665e-01, 0.0000e+00, 3.8242e+05, 3.8177e+05,
         1.4532e+00, 9.2942e-01, 1.0605e+00, 9.2291e-01, 4.1511e+05, 1.1164e+00,
         3.8757e+05, 9.2514e-01, 9.1497e-01, 9.4757e-01],
        [7.7133e+05, 3.8240e+05, 3.8243e+05, 3.8242e+05, 0.0000e+00, 7.6674e+05,
         3.8242e+05, 3.8243e+05, 3.8241e+05, 3.8241e+05, 7.8914e+05, 3.8241e+05,
         7.4441e+05, 3.8242e+05, 3.8241e+05, 3.8240e+05],
        [7.7343e+05, 3.8180e+05, 3.8178e+05, 3.8177e+05, 7.6674e+05, 0.0000e+00,
         3.8179e+05, 3.8178e+05, 3.8177e+05, 3.8178e+05, 7.9637e+05, 3.8179e+05,
         7.6167e+05, 3.8178e+05, 3.8178e+05, 3.8181e+05],
        [4.1102e+05, 5.2194e-01, 1.1388e+00, 1.4532e+00, 3.8242e+05, 3.8179e+05,
         0.0000e+00, 1.3594e+00, 5.8338e-01, 1.3186e+00, 4.1509e+05, 4.7644e-01,
         3.8756e+05, 1.5774e+00, 9.2828e-01, 1.5342e+00],
        [4.1104e+05, 1.0583e+00, 9.2194e-01, 9.2942e-01, 3.8243e+05, 3.8178e+05,
         1.3594e+00, 0.0000e+00, 1.0200e+00, 9.1862e-01, 4.1513e+05, 1.1058e+00,
         3.8760e+05, 9.4789e-01, 8.8186e-01, 9.4254e-01],
        [4.1101e+05, 4.3650e-01, 8.8649e-01, 1.0605e+00, 3.8241e+05, 3.8177e+05,
         5.8338e-01, 1.0200e+00, 0.0000e+00, 1.0365e+00, 4.1509e+05, 4.5153e-01,
         3.8756e+05, 1.2336e+00, 7.8334e-01, 1.1814e+00],
        [4.1100e+05, 1.0512e+00, 8.4213e-01, 9.2291e-01, 3.8241e+05, 3.8178e+05,
         1.3186e+00, 9.1862e-01, 1.0365e+00, 0.0000e+00, 4.1510e+05, 1.0573e+00,
         3.8759e+05, 9.5657e-01, 8.6664e-01, 9.2394e-01],
        [8.2236e+05, 4.1511e+05, 4.1511e+05, 4.1511e+05, 7.8914e+05, 7.9637e+05,
         4.1509e+05, 4.1513e+05, 4.1509e+05, 4.1510e+05, 0.0000e+00, 4.1509e+05,
         8.0814e+05, 4.1513e+05, 4.1511e+05, 4.1511e+05],
        [4.1101e+05, 3.7953e-01, 8.8887e-01, 1.1164e+00, 3.8241e+05, 3.8179e+05,
         4.7644e-01, 1.1058e+00, 4.5153e-01, 1.0573e+00, 4.1509e+05, 0.0000e+00,
         3.8757e+05, 1.2932e+00, 7.4658e-01, 1.2278e+00],
        [8.1755e+05, 3.8757e+05, 3.8754e+05, 3.8757e+05, 7.4441e+05, 7.6167e+05,
         3.8756e+05, 3.8760e+05, 3.8756e+05, 3.8759e+05, 8.0814e+05, 3.8757e+05,
         0.0000e+00, 3.8758e+05, 3.8758e+05, 3.8759e+05],
        [4.1104e+05, 1.2880e+00, 9.7346e-01, 9.2514e-01, 3.8242e+05, 3.8178e+05,
         1.5774e+00, 9.4789e-01, 1.2336e+00, 9.5657e-01, 4.1513e+05, 1.2932e+00,
         3.8758e+05, 0.0000e+00, 9.7594e-01, 9.3553e-01],
        [4.1102e+05, 7.6309e-01, 8.2465e-01, 9.1497e-01, 3.8241e+05, 3.8178e+05,
         9.2828e-01, 8.8186e-01, 7.8334e-01, 8.6664e-01, 4.1511e+05, 7.4658e-01,
         3.8758e+05, 9.7594e-01, 0.0000e+00, 9.6984e-01],
        [4.1101e+05, 1.2052e+00, 8.8032e-01, 9.4757e-01, 3.8240e+05, 3.8181e+05,
         1.5342e+00, 9.4254e-01, 1.1814e+00, 9.2394e-01, 4.1511e+05, 1.2278e+00,
         3.8759e+05, 9.3553e-01, 9.6984e-01, 0.0000e+00]])
Krum scores: ['411016.38', '0.83', '0.89', '0.98', '382412.12', '381781.50', '1.03', '0.97', '0.83', '0.95', '415103.16', '0.83', '387570.62', '1.06', '0.85', '1.02']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 10, 6, 5, 20, 17, 2, 3, 12, 1, 19, 11, 18, 7, 9, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:47...
global Accuracy on shared test data: 71.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 75 188]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:47, End: 2025-07-22 16:02:47)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [5, 9, 6, 4, 13, 17, 18, 3, 19, 12, 14, 15, 11, 10, 1, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.1980e-01, 8.6981e-01, 1.0480e+00, 4.1119e+05, 3.9828e+05,
         3.8701e+05, 9.0295e-01, 4.0916e+05, 1.3748e+00, 3.9136e+05, 3.8452e+05,
         1.0553e+00, 1.1266e+00, 8.9817e-01, 3.7942e+05],
        [9.1980e-01, 0.0000e+00, 8.4485e-01, 7.2256e-01, 4.1118e+05, 3.9828e+05,
         3.8702e+05, 9.1329e-01, 4.0917e+05, 9.7535e-01, 3.9139e+05, 3.8453e+05,
         7.0284e-01, 8.1364e-01, 8.9360e-01, 3.7938e+05],
        [8.6981e-01, 8.4485e-01, 0.0000e+00, 8.6187e-01, 4.1117e+05, 3.9828e+05,
         3.8703e+05, 8.9631e-01, 4.0915e+05, 1.1928e+00, 3.9136e+05, 3.8449e+05,
         8.6436e-01, 9.7945e-01, 8.2045e-01, 3.7938e+05],
        [1.0480e+00, 7.2256e-01, 8.6187e-01, 0.0000e+00, 4.1117e+05, 3.9829e+05,
         3.8702e+05, 1.0197e+00, 4.0919e+05, 4.9605e-01, 3.9139e+05, 3.8450e+05,
         3.5475e-01, 4.0759e-01, 9.8941e-01, 3.7939e+05],
        [4.1119e+05, 4.1118e+05, 4.1117e+05, 4.1117e+05, 0.0000e+00, 8.1428e+05,
         7.9427e+05, 4.1119e+05, 8.3992e+05, 4.1117e+05, 8.0637e+05, 7.9840e+05,
         4.1118e+05, 4.1117e+05, 4.1119e+05, 7.7858e+05],
        [3.9828e+05, 3.9828e+05, 3.9828e+05, 3.9829e+05, 8.1428e+05, 0.0000e+00,
         7.8432e+05, 3.9826e+05, 8.1942e+05, 3.9830e+05, 7.7914e+05, 7.8089e+05,
         3.9830e+05, 3.9830e+05, 3.9827e+05, 7.7838e+05],
        [3.8701e+05, 3.8702e+05, 3.8703e+05, 3.8702e+05, 7.9427e+05, 7.8432e+05,
         0.0000e+00, 3.8701e+05, 8.0636e+05, 3.8700e+05, 7.7558e+05, 7.8690e+05,
         3.8702e+05, 3.8700e+05, 3.8701e+05, 7.6703e+05],
        [9.0295e-01, 9.1329e-01, 8.9631e-01, 1.0197e+00, 4.1119e+05, 3.9826e+05,
         3.8701e+05, 0.0000e+00, 4.0913e+05, 1.3506e+00, 3.9138e+05, 3.8449e+05,
         1.0585e+00, 1.1115e+00, 9.1687e-01, 3.7938e+05],
        [4.0916e+05, 4.0917e+05, 4.0915e+05, 4.0919e+05, 8.3992e+05, 8.1942e+05,
         8.0636e+05, 4.0913e+05, 0.0000e+00, 4.0917e+05, 7.8540e+05, 8.0444e+05,
         4.0918e+05, 4.0917e+05, 4.0914e+05, 8.0053e+05],
        [1.3748e+00, 9.7535e-01, 1.1928e+00, 4.9605e-01, 4.1117e+05, 3.9830e+05,
         3.8700e+05, 1.3506e+00, 4.0917e+05, 0.0000e+00, 3.9139e+05, 3.8450e+05,
         4.9702e-01, 4.8370e-01, 1.3466e+00, 3.7937e+05],
        [3.9136e+05, 3.9139e+05, 3.9136e+05, 3.9139e+05, 8.0637e+05, 7.7914e+05,
         7.7558e+05, 3.9138e+05, 7.8540e+05, 3.9139e+05, 0.0000e+00, 7.8106e+05,
         3.9137e+05, 3.9138e+05, 3.9135e+05, 7.5269e+05],
        [3.8452e+05, 3.8453e+05, 3.8449e+05, 3.8450e+05, 7.9840e+05, 7.8089e+05,
         7.8690e+05, 3.8449e+05, 8.0444e+05, 3.8450e+05, 7.8106e+05, 0.0000e+00,
         3.8452e+05, 3.8451e+05, 3.8450e+05, 7.3322e+05],
        [1.0553e+00, 7.0284e-01, 8.6436e-01, 3.5475e-01, 4.1118e+05, 3.9830e+05,
         3.8702e+05, 1.0585e+00, 4.0918e+05, 4.9702e-01, 3.9137e+05, 3.8452e+05,
         0.0000e+00, 4.0010e-01, 1.0108e+00, 3.7938e+05],
        [1.1266e+00, 8.1364e-01, 9.7945e-01, 4.0759e-01, 4.1117e+05, 3.9830e+05,
         3.8700e+05, 1.1115e+00, 4.0917e+05, 4.8370e-01, 3.9138e+05, 3.8451e+05,
         4.0010e-01, 0.0000e+00, 1.1131e+00, 3.7938e+05],
        [8.9817e-01, 8.9360e-01, 8.2045e-01, 9.8941e-01, 4.1119e+05, 3.9827e+05,
         3.8701e+05, 9.1687e-01, 4.0914e+05, 1.3466e+00, 3.9135e+05, 3.8450e+05,
         1.0108e+00, 1.1131e+00, 0.0000e+00, 3.7937e+05],
        [3.7942e+05, 3.7938e+05, 3.7938e+05, 3.7939e+05, 7.7858e+05, 7.7838e+05,
         7.6703e+05, 3.7938e+05, 8.0053e+05, 3.7937e+05, 7.5269e+05, 7.3322e+05,
         3.7938e+05, 3.7938e+05, 3.7937e+05, 0.0000e+00]])
Krum scores: ['0.97', '0.83', '0.88', '0.69', '411175.72', '398279.41', '387008.34', '0.97', '409154.59', '0.91', '391370.41', '384501.56', '0.70', '0.76', '0.95', '379378.06']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 9, 6, 4, 13, 17, 18, 3, 19, 12, 14, 15, 11, 10, 1, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0051s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:48...
global Accuracy on shared test data: 74.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[165  72]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:48, End: 2025-07-22 16:02:48)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 18, 13, 3, 14, 19, 6, 15, 9, 20, 1, 16, 8, 7, 12, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0022e+05, 3.8733e+05, 9.7401e-01, 3.7168e+05, 3.7668e+05,
         8.3548e-01, 3.8221e+05, 7.2225e-01, 3.9591e+05, 9.7665e-01, 3.9805e+05,
         1.1446e+00, 1.1047e+00, 4.1622e-01, 3.7385e-01],
        [4.0022e+05, 0.0000e+00, 8.0032e+05, 4.0025e+05, 7.8677e+05, 7.6926e+05,
         4.0025e+05, 7.8249e+05, 4.0024e+05, 8.0261e+05, 4.0024e+05, 8.0961e+05,
         4.0027e+05, 4.0026e+05, 4.0022e+05, 4.0021e+05],
        [3.8733e+05, 8.0032e+05, 0.0000e+00, 3.8734e+05, 7.4717e+05, 7.6609e+05,
         3.8735e+05, 7.6360e+05, 3.8736e+05, 7.6559e+05, 3.8737e+05, 7.8706e+05,
         3.8737e+05, 3.8738e+05, 3.8735e+05, 3.8737e+05],
        [9.7401e-01, 4.0025e+05, 3.8734e+05, 0.0000e+00, 3.7168e+05, 3.7669e+05,
         8.5426e-01, 3.8223e+05, 8.2955e-01, 3.9589e+05, 8.7160e-01, 3.9807e+05,
         9.2720e-01, 8.8890e-01, 1.0571e+00, 9.5693e-01],
        [3.7168e+05, 7.8677e+05, 7.4717e+05, 3.7168e+05, 0.0000e+00, 7.3847e+05,
         3.7169e+05, 7.4477e+05, 3.7167e+05, 7.4716e+05, 3.7169e+05, 8.0641e+05,
         3.7165e+05, 3.7168e+05, 3.7168e+05, 3.7169e+05],
        [3.7668e+05, 7.6926e+05, 7.6609e+05, 3.7669e+05, 7.3847e+05, 0.0000e+00,
         3.7669e+05, 7.5980e+05, 3.7671e+05, 7.7523e+05, 3.7671e+05, 7.7346e+05,
         3.7670e+05, 3.7671e+05, 3.7669e+05, 3.7670e+05],
        [8.3548e-01, 4.0025e+05, 3.8735e+05, 8.5426e-01, 3.7169e+05, 3.7669e+05,
         0.0000e+00, 3.8219e+05, 8.0881e-01, 3.9590e+05, 8.1431e-01, 3.9803e+05,
         8.5017e-01, 8.9971e-01, 9.7334e-01, 8.4651e-01],
        [3.8221e+05, 7.8249e+05, 7.6360e+05, 3.8223e+05, 7.4477e+05, 7.5980e+05,
         3.8219e+05, 0.0000e+00, 3.8220e+05, 7.7675e+05, 3.8221e+05, 7.8179e+05,
         3.8221e+05, 3.8219e+05, 3.8220e+05, 3.8221e+05],
        [7.2225e-01, 4.0024e+05, 3.8736e+05, 8.2955e-01, 3.7167e+05, 3.7671e+05,
         8.0881e-01, 3.8220e+05, 0.0000e+00, 3.9590e+05, 8.6065e-01, 3.9805e+05,
         9.4325e-01, 9.1103e-01, 8.3524e-01, 6.9272e-01],
        [3.9591e+05, 8.0261e+05, 7.6559e+05, 3.9589e+05, 7.4716e+05, 7.7523e+05,
         3.9590e+05, 7.7675e+05, 3.9590e+05, 0.0000e+00, 3.9587e+05, 7.9763e+05,
         3.9588e+05, 3.9589e+05, 3.9590e+05, 3.9589e+05],
        [9.7665e-01, 4.0024e+05, 3.8737e+05, 8.7160e-01, 3.7169e+05, 3.7671e+05,
         8.1431e-01, 3.8221e+05, 8.6065e-01, 3.9587e+05, 0.0000e+00, 3.9803e+05,
         9.0866e-01, 9.1465e-01, 1.1308e+00, 9.8792e-01],
        [3.9805e+05, 8.0961e+05, 7.8706e+05, 3.9807e+05, 8.0641e+05, 7.7346e+05,
         3.9803e+05, 7.8179e+05, 3.9805e+05, 7.9763e+05, 3.9803e+05, 0.0000e+00,
         3.9805e+05, 3.9805e+05, 3.9808e+05, 3.9806e+05],
        [1.1446e+00, 4.0027e+05, 3.8737e+05, 9.2720e-01, 3.7165e+05, 3.7670e+05,
         8.5017e-01, 3.8221e+05, 9.4325e-01, 3.9588e+05, 9.0866e-01, 3.9805e+05,
         0.0000e+00, 9.4442e-01, 1.2818e+00, 1.1379e+00],
        [1.1047e+00, 4.0026e+05, 3.8738e+05, 8.8890e-01, 3.7168e+05, 3.7671e+05,
         8.9971e-01, 3.8219e+05, 9.1103e-01, 3.9589e+05, 9.1465e-01, 3.9805e+05,
         9.4442e-01, 0.0000e+00, 1.2541e+00, 1.0923e+00],
        [4.1622e-01, 4.0022e+05, 3.8735e+05, 1.0571e+00, 3.7168e+05, 3.7669e+05,
         9.7334e-01, 3.8220e+05, 8.3524e-01, 3.9590e+05, 1.1308e+00, 3.9808e+05,
         1.2818e+00, 1.2541e+00, 0.0000e+00, 3.6828e-01],
        [3.7385e-01, 4.0021e+05, 3.8737e+05, 9.5693e-01, 3.7169e+05, 3.7670e+05,
         8.4651e-01, 3.8221e+05, 6.9272e-01, 3.9589e+05, 9.8792e-01, 3.9806e+05,
         1.1379e+00, 1.0923e+00, 3.6828e-01, 0.0000e+00]])
Krum scores: ['0.77', '400234.00', '387352.25', '0.90', '371675.56', '376694.97', '0.84', '382201.16', '0.81', '395889.19', '0.90', '398044.25', '0.98', '0.97', '0.86', '0.76']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [11, 18, 13, 3, 14, 19, 6, 15, 9, 20, 1, 16, 8, 7, 12, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:48...
global Accuracy on shared test data: 75.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:48, End: 2025-07-22 16:02:48)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 12, 17, 19, 11, 5, 10, 4, 3, 2, 20, 14, 7, 9, 18, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2038e+00, 3.7961e+05, 3.8372e+05, 1.0832e+00, 9.2159e-01,
         1.0751e+00, 1.1096e+00, 9.0292e-01, 1.5083e+00, 3.9789e+05, 3.7777e+05,
         8.9050e-01, 9.1309e-01, 3.8637e+05, 3.9347e+05],
        [1.2038e+00, 0.0000e+00, 3.7964e+05, 3.8370e+05, 3.7598e-01, 1.0435e+00,
         3.5445e-01, 2.8748e-01, 1.0247e+00, 4.1561e-01, 3.9788e+05, 3.7776e+05,
         1.1548e+00, 7.7304e-01, 3.8639e+05, 3.9345e+05],
        [3.7961e+05, 3.7964e+05, 0.0000e+00, 7.6534e+05, 3.7964e+05, 3.7961e+05,
         3.7964e+05, 3.7963e+05, 3.7963e+05, 3.7964e+05, 7.6214e+05, 7.4039e+05,
         3.7961e+05, 3.7961e+05, 7.8038e+05, 7.8538e+05],
        [3.8372e+05, 3.8370e+05, 7.6534e+05, 0.0000e+00, 3.8371e+05, 3.8373e+05,
         3.8371e+05, 3.8369e+05, 3.8373e+05, 3.8369e+05, 7.8886e+05, 7.5479e+05,
         3.8373e+05, 3.8373e+05, 7.6916e+05, 7.7230e+05],
        [1.0832e+00, 3.7598e-01, 3.7964e+05, 3.8371e+05, 0.0000e+00, 9.5337e-01,
         3.6951e-01, 3.1164e-01, 9.5220e-01, 4.7471e-01, 3.9789e+05, 3.7776e+05,
         1.0364e+00, 6.7167e-01, 3.8636e+05, 3.9345e+05],
        [9.2159e-01, 1.0435e+00, 3.7961e+05, 3.8373e+05, 9.5337e-01, 0.0000e+00,
         9.3721e-01, 1.0087e+00, 8.6087e-01, 1.3786e+00, 3.9787e+05, 3.7777e+05,
         8.8084e-01, 8.5148e-01, 3.8639e+05, 3.9344e+05],
        [1.0751e+00, 3.5445e-01, 3.7964e+05, 3.8371e+05, 3.6951e-01, 9.3721e-01,
         0.0000e+00, 3.2445e-01, 9.5048e-01, 4.9654e-01, 3.9788e+05, 3.7777e+05,
         1.0609e+00, 7.1483e-01, 3.8639e+05, 3.9346e+05],
        [1.1096e+00, 2.8748e-01, 3.7963e+05, 3.8369e+05, 3.1164e-01, 1.0087e+00,
         3.2445e-01, 0.0000e+00, 9.8634e-01, 3.4998e-01, 3.9788e+05, 3.7775e+05,
         1.1240e+00, 7.1349e-01, 3.8637e+05, 3.9345e+05],
        [9.0292e-01, 1.0247e+00, 3.7963e+05, 3.8373e+05, 9.5220e-01, 8.6087e-01,
         9.5048e-01, 9.8634e-01, 0.0000e+00, 1.3181e+00, 3.9786e+05, 3.7778e+05,
         8.7595e-01, 8.2712e-01, 3.8636e+05, 3.9345e+05],
        [1.5083e+00, 4.1561e-01, 3.7964e+05, 3.8369e+05, 4.7471e-01, 1.3786e+00,
         4.9654e-01, 3.4998e-01, 1.3181e+00, 0.0000e+00, 3.9789e+05, 3.7774e+05,
         1.4562e+00, 9.3847e-01, 3.8637e+05, 3.9343e+05],
        [3.9789e+05, 3.9788e+05, 7.6214e+05, 7.8886e+05, 3.9789e+05, 3.9787e+05,
         3.9788e+05, 3.9788e+05, 3.9786e+05, 3.9789e+05, 0.0000e+00, 7.7999e+05,
         3.9787e+05, 3.9790e+05, 7.8508e+05, 7.9677e+05],
        [3.7777e+05, 3.7776e+05, 7.4039e+05, 7.5479e+05, 3.7776e+05, 3.7777e+05,
         3.7777e+05, 3.7775e+05, 3.7778e+05, 3.7774e+05, 7.7999e+05, 0.0000e+00,
         3.7776e+05, 3.7776e+05, 7.4462e+05, 7.8519e+05],
        [8.9050e-01, 1.1548e+00, 3.7961e+05, 3.8373e+05, 1.0364e+00, 8.8084e-01,
         1.0609e+00, 1.1240e+00, 8.7595e-01, 1.4562e+00, 3.9787e+05, 3.7776e+05,
         0.0000e+00, 8.7997e-01, 3.8637e+05, 3.9346e+05],
        [9.1309e-01, 7.7304e-01, 3.7961e+05, 3.8373e+05, 6.7167e-01, 8.5148e-01,
         7.1483e-01, 7.1349e-01, 8.2712e-01, 9.3847e-01, 3.9790e+05, 3.7776e+05,
         8.7997e-01, 0.0000e+00, 3.8638e+05, 3.9347e+05],
        [3.8637e+05, 3.8639e+05, 7.8038e+05, 7.6916e+05, 3.8636e+05, 3.8639e+05,
         3.8639e+05, 3.8637e+05, 3.8636e+05, 3.8637e+05, 7.8508e+05, 7.4462e+05,
         3.8637e+05, 3.8638e+05, 0.0000e+00, 7.6882e+05],
        [3.9347e+05, 3.9345e+05, 7.8538e+05, 7.7230e+05, 3.9345e+05, 3.9344e+05,
         3.9346e+05, 3.9345e+05, 3.9345e+05, 3.9343e+05, 7.9677e+05, 7.8519e+05,
         3.9346e+05, 3.9347e+05, 7.6882e+05, 0.0000e+00]])
Krum scores: ['1.01', '0.68', '379622.75', '383708.62', '0.64', '0.93', '0.65', '0.64', '0.92', '0.85', '397876.44', '377757.47', '0.99', '0.79', '386372.59', '393448.25']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 12, 17, 19, 11, 5, 10, 4, 3, 2, 20, 14, 7, 9, 18, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:49...
global Accuracy on shared test data: 73.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:49, End: 2025-07-22 16:02:49)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 15, 20, 9, 1, 5, 14, 17, 16, 13, 6, 2, 19, 18, 8, 3], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9511e+05, 3.9512e+05, 8.4207e-01, 1.0855e+00, 1.2165e+00,
         3.9210e+05, 3.7656e+05, 4.0140e+05, 3.9664e+05, 9.9869e-01, 2.9886e-01,
         3.9125e+05, 3.9032e+05, 1.2355e+00, 1.1719e+00],
        [3.9511e+05, 0.0000e+00, 8.0649e+05, 3.9510e+05, 3.9513e+05, 3.9513e+05,
         7.9503e+05, 7.6095e+05, 7.9881e+05, 7.8802e+05, 3.9511e+05, 3.9511e+05,
         7.5475e+05, 7.9555e+05, 3.9510e+05, 3.9512e+05],
        [3.9512e+05, 8.0649e+05, 0.0000e+00, 3.9511e+05, 3.9512e+05, 3.9511e+05,
         7.9329e+05, 7.8219e+05, 7.9728e+05, 7.9479e+05, 3.9511e+05, 3.9512e+05,
         7.9661e+05, 7.8019e+05, 3.9514e+05, 3.9516e+05],
        [8.4207e-01, 3.9510e+05, 3.9511e+05, 0.0000e+00, 7.8837e-01, 8.5437e-01,
         3.9208e+05, 3.7656e+05, 4.0138e+05, 3.9663e+05, 7.7864e-01, 6.9636e-01,
         3.9124e+05, 3.9033e+05, 8.8780e-01, 8.2634e-01],
        [1.0855e+00, 3.9513e+05, 3.9512e+05, 7.8837e-01, 0.0000e+00, 8.7154e-01,
         3.9208e+05, 3.7654e+05, 4.0139e+05, 3.9660e+05, 7.8176e-01, 9.4378e-01,
         3.9125e+05, 3.9031e+05, 8.6760e-01, 8.6738e-01],
        [1.2165e+00, 3.9513e+05, 3.9511e+05, 8.5437e-01, 8.7154e-01, 0.0000e+00,
         3.9210e+05, 3.7657e+05, 4.0139e+05, 3.9663e+05, 8.3057e-01, 1.0983e+00,
         3.9124e+05, 3.9029e+05, 9.0114e-01, 8.5864e-01],
        [3.9210e+05, 7.9503e+05, 7.9329e+05, 3.9208e+05, 3.9208e+05, 3.9210e+05,
         0.0000e+00, 7.7647e+05, 7.9152e+05, 7.8072e+05, 3.9210e+05, 3.9208e+05,
         7.8755e+05, 7.6338e+05, 3.9210e+05, 3.9208e+05],
        [3.7656e+05, 7.6095e+05, 7.8219e+05, 3.7656e+05, 3.7654e+05, 3.7657e+05,
         7.7647e+05, 0.0000e+00, 7.5848e+05, 7.7251e+05, 3.7654e+05, 3.7654e+05,
         7.8518e+05, 7.6283e+05, 3.7656e+05, 3.7656e+05],
        [4.0140e+05, 7.9881e+05, 7.9728e+05, 4.0138e+05, 4.0139e+05, 4.0139e+05,
         7.9152e+05, 7.5848e+05, 0.0000e+00, 8.1278e+05, 4.0137e+05, 4.0140e+05,
         7.8666e+05, 8.1020e+05, 4.0139e+05, 4.0141e+05],
        [3.9664e+05, 7.8802e+05, 7.9479e+05, 3.9663e+05, 3.9660e+05, 3.9663e+05,
         7.8072e+05, 7.7251e+05, 8.1278e+05, 0.0000e+00, 3.9662e+05, 3.9663e+05,
         7.8507e+05, 7.6935e+05, 3.9663e+05, 3.9663e+05],
        [9.9869e-01, 3.9511e+05, 3.9511e+05, 7.7864e-01, 7.8176e-01, 8.3057e-01,
         3.9210e+05, 3.7654e+05, 4.0137e+05, 3.9662e+05, 0.0000e+00, 8.6895e-01,
         3.9123e+05, 3.9031e+05, 8.2477e-01, 8.7933e-01],
        [2.9886e-01, 3.9511e+05, 3.9512e+05, 6.9636e-01, 9.4378e-01, 1.0983e+00,
         3.9208e+05, 3.7654e+05, 4.0140e+05, 3.9663e+05, 8.6895e-01, 0.0000e+00,
         3.9125e+05, 3.9032e+05, 1.1203e+00, 1.0437e+00],
        [3.9125e+05, 7.5475e+05, 7.9661e+05, 3.9124e+05, 3.9125e+05, 3.9124e+05,
         7.8755e+05, 7.8518e+05, 7.8666e+05, 7.8507e+05, 3.9123e+05, 3.9125e+05,
         0.0000e+00, 7.7154e+05, 3.9122e+05, 3.9124e+05],
        [3.9032e+05, 7.9555e+05, 7.8019e+05, 3.9033e+05, 3.9031e+05, 3.9029e+05,
         7.6338e+05, 7.6283e+05, 8.1020e+05, 7.6935e+05, 3.9031e+05, 3.9032e+05,
         7.7154e+05, 0.0000e+00, 3.9030e+05, 3.9030e+05],
        [1.2355e+00, 3.9510e+05, 3.9514e+05, 8.8780e-01, 8.6760e-01, 9.0114e-01,
         3.9210e+05, 3.7656e+05, 4.0139e+05, 3.9663e+05, 8.2477e-01, 1.1203e+00,
         3.9122e+05, 3.9030e+05, 0.0000e+00, 9.0975e-01],
        [1.1719e+00, 3.9512e+05, 3.9516e+05, 8.2634e-01, 8.6738e-01, 8.5864e-01,
         3.9208e+05, 3.7656e+05, 4.0141e+05, 3.9663e+05, 8.7933e-01, 1.0437e+00,
         3.9124e+05, 3.9030e+05, 9.0975e-01, 0.0000e+00]])
Krum scores: ['0.94', '395109.47', '395115.75', '0.80', '0.85', '0.90', '392085.34', '376549.59', '401386.62', '396624.22', '0.83', '0.82', '391237.09', '390305.91', '0.92', '0.90']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 15, 20, 9, 1, 5, 14, 17, 16, 13, 6, 2, 19, 18, 8, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0042s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:49...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[167  70]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:49, End: 2025-07-22 16:02:49)
start time is: 99134144608646, end time is: 99151792612892
The total time is: 17648004246ns.

 ------- aggregate method: krum, random_seed: 400 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 6, 13, 16, 7, 15, 9, 17, 14, 10, 8, 12, 20, 19, 1, 18], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.9411e+00, 3.9884e+05, 4.0426e+05, 6.2588e+00, 3.8641e+05,
         4.6669e+00, 3.9727e+05, 3.9351e+05, 5.6325e+00, 6.0108e+00, 5.2199e+00,
         3.8471e+05, 3.7860e+05, 5.2765e+00, 3.9279e+05],
        [4.9411e+00, 0.0000e+00, 3.9889e+05, 4.0422e+05, 5.9880e+00, 3.8644e+05,
         5.0068e+00, 3.9725e+05, 3.9354e+05, 3.8044e+00, 4.1410e+00, 3.8923e+00,
         3.8476e+05, 3.7867e+05, 3.8368e+00, 3.9279e+05],
        [3.9884e+05, 3.9889e+05, 0.0000e+00, 7.9902e+05, 3.9899e+05, 7.8863e+05,
         3.9891e+05, 7.9352e+05, 7.7129e+05, 3.9890e+05, 3.9887e+05, 3.9891e+05,
         7.9037e+05, 7.7185e+05, 3.9888e+05, 8.0128e+05],
        [4.0426e+05, 4.0422e+05, 7.9902e+05, 0.0000e+00, 4.0427e+05, 7.9396e+05,
         4.0427e+05, 8.1630e+05, 8.0999e+05, 4.0418e+05, 4.0427e+05, 4.0427e+05,
         8.0480e+05, 7.5811e+05, 4.0424e+05, 8.0332e+05],
        [6.2588e+00, 5.9880e+00, 3.9899e+05, 4.0427e+05, 0.0000e+00, 3.8642e+05,
         7.4958e+00, 3.9724e+05, 3.9345e+05, 6.1478e+00, 7.0446e+00, 6.3988e+00,
         3.8482e+05, 3.7869e+05, 6.0572e+00, 3.9279e+05],
        [3.8641e+05, 3.8644e+05, 7.8863e+05, 7.9396e+05, 3.8642e+05, 0.0000e+00,
         3.8641e+05, 8.0350e+05, 7.9787e+05, 3.8644e+05, 3.8642e+05, 3.8641e+05,
         7.8270e+05, 7.7445e+05, 3.8648e+05, 7.6136e+05],
        [4.6669e+00, 5.0068e+00, 3.9891e+05, 4.0427e+05, 7.4958e+00, 3.8641e+05,
         0.0000e+00, 3.9724e+05, 3.9354e+05, 5.7209e+00, 5.7911e+00, 4.7279e+00,
         3.8469e+05, 3.7865e+05, 5.4718e+00, 3.9277e+05],
        [3.9727e+05, 3.9725e+05, 7.9352e+05, 8.1630e+05, 3.9724e+05, 8.0350e+05,
         3.9724e+05, 0.0000e+00, 7.7849e+05, 3.9723e+05, 3.9722e+05, 3.9722e+05,
         7.7812e+05, 7.5860e+05, 3.9724e+05, 8.0758e+05],
        [3.9351e+05, 3.9354e+05, 7.7129e+05, 8.0999e+05, 3.9345e+05, 7.9787e+05,
         3.9354e+05, 7.7849e+05, 0.0000e+00, 3.9354e+05, 3.9354e+05, 3.9352e+05,
         7.7766e+05, 7.6314e+05, 3.9355e+05, 7.9154e+05],
        [5.6325e+00, 3.8044e+00, 3.9890e+05, 4.0418e+05, 6.1478e+00, 3.8644e+05,
         5.7209e+00, 3.9723e+05, 3.9354e+05, 0.0000e+00, 4.5356e+00, 4.3822e+00,
         3.8475e+05, 3.7868e+05, 4.5437e+00, 3.9278e+05],
        [6.0108e+00, 4.1410e+00, 3.9887e+05, 4.0427e+05, 7.0446e+00, 3.8642e+05,
         5.7911e+00, 3.9722e+05, 3.9354e+05, 4.5356e+00, 0.0000e+00, 4.4594e+00,
         3.8478e+05, 3.7871e+05, 5.2195e+00, 3.9281e+05],
        [5.2199e+00, 3.8923e+00, 3.9891e+05, 4.0427e+05, 6.3988e+00, 3.8641e+05,
         4.7279e+00, 3.9722e+05, 3.9352e+05, 4.3822e+00, 4.4594e+00, 0.0000e+00,
         3.8473e+05, 3.7868e+05, 4.4877e+00, 3.9282e+05],
        [3.8471e+05, 3.8476e+05, 7.9037e+05, 8.0480e+05, 3.8482e+05, 7.8270e+05,
         3.8469e+05, 7.7812e+05, 7.7766e+05, 3.8475e+05, 3.8478e+05, 3.8473e+05,
         0.0000e+00, 7.6267e+05, 3.8476e+05, 7.7434e+05],
        [3.7860e+05, 3.7867e+05, 7.7185e+05, 7.5811e+05, 3.7869e+05, 7.7445e+05,
         3.7865e+05, 7.5860e+05, 7.6314e+05, 3.7868e+05, 3.7871e+05, 3.7868e+05,
         7.6267e+05, 0.0000e+00, 3.7862e+05, 7.6663e+05],
        [5.2765e+00, 3.8368e+00, 3.9888e+05, 4.0424e+05, 6.0572e+00, 3.8648e+05,
         5.4718e+00, 3.9724e+05, 3.9355e+05, 4.5437e+00, 5.2195e+00, 4.4877e+00,
         3.8476e+05, 3.7862e+05, 0.0000e+00, 3.9280e+05],
        [3.9279e+05, 3.9279e+05, 8.0128e+05, 8.0332e+05, 3.9279e+05, 7.6136e+05,
         3.9277e+05, 8.0758e+05, 7.9154e+05, 3.9278e+05, 3.9281e+05, 3.9282e+05,
         7.7434e+05, 7.6663e+05, 3.9280e+05, 0.0000e+00]])
Krum scores: ['5.29', '4.27', '398881.00', '404240.09', '6.32', '386419.16', '5.23', '397230.75', '393515.97', '4.77', '5.03', '4.53', '384734.97', '378650.75', '4.81', '392787.09']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 6, 13, 16, 7, 15, 9, 17, 14, 10, 8, 12, 20, 19, 1, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0118s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:50...
global Accuracy on shared test data: 74.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [ 60 203]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:50, End: 2025-07-22 16:02:50)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 1, 17, 11, 15, 20, 4, 19, 14, 7, 8, 3, 13, 16, 2, 9], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.9780e+00, 3.9825e+05, 1.9953e+00, 3.9164e+05, 4.0848e+05,
         1.9516e+00, 3.8765e+05, 4.0572e+05, 2.1169e+00, 2.0164e+00, 1.9263e+00,
         4.0240e+05, 3.8246e+05, 1.9753e+00, 1.9778e+00],
        [1.9780e+00, 0.0000e+00, 3.9823e+05, 1.9971e+00, 3.9159e+05, 4.0847e+05,
         2.0488e+00, 3.8773e+05, 4.0572e+05, 2.0963e+00, 2.2629e+00, 2.0802e+00,
         4.0244e+05, 3.8247e+05, 1.8449e+00, 1.8536e+00],
        [3.9825e+05, 3.9823e+05, 0.0000e+00, 3.9823e+05, 8.0539e+05, 8.0718e+05,
         3.9823e+05, 7.9353e+05, 8.1012e+05, 3.9820e+05, 3.9822e+05, 3.9822e+05,
         7.8243e+05, 7.6316e+05, 3.9823e+05, 3.9823e+05],
        [1.9953e+00, 1.9971e+00, 3.9823e+05, 0.0000e+00, 3.9164e+05, 4.0849e+05,
         2.0891e+00, 3.8771e+05, 4.0575e+05, 2.1790e+00, 2.2139e+00, 2.1164e+00,
         4.0242e+05, 3.8250e+05, 2.1730e+00, 1.9975e+00],
        [3.9164e+05, 3.9159e+05, 8.0539e+05, 3.9164e+05, 0.0000e+00, 8.0648e+05,
         3.9167e+05, 8.0433e+05, 7.8667e+05, 3.9164e+05, 3.9169e+05, 3.9159e+05,
         8.1281e+05, 7.5641e+05, 3.9158e+05, 3.9164e+05],
        [4.0848e+05, 4.0847e+05, 8.0718e+05, 4.0849e+05, 8.0648e+05, 0.0000e+00,
         4.0847e+05, 8.0789e+05, 8.1728e+05, 4.0849e+05, 4.0846e+05, 4.0848e+05,
         7.9639e+05, 7.5912e+05, 4.0849e+05, 4.0847e+05],
        [1.9516e+00, 2.0488e+00, 3.9823e+05, 2.0891e+00, 3.9167e+05, 4.0847e+05,
         0.0000e+00, 3.8771e+05, 4.0570e+05, 2.1067e+00, 2.0551e+00, 2.0575e+00,
         4.0243e+05, 3.8246e+05, 1.9931e+00, 2.0276e+00],
        [3.8765e+05, 3.8773e+05, 7.9353e+05, 3.8771e+05, 8.0433e+05, 8.0789e+05,
         3.8771e+05, 0.0000e+00, 7.9040e+05, 3.8768e+05, 3.8767e+05, 3.8771e+05,
         7.8888e+05, 7.6489e+05, 3.8767e+05, 3.8773e+05],
        [4.0572e+05, 4.0572e+05, 8.1012e+05, 4.0575e+05, 7.8667e+05, 8.1728e+05,
         4.0570e+05, 7.9040e+05, 0.0000e+00, 4.0574e+05, 4.0571e+05, 4.0569e+05,
         7.9701e+05, 7.8390e+05, 4.0568e+05, 4.0570e+05],
        [2.1169e+00, 2.0963e+00, 3.9820e+05, 2.1790e+00, 3.9164e+05, 4.0849e+05,
         2.1067e+00, 3.8768e+05, 4.0574e+05, 0.0000e+00, 2.4280e+00, 2.1831e+00,
         4.0240e+05, 3.8246e+05, 2.0133e+00, 2.0725e+00],
        [2.0164e+00, 2.2629e+00, 3.9822e+05, 2.2139e+00, 3.9169e+05, 4.0846e+05,
         2.0551e+00, 3.8767e+05, 4.0571e+05, 2.4280e+00, 0.0000e+00, 2.1439e+00,
         4.0243e+05, 3.8251e+05, 2.2834e+00, 2.0703e+00],
        [1.9263e+00, 2.0802e+00, 3.9822e+05, 2.1164e+00, 3.9159e+05, 4.0848e+05,
         2.0575e+00, 3.8771e+05, 4.0569e+05, 2.1831e+00, 2.1439e+00, 0.0000e+00,
         4.0240e+05, 3.8248e+05, 2.0850e+00, 1.9406e+00],
        [4.0240e+05, 4.0244e+05, 7.8243e+05, 4.0242e+05, 8.1281e+05, 7.9639e+05,
         4.0243e+05, 7.8888e+05, 7.9701e+05, 4.0240e+05, 4.0243e+05, 4.0240e+05,
         0.0000e+00, 7.7596e+05, 4.0241e+05, 4.0240e+05],
        [3.8246e+05, 3.8247e+05, 7.6316e+05, 3.8250e+05, 7.5641e+05, 7.5912e+05,
         3.8246e+05, 7.6489e+05, 7.8390e+05, 3.8246e+05, 3.8251e+05, 3.8248e+05,
         7.7596e+05, 0.0000e+00, 3.8249e+05, 3.8252e+05],
        [1.9753e+00, 1.8449e+00, 3.9823e+05, 2.1730e+00, 3.9158e+05, 4.0849e+05,
         1.9931e+00, 3.8767e+05, 4.0568e+05, 2.0133e+00, 2.2834e+00, 2.0850e+00,
         4.0241e+05, 3.8249e+05, 0.0000e+00, 1.8697e+00],
        [1.9778e+00, 1.8536e+00, 3.9823e+05, 1.9975e+00, 3.9164e+05, 4.0847e+05,
         2.0276e+00, 3.8773e+05, 4.0570e+05, 2.0725e+00, 2.0703e+00, 1.9406e+00,
         4.0240e+05, 3.8252e+05, 1.8697e+00, 0.0000e+00]])
Krum scores: ['1.97', '1.99', '398222.44', '2.08', '391617.06', '408473.53', '2.03', '387685.25', '405704.69', '2.11', '2.15', '2.05', '402407.78', '382473.50', '1.99', '1.96']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [12, 1, 17, 11, 15, 20, 4, 19, 14, 7, 8, 3, 13, 16, 2, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0036s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:51...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:51, End: 2025-07-22 16:02:51)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 3, 6, 11, 1, 2, 7, 19, 20, 13, 5, 8, 12, 10, 15, 4], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9506e+05, 3.9502e+05, 3.9502e+05, 3.9505e+05, 3.9505e+05,
         3.9499e+05, 7.8887e+05, 8.0398e+05, 7.8169e+05, 3.9501e+05, 3.9503e+05,
         3.9506e+05, 3.9503e+05, 7.7390e+05, 3.9504e+05],
        [3.9506e+05, 0.0000e+00, 1.9968e+00, 1.8172e+00, 1.8686e+00, 1.8379e+00,
         1.8661e+00, 3.8365e+05, 4.0813e+05, 3.9425e+05, 1.7086e+00, 1.7194e+00,
         1.6312e+00, 1.6485e+00, 3.8927e+05, 1.7664e+00],
        [3.9502e+05, 1.9968e+00, 0.0000e+00, 1.8056e+00, 1.7192e+00, 1.6127e+00,
         1.8819e+00, 3.8365e+05, 4.0812e+05, 3.9428e+05, 1.8013e+00, 1.7586e+00,
         1.7679e+00, 1.7783e+00, 3.8923e+05, 1.7068e+00],
        [3.9502e+05, 1.8172e+00, 1.8056e+00, 0.0000e+00, 1.6744e+00, 1.7062e+00,
         1.6787e+00, 3.8362e+05, 4.0811e+05, 3.9429e+05, 1.6609e+00, 1.7870e+00,
         1.6715e+00, 1.7235e+00, 3.8926e+05, 1.7068e+00],
        [3.9505e+05, 1.8686e+00, 1.7192e+00, 1.6744e+00, 0.0000e+00, 1.6088e+00,
         1.7540e+00, 3.8363e+05, 4.0809e+05, 3.9429e+05, 1.7824e+00, 1.9094e+00,
         1.7641e+00, 1.7326e+00, 3.8928e+05, 1.7976e+00],
        [3.9505e+05, 1.8379e+00, 1.6127e+00, 1.7062e+00, 1.6088e+00, 0.0000e+00,
         1.6221e+00, 3.8363e+05, 4.0810e+05, 3.9430e+05, 1.7060e+00, 1.7656e+00,
         1.6920e+00, 1.6772e+00, 3.8927e+05, 1.7090e+00],
        [3.9499e+05, 1.8661e+00, 1.8819e+00, 1.6787e+00, 1.7540e+00, 1.6221e+00,
         0.0000e+00, 3.8361e+05, 4.0810e+05, 3.9430e+05, 1.6541e+00, 1.7962e+00,
         1.7605e+00, 1.7768e+00, 3.8926e+05, 1.6807e+00],
        [7.8887e+05, 3.8365e+05, 3.8365e+05, 3.8362e+05, 3.8363e+05, 3.8363e+05,
         3.8361e+05, 0.0000e+00, 7.8300e+05, 7.8270e+05, 3.8360e+05, 3.8364e+05,
         3.8362e+05, 3.8361e+05, 7.6630e+05, 3.8364e+05],
        [8.0398e+05, 4.0813e+05, 4.0812e+05, 4.0811e+05, 4.0809e+05, 4.0810e+05,
         4.0810e+05, 7.8300e+05, 0.0000e+00, 7.9620e+05, 4.0812e+05, 4.0815e+05,
         4.0812e+05, 4.0812e+05, 7.9411e+05, 4.0809e+05],
        [7.8169e+05, 3.9425e+05, 3.9428e+05, 3.9429e+05, 3.9429e+05, 3.9430e+05,
         3.9430e+05, 7.8270e+05, 7.9620e+05, 0.0000e+00, 3.9430e+05, 3.9431e+05,
         3.9429e+05, 3.9425e+05, 7.7961e+05, 3.9430e+05],
        [3.9501e+05, 1.7086e+00, 1.8013e+00, 1.6609e+00, 1.7824e+00, 1.7060e+00,
         1.6541e+00, 3.8360e+05, 4.0812e+05, 3.9430e+05, 0.0000e+00, 1.8298e+00,
         1.6995e+00, 1.7673e+00, 3.8929e+05, 1.7174e+00],
        [3.9503e+05, 1.7194e+00, 1.7586e+00, 1.7870e+00, 1.9094e+00, 1.7656e+00,
         1.7962e+00, 3.8364e+05, 4.0815e+05, 3.9431e+05, 1.8298e+00, 0.0000e+00,
         1.6395e+00, 1.6371e+00, 3.8922e+05, 1.6769e+00],
        [3.9506e+05, 1.6312e+00, 1.7679e+00, 1.6715e+00, 1.7641e+00, 1.6920e+00,
         1.7605e+00, 3.8362e+05, 4.0812e+05, 3.9429e+05, 1.6995e+00, 1.6395e+00,
         0.0000e+00, 1.5871e+00, 3.8927e+05, 1.5978e+00],
        [3.9503e+05, 1.6485e+00, 1.7783e+00, 1.7235e+00, 1.7326e+00, 1.6772e+00,
         1.7768e+00, 3.8361e+05, 4.0812e+05, 3.9425e+05, 1.7673e+00, 1.6371e+00,
         1.5871e+00, 0.0000e+00, 3.8927e+05, 1.6891e+00],
        [7.7390e+05, 3.8927e+05, 3.8923e+05, 3.8926e+05, 3.8928e+05, 3.8927e+05,
         3.8926e+05, 7.6630e+05, 7.9411e+05, 7.7961e+05, 3.8929e+05, 3.8922e+05,
         3.8927e+05, 3.8927e+05, 0.0000e+00, 3.8926e+05],
        [3.9504e+05, 1.7664e+00, 1.7068e+00, 1.7068e+00, 1.7976e+00, 1.7090e+00,
         1.6807e+00, 3.8364e+05, 4.0809e+05, 3.9430e+05, 1.7174e+00, 1.6769e+00,
         1.5978e+00, 1.6891e+00, 3.8926e+05, 0.0000e+00]])
Krum scores: ['395026.78', '1.76', '1.76', '1.71', '1.74', '1.68', '1.73', '383621.72', '408110.12', '394281.06', '1.72', '1.73', '1.67', '1.69', '389258.03', '1.69']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 3, 6, 11, 1, 2, 7, 19, 20, 13, 5, 8, 12, 10, 15, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:51...
global Accuracy on shared test data: 77.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:51, End: 2025-07-22 16:02:51)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 17, 19, 3, 4, 9, 10, 14, 18, 12, 8, 16, 2, 7, 13, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9010e+05, 3.9175e+05, 1.7777e+00, 1.6092e+00, 1.6670e+00,
         1.5500e+00, 4.0080e+05, 3.8671e+05, 1.7117e+00, 1.7638e+00, 3.8230e+05,
         1.6371e+00, 1.5716e+00, 3.9610e+05, 3.9606e+05],
        [3.9010e+05, 0.0000e+00, 7.6586e+05, 3.9013e+05, 3.9013e+05, 3.9013e+05,
         3.9016e+05, 7.8967e+05, 7.7877e+05, 3.9014e+05, 3.9011e+05, 7.6630e+05,
         3.9015e+05, 3.9014e+05, 7.7330e+05, 7.5373e+05],
        [3.9175e+05, 7.6586e+05, 0.0000e+00, 3.9175e+05, 3.9179e+05, 3.9178e+05,
         3.9175e+05, 8.0494e+05, 7.8351e+05, 3.9176e+05, 3.9174e+05, 7.5851e+05,
         3.9173e+05, 3.9179e+05, 7.8114e+05, 7.6765e+05],
        [1.7777e+00, 3.9013e+05, 3.9175e+05, 0.0000e+00, 1.8349e+00, 1.7207e+00,
         1.6180e+00, 4.0079e+05, 3.8670e+05, 1.7027e+00, 1.7913e+00, 3.8233e+05,
         1.6979e+00, 1.8129e+00, 3.9610e+05, 3.9597e+05],
        [1.6092e+00, 3.9013e+05, 3.9179e+05, 1.8349e+00, 0.0000e+00, 1.8688e+00,
         1.7040e+00, 4.0082e+05, 3.8670e+05, 1.7165e+00, 1.7685e+00, 3.8232e+05,
         1.6506e+00, 1.6449e+00, 3.9609e+05, 3.9602e+05],
        [1.6670e+00, 3.9013e+05, 3.9178e+05, 1.7207e+00, 1.8688e+00, 0.0000e+00,
         1.5370e+00, 4.0081e+05, 3.8670e+05, 1.5988e+00, 1.7797e+00, 3.8233e+05,
         1.6840e+00, 1.7986e+00, 3.9613e+05, 3.9602e+05],
        [1.5500e+00, 3.9016e+05, 3.9175e+05, 1.6180e+00, 1.7040e+00, 1.5370e+00,
         0.0000e+00, 4.0080e+05, 3.8668e+05, 1.6262e+00, 1.6119e+00, 3.8231e+05,
         1.5412e+00, 1.6378e+00, 3.9610e+05, 3.9598e+05],
        [4.0080e+05, 7.8967e+05, 8.0494e+05, 4.0079e+05, 4.0082e+05, 4.0081e+05,
         4.0080e+05, 0.0000e+00, 8.0059e+05, 4.0079e+05, 4.0079e+05, 7.6108e+05,
         4.0078e+05, 4.0079e+05, 8.0196e+05, 7.8934e+05],
        [3.8671e+05, 7.7877e+05, 7.8351e+05, 3.8670e+05, 3.8670e+05, 3.8670e+05,
         3.8668e+05, 8.0059e+05, 0.0000e+00, 3.8669e+05, 3.8671e+05, 7.7140e+05,
         3.8668e+05, 3.8669e+05, 7.8039e+05, 7.9172e+05],
        [1.7117e+00, 3.9014e+05, 3.9176e+05, 1.7027e+00, 1.7165e+00, 1.5988e+00,
         1.6262e+00, 4.0079e+05, 3.8669e+05, 0.0000e+00, 1.7725e+00, 3.8229e+05,
         1.7327e+00, 1.7953e+00, 3.9610e+05, 3.9600e+05],
        [1.7638e+00, 3.9011e+05, 3.9174e+05, 1.7913e+00, 1.7685e+00, 1.7797e+00,
         1.6119e+00, 4.0079e+05, 3.8671e+05, 1.7725e+00, 0.0000e+00, 3.8233e+05,
         1.8096e+00, 1.8265e+00, 3.9609e+05, 3.9601e+05],
        [3.8230e+05, 7.6630e+05, 7.5851e+05, 3.8233e+05, 3.8232e+05, 3.8233e+05,
         3.8231e+05, 7.6108e+05, 7.7140e+05, 3.8229e+05, 3.8233e+05, 0.0000e+00,
         3.8230e+05, 3.8230e+05, 7.8283e+05, 7.7636e+05],
        [1.6371e+00, 3.9015e+05, 3.9173e+05, 1.6979e+00, 1.6506e+00, 1.6840e+00,
         1.5412e+00, 4.0078e+05, 3.8668e+05, 1.7327e+00, 1.8096e+00, 3.8230e+05,
         0.0000e+00, 1.6427e+00, 3.9611e+05, 3.9602e+05],
        [1.5716e+00, 3.9014e+05, 3.9179e+05, 1.8129e+00, 1.6449e+00, 1.7986e+00,
         1.6378e+00, 4.0079e+05, 3.8669e+05, 1.7953e+00, 1.8265e+00, 3.8230e+05,
         1.6427e+00, 0.0000e+00, 3.9609e+05, 3.9600e+05],
        [3.9610e+05, 7.7330e+05, 7.8114e+05, 3.9610e+05, 3.9609e+05, 3.9613e+05,
         3.9610e+05, 8.0196e+05, 7.8039e+05, 3.9610e+05, 3.9609e+05, 7.8283e+05,
         3.9611e+05, 3.9609e+05, 0.0000e+00, 8.3362e+05],
        [3.9606e+05, 7.5373e+05, 7.6765e+05, 3.9597e+05, 3.9602e+05, 3.9602e+05,
         3.9598e+05, 7.8934e+05, 7.9172e+05, 3.9600e+05, 3.9601e+05, 7.7636e+05,
         3.9602e+05, 3.9600e+05, 8.3362e+05, 0.0000e+00]])
Krum scores: ['1.64', '390126.00', '391751.84', '1.73', '1.70', '1.68', '1.59', '400792.75', '386691.06', '1.69', '1.76', '382305.97', '1.66', '1.70', '396095.34', '395998.69']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 17, 19, 3, 4, 9, 10, 14, 18, 12, 8, 16, 2, 7, 13, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:52...
global Accuracy on shared test data: 77.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 51 212]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:52, End: 2025-07-22 16:02:52)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 17, 13, 12, 20, 7, 11, 1, 15, 10, 19, 2, 14, 6, 8, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8053e+05, 4.0076e+05, 1.6958e+00, 3.7597e+05, 1.5885e+00,
         1.5392e+00, 1.6940e+00, 4.0198e+05, 1.8464e+00, 4.0206e+05, 1.5605e+00,
         3.9126e+05, 1.6020e+00, 1.6436e+00, 1.8380e+00],
        [3.8053e+05, 0.0000e+00, 7.9760e+05, 3.8058e+05, 7.5244e+05, 3.8060e+05,
         3.8054e+05, 3.8056e+05, 7.6821e+05, 3.8056e+05, 7.9411e+05, 3.8056e+05,
         7.7614e+05, 3.8057e+05, 3.8054e+05, 3.8058e+05],
        [4.0076e+05, 7.9760e+05, 0.0000e+00, 4.0071e+05, 7.4817e+05, 4.0072e+05,
         4.0072e+05, 4.0076e+05, 8.0693e+05, 4.0070e+05, 8.0059e+05, 4.0070e+05,
         8.0404e+05, 4.0071e+05, 4.0070e+05, 4.0071e+05],
        [1.6958e+00, 3.8058e+05, 4.0071e+05, 0.0000e+00, 3.7599e+05, 1.7499e+00,
         1.7150e+00, 1.6554e+00, 4.0194e+05, 1.6001e+00, 4.0208e+05, 1.6927e+00,
         3.9126e+05, 1.6956e+00, 1.6529e+00, 1.6352e+00],
        [3.7597e+05, 7.5244e+05, 7.4817e+05, 3.7599e+05, 0.0000e+00, 3.7596e+05,
         3.7595e+05, 3.7597e+05, 7.7458e+05, 3.7597e+05, 7.7572e+05, 3.7596e+05,
         7.7238e+05, 3.7598e+05, 3.7596e+05, 3.7596e+05],
        [1.5885e+00, 3.8060e+05, 4.0072e+05, 1.7499e+00, 3.7596e+05, 0.0000e+00,
         1.5672e+00, 1.6314e+00, 4.0194e+05, 1.7616e+00, 4.0206e+05, 1.5457e+00,
         3.9126e+05, 1.7022e+00, 1.7061e+00, 1.8068e+00],
        [1.5392e+00, 3.8054e+05, 4.0072e+05, 1.7150e+00, 3.7595e+05, 1.5672e+00,
         0.0000e+00, 1.5710e+00, 4.0190e+05, 1.7316e+00, 4.0207e+05, 1.6347e+00,
         3.9130e+05, 1.6812e+00, 1.6717e+00, 1.6774e+00],
        [1.6940e+00, 3.8056e+05, 4.0076e+05, 1.6554e+00, 3.7597e+05, 1.6314e+00,
         1.5710e+00, 0.0000e+00, 4.0197e+05, 1.7285e+00, 4.0205e+05, 1.5185e+00,
         3.9129e+05, 1.5715e+00, 1.8102e+00, 1.6692e+00],
        [4.0198e+05, 7.6821e+05, 8.0693e+05, 4.0194e+05, 7.7458e+05, 4.0194e+05,
         4.0190e+05, 4.0197e+05, 0.0000e+00, 4.0195e+05, 8.1877e+05, 4.0194e+05,
         7.8415e+05, 4.0196e+05, 4.0196e+05, 4.0196e+05],
        [1.8464e+00, 3.8056e+05, 4.0070e+05, 1.6001e+00, 3.7597e+05, 1.7616e+00,
         1.7316e+00, 1.7285e+00, 4.0195e+05, 0.0000e+00, 4.0201e+05, 1.6956e+00,
         3.9132e+05, 1.7631e+00, 1.7729e+00, 1.5457e+00],
        [4.0206e+05, 7.9411e+05, 8.0059e+05, 4.0208e+05, 7.7572e+05, 4.0206e+05,
         4.0207e+05, 4.0205e+05, 8.1877e+05, 4.0201e+05, 0.0000e+00, 4.0203e+05,
         7.8926e+05, 4.0206e+05, 4.0206e+05, 4.0207e+05],
        [1.5605e+00, 3.8056e+05, 4.0070e+05, 1.6927e+00, 3.7596e+05, 1.5457e+00,
         1.6347e+00, 1.5185e+00, 4.0194e+05, 1.6956e+00, 4.0203e+05, 0.0000e+00,
         3.9129e+05, 1.4939e+00, 1.7138e+00, 1.6683e+00],
        [3.9126e+05, 7.7614e+05, 8.0404e+05, 3.9126e+05, 7.7238e+05, 3.9126e+05,
         3.9130e+05, 3.9129e+05, 7.8415e+05, 3.9132e+05, 7.8926e+05, 3.9129e+05,
         0.0000e+00, 3.9130e+05, 3.9126e+05, 3.9131e+05],
        [1.6020e+00, 3.8057e+05, 4.0071e+05, 1.6956e+00, 3.7598e+05, 1.7022e+00,
         1.6812e+00, 1.5715e+00, 4.0196e+05, 1.7631e+00, 4.0206e+05, 1.4939e+00,
         3.9130e+05, 0.0000e+00, 1.6640e+00, 1.6111e+00],
        [1.6436e+00, 3.8054e+05, 4.0070e+05, 1.6529e+00, 3.7596e+05, 1.7061e+00,
         1.6717e+00, 1.8102e+00, 4.0196e+05, 1.7729e+00, 4.0206e+05, 1.7138e+00,
         3.9126e+05, 1.6640e+00, 0.0000e+00, 1.7263e+00],
        [1.8380e+00, 3.8058e+05, 4.0071e+05, 1.6352e+00, 3.7596e+05, 1.8068e+00,
         1.6774e+00, 1.6692e+00, 4.0196e+05, 1.5457e+00, 4.0207e+05, 1.6683e+00,
         3.9131e+05, 1.6111e+00, 1.7263e+00, 0.0000e+00]])
Krum scores: ['1.65', '380554.75', '400708.34', '1.67', '375963.00', '1.66', '1.63', '1.63', '401943.78', '1.70', '402049.84', '1.60', '391277.25', '1.63', '1.69', '1.67']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 17, 13, 12, 20, 7, 11, 1, 15, 10, 19, 2, 14, 6, 8, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:52...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:52, End: 2025-07-22 16:02:52)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [19, 15, 9, 18, 3, 2, 8, 13, 10, 5, 4, 17, 11, 12, 1, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.7498e+05, 3.9851e+05, 7.6554e+05, 3.9853e+05, 3.9849e+05,
         3.9850e+05, 7.7408e+05, 3.9852e+05, 3.9847e+05, 3.9847e+05, 7.8981e+05,
         3.9848e+05, 3.9852e+05, 3.9850e+05, 7.9076e+05],
        [7.7498e+05, 0.0000e+00, 3.9090e+05, 7.7289e+05, 3.9086e+05, 3.9087e+05,
         3.9090e+05, 8.0055e+05, 3.9088e+05, 3.9085e+05, 3.9088e+05, 7.6436e+05,
         3.9085e+05, 3.9085e+05, 3.9083e+05, 7.7627e+05],
        [3.9851e+05, 3.9090e+05, 0.0000e+00, 3.9059e+05, 1.7403e+00, 1.5337e+00,
         1.7286e+00, 3.8895e+05, 1.5561e+00, 1.7476e+00, 1.8245e+00, 3.9237e+05,
         1.6942e+00, 1.5829e+00, 1.6776e+00, 3.9292e+05],
        [7.6554e+05, 7.7289e+05, 3.9059e+05, 0.0000e+00, 3.9056e+05, 3.9056e+05,
         3.9061e+05, 7.8157e+05, 3.9057e+05, 3.9059e+05, 3.9059e+05, 7.6289e+05,
         3.9057e+05, 3.9060e+05, 3.9058e+05, 7.9898e+05],
        [3.9853e+05, 3.9086e+05, 1.7403e+00, 3.9056e+05, 0.0000e+00, 1.7402e+00,
         1.8097e+00, 3.8896e+05, 1.7742e+00, 1.6771e+00, 1.7805e+00, 3.9234e+05,
         1.7631e+00, 1.6865e+00, 1.8386e+00, 3.9295e+05],
        [3.9849e+05, 3.9087e+05, 1.5337e+00, 3.9056e+05, 1.7402e+00, 0.0000e+00,
         1.8083e+00, 3.8893e+05, 1.6614e+00, 1.7780e+00, 1.7430e+00, 3.9238e+05,
         1.6996e+00, 1.6349e+00, 1.6344e+00, 3.9294e+05],
        [3.9850e+05, 3.9090e+05, 1.7286e+00, 3.9061e+05, 1.8097e+00, 1.8083e+00,
         0.0000e+00, 3.8893e+05, 1.7870e+00, 1.8572e+00, 1.7491e+00, 3.9239e+05,
         1.7244e+00, 1.6756e+00, 1.7745e+00, 3.9296e+05],
        [7.7408e+05, 8.0055e+05, 3.8895e+05, 7.8157e+05, 3.8896e+05, 3.8893e+05,
         3.8893e+05, 0.0000e+00, 3.8893e+05, 3.8895e+05, 3.8898e+05, 7.8514e+05,
         3.8895e+05, 3.8893e+05, 3.8898e+05, 7.6628e+05],
        [3.9852e+05, 3.9088e+05, 1.5561e+00, 3.9057e+05, 1.7742e+00, 1.6614e+00,
         1.7870e+00, 3.8893e+05, 0.0000e+00, 1.7985e+00, 1.8581e+00, 3.9236e+05,
         1.7259e+00, 1.5619e+00, 1.7309e+00, 3.9291e+05],
        [3.9847e+05, 3.9085e+05, 1.7476e+00, 3.9059e+05, 1.6771e+00, 1.7780e+00,
         1.8572e+00, 3.8895e+05, 1.7985e+00, 0.0000e+00, 1.6606e+00, 3.9234e+05,
         1.5198e+00, 1.7385e+00, 1.7078e+00, 3.9293e+05],
        [3.9847e+05, 3.9088e+05, 1.8245e+00, 3.9059e+05, 1.7805e+00, 1.7430e+00,
         1.7491e+00, 3.8898e+05, 1.8581e+00, 1.6606e+00, 0.0000e+00, 3.9234e+05,
         1.6212e+00, 1.6895e+00, 1.7644e+00, 3.9298e+05],
        [7.8981e+05, 7.6436e+05, 3.9237e+05, 7.6289e+05, 3.9234e+05, 3.9238e+05,
         3.9239e+05, 7.8514e+05, 3.9236e+05, 3.9234e+05, 3.9234e+05, 0.0000e+00,
         3.9237e+05, 3.9237e+05, 3.9236e+05, 7.9650e+05],
        [3.9848e+05, 3.9085e+05, 1.6942e+00, 3.9057e+05, 1.7631e+00, 1.6996e+00,
         1.7244e+00, 3.8895e+05, 1.7259e+00, 1.5198e+00, 1.6212e+00, 3.9237e+05,
         0.0000e+00, 1.7569e+00, 1.5615e+00, 3.9294e+05],
        [3.9852e+05, 3.9085e+05, 1.5829e+00, 3.9060e+05, 1.6865e+00, 1.6349e+00,
         1.6756e+00, 3.8893e+05, 1.5619e+00, 1.7385e+00, 1.6895e+00, 3.9237e+05,
         1.7569e+00, 0.0000e+00, 1.6595e+00, 3.9298e+05],
        [3.9850e+05, 3.9083e+05, 1.6776e+00, 3.9058e+05, 1.8386e+00, 1.6344e+00,
         1.7745e+00, 3.8898e+05, 1.7309e+00, 1.7078e+00, 1.7644e+00, 3.9236e+05,
         1.5615e+00, 1.6595e+00, 0.0000e+00, 3.9296e+05],
        [7.9076e+05, 7.7627e+05, 3.9292e+05, 7.9898e+05, 3.9295e+05, 3.9294e+05,
         3.9296e+05, 7.6628e+05, 3.9291e+05, 3.9293e+05, 3.9298e+05, 7.9650e+05,
         3.9294e+05, 3.9298e+05, 3.9296e+05, 0.0000e+00]])
Krum scores: ['398493.62', '390860.81', '1.66', '390576.62', '1.75', '1.68', '1.76', '388943.00', '1.70', '1.70', '1.73', '392355.91', '1.66', '1.65', '1.69', '392938.06']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [19, 15, 9, 18, 3, 2, 8, 13, 10, 5, 4, 17, 11, 12, 1, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0137s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:53...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[186  51]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:53, End: 2025-07-22 16:02:53)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 7, 15, 11, 2, 9, 6, 8, 14, 1, 18, 3, 13, 16, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9629e+05, 7.5305e+05, 3.9632e+05, 3.9630e+05, 3.9631e+05,
         3.9635e+05, 3.9634e+05, 7.7912e+05, 3.9630e+05, 7.8433e+05, 3.9631e+05,
         7.6955e+05, 7.9163e+05, 3.9631e+05, 8.0438e+05],
        [3.9629e+05, 0.0000e+00, 3.9037e+05, 1.3598e+00, 1.4842e+00, 1.5737e+00,
         1.5627e+00, 1.4995e+00, 3.9050e+05, 1.4971e+00, 3.8430e+05, 1.6048e+00,
         3.9108e+05, 4.1454e+05, 1.5605e+00, 3.9795e+05],
        [7.5305e+05, 3.9037e+05, 0.0000e+00, 3.9037e+05, 3.9032e+05, 3.9034e+05,
         3.9038e+05, 3.9039e+05, 7.7693e+05, 3.9036e+05, 7.6353e+05, 3.9037e+05,
         7.8082e+05, 8.1084e+05, 3.9034e+05, 7.8089e+05],
        [3.9632e+05, 1.3598e+00, 3.9037e+05, 0.0000e+00, 1.4224e+00, 1.4372e+00,
         1.4781e+00, 1.4800e+00, 3.9054e+05, 1.3813e+00, 3.8431e+05, 1.5673e+00,
         3.9104e+05, 4.1453e+05, 1.4743e+00, 3.9794e+05],
        [3.9630e+05, 1.4842e+00, 3.9032e+05, 1.4224e+00, 0.0000e+00, 1.2991e+00,
         1.3318e+00, 1.5405e+00, 3.9049e+05, 1.3464e+00, 3.8431e+05, 1.4926e+00,
         3.9108e+05, 4.1454e+05, 1.3552e+00, 3.9797e+05],
        [3.9631e+05, 1.5737e+00, 3.9034e+05, 1.4372e+00, 1.2991e+00, 0.0000e+00,
         1.4219e+00, 1.4980e+00, 3.9052e+05, 1.4437e+00, 3.8429e+05, 1.5246e+00,
         3.9108e+05, 4.1455e+05, 1.3388e+00, 3.9795e+05],
        [3.9635e+05, 1.5627e+00, 3.9038e+05, 1.4781e+00, 1.3318e+00, 1.4219e+00,
         0.0000e+00, 1.4765e+00, 3.9047e+05, 1.4298e+00, 3.8433e+05, 1.6816e+00,
         3.9105e+05, 4.1457e+05, 1.5298e+00, 3.9794e+05],
        [3.9634e+05, 1.4995e+00, 3.9039e+05, 1.4800e+00, 1.5405e+00, 1.4980e+00,
         1.4765e+00, 0.0000e+00, 3.9046e+05, 1.6146e+00, 3.8431e+05, 1.6169e+00,
         3.9108e+05, 4.1456e+05, 1.5250e+00, 3.9796e+05],
        [7.7912e+05, 3.9050e+05, 7.7693e+05, 3.9054e+05, 3.9049e+05, 3.9052e+05,
         3.9047e+05, 3.9046e+05, 0.0000e+00, 3.9049e+05, 7.7866e+05, 3.9055e+05,
         7.8165e+05, 7.8208e+05, 3.9048e+05, 7.8088e+05],
        [3.9630e+05, 1.4971e+00, 3.9036e+05, 1.3813e+00, 1.3464e+00, 1.4437e+00,
         1.4298e+00, 1.6146e+00, 3.9049e+05, 0.0000e+00, 3.8429e+05, 1.6242e+00,
         3.9108e+05, 4.1456e+05, 1.4897e+00, 3.9794e+05],
        [7.8433e+05, 3.8430e+05, 7.6353e+05, 3.8431e+05, 3.8431e+05, 3.8429e+05,
         3.8433e+05, 3.8431e+05, 7.7866e+05, 3.8429e+05, 0.0000e+00, 3.8434e+05,
         7.7097e+05, 8.0205e+05, 3.8429e+05, 7.7477e+05],
        [3.9631e+05, 1.6048e+00, 3.9037e+05, 1.5673e+00, 1.4926e+00, 1.5246e+00,
         1.6816e+00, 1.6169e+00, 3.9055e+05, 1.6242e+00, 3.8434e+05, 0.0000e+00,
         3.9110e+05, 4.1453e+05, 1.5570e+00, 3.9800e+05],
        [7.6955e+05, 3.9108e+05, 7.8082e+05, 3.9104e+05, 3.9108e+05, 3.9108e+05,
         3.9105e+05, 3.9108e+05, 7.8165e+05, 3.9108e+05, 7.7097e+05, 3.9110e+05,
         0.0000e+00, 7.9838e+05, 3.9109e+05, 8.0342e+05],
        [7.9163e+05, 4.1454e+05, 8.1084e+05, 4.1453e+05, 4.1454e+05, 4.1455e+05,
         4.1457e+05, 4.1456e+05, 7.8208e+05, 4.1456e+05, 8.0205e+05, 4.1453e+05,
         7.9838e+05, 0.0000e+00, 4.1456e+05, 8.1480e+05],
        [3.9631e+05, 1.5605e+00, 3.9034e+05, 1.4743e+00, 1.3552e+00, 1.3388e+00,
         1.5298e+00, 1.5250e+00, 3.9048e+05, 1.4897e+00, 3.8429e+05, 1.5570e+00,
         3.9109e+05, 4.1456e+05, 0.0000e+00, 3.9795e+05],
        [8.0438e+05, 3.9795e+05, 7.8089e+05, 3.9794e+05, 3.9797e+05, 3.9795e+05,
         3.9794e+05, 3.9796e+05, 7.8088e+05, 3.9794e+05, 7.7477e+05, 3.9800e+05,
         8.0342e+05, 8.1480e+05, 3.9795e+05, 0.0000e+00]])
Krum scores: ['396306.53', '1.51', '390352.50', '1.43', '1.39', '1.42', '1.46', '1.52', '390488.53', '1.46', '384298.78', '1.57', '391069.91', '414543.66', '1.47', '397948.50']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 7, 15, 11, 2, 9, 6, 8, 14, 1, 18, 3, 13, 16, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0123s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:54...
global Accuracy on shared test data: 76.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[181  56]
 [ 61 202]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:54, End: 2025-07-22 16:02:54)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 1, 17, 6, 7, 15, 9, 19, 3, 18, 13, 2, 20, 14, 16, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.4344e+00, 3.7936e+05, 1.4496e+00, 1.4992e+00, 3.8827e+05,
         1.3271e+00, 3.8693e+05, 1.4612e+00, 3.7521e+05, 4.0046e+05, 1.4445e+00,
         3.9180e+05, 3.8764e+05, 3.9410e+05, 1.3743e+00],
        [1.4344e+00, 0.0000e+00, 3.7938e+05, 1.3774e+00, 1.4285e+00, 3.8822e+05,
         1.3934e+00, 3.8696e+05, 1.5268e+00, 3.7519e+05, 4.0045e+05, 1.5296e+00,
         3.9181e+05, 3.8763e+05, 3.9411e+05, 1.5792e+00],
        [3.7936e+05, 3.7938e+05, 0.0000e+00, 3.7940e+05, 3.7938e+05, 7.7030e+05,
         3.7938e+05, 7.6643e+05, 3.7939e+05, 7.5017e+05, 7.8404e+05, 3.7936e+05,
         7.7469e+05, 7.8369e+05, 7.6326e+05, 3.7938e+05],
        [1.4496e+00, 1.3774e+00, 3.7940e+05, 0.0000e+00, 1.4952e+00, 3.8824e+05,
         1.3622e+00, 3.8692e+05, 1.5797e+00, 3.7517e+05, 4.0049e+05, 1.5092e+00,
         3.9182e+05, 3.8760e+05, 3.9410e+05, 1.5572e+00],
        [1.4992e+00, 1.4285e+00, 3.7938e+05, 1.4952e+00, 0.0000e+00, 3.8825e+05,
         1.5239e+00, 3.8697e+05, 1.5381e+00, 3.7517e+05, 4.0043e+05, 1.6993e+00,
         3.9180e+05, 3.8763e+05, 3.9409e+05, 1.7480e+00],
        [3.8827e+05, 3.8822e+05, 7.7030e+05, 3.8824e+05, 3.8825e+05, 0.0000e+00,
         3.8823e+05, 7.5898e+05, 3.8822e+05, 7.7775e+05, 7.6875e+05, 3.8823e+05,
         7.9641e+05, 7.7350e+05, 7.7820e+05, 3.8824e+05],
        [1.3271e+00, 1.3934e+00, 3.7938e+05, 1.3622e+00, 1.5239e+00, 3.8823e+05,
         0.0000e+00, 3.8692e+05, 1.4741e+00, 3.7518e+05, 4.0048e+05, 1.3651e+00,
         3.9179e+05, 3.8764e+05, 3.9412e+05, 1.3588e+00],
        [3.8693e+05, 3.8696e+05, 7.6643e+05, 3.8692e+05, 3.8697e+05, 7.5898e+05,
         3.8692e+05, 0.0000e+00, 3.8692e+05, 7.6718e+05, 8.0417e+05, 3.8694e+05,
         7.9910e+05, 7.7455e+05, 7.6517e+05, 3.8693e+05],
        [1.4612e+00, 1.5268e+00, 3.7939e+05, 1.5797e+00, 1.5381e+00, 3.8822e+05,
         1.4741e+00, 3.8692e+05, 0.0000e+00, 3.7518e+05, 4.0046e+05, 1.6290e+00,
         3.9183e+05, 3.8761e+05, 3.9409e+05, 1.6914e+00],
        [3.7521e+05, 3.7519e+05, 7.5017e+05, 3.7517e+05, 3.7517e+05, 7.7775e+05,
         3.7518e+05, 7.6718e+05, 3.7518e+05, 0.0000e+00, 7.6845e+05, 3.7518e+05,
         7.5798e+05, 7.6251e+05, 7.7174e+05, 3.7519e+05],
        [4.0046e+05, 4.0045e+05, 7.8404e+05, 4.0049e+05, 4.0043e+05, 7.6875e+05,
         4.0048e+05, 8.0417e+05, 4.0046e+05, 7.6845e+05, 0.0000e+00, 4.0048e+05,
         7.8065e+05, 7.7399e+05, 8.0547e+05, 4.0047e+05],
        [1.4445e+00, 1.5296e+00, 3.7936e+05, 1.5092e+00, 1.6993e+00, 3.8823e+05,
         1.3651e+00, 3.8694e+05, 1.6290e+00, 3.7518e+05, 4.0048e+05, 0.0000e+00,
         3.9182e+05, 3.8764e+05, 3.9412e+05, 1.3752e+00],
        [3.9180e+05, 3.9181e+05, 7.7469e+05, 3.9182e+05, 3.9180e+05, 7.9641e+05,
         3.9179e+05, 7.9910e+05, 3.9183e+05, 7.5798e+05, 7.8065e+05, 3.9182e+05,
         0.0000e+00, 7.6356e+05, 7.9483e+05, 3.9181e+05],
        [3.8764e+05, 3.8763e+05, 7.8369e+05, 3.8760e+05, 3.8763e+05, 7.7350e+05,
         3.8764e+05, 7.7455e+05, 3.8761e+05, 7.6251e+05, 7.7399e+05, 3.8764e+05,
         7.6356e+05, 0.0000e+00, 7.6929e+05, 3.8764e+05],
        [3.9410e+05, 3.9411e+05, 7.6326e+05, 3.9410e+05, 3.9409e+05, 7.7820e+05,
         3.9412e+05, 7.6517e+05, 3.9409e+05, 7.7174e+05, 8.0547e+05, 3.9412e+05,
         7.9483e+05, 7.6929e+05, 0.0000e+00, 3.9409e+05],
        [1.3743e+00, 1.5792e+00, 3.7938e+05, 1.5572e+00, 1.7480e+00, 3.8824e+05,
         1.3588e+00, 3.8693e+05, 1.6914e+00, 3.7519e+05, 4.0047e+05, 1.3752e+00,
         3.9181e+05, 3.8764e+05, 3.9409e+05, 0.0000e+00]])
Krum scores: ['1.42', '1.45', '379374.72', '1.46', '1.53', '388229.84', '1.38', '386926.84', '1.53', '375177.22', '400458.59', '1.48', '391803.78', '387623.00', '394097.28', '1.49']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 1, 17, 6, 7, 15, 9, 19, 3, 18, 13, 2, 20, 14, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:54...
global Accuracy on shared test data: 76.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:54, End: 2025-07-22 16:02:54)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 20, 16, 2, 9, 17, 4, 5, 15, 19, 10, 13, 3, 11, 12, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0671e+05, 4.0015e+05, 1.4009e+00, 1.7456e+00, 3.7870e+05,
         1.4063e+00, 1.3625e+00, 3.9995e+05, 3.9400e+05, 1.3953e+00, 3.9083e+05,
         1.4099e+00, 1.2879e+00, 1.5103e+00, 3.8950e+05],
        [4.0671e+05, 0.0000e+00, 7.9884e+05, 4.0669e+05, 4.0672e+05, 7.9059e+05,
         4.0673e+05, 4.0674e+05, 8.1766e+05, 8.2553e+05, 4.0670e+05, 8.2214e+05,
         4.0671e+05, 4.0672e+05, 4.0670e+05, 8.0945e+05],
        [4.0015e+05, 7.9884e+05, 0.0000e+00, 4.0014e+05, 4.0019e+05, 7.6061e+05,
         4.0018e+05, 4.0012e+05, 7.7738e+05, 8.0292e+05, 4.0014e+05, 7.9294e+05,
         4.0013e+05, 4.0014e+05, 4.0015e+05, 7.9792e+05],
        [1.4009e+00, 4.0669e+05, 4.0014e+05, 0.0000e+00, 1.2903e+00, 3.7871e+05,
         1.5320e+00, 1.4824e+00, 4.0000e+05, 3.9400e+05, 1.3039e+00, 3.9084e+05,
         1.4730e+00, 1.5112e+00, 1.1963e+00, 3.8951e+05],
        [1.7456e+00, 4.0672e+05, 4.0019e+05, 1.2903e+00, 0.0000e+00, 3.7872e+05,
         1.8815e+00, 1.7877e+00, 3.9996e+05, 3.9399e+05, 1.4827e+00, 3.9086e+05,
         1.8430e+00, 1.7794e+00, 1.3042e+00, 3.8945e+05],
        [3.7870e+05, 7.9059e+05, 7.6061e+05, 3.7871e+05, 3.7872e+05, 0.0000e+00,
         3.7869e+05, 3.7871e+05, 7.9354e+05, 7.5134e+05, 3.7870e+05, 7.8751e+05,
         3.7872e+05, 3.7869e+05, 3.7870e+05, 7.6534e+05],
        [1.4063e+00, 4.0673e+05, 4.0018e+05, 1.5320e+00, 1.8815e+00, 3.7869e+05,
         0.0000e+00, 1.3276e+00, 3.9998e+05, 3.9401e+05, 1.4712e+00, 3.9086e+05,
         1.3839e+00, 1.2944e+00, 1.5443e+00, 3.8948e+05],
        [1.3625e+00, 4.0674e+05, 4.0012e+05, 1.4824e+00, 1.7877e+00, 3.7871e+05,
         1.3276e+00, 0.0000e+00, 3.9996e+05, 3.9400e+05, 1.4237e+00, 3.9087e+05,
         1.2972e+00, 1.2675e+00, 1.5096e+00, 3.8949e+05],
        [3.9995e+05, 8.1766e+05, 7.7738e+05, 4.0000e+05, 3.9996e+05, 7.9354e+05,
         3.9998e+05, 3.9996e+05, 0.0000e+00, 7.9625e+05, 4.0001e+05, 7.8589e+05,
         3.9998e+05, 3.9997e+05, 3.9997e+05, 7.8440e+05],
        [3.9400e+05, 8.2553e+05, 8.0292e+05, 3.9400e+05, 3.9399e+05, 7.5134e+05,
         3.9401e+05, 3.9400e+05, 7.9625e+05, 0.0000e+00, 3.9401e+05, 8.0146e+05,
         3.9401e+05, 3.9401e+05, 3.9402e+05, 7.6445e+05],
        [1.3953e+00, 4.0670e+05, 4.0014e+05, 1.3039e+00, 1.4827e+00, 3.7870e+05,
         1.4712e+00, 1.4237e+00, 4.0001e+05, 3.9401e+05, 0.0000e+00, 3.9079e+05,
         1.3729e+00, 1.3879e+00, 1.2784e+00, 3.8946e+05],
        [3.9083e+05, 8.2214e+05, 7.9294e+05, 3.9084e+05, 3.9086e+05, 7.8751e+05,
         3.9086e+05, 3.9087e+05, 7.8589e+05, 8.0146e+05, 3.9079e+05, 0.0000e+00,
         3.9083e+05, 3.9084e+05, 3.9082e+05, 7.7146e+05],
        [1.4099e+00, 4.0671e+05, 4.0013e+05, 1.4730e+00, 1.8430e+00, 3.7872e+05,
         1.3839e+00, 1.2972e+00, 3.9998e+05, 3.9401e+05, 1.3729e+00, 3.9083e+05,
         0.0000e+00, 1.3853e+00, 1.5396e+00, 3.8947e+05],
        [1.2879e+00, 4.0672e+05, 4.0014e+05, 1.5112e+00, 1.7794e+00, 3.7869e+05,
         1.2944e+00, 1.2675e+00, 3.9997e+05, 3.9401e+05, 1.3879e+00, 3.9084e+05,
         1.3853e+00, 0.0000e+00, 1.5591e+00, 3.8946e+05],
        [1.5103e+00, 4.0670e+05, 4.0015e+05, 1.1963e+00, 1.3042e+00, 3.7870e+05,
         1.5443e+00, 1.5096e+00, 3.9997e+05, 3.9402e+05, 1.2784e+00, 3.9082e+05,
         1.5396e+00, 1.5591e+00, 0.0000e+00, 3.8947e+05],
        [3.8950e+05, 8.0945e+05, 7.9792e+05, 3.8951e+05, 3.8945e+05, 7.6534e+05,
         3.8948e+05, 3.8949e+05, 7.8440e+05, 7.6445e+05, 3.8946e+05, 7.7146e+05,
         3.8947e+05, 3.8946e+05, 3.8947e+05, 0.0000e+00]])
Krum scores: ['1.40', '406708.75', '400138.59', '1.38', '1.60', '378699.66', '1.42', '1.38', '399966.53', '394001.72', '1.38', '390830.84', '1.41', '1.38', '1.41', '389469.19']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 20, 16, 2, 9, 17, 4, 5, 15, 19, 10, 13, 3, 11, 12, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0080s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:55...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:55, End: 2025-07-22 16:02:55)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 5, 12, 17, 6, 9, 10, 11, 1, 16, 20, 4, 13, 15, 19, 14], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2429e+00, 1.4793e+00, 3.8838e+05, 1.4380e+00, 1.5449e+00,
         1.6166e+00, 1.3170e+00, 1.3051e+00, 3.9149e+05, 3.9153e+05, 1.3483e+00,
         3.9270e+05, 3.9188e+05, 3.7906e+05, 3.8507e+05],
        [1.2429e+00, 0.0000e+00, 1.4493e+00, 3.8839e+05, 1.3275e+00, 1.5568e+00,
         1.6233e+00, 1.1818e+00, 1.2772e+00, 3.9152e+05, 3.9154e+05, 1.2699e+00,
         3.9271e+05, 3.9190e+05, 3.7906e+05, 3.8509e+05],
        [1.4793e+00, 1.4493e+00, 0.0000e+00, 3.8836e+05, 1.4086e+00, 1.1945e+00,
         1.2363e+00, 1.4855e+00, 1.4495e+00, 3.9154e+05, 3.9153e+05, 1.5258e+00,
         3.9273e+05, 3.9191e+05, 3.7907e+05, 3.8505e+05],
        [3.8838e+05, 3.8839e+05, 3.8836e+05, 0.0000e+00, 3.8836e+05, 3.8840e+05,
         3.8839e+05, 3.8836e+05, 3.8836e+05, 7.8452e+05, 7.6344e+05, 3.8837e+05,
         7.5452e+05, 7.7891e+05, 7.5045e+05, 7.7077e+05],
        [1.4380e+00, 1.3275e+00, 1.4086e+00, 3.8836e+05, 0.0000e+00, 1.4662e+00,
         1.6064e+00, 1.3040e+00, 1.2343e+00, 3.9151e+05, 3.9154e+05, 1.2659e+00,
         3.9272e+05, 3.9189e+05, 3.7906e+05, 3.8509e+05],
        [1.5449e+00, 1.5568e+00, 1.1945e+00, 3.8840e+05, 1.4662e+00, 0.0000e+00,
         1.1986e+00, 1.5229e+00, 1.4783e+00, 3.9151e+05, 3.9152e+05, 1.6366e+00,
         3.9270e+05, 3.9189e+05, 3.7908e+05, 3.8509e+05],
        [1.6166e+00, 1.6233e+00, 1.2363e+00, 3.8839e+05, 1.6064e+00, 1.1986e+00,
         0.0000e+00, 1.6412e+00, 1.6491e+00, 3.9155e+05, 3.9155e+05, 1.7941e+00,
         3.9274e+05, 3.9187e+05, 3.7907e+05, 3.8507e+05],
        [1.3170e+00, 1.1818e+00, 1.4855e+00, 3.8836e+05, 1.3040e+00, 1.5229e+00,
         1.6412e+00, 0.0000e+00, 1.2413e+00, 3.9152e+05, 3.9155e+05, 1.2491e+00,
         3.9272e+05, 3.9189e+05, 3.7903e+05, 3.8510e+05],
        [1.3051e+00, 1.2772e+00, 1.4495e+00, 3.8836e+05, 1.2343e+00, 1.4783e+00,
         1.6491e+00, 1.2413e+00, 0.0000e+00, 3.9152e+05, 3.9153e+05, 1.3427e+00,
         3.9270e+05, 3.9187e+05, 3.7905e+05, 3.8511e+05],
        [3.9149e+05, 3.9152e+05, 3.9154e+05, 7.8452e+05, 3.9151e+05, 3.9151e+05,
         3.9155e+05, 3.9152e+05, 3.9152e+05, 0.0000e+00, 7.9942e+05, 3.9152e+05,
         7.9880e+05, 7.7172e+05, 7.6276e+05, 7.7745e+05],
        [3.9153e+05, 3.9154e+05, 3.9153e+05, 7.6344e+05, 3.9154e+05, 3.9152e+05,
         3.9155e+05, 3.9155e+05, 3.9153e+05, 7.9942e+05, 0.0000e+00, 3.9153e+05,
         7.9076e+05, 7.9442e+05, 7.6076e+05, 7.7434e+05],
        [1.3483e+00, 1.2699e+00, 1.5258e+00, 3.8837e+05, 1.2659e+00, 1.6366e+00,
         1.7941e+00, 1.2491e+00, 1.3427e+00, 3.9152e+05, 3.9153e+05, 0.0000e+00,
         3.9272e+05, 3.9188e+05, 3.7902e+05, 3.8508e+05],
        [3.9270e+05, 3.9271e+05, 3.9273e+05, 7.5452e+05, 3.9272e+05, 3.9270e+05,
         3.9274e+05, 3.9272e+05, 3.9270e+05, 7.9880e+05, 7.9076e+05, 3.9272e+05,
         0.0000e+00, 7.9538e+05, 7.9113e+05, 8.1597e+05],
        [3.9188e+05, 3.9190e+05, 3.9191e+05, 7.7891e+05, 3.9189e+05, 3.9189e+05,
         3.9187e+05, 3.9189e+05, 3.9187e+05, 7.7172e+05, 7.9442e+05, 3.9188e+05,
         7.9538e+05, 0.0000e+00, 7.7599e+05, 7.7967e+05],
        [3.7906e+05, 3.7906e+05, 3.7907e+05, 7.5045e+05, 3.7906e+05, 3.7908e+05,
         3.7907e+05, 3.7903e+05, 3.7905e+05, 7.6276e+05, 7.6076e+05, 3.7902e+05,
         7.9113e+05, 7.7599e+05, 0.0000e+00, 7.4163e+05],
        [3.8507e+05, 3.8509e+05, 3.8505e+05, 7.7077e+05, 3.8509e+05, 3.8509e+05,
         3.8507e+05, 3.8510e+05, 3.8511e+05, 7.7745e+05, 7.7434e+05, 3.8508e+05,
         8.1597e+05, 7.7967e+05, 7.4163e+05, 0.0000e+00]])
Krum scores: ['1.38', '1.33', '1.39', '388369.50', '1.35', '1.42', '1.51', '1.33', '1.33', '391512.78', '391531.47', '1.38', '392711.94', '391881.44', '379049.06', '385075.44']
Selected index: 7
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Chosen Update']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 5, 12, 17, 6, 9, 10, 11, 1, 16, 20, 4, 13, 15, 19, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0238s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:55...
global Accuracy on shared test data: 76.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 47 216]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:55, End: 2025-07-22 16:02:55)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 2, 6, 5, 17, 3, 7, 19, 8, 20, 16, 18, 4, 15, 11, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.2530e+00, 1.5350e+00, 1.6135e+00, 4.0400e+05, 1.5880e+00,
         1.7273e+00, 3.9803e+05, 1.6183e+00, 3.8037e+05, 3.8927e+05, 4.0343e+05,
         1.6774e+00, 3.8370e+05, 1.4109e+00, 1.2969e+00],
        [1.2530e+00, 0.0000e+00, 1.3143e+00, 1.4914e+00, 4.0401e+05, 1.4434e+00,
         1.5348e+00, 3.9802e+05, 1.4987e+00, 3.8039e+05, 3.8924e+05, 4.0343e+05,
         1.4887e+00, 3.8372e+05, 1.3188e+00, 1.2200e+00],
        [1.5350e+00, 1.3143e+00, 0.0000e+00, 1.4579e+00, 4.0400e+05, 1.5370e+00,
         1.4769e+00, 3.9804e+05, 1.4184e+00, 3.8037e+05, 3.8928e+05, 4.0339e+05,
         1.3895e+00, 3.8371e+05, 1.5369e+00, 1.5111e+00],
        [1.6135e+00, 1.4914e+00, 1.4579e+00, 0.0000e+00, 4.0398e+05, 1.3967e+00,
         1.3812e+00, 3.9804e+05, 1.5798e+00, 3.8038e+05, 3.8930e+05, 4.0342e+05,
         1.4663e+00, 3.8372e+05, 1.4607e+00, 1.6727e+00],
        [4.0400e+05, 4.0401e+05, 4.0400e+05, 4.0398e+05, 0.0000e+00, 4.0399e+05,
         4.0401e+05, 7.9208e+05, 4.0402e+05, 7.7223e+05, 7.9446e+05, 7.7816e+05,
         4.0400e+05, 7.8164e+05, 4.0401e+05, 4.0399e+05],
        [1.5880e+00, 1.4434e+00, 1.5370e+00, 1.3967e+00, 4.0399e+05, 0.0000e+00,
         1.5171e+00, 3.9803e+05, 1.4731e+00, 3.8037e+05, 3.8927e+05, 4.0339e+05,
         1.4452e+00, 3.8372e+05, 1.6238e+00, 1.6482e+00],
        [1.7273e+00, 1.5348e+00, 1.4769e+00, 1.3812e+00, 4.0401e+05, 1.5171e+00,
         0.0000e+00, 3.9805e+05, 1.4525e+00, 3.8041e+05, 3.8925e+05, 4.0342e+05,
         1.3805e+00, 3.8371e+05, 1.5483e+00, 1.7825e+00],
        [3.9803e+05, 3.9802e+05, 3.9804e+05, 3.9804e+05, 7.9208e+05, 3.9803e+05,
         3.9805e+05, 0.0000e+00, 3.9805e+05, 7.7626e+05, 8.0455e+05, 7.9287e+05,
         3.9807e+05, 7.7620e+05, 3.9803e+05, 3.9800e+05],
        [1.6183e+00, 1.4987e+00, 1.4184e+00, 1.5798e+00, 4.0402e+05, 1.4731e+00,
         1.4525e+00, 3.9805e+05, 0.0000e+00, 3.8038e+05, 3.8927e+05, 4.0336e+05,
         1.4479e+00, 3.8372e+05, 1.6310e+00, 1.6998e+00],
        [3.8037e+05, 3.8039e+05, 3.8037e+05, 3.8038e+05, 7.7223e+05, 3.8037e+05,
         3.8041e+05, 7.7626e+05, 3.8038e+05, 0.0000e+00, 7.8383e+05, 7.7117e+05,
         3.8038e+05, 7.4282e+05, 3.8038e+05, 3.8039e+05],
        [3.8927e+05, 3.8924e+05, 3.8928e+05, 3.8930e+05, 7.9446e+05, 3.8927e+05,
         3.8925e+05, 8.0455e+05, 3.8927e+05, 7.8383e+05, 0.0000e+00, 7.8055e+05,
         3.8933e+05, 7.6849e+05, 3.8924e+05, 3.8927e+05],
        [4.0343e+05, 4.0343e+05, 4.0339e+05, 4.0342e+05, 7.7816e+05, 4.0339e+05,
         4.0342e+05, 7.9287e+05, 4.0336e+05, 7.7117e+05, 7.8055e+05, 0.0000e+00,
         4.0340e+05, 7.7199e+05, 4.0341e+05, 4.0342e+05],
        [1.6774e+00, 1.4887e+00, 1.3895e+00, 1.4663e+00, 4.0400e+05, 1.4452e+00,
         1.3805e+00, 3.9807e+05, 1.4479e+00, 3.8038e+05, 3.8933e+05, 4.0340e+05,
         0.0000e+00, 3.8372e+05, 1.6523e+00, 1.7171e+00],
        [3.8370e+05, 3.8372e+05, 3.8371e+05, 3.8372e+05, 7.8164e+05, 3.8372e+05,
         3.8371e+05, 7.7620e+05, 3.8372e+05, 7.4282e+05, 7.6849e+05, 7.7199e+05,
         3.8372e+05, 0.0000e+00, 3.8372e+05, 3.8373e+05],
        [1.4109e+00, 1.3188e+00, 1.5369e+00, 1.4607e+00, 4.0401e+05, 1.6238e+00,
         1.5483e+00, 3.9803e+05, 1.6310e+00, 3.8038e+05, 3.8924e+05, 4.0341e+05,
         1.6523e+00, 3.8372e+05, 0.0000e+00, 1.3772e+00],
        [1.2969e+00, 1.2200e+00, 1.5111e+00, 1.6727e+00, 4.0399e+05, 1.6482e+00,
         1.7825e+00, 3.9800e+05, 1.6998e+00, 3.8039e+05, 3.8927e+05, 4.0342e+05,
         1.7171e+00, 3.8373e+05, 1.3772e+00, 0.0000e+00]])
Krum scores: ['1.50', '1.38', '1.45', '1.48', '403999.00', '1.50', '1.50', '398030.22', '1.51', '380376.88', '389260.38', '403402.06', '1.49', '383714.78', '1.49', '1.52']
Selected index: 1
krum, clients_type: [['Update 0']
 ['Chosen Update']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 2, 6, 5, 17, 3, 7, 19, 8, 20, 16, 18, 4, 15, 11, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:56...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:56, End: 2025-07-22 16:02:56)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 1, 4, 6, 2, 9, 10, 8, 14, 16, 13, 11, 3, 5, 18, 19], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.3310e+00, 1.4328e+00, 1.2948e+00, 1.1936e+00, 1.0851e+00,
         1.0781e+00, 1.3931e+00, 3.7411e+05, 4.0329e+05, 3.9817e+05, 1.1506e+00,
         1.3936e+00, 1.4081e+00, 3.9155e+05, 4.0046e+05],
        [1.3310e+00, 0.0000e+00, 1.2549e+00, 1.0958e+00, 1.5958e+00, 1.2977e+00,
         1.3424e+00, 1.2770e+00, 3.7409e+05, 4.0329e+05, 3.9819e+05, 1.1443e+00,
         1.2466e+00, 1.1640e+00, 3.9151e+05, 4.0044e+05],
        [1.4328e+00, 1.2549e+00, 0.0000e+00, 1.2226e+00, 1.7918e+00, 1.4527e+00,
         1.4922e+00, 1.2710e+00, 3.7410e+05, 4.0328e+05, 3.9819e+05, 1.2839e+00,
         1.2397e+00, 1.2324e+00, 3.9154e+05, 4.0043e+05],
        [1.2948e+00, 1.0958e+00, 1.2226e+00, 0.0000e+00, 1.5665e+00, 1.2476e+00,
         1.3227e+00, 1.2252e+00, 3.7409e+05, 4.0326e+05, 3.9819e+05, 1.1802e+00,
         1.2806e+00, 1.2040e+00, 3.9154e+05, 4.0047e+05],
        [1.1936e+00, 1.5958e+00, 1.7918e+00, 1.5665e+00, 0.0000e+00, 1.1210e+00,
         1.1343e+00, 1.7314e+00, 3.7409e+05, 4.0330e+05, 3.9822e+05, 1.2727e+00,
         1.6776e+00, 1.7637e+00, 3.9146e+05, 4.0044e+05],
        [1.0851e+00, 1.2977e+00, 1.4527e+00, 1.2476e+00, 1.1210e+00, 0.0000e+00,
         1.0444e+00, 1.4211e+00, 3.7412e+05, 4.0329e+05, 3.9821e+05, 1.1117e+00,
         1.4038e+00, 1.4053e+00, 3.9152e+05, 4.0045e+05],
        [1.0781e+00, 1.3424e+00, 1.4922e+00, 1.3227e+00, 1.1343e+00, 1.0444e+00,
         0.0000e+00, 1.4258e+00, 3.7410e+05, 4.0331e+05, 3.9821e+05, 1.0796e+00,
         1.3493e+00, 1.4175e+00, 3.9151e+05, 4.0047e+05],
        [1.3931e+00, 1.2770e+00, 1.2710e+00, 1.2252e+00, 1.7314e+00, 1.4211e+00,
         1.4258e+00, 0.0000e+00, 3.7412e+05, 4.0328e+05, 3.9821e+05, 1.2953e+00,
         1.2816e+00, 1.3461e+00, 3.9157e+05, 4.0045e+05],
        [3.7411e+05, 3.7409e+05, 3.7410e+05, 3.7409e+05, 3.7409e+05, 3.7412e+05,
         3.7410e+05, 3.7412e+05, 0.0000e+00, 7.6915e+05, 7.8822e+05, 3.7410e+05,
         3.7412e+05, 3.7413e+05, 7.7601e+05, 7.8200e+05],
        [4.0329e+05, 4.0329e+05, 4.0328e+05, 4.0326e+05, 4.0330e+05, 4.0329e+05,
         4.0331e+05, 4.0328e+05, 7.6915e+05, 0.0000e+00, 8.1461e+05, 4.0327e+05,
         4.0328e+05, 4.0328e+05, 7.6757e+05, 8.0850e+05],
        [3.9817e+05, 3.9819e+05, 3.9819e+05, 3.9819e+05, 3.9822e+05, 3.9821e+05,
         3.9821e+05, 3.9821e+05, 7.8822e+05, 8.1461e+05, 0.0000e+00, 3.9819e+05,
         3.9819e+05, 3.9819e+05, 7.6605e+05, 7.7317e+05],
        [1.1506e+00, 1.1443e+00, 1.2839e+00, 1.1802e+00, 1.2727e+00, 1.1117e+00,
         1.0796e+00, 1.2953e+00, 3.7410e+05, 4.0327e+05, 3.9819e+05, 0.0000e+00,
         1.2720e+00, 1.1372e+00, 3.9154e+05, 4.0047e+05],
        [1.3936e+00, 1.2466e+00, 1.2397e+00, 1.2806e+00, 1.6776e+00, 1.4038e+00,
         1.3493e+00, 1.2816e+00, 3.7412e+05, 4.0328e+05, 3.9819e+05, 1.2720e+00,
         0.0000e+00, 1.1742e+00, 3.9155e+05, 4.0046e+05],
        [1.4081e+00, 1.1640e+00, 1.2324e+00, 1.2040e+00, 1.7637e+00, 1.4053e+00,
         1.4175e+00, 1.3461e+00, 3.7413e+05, 4.0328e+05, 3.9819e+05, 1.1372e+00,
         1.1742e+00, 0.0000e+00, 3.9156e+05, 4.0045e+05],
        [3.9155e+05, 3.9151e+05, 3.9154e+05, 3.9154e+05, 3.9146e+05, 3.9152e+05,
         3.9151e+05, 3.9157e+05, 7.7601e+05, 7.6757e+05, 7.6605e+05, 3.9154e+05,
         3.9155e+05, 3.9156e+05, 0.0000e+00, 7.7107e+05],
        [4.0046e+05, 4.0044e+05, 4.0043e+05, 4.0047e+05, 4.0044e+05, 4.0045e+05,
         4.0047e+05, 4.0045e+05, 7.8200e+05, 8.0850e+05, 7.7317e+05, 4.0047e+05,
         4.0046e+05, 4.0045e+05, 7.7107e+05, 0.0000e+00]])
Krum scores: ['1.26', '1.24', '1.32', '1.23', '1.45', '1.24', '1.24', '1.33', '374101.00', '403279.53', '398192.66', '1.18', '1.29', '1.28', '391522.56', '400449.44']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 1, 4, 6, 2, 9, 10, 8, 14, 16, 13, 11, 3, 5, 18, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0050s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:57...
global Accuracy on shared test data: 76.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[174  63]
 [ 53 210]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:57, End: 2025-07-22 16:02:57)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 8, 17, 1, 15, 16, 13, 7, 3, 11, 18, 20, 2, 4, 10, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7523e+05, 7.6243e+05, 3.7525e+05, 7.8183e+05, 7.7595e+05,
         7.4472e+05, 3.7523e+05, 3.7524e+05, 3.7523e+05, 7.5596e+05, 7.6072e+05,
         3.7525e+05, 3.7525e+05, 3.7526e+05, 3.7527e+05],
        [3.7523e+05, 0.0000e+00, 3.8786e+05, 1.2541e+00, 4.0595e+05, 3.8951e+05,
         3.7173e+05, 1.2204e+00, 1.2234e+00, 1.6968e+00, 3.9813e+05, 3.9573e+05,
         1.5419e+00, 1.1858e+00, 1.4271e+00, 1.1931e+00],
        [7.6243e+05, 3.8786e+05, 0.0000e+00, 3.8788e+05, 7.7548e+05, 7.7611e+05,
         7.5416e+05, 3.8784e+05, 3.8790e+05, 3.8790e+05, 7.7946e+05, 7.9101e+05,
         3.8789e+05, 3.8784e+05, 3.8791e+05, 3.8787e+05],
        [3.7525e+05, 1.2541e+00, 3.8788e+05, 0.0000e+00, 4.0593e+05, 3.8952e+05,
         3.7172e+05, 1.1925e+00, 1.1991e+00, 1.5436e+00, 3.9814e+05, 3.9575e+05,
         1.4304e+00, 1.2476e+00, 1.3339e+00, 1.1368e+00],
        [7.8183e+05, 4.0595e+05, 7.7548e+05, 4.0593e+05, 0.0000e+00, 8.0305e+05,
         7.8831e+05, 4.0597e+05, 4.0594e+05, 4.0601e+05, 8.0114e+05, 8.1038e+05,
         4.0598e+05, 4.0594e+05, 4.0598e+05, 4.0594e+05],
        [7.7595e+05, 3.8951e+05, 7.7611e+05, 3.8952e+05, 8.0305e+05, 0.0000e+00,
         7.6261e+05, 3.8949e+05, 3.8948e+05, 3.8950e+05, 7.9903e+05, 7.8925e+05,
         3.8948e+05, 3.8951e+05, 3.8950e+05, 3.8953e+05],
        [7.4472e+05, 3.7173e+05, 7.5416e+05, 3.7172e+05, 7.8831e+05, 7.6261e+05,
         0.0000e+00, 3.7173e+05, 3.7173e+05, 3.7175e+05, 7.6305e+05, 7.9263e+05,
         3.7174e+05, 3.7172e+05, 3.7172e+05, 3.7171e+05],
        [3.7523e+05, 1.2204e+00, 3.8784e+05, 1.1925e+00, 4.0597e+05, 3.8949e+05,
         3.7173e+05, 0.0000e+00, 1.2659e+00, 1.6411e+00, 3.9810e+05, 3.9576e+05,
         1.5899e+00, 1.1582e+00, 1.4032e+00, 1.2204e+00],
        [3.7524e+05, 1.2234e+00, 3.8790e+05, 1.1991e+00, 4.0594e+05, 3.8948e+05,
         3.7173e+05, 1.2659e+00, 0.0000e+00, 1.6127e+00, 3.9812e+05, 3.9575e+05,
         1.4770e+00, 1.1787e+00, 1.3299e+00, 1.2390e+00],
        [3.7523e+05, 1.6968e+00, 3.8790e+05, 1.5436e+00, 4.0601e+05, 3.8950e+05,
         3.7175e+05, 1.6411e+00, 1.6127e+00, 0.0000e+00, 3.9812e+05, 3.9575e+05,
         1.0193e+00, 1.6656e+00, 1.1756e+00, 1.4974e+00],
        [7.5596e+05, 3.9813e+05, 7.7946e+05, 3.9814e+05, 8.0114e+05, 7.9903e+05,
         7.6305e+05, 3.9810e+05, 3.9812e+05, 3.9812e+05, 0.0000e+00, 7.9471e+05,
         3.9814e+05, 3.9812e+05, 3.9811e+05, 3.9812e+05],
        [7.6072e+05, 3.9573e+05, 7.9101e+05, 3.9575e+05, 8.1038e+05, 7.8925e+05,
         7.9263e+05, 3.9576e+05, 3.9575e+05, 3.9575e+05, 7.9471e+05, 0.0000e+00,
         3.9575e+05, 3.9575e+05, 3.9574e+05, 3.9575e+05],
        [3.7525e+05, 1.5419e+00, 3.8789e+05, 1.4304e+00, 4.0598e+05, 3.8948e+05,
         3.7174e+05, 1.5899e+00, 1.4770e+00, 1.0193e+00, 3.9814e+05, 3.9575e+05,
         0.0000e+00, 1.5615e+00, 1.0165e+00, 1.3434e+00],
        [3.7525e+05, 1.1858e+00, 3.8784e+05, 1.2476e+00, 4.0594e+05, 3.8951e+05,
         3.7172e+05, 1.1582e+00, 1.1787e+00, 1.6656e+00, 3.9812e+05, 3.9575e+05,
         1.5615e+00, 0.0000e+00, 1.4422e+00, 1.1587e+00],
        [3.7526e+05, 1.4271e+00, 3.8791e+05, 1.3339e+00, 4.0598e+05, 3.8950e+05,
         3.7172e+05, 1.4032e+00, 1.3299e+00, 1.1756e+00, 3.9811e+05, 3.9574e+05,
         1.0165e+00, 1.4422e+00, 0.0000e+00, 1.2905e+00],
        [3.7527e+05, 1.1931e+00, 3.8787e+05, 1.1368e+00, 4.0594e+05, 3.8953e+05,
         3.7171e+05, 1.2204e+00, 1.2390e+00, 1.4974e+00, 3.9812e+05, 3.9575e+05,
         1.3434e+00, 1.1587e+00, 1.2905e+00, 0.0000e+00]])
Krum scores: ['375240.44', '1.29', '387867.94', '1.26', '405950.56', '389495.69', '371721.50', '1.29', '1.27', '1.45', '398117.53', '395745.94', '1.34', '1.28', '1.28', '1.23']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [14, 8, 17, 1, 15, 16, 13, 7, 3, 11, 18, 20, 2, 4, 10, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:57...
global Accuracy on shared test data: 75.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [ 63 200]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:57, End: 2025-07-22 16:02:57)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 11, 18, 12, 4, 20, 2, 15, 7, 17, 19, 13, 5, 14, 16, 9], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1010e+00, 4.0304e+05, 1.0777e+00, 1.4481e+00, 3.8500e+05,
         1.0413e+00, 3.8545e+05, 1.4255e+00, 3.9937e+05, 3.9303e+05, 3.9216e+05,
         1.3994e+00, 3.9710e+05, 3.8282e+05, 1.0509e+00],
        [1.1010e+00, 0.0000e+00, 4.0306e+05, 1.1345e+00, 1.5982e+00, 3.8499e+05,
         9.9423e-01, 3.8547e+05, 1.5597e+00, 3.9934e+05, 3.9303e+05, 3.9215e+05,
         1.4071e+00, 3.9710e+05, 3.8284e+05, 1.0626e+00],
        [4.0304e+05, 4.0306e+05, 0.0000e+00, 4.0304e+05, 4.0301e+05, 7.7867e+05,
         4.0304e+05, 7.8670e+05, 4.0299e+05, 7.9617e+05, 8.0933e+05, 7.9713e+05,
         4.0304e+05, 8.0704e+05, 7.7740e+05, 4.0305e+05],
        [1.0777e+00, 1.1345e+00, 4.0304e+05, 0.0000e+00, 1.3950e+00, 3.8501e+05,
         1.0873e+00, 3.8549e+05, 1.5187e+00, 3.9936e+05, 3.9303e+05, 3.9216e+05,
         1.3992e+00, 3.9708e+05, 3.8282e+05, 1.1078e+00],
        [1.4481e+00, 1.5982e+00, 4.0301e+05, 1.3950e+00, 0.0000e+00, 3.8501e+05,
         1.5677e+00, 3.8548e+05, 1.2297e+00, 3.9937e+05, 3.9302e+05, 3.9214e+05,
         1.2432e+00, 3.9709e+05, 3.8280e+05, 1.4511e+00],
        [3.8500e+05, 3.8499e+05, 7.7867e+05, 3.8501e+05, 3.8501e+05, 0.0000e+00,
         3.8502e+05, 7.8525e+05, 3.8500e+05, 7.9281e+05, 7.6638e+05, 7.9299e+05,
         3.8502e+05, 7.5409e+05, 7.6514e+05, 3.8500e+05],
        [1.0413e+00, 9.9423e-01, 4.0304e+05, 1.0873e+00, 1.5677e+00, 3.8502e+05,
         0.0000e+00, 3.8548e+05, 1.6281e+00, 3.9938e+05, 3.9299e+05, 3.9212e+05,
         1.5386e+00, 3.9708e+05, 3.8281e+05, 1.0377e+00],
        [3.8545e+05, 3.8547e+05, 7.8670e+05, 3.8549e+05, 3.8548e+05, 7.8525e+05,
         3.8548e+05, 0.0000e+00, 3.8548e+05, 7.7139e+05, 8.1443e+05, 7.6949e+05,
         3.8544e+05, 7.9220e+05, 7.8090e+05, 3.8547e+05],
        [1.4255e+00, 1.5597e+00, 4.0299e+05, 1.5187e+00, 1.2297e+00, 3.8500e+05,
         1.6281e+00, 3.8548e+05, 0.0000e+00, 3.9940e+05, 3.9300e+05, 3.9217e+05,
         1.2544e+00, 3.9710e+05, 3.8283e+05, 1.5119e+00],
        [3.9937e+05, 3.9934e+05, 7.9617e+05, 3.9936e+05, 3.9937e+05, 7.9281e+05,
         3.9938e+05, 7.7139e+05, 3.9940e+05, 0.0000e+00, 7.8229e+05, 8.0205e+05,
         3.9936e+05, 8.0128e+05, 7.7064e+05, 3.9937e+05],
        [3.9303e+05, 3.9303e+05, 8.0933e+05, 3.9303e+05, 3.9302e+05, 7.6638e+05,
         3.9299e+05, 8.1443e+05, 3.9300e+05, 7.8229e+05, 0.0000e+00, 7.7007e+05,
         3.9302e+05, 7.8165e+05, 7.5910e+05, 3.9299e+05],
        [3.9216e+05, 3.9215e+05, 7.9713e+05, 3.9216e+05, 3.9214e+05, 7.9299e+05,
         3.9212e+05, 7.6949e+05, 3.9217e+05, 8.0205e+05, 7.7007e+05, 0.0000e+00,
         3.9217e+05, 7.9678e+05, 7.8808e+05, 3.9216e+05],
        [1.3994e+00, 1.4071e+00, 4.0304e+05, 1.3992e+00, 1.2432e+00, 3.8502e+05,
         1.5386e+00, 3.8544e+05, 1.2544e+00, 3.9936e+05, 3.9302e+05, 3.9217e+05,
         0.0000e+00, 3.9713e+05, 3.8283e+05, 1.3854e+00],
        [3.9710e+05, 3.9710e+05, 8.0704e+05, 3.9708e+05, 3.9709e+05, 7.5409e+05,
         3.9708e+05, 7.9220e+05, 3.9710e+05, 8.0128e+05, 7.8165e+05, 7.9678e+05,
         3.9713e+05, 0.0000e+00, 7.8511e+05, 3.9710e+05],
        [3.8282e+05, 3.8284e+05, 7.7740e+05, 3.8282e+05, 3.8280e+05, 7.6514e+05,
         3.8281e+05, 7.8090e+05, 3.8283e+05, 7.7064e+05, 7.5910e+05, 7.8808e+05,
         3.8283e+05, 7.8511e+05, 0.0000e+00, 3.8281e+05],
        [1.0509e+00, 1.0626e+00, 4.0305e+05, 1.1078e+00, 1.4511e+00, 3.8500e+05,
         1.0377e+00, 3.8547e+05, 1.5119e+00, 3.9937e+05, 3.9299e+05, 3.9216e+05,
         1.3854e+00, 3.9710e+05, 3.8281e+05, 0.0000e+00]])
Krum scores: ['1.18', '1.21', '403027.66', '1.20', '1.39', '385002.53', '1.21', '385464.53', '1.42', '399362.38', '393005.84', '392147.59', '1.35', '397090.91', '382813.66', '1.18']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [10, 11, 18, 12, 4, 20, 2, 15, 7, 17, 19, 13, 5, 14, 16, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:58...
global Accuracy on shared test data: 75.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 58 205]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:58, End: 2025-07-22 16:02:58)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 3, 5, 15, 8, 10, 14, 13, 2, 20, 1, 12, 4, 19, 11, 18], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1511e+00, 1.0587e+00, 3.9795e+05, 1.1083e+00, 1.2798e+00,
         3.9200e+05, 3.9039e+05, 1.3731e+00, 3.9670e+05, 1.0848e+00, 1.2689e+00,
         1.0454e+00, 3.7431e+05, 1.3183e+00, 3.7049e+05],
        [1.1511e+00, 0.0000e+00, 1.0194e+00, 3.9791e+05, 1.1013e+00, 1.2036e+00,
         3.9200e+05, 3.9044e+05, 1.2750e+00, 3.9669e+05, 1.0921e+00, 1.1437e+00,
         1.0755e+00, 3.7438e+05, 1.3253e+00, 3.7048e+05],
        [1.0587e+00, 1.0194e+00, 0.0000e+00, 3.9795e+05, 1.1074e+00, 1.2431e+00,
         3.9201e+05, 3.9044e+05, 1.2745e+00, 3.9674e+05, 1.0404e+00, 1.1679e+00,
         1.0331e+00, 3.7435e+05, 1.1726e+00, 3.7049e+05],
        [3.9795e+05, 3.9791e+05, 3.9795e+05, 0.0000e+00, 3.9790e+05, 3.9796e+05,
         7.7081e+05, 7.6318e+05, 3.9792e+05, 7.9573e+05, 3.9792e+05, 3.9794e+05,
         3.9790e+05, 7.6158e+05, 3.9793e+05, 7.5096e+05],
        [1.1083e+00, 1.1013e+00, 1.1074e+00, 3.9790e+05, 0.0000e+00, 1.2350e+00,
         3.9199e+05, 3.9042e+05, 1.2949e+00, 3.9672e+05, 1.1192e+00, 1.1745e+00,
         1.0485e+00, 3.7433e+05, 1.3338e+00, 3.7049e+05],
        [1.2798e+00, 1.2036e+00, 1.2431e+00, 3.9796e+05, 1.2350e+00, 0.0000e+00,
         3.9200e+05, 3.9042e+05, 9.3008e-01, 3.9669e+05, 1.2105e+00, 9.8049e-01,
         1.3003e+00, 3.7432e+05, 9.7081e-01, 3.7052e+05],
        [3.9200e+05, 3.9200e+05, 3.9201e+05, 7.7081e+05, 3.9199e+05, 3.9200e+05,
         0.0000e+00, 7.7233e+05, 3.9200e+05, 7.8332e+05, 3.9200e+05, 3.9199e+05,
         3.9201e+05, 7.4152e+05, 3.9201e+05, 7.6820e+05],
        [3.9039e+05, 3.9044e+05, 3.9044e+05, 7.6318e+05, 3.9042e+05, 3.9042e+05,
         7.7233e+05, 0.0000e+00, 3.9042e+05, 7.7753e+05, 3.9041e+05, 3.9043e+05,
         3.9039e+05, 7.6315e+05, 3.9043e+05, 7.5547e+05],
        [1.3731e+00, 1.2750e+00, 1.2745e+00, 3.9792e+05, 1.2949e+00, 9.3008e-01,
         3.9200e+05, 3.9042e+05, 0.0000e+00, 3.9672e+05, 1.2256e+00, 9.2746e-01,
         1.3038e+00, 3.7433e+05, 8.6734e-01, 3.7053e+05],
        [3.9670e+05, 3.9669e+05, 3.9674e+05, 7.9573e+05, 3.9672e+05, 3.9669e+05,
         7.8332e+05, 7.7753e+05, 3.9672e+05, 0.0000e+00, 3.9671e+05, 3.9671e+05,
         3.9668e+05, 7.7122e+05, 3.9673e+05, 7.7573e+05],
        [1.0848e+00, 1.0921e+00, 1.0404e+00, 3.9792e+05, 1.1192e+00, 1.2105e+00,
         3.9200e+05, 3.9041e+05, 1.2256e+00, 3.9671e+05, 0.0000e+00, 1.1722e+00,
         1.1118e+00, 3.7433e+05, 1.2272e+00, 3.7050e+05],
        [1.2689e+00, 1.1437e+00, 1.1679e+00, 3.9794e+05, 1.1745e+00, 9.8049e-01,
         3.9199e+05, 3.9043e+05, 9.2746e-01, 3.9671e+05, 1.1722e+00, 0.0000e+00,
         1.1772e+00, 3.7432e+05, 9.7319e-01, 3.7050e+05],
        [1.0454e+00, 1.0755e+00, 1.0331e+00, 3.9790e+05, 1.0485e+00, 1.3003e+00,
         3.9201e+05, 3.9039e+05, 1.3038e+00, 3.9668e+05, 1.1118e+00, 1.1772e+00,
         0.0000e+00, 3.7433e+05, 1.3142e+00, 3.7051e+05],
        [3.7431e+05, 3.7438e+05, 3.7435e+05, 7.6158e+05, 3.7433e+05, 3.7432e+05,
         7.4152e+05, 7.6315e+05, 3.7433e+05, 7.7122e+05, 3.7433e+05, 3.7432e+05,
         3.7433e+05, 0.0000e+00, 3.7432e+05, 7.4473e+05],
        [1.3183e+00, 1.3253e+00, 1.1726e+00, 3.9793e+05, 1.3338e+00, 9.7081e-01,
         3.9201e+05, 3.9043e+05, 8.6734e-01, 3.9673e+05, 1.2272e+00, 9.7319e-01,
         1.3142e+00, 3.7432e+05, 0.0000e+00, 3.7051e+05],
        [3.7049e+05, 3.7048e+05, 3.7049e+05, 7.5096e+05, 3.7049e+05, 3.7052e+05,
         7.6820e+05, 7.5547e+05, 3.7053e+05, 7.7573e+05, 3.7050e+05, 3.7050e+05,
         3.7051e+05, 7.4473e+05, 3.7051e+05, 0.0000e+00]])
Krum scores: ['1.16', '1.13', '1.11', '397922.50', '1.15', '1.13', '391997.47', '390414.88', '1.14', '396701.81', '1.13', '1.09', '1.14', '374324.06', '1.15', '370494.81']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 3, 5, 15, 8, 10, 14, 13, 2, 20, 1, 12, 4, 19, 11, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0151s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:58...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:58, End: 2025-07-22 16:02:58)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 6, 2, 13, 14, 5, 17, 7, 11, 16, 20, 9, 19, 10, 18, 15], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1504e+00, 1.2093e+00, 3.9457e+05, 3.8503e+05, 1.0226e+00,
         3.8090e+05, 1.1209e+00, 1.2068e+00, 3.8879e+05, 3.8976e+05, 1.4491e+00,
         3.7420e+05, 1.1226e+00, 3.8727e+05, 3.8123e+05],
        [1.1504e+00, 0.0000e+00, 8.7339e-01, 3.9457e+05, 3.8504e+05, 1.0481e+00,
         3.8094e+05, 1.0999e+00, 8.5887e-01, 3.8881e+05, 3.8975e+05, 9.7849e-01,
         3.7421e+05, 9.1027e-01, 3.8726e+05, 3.8119e+05],
        [1.2093e+00, 8.7339e-01, 0.0000e+00, 3.9456e+05, 3.8502e+05, 1.2337e+00,
         3.8094e+05, 1.3039e+00, 8.2261e-01, 3.8882e+05, 3.8978e+05, 8.3439e-01,
         3.7418e+05, 8.7334e-01, 3.8723e+05, 3.8121e+05],
        [3.9457e+05, 3.9457e+05, 3.9456e+05, 0.0000e+00, 7.7043e+05, 3.9458e+05,
         7.7143e+05, 3.9459e+05, 3.9458e+05, 7.7734e+05, 7.8102e+05, 3.9457e+05,
         7.7166e+05, 3.9455e+05, 7.6996e+05, 7.7575e+05],
        [3.8503e+05, 3.8504e+05, 3.8502e+05, 7.7043e+05, 0.0000e+00, 3.8505e+05,
         7.6569e+05, 3.8505e+05, 3.8506e+05, 7.8478e+05, 7.4764e+05, 3.8503e+05,
         7.6125e+05, 3.8504e+05, 7.5388e+05, 7.5666e+05],
        [1.0226e+00, 1.0481e+00, 1.2337e+00, 3.9458e+05, 3.8505e+05, 0.0000e+00,
         3.8092e+05, 1.0229e+00, 1.0719e+00, 3.8881e+05, 3.8975e+05, 1.4254e+00,
         3.7421e+05, 1.1266e+00, 3.8727e+05, 3.8124e+05],
        [3.8090e+05, 3.8094e+05, 3.8094e+05, 7.7143e+05, 7.6569e+05, 3.8092e+05,
         0.0000e+00, 3.8093e+05, 3.8092e+05, 7.7037e+05, 7.6851e+05, 3.8091e+05,
         7.4963e+05, 3.8093e+05, 7.5859e+05, 7.5937e+05],
        [1.1209e+00, 1.0999e+00, 1.3039e+00, 3.9459e+05, 3.8505e+05, 1.0229e+00,
         3.8093e+05, 0.0000e+00, 1.1862e+00, 3.8883e+05, 3.8974e+05, 1.5540e+00,
         3.7420e+05, 1.1524e+00, 3.8727e+05, 3.8122e+05],
        [1.2068e+00, 8.5887e-01, 8.2261e-01, 3.9458e+05, 3.8506e+05, 1.0719e+00,
         3.8092e+05, 1.1862e+00, 0.0000e+00, 3.8878e+05, 3.8973e+05, 8.5711e-01,
         3.7419e+05, 8.8327e-01, 3.8725e+05, 3.8122e+05],
        [3.8879e+05, 3.8881e+05, 3.8882e+05, 7.7734e+05, 7.8478e+05, 3.8881e+05,
         7.7037e+05, 3.8883e+05, 3.8878e+05, 0.0000e+00, 7.7635e+05, 3.8881e+05,
         7.3958e+05, 3.8883e+05, 7.7483e+05, 7.6992e+05],
        [3.8976e+05, 3.8975e+05, 3.8978e+05, 7.8102e+05, 7.4764e+05, 3.8975e+05,
         7.6851e+05, 3.8974e+05, 3.8973e+05, 7.7635e+05, 0.0000e+00, 3.8976e+05,
         7.4491e+05, 3.8975e+05, 7.7380e+05, 7.7182e+05],
        [1.4491e+00, 9.7849e-01, 8.3439e-01, 3.9457e+05, 3.8503e+05, 1.4254e+00,
         3.8091e+05, 1.5540e+00, 8.5711e-01, 3.8881e+05, 3.8976e+05, 0.0000e+00,
         3.7419e+05, 9.6177e-01, 3.8726e+05, 3.8121e+05],
        [3.7420e+05, 3.7421e+05, 3.7418e+05, 7.7166e+05, 7.6125e+05, 3.7421e+05,
         7.4963e+05, 3.7420e+05, 3.7419e+05, 7.3958e+05, 7.4491e+05, 3.7419e+05,
         0.0000e+00, 3.7422e+05, 7.5815e+05, 7.6952e+05],
        [1.1226e+00, 9.1027e-01, 8.7334e-01, 3.9455e+05, 3.8504e+05, 1.1266e+00,
         3.8093e+05, 1.1524e+00, 8.8327e-01, 3.8883e+05, 3.8975e+05, 9.6177e-01,
         3.7422e+05, 0.0000e+00, 3.8725e+05, 3.8119e+05],
        [3.8727e+05, 3.8726e+05, 3.8723e+05, 7.6996e+05, 7.5388e+05, 3.8727e+05,
         7.5859e+05, 3.8727e+05, 3.8725e+05, 7.7483e+05, 7.7380e+05, 3.8726e+05,
         7.5815e+05, 3.8725e+05, 0.0000e+00, 7.6547e+05],
        [3.8123e+05, 3.8119e+05, 3.8121e+05, 7.7575e+05, 7.5666e+05, 3.8124e+05,
         7.5937e+05, 3.8122e+05, 3.8122e+05, 7.6992e+05, 7.7182e+05, 3.8121e+05,
         7.6952e+05, 3.8119e+05, 7.6547e+05, 0.0000e+00]])
Krum scores: ['1.14', '0.96', '0.97', '394568.84', '385033.53', '1.09', '380917.88', '1.15', '0.95', '388803.75', '389746.41', '1.08', '374192.84', '0.98', '387253.59', '381204.59']
Selected index: 8
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Chosen Update']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 6, 2, 13, 14, 5, 17, 7, 11, 16, 20, 9, 19, 10, 18, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0074s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:59...
global Accuracy on shared test data: 73.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 64 199]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:59, End: 2025-07-22 16:02:59)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 17, 20, 9, 11, 12, 3, 1, 14, 15, 8, 4, 13, 7, 16, 19], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 4.0036e+05, 3.9498e+05, 7.9791e-01, 9.0387e-01, 8.1035e-01,
         1.1451e+00, 1.0757e+00, 3.9460e+05, 3.9845e+05, 1.1991e+00, 1.2112e+00,
         3.9084e+05, 1.2371e+00, 4.0180e+05, 3.8106e+05],
        [4.0036e+05, 0.0000e+00, 8.0673e+05, 4.0034e+05, 4.0033e+05, 4.0034e+05,
         4.0031e+05, 4.0032e+05, 7.9170e+05, 7.9314e+05, 4.0036e+05, 4.0032e+05,
         7.7922e+05, 4.0032e+05, 7.8369e+05, 7.5649e+05],
        [3.9498e+05, 8.0673e+05, 0.0000e+00, 3.9498e+05, 3.9502e+05, 3.9497e+05,
         3.9497e+05, 3.9499e+05, 7.8940e+05, 7.8775e+05, 3.9500e+05, 3.9499e+05,
         8.1728e+05, 3.9499e+05, 7.6489e+05, 7.6024e+05],
        [7.9791e-01, 4.0034e+05, 3.9498e+05, 0.0000e+00, 7.6416e-01, 7.3234e-01,
         1.2684e+00, 1.1811e+00, 3.9460e+05, 3.9843e+05, 1.3387e+00, 1.3540e+00,
         3.9085e+05, 1.4102e+00, 4.0179e+05, 3.8107e+05],
        [9.0387e-01, 4.0033e+05, 3.9502e+05, 7.6416e-01, 0.0000e+00, 7.9916e-01,
         1.5301e+00, 1.4230e+00, 3.9459e+05, 3.9844e+05, 1.6435e+00, 1.5953e+00,
         3.9081e+05, 1.6271e+00, 4.0182e+05, 3.8106e+05],
        [8.1035e-01, 4.0034e+05, 3.9497e+05, 7.3234e-01, 7.9916e-01, 0.0000e+00,
         1.2594e+00, 1.2147e+00, 3.9460e+05, 3.9843e+05, 1.3437e+00, 1.3216e+00,
         3.9083e+05, 1.4087e+00, 4.0181e+05, 3.8107e+05],
        [1.1451e+00, 4.0031e+05, 3.9497e+05, 1.2684e+00, 1.5301e+00, 1.2594e+00,
         0.0000e+00, 9.6925e-01, 3.9461e+05, 3.9843e+05, 1.0039e+00, 9.6476e-01,
         3.9085e+05, 1.0350e+00, 4.0183e+05, 3.8108e+05],
        [1.0757e+00, 4.0032e+05, 3.9499e+05, 1.1811e+00, 1.4230e+00, 1.2147e+00,
         9.6925e-01, 0.0000e+00, 3.9458e+05, 3.9843e+05, 1.0021e+00, 1.0392e+00,
         3.9082e+05, 9.9985e-01, 4.0181e+05, 3.8106e+05],
        [3.9460e+05, 7.9170e+05, 7.8940e+05, 3.9460e+05, 3.9459e+05, 3.9460e+05,
         3.9461e+05, 3.9458e+05, 0.0000e+00, 8.0956e+05, 3.9459e+05, 3.9464e+05,
         7.6930e+05, 3.9457e+05, 7.9925e+05, 7.5309e+05],
        [3.9845e+05, 7.9314e+05, 7.8775e+05, 3.9843e+05, 3.9844e+05, 3.9843e+05,
         3.9843e+05, 3.9843e+05, 8.0956e+05, 0.0000e+00, 3.9844e+05, 3.9841e+05,
         7.7822e+05, 3.9843e+05, 8.1990e+05, 7.8997e+05],
        [1.1991e+00, 4.0036e+05, 3.9500e+05, 1.3387e+00, 1.6435e+00, 1.3437e+00,
         1.0039e+00, 1.0021e+00, 3.9459e+05, 3.9844e+05, 0.0000e+00, 9.8765e-01,
         3.9086e+05, 9.9895e-01, 4.0182e+05, 3.8108e+05],
        [1.2112e+00, 4.0032e+05, 3.9499e+05, 1.3540e+00, 1.5953e+00, 1.3216e+00,
         9.6476e-01, 1.0392e+00, 3.9464e+05, 3.9841e+05, 9.8765e-01, 0.0000e+00,
         3.9085e+05, 1.0142e+00, 4.0182e+05, 3.8108e+05],
        [3.9084e+05, 7.7922e+05, 8.1728e+05, 3.9085e+05, 3.9081e+05, 3.9083e+05,
         3.9085e+05, 3.9082e+05, 7.6930e+05, 7.7822e+05, 3.9086e+05, 3.9085e+05,
         0.0000e+00, 3.9084e+05, 8.1299e+05, 7.7138e+05],
        [1.2371e+00, 4.0032e+05, 3.9499e+05, 1.4102e+00, 1.6271e+00, 1.4087e+00,
         1.0350e+00, 9.9985e-01, 3.9457e+05, 3.9843e+05, 9.9895e-01, 1.0142e+00,
         3.9084e+05, 0.0000e+00, 4.0181e+05, 3.8106e+05],
        [4.0180e+05, 7.8369e+05, 7.6489e+05, 4.0179e+05, 4.0182e+05, 4.0181e+05,
         4.0183e+05, 4.0181e+05, 7.9925e+05, 8.1990e+05, 4.0182e+05, 4.0182e+05,
         8.1299e+05, 4.0181e+05, 0.0000e+00, 7.8277e+05],
        [3.8106e+05, 7.5649e+05, 7.6024e+05, 3.8107e+05, 3.8106e+05, 3.8107e+05,
         3.8108e+05, 3.8106e+05, 7.5309e+05, 7.8997e+05, 3.8108e+05, 3.8108e+05,
         7.7138e+05, 3.8106e+05, 7.8277e+05, 0.0000e+00]])
Krum scores: ['1.02', '400324.53', '394979.34', '1.06', '1.23', '1.07', '1.09', '1.07', '394591.97', '398429.41', '1.12', '1.13', '390834.34', '1.16', '401807.44', '381064.75']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 17, 20, 9, 11, 12, 3, 1, 14, 15, 8, 4, 13, 7, 16, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0052s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:02:59...
global Accuracy on shared test data: 72.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [ 83 180]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:02:59, End: 2025-07-22 16:02:59)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 4, 11, 17, 20, 10, 16, 5, 13, 19, 12, 9, 7, 15, 8, 1], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9727e+05, 3.9729e+05, 8.1763e+05, 7.9961e+05, 3.9732e+05,
         8.1339e+05, 3.9727e+05, 7.9020e+05, 7.8078e+05, 3.9730e+05, 3.9729e+05,
         3.9727e+05, 8.0324e+05, 3.9727e+05, 3.9727e+05],
        [3.9727e+05, 0.0000e+00, 1.3052e+00, 4.0806e+05, 3.8815e+05, 1.0638e+00,
         4.0531e+05, 9.1398e-01, 3.8429e+05, 3.9634e+05, 1.1622e+00, 1.2118e+00,
         9.2354e-01, 3.8381e+05, 9.3020e-01, 9.7701e-01],
        [3.9729e+05, 1.3052e+00, 0.0000e+00, 4.0806e+05, 3.8816e+05, 8.5826e-01,
         4.0532e+05, 1.2383e+00, 3.8433e+05, 3.9634e+05, 6.6263e-01, 6.4512e-01,
         1.3411e+00, 3.8385e+05, 1.3564e+00, 1.1859e+00],
        [8.1763e+05, 4.0806e+05, 4.0806e+05, 0.0000e+00, 8.1615e+05, 4.0805e+05,
         8.1301e+05, 4.0807e+05, 7.8370e+05, 8.2101e+05, 4.0807e+05, 4.0806e+05,
         4.0806e+05, 7.8293e+05, 4.0807e+05, 4.0808e+05],
        [7.9961e+05, 3.8815e+05, 3.8816e+05, 8.1615e+05, 0.0000e+00, 3.8818e+05,
         8.0038e+05, 3.8818e+05, 7.8395e+05, 7.8023e+05, 3.8818e+05, 3.8818e+05,
         3.8818e+05, 7.8156e+05, 3.8816e+05, 3.8817e+05],
        [3.9732e+05, 1.0638e+00, 8.5826e-01, 4.0805e+05, 3.8818e+05, 0.0000e+00,
         4.0530e+05, 1.0578e+00, 3.8431e+05, 3.9633e+05, 8.1598e-01, 8.1616e-01,
         1.0420e+00, 3.8383e+05, 1.0495e+00, 9.7232e-01],
        [8.1339e+05, 4.0531e+05, 4.0532e+05, 8.1301e+05, 8.0038e+05, 4.0530e+05,
         0.0000e+00, 4.0532e+05, 8.0163e+05, 8.3297e+05, 4.0532e+05, 4.0533e+05,
         4.0531e+05, 7.8369e+05, 4.0528e+05, 4.0530e+05],
        [3.9727e+05, 9.1398e-01, 1.2383e+00, 4.0807e+05, 3.8818e+05, 1.0578e+00,
         4.0532e+05, 0.0000e+00, 3.8431e+05, 3.9633e+05, 1.1831e+00, 1.1946e+00,
         9.5270e-01, 3.8380e+05, 1.0144e+00, 9.2476e-01],
        [7.9020e+05, 3.8429e+05, 3.8433e+05, 7.8370e+05, 7.8395e+05, 3.8431e+05,
         8.0163e+05, 3.8431e+05, 0.0000e+00, 7.8112e+05, 3.8433e+05, 3.8430e+05,
         3.8430e+05, 7.5248e+05, 3.8428e+05, 3.8433e+05],
        [7.8078e+05, 3.9634e+05, 3.9634e+05, 8.2101e+05, 7.8023e+05, 3.9633e+05,
         8.3297e+05, 3.9633e+05, 7.8112e+05, 0.0000e+00, 3.9635e+05, 3.9632e+05,
         3.9633e+05, 7.7007e+05, 3.9636e+05, 3.9634e+05],
        [3.9730e+05, 1.1622e+00, 6.6263e-01, 4.0807e+05, 3.8818e+05, 8.1598e-01,
         4.0532e+05, 1.1831e+00, 3.8433e+05, 3.9635e+05, 0.0000e+00, 6.8231e-01,
         1.2367e+00, 3.8386e+05, 1.1917e+00, 1.1096e+00],
        [3.9729e+05, 1.2118e+00, 6.4512e-01, 4.0806e+05, 3.8818e+05, 8.1616e-01,
         4.0533e+05, 1.1946e+00, 3.8430e+05, 3.9632e+05, 6.8231e-01, 0.0000e+00,
         1.2801e+00, 3.8383e+05, 1.2200e+00, 1.1018e+00],
        [3.9727e+05, 9.2354e-01, 1.3411e+00, 4.0806e+05, 3.8818e+05, 1.0420e+00,
         4.0531e+05, 9.5270e-01, 3.8430e+05, 3.9633e+05, 1.2367e+00, 1.2801e+00,
         0.0000e+00, 3.8379e+05, 9.5771e-01, 9.4009e-01],
        [8.0324e+05, 3.8381e+05, 3.8385e+05, 7.8293e+05, 7.8156e+05, 3.8383e+05,
         7.8369e+05, 3.8380e+05, 7.5248e+05, 7.7007e+05, 3.8386e+05, 3.8383e+05,
         3.8379e+05, 0.0000e+00, 3.8380e+05, 3.8380e+05],
        [3.9727e+05, 9.3020e-01, 1.3564e+00, 4.0807e+05, 3.8816e+05, 1.0495e+00,
         4.0528e+05, 1.0144e+00, 3.8428e+05, 3.9636e+05, 1.1917e+00, 1.2200e+00,
         9.5771e-01, 3.8380e+05, 0.0000e+00, 9.6869e-01],
        [3.9727e+05, 9.7701e-01, 1.1859e+00, 4.0808e+05, 3.8817e+05, 9.7232e-01,
         4.0530e+05, 9.2476e-01, 3.8433e+05, 3.9634e+05, 1.1096e+00, 1.1018e+00,
         9.4009e-01, 3.8380e+05, 9.6869e-01, 0.0000e+00]])
Krum scores: ['397274.69', '1.03', '1.03', '408062.31', '388167.56', '0.94', '405304.72', '1.03', '384303.47', '396333.09', '0.97', '0.98', '1.05', '383807.25', '1.05', '1.00']
Selected index: 5
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Chosen Update']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 4, 11, 17, 20, 10, 16, 5, 13, 19, 12, 9, 7, 15, 8, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0040s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:00...
global Accuracy on shared test data: 71.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:00, End: 2025-07-22 16:03:00)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 11, 3, 14, 19, 2, 9, 13, 17, 20, 6, 8, 16, 5, 15, 18], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 1.1622e+00, 9.2873e-01, 3.8389e+05, 4.0008e+05, 1.2111e+00,
         1.0908e+00, 3.9079e+05, 3.9547e+05, 3.8115e+05, 8.7627e-01, 9.5072e-01,
         3.9640e+05, 9.0909e-01, 3.9265e+05, 4.0384e+05],
        [1.1622e+00, 0.0000e+00, 1.2595e+00, 3.8390e+05, 4.0007e+05, 6.1134e-01,
         6.8775e-01, 3.9080e+05, 3.9545e+05, 3.8114e+05, 8.8401e-01, 1.3354e+00,
         3.9640e+05, 1.1575e+00, 3.9271e+05, 4.0386e+05],
        [9.2873e-01, 1.2595e+00, 0.0000e+00, 3.8393e+05, 4.0007e+05, 1.3492e+00,
         1.1986e+00, 3.9079e+05, 3.9545e+05, 3.8115e+05, 1.0120e+00, 9.9409e-01,
         3.9641e+05, 9.2577e-01, 3.9266e+05, 4.0386e+05],
        [3.8389e+05, 3.8390e+05, 3.8393e+05, 0.0000e+00, 7.9113e+05, 3.8391e+05,
         3.8390e+05, 7.5979e+05, 7.6797e+05, 7.5100e+05, 3.8390e+05, 3.8390e+05,
         7.5308e+05, 3.8390e+05, 7.7077e+05, 7.8172e+05],
        [4.0008e+05, 4.0007e+05, 4.0007e+05, 7.9113e+05, 0.0000e+00, 4.0006e+05,
         4.0007e+05, 7.7015e+05, 7.9724e+05, 7.7553e+05, 4.0007e+05, 4.0007e+05,
         7.9640e+05, 4.0005e+05, 7.9857e+05, 8.0716e+05],
        [1.2111e+00, 6.1134e-01, 1.3492e+00, 3.8391e+05, 4.0006e+05, 0.0000e+00,
         6.8798e-01, 3.9078e+05, 3.9547e+05, 3.8115e+05, 9.0964e-01, 1.3856e+00,
         3.9642e+05, 1.3466e+00, 3.9271e+05, 4.0386e+05],
        [1.0908e+00, 6.8775e-01, 1.1986e+00, 3.8390e+05, 4.0007e+05, 6.8798e-01,
         0.0000e+00, 3.9080e+05, 3.9543e+05, 3.8114e+05, 8.4445e-01, 1.2137e+00,
         3.9641e+05, 1.1733e+00, 3.9269e+05, 4.0384e+05],
        [3.9079e+05, 3.9080e+05, 3.9079e+05, 7.5979e+05, 7.7015e+05, 3.9078e+05,
         3.9080e+05, 0.0000e+00, 7.7410e+05, 7.8483e+05, 3.9077e+05, 3.9078e+05,
         8.0273e+05, 3.9082e+05, 7.9890e+05, 7.6946e+05],
        [3.9547e+05, 3.9545e+05, 3.9545e+05, 7.6797e+05, 7.9724e+05, 3.9547e+05,
         3.9543e+05, 7.7410e+05, 0.0000e+00, 7.7632e+05, 3.9546e+05, 3.9546e+05,
         7.9733e+05, 3.9546e+05, 7.8708e+05, 7.9659e+05],
        [3.8115e+05, 3.8114e+05, 3.8115e+05, 7.5100e+05, 7.7553e+05, 3.8115e+05,
         3.8114e+05, 7.8483e+05, 7.7632e+05, 0.0000e+00, 3.8117e+05, 3.8116e+05,
         7.9321e+05, 3.8116e+05, 7.9222e+05, 7.8819e+05],
        [8.7627e-01, 8.8401e-01, 1.0120e+00, 3.8390e+05, 4.0007e+05, 9.0964e-01,
         8.4445e-01, 3.9077e+05, 3.9546e+05, 3.8117e+05, 0.0000e+00, 9.8828e-01,
         3.9639e+05, 9.4098e-01, 3.9269e+05, 4.0386e+05],
        [9.5072e-01, 1.3354e+00, 9.9409e-01, 3.8390e+05, 4.0007e+05, 1.3856e+00,
         1.2137e+00, 3.9078e+05, 3.9546e+05, 3.8116e+05, 9.8828e-01, 0.0000e+00,
         3.9641e+05, 9.9491e-01, 3.9268e+05, 4.0380e+05],
        [3.9640e+05, 3.9640e+05, 3.9641e+05, 7.5308e+05, 7.9640e+05, 3.9642e+05,
         3.9641e+05, 8.0273e+05, 7.9733e+05, 7.9321e+05, 3.9639e+05, 3.9641e+05,
         0.0000e+00, 3.9637e+05, 7.9777e+05, 8.1734e+05],
        [9.0909e-01, 1.1575e+00, 9.2577e-01, 3.8390e+05, 4.0005e+05, 1.3466e+00,
         1.1733e+00, 3.9082e+05, 3.9546e+05, 3.8116e+05, 9.4098e-01, 9.9491e-01,
         3.9637e+05, 0.0000e+00, 3.9268e+05, 4.0383e+05],
        [3.9265e+05, 3.9271e+05, 3.9266e+05, 7.7077e+05, 7.9857e+05, 3.9271e+05,
         3.9269e+05, 7.9890e+05, 7.8708e+05, 7.9222e+05, 3.9269e+05, 3.9268e+05,
         7.9777e+05, 3.9268e+05, 0.0000e+00, 8.0330e+05],
        [4.0384e+05, 4.0386e+05, 4.0386e+05, 7.8172e+05, 8.0716e+05, 4.0386e+05,
         4.0384e+05, 7.6946e+05, 7.9659e+05, 7.8819e+05, 4.0386e+05, 4.0380e+05,
         8.1734e+05, 4.0383e+05, 8.0330e+05, 0.0000e+00]])
Krum scores: ['0.99', '0.96', '1.05', '383898.25', '400065.47', '1.02', '0.95', '390785.62', '395450.25', '381148.03', '0.91', '1.08', '396397.53', '1.02', '392677.91', '403837.84']
Selected index: 10
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Chosen Update']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 11, 3, 14, 19, 2, 9, 13, 17, 20, 6, 8, 16, 5, 15, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0206s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:01...
global Accuracy on shared test data: 71.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 78 185]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:01, End: 2025-07-22 16:03:01)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 13, 17, 18, 15, 20, 11, 7, 10, 9, 6, 4, 5, 14, 16, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.7267e+05, 3.8489e+05, 3.9542e+05, 3.8707e+05, 3.9428e+05,
         1.3203e+00, 1.0462e+00, 1.3321e+00, 1.2621e+00, 1.5448e+00, 9.6447e-01,
         9.4952e-01, 3.9294e+05, 3.9340e+05, 1.3359e+00],
        [3.7267e+05, 0.0000e+00, 7.7400e+05, 7.5888e+05, 7.3909e+05, 7.7329e+05,
         3.7266e+05, 3.7264e+05, 3.7265e+05, 3.7264e+05, 3.7267e+05, 3.7264e+05,
         3.7264e+05, 7.6789e+05, 7.6581e+05, 3.7265e+05],
        [3.8489e+05, 7.7400e+05, 0.0000e+00, 7.7325e+05, 7.8434e+05, 7.7189e+05,
         3.8489e+05, 3.8489e+05, 3.8489e+05, 3.8491e+05, 3.8489e+05, 3.8489e+05,
         3.8487e+05, 7.8960e+05, 7.6310e+05, 3.8487e+05],
        [3.9542e+05, 7.5888e+05, 7.7325e+05, 0.0000e+00, 7.7112e+05, 8.0170e+05,
         3.9544e+05, 3.9544e+05, 3.9545e+05, 3.9546e+05, 3.9542e+05, 3.9542e+05,
         3.9542e+05, 7.9044e+05, 7.8418e+05, 3.9543e+05],
        [3.8707e+05, 7.3909e+05, 7.8434e+05, 7.7112e+05, 0.0000e+00, 7.8184e+05,
         3.8709e+05, 3.8709e+05, 3.8710e+05, 3.8709e+05, 3.8709e+05, 3.8707e+05,
         3.8708e+05, 7.5127e+05, 7.6451e+05, 3.8710e+05],
        [3.9428e+05, 7.7329e+05, 7.7189e+05, 8.0170e+05, 7.8184e+05, 0.0000e+00,
         3.9428e+05, 3.9428e+05, 3.9425e+05, 3.9426e+05, 3.9428e+05, 3.9430e+05,
         3.9428e+05, 7.9903e+05, 7.8606e+05, 3.9430e+05],
        [1.3203e+00, 3.7266e+05, 3.8489e+05, 3.9544e+05, 3.8709e+05, 3.9428e+05,
         0.0000e+00, 1.4001e+00, 7.2348e-01, 7.2504e-01, 8.4635e-01, 1.3744e+00,
         1.2355e+00, 3.9294e+05, 3.9342e+05, 6.4637e-01],
        [1.0462e+00, 3.7264e+05, 3.8489e+05, 3.9544e+05, 3.8709e+05, 3.9428e+05,
         1.4001e+00, 0.0000e+00, 1.4208e+00, 1.3621e+00, 1.6153e+00, 9.7372e-01,
         1.0014e+00, 3.9295e+05, 3.9342e+05, 1.4507e+00],
        [1.3321e+00, 3.7265e+05, 3.8489e+05, 3.9545e+05, 3.8710e+05, 3.9425e+05,
         7.2348e-01, 1.4208e+00, 0.0000e+00, 7.4663e-01, 8.5110e-01, 1.4567e+00,
         1.3632e+00, 3.9292e+05, 3.9342e+05, 6.7152e-01],
        [1.2621e+00, 3.7264e+05, 3.8491e+05, 3.9546e+05, 3.8709e+05, 3.9426e+05,
         7.2504e-01, 1.3621e+00, 7.4663e-01, 0.0000e+00, 8.4487e-01, 1.3133e+00,
         1.2603e+00, 3.9293e+05, 3.9342e+05, 7.0023e-01],
        [1.5448e+00, 3.7267e+05, 3.8489e+05, 3.9542e+05, 3.8709e+05, 3.9428e+05,
         8.4635e-01, 1.6153e+00, 8.5110e-01, 8.4487e-01, 0.0000e+00, 1.5620e+00,
         1.4742e+00, 3.9290e+05, 3.9340e+05, 7.7532e-01],
        [9.6447e-01, 3.7264e+05, 3.8489e+05, 3.9542e+05, 3.8707e+05, 3.9430e+05,
         1.3744e+00, 9.7372e-01, 1.4567e+00, 1.3133e+00, 1.5620e+00, 0.0000e+00,
         9.4413e-01, 3.9292e+05, 3.9339e+05, 1.4185e+00],
        [9.4952e-01, 3.7264e+05, 3.8487e+05, 3.9542e+05, 3.8708e+05, 3.9428e+05,
         1.2355e+00, 1.0014e+00, 1.3632e+00, 1.2603e+00, 1.4742e+00, 9.4413e-01,
         0.0000e+00, 3.9297e+05, 3.9343e+05, 1.3669e+00],
        [3.9294e+05, 7.6789e+05, 7.8960e+05, 7.9044e+05, 7.5127e+05, 7.9903e+05,
         3.9294e+05, 3.9295e+05, 3.9292e+05, 3.9293e+05, 3.9290e+05, 3.9292e+05,
         3.9297e+05, 0.0000e+00, 7.7408e+05, 3.9293e+05],
        [3.9340e+05, 7.6581e+05, 7.6310e+05, 7.8418e+05, 7.6451e+05, 7.8606e+05,
         3.9342e+05, 3.9342e+05, 3.9342e+05, 3.9342e+05, 3.9340e+05, 3.9339e+05,
         3.9343e+05, 7.7408e+05, 0.0000e+00, 3.9340e+05],
        [1.3359e+00, 3.7265e+05, 3.8487e+05, 3.9543e+05, 3.8710e+05, 3.9430e+05,
         6.4637e-01, 1.4507e+00, 6.7152e-01, 7.0023e-01, 7.7532e-01, 1.4185e+00,
         1.3669e+00, 3.9293e+05, 3.9340e+05, 0.0000e+00]])
Krum scores: ['1.17', '372646.06', '384884.59', '395426.84', '387082.47', '394272.59', '0.98', '1.24', '1.02', '0.98', '1.13', '1.21', '1.16', '392927.03', '393405.78', '0.99']
Selected index: 9
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Chosen Update']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 13, 17, 18, 15, 20, 11, 7, 10, 9, 6, 4, 5, 14, 16, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0041s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:01...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:01, End: 2025-07-22 16:03:01)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 8, 15, 14, 5, 6, 13, 18, 11, 17, 3, 4, 12, 7, 16, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.8952e-01, 4.2428e+05, 4.2278e+05, 8.7969e-01, 9.9751e-01,
         4.0621e+05, 3.8513e+05, 1.0284e+00, 4.0170e+05, 9.5688e-01, 9.6103e-01,
         1.0084e+00, 9.4215e-01, 3.7656e+05, 4.0154e+05],
        [9.8952e-01, 0.0000e+00, 4.2430e+05, 4.2280e+05, 9.4367e-01, 1.1891e+00,
         4.0623e+05, 3.8511e+05, 1.1997e+00, 4.0169e+05, 9.6886e-01, 9.1322e-01,
         1.1001e+00, 9.3384e-01, 3.7654e+05, 4.0158e+05],
        [4.2428e+05, 4.2430e+05, 0.0000e+00, 8.5893e+05, 4.2428e+05, 4.2431e+05,
         8.2914e+05, 8.1163e+05, 4.2428e+05, 8.1970e+05, 4.2429e+05, 4.2429e+05,
         4.2428e+05, 4.2431e+05, 7.9257e+05, 8.3826e+05],
        [4.2278e+05, 4.2280e+05, 8.5893e+05, 0.0000e+00, 4.2280e+05, 4.2279e+05,
         8.2575e+05, 8.0758e+05, 4.2279e+05, 8.1553e+05, 4.2277e+05, 4.2282e+05,
         4.2281e+05, 4.2278e+05, 8.2474e+05, 8.1824e+05],
        [8.7969e-01, 9.4367e-01, 4.2428e+05, 4.2280e+05, 0.0000e+00, 1.0700e+00,
         4.0622e+05, 3.8512e+05, 1.0144e+00, 4.0167e+05, 8.9232e-01, 8.7083e-01,
         1.0466e+00, 9.2077e-01, 3.7657e+05, 4.0156e+05],
        [9.9751e-01, 1.1891e+00, 4.2431e+05, 4.2279e+05, 1.0700e+00, 0.0000e+00,
         4.0622e+05, 3.8512e+05, 6.7634e-01, 4.0169e+05, 1.1430e+00, 1.1154e+00,
         6.9363e-01, 1.1544e+00, 3.7655e+05, 4.0153e+05],
        [4.0621e+05, 4.0623e+05, 8.2914e+05, 8.2575e+05, 4.0622e+05, 4.0622e+05,
         0.0000e+00, 7.6339e+05, 4.0621e+05, 7.9440e+05, 4.0620e+05, 4.0620e+05,
         4.0622e+05, 4.0618e+05, 7.9007e+05, 8.0506e+05],
        [3.8513e+05, 3.8511e+05, 8.1163e+05, 8.0758e+05, 3.8512e+05, 3.8512e+05,
         7.6339e+05, 0.0000e+00, 3.8510e+05, 7.7828e+05, 3.8512e+05, 3.8511e+05,
         3.8511e+05, 3.8511e+05, 7.7411e+05, 7.8953e+05],
        [1.0284e+00, 1.1997e+00, 4.2428e+05, 4.2279e+05, 1.0144e+00, 6.7634e-01,
         4.0621e+05, 3.8510e+05, 0.0000e+00, 4.0167e+05, 1.1307e+00, 1.1420e+00,
         6.5611e-01, 1.1353e+00, 3.7657e+05, 4.0153e+05],
        [4.0170e+05, 4.0169e+05, 8.1970e+05, 8.1553e+05, 4.0167e+05, 4.0169e+05,
         7.9440e+05, 7.7828e+05, 4.0167e+05, 0.0000e+00, 4.0170e+05, 4.0169e+05,
         4.0168e+05, 4.0170e+05, 7.6053e+05, 8.0326e+05],
        [9.5688e-01, 9.6886e-01, 4.2429e+05, 4.2277e+05, 8.9232e-01, 1.1430e+00,
         4.0620e+05, 3.8512e+05, 1.1307e+00, 4.0170e+05, 0.0000e+00, 9.3141e-01,
         1.0597e+00, 9.8205e-01, 3.7655e+05, 4.0153e+05],
        [9.6103e-01, 9.1322e-01, 4.2429e+05, 4.2282e+05, 8.7083e-01, 1.1154e+00,
         4.0620e+05, 3.8511e+05, 1.1420e+00, 4.0169e+05, 9.3141e-01, 0.0000e+00,
         1.0765e+00, 9.1299e-01, 3.7657e+05, 4.0156e+05],
        [1.0084e+00, 1.1001e+00, 4.2428e+05, 4.2281e+05, 1.0466e+00, 6.9363e-01,
         4.0622e+05, 3.8511e+05, 6.5611e-01, 4.0168e+05, 1.0597e+00, 1.0765e+00,
         0.0000e+00, 1.1123e+00, 3.7656e+05, 4.0157e+05],
        [9.4215e-01, 9.3384e-01, 4.2431e+05, 4.2278e+05, 9.2077e-01, 1.1544e+00,
         4.0618e+05, 3.8511e+05, 1.1353e+00, 4.0170e+05, 9.8205e-01, 9.1299e-01,
         1.1123e+00, 0.0000e+00, 3.7656e+05, 4.0154e+05],
        [3.7656e+05, 3.7654e+05, 7.9257e+05, 8.2474e+05, 3.7657e+05, 3.7655e+05,
         7.9007e+05, 7.7411e+05, 3.7657e+05, 7.6053e+05, 3.7655e+05, 3.7657e+05,
         3.7656e+05, 3.7656e+05, 0.0000e+00, 7.7671e+05],
        [4.0154e+05, 4.0158e+05, 8.3826e+05, 8.1824e+05, 4.0156e+05, 4.0153e+05,
         8.0506e+05, 7.8953e+05, 4.0153e+05, 8.0326e+05, 4.0153e+05, 4.0156e+05,
         4.0157e+05, 4.0154e+05, 7.7671e+05, 0.0000e+00]])
Krum scores: ['0.96', '1.01', '424286.97', '422788.03', '0.94', '0.98', '406206.81', '385111.53', '0.97', '401683.31', '0.99', '0.97', '0.95', '0.99', '376556.97', '401541.56']
Selected index: 4
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Chosen Update']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 8, 15, 14, 5, 6, 13, 18, 11, 17, 3, 4, 12, 7, 16, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0175s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:02...
global Accuracy on shared test data: 74.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:02, End: 2025-07-22 16:03:02)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 5, 3, 8, 6, 2, 10, 4, 18, 12, 13, 11, 9, 1, 15, 7], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8153e+05, 3.8157e+05, 3.8156e+05, 3.8151e+05, 3.8156e+05,
         3.8154e+05, 3.8154e+05, 7.7663e+05, 3.8153e+05, 7.8273e+05, 3.8152e+05,
         3.8153e+05, 3.8154e+05, 7.7843e+05, 3.8155e+05],
        [3.8153e+05, 0.0000e+00, 1.2610e+00, 1.3612e+00, 1.0371e+00, 1.0283e+00,
         9.7196e-01, 1.2485e+00, 4.0369e+05, 1.0033e+00, 4.0112e+05, 9.2044e-01,
         9.9479e-01, 1.1969e+00, 3.9758e+05, 1.3106e+00],
        [3.8157e+05, 1.2610e+00, 0.0000e+00, 1.0724e+00, 1.3777e+00, 1.3705e+00,
         1.3077e+00, 1.0836e+00, 4.0369e+05, 1.2512e+00, 4.0112e+05, 1.3728e+00,
         1.5588e+00, 1.0938e+00, 3.9757e+05, 1.1399e+00],
        [3.8156e+05, 1.3612e+00, 1.0724e+00, 0.0000e+00, 1.3962e+00, 1.4149e+00,
         1.3685e+00, 1.0392e+00, 4.0365e+05, 1.2883e+00, 4.0114e+05, 1.4503e+00,
         1.6296e+00, 1.1055e+00, 3.9754e+05, 1.0363e+00],
        [3.8151e+05, 1.0371e+00, 1.3777e+00, 1.3962e+00, 0.0000e+00, 7.7078e-01,
         8.0011e-01, 1.3742e+00, 4.0368e+05, 8.4972e-01, 4.0113e+05, 8.0621e-01,
         7.5677e-01, 1.2335e+00, 3.9757e+05, 1.4219e+00],
        [3.8156e+05, 1.0283e+00, 1.3705e+00, 1.4149e+00, 7.7078e-01, 0.0000e+00,
         7.1049e-01, 1.3928e+00, 4.0366e+05, 7.7462e-01, 4.0112e+05, 7.1869e-01,
         6.7417e-01, 1.2799e+00, 3.9755e+05, 1.4403e+00],
        [3.8154e+05, 9.7196e-01, 1.3077e+00, 1.3685e+00, 8.0011e-01, 7.1049e-01,
         0.0000e+00, 1.4145e+00, 4.0367e+05, 7.8339e-01, 4.0114e+05, 7.6413e-01,
         6.9728e-01, 1.2656e+00, 3.9756e+05, 1.3817e+00],
        [3.8154e+05, 1.2485e+00, 1.0836e+00, 1.0392e+00, 1.3742e+00, 1.3928e+00,
         1.4145e+00, 0.0000e+00, 4.0369e+05, 1.2795e+00, 4.0114e+05, 1.4002e+00,
         1.5892e+00, 1.1018e+00, 3.9755e+05, 1.0361e+00],
        [7.7663e+05, 4.0369e+05, 4.0369e+05, 4.0365e+05, 4.0368e+05, 4.0366e+05,
         4.0367e+05, 4.0369e+05, 0.0000e+00, 4.0370e+05, 7.9855e+05, 4.0366e+05,
         4.0367e+05, 4.0367e+05, 8.0077e+05, 4.0368e+05],
        [3.8153e+05, 1.0033e+00, 1.2512e+00, 1.2883e+00, 8.4972e-01, 7.7462e-01,
         7.8339e-01, 1.2795e+00, 4.0370e+05, 0.0000e+00, 4.0110e+05, 8.1619e-01,
         8.0548e-01, 1.2125e+00, 3.9756e+05, 1.3425e+00],
        [7.8273e+05, 4.0112e+05, 4.0112e+05, 4.0114e+05, 4.0113e+05, 4.0112e+05,
         4.0114e+05, 4.0114e+05, 7.9855e+05, 4.0110e+05, 0.0000e+00, 4.0110e+05,
         4.0111e+05, 4.0113e+05, 7.9437e+05, 4.0115e+05],
        [3.8152e+05, 9.2044e-01, 1.3728e+00, 1.4503e+00, 8.0621e-01, 7.1869e-01,
         7.6413e-01, 1.4002e+00, 4.0366e+05, 8.1619e-01, 4.0110e+05, 0.0000e+00,
         6.9858e-01, 1.2540e+00, 3.9756e+05, 1.4086e+00],
        [3.8153e+05, 9.9479e-01, 1.5588e+00, 1.6296e+00, 7.5677e-01, 6.7417e-01,
         6.9728e-01, 1.5892e+00, 4.0367e+05, 8.0548e-01, 4.0111e+05, 6.9858e-01,
         0.0000e+00, 1.4290e+00, 3.9756e+05, 1.6828e+00],
        [3.8154e+05, 1.1969e+00, 1.0938e+00, 1.1055e+00, 1.2335e+00, 1.2799e+00,
         1.2656e+00, 1.1018e+00, 4.0367e+05, 1.2125e+00, 4.0113e+05, 1.2540e+00,
         1.4290e+00, 0.0000e+00, 3.9756e+05, 1.0764e+00],
        [7.7843e+05, 3.9758e+05, 3.9757e+05, 3.9754e+05, 3.9757e+05, 3.9755e+05,
         3.9756e+05, 3.9755e+05, 8.0077e+05, 3.9756e+05, 7.9437e+05, 3.9756e+05,
         3.9756e+05, 3.9756e+05, 0.0000e+00, 3.9757e+05],
        [3.8155e+05, 1.3106e+00, 1.1399e+00, 1.0363e+00, 1.4219e+00, 1.4403e+00,
         1.3817e+00, 1.0361e+00, 4.0368e+05, 1.3425e+00, 4.0115e+05, 1.4086e+00,
         1.6828e+00, 1.0764e+00, 3.9757e+05, 0.0000e+00]])
Krum scores: ['381536.31', '1.10', '1.23', '1.25', '1.04', '1.01', '1.01', '1.24', '403670.72', '1.01', '401120.44', '1.02', '1.08', '1.18', '397558.22', '1.26']
Selected index: 6
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Chosen Update']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 5, 3, 8, 6, 2, 10, 4, 18, 12, 13, 11, 9, 1, 15, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:02...
global Accuracy on shared test data: 72.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[159  78]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:02, End: 2025-07-22 16:03:02)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 19, 8, 11, 14, 10, 15, 3, 7, 1, 13, 20, 18, 5, 17, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8888e+05, 1.1195e+00, 7.1885e-01, 4.0330e+05, 8.8709e-01,
         3.8792e+05, 1.0688e+00, 1.1687e+00, 1.0460e+00, 3.9760e+05, 4.0491e+05,
         4.0969e+05, 8.4743e-01, 3.9338e+05, 7.3585e-01],
        [3.8888e+05, 0.0000e+00, 3.8886e+05, 3.8885e+05, 8.1150e+05, 3.8886e+05,
         7.4697e+05, 3.8888e+05, 3.8886e+05, 3.8886e+05, 7.8682e+05, 7.8321e+05,
         7.9092e+05, 3.8884e+05, 7.8480e+05, 3.8885e+05],
        [1.1195e+00, 3.8886e+05, 0.0000e+00, 1.2053e+00, 4.0331e+05, 1.7159e+00,
         3.8792e+05, 9.8357e-01, 9.2072e-01, 9.6052e-01, 3.9759e+05, 4.0491e+05,
         4.0965e+05, 1.0216e+00, 3.9337e+05, 1.1367e+00],
        [7.1885e-01, 3.8885e+05, 1.2053e+00, 0.0000e+00, 4.0329e+05, 8.2191e-01,
         3.8795e+05, 1.1429e+00, 1.1801e+00, 1.0470e+00, 3.9761e+05, 4.0490e+05,
         4.0967e+05, 7.8849e-01, 3.9337e+05, 7.1449e-01],
        [4.0330e+05, 8.1150e+05, 4.0331e+05, 4.0329e+05, 0.0000e+00, 4.0329e+05,
         7.8747e+05, 4.0331e+05, 4.0330e+05, 4.0332e+05, 8.0869e+05, 7.8775e+05,
         8.0611e+05, 4.0333e+05, 7.9446e+05, 4.0327e+05],
        [8.8709e-01, 3.8886e+05, 1.7159e+00, 8.2191e-01, 4.0329e+05, 0.0000e+00,
         3.8795e+05, 1.6295e+00, 1.7393e+00, 1.5577e+00, 3.9760e+05, 4.0491e+05,
         4.0968e+05, 1.1531e+00, 3.9336e+05, 8.8419e-01],
        [3.8792e+05, 7.4697e+05, 3.8792e+05, 3.8795e+05, 7.8747e+05, 3.8795e+05,
         0.0000e+00, 3.8795e+05, 3.8791e+05, 3.8793e+05, 8.0032e+05, 7.9059e+05,
         8.2816e+05, 3.8794e+05, 7.8162e+05, 3.8793e+05],
        [1.0688e+00, 3.8888e+05, 9.8357e-01, 1.1429e+00, 4.0331e+05, 1.6295e+00,
         3.8795e+05, 0.0000e+00, 9.7654e-01, 9.0823e-01, 3.9761e+05, 4.0491e+05,
         4.0965e+05, 9.6421e-01, 3.9334e+05, 1.1228e+00],
        [1.1687e+00, 3.8886e+05, 9.2072e-01, 1.1801e+00, 4.0330e+05, 1.7393e+00,
         3.8791e+05, 9.7654e-01, 0.0000e+00, 9.1761e-01, 3.9758e+05, 4.0490e+05,
         4.0963e+05, 1.0109e+00, 3.9337e+05, 1.1943e+00],
        [1.0460e+00, 3.8886e+05, 9.6052e-01, 1.0470e+00, 4.0332e+05, 1.5577e+00,
         3.8793e+05, 9.0823e-01, 9.1761e-01, 0.0000e+00, 3.9761e+05, 4.0490e+05,
         4.0964e+05, 8.9021e-01, 3.9334e+05, 1.0163e+00],
        [3.9760e+05, 7.8682e+05, 3.9759e+05, 3.9761e+05, 8.0869e+05, 3.9760e+05,
         8.0032e+05, 3.9761e+05, 3.9758e+05, 3.9761e+05, 0.0000e+00, 8.1525e+05,
         8.1773e+05, 3.9760e+05, 8.0216e+05, 3.9759e+05],
        [4.0491e+05, 7.8321e+05, 4.0491e+05, 4.0490e+05, 7.8775e+05, 4.0491e+05,
         7.9059e+05, 4.0491e+05, 4.0490e+05, 4.0490e+05, 8.1525e+05, 0.0000e+00,
         8.1324e+05, 4.0491e+05, 8.1721e+05, 4.0489e+05],
        [4.0969e+05, 7.9092e+05, 4.0965e+05, 4.0967e+05, 8.0611e+05, 4.0968e+05,
         8.2816e+05, 4.0965e+05, 4.0963e+05, 4.0964e+05, 8.1773e+05, 8.1324e+05,
         0.0000e+00, 4.0966e+05, 8.1011e+05, 4.0968e+05],
        [8.4743e-01, 3.8884e+05, 1.0216e+00, 7.8849e-01, 4.0333e+05, 1.1531e+00,
         3.8794e+05, 9.6421e-01, 1.0109e+00, 8.9021e-01, 3.9760e+05, 4.0491e+05,
         4.0966e+05, 0.0000e+00, 3.9336e+05, 8.3677e-01],
        [3.9338e+05, 7.8480e+05, 3.9337e+05, 3.9337e+05, 7.9446e+05, 3.9336e+05,
         7.8162e+05, 3.9334e+05, 3.9337e+05, 3.9334e+05, 8.0216e+05, 8.1721e+05,
         8.1011e+05, 3.9336e+05, 0.0000e+00, 3.9336e+05],
        [7.3585e-01, 3.8885e+05, 1.1367e+00, 7.1449e-01, 4.0327e+05, 8.8419e-01,
         3.8793e+05, 1.1228e+00, 1.1943e+00, 1.0163e+00, 3.9759e+05, 4.0489e+05,
         4.0968e+05, 8.3677e-01, 3.9336e+05, 0.0000e+00]])
Krum scores: ['0.92', '388855.22', '1.05', '0.92', '403296.44', '1.24', '387929.41', '1.02', '1.05', '0.97', '397595.47', '404901.56', '409653.44', '0.91', '393356.69', '0.92']
Selected index: 13
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Chosen Update']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 19, 8, 11, 14, 10, 15, 3, 7, 1, 13, 20, 18, 5, 17, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0049s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:03...
global Accuracy on shared test data: 73.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[175  62]
 [ 70 193]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:03, End: 2025-07-22 16:03:03)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 11, 14, 5, 16, 8, 18, 12, 15, 2, 4, 10, 7, 19, 3, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8752e+05, 8.2702e+05, 3.8752e+05, 7.9564e+05, 3.8754e+05,
         7.8554e+05, 3.8753e+05, 7.9122e+05, 3.8754e+05, 3.8752e+05, 3.8753e+05,
         3.8752e+05, 7.7911e+05, 3.8751e+05, 3.8751e+05],
        [3.8752e+05, 0.0000e+00, 4.0168e+05, 8.4353e-01, 3.9280e+05, 1.2792e+00,
         3.9360e+05, 8.0580e-01, 3.9284e+05, 7.2886e-01, 1.2567e+00, 7.5240e-01,
         1.2557e+00, 4.0287e+05, 1.2024e+00, 7.5067e-01],
        [8.2702e+05, 4.0168e+05, 0.0000e+00, 4.0167e+05, 8.0946e+05, 4.0166e+05,
         7.9293e+05, 4.0166e+05, 7.6600e+05, 4.0166e+05, 4.0166e+05, 4.0167e+05,
         4.0166e+05, 7.9276e+05, 4.0166e+05, 4.0167e+05],
        [3.8752e+05, 8.4353e-01, 4.0167e+05, 0.0000e+00, 3.9278e+05, 1.5758e+00,
         3.9357e+05, 9.9207e-01, 3.9284e+05, 9.3802e-01, 1.5012e+00, 7.7009e-01,
         1.5633e+00, 4.0286e+05, 1.4603e+00, 9.5592e-01],
        [7.9564e+05, 3.9280e+05, 8.0946e+05, 3.9278e+05, 0.0000e+00, 3.9276e+05,
         7.9940e+05, 3.9278e+05, 7.7571e+05, 3.9278e+05, 3.9280e+05, 3.9279e+05,
         3.9278e+05, 7.9890e+05, 3.9276e+05, 3.9276e+05],
        [3.8754e+05, 1.2792e+00, 4.0166e+05, 1.5758e+00, 3.9276e+05, 0.0000e+00,
         3.9363e+05, 1.1853e+00, 3.9288e+05, 1.2179e+00, 9.7398e-01, 1.5322e+00,
         9.7295e-01, 4.0289e+05, 1.0309e+00, 1.1531e+00],
        [7.8554e+05, 3.9360e+05, 7.9293e+05, 3.9357e+05, 7.9940e+05, 3.9363e+05,
         0.0000e+00, 3.9365e+05, 7.7596e+05, 3.9362e+05, 3.9364e+05, 3.9359e+05,
         3.9359e+05, 7.8823e+05, 3.9359e+05, 3.9361e+05],
        [3.8753e+05, 8.0580e-01, 4.0166e+05, 9.9207e-01, 3.9278e+05, 1.1853e+00,
         3.9365e+05, 0.0000e+00, 3.9283e+05, 7.6251e-01, 1.1830e+00, 8.1084e-01,
         1.2507e+00, 4.0289e+05, 1.1295e+00, 7.8037e-01],
        [7.9122e+05, 3.9284e+05, 7.6600e+05, 3.9284e+05, 7.7571e+05, 3.9288e+05,
         7.7596e+05, 3.9283e+05, 0.0000e+00, 3.9287e+05, 3.9287e+05, 3.9281e+05,
         3.9286e+05, 7.8413e+05, 3.9286e+05, 3.9283e+05],
        [3.8754e+05, 7.2886e-01, 4.0166e+05, 9.3802e-01, 3.9278e+05, 1.2179e+00,
         3.9362e+05, 7.6251e-01, 3.9287e+05, 0.0000e+00, 1.2608e+00, 6.9234e-01,
         1.2904e+00, 4.0288e+05, 1.1784e+00, 7.1761e-01],
        [3.8752e+05, 1.2567e+00, 4.0166e+05, 1.5012e+00, 3.9280e+05, 9.7398e-01,
         3.9364e+05, 1.1830e+00, 3.9287e+05, 1.2608e+00, 0.0000e+00, 1.5999e+00,
         9.7684e-01, 4.0287e+05, 1.0320e+00, 1.1547e+00],
        [3.8753e+05, 7.5240e-01, 4.0167e+05, 7.7009e-01, 3.9279e+05, 1.5322e+00,
         3.9359e+05, 8.1084e-01, 3.9281e+05, 6.9234e-01, 1.5999e+00, 0.0000e+00,
         1.5808e+00, 4.0289e+05, 1.4753e+00, 7.8897e-01],
        [3.8752e+05, 1.2557e+00, 4.0166e+05, 1.5633e+00, 3.9278e+05, 9.7295e-01,
         3.9359e+05, 1.2507e+00, 3.9286e+05, 1.2904e+00, 9.7684e-01, 1.5808e+00,
         0.0000e+00, 4.0285e+05, 1.0752e+00, 1.2246e+00],
        [7.7911e+05, 4.0287e+05, 7.9276e+05, 4.0286e+05, 7.9890e+05, 4.0289e+05,
         7.8823e+05, 4.0289e+05, 7.8413e+05, 4.0288e+05, 4.0287e+05, 4.0289e+05,
         4.0285e+05, 0.0000e+00, 4.0285e+05, 4.0288e+05],
        [3.8751e+05, 1.2024e+00, 4.0166e+05, 1.4603e+00, 3.9276e+05, 1.0309e+00,
         3.9359e+05, 1.1295e+00, 3.9286e+05, 1.1784e+00, 1.0320e+00, 1.4753e+00,
         1.0752e+00, 4.0285e+05, 0.0000e+00, 1.1319e+00],
        [3.8751e+05, 7.5067e-01, 4.0167e+05, 9.5592e-01, 3.9276e+05, 1.1531e+00,
         3.9361e+05, 7.8037e-01, 3.9283e+05, 7.1761e-01, 1.1547e+00, 7.8897e-01,
         1.2246e+00, 4.0288e+05, 1.1319e+00, 0.0000e+00]])
Krum scores: ['387519.97', '0.95', '401662.75', '1.13', '392776.19', '1.17', '393602.94', '0.96', '392840.75', '0.94', '1.17', '1.05', '1.20', '402866.88', '1.16', '0.93']
Selected index: 15
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Chosen Update']], selected_client_indices: [13, 11, 14, 5, 16, 8, 18, 12, 15, 2, 4, 10, 7, 19, 3, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0190s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:04...
global Accuracy on shared test data: 71.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[173  64]
 [ 81 182]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:04, End: 2025-07-22 16:03:04)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 8, 9, 3, 4, 13, 6, 1, 16, 14, 11, 2, 12, 10, 5, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 9.0048e-01, 1.4369e+00, 9.7039e-01, 9.1835e-01, 4.0257e+05,
         1.6882e+00, 9.3818e-01, 3.9185e+05, 3.7618e+05, 1.1594e+00, 1.1984e+00,
         1.1611e+00, 1.3876e+00, 1.2025e+00, 3.9021e+05],
        [9.0048e-01, 0.0000e+00, 1.3832e+00, 9.6124e-01, 9.3939e-01, 4.0256e+05,
         1.6573e+00, 9.6044e-01, 3.9183e+05, 3.7616e+05, 1.1974e+00, 1.1919e+00,
         1.1200e+00, 1.3956e+00, 1.2256e+00, 3.9021e+05],
        [1.4369e+00, 1.3832e+00, 0.0000e+00, 1.3410e+00, 1.4010e+00, 4.0261e+05,
         6.4639e-01, 1.2454e+00, 3.9182e+05, 3.7617e+05, 6.8806e-01, 6.5068e-01,
         7.3788e-01, 5.4140e-01, 6.6379e-01, 3.9021e+05],
        [9.7039e-01, 9.6124e-01, 1.3410e+00, 0.0000e+00, 9.7898e-01, 4.0255e+05,
         1.5673e+00, 9.3018e-01, 3.9182e+05, 3.7618e+05, 1.1347e+00, 1.1357e+00,
         1.0908e+00, 1.3280e+00, 1.1393e+00, 3.9024e+05],
        [9.1835e-01, 9.3939e-01, 1.4010e+00, 9.7898e-01, 0.0000e+00, 4.0256e+05,
         1.6325e+00, 9.6843e-01, 3.9187e+05, 3.7617e+05, 1.2080e+00, 1.2238e+00,
         1.1275e+00, 1.4513e+00, 1.1899e+00, 3.9021e+05],
        [4.0257e+05, 4.0256e+05, 4.0261e+05, 4.0255e+05, 4.0256e+05, 0.0000e+00,
         4.0259e+05, 4.0257e+05, 8.0745e+05, 7.9084e+05, 4.0259e+05, 4.0261e+05,
         4.0258e+05, 4.0262e+05, 4.0259e+05, 7.8246e+05],
        [1.6882e+00, 1.6573e+00, 6.4639e-01, 1.5673e+00, 1.6325e+00, 4.0259e+05,
         0.0000e+00, 1.4482e+00, 3.9185e+05, 3.7618e+05, 8.7114e-01, 8.1226e-01,
         9.2467e-01, 6.7439e-01, 8.1956e-01, 3.9022e+05],
        [9.3818e-01, 9.6044e-01, 1.2454e+00, 9.3018e-01, 9.6843e-01, 4.0257e+05,
         1.4482e+00, 0.0000e+00, 3.9183e+05, 3.7618e+05, 1.0320e+00, 1.0603e+00,
         1.0265e+00, 1.2620e+00, 1.0672e+00, 3.9024e+05],
        [3.9185e+05, 3.9183e+05, 3.9182e+05, 3.9182e+05, 3.9187e+05, 8.0745e+05,
         3.9185e+05, 3.9183e+05, 0.0000e+00, 7.6603e+05, 3.9183e+05, 3.9184e+05,
         3.9183e+05, 3.9185e+05, 3.9182e+05, 7.8844e+05],
        [3.7618e+05, 3.7616e+05, 3.7617e+05, 3.7618e+05, 3.7617e+05, 7.9084e+05,
         3.7618e+05, 3.7618e+05, 7.6603e+05, 0.0000e+00, 3.7615e+05, 3.7616e+05,
         3.7619e+05, 3.7615e+05, 3.7616e+05, 7.6693e+05],
        [1.1594e+00, 1.1974e+00, 6.8806e-01, 1.1347e+00, 1.2080e+00, 4.0259e+05,
         8.7114e-01, 1.0320e+00, 3.9183e+05, 3.7615e+05, 0.0000e+00, 7.1011e-01,
         7.4083e-01, 6.9703e-01, 6.7667e-01, 3.9021e+05],
        [1.1984e+00, 1.1919e+00, 6.5068e-01, 1.1357e+00, 1.2238e+00, 4.0261e+05,
         8.1226e-01, 1.0603e+00, 3.9184e+05, 3.7616e+05, 7.1011e-01, 0.0000e+00,
         7.1962e-01, 6.3333e-01, 7.4467e-01, 3.9021e+05],
        [1.1611e+00, 1.1200e+00, 7.3788e-01, 1.0908e+00, 1.1275e+00, 4.0258e+05,
         9.2467e-01, 1.0265e+00, 3.9183e+05, 3.7619e+05, 7.4083e-01, 7.1962e-01,
         0.0000e+00, 7.3236e-01, 7.7094e-01, 3.9021e+05],
        [1.3876e+00, 1.3956e+00, 5.4140e-01, 1.3280e+00, 1.4513e+00, 4.0262e+05,
         6.7439e-01, 1.2620e+00, 3.9185e+05, 3.7615e+05, 6.9703e-01, 6.3333e-01,
         7.3236e-01, 0.0000e+00, 6.6055e-01, 3.9023e+05],
        [1.2025e+00, 1.2256e+00, 6.6379e-01, 1.1393e+00, 1.1899e+00, 4.0259e+05,
         8.1956e-01, 1.0672e+00, 3.9182e+05, 3.7616e+05, 6.7667e-01, 7.4467e-01,
         7.7094e-01, 6.6055e-01, 0.0000e+00, 3.9018e+05],
        [3.9021e+05, 3.9021e+05, 3.9021e+05, 3.9024e+05, 3.9021e+05, 7.8246e+05,
         3.9022e+05, 3.9024e+05, 7.8844e+05, 7.6693e+05, 3.9021e+05, 3.9021e+05,
         3.9021e+05, 3.9023e+05, 3.9018e+05, 0.0000e+00]])
Krum scores: ['1.13', '1.13', '0.93', '1.10', '1.14', '402577.44', '1.11', '1.05', '391832.88', '376166.75', '0.89', '0.89', '0.90', '0.93', '0.89', '390211.09']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 8, 9, 3, 4, 13, 6, 1, 16, 14, 11, 2, 12, 10, 5, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0156s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:04...
global Accuracy on shared test data: 73.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[180  57]
 [ 77 186]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:04, End: 2025-07-22 16:03:04)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 10, 11, 18, 16, 6, 15, 4, 2, 20, 5, 17, 3, 1, 12, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 5.1985e-01, 6.3382e-01, 3.8973e+05, 3.8055e+05, 5.6679e-01,
         4.0413e+05, 1.2272e+00, 5.8418e-01, 3.8343e+05, 6.5644e-01, 3.8622e+05,
         1.1765e+00, 1.0986e+00, 6.5849e-01, 3.9536e+05],
        [5.1985e-01, 0.0000e+00, 6.6917e-01, 3.8972e+05, 3.8056e+05, 6.0080e-01,
         4.0414e+05, 1.3428e+00, 5.6384e-01, 3.8344e+05, 6.8231e-01, 3.8622e+05,
         1.2391e+00, 1.1886e+00, 6.8428e-01, 3.9534e+05],
        [6.3382e-01, 6.6917e-01, 0.0000e+00, 3.8973e+05, 3.8055e+05, 7.3514e-01,
         4.0413e+05, 1.1115e+00, 7.9761e-01, 3.8344e+05, 6.6031e-01, 3.8621e+05,
         1.0668e+00, 9.5705e-01, 6.9597e-01, 3.9534e+05],
        [3.8973e+05, 3.8972e+05, 3.8973e+05, 0.0000e+00, 7.8452e+05, 3.8973e+05,
         7.8205e+05, 3.8968e+05, 3.8975e+05, 7.6772e+05, 3.8972e+05, 7.8002e+05,
         3.8971e+05, 3.8972e+05, 3.8972e+05, 7.9311e+05],
        [3.8055e+05, 3.8056e+05, 3.8055e+05, 7.8452e+05, 0.0000e+00, 3.8056e+05,
         7.8600e+05, 3.8057e+05, 3.8057e+05, 7.7222e+05, 3.8054e+05, 7.6239e+05,
         3.8052e+05, 3.8056e+05, 3.8057e+05, 7.5709e+05],
        [5.6679e-01, 6.0080e-01, 7.3514e-01, 3.8973e+05, 3.8056e+05, 0.0000e+00,
         4.0414e+05, 1.3152e+00, 6.1706e-01, 3.8344e+05, 7.0952e-01, 3.8621e+05,
         1.2849e+00, 1.1790e+00, 7.5966e-01, 3.9534e+05],
        [4.0413e+05, 4.0414e+05, 4.0413e+05, 7.8205e+05, 7.8600e+05, 4.0414e+05,
         0.0000e+00, 4.0410e+05, 4.0412e+05, 7.8722e+05, 4.0414e+05, 7.8304e+05,
         4.0412e+05, 4.0411e+05, 4.0414e+05, 7.9877e+05],
        [1.2272e+00, 1.3428e+00, 1.1115e+00, 3.8968e+05, 3.8057e+05, 1.3152e+00,
         4.0410e+05, 0.0000e+00, 1.6088e+00, 3.8344e+05, 1.0375e+00, 3.8618e+05,
         9.4970e-01, 9.3127e-01, 1.0245e+00, 3.9536e+05],
        [5.8418e-01, 5.6384e-01, 7.9761e-01, 3.8975e+05, 3.8057e+05, 6.1706e-01,
         4.0412e+05, 1.6088e+00, 0.0000e+00, 3.8344e+05, 8.3621e-01, 3.8620e+05,
         1.5335e+00, 1.4223e+00, 8.3392e-01, 3.9536e+05],
        [3.8343e+05, 3.8344e+05, 3.8344e+05, 7.6772e+05, 7.7222e+05, 3.8344e+05,
         7.8722e+05, 3.8344e+05, 3.8344e+05, 0.0000e+00, 3.8344e+05, 7.6698e+05,
         3.8343e+05, 3.8343e+05, 3.8343e+05, 7.7253e+05],
        [6.5644e-01, 6.8231e-01, 6.6031e-01, 3.8972e+05, 3.8054e+05, 7.0952e-01,
         4.0414e+05, 1.0375e+00, 8.3621e-01, 3.8344e+05, 0.0000e+00, 3.8621e+05,
         1.0356e+00, 9.4452e-01, 7.4567e-01, 3.9536e+05],
        [3.8622e+05, 3.8622e+05, 3.8621e+05, 7.8002e+05, 7.6239e+05, 3.8621e+05,
         7.8304e+05, 3.8618e+05, 3.8620e+05, 7.6698e+05, 3.8621e+05, 0.0000e+00,
         3.8616e+05, 3.8620e+05, 3.8619e+05, 8.0296e+05],
        [1.1765e+00, 1.2391e+00, 1.0668e+00, 3.8971e+05, 3.8052e+05, 1.2849e+00,
         4.0412e+05, 9.4970e-01, 1.5335e+00, 3.8343e+05, 1.0356e+00, 3.8616e+05,
         0.0000e+00, 9.1769e-01, 1.0282e+00, 3.9539e+05],
        [1.0986e+00, 1.1886e+00, 9.5705e-01, 3.8972e+05, 3.8056e+05, 1.1790e+00,
         4.0411e+05, 9.3127e-01, 1.4223e+00, 3.8343e+05, 9.4452e-01, 3.8620e+05,
         9.1769e-01, 0.0000e+00, 9.6837e-01, 3.9536e+05],
        [6.5849e-01, 6.8428e-01, 6.9597e-01, 3.8972e+05, 3.8057e+05, 7.5966e-01,
         4.0414e+05, 1.0245e+00, 8.3392e-01, 3.8343e+05, 7.4567e-01, 3.8619e+05,
         1.0282e+00, 9.6837e-01, 0.0000e+00, 3.9536e+05],
        [3.9536e+05, 3.9534e+05, 3.9534e+05, 7.9311e+05, 7.5709e+05, 3.9534e+05,
         7.9877e+05, 3.9536e+05, 3.9536e+05, 7.7253e+05, 3.9536e+05, 8.0296e+05,
         3.9539e+05, 3.9536e+05, 3.9536e+05, 0.0000e+00]])
Krum scores: ['0.74', '0.77', '0.78', '389716.38', '380550.59', '0.81', '404123.75', '1.12', '0.90', '383436.38', '0.78', '386193.88', '1.09', '1.02', '0.80', '395351.00']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 10, 11, 18, 16, 6, 15, 4, 2, 20, 5, 17, 3, 1, 12, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0043s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:05...
global Accuracy on shared test data: 74.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:05, End: 2025-07-22 16:03:05)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 16, 2, 4, 20, 5, 19, 11, 9, 1, 12, 15, 13, 6, 14, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.8923e+05, 4.4059e-01, 1.1867e+00, 3.9113e+05, 6.2144e-01,
         3.8827e+05, 5.8925e-01, 5.6411e-01, 1.0636e+00, 6.3484e-01, 4.0321e+05,
         4.0092e+05, 5.2168e-01, 3.9081e+05, 3.9163e+05],
        [3.8923e+05, 0.0000e+00, 3.8924e+05, 3.8925e+05, 7.8962e+05, 3.8924e+05,
         7.7523e+05, 3.8923e+05, 3.8924e+05, 3.8926e+05, 3.8924e+05, 7.8483e+05,
         7.9203e+05, 3.8922e+05, 7.7227e+05, 7.9620e+05],
        [4.4059e-01, 3.8924e+05, 0.0000e+00, 1.2241e+00, 3.9116e+05, 6.5748e-01,
         3.8830e+05, 6.0648e-01, 5.1399e-01, 1.0983e+00, 6.6047e-01, 4.0320e+05,
         4.0093e+05, 4.9960e-01, 3.9078e+05, 3.9164e+05],
        [1.1867e+00, 3.8925e+05, 1.2241e+00, 0.0000e+00, 3.9112e+05, 8.9102e-01,
         3.8830e+05, 9.8262e-01, 1.6672e+00, 8.8376e-01, 9.6492e-01, 4.0319e+05,
         4.0088e+05, 1.0723e+00, 3.9080e+05, 3.9162e+05],
        [3.9113e+05, 7.8962e+05, 3.9116e+05, 3.9112e+05, 0.0000e+00, 3.9116e+05,
         7.7934e+05, 3.9114e+05, 3.9116e+05, 3.9112e+05, 3.9113e+05, 7.9487e+05,
         7.8663e+05, 3.9114e+05, 7.7289e+05, 7.9179e+05],
        [6.2144e-01, 3.8924e+05, 6.5748e-01, 8.9102e-01, 3.9116e+05, 0.0000e+00,
         3.8829e+05, 5.7632e-01, 8.8314e-01, 8.5998e-01, 6.9626e-01, 4.0321e+05,
         4.0092e+05, 6.0902e-01, 3.9081e+05, 3.9162e+05],
        [3.8827e+05, 7.7523e+05, 3.8830e+05, 3.8830e+05, 7.7934e+05, 3.8829e+05,
         0.0000e+00, 3.8828e+05, 3.8832e+05, 3.8831e+05, 3.8828e+05, 7.8881e+05,
         7.7293e+05, 3.8829e+05, 8.0075e+05, 7.7576e+05],
        [5.8925e-01, 3.8923e+05, 6.0648e-01, 9.8262e-01, 3.9114e+05, 5.7632e-01,
         3.8828e+05, 0.0000e+00, 8.2421e-01, 8.9715e-01, 6.5010e-01, 4.0320e+05,
         4.0091e+05, 6.0680e-01, 3.9079e+05, 3.9163e+05],
        [5.6411e-01, 3.8924e+05, 5.1399e-01, 1.6672e+00, 3.9116e+05, 8.8314e-01,
         3.8832e+05, 8.2421e-01, 0.0000e+00, 1.5403e+00, 8.9378e-01, 4.0320e+05,
         4.0095e+05, 6.6228e-01, 3.9079e+05, 3.9163e+05],
        [1.0636e+00, 3.8926e+05, 1.0983e+00, 8.8376e-01, 3.9112e+05, 8.5998e-01,
         3.8831e+05, 8.9715e-01, 1.5403e+00, 0.0000e+00, 9.1702e-01, 4.0321e+05,
         4.0090e+05, 9.7692e-01, 3.9079e+05, 3.9163e+05],
        [6.3484e-01, 3.8924e+05, 6.6047e-01, 9.6492e-01, 3.9113e+05, 6.9626e-01,
         3.8828e+05, 6.5010e-01, 8.9378e-01, 9.1702e-01, 0.0000e+00, 4.0320e+05,
         4.0090e+05, 6.6720e-01, 3.9080e+05, 3.9161e+05],
        [4.0321e+05, 7.8483e+05, 4.0320e+05, 4.0319e+05, 7.9487e+05, 4.0321e+05,
         7.8881e+05, 4.0320e+05, 4.0320e+05, 4.0321e+05, 4.0320e+05, 0.0000e+00,
         8.0773e+05, 4.0322e+05, 7.8615e+05, 7.8453e+05],
        [4.0092e+05, 7.9203e+05, 4.0093e+05, 4.0088e+05, 7.8663e+05, 4.0092e+05,
         7.7293e+05, 4.0091e+05, 4.0095e+05, 4.0090e+05, 4.0090e+05, 8.0773e+05,
         0.0000e+00, 4.0093e+05, 7.9238e+05, 7.8378e+05],
        [5.2168e-01, 3.8922e+05, 4.9960e-01, 1.0723e+00, 3.9114e+05, 6.0902e-01,
         3.8829e+05, 6.0680e-01, 6.6228e-01, 9.7692e-01, 6.6720e-01, 4.0322e+05,
         4.0093e+05, 0.0000e+00, 3.9079e+05, 3.9165e+05],
        [3.9081e+05, 7.7227e+05, 3.9078e+05, 3.9080e+05, 7.7289e+05, 3.9081e+05,
         8.0075e+05, 3.9079e+05, 3.9079e+05, 3.9079e+05, 3.9080e+05, 7.8615e+05,
         7.9238e+05, 3.9079e+05, 0.0000e+00, 7.9350e+05],
        [3.9163e+05, 7.9620e+05, 3.9164e+05, 3.9162e+05, 7.9179e+05, 3.9162e+05,
         7.7576e+05, 3.9163e+05, 3.9163e+05, 3.9163e+05, 3.9161e+05, 7.8453e+05,
         7.8378e+05, 3.9165e+05, 7.9350e+05, 0.0000e+00]])
Krum scores: ['0.63', '389234.34', '0.64', '1.03', '391132.31', '0.70', '388288.91', '0.68', '0.84', '0.96', '0.73', '403200.28', '400910.06', '0.65', '390789.53', '391623.50']
Selected index: 0
krum, clients_type: [['Chosen Update']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 16, 2, 4, 20, 5, 19, 11, 9, 1, 12, 15, 13, 6, 14, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0044s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:05...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [ 65 198]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:05, End: 2025-07-22 16:03:05)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 18, 2, 15, 4, 12, 3, 11, 7, 5, 20, 6, 1, 9, 8, 17], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 7.9088e+05, 3.9091e+05, 7.6590e+05, 3.9092e+05, 3.9092e+05,
         3.9092e+05, 3.9094e+05, 3.9091e+05, 3.9091e+05, 7.6683e+05, 3.9092e+05,
         3.9092e+05, 3.9090e+05, 3.9091e+05, 7.8303e+05],
        [7.9088e+05, 0.0000e+00, 3.9473e+05, 7.8006e+05, 3.9474e+05, 3.9472e+05,
         3.9475e+05, 3.9471e+05, 3.9473e+05, 3.9474e+05, 7.8437e+05, 3.9474e+05,
         3.9473e+05, 3.9473e+05, 3.9475e+05, 7.9434e+05],
        [3.9091e+05, 3.9473e+05, 0.0000e+00, 3.9142e+05, 1.1402e+00, 5.9450e-01,
         1.0621e+00, 5.8253e-01, 1.1120e+00, 6.3328e-01, 3.8820e+05, 4.4314e-01,
         1.0050e+00, 3.1565e-01, 1.0916e+00, 3.8913e+05],
        [7.6590e+05, 7.8006e+05, 3.9142e+05, 0.0000e+00, 3.9141e+05, 3.9140e+05,
         3.9143e+05, 3.9141e+05, 3.9141e+05, 3.9140e+05, 7.6442e+05, 3.9141e+05,
         3.9141e+05, 3.9142e+05, 3.9143e+05, 7.7531e+05],
        [3.9092e+05, 3.9474e+05, 1.1402e+00, 3.9141e+05, 0.0000e+00, 9.3874e-01,
         8.8046e-01, 9.7953e-01, 8.0965e-01, 8.8911e-01, 3.8816e+05, 1.0055e+00,
         8.7292e-01, 1.1830e+00, 8.1282e-01, 3.8917e+05],
        [3.9092e+05, 3.9472e+05, 5.9450e-01, 3.9140e+05, 9.3874e-01, 0.0000e+00,
         9.0013e-01, 6.3679e-01, 9.5372e-01, 6.7995e-01, 3.8818e+05, 6.1003e-01,
         8.8198e-01, 5.9911e-01, 9.2657e-01, 3.8914e+05],
        [3.9092e+05, 3.9475e+05, 1.0621e+00, 3.9143e+05, 8.8046e-01, 9.0013e-01,
         0.0000e+00, 9.4718e-01, 9.0004e-01, 8.7822e-01, 3.8819e+05, 9.5793e-01,
         8.5643e-01, 1.1005e+00, 8.9532e-01, 3.8916e+05],
        [3.9094e+05, 3.9471e+05, 5.8253e-01, 3.9141e+05, 9.7953e-01, 6.3679e-01,
         9.4718e-01, 0.0000e+00, 9.4564e-01, 5.8967e-01, 3.8819e+05, 5.6332e-01,
         8.5310e-01, 5.4694e-01, 9.4567e-01, 3.8913e+05],
        [3.9091e+05, 3.9473e+05, 1.1120e+00, 3.9141e+05, 8.0965e-01, 9.5372e-01,
         9.0004e-01, 9.4564e-01, 0.0000e+00, 9.0651e-01, 3.8817e+05, 1.0194e+00,
         8.6221e-01, 1.1475e+00, 8.0657e-01, 3.8915e+05],
        [3.9091e+05, 3.9474e+05, 6.3328e-01, 3.9140e+05, 8.8911e-01, 6.7995e-01,
         8.7822e-01, 5.8967e-01, 9.0651e-01, 0.0000e+00, 3.8818e+05, 5.9590e-01,
         8.1629e-01, 6.0355e-01, 9.0494e-01, 3.8916e+05],
        [7.6683e+05, 7.8437e+05, 3.8820e+05, 7.6442e+05, 3.8816e+05, 3.8818e+05,
         3.8819e+05, 3.8819e+05, 3.8817e+05, 3.8818e+05, 0.0000e+00, 3.8817e+05,
         3.8819e+05, 3.8819e+05, 3.8820e+05, 7.8974e+05],
        [3.9092e+05, 3.9474e+05, 4.4314e-01, 3.9141e+05, 1.0055e+00, 6.1003e-01,
         9.5793e-01, 5.6332e-01, 1.0194e+00, 5.9590e-01, 3.8817e+05, 0.0000e+00,
         9.0733e-01, 4.2272e-01, 9.8126e-01, 3.8914e+05],
        [3.9092e+05, 3.9473e+05, 1.0050e+00, 3.9141e+05, 8.7292e-01, 8.8198e-01,
         8.5643e-01, 8.5310e-01, 8.6221e-01, 8.1629e-01, 3.8819e+05, 9.0733e-01,
         0.0000e+00, 1.0382e+00, 8.6375e-01, 3.8916e+05],
        [3.9090e+05, 3.9473e+05, 3.1565e-01, 3.9142e+05, 1.1830e+00, 5.9911e-01,
         1.1005e+00, 5.4694e-01, 1.1475e+00, 6.0355e-01, 3.8819e+05, 4.2272e-01,
         1.0382e+00, 0.0000e+00, 1.1209e+00, 3.8913e+05],
        [3.9091e+05, 3.9475e+05, 1.0916e+00, 3.9143e+05, 8.1282e-01, 9.2657e-01,
         8.9532e-01, 9.4567e-01, 8.0657e-01, 9.0494e-01, 3.8820e+05, 9.8126e-01,
         8.6375e-01, 1.1209e+00, 0.0000e+00, 3.8914e+05],
        [7.8303e+05, 7.9434e+05, 3.8913e+05, 7.7531e+05, 3.8917e+05, 3.8914e+05,
         3.8916e+05, 3.8913e+05, 3.8915e+05, 3.8916e+05, 7.8974e+05, 3.8914e+05,
         3.8916e+05, 3.8913e+05, 3.8914e+05, 0.0000e+00]])
Krum scores: ['390913.12', '394730.81', '0.76', '391410.38', '0.93', '0.75', '0.92', '0.73', '0.92', '0.73', '388180.84', '0.72', '0.88', '0.77', '0.91', '389140.25']
Selected index: 11
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Chosen Update']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 18, 2, 15, 4, 12, 3, 11, 7, 5, 20, 6, 1, 9, 8, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0048s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:06...
global Accuracy on shared test data: 72.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:06, End: 2025-07-22 16:03:06)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 20, 18, 7, 14, 3, 9, 15, 5, 8, 1, 4, 11, 6, 17, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9468e+05, 3.8222e+05, 1.2266e+00, 3.9773e+05, 1.0857e+00,
         2.8158e-01, 3.8400e+05, 6.3187e-01, 1.1429e+00, 1.0880e+00, 1.2559e+00,
         5.8325e-01, 4.1213e-01, 3.9299e+05, 3.8830e+05],
        [3.9468e+05, 0.0000e+00, 7.6543e+05, 3.9469e+05, 8.0180e+05, 3.9468e+05,
         3.9469e+05, 7.8715e+05, 3.9469e+05, 3.9468e+05, 3.9470e+05, 3.9468e+05,
         3.9469e+05, 3.9468e+05, 7.7735e+05, 7.7670e+05],
        [3.8222e+05, 7.6543e+05, 0.0000e+00, 3.8223e+05, 7.8684e+05, 3.8222e+05,
         3.8219e+05, 7.8744e+05, 3.8220e+05, 3.8221e+05, 3.8221e+05, 3.8223e+05,
         3.8221e+05, 3.8221e+05, 7.6992e+05, 7.8081e+05],
        [1.2266e+00, 3.9469e+05, 3.8223e+05, 0.0000e+00, 3.9773e+05, 9.1389e-01,
         1.2256e+00, 3.8403e+05, 9.6130e-01, 8.3709e-01, 8.6942e-01, 8.3640e-01,
         9.5280e-01, 1.5375e+00, 3.9302e+05, 3.8828e+05],
        [3.9773e+05, 8.0180e+05, 7.8684e+05, 3.9773e+05, 0.0000e+00, 3.9774e+05,
         3.9773e+05, 7.9330e+05, 3.9774e+05, 3.9773e+05, 3.9775e+05, 3.9771e+05,
         3.9773e+05, 3.9774e+05, 7.9657e+05, 7.7426e+05],
        [1.0857e+00, 3.9468e+05, 3.8222e+05, 9.1389e-01, 3.9774e+05, 0.0000e+00,
         1.0681e+00, 3.8400e+05, 8.7180e-01, 8.8161e-01, 8.7044e-01, 8.9511e-01,
         9.0021e-01, 1.3437e+00, 3.9299e+05, 3.8830e+05],
        [2.8158e-01, 3.9469e+05, 3.8219e+05, 1.2256e+00, 3.9773e+05, 1.0681e+00,
         0.0000e+00, 3.8401e+05, 6.1438e-01, 1.1063e+00, 1.0420e+00, 1.1718e+00,
         5.4858e-01, 3.9377e-01, 3.9300e+05, 3.8830e+05],
        [3.8400e+05, 7.8715e+05, 7.8744e+05, 3.8403e+05, 7.9330e+05, 3.8400e+05,
         3.8401e+05, 0.0000e+00, 3.8401e+05, 3.8402e+05, 3.8407e+05, 3.8401e+05,
         3.8400e+05, 3.8402e+05, 7.9151e+05, 7.6938e+05],
        [6.3187e-01, 3.9469e+05, 3.8220e+05, 9.6130e-01, 3.9774e+05, 8.7180e-01,
         6.1438e-01, 3.8401e+05, 0.0000e+00, 9.1188e-01, 8.4012e-01, 9.1276e-01,
         5.9275e-01, 8.3636e-01, 3.9298e+05, 3.8829e+05],
        [1.1429e+00, 3.9468e+05, 3.8221e+05, 8.3709e-01, 3.9773e+05, 8.8161e-01,
         1.1063e+00, 3.8402e+05, 9.1188e-01, 0.0000e+00, 8.6031e-01, 8.4338e-01,
         9.2836e-01, 1.4242e+00, 3.9299e+05, 3.8829e+05],
        [1.0880e+00, 3.9470e+05, 3.8221e+05, 8.6942e-01, 3.9775e+05, 8.7044e-01,
         1.0420e+00, 3.8407e+05, 8.4012e-01, 8.6031e-01, 0.0000e+00, 9.0021e-01,
         8.4080e-01, 1.3370e+00, 3.9298e+05, 3.8829e+05],
        [1.2559e+00, 3.9468e+05, 3.8223e+05, 8.3640e-01, 3.9771e+05, 8.9511e-01,
         1.1718e+00, 3.8401e+05, 9.1276e-01, 8.4338e-01, 9.0021e-01, 0.0000e+00,
         9.6268e-01, 1.4796e+00, 3.9299e+05, 3.8831e+05],
        [5.8325e-01, 3.9469e+05, 3.8221e+05, 9.5280e-01, 3.9773e+05, 9.0021e-01,
         5.4858e-01, 3.8400e+05, 5.9275e-01, 9.2836e-01, 8.4080e-01, 9.6268e-01,
         0.0000e+00, 7.8643e-01, 3.9298e+05, 3.8831e+05],
        [4.1213e-01, 3.9468e+05, 3.8221e+05, 1.5375e+00, 3.9774e+05, 1.3437e+00,
         3.9377e-01, 3.8402e+05, 8.3636e-01, 1.4242e+00, 1.3370e+00, 1.4796e+00,
         7.8643e-01, 0.0000e+00, 3.9300e+05, 3.8830e+05],
        [3.9299e+05, 7.7735e+05, 7.6992e+05, 3.9302e+05, 7.9657e+05, 3.9299e+05,
         3.9300e+05, 7.9151e+05, 3.9298e+05, 3.9299e+05, 3.9298e+05, 3.9299e+05,
         3.9298e+05, 3.9300e+05, 0.0000e+00, 7.7190e+05],
        [3.8830e+05, 7.7670e+05, 7.8081e+05, 3.8828e+05, 7.7426e+05, 3.8830e+05,
         3.8830e+05, 7.6938e+05, 3.8829e+05, 3.8829e+05, 3.8829e+05, 3.8831e+05,
         3.8831e+05, 3.8830e+05, 7.7190e+05, 0.0000e+00]])
Krum scores: ['0.81', '394682.88', '382209.41', '0.98', '397729.75', '0.94', '0.78', '384010.06', '0.78', '0.94', '0.91', '0.97', '0.77', '1.00', '392986.19', '388295.38']
Selected index: 12
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Chosen Update']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 20, 18, 7, 14, 3, 9, 15, 5, 8, 1, 4, 11, 6, 17, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0058s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:07...
global Accuracy on shared test data: 71.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [ 66 197]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:07, End: 2025-07-22 16:03:07)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 13, 18, 9, 4, 1, 16, 14, 20, 5, 17, 8, 6, 10, 12, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
tensor([[0.0000e+00, 3.9224e+05, 4.1083e+05, 3.7789e-01, 1.1872e+00, 1.0458e+00,
         3.9068e+05, 3.9579e+05, 3.8084e+05, 6.7710e-01, 3.6748e+05, 1.1752e+00,
         4.4455e-01, 4.0025e-01, 6.4103e-01, 3.9236e+05],
        [3.9224e+05, 0.0000e+00, 8.0271e+05, 3.9223e+05, 3.9220e+05, 3.9223e+05,
         7.6354e+05, 7.9598e+05, 7.7531e+05, 3.9222e+05, 7.2085e+05, 3.9220e+05,
         3.9223e+05, 3.9223e+05, 3.9222e+05, 7.9661e+05],
        [4.1083e+05, 8.0271e+05, 0.0000e+00, 4.1085e+05, 4.1082e+05, 4.1080e+05,
         7.9620e+05, 8.1898e+05, 7.7669e+05, 4.1082e+05, 7.6009e+05, 4.1081e+05,
         4.1084e+05, 4.1084e+05, 4.1085e+05, 8.1865e+05],
        [3.7789e-01, 3.9223e+05, 4.1085e+05, 0.0000e+00, 1.2620e+00, 1.1156e+00,
         3.9067e+05, 3.9581e+05, 3.8085e+05, 6.3292e-01, 3.6746e+05, 1.2539e+00,
         3.8213e-01, 3.2730e-01, 6.3755e-01, 3.9235e+05],
        [1.1872e+00, 3.9220e+05, 4.1082e+05, 1.2620e+00, 0.0000e+00, 8.8860e-01,
         3.9069e+05, 3.9583e+05, 3.8082e+05, 9.6619e-01, 3.6744e+05, 8.6181e-01,
         1.3418e+00, 1.3597e+00, 1.0097e+00, 3.9236e+05],
        [1.0458e+00, 3.9223e+05, 4.1080e+05, 1.1156e+00, 8.8860e-01, 0.0000e+00,
         3.9068e+05, 3.9582e+05, 3.8083e+05, 8.7096e-01, 3.6744e+05, 8.6932e-01,
         1.1969e+00, 1.1766e+00, 9.3544e-01, 3.9237e+05],
        [3.9068e+05, 7.6354e+05, 7.9620e+05, 3.9067e+05, 3.9069e+05, 3.9068e+05,
         0.0000e+00, 7.9618e+05, 7.7582e+05, 3.9069e+05, 7.6025e+05, 3.9067e+05,
         3.9067e+05, 3.9065e+05, 3.9065e+05, 7.7245e+05],
        [3.9579e+05, 7.9598e+05, 8.1898e+05, 3.9581e+05, 3.9583e+05, 3.9582e+05,
         7.9618e+05, 0.0000e+00, 7.7143e+05, 3.9581e+05, 7.6519e+05, 3.9582e+05,
         3.9582e+05, 3.9582e+05, 3.9582e+05, 8.0752e+05],
        [3.8084e+05, 7.7531e+05, 7.7669e+05, 3.8085e+05, 3.8082e+05, 3.8083e+05,
         7.7582e+05, 7.7143e+05, 0.0000e+00, 3.8082e+05, 7.4134e+05, 3.8081e+05,
         3.8085e+05, 3.8083e+05, 3.8083e+05, 7.5973e+05],
        [6.7710e-01, 3.9222e+05, 4.1082e+05, 6.3292e-01, 9.6619e-01, 8.7096e-01,
         3.9069e+05, 3.9581e+05, 3.8082e+05, 0.0000e+00, 3.6748e+05, 9.8717e-01,
         7.0766e-01, 6.7729e-01, 7.3476e-01, 3.9235e+05],
        [3.6748e+05, 7.2085e+05, 7.6009e+05, 3.6746e+05, 3.6744e+05, 3.6744e+05,
         7.6025e+05, 7.6519e+05, 7.4134e+05, 3.6748e+05, 0.0000e+00, 3.6745e+05,
         3.6747e+05, 3.6747e+05, 3.6744e+05, 7.6226e+05],
        [1.1752e+00, 3.9220e+05, 4.1081e+05, 1.2539e+00, 8.6181e-01, 8.6932e-01,
         3.9067e+05, 3.9582e+05, 3.8081e+05, 9.8717e-01, 3.6745e+05, 0.0000e+00,
         1.3429e+00, 1.2822e+00, 1.0149e+00, 3.9238e+05],
        [4.4455e-01, 3.9223e+05, 4.1084e+05, 3.8213e-01, 1.3418e+00, 1.1969e+00,
         3.9067e+05, 3.9582e+05, 3.8085e+05, 7.0766e-01, 3.6747e+05, 1.3429e+00,
         0.0000e+00, 4.0198e-01, 7.2994e-01, 3.9235e+05],
        [4.0025e-01, 3.9223e+05, 4.1084e+05, 3.2730e-01, 1.3597e+00, 1.1766e+00,
         3.9065e+05, 3.9582e+05, 3.8083e+05, 6.7729e-01, 3.6747e+05, 1.2822e+00,
         4.0198e-01, 0.0000e+00, 6.6087e-01, 3.9234e+05],
        [6.4103e-01, 3.9222e+05, 4.1085e+05, 6.3755e-01, 1.0097e+00, 9.3544e-01,
         3.9065e+05, 3.9582e+05, 3.8083e+05, 7.3476e-01, 3.6744e+05, 1.0149e+00,
         7.2994e-01, 6.6087e-01, 0.0000e+00, 3.9235e+05],
        [3.9236e+05, 7.9661e+05, 8.1865e+05, 3.9235e+05, 3.9236e+05, 3.9237e+05,
         7.7245e+05, 8.0752e+05, 7.5973e+05, 3.9235e+05, 7.6226e+05, 3.9238e+05,
         3.9235e+05, 3.9234e+05, 3.9235e+05, 0.0000e+00]])
Krum scores: ['0.68', '392220.66', '410823.50', '0.68', '1.07', '0.99', '390668.53', '395812.22', '380826.25', '0.75', '367452.69', '1.06', '0.74', '0.70', '0.76', '392352.25']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 13, 18, 9, 4, 1, 16, 14, 20, 5, 17, 8, 6, 10, 12, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0159s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:07...
global Accuracy on shared test data: 73.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[171  66]
 [ 69 194]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:07, End: 2025-07-22 16:03:07)
start time is: 99151792616289, end time is: 99169627338277
The total time is: 17834721988ns.

 ------- aggregate method: mean, random_seed: 0 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 3, 1, 13, 7, 14, 20, 12, 17, 5, 4, 19, 16, 10, 6, 11], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 3, 1, 13, 7, 14, 20, 12, 17, 5, 4, 19, 16, 10, 6, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0134s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:08...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[126 111]
 [135 128]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:08, End: 2025-07-22 16:03:08)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 13, 6, 12, 4, 1, 10, 9, 18, 5, 17, 8, 15, 16, 19, 14], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 13, 6, 12, 4, 1, 10, 9, 18, 5, 17, 8, 15, 16, 19, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:08...
global Accuracy on shared test data: 55.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[120 117]
 [105 158]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:08, End: 2025-07-22 16:03:08)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 14, 6, 7, 9, 3, 13, 12, 11, 2, 10, 1, 8, 5, 17, 4], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 14, 6, 7, 9, 3, 13, 12, 11, 2, 10, 1, 8, 5, 17, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0039s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:09...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[172  65]
 [189  74]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:09, End: 2025-07-22 16:03:09)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 7, 18, 17, 6, 10, 3, 1, 19, 4, 9, 8, 16, 14, 12, 13], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 7, 18, 17, 6, 10, 3, 1, 19, 4, 9, 8, 16, 14, 12, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0153s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:10...
global Accuracy on shared test data: 47.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[203  34]
 [230  33]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:10, End: 2025-07-22 16:03:10)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 20, 18, 2, 7, 1, 12, 13, 3, 9, 15, 5, 19, 14, 10, 4], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 20, 18, 2, 7, 1, 12, 13, 3, 9, 15, 5, 19, 14, 10, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0182s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:10...
global Accuracy on shared test data: 42.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[151  86]
 [202  61]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:10, End: 2025-07-22 16:03:10)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 4, 9, 16, 15, 5, 20, 19, 12, 2, 7, 18, 11, 10, 6, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 4, 9, 16, 15, 5, 20, 19, 12, 2, 7, 18, 11, 10, 6, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0011s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:11...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 96 141]
 [105 158]]
Function 'evaluate_global_model' executed in 0.0023 seconds (Start: 2025-07-22 16:03:11, End: 2025-07-22 16:03:11)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 16, 8, 12, 2, 9, 11, 1, 10, 13, 14, 18, 20, 17, 15, 5], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 16, 8, 12, 2, 9, 11, 1, 10, 13, 14, 18, 20, 17, 15, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:11...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 39 198]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:11, End: 2025-07-22 16:03:11)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 3, 13, 9, 7, 18, 2, 10, 5, 1, 15, 20, 17, 12, 4, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 3, 13, 9, 7, 18, 2, 10, 5, 1, 15, 20, 17, 12, 4, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:12...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 50 187]
 [ 72 191]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:12, End: 2025-07-22 16:03:12)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 17, 11, 13, 19, 10, 7, 5, 16, 15, 20, 6, 1, 4, 8, 18], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 17, 11, 13, 19, 10, 7, 5, 16, 15, 20, 6, 1, 4, 8, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0031s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:13...
global Accuracy on shared test data: 45.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 56 181]
 [ 91 172]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:13, End: 2025-07-22 16:03:13)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 8, 6, 16, 11, 20, 18, 19, 4, 10, 9, 14, 3, 2, 7, 5], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 8, 6, 16, 11, 20, 18, 19, 4, 10, 9, 14, 3, 2, 7, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0027s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:13...
global Accuracy on shared test data: 44.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 66 171]
 [109 154]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:13, End: 2025-07-22 16:03:13)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 11, 14, 5, 19, 17, 7, 10, 8, 18, 15, 13, 6, 12, 4, 16], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 11, 14, 5, 19, 17, 7, 10, 8, 18, 15, 13, 6, 12, 4, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0033s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:14...
global Accuracy on shared test data: 41.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 85 152]
 [139 124]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:14, End: 2025-07-22 16:03:14)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 17, 20, 4, 10, 14, 6, 11, 13, 8, 15, 1, 9, 7, 3, 5], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 17, 20, 4, 10, 14, 6, 11, 13, 8, 15, 1, 9, 7, 3, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:14...
global Accuracy on shared test data: 41.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[117 120]
 [174  89]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:14, End: 2025-07-22 16:03:14)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 8, 5, 14, 1, 15, 18, 16, 9, 6, 13, 12, 20, 4, 19, 17], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 8, 5, 14, 1, 15, 18, 16, 9, 6, 13, 12, 20, 4, 19, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0133s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:15...
global Accuracy on shared test data: 42.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[129 108]
 [182  81]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:15, End: 2025-07-22 16:03:15)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 7, 3, 2, 4, 18, 5, 14, 9, 12, 16, 13, 20, 19, 6, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 7, 3, 2, 4, 18, 5, 14, 9, 12, 16, 13, 20, 19, 6, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:16...
global Accuracy on shared test data: 45.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[127 110]
 [165  98]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 16:03:16, End: 2025-07-22 16:03:16)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [18, 1, 6, 13, 12, 19, 15, 17, 5, 4, 7, 10, 16, 2, 3, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [18, 1, 6, 13, 12, 19, 15, 17, 5, 4, 7, 10, 16, 2, 3, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:16...
global Accuracy on shared test data: 45.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[103 134]
 [138 125]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:16, End: 2025-07-22 16:03:16)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 16, 11, 14, 18, 8, 19, 20, 7, 17, 2, 4, 6, 15, 5, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 16, 11, 14, 18, 8, 19, 20, 7, 17, 2, 4, 6, 15, 5, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:17...
global Accuracy on shared test data: 46.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[122 115]
 [154 109]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:17, End: 2025-07-22 16:03:17)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 1, 5, 9, 16, 12, 10, 7, 17, 13, 20, 18, 11, 4, 19, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 1, 5, 9, 16, 12, 10, 7, 17, 13, 20, 18, 11, 4, 19, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0022s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:17...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[137 100]
 [157 106]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:17, End: 2025-07-22 16:03:17)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 9, 1, 3, 14, 13, 18, 6, 10, 16, 11, 7, 8, 2, 20, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 9, 1, 3, 14, 13, 18, 6, 10, 16, 11, 7, 8, 2, 20, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:18...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[133 104]
 [157 106]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:18, End: 2025-07-22 16:03:18)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 20, 2, 19, 14, 1, 4, 18, 6, 12, 15, 16, 9, 10, 7, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 20, 2, 19, 14, 1, 4, 18, 6, 12, 15, 16, 9, 10, 7, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0022s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:19...
global Accuracy on shared test data: 50.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[138  99]
 [150 113]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:19, End: 2025-07-22 16:03:19)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 13, 9, 19, 8, 16, 18, 7, 3, 10, 5, 1, 6, 17, 20, 4], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 13, 9, 19, 8, 16, 18, 7, 3, 10, 5, 1, 6, 17, 20, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0051s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:19...
global Accuracy on shared test data: 46.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[194  43]
 [225  38]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:19, End: 2025-07-22 16:03:19)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 14, 13, 18, 10, 4, 3, 11, 7, 9, 17, 2, 8, 16, 12, 20], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 14, 13, 18, 10, 4, 3, 11, 7, 9, 17, 2, 8, 16, 12, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:20...
global Accuracy on shared test data: 45.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [216  47]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:20, End: 2025-07-22 16:03:20)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 15, 4, 11, 12, 16, 7, 5, 8, 10, 1, 18, 2, 17, 9, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 15, 4, 11, 12, 16, 7, 5, 8, 10, 1, 18, 2, 17, 9, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0021s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:20...
global Accuracy on shared test data: 46.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[199  38]
 [228  35]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:20, End: 2025-07-22 16:03:20)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 8, 4, 10, 15, 13, 16, 20, 1, 17, 19, 11, 7, 2, 18, 9], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 8, 4, 10, 15, 13, 16, 20, 1, 17, 19, 11, 7, 2, 18, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0182s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:21...
global Accuracy on shared test data: 46.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[189  48]
 [218  45]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:21, End: 2025-07-22 16:03:21)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 15, 18, 20, 3, 1, 9, 13, 17, 10, 5, 2, 7, 19, 11, 14], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 15, 18, 20, 3, 1, 9, 13, 17, 10, 5, 2, 7, 19, 11, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0074s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:22...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[203  34]
 [218  45]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:22, End: 2025-07-22 16:03:22)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 1, 4, 18, 12, 9, 16, 2, 6, 14, 8, 10, 13, 17, 5, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 1, 4, 18, 12, 9, 16, 2, 6, 14, 8, 10, 13, 17, 5, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0007s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:22...
global Accuracy on shared test data: 47.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[189  48]
 [217  46]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:22, End: 2025-07-22 16:03:22)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 15, 11, 19, 8, 13, 9, 12, 17, 10, 4, 2, 14, 6, 16, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 15, 11, 19, 8, 13, 9, 12, 17, 10, 4, 2, 14, 6, 16, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0175s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:23...
global Accuracy on shared test data: 46.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[176  61]
 [205  58]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:23, End: 2025-07-22 16:03:23)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 8, 5, 3, 14, 6, 1, 2, 10, 11, 20, 17, 19, 18, 4, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 8, 5, 3, 14, 6, 1, 2, 10, 11, 20, 17, 19, 18, 4, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0122s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:23...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[123 114]
 [146 117]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:23, End: 2025-07-22 16:03:23)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 14, 1, 8, 12, 6, 19, 17, 2, 5, 20, 16, 9, 7, 3, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 14, 1, 8, 12, 6, 19, 17, 2, 5, 20, 16, 9, 7, 3, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0118s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:24...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[103 134]
 [133 130]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:24, End: 2025-07-22 16:03:24)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 15, 3, 2, 7, 18, 5, 17, 20, 9, 19, 13, 4, 11, 16, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 15, 3, 2, 7, 18, 5, 17, 20, 9, 19, 13, 4, 11, 16, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0021s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:25...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 65 172]
 [ 85 178]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:25, End: 2025-07-22 16:03:25)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [18, 1, 2, 12, 13, 4, 15, 16, 14, 9, 6, 17, 8, 10, 11, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [18, 1, 2, 12, 13, 4, 15, 16, 14, 9, 6, 17, 8, 10, 11, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:25...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 56 181]
 [ 86 177]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:25, End: 2025-07-22 16:03:25)
start time is: 99169627343537, end time is: 99187496190973
The total time is: 17868847436ns.

 ------- aggregate method: mean, random_seed: 100 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 9, 8, 5, 15, 10, 2, 14, 13, 1, 6, 18, 4, 3, 19, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 9, 8, 5, 15, 10, 2, 14, 13, 1, 6, 18, 4, 3, 19, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0196s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:26...
global Accuracy on shared test data: 50.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [194  69]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:26, End: 2025-07-22 16:03:26)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 14, 18, 17, 4, 3, 15, 19, 16, 10, 9, 5, 13, 2, 7, 20], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 14, 18, 17, 4, 3, 15, 19, 16, 10, 9, 5, 13, 2, 7, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0023s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:26...
global Accuracy on shared test data: 46.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[109 128]
 [141 122]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:26, End: 2025-07-22 16:03:26)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 9, 6, 13, 20, 16, 3, 18, 7, 1, 8, 11, 14, 10, 12, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 9, 6, 13, 20, 16, 3, 18, 7, 1, 8, 11, 14, 10, 12, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0014s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:27...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[162  75]
 [178  85]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:27, End: 2025-07-22 16:03:27)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 5, 11, 17, 9, 15, 18, 20, 16, 4, 13, 6, 19, 8, 12, 7], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 5, 11, 17, 9, 15, 18, 20, 16, 4, 13, 6, 19, 8, 12, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0123s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:27...
global Accuracy on shared test data: 47.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[224  13]
 [250  13]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:27, End: 2025-07-22 16:03:27)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 8, 18, 2, 6, 13, 3, 5, 17, 14, 11, 1, 12, 15, 19, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 8, 18, 2, 6, 13, 3, 5, 17, 14, 11, 1, 12, 15, 19, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0107s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:28...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [183  80]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:28, End: 2025-07-22 16:03:28)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [17, 3, 2, 7, 13, 16, 11, 18, 4, 5, 9, 8, 12, 15, 14, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [17, 3, 2, 7, 13, 16, 11, 18, 4, 5, 9, 8, 12, 15, 14, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0073s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:29...
global Accuracy on shared test data: 53.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 73 164]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:29, End: 2025-07-22 16:03:29)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 17, 4, 2, 14, 18, 15, 10, 3, 6, 5, 9, 8, 11, 13, 7], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 17, 4, 2, 14, 18, 15, 10, 3, 6, 5, 9, 8, 11, 13, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0009s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:29...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[120 117]
 [114 149]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:29, End: 2025-07-22 16:03:29)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 14, 2, 19, 8, 11, 20, 10, 1, 3, 16, 17, 9, 5, 6, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 14, 2, 19, 8, 11, 20, 10, 1, 3, 16, 17, 9, 5, 6, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0118s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:30...
global Accuracy on shared test data: 50.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 40 197]
 [ 50 213]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:30, End: 2025-07-22 16:03:30)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 7, 20, 14, 17, 16, 6, 11, 9, 19, 3, 4, 12, 15, 5, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 7, 20, 14, 17, 16, 6, 11, 9, 19, 3, 4, 12, 15, 5, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0185s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:31...
global Accuracy on shared test data: 45.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 85 152]
 [122 141]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:31, End: 2025-07-22 16:03:31)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 6, 3, 7, 9, 5, 10, 17, 13, 19, 4, 12, 14, 20, 15, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 6, 3, 7, 9, 5, 10, 17, 13, 19, 4, 12, 14, 20, 15, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0026s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:31...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 56 181]
 [ 72 191]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:31, End: 2025-07-22 16:03:31)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 13, 15, 8, 19, 7, 9, 11, 14, 12, 6, 18, 2, 4, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 13, 15, 8, 19, 7, 9, 11, 14, 12, 6, 18, 2, 4, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:32...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [120 143]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:32, End: 2025-07-22 16:03:32)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 17, 15, 11, 16, 19, 12, 18, 6, 10, 2, 1, 5, 7, 8, 9], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 17, 15, 11, 16, 19, 12, 18, 6, 10, 2, 1, 5, 7, 8, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:32...
global Accuracy on shared test data: 46.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[170  67]
 [200  63]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:32, End: 2025-07-22 16:03:32)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 5, 16, 11, 10, 3, 15, 13, 6, 7, 2, 4, 8, 12, 19, 20], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 5, 16, 11, 10, 3, 15, 13, 6, 7, 2, 4, 8, 12, 19, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0030s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:33...
global Accuracy on shared test data: 46.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 84 153]
 [113 150]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:33, End: 2025-07-22 16:03:33)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 20, 9, 14, 2, 6, 16, 4, 8, 13, 12, 1, 17, 5, 7, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 20, 9, 14, 2, 6, 16, 4, 8, 13, 12, 1, 17, 5, 7, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0091s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:34...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 96 141]
 [109 154]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:34, End: 2025-07-22 16:03:34)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 8, 2, 19, 4, 16, 20, 1, 7, 10, 6, 11, 14, 17, 18, 5], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 8, 2, 19, 4, 16, 20, 1, 7, 10, 6, 11, 14, 17, 18, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:34...
global Accuracy on shared test data: 49.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 93 144]
 [111 152]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:34, End: 2025-07-22 16:03:34)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 16, 8, 1, 9, 14, 11, 4, 6, 17, 2, 15, 12, 5, 7, 3], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 16, 8, 1, 9, 14, 11, 4, 6, 17, 2, 15, 12, 5, 7, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:35...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 91 146]
 [107 156]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:35, End: 2025-07-22 16:03:35)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 8, 12, 20, 2, 16, 5, 10, 4, 14, 1, 17, 3, 11, 13, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 8, 12, 20, 2, 16, 5, 10, 4, 14, 1, 17, 3, 11, 13, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:35...
global Accuracy on shared test data: 50.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 83 154]
 [ 93 170]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:35, End: 2025-07-22 16:03:35)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 17, 10, 8, 1, 9, 11, 19, 13, 7, 6, 18, 16, 15, 5, 3], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 17, 10, 8, 1, 9, 11, 19, 13, 7, 6, 18, 16, 15, 5, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0006s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:36...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 78 159]
 [ 89 174]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:36, End: 2025-07-22 16:03:36)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 10, 2, 20, 14, 17, 11, 18, 13, 4, 12, 3, 1, 5, 9, 8], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 10, 2, 20, 14, 17, 11, 18, 13, 4, 12, 3, 1, 5, 9, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0026s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:37...
global Accuracy on shared test data: 49.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 29 208]
 [ 46 217]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:37, End: 2025-07-22 16:03:37)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 17, 9, 11, 19, 7, 5, 3, 1, 18, 12, 10, 4, 16, 15, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 17, 9, 11, 19, 7, 5, 3, 1, 18, 12, 10, 4, 16, 15, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0022s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:37...
global Accuracy on shared test data: 51.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 44 193]
 [ 49 214]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:37, End: 2025-07-22 16:03:37)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 14, 18, 16, 5, 7, 4, 15, 6, 3, 2, 19, 8, 11, 17, 10], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 14, 18, 16, 5, 7, 4, 15, 6, 3, 2, 19, 8, 11, 17, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0028s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:38...
global Accuracy on shared test data: 47.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 75 162]
 [100 163]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:38, End: 2025-07-22 16:03:38)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 14, 18, 13, 12, 6, 1, 17, 11, 19, 2, 16, 15, 5, 7, 10], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 14, 18, 13, 12, 6, 1, 17, 11, 19, 2, 16, 15, 5, 7, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0035s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:39...
global Accuracy on shared test data: 48.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 54 183]
 [ 73 190]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:39, End: 2025-07-22 16:03:39)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 9, 10, 11, 16, 17, 2, 14, 15, 7, 19, 20, 18, 1, 8, 5], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 9, 10, 11, 16, 17, 2, 14, 15, 7, 19, 20, 18, 1, 8, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:39...
global Accuracy on shared test data: 53.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 89 148]
 [ 84 179]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:39, End: 2025-07-22 16:03:39)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 4, 15, 6, 13, 5, 11, 10, 12, 19, 7, 16, 3, 9, 18, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 4, 15, 6, 13, 5, 11, 10, 12, 19, 7, 16, 3, 9, 18, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0026s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:40...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 87 150]
 [ 86 177]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:40, End: 2025-07-22 16:03:40)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 19, 5, 7, 20, 8, 15, 18, 13, 9, 14, 11, 17, 4, 16, 2], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 19, 5, 7, 20, 8, 15, 18, 13, 9, 14, 11, 17, 4, 16, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0011s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:40...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[108 129]
 [122 141]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:40, End: 2025-07-22 16:03:40)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 7, 1, 16, 10, 11, 18, 12, 4, 17, 8, 15, 14, 2, 3, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 7, 1, 16, 10, 11, 18, 12, 4, 17, 8, 15, 14, 2, 3, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0035s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:41...
global Accuracy on shared test data: 50.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 88 149]
 [ 98 165]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:41, End: 2025-07-22 16:03:41)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 5, 18, 7, 15, 4, 14, 19, 17, 1, 13, 2, 16, 11, 6, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 5, 18, 7, 15, 4, 14, 19, 17, 1, 13, 2, 16, 11, 6, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:41...
global Accuracy on shared test data: 47.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[125 112]
 [152 111]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:41, End: 2025-07-22 16:03:41)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 13, 7, 17, 18, 14, 10, 20, 4, 12, 2, 5, 8, 3, 9, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 13, 7, 17, 18, 14, 10, 20, 4, 12, 2, 5, 8, 3, 9, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0168s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:42...
global Accuracy on shared test data: 48.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[194  43]
 [217  46]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:42, End: 2025-07-22 16:03:42)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 4, 5, 10, 8, 19, 14, 3, 11, 20, 12, 1, 13, 15, 16, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 4, 5, 10, 8, 19, 14, 3, 11, 20, 12, 1, 13, 15, 16, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:43...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[203  34]
 [212  51]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:43, End: 2025-07-22 16:03:43)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 6, 13, 1, 20, 18, 9, 12, 16, 2, 3, 17, 19, 15, 11, 10], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 6, 13, 1, 20, 18, 9, 12, 16, 2, 3, 17, 19, 15, 11, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0048s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:43...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[166  71]
 [181  82]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:43, End: 2025-07-22 16:03:43)
start time is: 99187496194179, end time is: 99205469223117
The total time is: 17973028938ns.

 ------- aggregate method: mean, random_seed: 200 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 14, 11, 12, 13, 9, 6, 10, 17, 16, 3, 15, 2, 19, 8, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 14, 11, 12, 13, 9, 6, 10, 17, 16, 3, 15, 2, 19, 8, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0167s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:44...
global Accuracy on shared test data: 44.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[146  91]
 [189  74]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:44, End: 2025-07-22 16:03:44)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 19, 4, 15, 10, 18, 1, 17, 20, 8, 2, 12, 3, 5, 6, 7], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 19, 4, 15, 10, 18, 1, 17, 20, 8, 2, 12, 3, 5, 6, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0073s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:44...
global Accuracy on shared test data: 46.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 24 213]
 [ 56 207]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:44, End: 2025-07-22 16:03:44)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 20, 5, 14, 15, 17, 3, 1, 4, 19, 13, 6, 8, 9, 12, 2], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 20, 5, 14, 15, 17, 3, 1, 4, 19, 13, 6, 8, 9, 12, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:45...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 63 174]
 [ 74 189]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:45, End: 2025-07-22 16:03:45)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 8, 10, 5, 7, 17, 4, 18, 12, 6, 19, 20, 3, 2, 16, 14], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 8, 10, 5, 7, 17, 4, 18, 12, 6, 19, 20, 3, 2, 16, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0010s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:46...
global Accuracy on shared test data: 51.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 79 158]
 [ 87 176]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:46, End: 2025-07-22 16:03:46)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 10, 16, 13, 8, 2, 11, 20, 9, 19, 12, 1, 3, 18, 15, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 10, 16, 13, 8, 2, 11, 20, 9, 19, 12, 1, 3, 18, 15, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0009s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:46...
global Accuracy on shared test data: 55.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 74 163]
 [ 59 204]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:46, End: 2025-07-22 16:03:46)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 10, 11, 13, 8, 12, 1, 19, 6, 2, 18, 14, 15, 17, 20, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 10, 11, 13, 8, 12, 1, 19, 6, 2, 18, 14, 15, 17, 20, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:47...
global Accuracy on shared test data: 50.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[111 126]
 [123 140]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:47, End: 2025-07-22 16:03:47)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 14, 2, 9, 16, 15, 18, 12, 10, 8, 11, 4, 13, 3, 7, 6], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 14, 2, 9, 16, 15, 18, 12, 10, 8, 11, 4, 13, 3, 7, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0128s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:47...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 93 144]
 [ 96 167]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:47, End: 2025-07-22 16:03:47)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 13, 12, 6, 9, 11, 15, 10, 17, 16, 7, 14, 2, 20, 19, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 13, 12, 6, 9, 11, 15, 10, 17, 16, 7, 14, 2, 20, 19, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:48...
global Accuracy on shared test data: 48.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 51 186]
 [ 71 192]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:48, End: 2025-07-22 16:03:48)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 20, 14, 12, 11, 1, 17, 3, 7, 18, 9, 10, 4, 15, 8, 13], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 20, 14, 12, 11, 1, 17, 3, 7, 18, 9, 10, 4, 15, 8, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0165s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:49...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 37 200]
 [ 39 224]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:49, End: 2025-07-22 16:03:49)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 7, 1, 19, 17, 18, 13, 10, 2, 16, 14, 6, 8, 5, 20, 9], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 7, 1, 19, 17, 18, 13, 10, 2, 16, 14, 6, 8, 5, 20, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:49...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 20 217]
 [ 21 242]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:49, End: 2025-07-22 16:03:49)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 5, 15, 2, 11, 7, 9, 10, 13, 17, 20, 4, 19, 18, 1, 14], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 5, 15, 2, 11, 7, 9, 10, 13, 17, 20, 4, 19, 18, 1, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:50...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 66 171]
 [ 68 195]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:50, End: 2025-07-22 16:03:50)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 5, 12, 15, 2, 7, 10, 11, 16, 4, 17, 8, 18, 9, 20, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 5, 12, 15, 2, 7, 10, 11, 16, 4, 17, 8, 18, 9, 20, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0164s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:50...
global Accuracy on shared test data: 53.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 81 156]
 [ 76 187]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:50, End: 2025-07-22 16:03:50)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 3, 19, 1, 15, 16, 7, 4, 10, 14, 13, 9, 11, 20, 5, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 3, 19, 1, 15, 16, 7, 4, 10, 14, 13, 9, 11, 20, 5, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0085s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:51...
global Accuracy on shared test data: 56.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 74 163]
 [ 57 206]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:51, End: 2025-07-22 16:03:51)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 12, 10, 18, 3, 7, 15, 13, 4, 17, 19, 2, 20, 6, 8, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 12, 10, 18, 3, 7, 15, 13, 4, 17, 19, 2, 20, 6, 8, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0046s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:52...
global Accuracy on shared test data: 57.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 77 160]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:52, End: 2025-07-22 16:03:52)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [5, 18, 3, 8, 17, 16, 15, 14, 2, 4, 6, 9, 13, 11, 10, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 18, 3, 8, 17, 16, 15, 14, 2, 4, 6, 9, 13, 11, 10, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0170s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:52...
global Accuracy on shared test data: 55.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[182  55]
 [166  97]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:52, End: 2025-07-22 16:03:52)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 20, 6, 10, 16, 5, 2, 7, 12, 8, 18, 17, 3, 19, 1, 4], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 20, 6, 10, 16, 5, 2, 7, 12, 8, 18, 17, 3, 19, 1, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0024s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:53...
global Accuracy on shared test data: 54.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[153  84]
 [143 120]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:53, End: 2025-07-22 16:03:53)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 11, 17, 7, 18, 8, 16, 5, 20, 13, 4, 2, 15, 12, 14, 3], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 11, 17, 7, 18, 8, 16, 5, 20, 13, 4, 2, 15, 12, 14, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:53...
global Accuracy on shared test data: 57.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[134 103]
 [109 154]]
Function 'evaluate_global_model' executed in 0.0024 seconds (Start: 2025-07-22 16:03:53, End: 2025-07-22 16:03:53)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [19, 2, 14, 18, 7, 3, 8, 4, 5, 10, 15, 6, 17, 13, 1, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [19, 2, 14, 18, 7, 3, 8, 4, 5, 10, 15, 6, 17, 13, 1, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0036s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:54...
global Accuracy on shared test data: 56.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[140  97]
 [122 141]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:54, End: 2025-07-22 16:03:54)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 14, 3, 16, 2, 20, 1, 18, 4, 12, 7, 9, 13, 6, 15, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 14, 3, 16, 2, 20, 1, 18, 4, 12, 7, 9, 13, 6, 15, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0063s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:55...
global Accuracy on shared test data: 55.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[145  92]
 [133 130]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:55, End: 2025-07-22 16:03:55)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 11, 4, 1, 7, 16, 3, 8, 18, 2, 19, 20, 5, 10, 6, 14], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 11, 4, 1, 7, 16, 3, 8, 18, 2, 19, 20, 5, 10, 6, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:55...
global Accuracy on shared test data: 55.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[133 104]
 [120 143]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:55, End: 2025-07-22 16:03:55)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 11, 19, 10, 2, 7, 15, 6, 16, 17, 13, 18, 1, 8, 14, 4], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 11, 19, 10, 2, 7, 15, 6, 16, 17, 13, 18, 1, 8, 14, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0016s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:56...
global Accuracy on shared test data: 57.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[150  87]
 [128 135]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:56, End: 2025-07-22 16:03:56)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [5, 9, 14, 15, 18, 12, 10, 16, 8, 19, 2, 7, 17, 3, 1, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 9, 14, 15, 18, 12, 10, 16, 8, 19, 2, 7, 17, 3, 1, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0171s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:56...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[159  78]
 [160 103]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:56, End: 2025-07-22 16:03:56)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 6, 19, 15, 9, 5, 7, 16, 1, 3, 8, 18, 20, 10, 4, 14], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 6, 19, 15, 9, 5, 7, 16, 1, 3, 8, 18, 20, 10, 4, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0144s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:57...
global Accuracy on shared test data: 54.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[137 100]
 [127 136]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:57, End: 2025-07-22 16:03:57)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 5, 14, 4, 19, 6, 13, 16, 10, 18, 1, 3, 20, 2, 17, 8], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 5, 14, 4, 19, 6, 13, 16, 10, 18, 1, 3, 20, 2, 17, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0088s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:58...
global Accuracy on shared test data: 51.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[138  99]
 [144 119]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:03:58, End: 2025-07-22 16:03:58)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 14, 12, 8, 3, 1, 11, 17, 4, 15, 19, 7, 5, 20, 18, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 14, 12, 8, 3, 1, 11, 17, 4, 15, 19, 7, 5, 20, 18, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0088s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:58...
global Accuracy on shared test data: 51.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[158  79]
 [164  99]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:58, End: 2025-07-22 16:03:58)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 9, 11, 4, 17, 14, 3, 5, 20, 16, 13, 19, 6, 10, 2, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 9, 11, 4, 17, 14, 3, 5, 20, 16, 13, 19, 6, 10, 2, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:03:59...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[142  95]
 [142 121]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:03:59, End: 2025-07-22 16:03:59)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 17, 20, 9, 11, 10, 18, 3, 2, 4, 12, 7, 19, 1, 6, 8], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 17, 20, 9, 11, 10, 18, 3, 2, 4, 12, 7, 19, 1, 6, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0010s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:00...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 93 144]
 [ 92 171]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:00, End: 2025-07-22 16:04:00)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 3, 20, 2, 9, 7, 5, 10, 19, 8, 12, 4, 11, 6, 14, 18], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 3, 20, 2, 9, 7, 5, 10, 19, 8, 12, 4, 11, 6, 14, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0116s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:00...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 79 158]
 [ 92 171]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:00, End: 2025-07-22 16:04:00)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 14, 12, 7, 10, 9, 20, 2, 5, 6, 19, 8, 4, 13, 16, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 14, 12, 7, 10, 9, 20, 2, 5, 6, 19, 8, 4, 13, 16, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0017s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:01...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 48 189]
 [ 62 201]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:01, End: 2025-07-22 16:04:01)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 16, 5, 19, 7, 3, 10, 17, 18, 11, 13, 20, 1, 6, 4, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 16, 5, 19, 7, 3, 10, 17, 18, 11, 13, 20, 1, 6, 4, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0141s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:01...
global Accuracy on shared test data: 53.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 49 188]
 [ 46 217]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:01, End: 2025-07-22 16:04:01)
start time is: 99205469226433, end time is: 99223697779156
The total time is: 18228552723ns.

 ------- aggregate method: mean, random_seed: 300 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 10, 8, 11, 7, 5, 13, 14, 4, 6, 16, 18, 1, 19, 3, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 10, 8, 11, 7, 5, 13, 14, 4, 6, 16, 18, 1, 19, 3, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0036s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:02...
global Accuracy on shared test data: 55.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 39 198]
 [ 25 238]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:02, End: 2025-07-22 16:04:02)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 12, 17, 19, 1, 10, 7, 20, 15, 18, 13, 3, 9, 6, 16, 11], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 12, 17, 19, 1, 10, 7, 20, 15, 18, 13, 3, 9, 6, 16, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:03...
global Accuracy on shared test data: 53.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 47 190]
 [ 45 218]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:03, End: 2025-07-22 16:04:03)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 20, 14, 15, 4, 9, 2, 3, 11, 7, 8, 10, 17, 19, 13, 12], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 20, 14, 15, 4, 9, 2, 3, 11, 7, 8, 10, 17, 19, 13, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0010s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:03...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[123 114]
 [144 119]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:03, End: 2025-07-22 16:04:03)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 14, 15, 17, 3, 19, 7, 12, 16, 20, 5, 2, 8, 1, 10, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 14, 15, 17, 3, 19, 7, 12, 16, 20, 5, 2, 8, 1, 10, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0049s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:04...
global Accuracy on shared test data: 56.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[135 102]
 [117 146]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:04, End: 2025-07-22 16:04:04)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 12, 16, 11, 13, 18, 14, 9, 19, 4, 2, 8, 5, 20, 7, 17], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 12, 16, 11, 13, 18, 14, 9, 19, 4, 2, 8, 5, 20, 7, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:04...
global Accuracy on shared test data: 56.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 61 176]
 [ 44 219]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:04, End: 2025-07-22 16:04:04)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 10, 11, 5, 14, 9, 3, 2, 13, 20, 8, 15, 7, 4, 6, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 10, 11, 5, 14, 9, 3, 2, 13, 20, 8, 15, 7, 4, 6, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0060s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:05...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 84 153]
 [ 78 185]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:05, End: 2025-07-22 16:04:05)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 2, 15, 11, 4, 10, 19, 16, 17, 8, 13, 1, 3, 20, 18, 5], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 2, 15, 11, 4, 10, 19, 16, 17, 8, 13, 1, 3, 20, 18, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:05...
global Accuracy on shared test data: 51.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[155  82]
 [161 102]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:05, End: 2025-07-22 16:04:05)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 7, 9, 4, 10, 13, 14, 17, 3, 5, 6, 8, 12, 18, 15, 20], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 7, 9, 4, 10, 13, 14, 17, 3, 5, 6, 8, 12, 18, 15, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0168s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:06...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [191  72]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:06, End: 2025-07-22 16:04:06)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 9, 18, 6, 4, 16, 13, 19, 10, 12, 7, 1, 11, 3, 20, 8], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 9, 18, 6, 4, 16, 13, 19, 10, 12, 7, 1, 11, 3, 20, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:07...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[157  80]
 [151 112]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:07, End: 2025-07-22 16:04:07)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 13, 18, 8, 20, 5, 6, 4, 19, 3, 9, 15, 1, 12, 16, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 13, 18, 8, 20, 5, 6, 4, 19, 3, 9, 15, 1, 12, 16, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0205s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:07...
global Accuracy on shared test data: 51.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 98 139]
 [105 158]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:07, End: 2025-07-22 16:04:07)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 4, 6, 18, 14, 20, 19, 9, 2, 15, 1, 8, 11, 17, 13, 7], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 4, 6, 18, 14, 20, 19, 9, 2, 15, 1, 8, 11, 17, 13, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:08...
global Accuracy on shared test data: 51.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [110 153]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:08, End: 2025-07-22 16:04:08)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 1, 19, 6, 14, 12, 3, 5, 9, 7, 8, 20, 11, 18, 17, 2], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 1, 19, 6, 14, 12, 3, 5, 9, 7, 8, 20, 11, 18, 17, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0158s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:08...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[104 133]
 [106 157]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:08, End: 2025-07-22 16:04:08)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 18, 9, 8, 19, 20, 14, 1, 7, 5, 15, 6, 16, 4, 3, 11], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 18, 9, 8, 19, 20, 14, 1, 7, 5, 15, 6, 16, 4, 3, 11], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0026s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:09...
global Accuracy on shared test data: 50.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[132 105]
 [143 120]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:09, End: 2025-07-22 16:04:09)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 8, 17, 14, 20, 6, 16, 11, 5, 2, 19, 7, 1, 4, 9, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 8, 17, 14, 20, 6, 16, 11, 5, 2, 19, 7, 1, 4, 9, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0128s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:10...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[154  83]
 [163 100]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:10, End: 2025-07-22 16:04:10)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 19, 13, 16, 6, 12, 2, 14, 18, 15, 17, 8, 7, 5, 3, 1], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 19, 13, 16, 6, 12, 2, 14, 18, 15, 17, 8, 7, 5, 3, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0026s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:10...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[113 124]
 [114 149]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:10, End: 2025-07-22 16:04:10)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 18, 7, 1, 2, 9, 8, 11, 4, 15, 20, 10, 5, 16, 13, 17], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 18, 7, 1, 2, 9, 8, 11, 4, 15, 20, 10, 5, 16, 13, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:11...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[140  97]
 [143 120]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:11, End: 2025-07-22 16:04:11)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 16, 3, 7, 2, 20, 15, 14, 4, 8, 6, 13, 9, 12, 17, 5], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 16, 3, 7, 2, 20, 15, 14, 4, 8, 6, 13, 9, 12, 17, 5], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0031s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:11...
global Accuracy on shared test data: 51.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[150  87]
 [157 106]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:11, End: 2025-07-22 16:04:11)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 8, 17, 18, 15, 16, 2, 19, 12, 3, 6, 4, 20, 14, 5, 13], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 8, 17, 18, 15, 16, 2, 19, 12, 3, 6, 4, 20, 14, 5, 13], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0167s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:12...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[144  93]
 [166  97]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:12, End: 2025-07-22 16:04:12)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 8, 19, 1, 11, 10, 18, 14, 13, 17, 7, 5, 4, 6, 2, 15], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 8, 19, 1, 11, 10, 18, 14, 13, 17, 7, 5, 4, 6, 2, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0008s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:13...
global Accuracy on shared test data: 49.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[140  97]
 [156 107]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:13, End: 2025-07-22 16:04:13)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [18, 1, 2, 20, 5, 17, 9, 15, 6, 8, 13, 3, 14, 11, 10, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [18, 1, 2, 20, 5, 17, 9, 15, 6, 8, 13, 3, 14, 11, 10, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0071s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:13...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[143  94]
 [144 119]]
Function 'evaluate_global_model' executed in 0.0024 seconds (Start: 2025-07-22 16:04:13, End: 2025-07-22 16:04:13)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [18, 1, 14, 12, 8, 9, 20, 10, 15, 2, 11, 3, 6, 19, 7, 17], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [18, 1, 14, 12, 8, 9, 20, 10, 15, 2, 11, 3, 6, 19, 7, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0151s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:14...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[142  95]
 [141 122]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:14, End: 2025-07-22 16:04:14)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 11, 8, 7, 5, 6, 13, 15, 14, 16, 12, 20, 17, 19, 18, 10], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 11, 8, 7, 5, 6, 13, 15, 14, 16, 12, 20, 17, 19, 18, 10], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0128s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:14...
global Accuracy on shared test data: 54.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[124 113]
 [116 147]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:14, End: 2025-07-22 16:04:14)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [6, 10, 7, 17, 13, 15, 9, 5, 14, 1, 11, 4, 3, 12, 20, 18], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [6, 10, 7, 17, 13, 15, 9, 5, 14, 1, 11, 4, 3, 12, 20, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0215s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:15...
global Accuracy on shared test data: 49.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[107 130]
 [121 142]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:15, End: 2025-07-22 16:04:15)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 20, 6, 18, 9, 10, 17, 5, 11, 7, 19, 1, 14, 3, 4, 12], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 20, 6, 18, 9, 10, 17, 5, 11, 7, 19, 1, 14, 3, 4, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:16...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[102 135]
 [106 157]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 16:04:16, End: 2025-07-22 16:04:16)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [19, 8, 12, 1, 20, 9, 6, 10, 13, 18, 14, 2, 16, 11, 5, 3], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [19, 8, 12, 1, 20, 9, 6, 10, 13, 18, 14, 2, 16, 11, 5, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0020s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:16...
global Accuracy on shared test data: 52.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[100 137]
 [102 161]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:16, End: 2025-07-22 16:04:16)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [15, 10, 6, 5, 20, 17, 2, 3, 12, 1, 19, 11, 18, 7, 9, 8], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [15, 10, 6, 5, 20, 17, 2, 3, 12, 1, 19, 11, 18, 7, 9, 8], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0143s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:17...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[135 102]
 [129 134]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 16:04:17, End: 2025-07-22 16:04:17)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [5, 9, 6, 4, 13, 17, 18, 3, 19, 12, 14, 15, 11, 10, 1, 16], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [5, 9, 6, 4, 13, 17, 18, 3, 19, 12, 14, 15, 11, 10, 1, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0058s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:17...
global Accuracy on shared test data: 53.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 82 155]
 [ 78 185]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:17, End: 2025-07-22 16:04:17)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 18, 13, 3, 14, 19, 6, 15, 9, 20, 1, 16, 8, 7, 12, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 18, 13, 3, 14, 19, 6, 15, 9, 20, 1, 16, 8, 7, 12, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0010s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:18...
global Accuracy on shared test data: 54.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 64 173]
 [ 54 209]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:18, End: 2025-07-22 16:04:18)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [8, 12, 17, 19, 11, 5, 10, 4, 3, 2, 20, 14, 7, 9, 18, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [8, 12, 17, 19, 11, 5, 10, 4, 3, 2, 20, 14, 7, 9, 18, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0009s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:19...
global Accuracy on shared test data: 55.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 60 177]
 [ 48 215]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:19, End: 2025-07-22 16:04:19)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 15, 20, 9, 1, 5, 14, 17, 16, 13, 6, 2, 19, 18, 8, 3], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 15, 20, 9, 1, 5, 14, 17, 16, 13, 6, 2, 19, 18, 8, 3], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0037s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:19...
global Accuracy on shared test data: 54.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 53 184]
 [ 44 219]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:19, End: 2025-07-22 16:04:19)
start time is: 99223697782603, end time is: 99241525213004
The total time is: 17827430401ns.

 ------- aggregate method: mean, random_seed: 400 --------

[Server] Epoch 0...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 6, 13, 16, 7, 15, 9, 17, 14, 10, 8, 12, 20, 19, 1, 18], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'client_type', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 6, 13, 16, 7, 15, 9, 17, 14, 10, 8, 12, 20, 19, 1, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0168s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:20...
global Accuracy on shared test data: 48.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 82 155]
 [104 159]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:20, End: 2025-07-22 16:04:20)

[Server] Epoch 1...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 1, 17, 11, 15, 20, 4, 19, 14, 7, 8, 3, 13, 16, 2, 9], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 1, 17, 11, 15, 20, 4, 19, 14, 7, 8, 3, 13, 16, 2, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0035s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:20...
global Accuracy on shared test data: 45.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[104 133]
 [139 124]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:20, End: 2025-07-22 16:04:20)

[Server] Epoch 2...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [16, 3, 6, 11, 1, 2, 7, 19, 20, 13, 5, 8, 12, 10, 15, 4], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [16, 3, 6, 11, 1, 2, 7, 19, 20, 13, 5, 8, 12, 10, 15, 4], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0102s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:21...
global Accuracy on shared test data: 46.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[129 108]
 [162 101]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:21, End: 2025-07-22 16:04:21)

[Server] Epoch 3...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [11, 17, 19, 3, 4, 9, 10, 14, 18, 12, 8, 16, 2, 7, 13, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [11, 17, 19, 3, 4, 9, 10, 14, 18, 12, 8, 16, 2, 7, 13, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:22...
global Accuracy on shared test data: 44.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[119 118]
 [159 104]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:22, End: 2025-07-22 16:04:22)

[Server] Epoch 4...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [4, 17, 13, 12, 20, 7, 11, 1, 15, 10, 19, 2, 14, 6, 8, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [4, 17, 13, 12, 20, 7, 11, 1, 15, 10, 19, 2, 14, 6, 8, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0193s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:22...
global Accuracy on shared test data: 51.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[183  54]
 [187  76]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:22, End: 2025-07-22 16:04:22)

[Server] Epoch 5...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [19, 15, 9, 18, 3, 2, 8, 13, 10, 5, 4, 17, 11, 12, 1, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [19, 15, 9, 18, 3, 2, 8, 13, 10, 5, 4, 17, 11, 12, 1, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0015s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:23...
global Accuracy on shared test data: 50.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[100 137]
 [110 153]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:23, End: 2025-07-22 16:04:23)

[Server] Epoch 6...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [20, 7, 15, 11, 2, 9, 6, 8, 14, 1, 18, 3, 13, 16, 10, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [20, 7, 15, 11, 2, 9, 6, 8, 14, 1, 18, 3, 13, 16, 10, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0052s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:23...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[168  69]
 [167  96]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:23, End: 2025-07-22 16:04:23)

[Server] Epoch 7...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 1, 17, 6, 7, 15, 9, 19, 3, 18, 13, 2, 20, 14, 16, 12], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 1, 17, 6, 7, 15, 9, 19, 3, 18, 13, 2, 20, 14, 16, 12], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0009s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:24...
global Accuracy on shared test data: 53.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [172  91]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:24, End: 2025-07-22 16:04:24)

[Server] Epoch 8...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 20, 16, 2, 9, 17, 4, 5, 15, 19, 10, 13, 3, 11, 12, 18], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 20, 16, 2, 9, 17, 4, 5, 15, 19, 10, 13, 3, 11, 12, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0026s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:24...
global Accuracy on shared test data: 58.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[179  58]
 [149 114]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:24, End: 2025-07-22 16:04:24)

[Server] Epoch 9...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 5, 12, 17, 6, 9, 10, 11, 1, 16, 20, 4, 13, 15, 19, 14], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 5, 12, 17, 6, 9, 10, 11, 1, 16, 20, 4, 13, 15, 19, 14], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0010s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:25...
global Accuracy on shared test data: 54.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[194  43]
 [185  78]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:25, End: 2025-07-22 16:04:25)

[Server] Epoch 10...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 2, 6, 5, 17, 3, 7, 19, 8, 20, 16, 18, 4, 15, 11, 9], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 2, 6, 5, 17, 3, 7, 19, 8, 20, 16, 18, 4, 15, 11, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0128s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:26...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[198  39]
 [197  66]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:26, End: 2025-07-22 16:04:26)

[Server] Epoch 11...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 1, 4, 6, 2, 9, 10, 8, 14, 16, 13, 11, 3, 5, 18, 19], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 1, 4, 6, 2, 9, 10, 8, 14, 16, 13, 11, 3, 5, 18, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0140s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:26...
global Accuracy on shared test data: 52.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[177  60]
 [177  86]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:26, End: 2025-07-22 16:04:26)

[Server] Epoch 12...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 8, 17, 1, 15, 16, 13, 7, 3, 11, 18, 20, 2, 4, 10, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 8, 17, 1, 15, 16, 13, 7, 3, 11, 18, 20, 2, 4, 10, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:27...
global Accuracy on shared test data: 53.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[178  59]
 [172  91]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:27, End: 2025-07-22 16:04:27)

[Server] Epoch 13...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 11, 18, 12, 4, 20, 2, 15, 7, 17, 19, 13, 5, 14, 16, 9], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 11, 18, 12, 4, 20, 2, 15, 7, 17, 19, 13, 5, 14, 16, 9], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0005s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:27...
global Accuracy on shared test data: 54.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[137 100]
 [127 136]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:27, End: 2025-07-22 16:04:27)

[Server] Epoch 14...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 3, 5, 15, 8, 10, 14, 13, 2, 20, 1, 12, 4, 19, 11, 18], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 3, 5, 15, 8, 10, 14, 13, 2, 20, 1, 12, 4, 19, 11, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0011s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:28...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[122 115]
 [131 132]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:28, End: 2025-07-22 16:04:28)

[Server] Epoch 15...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 6, 2, 13, 14, 5, 17, 7, 11, 16, 20, 9, 19, 10, 18, 15], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 6, 2, 13, 14, 5, 17, 7, 11, 16, 20, 9, 19, 10, 18, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:29...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[135 102]
 [150 113]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:29, End: 2025-07-22 16:04:29)

[Server] Epoch 16...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 17, 20, 9, 11, 12, 3, 1, 14, 15, 8, 4, 13, 7, 16, 19], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 17, 20, 9, 11, 12, 3, 1, 14, 15, 8, 4, 13, 7, 16, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0045s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:29...
global Accuracy on shared test data: 50.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[140  97]
 [149 114]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:29, End: 2025-07-22 16:04:29)

[Server] Epoch 17...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 4, 11, 17, 20, 10, 16, 5, 13, 19, 12, 9, 7, 15, 8, 1], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 4, 11, 17, 20, 10, 16, 5, 13, 19, 12, 9, 7, 15, 8, 1], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0020s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:30...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[135 102]
 [136 127]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:30, End: 2025-07-22 16:04:30)

[Server] Epoch 18...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 11, 3, 14, 19, 2, 9, 13, 17, 20, 6, 8, 16, 5, 15, 18], updated_f: 8
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 11, 3, 14, 19, 2, 9, 13, 17, 20, 6, 8, 16, 5, 15, 18], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0004s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:30...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 86 151]
 [ 87 176]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:30, End: 2025-07-22 16:04:30)

[Server] Epoch 19...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [3, 13, 17, 18, 15, 20, 11, 7, 10, 9, 6, 4, 5, 14, 16, 2], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [3, 13, 17, 18, 15, 20, 11, 7, 10, 9, 6, 4, 5, 14, 16, 2], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:31...
global Accuracy on shared test data: 50.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 69 168]
 [ 82 181]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:31, End: 2025-07-22 16:04:31)

[Server] Epoch 20...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [1, 8, 15, 14, 5, 6, 13, 18, 11, 17, 3, 4, 12, 7, 16, 20], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [1, 8, 15, 14, 5, 6, 13, 18, 11, 17, 3, 4, 12, 7, 16, 20], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0180s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:31...
global Accuracy on shared test data: 52.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[111 126]
 [110 153]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:31, End: 2025-07-22 16:04:31)

[Server] Epoch 21...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [14, 5, 3, 8, 6, 2, 10, 4, 18, 12, 13, 11, 9, 1, 15, 7], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [14, 5, 3, 8, 6, 2, 10, 4, 18, 12, 13, 11, 9, 1, 15, 7], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0225s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:32...
global Accuracy on shared test data: 53.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[120 117]
 [118 145]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:32, End: 2025-07-22 16:04:32)

[Server] Epoch 22...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [12, 19, 8, 11, 14, 10, 15, 3, 7, 1, 13, 20, 18, 5, 17, 6], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [12, 19, 8, 11, 14, 10, 15, 3, 7, 1, 13, 20, 18, 5, 17, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0022s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:33...
global Accuracy on shared test data: 52.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[105 132]
 [106 157]]
Function 'evaluate_global_model' executed in 0.0022 seconds (Start: 2025-07-22 16:04:33, End: 2025-07-22 16:04:33)

[Server] Epoch 23...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 11, 14, 5, 16, 8, 18, 12, 15, 2, 4, 10, 7, 19, 3, 6], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 11, 14, 5, 16, 8, 18, 12, 15, 2, 4, 10, 7, 19, 3, 6], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0173s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:33...
global Accuracy on shared test data: 51.20%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 77 160]
 [ 84 179]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:33, End: 2025-07-22 16:04:33)

[Server] Epoch 24...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [7, 8, 9, 3, 4, 13, 6, 1, 16, 14, 11, 2, 12, 10, 5, 19], updated_f: 4
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [7, 8, 9, 3, 4, 13, 6, 1, 16, 14, 11, 2, 12, 10, 5, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0181s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:34...
global Accuracy on shared test data: 51.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 79 158]
 [ 85 178]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:34, End: 2025-07-22 16:04:34)

[Server] Epoch 25...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [9, 10, 11, 18, 16, 6, 15, 4, 2, 20, 5, 17, 3, 1, 12, 19], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [9, 10, 11, 18, 16, 6, 15, 4, 2, 20, 5, 17, 3, 1, 12, 19], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0175s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:35...
global Accuracy on shared test data: 47.80%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 71 166]
 [ 95 168]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:35, End: 2025-07-22 16:04:35)

[Server] Epoch 26...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 16, 2, 4, 20, 5, 19, 11, 9, 1, 12, 15, 13, 6, 14, 17], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 16, 2, 4, 20, 5, 19, 11, 9, 1, 12, 15, 13, 6, 14, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0018s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:35...
global Accuracy on shared test data: 48.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[112 125]
 [133 130]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:35, End: 2025-07-22 16:04:35)

[Server] Epoch 27...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [13, 18, 2, 15, 4, 12, 3, 11, 7, 5, 20, 6, 1, 9, 8, 17], updated_f: 5
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [13, 18, 2, 15, 4, 12, 3, 11, 7, 5, 20, 6, 1, 9, 8, 17], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0031s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:36...
global Accuracy on shared test data: 46.40%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[113 124]
 [144 119]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:36, End: 2025-07-22 16:04:36)

[Server] Epoch 28...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [10, 20, 18, 7, 14, 3, 9, 15, 5, 8, 1, 4, 11, 6, 17, 16], updated_f: 6
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [10, 20, 18, 7, 14, 3, 9, 15, 5, 8, 1, 4, 11, 6, 17, 16], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0063s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:36...
global Accuracy on shared test data: 49.60%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 97 140]
 [112 151]]
Function 'evaluate_global_model' executed in 0.0020 seconds (Start: 2025-07-22 16:04:36, End: 2025-07-22 16:04:36)

[Server] Epoch 29...
client_indices (20): [11, 1, 16, 19, 12, 5, 14, 17, 13, 4, 18, 10, 15, 3, 9, 7, 2, 6, 8, 20], f:8, random
select_clients (16): [2, 13, 18, 9, 4, 1, 16, 14, 20, 5, 17, 8, 6, 10, 12, 15], updated_f: 7
[Server] Broadcasting value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
[Server] Received from clients: 16
*aggregate cnn...
each update shape: torch.Size([3914])
Unique weights: tensor([1]), counts: tensor([16])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']
 ['Update 10']
 ['Update 11']
 ['Update 12']
 ['Update 13']
 ['Update 14']
 ['Update 15']], selected_client_indices: [2, 13, 18, 9, 4, 1, 16, 14, 20, 5, 17, 8, 6, 10, 12, 15], client_updates: min: -1000.00, max: -1000.00, time taken: 0.0094s, l2_error: -1000.00
[Server] Aggregated value: dict_keys(['global_model_state_dict', 'data_dir', 'server_epoch', 'CFG'])
Function 'evaluate_global_model starts at 2025-07-22 16:04:37...
global Accuracy on shared test data: 52.00%, Counter({1: 263, 0: 237})
Confusion Matrix:
[[ 79 158]
 [ 82 181]]
Function 'evaluate_global_model' executed in 0.0021 seconds (Start: 2025-07-22 16:04:37, End: 2025-07-22 16:04:37)
start time is: 99241525216080, end time is: 99259368505146
The total time is: 17843289066ns.
-----------------------------------------------------------------------------------
[Server] Training complete. Connections closed.



***random_seed:0
rkrum =  [0.754, 0.77, 0.772, 0.766, 0.78, 0.774, 0.752, 0.76, 0.798, 0.772, 0.806, 0.784, 0.78, 0.772, 0.77, 0.762, 0.75, 0.746, 0.75, 0.778, 0.76, 0.756, 0.738, 0.736, 0.746, 0.766, 0.728, 0.736, 0.732, 0.75]
krum =  [0.754, 0.772, 0.778, 0.768, 0.768, 0.768, 0.756, 0.754, 0.76, 0.748, 0.744, 0.768, 0.756, 0.744, 0.764, 0.748, 0.722, 0.744, 0.752, 0.734, 0.746, 0.738, 0.728, 0.7, 0.718, 0.744, 0.738, 0.704, 0.734, 0.736]
mean =  [0.508, 0.556, 0.492, 0.472, 0.424, 0.508, 0.492, 0.482, 0.456, 0.44, 0.418, 0.412, 0.42, 0.45, 0.456, 0.462, 0.486, 0.478, 0.502, 0.464, 0.452, 0.468, 0.468, 0.496, 0.47, 0.468, 0.48, 0.466, 0.486, 0.466]
rkrum =  35922555992
krum =  17843826133
mean =  17868847436

***random_seed:100
rkrum =  [0.744, 0.772, 0.79, 0.77, 0.766, 0.786, 0.776, 0.764, 0.772, 0.762, 0.76, 0.762, 0.766, 0.75, 0.742, 0.744, 0.744, 0.736, 0.702, 0.724, 0.708, 0.71, 0.714, 0.71, 0.726, 0.742, 0.722, 0.726, 0.732, 0.73]
krum =  [0.71, 0.76, 0.768, 0.784, 0.762, 0.778, 0.758, 0.764, 0.76, 0.746, 0.76, 0.748, 0.732, 0.76, 0.724, 0.718, 0.734, 0.706, 0.732, 0.712, 0.706, 0.708, 0.722, 0.71, 0.702, 0.712, 0.714, 0.704, 0.712, 0.714]
mean =  [0.502, 0.462, 0.494, 0.474, 0.518, 0.53, 0.538, 0.506, 0.452, 0.494, 0.49, 0.466, 0.468, 0.5, 0.49, 0.494, 0.506, 0.504, 0.492, 0.516, 0.476, 0.488, 0.536, 0.528, 0.498, 0.506, 0.472, 0.48, 0.508, 0.496]
rkrum =  18129568144
krum =  17911906579
mean =  17973028938

***random_seed:200
rkrum =  [0.736, 0.762, 0.774, 0.78, 0.766, 0.766, 0.76, 0.756, 0.766, 0.746, 0.778, 0.76, 0.758, 0.76, 0.784, 0.75, 0.756, 0.754, 0.768, 0.762, 0.788, 0.764, 0.764, 0.766, 0.748, 0.748, 0.76, 0.75, 0.748, 0.746]
krum =  [0.774, 0.774, 0.77, 0.758, 0.782, 0.758, 0.762, 0.762, 0.762, 0.746, 0.756, 0.74, 0.746, 0.74, 0.726, 0.734, 0.724, 0.748, 0.758, 0.73, 0.73, 0.746, 0.714, 0.726, 0.718, 0.724, 0.738, 0.726, 0.72, 0.7]
mean =  [0.44, 0.462, 0.504, 0.51, 0.556, 0.502, 0.52, 0.486, 0.522, 0.524, 0.522, 0.536, 0.56, 0.572, 0.558, 0.546, 0.576, 0.562, 0.55, 0.552, 0.57, 0.524, 0.546, 0.514, 0.514, 0.526, 0.528, 0.5, 0.498, 0.532]
rkrum =  18135682858
krum =  18156062744
mean =  18228552723

***random_seed:300
rkrum =  [0.75, 0.754, 0.78, 0.78, 0.78, 0.76, 0.77, 0.766, 0.768, 0.776, 0.774, 0.764, 0.762, 0.77, 0.758, 0.758, 0.774, 0.766, 0.758, 0.736, 0.764, 0.762, 0.748, 0.74, 0.752, 0.734, 0.736, 0.728, 0.734, 0.75]
krum =  [0.74, 0.764, 0.77, 0.76, 0.784, 0.774, 0.78, 0.78, 0.778, 0.758, 0.776, 0.746, 0.756, 0.758, 0.762, 0.75, 0.734, 0.756, 0.748, 0.742, 0.738, 0.726, 0.74, 0.728, 0.762, 0.716, 0.74, 0.75, 0.738, 0.728]
mean =  [0.554, 0.53, 0.484, 0.562, 0.56, 0.538, 0.514, 0.498, 0.538, 0.512, 0.51, 0.522, 0.504, 0.508, 0.524, 0.52, 0.512, 0.482, 0.494, 0.524, 0.528, 0.542, 0.498, 0.518, 0.522, 0.538, 0.534, 0.546, 0.55, 0.544]
rkrum =  17709281176
krum =  17648004246
mean =  17827430401

***random_seed:400
rkrum =  [0.728, 0.732, 0.776, 0.778, 0.776, 0.782, 0.786, 0.754, 0.776, 0.768, 0.774, 0.766, 0.766, 0.75, 0.744, 0.74, 0.762, 0.754, 0.76, 0.76, 0.744, 0.728, 0.73, 0.756, 0.724, 0.742, 0.75, 0.746, 0.758, 0.75]
krum =  [0.742, 0.764, 0.77, 0.774, 0.76, 0.766, 0.766, 0.76, 0.754, 0.764, 0.748, 0.768, 0.754, 0.756, 0.73, 0.738, 0.724, 0.712, 0.712, 0.73, 0.744, 0.72, 0.736, 0.71, 0.732, 0.748, 0.728, 0.728, 0.718, 0.73]
mean =  [0.482, 0.456, 0.46, 0.446, 0.518, 0.506, 0.528, 0.536, 0.586, 0.544, 0.528, 0.526, 0.538, 0.546, 0.508, 0.496, 0.508, 0.524, 0.524, 0.5, 0.528, 0.53, 0.524, 0.512, 0.514, 0.478, 0.484, 0.464, 0.496, 0.52]
rkrum =  17951947837
krum =  17834721988
mean =  17843289066


start time is: 98960002252833, end time is: 99259471584962
The total time is: 299469332129ns.
