/users/kunyang/nvflare/auto_labeling
current directory: /users/kunyang/nvflare/auto_labeling
current file: /users/kunyang/nvflare/auto_labeling/ICONIP/ragg_label_flipping_mnist.py
Device: cuda
Function 'main starts at 2025-11-12 09:52:02...


Namespace(labeling_rate=10.0, server_epochs=2, num_clients=10, aggregation_method='median', verbose=5)
NUM_CLIENTS: 10, in which NUM_HONEST_CLIENTS: 7 and NUM_BYZANTINE_CLIENTS: 3
{'SEED': 42, 'TRAIN_VAL_SEED': 0, 'DEVICE': device(type='cuda'), 'VERBOSE': 5, 'LABELING_RATE': 0.8, 'BIG_NUMBER': 10.0, 'SERVER_EPOCHS': 2, 'CLIENT_EPOCHS': 5, 'BATCH_SIZE': 512, 'IID_CLASSES_CNT': 5, 'NUM_CLIENTS': 10, 'NUM_BYZANTINE_CLIENTS': 3, 'NUM_HONEST_CLIENTS': 7, 'AGGREGATION_METHOD': 'median', 'LABELS': {0, 1, 2, 3, 4, 5, 6, 7, 8, 9}, 'NUM_CLASSES': 10, 'CNN': <class 'ragg.base.CNN'>}

*************************** Generate Clients Data ******************************
Function 'gen_client_data starts at 2025-11-12 09:52:02...
X.shape: (60000, 28, 28), y.shape: (60000,)

	: size, Client_0,  Client_1,  Client_2,  Client_3,  Client_4,  Client_5,  Client_6,  Client_7,  Client_8,  Client_9
class 0:  5923 [481, 528, 502, 575, 385, 505, 689, 687, 653, 918] , alpha: 10.0
class 1:  6742 [664, 660, 728, 1109, 455, 733, 761, 498, 290, 844] , alpha: 10.0
class 2:  5958 [506, 507, 630, 897, 628, 400, 582, 461, 1034, 313] , alpha: 10.0
class 3:  6131 [643, 683, 320, 385, 765, 724, 586, 812, 588, 625] , alpha: 10.0
class 4:  5842 [581, 542, 215, 551, 593, 627, 335, 624, 726, 1048] , alpha: 10.0
class 5:  5421 [856, 351, 710, 598, 246, 709, 477, 419, 587, 468] , alpha: 10.0
class 6:  5918 [406, 327, 587, 473, 407, 675, 503, 399, 997, 1144] , alpha: 10.0
class 7:  6265 [777, 681, 524, 630, 712, 553, 513, 555, 471, 849] , alpha: 10.0
class 8:  5851 [307, 847, 1191, 527, 595, 383, 556, 693, 380, 372] , alpha: 10.0
class 9:  5949 [787, 511, 470, 433, 619, 700, 678, 587, 298, 866] , alpha: 10.0
client 0's data size: 6008, total classes: 10, in which {0: 481, 1: 664, 2: 506, 3: 643, 4: 581, 5: 856, 6: 406, 7: 777, 8: 307, 9: 787}, alpha: 10.0
client 1's data size: 5637, total classes: 10, in which {0: 528, 1: 660, 2: 507, 3: 683, 4: 542, 5: 351, 6: 327, 7: 681, 8: 847, 9: 511}, alpha: 10.0
client 2's data size: 5877, total classes: 10, in which {0: 502, 1: 728, 2: 630, 3: 320, 4: 215, 5: 710, 6: 587, 7: 524, 8: 1191, 9: 470}, alpha: 10.0
client 3's data size: 6178, total classes: 10, in which {0: 575, 1: 1109, 2: 897, 3: 385, 4: 551, 5: 598, 6: 473, 7: 630, 8: 527, 9: 433}, alpha: 10.0
client 4's data size: 5405, total classes: 10, in which {0: 385, 1: 455, 2: 628, 3: 765, 4: 593, 5: 246, 6: 407, 7: 712, 8: 595, 9: 619}, alpha: 10.0
client 5's data size: 6009, total classes: 10, in which {0: 505, 1: 733, 2: 400, 3: 724, 4: 627, 5: 709, 6: 675, 7: 553, 8: 383, 9: 700}, alpha: 10.0
client 6's data size: 5680, total classes: 10, in which {0: 689, 1: 761, 2: 582, 3: 586, 4: 335, 5: 477, 6: 503, 7: 513, 8: 556, 9: 678}, alpha: 10.0
client 7's data size: 5735, total classes: 10, in which {0: 687, 1: 498, 2: 461, 3: 812, 4: 624, 5: 419, 6: 399, 7: 555, 8: 693, 9: 587}, alpha: 10.0
client 8's data size: 6024, total classes: 10, in which {0: 653, 1: 290, 2: 1034, 3: 588, 4: 726, 5: 587, 6: 997, 7: 471, 8: 380, 9: 298}, alpha: 10.0
client 9's data size: 7447, total classes: 10, in which {0: 918, 1: 844, 2: 313, 3: 625, 4: 1048, 5: 468, 6: 1144, 7: 849, 8: 372, 9: 866}, alpha: 10.0
total size: 60000

*** client_0: Honest...
client_0 data (10):  {0: 481, 1: 664, 2: 506, 3: 643, 4: 581, 5: 856, 6: 406, 7: 777, 8: 307, 9: 787}
Local_data: 
X: torch.Size([6008, 28, 28]), y(10): {0: 481, 1: 664, 2: 506, 3: 643, 4: 581, 5: 856, 6: 406, 7: 777, 8: 307, 9: 787}, in which, 
	X_train: torch.Size([4325, 28, 28]), y_train: Counter({5: 636, 7: 573, 9: 552, 1: 484, 3: 474, 4: 415, 2: 355, 0: 331, 6: 287, 8: 218})
	X_val: torch.Size([481, 28, 28]), y_val: Counter({5: 69, 9: 67, 7: 57, 4: 51, 1: 47, 3: 44, 2: 43, 6: 38, 8: 33, 0: 32})
	X_test: torch.Size([1202, 28, 28]), y_test: Counter({9: 168, 5: 151, 7: 147, 1: 133, 3: 125, 0: 118, 4: 115, 2: 108, 6: 81, 8: 56})

*** client_1: Honest...
client_1 data (10):  {0: 528, 1: 660, 2: 507, 3: 683, 4: 542, 5: 351, 6: 327, 7: 681, 8: 847, 9: 511}
Local_data: 
X: torch.Size([5637, 28, 28]), y(10): {0: 528, 1: 660, 2: 507, 3: 683, 4: 542, 5: 351, 6: 327, 7: 681, 8: 847, 9: 511}, in which, 
	X_train: torch.Size([4058, 28, 28]), y_train: Counter({8: 619, 3: 514, 7: 480, 1: 471, 4: 385, 9: 375, 0: 372, 2: 355, 5: 249, 6: 238})
	X_val: torch.Size([451, 28, 28]), y_val: Counter({8: 69, 7: 65, 3: 51, 1: 49, 2: 46, 4: 42, 0: 35, 9: 35, 5: 34, 6: 25})
	X_test: torch.Size([1128, 28, 28]), y_test: Counter({8: 159, 1: 140, 7: 136, 0: 121, 3: 118, 4: 115, 2: 106, 9: 101, 5: 68, 6: 64})

*** client_2: Honest...
client_2 data (10):  {0: 502, 1: 728, 2: 630, 3: 320, 4: 215, 5: 710, 6: 587, 7: 524, 8: 1191, 9: 470}
Local_data: 
X: torch.Size([5877, 28, 28]), y(10): {0: 502, 1: 728, 2: 630, 3: 320, 4: 215, 5: 710, 6: 587, 7: 524, 8: 1191, 9: 470}, in which, 
	X_train: torch.Size([4230, 28, 28]), y_train: Counter({8: 855, 1: 515, 5: 514, 2: 468, 6: 436, 7: 381, 0: 354, 9: 325, 3: 228, 4: 154})
	X_val: torch.Size([471, 28, 28]), y_val: Counter({8: 113, 1: 63, 5: 61, 6: 43, 7: 42, 2: 38, 9: 38, 3: 31, 0: 30, 4: 12})
	X_test: torch.Size([1176, 28, 28]), y_test: Counter({8: 223, 1: 150, 5: 135, 2: 124, 0: 118, 6: 108, 9: 107, 7: 101, 3: 61, 4: 49})

*** client_3: Honest...
client_3 data (10):  {0: 575, 1: 1109, 2: 897, 3: 385, 4: 551, 5: 598, 6: 473, 7: 630, 8: 527, 9: 433}
Local_data: 
X: torch.Size([6178, 28, 28]), y(10): {0: 575, 1: 1109, 2: 897, 3: 385, 4: 551, 5: 598, 6: 473, 7: 630, 8: 527, 9: 433}, in which, 
	X_train: torch.Size([4447, 28, 28]), y_train: Counter({1: 790, 2: 659, 7: 448, 5: 431, 4: 400, 0: 398, 8: 390, 6: 346, 9: 322, 3: 263})
	X_val: torch.Size([495, 28, 28]), y_val: Counter({1: 92, 2: 64, 4: 55, 7: 51, 5: 48, 0: 43, 6: 40, 8: 39, 3: 35, 9: 28})
	X_test: torch.Size([1236, 28, 28]), y_test: Counter({1: 227, 2: 174, 0: 134, 7: 131, 5: 119, 8: 98, 4: 96, 3: 87, 6: 87, 9: 83})

*** client_4: Honest...
client_4 data (10):  {0: 385, 1: 455, 2: 628, 3: 765, 4: 593, 5: 246, 6: 407, 7: 712, 8: 595, 9: 619}
Local_data: 
X: torch.Size([5405, 28, 28]), y(10): {0: 385, 1: 455, 2: 628, 3: 765, 4: 593, 5: 246, 6: 407, 7: 712, 8: 595, 9: 619}, in which, 
	X_train: torch.Size([3891, 28, 28]), y_train: Counter({3: 547, 7: 519, 2: 460, 9: 456, 8: 433, 4: 416, 1: 317, 6: 294, 0: 271, 5: 178})
	X_val: torch.Size([433, 28, 28]), y_val: Counter({3: 63, 7: 60, 4: 59, 8: 47, 2: 44, 9: 39, 1: 36, 6: 31, 0: 30, 5: 24})
	X_test: torch.Size([1081, 28, 28]), y_test: Counter({3: 155, 7: 133, 2: 124, 9: 124, 4: 118, 8: 115, 1: 102, 0: 84, 6: 82, 5: 44})

*** client_5: Honest...
client_5 data (10):  {0: 505, 1: 733, 2: 400, 3: 724, 4: 627, 5: 709, 6: 675, 7: 553, 8: 383, 9: 700}
Local_data: 
X: torch.Size([6009, 28, 28]), y(10): {0: 505, 1: 733, 2: 400, 3: 724, 4: 627, 5: 709, 6: 675, 7: 553, 8: 383, 9: 700}, in which, 
	X_train: torch.Size([4326, 28, 28]), y_train: Counter({5: 536, 3: 523, 1: 522, 9: 507, 6: 473, 4: 437, 7: 417, 0: 352, 2: 294, 8: 265})
	X_val: torch.Size([481, 28, 28]), y_val: Counter({4: 67, 6: 62, 9: 58, 1: 56, 3: 55, 5: 53, 8: 37, 7: 36, 0: 29, 2: 28})
	X_test: torch.Size([1202, 28, 28]), y_test: Counter({1: 155, 3: 146, 6: 140, 9: 135, 0: 124, 4: 123, 5: 120, 7: 100, 8: 81, 2: 78})

*** client_6: Honest...
client_6 data (10):  {0: 689, 1: 761, 2: 582, 3: 586, 4: 335, 5: 477, 6: 503, 7: 513, 8: 556, 9: 678}
Local_data: 
X: torch.Size([5680, 28, 28]), y(10): {0: 689, 1: 761, 2: 582, 3: 586, 4: 335, 5: 477, 6: 503, 7: 513, 8: 556, 9: 678}, in which, 
	X_train: torch.Size([4089, 28, 28]), y_train: Counter({1: 537, 0: 491, 9: 485, 2: 422, 3: 415, 8: 394, 7: 384, 5: 359, 6: 353, 4: 249})
	X_val: torch.Size([455, 28, 28]), y_val: Counter({1: 65, 9: 58, 6: 52, 2: 51, 8: 45, 0: 43, 3: 43, 7: 40, 5: 35, 4: 23})
	X_test: torch.Size([1136, 28, 28]), y_test: Counter({1: 159, 0: 155, 9: 135, 3: 128, 8: 117, 2: 109, 6: 98, 7: 89, 5: 83, 4: 63})

*** client_7: Byzantine...
client_7 data (10):  {0: 615, 1: 667, 2: 545, 3: 472, 4: 445, 5: 598, 6: 739, 7: 471, 8: 524, 9: 659}
Local_data: 
X: torch.Size([5735, 28, 28]), y(10): {0: 615, 1: 667, 2: 545, 3: 472, 4: 445, 5: 598, 6: 739, 7: 471, 8: 524, 9: 659}, in which, 
	X_train: torch.Size([4129, 28, 28]), y_train: Counter({6: 584, 1: 505, 9: 477, 5: 469, 0: 415, 2: 414, 8: 358, 7: 329, 4: 301, 3: 277})
	X_val: torch.Size([459, 28, 28]), y_val: Counter({6: 67, 1: 61, 9: 55, 0: 45, 5: 44, 7: 41, 2: 40, 8: 39, 3: 34, 4: 33})
	X_test: torch.Size([1147, 28, 28]), y_test: Counter({3: 161, 0: 155, 8: 127, 9: 127, 4: 111, 1: 101, 7: 101, 2: 91, 6: 88, 5: 85})

*** client_8: Byzantine...
client_8 data (10):  {0: 392, 1: 354, 2: 601, 3: 918, 4: 613, 5: 700, 6: 667, 7: 904, 8: 316, 9: 559}
Local_data: 
X: torch.Size([6024, 28, 28]), y(10): {0: 392, 1: 354, 2: 601, 3: 918, 4: 613, 5: 700, 6: 667, 7: 904, 8: 316, 9: 559}, in which, 
	X_train: torch.Size([4337, 28, 28]), y_train: Counter({7: 731, 3: 719, 5: 511, 9: 452, 4: 434, 6: 430, 2: 351, 1: 276, 0: 221, 8: 212})
	X_val: torch.Size([482, 28, 28]), y_val: Counter({3: 89, 7: 85, 5: 76, 9: 49, 6: 48, 4: 40, 2: 32, 8: 22, 1: 22, 0: 19})
	X_test: torch.Size([1205, 28, 28]), y_test: Counter({2: 218, 6: 189, 0: 152, 4: 139, 5: 113, 3: 110, 7: 88, 8: 82, 9: 58, 1: 56})

*** client_9: Byzantine...
client_9 data (10):  {0: 877, 1: 476, 2: 745, 3: 1084, 4: 569, 5: 947, 6: 685, 7: 417, 8: 740, 9: 907}
Local_data: 
X: torch.Size([7447, 28, 28]), y(10): {0: 877, 1: 476, 2: 745, 3: 1084, 4: 569, 5: 947, 6: 685, 7: 417, 8: 740, 9: 907}, in which, 
	X_train: torch.Size([5361, 28, 28]), y_train: Counter({3: 852, 5: 766, 9: 650, 0: 618, 2: 614, 8: 585, 6: 446, 4: 341, 1: 260, 7: 229})
	X_val: torch.Size([596, 28, 28]), y_val: Counter({3: 92, 5: 91, 2: 76, 9: 73, 8: 69, 0: 64, 6: 39, 4: 37, 7: 29, 1: 26})
	X_test: torch.Size([1490, 28, 28]), y_test: Counter({6: 200, 0: 195, 4: 191, 1: 190, 9: 184, 7: 159, 3: 140, 5: 90, 8: 86, 2: 55})
Function 'gen_client_data' executed in 37.6249 seconds (Start: 2025-11-12 09:52:02, End: 2025-11-12 09:52:39)

***************************** Global Models *************************************
CNN(
  (conv1): Conv2d(1, 16, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv11): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv21): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv3): Conv2d(32, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv31): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (fc1): Linear(in_features=576, out_features=512, bias=True)
  (fc2): Linear(in_features=512, out_features=10, bias=True)
  (leaky_relu): LeakyReLU(negative_slope=0.2)
)

*************** Server Epoch: 0/2, Client Training *****************

*** server_epoch:0, client_0: Honest... ***
client_0 data (10): {0: 331, 1: 484, 2: 355, 3: 474, 4: 415, 5: 636, 6: 287, 7: 573, 8: 218, 9: 552}
Local_data: 
X: torch.Size([6008, 28, 28]), y(10): {0: 481, 1: 664, 2: 506, 3: 643, 4: 581, 5: 856, 6: 406, 7: 777, 8: 307, 9: 787}, in which, 
	X_train: torch.Size([4325, 28, 28]), y_train: Counter({5: 636, 7: 573, 9: 552, 1: 484, 3: 474, 4: 415, 2: 355, 0: 331, 6: 287, 8: 218})
	X_val: torch.Size([481, 28, 28]), y_val: Counter({5: 69, 9: 67, 7: 57, 4: 51, 1: 47, 3: 44, 2: 43, 6: 38, 8: 33, 0: 32})
	X_test: torch.Size([1202, 28, 28]), y_test: Counter({9: 168, 5: 151, 7: 147, 1: 133, 3: 125, 0: 118, 4: 115, 2: 108, 6: 81, 8: 56})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:40...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 331), (1, 484), (2, 355), (3, 474), (4, 415), (5, 636), (6, 287), (7, 573), (8, 218), (9, 552)])
class_weight: tensor([0.12, 0.08, 0.11, 0.08, 0.09, 0.06, 0.14, 0.07, 0.18, 0.07],
       device='cuda:0'), sum(class_weight) = 0.9999999403953552
train_cnn epoch: 0, local_cnn train loss: 18.1490, val_loss: 18.1490, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.2973, val_loss: 3.2973, LR: 0.001
Function 'train_cnn' executed in 1.1515 seconds (Start: 2025-11-12 09:52:40, End: 2025-11-12 09:52:41)
dist(local, global): 10.52151870727539
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:41...
Function 'evaluate' executed in 0.0157 seconds (Start: 2025-11-12 09:52:41, End: 2025-11-12 09:52:41)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:41...
Function 'evaluate_shared_test' executed in 0.0591 seconds (Start: 2025-11-12 09:52:41, End: 2025-11-12 09:52:41)

*** server_epoch:0, client_1: Honest... ***
client_1 data (10): {0: 372, 1: 471, 2: 355, 3: 514, 4: 385, 5: 249, 6: 238, 7: 480, 8: 619, 9: 375}
Local_data: 
X: torch.Size([5637, 28, 28]), y(10): {0: 528, 1: 660, 2: 507, 3: 683, 4: 542, 5: 351, 6: 327, 7: 681, 8: 847, 9: 511}, in which, 
	X_train: torch.Size([4058, 28, 28]), y_train: Counter({8: 619, 3: 514, 7: 480, 1: 471, 4: 385, 9: 375, 0: 372, 2: 355, 5: 249, 6: 238})
	X_val: torch.Size([451, 28, 28]), y_val: Counter({8: 69, 7: 65, 3: 51, 1: 49, 2: 46, 4: 42, 0: 35, 9: 35, 5: 34, 6: 25})
	X_test: torch.Size([1128, 28, 28]), y_test: Counter({8: 159, 1: 140, 7: 136, 0: 121, 3: 118, 4: 115, 2: 106, 9: 101, 5: 68, 6: 64})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:42...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 372), (1, 471), (2, 355), (3, 514), (4, 385), (5, 249), (6, 238), (7, 480), (8, 619), (9, 375)])
class_weight: tensor([0.10, 0.08, 0.11, 0.07, 0.10, 0.15, 0.16, 0.08, 0.06, 0.10],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 16.6023, val_loss: 16.6023, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.1876, val_loss: 3.1876, LR: 0.001
Function 'train_cnn' executed in 0.8529 seconds (Start: 2025-11-12 09:52:42, End: 2025-11-12 09:52:43)
dist(local, global): 10.0827054977417
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:43...
Function 'evaluate' executed in 0.0139 seconds (Start: 2025-11-12 09:52:43, End: 2025-11-12 09:52:43)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:43...
Function 'evaluate_shared_test' executed in 0.0301 seconds (Start: 2025-11-12 09:52:43, End: 2025-11-12 09:52:43)

*** server_epoch:0, client_2: Honest... ***
client_2 data (10): {0: 354, 1: 515, 2: 468, 3: 228, 4: 154, 5: 514, 6: 436, 7: 381, 8: 855, 9: 325}
Local_data: 
X: torch.Size([5877, 28, 28]), y(10): {0: 502, 1: 728, 2: 630, 3: 320, 4: 215, 5: 710, 6: 587, 7: 524, 8: 1191, 9: 470}, in which, 
	X_train: torch.Size([4230, 28, 28]), y_train: Counter({8: 855, 1: 515, 5: 514, 2: 468, 6: 436, 7: 381, 0: 354, 9: 325, 3: 228, 4: 154})
	X_val: torch.Size([471, 28, 28]), y_val: Counter({8: 113, 1: 63, 5: 61, 6: 43, 7: 42, 2: 38, 9: 38, 3: 31, 0: 30, 4: 12})
	X_test: torch.Size([1176, 28, 28]), y_test: Counter({8: 223, 1: 150, 5: 135, 2: 124, 0: 118, 6: 108, 9: 107, 7: 101, 3: 61, 4: 49})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:44...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 354), (1, 515), (2, 468), (3, 228), (4, 154), (5, 514), (6, 436), (7, 381), (8, 855), (9, 325)])
class_weight: tensor([0.10, 0.07, 0.07, 0.15, 0.22, 0.07, 0.08, 0.09, 0.04, 0.11],
       device='cuda:0'), sum(class_weight) = 0.9999999403953552
train_cnn epoch: 0, local_cnn train loss: 18.4860, val_loss: 18.4860, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.3075, val_loss: 3.3075, LR: 0.001
Function 'train_cnn' executed in 0.8911 seconds (Start: 2025-11-12 09:52:44, End: 2025-11-12 09:52:45)
dist(local, global): 10.641938209533691
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:45...
Function 'evaluate' executed in 0.0136 seconds (Start: 2025-11-12 09:52:45, End: 2025-11-12 09:52:45)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:45...
Function 'evaluate_shared_test' executed in 0.0363 seconds (Start: 2025-11-12 09:52:45, End: 2025-11-12 09:52:45)

*** server_epoch:0, client_3: Honest... ***
client_3 data (10): {0: 398, 1: 790, 2: 659, 3: 263, 4: 400, 5: 431, 6: 346, 7: 448, 8: 390, 9: 322}
Local_data: 
X: torch.Size([6178, 28, 28]), y(10): {0: 575, 1: 1109, 2: 897, 3: 385, 4: 551, 5: 598, 6: 473, 7: 630, 8: 527, 9: 433}, in which, 
	X_train: torch.Size([4447, 28, 28]), y_train: Counter({1: 790, 2: 659, 7: 448, 5: 431, 4: 400, 0: 398, 8: 390, 6: 346, 9: 322, 3: 263})
	X_val: torch.Size([495, 28, 28]), y_val: Counter({1: 92, 2: 64, 4: 55, 7: 51, 5: 48, 0: 43, 6: 40, 8: 39, 3: 35, 9: 28})
	X_test: torch.Size([1236, 28, 28]), y_test: Counter({1: 227, 2: 174, 0: 134, 7: 131, 5: 119, 8: 98, 4: 96, 3: 87, 6: 87, 9: 83})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:46...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 398), (1, 790), (2, 659), (3, 263), (4, 400), (5, 431), (6, 346), (7, 448), (8, 390), (9, 322)])
class_weight: tensor([0.10, 0.05, 0.06, 0.15, 0.10, 0.09, 0.12, 0.09, 0.10, 0.13],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 18.4054, val_loss: 18.4054, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.1461, val_loss: 3.1461, LR: 0.001
Function 'train_cnn' executed in 1.0010 seconds (Start: 2025-11-12 09:52:46, End: 2025-11-12 09:52:47)
dist(local, global): 10.457586288452148
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:47...
Function 'evaluate' executed in 0.0141 seconds (Start: 2025-11-12 09:52:47, End: 2025-11-12 09:52:47)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:47...
Function 'evaluate_shared_test' executed in 0.0260 seconds (Start: 2025-11-12 09:52:47, End: 2025-11-12 09:52:47)

*** server_epoch:0, client_4: Honest... ***
client_4 data (10): {0: 271, 1: 317, 2: 460, 3: 547, 4: 416, 5: 178, 6: 294, 7: 519, 8: 433, 9: 456}
Local_data: 
X: torch.Size([5405, 28, 28]), y(10): {0: 385, 1: 455, 2: 628, 3: 765, 4: 593, 5: 246, 6: 407, 7: 712, 8: 595, 9: 619}, in which, 
	X_train: torch.Size([3891, 28, 28]), y_train: Counter({3: 547, 7: 519, 2: 460, 9: 456, 8: 433, 4: 416, 1: 317, 6: 294, 0: 271, 5: 178})
	X_val: torch.Size([433, 28, 28]), y_val: Counter({3: 63, 7: 60, 4: 59, 8: 47, 2: 44, 9: 39, 1: 36, 6: 31, 0: 30, 5: 24})
	X_test: torch.Size([1081, 28, 28]), y_test: Counter({3: 155, 7: 133, 2: 124, 9: 124, 4: 118, 8: 115, 1: 102, 0: 84, 6: 82, 5: 44})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:48...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 271), (1, 317), (2, 460), (3, 547), (4, 416), (5, 178), (6, 294), (7, 519), (8, 433), (9, 456)])
class_weight: tensor([0.13, 0.11, 0.08, 0.06, 0.08, 0.20, 0.12, 0.07, 0.08, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 16.8595, val_loss: 16.8595, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.2951, val_loss: 3.2951, LR: 0.001
Function 'train_cnn' executed in 0.7898 seconds (Start: 2025-11-12 09:52:48, End: 2025-11-12 09:52:48)
dist(local, global): 10.140694618225098
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:48...
Function 'evaluate' executed in 0.0134 seconds (Start: 2025-11-12 09:52:48, End: 2025-11-12 09:52:48)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:48...
Function 'evaluate_shared_test' executed in 0.0309 seconds (Start: 2025-11-12 09:52:48, End: 2025-11-12 09:52:48)

*** server_epoch:0, client_5: Honest... ***
client_5 data (10): {0: 352, 1: 522, 2: 294, 3: 523, 4: 437, 5: 536, 6: 473, 7: 417, 8: 265, 9: 507}
Local_data: 
X: torch.Size([6009, 28, 28]), y(10): {0: 505, 1: 733, 2: 400, 3: 724, 4: 627, 5: 709, 6: 675, 7: 553, 8: 383, 9: 700}, in which, 
	X_train: torch.Size([4326, 28, 28]), y_train: Counter({5: 536, 3: 523, 1: 522, 9: 507, 6: 473, 4: 437, 7: 417, 0: 352, 2: 294, 8: 265})
	X_val: torch.Size([481, 28, 28]), y_val: Counter({4: 67, 6: 62, 9: 58, 1: 56, 3: 55, 5: 53, 8: 37, 7: 36, 0: 29, 2: 28})
	X_test: torch.Size([1202, 28, 28]), y_test: Counter({1: 155, 3: 146, 6: 140, 9: 135, 0: 124, 4: 123, 5: 120, 7: 100, 8: 81, 2: 78})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:49...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 352), (1, 522), (2, 294), (3, 523), (4, 437), (5, 536), (6, 473), (7, 417), (8, 265), (9, 507)])
class_weight: tensor([0.12, 0.08, 0.14, 0.08, 0.09, 0.08, 0.09, 0.10, 0.15, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 18.3724, val_loss: 18.3724, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.2729, val_loss: 3.2729, LR: 0.001
Function 'train_cnn' executed in 0.9077 seconds (Start: 2025-11-12 09:52:49, End: 2025-11-12 09:52:50)
dist(local, global): 10.4994535446167
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:50...
Function 'evaluate' executed in 0.0138 seconds (Start: 2025-11-12 09:52:50, End: 2025-11-12 09:52:50)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:50...
Function 'evaluate_shared_test' executed in 0.0261 seconds (Start: 2025-11-12 09:52:50, End: 2025-11-12 09:52:50)

*** server_epoch:0, client_6: Honest... ***
client_6 data (10): {0: 491, 1: 537, 2: 422, 3: 415, 4: 249, 5: 359, 6: 353, 7: 384, 8: 394, 9: 485}
Local_data: 
X: torch.Size([5680, 28, 28]), y(10): {0: 689, 1: 761, 2: 582, 3: 586, 4: 335, 5: 477, 6: 503, 7: 513, 8: 556, 9: 678}, in which, 
	X_train: torch.Size([4089, 28, 28]), y_train: Counter({1: 537, 0: 491, 9: 485, 2: 422, 3: 415, 8: 394, 7: 384, 5: 359, 6: 353, 4: 249})
	X_val: torch.Size([455, 28, 28]), y_val: Counter({1: 65, 9: 58, 6: 52, 2: 51, 8: 45, 0: 43, 3: 43, 7: 40, 5: 35, 4: 23})
	X_test: torch.Size([1136, 28, 28]), y_test: Counter({1: 159, 0: 155, 9: 135, 3: 128, 8: 117, 2: 109, 6: 98, 7: 89, 5: 83, 4: 63})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:51...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 491), (1, 537), (2, 422), (3, 415), (4, 249), (5, 359), (6, 353), (7, 384), (8, 394), (9, 485)])
class_weight: tensor([0.08, 0.07, 0.09, 0.09, 0.16, 0.11, 0.11, 0.10, 0.10, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 16.4698, val_loss: 16.4698, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.9896, val_loss: 2.9896, LR: 0.001
Function 'train_cnn' executed in 0.8290 seconds (Start: 2025-11-12 09:52:51, End: 2025-11-12 09:52:52)
dist(local, global): 10.226906776428223
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:52...
Function 'evaluate' executed in 0.0135 seconds (Start: 2025-11-12 09:52:52, End: 2025-11-12 09:52:52)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:52...
Function 'evaluate_shared_test' executed in 0.0314 seconds (Start: 2025-11-12 09:52:52, End: 2025-11-12 09:52:52)

***server_epoch:0, client_7: Byzantine...
client_7 data: {0: 415, 1: 505, 2: 414, 3: 277, 4: 301, 5: 469, 6: 584, 7: 329, 8: 358, 9: 477}
Local_data: 
X: torch.Size([5735, 28, 28]), y(10): {0: 615, 1: 667, 2: 545, 3: 472, 4: 445, 5: 598, 6: 739, 7: 471, 8: 524, 9: 659}, in which, 
	X_train: torch.Size([4129, 28, 28]), y_train: Counter({6: 584, 1: 505, 9: 477, 5: 469, 0: 415, 2: 414, 8: 358, 7: 329, 4: 301, 3: 277})
	X_val: torch.Size([459, 28, 28]), y_val: Counter({6: 67, 1: 61, 9: 55, 0: 45, 5: 44, 7: 41, 2: 40, 8: 39, 3: 34, 4: 33})
	X_test: torch.Size([1147, 28, 28]), y_test: Counter({3: 161, 0: 155, 8: 127, 9: 127, 4: 111, 1: 101, 7: 101, 2: 91, 6: 88, 5: 85})
Function 'train_cnn starts at 2025-11-12 09:52:53...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 415), (1, 505), (2, 414), (3, 277), (4, 301), (5, 469), (6, 584), (7, 329), (8, 358), (9, 477)])
class_weight: tensor([0.09, 0.08, 0.09, 0.14, 0.13, 0.08, 0.07, 0.12, 0.11, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 18.0522, val_loss: 18.0522, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.6051, val_loss: 3.6051, LR: 0.001
Function 'train_cnn' executed in 0.8273 seconds (Start: 2025-11-12 09:52:53, End: 2025-11-12 09:52:53)
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:53...
Function 'evaluate' executed in 0.0134 seconds (Start: 2025-11-12 09:52:53, End: 2025-11-12 09:52:53)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:53...
Function 'evaluate_shared_test' executed in 0.0303 seconds (Start: 2025-11-12 09:52:53, End: 2025-11-12 09:52:54)

***server_epoch:0, client_8: Byzantine...
client_8 data: {0: 221, 1: 276, 2: 351, 3: 719, 4: 434, 5: 511, 6: 430, 7: 731, 8: 212, 9: 452}
Local_data: 
X: torch.Size([6024, 28, 28]), y(10): {0: 392, 1: 354, 2: 601, 3: 918, 4: 613, 5: 700, 6: 667, 7: 904, 8: 316, 9: 559}, in which, 
	X_train: torch.Size([4337, 28, 28]), y_train: Counter({7: 731, 3: 719, 5: 511, 9: 452, 4: 434, 6: 430, 2: 351, 1: 276, 0: 221, 8: 212})
	X_val: torch.Size([482, 28, 28]), y_val: Counter({3: 89, 7: 85, 5: 76, 9: 49, 6: 48, 4: 40, 2: 32, 8: 22, 1: 22, 0: 19})
	X_test: torch.Size([1205, 28, 28]), y_test: Counter({2: 218, 6: 189, 0: 152, 4: 139, 5: 113, 3: 110, 7: 88, 8: 82, 9: 58, 1: 56})
Function 'train_cnn starts at 2025-11-12 09:52:54...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 221), (1, 276), (2, 351), (3, 719), (4, 434), (5, 511), (6, 430), (7, 731), (8, 212), (9, 452)])
class_weight: tensor([0.17, 0.13, 0.10, 0.05, 0.08, 0.07, 0.09, 0.05, 0.17, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 17.9359, val_loss: 17.9359, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.7958, val_loss: 2.7958, LR: 0.001
Function 'train_cnn' executed in 0.8621 seconds (Start: 2025-11-12 09:52:54, End: 2025-11-12 09:52:55)
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:55...
Function 'evaluate' executed in 0.0135 seconds (Start: 2025-11-12 09:52:55, End: 2025-11-12 09:52:55)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:55...
Function 'evaluate_shared_test' executed in 0.0301 seconds (Start: 2025-11-12 09:52:55, End: 2025-11-12 09:52:55)

***server_epoch:0, client_9: Byzantine...
client_9 data: {0: 618, 1: 260, 2: 614, 3: 852, 4: 341, 5: 766, 6: 446, 7: 229, 8: 585, 9: 650}
Local_data: 
X: torch.Size([7447, 28, 28]), y(10): {0: 877, 1: 476, 2: 745, 3: 1084, 4: 569, 5: 947, 6: 685, 7: 417, 8: 740, 9: 907}, in which, 
	X_train: torch.Size([5361, 28, 28]), y_train: Counter({3: 852, 5: 766, 9: 650, 0: 618, 2: 614, 8: 585, 6: 446, 4: 341, 1: 260, 7: 229})
	X_val: torch.Size([596, 28, 28]), y_val: Counter({3: 92, 5: 91, 2: 76, 9: 73, 8: 69, 0: 64, 6: 39, 4: 37, 7: 29, 1: 26})
	X_test: torch.Size([1490, 28, 28]), y_test: Counter({6: 200, 0: 195, 4: 191, 1: 190, 9: 184, 7: 159, 3: 140, 5: 90, 8: 86, 2: 55})
Function 'train_cnn starts at 2025-11-12 09:52:56...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 618), (1, 260), (2, 614), (3, 852), (4, 341), (5, 766), (6, 446), (7, 229), (8, 585), (9, 650)])
class_weight: tensor([0.07, 0.17, 0.07, 0.05, 0.13, 0.06, 0.10, 0.20, 0.08, 0.07],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 19.9898, val_loss: 19.9898, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.2635, val_loss: 3.2635, LR: 0.001
Function 'train_cnn' executed in 1.0740 seconds (Start: 2025-11-12 09:52:56, End: 2025-11-12 09:52:57)
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:57...
Function 'evaluate' executed in 0.0150 seconds (Start: 2025-11-12 09:52:57, End: 2025-11-12 09:52:57)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:57...
Function 'evaluate_shared_test' executed in 0.0277 seconds (Start: 2025-11-12 09:52:57, End: 2025-11-12 09:52:57)

*************** Server Epoch: 0/2, Server Aggregation **************
Function 'aggregate_cnns starts at 2025-11-12 09:52:57...
*aggregate cnn...
each update shape: torch.Size([390378])
Unique weights: tensor([1]), counts: tensor([10])
Chosen update: Counter({4: 91873, 6: 48352, 1: 47154, 5: 44098, 0: 40467, 3: 40054, 2: 35909, 7: 14435, 9: 14030, 8: 14006}), updates[0].shape: (390378,), clients_weights: [1 1 1 1 1 1 1 1 1 1]
median, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], client_updates: min: -0.05, max: 0.05, time taken: 0.0583s, l2_error: 1.32
Function 'aggregate_cnns' executed in 0.4078 seconds (Start: 2025-11-12 09:52:57, End: 2025-11-12 09:52:58)

*************** Server Epoch: 1/2, Client Training *****************

*** server_epoch:1, client_0: Honest... ***
client_0 data (10): {0: 331, 1: 484, 2: 355, 3: 474, 4: 415, 5: 636, 6: 287, 7: 573, 8: 218, 9: 552}
Local_data: 
X: torch.Size([6008, 28, 28]), y(10): {0: 481, 1: 664, 2: 506, 3: 643, 4: 581, 5: 856, 6: 406, 7: 777, 8: 307, 9: 787}, in which, 
	X_train: torch.Size([4325, 28, 28]), y_train: Counter({5: 636, 7: 573, 9: 552, 1: 484, 3: 474, 4: 415, 2: 355, 0: 331, 6: 287, 8: 218})
	X_val: torch.Size([481, 28, 28]), y_val: Counter({5: 69, 9: 67, 7: 57, 4: 51, 1: 47, 3: 44, 2: 43, 6: 38, 8: 33, 0: 32})
	X_test: torch.Size([1202, 28, 28]), y_test: Counter({9: 168, 5: 151, 7: 147, 1: 133, 3: 125, 0: 118, 4: 115, 2: 108, 6: 81, 8: 56})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:59...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 331), (1, 484), (2, 355), (3, 474), (4, 415), (5, 636), (6, 287), (7, 573), (8, 218), (9, 552)])
class_weight: tensor([0.12, 0.08, 0.11, 0.08, 0.09, 0.06, 0.14, 0.07, 0.18, 0.07],
       device='cuda:0'), sum(class_weight) = 0.9999999403953552
train_cnn epoch: 0, local_cnn train loss: 4.4469, val_loss: 4.4469, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.0428, val_loss: 2.0428, LR: 0.001
Function 'train_cnn' executed in 0.8624 seconds (Start: 2025-11-12 09:52:59, End: 2025-11-12 09:52:59)
dist(local, global): 4.775179386138916
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:59...
Function 'evaluate' executed in 0.0124 seconds (Start: 2025-11-12 09:52:59, End: 2025-11-12 09:52:59)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:59...
Function 'evaluate_shared_test' executed in 0.0261 seconds (Start: 2025-11-12 09:52:59, End: 2025-11-12 09:52:59)

*** server_epoch:1, client_1: Honest... ***
client_1 data (10): {0: 372, 1: 471, 2: 355, 3: 514, 4: 385, 5: 249, 6: 238, 7: 480, 8: 619, 9: 375}
Local_data: 
X: torch.Size([5637, 28, 28]), y(10): {0: 528, 1: 660, 2: 507, 3: 683, 4: 542, 5: 351, 6: 327, 7: 681, 8: 847, 9: 511}, in which, 
	X_train: torch.Size([4058, 28, 28]), y_train: Counter({8: 619, 3: 514, 7: 480, 1: 471, 4: 385, 9: 375, 0: 372, 2: 355, 5: 249, 6: 238})
	X_val: torch.Size([451, 28, 28]), y_val: Counter({8: 69, 7: 65, 3: 51, 1: 49, 2: 46, 4: 42, 0: 35, 9: 35, 5: 34, 6: 25})
	X_test: torch.Size([1128, 28, 28]), y_test: Counter({8: 159, 1: 140, 7: 136, 0: 121, 3: 118, 4: 115, 2: 106, 9: 101, 5: 68, 6: 64})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:00...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 372), (1, 471), (2, 355), (3, 514), (4, 385), (5, 249), (6, 238), (7, 480), (8, 619), (9, 375)])
class_weight: tensor([0.10, 0.08, 0.11, 0.07, 0.10, 0.15, 0.16, 0.08, 0.06, 0.10],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4.0849, val_loss: 4.0849, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.1987, val_loss: 2.1987, LR: 0.001
Function 'train_cnn' executed in 0.9404 seconds (Start: 2025-11-12 09:53:00, End: 2025-11-12 09:53:01)
dist(local, global): 4.563828945159912
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:01...
Function 'evaluate' executed in 0.0122 seconds (Start: 2025-11-12 09:53:01, End: 2025-11-12 09:53:01)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:01...
Function 'evaluate_shared_test' executed in 0.0300 seconds (Start: 2025-11-12 09:53:01, End: 2025-11-12 09:53:01)

*** server_epoch:1, client_2: Honest... ***
client_2 data (10): {0: 354, 1: 515, 2: 468, 3: 228, 4: 154, 5: 514, 6: 436, 7: 381, 8: 855, 9: 325}
Local_data: 
X: torch.Size([5877, 28, 28]), y(10): {0: 502, 1: 728, 2: 630, 3: 320, 4: 215, 5: 710, 6: 587, 7: 524, 8: 1191, 9: 470}, in which, 
	X_train: torch.Size([4230, 28, 28]), y_train: Counter({8: 855, 1: 515, 5: 514, 2: 468, 6: 436, 7: 381, 0: 354, 9: 325, 3: 228, 4: 154})
	X_val: torch.Size([471, 28, 28]), y_val: Counter({8: 113, 1: 63, 5: 61, 6: 43, 7: 42, 2: 38, 9: 38, 3: 31, 0: 30, 4: 12})
	X_test: torch.Size([1176, 28, 28]), y_test: Counter({8: 223, 1: 150, 5: 135, 2: 124, 0: 118, 6: 108, 9: 107, 7: 101, 3: 61, 4: 49})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:02...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 354), (1, 515), (2, 468), (3, 228), (4, 154), (5, 514), (6, 436), (7, 381), (8, 855), (9, 325)])
class_weight: tensor([0.10, 0.07, 0.07, 0.15, 0.22, 0.07, 0.08, 0.09, 0.04, 0.11],
       device='cuda:0'), sum(class_weight) = 0.9999999403953552
train_cnn epoch: 0, local_cnn train loss: 4.2552, val_loss: 4.2552, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1.9832, val_loss: 1.9832, LR: 0.001
Function 'train_cnn' executed in 0.8730 seconds (Start: 2025-11-12 09:53:02, End: 2025-11-12 09:53:03)
dist(local, global): 5.125607490539551
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:03...
Function 'evaluate' executed in 0.0123 seconds (Start: 2025-11-12 09:53:03, End: 2025-11-12 09:53:03)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:03...
Function 'evaluate_shared_test' executed in 0.0263 seconds (Start: 2025-11-12 09:53:03, End: 2025-11-12 09:53:03)

*** server_epoch:1, client_3: Honest... ***
client_3 data (10): {0: 398, 1: 790, 2: 659, 3: 263, 4: 400, 5: 431, 6: 346, 7: 448, 8: 390, 9: 322}
Local_data: 
X: torch.Size([6178, 28, 28]), y(10): {0: 575, 1: 1109, 2: 897, 3: 385, 4: 551, 5: 598, 6: 473, 7: 630, 8: 527, 9: 433}, in which, 
	X_train: torch.Size([4447, 28, 28]), y_train: Counter({1: 790, 2: 659, 7: 448, 5: 431, 4: 400, 0: 398, 8: 390, 6: 346, 9: 322, 3: 263})
	X_val: torch.Size([495, 28, 28]), y_val: Counter({1: 92, 2: 64, 4: 55, 7: 51, 5: 48, 0: 43, 6: 40, 8: 39, 3: 35, 9: 28})
	X_test: torch.Size([1236, 28, 28]), y_test: Counter({1: 227, 2: 174, 0: 134, 7: 131, 5: 119, 8: 98, 4: 96, 3: 87, 6: 87, 9: 83})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:04...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 398), (1, 790), (2, 659), (3, 263), (4, 400), (5, 431), (6, 346), (7, 448), (8, 390), (9, 322)])
class_weight: tensor([0.10, 0.05, 0.06, 0.15, 0.10, 0.09, 0.12, 0.09, 0.10, 0.13],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 4.0040, val_loss: 4.0040, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.0507, val_loss: 2.0507, LR: 0.001
Function 'train_cnn' executed in 0.8973 seconds (Start: 2025-11-12 09:53:04, End: 2025-11-12 09:53:05)
dist(local, global): 4.793979167938232
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:05...
Function 'evaluate' executed in 0.0125 seconds (Start: 2025-11-12 09:53:05, End: 2025-11-12 09:53:05)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:05...
Function 'evaluate_shared_test' executed in 0.0262 seconds (Start: 2025-11-12 09:53:05, End: 2025-11-12 09:53:05)

*** server_epoch:1, client_4: Honest... ***
client_4 data (10): {0: 271, 1: 317, 2: 460, 3: 547, 4: 416, 5: 178, 6: 294, 7: 519, 8: 433, 9: 456}
Local_data: 
X: torch.Size([5405, 28, 28]), y(10): {0: 385, 1: 455, 2: 628, 3: 765, 4: 593, 5: 246, 6: 407, 7: 712, 8: 595, 9: 619}, in which, 
	X_train: torch.Size([3891, 28, 28]), y_train: Counter({3: 547, 7: 519, 2: 460, 9: 456, 8: 433, 4: 416, 1: 317, 6: 294, 0: 271, 5: 178})
	X_val: torch.Size([433, 28, 28]), y_val: Counter({3: 63, 7: 60, 4: 59, 8: 47, 2: 44, 9: 39, 1: 36, 6: 31, 0: 30, 5: 24})
	X_test: torch.Size([1081, 28, 28]), y_test: Counter({3: 155, 7: 133, 2: 124, 9: 124, 4: 118, 8: 115, 1: 102, 0: 84, 6: 82, 5: 44})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:06...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 271), (1, 317), (2, 460), (3, 547), (4, 416), (5, 178), (6, 294), (7, 519), (8, 433), (9, 456)])
class_weight: tensor([0.13, 0.11, 0.08, 0.06, 0.08, 0.20, 0.12, 0.07, 0.08, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3.5129, val_loss: 3.5129, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.0581, val_loss: 2.0581, LR: 0.001
Function 'train_cnn' executed in 0.7582 seconds (Start: 2025-11-12 09:53:06, End: 2025-11-12 09:53:06)
dist(local, global): 5.1823248863220215
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:06...
Function 'evaluate' executed in 0.0120 seconds (Start: 2025-11-12 09:53:06, End: 2025-11-12 09:53:06)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:06...
Function 'evaluate_shared_test' executed in 0.0261 seconds (Start: 2025-11-12 09:53:06, End: 2025-11-12 09:53:06)

*** server_epoch:1, client_5: Honest... ***
client_5 data (10): {0: 352, 1: 522, 2: 294, 3: 523, 4: 437, 5: 536, 6: 473, 7: 417, 8: 265, 9: 507}
Local_data: 
X: torch.Size([6009, 28, 28]), y(10): {0: 505, 1: 733, 2: 400, 3: 724, 4: 627, 5: 709, 6: 675, 7: 553, 8: 383, 9: 700}, in which, 
	X_train: torch.Size([4326, 28, 28]), y_train: Counter({5: 536, 3: 523, 1: 522, 9: 507, 6: 473, 4: 437, 7: 417, 0: 352, 2: 294, 8: 265})
	X_val: torch.Size([481, 28, 28]), y_val: Counter({4: 67, 6: 62, 9: 58, 1: 56, 3: 55, 5: 53, 8: 37, 7: 36, 0: 29, 2: 28})
	X_test: torch.Size([1202, 28, 28]), y_test: Counter({1: 155, 3: 146, 6: 140, 9: 135, 0: 124, 4: 123, 5: 120, 7: 100, 8: 81, 2: 78})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:07...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 352), (1, 522), (2, 294), (3, 523), (4, 437), (5, 536), (6, 473), (7, 417), (8, 265), (9, 507)])
class_weight: tensor([0.12, 0.08, 0.14, 0.08, 0.09, 0.08, 0.09, 0.10, 0.15, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3.9915, val_loss: 3.9915, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.0032, val_loss: 2.0032, LR: 0.001
Function 'train_cnn' executed in 0.8874 seconds (Start: 2025-11-12 09:53:07, End: 2025-11-12 09:53:08)
dist(local, global): 5.04365348815918
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:08...
Function 'evaluate' executed in 0.0123 seconds (Start: 2025-11-12 09:53:08, End: 2025-11-12 09:53:08)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:08...
Function 'evaluate_shared_test' executed in 0.0262 seconds (Start: 2025-11-12 09:53:08, End: 2025-11-12 09:53:08)

*** server_epoch:1, client_6: Honest... ***
client_6 data (10): {0: 491, 1: 537, 2: 422, 3: 415, 4: 249, 5: 359, 6: 353, 7: 384, 8: 394, 9: 485}
Local_data: 
X: torch.Size([5680, 28, 28]), y(10): {0: 689, 1: 761, 2: 582, 3: 586, 4: 335, 5: 477, 6: 503, 7: 513, 8: 556, 9: 678}, in which, 
	X_train: torch.Size([4089, 28, 28]), y_train: Counter({1: 537, 0: 491, 9: 485, 2: 422, 3: 415, 8: 394, 7: 384, 5: 359, 6: 353, 4: 249})
	X_val: torch.Size([455, 28, 28]), y_val: Counter({1: 65, 9: 58, 6: 52, 2: 51, 8: 45, 0: 43, 3: 43, 7: 40, 5: 35, 4: 23})
	X_test: torch.Size([1136, 28, 28]), y_test: Counter({1: 159, 0: 155, 9: 135, 3: 128, 8: 117, 2: 109, 6: 98, 7: 89, 5: 83, 4: 63})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:09...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 491), (1, 537), (2, 422), (3, 415), (4, 249), (5, 359), (6, 353), (7, 384), (8, 394), (9, 485)])
class_weight: tensor([0.08, 0.07, 0.09, 0.09, 0.16, 0.11, 0.11, 0.10, 0.10, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 3.7598, val_loss: 3.7598, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1.7410, val_loss: 1.7410, LR: 0.001
Function 'train_cnn' executed in 0.7940 seconds (Start: 2025-11-12 09:53:09, End: 2025-11-12 09:53:10)
dist(local, global): 4.840540885925293
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:10...
Function 'evaluate' executed in 0.0121 seconds (Start: 2025-11-12 09:53:10, End: 2025-11-12 09:53:10)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:10...
Function 'evaluate_shared_test' executed in 0.0263 seconds (Start: 2025-11-12 09:53:10, End: 2025-11-12 09:53:10)

***server_epoch:1, client_7: Byzantine...
client_7 data: {0: 415, 1: 505, 2: 414, 3: 277, 4: 301, 5: 469, 6: 584, 7: 329, 8: 358, 9: 477}
Local_data: 
X: torch.Size([5735, 28, 28]), y(10): {0: 615, 1: 667, 2: 545, 3: 472, 4: 445, 5: 598, 6: 739, 7: 471, 8: 524, 9: 659}, in which, 
	X_train: torch.Size([4129, 28, 28]), y_train: Counter({6: 584, 1: 505, 9: 477, 5: 469, 0: 415, 2: 414, 8: 358, 7: 329, 4: 301, 3: 277})
	X_val: torch.Size([459, 28, 28]), y_val: Counter({6: 67, 1: 61, 9: 55, 0: 45, 5: 44, 7: 41, 2: 40, 8: 39, 3: 34, 4: 33})
	X_test: torch.Size([1147, 28, 28]), y_test: Counter({3: 161, 0: 155, 8: 127, 9: 127, 4: 111, 1: 101, 7: 101, 2: 91, 6: 88, 5: 85})
Function 'train_cnn starts at 2025-11-12 09:53:11...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 415), (1, 505), (2, 414), (3, 277), (4, 301), (5, 469), (6, 584), (7, 329), (8, 358), (9, 477)])
class_weight: tensor([0.09, 0.08, 0.09, 0.14, 0.13, 0.08, 0.07, 0.12, 0.11, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 28.2845, val_loss: 28.2845, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.7407, val_loss: 3.7407, LR: 0.001
Function 'train_cnn' executed in 0.8122 seconds (Start: 2025-11-12 09:53:11, End: 2025-11-12 09:53:11)
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:11...
Function 'evaluate' executed in 0.0120 seconds (Start: 2025-11-12 09:53:11, End: 2025-11-12 09:53:11)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:11...
Function 'evaluate_shared_test' executed in 0.0338 seconds (Start: 2025-11-12 09:53:11, End: 2025-11-12 09:53:11)

***server_epoch:1, client_8: Byzantine...
client_8 data: {0: 221, 1: 276, 2: 351, 3: 719, 4: 434, 5: 511, 6: 430, 7: 731, 8: 212, 9: 452}
Local_data: 
X: torch.Size([6024, 28, 28]), y(10): {0: 392, 1: 354, 2: 601, 3: 918, 4: 613, 5: 700, 6: 667, 7: 904, 8: 316, 9: 559}, in which, 
	X_train: torch.Size([4337, 28, 28]), y_train: Counter({7: 731, 3: 719, 5: 511, 9: 452, 4: 434, 6: 430, 2: 351, 1: 276, 0: 221, 8: 212})
	X_val: torch.Size([482, 28, 28]), y_val: Counter({3: 89, 7: 85, 5: 76, 9: 49, 6: 48, 4: 40, 2: 32, 8: 22, 1: 22, 0: 19})
	X_test: torch.Size([1205, 28, 28]), y_test: Counter({2: 218, 6: 189, 0: 152, 4: 139, 5: 113, 3: 110, 7: 88, 8: 82, 9: 58, 1: 56})
Function 'train_cnn starts at 2025-11-12 09:53:12...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 221), (1, 276), (2, 351), (3, 719), (4, 434), (5, 511), (6, 430), (7, 731), (8, 212), (9, 452)])
class_weight: tensor([0.17, 0.13, 0.10, 0.05, 0.08, 0.07, 0.09, 0.05, 0.17, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 28.9941, val_loss: 28.9941, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.0146, val_loss: 3.0146, LR: 0.001
Function 'train_cnn' executed in 0.8611 seconds (Start: 2025-11-12 09:53:12, End: 2025-11-12 09:53:13)
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:13...
Function 'evaluate' executed in 0.0122 seconds (Start: 2025-11-12 09:53:13, End: 2025-11-12 09:53:13)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:13...
Function 'evaluate_shared_test' executed in 0.0264 seconds (Start: 2025-11-12 09:53:13, End: 2025-11-12 09:53:13)

***server_epoch:1, client_9: Byzantine...
client_9 data: {0: 618, 1: 260, 2: 614, 3: 852, 4: 341, 5: 766, 6: 446, 7: 229, 8: 585, 9: 650}
Local_data: 
X: torch.Size([7447, 28, 28]), y(10): {0: 877, 1: 476, 2: 745, 3: 1084, 4: 569, 5: 947, 6: 685, 7: 417, 8: 740, 9: 907}, in which, 
	X_train: torch.Size([5361, 28, 28]), y_train: Counter({3: 852, 5: 766, 9: 650, 0: 618, 2: 614, 8: 585, 6: 446, 4: 341, 1: 260, 7: 229})
	X_val: torch.Size([596, 28, 28]), y_val: Counter({3: 92, 5: 91, 2: 76, 9: 73, 8: 69, 0: 64, 6: 39, 4: 37, 7: 29, 1: 26})
	X_test: torch.Size([1490, 28, 28]), y_test: Counter({6: 200, 0: 195, 4: 191, 1: 190, 9: 184, 7: 159, 3: 140, 5: 90, 8: 86, 2: 55})
Function 'train_cnn starts at 2025-11-12 09:53:14...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 618), (1, 260), (2, 614), (3, 852), (4, 341), (5, 766), (6, 446), (7, 229), (8, 585), (9, 650)])
class_weight: tensor([0.07, 0.17, 0.07, 0.05, 0.13, 0.06, 0.10, 0.20, 0.08, 0.07],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 31.3473, val_loss: 31.3473, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.5137, val_loss: 3.5137, LR: 0.001
Function 'train_cnn' executed in 1.0441 seconds (Start: 2025-11-12 09:53:14, End: 2025-11-12 09:53:15)
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:15...
Function 'evaluate' executed in 0.0131 seconds (Start: 2025-11-12 09:53:15, End: 2025-11-12 09:53:15)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:15...
Function 'evaluate_shared_test' executed in 0.0255 seconds (Start: 2025-11-12 09:53:15, End: 2025-11-12 09:53:15)

*************** Server Epoch: 1/2, Server Aggregation **************
Function 'aggregate_cnns starts at 2025-11-12 09:53:15...
*aggregate cnn...
each update shape: torch.Size([390378])
Unique weights: tensor([1]), counts: tensor([10])
Chosen update: Counter({4: 89893, 6: 48944, 0: 46856, 1: 45898, 3: 44980, 5: 42684, 2: 41925, 9: 10405, 8: 9768, 7: 9025}), updates[0].shape: (390378,), clients_weights: [1 1 1 1 1 1 1 1 1 1]
median, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], client_updates: min: -0.04, max: 0.04, time taken: 0.0642s, l2_error: 0.96
Function 'aggregate_cnns' executed in 0.1059 seconds (Start: 2025-11-12 09:53:15, End: 2025-11-12 09:53:15)
saving histories to /projects/kunyang/nvflare_py31012/nvflare/data/MNIST/label_flipping/h_7-b_3-5-0.8-10.0-median/0/histories_-n_2.pt.gz

***************************** Final Results (mu+/-std) *************************************

 Final***model_type: global***
*client_0:
	server_epoch_0, train_acc:0.0929-0.0000, val_acc:0.0748-0.0000, test_acc:0.1082-0.0000, shared_acc:0.1040-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.8941-0.0000, val_acc:0.8649-0.0000, test_acc:0.8827-0.0000, shared_acc:0.8938-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_1:
	server_epoch_0, train_acc:0.0944-0.0000, val_acc:0.0798-0.0000, test_acc:0.1090-0.0000, shared_acc:0.1040-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.8807-0.0000, val_acc:0.8514-0.0000, test_acc:0.8927-0.0000, shared_acc:0.8938-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_2:
	server_epoch_0, train_acc:0.0915-0.0000, val_acc:0.0870-0.0000, test_acc:0.1088-0.0000, shared_acc:0.1040-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.8851-0.0000, val_acc:0.8705-0.0000, test_acc:0.8810-0.0000, shared_acc:0.8938-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_3:
	server_epoch_0, train_acc:0.0996-0.0000, val_acc:0.0889-0.0000, test_acc:0.1125-0.0000, shared_acc:0.1040-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.8961-0.0000, val_acc:0.9071-0.0000, test_acc:0.9021-0.0000, shared_acc:0.8938-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_4:
	server_epoch_0, train_acc:0.0735-0.0000, val_acc:0.0693-0.0000, test_acc:0.0786-0.0000, shared_acc:0.1040-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.8761-0.0000, val_acc:0.9076-0.0000, test_acc:0.8788-0.0000, shared_acc:0.8938-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_5:
	server_epoch_0, train_acc:0.0929-0.0000, val_acc:0.0624-0.0000, test_acc:0.1098-0.0000, shared_acc:0.1040-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.8858-0.0000, val_acc:0.8940-0.0000, test_acc:0.8819-0.0000, shared_acc:0.8938-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_6:
	server_epoch_0, train_acc:0.1245-0.0000, val_acc:0.0923-0.0000, test_acc:0.1408-0.0000, shared_acc:0.1040-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.8919-0.0000, val_acc:0.8681-0.0000, test_acc:0.8996-0.0000, shared_acc:0.8938-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_7:
	server_epoch_0, train_acc:0.1078-0.0000, val_acc:0.1068-0.0000, test_acc:0.1386-0.0000, shared_acc:0.1040-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.0124-0.0000, val_acc:0.0109-0.0000, test_acc:0.8649-0.0000, shared_acc:0.8938-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_8:
	server_epoch_0, train_acc:0.0620-0.0000, val_acc:0.0539-0.0000, test_acc:0.1344-0.0000, shared_acc:0.1040-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.0092-0.0000, val_acc:0.0083-0.0000, test_acc:0.8871-0.0000, shared_acc:0.8938-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_9:
	server_epoch_0, train_acc:0.1263-0.0000, val_acc:0.1191-0.0000, test_acc:0.1329-0.0000, shared_acc:0.1040-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.0110-0.0000, val_acc:0.0134-0.0000, test_acc:0.9013-0.0000, shared_acc:0.8938-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 

 Final***model_type: local***
*client_0:
	server_epoch_0, train_acc:0.8948-0.0000, val_acc:0.8316-0.0000, test_acc:0.8810-0.0000, shared_acc:0.8744-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.9346-0.0000, val_acc:0.8940-0.0000, test_acc:0.9143-0.0000, shared_acc:0.9204-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_1:
	server_epoch_0, train_acc:0.8871-0.0000, val_acc:0.8603-0.0000, test_acc:0.8910-0.0000, shared_acc:0.8899-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.9145-0.0000, val_acc:0.8980-0.0000, test_acc:0.9069-0.0000, shared_acc:0.9107-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_2:
	server_epoch_0, train_acc:0.8783-0.0000, val_acc:0.8662-0.0000, test_acc:0.8793-0.0000, shared_acc:0.8497-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.9246-0.0000, val_acc:0.9151-0.0000, test_acc:0.9184-0.0000, shared_acc:0.9083-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_3:
	server_epoch_0, train_acc:0.8977-0.0000, val_acc:0.8808-0.0000, test_acc:0.8794-0.0000, shared_acc:0.8810-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.9409-0.0000, val_acc:0.9333-0.0000, test_acc:0.9223-0.0000, shared_acc:0.9181-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_4:
	server_epoch_0, train_acc:0.8928-0.0000, val_acc:0.8637-0.0000, test_acc:0.8908-0.0000, shared_acc:0.8869-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.9244-0.0000, val_acc:0.9261-0.0000, test_acc:0.9167-0.0000, shared_acc:0.9122-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_5:
	server_epoch_0, train_acc:0.9059-0.0000, val_acc:0.9085-0.0000, test_acc:0.8935-0.0000, shared_acc:0.8983-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.9355-0.0000, val_acc:0.9272-0.0000, test_acc:0.9176-0.0000, shared_acc:0.9219-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_6:
	server_epoch_0, train_acc:0.8564-0.0000, val_acc:0.8308-0.0000, test_acc:0.8504-0.0000, shared_acc:0.8474-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.9435-0.0000, val_acc:0.9055-0.0000, test_acc:0.9243-0.0000, shared_acc:0.9295-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_7:
	server_epoch_0, train_acc:0.8404-0.0000, val_acc:0.8453-0.0000, test_acc:0.0201-0.0000, shared_acc:0.0166-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.8576-0.0000, val_acc:0.8584-0.0000, test_acc:0.0113-0.0000, shared_acc:0.0116-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_8:
	server_epoch_0, train_acc:0.8937-0.0000, val_acc:0.8817-0.0000, test_acc:0.0025-0.0000, shared_acc:0.0107-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.9126-0.0000, val_acc:0.9087-0.0000, test_acc:0.0124-0.0000, shared_acc:0.0155-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
*client_9:
	server_epoch_0, train_acc:0.9215-0.0000, val_acc:0.9262-0.0000, test_acc:0.0101-0.0000, shared_acc:0.0122-0.0000, l2_error:1.3247-0.0000, time_taken:0.0583-0.0000, 
	server_epoch_1, train_acc:0.9101-0.0000, val_acc:0.9060-0.0000, test_acc:0.0181-0.0000, shared_acc:0.0167-0.0000, l2_error:0.9618-0.0000, time_taken:0.0642-0.0000, 
Function 'main' executed in 73.5465 seconds (Start: 2025-11-12 09:52:02, End: 2025-11-12 09:53:15)
