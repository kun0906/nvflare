/users/kunyang/nvflare/auto_labeling
current directory: /users/kunyang/nvflare/auto_labeling
current file: /users/kunyang/nvflare/auto_labeling/ICONIP/ragg_model_large_value_mnist.py
NVIDIA A100-SXM4-80GB
GPU: 79.25 GB
Device: cuda
Function 'main starts at 2025-11-12 09:52:03...


Namespace(labeling_rate=10.0, server_epochs=2, num_clients=10, aggregation_method='mean', verbose=5)
NUM_CLIENTS: 10, in which NUM_HONEST_CLIENTS: 7 and NUM_BYZANTINE_CLIENTS: 3
{'SEED': 42, 'TRAIN_VAL_SEED': 0, 'DEVICE': device(type='cuda'), 'VERBOSE': 5, 'LABELING_RATE': 0.8, 'BIG_NUMBER': 10.0, 'SERVER_EPOCHS': 2, 'CLIENT_EPOCHS': 5, 'BATCH_SIZE': 512, 'IID_CLASSES_CNT': 5, 'NUM_CLIENTS': 10, 'NUM_BYZANTINE_CLIENTS': 3, 'NUM_HONEST_CLIENTS': 7, 'AGGREGATION_METHOD': 'mean', 'LABELS': {0, 1, 2, 3, 4, 5, 6, 7, 8, 9}, 'NUM_CLASSES': 10, 'CNN': <class 'ragg.base.CNN'>}

*************************** Generate Clients Data ******************************
Function 'gen_client_data starts at 2025-11-12 09:52:03...
X.shape: (60000, 28, 28), y.shape: (60000,)

	: size, Client_0,  Client_1,  Client_2,  Client_3,  Client_4,  Client_5,  Client_6,  Client_7,  Client_8,  Client_9
class 0:  5923 [481, 528, 502, 575, 385, 505, 689, 687, 653, 918] , alpha: 10.0
class 1:  6742 [664, 660, 728, 1109, 455, 733, 761, 498, 290, 844] , alpha: 10.0
class 2:  5958 [506, 507, 630, 897, 628, 400, 582, 461, 1034, 313] , alpha: 10.0
class 3:  6131 [643, 683, 320, 385, 765, 724, 586, 812, 588, 625] , alpha: 10.0
class 4:  5842 [581, 542, 215, 551, 593, 627, 335, 624, 726, 1048] , alpha: 10.0
class 5:  5421 [856, 351, 710, 598, 246, 709, 477, 419, 587, 468] , alpha: 10.0
class 6:  5918 [406, 327, 587, 473, 407, 675, 503, 399, 997, 1144] , alpha: 10.0
class 7:  6265 [777, 681, 524, 630, 712, 553, 513, 555, 471, 849] , alpha: 10.0
class 8:  5851 [307, 847, 1191, 527, 595, 383, 556, 693, 380, 372] , alpha: 10.0
class 9:  5949 [787, 511, 470, 433, 619, 700, 678, 587, 298, 866] , alpha: 10.0
client 0's data size: 5735, total classes: 10, in which {0: 687, 1: 498, 2: 461, 3: 812, 4: 624, 5: 419, 6: 399, 7: 555, 8: 693, 9: 587}
client 1's data size: 6178, total classes: 10, in which {0: 575, 1: 1109, 2: 897, 3: 385, 4: 551, 5: 598, 6: 473, 7: 630, 8: 527, 9: 433}
client 2's data size: 5877, total classes: 10, in which {0: 502, 1: 728, 2: 630, 3: 320, 4: 215, 5: 710, 6: 587, 7: 524, 8: 1191, 9: 470}
client 3's data size: 6024, total classes: 10, in which {0: 653, 1: 290, 2: 1034, 3: 588, 4: 726, 5: 587, 6: 997, 7: 471, 8: 380, 9: 298}
client 4's data size: 6009, total classes: 10, in which {0: 505, 1: 733, 2: 400, 3: 724, 4: 627, 5: 709, 6: 675, 7: 553, 8: 383, 9: 700}
client 5's data size: 5680, total classes: 10, in which {0: 689, 1: 761, 2: 582, 3: 586, 4: 335, 5: 477, 6: 503, 7: 513, 8: 556, 9: 678}
client 6's data size: 7447, total classes: 10, in which {0: 918, 1: 844, 2: 313, 3: 625, 4: 1048, 5: 468, 6: 1144, 7: 849, 8: 372, 9: 866}
client 7's data size: 5405, total classes: 10, in which {0: 385, 1: 455, 2: 628, 3: 765, 4: 593, 5: 246, 6: 407, 7: 712, 8: 595, 9: 619}
client 8's data size: 6008, total classes: 10, in which {0: 481, 1: 664, 2: 506, 3: 643, 4: 581, 5: 856, 6: 406, 7: 777, 8: 307, 9: 787}
client 9's data size: 5637, total classes: 10, in which {0: 528, 1: 660, 2: 507, 3: 683, 4: 542, 5: 351, 6: 327, 7: 681, 8: 847, 9: 511}
total size: 60000

*** client_0: Honest...
client_0 data (10):  {0: 687, 1: 498, 2: 461, 3: 812, 4: 624, 5: 419, 6: 399, 7: 555, 8: 693, 9: 587}
Local_data: 
X: torch.Size([5735, 28, 28]), y(10): {0: 687, 1: 498, 2: 461, 3: 812, 4: 624, 5: 419, 6: 399, 7: 555, 8: 693, 9: 587}, in which, 
	X_train: torch.Size([4129, 28, 28]), y_train: Counter({3: 584, 8: 505, 0: 477, 4: 469, 9: 415, 7: 414, 1: 358, 2: 329, 5: 301, 6: 277})
	X_val: torch.Size([459, 28, 28]), y_val: Counter({3: 67, 8: 61, 0: 55, 9: 45, 4: 44, 2: 41, 7: 40, 1: 39, 6: 34, 5: 33})
	X_test: torch.Size([1147, 28, 28]), y_test: Counter({3: 161, 0: 155, 8: 127, 9: 127, 4: 111, 1: 101, 7: 101, 2: 91, 6: 88, 5: 85})

*** client_1: Honest...
client_1 data (10):  {0: 575, 1: 1109, 2: 897, 3: 385, 4: 551, 5: 598, 6: 473, 7: 630, 8: 527, 9: 433}
Local_data: 
X: torch.Size([6178, 28, 28]), y(10): {0: 575, 1: 1109, 2: 897, 3: 385, 4: 551, 5: 598, 6: 473, 7: 630, 8: 527, 9: 433}, in which, 
	X_train: torch.Size([4447, 28, 28]), y_train: Counter({1: 790, 2: 659, 7: 448, 5: 431, 4: 400, 0: 398, 8: 390, 6: 346, 9: 322, 3: 263})
	X_val: torch.Size([495, 28, 28]), y_val: Counter({1: 92, 2: 64, 4: 55, 7: 51, 5: 48, 0: 43, 6: 40, 8: 39, 3: 35, 9: 28})
	X_test: torch.Size([1236, 28, 28]), y_test: Counter({1: 227, 2: 174, 0: 134, 7: 131, 5: 119, 8: 98, 4: 96, 3: 87, 6: 87, 9: 83})

*** client_2: Honest...
client_2 data (10):  {0: 502, 1: 728, 2: 630, 3: 320, 4: 215, 5: 710, 6: 587, 7: 524, 8: 1191, 9: 470}
Local_data: 
X: torch.Size([5877, 28, 28]), y(10): {0: 502, 1: 728, 2: 630, 3: 320, 4: 215, 5: 710, 6: 587, 7: 524, 8: 1191, 9: 470}, in which, 
	X_train: torch.Size([4230, 28, 28]), y_train: Counter({8: 855, 1: 515, 5: 514, 2: 468, 6: 436, 7: 381, 0: 354, 9: 325, 3: 228, 4: 154})
	X_val: torch.Size([471, 28, 28]), y_val: Counter({8: 113, 1: 63, 5: 61, 6: 43, 7: 42, 2: 38, 9: 38, 3: 31, 0: 30, 4: 12})
	X_test: torch.Size([1176, 28, 28]), y_test: Counter({8: 223, 1: 150, 5: 135, 2: 124, 0: 118, 6: 108, 9: 107, 7: 101, 3: 61, 4: 49})

*** client_3: Honest...
client_3 data (10):  {0: 653, 1: 290, 2: 1034, 3: 588, 4: 726, 5: 587, 6: 997, 7: 471, 8: 380, 9: 298}
Local_data: 
X: torch.Size([6024, 28, 28]), y(10): {0: 653, 1: 290, 2: 1034, 3: 588, 4: 726, 5: 587, 6: 997, 7: 471, 8: 380, 9: 298}, in which, 
	X_train: torch.Size([4337, 28, 28]), y_train: Counter({2: 731, 6: 719, 4: 511, 0: 452, 5: 434, 3: 430, 7: 351, 8: 276, 9: 221, 1: 212})
	X_val: torch.Size([482, 28, 28]), y_val: Counter({6: 89, 2: 85, 4: 76, 0: 49, 3: 48, 5: 40, 7: 32, 1: 22, 8: 22, 9: 19})
	X_test: torch.Size([1205, 28, 28]), y_test: Counter({2: 218, 6: 189, 0: 152, 4: 139, 5: 113, 3: 110, 7: 88, 8: 82, 9: 58, 1: 56})

*** client_4: Honest...
client_4 data (10):  {0: 505, 1: 733, 2: 400, 3: 724, 4: 627, 5: 709, 6: 675, 7: 553, 8: 383, 9: 700}
Local_data: 
X: torch.Size([6009, 28, 28]), y(10): {0: 505, 1: 733, 2: 400, 3: 724, 4: 627, 5: 709, 6: 675, 7: 553, 8: 383, 9: 700}, in which, 
	X_train: torch.Size([4326, 28, 28]), y_train: Counter({5: 536, 3: 523, 1: 522, 9: 507, 6: 473, 4: 437, 7: 417, 0: 352, 2: 294, 8: 265})
	X_val: torch.Size([481, 28, 28]), y_val: Counter({4: 67, 6: 62, 9: 58, 1: 56, 3: 55, 5: 53, 8: 37, 7: 36, 0: 29, 2: 28})
	X_test: torch.Size([1202, 28, 28]), y_test: Counter({1: 155, 3: 146, 6: 140, 9: 135, 0: 124, 4: 123, 5: 120, 7: 100, 8: 81, 2: 78})

*** client_5: Honest...
client_5 data (10):  {0: 689, 1: 761, 2: 582, 3: 586, 4: 335, 5: 477, 6: 503, 7: 513, 8: 556, 9: 678}
Local_data: 
X: torch.Size([5680, 28, 28]), y(10): {0: 689, 1: 761, 2: 582, 3: 586, 4: 335, 5: 477, 6: 503, 7: 513, 8: 556, 9: 678}, in which, 
	X_train: torch.Size([4089, 28, 28]), y_train: Counter({1: 537, 0: 491, 9: 485, 2: 422, 3: 415, 8: 394, 7: 384, 5: 359, 6: 353, 4: 249})
	X_val: torch.Size([455, 28, 28]), y_val: Counter({1: 65, 9: 58, 6: 52, 2: 51, 8: 45, 0: 43, 3: 43, 7: 40, 5: 35, 4: 23})
	X_test: torch.Size([1136, 28, 28]), y_test: Counter({1: 159, 0: 155, 9: 135, 3: 128, 8: 117, 2: 109, 6: 98, 7: 89, 5: 83, 4: 63})

*** client_6: Honest...
client_6 data (10):  {0: 918, 1: 844, 2: 313, 3: 625, 4: 1048, 5: 468, 6: 1144, 7: 849, 8: 372, 9: 866}
Local_data: 
X: torch.Size([7447, 28, 28]), y(10): {0: 918, 1: 844, 2: 313, 3: 625, 4: 1048, 5: 468, 6: 1144, 7: 849, 8: 372, 9: 866}, in which, 
	X_train: torch.Size([5361, 28, 28]), y_train: Counter({6: 852, 4: 766, 0: 650, 9: 618, 7: 614, 1: 585, 3: 446, 5: 341, 8: 260, 2: 229})
	X_val: torch.Size([596, 28, 28]), y_val: Counter({6: 92, 4: 91, 7: 76, 0: 73, 1: 69, 9: 64, 3: 39, 5: 37, 2: 29, 8: 26})
	X_test: torch.Size([1490, 28, 28]), y_test: Counter({6: 200, 0: 195, 4: 191, 1: 190, 9: 184, 7: 159, 3: 140, 5: 90, 8: 86, 2: 55})

*** client_7: Byzantine...
client_7 data (10):  {0: 385, 1: 455, 2: 628, 3: 765, 4: 593, 5: 246, 6: 407, 7: 712, 8: 595, 9: 619}
Local_data: 
X: torch.Size([5405, 28, 28]), y(10): {0: 385, 1: 455, 2: 628, 3: 765, 4: 593, 5: 246, 6: 407, 7: 712, 8: 595, 9: 619}, in which, 
	X_train: torch.Size([3891, 28, 28]), y_train: Counter({3: 547, 7: 519, 2: 460, 9: 456, 8: 433, 4: 416, 1: 317, 6: 294, 0: 271, 5: 178})
	X_val: torch.Size([433, 28, 28]), y_val: Counter({3: 63, 7: 60, 4: 59, 8: 47, 2: 44, 9: 39, 1: 36, 6: 31, 0: 30, 5: 24})
	X_test: torch.Size([1081, 28, 28]), y_test: Counter({3: 155, 7: 133, 2: 124, 9: 124, 4: 118, 8: 115, 1: 102, 0: 84, 6: 82, 5: 44})

*** client_8: Byzantine...
client_8 data (10):  {0: 481, 1: 664, 2: 506, 3: 643, 4: 581, 5: 856, 6: 406, 7: 777, 8: 307, 9: 787}
Local_data: 
X: torch.Size([6008, 28, 28]), y(10): {0: 481, 1: 664, 2: 506, 3: 643, 4: 581, 5: 856, 6: 406, 7: 777, 8: 307, 9: 787}, in which, 
	X_train: torch.Size([4325, 28, 28]), y_train: Counter({5: 636, 7: 573, 9: 552, 1: 484, 3: 474, 4: 415, 2: 355, 0: 331, 6: 287, 8: 218})
	X_val: torch.Size([481, 28, 28]), y_val: Counter({5: 69, 9: 67, 7: 57, 4: 51, 1: 47, 3: 44, 2: 43, 6: 38, 8: 33, 0: 32})
	X_test: torch.Size([1202, 28, 28]), y_test: Counter({9: 168, 5: 151, 7: 147, 1: 133, 3: 125, 0: 118, 4: 115, 2: 108, 6: 81, 8: 56})

*** client_9: Byzantine...
client_9 data (10):  {0: 528, 1: 660, 2: 507, 3: 683, 4: 542, 5: 351, 6: 327, 7: 681, 8: 847, 9: 511}
Local_data: 
X: torch.Size([5637, 28, 28]), y(10): {0: 528, 1: 660, 2: 507, 3: 683, 4: 542, 5: 351, 6: 327, 7: 681, 8: 847, 9: 511}, in which, 
	X_train: torch.Size([4058, 28, 28]), y_train: Counter({8: 619, 3: 514, 7: 480, 1: 471, 4: 385, 9: 375, 0: 372, 2: 355, 5: 249, 6: 238})
	X_val: torch.Size([451, 28, 28]), y_val: Counter({8: 69, 7: 65, 3: 51, 1: 49, 2: 46, 4: 42, 0: 35, 9: 35, 5: 34, 6: 25})
	X_test: torch.Size([1128, 28, 28]), y_test: Counter({8: 159, 1: 140, 7: 136, 0: 121, 3: 118, 4: 115, 2: 106, 9: 101, 5: 68, 6: 64})
Function 'gen_client_data' executed in 38.7277 seconds (Start: 2025-11-12 09:52:03, End: 2025-11-12 09:52:42)

***************************** Global Models *************************************
CNN(
  (conv1): Conv2d(1, 16, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv11): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv21): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv3): Conv2d(32, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv31): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (fc1): Linear(in_features=576, out_features=512, bias=True)
  (fc2): Linear(in_features=512, out_features=10, bias=True)
  (leaky_relu): LeakyReLU(negative_slope=0.2)
)

*************** Server Epoch: 0/2, Client Training *************

*** server_epoch:0, client_0: Honest... ***
client_0 data (10): {0: 477, 1: 358, 2: 329, 3: 584, 4: 469, 5: 301, 6: 277, 7: 414, 8: 505, 9: 415}
Local_data: 
X: torch.Size([5735, 28, 28]), y(10): {0: 687, 1: 498, 2: 461, 3: 812, 4: 624, 5: 419, 6: 399, 7: 555, 8: 693, 9: 587}, in which, 
	X_train: torch.Size([4129, 28, 28]), y_train: Counter({3: 584, 8: 505, 0: 477, 4: 469, 9: 415, 7: 414, 1: 358, 2: 329, 5: 301, 6: 277})
	X_val: torch.Size([459, 28, 28]), y_val: Counter({3: 67, 8: 61, 0: 55, 9: 45, 4: 44, 2: 41, 7: 40, 1: 39, 6: 34, 5: 33})
	X_test: torch.Size([1147, 28, 28]), y_test: Counter({3: 161, 0: 155, 8: 127, 9: 127, 4: 111, 1: 101, 7: 101, 2: 91, 6: 88, 5: 85})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:43...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 477), (1, 358), (2, 329), (3, 584), (4, 469), (5, 301), (6, 277), (7, 414), (8, 505), (9, 415)])
class_weight: tensor([0.08, 0.11, 0.12, 0.07, 0.08, 0.13, 0.14, 0.09, 0.08, 0.09],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 18.3674, val_loss: 18.3674, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.9172, val_loss: 3.9172, LR: 0.001
Function 'train_cnn' executed in 1.1076 seconds (Start: 2025-11-12 09:52:43, End: 2025-11-12 09:52:44)
dist(local, global): 10.520020484924316
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:44...
Function 'evaluate' executed in 0.0539 seconds (Start: 2025-11-12 09:52:44, End: 2025-11-12 09:52:44)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:44...
Function 'evaluate_shared_test' executed in 0.0408 seconds (Start: 2025-11-12 09:52:44, End: 2025-11-12 09:52:44)

*** server_epoch:0, client_1: Honest... ***
client_1 data (10): {0: 398, 1: 790, 2: 659, 3: 263, 4: 400, 5: 431, 6: 346, 7: 448, 8: 390, 9: 322}
Local_data: 
X: torch.Size([6178, 28, 28]), y(10): {0: 575, 1: 1109, 2: 897, 3: 385, 4: 551, 5: 598, 6: 473, 7: 630, 8: 527, 9: 433}, in which, 
	X_train: torch.Size([4447, 28, 28]), y_train: Counter({1: 790, 2: 659, 7: 448, 5: 431, 4: 400, 0: 398, 8: 390, 6: 346, 9: 322, 3: 263})
	X_val: torch.Size([495, 28, 28]), y_val: Counter({1: 92, 2: 64, 4: 55, 7: 51, 5: 48, 0: 43, 6: 40, 8: 39, 3: 35, 9: 28})
	X_test: torch.Size([1236, 28, 28]), y_test: Counter({1: 227, 2: 174, 0: 134, 7: 131, 5: 119, 8: 98, 4: 96, 3: 87, 6: 87, 9: 83})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:45...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 398), (1, 790), (2, 659), (3, 263), (4, 400), (5, 431), (6, 346), (7, 448), (8, 390), (9, 322)])
class_weight: tensor([0.10, 0.05, 0.06, 0.15, 0.10, 0.09, 0.12, 0.09, 0.10, 0.13],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 18.5438, val_loss: 18.5438, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.2277, val_loss: 3.2277, LR: 0.001
Function 'train_cnn' executed in 0.8929 seconds (Start: 2025-11-12 09:52:45, End: 2025-11-12 09:52:46)
dist(local, global): 10.459977149963379
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:46...
Function 'evaluate' executed in 0.0139 seconds (Start: 2025-11-12 09:52:46, End: 2025-11-12 09:52:46)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:46...
Function 'evaluate_shared_test' executed in 0.0298 seconds (Start: 2025-11-12 09:52:46, End: 2025-11-12 09:52:46)

*** server_epoch:0, client_2: Honest... ***
client_2 data (10): {0: 354, 1: 515, 2: 468, 3: 228, 4: 154, 5: 514, 6: 436, 7: 381, 8: 855, 9: 325}
Local_data: 
X: torch.Size([5877, 28, 28]), y(10): {0: 502, 1: 728, 2: 630, 3: 320, 4: 215, 5: 710, 6: 587, 7: 524, 8: 1191, 9: 470}, in which, 
	X_train: torch.Size([4230, 28, 28]), y_train: Counter({8: 855, 1: 515, 5: 514, 2: 468, 6: 436, 7: 381, 0: 354, 9: 325, 3: 228, 4: 154})
	X_val: torch.Size([471, 28, 28]), y_val: Counter({8: 113, 1: 63, 5: 61, 6: 43, 7: 42, 2: 38, 9: 38, 3: 31, 0: 30, 4: 12})
	X_test: torch.Size([1176, 28, 28]), y_test: Counter({8: 223, 1: 150, 5: 135, 2: 124, 0: 118, 6: 108, 9: 107, 7: 101, 3: 61, 4: 49})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:47...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 354), (1, 515), (2, 468), (3, 228), (4, 154), (5, 514), (6, 436), (7, 381), (8, 855), (9, 325)])
class_weight: tensor([0.10, 0.07, 0.07, 0.15, 0.22, 0.07, 0.08, 0.09, 0.04, 0.11],
       device='cuda:0'), sum(class_weight) = 0.9999999403953552
train_cnn epoch: 0, local_cnn train loss: 18.4860, val_loss: 18.4860, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.3075, val_loss: 3.3075, LR: 0.001
Function 'train_cnn' executed in 0.8727 seconds (Start: 2025-11-12 09:52:47, End: 2025-11-12 09:52:48)
dist(local, global): 10.641938209533691
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:48...
Function 'evaluate' executed in 0.0136 seconds (Start: 2025-11-12 09:52:48, End: 2025-11-12 09:52:48)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:48...
Function 'evaluate_shared_test' executed in 0.0299 seconds (Start: 2025-11-12 09:52:48, End: 2025-11-12 09:52:48)

*** server_epoch:0, client_3: Honest... ***
client_3 data (10): {0: 452, 1: 212, 2: 731, 3: 430, 4: 511, 5: 434, 6: 719, 7: 351, 8: 276, 9: 221}
Local_data: 
X: torch.Size([6024, 28, 28]), y(10): {0: 653, 1: 290, 2: 1034, 3: 588, 4: 726, 5: 587, 6: 997, 7: 471, 8: 380, 9: 298}, in which, 
	X_train: torch.Size([4337, 28, 28]), y_train: Counter({2: 731, 6: 719, 4: 511, 0: 452, 5: 434, 3: 430, 7: 351, 8: 276, 9: 221, 1: 212})
	X_val: torch.Size([482, 28, 28]), y_val: Counter({6: 89, 2: 85, 4: 76, 0: 49, 3: 48, 5: 40, 7: 32, 1: 22, 8: 22, 9: 19})
	X_test: torch.Size([1205, 28, 28]), y_test: Counter({2: 218, 6: 189, 0: 152, 4: 139, 5: 113, 3: 110, 7: 88, 8: 82, 9: 58, 1: 56})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:48...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 452), (1, 212), (2, 731), (3, 430), (4, 511), (5, 434), (6, 719), (7, 351), (8, 276), (9, 221)])
class_weight: tensor([0.08, 0.17, 0.05, 0.09, 0.07, 0.08, 0.05, 0.10, 0.13, 0.17],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 18.2760, val_loss: 18.2760, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.8764, val_loss: 2.8764, LR: 0.001
Function 'train_cnn' executed in 0.9896 seconds (Start: 2025-11-12 09:52:48, End: 2025-11-12 09:52:49)
dist(local, global): 10.590551376342773
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:49...
Function 'evaluate' executed in 0.0138 seconds (Start: 2025-11-12 09:52:49, End: 2025-11-12 09:52:49)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:49...
Function 'evaluate_shared_test' executed in 0.0295 seconds (Start: 2025-11-12 09:52:49, End: 2025-11-12 09:52:49)

*** server_epoch:0, client_4: Honest... ***
client_4 data (10): {0: 352, 1: 522, 2: 294, 3: 523, 4: 437, 5: 536, 6: 473, 7: 417, 8: 265, 9: 507}
Local_data: 
X: torch.Size([6009, 28, 28]), y(10): {0: 505, 1: 733, 2: 400, 3: 724, 4: 627, 5: 709, 6: 675, 7: 553, 8: 383, 9: 700}, in which, 
	X_train: torch.Size([4326, 28, 28]), y_train: Counter({5: 536, 3: 523, 1: 522, 9: 507, 6: 473, 4: 437, 7: 417, 0: 352, 2: 294, 8: 265})
	X_val: torch.Size([481, 28, 28]), y_val: Counter({4: 67, 6: 62, 9: 58, 1: 56, 3: 55, 5: 53, 8: 37, 7: 36, 0: 29, 2: 28})
	X_test: torch.Size([1202, 28, 28]), y_test: Counter({1: 155, 3: 146, 6: 140, 9: 135, 0: 124, 4: 123, 5: 120, 7: 100, 8: 81, 2: 78})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:50...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 352), (1, 522), (2, 294), (3, 523), (4, 437), (5, 536), (6, 473), (7, 417), (8, 265), (9, 507)])
class_weight: tensor([0.12, 0.08, 0.14, 0.08, 0.09, 0.08, 0.09, 0.10, 0.15, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 18.0174, val_loss: 18.0174, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.0069, val_loss: 3.0069, LR: 0.001
Function 'train_cnn' executed in 0.8574 seconds (Start: 2025-11-12 09:52:50, End: 2025-11-12 09:52:51)
dist(local, global): 10.560128211975098
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:51...
Function 'evaluate' executed in 0.0137 seconds (Start: 2025-11-12 09:52:51, End: 2025-11-12 09:52:51)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:51...
Function 'evaluate_shared_test' executed in 0.0293 seconds (Start: 2025-11-12 09:52:51, End: 2025-11-12 09:52:51)

*** server_epoch:0, client_5: Honest... ***
client_5 data (10): {0: 491, 1: 537, 2: 422, 3: 415, 4: 249, 5: 359, 6: 353, 7: 384, 8: 394, 9: 485}
Local_data: 
X: torch.Size([5680, 28, 28]), y(10): {0: 689, 1: 761, 2: 582, 3: 586, 4: 335, 5: 477, 6: 503, 7: 513, 8: 556, 9: 678}, in which, 
	X_train: torch.Size([4089, 28, 28]), y_train: Counter({1: 537, 0: 491, 9: 485, 2: 422, 3: 415, 8: 394, 7: 384, 5: 359, 6: 353, 4: 249})
	X_val: torch.Size([455, 28, 28]), y_val: Counter({1: 65, 9: 58, 6: 52, 2: 51, 8: 45, 0: 43, 3: 43, 7: 40, 5: 35, 4: 23})
	X_test: torch.Size([1136, 28, 28]), y_test: Counter({1: 159, 0: 155, 9: 135, 3: 128, 8: 117, 2: 109, 6: 98, 7: 89, 5: 83, 4: 63})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:52...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 491), (1, 537), (2, 422), (3, 415), (4, 249), (5, 359), (6, 353), (7, 384), (8, 394), (9, 485)])
class_weight: tensor([0.08, 0.07, 0.09, 0.09, 0.16, 0.11, 0.11, 0.10, 0.10, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 16.6060, val_loss: 16.6060, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.0898, val_loss: 3.0898, LR: 0.001
Function 'train_cnn' executed in 0.8168 seconds (Start: 2025-11-12 09:52:52, End: 2025-11-12 09:52:53)
dist(local, global): 10.215006828308105
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:53...
Function 'evaluate' executed in 0.0135 seconds (Start: 2025-11-12 09:52:53, End: 2025-11-12 09:52:53)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:53...
Function 'evaluate_shared_test' executed in 0.0295 seconds (Start: 2025-11-12 09:52:53, End: 2025-11-12 09:52:53)

*** server_epoch:0, client_6: Honest... ***
client_6 data (10): {0: 650, 1: 585, 2: 229, 3: 446, 4: 766, 5: 341, 6: 852, 7: 614, 8: 260, 9: 618}
Local_data: 
X: torch.Size([7447, 28, 28]), y(10): {0: 918, 1: 844, 2: 313, 3: 625, 4: 1048, 5: 468, 6: 1144, 7: 849, 8: 372, 9: 866}, in which, 
	X_train: torch.Size([5361, 28, 28]), y_train: Counter({6: 852, 4: 766, 0: 650, 9: 618, 7: 614, 1: 585, 3: 446, 5: 341, 8: 260, 2: 229})
	X_val: torch.Size([596, 28, 28]), y_val: Counter({6: 92, 4: 91, 7: 76, 0: 73, 1: 69, 9: 64, 3: 39, 5: 37, 2: 29, 8: 26})
	X_test: torch.Size([1490, 28, 28]), y_test: Counter({6: 200, 0: 195, 4: 191, 1: 190, 9: 184, 7: 159, 3: 140, 5: 90, 8: 86, 2: 55})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:54...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 650), (1, 585), (2, 229), (3, 446), (4, 766), (5, 341), (6, 852), (7, 614), (8, 260), (9, 618)])
class_weight: tensor([0.07, 0.08, 0.20, 0.10, 0.06, 0.13, 0.05, 0.07, 0.17, 0.07],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 20.6135, val_loss: 20.6135, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.4206, val_loss: 3.4206, LR: 0.001
Function 'train_cnn' executed in 1.0989 seconds (Start: 2025-11-12 09:52:54, End: 2025-11-12 09:52:55)
dist(local, global): 10.886112213134766
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:55...
Function 'evaluate' executed in 0.0147 seconds (Start: 2025-11-12 09:52:55, End: 2025-11-12 09:52:55)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:55...
Function 'evaluate_shared_test' executed in 0.0294 seconds (Start: 2025-11-12 09:52:55, End: 2025-11-12 09:52:55)

***server_epoch:0, client_7: Byzantine...
client_7 data: {0: 271, 1: 317, 2: 460, 3: 547, 4: 416, 5: 178, 6: 294, 7: 519, 8: 433, 9: 456}
Local_data: 
X: torch.Size([5405, 28, 28]), y(10): {0: 385, 1: 455, 2: 628, 3: 765, 4: 593, 5: 246, 6: 407, 7: 712, 8: 595, 9: 619}, in which, 
	X_train: torch.Size([3891, 28, 28]), y_train: Counter({3: 547, 7: 519, 2: 460, 9: 456, 8: 433, 4: 416, 1: 317, 6: 294, 0: 271, 5: 178})
	X_val: torch.Size([433, 28, 28]), y_val: Counter({3: 63, 7: 60, 4: 59, 8: 47, 2: 44, 9: 39, 1: 36, 6: 31, 0: 30, 5: 24})
	X_test: torch.Size([1081, 28, 28]), y_test: Counter({3: 155, 7: 133, 2: 124, 9: 124, 4: 118, 8: 115, 1: 102, 0: 84, 6: 82, 5: 44})
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:56...
Function 'evaluate' executed in 0.0134 seconds (Start: 2025-11-12 09:52:56, End: 2025-11-12 09:52:56)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:56...
Function 'evaluate_shared_test' executed in 0.0384 seconds (Start: 2025-11-12 09:52:56, End: 2025-11-12 09:52:56)

***server_epoch:0, client_8: Byzantine...
client_8 data: {0: 331, 1: 484, 2: 355, 3: 474, 4: 415, 5: 636, 6: 287, 7: 573, 8: 218, 9: 552}
Local_data: 
X: torch.Size([6008, 28, 28]), y(10): {0: 481, 1: 664, 2: 506, 3: 643, 4: 581, 5: 856, 6: 406, 7: 777, 8: 307, 9: 787}, in which, 
	X_train: torch.Size([4325, 28, 28]), y_train: Counter({5: 636, 7: 573, 9: 552, 1: 484, 3: 474, 4: 415, 2: 355, 0: 331, 6: 287, 8: 218})
	X_val: torch.Size([481, 28, 28]), y_val: Counter({5: 69, 9: 67, 7: 57, 4: 51, 1: 47, 3: 44, 2: 43, 6: 38, 8: 33, 0: 32})
	X_test: torch.Size([1202, 28, 28]), y_test: Counter({9: 168, 5: 151, 7: 147, 1: 133, 3: 125, 0: 118, 4: 115, 2: 108, 6: 81, 8: 56})
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:57...
Function 'evaluate' executed in 0.0137 seconds (Start: 2025-11-12 09:52:57, End: 2025-11-12 09:52:57)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:57...
Function 'evaluate_shared_test' executed in 0.0383 seconds (Start: 2025-11-12 09:52:57, End: 2025-11-12 09:52:57)

***server_epoch:0, client_9: Byzantine...
client_9 data: {0: 372, 1: 471, 2: 355, 3: 514, 4: 385, 5: 249, 6: 238, 7: 480, 8: 619, 9: 375}
Local_data: 
X: torch.Size([5637, 28, 28]), y(10): {0: 528, 1: 660, 2: 507, 3: 683, 4: 542, 5: 351, 6: 327, 7: 681, 8: 847, 9: 511}, in which, 
	X_train: torch.Size([4058, 28, 28]), y_train: Counter({8: 619, 3: 514, 7: 480, 1: 471, 4: 385, 9: 375, 0: 372, 2: 355, 5: 249, 6: 238})
	X_val: torch.Size([451, 28, 28]), y_val: Counter({8: 69, 7: 65, 3: 51, 1: 49, 2: 46, 4: 42, 0: 35, 9: 35, 5: 34, 6: 25})
	X_test: torch.Size([1128, 28, 28]), y_test: Counter({8: 159, 1: 140, 7: 136, 0: 121, 3: 118, 4: 115, 2: 106, 9: 101, 5: 68, 6: 64})
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:58...
Function 'evaluate' executed in 0.0133 seconds (Start: 2025-11-12 09:52:58, End: 2025-11-12 09:52:58)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:58...
Function 'evaluate_shared_test' executed in 0.0254 seconds (Start: 2025-11-12 09:52:58, End: 2025-11-12 09:52:58)

*************** Server Epoch: 0/2, Server Aggregation **********
Function 'aggregate_cnns starts at 2025-11-12 09:52:58...
*aggregate cnn...
each update shape: torch.Size([390378])
Unique weights: tensor([3891, 4058, 4089, 4129, 4230, 4325, 4326, 4337, 4447, 5361]), counts: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], client_updates: min: -0.06, max: 0.05, time taken: 0.0021s, l2_error: 1026.61
Function 'aggregate_cnns' executed in 0.0407 seconds (Start: 2025-11-12 09:52:58, End: 2025-11-12 09:52:58)

*************** Server Epoch: 1/2, Client Training *************

*** server_epoch:1, client_0: Honest... ***
client_0 data (10): {0: 477, 1: 358, 2: 329, 3: 584, 4: 469, 5: 301, 6: 277, 7: 414, 8: 505, 9: 415}
Local_data: 
X: torch.Size([5735, 28, 28]), y(10): {0: 687, 1: 498, 2: 461, 3: 812, 4: 624, 5: 419, 6: 399, 7: 555, 8: 693, 9: 587}, in which, 
	X_train: torch.Size([4129, 28, 28]), y_train: Counter({3: 584, 8: 505, 0: 477, 4: 469, 9: 415, 7: 414, 1: 358, 2: 329, 5: 301, 6: 277})
	X_val: torch.Size([459, 28, 28]), y_val: Counter({3: 67, 8: 61, 0: 55, 9: 45, 4: 44, 2: 41, 7: 40, 1: 39, 6: 34, 5: 33})
	X_test: torch.Size([1147, 28, 28]), y_test: Counter({3: 161, 0: 155, 8: 127, 9: 127, 4: 111, 1: 101, 7: 101, 2: 91, 6: 88, 5: 85})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:58...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 477), (1, 358), (2, 329), (3, 584), (4, 469), (5, 301), (6, 277), (7, 414), (8, 505), (9, 415)])
class_weight: tensor([0.08, 0.11, 0.12, 0.07, 0.08, 0.13, 0.14, 0.09, 0.08, 0.09],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 24209728.2500, val_loss: 24209728.2500, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 6147541.6875, val_loss: 6147541.6875, LR: 0.001
Function 'train_cnn' executed in 0.8518 seconds (Start: 2025-11-12 09:52:58, End: 2025-11-12 09:52:59)
dist(local, global): 18.883365631103516
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:59...
Function 'evaluate' executed in 0.0121 seconds (Start: 2025-11-12 09:52:59, End: 2025-11-12 09:52:59)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:59...
Function 'evaluate_shared_test' executed in 0.0320 seconds (Start: 2025-11-12 09:52:59, End: 2025-11-12 09:52:59)

*** server_epoch:1, client_1: Honest... ***
client_1 data (10): {0: 398, 1: 790, 2: 659, 3: 263, 4: 400, 5: 431, 6: 346, 7: 448, 8: 390, 9: 322}
Local_data: 
X: torch.Size([6178, 28, 28]), y(10): {0: 575, 1: 1109, 2: 897, 3: 385, 4: 551, 5: 598, 6: 473, 7: 630, 8: 527, 9: 433}, in which, 
	X_train: torch.Size([4447, 28, 28]), y_train: Counter({1: 790, 2: 659, 7: 448, 5: 431, 4: 400, 0: 398, 8: 390, 6: 346, 9: 322, 3: 263})
	X_val: torch.Size([495, 28, 28]), y_val: Counter({1: 92, 2: 64, 4: 55, 7: 51, 5: 48, 0: 43, 6: 40, 8: 39, 3: 35, 9: 28})
	X_test: torch.Size([1236, 28, 28]), y_test: Counter({1: 227, 2: 174, 0: 134, 7: 131, 5: 119, 8: 98, 4: 96, 3: 87, 6: 87, 9: 83})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:00...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 398), (1, 790), (2, 659), (3, 263), (4, 400), (5, 431), (6, 346), (7, 448), (8, 390), (9, 322)])
class_weight: tensor([0.10, 0.05, 0.06, 0.15, 0.10, 0.09, 0.12, 0.09, 0.10, 0.13],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 27845808.5000, val_loss: 27845808.5000, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5748883.5625, val_loss: 5748883.5625, LR: 0.001
Function 'train_cnn' executed in 0.8817 seconds (Start: 2025-11-12 09:53:00, End: 2025-11-12 09:53:01)
dist(local, global): 20.12706756591797
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:01...
Function 'evaluate' executed in 0.0124 seconds (Start: 2025-11-12 09:53:01, End: 2025-11-12 09:53:01)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:01...
Function 'evaluate_shared_test' executed in 0.0261 seconds (Start: 2025-11-12 09:53:01, End: 2025-11-12 09:53:01)

*** server_epoch:1, client_2: Honest... ***
client_2 data (10): {0: 354, 1: 515, 2: 468, 3: 228, 4: 154, 5: 514, 6: 436, 7: 381, 8: 855, 9: 325}
Local_data: 
X: torch.Size([5877, 28, 28]), y(10): {0: 502, 1: 728, 2: 630, 3: 320, 4: 215, 5: 710, 6: 587, 7: 524, 8: 1191, 9: 470}, in which, 
	X_train: torch.Size([4230, 28, 28]), y_train: Counter({8: 855, 1: 515, 5: 514, 2: 468, 6: 436, 7: 381, 0: 354, 9: 325, 3: 228, 4: 154})
	X_val: torch.Size([471, 28, 28]), y_val: Counter({8: 113, 1: 63, 5: 61, 6: 43, 7: 42, 2: 38, 9: 38, 3: 31, 0: 30, 4: 12})
	X_test: torch.Size([1176, 28, 28]), y_test: Counter({8: 223, 1: 150, 5: 135, 2: 124, 0: 118, 6: 108, 9: 107, 7: 101, 3: 61, 4: 49})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:02...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 354), (1, 515), (2, 468), (3, 228), (4, 154), (5, 514), (6, 436), (7, 381), (8, 855), (9, 325)])
class_weight: tensor([0.10, 0.07, 0.07, 0.15, 0.22, 0.07, 0.08, 0.09, 0.04, 0.11],
       device='cuda:0'), sum(class_weight) = 0.9999999403953552
train_cnn epoch: 0, local_cnn train loss: 22743577.5000, val_loss: 22743577.5000, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5558720.5625, val_loss: 5558720.5625, LR: 0.001
Function 'train_cnn' executed in 0.8275 seconds (Start: 2025-11-12 09:53:02, End: 2025-11-12 09:53:03)
dist(local, global): 19.722686767578125
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:03...
Function 'evaluate' executed in 0.0121 seconds (Start: 2025-11-12 09:53:03, End: 2025-11-12 09:53:03)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:03...
Function 'evaluate_shared_test' executed in 0.0262 seconds (Start: 2025-11-12 09:53:03, End: 2025-11-12 09:53:03)

*** server_epoch:1, client_3: Honest... ***
client_3 data (10): {0: 452, 1: 212, 2: 731, 3: 430, 4: 511, 5: 434, 6: 719, 7: 351, 8: 276, 9: 221}
Local_data: 
X: torch.Size([6024, 28, 28]), y(10): {0: 653, 1: 290, 2: 1034, 3: 588, 4: 726, 5: 587, 6: 997, 7: 471, 8: 380, 9: 298}, in which, 
	X_train: torch.Size([4337, 28, 28]), y_train: Counter({2: 731, 6: 719, 4: 511, 0: 452, 5: 434, 3: 430, 7: 351, 8: 276, 9: 221, 1: 212})
	X_val: torch.Size([482, 28, 28]), y_val: Counter({6: 89, 2: 85, 4: 76, 0: 49, 3: 48, 5: 40, 7: 32, 1: 22, 8: 22, 9: 19})
	X_test: torch.Size([1205, 28, 28]), y_test: Counter({2: 218, 6: 189, 0: 152, 4: 139, 5: 113, 3: 110, 7: 88, 8: 82, 9: 58, 1: 56})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:04...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 452), (1, 212), (2, 731), (3, 430), (4, 511), (5, 434), (6, 719), (7, 351), (8, 276), (9, 221)])
class_weight: tensor([0.08, 0.17, 0.05, 0.09, 0.07, 0.08, 0.05, 0.10, 0.13, 0.17],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 28993185.7500, val_loss: 28993185.7500, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5781276.7812, val_loss: 5781276.7812, LR: 0.001
Function 'train_cnn' executed in 0.8425 seconds (Start: 2025-11-12 09:53:04, End: 2025-11-12 09:53:04)
dist(local, global): 21.014617919921875
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:04...
Function 'evaluate' executed in 0.0124 seconds (Start: 2025-11-12 09:53:04, End: 2025-11-12 09:53:04)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:04...
Function 'evaluate_shared_test' executed in 0.0293 seconds (Start: 2025-11-12 09:53:04, End: 2025-11-12 09:53:04)

*** server_epoch:1, client_4: Honest... ***
client_4 data (10): {0: 352, 1: 522, 2: 294, 3: 523, 4: 437, 5: 536, 6: 473, 7: 417, 8: 265, 9: 507}
Local_data: 
X: torch.Size([6009, 28, 28]), y(10): {0: 505, 1: 733, 2: 400, 3: 724, 4: 627, 5: 709, 6: 675, 7: 553, 8: 383, 9: 700}, in which, 
	X_train: torch.Size([4326, 28, 28]), y_train: Counter({5: 536, 3: 523, 1: 522, 9: 507, 6: 473, 4: 437, 7: 417, 0: 352, 2: 294, 8: 265})
	X_val: torch.Size([481, 28, 28]), y_val: Counter({4: 67, 6: 62, 9: 58, 1: 56, 3: 55, 5: 53, 8: 37, 7: 36, 0: 29, 2: 28})
	X_test: torch.Size([1202, 28, 28]), y_test: Counter({1: 155, 3: 146, 6: 140, 9: 135, 0: 124, 4: 123, 5: 120, 7: 100, 8: 81, 2: 78})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:05...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 352), (1, 522), (2, 294), (3, 523), (4, 437), (5, 536), (6, 473), (7, 417), (8, 265), (9, 507)])
class_weight: tensor([0.12, 0.08, 0.14, 0.08, 0.09, 0.08, 0.09, 0.10, 0.15, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 22428435.5000, val_loss: 22428435.5000, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5552334.5625, val_loss: 5552334.5625, LR: 0.001
Function 'train_cnn' executed in 0.8671 seconds (Start: 2025-11-12 09:53:05, End: 2025-11-12 09:53:06)
dist(local, global): 19.888460159301758
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:06...
Function 'evaluate' executed in 0.0123 seconds (Start: 2025-11-12 09:53:06, End: 2025-11-12 09:53:06)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:06...
Function 'evaluate_shared_test' executed in 0.0261 seconds (Start: 2025-11-12 09:53:06, End: 2025-11-12 09:53:06)

*** server_epoch:1, client_5: Honest... ***
client_5 data (10): {0: 491, 1: 537, 2: 422, 3: 415, 4: 249, 5: 359, 6: 353, 7: 384, 8: 394, 9: 485}
Local_data: 
X: torch.Size([5680, 28, 28]), y(10): {0: 689, 1: 761, 2: 582, 3: 586, 4: 335, 5: 477, 6: 503, 7: 513, 8: 556, 9: 678}, in which, 
	X_train: torch.Size([4089, 28, 28]), y_train: Counter({1: 537, 0: 491, 9: 485, 2: 422, 3: 415, 8: 394, 7: 384, 5: 359, 6: 353, 4: 249})
	X_val: torch.Size([455, 28, 28]), y_val: Counter({1: 65, 9: 58, 6: 52, 2: 51, 8: 45, 0: 43, 3: 43, 7: 40, 5: 35, 4: 23})
	X_test: torch.Size([1136, 28, 28]), y_test: Counter({1: 159, 0: 155, 9: 135, 3: 128, 8: 117, 2: 109, 6: 98, 7: 89, 5: 83, 4: 63})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:07...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 491), (1, 537), (2, 422), (3, 415), (4, 249), (5, 359), (6, 353), (7, 384), (8, 394), (9, 485)])
class_weight: tensor([0.08, 0.07, 0.09, 0.09, 0.16, 0.11, 0.11, 0.10, 0.10, 0.08],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 21029499.1250, val_loss: 21029499.1250, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5346017.8125, val_loss: 5346017.8125, LR: 0.001
Function 'train_cnn' executed in 0.9394 seconds (Start: 2025-11-12 09:53:07, End: 2025-11-12 09:53:08)
dist(local, global): 18.679594039916992
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:08...
Function 'evaluate' executed in 0.0120 seconds (Start: 2025-11-12 09:53:08, End: 2025-11-12 09:53:08)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:08...
Function 'evaluate_shared_test' executed in 0.0261 seconds (Start: 2025-11-12 09:53:08, End: 2025-11-12 09:53:08)

*** server_epoch:1, client_6: Honest... ***
client_6 data (10): {0: 650, 1: 585, 2: 229, 3: 446, 4: 766, 5: 341, 6: 852, 7: 614, 8: 260, 9: 618}
Local_data: 
X: torch.Size([7447, 28, 28]), y(10): {0: 918, 1: 844, 2: 313, 3: 625, 4: 1048, 5: 468, 6: 1144, 7: 849, 8: 372, 9: 866}, in which, 
	X_train: torch.Size([5361, 28, 28]), y_train: Counter({6: 852, 4: 766, 0: 650, 9: 618, 7: 614, 1: 585, 3: 446, 5: 341, 8: 260, 2: 229})
	X_val: torch.Size([596, 28, 28]), y_val: Counter({6: 92, 4: 91, 7: 76, 0: 73, 1: 69, 9: 64, 3: 39, 5: 37, 2: 29, 8: 26})
	X_test: torch.Size([1490, 28, 28]), y_test: Counter({6: 200, 0: 195, 4: 191, 1: 190, 9: 184, 7: 159, 3: 140, 5: 90, 8: 86, 2: 55})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:09...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 650), (1, 585), (2, 229), (3, 446), (4, 766), (5, 341), (6, 852), (7, 614), (8, 260), (9, 618)])
class_weight: tensor([0.07, 0.08, 0.20, 0.10, 0.06, 0.13, 0.05, 0.07, 0.17, 0.07],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 25196217.5000, val_loss: 25196217.5000, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 5298903.6250, val_loss: 5298903.6250, LR: 0.001
Function 'train_cnn' executed in 1.0728 seconds (Start: 2025-11-12 09:53:09, End: 2025-11-12 09:53:10)
dist(local, global): 21.72607421875
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:10...
Function 'evaluate' executed in 0.0135 seconds (Start: 2025-11-12 09:53:10, End: 2025-11-12 09:53:10)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:10...
Function 'evaluate_shared_test' executed in 0.0263 seconds (Start: 2025-11-12 09:53:10, End: 2025-11-12 09:53:10)

***server_epoch:1, client_7: Byzantine...
client_7 data: {0: 271, 1: 317, 2: 460, 3: 547, 4: 416, 5: 178, 6: 294, 7: 519, 8: 433, 9: 456}
Local_data: 
X: torch.Size([5405, 28, 28]), y(10): {0: 385, 1: 455, 2: 628, 3: 765, 4: 593, 5: 246, 6: 407, 7: 712, 8: 595, 9: 619}, in which, 
	X_train: torch.Size([3891, 28, 28]), y_train: Counter({3: 547, 7: 519, 2: 460, 9: 456, 8: 433, 4: 416, 1: 317, 6: 294, 0: 271, 5: 178})
	X_val: torch.Size([433, 28, 28]), y_val: Counter({3: 63, 7: 60, 4: 59, 8: 47, 2: 44, 9: 39, 1: 36, 6: 31, 0: 30, 5: 24})
	X_test: torch.Size([1081, 28, 28]), y_test: Counter({3: 155, 7: 133, 2: 124, 9: 124, 4: 118, 8: 115, 1: 102, 0: 84, 6: 82, 5: 44})
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:11...
Function 'evaluate' executed in 0.0117 seconds (Start: 2025-11-12 09:53:11, End: 2025-11-12 09:53:11)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:11...
Function 'evaluate_shared_test' executed in 0.0264 seconds (Start: 2025-11-12 09:53:11, End: 2025-11-12 09:53:11)

***server_epoch:1, client_8: Byzantine...
client_8 data: {0: 331, 1: 484, 2: 355, 3: 474, 4: 415, 5: 636, 6: 287, 7: 573, 8: 218, 9: 552}
Local_data: 
X: torch.Size([6008, 28, 28]), y(10): {0: 481, 1: 664, 2: 506, 3: 643, 4: 581, 5: 856, 6: 406, 7: 777, 8: 307, 9: 787}, in which, 
	X_train: torch.Size([4325, 28, 28]), y_train: Counter({5: 636, 7: 573, 9: 552, 1: 484, 3: 474, 4: 415, 2: 355, 0: 331, 6: 287, 8: 218})
	X_val: torch.Size([481, 28, 28]), y_val: Counter({5: 69, 9: 67, 7: 57, 4: 51, 1: 47, 3: 44, 2: 43, 6: 38, 8: 33, 0: 32})
	X_test: torch.Size([1202, 28, 28]), y_test: Counter({9: 168, 5: 151, 7: 147, 1: 133, 3: 125, 0: 118, 4: 115, 2: 108, 6: 81, 8: 56})
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:12...
Function 'evaluate' executed in 0.0121 seconds (Start: 2025-11-12 09:53:12, End: 2025-11-12 09:53:12)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:12...
Function 'evaluate_shared_test' executed in 0.0253 seconds (Start: 2025-11-12 09:53:12, End: 2025-11-12 09:53:12)

***server_epoch:1, client_9: Byzantine...
client_9 data: {0: 372, 1: 471, 2: 355, 3: 514, 4: 385, 5: 249, 6: 238, 7: 480, 8: 619, 9: 375}
Local_data: 
X: torch.Size([5637, 28, 28]), y(10): {0: 528, 1: 660, 2: 507, 3: 683, 4: 542, 5: 351, 6: 327, 7: 681, 8: 847, 9: 511}, in which, 
	X_train: torch.Size([4058, 28, 28]), y_train: Counter({8: 619, 3: 514, 7: 480, 1: 471, 4: 385, 9: 375, 0: 372, 2: 355, 5: 249, 6: 238})
	X_val: torch.Size([451, 28, 28]), y_val: Counter({8: 69, 7: 65, 3: 51, 1: 49, 2: 46, 4: 42, 0: 35, 9: 35, 5: 34, 6: 25})
	X_test: torch.Size([1128, 28, 28]), y_test: Counter({8: 159, 1: 140, 7: 136, 0: 121, 3: 118, 4: 115, 2: 106, 9: 101, 5: 68, 6: 64})
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:13...
Function 'evaluate' executed in 0.0118 seconds (Start: 2025-11-12 09:53:13, End: 2025-11-12 09:53:13)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:13...
Function 'evaluate_shared_test' executed in 0.0254 seconds (Start: 2025-11-12 09:53:13, End: 2025-11-12 09:53:13)

*************** Server Epoch: 1/2, Server Aggregation **********
Function 'aggregate_cnns starts at 2025-11-12 09:53:13...
*aggregate cnn...
each update shape: torch.Size([390378])
Unique weights: tensor([3891, 4058, 4089, 4129, 4230, 4325, 4326, 4337, 4447, 5361]), counts: tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
mean, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], client_updates: min: -0.07, max: 0.06, time taken: 0.0029s, l2_error: 1067.45
Function 'aggregate_cnns' executed in 0.0440 seconds (Start: 2025-11-12 09:53:13, End: 2025-11-12 09:53:13)

***************************** Final Results (mu+/-std) *************************************

 Final***model_type: global***
*client_0:
	server_epoch_0, train_acc:0.1209-0.0000, val_acc:0.1285-0.0000, test_acc:0.1386-0.0000, shared_acc:0.1040-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.0945-0.0000, val_acc:0.1068-0.0000, test_acc:0.0959-0.0000, shared_acc:0.1023-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_1:
	server_epoch_0, train_acc:0.0996-0.0000, val_acc:0.0889-0.0000, test_acc:0.1125-0.0000, shared_acc:0.1040-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.0848-0.0000, val_acc:0.0707-0.0000, test_acc:0.0858-0.0000, shared_acc:0.1023-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_2:
	server_epoch_0, train_acc:0.0915-0.0000, val_acc:0.0870-0.0000, test_acc:0.1088-0.0000, shared_acc:0.1040-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.1017-0.0000, val_acc:0.0998-0.0000, test_acc:0.1063-0.0000, shared_acc:0.1023-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_3:
	server_epoch_0, train_acc:0.1137-0.0000, val_acc:0.1100-0.0000, test_acc:0.1344-0.0000, shared_acc:0.1040-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.1081-0.0000, val_acc:0.1120-0.0000, test_acc:0.1087-0.0000, shared_acc:0.1023-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_4:
	server_epoch_0, train_acc:0.0929-0.0000, val_acc:0.0624-0.0000, test_acc:0.1098-0.0000, shared_acc:0.1040-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.1179-0.0000, val_acc:0.0915-0.0000, test_acc:0.1057-0.0000, shared_acc:0.1023-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_5:
	server_epoch_0, train_acc:0.1245-0.0000, val_acc:0.0923-0.0000, test_acc:0.1408-0.0000, shared_acc:0.1040-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.1096-0.0000, val_acc:0.1187-0.0000, test_acc:0.1162-0.0000, shared_acc:0.1023-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_6:
	server_epoch_0, train_acc:0.1242-0.0000, val_acc:0.1258-0.0000, test_acc:0.1329-0.0000, shared_acc:0.1040-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.1283-0.0000, val_acc:0.1057-0.0000, test_acc:0.1450-0.0000, shared_acc:0.1023-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_7:
	server_epoch_0, train_acc:0.0735-0.0000, val_acc:0.0693-0.0000, test_acc:0.0786-0.0000, shared_acc:0.1040-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.0918-0.0000, val_acc:0.0901-0.0000, test_acc:0.0851-0.0000, shared_acc:0.1023-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_8:
	server_epoch_0, train_acc:0.0929-0.0000, val_acc:0.0748-0.0000, test_acc:0.1082-0.0000, shared_acc:0.1040-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.1068-0.0000, val_acc:0.0977-0.0000, test_acc:0.0998-0.0000, shared_acc:0.1023-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_9:
	server_epoch_0, train_acc:0.0944-0.0000, val_acc:0.0798-0.0000, test_acc:0.1090-0.0000, shared_acc:0.1040-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.0895-0.0000, val_acc:0.0820-0.0000, test_acc:0.0842-0.0000, shared_acc:0.1023-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 

 Final***model_type: local***
*client_0:
	server_epoch_0, train_acc:0.8687-0.0000, val_acc:0.8540-0.0000, test_acc:0.8614-0.0000, shared_acc:0.8717-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.3977-0.0000, val_acc:0.4052-0.0000, test_acc:0.4037-0.0000, shared_acc:0.3826-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_1:
	server_epoch_0, train_acc:0.9051-0.0000, val_acc:0.8970-0.0000, test_acc:0.8908-0.0000, shared_acc:0.8858-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.4311-0.0000, val_acc:0.4182-0.0000, test_acc:0.4296-0.0000, shared_acc:0.3820-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_2:
	server_epoch_0, train_acc:0.8783-0.0000, val_acc:0.8662-0.0000, test_acc:0.8793-0.0000, shared_acc:0.8497-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.4348-0.0000, val_acc:0.4225-0.0000, test_acc:0.4218-0.0000, shared_acc:0.3894-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_3:
	server_epoch_0, train_acc:0.9034-0.0000, val_acc:0.9004-0.0000, test_acc:0.8905-0.0000, shared_acc:0.8718-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.4074-0.0000, val_acc:0.3983-0.0000, test_acc:0.3917-0.0000, shared_acc:0.3832-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_4:
	server_epoch_0, train_acc:0.9004-0.0000, val_acc:0.8919-0.0000, test_acc:0.8943-0.0000, shared_acc:0.8978-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.4330-0.0000, val_acc:0.4116-0.0000, test_acc:0.4176-0.0000, shared_acc:0.3953-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_5:
	server_epoch_0, train_acc:0.8917-0.0000, val_acc:0.8505-0.0000, test_acc:0.8794-0.0000, shared_acc:0.8751-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.4047-0.0000, val_acc:0.4154-0.0000, test_acc:0.3952-0.0000, shared_acc:0.3654-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_6:
	server_epoch_0, train_acc:0.9144-0.0000, val_acc:0.9211-0.0000, test_acc:0.9054-0.0000, shared_acc:0.8957-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.5404-0.0000, val_acc:0.5336-0.0000, test_acc:0.5329-0.0000, shared_acc:0.4664-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_7:
	server_epoch_0, train_acc:0.1288-0.0000, val_acc:0.1455-0.0000, test_acc:0.1295-0.0000, shared_acc:0.1076-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.0861-0.0000, val_acc:0.0785-0.0000, test_acc:0.0833-0.0000, shared_acc:0.0728-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_8:
	server_epoch_0, train_acc:0.0830-0.0000, val_acc:0.0873-0.0000, test_acc:0.0782-0.0000, shared_acc:0.0916-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.1082-0.0000, val_acc:0.0915-0.0000, test_acc:0.1248-0.0000, shared_acc:0.1299-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
*client_9:
	server_epoch_0, train_acc:0.0848-0.0000, val_acc:0.0710-0.0000, test_acc:0.0754-0.0000, shared_acc:0.0752-0.0000, l2_error:1026.6147-0.0000, time_taken:0.0021-0.0000, 
	server_epoch_1, train_acc:0.1323-0.0000, val_acc:0.1308-0.0000, test_acc:0.1135-0.0000, shared_acc:0.1352-0.0000, l2_error:1067.4451-0.0000, time_taken:0.0029-0.0000, 
Function 'main' executed in 69.3414 seconds (Start: 2025-11-12 09:52:03, End: 2025-11-12 09:53:13)
