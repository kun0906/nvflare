/users/kunyang/nvflare/auto_labeling
current directory: /users/kunyang/nvflare/auto_labeling
current file: /users/kunyang/nvflare/auto_labeling/ICONIP/ragg_label_flipping_mnist.py
Device: cuda
Function 'main starts at 2025-11-12 09:52:03...


Namespace(labeling_rate=0.5, server_epochs=2, num_clients=10, aggregation_method='krum', verbose=5)
NUM_CLIENTS: 10, in which NUM_HONEST_CLIENTS: 7 and NUM_BYZANTINE_CLIENTS: 3
{'SEED': 42, 'TRAIN_VAL_SEED': 0, 'DEVICE': device(type='cuda'), 'VERBOSE': 5, 'LABELING_RATE': 0.8, 'BIG_NUMBER': 0.5, 'SERVER_EPOCHS': 2, 'CLIENT_EPOCHS': 5, 'BATCH_SIZE': 512, 'IID_CLASSES_CNT': 5, 'NUM_CLIENTS': 10, 'NUM_BYZANTINE_CLIENTS': 3, 'NUM_HONEST_CLIENTS': 7, 'AGGREGATION_METHOD': 'krum', 'LABELS': {0, 1, 2, 3, 4, 5, 6, 7, 8, 9}, 'NUM_CLASSES': 10, 'CNN': <class 'ragg.base.CNN'>}

*************************** Generate Clients Data ******************************
Function 'gen_client_data starts at 2025-11-12 09:52:03...
X.shape: (60000, 28, 28), y.shape: (60000,)

	: size, Client_0,  Client_1,  Client_2,  Client_3,  Client_4,  Client_5,  Client_6,  Client_7,  Client_8,  Client_9
class 0:  5923 [8, 93, 229, 442, 173, 1213, 421, 1086, 1250, 1008] , alpha: 0.5
class 1:  6742 [4, 56, 1027, 196, 2219, 632, 2177, 47, 347, 37] , alpha: 0.5
class 2:  5958 [802, 128, 1774, 0, 1028, 3, 11, 382, 3, 1827] , alpha: 0.5
class 3:  6131 [221, 1763, 586, 0, 278, 63, 1633, 1451, 95, 41] , alpha: 0.5
class 4:  5842 [2606, 1557, 32, 571, 753, 200, 31, 3, 17, 72] , alpha: 0.5
class 5:  5421 [55, 6, 429, 430, 477, 3589, 31, 165, 3, 236] , alpha: 0.5
class 6:  5918 [1406, 104, 15, 530, 10, 433, 853, 165, 655, 1747] , alpha: 0.5
class 7:  6265 [64, 898, 153, 16, 396, 3064, 0, 170, 1365, 139] , alpha: 0.5
class 8:  5851 [330, 2094, 215, 544, 30, 577, 937, 47, 46, 1031] , alpha: 0.5
class 9:  5949 [136, 0, 29, 116, 1627, 172, 308, 3198, 312, 51] , alpha: 0.5
client 0's data size: 5632, total classes: 10, in which {0: 8, 1: 4, 2: 802, 3: 221, 4: 2606, 5: 55, 6: 1406, 7: 64, 8: 330, 9: 136}, alpha: 0.5
client 1's data size: 6699, total classes: 9, in which {0: 93, 1: 56, 2: 128, 3: 1763, 4: 1557, 5: 6, 6: 104, 7: 898, 8: 2094}, alpha: 0.5
client 2's data size: 4489, total classes: 10, in which {0: 229, 1: 1027, 2: 1774, 3: 586, 4: 32, 5: 429, 6: 15, 7: 153, 8: 215, 9: 29}, alpha: 0.5
client 3's data size: 2845, total classes: 8, in which {0: 442, 1: 196, 4: 571, 5: 430, 6: 530, 7: 16, 8: 544, 9: 116}, alpha: 0.5
client 4's data size: 6991, total classes: 10, in which {0: 173, 1: 2219, 2: 1028, 3: 278, 4: 753, 5: 477, 6: 10, 7: 396, 8: 30, 9: 1627}, alpha: 0.5
client 5's data size: 9946, total classes: 10, in which {0: 1213, 1: 632, 2: 3, 3: 63, 4: 200, 5: 3589, 6: 433, 7: 3064, 8: 577, 9: 172}, alpha: 0.5
client 6's data size: 6402, total classes: 9, in which {0: 421, 1: 2177, 2: 11, 3: 1633, 4: 31, 5: 31, 6: 853, 8: 937, 9: 308}, alpha: 0.5
client 7's data size: 6714, total classes: 10, in which {0: 1086, 1: 47, 2: 382, 3: 1451, 4: 3, 5: 165, 6: 165, 7: 170, 8: 47, 9: 3198}, alpha: 0.5
client 8's data size: 4093, total classes: 10, in which {0: 1250, 1: 347, 2: 3, 3: 95, 4: 17, 5: 3, 6: 655, 7: 1365, 8: 46, 9: 312}, alpha: 0.5
client 9's data size: 6189, total classes: 10, in which {0: 1008, 1: 37, 2: 1827, 3: 41, 4: 72, 5: 236, 6: 1747, 7: 139, 8: 1031, 9: 51}, alpha: 0.5
total size: 60000

*** client_0: Honest...
client_0 data (10):  {0: 8, 1: 4, 2: 802, 3: 221, 4: 2606, 5: 55, 6: 1406, 7: 64, 8: 330, 9: 136}
Local_data: 
X: torch.Size([5632, 28, 28]), y(10): {0: 8, 1: 4, 2: 802, 3: 221, 4: 2606, 5: 55, 6: 1406, 7: 64, 8: 330, 9: 136}, in which, 
	X_train: torch.Size([4054, 28, 28]), y_train: Counter({4: 1859, 6: 1025, 2: 564, 8: 250, 3: 165, 9: 101, 5: 41, 7: 40, 0: 7, 1: 2})
	X_val: torch.Size([451, 28, 28]), y_val: Counter({4: 225, 6: 117, 2: 50, 3: 20, 8: 17, 7: 9, 9: 8, 5: 3, 0: 1, 1: 1})
	X_test: torch.Size([1127, 28, 28]), y_test: Counter({4: 522, 6: 264, 2: 188, 8: 63, 3: 36, 9: 27, 7: 15, 5: 11, 1: 1})

*** client_1: Honest...
client_1 data (9):  {0: 93, 1: 56, 2: 128, 3: 1763, 4: 1557, 5: 6, 6: 104, 7: 898, 8: 2094}
Local_data: 
X: torch.Size([6699, 28, 28]), y(9): {0: 93, 1: 56, 2: 128, 3: 1763, 4: 1557, 5: 6, 6: 104, 7: 898, 8: 2094}, in which, 
	X_train: torch.Size([4823, 28, 28]), y_train: Counter({8: 1514, 3: 1256, 4: 1136, 7: 646, 2: 84, 6: 81, 0: 57, 1: 45, 5: 4})
	X_val: torch.Size([536, 28, 28]), y_val: Counter({8: 170, 3: 156, 4: 104, 7: 73, 0: 10, 2: 10, 6: 9, 1: 4})
	X_test: torch.Size([1340, 28, 28]), y_test: Counter({8: 410, 3: 351, 4: 317, 7: 179, 2: 34, 0: 26, 6: 14, 1: 7, 5: 2})

*** client_2: Honest...
client_2 data (10):  {0: 229, 1: 1027, 2: 1774, 3: 586, 4: 32, 5: 429, 6: 15, 7: 153, 8: 215, 9: 29}
Local_data: 
X: torch.Size([4489, 28, 28]), y(10): {0: 229, 1: 1027, 2: 1774, 3: 586, 4: 32, 5: 429, 6: 15, 7: 153, 8: 215, 9: 29}, in which, 
	X_train: torch.Size([3231, 28, 28]), y_train: Counter({2: 1271, 1: 731, 3: 433, 5: 303, 0: 164, 8: 163, 7: 111, 4: 23, 9: 21, 6: 11})
	X_val: torch.Size([360, 28, 28]), y_val: Counter({2: 142, 1: 75, 3: 47, 5: 43, 0: 17, 8: 17, 7: 11, 4: 4, 9: 3, 6: 1})
	X_test: torch.Size([898, 28, 28]), y_test: Counter({2: 361, 1: 221, 3: 106, 5: 83, 0: 48, 8: 35, 7: 31, 4: 5, 9: 5, 6: 3})

*** client_3: Honest...
client_3 data (8):  {0: 442, 1: 196, 4: 571, 5: 430, 6: 530, 7: 16, 8: 544, 9: 116}
Local_data: 
X: torch.Size([2845, 28, 28]), y(8): {0: 442, 1: 196, 4: 571, 5: 430, 6: 530, 7: 16, 8: 544, 9: 116}, in which, 
	X_train: torch.Size([2048, 28, 28]), y_train: Counter({4: 419, 8: 401, 6: 367, 0: 314, 5: 312, 1: 138, 9: 86, 7: 11})
	X_val: torch.Size([228, 28, 28]), y_val: Counter({6: 56, 4: 46, 0: 36, 8: 35, 5: 33, 1: 15, 9: 6, 7: 1})
	X_test: torch.Size([569, 28, 28]), y_test: Counter({8: 108, 6: 107, 4: 106, 0: 92, 5: 85, 1: 43, 9: 24, 7: 4})

*** client_4: Honest...
client_4 data (10):  {0: 173, 1: 2219, 2: 1028, 3: 278, 4: 753, 5: 477, 6: 10, 7: 396, 8: 30, 9: 1627}
Local_data: 
X: torch.Size([6991, 28, 28]), y(10): {0: 173, 1: 2219, 2: 1028, 3: 278, 4: 753, 5: 477, 6: 10, 7: 396, 8: 30, 9: 1627}, in which, 
	X_train: torch.Size([5032, 28, 28]), y_train: Counter({1: 1568, 9: 1196, 2: 726, 4: 552, 5: 361, 7: 278, 3: 200, 0: 124, 8: 21, 6: 6})
	X_val: torch.Size([560, 28, 28]), y_val: Counter({1: 189, 9: 128, 2: 92, 4: 49, 5: 35, 7: 32, 3: 17, 0: 15, 6: 2, 8: 1})
	X_test: torch.Size([1399, 28, 28]), y_test: Counter({1: 462, 9: 303, 2: 210, 4: 152, 7: 86, 5: 81, 3: 61, 0: 34, 8: 8, 6: 2})

*** client_5: Honest...
client_5 data (10):  {0: 1213, 1: 632, 2: 3, 3: 63, 4: 200, 5: 3589, 6: 433, 7: 3064, 8: 577, 9: 172}
Local_data: 
X: torch.Size([9946, 28, 28]), y(10): {0: 1213, 1: 632, 2: 3, 3: 63, 4: 200, 5: 3589, 6: 433, 7: 3064, 8: 577, 9: 172}, in which, 
	X_train: torch.Size([7160, 28, 28]), y_train: Counter({5: 2570, 7: 2187, 0: 878, 1: 454, 8: 412, 6: 316, 4: 156, 9: 136, 3: 48, 2: 3})
	X_val: torch.Size([796, 28, 28]), y_val: Counter({5: 282, 7: 268, 0: 80, 8: 56, 1: 43, 6: 42, 4: 13, 9: 7, 3: 5})
	X_test: torch.Size([1990, 28, 28]), y_test: Counter({5: 737, 7: 609, 0: 255, 1: 135, 8: 109, 6: 75, 4: 31, 9: 29, 3: 10})

*** client_6: Honest...
client_6 data (9):  {0: 421, 1: 2177, 2: 11, 3: 1633, 4: 31, 5: 31, 6: 853, 8: 937, 9: 308}
Local_data: 
X: torch.Size([6402, 28, 28]), y(9): {0: 421, 1: 2177, 2: 11, 3: 1633, 4: 31, 5: 31, 6: 853, 8: 937, 9: 308}, in which, 
	X_train: torch.Size([4608, 28, 28]), y_train: Counter({1: 1585, 3: 1174, 8: 672, 6: 607, 0: 287, 9: 232, 4: 21, 5: 21, 2: 9})
	X_val: torch.Size([513, 28, 28]), y_val: Counter({1: 170, 3: 131, 8: 81, 6: 69, 0: 32, 9: 22, 4: 4, 5: 3, 2: 1})
	X_test: torch.Size([1281, 28, 28]), y_test: Counter({1: 422, 3: 328, 8: 184, 6: 177, 0: 102, 9: 54, 5: 7, 4: 6, 2: 1})

*** client_7: Byzantine...
client_7 data (10):  {0: 2795, 1: 49, 2: 231, 3: 412, 4: 133, 5: 35, 6: 1204, 7: 321, 8: 45, 9: 1489}
Local_data: 
X: torch.Size([6714, 28, 28]), y(10): {0: 2795, 1: 49, 2: 231, 3: 412, 4: 133, 5: 35, 6: 1204, 7: 321, 8: 45, 9: 1489}, in which, 
	X_train: torch.Size([4833, 28, 28]), y_train: Counter({0: 2312, 6: 1037, 9: 772, 7: 269, 2: 131, 3: 120, 4: 117, 1: 38, 8: 35, 5: 2})
	X_val: torch.Size([538, 28, 28]), y_val: Counter({0: 254, 6: 133, 9: 85, 7: 23, 4: 16, 3: 11, 2: 10, 8: 3, 1: 2, 5: 1})
	X_test: torch.Size([1343, 28, 28]), y_test: Counter({9: 632, 3: 281, 0: 229, 2: 90, 6: 34, 5: 32, 7: 29, 1: 9, 8: 7})

*** client_8: Byzantine...
client_8 data (10):  {0: 527, 1: 106, 2: 1115, 3: 530, 4: 4, 5: 16, 6: 220, 7: 253, 8: 287, 9: 1035}
Local_data: 
X: torch.Size([4093, 28, 28]), y(10): {0: 527, 1: 106, 2: 1115, 3: 530, 4: 4, 5: 16, 6: 220, 7: 253, 8: 287, 9: 1035}, in which, 
	X_train: torch.Size([2946, 28, 28]), y_train: Counter({2: 1014, 9: 883, 3: 458, 8: 245, 0: 229, 6: 67, 1: 32, 5: 13, 4: 3, 7: 2})
	X_val: torch.Size([328, 28, 28]), y_val: Counter({2: 100, 9: 95, 3: 56, 8: 32, 0: 26, 6: 12, 1: 4, 5: 3})
	X_test: torch.Size([819, 28, 28]), y_test: Counter({0: 272, 7: 251, 6: 141, 1: 70, 9: 57, 3: 16, 8: 10, 2: 1, 4: 1})

*** client_9: Byzantine...
client_9 data (10):  {0: 247, 1: 843, 2: 469, 3: 1408, 4: 209, 5: 99, 6: 380, 7: 1497, 8: 225, 9: 812}
Local_data: 
X: torch.Size([6189, 28, 28]), y(10): {0: 247, 1: 843, 2: 469, 3: 1408, 4: 209, 5: 99, 6: 380, 7: 1497, 8: 225, 9: 812}, in which, 
	X_train: torch.Size([4455, 28, 28]), y_train: Counter({7: 1310, 3: 1261, 1: 757, 9: 721, 4: 171, 2: 101, 5: 51, 0: 33, 6: 28, 8: 22})
	X_val: torch.Size([496, 28, 28]), y_val: Counter({7: 157, 3: 139, 9: 77, 1: 75, 4: 22, 2: 8, 6: 5, 5: 5, 8: 4, 0: 4})
	X_test: torch.Size([1238, 28, 28]), y_test: Counter({2: 360, 6: 347, 0: 210, 8: 199, 5: 43, 7: 30, 4: 16, 9: 14, 1: 11, 3: 8})
Function 'gen_client_data' executed in 38.7133 seconds (Start: 2025-11-12 09:52:03, End: 2025-11-12 09:52:42)

***************************** Global Models *************************************
CNN(
  (conv1): Conv2d(1, 16, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv11): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv21): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv3): Conv2d(32, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv31): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (fc1): Linear(in_features=576, out_features=512, bias=True)
  (fc2): Linear(in_features=512, out_features=10, bias=True)
  (leaky_relu): LeakyReLU(negative_slope=0.2)
)

*************** Server Epoch: 0/2, Client Training *****************

*** server_epoch:0, client_0: Honest... ***
client_0 data (10): {0: 7, 1: 2, 2: 564, 3: 165, 4: 1859, 5: 41, 6: 1025, 7: 40, 8: 250, 9: 101}
Local_data: 
X: torch.Size([5632, 28, 28]), y(10): {0: 8, 1: 4, 2: 802, 3: 221, 4: 2606, 5: 55, 6: 1406, 7: 64, 8: 330, 9: 136}, in which, 
	X_train: torch.Size([4054, 28, 28]), y_train: Counter({4: 1859, 6: 1025, 2: 564, 8: 250, 3: 165, 9: 101, 5: 41, 7: 40, 0: 7, 1: 2})
	X_val: torch.Size([451, 28, 28]), y_val: Counter({4: 225, 6: 117, 2: 50, 3: 20, 8: 17, 7: 9, 9: 8, 5: 3, 0: 1, 1: 1})
	X_test: torch.Size([1127, 28, 28]), y_test: Counter({4: 522, 6: 264, 2: 188, 8: 63, 3: 36, 9: 27, 7: 15, 5: 11, 1: 1})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:42...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 7), (1, 2), (2, 564), (3, 165), (4, 1859), (5, 41), (6, 1025), (7, 40), (8, 250), (9, 101)])
class_weight: tensor([0.20, 0.70, 0.00, 0.01, 0.00, 0.03, 0.00, 0.03, 0.01, 0.01],
       device='cuda:0'), sum(class_weight) = 0.9999999403953552
train_cnn epoch: 0, local_cnn train loss: 14.1654, val_loss: 14.1654, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.2023, val_loss: 2.2023, LR: 0.001
Function 'train_cnn' executed in 1.1364 seconds (Start: 2025-11-12 09:52:42, End: 2025-11-12 09:52:44)
dist(local, global): 9.661474227905273
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:44...
Function 'evaluate' executed in 0.0173 seconds (Start: 2025-11-12 09:52:44, End: 2025-11-12 09:52:44)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:44...
Function 'evaluate_shared_test' executed in 0.0416 seconds (Start: 2025-11-12 09:52:44, End: 2025-11-12 09:52:44)

*** server_epoch:0, client_1: Honest... ***
client_1 data (9): {0: 57, 1: 45, 2: 84, 3: 1256, 4: 1136, 5: 4, 6: 81, 7: 646, 8: 1514}
Local_data: 
X: torch.Size([6699, 28, 28]), y(9): {0: 93, 1: 56, 2: 128, 3: 1763, 4: 1557, 5: 6, 6: 104, 7: 898, 8: 2094}, in which, 
	X_train: torch.Size([4823, 28, 28]), y_train: Counter({8: 1514, 3: 1256, 4: 1136, 7: 646, 2: 84, 6: 81, 0: 57, 1: 45, 5: 4})
	X_val: torch.Size([536, 28, 28]), y_val: Counter({8: 170, 3: 156, 4: 104, 7: 73, 0: 10, 2: 10, 6: 9, 1: 4})
	X_test: torch.Size([1340, 28, 28]), y_test: Counter({8: 410, 3: 351, 4: 317, 7: 179, 2: 34, 0: 26, 6: 14, 1: 7, 5: 2})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:45...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 57), (1, 45), (2, 84), (3, 1256), (4, 1136), (5, 4), (6, 81), (7, 646), (8, 1514)])
class_weight: tensor([0.06, 0.07, 0.04, 0.00, 0.00, 0.79, 0.04, 0.00, 0.00], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 16.9743, val_loss: 16.9743, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.3433, val_loss: 2.3433, LR: 0.001
Function 'train_cnn' executed in 0.9600 seconds (Start: 2025-11-12 09:52:45, End: 2025-11-12 09:52:45)
dist(local, global): 9.9279203414917
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:45...
Function 'evaluate' executed in 0.0145 seconds (Start: 2025-11-12 09:52:45, End: 2025-11-12 09:52:45)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:45...
Function 'evaluate_shared_test' executed in 0.0262 seconds (Start: 2025-11-12 09:52:45, End: 2025-11-12 09:52:46)

*** server_epoch:0, client_2: Honest... ***
client_2 data (10): {0: 164, 1: 731, 2: 1271, 3: 433, 4: 23, 5: 303, 6: 11, 7: 111, 8: 163, 9: 21}
Local_data: 
X: torch.Size([4489, 28, 28]), y(10): {0: 229, 1: 1027, 2: 1774, 3: 586, 4: 32, 5: 429, 6: 15, 7: 153, 8: 215, 9: 29}, in which, 
	X_train: torch.Size([3231, 28, 28]), y_train: Counter({2: 1271, 1: 731, 3: 433, 5: 303, 0: 164, 8: 163, 7: 111, 4: 23, 9: 21, 6: 11})
	X_val: torch.Size([360, 28, 28]), y_val: Counter({2: 142, 1: 75, 3: 47, 5: 43, 0: 17, 8: 17, 7: 11, 4: 4, 9: 3, 6: 1})
	X_test: torch.Size([898, 28, 28]), y_test: Counter({2: 361, 1: 221, 3: 106, 5: 83, 0: 48, 8: 35, 7: 31, 4: 5, 9: 5, 6: 3})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:46...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 164), (1, 731), (2, 1271), (3, 433), (4, 23), (5, 303), (6, 11), (7, 111), (8, 163), (9, 21)])
class_weight: tensor([0.03, 0.01, 0.00, 0.01, 0.21, 0.02, 0.43, 0.04, 0.03, 0.23],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 13.1991, val_loss: 13.1991, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.7208, val_loss: 2.7208, LR: 0.001
Function 'train_cnn' executed in 0.6494 seconds (Start: 2025-11-12 09:52:46, End: 2025-11-12 09:52:47)
dist(local, global): 9.258928298950195
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:47...
Function 'evaluate' executed in 0.0128 seconds (Start: 2025-11-12 09:52:47, End: 2025-11-12 09:52:47)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:47...
Function 'evaluate_shared_test' executed in 0.0286 seconds (Start: 2025-11-12 09:52:47, End: 2025-11-12 09:52:47)

*** server_epoch:0, client_3: Honest... ***
client_3 data (8): {0: 314, 1: 138, 4: 419, 5: 312, 6: 367, 7: 11, 8: 401, 9: 86}
Local_data: 
X: torch.Size([2845, 28, 28]), y(8): {0: 442, 1: 196, 4: 571, 5: 430, 6: 530, 7: 16, 8: 544, 9: 116}, in which, 
	X_train: torch.Size([2048, 28, 28]), y_train: Counter({4: 419, 8: 401, 6: 367, 0: 314, 5: 312, 1: 138, 9: 86, 7: 11})
	X_val: torch.Size([228, 28, 28]), y_val: Counter({6: 56, 4: 46, 0: 36, 8: 35, 5: 33, 1: 15, 9: 6, 7: 1})
	X_test: torch.Size([569, 28, 28]), y_test: Counter({8: 108, 6: 107, 4: 106, 0: 92, 5: 85, 1: 43, 9: 24, 7: 4})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:48...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 314), (1, 138), (4, 419), (5, 312), (6, 367), (7, 11), (8, 401), (9, 86)])
class_weight: tensor([0.03, 0.06, 0.02, 0.03, 0.02, 0.73, 0.02, 0.09], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 8.5935, val_loss: 8.5935, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.2987, val_loss: 2.2987, LR: 0.001
Function 'train_cnn' executed in 0.4007 seconds (Start: 2025-11-12 09:52:48, End: 2025-11-12 09:52:48)
dist(local, global): 8.113049507141113
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:48...
Function 'evaluate' executed in 0.0137 seconds (Start: 2025-11-12 09:52:48, End: 2025-11-12 09:52:48)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:48...
Function 'evaluate_shared_test' executed in 0.0260 seconds (Start: 2025-11-12 09:52:48, End: 2025-11-12 09:52:48)

*** server_epoch:0, client_4: Honest... ***
client_4 data (10): {0: 124, 1: 1568, 2: 726, 3: 200, 4: 552, 5: 361, 6: 6, 7: 278, 8: 21, 9: 1196}
Local_data: 
X: torch.Size([6991, 28, 28]), y(10): {0: 173, 1: 2219, 2: 1028, 3: 278, 4: 753, 5: 477, 6: 10, 7: 396, 8: 30, 9: 1627}, in which, 
	X_train: torch.Size([5032, 28, 28]), y_train: Counter({1: 1568, 9: 1196, 2: 726, 4: 552, 5: 361, 7: 278, 3: 200, 0: 124, 8: 21, 6: 6})
	X_val: torch.Size([560, 28, 28]), y_val: Counter({1: 189, 9: 128, 2: 92, 4: 49, 5: 35, 7: 32, 3: 17, 0: 15, 6: 2, 8: 1})
	X_test: torch.Size([1399, 28, 28]), y_test: Counter({1: 462, 9: 303, 2: 210, 4: 152, 7: 86, 5: 81, 3: 61, 0: 34, 8: 8, 6: 2})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:49...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 124), (1, 1568), (2, 726), (3, 200), (4, 552), (5, 361), (6, 6), (7, 278), (8, 21), (9, 1196)])
class_weight: tensor([0.03, 0.00, 0.01, 0.02, 0.01, 0.01, 0.70, 0.02, 0.20, 0.00],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 18.1059, val_loss: 18.1059, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.6519, val_loss: 2.6519, LR: 0.001
Function 'train_cnn' executed in 1.0323 seconds (Start: 2025-11-12 09:52:49, End: 2025-11-12 09:52:50)
dist(local, global): 10.401657104492188
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:50...
Function 'evaluate' executed in 0.0141 seconds (Start: 2025-11-12 09:52:50, End: 2025-11-12 09:52:50)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:50...
Function 'evaluate_shared_test' executed in 0.0283 seconds (Start: 2025-11-12 09:52:50, End: 2025-11-12 09:52:50)

*** server_epoch:0, client_5: Honest... ***
client_5 data (10): {0: 878, 1: 454, 2: 3, 3: 48, 4: 156, 5: 2570, 6: 316, 7: 2187, 8: 412, 9: 136}
Local_data: 
X: torch.Size([9946, 28, 28]), y(10): {0: 1213, 1: 632, 2: 3, 3: 63, 4: 200, 5: 3589, 6: 433, 7: 3064, 8: 577, 9: 172}, in which, 
	X_train: torch.Size([7160, 28, 28]), y_train: Counter({5: 2570, 7: 2187, 0: 878, 1: 454, 8: 412, 6: 316, 4: 156, 9: 136, 3: 48, 2: 3})
	X_val: torch.Size([796, 28, 28]), y_val: Counter({5: 282, 7: 268, 0: 80, 8: 56, 1: 43, 6: 42, 4: 13, 9: 7, 3: 5})
	X_test: torch.Size([1990, 28, 28]), y_test: Counter({5: 737, 7: 609, 0: 255, 1: 135, 8: 109, 6: 75, 4: 31, 9: 29, 3: 10})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:51...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 878), (1, 454), (2, 3), (3, 48), (4, 156), (5, 2570), (6, 316), (7, 2187), (8, 412), (9, 136)])
class_weight: tensor([0.00, 0.01, 0.88, 0.06, 0.02, 0.00, 0.01, 0.00, 0.01, 0.02],
       device='cuda:0'), sum(class_weight) = 0.9999999403953552
train_cnn epoch: 0, local_cnn train loss: 22.3470, val_loss: 22.3470, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.6216, val_loss: 2.6216, LR: 0.001
Function 'train_cnn' executed in 1.5213 seconds (Start: 2025-11-12 09:52:51, End: 2025-11-12 09:52:53)
dist(local, global): 11.702560424804688
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:53...
Function 'evaluate' executed in 0.0188 seconds (Start: 2025-11-12 09:52:53, End: 2025-11-12 09:52:53)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:53...
Function 'evaluate_shared_test' executed in 0.0305 seconds (Start: 2025-11-12 09:52:53, End: 2025-11-12 09:52:53)

*** server_epoch:0, client_6: Honest... ***
client_6 data (9): {0: 287, 1: 1585, 2: 9, 3: 1174, 4: 21, 5: 21, 6: 607, 8: 672, 9: 232}
Local_data: 
X: torch.Size([6402, 28, 28]), y(9): {0: 421, 1: 2177, 2: 11, 3: 1633, 4: 31, 5: 31, 6: 853, 8: 937, 9: 308}, in which, 
	X_train: torch.Size([4608, 28, 28]), y_train: Counter({1: 1585, 3: 1174, 8: 672, 6: 607, 0: 287, 9: 232, 4: 21, 5: 21, 2: 9})
	X_val: torch.Size([513, 28, 28]), y_val: Counter({1: 170, 3: 131, 8: 81, 6: 69, 0: 32, 9: 22, 4: 4, 5: 3, 2: 1})
	X_test: torch.Size([1281, 28, 28]), y_test: Counter({1: 422, 3: 328, 8: 184, 6: 177, 0: 102, 9: 54, 5: 7, 4: 6, 2: 1})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:52:53...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 287), (1, 1585), (2, 9), (3, 1174), (4, 21), (5, 21), (6, 607), (8, 672), (9, 232)])
class_weight: tensor([0.02, 0.00, 0.51, 0.00, 0.22, 0.22, 0.01, 0.01, 0.02], device='cuda:0'), sum(class_weight) = 0.9999999403953552
train_cnn epoch: 0, local_cnn train loss: 15.6514, val_loss: 15.6514, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.1557, val_loss: 2.1557, LR: 0.001
Function 'train_cnn' executed in 0.8984 seconds (Start: 2025-11-12 09:52:53, End: 2025-11-12 09:52:54)
dist(local, global): 9.654623985290527
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:54...
Function 'evaluate' executed in 0.0187 seconds (Start: 2025-11-12 09:52:54, End: 2025-11-12 09:52:54)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:54...
Function 'evaluate_shared_test' executed in 0.0292 seconds (Start: 2025-11-12 09:52:54, End: 2025-11-12 09:52:54)

***server_epoch:0, client_7: Byzantine...
client_7 data: {0: 2312, 1: 38, 2: 131, 3: 120, 4: 117, 5: 2, 6: 1037, 7: 269, 8: 35, 9: 772}
Local_data: 
X: torch.Size([6714, 28, 28]), y(10): {0: 2795, 1: 49, 2: 231, 3: 412, 4: 133, 5: 35, 6: 1204, 7: 321, 8: 45, 9: 1489}, in which, 
	X_train: torch.Size([4833, 28, 28]), y_train: Counter({0: 2312, 6: 1037, 9: 772, 7: 269, 2: 131, 3: 120, 4: 117, 1: 38, 8: 35, 5: 2})
	X_val: torch.Size([538, 28, 28]), y_val: Counter({0: 254, 6: 133, 9: 85, 7: 23, 4: 16, 3: 11, 2: 10, 8: 3, 1: 2, 5: 1})
	X_test: torch.Size([1343, 28, 28]), y_test: Counter({9: 632, 3: 281, 0: 229, 2: 90, 6: 34, 5: 32, 7: 29, 1: 9, 8: 7})
Function 'train_cnn starts at 2025-11-12 09:52:55...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 2312), (1, 38), (2, 131), (3, 120), (4, 117), (5, 2), (6, 1037), (7, 269), (8, 35), (9, 772)])
class_weight: tensor([    0.00,     0.04,     0.01,     0.01,     0.01,     0.85,     0.00,
            0.01,     0.05,     0.00], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.9083, val_loss: 15.9083, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.3884, val_loss: 2.3884, LR: 0.001
Function 'train_cnn' executed in 0.9441 seconds (Start: 2025-11-12 09:52:55, End: 2025-11-12 09:52:56)
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:56...
Function 'evaluate' executed in 0.0148 seconds (Start: 2025-11-12 09:52:56, End: 2025-11-12 09:52:56)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:56...
Function 'evaluate_shared_test' executed in 0.0283 seconds (Start: 2025-11-12 09:52:56, End: 2025-11-12 09:52:56)

***server_epoch:0, client_8: Byzantine...
client_8 data: {0: 229, 1: 32, 2: 1014, 3: 458, 4: 3, 5: 13, 6: 67, 7: 2, 8: 245, 9: 883}
Local_data: 
X: torch.Size([4093, 28, 28]), y(10): {0: 527, 1: 106, 2: 1115, 3: 530, 4: 4, 5: 16, 6: 220, 7: 253, 8: 287, 9: 1035}, in which, 
	X_train: torch.Size([2946, 28, 28]), y_train: Counter({2: 1014, 9: 883, 3: 458, 8: 245, 0: 229, 6: 67, 1: 32, 5: 13, 4: 3, 7: 2})
	X_val: torch.Size([328, 28, 28]), y_val: Counter({2: 100, 9: 95, 3: 56, 8: 32, 0: 26, 6: 12, 1: 4, 5: 3})
	X_test: torch.Size([819, 28, 28]), y_test: Counter({0: 272, 7: 251, 6: 141, 1: 70, 9: 57, 3: 16, 8: 10, 2: 1, 4: 1})
Function 'train_cnn starts at 2025-11-12 09:52:57...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 229), (1, 32), (2, 1014), (3, 458), (4, 3), (5, 13), (6, 67), (7, 2), (8, 245), (9, 883)])
class_weight: tensor([0.00, 0.03, 0.00, 0.00, 0.34, 0.08, 0.02, 0.52, 0.00, 0.00],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 11.2190, val_loss: 11.2190, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1.6252, val_loss: 1.6252, LR: 0.001
Function 'train_cnn' executed in 0.5999 seconds (Start: 2025-11-12 09:52:57, End: 2025-11-12 09:52:58)
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:58...
Function 'evaluate' executed in 0.0128 seconds (Start: 2025-11-12 09:52:58, End: 2025-11-12 09:52:58)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:58...
Function 'evaluate_shared_test' executed in 0.0262 seconds (Start: 2025-11-12 09:52:58, End: 2025-11-12 09:52:58)

***server_epoch:0, client_9: Byzantine...
client_9 data: {0: 33, 1: 757, 2: 101, 3: 1261, 4: 171, 5: 51, 6: 28, 7: 1310, 8: 22, 9: 721}
Local_data: 
X: torch.Size([6189, 28, 28]), y(10): {0: 247, 1: 843, 2: 469, 3: 1408, 4: 209, 5: 99, 6: 380, 7: 1497, 8: 225, 9: 812}, in which, 
	X_train: torch.Size([4455, 28, 28]), y_train: Counter({7: 1310, 3: 1261, 1: 757, 9: 721, 4: 171, 2: 101, 5: 51, 0: 33, 6: 28, 8: 22})
	X_val: torch.Size([496, 28, 28]), y_val: Counter({7: 157, 3: 139, 9: 77, 1: 75, 4: 22, 2: 8, 6: 5, 5: 5, 8: 4, 0: 4})
	X_test: torch.Size([1238, 28, 28]), y_test: Counter({2: 360, 6: 347, 0: 210, 8: 199, 5: 43, 7: 30, 4: 16, 9: 14, 1: 11, 3: 8})
Function 'train_cnn starts at 2025-11-12 09:52:58...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 33), (1, 757), (2, 101), (3, 1261), (4, 171), (5, 51), (6, 28), (7, 1310), (8, 22), (9, 721)])
class_weight: tensor([0.20, 0.01, 0.07, 0.01, 0.04, 0.13, 0.24, 0.01, 0.30, 0.01],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 15.9021, val_loss: 15.9021, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.2733, val_loss: 2.2733, LR: 0.001
Function 'train_cnn' executed in 0.8847 seconds (Start: 2025-11-12 09:52:58, End: 2025-11-12 09:52:59)
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:52:59...
Function 'evaluate' executed in 0.0138 seconds (Start: 2025-11-12 09:52:59, End: 2025-11-12 09:52:59)
Function 'evaluate_shared_test starts at 2025-11-12 09:52:59...
Function 'evaluate_shared_test' executed in 0.0261 seconds (Start: 2025-11-12 09:52:59, End: 2025-11-12 09:52:59)

*************** Server Epoch: 0/2, Server Aggregation **************
Function 'aggregate_cnns starts at 2025-11-12 09:52:59...
*aggregate cnn...
each update shape: torch.Size([390378])
Unique weights: tensor([1]), counts: tensor([10])
Krum scores: ['39.96', '39.21', '37.07', '34.09', '40.31', '47.49', '38.20', '51.69', '44.78', '51.21']
Selected index: 3
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Update 2']
 ['Chosen Update']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], client_updates: min: -0.07, max: 0.06, time taken: 0.0444s, l2_error: 3.51
Function 'aggregate_cnns' executed in 0.0827 seconds (Start: 2025-11-12 09:52:59, End: 2025-11-12 09:52:59)

*************** Server Epoch: 1/2, Client Training *****************

*** server_epoch:1, client_0: Honest... ***
client_0 data (10): {0: 7, 1: 2, 2: 564, 3: 165, 4: 1859, 5: 41, 6: 1025, 7: 40, 8: 250, 9: 101}
Local_data: 
X: torch.Size([5632, 28, 28]), y(10): {0: 8, 1: 4, 2: 802, 3: 221, 4: 2606, 5: 55, 6: 1406, 7: 64, 8: 330, 9: 136}, in which, 
	X_train: torch.Size([4054, 28, 28]), y_train: Counter({4: 1859, 6: 1025, 2: 564, 8: 250, 3: 165, 9: 101, 5: 41, 7: 40, 0: 7, 1: 2})
	X_val: torch.Size([451, 28, 28]), y_val: Counter({4: 225, 6: 117, 2: 50, 3: 20, 8: 17, 7: 9, 9: 8, 5: 3, 0: 1, 1: 1})
	X_test: torch.Size([1127, 28, 28]), y_test: Counter({4: 522, 6: 264, 2: 188, 8: 63, 3: 36, 9: 27, 7: 15, 5: 11, 1: 1})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:00...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 7), (1, 2), (2, 564), (3, 165), (4, 1859), (5, 41), (6, 1025), (7, 40), (8, 250), (9, 101)])
class_weight: tensor([0.20, 0.70, 0.00, 0.01, 0.00, 0.03, 0.00, 0.03, 0.01, 0.01],
       device='cuda:0'), sum(class_weight) = 0.9999999403953552
train_cnn epoch: 0, local_cnn train loss: 6.3407, val_loss: 6.3407, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1.6229, val_loss: 1.6229, LR: 0.001
Function 'train_cnn' executed in 0.8070 seconds (Start: 2025-11-12 09:53:00, End: 2025-11-12 09:53:01)
dist(local, global): 5.990015983581543
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:01...
Function 'evaluate' executed in 0.0130 seconds (Start: 2025-11-12 09:53:01, End: 2025-11-12 09:53:01)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:01...
Function 'evaluate_shared_test' executed in 0.0263 seconds (Start: 2025-11-12 09:53:01, End: 2025-11-12 09:53:01)

*** server_epoch:1, client_1: Honest... ***
client_1 data (9): {0: 57, 1: 45, 2: 84, 3: 1256, 4: 1136, 5: 4, 6: 81, 7: 646, 8: 1514}
Local_data: 
X: torch.Size([6699, 28, 28]), y(9): {0: 93, 1: 56, 2: 128, 3: 1763, 4: 1557, 5: 6, 6: 104, 7: 898, 8: 2094}, in which, 
	X_train: torch.Size([4823, 28, 28]), y_train: Counter({8: 1514, 3: 1256, 4: 1136, 7: 646, 2: 84, 6: 81, 0: 57, 1: 45, 5: 4})
	X_val: torch.Size([536, 28, 28]), y_val: Counter({8: 170, 3: 156, 4: 104, 7: 73, 0: 10, 2: 10, 6: 9, 1: 4})
	X_test: torch.Size([1340, 28, 28]), y_test: Counter({8: 410, 3: 351, 4: 317, 7: 179, 2: 34, 0: 26, 6: 14, 1: 7, 5: 2})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:02...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 57), (1, 45), (2, 84), (3, 1256), (4, 1136), (5, 4), (6, 81), (7, 646), (8, 1514)])
class_weight: tensor([0.06, 0.07, 0.04, 0.00, 0.00, 0.79, 0.04, 0.00, 0.00], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 10.0469, val_loss: 10.0469, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.0721, val_loss: 2.0721, LR: 0.001
Function 'train_cnn' executed in 0.9730 seconds (Start: 2025-11-12 09:53:02, End: 2025-11-12 09:53:03)
dist(local, global): 5.863556385040283
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:03...
Function 'evaluate' executed in 0.0131 seconds (Start: 2025-11-12 09:53:03, End: 2025-11-12 09:53:03)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:03...
Function 'evaluate_shared_test' executed in 0.0273 seconds (Start: 2025-11-12 09:53:03, End: 2025-11-12 09:53:03)

*** server_epoch:1, client_2: Honest... ***
client_2 data (10): {0: 164, 1: 731, 2: 1271, 3: 433, 4: 23, 5: 303, 6: 11, 7: 111, 8: 163, 9: 21}
Local_data: 
X: torch.Size([4489, 28, 28]), y(10): {0: 229, 1: 1027, 2: 1774, 3: 586, 4: 32, 5: 429, 6: 15, 7: 153, 8: 215, 9: 29}, in which, 
	X_train: torch.Size([3231, 28, 28]), y_train: Counter({2: 1271, 1: 731, 3: 433, 5: 303, 0: 164, 8: 163, 7: 111, 4: 23, 9: 21, 6: 11})
	X_val: torch.Size([360, 28, 28]), y_val: Counter({2: 142, 1: 75, 3: 47, 5: 43, 0: 17, 8: 17, 7: 11, 4: 4, 9: 3, 6: 1})
	X_test: torch.Size([898, 28, 28]), y_test: Counter({2: 361, 1: 221, 3: 106, 5: 83, 0: 48, 8: 35, 7: 31, 4: 5, 9: 5, 6: 3})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:04...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 164), (1, 731), (2, 1271), (3, 433), (4, 23), (5, 303), (6, 11), (7, 111), (8, 163), (9, 21)])
class_weight: tensor([0.03, 0.01, 0.00, 0.01, 0.21, 0.02, 0.43, 0.04, 0.03, 0.23],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 12.0822, val_loss: 12.0822, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.2830, val_loss: 2.2830, LR: 0.001
Function 'train_cnn' executed in 0.6512 seconds (Start: 2025-11-12 09:53:04, End: 2025-11-12 09:53:04)
dist(local, global): 5.289718151092529
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:04...
Function 'evaluate' executed in 0.0110 seconds (Start: 2025-11-12 09:53:04, End: 2025-11-12 09:53:04)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:04...
Function 'evaluate_shared_test' executed in 0.0262 seconds (Start: 2025-11-12 09:53:04, End: 2025-11-12 09:53:04)

*** server_epoch:1, client_3: Honest... ***
client_3 data (8): {0: 314, 1: 138, 4: 419, 5: 312, 6: 367, 7: 11, 8: 401, 9: 86}
Local_data: 
X: torch.Size([2845, 28, 28]), y(8): {0: 442, 1: 196, 4: 571, 5: 430, 6: 530, 7: 16, 8: 544, 9: 116}, in which, 
	X_train: torch.Size([2048, 28, 28]), y_train: Counter({4: 419, 8: 401, 6: 367, 0: 314, 5: 312, 1: 138, 9: 86, 7: 11})
	X_val: torch.Size([228, 28, 28]), y_val: Counter({6: 56, 4: 46, 0: 36, 8: 35, 5: 33, 1: 15, 9: 6, 7: 1})
	X_test: torch.Size([569, 28, 28]), y_test: Counter({8: 108, 6: 107, 4: 106, 0: 92, 5: 85, 1: 43, 9: 24, 7: 4})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:05...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 314), (1, 138), (4, 419), (5, 312), (6, 367), (7, 11), (8, 401), (9, 86)])
class_weight: tensor([0.03, 0.06, 0.02, 0.03, 0.02, 0.73, 0.02, 0.09], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 2.2788, val_loss: 2.2788, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1.0674, val_loss: 1.0674, LR: 0.001
Function 'train_cnn' executed in 0.4169 seconds (Start: 2025-11-12 09:53:05, End: 2025-11-12 09:53:06)
dist(local, global): 3.8172173500061035
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:06...
Function 'evaluate' executed in 0.0116 seconds (Start: 2025-11-12 09:53:06, End: 2025-11-12 09:53:06)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:06...
Function 'evaluate_shared_test' executed in 0.0341 seconds (Start: 2025-11-12 09:53:06, End: 2025-11-12 09:53:06)

*** server_epoch:1, client_4: Honest... ***
client_4 data (10): {0: 124, 1: 1568, 2: 726, 3: 200, 4: 552, 5: 361, 6: 6, 7: 278, 8: 21, 9: 1196}
Local_data: 
X: torch.Size([6991, 28, 28]), y(10): {0: 173, 1: 2219, 2: 1028, 3: 278, 4: 753, 5: 477, 6: 10, 7: 396, 8: 30, 9: 1627}, in which, 
	X_train: torch.Size([5032, 28, 28]), y_train: Counter({1: 1568, 9: 1196, 2: 726, 4: 552, 5: 361, 7: 278, 3: 200, 0: 124, 8: 21, 6: 6})
	X_val: torch.Size([560, 28, 28]), y_val: Counter({1: 189, 9: 128, 2: 92, 4: 49, 5: 35, 7: 32, 3: 17, 0: 15, 6: 2, 8: 1})
	X_test: torch.Size([1399, 28, 28]), y_test: Counter({1: 462, 9: 303, 2: 210, 4: 152, 7: 86, 5: 81, 3: 61, 0: 34, 8: 8, 6: 2})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:06...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 124), (1, 1568), (2, 726), (3, 200), (4, 552), (5, 361), (6, 6), (7, 278), (8, 21), (9, 1196)])
class_weight: tensor([0.03, 0.00, 0.01, 0.02, 0.01, 0.01, 0.70, 0.02, 0.20, 0.00],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 9.4530, val_loss: 9.4530, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.4328, val_loss: 2.4328, LR: 0.001
Function 'train_cnn' executed in 1.0353 seconds (Start: 2025-11-12 09:53:06, End: 2025-11-12 09:53:07)
dist(local, global): 6.135191917419434
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:07...
Function 'evaluate' executed in 0.0133 seconds (Start: 2025-11-12 09:53:07, End: 2025-11-12 09:53:08)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:08...
Function 'evaluate_shared_test' executed in 0.0264 seconds (Start: 2025-11-12 09:53:08, End: 2025-11-12 09:53:08)

*** server_epoch:1, client_5: Honest... ***
client_5 data (10): {0: 878, 1: 454, 2: 3, 3: 48, 4: 156, 5: 2570, 6: 316, 7: 2187, 8: 412, 9: 136}
Local_data: 
X: torch.Size([9946, 28, 28]), y(10): {0: 1213, 1: 632, 2: 3, 3: 63, 4: 200, 5: 3589, 6: 433, 7: 3064, 8: 577, 9: 172}, in which, 
	X_train: torch.Size([7160, 28, 28]), y_train: Counter({5: 2570, 7: 2187, 0: 878, 1: 454, 8: 412, 6: 316, 4: 156, 9: 136, 3: 48, 2: 3})
	X_val: torch.Size([796, 28, 28]), y_val: Counter({5: 282, 7: 268, 0: 80, 8: 56, 1: 43, 6: 42, 4: 13, 9: 7, 3: 5})
	X_test: torch.Size([1990, 28, 28]), y_test: Counter({5: 737, 7: 609, 0: 255, 1: 135, 8: 109, 6: 75, 4: 31, 9: 29, 3: 10})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:09...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 878), (1, 454), (2, 3), (3, 48), (4, 156), (5, 2570), (6, 316), (7, 2187), (8, 412), (9, 136)])
class_weight: tensor([0.00, 0.01, 0.88, 0.06, 0.02, 0.00, 0.01, 0.00, 0.01, 0.02],
       device='cuda:0'), sum(class_weight) = 0.9999999403953552
train_cnn epoch: 0, local_cnn train loss: 8.1671, val_loss: 8.1671, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.0074, val_loss: 2.0074, LR: 0.001
Function 'train_cnn' executed in 1.5353 seconds (Start: 2025-11-12 09:53:09, End: 2025-11-12 09:53:10)
dist(local, global): 7.281673431396484
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:10...
Function 'evaluate' executed in 0.0176 seconds (Start: 2025-11-12 09:53:10, End: 2025-11-12 09:53:10)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:10...
Function 'evaluate_shared_test' executed in 0.0264 seconds (Start: 2025-11-12 09:53:10, End: 2025-11-12 09:53:10)

*** server_epoch:1, client_6: Honest... ***
client_6 data (9): {0: 287, 1: 1585, 2: 9, 3: 1174, 4: 21, 5: 21, 6: 607, 8: 672, 9: 232}
Local_data: 
X: torch.Size([6402, 28, 28]), y(9): {0: 421, 1: 2177, 2: 11, 3: 1633, 4: 31, 5: 31, 6: 853, 8: 937, 9: 308}, in which, 
	X_train: torch.Size([4608, 28, 28]), y_train: Counter({1: 1585, 3: 1174, 8: 672, 6: 607, 0: 287, 9: 232, 4: 21, 5: 21, 2: 9})
	X_val: torch.Size([513, 28, 28]), y_val: Counter({1: 170, 3: 131, 8: 81, 6: 69, 0: 32, 9: 22, 4: 4, 5: 3, 2: 1})
	X_test: torch.Size([1281, 28, 28]), y_test: Counter({1: 422, 3: 328, 8: 184, 6: 177, 0: 102, 9: 54, 5: 7, 4: 6, 2: 1})
Train CNN...
Function 'train_cnn starts at 2025-11-12 09:53:11...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 287), (1, 1585), (2, 9), (3, 1174), (4, 21), (5, 21), (6, 607), (8, 672), (9, 232)])
class_weight: tensor([0.02, 0.00, 0.51, 0.00, 0.22, 0.22, 0.01, 0.01, 0.02], device='cuda:0'), sum(class_weight) = 0.9999999403953552
train_cnn epoch: 0, local_cnn train loss: 7.4020, val_loss: 7.4020, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 1.6518, val_loss: 1.6518, LR: 0.001
Function 'train_cnn' executed in 0.8897 seconds (Start: 2025-11-12 09:53:11, End: 2025-11-12 09:53:12)
dist(local, global): 5.477435111999512
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:12...
Function 'evaluate' executed in 0.0174 seconds (Start: 2025-11-12 09:53:12, End: 2025-11-12 09:53:12)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:12...
Function 'evaluate_shared_test' executed in 0.0299 seconds (Start: 2025-11-12 09:53:12, End: 2025-11-12 09:53:12)

***server_epoch:1, client_7: Byzantine...
client_7 data: {0: 2312, 1: 38, 2: 131, 3: 120, 4: 117, 5: 2, 6: 1037, 7: 269, 8: 35, 9: 772}
Local_data: 
X: torch.Size([6714, 28, 28]), y(10): {0: 2795, 1: 49, 2: 231, 3: 412, 4: 133, 5: 35, 6: 1204, 7: 321, 8: 45, 9: 1489}, in which, 
	X_train: torch.Size([4833, 28, 28]), y_train: Counter({0: 2312, 6: 1037, 9: 772, 7: 269, 2: 131, 3: 120, 4: 117, 1: 38, 8: 35, 5: 2})
	X_val: torch.Size([538, 28, 28]), y_val: Counter({0: 254, 6: 133, 9: 85, 7: 23, 4: 16, 3: 11, 2: 10, 8: 3, 1: 2, 5: 1})
	X_test: torch.Size([1343, 28, 28]), y_test: Counter({9: 632, 3: 281, 0: 229, 2: 90, 6: 34, 5: 32, 7: 29, 1: 9, 8: 7})
Function 'train_cnn starts at 2025-11-12 09:53:13...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 2312), (1, 38), (2, 131), (3, 120), (4, 117), (5, 2), (6, 1037), (7, 269), (8, 35), (9, 772)])
class_weight: tensor([    0.00,     0.04,     0.01,     0.01,     0.01,     0.85,     0.00,
            0.01,     0.05,     0.00], device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 21.3734, val_loss: 21.3734, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.0606, val_loss: 3.0606, LR: 0.001
Function 'train_cnn' executed in 0.9819 seconds (Start: 2025-11-12 09:53:13, End: 2025-11-12 09:53:14)
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:14...
Function 'evaluate' executed in 0.0129 seconds (Start: 2025-11-12 09:53:14, End: 2025-11-12 09:53:14)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:14...
Function 'evaluate_shared_test' executed in 0.0301 seconds (Start: 2025-11-12 09:53:14, End: 2025-11-12 09:53:14)

***server_epoch:1, client_8: Byzantine...
client_8 data: {0: 229, 1: 32, 2: 1014, 3: 458, 4: 3, 5: 13, 6: 67, 7: 2, 8: 245, 9: 883}
Local_data: 
X: torch.Size([4093, 28, 28]), y(10): {0: 527, 1: 106, 2: 1115, 3: 530, 4: 4, 5: 16, 6: 220, 7: 253, 8: 287, 9: 1035}, in which, 
	X_train: torch.Size([2946, 28, 28]), y_train: Counter({2: 1014, 9: 883, 3: 458, 8: 245, 0: 229, 6: 67, 1: 32, 5: 13, 4: 3, 7: 2})
	X_val: torch.Size([328, 28, 28]), y_val: Counter({2: 100, 9: 95, 3: 56, 8: 32, 0: 26, 6: 12, 1: 4, 5: 3})
	X_test: torch.Size([819, 28, 28]), y_test: Counter({0: 272, 7: 251, 6: 141, 1: 70, 9: 57, 3: 16, 8: 10, 2: 1, 4: 1})
Function 'train_cnn starts at 2025-11-12 09:53:15...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 229), (1, 32), (2, 1014), (3, 458), (4, 3), (5, 13), (6, 67), (7, 2), (8, 245), (9, 883)])
class_weight: tensor([0.00, 0.03, 0.00, 0.00, 0.34, 0.08, 0.02, 0.52, 0.00, 0.00],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 18.6270, val_loss: 18.6270, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 2.0900, val_loss: 2.0900, LR: 0.001
Function 'train_cnn' executed in 0.5874 seconds (Start: 2025-11-12 09:53:15, End: 2025-11-12 09:53:15)
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:15...
Function 'evaluate' executed in 0.0111 seconds (Start: 2025-11-12 09:53:15, End: 2025-11-12 09:53:15)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:15...
Function 'evaluate_shared_test' executed in 0.0332 seconds (Start: 2025-11-12 09:53:15, End: 2025-11-12 09:53:15)

***server_epoch:1, client_9: Byzantine...
client_9 data: {0: 33, 1: 757, 2: 101, 3: 1261, 4: 171, 5: 51, 6: 28, 7: 1310, 8: 22, 9: 721}
Local_data: 
X: torch.Size([6189, 28, 28]), y(10): {0: 247, 1: 843, 2: 469, 3: 1408, 4: 209, 5: 99, 6: 380, 7: 1497, 8: 225, 9: 812}, in which, 
	X_train: torch.Size([4455, 28, 28]), y_train: Counter({7: 1310, 3: 1261, 1: 757, 9: 721, 4: 171, 2: 101, 5: 51, 0: 33, 6: 28, 8: 22})
	X_val: torch.Size([496, 28, 28]), y_val: Counter({7: 157, 3: 139, 9: 77, 1: 75, 4: 22, 2: 8, 6: 5, 5: 5, 8: 4, 0: 4})
	X_test: torch.Size([1238, 28, 28]), y_test: Counter({2: 360, 6: 347, 0: 210, 8: 199, 5: 43, 7: 30, 4: 16, 9: 14, 1: 11, 3: 8})
Function 'train_cnn starts at 2025-11-12 09:53:16...
X: min: -1.0, max: 1.0
Compute classes weights...
labeled_y:  dict_items([(0, 33), (1, 757), (2, 101), (3, 1261), (4, 171), (5, 51), (6, 28), (7, 1310), (8, 22), (9, 721)])
class_weight: tensor([0.20, 0.01, 0.07, 0.01, 0.04, 0.13, 0.24, 0.01, 0.30, 0.01],
       device='cuda:0'), sum(class_weight) = 1.0
train_cnn epoch: 0, local_cnn train loss: 20.3468, val_loss: 20.3468, LR: 0.001
train_cnn epoch: 4, local_cnn train loss: 3.3624, val_loss: 3.3624, LR: 0.001
Function 'train_cnn' executed in 0.8978 seconds (Start: 2025-11-12 09:53:16, End: 2025-11-12 09:53:17)
Evaluate CNNs...
Function 'evaluate starts at 2025-11-12 09:53:17...
Function 'evaluate' executed in 0.0125 seconds (Start: 2025-11-12 09:53:17, End: 2025-11-12 09:53:17)
Function 'evaluate_shared_test starts at 2025-11-12 09:53:17...
Function 'evaluate_shared_test' executed in 0.0263 seconds (Start: 2025-11-12 09:53:17, End: 2025-11-12 09:53:17)

*************** Server Epoch: 1/2, Server Aggregation **************
Function 'aggregate_cnns starts at 2025-11-12 09:53:17...
*aggregate cnn...
each update shape: torch.Size([390378])
Unique weights: tensor([1]), counts: tensor([10])
Krum scores: ['13.26', '13.31', '12.00', '14.16', '13.23', '18.06', '13.41', '31.80', '24.48', '27.33']
Selected index: 2
krum, clients_type: [['Update 0']
 ['Update 1']
 ['Chosen Update']
 ['Update 3']
 ['Update 4']
 ['Update 5']
 ['Update 6']
 ['Update 7']
 ['Update 8']
 ['Update 9']], client_updates: min: -0.05, max: 0.06, time taken: 0.0438s, l2_error: 2.25
Function 'aggregate_cnns' executed in 0.0874 seconds (Start: 2025-11-12 09:53:17, End: 2025-11-12 09:53:17)
saving histories to /projects/kunyang/nvflare_py31012/nvflare/data/MNIST/label_flipping/h_7-b_3-5-0.8-0.5-krum/0/histories_-n_2.pt.gz

***************************** Final Results (mu+/-std) *************************************

 Final***model_type: global***
*client_0:
	server_epoch_0, train_acc:0.0027-0.0000, val_acc:0.0044-0.0000, test_acc:0.0000-0.0000, shared_acc:0.1040-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.7296-0.0000, val_acc:0.7539-0.0000, test_acc:0.7116-0.0000, shared_acc:0.5727-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_1:
	server_epoch_0, train_acc:0.0110-0.0000, val_acc:0.0168-0.0000, test_acc:0.0194-0.0000, shared_acc:0.1040-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.5314-0.0000, val_acc:0.5075-0.0000, test_acc:0.5149-0.0000, shared_acc:0.5727-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_2:
	server_epoch_0, train_acc:0.0579-0.0000, val_acc:0.0639-0.0000, test_acc:0.0624-0.0000, shared_acc:0.1040-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.3859-0.0000, val_acc:0.3861-0.0000, test_acc:0.3931-0.0000, shared_acc:0.5727-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_3:
	server_epoch_0, train_acc:0.1631-0.0000, val_acc:0.1404-0.0000, test_acc:0.1722-0.0000, shared_acc:0.1040-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.8682-0.0000, val_acc:0.9123-0.0000, test_acc:0.8436-0.0000, shared_acc:0.5727-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_4:
	server_epoch_0, train_acc:0.0294-0.0000, val_acc:0.0321-0.0000, test_acc:0.0272-0.0000, shared_acc:0.1040-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.5618-0.0000, val_acc:0.5339-0.0000, test_acc:0.5611-0.0000, shared_acc:0.5727-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_5:
	server_epoch_0, train_acc:0.1616-0.0000, val_acc:0.1445-0.0000, test_acc:0.1693-0.0000, shared_acc:0.1040-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.5744-0.0000, val_acc:0.5490-0.0000, test_acc:0.5653-0.0000, shared_acc:0.5727-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_6:
	server_epoch_0, train_acc:0.0603-0.0000, val_acc:0.0604-0.0000, test_acc:0.0765-0.0000, shared_acc:0.1040-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.6643-0.0000, val_acc:0.6589-0.0000, test_acc:0.6612-0.0000, shared_acc:0.5727-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_7:
	server_epoch_0, train_acc:0.4705-0.0000, val_acc:0.4684-0.0000, test_acc:0.1675-0.0000, shared_acc:0.1040-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.0221-0.0000, val_acc:0.0316-0.0000, test_acc:0.3611-0.0000, shared_acc:0.5727-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_8:
	server_epoch_0, train_acc:0.0757-0.0000, val_acc:0.0762-0.0000, test_acc:0.3248-0.0000, shared_acc:0.1040-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.0048-0.0000, val_acc:0.0030-0.0000, test_acc:0.5885-0.0000, shared_acc:0.5727-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_9:
	server_epoch_0, train_acc:0.0083-0.0000, val_acc:0.0081-0.0000, test_acc:0.1737-0.0000, shared_acc:0.1040-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.0065-0.0000, val_acc:0.0121-0.0000, test_acc:0.6139-0.0000, shared_acc:0.5727-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 

 Final***model_type: local***
*client_0:
	server_epoch_0, train_acc:0.9203-0.0000, val_acc:0.9268-0.0000, test_acc:0.9086-0.0000, shared_acc:0.5736-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.9410-0.0000, val_acc:0.9379-0.0000, test_acc:0.9193-0.0000, shared_acc:0.6976-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_1:
	server_epoch_0, train_acc:0.9305-0.0000, val_acc:0.9310-0.0000, test_acc:0.9336-0.0000, shared_acc:0.6378-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.9366-0.0000, val_acc:0.9310-0.0000, test_acc:0.9358-0.0000, shared_acc:0.6732-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_2:
	server_epoch_0, train_acc:0.8892-0.0000, val_acc:0.8778-0.0000, test_acc:0.8753-0.0000, shared_acc:0.5999-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.9152-0.0000, val_acc:0.8833-0.0000, test_acc:0.9020-0.0000, shared_acc:0.7151-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_3:
	server_epoch_0, train_acc:0.8682-0.0000, val_acc:0.9123-0.0000, test_acc:0.8436-0.0000, shared_acc:0.5727-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.9307-0.0000, val_acc:0.9342-0.0000, test_acc:0.9209-0.0000, shared_acc:0.6766-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_4:
	server_epoch_0, train_acc:0.9320-0.0000, val_acc:0.9071-0.0000, test_acc:0.9278-0.0000, shared_acc:0.7226-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.9332-0.0000, val_acc:0.9071-0.0000, test_acc:0.9285-0.0000, shared_acc:0.7923-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_5:
	server_epoch_0, train_acc:0.9578-0.0000, val_acc:0.9447-0.0000, test_acc:0.9548-0.0000, shared_acc:0.7514-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.9654-0.0000, val_acc:0.9585-0.0000, test_acc:0.9583-0.0000, shared_acc:0.7836-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_6:
	server_epoch_0, train_acc:0.9256-0.0000, val_acc:0.9318-0.0000, test_acc:0.9243-0.0000, shared_acc:0.5735-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.9494-0.0000, val_acc:0.9513-0.0000, test_acc:0.9454-0.0000, shared_acc:0.6355-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_7:
	server_epoch_0, train_acc:0.9359-0.0000, val_acc:0.9461-0.0000, test_acc:0.0074-0.0000, shared_acc:0.0088-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.9121-0.0000, val_acc:0.9201-0.0000, test_acc:0.0097-0.0000, shared_acc:0.0197-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_8:
	server_epoch_0, train_acc:0.9284-0.0000, val_acc:0.9238-0.0000, test_acc:0.0073-0.0000, shared_acc:0.0270-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.9148-0.0000, val_acc:0.9024-0.0000, test_acc:0.0159-0.0000, shared_acc:0.0681-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
*client_9:
	server_epoch_0, train_acc:0.9264-0.0000, val_acc:0.9234-0.0000, test_acc:0.0105-0.0000, shared_acc:0.0765-0.0000, l2_error:3.5094-0.0000, time_taken:0.0444-0.0000, 
	server_epoch_1, train_acc:0.9129-0.0000, val_acc:0.9052-0.0000, test_acc:0.0153-0.0000, shared_acc:0.1431-0.0000, l2_error:2.2465-0.0000, time_taken:0.0438-0.0000, 
Function 'main' executed in 74.1686 seconds (Start: 2025-11-12 09:52:03, End: 2025-11-12 09:53:17)
